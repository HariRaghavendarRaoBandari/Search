PATH TRANSFORMATIONS FOR LOCAL TIMES OF

ONE-DIMENSIONAL DIFFUSIONS

UMUT C¸ ETIN

Abstract. Let X be a regular one-dimensional transient diﬀusion and Ly be its local time
at y. The stochastic diﬀerential equation (SDE) whose solution corresponds to the process
X conditioned on [Ly
∞ = a] for a given a ≥ 0 is constructed and a new path decomposition
result for transient diﬀusions is given. In the course of the construction of the SDE the
concept of recurrent transformation is introduced and Bessel-type motions as well as their
SDE representations are studied. A remarkable link between an h-transform with a minimal
excessive function and recurrent transformations is found, which, as a by-product, gives a
useful representation of last passage times as a mixture of ﬁrst hitting times. Moreover, the
Engelbert-Schmidt theory for the weak solutions of one dimensional SDEs is extended to
the case when the initial condition is an entrance boundary for the diﬀusion. This extension
was necessary for the construction of the Bessel-type motion which played an essential part
in the SDE representation of X conditioned on [Ly

∞ = a].

6
1
0
2

 
r
a

M
6

 

 
 
]

.

R
P
h
t
a
m

[
 
 

1
v
6
8
8
1
0

.

3
0
6
1
:
v
i
X
r
a

1. Introduction

Conditioning a given Markov process, X, is a well-studied subject which has become
synonymous with the term h-transform. If one wants to condition the paths of X to stay
in a certain set, the classical recipe consists of ﬁnding an appropriate excessive function, h,
deﬁning the transition probabilities of the conditioned process via h, and constructing on the
canonical space a Markov process, X h, with these new transition probabilities using standard
techniques. This procedure is called an h-transform and its origins go back to Doob and his
study of boundary limits of Brownian motion [4, 5]. If h is a minimal excessive function with
a pole at y (see Section 11.4 of [3] for deﬁnitions), then X h is the process X conditioned
to converge to y and killed at its last exit from y. We refer the reader to Chapter 11 of [3]
for an in-depth analysis of h-transforms and their connections with time reversal and last
passage times.

If X is regular transient diﬀusion taking values in some subset of R, h := u(·, y) is a
minimal excessive function for every y in its state space, where u is the potential density of
X. Moreover, y is the unique pole of this excessive function. Thus, the preceding discussion
suggests that this h-transform condition X to converge to y and kills it at its last exit from
y. For a thorough discussion of h-transforms for one-dimensional diﬀusions and the proofs
of certain results that are considered to be folklore in the literature we refer the reader to a
recent manuscript by Evans and Hening [7]. The recent work of Perkowski and Ruf [15] also
considers a speciﬁc case of conditioning for one-dimensional diﬀusions.

Date: March 8, 2016.

1

2

UMUT C¸ ETIN

In this paper we are interested in conditioning a one-dimensional regular transient diﬀusion
on the value of its local time at its lifetime. We assume that the diﬀusion cannot be killed
in the interior of its state space. It is well-known that (X, Ly) is a two-dimensional Markov
process, where Ly is the local time of X at level y. If we would like to apply an h-transform
to achieve our conditioning, we need to ﬁnd a minimal excessive function of the pair (X, Ly)
with a suitable pole so that the local time of the X h equals a given number, say, a ≥ 0 at its
lifetime. The problem with this approach is that it requires the knowledge of the potential
density of the Markov pair (X, Ly), which is in general not easily obtained or characterised.
Moreover, as in every h-transform, it requires a killing procedure.

We shall follow a diﬀerent approach and construct the conditioned process as a weak solu-
tion to a stochastic diﬀerential equation (SDE) with a suitably chosen drift. This obviously
requires the original process, X, being a solution of an SDE. In Section 2 we impose the
standard Engelbert-Schmidt conditions in order to ensure that X itself is the unique weak
solution of an SDE upto a, possibly ﬁnite, exit time from its state space. Our aim is to con-
struct an SDE –for which weak uniqueness holds– such that the law of its solutions coincides
with the law of X conditioned on the null set [Ly
∞ = a]. As such, there will be no killing
involved in the interior of the state space in our conditioning.

At the end of Section 2 we give a recipe for constructing the SDE with the above property
and a brief warning about pitfalls that one may encounter depending on the limiting values
of X. However, diﬃculties aside, the desired conditioning should be done in two steps: In
Step 1 we have to choose a suitable drift that makes sure that the solution keeps hitting
y until the local time process equals a. As soon as this is achieved, in Step 2, we have to
choose a new drift that prevents the solutions hitting y again and, thus, keeping the local
time process constant at a.

Since we want to make sure that Ly

∞ = a with probability one for the conditioned process,
it is necessary that we have to choose a drift term in Step 1 to transform X into a recurrent
process.
Indeed, if the solution of the SDE considered in Step 1 is transient, there is a
non-zero probability for its solution to drift away to the cemetery state before its local time
process hits a. To this end we introduce the concept of a recurrent transformation in Section
3. Roughly speaking, a recurrent transformation adds a drift term to the original SDE of X
so that the resulting process is a regular diﬀusion with the same state space which it cannot
exit in ﬁnite time. A particular example of a recurrent transformation will give us the drift
that achieves the Step 1 of our conditioning procedure. Interestingly, this speciﬁc recurrent
transformation will be intimately linked to the h-transform of X that we discussed at the
beginning of this section with h = u(·, y), which conditions X to converge to y and kills it
at its last exit from y. We show in Remark 3 that these particular examples of recurrent
transformation and the h-transform produce diﬀusions with the same scale function and the
speed measure. Yet the resulting diﬀusions are fundamentally diﬀerent since one is transient
while the other is recurrent. As one could expect the diﬀerence between the recurrent
transformation and the h-transform lies in their killing measures. While the killing measure
for the former is null, it is a Dirac measure for the latter. Given that they have the same
scale function and the speed measure it is only natural to ask whether one can obtain the
h-transform from the recurrent transformation via a killing. We show in Remark 3 that
one can indeed get the h-transform by killing the recurrent transform at a random time

PATH TRANSFORMATIONS FOR LOCAL TIMES OF ONE-DIMENSIONAL DIFFUSIONS

3

which is a mixture of inverse local times associated to the recurrent transformation. As a
by-product of this result we also deduce that one can simulate the last passage times of a
transient diﬀusion by simulating a mixture of the ﬁrst hitting times of the local times of a
related diﬀusion. This is not only a result of independent interest but it can be also useful
in simulation studies involving last passage times of diﬀusions.

Section 4 prepares the drift terms that one would use in Step 2 of the conditioning proce-
dure. Since the solution of the SDE at the end of Step 1 equals y, and the new drift should
be chosen in a way to keep the conditioned process away from y, the drift term that must
be employed in the second step of our construction leads to solutions that are linked to the
excursions of X away from y. Indeed, if y = 0 and X is a Brownian motion killed at 0, the
SDE that we obtain in Step 2 is the SDE associated to the 3-dimensional Bessel process. In
Section 4 we give the SDE characterisations of these Bessel-type motions –a term adapted
from McKean in his study of excursions of diﬀusions [12]– and prove a time reversal result
akin to those that can be found in the seminal paper of Williams [20] using a theorem due
to Nagasawa [14].

After all these preparations and the other related results of independent interest, the SDE
that is associated to the desired conditioning is constructed in Section 5. Weak uniqueness
of its solutions is proven in Theorem 5.1 and Corollary 5.2 establishes that the law of its
solutions possesses the desired bridge property using an enlargement of ﬁltration technique.
Corollary 5.2 also paves the way for a new path decomposition result for transient diﬀusions.
Theorem 5.2 is reminiscent of Williams’ path decomposition for the Brownian motion killed
at 0 and constructs the original process, X, by pasting together a recurrent transformation
and a time-reversed Bessel-type motion.

Another contribution of this paper is to the solutions of one dimensional time-homogeneous
SDEs.
In Step 2 we construct an SDE for a one-dimensional diﬀusion, where the initial
condition is an entrance boundary1. The existence and uniqueness of solutions to such
SDEs do not follow from the Engelbert-Schmidt theory, which constructs the solution from
a time-changed applied to a Brownian motion. As explained in Section 2, the reason for
the non-applicability of the available theory is due to the scale functions being inﬁnite at
entrance boundaries forcing one to start the Brownian motion at +∞ if one want to use the
method of Engelbert and Schmidt. Theorem 2.1 extends the Engelbert-Schmidt theory to
the case when the initial condition is an entrance boundary. The proof uses similar tools
employed in the proof of the classical result of Engelbert and Schmidt without the entrance
boundary. However, we construct the weak solution as a time-changed Bessel process as
opposed to a time-changed Brownian motion.

The outline of the paper is as follows. Section 2 reviews some background material on
one-dimensional diﬀusions that will be used often in the paper and gives a recipe for the
construction of the SDE to achieve our desired conditioning. Section 3 introduces the concept
of recurrent transformation and ﬁnds the drift that will be necessary to complete Step 1. The
drift term that will be used in the second step of our construction is discussed in Section 4
along with its connection to the excursions of X. Our main results on the SDE representation
of X conditioned on its local time at its lifetime and a new path decomposition result for

1In the terminology of Ito-McKean this corresponds to an entrance-not-exit boundary.

4

UMUT C¸ ETIN

transient diﬀusions are contained in Section 5. Finally, Section 6 illustrates the ﬁndings via
some speciﬁc examples.

2. Preliminaries and a recipe for the conditioning

Let X be a regular transient diﬀusion on (l, r), where −∞ ≤ l < r ≤ ∞. Such a diﬀusion
is uniquely characterised by its scale function, s, and speed measure, m, deﬁned on the
Borel subsets of the open interval (l, r). We assume that if any of the boundaries are reached
in ﬁnite time, the process is killed and sent to the cemetery state, ∆. This is the only
instance when the process can be killed, we do not allow killing inside (l, r). Consistent
with the term ‘killing’ ∆ is assumed to be an absorbing state. The set of points that can
be reached in ﬁnite time starting from the interior of (l, r) and the entrance boundaries
will be denoted by I. That is, I is the union of (l, r) with the regular, exit or entrance
boundaries. The law induced on C(R+, I), the space of I-valued continuous functions on
[0,∞), by X with X0 = x will be denoted by P x as usual, while ζ will correspond to its
lifetime. In what follows we will often replace ζ with ∞ when dealing with the limit values
of the processes as long as no confusion arises. The ﬁltration (Ft)t≥0 will correspond to the
universal completion of the natural ﬁltration of X, and therefore is right continuous. Recall
that in terms of the ﬁrst hitting times, Ty := inf{t > 0 : Xt = y} for y ∈ (l, r), the regularity
amounts to P x(Ty < ∞) > 0 whenever x and y belongs to the open interval (l, r). This
assumption entails in particular that s is strictly increasing and continuous (see Proposition
VII.3.2 in [18]), thereby possessing a left derivative, s′, on (l, r), and 0 < m((a, z) < ∞ for
all l < a < z < r (see Theorem VII3.6 and the preceding discussion in [18]).
The hypothesis that X is transient implies that at least one of s(l) and s(r) must be ﬁnite.
Since s is unique only upto an aﬃne transformation, we will assume without loss of generality
that s(l) = 0 and s(r) = 1 whenever they are ﬁnite. In view of our foregoing assumptions
one can easily deduce that Xζ− ∈ {l, r}. We refer the reader to [2] for a summary of results
and references on one-dimensional diﬀusions. The deﬁnitive treatment of such diﬀusions is,
of course, contained in [8].

As we are interested in the path transformations of local times via SDEs, we further impose
the so-called Engelbert-Schmidt conditions to ensure that X can be considered as a solution
of an SDE. That is, we shall assume the existence of measurable functions σ : (l, r) 7→ R and
b : (l, r) 7→ R such that for any x ∈ (l, r)

σ(x) > 0 and ∃ε > 0 s.t. Z x+ε

x−ε

1 + |b(y)|
σ2(y)

dy < ∞.

(2.1)

Under this assumption (see [6] or Theorem 5.5.15 in [9]) there exists a unique weak solution
(upto the exit time from the interval (l, r)) to the SDE

Xt = x +Z t

σ(Xs)dBs +Z t
where ζ = inf{t ≥ 0 : Xt− ∈ {l, r}} and l < x < r.
The Engelbert-Schmidt conditions ensure the existence and uniqueness of weak solutions
to above SDE starting from x ∈ (l, r). However, it should be noted that the results of the
Engelbert-Schmidt do not apply if the starting point is an entrance boundary since the scale

b(Xs)ds,

t < ζ,

0

0

Xt = x +Z t

0

σ(Xs)dBs +Z t

0

b(Xs)ds,

t < ζ,

(2.3)

PATH TRANSFORMATIONS FOR LOCAL TIMES OF ONE-DIMENSIONAL DIFFUSIONS

5

function is not ﬁnite at such an endpoint. The following theorem, whose proof is delegated to
the Appendix, extends this theory when x is an entrance boundary for a transient diﬀusion.
A quick glance at the proof reveals that the solution is obtained as a time and scale change
of a 3-dimensional Bessel process starting from its entrance boundary as opposed to the
standard Engelbert-Schmidt theory that constructs the solution as a time and scale change
of a Brownian motion.

Theorem 2.1. Suppose that X is a regular transient diﬀusion on (l, r) with an entrance
boundary and satisﬁes (2.1). Then there exists a unique weak solution to

Xt = x +Z t

0

σ(Xs)dBs +Z t

0

b(Xs)ds,

t < ζ,

(2.2)

where ζ = inf{t ≥ 0 : Xt− ∈ {l, r}} and x is the entrance boundary.

We summarise the assumptions on X in the following

Assumption 2.1. X is a regular transient diﬀusion on (l, r), where −∞ ≤ l < r ≤ ∞.
Moreover, whenever X0 is an entrance boundary or belongs to (l, r), X is the unique weak
solution to

where ζ = inf{t > 0 : Xt− ∈ {l, r}}, and σ : (l, r) 7→ R and b : (l, r) 7→ R satisfy (2.1) for all
x ∈ (l, r). Its scale function is chosen so that s(l) = 0 and s(r) = 1 whenever they are ﬁnite.

Observe that the condition (2.1) further implies one can take

s(x) =Z x

C

exp(cid:18)−2Z z

c

We will denote by (Lx

b(u)
σ2(u)

du(cid:19) dz and m(dx) =

dx, for some (c, C) ∈ (l, r)2.
t )x∈(l,r) the family of diﬀusion local times associated to R. Recall

s′(x)σ2(x)

2

that the occupation times formula for the diﬀusion local time is given by

From above one can easily deduce the relationship

Z t

0

f (Xs)ds =Z r

l

f (x)Lx

t m(dx).

˜Lx =

2

s′(x)

Lx,

(2.4)

where ˜Lx is the semimartingale local time of X at x, when X is a semimartingale.

Remark 1. It is clear from the above relationship that the diﬀusion local time is not invariant
under absolutely continuous changes of measures, which change the scale function. In the
sequel when we consider sets of the form [Lx
T > a], where T is a stopping time, we shall always
think of it as the set [ ˜Lx
s′(x)a ] written in terms of the semimartingale local time. Since
the semimartingale local time can be deﬁned as a limit involving the quadratic variation of X
(see Corollary VI.1.9 in [18]), which remains intact after an absolutely continuous measure
change.

T > 2

6

UMUT C¸ ETIN

Any regular transient diﬀusion on (l, r) has a ﬁnite potential density, u : (l, r)2 7→ R+,
with respect to its speed measure (see p.20 of [2]). That is, for any bounded and continuous
function, f , vanishing at accessible boundaries

U f (x) :=Z ∞

0

Ex[f (Xt)]dt =Z r

l

f (y)u(x, y)m(dy).

In the case of one-dimensional transient diﬀusions that we consider herein the distribution

of Ly

∞ is known explicitly in terms of the potential density (see p.21 of [2]). In particular,

P y(Ly

∞ > t) = exp(cid:18)−

t

u(y, y)(cid:19) .

(2.5)

Therefore, for an arbitrary starting point, x, in (l, r) and any Borel subset, E, of (l, r) we
have

P x(Ly

∞ ∈ E|Ft) = 1[Ly

t ∈E](1 − ψ(Xt, y)) +

where

1[a>Ly

t ] exp(cid:18)−

t

a − Ly
u(y, y)(cid:19) da,

(2.6)

ψ(Xt, y)

u(y, y) ZE
ψ(x, y) := P x(Ty < ∞),

in view of the strong Markov property of X.

It will also prove useful in the sequel to consider the inverse local time:

(τ y

a )a≥0 is right continuous and, moreover,

a = inf{t ≥ 0 : Ly
τ y

t > a}.

Clearly, the interval [τ y
an excursion of X from the point y.

a−, τ y

a ] corresponds to an interval of constancy for Ly or, equivalently,

τ y
a− = inf{t ≥ 0 : Ly

t ≥ a}.

When only one of s(l) and s(r) is ﬁnite, the terminal value of X equals either l or r, in
which case X∞ and Ly
∞ are trivially independent no matter where the diﬀusion has started.
If both s(l) and s(r) are ﬁnite, the situation is more delicate. The following result that
illustrates this must be well-known. We nevertheless provide a proof for the convenience of
the reader.

∞ are independent under P x if and only if x = y.

Proposition 2.1. Suppose that X is a regular transient diﬀusion on (l, r) with s(l) = 0 =
1 − s(r). Then, X∞ and Ly
Proof. Suppose that x ≤ y and observe from (2.6) that
∞ > t) = P x(Ty < ∞) exp(cid:18)−

u(y, y)(cid:19) .

P x(Ly

t

Next, consider the h-transform of X using s as the h-function to obtain a diﬀusion with
transition function

P s

t (x, dz) =

s(z)
s(x)

Pt(x, dy),

PATH TRANSFORMATIONS FOR LOCAL TIMES OF ONE-DIMENSIONAL DIFFUSIONS

7

where Pt is the original transition function of X. The resulting process corresponds to the
conditioning of X so that X∞ = r and it is a regular diﬀusion on (l, r) with the speed
measure, ms, and the potential density2 us given by (see Paragraph 31 in Chap. II of [2])

ms(dz) = s2(z)m(dz)

us(x, z) =

u(x, z)
s(x)s(z)

.

Denoting the law of the h-transform with P h,x when it starts at x, we have, in particular,

P h,x(Ly

∞ > t) = P x(Ly

∞ > t|X∞ = r).

Notice that, since the speed measure has changed, the diﬀusion local time of the h-transform
is no longer represented by Ly. Let Ls,x denote the diﬀusion local time with respect to ms
at the level x. In view of the occupation times formula and the fact that P h,x ∼ P x on Ft
one has

Z r

l

f (x)Lx

t m(dx) =Z t

0

f (Rs)ds =Z r

l

f (x)Ls,x

t s2(x)m(dx),

which yields Ly
under P x, so it does under P s,x since P s,x ≪ P x. Therefore, Ly

due to the continuity of local times. Since Ly

s2(y) = Ls,y

∞

t

t

∞ and

t converges to Ly

∞

s2(y) = Ls,y
t

s2us(y, y)(cid:19) = exp(cid:18)−

t

u(y, y)(cid:19) ,

P x(Ly

∞ > t|X∞ = r) = P h,x(cid:18)Ls,y

s2(y)(cid:19) = exp(cid:18)−
since P s,x(Ty < ∞) = 1 due to the conditioning. Thus,

∞ >

t

P x(Ly

∞ > t|X∞ = r) = P x(Ly

∞ > t)

if and only if x = y. The case x ≥ y is handled similarly by conditioning on [X∞ = l] using
the h-function 1 − s.

(cid:3)

Note that if s(l) = 0 = 1 − s(r), then P x(X∞ = r) = s(r) and

ψ(x, y) =( s(x)

s(y) , y ≥ x;
1−s(x)
1−s(y) , y < x.

u(x, y) = s(x)(1 − s(y)), x ≤ y.

(2.7)

On the other hand, if s(l) = 0 and s(r) = ∞, then Xt → l, P x-a.s. for any x ∈ (l, r), which
in turn implies

ψ(x, y) =(cid:26) s(x)

s(y) , y ≥ x;
1, y < x.

u(x, y) = s(x), x ≤ y.

Similarly, if s(l) = −∞ and s(r) = 1, then Xt → r, P x-a.s. for any x ∈ (l, r), and

ψ(x, y) =(cid:26)

1, y ≥ x;
1−s(x)
1−s(y) , y < x.

u(x, y) = 1 − s(y), x ≤ y.

For later purposes we also deﬁne

ρ(y) := P y(X∞ = r).

2Note that this is the density with respect to the new speed measure mh.

(2.8)

(2.9)

(2.10)

8

UMUT C¸ ETIN

We are interested in conditioning X so that Ly
∞ = a for some given a > 0. As any such
conditioning will make sure that X ﬁrst hits y, we will assume X0 = y to ease the exposition.
Formally, the construction of the conditioned process should be achieved in two steps: 1)
make sure that X keeps hitting y before Ly reaches a and 2) as soon as Ly becomes a never
let X hit y again.

In order to achieve the ﬁrst step we need to change the behaviour of X in such a way
that the process is recurrent. Indeed, if X is still transient after some transformation, there
will be a positive probably that it will drift towards one of its endpoints before Ly becomes
a. In Section 3 we will introduce the concept of a recurrent transformation and consider a
particular example which allows us to complete the ﬁrst step of our conditioning.

a−. Since Xτ y

The second step in our recipe is to prevent X from hitting y after τ y

a− < ∞], this means that we need to keep X above or below y after τ y

= y,
on [τ y
a−. Recall
that we are not merely interested in creating a process with the property that Ly
∞ = a,
but a conditioned version of X whose law coincides with the regular conditional probability
P y(·|Ly
∞ = a). This necessitates, in particular, that the conditioned process should also
have the same set of possible values for its limiting value. If s(l) = 0 and s(r) = ∞ (resp.
s(l) = −∞ and s(r) = 1), our task is relatively simple: keep X below (resp. above) y at all
times after τ y
On the other hand, if s(l) = 0 = 1 − s(r), the original process could drift towards r as
well as l. As we are only conditioning on Ly
∞ and not on X∞, we will have to appropriately
randomise the coeﬃcients of the SDE for the bridge process to allow our solution have l and
r as possible limit points. In Section 4 we study the Bessel-type SDEs with appropriate drifts
that will allow us to complete the second step, discuss its connection with the excursions
of X, and present a time reversal connection. Finally, the SDE that achieves our desired
conditioning with randomised drifts is constructed in Section 5.

a−.

a−

3. Recurrent transformations and Step 1

The ﬁrst step towards our desired conditioning requires us transform X into a recurrent
diﬀusion. To wit, suppose h is a non-negative C 2-function and M an adapted continuous
process of ﬁnite variation so that h(X)M is a non-negative local martingale. Thus, by
stopping at its localising sequence and using Girsanov’s theorem we arrive at a weak solution,
up to a stopping time, of the following equation for any given y ∈ (l, r) taking values in (l, r):
(3.11)

h′(Xs)

0 (cid:26)b(Xs) + σ2(Xs)

h(Xs)(cid:27) ds.

We can associate to this SDE the scale function

Xt = y +Z t

0

σ(Xs)dBs +Z t
rs(x) :=Z x

s′(y)
h2(y)

c

dy,

x ∈ (l, r)

(3.12)

provided that the integral is ﬁnite for all x ∈ (l, r), which, in particular, requires h > 0 on
(l, r). This will allow us to deduce the existence of a solution to (3.11) until the ﬁrst exit
time from (l, r). If, in addition, −rs(l+) = rs(r−) = ∞, the solution will be recurrent and
never exit (l.r) (see Proposition 5.5.22 in [9]).

PATH TRANSFORMATIONS FOR LOCAL TIMES OF ONE-DIMENSIONAL DIFFUSIONS

9

Remark 2. It has to be noted that the notion of recurrence that we consider for one-
dimensional diﬀusions excludes some recurrent solutions of one-dimensional SDEs with time-
homogeneous coeﬃcients since we kill our diﬀusion as soon as it reaches a boundary point. A
notable example is a squared Bessel process with dimension δ < 2, which solves the following
SDE:

Xt = y + 2Z t

0 pXsdBs + δt.

The above SDE has a global strong solution, i.e. solution for all t ≥ 0, which is recurrent (see
Section XI.1 of [18]). However, the point 0 is reached a.s. and is instantaneously reﬂecting
by Proposition XI.1.5 in [18]. As such, it violates our assumption of a diﬀusion being killed
at a regular boundary. According to this assumption, a squared Bessel process of dimension
0 < δ < 2 is killed as soon as it reaches 0 and, thus, is a transient diﬀusion.

Using h and M to get a recurrent process imposes some boundary conditions on h. Indeed,
if s(l) = 0 (resp. s(r) = 1), in order to have rs(l+) = −∞ (resp. rs(r−) = ∞), we must
have limx→l h(x) = 0 (resp. limx→r h(x) = 0).
Ah(Xt)
h(Xt) dt. Thus, M is a multi-

plicative functional3 given by

Moreover, since h(Xt)Mt is a local martingale, dMt = −Mt
ds(cid:19) .

Mt = exp(cid:18)−Z t

Ah(Xs)
h(Xs)

0

In the light of the above discussion we now introduce the concept of a recurrent transfor-

mation of a diﬀusion.

Deﬁnition 3.1. Let X be a regular transient diﬀusion satisfying Assumption 2.1 and h :
(l, r) 7→ (0,∞) be a continuous function such that the limits h(l+) := limx→l h(x) and
h(r−) := limx→r h(x) exists. Then, (h, M) is said to be a recurrent transform (of X) if the
following are satisﬁed:

(1) M is an adapted process of ﬁnite variation.
(2) h(X)M is a nonnegative local martingale.
(3) The function rs from (3.12) is ﬁnite for all x ∈ (l, r) with −rs(l+) = rs(r−) = ∞.
(4) There exists a unique weak solution to (3.11) for t ≥ 0.
In the above deﬁnition, the deﬁning condition for a recurrent transformation is the function
rs and its explosive nature near the boundaries. The function h and the multiplicative
funtional M come into play when one wants to construct a weak solution of the SDE (3.11)
and show that the law of its solution is locally absolutely continuous with respect to that of
the original process X, which satisﬁes (2.3), as in Proposition 3.1.
Theorem 3.1. Let h : (l, r) 7→ (0,∞) be an absolutely continuous function such that its left
derivative, h′, s of ﬁnite variation. Suppose further that the mapping rs given by (3.12) is
ﬁnite for all x ∈ (l, r) and that −rs(l+) = rs(r−) = ∞. Then, the following statements are
valid.

3See Section 1 of Chapter III and the rest in [1] for a deﬁnition and properties. We will not need any

further properties of multiplicative functionals in this paper.

10

UMUT C¸ ETIN

(1) h′ admists the decomposition dh′(x) = h′′(x)dx + n(dx), where n is a locally ﬁnite

signed measure on (l, r) that is singular with respect to the Lebesgue measure.

(2) The integral

1[t<ζ](cid:18)Z t

0 |Ah(Xs)| ds +Z r
for every y ∈ (l, r), where Ah = σ2(x)

l

Lx
t

1

s′(x)|n(dx)|(cid:19) < ∞, P y-a.s.,

2 h′′(x) + b(x)h′(x) with an abuse of notation.

(3) (h, M) is a recurrent transform, where, on [t < ζ],

Mt

Λt(h)

:= exp(cid:18)−Z t
:= Z r

0
1

Lx
t

s′(x)

l

Ah(Xs)
h(Xs)

ds −Z t

0

1

h(Xs)

dΛs(h)(cid:19) and

n(dx).

(4) Let Rh,y be the law of the solution of (3.11) and Γ ∈ FT for some (Ft)-stopping time,

T , such that h(X T )M T is a uniformly integrable P y-martingale. Then,

Rh,y(Γ) =

1

h(y)

Ey [1Γh(XT )MT ] .

(3.13)

Proof.

(1) The decomposition follows from Theorem 0.4.4 in [18].

(2) Observe that, in view of occupation times formula, the integral on [t < ζ] equals

l

Z r
= Z r

l

(cid:12)(cid:12)(cid:12)(cid:12)
(cid:12)(cid:12)(cid:12)(cid:12)

σ2(x)

2

h′′(x) +

h′′(x) + b(x)h′(x)(cid:12)(cid:12)(cid:12)(cid:12)
h′(x)(cid:12)(cid:12)(cid:12)(cid:12)

2b(x)
σ2(x)

Lx
t

Lx
t

1

s′(x)

1
s′(x)|n(dx)|

2

s′(x)σ2(x)

dx +Z r

l

Lx
t

dx +Z r
1
s′(x)|n(dx)|

Lx
t

l

Due to the continuity of X, on [t < ζ] and on almost every path Lx
t would be equal
to 0 for all x outside a compact interval in (l, r) determined by the maximum and
the minimum of X on [0, t]. Moreover, due to the continuity of x 7→ Lx
t , it suﬃces to
check

dx +ZK

1
s′(x)|n(dx)| < ∞

(3.14)

for an arbitrary compact K contained in (l, r). First note that

h′′(x) +

2b(x)
σ2(x)

ZK(cid:12)(cid:12)(cid:12)(cid:12)

1

s′(x)

h′(x)(cid:12)(cid:12)(cid:12)(cid:12)
dx +ZK

1

s′(x)

ZK |h′′(x)|

1
s′(x)|n(dx)| < ∞

since h′ is of ﬁnite variation and s′ is continuous and strictly positive on (l, r).

Moreover,

2b(x)
σ2(x)

ZK(cid:12)(cid:12)(cid:12)(cid:12)

dx = C +ZK(cid:18)Z y

dx(cid:19)|dh′(y)|,
c (cid:12)(cid:12)(cid:12)
for some C < ∞ and c ∈ K due to the ﬁniteness of h′ and R y

dx at the
boundary of K. However, the integral in the above representation is ﬁnite since dh′

σ2(x)(cid:12)(cid:12)(cid:12)(cid:12)

h′(x)(cid:12)(cid:12)(cid:12)(cid:12)

σ2(x)(cid:12)(cid:12)(cid:12)

2b(x)

(cid:12)(cid:12)(cid:12)(cid:12)

2b(x)

c

PATH TRANSFORMATIONS FOR LOCAL TIMES OF ONE-DIMENSIONAL DIFFUSIONS

11

dx is bounded in K. This completes the proof that

c (cid:12)(cid:12)(cid:12)
is of ﬁnite variation andR y

2b(x)

σ2(x)(cid:12)(cid:12)(cid:12)

(3.14) holds for an arbitrary compact set K, which in turn yields the claim.

(3) It follows from the previous part that Λ(h) is of ﬁnite variation. Since (h(Xs)s≤t
is away from 0, path by path, for t < ζ, it immediately follows that M is of ﬁnite
variation, too.

Since h can be considered as a diﬀerence of convex functions, it follows from Ito-

Tanaka formula that on [t < ζ]

h(Xt) = h(y) +Z t

0

h′(Xs)dXs +

0

1

h′(Xs)dXs +

= Z t
2Z t
h(Xt)Mt = h(y) +Z t

0

0

l

1

2Z r
σ2(Xs)h′′(Xs)ds +Z r

˜Lx
t {h′′(x)dx + n(dx)}
Lx 1
s′(x)

l

n(dx).

h′(Xs)Msσ(Xs)dBs,

t < ζ,

Thus, a simple application of integration by parts formula yields

proving the local martingale property for h(X)M. In particular, h(X)M is a contin-
uous non-negative supermartingale with an integrable limit as t → ζ.
exists a unique weak solution to (3.11).

Finally, due to the hypotheses on rs it follows from Theorem 5.5.15 in [9] that there

(4) Since h(X)ST M T is a uniformly integrable martingale under P y, we deduce from

Girsanov’s theorem and the uniqueness in law of the solutions of (3.11) that

Rh,y (Γ) =

1

h(y)

Ey [1Γh(XT )MT ] .

(cid:3)

Example 3.1. Suppose δ > 2 and consider a δ-dimensional Bessel process on (0,∞), i.e. a
one-dimensional diﬀusion with the dynamics

dXt = 2pXtdBt + δdt.

2−δ

2 . Thus, X is transient and approaches to ∞

2−δ

Let h(x) := x

The scale function is given by s(x) = 1 − x
as t → ∞, while 0 is an inaccessible boundary.
Z t
Mt := exp(cid:18)(δ − 2)2

4 and deﬁne

8

0

1
Xs

ds(cid:19) ,

t ≥ 0.

Then, it follows from Theorem 3.1 that M is of ﬁnite variation and h(X)M is a local mar-
tingale. Moreover,

rs(x) =

2 Z x
δ − 2

1

1
u

du = log x,

x > 0.

Thus, −rs(0) = rs(∞) = ∞, and we conclude that (h, M) is a recurrent transform by
invoking Theorem 3.1 again. The transformation yields the following SDE for the resulting

12

process

UMUT C¸ ETIN

which is the SDE for a 2-dimensional squared Bessel process. Recall (or see p.442 of [18])
that 0 is polar for a 2-dimensional squared Bessel process.

dXt = 2pXtdBt + 2dt,

The following proposition gives another example of a recurrent transform, which will let

us achieve the ﬁrst step of our desired conditioning.

Proposition 3.1. Consider the pair (h, M) deﬁned by

h(x) := u(x, y), x ∈ (l, r), and Mt = exp(cid:18) Ly

u(y, y)(cid:19) .

t

Then, the following hold:

(1) (h, M) is a recurrent transform for X.
(2) There exists a unique weak solution to

Xt = y +Z t

0

σ(Xs)dBs +Z t

0 (cid:26)b(Xs) + σ2(Xs)

ux(Xs, y)

u(Xs, y) (cid:27) ds,

t ≥ 0,

(3.15)

where ux denotes the ﬁrst partial left derivative of u(x, y) with respect to x.

(3) Moreover, if Rh,y denotes the law of the solution, then, for all a > 0, we have4

Rh,y(Ly

∞ ≥ a) = Rh,y(τ y
dRh,y

a− < ∞) = 1 and

= exp(cid:18) a

u(y, y)(cid:19) 1[τ y

a−<ζ].

dP y (cid:12)(cid:12)F

τ

y
a−

(3.16)

Proof.

(1) It follows from (2.7)-(2.9) that x 7→ u(x, y) is absolutely continuous and its

left derivative is of ﬁnite variation. In particular,
n(dx) = −s′(y)εy,

where εy is the dirac measure at point y. This further implies Λt(h) = −Ly
Ah vanishes, Theorem 3.1 suggests we deﬁne

t . Since

Mt = exp(cid:18)Z t

0

1

u(Xs, y)

dLy

s(cid:19) = exp(cid:18) 1

u(y, y)

Ly

t(cid:19) ,

where the last equality is due to the fact that the support of dLy is carried by the
set {t : Xt = y}.

Next, consider the function

rs(x) =Z x

y

s′(z)

u2(z, y)

dz,

and suppose, ﬁrst, that s(l) = 1 − s(r) = 0. Then, for x < y,
(1 − s(y))2(cid:18) 1
s(y) −

(1 − s(y))2Z x

s′(z)
s2(z)

rs(x) =

dz =

1

1

y

1

s(x)(cid:19) ,

4Recall Remark 1 for the interpretation of τ y

a− under Rh,y.

PATH TRANSFORMATIONS FOR LOCAL TIMES OF ONE-DIMENSIONAL DIFFUSIONS

13

which in particular shows that limx→l rs(x) = −∞. Similarly, for x > y,
1 − s(y)(cid:19) ,

s2(y))Z x

1 − s(x) −

s2(y)(cid:18)

(1 − s(z))2

rs(x) =

s′(z)

dz =

1

1

1

1

y

and, thus, sr(∞) = ∞. The other cases are handled the same way to show −rs(l) =
rs(r) = ∞. This completes the proof of that (h, M) is a recurrent transform via
Theorem 3.1.
(2) This follows from the previous part and the deﬁnition of a recurrent transformation.
(3) Observe that h(X τ y
a− is a bounded martingale. Thus, it follows from (3.13)

a−)M τ y

that

Rh,y(τ y

a− < ∞) =

a−<∞]u(Xτ y

a−

, y) exp  Ly

u(y, y)!#

τ y
a−

1

u(y, y)

Ey"1[τ y
u(y, y)(cid:19) P y(τ y

= exp(cid:18) a

a− < ζ),

where the last equality is due to the fact that Xτ y
of X and of Ly. On the other hand,

a−

= y and Ly
τ y
a−

= a by the continuity

P y(τ y

a− < ζ) = P y(Ly

u(y, y)(cid:19)
in view of (2.5). This shows that Rh,y(τ y
a− < ∞) = Rh,y(Ly
(3.13) once more yields the desired absolute continuity on Fτ y

∞ ≥ a) = exp(cid:18)−

a

.

a−

∞ ≥ a) = 1. Applying

(cid:3)

Remark 3. It is trivial to check that (h, M)-recurrent transform of X has h2dm as its speed
measure. In the speciﬁc case considered in the above proposition the recurrent transform is
a one-dimensional diﬀusion with scale

rs(x) =Z x

c

s′(z)

u2(z, y)

dz

and the speed measure u2(z, y)m(dz). Note that this is not the only diﬀusion with this
scale function and the speed measure. Indeed, if one considers the h-transform of X via
h(x) = u(x, y), one obtains a diﬀusion which amounts to conditioning the paths of X to
converge to y and killed at its last exit from y. The resulting diﬀusion is obviously a transient
diﬀusion but has the same scale and the speed (see, e.g. Theorem 6.2 in [7] or Paragraph 31
in [2]). The crucial diﬀerence between the two transformations is that one involves killing.
More precisely, the h-transform has a killing measure

kh(dz) = u(y, y)εy,

where εy is the point mass at y (see, again, Theorem 6.2 in [7] or Paragraph 31 in [2]), while
the killing measure for the recurrent transform is null.

14

UMUT C¸ ETIN

Killing of the trajectories in the h-transform is also apparent from the following relationship

between the measures:

Eh,x[F ] =

Ex[F u(Xt, y)]

u(x, y)

= Ex(cid:2)F 1[Gy>t](cid:3) .

In the above F is an Ft-measurable random variable, Gy = sup{t : Xt = y}, and Eh,x is the
expectation operator with respect to the law of the h-transform (see Section 3.9 in [11] for
more details) started at x. The above identity in particular implies

i.e., P h,x-distribution of ζ coincides with the law of Gy under P x.

P h,x(ζ > t) = P x(Gy > t), ∀t ≥ 0,

Given this close relationship between the recurrent transform and the h-transform one may
wonder whether it is possible to obtain the latter from the former via a killing. This is in
fact possible. All we have to do is to kill R at some random time with distribution equalling
to that of Gy and at which R equals y.

To this end let τ y

a be the right continuous inverse of the diﬀusion local time of R at level

y. Then,

Rh,x exp (−λτ y

a ) = exp(cid:18)−
= exp(cid:18)−

a

R(y, y)(cid:19) Rh,x exp (−λTy)
R(y, y)(cid:19) u(y, y)Ex exp (−λTy) ,

a

uλ

uλ

where uλ

R is the λ-potential kernel for R with respect to u2(z, y)m(dz) given by

uλ
R(z, y) =

uλ(z, y)

u(z, y)u(y, y)

and uλ is the λ-potential kernel for X with respect to m. The ﬁrst equality in above follows
from the strong Markov property of R and p.22 of [2], while the second is a consequence of
(3.13). Moreover, (see Theorem 3.6.5 in [11])

implying

Ex exp (−λTy) =

uλ(x, y)
uλ(y, y)

Rh,x exp (−λτ y

a ) = exp(cid:18)−

au2(y, y)

uλ(y, y) (cid:19) uλ(x, y)u(y, y)

uλ(y, y)

On the other hand, expression (54) in [17] gives

.

(3.17)

Ex exp (−λGy) =

uλ(x, y)
u(y, y)

.

(3.18)

Thus, if α is an independent “random variable” with a uniform distribution over (0,∞), it
follows from (3.17) that τ y

α has the Laplace transform given by

uλ(x, y)u(y, y)

uλ(y, y)

Z ∞

0

exp(cid:18)−

au2(y, y)

uλ(y, y) (cid:19) da =

uλ(x, y)
u(y, y)

,

PATH TRANSFORMATIONS FOR LOCAL TIMES OF ONE-DIMENSIONAL DIFFUSIONS

15

which coincides with (3.18). Moreover, Rτ y
α = y. Thus, the h-transform of X with the
minimal excessive function h(x) = u(x, y) can be obtained by killing the (u(·, y), M)-recurrent
transform of X at τ y
α.

Remark 4. The procedure at the end of the previous remark gives us a way to simulate
the last passage time of a transient diﬀusion as a mixture of ﬁrst hitting times of a related
diﬀusion, which might prove to be useful for numerical studies especially when the potential
kernels are not known explicitly.

Proposition 3.1 tells us what to do in our ﬁrst step: We run the (h, M)-recurrent trans-

formation given in the proposition until τ y

a−, which is ﬁnite with probability 1. That is,

a−

a−

Xt∧τ y

σ(Xs)dBs +Z t∧τ y
Recall that [τ y
∞ ≥ a]. Thus, the above makes sure that the conditioned process
will have its local time at y being at least equal to a in the limit. It now remains to make
sure that the process never visits y after τ y
a−

= y +Z t∧τ y
a− < ∞] = [Ly

(cid:26)b(Xs) + σ2(Xs)

ux(Xs, y)

u(Xs, y) (cid:27) ds.

a−

0

0

4. Bessel-type motions and Step 2

Recall that the second step of our recipe is to keep X away from y after τ y

a−. As one can
guess this can be achieved by conditioning X never hit y using an h-transform. The next
proposition make this idea rigorous and gives us the candidate drifts that ensure X has the
prescribed limit while avoiding y at the same time.

Proposition 4.1. Let X be a regular diﬀusion satisfying Assumption 2.1.

(1) Suppose s(l) = 0. There exists a regular diﬀusion on (l, y) with the scale function sl

and the speed measure, ml, deﬁned by

sl(x) :=

s(y) − s(x)

,

ml(dx) := (s(y) − s(x))2m(dx).

y is an entrance boundary for this diﬀusion, which is also the unique weak solution
to

Rt = x +Z t

0

σ(Rs)dBs +Z t

0 (cid:26)b(Rs) −

s′(Rs)σ2(Rs)

s(y) − s(Rs)(cid:27) ds,

t < ζ,

(4.19)

1

1

where x ∈ (l, y] and ζ = inf{t ≥ 0 : Rt− = l}. Moreover, limt→∞ Rt = l, Qx,0-a.s.,
where Qx,0 is the law of the weak solution to the SDE above.
(2) Suppose s(r) = 1. There exists a regular diﬀusion on (y, r) with the scale function sr

and the speed measure, mr, deﬁned by

sr(x) :=

s(y) − s(x)

,

mr(dx) := (s(y) − s(x))2m(dx).

y is an entrance boundary for this diﬀusion, which is also the unique weak solution
to

Rt = x +Z t

0

σ(Rs)dBs +Z t

0 (cid:26)b(Rs) +

s′(Rs)σ2(Rs)

s(Rs) − s(y)(cid:27) ds,

t < ζ,

(4.20)

16

UMUT C¸ ETIN

where x ∈ [y, r) and ζ = inf{t ≥ 0 : Rt− = r}. Moreover, limt→∞ Rt = r, Qx,1-a.s.,
where Qx,1 is the law of the weak solution to the SDE above.

Proof. We will only prove the proposition in case (1), the proof of the second part follows
identical steps.

Clearly, sl is strictly increasing and continuous since s′ > 0 on (l, y). Moreover, it can be
directly checked that 0 < ml((a, z)) < ∞ for l < a < z < y using the analogous property
for m and the fact that s is strictly increasing. Thus, we can associate a regular diﬀusion to
(sl, ml). To see that y is an entrance boundary, observe that for l < z < y

Z y
Indeed, since sl(y−) = ∞,

z

(sl(a) − sl(z))(s(y) − s(a))2m(da) < ∞.

lim
a→y

sl(a) − sl(z)
(s(y) − s(a))−2 =

1
2

lim
a→y

(s(y)−s(a))2

s′(a)(s(y) − s(a))−3 = 0,

s′(a)

implying the ﬁniteness of the above integral near y due to the fact that y belongs to the
interior of the state space of the regular diﬀusion with scale s and speed m. Finiteness of
the integral near z follows from the boundedness of sl and s on the compact subsets of (l, y)
and the ﬁniteness of m in the interior of (l, r).

In order to conclude y is an entrance boundary, we also need to verify that

The above integral, indeed, diverges since ml((z, y)) > 0, and

Z y

z

ml((z, a))

s′(a)

(s(y) − s(a))2

da = ∞.

for any z′ such that z < z′ < y.

Z y

z ′

s′(a)

(s(y) − s(a))2

da = ∞

In order to show the weak existence and uniqueness of solutions to (4.19) with x ∈ (l, y),
we will again make use of the Engelbert-Schmidt criteria analogous to (2.1). Observe that
in view of our assumption on σ and b, all that we need to check is the local integrability of
s(y)−s .

s′

Indeed, for any (x, z) such that l < x < z < y

Z z

x

s′(u)

s(y) − s(u)

du = log

s(y) − s(z)
s(y) − s(x)

< ∞.

The existence and uniqueness of a weak solution when the starting point is y, i.e. the

entrance boundary, follows from Theorem 2.1.

Finally, the limit as t → ∞ follows from the fact that sl(l) < ∞ while sl(y) = ∞ (see

(cid:3)

Proposition 5.5.22 in [9]).

We will next prove a result which shows that the processes obtained above can be consid-
ered as the analogues of 3-dimensional Bessel process, which is the killed Brownian motion
on (0,∞) conditioned to converge to ∞. As such, they deﬁne the entrance laws for the ex-
cursions of the original process, X, away from y as shown by Pitman and Yor (see Section 3

PATH TRANSFORMATIONS FOR LOCAL TIMES OF ONE-DIMENSIONAL DIFFUSIONS

17

of [16]) and can be considered as an excursion of X away from y conditioned to last forever.
Moreover, a time reversal relationship exists between the solutions of (4.19) and those of
(2.3) stopped at y akin to the one between the 3-dimensional Bessel process and the killed
Brownian motion established by Williams [20]. This relationship will be proved by a time
reversal result of Nagasawa [14]. The following version of this result is taken from Sharpe
[19].

Theorem 4.1 (Nagasawa [14]). Let X and ˆX be standard Markov processes in duality on
their common state space with respect to a σ-ﬁnite measure, ξ. Let u(x, y) denote the potential
kernel density with respect to ξ so that for any positive and measurable f

Let G be a co-optional time and deﬁne

ExZ ∞

0

f (Xt)dt =Z u(x, z)f (z)ξ(dz).
on [G < ∞] if 0 < t < G;
otherwise.

˜Xt =(cid:26) X(G−t)−,

∆,

Fix an initial law λ and let v(x) = R u(x, z)λ(dz). Then, under P λ, the process ˜X is a

homogeneous Markov process with transition semigroup, ( ˜Pt) deﬁned by

˜Ptf (x) =(cid:26) Ptf v(x)

v(x)

0,

,

if 0 < v(x) < ∞;
otherwise.

Now, we can state and prove the results announced in the paragraph preceding the above

theorem.
Proposition 4.2. Let X be a regular diﬀusion satisﬁying Assumption 2.1, y ∈ (l, r), and
denote by X 0 (resp. X 1) the killed diﬀusion process on (l, y) (resp. (y, r)) with the scale
function s and the speed measure m.5

(1) Suppose s(l) = 0 (resp. (s(r) = 1). Then, for any bounded and measurable f and

x 6= y

Q0

t f (x) =

where (Q0
t )t≥0 (resp. (Q1
(resp. (4.20)) while (P 0
X 1).

P 0
t f (s(y) − s)(x)
s(y) − s(x)

(cid:18)resp. Q1

t f (x) =

P 1
s(x) − s(y) (cid:19) ,
t f (s − s(y))(x)

t )t≥0) is the semigroup associated to the solutions of (4.19)
t )t≥0 (resp.(P 1
t )t≥0) is the transition semigroup of X 0 (resp.

(2) Let R be the solution of (4.19) (resp. (4.20)) with x = y. Pick a z ∈ (l, y) (resp.

z ∈ (y, r)) and deﬁne the last passage time

Next, let Y be the diﬀusion on (l, y) (resp. (y, r)) obtained by conditioning X 0 (resp.
X 1) converge to y with Y0 = z. Then, the processes

Gz := sup{t : Rt = z}.

{RGz −t, 0 < t < Gy} and {Yt, 0 < t < Sy}

5These are simply the solutions of (2.3) killed when they reach y or one of l and r

18

UMUT C¸ ETIN

have the same law, where

In particular, Gz and Sy are ﬁnite and have the same distribution.

Sy = inf{t : Yt = y}.

Proof. We will only prove the above result when s(l) = 0. The other case is handled in the
same way.

(1) Suppose x < y and consider the martingale (s(y) − s(Xt∧Ty ), where X is a solution
of (2.3) with X0 = x, and Ty is the ﬁrst passage time of y by X. Then, Girsanov’s
theorem in conjunction with the weak uniqueness of solutions of (4.19) yields

Q0

t f (x) =

Ex(cid:2)f (Xt)(cid:0)s(y) − s(Xt∧Ty )(cid:1)(cid:3)

s(y) − s(x)

=

Ex(cid:2)f (Xt) (s(y) − s(Xt)) 1[t<Ty]))(cid:3)

s(y) − s(x)

,

which establishes the identity for x < y.

(2) Since (Q0

t ) is the semigroup of R, it is self-dual with respect to ml.

Its potential

kernel with respect to ml is symmetric and is given by

ul(x, z) = sl(x) − sl(l) =

s(x)

s(y)(s(y) − s(x))

,

x ≤ z,

since sl(y) = ∞ (see the beginning of p.20 in [2]). Next, deﬁne

where εy is the point mass at y. Since Gz is a Qy,0-a.s. ﬁnite co-optional time,
Theorem 4.1 yields that, under Qy,0, the transition semigroup of the time-reversed
process, (RGz −t)0<t<Gz , is given by

˜Ptf (x) =

Q0

t f v(x)
v(x)

.

On the other hand, it follows from part (1) that
P 0
t f v(s(y) − s)(x)
v(x)(s(y) − s(x))

t f v(x)
v(x)

Q0

=

=

which establishes the claims.

P 0

t f s(x)
s(x)

,

(cid:3)

In view of the above proposition and following the footsteps of McKean [12], any solution

of (4.19) (resp. (4.20)) will be called a Bessel-type motion with law Qx,0 (resp. Qx,1).

5. Main results and their proofs

We are now ready to prove our main results. In what follows the inverse local time should

be interpreted in terms of the semimartingale local time as explained in Remark 1.

v(x) :=Z r

l

ul(x, z)εy(dz) = ul(x, y) =

s(x)

s(y)(s(y) − s(x))

,

PATH TRANSFORMATIONS FOR LOCAL TIMES OF ONE-DIMENSIONAL DIFFUSIONS

19

Theorem 5.1. There exists a ﬁltered probability space, (Ω,G, (Gt)t≥0, P L,a), which contains
a Bernoulli random variable, θ, with6 P L,a(θ = 1) = ρ(y) = 1 − P L,a(θ = 0) and the
adapted pair (X, B) such that (Gt)t≥0 is right-continuous, B is a standard Brownian motion
independent of θ, and X satisﬁes
Xt = y +Z t
+Z t

b(Xs)ds +Z t∧τ y
s(Xs) − s(y) − (1 − θ)1[Xs<y]

σ(Xs)dBs +Z t
σ2(Xs)(cid:26)θ1[Xs>y]

s(y) − s(Xs)(cid:27) ds,

ux(Xs, y)
u(Xs, y)

σ2(Xs)

s′(Xs)

s′(Xs)

(5.21)

t < ζ.

t∧τ y

ds

a−

a−

0

0

0

Moreover, weak uniqueness holds for the solutions of the above SDE. The law induced by its
solutions, denoted by P L,a with a slight abuse of notation, on C(R+, I) satisﬁes the following
properties:

dowed with the locally uniform topology.

(1) The mapping a 7→ P L,a(E) is measurable for any Borel subset, E, of C(R+, I) en-
(2) There exists a ﬁltered probability space, ( ˜Ω, ˜G, ( ˜Gt)t≥0, P L,g), which contains a Bernoulli
random variable, θ, with P L,g(θ = 1) = ρ(y) = 1 − P L,g(θ = 0), another R++-valued
random variable Γ with distribution g, and the adapted pair (X, B) such that i) ( ˜Gt)t≥0
is right-continuous; ii) B is a standard Brownian motion; iii) B, θ and Γ are mutually
independent; and iv) X solves

Xt = y +Z t
+Z t

t∧τ y

0

Γ−

Γ−

σ(Xs)dBs +Z t
σ2(Xs)(cid:26)θ1[Xs>y]

σ2(Xs)

b(Xs)ds +Z t∧τ y
s(Xs) − s(y) − (1 − θ)1[Xs<y]

s′(Xs)

ux(Xs, y)
u(Xs, y)

0

0

ds

s′(Xs)

s(y) − s(Xs)(cid:27) ds,

(5.22)

t < ζ.

Similarly, the uniqueness in law holds for the solutions of the above SDE with prop-
erties i)-iv). Furthermore, denoting the law of its solutions by P L,g, we have the
following disintegration formula:

(3) P L,a(Ly

∞ = a) = P L,g(Ly

∞ = Γ) = 1.

P L,g =Z ∞

0

g(da)P L,a.

(5.23)

Proof. A weak solution can be constructed by the time-change method of Engelbert-Schmidt
ﬁrst applied to a Brownian motion until τ y
a− and then to a 3-dimensional Bessel process. The
uniqueness in law can be shown by the same argument employed in the proof of Theorem
2.1. The claim on the existence and the uniqueness of the SDE is basically a combination
of Propositions 3.1 and 4.1.

(1) Note that it suﬃces to show

a 7→ P L.a(Xti ∈ Ei; i = 1, . . . , n)

is measurable for any n, where 0 < t1 < . . . < tn are arbitrary positive real numbers
and Ei is an interval contained in I.

6See (2.10) for the deﬁnition of ρ.

20

UMUT C¸ ETIN

a− is measurable due to the monotonicity of τ y

Let J := min{i : ti ≥ τ y
since a 7→ τ y
P L.a(Xti ∈ Ei; i = 1, . . . , n) = Eh,yh1[Xt1 ∈E1] . . . 1[XtJ −1

∈EJ −1]π(τ y

a−, J, θ)i ,

a−} and observe that J depends on a in a measurable way

a in a. Then,

where Eh,y is expectation with respect to Rh,y, which is the law of the solutions of
(3.15), and

π(t, j, θ) = Qy,θ(X(tj −t)+ ∈ Ej, X(tj+1−t)+ ∈ Ej+1, . . . , X(tn−t)+ ∈ En),

with Qy,θ being the law of (4.19) or (4.20) depending on the value of θ. Now, since
θ is independent of B and Rh,y is absolutely continuous with respect to P y with

dRh,y

dP y = exp(cid:18) a

u(y, y)(cid:19) 1[τ y

a−<ζ],

as given by Proposition 3.1, the claim follows.

(2) Existence follows from constructing the solution on the product space C(R+, I)× R+.
We can construct the probability space on Ω × R+ by considering the product σ-
algebras generated by the measurable rectangles and the product measure, P L, ob-
tained as the product of P L,a and g, which in particular obeys the disintegration
formula. This probability space is then endowed with the natural ﬁltration of the
co-ordinate process augmented with the universal null-sets to yield a right-continuous
ﬁltration. This ensures the existence of a solution with the given properties. Unique-
ness in law follows from the same time-change method of Engelbert-Schmidt applied,
e.g. in Theorem 2.1, previously.

(3) This follows from the construction since Ly
τ y
a−

= a and R does not visit y after τ y

a−.

The following corollary establishes the connection between the solutions of (5.21) and
(5.22) and the Doob-Meyer decomposition of the solutions of (2.3) when the underlying
ﬁltration is enlarged with Ly

∞.

(cid:3)

∞). Then,

Corollary 5.1. Let X be a regular diﬀusion satisfying Assumption 2.1 and (Ω,G, (Gt)t≥0, P )
be a ﬁltered probability space in which it solves (2.3) with X0 = y. Consider the ﬁltration
(Ht)t≥0, where Ht = Gt ∨ σ(Ly
Xt = y +Z t
+Z t

b(Xs)ds +Z t∧τ y

σ(Xs)dβs +Z t

ux(Xs, y)
u(Xs, y)

s(Xs) − s(y)

σ2(Xs)

σ2(Xs)

s′(Xs)

ds,

t < ζ,

(5.24)

t∧τ y

Γ−

ds

Γ−

0

0

0

where Γ := Ly

∞ and β is an (Ht)t≥0-Brownian motion stopped at ζ.

In particular, X is a weak solution of (5.22), where Γ = Ly

∞, g(da) = 1

u(y,y) exp(cid:16)− a

u(y,y)(cid:17) da,

and θ = 1[R∞=r].

PATH TRANSFORMATIONS FOR LOCAL TIMES OF ONE-DIMENSIONAL DIFFUSIONS

21

Proof. Directly following the arguments in the proof of Theorem 1.6 in [10] and keeping in
mind that the Gt-conditional distribution of Ly
∞ has an atom (as in the case of Example 1.7
in [10]), we deduce that
Mt := Xt − y −Z t
is an (Ht)t≥0 local martingale stopped at ζ. Note that the above is well-deﬁned since, the
integrand of the last integral has a constant sign and P -a.s.

b(Xs)ds −Z t∧τ y

ds −Z t

ux(Xs, y)
u(Xs, y)

s(Xs) − s(y)

σ2(Xs)

σ2(Xs)

s′(Xs)

t∧τ y

ds

Γ−

Γ−

0

0

by the deﬁnition of weak solutions. Therefore, on [t < ζ], we have

Z t
0 (cid:8)σ2(Xs) + |b(Xs)|(cid:9) ds < ∞, on [t < ζ],
Z t∧τ y

ds < ∞

Γ−

0

ux(Xs, y)

due to the continuity (and therefore boundedness) of ux(X,y)

σ2(Xs)(cid:12)(cid:12)(cid:12)(cid:12)

u(Xs, y) (cid:12)(cid:12)(cid:12)(cid:12)
It can also be directly veriﬁed that [M, M]t =R t
for x ∈ (l, r) by assumption, we may deﬁne
βt :=Z t∧ζ

σ(Xs)

dMs.

1

0

u(X,y) on compact subintervals of [0, ζ).
0 σ2(Xs)ds on [t < ζ]. Thus, since σ(x) > 0

Observe that the above stochastic integral is well-deﬁned since M is a continuous local
martingale and on [t < ζ]

Z t

0

1

σ2(Xs)

d[M, M]s = t.

By L´evy’s characterisation we easily deduce that β is an (Ht)t≥0-Brownian motion stopped
at ζ, which in turn yields that X satisﬁes (5.24). Moreover, β is independent of LY
To show that X is the weak solution of (5.22) with the given set of Γ, g, and θ, recall
from (2.5) that the P -distribution of Ly
u(y,y) and observe
that the dynamics of X in (5.24) is the same as those given by (5.22) once we replace B
> y] for all t > 0. Moreover, P (θ = 1) = ρ(y) is
with β and notice that [θ = 1] = [Xt+τ y
trivially satisﬁed due to the deﬁnition of ρ. Thus, it remains to show that θ, β and Ly
∞ are
independent from each other.

∞ is exponential with parameter

∞.

Γ−

1

We have already observed that β and Ly

∞ and
X∞ under P is obvious when only one of s(l) and s(r) is ﬁnite. If both of them are ﬁnite,
the result follows from Proposition 2.1.

∞ are independent. The independence of Ly

Note that (Ly

, X∞ is independent of (βt∧τ y

and Ly
τ y
Γ−
Ly
∞ is independent of β, we deduce that X∞ is independent of (βt∧τ y
[X∞ = r] = [Xt > y,∀t > τ y
Therefore, X∞ is independent of (βt+τ y

t , Xt) is strong Markov with respect to (Ht)t≥0 given Ly
∞. Thus, given Xτ y
= y and Ly
∞. Since
τ y
Γ−
)t≥0, too. Moreover,
since (Ht)t≥0 is right-continuous.

Γ−] implies [X∞ = r] ∈ Hτ y

)t≥0. However, Xτ y

)t≥0, hence, of β.

= Γ = Ly

Γ−

Γ−

Γ−

Γ−

Γ−

Γ− − βτ y

Γ−

(cid:3)

22

UMUT C¸ ETIN

Theorem 5.1 and Corollary 5.1 establish that the law of solutions of (5.21) is that of the
∞ = a] in view of the uniqueness in law of solutions of

solution of (2.3) conditioned on [Ly
(5.22) and the disintegration formula (5.23) as stated below.

Corollary 5.2. Let P L,a be the law on C(R+, I) induced by solutions of (5.21) and consider
the canonical space (C(R+, I),B, P y), where B is the Borel σ-algebra on C(R+, I). Then,
for all t > 0 and any bounded and measurable F : C([0, t], I) 7→ R and h : R+ 7→ R, the
following holds:
Z ∞
That is, P L,a is a regular conditional probability of B given Ly
Consequently, if X is a solution of (5.22) with g(da) = 1

u(y, y)(cid:19) da = Ey [F (Xs; s ≤ t)h(Ly

EL,a [F (Xs; s ≤ t)] h(a)

exp(cid:18)−

∞ = a.

u(y, y)

(5.25)

∞)] .

1

a

0

u(y,y) exp(cid:16)− a

u(y,y)(cid:17) da, then, in its

own ﬁltration, it’s a regular diﬀusion on (l, r) with scale function s and speed measure m.

Proof. Let X be a solution of (2.3) in some ﬁltered probability space with a right-continuous
ﬁltration. As we have seen in Corollary 5.1, it follows (5.24) when the ﬁltration is enlarged
with Ly
∞. The same corollary also yields that X is a weak solution of (5.22) when g(da) =

(5.23).

u(y,y)(cid:17) da. Since weak uniqueness holds for (5.22), we obtain (5.25) in view of
u(y,y) exp(cid:16)− a
The second claim follows from taking h ≡ 1 in (5.25), in which case the left-hand side of

1

(5.25) equals

Thus, P L,g = P y, which implies the claim.

EL,g [F (Rs; s ≤ t)] .

(cid:3)

What is hidden, in fact, in the second part of the above corollary is a new path decompo-
sition result for the original process X which can be restated, and upgraded to a theorem,
as follows:

Theorem 5.2. Let X be a weak solution of (2.3) with scale function s and potential kernel
u. Pick a y ∈ (l, r) and on a suitable probability space set up the following four independent
elements:

(1) An exponential random variable, Γ, with mean u(y, y).
(2) A Bernoulli random variable, θ, with P(θ = 1) = ρ(y), where ρ is as in (2.10).
(3) A process Y , which is a (u(·, y), M) recurrent transform of X run upto τ y

Γ−, where

Mt = exp(cid:16) Lt

u(y,y)(cid:17).

(4) A pair of Bessel-type motions, (R0, R1) with laws (Qy,0, Qy,1) and lifetimes (ζ 0, ζ 1).

Then, the process deﬁned by

˜Xt :=(cid:26) Yt,

Rθ

t−τ y

Γ−

t ≤ τ y

Γ−

, 0 < t − τ y

Γ− ≤ ζ θ,

has the same law as X.

PATH TRANSFORMATIONS FOR LOCAL TIMES OF ONE-DIMENSIONAL DIFFUSIONS

23

Note that the random variable θ is needed only if s(l) = 1−s(r) = 0. It must be emphasised
that, in this case, the Bessel-type motions in the above setup are not independent from each
other. In fact, the underlying Brownian motions in their SDE representations are the same.
This is indeed possible since (4.19) and (4.20) have the same coeﬃcients and diﬀer only in
their choice of the state space.

6. Examples

In this section we present some explicit examples that follow from Theorems 5.1 and 5.2.
Our usual disclaimer regarding the interpretation of the inverse local time from Remark 1
applies.

6.1. Killed Brownian motion. Suppose X is a Brownian motion on (−∞, b) killed at
b > 0. Thus, s(x) = x
b , u(x, y) = 1 − s(x ∨ y), and X∞ = b, which is reached in ﬁnite time,
a.s.. Taking y = 0 the equation (5.21) reads as

Xt = Bt −Z t∧τ 0

0

a−

1

b − Xs

1[Xs>0]ds +Z t

t∧τ 0

a−

1
Xs

ds,

t < ζ,

(6.26)

where ζ is the ﬁrst hitting time of b, which occurs in ﬁnite time.

The ﬁrst integral represents the recurrent transform, Y , stopped at τ 0

a−, where

If we let U := b − Y , then

0

1

Yt = Bt −Z t
b − Ys
Ut = b + βt +Z t

1
Us

0

1[Ys>0]ds.

1[Us<b]ds,

(6.27)

where β = −B. Although U resembles a 3-dimensional process, it clearly isn’t since it is
recurrent. It behaves like a Bessel process on the interval (0, b), otherwise it moves like a
Brownian motion, which makes it recurrent. This hints at the guess U being a recurrent
transform of R, which turns out to be true.

Proposition 6.1. Let U be as in (6.27). Then, it is an (h, M)-recurrent transform of the
3-dimensional Bessel process, R, which solves

Rt = R0 + Bt +Z t

0

1
Rs

ds,

(6.28)

where

and Lb is the local time of R at b.

h(x) =

1
x ∨ b

, Mt = exp(cid:0)bLb
t(cid:1) ,

Proof. The potential kernel, u, for R is given by

u(x, y) =

1
x ∨ y

.

24

UMUT C¸ ETIN

Proposition 3.1 yields that (u(·, b), M) is a recurrent transform which results in the SDE

dXt = dBt +(cid:26) 1

Xt − 1[Xt>b]

1

Xt(cid:27) dt = dBt + 1[Xt≤b]

1
Xt

dt.

0 1[Xs=b]ds = 0, which in turn yields the claim.

(cid:3)

Since [Xt = b] is a null set, R t

Having characterised the recurrent transform and the Bessel process that led to (6.26), we

can now state the path decomposition for the killed Brownian motion using Theorem 5.2.

Corollary 6.1. On a suitable probability space set up the following three independent ele-
ments:

(1) An exponential random variable, Γ, with mean 1.
(2) A weak solution, U, of (6.27).
(3) A 3-dimensional Bessel process, R, which solves (6.28) with R0 = 0.

Consider

˜Xt :=(cid:26) b − Ut,

Rt−τ b

Γ−

t ≤ τ b

Γ−

, 0 < t − τ y

Γ− ≤ Sb,

where (τ b
t )t≥0 is the right-continuous inverse of the local time of U at level b and Sb := inf{t ≥
0 : Rt = b}. Then, ˜X has the same law as the Brownian motion starting at 0 and killed at b.
6.2. Ornstein-Uhlenbeck process. Consider the Ornstein-Uhlenbeck process

(6.29)

(6.30)

(6.31)

for some r > 0. Then, X is transient and has the scale function

Xt = y + Bt +Z t

0

(rRXs + b)ds

s(x) =r r

πZ x

−∞

exp −r(cid:18)y −

b

r(cid:19)2! dy,

with s(−∞) = 1 − s(∞) = 0. The equation (5.21) reads in this case as

Xt = y + Bt +Z t

0

(rXs + b)ds

a−

0

+Z t∧τ y
+Z t

t∧τ y

a−

s(Xs)

(cid:26) s′(Xs)
1[Xs≤y] −
σ2(Xs)(cid:26)θ1[Xs>y]

1[Xs>y](cid:27) ds

s′(Xs)
1 − s(Xs)
s′(Xs)
s(Xs) − s(y) − (1 − θ)1[Xs<y]

s′(Xs)

s(y) − s(Xs)(cid:27) ds,

where θ is a random variable with ρ(y) = s(y). We already know that there exists a weak
solution, which is unique in law. The SDE above in fact possesses a unique strong solution.
Indeed, since σ ≡ 1, Lemma IX.3.3, Corollary IX.3.4 and Proposition IX.3.2 in [18] imply
that pathwise uniqueness holds for the SDEs (4.19) and (4.20) associated with the Ornstein-
Uhlenbeck process above. Moreover, the auxiliary SDE

dXt = dβt +(cid:26) s′(Xt)

s(Xt)

1[Xt≤y] −

s′(Xt)
1 − s(Xt)

1[Xt>y](cid:27) dt

Xt = y +Z t

0

2pXsdBs + δt.

2−δ

Note that a scale function is given by s(x) = 1 − x

2 . Thus, the equation (5.21) reads

Xt = y +Z t

0

2pXsdBs + δt

−2(δ − 2)Z t∧τ y

0

a−

1[Xs>y]ds + 2(δ − 2)Z t

t∧τ y

a−

y

2−δ

2−δ

2

s

X
2 − X

ds.

2−δ

2

s

PATH TRANSFORMATIONS FOR LOCAL TIMES OF ONE-DIMENSIONAL DIFFUSIONS

25

has pathwise uniqueness until the ﬁrst exit time from any bounded interval by part i of The-
orem IX.3.5 since the drift coeﬃcient is bounded in compact subsets of R. This establishes
the pathwise uniqueness for the solutions of (3.15). Thus, in view of the celebrated result of
Yamada and Watanabe (see Corollary 5.3.23 in [9]), there exists a unique strong solution to
(3.15), hence, to (6.31).

6.3. Squared Bessel process. Now, X is a squared Bessel process on (0,∞) of order δ > 2,
i.e.

Observe that we do not need to introduce the random variable θ since ρ(y) = 1.

As in the previous example we can show that the solution is in fact the unique strong

solution once we show that the following SDE has pathwise uniqueness:

Indeed, if R and X are two strong solutions then

0

Xt = y +Z t
|Rt − Xt| = 2Z t

0

2pXsdBs + δt − 2(δ − 2)Z t
sgn(Rs − Xs)(pRs −pXs)dBs

0

1[Xs>y]ds.

0

sgn(Rs − Xs)(1[Rs>y] − 1[Xs>y])ds + ˜Lt

−2(δ − 2)Z t
sgn(Rs − Xs)(pRs −pXs)dBs + ˜Lt,

≤ Z t

0

where ˜L is the semimartingale local time of R − X at 0 and sgn(x) = 1 if x > 0 and −1,
otherwise. If τx := inf{t ≥ 0 : |Rt − Xs| > x}, then the stochastic integral stopped at τx is a
true martingale since |√z − √z′| <p|z − z′||. Thus,
However, ˜L ≡ 0 by Lemma IX.3.3 in [18] since, again, |√z − √z′| <p|z − z′||.

E|Rt∧τx − Xt∧τx| ≤ E ˜Lt∧τx .

References

[1] R. M. Blumenthal and R. K. Getoor, Markov processes and potential theory, Pure and Applied

Mathematics, Vol. 29, Academic Press, New York-London, 1968.

[2] A. N. Borodin and P. Salminen, Handbook of Brownian motion—facts and formulae, Probability

and its Applications, Birkh¨auser Verlag, Basel, second ed., 2002.

26

UMUT C¸ ETIN

[3] K. L. Chung and J. B. Walsh, Markov processes, Brownian motion, and time symmetry, vol. 249 of
Grundlehren der Mathematischen Wissenschaften [Fundamental Principles of Mathematical Sciences],
Springer, New York, second ed., 2005.

[4] J. L. Doob, Conditional Brownian motion and the boundary limits of harmonic functions, Bull. Soc.

Math. France, 85 (1957), pp. 431–458.

[5]
[6] H. J. Engelbert and W. Schmidt, Strong Markov continuous local martingales and solutions of

, Probability theory and the ﬁrst boundary value problem, Illinois J. Math., 2 (1958), pp. 19–36.

one-dimensional stochastic diﬀerential equations. III, Math. Nachr., 151 (1991), pp. 149–197.

[7] S. N. Evans and A. Hening, Markov processes conditioned on their location at large exponential

times, Working paper.

[8] K. Itˆo and H. P. McKean, Jr., Diﬀusion processes and their sample paths, Springer-Verlag, Berlin-
New York, 1974. Second printing, corrected, Die Grundlehren der mathematischen Wissenschaften,
Band 125.

[9] I. Karatzas and S. E. Shreve, Brownian motion and stochastic calculus, vol. 113 of Graduate Texts

in Mathematics, Springer-Verlag, New York, second ed., 1991.

[10] R. Mansuy and M. Yor, Random times and enlargements of ﬁltrations in a Brownian setting,

vol. 1873 of Lecture Notes in Mathematics, Springer-Verlag, Berlin, 2006.

[11] M. B. Marcus and J. Rosen, Markov processes, Gaussian processes, and local times, vol. 100 of

Cambridge Studies in Advanced Mathematics, Cambridge University Press, Cambridge, 2006.

[12] H. P. McKean, Jr., Excursions of a non-singular diﬀusion, Z. Wahrscheinlichkeitstheorie und Verw.

Gebiete, 1 (1962/1963), pp. 230–239.

[13] A. Mijatovi´c and M. Urusov, Convergence of integral functionals of one-dimensional diﬀusions,

Electron. Commun. Probab., 17 (2012), pp. no. 61, 13.

[14] M. Nagasawa, Time reversions of Markov processes, Nagoya Math. J., 24 (1964), pp. 177–204.
[15] N. Perkowski and J. Ruf, Conditioned martingales, Electron. Commun. Probab., 17 (2012), pp. no.

48, 12.

[16] J. Pitman and M. Yor, A decomposition of Bessel bridges, Z. Wahrsch. Verw. Gebiete, 59 (1982),

pp. 425–457.

[17]

, Hitting, occupation and inverse local times of one-dimensional diﬀusions: martingale and excur-

sion approaches, Bernoulli, 9 (2003), pp. 1–24.

[18] D. Revuz and M. Yor, Continuous martingales and Brownian motion, vol. 293 of Grundlehren der
Mathematischen Wissenschaften [Fundamental Principles of Mathematical Sciences], Springer-Verlag,
Berlin, third ed., 1999.

[19] M. J. Sharpe, Some transformations of diﬀusions by time reversal, Ann. Probab., 8 (1980), pp. 1157–

1162.

[20] D. Williams, Path decomposition and continuity of local time for one-dimensional diﬀusions. I, Proc.

London Math. Soc. (3), 28 (1974), pp. 738–768.

Appendix A. Proof of Theorem 2.1

Proof of Theorem 2.1. Suppose that l is an entrance boundary and assume l = 0 without
loss of generality. Since 0 is entrance, we must have s(0) = −∞. Although s(r) = 1 by
assumption, let’s apply a further aﬃne transformation and assume s(r) = 0. Also note that if
r is a singular boundary, transience of X implies r is not entrance. Consider a 3-dimensional
Bessel process, R, on (0,∞) starting at 0, i.e

It is well-known that 0 is an entrance boundary for R (see [2] for a summary of results on
Bessel processes), whose scale function is given by p(x) := − 1
x . We will construct a weak

Rt = Bt +Z t

0

1
Rs

ds.

PATH TRANSFORMATIONS FOR LOCAL TIMES OF ONE-DIMENSIONAL DIFFUSIONS

27

solution of (2.2) by change of time and scale applied to R following the ideas of Engelbert
and Schmidt (see, e.g., Section 5.5 of [9]).

Observe that s is a C 1-function whose derivative is absolutely continuous. It is clear that
these properties are inherited by its inverse, s−1. Since s−1(−∞) = 0, it follows from Ito’s
formula and the fact that

σ2
2

s′′ + bs′ = 0,

Y = s−1(p(R)) is a semimartingale satisfying

Yt =Z t

0

us′ (s−1 (p(Ru)))
Consider the additive functional

R2

1

dBu +Z t

0

b (s−1 (p(Ru)))

σ2 (s−1 (p(Ru))) [R2

us′ (s−1 (p(Ru)))]2 du

(A.32)

At :=Z t

0

1
us′ (s−1 (p(Ru)))]2 du,
σ2 (s−1 (p(Ru))) [R2

and its right-continuous inverse

We also deﬁne A∞ = limt→∞ At and T∞ = limt→∞ Tt.

Tt := inf{s ≥ 0 : As > t}.

It follows from the occupation times formula that

At = 2Z ∞

0

x2σ2 (s−1 (p(x))) (s′(s−1(p(x)))2 dx = 2Z r

lx
t

0

− 1
t

s(x)

l

σ2 (x) s′(x)

dx,

where lx is the diﬀusion local time for R. Since Rt → ∞, a.s. and never visits 0 again, we
immediately deduce that for every t, the mapping x 7→ lx
t has a compact support, a.s., that
is contained in (0,∞). Since it is also c`adl`ag , it is bounded. This implies that At < ∞, a.s.,
since for any 0 < z < u < r

2Z u

z

1

σ2 (x) s′(x)

dx = m((z, u)) < ∞.

The same reasoning also yields that ATx < ∞, where Tx = inf{t ≥ 0 : Rt = x} for some
x ∈ (0,∞). Thus, the strong Markov property implies

Q0(A∞ < ∞) = Qx(A∞ < ∞),

where Qx is the law of a 3-dimensional Bessel process starting at x. Mijatovic and Urusov
show in Theorem 2.11 [13] that Qx(A∞ < ∞) = 1 (resp. = 0) if

Z ∞

z

x3σ2 (s−1 (p(x))) (s′(s−1(p(x)))2 dx < ∞ (resp. = ∞))

1

for some z. After a change of variable the above integral turns into

−Z r

s−1(p(z))

s(x)

σ2(x)s′(x)

dx,

which is ﬁnite if r is a regular boundary. Consequently, A∞ < ∞, a.s. when r is regular.

28

UMUT C¸ ETIN

If r is a singular boundary, we have already observed at the beginning of the proof that
it is not entrance. If it is exit, the above integral will be ﬁnite, too. Indeed, that r is exit
implies

under the assumption that r is an exit boundary. On the other hand, since s(r) = 0 and

Z r

z

m((z, x))s′(x)dx < ∞.

m((z, x))s′(x)dx

dx = log s(z) − log s(r) = ∞,

Also, note that limx→r s(x)m((z, x) exists and equals

z

z

z

s(x)

σ2(x)s′(x)

s′(x)
s(x)

dx −Z r

we deduce that limx→r s(x)m((z, x) = 0 since

−Z r
Z r
∞ >Z r
m((z, x))s′(x)dx =Z r
Therefore, for any z ∈ (0, r)
dx =Z r
−Z r

σ2(x)s′(x)

s(x)

z

z

and A∞ is ﬁnite.

s(x)m((z, x))

s′(x)
s(x)

dx.

z

m((z, x))s′(x)dx < ∞,

z

If r is a natural boundary, let rn be a sequence of numbers in (l, r) increasing to r and

observe that

−Z r

z

s(x)

σ2(x)s′(x)

dx = lim

n→∞(cid:26)−s(rn)m((z, rn)) +Z rn
n→∞Z rn
m((z, x))s′(x)dx = ∞.

z

z

≥ lim

m((z, x))s′(x)dx(cid:27)

Thus, A∞ = ∞, a.s., when r is a natural boundary.
The behaviour of A near inﬁnity aﬀects the ﬁniteness of T . If A∞ < ∞, then Tt = ∞ on
[t ≥ A∞]. Otherwise, Tt < ∞, for every t. Moreover, it is easy to see that A is continuous
and strictly increasing while T is continuous everywhere and strictly increasing on [0, A∞).
Moreover, t = ATt for t ≤ A∞ and t = TAt for every t < ∞.
With the above characterisation of A and T , let us next consider Xt := YTt and Gt = FTt,
where (Ft) is the universal completion of the natural ﬁltration of R. Consequently, (Gt)
satisﬁes the usual conditions since (Tt) is continuous. Then, it is straightforward to check
that

Mt :=Z Tt
R2
is a continuous (Gt)-local martingale with
[M, M]t =Z Tt

0

0

1

us′ (s−1 (p(Ru)))

dBu

1

us′ (s−1 (p(Ru)))]2 du.

[R2

PATH TRANSFORMATIONS FOR LOCAL TIMES OF ONE-DIMENSIONAL DIFFUSIONS

29

σ2(Xu)du.

0

0

[M, M]t =Z Tt

Thus, there exists a (Gt)-Brownian motion, β, such that
σ(Xu)dβu.

On the set [Tt < ∞] = [t < A∞], the above can be rewritten as
σ2(s−1(p(Ru)))dAu =Z t
Mt =Z t
us′ (s−1 (p(Ru)))]2 du =Z t
σ(Xu)dβu +Z t

Thus, we have proved on [t < A∞]

Xt =Z t

Similarly, on [t < A∞]

σ2 (s−1 (p(Ru))) [R2

b (s−1 (p(Ru)))

Z Tt

b(Xu)du.

0

0

0

0

0

b(Xu)du.

On the other hand, on [t ≥ A∞], Tt = ∞, and Xt = Y∞ = s−1(p(R∞)) = s−1(p(∞)) = r.
Furthermore, since s−1◦ p is one-to-one, A∞ = inf{t ≥ 0 : Xt = r}. This shows the existence
of a weak solution to (2.2) as soon as we verify that ζ = A∞. However, this immediately
follows from the fact that any diﬀusion that satisﬁes (2.2) has the scale and speed given by
s and m, respectively, which in turn yields that 0 is an entrance boundary and, therefore,
inaccessible.

To show uniqueness let X be a weak solution and Y = p−1(s(X)) so that on [t < ζ]

Yt =Z t

0

s′(Xu)σ(Xu)

s2(Xu)

dBu −Z t

0

(s′(Xu)σ(Xu))2

s3(Xu)

du.

Consider

and its right continuous inverse At := inf{s ≥ 0 : Ts > t}.

As before,

Tt :=Z t

0

(s′(Xu)σ(Xu))2

s4(Xu)

du

Tt = 2Z r

0

Lx
t

s′(x)
s4(x)

dx,

where Lx is the diﬀusion local time at x for X. On the set [t < ζ], Lx has compact support
in (0, r). Thus, Tt < ∞ on [t < ζ] since for 0 < z < u < r
1

3Z u

z

s′(x)
s4(x)

dx =

1
s3(z) −

s3(u)

< ∞.

Similarly, Tt is absolutely continuous and strictly increasing on [0, ζ).

Next observe that

s(x)

−Z r
Thus, Theorem 2.11 in [13] yields Tt = ∞ on [t ≥ ζ]. This, in particular, yields that At < ∞
for all t < ∞ and A∞ = ζ.

dx = −Z r

dx = ∞.

s′(x)
s(x)

s′(x)σ2(x)

(s′(x)σ(x))2

s2(x)

z

z

with

Thus, on the set [At < ζ], [M, M]t = t as well as
(s′(Xu)σ(Xu))2

s′(Xu)σ(Xu)

s2(Xu)

dBu

(s′(Xu))2σ2(Xu)

s4(Xu)

du = TAt .

0

Mt =Z At
[M, M]t =Z At
−Z At

0

0

s3(Xu)

du =Z t

0

1
Xu

du.

Xt = βt +Z t

0

1
Xu

du.

Let τ := inf{t ≥ 0 : At = ζ}. The above considerations show that on [0, τ )

30

UMUT C¸ ETIN

Consider Xt = YAt and Gt = FAt, where (Ft) is the universal completion of the natural

ﬁltration of X. Deﬁne the (Gt)-local martingale

Using the continuity of X we also deduce that Xτ = Yζ = r and X is, therefore, 3-dimensional
Bessle process starting at 0 and stopped at r. Since the SDE for the 3-dimensional Bessel
process has a unique solution, we deduce that the distribution of (YAt) is uniquely identiﬁed
on [At < ζ]. This in turn yields the weak uniqueness of the solutions of (2.2) on [0, ζ] since
At is strictly increasing on [t ≤ τ ] and p−1 ◦ s is one-to-one.
r = 0 and consider the diﬀusion, R, on (−∞, 0) deﬁned by the SDE:

If the entrance boundary is the right endpoint, i.e. r, suppose without loss of generality

Rt = Bt +Z t

0

1
Rs

ds.

This is the negative of a 3-dimensional Bessel process and 0 is its entrance boundary. Now,
the above arguments can be repeated to show the existence and the uniqueness of the weak
solutions of (2.2).
(cid:3)

Department of Statistics, London School of Economics and Political Science, 10 Houghton

st, London, WC2A 2AE, UK

E-mail address: u.cetin@lse.ac.uk

