ALGEBRAIC INDEPENDENCE OF G-FUNCTIONS AND

CONGRUENCES “ `A LA LUCAS”

by

B. Adamczewski, Jason P. Bell & E. Delaygue

Abstract. — We develop a new method for proving algebraic independence of G-functions. Our
approach rests on the following observation: G-functions do not always come with a single linear
diﬀerential equation, but also sometimes with an inﬁnite family of linear diﬀerence equations
associated with the Frobenius that are obtained by reduction modulo prime ideals. When these
linear diﬀerence equations have order one, the coeﬃcients of the G-function satisfy congruences
reminiscent of a classical theorem of Lucas on binomial coeﬃcients. We use this to derive a
Kolchin-like algebraic independence criterion. We show the relevance of this criterion by proving,
using p-adic tools, that many classical families of G-functions turn out to satisfy congruences “`a
la Lucas”.

Contents

1. Introduction. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
1
2. Notation. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
7
3. Lucas-type congruences and two special sets of power series . . . . . . . . . . . . . .
8
4. A criterion for algebraic independence . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 11
5. Algebraic functions in Ld(R,S) and Ld(R,S). . . . . . . . . . . . . . . . . . . . . . . . . . . . . 14
6. From asymptotics and singularity analysis to algebraic independence . . . . . 17
7. A family of multivariate generalized hypergeometric series and their p-adic

properties. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 24
8. Lucas-type congruences among classical families of G-functions. . . . . . . . . . . 33
9. Algebraic independence of G-functions: a few examples. . . . . . . . . . . . . . . . . . . 43
References. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 48

1. Introduction

This paper is the fourth of a series started by the ﬁrst two authors [1, 2, 3] concerning
several number theoretical problems involving linear diﬀerence equations, called Mahler’s
equations, as well as underlying structures associated with automata theory. We investigate

This project has received funding from the European Research Council (ERC) under the European Union’s

Horizon 2020 research and innovation programme under the Grant Agreement No 648132.

6
1
0
2

 
r
a

 

M
4
1

 
 
]
T
N
h
t
a
m

.

[
 
 

1
v
7
8
1
4
0

.

3
0
6
1
:
v
i
X
r
a

here a class of analytic functions introduced by Siegel [45] in his landmark 1929 paper under
n=0 a(n)zn is a G-function if it satisﬁes
the following conditions. Its coeﬃcients a(n) are algebraic numbers and there exists a positive
real number C such that for every non-negative integer n:

the name of G-functions. Let us recall that f (z) :=P∞

(i) The moduli of all Galois conjugates of a(n) are at most C n.
(ii) There exists a sequence of positive integers dn < C n such that dnam is an algebraic

integer for all m, 0 ≤ m ≤ n.

(iii) The function f satisﬁes a linear diﬀerential equation with coeﬃcients in Q(z).

Their study leads to a remarkable interplay between number theory, algebraic geometry,
combinatorics, and the study of linear diﬀerential equations (see [8, 25, 34, 49]).

In this paper, we focus on the algebraic relations over C(z) that may or may not exist
between G-functions. In this respect, our main aim is to develop a new method for proving
algebraic independence of such functions. Our ﬁrst motivation is related to transcendence
theory. A large part of the theory is actually devoted to the study of algebraic relations
over Q between periods (∗). Unfortunately, this essentially remains terra incognita. At least
conjecturally, G-functions may be thought of as their functional counterpart (smooth algebraic
deformations of periods). Understanding algebraic relations among G-functions thus appears
to be a ﬁrst step in this direction and, ﬁrst of all, a much more tractable problem. For instance,
a conjecture of Kontsevich [33] (see also [34]) claims that any algebraic relation between
periods can be derived from the three fundamental operations associated with integration:
additivity, change of variables, and Stokes’ formula. It is considered completely out of reach
by specialists, but recently Ayoub [9] proved a functional version of the conjecture (see also
[6]). Despite the depth of this result, it does not help that much in deciding whether given
G-functions are or are not algebraically independent.

A second motivation ﬁnds its source in enumerative combinatorics. Indeed, most generating
series that have been studied so far by combinatorists turn out to be G-functions. To some
extent, the nature of a generating series reﬂects the underlying structure of the objects it
counts (see [11]). By nature, we mean whether the generating series is rational, algebraic, or
D-ﬁnite. In the same line, algebraic independence of generating series can be considered as a
reasonable way to measure how distinct families of combinatorial objects may be (un)related.
Though combinatorists have a very long tradition of proving transcendence of generating
functions, it seems that algebraic independence has never been studied so far in this setting.

Our approach rests on the following observation: a G-function often comes with not just a
single linear diﬀerential equation, but also sometimes with an inﬁnite family of linear diﬀerence
equations obtained by reduction modulo prime ideals. Let us formalize this claim somewhat.
Let K be a number ﬁeld, f (z) :=P∞
n=0 a(n)zn be a G-function in K{z}, and let us denote by
OK the ring of integers of K. For prime ideals p of OK such that all coeﬃcients of f belong
to the localization of OK at p, it makes sense to consider the reduction of f modulo p:

∞

f|p(z) :=

Xn=0(cid:0)a(n) mod p(cid:1)zn ∈ (OK /p)[[z]] .

*. A period is a complex number whose real and imaginary parts are values of absolutely convergent integrals
of rational fractions over domains of Rn deﬁned by polynomial inequalities with rational coeﬃcients. Most
complex numbers of interest to arithmeticians turn out to be periods.

2

When p is above the prime p, the residue ﬁeld OK /p is a ﬁnite ﬁeld of characteristic p, and
the linear diﬀerence equation mentioned above is of the form:

(1.1)

a0(z)f|p(z) + a1(z)f|p(zp) + ··· + ad(z)f|p(zpd

) = 0 ,

where ai(z) belong to (OK /p)(z). That is, a linear diﬀerence equation associated with the
Frobenius endomorphism σp : z 7→ zp. Note that f|p satisﬁes an equation of the form (1.1) if,
and only if, it is algebraic over (OK /p)(z). A theorem of Furstenberg [29] and Deligne [22]
shows that this holds true for all diagonals of multivariate algebraic power series and almost
every prime ideals (∗). Furthermore, classical conjectures of Bombieri and Dwork would imply
that this should also be the case for any globally bounded G-functions (see [15]). Note that
even when a G-function is not globally bounded, but can still be reduced modulo p for inﬁnitely
many prime ideals p, a similar situation may be expected. For instance, the hypergeometric
function

2F1(cid:20) (1/2), (1/2)

(2/3)

; z(cid:21)

is not globally bounded but satisﬁes a relation of the form (1.1) for all prime numbers con-
gruent to 1 modulo 6 (see Section 8.2).

A case of speciﬁc interest is when f|p satisﬁes a linear diﬀerence equation of order one with

respect to a power of the Frobenius. Then one obtains a simpler equation of the form:

(1.2)

f|p(z) = a(z)f|p(zpk

) ,

for some positive integer k and some rational fraction a(z) in (OK /p)(z). As explained in
Section 3, these equations lead to congruences for the coeﬃcients of f that are reminiscent
to a classical theorem of Lucas [37] on binomial coeﬃcients and the so-called p-Lucas con-
gruences. At ﬁrst glance, it may seem somewhat miraculous that a G-function could satisfy
such congruences for inﬁnitely many prime ideals. Surprisingly enough, we will show that
this situation occurs remarkably often. For instance, motivated by the search of diﬀerential
operators associated with particular families of Calabi-Yau varieties, Almkvist et al. [5] gave
a list of more than 400 diﬀerential operators selected as potential candidates. They all have a
unique solution analytic at the origin and it turns out that more than ﬁfty percent of these an-
alytic solutions do satisfy Lucas-type congruences (see the discussion in Section 8.4). Another
interesting example is due to Samol and van Straten [43]. Consider a Laurent polynomial

Λ(x) =

k

Xi=1

αixai ∈ Z[x±

1 , . . . , x±
d ],

1 , . . . , x±

where ai ∈ Zd and αi
6= 0 for i in {1, . . . , k}. Then the Newton polyhedron of Λ is the
convex hull of {a1, . . . , ak} in Rd. In [43], it is proved that if Λ(x) is a Laurent polynomial in
Z[x±
d ] such that the origin is the only interior integral point of the Newton polyhedron
of Λ, then the sequence of the constant terms of its powers ([Λ(x)n]0)n≥0 has the p-Lucas
property for all primes p. More generally, there is a long tradition (and a corresponding
extensive literature) in proving that some sequences of natural numbers satisfy the p-Lucas
property or some related congruences. Most classical sequences which are known to enjoy the

*. Diagonals of algebraic power series form a distinguished class of G-functions (see for instance [2, 13, 14]).

3

p-Lucas property turn out to be multisums of products of binomial coeﬃcients such as, for
example, the Ap´ery numbers

n

Xk=0(cid:18)n

k(cid:19)2(cid:18)n + k

k (cid:19) and

n

Xk=0(cid:18)n

k(cid:19)2(cid:18)n + k
k (cid:19)2

.

Other classical examples are ratios of factorials such as
(10n)!

(3n)!
n!3

and

(5n)!(3n)!n!2 ·

However, the known proofs are quite diﬀerent and strongly depend on the particular forms
of the binomial coeﬃcients and of the number of sums involved in those sequences. We note
that some attempts to obtain more systematic results can be found in [39] and more recently
in [38]. We also refer the reader to [41] for a recent survey, including many references, about
p-Lucas congruences. In Section 7, we provide a way to unify many proofs, as well as to obtain
a lot of new examples. We introduce a family of multivariate hypergeometric series and study
their p-adic properties. Using specializations of these series, we are able to prove in Section 8
that a large variety of classical families of G-functions actually satisfy such congruences. This
includes families of hypergeometric series and generating series associated with multisums of
products of binomial coeﬃcients. This also includes more exotic examples such as

∞

Xn=0




⌊n/3⌋

Xk=0

k≡n mod 2

2k3

n−3k

2 (cid:18)n

k(cid:19)(cid:18)n − k

n−k

2

k (cid:19)
2 (cid:19)(cid:18) n−k


zn .

Let f1(z), . . . , fs(z) be power series such that (1.2) holds for all elements in an inﬁnite set
S of prime ideals and for rational fractions a(z) whose height is in O(pk) (∗). In Section 4
we prove an algebraic independence criterion, Theorem 4.1, saying that f1(z), . . . , fn(z) are
algebraically dependent over C(z) if, and only if, there exist integers a1, . . . , as, not all zero,
such that:

f1(z)a1 ··· fs(z)as ∈ Q(z) .

Thus if f1(z), . . . , fn(z) are algebraically dependent, they should satisfy a very special kind
of relation: a Laurent monomial is equal to a rational fraction. This kind of result is usually
attached to the name of Kolchin. At this point, it is often possible to apply asymptotic tech-
niques and analysis of singularities, as described in Section 6, to easily deduce a contradiction
and ﬁnally prove that the functions f1(z), . . . , fs(z) are algebraically independent over C(z).

Remark 1.1. — Since G-functions do satisfy linear diﬀerential equations, diﬀerential Galois
theory provides a natural framework to look at these questions. For instance, it leads to
strong results concerning hypergeometric functions [10]. However, the major drawback of this
approach is that things become increasingly tricky when working with diﬀerential equations of
higher orders. Given some G-functions f1(z), . . . , fs(z), it may be non-trivial to determine the
diﬀerential Galois group associated with a diﬀerential operator annihilating these functions.
The method developed in this paper follows a totally diﬀerent road. An important feature is
that, contrary to what would happen using diﬀerential Galois theory, we do not have to care
about the derivatives of the functions f1(z), . . . , fs(z). It is also worth mentioning that in order

*. See Section 2 for a precise deﬁnition of the height of a rational fraction and Section 3.1 for precise

conditions imposed upon f1(z), . . . , fs(z).

4

to apply Theorem 4.1, we do not even need that the functions f1(z), . . . , fs(z) satisfy linear
diﬀerential equations. We only need properties about their reduction modulo prime ideals.
As described in Sections 3 and 4, all of this makes perfect sense in the general framework of
a Dedekind domain. However, we only focus in this paper on applications of our method to
G-functions.

The present work was initiated with the following concrete example. Given a positive

integer r, the function

fr(z) :=

∞

n(cid:19)r
Xn=0(cid:18)2n

zn

is a G-function annihilated by the diﬀerential operator Lr := θr−4rz(θ+1/2)r, where θ = z d
dz .
In 1980, Stanley [47] conjectured that the fr’s are transcendental over C(z) unless for r = 1,
in which case we have f1(z) = (√1 − 4z)−1. He also proved the transcendence in the case

where r is even. The conjecture was solved independently by Flajolet [27] and by Sharif and
Woodcock [46] with totally diﬀerent methods. Incidentally, this result is also a consequence
of work of Beukers and Heckman [10] concerning generalized hypergeometric series. Let us
brieﬂy describe these diﬀerent proofs. We assume in the sequel that r > 1.

(i) The proof of Flajolet is based on asymptotics. Indeed, it is known that for an algebraic

function f (z) =P∞

n=0 a(n)zn ∈ Q{z}, one has:
Ciωn

a(n) =

αnns

m

Γ(s + 1)

Xi=0

i + O

n→∞

(αnnt),

where s ∈ Q \ Z<0, t < s, α is an algebraic number and the Ci’s and ωi’s are algebraic
with |ωi| = 1. On the other hand, Stirling formula leads to the following asymptotics

n(cid:19)r
(cid:18)2n

∼n→∞

2(2n+1/2)r
(2πn)r/2 ·

A simple comparison between these two asymptotics shows that fr cannot be algebraic
when r is even, as already observed by Stanley in [47]. Flajolet [27] shows that it also
leads to the same conclusion for odd r, but then it requires the transcendence of π.

(ii) The proof of Sharif and Woodcock is based on the Lucas theorem previously mentioned.

Indeed, Lucas’ theorem on binomial coeﬃcients implies that

(np + m)(cid:19)r
(cid:18)2(np + m)

≡(cid:18)2n

n(cid:19)r(cid:18)2m
m(cid:19)r

mod p

for all prime numbers p, all non-negative integers n and all m, 0 ≤ m ≤ p− 1. This leads
to the algebraic equation:

fr|p(z) = Ap(z)fr|p(z)p

where Ap(z) := Pp−1

In [46], Sharif and Woodcock prove that the
degree of algebraicity of fr|p cannot remains bounded when p runs along the primes,
which ensures the transcendence of fr.

n(cid:1) mod p(cid:1)zn.

n=0(cid:0)(cid:0)2n

(iii) The proof based on the work of Beukers and Heckman used the fact that

fr(z) = r+1Fr(cid:20) (1/2), . . . , (1/2)

1, . . . , 1

; 22rz(cid:21)

5

is a hypergeometric function. Then it is easy to see that fr fails the beautiful interlacing
criterion proved in [10]. In consequence, the diﬀerential Galois groups associated with
the fr’s are all inﬁnite and these functions are thus transcendental.

Though there are three diﬀerent ways to obtain the transcendence of fr, not much was
apparently known about their algebraic independence. Roughly, our approach can be summed
up by saying that (ii) + (i) leads to algebraic independence in a rather straightforward manner,
while (iii) would be the more usual method. In this line, we will complete in Section 6 the
result of [2], proving that the functions fr are all algebraically independent.

To give a ﬂavor of the kind of results we can obtain, we just add the following two examples.
They correspond respectively to Theorems 9.8 and 9.9 proved in the sequel. The ﬁrst one
concerns several families of generating series associated with Ap´ery numbers, Franel numbers,
and some of their generalizations. The second one involves a mix of hypergeometric series
and generating series associated with factorial ratios and Apery numbers.

Proposition 1.2. — Let F be the set formed by the union of the three following sets:
k (cid:19)r! zn : r ≥ 2)

k(cid:19)r! zn : r ≥ 3) , ( ∞

Xn=0  n
( ∞

Xk=0(cid:18)n

Xk=0(cid:18)n

k(cid:19)r(cid:18)n + k

Xn=0  n
k (cid:19)r! zn : r ≥ 1) .
k(cid:19)2r(cid:18)n + k

Xn=0  n
( ∞

Xk=0(cid:18)n

Then all elements of F are algebraically independent over C(z).

Observe that the restriction made on the parameter r in each case is optimal since the

and

functions

and

∞

Xn=0  n

Xk=0(cid:18)n

1

1 − 2z

,

k(cid:19)! zn =
Xn=0  n

Xk=0(cid:18)n

∞

k(cid:19)2! zn =

1

√1 − 4z

∞

Xn=0  n
Xk=0(cid:18)n
k (cid:19)! zn =

k(cid:19)(cid:18)n + k

1

√1 − 6z + z2

are all algebraic over Q(z).

Proposition 1.3. — The functions

∞

Xn=0

f (z) :=

and

(4n)!
(2n)!n!2 zn, g(z) :=

∞

Xn=0  n

Xk=0(cid:18)n

k(cid:19)2(cid:18)n + k

k (cid:19)2! zn, h(z) :=

(1/6)n(1/2)n

(2/3)nn!

zn

∞

Xn=0

i(z) :=

are algebraically independent over C(z).

(1/5)3
n
(2/7)nn!2 zn

∞

Xn=0

6

2. Notation

Let us introduce some notation that will be used throughout this paper. Let d be a
positive integer. Given d-tuples of real numbers m = (m1, . . . , md) and n = (n1, . . . , nd), we
set m + n := (m1 + n1, . . . , md + nd) and m · n := m1n1 + ··· + mdnd. If moreover λ is a real
number, then we set λm := (λm1, . . . , λmd). We write m ≥ n if we have mk ≥ nk for all k
in {1, . . . , d}. We also set 0 := (0, . . . , 0) and 1 := (1, . . . , 1). We let P denote the set of all
prime numbers.

2.0.1. Polynomials.— Given a d-tuple of natural numbers n = (n1, . . . , nd) and a vector of
indeterminates x = (x1, . . . , xd), we will denote by xn the monomial xn1
d . The (total)
degree of such a monomial is the non-negative integer n1 + ··· + nd. Given a ring R and
a polynomial P in R[x], we denote by deg P the (total) degree of P , that is the maximum
of the total degrees of the monomials appearing in P with non-zero coeﬃcient. The partial
degree of P with respect to the indeterminate xi is denoted by degxi(P ). Given a polynomial
P (Y ) in R[x][Y ], we deﬁne the height of P as the maximum of the total degrees (in x) of its
coeﬃcients.

1 ··· xnd

2.0.2. Algebraic functions.— Let K be a ﬁeld. We denote by K[[x]] the ring of formal power
series with coeﬃcients in K and associated with the vector of indeterminates x. We denote
by K[[x]]× the group of units of K[[x]], that is the subset of K[[x]] formed by all power series
with non-zero constant coeﬃcients. We say that a power series

f (x) = Xn∈Nd

a(n)xn ∈ K[[x]]

is algebraic if it is algebraic over the ﬁeld of rational functions K(x), that is, if there exist
polynomials A0, . . . , Am in K[x], not all zero, such that

Ai(x)f (x)i = 0 .

m

Xi=0

Otherwise, f is said to be transcendental. The degree of an algebraic power series f , denoted
by deg f , is deﬁned as the degree of the minimal polynomial of f , or equivalently, as the
minimum of the natural numbers m for which such a relation holds. The (naive) height of f ,
denoted by H(f ), is then deﬁned as the height of the minimal polynomial of f , or equivalently,
as the minimum of the heights of the non-zero polynomials P (Y ) in K[x][Y ] that vanish at
f . For a rational function f , written as A(x)/B(x) with A and B two coprime polynomials,
then one has H(f ) = max(deg A, deg B). Note that we just introduced two diﬀerent notions:
the degree of a polynomial and the degree of an algebraic function. Since polynomials are
also algebraic functions we have to be careful. For instance, the polynomial x2y3 in K[x, y]
has degree 5 but viewed as an element of K[[x, y]] it is an algebraic power series of degree 1.
In the sequel, this should not be a source of confusion.

2.0.3. Algebraic independence.— Let f1, . . . , fn be in K[[x]]. We say that f1, . . . , fn are
algebraically dependent if they are algebraically dependent over the ﬁeld K(x), that is, if there
exists a non-zero polynomial P (Y1, . . . , Yn) in K[x][Y1, . . . , Yn] such that P (f1, . . . , fn) = 0.
This is also equivalent to declaring that the ﬁeld extension K(x)(f1, . . . , fn) of K(x) has
transcendence degree less than n. When the degree of such a polynomial P (here, the total
degree with respect to Y1, . . . , Yn) is at most d, then we say that f1, . . . , fn satisfy a polynomial
(or an algebraic) relation of degree at most d. When there is no algebraic relation between

7

them, the power series f1, . . . , fn are said to be algebraically independent (over K(x)). A set
or family S of power series is said to be algebraically independent if all ﬁnite subsets of S
consist of algebraically independent elements.

2.0.4. Dedekind domains.— We recall here some basic facts about Dedekind domains (see
for instance [44]). Let R be a Dedekind domain; that is, R is Noetherian, integrally closed,
and every non-zero prime ideal of R is a maximal ideal. Let K denote the ﬁeld of fractions
of R. The localization of R at a maximal ideal p is denoted by Rp. Recall here that Rp can
be seen as the following subset of K:

Then Rp is a discrete valuation ring and the residue ﬁeld Rp/p is equal to R/p. Furthermore,
any non-zero element of R belongs to at most a ﬁnite number of maximal ideals of R. In

Rp = {a/b : a ∈ R, b ∈ R \ p} .

This property implies that any non-zero element of K belongs to Rp for all but ﬁnitely many

other words, given an inﬁnite set S of maximal ideals of R, then one always hasTp∈S p = {0}.
maximal ideal p of R. Furthermore, we also have Tp∈S pRp = {0}. For every power series
f (x) =Pn∈Nd a(n)xn with coeﬃcients in Rp, we set

f|p(x) := Xn∈Nd(cid:0)a(n) mod p(cid:1)xn ∈ (R/p)[[x]] .

The power series f|p is called the reduction of f modulo p.

3. Lucas-type congruences and two special sets of power series

3.1. The set Ld(R,S). — We deﬁne a special set of power series that will play a key role
in this paper.

Deﬁnition 3.1. — Let R be a Dedekind domain and K be its ﬁeld of fractions. Let S be
a set of prime ideals of R. Let d be a positive integer and x = (x1, . . . , xd) be a vector of
indeterminates. We let Ld(R,S) denote the set of all power series f (x) in K[[x]] with constant
term equal to 1 and such that for every p in S:

(i) f (x) ∈ Rp[[x]];
(ii) The residue ﬁeld R/p is ﬁnite and has characteristic p ;
(iii) There exist a positive integer k and a rational fraction A in K(x) ∩ Rp[[x]] satisfying

f (x) ≡ A(x)f(cid:0)xpk(cid:1) mod pRp[[x]];

(iv) H(A) = O(pk), where the constant involved in the Landau notation does not depend

on p.

Remark 3.2. — If f (x) is a formal power series that belongs to Ld(R,S), then the constant
coeﬃcient A(0) of the rational fraction A involved in (iii) must be equal to 1. In particular,
A(x) belongs to the group of units Rp[[x]]×.
Remark 3.3. — Let f (x) be a power series in Ld(R,S). Let p be a prime in S such that
f (x) ≡ A(x)f(cid:0)xpk(cid:1) mod pRp[[x]] with H(A(x)) ≤ Cpk. Iterating Congruence (iii), we ob-
serve that for all natural numbers m, we also have

f (x) ≡ A(x)A(cid:0)xpk(cid:1)··· A(cid:0)xpmk(cid:1)f(cid:0)xp(m+1)k(cid:1) mod pRp[[x]],

8

with

H(cid:0)A(x)A(cid:0)xpk(cid:1)··· A(cid:0)xpmk(cid:1)(cid:1) ≤ Cpk(1 + pk + ··· + pkm)

≤ Cpk p(m+1)k − 1
pk − 1
≤ 2Cp(m+1)k.

Remark 3.4. — In our applications, we will focus on the fundamental case where K is a
number ﬁeld. In that case, K is the fraction ﬁeld of its ring of integers R = OK which is a
Dedekind domain. Furthermore, for every prime ideal p in OK above a rational prime p, the
residue ﬁeld OK /p is ﬁnite of characteristic p. In particular, we will consider the case K = Q.
In that case, we have R = OK = Z and, for every prime number p, the localization Z(p) is
the set of rational numbers whose denominator is not divisible by p. If there is no risk of
confusion, we will simply write Ld(S) instead of Ld(Z,S) and L(S) instead of L1(Z,S).

As we will see in the sequel, a good way to prove that some power series f belongs to
L1(R,S) is to show that f arises as some specialization of a multivariate power series known
to belong to Ld(R,S). In this direction, we give the following useful result.
Proposition 3.5. — Let R be a Dedekind domain with ﬁeld of fractions K. Let S and S′ be
two sets of prime ideals of R of ﬁnite index. Let f be in Ld(R,S) and g in Le(R,S ′). Then
the following hold.
(i) Let a1, . . . , ad be non-zero elements of K and n1, . . . , nd be positive integers. Then
d ) belongs to Ld(R,T ), where T is the set of primes p in S such that

1 , . . . , adxnd

f (a1xn1
a1, . . . , ad belong to Rp.

(ii) If x is an indeterminate, then f (x, x, x3, . . . , xd) belongs to Ld−1(R,S).
(iii) If x and y are two vectors of indeterminates, then f (x) · h(y) is in Ld+e(R,S ∩ S ′).
The proof of Proposition 3.5 is a straightforward consequence of Deﬁnition 3.1 and of

Remark 3.3.

3.2. The set Ld(R,S) and pk-Lucas congruences. — As we will see in the sequel, it
often happens that elements of Ld(R,S) satisfy a stronger form of Condition (iii). Typically,
the rational fraction A(x) can just be a polynomial with even further restriction on its degree.
This gives rise to stronger congruences that are of interest in combinatorics, and leads us to
deﬁne the following distinguished subset of Ld(R,S).
Deﬁnition 3.6. — Let us deﬁne Ld(R,S) as the subset of Ld(R,S) formed by the series f (x)
for which Condition (iii) is satisﬁed for a ﬁxed k (i. e. independent of p) and a polynomial
A(x) ∈ Rp[x] with degxi(A(x)) ≤ pk − 1 for all i in {1, . . . , d}.

Again, if there is no risk of confusion, we will simply write Ld(S) instead of Ld(Z,S) and

L(S) instead of L1(Z,S).
Remark 3.7. — Let f (x) ∈ Ld(R,S). Let p be a prime ideal in S such that f (x) ≡
A(x)f(cid:0)xpk(cid:1) mod pRp[[x]] where A(x) belongs to Rp[x] with degxi(A(x)) ≤ pk − 1 for all
i in {1, . . . , d}. Iterating Condition (iii), we observe that for all natural numbers m, we also
have

f (x) ≡ A(x)A(cid:0)xpk(cid:1)··· A(cid:0)xpmk(cid:1)f(cid:0)xp(m+1)k(cid:1) mod pRp[[x]],

9

with

degxi(cid:0)A(x)A(cid:0)xpk(cid:1)··· A(cid:0)xpmk(cid:1)(cid:1) ≤ (pk − 1)(1 + pk + ··· + pkm)

≤ p(m+1)k − 1.

We have the following practical characterization of power series in Ld(R,S) in terms of

congruences satisﬁed by their coeﬃcients.

Deﬁnition 3.8. — We say that the family (a(n))n∈Nd with values in K d satisﬁes the pk-
Lucas property with respect to S if for all maximal ideal p in S, (a(n))n∈Nd takes values in
Rp and

a(v + mpk) ≡ a(v)a(m) mod pRp,

for all v in {0, . . . , pk − 1}d and m in Nd. When S is the set of all maximal ideals of R, then
we say that (a(n))n∈Nd , which takes thus values in R, satisﬁes the pk-Lucas property. When
k = 1, we simply say that (a(n))n∈Nd satisﬁes the p-Lucas property (or the p-Lucas property
with respect to S).
Proposition 3.9. — A power series f (x) :=Pn∈Nd a(n)xn belongs to Ld(R,S) if and only
if there exists a positive integer k such that the family (a(n))n∈Nd satisﬁes a(0) = 1 and has
the pk-Lucas property with respect to S.
We will also say that a power series f (x) :=Pn∈Nd a(n)xn satisﬁes the pk-Lucas property
with respect to S when the family (a(n))n∈Nd satisﬁes the pk-Lucas property with respect
to S.
Proof of Proposition 3.9. — Let f (x) := Pn∈Nd a(n)xn belong to Ld(R,S). By deﬁnition,
there exists a positive integer k such that, for every p in S, one has
f (x) ≡ A(x)f(cid:0)xpk(cid:1) mod pRp[[x]],
(3.1)
where A(x) belongs to Rp[x] and degxi(A(x)) ≤ pk − 1 for all 1 ≤ i ≤ d. Then we can write

and thus

b(v)xv

A(x) = X0≤v≤(pk−1)1
A(x)f(cid:0)xpk(cid:1) = Xm∈Nd X0≤v≤(pk−1)1

b(v)a(m)xv+mpk

.

The congruence satisﬁed by f now implies that

a(v + mpk) ≡ b(v)a(m) mod pRp,

(3.2)
for all m in Nd and all 0 ≤ v ≤ (pk − 1)1. Choosing m = 0, we obtain that a(v) ≡ b(v)
mod pRp for all 0 ≤ v ≤ (pk − 1)1 because a(0) = 1. This shows that the family (a(n))n∈Nd
satisﬁes the pk-Lucas property with respect to S.

Reciprocally, assume that (a(n))n∈Nd is a family with a(0) = 1 that satisﬁes the pk-Lucas

property with respect to S. Then setting

A(x) := X0≤v≤(pk−1)1

a(v)xv ∈ Rp[x]

10

and f (x) :=Pn∈Nd a(n)xn, we immediately obtain that
which shows that f belongs to Ld(R,S).

f (x) ≡ A(x)f(cid:0)xpk(cid:1) mod pRp[[x]],

Contrary to elements of Ld(R,S), those of Ld(R,S) satisfy the following two additional
useful properties. Recall that given two power series f (x) := Pn∈Nd a(n)xn and g(x) =
Pn∈Nd b(n)xn with coeﬃcients in an arbitrary ring, one can deﬁne the Hadamard product of

f and g by

f ⊙ g := Xn∈Nd

a(n)b(n)xn

and the diagonal of f by

∆(f ) :=

∞

Xn=0

a(n, . . . , n)xn .

Proposition 3.10. — Let f (x) and g(x) belong to Ld(R,S). Then the following hold.
(i) f ⊙ g ∈ Ld(R,S).
(ii) ∆(f ) ∈ L1(R,S).
The proof of Proposition 3.10 is straightforward using that the coeﬃcients of f and g satisfy

the pk-Lucas property with respect to S.

4. A criterion for algebraic independence

In this section, we show that any algebraically dependent power series f1, . . . , fn that belong
to Ld(R,S), for an inﬁnite set of primes S, should in fact satisfy a very special kind of relation:
a Laurent monomial is equal to a rational fraction. This provides a simple and useful algebraic
independence criterion for elements of Ld(R,S).
Theorem 4.1. — Let R be a Dedekind domain and f1(x), . . . , fn(x) be power series in
Ld(R,S) where S is an inﬁnite set of primes ideals of R of ﬁnite index. Let K be the fraction
ﬁeld of R. Then the power series f1(x), . . . , fn(x) are algebraically dependent over K(x) if
and only if there exist a1, . . . , as ∈ Z not all zero, such that
f1(x)a1 ··· fn(x)as ∈ K(x).

Remark 4.2. — We actually prove a slightly more precise version of Theorem 4.1:
f1(x), . . . , fn(x) satisfy a polynomial relation of degree at most d over K(x), then

if

f1(x)a1 ··· fn(x)as = A(x) ,

where |a1 + ··· + an| ≤ d, |ai| ≤ d for 1 ≤ i ≤ n, and A(x) is a rational fraction of height at
most 2Cdn. Here C denotes the constant involved in the Landau notation of Condition (iv)
in Deﬁnition 3.1.

11

4.1. A Kolchin-like proposition. — Statements of the type of Proposition 4.3 below
often appear in the study of systems of homogeneous linear diﬀerential/diﬀerence equations
of order one. They are usually associated with the name of Kolchin who ﬁrst proved one
version in the diﬀerential case. We give here a rather general quantitative version in the case
of diﬀerence equations associated with an injective endomorphism. We provide the simple
proof below for the sake of completeness.

Proposition 4.3. — Let A be an integral domain, let σ be an injective endomorphism of A,
and let B be a subring of A such that σ(B) ⊂ B. Let L denote the ﬁeld of fractions of B.
We also write σ for the canonical extension of σ to L. Let f1, . . . , fn be non-zero elements of
A satisfying a non-trivial polynomial relation of degree d with coeﬃcients in L. If there exist
a1, . . . , an in B such that fi = aiσ(fi) for all i in {1, . . . , n}, then there exist m1, . . . , mn ∈ Z,
not all zero, and r ∈ L∗ such that

am1
1

··· amn

n =

σ(r)

r

.

Furthermore, |m1 + ··· + mn| ≤ d and |mi| ≤ d for 1 ≤ i ≤ n.
Proof. — Let P be a polynomial with a minimal number of monomials among the non-zero
polynomials in L[X1, . . . , Xn] of degree at most d satisfying P (f1, . . . , fn) = 0. We write

P (X1, . . . , Xn) = X(i1,...,in)∈I
with ri1,...,in in L \ {0}. By assumption, we have
0 = σ(cid:0)P (f1, . . . , fn)(cid:1) = X(i1,...,in)∈I
= X(i1,...,in)∈I

(4.1)

σ(ri1,...,in)σ(f1)i1 ··· σ(fn)in

σ(ri1,...,in)

ri1,...,inX i1

1 ··· X in
n ,

n

f i1
1 ··· f in
ai1
1 ··· ain

n

.

Let ﬁx i0 = (s1, . . . , sn) in I. We also have

(4.2)

σ(ri0)P (f1, . . . , fn) = 0.

By multiplying (4.1) by ri0as1
n and subtracting (4.2), we obtain a new polynomial in
L[X1, . . . , Xn] of degree less than or equal to d, vanishing at (f1, . . . , fn), but with a smaller
number of monomials, so this polynomial has to be zero. Since all the fi’s are non-zero, the
cardinality of I is at least equal to 2. It follows that there exists i1 = (t1, . . . , tn) in I, i1 6= i0,
such that

1 ··· asn

which leads to

ri0σ(ri1)as1−t1

1

. . . asn−tn

n

= σ(ri0)ri1,

as1−t1
1

. . . asn−tn

n

=

σ(ri0)ri1
ri0σ(ri1)

.

Hence it suﬃces to take mi = si − ti and r = ri0/ri1. Furthermore, since P has total degree
at most d, we have |m1 + ··· + mn| ≤ d and |mi| ≤ d, for 1 ≤ i ≤ n.

12

4.2. Reduction modulo prime ideals. — We can now proceed with the proof of Theo-
rem 4.1. We ﬁrst recall the following simple lemma.

Lemma 4.4. — Let R be a Dedekind domain, K its ﬁeld of fractions and f1, . . . , fn power
series in K[[x]]. Let S denote an inﬁnite set of prime ideals of R such that f1, . . . , fn belong
to Rp[[x]] for every p in S. If f1|p, . . . , fn|p are linearly dependent over R/p for all ideals p in
S, then f1, . . . , fn are linearly dependent over K.
Proof. — Let ai(n) denote the n-th coeﬃcient of the power series fi. Let us consider

a1(0) a1(1) a1(2)
a2(0) a2(1) a2(2)

...

...

...

an(0) an(1) an(2)




,

···
···
. . .
···




the n×∞ matrix whose coeﬃcient in position (i, j) is ai(j − 1). By assumption, f1|p, . . . , fn|p
are linearly dependent over R/p for all p in S. This implies that, for such a prime ideal, every
n × n minor has determinant that vanishes modulo p. In other words, every n × n minor has
determinant that belongs to pRp. Since R is a Dedekind domain, a non-zero element in K
belongs to only ﬁnitely many ideals pRp. Since S is inﬁnite, we obtain that all n × n minors
are actually equal to zero in K. This means that the set of all column vectors of our matrix
generate a vector space E of dimension less than n. Hence there is a non-zero linear form
on K n which vanishes on E and we obtain a non-zero vector (b1, . . . , bn) in K n such that

We can now complete the proof of Theorem 4.1.

i=1 bifi = 0. Thus f1, . . . , fn are linearly dependent over K.

Pn
Proof of Theorem 4.1. — Let f1(x), . . . , fn(x) in Ld(R,S) be algebraically dependent over
K(x). Let Q(x, y1, . . . , yn) be a non-zero polynomial in R[x][y1, . . . , yn] of total degree at
most d in y1, . . . , yn such that

Q(cid:0)x, f1(x), . . . , fn(x)(cid:1) = 0.

With all p in S, we associate a prime number p such that the residue ﬁeld R/p is a ﬁnite ﬁeld
of characteristic p. Let dp be the degree of the ﬁeld extension R/p over Fp. By Deﬁnition 3.1,
for all i in {1, . . . , n}, there exists a positive real number Ci such that, for all p in S, there
are positive integers ki and Ai(x) in K(x) ∩ Rp[[x]] satisfying
fi(x) ≡ Ai(x)fi(cid:0)xpki(cid:1) mod pRp[[x]],

with H(Ai) ≤ Cipki. We set C := 2 max(C1, . . . , Cn) and k := lcm(dp, k1, . . . , kn). Hence by
Remark 3.3, for all i in {1, . . . , n} and all p in S, there exists Bi(x) in K(x)∩ Rp[[x]] satisfying

fi(x) ≡ Bi(x)fi(cid:0)xpk(cid:1) mod pRp[[x]],

with H(Bi) ≤ Cpk.
Since Q is non-zero and R is a Dedekind domain, the coeﬃcients of Q belong to at most
ﬁnitely many prime ideals p of S. There thus exists an inﬁnite subset S ′ of S such that,
for every p in S ′, Q|p is a non-zero polynomial in (R/p)[x][y1, . . . , yn] of total degree at most
d in y1, . . . , yn that vanishes at (f1|p(x), . . . , fn|p(x)). We can thus apply Proposition 4.3 to

13

f1|p, . . . , fs|p with A := (R/p)[[x]], B := (R/p)(x) ∩ A, L = (R/p)(x) and σ the injective
endomorphism of A deﬁned by

σ(cid:0)g(x)(cid:1) = g(cid:0)xpk(cid:1) = g(x)pk

, (g(x) ∈ A),

where the last equality holds because dp divides k. Then Proposition 4.3 implies that there
exist integers m1, . . . , ms, not all zero, and a non-zero rational fraction r(x) in (R/p)(x) such
that

(4.3)

B1(x)m1 ··· Bn(x)mn =

r(cid:0)xpk(cid:1)

r(x)

= r(x)pk−1.

By Remark 3.2, the constant coeﬃcient in the left-hand side of (4.3) is equal to 1. It thus
follows that the constant coeﬃcient of the power series r is non-zero. We can thus assume
without any loss of generality that the constant coeﬃcient of r is equal to 1. Furthermore,
we have |m1 + ··· + mn| ≤ d and |mi| ≤ d for 1 ≤ i ≤ n. Note that the rational fractions
Bi, r and the integers mi all depend on p. However, since all the mi’s belong to a ﬁnite set,
the pigeonhole principle implies the existence of an inﬁnite subset S ′′ of S ′ and of integers
t1, . . . , tn independent of p such that, for all p in S ′′, we have mi = ti for 1 ≤ i ≤ n. Assume
now that p is a prime ideal in S ′′ and write r(x) = s(x)/t(x) with s(x) and t(x) in (R/p)[x]
and coprime. Since H(Bi) ≤ Cpk, the degrees of s(x) and t(x) are bounded by

Set

pk
C(cid:0)|t1| + ··· + |tn|(cid:1) ≤ 2Cdn.
pk − 1
h(x) := f1(x)−t1 ··· fn(x)−tn ∈ K[[x]].
h|p(cid:0)xpk(cid:1) ≡ f1|p(cid:0)xpk(cid:1)−t1 ··· fn|p(cid:0)xpk(cid:1)−tn mod pRp[[x]]

Then, for every p in S ′′, we obtain that

≡ f1|p(x)−t1 ··· fn|p(x)−tnB1(x)t1 ··· Bn(x)tn mod pRp[[x]]
≡ h|p(x)r(x)pk−1 mod pRp[[x]].

Since h|p is not zero, we obtain that h|p(x)pk−1 ≡ r(x)pk−1 and there is a in a suitable
algebraic extension of R/p such that h|p(x) = ar(x). But, the constant coeﬃcients of both
h|p and r are equal to 1, and hence h|p(x) = r(x). Thus, for inﬁnitely many prime ideals p,
the reductions modulo p of the power series xm
i , 1 ≤ i ≤ d, 0 ≤ m ≤ 2Cdn, are
linearly independent over R/p. Since R is a Dedekind domain, Lemma 4.4 implies that these
power series are linearly dependent over K, which means that h(x) belong to K(x). This
ends the proof.

i h(x) and xm

5. Algebraic functions in Ld(R,S) and Ld(R,S)

The aim of this section is to describe which power series among Ld(R,S) and Ld(R,S) are
algebraic over K(x). Here, we keep the notation of Section 3, we ﬁx a Dedekind domain R and
K still denotes the fraction ﬁeld of R. For every prime ideal p of R of ﬁnite index, we write dp
for the degree of the ﬁeld extension R/p over Fp. As a consequence of Theorem 4.1, we deduce
the following generalization of the main result of [4]. In their Theorem 1, Allouche, Gouyou-
Beauchamps and Skordev [4] characterize the algebraic power series of one variable with

14

rational coeﬃcients that have the p-Lucas property with respect to primes in an arithmetic
progression of the form 1 + sN.

Proposition 5.1. — Let f (x) be in Ld(R,S) for an inﬁnite set S. Assume that f (x) is
algebraic over K(x) of degree less than or equal to κ. Then there exists a rational fraction
r(x) in K(x), with r(0) = 1, and a positive integer a ≤ κ such that f (x) = r(x)1/a.
Reciprocally, if f (x) = r(x)1/a where r(x) is in K(x), with r(0) = 1, and a is a positive
integer, then f (x) belongs to Ld(R,S) where S is the set of all prime ideals p of R such that
r(x) ∈ Rp(x) and R/p is a ﬁnite ﬁeld of characteristic in 1 + aN.
Proof of Proposition 5.1. — Let us ﬁrst assume that there is an inﬁnite set S such that f
belongs to Ld(R,S) and is algebraic. We can apply Theorem 4.1 in the case of a single
function. We obtain that there exists a positive integer a ≤ κ and a rational fraction r(x) in
K(x) such that f (x)a = r(x), and r(0) = 1 as expected.

Conversely, assume that there is a positive integer a ≤ κ such that f (x) = r(x)1/a with
r(x) in K(x) and r(0) = 1. Of course, f is algebraic over K(x) with degree at most κ. Let
p be a prime ideal of R such that r(x) ∈ Rp(x) and R/p is a ﬁnite ﬁeld of characteristic p in
1 + aN. Note that there exists a natural number b such that p = 1 + ab, and thus we have
f (x)p−1 = f (x)ab = r(x)b. This gives f (x) = r(x)−bf (x)p and thus

f (x) = r(x)−b(1+p+···+pdp−1)f (x)pdp .

It follows that

with A(x) in K(x) ∩ Rp[[x]] and H(A) ≤ 2bpdp−1H(r) ≤ 2H(r)pdp. This shows that f and p
satisfy Conditions (i)–(iv) in Deﬁnition 3.1, as expected.

f (x) ≡ A(x)f(cid:0)xpdp(cid:1) mod pRp[[x]],

We also have the following similar characterization of algebraic formal power series in

Ld(R,S).
Proposition 5.2. — Let f (x) be in Ld(R,S) for an inﬁnite set S. Assume that f (x) is
algebraic over K(x) of degree less than or equal to κ. Then there exists a polynomial P (x)
in K[x], with P (0) = 1, and a positive integer a ≤ κ such that f (x) = P (x)−1/a with
degxi(P (x)) ≤ a for all i in {1, . . . , d}.
Reciprocally, if f (x) = P (x)−1/a where P (x) is in K[x], with P (0) = 1, and a is a positive
integer such that degxi(P (x)) ≤ a for all i in {1, . . . , d}, then for every prime ideal p in R
such that P (x) is in Rp[x] and R/p is a ﬁnite ﬁeld of characteristic p in 1 + aN, f (x) satisﬁes
the pdp-Lucas property.

Proof. — Let us ﬁrst assume that there is an inﬁnite set S such that f belongs to Ld(R,S)
and is algebraic. By Proposition 5.1, there are a positive integer a ≤ κ and a rational fraction
r(x) in K(x), with r(0) = 1, such that f (x) = r(x)1/a. We write r(x) = s(x)/t(x) with
s(x) coprime to t(x) and s(0) = t(0) = 1. Since the resultant of s(x) and t(x) is a non-zero
element of K, there exists an inﬁnite subset S ′ of S such that s|p(x) and t|p(x) are coprime and
non-zero for all prime ideals p in S ′. We ﬁx p in S ′ and we let p be the characteristic of R/p.
By assumption, there exist a positive integer k and A(x) in Rp[x], with degxi(A) ≤ pk − 1 for
all i in {1, . . . , d}, such that

f (x) ≡ A(x)f (xpk

) mod pRp[[x]].

15

By Remark 3.7, we can assume that dp divides k. This yields
f (x)pk−1 ≡ A(x)−1 mod pRp[[x]]

and

t(x)pk−1 ≡ s(x)pk−1A(x)a mod pRp[[x]] .

(5.1)
Since t|p(x) is coprime to s|p(x) and s(0) = 1, we deduce that s|p(x) = 1. Since S ′ is inﬁnite,
we obtain s(x) = 1, as expected. Finally, we have degxi(t) ≤ a for all i in {1, . . . , d}. Indeed,
Congruence (5.1) implies that degxi(t|p) ≤ a for all i in {1, . . . , d} and all p in S ′.

Conversely, assume that f (x) = P (x)−1/a where P (x) is in K[x], with P (0) = 1, and a is
a positive integer such that degxi(P (x)) ≤ a for all i in {1, . . . , d}. Let p be a prime ideal in
R such that P (x) is in Rp[x] and R/p is a ﬁnite ﬁeld of characteristic p in 1 + aN. Following
the proof of Proposition 5.1, we obtain that

where b satisﬁes p = 1 + ab. It follows that

f (x) = P (x)b(1+p+···+pdp−1)f (x)pdp ,

f (x) ≡ A(x)f(cid:0)xpdp(cid:1) mod pRp[[x]],

with A(x) in Rp[x] and degxi A(x) ≤ pdp − 1 as expected.
Remark 5.3. — With these ﬁrst principles in hand, one can already deduce non-trivial
results. As a direct consequence of Proposition 5.2 with R = Z, we get that the bivariate
1−x(1+y) satisﬁes the p-Lucas property for all prime numbers p, which is equivalent
power series
to Lucas’ theorem since we have

1

1

1 − x(1 + y)

= Xn,k≥0(cid:18)n

k(cid:19)xnyk .

Using Proposition 3.10 and Proposition 5.2, we also obtain that given any polynomial P (x)
in Q[x] with P (0) = 1, then we have

for every positive integer a ≥ max{degxi(P (x)) : 1 ≤ i ≤ d} and

∆(cid:18)

1

P (x)1/a(cid:19) ∈ L(S),

S =(cid:8)p ∈ P : p ≡ 1 mod a and P (x) ∈ Z(p)[x](cid:9).

This has interesting consequences. Choosing for instance P (x1, . . . , xd) = 1 − (x1 + ··· + xd)
and a = 1, we deduce from Proposition 3.10 that for every positive integer t the power
series P∞
xn satisﬁes the p-Lucas property for all prime numbers p. Choosing
n=0(cid:0)
P (x1, x2, x3, x4) = (1 − x1 − x2)(1 − x3 − x4) − x1x2x3x4 and a = 1, we recover a classical
result of Gessel [30]: the sequence of Apr´ery numbers

n,n,...,n(cid:1)t

dn

  n
Xk=0(cid:18)n

k(cid:19)2(cid:18)n + k

k (cid:19)2!n≥0

satisﬁes the p-Lucas property for all prime numbers p (∗).

*. The fact that the diagonal of 1/P is the generating series of the Ap´ery numbers can be found in [48].

16

6. From asymptotics and singularity analysis to algebraic independence

In this section, we emphasize the relevance of Theorem 4.1 for proving algebraic indepen-
dence by using complex analysis. We ﬁx a Dedekind domain R ⊂ C and an inﬁnite set
S of prime ideals of R of ﬁnite index. We still write K for the fraction ﬁeld of R. Let
f1(x), . . . , fn(x) be power series in Ld(R,S) algebraically dependent over C(x). By Proposi-
tion 6.2 below, those power series are algebraically dependent over K(x). Then Theorem 4.1
yields integers a1, . . . , an, not all zero, and a rational fraction r(x) in K(x) such that

(6.1)

f1(x)a1 ··· fn(x)an = r(x) .

We will describe in this section some basic principles that allow to reach a contradiction
with (6.1) and that thus lead to the algebraic independence of the fi’s. The key feature
when dealing with one-variable complex functions is that one can derive a lot of information
from the study of their singularities and asymptotics for their coeﬃcients. It is well-known
that asymptotics of coeﬃcients of analytic functions and analysis of their singularities are
intimately related and there are strong transference theorems that allow to go from one to
the other viewpoint. This connection is for instance described in great detail in the book of
Flajolet and Sedgewick [28].

Remark 6.1. — If the multivariate functions f1(x), . . . , fn(x) in Ld(R,S) are algebraically
dependent over K(x), then the univariate power series fi(λ1xn1, . . . , λdxnd), 1 ≤ i ≤ n, where
λi ∈ C∗ and ni ≥ 1, are algebraically dependent over K(x). We thus stress that the principles
described in this section could also be used to prove the algebraic independence of multivariate
functions.

As announced above, we have the following result.

Proposition 6.2. — Let K be a subﬁeld of C and f1(x), . . . , fn(x) be power series in K(x)
algebraically dependent over C(x). Then those power series are algebraically dependent over
K(x).

Proof. — Let P (Y1, . . . , Yn) be a non-zero polynomial with coeﬃcients in C[x] such that
P (f1(x), . . . , fn(x)) = 0. Let w1(x), . . . , wr(x) be the coeﬃcients of P . Since the wi’s
are polynomials, their coeﬃcients span a ﬁnitely generated ﬁeld extension of K, say L =
K(t1, . . . , ts, ϕ) where t1, . . . , ts are complex numbers algebraically independent over K and
ϕ is a complex number algebraic over K(t1, . . . , ts) of degree h. Let m be the maximum of
the partial degrees of the wi’s. By multiplying P by a suitable polynomial in K[t1, . . . , ts],
we may assume that

wi(x) = X0≤k≤m1

λi(j, k, ℓ)tjϕℓ
 xk,

h−1

Xℓ=0 Xj∈Jk,ℓ




where the sets Jk,ℓ are ﬁnite and the coeﬃcients λi(j, k, ℓ) belong to K and are not all zero.
Hence there are pairwise distinct a1, . . . , ar in Nn such that

(6.2)

h−1

Xℓ=0

r


Xi=1 X0≤k≤m1 Xj∈Jk,ℓ


λi(j, k, ℓ)tjxkf (x)ai

 ϕℓ = 0,

17

where f (x) denotes (f1(x), . . . , fn(x)). By expanding the left-hand side of (6.2), we obtain a
power series in x whose coeﬃcients are polynomial of degree at most h−1 in ϕ with coeﬃcients
in K(t1, . . . , ts). Hence the latter coeﬃcients are zero and, for every ℓ, we have

(6.3)

X0≤k≤m1 Xj∈Jk,ℓ  r
Xi=1

λi(j, k, ℓ)xkf (x)ai! tj = 0.

Since the variables x1, . . . , xd are algebraically independent over C, the complex numbers
t1, . . . , ts are still algebraically independent over K(x) and Equation (6.3) yields a non-trivial
polynomial relation over K(x) for the fi’s.

6.1. General principle. — We write L(R,S) for L1(R,S) and we let C{z} denote the set
of complex functions that are analytic at the origin. For such a function f (z), we denote by
ρf its radius of convergence. We recall that when ρf is ﬁnite, f must have a singularity on
the circle |z| = ρf .
Deﬁnition 6.3. — Let W denote the set of all analytic functions f (z) in C{z} whose radius
of convergence is ﬁnite and for which there exists z ∈ C, |z| = ρf , such that no positive integer
power of f admits a meromorphic continuation to a neighborhood of z.

Proposition 6.4. — Let f1(z), . . . , fn(z) be functions that belong to L(R,S) ∩ W for an
inﬁnite set S, and such that ρf1, . . . , ρfn are pairwise distinct. Then f1(z), . . . , fn(z) are
algebraically independent over C(z).

Proof. — Let us assume by contradiction that f1, . . . , fn are algebraically dependent over
C(z). By Proposition 6.2, they are algebraically dependent over K(z). Since the fi’s belong
to L(R,S), we can ﬁrst apply Theorem 4.1. We obtain that there exist integers a1, . . . , an,
not all zero, and a rational fraction r(z) in K(x) such that
f1(z)a1 ··· fn(z)an = r(z) .

(6.4)

Thereby, it suﬃces to prove that (6.4) leads to a contradiction. We can assume without loss
of generality that ρf1 < ··· < ρfn. Let j be the smallest index for which aj 6= 0. We obtain
that

(6.5)

fj(z)aj = r(z)fj+1(z)−aj+1 ··· fn(z)−an .
We can assume that aj is positive since otherwise we could write
fj(z)−aj = r(z)−1fj+1(z)aj+1 ··· fn(z)an .

By assumption, the function fj(z) belongs to W and has thus a singularity at a point z0 ∈ C
with |z0| = ρfj and such that f aj
j has no meromorphic continuation to a neighborhood of z0.
But the right-hand side is clearly meromorphic in a neighborhood of z0. Hence we have a
contradiction. This ends the proof.

Remark 6.5. — The set W contains all functions f (z) in C{z} with a ﬁnite radius of con-
vergence and whose coeﬃcients a(n) satisfy:

a(n) ∈ R≥0

and a(n) = O  ρ−n

n ! ·

f

18

Indeed, for such a function there exist positive constants C1 and C2 such that, for all z in C
satisfying ρf

2 < |z| < ρf , we have

|f (z)| ≤ |a(0)| + C1

∞

(|z|/ρf )n
Xn=1
≤ −C2 log(cid:18)1 − |z|
ρf(cid:19) .

n

By Pringsheim’s theorem, f has a singularity at ρf . If f is not in W, then there exists a
positive integer r such that f r is meromorphic at ρf . On the other hand, the inequality above
shows that f r cannot have a pole at ρf . Thus f r is analytic at ρf and f r(z) has a limit as z
tends to ρf . But if this limit is non-zero, then f would be also analytic at ρf , a contradiction.
It follows that

lim
z→ρf

f (z) = 0 ,

but this is impossible because the coeﬃcients of f are non-negative (and not all zero since ρf
is ﬁnite). Hence f (z) belongs to W.

Here is a ﬁrst example illustrating the relevance of Proposition 6.4.

Theorem 6.6. — Set

∞

n(cid:19)r
Xn=0(cid:18)2n

F :=(fr(z) :=

zn : r ≥ 2) .
Then all elements of F are algebraically independent over C(z).
In [2], the ﬁrst two authors proved that all functions fr(z), r ≥ 4, are algebraically inde-
pendent. Note that Theorem 6.6 is optimal since f1(z) = 1/√1 − 4z is an algebraic function.
Proof. — Let r ≥ 2 be an integer. We ﬁrst observe, as a direct consequence of Lucas’ theorem,
that the functions fr all satisfy the p-Lucas property for all primes. Hence fr belongs to L(P).
Using Stirling formula, we also get that

This shows that ρfr = 2−2r. By Remark 6.5, it follows that fr(z) ∈ W since r ≥ 2 implies
that

n(cid:19)r
(cid:18)2n

∼n→∞

2(2n+1/2)r
(2πn)r/2 ·

2(2n+1/2)r
(2πn)r/2

= O  ρ−n

n ! .

fr

The result then follows from a direct application of Proposition 6.4.

In Proposition 6.4 and the application above, we use the fact that the radius of convergence
of the involved functions are all distinct. We observe below that this condition is not necessary
to apply our method.
Proposition 6.7. — Let f1(z) and f2(z) be two transcendental functions in L(R,S) with
same ﬁnite positive radius of convergence ρ. Assume that f1 and f2 have a singularity at a
point z0 ∈ C, with |z0| = ρ, such that the following hold.
(i) There is no (C, α) in C∗ × Q such that f1(tz0) ∼t→1

C(t − 1)α.

t∈(0,1)

19

(ii)

lim
t→1
t∈(0,1)

f2(tz0) = l ∈ C∗.

Then f1(z) and f2(z) are algebraically independent over C(z).

Proof. — Let us assume that f1 and f2 are algebraically dependent over C(z) and hence over
K(z) by Proposition 6.2. Since f1(z) and f2(z) belong to L1(R,S), we can apply Theorem 4.1.
We obtain that there exist a1, a2 ∈ Z, not both equal to 0, and a rational function r(z) such
that

(6.6)

f1(z)a1 f2(z)a2 = r(z) .

Thereby, it suﬃces to prove that (6.6) leads to a contradiction. Note that since f1 and f2
are transcendental, we have a1a2 6= 0. Without loss of generality we can assume that a1 ≥ 1.
Hence, we have

f1(tz0) ∼t→1

t∈(0,1)

r(tz0)1/a1 ℓ−a2/a1 ,

which contradicts Assertion (i). This ends the proof.

Let us give a ﬁrst example of application of Proposition 6.7.

Theorem 6.8. — The functions

(4n)!
(2n)!n!2 zn

and

∞

Xn=0

are algebraically independent over Q(z).

∞

Xn=0  n

Xk=0(cid:18)n

k(cid:19)6! zn

Proof. — Using Stirling formula, we obtain that

(6.7)

(4n)!
(2n)!n!2 ∼n→∞

26n
πn

,

while a result of McIntosh [40] (stated in the proof of Theorem 9.8) gives that

(6.8)

P∞

n

k(cid:19)6
Xk=0(cid:18)n

∼n→∞

26n

.

p6(πn/2)5

a(n) ∼n→∞

αnns

Γ(s + 1)

Ciωn
i ,

m

Xi=0

By Flajolet’s asymptotic for algebraic functions (see [26]), we know that if a power series

n=0 a(n)zn in Q[[z]] is algebraic over Q(z), then we have

where s ∈ Q \ Z<0 and α, the Ci’s and the ωi’s are algebraic numbers. Since Γ(−3/2) is a
rational multiple of √π and π is a transcendental number, we obtain that
k(cid:19)6! zn

(4n)!
(2n)!n!2 zn

and f2(z) :=

f1(z) :=

∞

∞

Xn=0  n

Xk=0(cid:18)n

are both transcendental over Q(z). It follows that f1 and f2 have the same radius of conver-
gence ρ = (1/2)6. Furthermore, (6.7) shows that f1 does satisfy Assumption (i) of Proposi-
tion 6.7. Indeed, (6.7) shows that f1 has a logarithmic singularity at ρ which is not compatible
with an asymptotic of the form C(z − ρ)α. On the other hand, (6.8) shows that f2 satisﬁes

Xn=0

20

Assumption (ii) of Proposition 6.7. As we will prove in Section 8, f1 and f2 both belong to
L(P), we can apply Proposition 6.7 to conclude.
6.2. Singularities of G-functions and asymptotics of their coeﬃcients. — We are
mainly interested in G-functions so we will focus on elements in sets of the form L1(OK ,S)
(also denoted by L(OK,S)), where OK is the ring of integers of a number ﬁeld K assumed
to be embedded in C. In this case, it is well-known that K is the fraction ﬁeld of OK which
is a Dedekind domain. In this section, we brieﬂy recall some background about the kind of
singularities a G-function may have. As we will see, those are subject to severe restrictions.
In particular, this explains why the same kind of asymptotics always come up when studying
the coeﬃcients of G-functions.

Let f be a G-function and L be a non-zero diﬀerential operator in Q[z, d/dz] of minimal
order such that L · f (z) = 0. Then it is known that L is a Fuchsian operator, that is
all its singularities are regular. Furthermore, its exponents at each singularity are rational
numbers. This follows from results of Chudnovsky [16], Katz [32], and Andr´e [7] (see [8]
for a discussion).
In particular, these results have the following consequence. Let ρ be a
singularity of L at ﬁnite distance and consider a closed half-line ∆ starting at ρ and ending at
inﬁnity. Then there is a simply connected open set U ⊃ {0, ρ} such that f admits an analytic
continuation to V := U \ ∆ (again denoted f ) which is annihilated by L. In a neighborhood
W of ρ in V , there exist rational numbers λ1, . . . , λs, natural integers k1, . . . , ks and functions
fi,k(z) in C{z − ρ} such that

s

ki

(6.9)

f (z) =

(z − ρ)λi log(z − ρ)kfi,k(z),

Xk=0
Xi=1
and where λi − λj ∈ Z implies that λi = λj. By grouping terms with λi = λj, we may assume
that if λi − λj is an integer, then i = j.
The following result shows that a G-function that does not belong to the set W should have
a decomposition of a very restricted form on its circle of convergence. Roughly speaking, this
means that transcendental G-functions usually tend to belong to W.

Proposition 6.9. — Let f be a G-function and let ρ be a singularity of f . Then there is a
positive integer m such that f m has an analytic continuation to a neighborhood of ρ which is
meromorphic at ρ if, and only if, in any decomposition of the form (6.9), we have s = 1 and
k1 = 0, that is f (z) = (z − ρ)λg(z) for z ∈ W , where λ ∈ Q and g(z) ∈ C{z − ρ}.
Proof. — Let f be a G-function, ρ be a singularity of f , and let us ﬁx a decomposition for f
of the form (6.9). Assume that there is a positive integer m such that f m has a meromorphic
continuation h to a neighborhood Vρ of ρ. Let (i, k) be a pair such that

λi + ordρfi,k = min{λj + ordρfj,ℓ | 1 ≤ j ≤ s, 0 ≤ ℓ ≤ kj} .

(6.10)
Observe that i is unique because, if λi + ordρfi,k = λj + ordρfj,ℓ, then λi − λj is an integer so
that by assumption i = j. Let κ be the greatest ℓ ∈ {0, . . . , ki} such that

λi + ordρfi,ℓ = λi + ordρfi,k .

For z in W we set

w(z) := f (z)m − (z − ρ)mλi log(z − ρ)mκfi,κ(z)m .

21

Hence, as z tends to ρ in W , we have

w(z)

(z − ρ)mλi log(z − ρ)mκfi,κ(z)m −→ 0 ,

so that

f (z)m

(z − ρ)mλi log(z − ρ)mκfi,κ(z)m −→ 1 ,

which shows that κ = 0 and λi ∈ 1
m Z. In particular, this shows that the pair (i, k) is uniquely
deﬁned by (6.10) and that w(z) admits a meromorphic continuation to a neighborhood of ρ.

We ﬁnish the proof by contradiction while assuming that s ≥ 2 or k1 ≥ 1. Hence, there is

a pair (i′, k′) which minimizes λi′ + ordρfi′,k′ while satisfying

(6.11)
Again, one can show that i′ is unique. Let κ′ be the greatest ℓ ∈ {0, . . . , ki′} such that

λi + ordρfi,0 < λi′ + ordρfi′,k′.

λi′ + ordρfi′,ℓ = λi′ + ordρfi′,k′.

For z in W we set

v(z) := w(z) − (z − ρ)(m−1)λi+λi′ log(z − ρ)κ′

fi,0(z)m−1fi′,κ′(z).

Hence, as z tends to ρ in W , we have

(z − ρ)(m−1)λi+λi′ log(z − ρ)κ′fi,0(z)m−1fi′,κ′(z) −→ 0 ,

v(z)

so that

(z − ρ)(m−1)λi+λi′ log(z − ρ)κ′fi,0(z)m−1fi′,κ′(z) −→ 1 .

w(z)

Since w(z) has a meromorphic continuation to a neighborhood of ρ, this shows that κ′ = 0
and (m − 1)λi + λi′ ∈ Z. We have mλi ∈ Z so λi − λi′ is an integer and i = i′. Thus
(i′, κ′) = (i, 0) which contradicts (6.11). This ends the proof.

6.3. G-functions with integer coeﬃcients. — In this section we focus on G-functions
with integer coeﬃcients. We ﬁrst introduce the following set of analytic functions.

Deﬁnition 6.10. — Let G denote the set of all analytic functions f (z) in C{z} satisfying
the following conditions.

(i) f (z) satisﬁes a non-trivial linear diﬀerential equation with coeﬃcients in Q[z].

(ii) f (z) belongs to Z[[z]].

We observe that elements of G are G-functions. The transcendental elements of G have

speciﬁc singularities.

Proposition 6.11. — Every transcendental f in G has a singularity β ∈ C with |β| < 1
such that no non-zero power of f admits a meromorphic continuation at β.

22

Proof. — Let argue by contradiction. Let f be an element of G such that, for every complex
numbers β with |β| < 1, there is a positive integer n = n(β) such that f n admits a meromor-
phic continuation at β. Since f is a G-function, it has only ﬁnitely many singularities and
they all are at algebraic points. It implies that there exists a polynomial P (z) in Z[z] and a
positive integer N such that g(z) := P (z)f (z)N is holomorphic in the open unit disk. Hence
g is a power series with integer coeﬃcients such that ρg ≥ 1. By the P`olya-Carlson theorem,
g is either a rational fraction or admits the unit circle as a natural boundary. Since g has only
ﬁnitely many singularities, we obtain that g is a rational fraction and f is algebraic, which is
a contradiction.

We have the following generalization of Theorem 6.6 concerning algebraic independence of

Hadamard powers of elements of G.

n=0 a(n)zn be a transcendental function in L(S) ∩ G and

such that

Theorem 6.12. — Let f (z) := P∞
a(n) ≥ 0

and a(n) = O  ρ−n

n ! ·

f

Then the functions f1 := f, f2 := f ⊙ f, f3 := f ⊙ f ⊙ f, . . . are algebraically independent over
C(z).

It
Proof. — By Proposition 6.11, the radius of convergence of f (z) satisﬁes 0 < ρf < 1.
follows that all the fr’s have distinct radius of convergence since ρfr = ρr
f . On the other
hand, Remark 6.5 implies that each fr belongs to W. We can thus apply Proposition 6.4 to
conclude the proof.

In all previous applications of Theorem 4.1, we used some knowledge about asymptotics of
coeﬃcients and/or about the singularities of the functions involved. We give here a general re-
sult that does not require any a priori knowledge of this kind. It applies to any transcendental
element of G which satisﬁes some Lucas-type congruences.

Proposition 6.13. — Let f (z) be a transcendental function in L(S)∩ G. Then the following
hold.
(i) Let λ1, . . . , λn be non-zero rational numbers with distinct absolute values. Then the

series f (λ1z), . . . , f (λnz) are algebraically independent over Q(z).

(ii) The family (cid:8)f (z), f (z2), f (z3), . . .(cid:9) is algebraically independent over Q(z).
Proof. — Let us ﬁrst prove Assertion (i). We ﬁrst note that, for all but ﬁnitely many primes
p in S, the rational numbers λ1, . . . , λn belong to Z(p). We can thus replace S by an inﬁnite
subset S ′ such that this holds for all primes in S ′. Set gi(z) := f (λiz) for every i in {1, . . . , n}.
Taking p in S ′ and using that f (z) belongs to L(S), we obtain that there exist a rational
fraction A(z) and a positive integer k such that f (z) ≡ A(z)f (zpk
) mod pZ(p)[[z]]. This gives:

gi(z) ≡ f (λiz) ≡ A(λiz)f(cid:0)(λiz)pk(cid:1) mod pZ(p)[[z]]
≡ A(λiz)f(cid:0)λizpk(cid:1) mod pZ(p)[[z]]
≡ A(λiz)gi(cid:0)zpk(cid:1) mod pZ(p)[[z]].

We thus have that g1(z), . . . , gn(z) all belong to L(S ′). Let us assume by contradiction that
they are algebraically dependent over Q(z). Then Theorem 4.1 ensures the existence of

23

integers a1, . . . , an, not all zero, and of a rational fraction r(z) in Q(z) such that

(6.12)

g1(z)a1 ··· gn(z)an = r(x).

Without any loss of generality, we can assume that |λ1| < ··· < |λn|. Let j be the largest
index for which aj 6= 0.

Let α denote the inﬁmum of all |β|, where β ranges over all complex numbers such that, for
all n ≥ 1, f (z)n has no meromorphic continuation at β. By Proposition 6.11, we have that
0 < α < 1. We pick now a complex number β such that, for every positive integer n, f (z)n is
not meromorphic at β and such that |(λi/λj)β| < α for all i < j. Then Equation (6.12) can
be rewritten as

j−1

gj(z)aj = r(z)

gi(z)−ai.

Yi=1

We assume that aj > 0, otherwise we would write gj(z)−aj = r(z)−1Qj−1
i=1 gi(z)ai . Our choice
of β ensures, for every i = 1, . . . , j − 1, the existence of a positive integer ni such that gi(z)ni
is meromorphic at z = β/λj . Taking n := gcd(n1, . . . , nj−1), we obtain that gj(z)naj
is
meromorphic at β/λj. This provides a contradiction since no power of f (z) is meromorphic
at β. This proves Assertion (i).

A similar argument handles Assertion (ii).

In that case, we have to choose j to be the
smallest index for which aj 6= 0 and β to be such that for every positive integer n, f (z)n is
not meromorphic at β and such that|βi/j| < α for all i > j. The rest of the proof remains
unchanged.

7. A family of multivariate generalized hypergeometric series and their p-adic

properties

In this section, we introduce a family of multivariate generalized hypergeometric series
denoted by Fu,v(x) and already mentioned in Section 1. Our aim is to deduce from p-adic
properties of their coeﬃcients an eﬃcient condition on the parameters u and v that forces
Fu,v(x) to belong to Ld(S) for an inﬁnite set of primes S. A key idea is then that classical
examples of sequences with the p-Lucas property arise from specializations of particular mul-
tivariate generalized hypergeometric series. As we will see in Section 8, various specializations
of the parameters or of the variables of functions of type Fu,v lead us to prove that interesting
families of G-functions belong to L1(S). This includes generating series associated with facto-
rial ratios, with some sums and products of binomials, and generalized hypergeometric series.
In this direction, we stress that Propositions 7.1, 7.2, and 7.4 allow to recover most examples
in the literature of sequences known to satisfy p-Lucas congruences. They also provide a lot
of new examples.

Let us give now the deﬁnition of our family of multivariate generalized hypergeometric
series. For every tuples u = ((α1, e1), . . . , (αr, er)) and v = ((β1, f1), . . . , (βs, fs)) of elements
in Q × Nd, and every vector n in Nd, we set

Qu,v(n) :=

(α1)e1·n ··· (αr)er·n
(β1)f1·n ··· (βs)fs·n

,

24

where (x)n := x(x + 1)··· (x + n− 1) if n ≥ 1, and (x)0 = 1 denote the Pochhammer symbol.
Then the multivariate power series Fu,v(x) is deﬁned by:

Fu,v(x) := Xn∈Nd

Qu,v(n)xn ∈ Q[[x]] .

We also set

Hd :=(Fu,v(x) : αi, βi ∈ Q ∩ (0, 1] and

ei =

r

Xi=1

fj) .

s

Xj=1

The class of power series H := ∪d≥1Hd contains of course the generalized hypergeometric
series, but also the multivariate Apell and Lauricella hypergeometric series.

7.1. Lucas-type congruences for elements of Hd. — Our aim is to provide an eﬃcient
condition for Fu,v(x) to satisfy the pk-Lucas property for inﬁnitely many primes p. In this
direction, our main result is Proposition 7.2. However, the statement of this result is a bit
technical and requires some notation. We thus choose to ﬁrst state it in a particular case, as
Proposition 7.1, that avoids most of these technical aspects.

Our ﬁrst condition is based on the analytical properties of the following simple step function

deﬁned from Rd to Z:

ξ1(x) :=

r

s

Xi=1
⌊ei · x − αi⌋ −

Xj=1

⌊fj · x − βj⌋ + r − s .

Note that if Fu,v(x) belongs to Hd, then the behavior of ξ1 on Rd is determined by its values
on [0, 1)d because we have

ξ1(x) = ξ1(cid:0){x}(cid:1) +  r
Xi=1

ei −

s

Xj=1

fj! · ⌊x⌋ = ξ1(cid:0){x}(cid:1) .

Let D1

u,v be the semi-algebraic set deﬁned by:

D1
u,v :=(cid:8)x ∈ [0, 1)d : e · x ≥ α for some coordinate (α, e) of either u or v(cid:9) .

Note that outside D1
u,v the step function ξ1 trivially vanishes when the αi’s and βi’s belong to
(0, 1]. We need a last notation before stating our ﬁrst result. We let dα,β stand for the least
common multiple of the denominators of the rational numbers α1, . . . , αr, β1, . . . , βs, written
in lowest form. Then our ﬁrst proposition reads as follows.

Proposition 7.1. — Let Fu,v(x) be in Hd and let us assume that ξ1(x) ≥ 1 for all x in
D1
u,v. Then Fu,v(x) belongs to Ld(S), where

S := {p ∈ P : p ≡ 1 mod dα,β} .

More precisely, Fu,v(x) satisﬁes the p-Lucas property for all primes p in S.

25

Let us illustrate Proposition 7.1 with the following example. Set u := ((1, (2, 1), (1, (1, 1)))

and v := ((1, (1, 0)), (1, (1, 0)), (1, (1, 0)), (1, (0, 1)), (1, (0, 1))). Then

Fu,v(x, y) = X(n,m)∈N2
= X(n,m)∈N2

(1)2n+m(1)n+m

(1)3

n(1)2
m

xnym

(2n + m)!(n + m)!

n!3m!2

xnym .

For all x1 and x2 in [0, 1), we have

ξ1(x1, x2) = ⌊2x1 + x2 − 1⌋ + ⌊x1 + x2 − 1⌋ − 3⌊x1 − 1⌋ − 2⌊x2 − 1⌋ − 3

j=1 fj, α and β are tuples of elements in (0, 1] and dα,β = 1.

= ⌊2x1 + x2⌋ + ⌊x1 + x2⌋ − 3⌊x1⌋ − 2⌊x2⌋
= ⌊2x1 + x2⌋ + ⌊x1 + x2⌋ .
i=1 ei =Ps

Clearly, we have thatPr

Furthermore, we have
u,v =n(x1, x2) ∈ [0, 1)2 : 2x1 + x2 ≥ 1 or x1 + x2 ≥ 1o ,
D1

so that ξ1(x1, x2) ≥ 1, for all (x1, x2) in D1
satisﬁes the p-Lucas property for all prime numbers p.

u,v. Hence we infer from Proposition 7.1 that Fu,v

We are now going to generalize Proposition 7.1 in order to possibly enlarge the set of
primes p for which an element of Hd does satisfy the pk-Lucas property. Towards that goal,
we consider the following generalizations of ξ1 and D1
u,v. For all x ∈ R, we denote by hxi the
unique element in (0, 1] such that x−hxi is an integer. In other words, we have hxi = 1−{1−x},
or equivalently:

hxi =({x}

1

if x /∈ Z,
otherwise.

.

Let a denote an element of {1, . . . , dα,β} which is coprime to dα,β. Then we consider the
following step function from Rd to Z:

r

s

ξa(x) :=

Xi=1(cid:4)ei · x − haαii(cid:5) −

Xj=1(cid:4)fj · x − haβji(cid:5) + r − s .

Furthermore, we consider the semi-algebraic set

u,v :=nx ∈ [0, 1)d : e · x ≥ haαi for some coordinate (α, e) of either u or vo .
Da

If α belongs to Q ∩ (0, 1], then we have hαi = α, so that we recover our initial deﬁnition of ξ1
when a = 1. Our generalization of Proposition 7.1 reads as follows.

Proposition 7.2. — Let Fu,v(x) be in Hd. Let us assume that there exists a subset A of
{1, . . . , dα,β} such that the following hold.

(i) {a mod dα,β : a ∈ A} is a subgroup of (Z/dα,βZ)×.
(ii) For all a in A and all x in Da
u,v, we have ξa(x) ≥ 1.

26

Set k := Card A. Then Fu,v(x) belongs to Ld(S), where

S := {p ∈ P : p ≡ a mod dα,β for some a ∈ A, and p > dα,β} .

More precisely, Fu,v(x) satisﬁes the pk-Lucas property for all primes p in S.
Remark 7.3. — Proposition 7.1 is simply obtained by taking A = {1}. It is worth men-
tioning that in order to apply Proposition 7.2, one always has to check that ξ1(x) ≥ 1 for x
in D1
u,v. Hence Proposition 7.1 applies too. This explains why Proposition 7.1 is suﬃcient
for all our applications concerning algebraic independence. Indeed, for using our algebraic
independence criterion, one only needs to work with inﬁnitely many primes, so that we do
not really care about a precise description of the set S.

Let us illustrate Proposition 7.2 with the following one-variable hypergeometric series. We

set

∞

For all x in [0, 1), we have

F (x) :=

Xn=0
and ξ6(x) = 2⌊x − 1/5⌋ − ⌊x − 5/7⌋ + 1.
ξ1(x) = 2⌊x − 1/5⌋ − ⌊x − 2/7⌋ + 1

(2/7)n(1)n

xn .

(1/5)2
n

Furthermore, we have

D1 = D6 =(cid:8)x ∈ [0, 1) : x ≥ 1/5(cid:9) .

We thus deduce that both ξ1(x) and ξ6(x) are greater than or equal to 1 for all x in D1. Since
dα,β = 35 and 62 ≡ 1 mod 35, we can apply Proposition 7.2 with A = {1} and A = {1, 6}.
We thus deduce that for almost all primes p ≡ 1 mod 35, F (z) satisﬁes the p-Lucas property,
while, for almost all primes p ≡ 6 mod 35, F (z) satisﬁes the p2-Lucas property.

In order to transfer the pk-Lucas property from multivariate series of type Fu,v to one-
variable formal power series, we will use the following useful complement to Proposition 7.2.
Proposition 7.4. — Let Fu,v(x) be in Hd. We keep all assumptions and notation of Propo-
sition 7.2. Set

N :=(cid:8)n ∈ Nd : ∀a ∈ A,∀x ∈ [0, 1)d with n · x ≥ 1, one has ξa(x) ≥ 1(cid:9) .

Let n = (n1, . . . , nd) be in N and (b1, . . . , bd) be a vector of non-zero rational numbers. Then
Fu,v(b1xn1, . . . , bdxnd) belongs to L1(S ′), where

Let us illustrate this result with the example given just after Proposition 7.1, that is with

the function

S ′ :=np ∈ S : (b1, . . . , bd) ∈ Zd

(p)o .

Fu,v(x, y) = X(n,m)∈N2

(2n + m)!(n + m)!

n!3m!2

xnym .

We consider the specialization given by n = (1, 1) and b1 = b2 = 1. Then Proposition 7.4
applies with A = {1} and dα,β = 1, because we already observed that ξ1(x1, x2) ≥ 1 for
all (x1, x2) in [0, 1)2 satisfying x1 + x2 ≥ 1. A small computation shows that we obtain yet
another proof of Gessel’s result stating that the Ap´ery sequence

  n
Xk=0(cid:18)n

k(cid:19)2(cid:18)n + k

k (cid:19)!n≥0

27

satisﬁes the p-Lucas property for all primes p.

Applying Proposition 7.4 to the same function but with the specialization given by n =

(2, 1), b1 = −1 and b2 = 2, we get that

Xn=0


Fu,v(−x2, 2x) =

∞

⌊n/2⌋

Xk=0

also satisﬁes the p-Lucas property for all primes p.

(−1)k2n−2k(cid:18)n

k(cid:19)(cid:18) n − k

n − 2k(cid:19)2
 xn

7.2. Proofs of Propositions 7.2 and 7.4. — We ﬁrst introduce some p-adic tools that
will be useful for proving these results.
7.2.1. p-adic tools for the study of Qu,v. — By Deﬁnition 3.8 and Proposition 3.9, prov-
ing that Fu,v(x) belongs to Ld(S) is the same as proving the pk-Lucas congruence for the
multivariate sequence Qu,v, that is:

Qu,v(n + mpk) ≡ Qu,v(n)Qu,v(m) mod p ,

for all n and m in Nd and all primes p in S. To that purpose, we shall use some classical
techniques associated with Pochhammer symbols to compute the p-adic valuation of Qu,v(n).
These techniques are reminiscent of works of Dwork [24], Katz [31], Christol [13] and, more
recently, Delaygue, Rivoal, and Roques [21]. The following discussion should highlight the
role played by the functions ξa in the proof of Proposition 7.2.

Christol [13] gave a useful formula to compute the p-adic valuation of (a)n where n is a
natural integer, and later Delaygue, Rivoal, and Roques [21] reformulated this result in order
to deduce a formula which may seem closer to the classical one of Legendre:

We recall now this reformulation. We refer the reader to [21, Section 3] for more details on
the following deﬁnitions. For all primes p and all α in Zp ∩ Q, there is a unique element in
Zp, denoted by Dp(α), such that pDp(α) − α belongs to {0, . . . , p − 1}. Hence, if κ0 denotes
the ﬁrst digit in the Hensel expansion of −α, then we have

vp(n!) =

∞

pℓ(cid:23) .
Xℓ=1(cid:22) n

Dp(α) =

α + κ0

·

p

The map Dp was introduced by Dwork in [24], where it is simply denoted by a 7→ a′. For all
positive integers ℓ, we denote by δp,ℓ(α,·) the step function deﬁned, for all real numbers x, by

δp,ℓ(α, x) =(cid:22)x − Dℓ

p(α) − ⌊1 − α⌋

pℓ

(cid:23) + 1 .

By Proposition 4 in [21], if α does not belong to Z≤0, then we get that

vp(cid:0)(α)e·n(cid:1) =

∞

Xℓ=1

δp,ℓ(cid:18)α,

pℓ (cid:19) =
e · n

∞

Xℓ=1

δp,ℓ(cid:18)α, e ·(cid:26) n

pℓ(cid:27)(cid:19) + e ·(cid:0)vp(n1!), . . . , vp(nd!)(cid:1) .

For all primes p that does not divide dα,β, we set

∆p,ℓ

u,v(x) :=

r

Xi=1

δp,ℓ(αi, ei · x) −

s

Xj=1

δp,ℓ(βj , fj · x) ,

28

so that

∞

vp(cid:0)Qu,v(n)(cid:1) =

=

∞

Xℓ=1
Xℓ=1

∆p,ℓ

pℓ(cid:19)
u,v(cid:18) n
pℓ(cid:27)(cid:19) +  r
u,v(cid:18)(cid:26) n
Xi=1

∆p,ℓ

ei −

s

Xj=1

fj! ·(cid:0)vp(n1!), . . . , vp(nd!)(cid:1) .

This formula may seem complicated because the step functions ∆p,ℓ

u,v a priori highly depend
on p and ℓ, but they actually only depend on the congruence class of pℓ modulo dα,β. To
be more precise, let α and β be tuples of elements in Q ∩ (0, 1], p > dα,β be a prime, and
let a be such that apℓ ≡ 1 mod dα,β. Then we have ∆p,ℓ
u,v = ξa. Indeed, if α is a rational
number in (0, 1], then we have ⌊1 − α⌋ = 0 and Lemma 3 in [21] implies that Dℓ
p(α) = haαi,
as expected. Let us denote by ι(pℓ) the unique element of {0, . . . , dα,β} such that ι(pℓ)pℓ ≡ 1
mod dα,β. We thus get the following formula:

which is somewhat reminiscent of Legendre formula.

vp(cid:0)Qu,v(n)(cid:1) =

∞

Xℓ=1

ξι(pℓ)(cid:18) n

pℓ(cid:19) ,

7.2.2. Proof of Proposition 7.2. — We are now ready to prove Propositions 7.2 and 7.4.
Given a tuple of elements in Z(p) × Nd, say w = ((γ1, g1), . . . , (γt, gt)), we set

Dp(w) :=(cid:0)(cid:0)Dp(γ1), g1(cid:1), . . . ,(cid:0)Dp(γt), gt(cid:1)(cid:1).

In order to prove Proposition 7.2, we will need the following lemma.
Lemma 7.5. — Let p > dα,β be a prime and let a in {0, . . . , p − 1}d be such that a/p does
not belong to Dι(p)

j=1 fj, then we have

u,v . If Pr

i=1 ei =Ps

Qu,v(a + mp) ∈ Qu,v(a)QDp(u),Dp(v)(m)(1 + pZ(p)) ,

for all m in Nd.

Proof. — Let (α, e) be a coordinate of either the vector u or v, and let p > dα,β be a prime.
Hence we have α ∈ Z(p) and Dp(α) is well deﬁned. Let m in Nd and a in {0, . . . , p − 1}d be
such that a/p does not belong to Dι(p)
(α)e·(a+mp) = e·mp−1
Yi=0

(α + i)! e·a−1
Yi=0

(α + i + e · mp)! .

u,v . We have

(7.1)

Furthermore, we also have

e·mp−1

p−1

e·m−1

Yi=0

(α + i) =

(α + k + jp)

Yj=0

Yk=0
= pe·m(cid:0)Dp(α)(cid:1)e·m

p−1

Yk=0

k6=pDp(α)−α

(α + k)e·m

e·m−1

Yj=0 (cid:18)1 +

j

α + k

p(cid:19) .

29

If k 6= pDp(α) − α, then α + k ∈ Z×
1 +

(p) and we obtain that

j

α + k

p ∈ 1 + pZ(p) ,

for all non-negative integers j. By Wilson’s theorem, it follows that

This leads to

(7.2)

(α + k) ≡ (p − 1)! ≡ −1 mod pZ(p) .

p−1

Yk=0

k6=pDp(α)−α

e·mp−1

Yi=0

(α + i) ∈ (−p)e·m(cid:0)Dp(α)(cid:1)e·m(1 + pZ(p)) .

In addition, since a/p is not in Dι(p)
Since α ∈ (0, 1] we obtain that e · a − 1 < pDp(α) − α.
0 ≤ i ≤ e · a − 1, we have α + i ∈ Z×

u,v , we have e · a/p < hι(p)αi, that is e · a < pDp(α).
In particular, for all i satisfying
(p). This gives:

e·a−1

Yi=0

(7.3)

(α + i + e · mp) = (α)e·a

We then infer from (7.1), (7.2) and (7.3) that

e·a−1

Yi=0 (cid:18)1 +

e · m
α + i

p(cid:19) ∈ (α)e·a(1 + pZ(p)) .

(7.4)

(α)e·(a+mp) ∈ (α)e·a(−p)e·m(cid:0)Dp(α)(cid:1)e·m(1 + pZ(p)) .

By applying (7.4) to all pairs in u and v, and using that by assumption Pr

we ﬁnally deduce that

i=1 ei = Ps

j=1 fj,

Qu,v(a + mp) ∈ Qu,v(a)QDp(u),Dp(v)(m)(1 + pZ(p)) ,

which ends the proof.

We are now ready to prove Proposition 7.2.

Proof of Proposition 7.2. — Let A be a subset of {1, . . . , dα,β} which satisﬁes Assertions (i)
and (ii) in Proposition 7.2. We recall that

S := {p ∈ P : p ≡ a mod dα,β for some a ∈ A, and p > dα,β} .

Note that if p belongs to S and ℓ is a positive integer, then there exists a in A such that
pℓ ≡ a mod dα,β.
We ﬁrst prove that Fu,v(x) belongs to Z(p)[[x]] for all p in S. Let p in S and n in Nd be
ﬁxed. By assumption, we have Pr
j=1 fj and the elements of α and β belong to
(0, 1] ∩ Z(p). We thus infer from the discussion of Section 7.2.1 that

i=1 ei = Ps
Xℓ=1
vp(cid:0)Qu,v(n)(cid:1) =
For all non-negative integers ℓ, we have ι(pℓ) ∈ A. By Assertion (ii) in Proposition 7.2 and
since ξι(pℓ)(x) = 0 outside Dι(pℓ)
u,v , we deduce that ξι(pℓ)(x) ≥ 0, for all x in [0, 1)d. Hence, we
obtain that vp(cid:0)Qu,v(n)(cid:1) ≥ 0 and thus Fu,v(x) belongs to Z(p)[[x]], as claimed.

ξι(pℓ)(cid:18)(cid:26) n

pℓ(cid:27)(cid:19) .

(7.5)

∞

30

Let k := Card A. Let p be a ﬁxed prime in S. We shall show that Fu,v has the pk-Lucas
property. Let a = a0 + a1p +··· + ak−1pk−1 with ai in {0, . . . , p− 1}d. We need to distinguish
two cases.

• Case 1: there exists an integer i, 0 ≤ i ≤ k − 1, such that ai/p belongs to Dι(pi+1)
In that case, we are going to show that Qu,v(a + mpk) ≡ 0 mod pZ(p), for all m in Nd.

We ﬁrst note that since ι(pℓ) belongs to A, one has ξι(pℓ) ≥ 0 on Rd. We thus get that

u,v

.

vp(cid:0)Qu,v(a + mpk)(cid:1) =

∞

pℓ (cid:27)(cid:19)

ξι(pℓ)(cid:18)(cid:26) a + npk

Xℓ=1
≥ ξι(pi+1)(cid:18) a0 + a1p + ··· + aipi

pi+1

(cid:19) ,

for all m in Nd. Now, since

x :=

a0 + a1p + ··· + aipi

pi+1

≥

ai

p ∈ Dι(pi+1)

u,v

,

we obtain that x ∈ Dι(pi+1)

u,v

, and thus ξι(pi+1)(x) ≥ 1 by Assertion (ii). This gives:

for all m in Nd. Choosing m = 0, we deduce that

Qu,v(a + mpk) ≡ 0 mod pZ(p) ,

Qu,v(a) ≡ 0 mod pZ(p)

and thus

for all m in Nd. This ends the proof in that case.

Qu,v(a + mpk) ≡ Qu,v(a)Qu,v(m) mod pZ(p) ,

• Case 2: for all integers i, 0 ≤ i ≤ k − 1, ai/p does not belong to Dι(pi+1)
We will recursively apply Lemma 7.5 k times. We ﬁrst observe that QDp(u),Dp(v)(n) belongs

to Z(p) for any n in Nd. Indeed, for all a in A and all α in α or β, we have

u,v

.

haDp(α)i =(cid:10)ahι(p)αi(cid:11) = haι(p)αi = hbαi ,
Dp(u),Dp(v) = Db

for some b in A as a consequence of Assertion (i) in Proposition 7.2. Hence the function
Dp(u),Dp(v) = ξb
ξa
u,v. We thus have that both
Qu,v(n) and QDp(u),Dp(v)(n) belong to Z(p) for all n in Nd. Then we infer from Lemma 7.5
that

u,v is non-negative on Rd, and Da

Qu,v(a + mpk) ≡ Qu,v(a0)QDp(u),Dp(v)(a1 + ··· + ak−1pk−2 + mpk−1) mod pZ(p) ,

u,v and Da

Dp(u),Dp(v) = ξb

Dp(u),Dp(v) = Db
for all m in Nd. Since ξa
u,v, it follows that Dp(u)
and Dp(v) satisfy the assumptions of Proposition 7.2 with the same set A. Furthermore, if
a = ι(pℓ), then we obtain that b = ι(pℓ+1), which leads to Dι(pℓ)
. We can
thus apply Lemma 7.5 to Dp(u) and Dp(v), with a1 instead of a. This yields
Qu,v(a+mpk) ≡ Qu,v(a0)QDp(u),Dp(v)(a1)QD2

p(v)(a2+···+ak−1pk−3+mpk−2) mod pZ(p) ,

Dp(u),Dp(v) = Dι(pℓ+1)

p(u),D2

u,v

31

for all m in Nd. By induction, we obtain that

Qu,v(a + mpk) ≡ k−1
Yi=0

QDi

p(u),Di

p(v)(ai)! QDk

p(u),Dk

p (v)(m) mod pZ(p) ,

for all m in Nd. Choosing m = 0, we deduce that
Qu,v(a + mpk) ≡ Qu,v(a)QDk

p (u),Dk

p (v)(m) mod pZ(p) ,

for all m in Nd. Since k = card A, one has pk ≡ 1 mod dα,β. Then for all α in α or β, we
have

since α ∈ (0, 1]. Hence Dk

Dk
p(α) = hι(pk)αi = hαi = α ,

p(u) = u and Dk

p(v) = v, and it follows that
Qu,v(a + mpk) ≡ Qu,v(a)Qu,v(m) mod pZ(p) ,

for all m in Nd. This ends the proof.

Now, we prove Proposition 7.4.

Proof of Proposition 7.4. — Set

N :=(cid:8)n ∈ Nd : ∀a ∈ A,∀x ∈ [0, 1)d with n · x ≥ 1, one has ξa(x) ≥ 1(cid:9) .

Let n = (n1, . . . , nd) be in N , (b1, . . . , bd) be a vector of non-zero rational numbers. Set

(p)o
S′ :=np ∈ S : (b1, . . . , bd) ∈ Zd

and let p be a prime number in S′. We will simply write F for Fu,v and Q for Qu,v. By
Proposition 7.2, the sequence Q(n) has the pk-Lucas property, so that

F (x) ≡

Q(a)xa

This gives:

) mod pZ(p)[[x]] .

 X0≤a≤(pk−1)1
F (b1xn1, . . . , bdxnd) ≡
 X0≤a≤(pk−1)1
≡
 X0≤a≤(pk−1)1

d xndpk(cid:17) mod pZ(p)[[x]]
, . . . , bdxndpk(cid:17) mod pZ(p)[[x]] ,
i ≡ bi mod pZ(p) for all i in {1, . . . , d}. For all a in {0, . . . , pk−1}d satisfying n·a ≥ pk,

since bpk
we have n · a/pk ≥ 1 and thus ξa(a/pk) ≥ 1 for all a in A. It follows that

 F (xpk
 F(cid:16)bpk
 F(cid:16)b1xn1pk

baQ(a)xn·a
baQ(a)xn·a

, . . . , bpk

1 xn1pk

vp(cid:0)Q(a)(cid:1) =

∞

Xℓ=1

ξι(pℓ)(cid:18) a

pℓ(cid:19) ≥ ξι(pk)(cid:18) a

pk(cid:19) ≥ 1 ,

because ξa is non-negative on Rd for every a in A. Thus there is a polynomial A(x) with
coeﬃcients in Z(p) and of degree at most pk − 1 such that

F (b1xn1, . . . , bdxnd) ≡ A(x)F(cid:16)b1xn1pk

, . . . , bdxndpk(cid:17) mod pZ(p)[[x]] .

32

This shows that F (b1xn1, . . . , bdxnd) satisﬁes the pk-Lucas property, as expected.

8. Lucas-type congruences among classical families of G-functions

In Section 7, we gave a general condition involving some step functions ξa(x) that ensures
a function in Hd satisﬁes Lucas-type congruences. Propositions 7.1 and 7.2 actually take a
much simpler form when working with more speciﬁc families of G-functions. We illustrate this
fact by considering ﬁrst two classical families: the generating series of factorial ratios and the
generalized hypergeometric functions. Then we discuss the case of multivariate factorial ratios
and show how their specializations lead to Lucas-type congruences for G-functions involving
various sums and products of binomials, such as those associated with Ap´ery, Franel, Domb,
and Delannoy numbers.

8.1. Generating series of factorial ratios. — Given two tuples of vectors of natural
numbers, e = (e1, . . . , eu) and f = (f1, . . . , fv), the associated sequence of factorial ratio is
deﬁned by

Qe,f (n) := Qu
i=1(ein)!
i=1(fin)! ·
Qv
The generating series of such a sequence is then denoted by
Fe,f (x) := Xn∈N
Qe,f (n)xn .

In order to study when Qe,f (n) is integer valued, Landau introduced the following simple step
function ∆e,f deﬁned from R to Z by:

∆e,f (x) :=

u

Xi=1

⌊eix⌋ −

v

Xj=1
⌊fjx⌋ .

According to Landau’s criterion [36], and Bober’s reﬁnement [12], we have the following
dichotomy.

• If, for all x in [0, 1], one has ∆e,f (x) ≥ 0, then Qe,f (n) ∈ N, for all n ≥ 0.
• If there exists x in [0, 1] such that ∆e,f (x) < 0, then there are only ﬁnitely many prime

numbers p such that Qe,f (n) belongs to Z(p) for all n ≥ 0.

In the sequel, we always assume that the sets {e1, . . . , eu} and {f1, . . . , fv} are disjoint. We
set |e| :=Pu

i=1 fi, and
me,f := (max{e1, . . . , eu, f1, . . . , fv})−1 .

i=1 ei, |f| :=Pv

Note that the functions of type Fe,f correspond to functions of type Fu,v for which the
parameter d, as well as all the parameters αi and βi, are equal to 1. Propositions 7.1 and 7.2
can now be restated in a single result that takes the following simple form.

Proposition 8.1. — Let us assume that |e| = |f| and that ∆e,f (x) ≥ 1, for all real numbers
x such that me,f ≤ x < 1. Then Fe,f (x) ∈ L1(P).
In other words, Fe,f (x) satisﬁes the
p-Lucas property for all prime numbers p.

33

Remark 8.2. — When all the fi’s are equal to 1, it becomes obvious that ∆e,f (x) ≥ 1, for
all real numbers x such that me,f ≤ x < 1. This shows that all generating series of the form

∞

Xn=0Qr

i=1(ein)!
(n!)r

xn ,

where e1, . . . , er are positive integers, satisfy the p-Lucas property for all prime numbers p.

We also prove the following reﬁnement of Proposition 8.1.

Proposition 8.3. — The following assertions are equivalent.

(i) There exists an inﬁnite set of primes S such that Fe,f (x) ∈ L1(S).

(ii) The sequence Qe,f is integer-valued and has the p-Lucas property for all primes p.

(iii) We have |e| = |f| and ∆e,f (x) ≥ 1 for all real numbers x such that me,f ≤ x < 1.
Remark 8.4. — The equivalence of Assertions (ii) and (iii) is contained in [20, Theorem 3].
A consequence of Proposition 8.3 is that Fe,f (x) belongs to L1(S) for an inﬁnite set of primes
S if and only if all Taylor coeﬃcients at the origin of the associated mirror map ze,f are
integers (see Theorems 1 and 3 in [18]). It would be interesting to investigate in more details
this intriguing connection.

Proof of Proposition 8.3. — Obviously, Assertion (ii) implies Assertion (i), and Assertions (ii)
and (iii) are shown to be equivalent in [20, Theorem 3]. Hence it suﬃces to prove that (i)
implies (iii). From now on, we assume that Assertion (i) holds.

First, we prove that |e| = |f|. Since S is inﬁnite and Fe,f (x) belongs to Zp[[x]] for
every prime p in S, Landau’s criterion implies that ∆e,f (x) ≥ 0 for all x in [0, 1].
In
particular, we obtain that |e| − |f| = ∆e,f (1) ≥ 0.
If |e| > |f| then ∆e,f (1) ≥ 1. Set
Me,f := max{e1, . . . , eu, f1, . . . , fv}. Then, for all prime numbers p > Me,f and all positive
integers k, we have

∞

vp(cid:0)Qe,f (1 + pk)(cid:1) =

∆e,f(cid:18) 1 + pk
pℓ (cid:19)
pk(cid:19)

Xℓ=1
≥ ∆e,f(cid:18)1 +
≥ 1 ,

1

Our choice of p ensures that vp(Qe,f (1)) = 0. We thus deduce that, for almost all primes p
and all positive integers k, we have

Qe,f (1 + pk) 6≡ Qe,f (1)Qe,f (1) mod pZ(p) ,

which provides a contradiction with Assertion (i). Hence we get that |e| = |f|.

34

Now, we prove the following identity. For all prime numbers p, all positive integers k, all a

in {0, . . . , pk − 1}, and all natural integers n, we have
Yj=1 (cid:18)1 +
Yj=1 (cid:18)1 +

Qe,f (a + npk)
Qe,f (a)Qe,f (n) ∈

Yi=1
Yi=1

⌊fia/pk⌋

⌊eia/pk⌋

(8.1)

u

v

ei
j

fi
j

n(cid:19)
n(cid:19)(cid:0)1 + pZ(p)(cid:1) .

Indeed, we have

Qe,f (a + npk)
Qe,f (a)Qe,f (n)

= Qe,f (a + npk)
Qe,f (a)Qe,f (npk)

k−1

Yj=0

Qe,f (npj+1)
Qe,f (npj) ·

Since |e| = |f|, we can apply [19, Lemma 7] (∗) with d = 1, c = 0, m = npj and s = 0 which
leads to

Furthermore, we have

Qe,f (a + npk)
Qe,f (a)Qe,f (npk)

1

=

j=1(j + einpk)
j=1(j + finpk)

Qe,f (npj+1)
Qe,f (npj) ∈ 1 + pZ(p) .
Qe,f (a)Qu
i=1Qeia
i=1Qfia
Qv
j=1(cid:16)1 + einpk
j (cid:17)
i=1Qeia
= Qu
j (cid:17)
j=1(cid:16)1 + finpk
i=1Qfia
Qv
i=1Q⌊eia/pk⌋
j (cid:17)
(cid:16)1 + ein
∈ Qu
j (cid:17)(cid:0)1 + pZ(p)(cid:1) ,
(cid:16)1 + fin
i=1Q⌊fia/pk⌋
Qv

j=1

j=1

since, if pk does not divide j, then 1 + (einpk)/j belongs to 1 + pZ(p). This ends the proof of
Equation (8.1).

Now we assume that there exists x in [me,f , 1[ such that ∆e,f (x) = 0 and we argue by

contradiction.

By assumption, for all p in S, there exists a positive integer kp, such that, for all v in

{0, . . . , pkp − 1} and all natural integers m, we have

Qe,f (v + mpkp) ≡ Qe,f (v)Qe,f (m) mod pZ(p) .

Let γ1 < ··· < γt denote the abscissa of the points of discontinuity of ∆e,f on [0, 1[.
In
particular, we have γ1 = me,f . There exists i in {1, . . . , t − 1} such that ∆e,f (x) = 0 for all x
in [γi, γi+1[. For all large enough prime numbers p ∈ S, we choose rp in {0, . . . , p − 1} such
that rp/p belongs to [γi, γi+1[ and we set ap = rppkp−1. Hence ap/pkp belongs to [γi, γi+1[.

*. The proof of this lemma uses a lemma of Lang which contains an error. Fortunately, Lemma 7 remains

true. Details of this correction are presented in [21, Section 2.4].

35

Then, by applying (8.1) in combination with [19, Lemma 16] (with E = e and F = f ), there
are integers m1, . . . , mi such that we have

Qe,f (ap + pkp)
Qe,f (ap)Qe,f (1) ∈

and

1

γk(cid:19)mk

(cid:0)1 + pZ(p)(cid:1)

i

Yk=1(cid:18)1 +
γk(cid:19)mk

1

i

Yk=1(cid:18)1 +

> 1 ,

because ∆e,f is non-negative on [0, 1]. For all large enough primes p in S, we thus deduce
that

i

Yk=1(cid:18)1 +

1

γk(cid:19)mk

/∈ 1 + pZ(p) .

Furthermore, for all large enough p in S, we have 1/p < me,f , and (ap + pkp)/pℓ < me,f , for
ℓ ≥ kp + 1. It follows that vp(Qe,f (1)) = 0, while
∆e,f(cid:18)(cid:26) ap

pℓ(cid:27)(cid:19) = ∆e,f(cid:18) rp

p(cid:19) = 0 ,

kp

vp(cid:0)Qe,f (ap)(cid:1) =

Xℓ=1

and

vp(cid:0)Qe,f (ap + pkp)(cid:1) =

kp

Xℓ=1

∆e,f(cid:18)(cid:26) ap + pkp

pℓ (cid:27)(cid:19) = ∆e,f(cid:18) rp

p

+ 1(cid:19) = 0 .

Hence Qe,f (ap + pkp) 6≡ Qe,f (ap)Qe,f (1) mod pZ(p) which leads to a contradiction, and ends
the proof of Proposition 8.3.

Let us remind to the reader that one easily obtains the graph of ∆e,f on [0, 1] by translating a
factorial ratio into hypergeometric form. We illustrate this process with the following example.
We consider

We have

(10n)!

(5n)!(3n)!n!2 =

∞

(10n)!

F (x) :=

j=1(10k + j)

(5n)!(3n)!n!2 xn .

Xn=0
Qn−1
k=0Q10
j=1(5k + j)(cid:1)(3k + 1)(3k + 2)(3k + 3)(k + 1)2
Qn−1
k=0Q10
j=1(cid:0)k + j
10(cid:1)
Qn−1
k=0(cid:0)Q5
j=1(cid:0)k + j
5(cid:1)(cid:1)(cid:0)k + 1
3(cid:1)(cid:0)k + 2
3(cid:1) (k + 1)3
Q10
nQ5

Qn−1
k=0(cid:0)Q5
5533(cid:19)n
=(cid:18) 1010
5533(cid:19)n
=(cid:18) 1010
5533(cid:19)n (1/10)n(3/10)n(1/2)n(7/10)n(9/10)n
=(cid:18) 1010

(1/3)n(2/3)n(1)3
n

(1/3)n(2/3)n(1)3

j=1(j/10)n

j=1(j/5)n

·

36

Then we deduce that ∆e,f has jumps of amplitude 1 at 1/10, 3/10, 1/2, 7/10 and 9/10, while
the abscissa of its jumps of amplitude −1 are 1/3, 2/3. Furthermore, ∆e,f has a jump of
amplitude −3 at 1. Since

1
10

<

3
10

1
3

1
2

2
3

7
10

9
10

<

<

<

<

<

< 1 ,

we get that ∆e,f ≥ 1 on [1/10, 1) and it follows form Proposition 8.1 that the function F (x)
satisﬁes the p-Lucas property for all prime numbers. Along the same lines, one can prove for
instance that the G-functions
∞

∞

Xn=0

(5n)!(3n)!
(2n)!2n!4 xn and

(4n)!
(2n)!n!2 xn

Xn=0

also satisfy the p-Lucas property for all prime numbers.

8.2. Generalized hypergeometric series. — With two tuples α := (α1, . . . , αr) and
β := (β1, . . . , βs) of elements in Q \ Z≤0, we can associate the generalized hypergeometric
series

rFs(cid:20) α1, . . . , αr

β1, . . . , βs

; x(cid:21) :=

∞

Xn=0

(α1)n ··· (αr)n
(β1)n ··· (βs)n

xn
n! ·

∞

and Fα,β(x) :=

(α1)n ··· (αr)n
(β1)n ··· (βs)n
Fα,β(x) = r+1Fs(cid:20) α1, . . . , αr, 1

β1, . . . , βs

Xn=0
; x(cid:21) .

Qα,β(n)xn ,

Here, we set

so that

Qα,β(n) :=

Note that such series simply correspond to series of type Fu,v for which the parameter d, as
well as all parameters ei and fi, are equal to 1.

To apply Proposition 7.2, we have to compare the numbers haαii and haβji for a in
{1, . . . , dα,β} coprime to dα,β.
Indeed, on [0, 1), ξa have jumps of amplitude 1 at haαii
and jumps of amplitude −1 at haβji, where αi and βj are not equal to 1. For every a in
{1, . . . , dα,β} coprime to dα,β, we set

mα,β(a) := min(cid:0)haα1i, . . . ,haαri,haβ1i, . . . ,haβsi(cid:1),

so that the corresponding set Da
Example 8.5. — Let us illustrate Proposition 7.2 with few examples.

u,v equals [mα,β(a), 1).

• We ﬁrst choose α = (1/2, 1/2) and β = (2/3, 1). We thus have dα,β = 6 and 1/2 < 2/3,

so ξ1(x) ≥ 1 for x in [1/2, 1). On the other hand, we have
2(cid:29) =

3(cid:29) <(cid:28)5 ·

=(cid:28)5 ·

1
3

1

2

1
2

,

so ξ5(1/3) = −1. The maximal set A for which we can apply Proposition 7.2 is thus A = {1}.
Hence we deduce that Fα,β(x) has the p-Lucas properties for all primes p ≡ 1 mod 6. We

37

stress that, according to Theorem A in [21] (which is a reformulation of Christol’s result [13,
Proposition 1]), the function

Fα,β(x) =

(1/2)2
n

(2/3)n(1)n

xn

∞

Xn=0

is not globally bounded, that is there is no C in Q such that Fα,β(Cx) belongs to Z[[x]]. In
particular, it cannot be expressed as the diagonal of a multivariate algebraic function.

• Let study another example by taking α = (1/9, 4/9, 5/9) and β = (1/3, 1, 1). This choice

of parameters was considered by Christol in [13]. We have dα,β = 9 and

1
9

<

1
3

<

4
9

<

5
9

.

Hence mα,β(1) = 1/9 but ξ1(1/3) = 0 < 1, so we cannot just apply Proposition 7.2. Indeed,
any subgroup of (Z/9Z)× must of course contain 1.

• For our last example, let us choose α = (1/3, 1/2) and β = (3/4, 1). Hence we have

dα,β = 12 and

while

1
3

<

1
2

<

3
4

, (cid:28) 5
2(cid:29) <(cid:28) 5
2(cid:29) and (cid:28) 33

3(cid:29) <(cid:28) 15
4 (cid:29) ,
2 (cid:29) <(cid:28) 11
4 (cid:29) <(cid:28) 11
3 (cid:29) .

4 (cid:29) <(cid:28) 7
(cid:28) 21

3(cid:29) <(cid:28) 7

Observe furthermore that 52 ≡ 1 mod 12. This shows that the maximal set A for which one
can apply Proposition 7.2 is A = {1, 5}. Hence the generalized hypergeometric series

(1/3)n(1/2)n
(3/4)n(1)n

xn

∞

Xn=0

satisﬁes the p-Lucas property for all primes congruent to 1 mod 12 and the p2-Lucas property
for all primes congruent to 5 mod 12.

We end this section by observing that our condition is always satisﬁed in the classical
case where the hypergeometric diﬀerential equation associated with Fα,β(x) has maximal
unipotent monodromy at the origin.
Corollary 8.6. — Let α ∈ (Q ∩ (0, 1))r and β = (1, . . . , 1) ∈ Qr. Then the generalized
hypergeometric series Fα,β(x) belongs to L1(S), where S is the set of all primes larger than
dα,β.

8.3. Multivariate factorial ratios and specializations. — We consider now a class of
multivariate power series which provides a higher-dimensional generalization of generating
series associated with factorial ratios that we discussed in Section 8.1. Given two tuples of
i=1 ei and, for all n in

vectors in Nd, e = (e1, . . . , eu) and f = (f1, . . . , fv), we write |e| = Pu

Nd, we set

Qe,f (n) := Qu
i=1(ei · n)!
Qv
i=1(fi · n)!

and Fe,f (x) := Xn∈Nd

Qe,f (n)xn.

Such multivariate power series simply correspond to functions of type Fu,v for which all
parameters αi and βi are equal to one. In particular, we have dα,β = 1. Propositions 7.1 and

38

7.2 take the following much simpler form. As in Section 8.1, we consider the Landau function
∆e,f deﬁned from Rd to Z by:

∆e,f (x) :=

u

Xi=1

⌊ei · x⌋ −

v

Xj=1
⌊fj · x⌋ .

Note that this function precisely corresponds in this setting to the function ξ1 deﬁned in
Section 7. We also recall that, as in the one-variable case, Landau’s criterion [36], and
Delaygue’s reﬁnement [19], give the following dichotomy.

• If, for all x in [0, 1]d, one has ∆e,f (x) ≥ 0, then Qe,f (n) is an integer for all n in Nd.
• If there exists x in [0, 1]d such that ∆e,f (x) < 0, then there are only ﬁnitely many prime

numbers p such that Qe,f (n) belongs to Z(p) for all n in Nd.

Set

De,f :=(cid:8)x ∈ [0, 1)d :

there is d in {e1, . . . , eu, f1, . . . , fv} such that d · x ≥ 1(cid:9) .

u,v in this setting. Propositions 7.1 and 7.2 can now

Note that De,f corresponds to the set D1
be restated in a single result as follows.

Proposition 8.7. — Let us assume that |e| = |f| and that ∆e,f (x) ≥ 1 for all x in De,f .
Then Fe,f (x) belongs to Ld(P). More precisely, Fe,f (x) satisﬁes the p-Lucas property for all
primes p.

This result is also proved by Delaygue in [20, Theorem 3]. We give below a simple case of

Proposition 8.7 that turns out to be especially useful for applications.

Corollary 8.8. — For every k in {1, . . . , d}, let us denote by 1k the vector of Nd whose k-th
coordinate is one and all others are zero. Let e and f = (1k1, . . . , 1kv ) be two disjoint tuples
of non-zero vectors in Nd such that |e| = |f| and ki ∈ {1, . . . , d}, 1 ≤ i ≤ v. Then Fe,f (x)
satisﬁes the p-Lucas property for all primes p.

Proof. — Let x be in De,f . By assumption, there is a coordinate d of either e or f such that
d · x ≥ 1. But, since x belongs to [0, 1)d and f = (1k1, . . . , 1kv ), d has to be a coordinate of
the vector e so that

v

Xj=1
⌊1kj · x⌋

⌊ei · x⌋ −

⌊ei · x⌋

∆e,f (x) =

u

u

Xi=1
Xi=1
≥ 1 .

=

Proposition 8.7 then applies to conclude the proof.

39

8.3.1. Specializations of factorial ratios. — Our main interest when working with multivari-
ate power series in this setting is to beneﬁt from the following general philosophy: interesting
classical power series in one variable can be produced as simple specializations of simple mul-
tivariate power series. In particular, we claim that specializations of functions of type Fe,f
lead to many classical examples of generating functions arising in combinatorics and number
theory. As already mentioned in Section 7, the generating function of Ap´ery’s numbers

∞

f (x) =

Xn=0  n

Xk=0(cid:18)n

k(cid:19)2(cid:18)n + k

k (cid:19)! xn

can be for instance obtained as the specialization f (x) = Fe,f (x, x) of the two-variate gener-
ating series of factorial ratios

(8.2)

Fe,f (x1, x2) = X(n1,n2)∈N2

(2n1 + n2)!(n1 + n2)!

n1!3n2!2

xn1
1 xn2
2 ,

corresponding to the choice

e =(cid:0)(2, 1), (1, 1)(cid:1)

and f =(cid:0)(1, 0), (1, 0), (1, 0), (0, 1), (0, 1)(cid:1) .

In order to support our claim, we gather in the following table some classical sequences
for which we prove that they satisfy the p-Lucas property for all primes p. Indeed, they all
arise from specialization in (x, x) of bivariate power series Fe,f (x1, x2) that belong to L2(P).
The fact these bivariate power series belong to L2(P) is a direct consequence of Corollary 8.8.
Proposition 7.4 then implies that the specialization Fe,f (x, x) belong to L1(P).

40

Sequence

n

Qe,f (n1, n2)
(n1 + n2)!2

n

n

n

n

n1!3n2!2

n1!3n2!3

n1!4n2!2

n1!2n2!2

(n1 + n2)!3

(n1 + n2)!4

(2n1 + n2)!2

(2n1 + n2)!(n1 + n2)!

k(cid:19)2
(cid:18)2n
n(cid:19) =
Xk=0(cid:18)n
k(cid:19)2(cid:18)n + k
k (cid:19)2
Xk=0(cid:18)n
k(cid:19)2(cid:18)n + k
Xk=0(cid:18)n
k (cid:19)
k(cid:19)3
Xk=0(cid:18)n
k(cid:19)4
Xk=0(cid:18)n
k(cid:19)(cid:18)2k
k(cid:19)(cid:18)2(n − k)
n − k (cid:19)
k(cid:19)2(cid:18)2k
Xk=0(cid:18)n
k(cid:19)
k(cid:19)2(cid:18)2k
n − k (cid:19) (n1 + n2)!2(2n1)!(2n2)!
k(cid:19)(cid:18)2(n − k)
k(cid:19)(cid:18)n + k
k (cid:19)
Xk=0(cid:18)n
k(cid:19)2(cid:18)2(n − k)
n − k (cid:19)2
Xk=0(cid:18)2k

(n1 + n2)!(2n1)!(2n2)!

(n1 + n2)!2(2n1)!

(2n1)!2(2n2)!2

(2n1 + n2)!

n1!3n2!3

n1!4n2!4

n1!4n2!2

n1!4n2!4

n1!4n2!4

n1!2n2!

n

Xk=0(cid:18)n

n

n

Xk=0(cid:18)n

n

n

Reference from OEIS

Central binomial coeﬃcients (A000984)

Ap´ery numbers (A005259)

Ap´ery numbers (A005258)

Franel numbers (A000172)

(A005260)

(A081085)

Number of abelian squares

of length 2n over an alphabet

with 3 letters (A002893)

Domb numbers (A002895)

Central Delannoy numbers (A001850)

(A036917)

Let us end this section with an example of a diﬀerent type, that is for which f is not of the

form (1k1, . . . , 1kv ). Set

Fe,f (x1, x2) := X(n1,n2)∈N2

(3n1 + 2n2)!

(n1 + n2)!n1!2n2!

xn1
1 xn2
2 .

In that case, we obtain De,f = {(x, y) ∈ [0, 1)2 : 3x1 + 2x2 ≥ 1}. When (x1, x2) belongs to
De,f , we get that

∆e,f (x1, x2) = ⌊3x1 + 2x2⌋ − ⌊x1 + x2⌋ ≥ 1 .

By Proposition 8.7, it follows that Fe,f (x1, x2) has the p-Lucas property for all primes. Us-
ing specializations in (−x, x) and (2x3, 3x2), we then infer from Proposition 7.4 that both
sequences

n

(−1)k(cid:18)2n + k
Xk=0

n (cid:19)(cid:18)n + k

k (cid:19)(cid:18)n

k(cid:19) and

41

⌊n/3⌋

Xk=0

k≡n mod 2

2k3

n−3k

2 (cid:18)n

k(cid:19)(cid:18)n − k

2 (cid:19)(cid:18) n−k
k (cid:19)

n−k

2

also satisfy the p-Lucas property for all prime numbers p.

8.4. Examples from diﬀerential equations of Calabi-Yau type. — Motivated by the
search for diﬀerential operators associated with particular families of Calabi-Yau varieties,
Almkvist et al. [5] gave a list of more than 400 diﬀerential operators satisfying some algebraic
conditions [5, Section 1]. In particular, a condition is that the associated diﬀerential equation
admits a unique power series solution near z = 0 with constant term 1 and that this power
series has integral Taylor coeﬃcients. In most of the cases, this solution is also given in [5]. It
turns out that our method enables us to prove that most of these solutions have the p-Lucas
property for inﬁnitely many primes p.

By studying the integrality of the Taylor coeﬃcients of mirror maps, Kratthentaler and
Rivoal in [35] and Delaygue in [17, Section 10.2] showed that the power series solutions near
z = 0 of 143 equations in Table [5] are specializations of series Fu,v(x) where α and β are
tuples of 1’s. Furthermore, they showed that in 140 cases the associated functions ξ1 are
greater than or equal to 1 on D1
u,v. Hence, to prove that these specializations have the p-
Lucas property for all primes p, it suﬃces to show that the specialization is given by a vector
n such that if x ∈ [0, 1)d and n · x ≥ 1, then ξ1(x) ≥ 1.

Following this method, we checked that 212 cases have the p-Lucas property for inﬁnitely
many primes p, namely Cases 1–25, 29, 3∗, 4∗, 4∗∗, 6∗–10∗, 7∗∗–10∗∗, 13∗, 13∗∗, ˆ1– ˆ14, 30, 31,
34–41, 43–83, 85–108, 110–116, 119–122, 124–132, 145–153, 155–172, 180, 185, 188, 190–192,
197, 208, 209, 212, 232, 233, 237–241, 243, 278, 284, 288, 292, 307, 323, 330, 337, 338, 340,
367, 369–372, 377, 380, 398.

Among the cases not covered in [35] nor [17], we explain Cases 4∗ and 31 to give examples.

In Case 4∗, the power series solution near z = 0 is

∞

Xn=0  n
Xk=0

Hence f (z) = F (27z, 27z) where

f (z) =

27n(cid:18)2n

n(cid:19)(cid:18)−1/3

k (cid:19)2(cid:18)−2/3

n − k(cid:19)2! zn.

F (x, y) = Xn1,n2≥0

(2n1 + 2n2)!(1/3)2

n1 (2/3)2
n2

(n1 + n2)!2n1!2n2!2

xn1yn2,

which is a series Fu,v(x, y). We have dα,β = 3, and, for every (x, y) in [0, 1)2, we have

ξ1(x, y) = ξ2(x, y) = ⌊2x + 2y⌋ + 2⌊x − 1/3⌋ + 2⌊y − 2/3⌋ − ⌊x + y⌋ + 4.

Furthermore, we have
D1
u,v = D2
If (x, y) belongs to D1
u,v, then we have ⌊x − 1/3⌋ + ⌊y − 2/3⌋ ∈ {−1, 0} so that ξ1(x, y) ≥ 2.
In addition, if x + y ≥ 1, then we have (x, y) ∈ D1
u,v and ξ1(x, y) ≥ 1. By Propositions 7.2
and 7.4, we obtain that f (z) has the p-Lucas property for all primes p > 3.

u,v =(cid:8)(x, y) ∈ [0, 1)2 : x ≥ 1/3 or y ≥ 2/3(cid:9).

In Case 31, the power series solution near z = 0 can be rewritten as

f (z) =

∞

Xn=0  n
Xk=0

k

Xi=0

43n42(n−k)4k−i(−1)i(cid:18)2k

k(cid:19)(cid:18)2i

i(cid:19) (1/4)n(1/4)n−k(3/4)k

n!(n − k)!(k − i)!i! ! zn.

42

Hence f (z) = F (45z, 44z,−43z) where F (x, y, z) is

Xn1,n2,n3≥0(cid:18)2(n2 + n3)

n2 + n3 (cid:19)(cid:18)2n3

n3(cid:19) (1/4)n1+n2+n3(1/4)n1 (3/4)n2+n3

(n1 + n2 + n3)!n1!n2!n3!

xn1yn2zn3,

which is a series Fu,v(x, y, z). We have dα,β = 4, and, for every (x, y, z) in [0, 1)3, we have
ξ1(x, y, z) = ⌊2y+2z⌋+⌊2z⌋+⌊x+y+z−1/4⌋+⌊x−1/4⌋+⌊y+z−3/4⌋−2⌊y+z⌋−⌊x+y+z⌋+3.
Furthermore, we have

D1
u,v =(cid:8)(x, y, z) ∈ [0, 1)3 : x + y + z ≥ 1/4(cid:9).

Let (x, y, z) be in D1
u,v. We have ⌊2y + 2z⌋ − 2⌊y + z⌋ ≥ 0. If x + y + z < 1 then we easily
obtain that ξ1(x, y, z) ≥ 1. If 1 ≤ x + y + z < 2, then we have x ≥ 1/4 or y + z ≥ 3/4 which
yields ξ1(x, y, z) ≥ 1 again. Finally, if 2 ≤ x + y + z < 3, then we have ⌊x + y + z − 1/4⌋ ≥ 1
and ξ1(x, y, z) ≥ 1 as expected. Hence, by Propositions 7.2 and 7.4, we obtain that f (z) has
the p-Lucas property for all primes p ≡ 1 mod 4.

9. Algebraic independence of G-functions: a few examples

In this last section, we gather various examples of statements concerning algebraic inde-

pendence of G-functions that follows from simple applications of our method.

9.1. Factorial ratios. — Given two tuples of vectors of natural numbers, e = (e1, . . . , eu)
and f = (f1, . . . , fv), we recall that the associated sequence of factorial ratios is deﬁned by

and that the generating series of such a sequence is denoted by

i=1(ein)!
i=1(fin)!

Qe,f (n) := Qu
Qv
Xn=0
Qe,f (n)zn .

∞

Fe,f (x) :=

In the sequel, we always assume that the sets {e1, . . . , eu} and {f1, . . . , fv} are disjoint. We
also recall that |e| :=Pu

i=1 ei, |f| :=Pv
me,f := (max{e1, . . . , eu, f1, . . . , fv})−1 .

i=1 fi, and

We set

(9.1)

From Stirling’s formula, we deduce the following general asymptotics:

Qe,f (n) ∼n→∞

We give the following consequence of Proposition 6.4.

i

i

·

i=1 eei
i=1 f fi

Ce,f := Qu
Qv
e,f(cid:0)√2πn(cid:1)u−vsQu
i=1 ei
i=1 fi ·
Qv
for all i in {1, . . . , s},

C n

:=
Proposition 9.1. — Let s be a positive integer and,
(ei,1, . . . , ei,ui) and fi := (fi,1, . . . , fi,vi) be disjoint tuples of positive integers. Let us assume
that the following hold.

let ei

(i) For all i in {1, . . . , s}, one has vi − ui ≥ 2.

43

(ii) The rational numbers Ce1,f1, . . . , Ces,fs are pairwise distinct.
(iii) For all i in {1, . . . , s}, Qei,fi satisﬁes the p–Lucas property for all primes p.
Then Fe1,f1(z), . . . , Fes,fs(z) are algebraically independent over C(z).

Proof. — Since vi − ui ≥ 2 for all i, we ﬁrst infer from (9.1) that Qei,fi(n) = O(C n
/n)
and thus, by Remark 6.5, we see that all Fei,fi(z) belong to W. We also infer from (9.1) that
the radius of convergence of Fei,fi(z) is 1/Cei,fi. Hence the functions Fe1,f1(z), . . . , Fes,fs(z)
have distinct radius of convergence. Since by assumption they all belong to L(P), the result
follows from Proposition 6.4.

ei,fi

As an illustration, let us give the following result.

Theorem 9.2. — The functions
∞

∞

Xn=0

Xn=0

(3n)!
n!3 zn,

(5n)!(3n)!
(2n)!2n!4 zn

and

(10n)!

(5n)!(3n)!n!2 zn

∞

Xn=0

are algebraically independent over C(z).

Proof. — It is easy to see that (i) and (ii) are satisﬁed, while Proposition 8.1 can be used to
prove that (iii) holds too.

Using Proposition 6.7, we can also obtain the following result.

Proposition 9.3. — Let e1 and f1, respectively e2 and f2, be disjoint tuples of positive in-
tegers such that the following hold.

(i) v1 − u1 = 2.
(ii) v2 − u2 ≥ 3.
(iii) Qe1,f1 and Qe2,f2 satisfy the p–Lucas property for all primes p.
Then Fe1,f1(z) and Fe2,f2(z) are algebraically independent over C(z).

Proof. — We ﬁrst observe that if Ce1,f1 6= Ce2,f2, we can use Proposition 9.1 to conclude. We
can thus assume that Ce1,f1 = Ce2,f2 =: C and we will use Proposition 6.7.
We ﬁrst remark that Fe1,f1(z) and Fe2,f2(z) are both transcendental. This follows for
instance from applying Proposition 9.1 twice with a single function. Now, by Pringsheim’s
theorem, Fe1,f1(z) and Fe2,f2(z) have a singularity at 1/C. Using (9.1), we infer from the
assumption v1 − u1 = 2 that Fe1,f1 satisﬁes Condition (i) of Proposition 6.7, while we infer
from the assumption v2−u2 ≥ 3 that Fe2,f2 satisﬁes Condition (ii) of Proposition 6.7. Since, by
assumption, Fe1,f1 and Fe2,f2 both belong to L(P), we can apply Proposition 6.7 to conclude
the proof.

Remark 9.4. — Using the discussion in [42], one can actually show that the only case
where Fe,f (z) both belongs to L(P) and is an algebraic function corresponds to e = (2) and
f = (1, 1), that is to

We give the following illustration of Proposition 9.3.

Fe,f (z) =

1

√1 − z ·

44

Theorem 9.5. — The functions

(4n)!
(2n)!n!2 zn

and

∞

Xn=0

(2n)!3
n!6 zn

∞

Xn=0

are algebraically independent over C(z).
Proof. — Here we have e1 = (4) and f1 = (2, 1, 1), so that v1 − u1 = 2. Furthermore, for all
x in [1/4, 1), we have

which shows that Qe1,f1 satisﬁes the p-Lucas property for all primes p. On the other hand,
we also have e2 = (2, 2, 2) and f2 = (1, 1, 1, 1, 1, 1), so that v2 − u2 = 3. Furthermore, for all
x in [1/2, 1), we have

∆e1,f1(x) = ⌊4x⌋ − ⌊2x⌋ ≥ 1 ,

which shows that Qe2,f2 also satisﬁes the p-Lucas property for all primes p. Then the result
follows from Proposition 9.3.

∆e2,f2(x) = 3⌊2x⌋ ≥ 1 ,

9.2. Generalized hypergeometric functions. — Using Stirling formula, it is easy to
give a general asymptotic for the coeﬃcients of generalized hypergeometric functions. Indeed,
it implies that

xx− 1

2 e−x√2π ,

Γ(x) ∼x→∞

and hence

Let us recall that

(α)n =

Γ(α + n)

Γ(α)

∼n→∞

(α + n)α− 1

2 +ne−α−n √2π
Γ(α) ·

Qα,β(n) :=

(α1)n ··· (αr)n
(β1)n ··· (βs)n

and Fα,β(x) :=

Qα,β(n)xn .

When r = s, that is when Fα,β(x) is a G-function, we thus obtain that

(9.2)

Note that it is usually easy to detect from such asymptotics when the hypergeometric
function Fα,β(z) is transcendental by comparison with asymptotics of coeﬃcients of algebraic
functions. Otherwise, one can always use the beautiful criterion of Beukers and Heckman
[10]. For instance, one can use our asymptotics to show that the hypergeometric function

f(z) :=

(1/5)n(4/5)n

n!2

zn

∞

Xn=0

is transcendental and belong to W (see the proof of Theorem 9.7). Furthermore, Corollary
8.6 shows it has the p-Lucas property for all primes larger than 5. We can thus apply
Proposition 6.4 to deduce the following result.

45

Qα,β(n) ∼n→∞

which leads to the following simple asymptotics:

ePr

nPr

i=1(αi + n)

j=1(βj + n)!n
i=1(αi−βi) Qr
Qr
j=1 Γ(βj)! nPr
Qα,β(n) ∼n→∞ Qr
Qr

i=1 Γ(αi)

∞

Xn=0
i=1(βi−αi)Qr
Qr

i=1(αi−βi) .

i=1 Γ(αi)
j=1 Γ(βj)

Theorem 9.6. — The functions f(z), f(2z), f(3z) . . . are algebraically independent over C(z).

Let us give another kind of example derived from Proposition 6.7.

Theorem 9.7. — The hypergeometric functions

f1(z) =

(1/5)n(4/5)n

n!2

zn

and f2(z) =

∞

Xn=0

are algebraically independent over C(z).

(1/3)n(1/2)2
n
(2/3)nn!2 zn

∞

Xn=0

Proof. — For α = (1/5, 4/5) and β = (1, 1), we infer from Equation (9.2) that

(9.3)

Qα,β(n) ∼n→∞

Γ(1/5)Γ(4/5)

n

which is the asymptotic of a transcendental series. For α = (1/3, 1/2, 1/2) and β = (2/3, 1, 1),
we have

(9.4)

Qα,β(n) ∼n→∞

Γ(1/3)Γ(1/2)2

1

Γ(2/3)

n4/3

,

so that f2 belongs to W. By Corollary 8.6, we ﬁrst get that f1 belongs to L(S0), where S0 is
the set of primes larger than 5, while Proposition 7.2 implies that f2 belongs to L(S1), where
S1 = {p ∈ P : p ≡ 1 mod 6}. In particular, both belong to L(S1). The series f2 belongs to
W ∩ L(S1) so is transcendental over C(z) by Proposition 6.4. Note that these functions are
hypergeometric and thus have the same radius of convergence 1. Then (9.3) and (9.4) show,
as earlier, that one can apply Proposition 6.7, which ends the proof.

9.3. Sums and products of binomials. — We give below an application of Proposi-
tion 6.4 to generating series associated with Ap´ery numbers, Franel numbers, and some of
their generalizations.

and

Theorem 9.8. — Let F be the set formed by the union of the three following sets:
k (cid:19)r! zn : r ≥ 2)

Xn=0  n
( ∞

Xk=0(cid:18)n

Xn=0  n
k(cid:19)r! zn : r ≥ 3) , ( ∞
k(cid:19)r(cid:18)n + k
Xk=0(cid:18)n
Xn=0  n
( ∞
k (cid:19)r! zn : r ≥ 1) .
k(cid:19)2r(cid:18)n + k

Xk=0(cid:18)n

Then all elements of F are algebraically independent over C(z).
Proof. — McIntosh [40] proves general asymptotics for sequences of the form

S(n) :=

n

Xk=0

m

k (cid:19)rj
Yj=0(cid:18)n + jk

,

where m, r0, . . . , rm are natural integers. Indeed, he shows that

S(n) ∼n→∞

µn+1/2

pν(2πλn)r−1

,

46

with r = r0 + ··· + rm, and where λ, 0 < λ < 1, is deﬁned by
= 1 ,

m

Yj=0(cid:18)

(1 + jλ)j

λ(1 + jλ − λ)j−1(cid:19)rj

and where µ and ν are respectively deﬁned by

and

ν =

µ =

m

1 + jλ − λ(cid:19)rj

Yj=0(cid:18) 1 + jλ
Xj=0

rj

m

(1 + jλ − λ)(1 + jλ) ·

The particular case we are interested in is considered in [40]. For a positive integer r, we
then obtain the following asymptotics:

and

n

,

n

2rn

k(cid:19)r
Xk=0(cid:18)n
∼n→∞
pr(πn/2)r−1
(1 + √2)2nr+r
k(cid:19)r(cid:18)n + k
k (cid:19)r
Xk=0(cid:18)n
∼n→∞
q4r(πn√2)2r−1
∼n→∞ (cid:0)(1 + √5)/2(cid:1)5nr+4r
k(cid:19)2r(cid:18)n + k
k (cid:19)r
Xk=0(cid:18)n
q(5 + 2√5)r(2πn)3r−1 ·

n

,

These asymptotics show that all functions in F have distinct radius of convergence. Further-
more, we infer from Remark 6.5 and these asymptotics that they all belong to W since r ≥ 3
for the ﬁrst family, r ≥ 2 for the second, and r ≥ 1 for the third. On the other hand, we
already proved in Section 8.3 that all functions in F belong to L(P). The result thus follows
directly from Proposition 6.4.

9.4. A mixed example. — One special feature of our approach is that one can easily mix
functions of rather diﬀerent type without having to consider all their derivatives and ﬁnding
a common diﬀerential equation for them. We illustrate this claim with the following simple
example.

Theorem 9.9. — The functions

∞

Xn=0

f (z) :=

and

(4n)!
(2n)!n!2 zn, g(z) :=

∞

Xn=0  n

k(cid:19)2(cid:18)n + k

k (cid:19)2! zn, h(z) :=

(1/6)n(1/2)n

(2/3)nn!

zn,

∞

Xn=0

Xk=0(cid:18)n
Xn=0

∞

i(z) :=

(1/5)3
n
(2/7)nn!2 zn

are algebraically independent over C(z).

Note that the two last functions are not globally bounded so they cannot be obtained as

the diagonal of some rational functions.

47

Proof. — On the one hand, we already shown in Section 8.1 that f (z) belongs to L(P),
in Section 5 that g(z) belongs to L(P), in Section 8.2 that h(z) belongs to L(S), where
S = {p ∈ P : p ≡ 1 mod 6}, and it follows from Proposition 7.2 that i(z) belongs to L(S ′),
where S ′ = {p ∈ P : p ≡ 1 mod 35}. Hence all belong to L(S1), where S1 = {p ∈ P : p ≡ 1
mod 210}.
On the other hand, we infer from Remark 6.5 and asymptotics for the coeﬃcients of these
functions (see Sections 9.1, 9.2, and 9.3) that they all belong to W and that ρf = 4−3,
ρg := (1 + √2)−4, ρh = 1, and ρi = 1.

Now, let us assume that f, g, h, i are algebraically dependent over C(z). Then by Theo-

rem 4.1, there should exist integers a, b, c, d, not all zero, such that

f (z)ag(z)bh(z)ci(z)d = r(z) ,

where r(z) is a rational fraction. If a 6= 0, we infer from the equality

f (z)a = r(z)g(z)−bh(z)−ci(z)−d

that f (z)a is meromorphic at ρf , which provides a contradiction with the fact that f (z)
belongs to W. Thus a equals 0. Now, if b 6= 0, we obtain in the same way that g(z)b is
meromorphic at ρg, which provides a contradiction with the fact that g(z) belongs to W.
Thus b = 0 and we have

h(z)ci(z)d = r(z) ,

with c and d not all zero. This means that h and i are algebraically dependent. However, using
the asymptotics of Section 9.2, we see that h and i satisfy the assumption of Proposition 6.7
and are thus algebraically independent. We thus get a contradiction, concluding the proof.

References

[1] B. Adamczewski, J. P. Bell, On vanishing coeﬃcients of algebraic power series over ﬁelds of

positive characteristic, Invent. Math. 187 (2012), 343–393.

[2] B. Adamczewski, J. P. Bell, Diagonalization and rationalization of algebraic Laurent series,
Ann. Sci. ´Ec. Norm. Sup´er. 46 (2013), 963–1004.
[3] B. Adamczewski, J. P. Bell, A problem about Mahler functions, submitted, 56 pp.

[4] J.-P. Allouche, D. Gouyou-Beauchamps, and G. Skordev, Transcendence of binomial and

Lucas’ formal poxer series, J. Algebra 210 (1998), no. 2, 577–592.

[5] G. Almkvist, C. van Eckenvort, D. van Straten, and W. Zudilin, Tables of Calbi-Yau

equations, arXiv:0507430v2 [math.AG], 130 pages.

[6] Y. Andr´e, Groupes de Galois motiviques et p´eriodes, S´eminaire Bourbaki, expos´e 1104, novembre

2015.

[7] Y. Andr´e, S´eries Gevrey de type arithm´etique, I. Th´eor`emes de puret´e et de dualit´e, Ann. Math.

151 (2000), 705–740.

[8] Y. Andr´e, G-functions and Geometry, Aspects of Math. E13, Vieweg, Braunschweig/Wiesbaden

(1989).

[9] J. Ayoub, Une version relative de la conjecture des p´eriodes de Kontsevich-Zagier, Ann. Math.

181 (2015), 905–992.

[10] F. Beukers, G. Heckman, Monodromy for the hypergeometric functions nFn−1, Invent. Math.

95 (1989), 325–354.

48

[11] M. Bousquet-M´elou, Rational and algebraic series in combinatorial enumeration, International

Congress of Mathematicians. Vol. III, 789–826, Eur. Math. Soc., Z¨urich, 2006.

[12] J. W. Bober, Factorial ratios, hypergeometric series, and a family of step functions, Journal of

the London Mathematical Society (2) 79 (2009), 422–444.

[13] G. Christol, Fonctions hyperg´eom´etriques born´ees, Groupe de travail d’analyse ultram´etrique,

tome 14 (1986-1987), exp. 8, 1-16.

[14] G. Christol, Diagonales de fractions rationnelles, Progress in Math. 75 (1988), 65–90.
[15] G. Christol, Globally bounded solutions of diﬀerential equations, in Analytic number theory

(Tokyo, 1988), pp. 45–64, Lecture Notes in Math. 1434, Springer, Berlin, 1990.

[16] D. Chudnovsky, G. Chudnovsky, Applications of Pad´e approximations to diophantine in-
equalities in values of G-functions, in Number Theory (New York 1983–84), 9–51, Lecture Notes in
Math. 1135, Springer-Verlag, New York (1985).
[17] ´E. Delaygue, Propri´et´es arithm´etiques des applications mirroir, PhD thesis (2011), available
online at http://math.univ-lyon1.fr/∼delaygue/articles/PhD Thesis delaygue.pdf.
[18] E. Delaygue, Crit`ere pour l’int´egralit´e des coeﬃcients de Taylor des applications miroir, J.

Reine Angew. Math. 662 (2012), 205–252.

[19] E. Delaygue, A criterion for the integraity of the Taylor coeﬃcients of mirror maps in several

variables, Adv. Math., 234 (2013) 414–452.

[20] E. Delaygue, Arithmetic properties of Ap´ery-like numbers, preprint (2013), arXiv:1310.4131v1

[math.NT], 22 pages.

[21] E. Delaygue, T. Rivoal, and J. Roques, On Dwork’s p-adic formal congruences theorem
and hypergeometric mirror maps, preprint (2013), arXiv:1309.5902v1 [math.NT], 80 pages, to appear
in Memoirs Amer. Math. Soc.

[22] P. Deligne, Int´egration sur un cycle ´evanescent, Invent. Math. 76 (1983), 129–143.
[23] B. Dwork, p-adic cycles, Inst. Hautes ´Etudes Sci. Publ. Math., 37 (1969), 27–115.
[24] B. Dwork, On p-adic diﬀerential equations. IV. Generalized hypergeometric functions as p-adic
analytic functions in one variable. Ann. Sci. ´Ecole Norm. Sup. (4), 6 (1973), 295-315.
[25] B. Dwork, G. Gerotto, and F. Sullivan, An introduction to G-functions, Annals of Math-

ematics Studies 133, Princeton University Press, 1994.

[26] P. Flajolet, Ambiguity and transcendence, Automata, languages and programming (Nafplion,

1985), 179–188, Lecture Notes in Comput. Sci., 194, Springer, Berlin, 1985.

[27] P. Flajolet, Analytic Models and Ambiguity of Context-Free Languages, Theor. Comput. Sci.

49 (1987), 283–309.

[28] P. Flajolet and R. Sedgewick, Analytic combinatorics, Cambridge University Press, 2009.
[29] H. Furstenberg, Algebraic functions over ﬁnite ﬁelds, J. Algebra 7 (1967) 271–277.
[30] I. Gessel, Some congruences for Ap´ery numbers, J. Number Theory 14 (1982), 362–368.
[31] N. Katz, Algebraic solutions of diﬀerential equations. Invent. Math. 18 (1972), 1-118.
[32] N. M. Katz, Nilpotent connections and the monodromy theorem: applications of a result of
Turrittin, Inst. Hautes ´Etudes Sci. Publ. Math. 35 (1970), 175–232.
[33] M. Kontsevich, Periods, Journ´ee annuelle de la SMF, 1999.
[34] M. Kontsevich and D. Zagier, Periods, in Mathematics unlimited—2001 and beyond, pp.

771–808, Springer-Verlag, 2001.

[35] C. Krattenthaler and T. Rivoal, Multivariate p-adic formal congruences and integrality of
Taylor coeﬃcients of mirror maps, S´eminaire et Congr`es 23 (2011), 301–329. Actes de la conf´erence
Th´eories galoisiennes et arithm´etiques des ´equations diﬀ´erentielles (CIRM, septembre 2009).

49

[36] E. Landau, Sur les conditions de divisibilit´e d’un produit de factorielles par un autre, collected

works, I, page 116. Thales-Verlag (1985).

[37] E. Lucas, Sur les congruences des nombres eul´eriens et les coeﬃcients diﬀ´erentiels des fonctions

trigonom´etriques, suivant un module premier, Bull. Soc. Math. France 6 (1877–1878), 49–54.

[38] A. Malik and A. Straub, Divisibility properties of sporadic Ap´ery-like numbers, Research in

Number Theory 2 (2016), 1–26.

[39] R. J. McIntosh, A generalization of a congruential property of Lucas, Amer. Math. Monthly

99 (1992), 231–238.

[40] R. J. McIntosh, An asymptotic formula for binomial sums, J. Number Theory 58 (1996), 158–

172.

[41] R. Meˇstrovi´c, Lucas’ theorem:

its generalizations, extensions ans applications (1878–2014),

preprint (2014), arXiv:1409.3820v1.

[42] F. Rodriguez-Villegas, Integral ratios of factorials and algebraic hypergeometric functions,

preprint (2007), arXiv:0701.1362v1 [math.NT], 3 pages.

[43] K. Samol, D. van Straten, Dwork congruences and reﬂexive polytopes, preprint (2009),

arXiv:0911.0797v1 [math.AG], 14pp.

[44] J.-P. Serre, Local Fields, Springer-Verlag, 1980.
[45] C. Siegel, ¨Uber einige Anwendungen diohantischer Approximationen, Abhandlungen Akad.
Berlin 1929.

[46] H. Sharif and C. F. Woodcock, On the transcendence of certain series, J. Algebra 121

(1989), 364–369.

[47] R. Stanley, Diﬀerentiably ﬁnite power series, European J. Combin. 1 (1980), 175–188.

[48] A. Straub, Multivariate Ap´ery numbers and supercongruences of rational functions, Algebra

Number Theory 8 (2014), 1985–2007.

[49] M. Waldschmidt, Transcendence of periods: the state of the art, Pure Appl. Math. Q. 2 (2006),

435–463.

B. Adamczewski, CNRS, Universit´e de Lyon, Universit´e Lyon 1, Institut Camille Jordan, 43 boulevard du
• E-mail : Boris.Adamczewski@math.cnrs.fr

11 novembre 1918, 69622 Villeurbanne Cedex, France

Jason P. Bell, Department of Pure Mathematics, University of Waterloo, Waterloo, ON, Canada, N2L 3G1

E-mail : jpbell@uwaterloo.ca

E. Delaygue, Universit´e de Lyon, Universit´e Lyon 1, Institut Camille Jordan, 43 boulevard du 11 novembre

1918, 69622 Villeurbanne Cedex, France • E-mail : delaygue@math.univ-lyon1.fr

50

