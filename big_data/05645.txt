6
1
0
2

 
r
a

 

M
7
1

 
 
]
T
R
h
t
a
m

.

[
 
 

1
v
5
4
6
5
0

.

3
0
6
1
:
v
i
X
r
a

Rationality of ﬁxed-point vertex operator algebras

Masahiko Miyamoto∗

and

Scott Carnahan†

Institute of Mathematics, University of Tsukuba,

Tsukuba 305 Japan

Abstract

We show that if T is a simple regular vertex operator algebra of CFT type
with a nonsingular invariant bilinear form and σ is a ﬁnite automorphism of
T , then the ﬁxed point vertex operator subalgebra T σ is also regular.

Contents

1 Introduction

2 Notation conventions

3 Projectivity of the orbifold model

3.1
Induced generalized modules . . . . . . . . . . . . . . . . . . . . . . .
3.2 Eigenmodules are simple currents . . . . . . . . . . . . . . . . . . . .
3.3 Projectivity for ﬁxed points
. . . . . . . . . . . . . . . . . . . . . . .

1

3

5
5
6
7

4 Rationality

8
4.1 Moore-Seiberg-Huang argument . . . . . . . . . . . . . . . . . . . . .
9
4.2 Rigidity . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 16
4.3 Rationality of the ﬁxed-point subVOA . . . . . . . . . . . . . . . . . 20

1

Introduction

Let V be a vertex operator algebra (abbreviated as VOA). If V satisﬁes some prop-
erty P , it is natural to ask if, for any ﬁnite order automorphism σ, the ﬁxed-point
subVOA V σ also satisﬁes P . We call this question the cyclic orbifold problem for
P .

∗Supported by the Grants-in-Aids for Scientiﬁc Research, No. 26610002, The Ministry of Edu-
†Supported by the Program to Disseminate Tenure Tracking System, MEXT, Japan

cation, Science and Culture, Japan

1

In this paper, we show that if V is simple and regular of CFT type, equipped with
a nonsingular invariant bilinear form, then so is V σ. That is, we resolve the cyclic
orbifold problem for the “simple, regular, CFT type, with nonsingular invariant
form” property. While this property appears to be rather long and restrictive, many
fundamentally important VOAs, such as unitary minimal models, rational WZW
models, lattice VOAs, the Monster VOA V (cid:92) appearing in moonshine, and various
tensor products of them have this property. Furthermore, there are many substantial
results, such as Zhu’s theorem on modular invariance of trace functions [Zhu-1996]
and the Verlinde Conjecture [Huang-2008], that are consequences of this property.
However it can be quite diﬃcult to prove for a particular VOA without substantial
control of its internal structure. Thus, a resolution of the cyclic orbifold problem
allows us to apply powerful tools where they were once useless.

The cyclic orbifold problems for CFT type and existence of a nonsingular in-
variant form are quite trivial, and the cyclic orbifold problem for simplicity is a
consequence of Theorem 3 in [Dong-Mason-1997]. The regularity property is equiv-
alent to the combination of rationality, meaning all ﬁnitely generated N-gradable
V -modules are completely reducible, and the C2-coﬁniteness property. The C2-
coﬁniteness property was introduced in [Zhu-1996] as a technical condition to prove
a modular invariance property of the space spanned by trace functions on modules,
but it is now understood as one of the most important ﬁniteness conditions for a
VOA. Recently, the cyclic orbifold problem for the C2 coﬁniteness property was re-
solved [Miyamoto-2015a], so we prove the remaining problem, namely rationality of
V σ.

It is natural to ask whether the CFT type hypothesis can be relaxed. Indeed,

we can phrase our main theorem in the following slightly stronger form:

Main Theorem. Let T be a simple regular VOA with a nonsingular invariant
If the L(0)-spectrum of T σ is
bilinear form and σ a ﬁnite automorphism of T .
non-negative and sT,T (cid:54)= 0, then the ﬁxed point vertex operator subalgebra T σ is
regular, where (sj,k) = (sU j ,U k) denotes the S-matrix for the modular transformation
1 0 ) and {U j | j = 1, ..., p} is the set of simple
of trace functions corresponding to ( 0 −1
T -modules.

The assumption on the L(0)-spectrum of T σ is used in the modular invariance re-
sult of [Miyamoto-2004], and by the remark the end of the introduction in that paper,
it appears that we may need to assume the stronger condition of C2+s-coﬁniteness
when T σ has lowest L(0)-eigenvalue −s ≤ 0. The assumption sT,T (cid:54)= 0 follows from
the Verlinde formula, whose proof in [Huang-2008] assumes T is of CFT type. We
are reasonably conﬁdent that sT,T (cid:54)= 0 can be derived from the other assumptions,
but we have been unable to remove the dependence of Huang’s proof on the CFT
type hypothesis with complete certainty.
In summary, it is not so easy to get a
substantial weakening of the CFT type hypothesis, and as far as we know, it is not
so easy to ﬁnd interesting examples that would justify the eﬀort.
This paper has the following structure: In §2, we introduce some deﬁnitions and
notation. In §3, we prove that T decomposes as a direct sum of simple currents
for T σ, and show that T σ is projective as a T σ-module. This section does not use
the assumptions on L(0)-spectrum and sT T . In §4, we introduce the Moore-Seiberg-

2

Huang argument using the machinery of two-point genus-one functions, prove the
rigidity of every simple T σ-module, and conclude with the Main Theorem.
Acknowledgement
The ﬁrst author would like to express special thanks to H. Yamauchi and T. Arakawa
for giving him the chance to explain the details of his proofs. He also thanks to
T. Abe and A. Matsuo for their advice.

2 Notation conventions

plication written as (u, v) (cid:55)→ Y (u, z)v =(cid:80)

A VOA is a quadruple (V, Y ( , z), 1, ω), where V is a vector space with distinguished
vectors 1, ω ∈ V , and Y : V ⊗ V → V ((z)) is a multiplication map, with multi-
n∈Z unvz−n−1. These data are required
to satisfy some axioms, which we will not write in detail here, since we will not
use them explicitly. The points that are important for us are that the operator
L(−1) = ω0 satisﬁes a derivative rule, and L(0) = ω1 acts semisimply with integer
eigenvalues that are bounded below and have ﬁnite multiplicity. We say that V is
of CFT type if the spectrum of L(0) is non-negative and Ker L(0) spanned by 1.
When we say that V is C2-coﬁnite, we mean that dim V /C2(V ) < ∞, where
C2(V ) = SpanC{v−2u | v, u ∈ V, wt(v) ≥ 1}. One often sees a deﬁnition of C2(V )
and C2-coﬁniteness in the literature that is diﬀerent from ours, in that the weight
restriction is missing. The resulting notions of C2-coﬁniteness are clearly equivalent
when V is of CFT type, but otherwise our condition is a priori slightly stronger. If
we write C old
for the other deﬁnition, the following implications are straightforward:

2

V is C old

2 -coﬁnite and of CFT type ⇒ V is C2-coﬁnite ⇒ V is C old

2 -coﬁnite.

Our deﬁnition of C2-coﬁniteness has two advantages for us: the cyclic orbifold
problem is solved, and the modular invariance theorem of [Miyamoto-2004] uses it.
Both of these results are used in the proof of the main theorem. In this paper, all
of our VOAs are simple and C2-coﬁnite, with a nonsingular invariant bilinear form.
We use the term “V -module” in a weak sense, to denote a vector space U with
action map Y U : V ⊗ U → U ((z))[log z], where L(0)U is not necessarily diago-
nalizable - these are often called “logarithmic V -modules”. In this paper, we are
only concerned with ﬁnitely generated V -modules. For any ﬁnitely generated V -

modules A, B, C, we will use the term “intertwining operator of type(cid:0) C
tion, and has the form Y(a, z) =(cid:80)K
as a map A⊗ B → C{z}[log z]. We will write I(cid:0) C
twining operators of type(cid:0) C

logarithmic intertwining operators as described in [Huang-Lepowsky-Zhang-2007].
dzY(a, z) and Y(v−2a, z) =
By using the fact that Y satisﬁes Y(L(−1)a, z) = d
Resx{(x − z)−2Y C(v, x)Y(a, z) − (−z + x)−2Y(a, z)Y B(v, x)} for a ∈ A, v ∈ V ,
we ﬁnd that ﬁnd that the series Y(a, z) satisﬁes a regular singular diﬀerential equa-
m∈C aj,mz−m−1 logj z, i.e., Y can be viewed

(cid:1) for the vector space of all inter-
(cid:1), including those with logarithmic terms. Technical

(cid:1)” to denote

(cid:80)

j=0

A,B

A,B

A,B

details for the theory of (logarithmic) intertwining operators between (logarithmic)
modules can be found in [Huang-Lepowsky-Zhang-2007]. We simply note that be-
cause V is C2-coﬁnite, the category C of all ﬁnitely generated V -modules satisﬁes

3

Huang-Lepowsky-Zhang’s Assumption 12.1, so we can cite the associativity and
convergence results of that paper without alteration.
The fusion product A(cid:2) B will be an essential tool for us. In [Miyamoto-2014], it
is viewed it as a projective limit of the images of surjective intertwining operators,
and this coincides with the deﬁnition in [Huang-Lepowsky-Zhang-2007]. Since V is
C2-coﬁnite, for ﬁnitely generated V -modules A and B, there is a pair (A (cid:2) B,Y(cid:2)
A,B)
of a ﬁnitely generated (logarithmic) V -module A (cid:2) B and a surjective (logarithmic)
intertwining operator Y(cid:2)
homomorphism φ : A (cid:2) B → C such that Y = φY(cid:2)
A,B. Although the pair (A (cid:2)
B,Y(cid:2)
A,B) is not uniquely determined, it is uniquely determined up to isomorphism.
We ﬁx a representative (A (cid:2) B,Y(cid:2)
A,B) of the isomorphism class for each pair (A, B).
Given V -module homomorphisms α : A → C and β : B → D, from the universal
property of fusion products, we have an induced homomorphism from A (cid:2) B to
C (cid:2) D, which we denote by α(cid:2)β. We write σ ◦ δ to denote the composition of
homomorphisms σ and δ.

(cid:1) such that for any Y ∈ I(cid:0) C

A,B of type(cid:0)A(cid:2)B

(cid:1), there is a

A,B

A,B

We follow the convention used in Huang’s papers (e.g., [Huang-2005]) to describe
equality of n-point functions: When we say that an identity (of formal power series
with fractional powers and logarithms) holds on a complex domain O, we implicitly
mean that one chooses a set of branch cuts on O that yield a distinguished choice
of fractional powers and logarithms of the corresponding variables, and then applies
the substitution at each point to get a pair of series that converge to an identity of
complex numbers. Furthermore, when we claim equality, we implicitly claim that
the two series converge absolutely uniformly on compact subsets of the cut region,
so that we have an equality of holomorphic functions. To ensure consistency with
results in the literature, we choose our branch cuts according to the method given
by Huang: arguments of variables are restricted to lie between zero and 2π, and
fractional powers and logarithms are then chosen accordingly.

We use homomorphisms to explain the relations among the fusion products. For
simple V -modules A, B, C, since A, B, C are C2-coﬁnite, the fusion products among
them are all well-deﬁned and there is an isomorphism

µA,B,C : (A (cid:2) B) (cid:2) C → A (cid:2) (B (cid:2) C)

(2.1)

satisfying

(cid:104)d(cid:48), µA,B,CY(cid:2)

A(cid:2)B,C(Y(cid:2)

A,B(a, x1)b, x2)c(cid:105) = (cid:104)d(cid:48),Y(cid:2)

A,B(cid:2)C(a, x1 − x2)Y(cid:2)

B,C(b, x2)c(cid:105)

in the open domain

O1 = {(x1, x2) ∈ C2 | 0 < |x1| < |x2| < |x1 − x2|}

for any a ∈ A, b ∈ B, c ∈ C and d(cid:48) ∈ (A (cid:2) (B (cid:2) C))(cid:48), where (cid:104)·,·(cid:105) is the pairing on
(A(cid:2) (B (cid:2) C))(cid:48) × A(cid:2) (B (cid:2) C) (see Theorem 10.3 in [Huang-Lepowsky-Zhang-2007]).
Another important homomorphism is

πW : W (cid:2) W (cid:48) → V (∼= V (cid:48))

satisfying

zwt(w)+wt(w(cid:48))πW (Y(cid:2)

W,W (cid:48)(w, z)w(cid:48)) = (cid:104)w, w(cid:48)(cid:105)1

lim
z→0

4

for w ∈ W and w(cid:48) ∈ W (cid:48), where (cid:104)·,·(cid:105) is the contragradient pairing on W ×W (cid:48). We set
YW := πWY(cid:2)
W,W (cid:48), and warn the reader that forgetting the πW will cause confusion
in §4.

3 Projectivity of the orbifold model

If V is a VOA, then a V -module P is called projective if every V -module epimor-
phism f : W → P splits. The main purpose in this section is to prove the following
theorem.

Theorem. Let T be a simple regular VOA with a nonsingular invariant bilinear
form and σ ∈ Aut(T ) of order n ∈ Z≥1, then T σ is projective as a T σ-module.

To simplify the notation, we let V = T σ be the ﬁxed point VOA. Viewing T as
j=0 T (j), where T (j) = {v ∈ T | vg =

a < σ >-module, T decomposes into T = ⊕n−1
e2πij/nv}. By [Dong-Mason-1997], T (j) are simple V -modules.

3.1 Induced generalized modules

For each ﬁnitely generated V -module D, we consider the V -module:

T (cid:2)V D = ⊕n−1

j=0 T (j) (cid:2)V D.

We call this the induced module. We note that it does not necessarily admit a T -
module structure in the usual VOA sense, because the power series from the module
action may have fractional powers. However, there is a weaker form of action from
an intertwining operator that one might expect from a direct sum of logarithmic
twisted modules.
Lemma 1. There is a canonical action of T on T (cid:2)V D by an intertwining operator
that satisﬁes the L(−1)-derivative property and associativity.
Proof. Set W (j) = T (j) (cid:2)V D and W = ⊕p−1

[Huang-Lepowsky-Zhang-2007], there is some Y ∈ I(cid:0) W

j=0W (j). By the Theorem 9.11 of

(cid:1) such that on the domain

T,W

O2 = {(x, y) ∈ C2 | |x| > |y| > |x − y| > 0},

we have the following equality:

(cid:104)w(cid:48),Y(t, x)Y(cid:2)

T,D(Y (t, x − y)t1, y)d(cid:105)

(3.1)

(3.2)

for any t, t1 ∈ T , w(cid:48) ∈ W (cid:48) and d ∈ D. Expanding Y, we set

Y(t, x) =

tm,kx−m−1 logk x ∈ End(W ){t}[log t]

T,D(t1, y)d(cid:105) = (cid:104)w(cid:48),Y(cid:2)
K(cid:88)
(cid:88)

m∈Q

k=0

and we view tm,k ∈ Hom(W, W ) as coeﬃcients of an action of t ∈ T on W .
We now show that Y(t, x) satisﬁes associativity and the L(−1)-derivative prop-
erty. We ﬁrst note that W (0) = V (cid:2)V D = D and Y(t, x) = Y W (t, x) for t ∈ V .

5

In particular, it has no logarithmic terms. By repeated application of associativity
with respect to Y , for any t1, t2, t3 ∈ T , we have:

(cid:104)w(cid:48),Y(t1, x)Y(t2, y)Y(cid:2)

T,D(t3, z)d(cid:105) = (cid:104)w(cid:48),Y(t1, x)Y(cid:2)

T,D(Y (t2, y − z)t3, z)d(cid:105)

T,D(Y (t1, x − z)Y (t2, y − z)t3, z)d(cid:105)
T,D(Y (Y (t1, x − y)t2, y − z)t3, z)d(cid:105)

= (cid:104)w(cid:48),Y(cid:2)
= (cid:104)w(cid:48),Y(cid:2)
= (cid:104)w(cid:48),Y(Y (t1, x − y)t2, y)Y(cid:2)

T,D(t3, z)d(cid:105)

as analytic functions on the open domain

O3 = {(x, y, z) ∈ C3 | |x| > |y| > |z| > |x − z| > |y − z| > |x − y| > 0}.

Since the above holds for any t3 ∈ T and w ∈ T (cid:2)V D and w(cid:48) ∈ (T (cid:2)V D)(cid:48), we

have

in O2, which proves associativity.

(cid:104)w(cid:48),Y(t1, x)Y(t2, y)w(cid:105) = (cid:104)w(cid:48),Y(Y (t1, x − y)t2, y)w(cid:105)

(3.3)

(cid:104)w(cid:48),Y(L(−1)t, x)Y(cid:2)

Furthermore, by direct calculation, we have
T,D(t1, y)d(cid:105) = (cid:104)w(cid:48),Y(cid:2)
= ∂
= (cid:104)w(cid:48), ∂

T,D(Y (L(−1)t, x − y)t1, y)d(cid:105)
∂xY(t, x)Y(cid:2)
in O2 and so Y(t, x) satisﬁes the L(−1)-derivative property.

T,D(Y (t, x − y)t1, y)d(cid:105)

T,D(t1, y)d(cid:105)

∂x(cid:104)w(cid:48),Y(cid:2)

3.2 Eigenmodules are simple currents

As an application of the induced module, we prove the following theorem.
Theorem 2. Let T be a C2-coﬁnite VOA and σ ∈ Aut(T ) of order n ∈ Z≥1. Then
for any j ∈ Z/nZ, the T σ-module T (j) is a simple current.
Proof. We consider the induced module W = T (cid:2)V T (j) of T (j), and set W (h) =
T (h−j) (cid:2)V T (j). As we explained before, T has an action on W by Y given in
(3.1). By the universal property of fusion products, there is a natural epimorphism
φ : W = T (cid:2)V T (j) → T such that φ(Y(cid:2)
T,T (j)(t, z)tj) = Y (t, z)tj for t ∈ T , tj ∈ T (j).
Then by the deﬁnition of Y, we have

φ(Y(v, z)w) = Y (v, z)φ(w)

(3.4)
for v ∈ T and w ∈ W . In particular, W/ Ker φ is isomorphic to T as a T -module.
h=0K (h). Since T (0) ∼= V and W (j) =
We set K (h) := W (h) ∩ Ker φ, so Ker φ = ⊕n−1
T (0) (cid:2)V T (j) ∼= T (j) is simple, we have K (j) = 0. Suppose W (0) is not simple, i.e.,
K (0) (cid:54)= 0. By restricting the actions of T on the induced module W to Ker φ, for
any t1 ∈ T (h−j), t2 ∈ T (j−h) and w ∈ K (h) and w(cid:48) ∈ (K (h))(cid:48),

(cid:104)w(cid:48),Y(t1, x)Y(t2, y)w(cid:105) = (cid:104)w(cid:48),Y(Y (t1, x − y)t2, y)w(cid:105)

(3.5)
holds in O2. Since K (j) = 0 as we showed at (3.3), we have Y(t2, y)w = 0 and the
left hand side of (3.5) is zero. On the other hand, since Y (t1, x − y)t2 ∈ V [[x −

6

y, (x − y)−1]], the coeﬃcients of Y(Y (t1, x − y)t2, y)w is nonzero for some t1 ∈ T χ
and t2 ∈ T χ−1, which contradicts the above.
Hence T (n−j) (cid:2)V T (j) ∼= V . For any simple module D, by the associativity of

fusion products, we have

T (n−j) (cid:2) (T (j) (cid:2)V D) ∼= (T (n−j) (cid:2) T (j)) (cid:2)V D ∼= V (cid:2)V D ∼= D.

(3.6)

Fusion with T (j) is therefore an invertible operation on irreducible modules, i.e., T (j)
is simple current.
Corollary 3. If B is a simple V -module, then T (cid:2)V B is an irreducible σk-twisted
T -module for some k ∈ Z. In particular, T (cid:2)V B is an irreducible T -module if and
only if it has weights supported in a single coset of Z.
Proof. We ﬁrst show that T (cid:2)V B is a twisted module.
so the intertwining operator Y(cid:2)
r ∈ C. By associativity, the intertwining operators Y(cid:2)
jr + Z for all j ∈ Z, so r ∈ 1
immediately from the associativity of intertwining operators.
of the V -submodules T (j) (cid:2)V B.

Since each T (j) is a simple current, the V -submodules T (j) (cid:2)V B are irreducible,
T (1),B has exponents in a single coset r + Z for some
T (j),B then have exponents in
Z, and the axioms for σnr-twisted modules follow

Irreducibility under the T -action follows straightforwardly from the irreducibility

n

3.3 Projectivity for ﬁxed points

We come to the main result of this section.

Theorem 4. Let T be a simple regular VOA with a nonsingular bilinear form and
σ ∈ Aut(T ) of order n, then T σ is projective as a T σ-module.
ρ−→ V → 0 be a non-split
Proof. Suppose the assertion is false and let 0 → B → D
extension of V by a simple V -module B. By simplicity of B, all weights of D are
integers. From the deﬁnition of induced module, we have the following commutative
diagram with exact rows [Miyamoto-2015b]:

T (cid:2)V B

ρ1

/ T (cid:2)V D

τ1

B

τ2
/ D

ρ2

ρ

/ T (cid:2)V V

τ3

/ V

/ 0

/ 0

(3.7)

where τi (i = 1, 2, 3) are all projections given by the direct factor T σ = V of T . For
each character j, T (j) (cid:2) B is a simple V -module and

T (j) (cid:2)V B

ρ1−→ T (j) (cid:2)V D

ρ2−→ T (j) (cid:2)V V → 0

(3.8)
is exact as V -modules. If T (j) (cid:2)V B has non-integer weights, then ρ2 : T (j) (cid:2)V D →
T (j) has to split and so does D → V , which contradicts the choice of D. Therefore,
we may assume all weights of T (cid:2)V D are integers. Since (T (cid:2) D)/ρ1(T (cid:2)V B) ∼= T
and T (cid:2)V B are irreducible T -modules (the latter by Corollary 3), the power of log z

7



/


/


/
/
/
/
in the expansion of Y deﬁned by (3.1) is at most one. That is, for any t ∈ T , we
have

Y(t, z) = Y 0(t, z) + Y 1(t, z) log z

T,(T (cid:2)V D)/ρ1(T (cid:2)V B)

with Y 0(t, z) ∈ End(T (cid:2)V D)[[z, z−1]] and Y 1(t, z) ∈ Hom((T (cid:2)V D)/ρ1(T (cid:2)V
dzY(t, z), we have Y 0(L(−1)t, z) =
B), ρ1(T (cid:2)V B))[[z, z−1]]. Since Y(L(−1)t, z) = d
dzY 0(t, z) + 1
dzY 1(t, z). In particular, Y 1 is an inter-

(cid:1), or by identifying (T (cid:2)V D)/ρ1(T (cid:2)V B)

zY 1(t, z) and Y 1(L(−1)t, z) = d

T (cid:2)B

d

twining operator of type(cid:0)
with T , of type(cid:0)T (cid:2)B
(cid:1).

T,T

If Y 1 = 0, then T (cid:2)D is a T -module. However, T is projective by our assumption
of rationality, so the surjection ρ2 : T (cid:2) D → T splits. This induces a splitting of
ρ : V (cid:2) D → V , contradicting our assumption that the extension is not split. Thus,
we may assume Y 1 (cid:54)= 0, so by considering the type of Y 1 and irreducibility of T (cid:2)V B,
we have T (cid:2)V B ∼= T (cid:2)V D/ρ1(T (cid:2)V B) ∼= T . Identifying T (cid:2)V D/ρ1(T (cid:2)V B) with
T , we have Y 1(t, z) = λY (t, z) for some λ ∈ C.

We now expand equation 3.3:

(cid:104)w(cid:48),(cid:0)Y 0(t1, x) + Y 1(t1, x) log x(cid:1)(cid:0)Y 0(t2, y) + Y 1(t2, y) log y(cid:1) w(cid:105)
= (cid:104)w(cid:48),(cid:0)Y 0(Y (t1, x − y)t2, y) + Y 1(Y (t1, x − y)t2, y) log y(cid:1) w(cid:105)

= (cid:104)w(cid:48),Y(t1, x)Y(t2, y)w(cid:105)
= (cid:104)w(cid:48),Y(Y (t1, x − y)t2, y)w(cid:105)

When t1 = t2 = 1, we may substitute any ﬁxed y ∈ C× and apply unique expansion
of single-variable logarithmic power series to ﬁnd that λ = 0, contradicting our
reduction to the case Y 1 (cid:54)= 0.

4 Rationality

In order to prove the main theorem, we will combine a result in [Miyamoto-2004]
about the modular invariance of characters with a method treating genus-one two-
point correlation functions introduced in [Huang-2005]. We ﬁrst recall the result
about the modular invariance property.

For a V -module U , we consider the trace function

ZU (v, τ ) := xwt(v) TrU Y U (v, x)qL(0)−c/24

τ

for τ in the complex upper half-plane H and v ∈ Vwt(v), where qz denotes e2πiz for
any suitable input z. We note that ZU (v, τ ) does not depend on x.

trace functions (cid:99)Trr+1 . . . ,(cid:99)Trr+d and complex numbers sj,k for j = 1, . . . , r and k =

Theorem 5. If V is C2-coﬁnite with non-negative L(0)-spectrum, and U 1, . . . , U r
represent the isomorphism classes of irreducible V -modules, then there are pseudo-
1, . . . , r + d, such that the following equality of functions on V × H holds:

sj,kZU k(v, τ ) +

k=1

k=r+1

8

τ− wt[v]ZU j (v,−1/τ ) =

r(cid:88)

r+d(cid:88)

sj,k(cid:99)Trko(v)qL(0)−c/24

(V, Y [, z], 1,(cid:101)ω)

Here, v ∈ V[wt[v]], where the bracket weight V[m] is deﬁned by Zhu’s modiﬁed VOA
structure

on V given by Y [v, z] := Y (v, qz − 1)qwt(v) and (cid:101)ω := (2πi)2(ω − c
for a linear combination U = (cid:80)
i∈D ξiZU i(v, τ ) and(cid:80)
notation ZU (v, τ ) and sU,j to denote(cid:80)

We may extend trace functions to virtual modules with complex coeﬃcients:
i∈D ξiU i of simple modules U i, we will abuse the
i∈D ξisi,j, respectively.
We won’t explain the precise deﬁnition of pseudo-trace functions, because we
are concerned with only the cases where pseudo-trace functions don’t appear.
If
τ− wt[v]ZU (v,−1/τ ) is a linear combination of trace functions on V -modules for all
v ∈ V , then we say that U is of type NPT. One point we would like to mention

about pseudo-trace functions is that(cid:99)Trko(1)qL(0) = 0 for any pseudo-trace function
(cid:99)Trk and the vacuum 1.

241).

4.1 Moore-Seiberg-Huang argument

We next explain the deﬁnition of composition-invertible power series and their ac-
tions on modules for the Virasoro algebra from [Huang-2005], and then extend
Huang’s results to the case of intertwining operators with logarithmic terms.

Let Aj, j ∈ N be the complex numbers deﬁned by

(cid:32)
−(cid:88)
For any V -module W , we denote the operator (cid:80)

(e2πiy − 1) =

1
2πi

(cid:32)

exp

Ajyj+1 ∂
∂y

j∈N

(cid:33)(cid:33)

y.

convenience, we introduce the operator

j∈N ajL(j) on W by L+(A). For

U(x) = (2πix)L(0)e−L+(A) ∈ (End W ){x}

where (2πi)L(0) = e(log 2π+iπ/2)L(0). We have U(1) = (2πi)L(0)e−L+(A) and U(qx) =
x U(1) as concrete examples. As Huang has shown in [4, Proposition 1.2], U(1)ω =
qL(0)
(2πi)2(ω − c

241) and

U(1)Y(w, x)U(1)−1 = Y(U(qx)w, qx − 1)

for an intertwining operator Y. Namely, we have

U(1)Y(w, x)U(1)−1 = Y[U(1)w, x]

where Y[w, x] = Y(w, qx− 1)qwt(w)
intertwining operator for the modiﬁed VOA (V, Y [, ], 1, ˜ω = U(1)ω) in [12]. So,

for homogeneous elements w deﬁnes the modiﬁed

x

(cid:77)

U{x} → (cid:77)

U∈mod(V )

U∈mod(V )

U{x}

U(1) :

(where we take a sum over isomorphism classes to avoid set-theoretic problems) gives
an isomorphism between (V, Y, 1, ω)-intertwining operators by W and (V, Y [, ], 1, ˜ω)-
intertwining operators by W via U(1) : W{x} → W{x}.

9

Lemma 6. For u ∈ Wn, U(1)w ∈ W[n].
Proof. The x−2-coeﬃcients of both sides of U(1)Y (ω, x)u = Y [U(1)ω, x]U(1)u yield
wt(u)U(1)u = L[0]U(1)u.

The following equations are proved for non-logarithmic intertwining operators
in [Huang-2005]. We will prove the same statement for every intertwining operator
even if it has logarithmic terms.

Lemma 7. Let B, U, T, P be V -modules. For Y ∈ I(cid:0) T

(cid:1), u ∈ U , and

(cid:1), Y1 ∈ I(cid:0) P

B,U

T,P

b ∈ B, we have the following formal equalities:

1. eτ L(0)Y(b, z)u = Y(eτ L(0)b, eτ z)eτ L(0)u in T{z, eτ}[y, τ ], where y = log z.
2. qL(0)Y(U(qy)b, qy) = Y(U(qyq)b, qyq)qL(0) in (Hom(U, T )){qy, q}[y, τ ]
3. Y1(Y(U(qy)b, qy−qx)U(qx)u, qx) = Y1(U(qx)Y(b, y−x)u, qx) in (End P ){qx, y−
(cid:80)
n∈C b(h,n)z−n−1yh. From the L(−1) derivative formula

Proof. Set Y(b, z) =(cid:80)K

x}[x, log(y − x)]

Y(L(−1)b, z) = d

h=0

dzY(b, z), we have
u = (L(−1)b)(h,n+1) + (L(0)b)(h,n)
= (−n − 1)b(h,n) + (h + 1)b(h+1,n) + (L(0)b)(h,n).

Using the notation (α ⊗ β)b(h,n)u = (αb)(h,n)βu, and Ω = L(0) ⊗ 1 + 1 ⊗ L(0), we
have

L(0)(b(h,n)u) = (−n − 1 + Ω)b(h,n)u + (h + 1)b(h+1,n)u

(−n − 1 + Ω)m−j(h + 1)··· (h + j)b(h+j,n)u

for m ≥ 1, where (h + 1)··· (h + j) = 1 for j = 0. Therefore, we obtain
eτ L(0)Y(b, z)u =

z−n−1

eτ L(0)

b(h,n)uyh

(cid:33)

L(0)mτ m

(b(h,n)uyhz−n−1)

(cid:18)m
(cid:19)
m(cid:88)
(cid:32) K(cid:88)

j=0

j

h=0

(cid:18)m
(cid:19)

j

m!

τ m
m!

L(0)m(b(h,n)u) =

=

=

h=0

m=0

n∈C

n∈C

(cid:88)
(cid:88)
∞(cid:88)
∞(cid:88)
(cid:88)
∞(cid:88)
∞(cid:88)
m(cid:88)
k(cid:88)
∞(cid:88)
∞(cid:88)
(cid:88)
(cid:88)
∞(cid:88)
∞(cid:88)
(cid:88)

n∈C

n∈C

n∈C

m=0

h=0

k=0

i=0

j=0

k=0

j=0

=

(Ω − n − 1)m−j(h + 1)··· (h + j)b(h+j,n)uyhz−n−1.

By replacing h + j and m = j by k and i, respectively, eτ L(0)Y(b, z)u equals
(k − j + 1)··· (k)τ jyk−jb(k,n)uz−n−1

τ i(Ω − n − 1)i

1
j!

i!

eτ (Ω−n−1)b(k,n)u(y + τ )kz−n−1

(eτ L(0)b)(k,n)(eτ L(0)u)(y + τ )keτ (−n−1)z−n−1

n∈C

=
= Y(eτ L(0)b, eτ z)(eτ L(0)u)

k=0

10

so the ﬁrst equation is proved. Replacing τ with 2πiτ , y with 2πiy, and b with U(qy)b
yields the second equation. The third equation follows from the second equation,
together with the following:

x U(1)Y(b, y − x)
U(qx)Y(b, y − x) = qL(0)
x Y(U(qy−x)b, qy−x − 1)U(1)
= qL(0)
= Y(U(qy−xqx)b, qx(qy−x − 1))qL(0)
= Y(U(qy)b, qy − qx)U(qx)

x U(1)

We now consider genus-one two-point correlation functions introduced by Huang
in Proposition 1.4 of [Huang-2005] (see also [Moore-Seiberg-1989]). From now on, to
simplify the notation, we assume that W is a simple V -module with integer weights.

Deﬁnition 8. Let W be a simple V -module with integer weights, and let U be a
simple V -module. We deﬁne the formal power series

ZU (w, w(cid:48), x − y, τ ) := TrU Y (U(qy)YW (w, x − y)w(cid:48), qy)qL(0)−c/24.

This is an element of C{qy, q}((x − y))[y, τ ]

In [Huang-2005], Huang showed that this power series is absolutely uniformly
convergent on compact sets in the region O4 = {(x, y, τ ) ∈ C2 × H||qx−y| > 1 >
|qx−y − 1| > 0}. While Huang shows in Proposition 5.4 of loc. cit.
that this
function satisﬁes a diﬀerential equation with regular singularities at speciﬁed loci,
and therefore can be analytically continued to a multivalued function on a dense
open subset of C2 × H, we will restrict our view to O4 (which is an inﬁnite disjoint
union of contractible open sets). This allows us to avoid the subtleties of showing
that multivalued functions are equal. By the third claim of Lemma 7, this function
is equal to

TrU Y (Y(U(qyqx−y)w, qy(qx−y − 1))U(qy)w(cid:48), qy)qL(0)−c/24

and we will view it as a formal power series in qx−y whose coeﬃcients are analytic
functions of τ ∈ H. A priori, it is also a formal power series in qy, but by the
following lemma, we can ignore that variable.
Lemma 9. TrU Y (U(qy)YW (w, x − y)w(cid:48), qy)qL(0)−c/24 does not depend on qy.

(cid:88)
r v(r), where v(r) ∈ Vr. Then the grade-preserving part of

(cid:88)

(cid:88)

(cid:16)(cid:88)

v(r)(cid:17)

y(v(r))mq−m−1
qr

y

qL(0)
y

m

q−m−1

y

=

m

m

r

Proof. Set U(1)v =(cid:80)
is(cid:80)
y =(cid:80)

Y (U(qy)v, qy) =

r−1qr

yv(r)

r qr

r v(r)

r−1 which does not depend on qy.

11

Remark 10. We point out a useful property of the operator U(qy). When we consider
the S-transformation τ (cid:55)→ −1/τ , we have to consider the bracket weight wt[v] of
v ∈ V . However, the coeﬃcients wmw(cid:48) of YW (w, x−y)w(cid:48) satisfy wt(wmw(cid:48)) = wt(w)+
wt(w(cid:48)) − m − 1 while U(1)wmw(cid:48) ∈ V[wt(w)+wt(w(cid:48))−m−1]. That is, for each m ∈ C, the
coeﬃcient of (x − y)m in ZU is a trace function on U with the grade-preserving
operator of U(1)wmw(cid:48) ∈ V[wt(w)+wt(w(cid:48))−m−1]. Therefore, the S-transformation of ZU
is

τ wt(w)+wt(w(cid:48)) TrU Y (U(qy)YW (w,

.
Then, since wmw(cid:48) ∈ Vwt(w)+wt(w(cid:48))−m−1, Lemma 6 and Theorem 5 imply

)w(cid:48), qy)qL(0)−c/24

−1/τ

x − y

τ

TrU j τ− wt(w)−wt(w(cid:48))Y (U(qy)YW (w,

)w(cid:48), qy)qL(0)−c/24

−1/τ

x − y

τ

r(cid:88)
r+d(cid:88)

k=1

k=r+1

=

+

sjk TrU k Y (U(qy)YW (w, x − y)w(cid:48), qy)qL(0)−c/24

ˆTrkY (U(qy)YW (w, x − y)w(cid:48), qy)qL(0)−c/24

sjk

by viewing both sides as formal power series in x − y with coeﬃcients in analytic
functions of τ .
Remark 11. Since |qx| > |qy| and 1 > |qx−y − 1| hold in the region O4, associa-
tivity (as in Theorem 9.11 of [Huang-Lepowsky-Zhang-2007]) implies there is a

Y1 ∈ I(cid:0)

U

W,W (cid:48)(cid:2)U

(cid:1) such that

(cid:104)u(cid:48), Y (U(qy)YW (w, x − y)w(cid:48), qy)u(cid:105) = (cid:104)u(cid:48),Y1(U(qx)w, qx)Y(cid:2)

(U(qy)w(cid:48), qy)u(cid:105)

for u ∈ U , u(cid:48) ∈ U(cid:48), w ∈ W , and w(cid:48) ∈ W (cid:48). In particular, as a formal power series of
q with the coeﬃcients in analytic functions on x and y, we have

TrU Y U (U(qy)YW (w, x − y)w(cid:48), qy)qL(0)−c/24 =

= TrU Y1(U(qx)w, qx)Y(cid:2)

(U(qy)w(cid:48), qy)qL(0)−c/24

in O4. Furthermore, since W and W (cid:48) are C2-coﬁnite, the coeﬃcient functions in x
and y attached to a power of q satisfy a certain regular singular diﬀerential equation
with known singularities (by [Huang-Lepowsky-Zhang-2007] section 11.2), so the
above functions are all holomorphic on O4.
Lemma 12. The set {ZU (w, w(cid:48), x − y, τ )}U∈Irr(V ) form a linearly independent col-
lection, when viewed as maps from W (cid:2) W (cid:48) to either holomorphic functions on O4
or formal power series.

Proof. By Proposition 4.21 of [Huang-Lepowsky-Zhang-2007], V is spanned by the
coeﬃcients of YW , so it suﬃces to show linear independence of traces of V on
simple modules U . This in turn follows from a straightforward adaptation of the
arguments in the beginning of the proof of Theorem 5.3.1 of [Zhu-1996]. Essentially,
the restriction of the trace functions to highest-weight subspaces come traces of
zero-mode operators on distinct irreducible A0(V )-modules, and we do not need
semisimplicity to conclude their linear independence.

12

Since TrU o(L[−1]v) = 0 and ZU does not depend on qy, we can extend the
skew-symmetry property of products to the following skew-symmetry property of
genus-one two-point correlation functions.

Lemma 13. If the weights of W are integers, then we have
ZU (w, w(cid:48), y − x, τ ) = ZU (w(cid:48), w, x − y, τ )

Proof. By direct calculation, we have

ZU (w, w(cid:48), y − x, τ ) = TrU Y (U(qx)YW (w, y − x)w(cid:48), qx)qL(0)−c/24

= TrU Y (U(qx)eL(−1)(y−x)YW (cid:48)(w(cid:48), x − y)w, qx)qL(0)−c/24
= TrU Y (eL[−1](y−x)U(qx)YW (cid:48)(w(cid:48), x − y)w, qx)qL(0)−c/24
= TrU Y (U(qy)YW (w(cid:48), x − y)w, qy)qL(0)−c/24

We note that the integral weight property of W is used in the second line.

Let us explain a method which we call the Moore-Seiberg-Huang argument. We
wish to express the following trace functions of V on (virtual) V -modules U and
P as linear combinations of trace functions of W (cid:2) W (cid:48) on those V -modules, using
formal Q-power series in qx, qy, and q:

1. TrP Y P (U(qy)Y V
2. TrU Y U (U(qx)Y V
For the ﬁrst trace function (1), we have the following lemma

W (cid:48),W (w(cid:48), x − y − 1)w, qy)qL(0)−c/24
W,W (cid:48)(w, y − x − τ )w(cid:48), qx)qL(0)−c/24

Lemma 14. Let P be a simple V -module with weights in p +N. Assume the weights
of W (cid:48) (cid:2) P are in r + N. Then

ZP (w, w(cid:48), x − y − 1, τ ) = e2πi(p−r)ZP (w, w(cid:48), x − y, τ )

Proof. By the associativity of products of intertwining operators, there is Y 1 ∈

I(cid:0)

P

W,W (cid:48)(cid:2)P

(cid:1) and Y 2 ∈ I(cid:0)W (cid:48)(cid:2)P

(cid:1) such that

W (cid:48),P

(cid:104)u(cid:48), Y (Y V

W,W (cid:48)(w, x − y)w(cid:48), y)u(cid:105) = (cid:104)u(cid:48),Y 1(w, x)Y 2(w(cid:48), y)u(cid:105) on O2

k|k ∈ B(P )} its dual basis. Then since

for all u(cid:48) ∈ P (cid:48) and u ∈ P . Let {uk|k ∈ B(P )} be a homogeneous basis and
{u(cid:48)
ZP (w, w(cid:48), x− y − 1, τ ) =

k, TrP Y (U(qy)YW (w, x− y − 1)w(cid:48), qy)qwt(u)−c/24uk(cid:105)
(cid:104)u(cid:48)

(cid:88)

k∈B(P )

we use the expansion of ZP in Remark 11 to get:

ZP (w, w(cid:48), x − y − 1, τ ) = TrP Y 1(U(qx)w, qx)Y 2(U(qye2πi)w(cid:48), qye2πi)qL(0)−c/24
= TrP Y 1(U(qx)w, qx)e2πi(p−r)Y 2(U(qy)w(cid:48), qy)qL(0)−c/24
= e2πi(p−r) TrP Y 1(U(qx)w, qx)Y 2(U(qy)w(cid:48), qy)qL(0)−c/24
= e2πi(p−r)ZP (w, w(cid:48), x − y, τ ).

13

The second equality follows from the ﬁrst claim of Lemma 7 with the substitution
τ = e2πi. While the Lemma asserted an equality of formal series in τ , this substi-
tution gives an equality of holomorphic functions by the C2-coﬁniteness of W and
P .

For the second trace function (2), we have the following lemma

Lemma 15. Let U be a simple V -module. Then as a formal Q power series of qx,
qy, and q, ZU (w, w(cid:48), y − x − τ, τ ) is a linear sum of trace functions of W (cid:48) (cid:2) W on
V -modules W (cid:48) (cid:2) U . Namely, there is Y 2
ZU (w, w(cid:48), y − x − τ, τ ) = TrW (cid:2)U Y 2

W (cid:48)(cid:2)W,W (cid:48)(cid:2)U
W (cid:48),W (w, y − x)w(cid:48), qy)qL(0)−c/24.

U (U(qy)Y(cid:2)

Proof. By Remark 11 (i.e., associativity of intertwining operators as described in
[Huang-Lepowsky-Zhang-2007]) there is Y 1

U ∈ I(cid:0) W (cid:48)(cid:2)U
U ∈ I(cid:0)

U

(cid:1) such that
(cid:1) such that

W,W (cid:48)(cid:2)U
U (w, x)Y(cid:2)

W (cid:48),U (w(cid:48), y)u(cid:105)

(cid:104)u(cid:48), Y U (Y V

W,W (cid:48)(w,−y)w(cid:48), y)u(cid:105) = (cid:104)u(cid:48),Y 1

and so we have

ZU (w, w(cid:48), y − x − τ, τ ) = TrU Y 1
= TrU Y 1
= TrW (cid:48)(cid:2)U Y(cid:2)

U (U(qx)w, qx)Y(cid:2)
U (U(qx)w, qx)qL(0)−c/24Y(cid:2)

W (cid:48),U (U(qyq)w(cid:48), qyq)qL(0)−c/24
W (cid:48),U (U(qy)w(cid:48), qy)
U (U(qx)w, qx)qL(0)−c/24,

W (cid:48),U (U(qy)w(cid:48), qy)Y 1

U ∈ I(cid:0) W (cid:48)(cid:2)U

where we use the second claim of Lemma 7 to obtain the second line, and the cyclic
symmetry of traces to obtain the third line. We apply associativity again to see that
there is Y 2
ZU (w, w(cid:48), y − x − τ, τ ) = TrW (cid:48)(cid:2)U Y 2

(cid:1) qL(0)−c/24 (4.1.1)

(cid:0)U(qy)Y(cid:2)

W (cid:48),W (w(cid:48), y − x)w, qy

W (cid:48)(cid:2)W,W (cid:48)(cid:2)U

U

(cid:1) such that

as we desired.

We write ZW (cid:48)(cid:2)U (Y 2

U , w(cid:48), w, y−x, τ ) to denote the right side of the equation in the
above lemma. In order to use both equations (1) and (2), we consider the following
situations (note that this depends on our ﬁxed irreducible module W with integral
weights):
Deﬁnition 16. Suppose V has non-negative L(0)-spectrum, and let {U i}i∈D be a
i∈D xiU i be a virtual module with complex

collection of V -modules, and let U =(cid:80)

coeﬃcients.

NPT We say that U satisﬁes the property NPT (for “no pseudo-trace”) if the S-
transformation of the trace function on U is a linear combination of trace
functions on V -modules. Equivalently, the decomposition of τ wt[v]ZU (v,−1/τ )
given in Theorem 5 has no contributions from pseudo-traces for any v ∈ V .

SW We say that a module U i satisﬁes the property SW (single weight) if the
generalized eigenvalues of L(0) on W (cid:2) U i lie in a single coset of Z. We say
that the collection {Ui}i∈D satisﬁes SW if each U i satisﬁes SW.

14

(cid:88)
(cid:88)

j

i∈D xiU i satisﬁes property

Lemma 17. Suppose {U i}i∈D satisﬁes SW, and U =(cid:80)
NPT. Then(cid:88)

xi

i∈D

si,jZW (cid:2)U j (Y 2

U j , w, w(cid:48), y − x, τ )

(cid:32)(cid:88)
where ZU denotes (cid:80)
i ∈ D, and ˆZk(w, w(cid:48), x−y, τ ) denotes the pseudo-trace function(cid:99)Trk(U(qy)YW (w, x−

i∈D xiZU i, N = wt(w) + wt(w(cid:48)), κi = ewt(W (cid:2)U i)−wt(U i) for all

si,jZU j (w(cid:48), w, x − y, τ ) +

ˆZj(w(cid:48), w, x − y, τ )

(cid:88)

(cid:33)

xiκi

i∈D

si,j

=

j

j

Proof. We obtain the following chain of equalities

y)w(cid:48), qy)qL(0)−c/24.

(cid:88)

i∈D

xi

(cid:88)
(cid:88)

j

i∈D

(cid:88)

j

si,jZW (cid:2)U j (Y 2

U j , w, w(cid:48), y − x, τ )

=

xi

si,jZU j (w(cid:48), w, y − x − τ, τ )

y − x − τ
τ
y − x

,−1/τ )
− 1,−1/τ )

τ

xiκiZU i(w(cid:48), w,

y − x

τ

,−1/τ )

= τ−N ZU (w(cid:48), w,
= τ−N ZU (w(cid:48), w,

= τ−N(cid:88)
(cid:88)

i∈D

xiκi

=

i∈D

(cid:32)(cid:88)

j

si,jZU j (w(cid:48), w, y − x, τ ) +

(cid:33)

ˆZj(w(cid:48), w, y − x, τ )

(cid:88)

j

si,j

where the ﬁrst equality comes from Lemma 15, the second equality is property NPT
combined with Remark 10, the fourth equality is Lemma 14 combined with property
SW, and the ﬁfth is the combination of Remark 10 and Lemma 13.

i∈D xiU i satisﬁes NPT and UW, then the following two

i∈D xi

statements hold:

Lemma 18. If U = (cid:80)
1. (cid:80)
(cid:80)
j si,jZW (cid:2)U j (Y 2
2. The virtual module(cid:80)
Proof. The sum(cid:80)
(cid:80)
(cid:88)
(cid:88)

i∈D xi

xi

i∈D

j

coeﬃcients are trace functions of V on V -modules.

U , w, w(cid:48), y − x, τ ) is a power series in y − x whose

U j , w, w(cid:48), y − x, τ ) that appears on the left
side of Lemma 17 is a linear combination of trace functions of W (cid:2) W (cid:48). By this, we
mean that the coeﬃcient attached to (y − x)−m−1 is

i∈D xiκiU i satisﬁes NPT.
j si,jZW (cid:2)U j (Y 2

si,j TrW (cid:2)U j Y 2

U j (U(qy)wmw(cid:48), qy)qL(0)−c/24.

However, by Remark 10, the sum on the right side of that Lemma is a linear com-
bination of trace and pseudo-trace functions of operators from V , where we mean

15

that the coeﬃcients of powers of y − x are linear maps from W (cid:2) W (cid:48) to a space of
holomorphic functions in τ that vanish on the kernel of πW : W (cid:2)W (cid:48) → V . Since the
two sides are equal, we conclude that the contributions from pseudo-traces vanish,
and all trace contributions come from V . This proves the ﬁrst claim.

For the second claim, we note that the previous paragraph yields the equality

xiκiZU i(w(cid:48), w,

y − x

τ

,−1/τ ) =

xiκi

si,jZU j (w(cid:48), w, y − x, τ )

τ−N(cid:88)

i∈D

(cid:88)

i∈D

(cid:88)

j

If we choose our integral weight module W to be V , then we obtain a decomposition
of ZU (v,−1/τ ) into traces by setting w(cid:48) = 1.
Proposition 19. If V has non-negative L(0)-spectrum, then for every j, T j satisﬁes
NPT.

Proof. We note that each T j satisﬁes property SW because it is a simple current.
In particular, if W is any irreducible V -submodule of a σ-twisted T -module, then
wt(W (cid:2) T j) − wt(W ) ≡ j
n by the monodromy property of twisted modules. Such a
σ-twisted T -module exists by Theorem 1.1(ii) of [Dong-Li-Mason-2000], so a choice
of W always exists.

We claim that we may assume that W has integral weight. To show this we
note that the lowest weight of W is rational because V is C2-coﬁnite, so there is
a lattice VOA VL (for L positive-deﬁnite and even) and a simple VL-module VL+α
such that wt(W ) + wt(VL+α) ∈ Z. Then T ⊗ VL is a regular VOA with nonsingular
invariant bilinear form, and ˆσ = σ⊗ idVL is a ﬁnite order automorphism whose ﬁxed
point sub-VOA is V ⊗ VL. If T j ⊗ VL satisﬁes NPT, then T j satisﬁes NPT, so if W
has non-integral weight, we may replace V with V ⊗ VL and W with W ⊗ VL+α for
suitable L and α in the following paragraph.

Set ξ = e2πi/n. We will prove that(cid:80)n−1
(cid:80)n−1
17. By the second claim of Lemma 18, we ﬁnd that (cid:80)n−1

j=0 ξkjT j satisﬁes NPT for all k by induction
on k. The case k = 0 follows from the assumption that T is regular. Now, suppose
j=0 ξkjT j satisﬁes NPT for some k. Thus, we obtain the equalities given in Lemma
j=0 ξ(k+1)jT j also satisﬁes
NPT. Since this holds for all k, by a discrete Fourier transform, we conclude that
any linear combination of T j satisﬁes NPT.

4.2 Rigidity
Let T be a regular VOA with a ﬁnite automorphism σ satisfying T (cid:48) ∼= T and let
V be the ﬁxed point subVOA T σ. As we showed, V is projective and V (cid:48) ∼= V .
Thus, for each simple V -module W , there is a unique pair given by a projection
πW : W (cid:2) W (cid:48) → V and an embedding eW : V → W (cid:2) W (cid:48), such that πW ◦ eW = idV .
A simple V -module W is called “rigid” if the following composite is an isomorphism:

W (cid:2) V

idW (cid:2)eW(cid:48)−→ W (cid:2) (W (cid:48) (cid:2) W )

µ→ (W (cid:2) W (cid:48)) (cid:2) W πW (cid:2)idW−→ V (cid:2) W

(4.2.1)

Our purpose to prove that every simple V -module W is rigid.
We ﬁrst deﬁne some notation that we will use later.

16

Deﬁnition 20. Set D = eW (V ) (cid:2) W ⊂ (W (cid:2) W (cid:48)) (cid:2) W . Then D is a direct
factor of (W (cid:2) W (cid:48)) (cid:2) W , and we let iD and πD denote the corresponding inclusion
and projection maps. Similarly, we set F = µ−1(D) and let iF and πF denote the
inclusion and projection maps. We end up with the following diagram:

F

πF

iF 

W (cid:2) (W (cid:48) (cid:2) W )

µ|F

µ /

D

πD

eW (cid:2)idW

iD 

/ (W (cid:2) W (cid:48)) (cid:2) W

/ V (cid:2) W

πW (cid:2)idW

Lemma 21. W is rigid if and only if Ker πF does not contain W (cid:2) eW (cid:48)(V ).
Proof. This follows from the fact that µ|F : F → D and eW (cid:2) idW : V (cid:2) W → D
are isomorphisms.

Let us explain the rigidity condition from the viewpoint of intertwining operators.

W ∈ I(cid:0) W

(cid:1) for U = W in the proof of Lemma 15

Recall that we introduced Y 1
as an intertwining operator satisfying

W,W (cid:48)(cid:2)W

(cid:0)Y V
W,W (cid:48)(w, x − y)w(cid:48), y(cid:1) u(cid:105) = (cid:104)u(cid:48),Y 1

(cid:104)u(cid:48), YW

W (w, x)Y(cid:2)

W (cid:48),W (w(cid:48), y)u(cid:105)

(4.2.2)

for u, w ∈ W, u(cid:48), w(cid:48) ∈ W (cid:48).

Lemma 22.

W,W (cid:48)(cid:2)W

W (w, x)Y(cid:2)

Y 1
W = iF πFY(cid:2)
Proof. By applying µ to YW (Y V
W,W (cid:48)(w, x − y)w(cid:48), y)u = πD(Y(cid:2)
y)w(cid:48), y)u, we ﬁnd that Y 1
W = πFY(cid:2)
and so Y 1
Lemma 23. KerY 1
of W (cid:48) (cid:2) W .
Proof. Since Y 1
we have

W is an intertwining operator, for p ∈ KerY 1

W,W (cid:48)(cid:2)W as we desired.
W := {u ∈ W (cid:48) (cid:2) W | Y 1

W (cid:48),W is equal to πF (Y(cid:2)

W (w, x)u = 0∀w ∈ W} is a sub V -module

W , v ∈ V, m ∈ Z, w ∈ W ,

W (cid:2)W (cid:48),W (Y(cid:2)
W,W (cid:48)(cid:2)W (w, x)Y(cid:2)

W,W (cid:48)(w, x −
W (cid:48),W (w(cid:48), y)u)

W (w, x)vmp = vmY 1
Y 1

Y 1
W (vjw, x)px−m+j = 0.

W (w, x)p −(cid:88)

(cid:18)m

(cid:19)

j∈N

j

The following is a relation between intertwining operators and rigidity.

Lemma 24. W is rigid if and only if KerY 1
Proof. By checking coeﬃcients of πFY(cid:2)
Ker πF contains W (cid:2) eW (cid:48)(V ) if and only if Ker πFY(cid:2)
claim then follows from the rigidity criterion of Lemma 21, the expansion of Y 1
Lemma 22, and the fact that iF is an isomorphism.

it is straightforward to see that
W,W (cid:48)(cid:2)W contains eW (cid:48)(V ). The
W in

W does not contain eW (cid:48)(V ).

W,W (cid:48)(cid:2)W ,

17

/
/


O
O
O
O
/
h
h
We now prove the following main result of this subsection. Let sT T denote the
S-matrix coeﬃcient of ZT (v, τ ) in the expansion of τ wt[v]ZT (v,−1/τ ) into a linear
combination of trace functions on T -modules.

Proposition 25. If V has non-negative L(0)-spectrum and sT T is nonzero, then
every simple V -module is rigid.

As we mentioned in the introduction, the hypothesis of this proposition holds
when T is of CFT type, by the Verlinde formula (in particular, Theorem 5.5 in
[Huang-2008]).

(cid:88)

Proof. Let W be a simple V -module. We may assume that W has integral weights,
by following the same method as in the proof of Proposition 19. That is, by taking
tensor products with a suitable lattice VOA VL and a rigid simple module VL+α, we
obtain a simple V ⊗ VL-module W ⊗ VL+α with integral weights, and W is rigid as
a V -module if and only if W ⊗ VL+α is rigid as a V ⊗ VL-module.
By Proposition 19, every T i satisﬁes condition NPT and so there is λU ∈ C for

each simple V -module U such that

x − y

τ

(τ )−N ZT i(w, w(cid:48),

,−1/τ ) =

λU ZU (w, w(cid:48), x − y, τ ),

U∈irr(V )

By our hypothesis, S-transformation of ZT (w, w(cid:48), x−y, τ ) =(cid:80)n−1

where irr(V ) denotes the set of simple V -modules and N = wt[w] + wt[w(cid:48)].
j=0 ZT j (w, w(cid:48), x−
y, τ ) is a linear combination of trace functions on T -modules and ZT (w, w(cid:48), x− y, τ )
In particular, by decomposing T -modules as
appears with a nonzero coeﬃcient.
V -modules, ZV (w, w(cid:48), x − y, τ ) appears with a nonzero coeﬃcient. Therefore, there
is some T j such that ZV (w, w(cid:48), x − y, τ ) appears with nonzero coeﬃcient in the
S-transformation ZT j (w, w(cid:48), x−y
x − y

,−1/τ ). We ﬁx j and write
,−1/τ ) =

λU ZU (w, w(cid:48), x − y, τ )

(τ )−N ZT j (w, w(cid:48),

(cid:88)

τ

τ

U∈irr(V )

where λV (cid:54)= 0. Since T j is a simple current, Lemma 14 implies there is some
ξ ∈ C \ {0} such that

ZT j (w, w(cid:48), x − y + 1, τ ) = ξZT j (w, w(cid:48), x − y, τ )

We consider the S-transformation of ZT j (w, w(cid:48), x − y, τ ):

(τ )−N ξZT j (w, w(cid:48),

x
τ

− y
τ

,−1/τ )
− y
τ

x
τ
x − y + τ

+ 1,−1/τ )
,−1/τ )

= (τ )−N ZT j (w, w(cid:48),
= (τ )−N ZT j (w, w(cid:48),

(cid:88)
(cid:88)
(cid:88)

U

U

=

=

=

τ

λU ZU (w, w(cid:48), x − y + τ, τ )
λU ZU (w(cid:48), w, y − x − τ, τ )
TrW (cid:48)(cid:2)U Y 2

U (U(qy)Y(cid:2)

U

18

W (cid:48),W (w(cid:48), y − x)w, qy)qL(0)−c/24.

On the other hand,

(τ )−N ξZT j (w, w(cid:48),

x
τ

− y
τ

,−1/τ )

= (τ )−N ξZT j (w(cid:48), w,

y
τ

− x
τ

,−1/τ )

λU ZU (w(cid:48), w, y − x, τ )
λU TrU Y U (πW (cid:48)U(qy)Y(cid:2)

(cid:88)
(cid:88)

U

U

= ξ

= ξ

Therefore, we have

ξ(cid:80)

U∈irr(V ) λU TrU Y U(cid:0)πW (cid:48)U(qy)Y(cid:2)
(cid:0)U(qy)Y(cid:2)
=(cid:80)

U∈irr(V ) TrW (cid:48)(cid:2)U Y 2

U

W (cid:48),W (w(cid:48), y − x)w, qy)qL(0)−c/24

(cid:1) qL(0)−c/24
(cid:1) qL(0)−c/24.

By comparing coeﬃcients of the expansions in y − x and log(y − x), we see that for
any r ∈ W (cid:48) (cid:2) W , we have

λU TrU Y U (πW (cid:48)(r), z)qL(0)−c/24 =

TrW (cid:48)(cid:2)U Y 2(r, z)qL(0)−c/24

(cid:88)

ξ

U∈irr(V )

for r ∈ W (cid:48) (cid:2) W . In particular, we may restrict to r ∈ eW (cid:48)(V ) to ﬁnd that

W (cid:48),W (w(cid:48), y − x)w, qy

W (cid:48),W (w(cid:48), y − x)w, qy
(cid:88)

U∈irr(V )

(cid:88)

ξ

U∈irr(V )

(cid:88)

=

U∈irr(V )

λU TrU Y U (πW (cid:48)(r), z)qL(0)−c/24

TrW (cid:48)(cid:2)U Y 2(eW (cid:48)πW (cid:48)(r), z)qL(0)−c/24

and so

(cid:88)

ξ

U∈irr(V )

(cid:88)

=

U∈irr(V )

λU TrU Y U (πW (cid:48)U(qy)Y(cid:2)

W (cid:48),W (w(cid:48), y − x)w, qy)qL(0)−c/24

TrW (cid:48)(cid:2)U Y 2

U (eW (cid:48)πW (cid:48)U(qy)Y(cid:2)

W (cid:48),W (w(cid:48), y − x)w, qy)qL(0)−c/24

(4.2.3)

The composition of Y 2
V,W (cid:48)(cid:2)U

ator of the form I(cid:0) W (cid:48)(cid:2)U
(cid:1). Therefore, we can replace this composition with a linear
combination (cid:80) aRU YRU of vertex operators YRU of V on the simple composition
(cid:88)

U with eW (cid:48) applied to the ﬁrst input is an intertwining oper-

factors RU of W (cid:48) (cid:2) U , yielding

λU TrU Y U (πW (cid:48)U(qy)Y(cid:2)

W (cid:48),W (w(cid:48), y − x)wqL(0)−c/24

ξ

U∈irr(V )

(cid:88)

(cid:88)

U∈irr(V )

RU

=

aRU ZRU (w(cid:48), w, y − x, τ ),

where RU runs over the composition factors of W (cid:48) (cid:2) U .
By our choice of T j, we have λV (cid:54)= 0. By Lemma 12, the traces ZRU (w(cid:48), w, y −
x, τ ) are linearly independent, so there is some U such that RU ∼= V with nonzero

19

coeﬃcient. Since W (cid:48) (cid:2) U then has a composition factor isomorphic to V , the pro-
jectivity of V (from Theorem 4) implies V is a submodule, and self-duality of V
then implies V is a direct summand. Thus, there is a nonzero intertwining operator

(cid:1). By the duality properties of intertwining operators, the irreducible

of type(cid:0) V

W (cid:48),U

module U is then necessarily isomorphic to W , so RW = eW (cid:48)(V ). Thus, we have
the following nonvanishing summand on the right side of Equation 4.2.3:

(cid:0)U(qy)πW (cid:48)Y(cid:2)

TrRW Y 2

W

W (cid:48),W (w(cid:48), y − x)w, qy

(cid:1) qL(0)−c/24 (cid:54)= 0.

By the properties of Y 2 given in the proof of Lemma 15, the left side is equal to

TrRW Y(cid:2)

W (cid:48),W (U(qy)w(cid:48), qy)Y 1
W (w, x)RW (cid:54)= 0. This implies KerY 1

and so Y 1
criterion of Lemma 24, W is rigid.

W (U(qx)w, qx)qL(0)−c/24
W does not contain eW (cid:48)(V ), so by the

4.3 Rationality of the ﬁxed-point subVOA

Theorem 26. Let T be a simple regular VOA with a nonsingular invariant form,
and suppose sT T (cid:54)= 0. Let σ be a ﬁnite order automorphism of T such that V = T σ
has non-negative L(0)-spectrum. Then V is rational.

Proof. It suﬃces to show that any simple V -module W is projective.

Consider a V -module surjection f : D → W . We wish to show that it splits. By

taking its pullback along

πW (cid:2)1W (cid:2)U : (W (cid:2) W (cid:48)) (cid:2) W → V (cid:2) W,

we have the following commutative diagram:

W (cid:2) (W (cid:48) (cid:2) D)

1W (cid:2)(1W(cid:48)(cid:2)f )

W (cid:2) V

/ W (cid:2) (W (cid:48) (cid:2) W )

1W (cid:2)eW

µ

µD /

(W (cid:2) W (cid:48)) (cid:2) D
1W(cid:2)W(cid:48)(cid:2)f
/ (W (cid:2) W (cid:48)) (cid:2) W

πW (cid:2)1D/

V (cid:2) D
1V (cid:2)f
/ V (cid:2) W

πW (cid:2)1W

where µD is an isomorphism making the left square commute (and this exists by the
universal property of fusion). We will show that a splitting of f exists by ﬁnding
a submodule of W (cid:2) (W (cid:48) (cid:2) D) that is isomorphic to W , such that the diagram
produces an isomorphism to V (cid:2) W that factors through V (cid:2) D.
Consider the set X of submodules Q ⊆ W (cid:48)(cid:2)D such that 1W (cid:2)(1W (cid:48)(cid:2)f )(W (cid:2)Q) =
W (cid:2) eW (V ). This set is nonempty, since we can just take the pullback. For any
such submodule Q ∈ X, we have a surjection 1W (cid:48)(cid:2)f : Q → eW (V ), and since V is
projective by Theorem 4, there is a section V → Q. In particular, if we take Q to
be a minimal element of X, then Q is isomorphic to V .

Under this choice of Q, Proposition 25 gives us an isomorphism
(πW (cid:2)1W ) ◦ µ ◦ (1W (cid:2)(1W (cid:48)(cid:2)f )) : W (cid:2) Q → V (cid:2) W.

By commutativity of the diagram, (πW (cid:2)1D) ◦ µD(W (cid:2) Q) is a submodule of V (cid:2) D
that is isomorphic to W , and maps isomorphically to V (cid:2) W along 1V (cid:2)f . Thus,
f : D → W splits.

20

/


/




/
/
/
Corollary 27. Let T be a simple regular VOA of CFT type that is self-dual as a
T -module, and let G be a ﬁnite solvable group of automorphisms of T . Then the ﬁxed
point subVOA T G is simple, regular, of CFT type, and self-dual as a T G-module.

Proof. We may reduce to the case that G is cyclic of prime order by induction along
the composition series of G. We may then apply Theorem 26 because Theorem 5.5
of [Huang-2008] asserts that sT T (cid:54)= 0 under our hypotheses.
Corollary 28. Let T be a simple regular VOA, and suppose sT T (cid:54)= 0. Let σ be a
ﬁnite order automorphism such that T σ has non-negative L(0)-spectrum. Then T is
σ-rational. That is, all σ-twisted modules are completely reducible.

Proof. By Theorem 26, T σ is rational, so by Theorem 2.5 of [Miyamoto-2004],
the associative algebra Ak(T σ) is ﬁnite dimensional, and by Theorem 4.10(a) in
[Dong-Li-Mason-1998a], it is semisimple for all integers k. As mentioned in the
proof of Proposition 2.5 in [Dong-Li-Mason-1998b], the associative algebra Aσ,n(T )
is a quotient of A(cid:98)n(cid:99)(T σ) for all n ∈ 1|σ|Z≥0. Thus, each Aσ,n(T ) is semisimple. By
of the associative algebras Aσ,n(T ) for all n ∈ 1|σ|Z≥0.

Theorem 4.5 of [Dong-Li-Mason-1998b], σ-rationality is equivalent to semisimplicity

We note that Theorem 10.1 of [Dong-Li-Mason-2000] and Corollary 28 combine
to yield an SL2(Z)-compatibility result for characters of twisted modules for any
holomorphic C2-coﬁnite VOA of CFT type. In particular, this resolves one of the
principal claims in Generalized Moonshine for V (cid:92).

References

[Borcherds-1986]

[Dong-Li-Mason-2000]

[Dong-Li-Mason-1998b]

[Dong-Li-Mason-1998a]

[Dong-Mason-1997]

R. E. Borcherds, Vertex algebras, Kac-
Moody
the Monster,
Proc. Natl. Acad. Sci. USA 83 (1986),
3068–3071.

algebras,

and

C. Dong, H. Li, G. Mason, Modular invariance
of trace functions in orbifold theory Comm.
Math. Phys. 214 (2000) no. 1, 1–56.

C. Dong, H. Li, G. Mason, Twisted representa-
tions of vertex operator algebras and associative
algebras Internat. Math. Res. Notices 8 (1998),
389–397.

C. Dong, H. Li, G. Mason, Vertex operator al-
gebras and associative algebras J. Algebra 206
(1998), 67–96.

C. Dong, G. Mason, On quantum Galois theory,
Duke Math. J. 86 (1997), no.2, 305–321.

21

[Frenkel-Lepowsky-Meurman-1988] I. Frenkel, J. Lepowsky, A. Meurman, Ver-
tex operator algebras and the Monster Pure
and Applied Mathematics 134 Academic Press,
Inc., Boston, MA, (1988).

[Huang-2005]

[Huang-2008]

[Huang-Lepowsky-1995]

[Huang-Lepowsky-Zhang-2007]

[Miyamoto-2004]

[Miyamoto-2014]

[Miyamoto-2015a]

[Miyamoto-2015b]

[Moore-Seiberg-1989]

[Zhu-1996]

Y.-Z. Huang, Diﬀerential equations, duality and
modular invariance, Commun. Contemp. Math.
7 (2005), no. 5, 649–706.

Y.-Z. Huang, Vertex operator algebras and the
Verlinde conjecture, Commun. Contemp. Math.
10 (2008), no. 1, 103–154.

Y.-Z. Huang, J. Lepowsky, A theory of fusion
products for module categories for a vertex al-
gebra, I, Selecta Mathematica, New Series Vol.
1 (1995), 699–756.

Y.-Z. Huang, J. Lepowsky, L. Zhang. Loga-
rithmic tensor product theory for generalized
modules for a conformal vertex algebra ArXiv
preprint: 0710.2687

M. Miyamoto, Modular invariance of vertex op-
erator algebra satisfying C2-coﬁniteness, Duke
Math. J. 122, no. 1, 51–91 (2004)

M. Miyamoto, C1-coﬁniteness and Fusion Prod-
ucts for Vertex Operator Algebras, ”Confor-
mal Field Theories and Tensor Categories”
held in 2011 (editor Y.-Z. Huang et al.),
Mathematical Lectures from Peking Univer-
sity, Springer-Verlag Berlin Heidelberg, 271–279
(2014) arXiv:1305.3008

M. Miyamoto, C2-coﬁniteness of cyclic-orbifold
models, Comm. Math. Phys. 335 (2015), no. 3,
1279–1286

M. Miyamoto, Pure exactness of the principal
cover of vertex operator algebras, J. Algebra
423 (2015), 289–300.

G. Moore and N.Seiberg, Classical and quantum
conformal ﬁeld theory, Comm. Math. Phys. 123
(1989), 177–254.

Y. Zhu, Modular invariance of characters of
vertex operator algebras, J. Amer. Math. Soc.
9 (1996), 237–302.

22

