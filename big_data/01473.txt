6
1
0
2

 
r
a

 

M
4
1

 
 
]
P
A
h
t
a
m

.

[
 
 

4
v
3
7
4
1
0

.

3
0
6
1
:
v
i
X
r
a

Exact and optimal controllability for scalar
conservation laws with discontinuous ﬂux

Adimurthi∗

Shyam Sundar Ghoshal†

Pierangelo Marcati‡

March 16, 2016

Abstract

This paper deals with an optimal control problem and describes the
reachable set for the scalar 1-D conservation laws with discontinuous
ﬂux. Regarding the optimal control problem we ﬁrst prove the exis-
tence of a minimizer and then we prescribe an algorithm to compute
it. The same method also applies to compute the initial data control.
The proof relies on the explicit formula for the conservation laws with
the discontinuous ﬂux and ﬁner properties of the characteristics.

Key words: Scalar conservation laws, discontinuous ﬂux, exact control, op-
timal control, Hamilton-Jacobi equation.

1

Introduction

The goal of this paper is to study the optimal and exact control problem of
the following scalar conservation laws with discontinuous ﬂux

( ut + F (x, u)x = 0,

u(x, 0) = u0(x),

(1)

where the ﬂux F is given by, F (x, u) = H(x)f (u) + (1 − H(x))g(u), H is the
Heaviside function. Through out the present article we assume the ﬂuxes
f, g to be C 1(R), strictly convex with superlinear growth; u0 ∈ L∞. We
denote by θf , θg the unique minima of the ﬂuxes f, g respectively.

∗Centre for Applicable Mathematics, Tata Institute of Fundamental Research, Post Bag
No 6503, Sharadanagar, Bangalore - 560065, India. Email: aditi@math.tifrbng.res.in.
†Gran Sasso Science Institute, Viale Francesco Crispi, 7, 67100 L’Aquila, Italy. Email:

shyam.ghoshal@gssi.infn.it.

‡Gran Sasso Science
and Department

7,

67100 L’Aquila,
and
Email:

Science

Italy.

Italy
Mathematics,
pierangelo.marcati@gssi.infn.it/pierangelo.marcati@univaq.it.

Information Engineering, Computer

University

L’Aquila,

of

67100

L’Aquila,

Institute, Viale Francesco Crispi,
of

1

CONTROLLABILITY FOR DISCONTINUOUS FLUX

2

There is no literature concerning reachable set or any sort of optimal
controllability results for equations of type (1).
In the present paper we
obtain a necessary and suﬃcient condition for the reachable set and we
prove the existence of a minimizer for an optimal control problem. In order
to obtain an initial data control or ﬁnding minimizer of optimal control, we
use a new backward resolution. The advantage of this approach is that it
is constructive and easy to compute. The main diﬃculty of this backward
resolution is that there are no rarefactions originating from the interface
x = 0, then one cannot just generalize, to the case f 6= g, the backward
construction given in [1, 2] for the case in f = g.

In order to state our main results, we need to introduce various notations
and technical arguments hence the main Theorems 4.1 and 5.1 have been
postponed to the sections 4 and 5 respectively.

The scalar conservation laws with discontinuous ﬂux of type (1) has a
huge variety of applications in several ﬁelds, namely traﬃc ﬂow modeling,
modeling gravity, modeling continuous sedimentation in clariﬁer-thickener
units, ion etching in the semiconductor industry and many more.

In the past two decades the ﬁrst order model of type (1) has been exten-
sively studied from both the theoretical and numerical point of view. Con-
cerning the uniqueness it is worth to mention that the following Kruˇzkov
type entropy inequalities in both the two upper quarter-planes are not suf-
ﬁcient to guarantee the uniqueness,

∂t + ψ1(u) ∂s

∞

∞

0

∞

R0 (cid:0)φ1(u) ∂s
R0
R0 (cid:0)φ2(u) ∂s
R−∞

∞

R0

∂x(cid:1) ≥ −
∂x(cid:1) ≥
R0

∞

ψ1(u(0+, t))s(0, t)dt,

(2)

∂t + ψ2(u) ∂s

ψ2(u(0+, t))s(0, t)dt.

Here (φi, ψi) denote the entropy pairs for i = 1, 2 and s ∈ C 1
0 (R × R+), a
non-negative test function. Consequently one need an extra criteria on the
interface called ”interface entropy condition” (see [4]) given by

meas{t : f ′(u(0+, t)) > 0, g′(u(0−, t)) < 0} = 0.

(3)

Using this extra entropy along with the above Kruˇzkov type inequalities the
uniqueness result has been obtained in [4]. On the other hand, the exis-
tence result has been proved in several ways, namely via Hamilton-Jacobi,
convergence of numerical schemes, vanishing viscosity method, for further
details we refer the reader to [4, 5, 6, 7, 9, 13, 14, 20, 21, 25] and the refer-
ences therein. The present paper uses the explicit formula obtained in [4, 7],
via the Hamilton-Jacobi Cauchy problem. By using this formula it can be
shown that if v0 is uniformly Lipschitz then v(·, t) is also uniformly Lipschitz
for all t > 0 and if we denote u := ∂v
∂x , it follows easily that u is the unique
weak solution (see [4]) satisfying (2), enjoys (3) near interface and satisﬁes

CONTROLLABILITY FOR DISCONTINUOUS FLUX

the following Rankine-Hugoniot condition on the interface.

meas(cid:8)t : f (u(0+, t)) 6= g(u(0−, t))(cid:9) = 0.

3

(4)

∞

R−∞

Regarding the well-posedness theory to f = g case, we refer the reader to
[19] for Cauchy problem and for the initial boundary value problem to [24].
Through out this paper we work with the solution which is obtained

from the Hamilton-Jacobi formulation.

Concerning the exact controllability for the scalar convex conservation
laws the ﬁrst work has been done in [10], where they considered the initial
boundary value problem in a quarter plane with u0 = 0 and by using one
boundary control they investigated the reachable set. As in [1], they con-
sidered u0 ∈ L∞ and three possible cases, namely pure initial value problem
with initial data control outside any domain, initial boundary value problem
in a quarter plane with one boundary control and initial boundary problem
in a strip with two boundary controls to get the reachable sets in a com-
plete generality. In both the articles the Lax-Oleinik type formulas has been
exploited. An alternative approach has been provided in [23] by using the
return method (see [17]). For the viscous Burgers equation any non-zero
state can be reached in ﬁnite time by two boundary controls [22]. A gen-
eral theory for the system of conservation laws is still largely unavailable,
nevertheless in [12], the authors constructed an example showing that exact
controllability to a constant cannot be reached in a ﬁnite time and proved
asymptotic stabilization to a constant by two boundary controls. Recently,
under dissipative boundary conditions the asymptotic stabilization to 0 has
been proved in [18] for 2 × 2 system, when the velocities are positive. For
the Temple class systems and triangular type systems we refer the reader to
[11] and [8] respectively.

Let us brieﬂy discuss the optimal controllability results for the case f =
loc, T > 0, we denote by J{f =g}, a cost

g. Assume the target function k ∈ L2
functional, deﬁned in the following way

J{f =g}(u0) =

|f ′(u(x, T )) − f ′(k(x))|2dx,

(5)

where u0 ∈ L∞(R), u0 ≡ θf outside a compact set, θf being the only
critical point of the ﬂux f . Here u(·, T ) denotes the unique weak solution
at t = T to the Cauchy problem (1), in the case f = g with initial datum
u0. Then in this case, the optimal control reads like : ﬁnd a w0 such that
J{f =g}(w0) = min
J{f =g}(u0). In [15, 16], they considered the above optimal
u0
control problem for the Burgers’ equation and proved such minimizer exists
and proposed a numerical scheme called ”alternating decent algorithm”,
although the convergence of these scheme still remains open. Whereas in [2],
they made use of the Lax-Oleinik formula and derived a numerical backward
construction which converges to a solution of the above problem. The latter

CONTROLLABILITY FOR DISCONTINUOUS FLUX

4

method can be applied also to general convex ﬂuxes as long as a Lax-Oleinik
type formula is available. It has to be noticed that even for the case f = g,
due to the occurrence of the shocks in the solution of (1), one may have
several minimizers of the optimal control problem (5).

We organize the paper in the following manner, section 2 deals with the
existing results collected from [4, 7]. Section 3 consists of some important
Lemmas and the backward construction. Then we state and prove the result
concerning optimal controllability in section 4. Finally in section 5, we state
and prove the exact controllability result.

2 Known facts about discontinuous ﬂuxes

In order to make the paper self contained we recall some results, deﬁnitions
and notations from [4].

DEFINITION 2.1. Control curve : Let 0 < t, x ∈ R and γ ∈ C([0, t], R).
Then γ is said to be a control curve if the following holds: it is piecewise
aﬃne on [0, t] with at most 3 segments, each segment must be completely
inside a closed quarter plane.
If they are exactly 3, then the middle one
is on the line x = 0 and the other two must be either in the positive
or negative quarter plane. Moreover, no segment can cross x = 0. Let
c(x, t) be the set of control curves, c0(x, t) is the subset of c(x, t) consists of
only one segment. cr(x, t) is the subset containing exactly 3 segments and
cb(x, t) = c(x, t) \ {c0(x, t) ∪ cr(x, t)}.

DEFINITION 2.2. Cost function: Let f ∗, g∗ be the convex duals of the
ﬂuxes. Let us assume that v0 : R → R be an uniformly Lipschitz continuous
function. Let (x, t) ∈ R × R+, γ ∈ c(x, t). The cost functional Γ associated
to v0 is deﬁned by

Γv0,γ(x, t) = v0(γ(0)) +

+meas{θ ∈ [0, t]

: γ(θ) = 0}min{f ∗(0), g∗(0)}.

{θ∈[0,t] : γ(θ)>0}

R

f ∗( ˙γ)dθ +

{θ∈[0,t] : γ(θ)<0}

R

g∗( ˙γ)dθ

Then we deﬁne the value function v : R×R+ → R by v(x, t) = inf

γ∈c(x,t)

{Γγ,v0(x, t)}.

DEFINITION 2.3. Let us deﬁne by ch(x, t) = {γ : Γv0,γ(x, t) = v(x, t)},
the set of characteristics curves. Let t > 0, deﬁne

R1(t) = inf{x ; x ≥ 0, ch(x, t) ⊂ c0(x, t)},

if the above set is empty.
L1(t) = sup{x ; x ≤ 0, ch(x, t) ⊂ c0(x, t)},

R2(t) = (cid:26) inf{x ; 0 ≤ x ≤ R1(t), ch(x, t) ∩ cr(x, t) 6= φ},
L2(t) = (cid:26) sup{x ; L1(t) ≤ x ≤ 0, ch(x, t) ∩ cr(x, t) 6= φ},

if the above set is empty.

R1(t)

L1(t)

CONTROLLABILITY FOR DISCONTINUOUS FLUX

5

For f = g case, a detailed study of the above curves has been done in

[1, 3].

THEOREM 2.1. (See [4]) Let u0 ∈ L∞(R) and v0(x) :=

u0(θ)dθ. Then

x

R0

1. Then the function v is uniformly Lipschitz continuous and u := ∂v
∂x

solves (1) in weak sense with initial data u0.

2. u satisﬁes Rankine-Hugoniot condition (4) and interface entropy con-

dition (3) near the interface.

3. R1(·), L1(·) are Lipschitz continuous functions and there exists a func-
tion y : {(−∞, L1(t)] ∪ [R1(t), ∞)} × (0, ∞) → R such that for all
t > 0, x 7→ y(·, t) is non decreasing function.

4. There exist non increasing function t+ : [0, R1(t)] → [0, t] and a non
decreasing function t− : [L1(t), 0] → [0, t] such the Explicit formula is
given by

f ′(u(x, t)) =(cid:16) x−y(x,t)
g′(u(x, t)) =(cid:16) x−y(x,t)

t

t

(cid:17) 1x≥R1(t) +(cid:16)
(cid:17) 1x≤L1(t) +(cid:16)

x

t−t+(x,t)(cid:17) 10≤x<R1(t).
t−t−(x,t)(cid:17) 1L1(t)<x<0.

x

(6)

(7)

5. Let V+ = {t : R1(t) > 0}, V− = {t : L1(t) < 0}. Then there exist non
increasing function y−,0 : V+ → (−∞, 0] and a non decreasing function
y+,0 : V− → [0, ∞) such that g′(u(0−, t)) = − y−,0(t)
, for t ∈ V+ \ D+,
f ′(u(0+, t)) = − y+,0(t)
, for t ∈ V− \ D− and f (u(0+, t)) = g(u(0−, t)),
for t ∈ (V+\D+)∪(V−\D−), where D± are the points of discontinuities
of y±,0.

t

t

6. For each T > 0, one of the following holds,

i). If R1(T ) > 0, L1(T ) = 0, then ∀ t ∈ (t+(R1(T )−, T ), T ), R1(t) >

0,
where t+(R1(T )−, T ) =

lim

x→R1(T )−

t+(x, T ), (see ﬁgure 2, case i).

ii). If R1(T ) = 0, L1(T ) < 0, then ∀ t ∈ (t−(L1(T )+, T ), T ), L1(t) <

0,
where t−(L1(T )+, T ) = lim

x→L1(T )+

t−(x, T ).

iii). R1(T ) = 0 = L1(T ), (see ﬁgure 2, case iii).

CONTROLLABILITY FOR DISCONTINUOUS FLUX

6

(x, T )
(x, T ) (R1(T ), T )

(R1(T ), T )

L1 curve

t+(x, T )

t = T

(z, T )

(z, t)

R1 curve

y0,−(t+(x, T ))

y(z, T )

L1 curve

x = 0
Case i

t = 0

x = 0
Case iii

t−(z, t)

y0,+(t−(z, t))

Figure 1: Case i : when R1(T ) > 0, L1(T ) = 0, Case iii : when R1(T ) =
0, L1(T ) = 0.

3 Key technical lemmas

Let us denote f+ = f |[θf ,∞), f− = f |(−∞,θf ], g+ = g |[θg,∞), g− = g |(−∞,θf ],
where θf , θg be the unique minimums of the ﬂuxes f, g respectively. Let
¯θf , ¯θg such that

(cid:26) f ′(¯θg) ≥ 0, f (¯θg) = g(θg)

g′(¯θf ) ≤ 0, f (θf ) = g(¯θf )

if g(θg) ≥ f (θf ),
if g(θg) ≤ f (θf ).

Let

I+ =(cid:26) [¯θg, ∞)

[θf , ∞)

if g(θg) ≥ f (θf ),
if g(θg) ≤ f (θf ).

Deﬁne h+ : I+ → [0, ∞) by h+(p) = g′ ◦ g−1
is well deﬁned and strictly increasing function. Let

+ ◦ f ◦ f ′−1(p). Then clearly h+

I− =(cid:26) [θg, ∞)

[¯θf , ∞)

if g(θg) ≥ f (θf )
if g(θg) ≤ f (θf ).

Similarly we deﬁne a strictly decreasing function h− : I− → (−∞, 0] by
h−(p) = f ′ ◦ f −1

− ◦ g ◦ g′−1(p).

3.1 No rarefaction waves on the interface

The following Lemma plays a key role in our result since excludes that
forward rarefaction waves emanates from the interface.

LEMMA 3.1. x 7→ t+(x, t) is a strictly decreasing function in (0, R1(t))
and x 7→ t−(x, t) is a strictly increasing function in (L1(t), 0).

CONTROLLABILITY FOR DISCONTINUOUS FLUX

7

Proof. Without loss of generality we assume that for some T > 0, R1(T ) > 0
and L1(T ) = 0. Deﬁne XT : [t+(R1(T )−, T ), T ] → [0, R1(T )] by XT (t) =
Max{x :
t+(x, T ) ≥ t}. Since x 7→ t+(x, T ) is a non increasing function,
hence t 7→ XT (t) is a non increasing function. Since the limits of characteris-
tics curves are characteristics curves, hence there exists a γ ∈ (cr(XT (t), T )∪
cb(XT (t), T )) ∩ ch(XT (t), T ) such that γ = (γ1, γ2, γ3), where the ﬁrst com-
ponent of γ is given by γ1(θ) = XT (t) + (θ − T )
for θ ∈
[t+(XT (t)−, T ), T ]. Let D1 = set of discontinuities of the mapping t 7→
XT (t). Then D1 is countable and as in Step 1, Lemma 4.10 of [4], it can
be shown that for all t /∈ D1. The R-H condition holds, i.e,. f (u(0+, t)) =
g(u(0−, t)) for all t /∈ D1. Now we state the following claim which will
conclude the Lemma.
Claim 1: t 7→ XT (t) is a continuous function.

T −t+(XT (t)−,t) ,

XT (t)

Suppose not, then there exists t0 ∈ [0, T ] such that

x0 = XT (t0+) < XT (t0−) = x1.

(8)

Due to the fact that characteristics do not intersect properly, we have for
all x ∈ (x0, x1), t+(x, T ) = t0. Observe that the straight line α(t) :=

(t − t0)(cid:16) x1

T −t0(cid:17) is a characteristic curve. Since characteristics do not in-

tersect properly, we conclude R1(t) > 0, for all t ∈ (t0, T ], hence by entropy
condition (3), we have L1(t) = 0 for all t ∈ (t0, T ].
Claim 2: There exists ǫ > 0 such that for all t ∈ [t0 − ǫ, t0], R1(t) > 0.
If not, then there exists a sequence {tk}∞
k=1 with tk+1 > tk such that R1(tk) =
tk = t0. Since R1(tk) = 0, therefore there exists a sequence
0 and lim
k→∞
{yk}∞
) is a characteristic curve.
The function t 7→ y+,0(t) is non decreasing hence we conclude yk+1 ≥ yk, for
all k. Then {yk}∞
k=1 is a non decreasing sequence and bounded below by 0,
therefore converges to some y0 ≥ 0 (say). By the deﬁnition of characteristics
curve we conclude

k=1 with yk ≥ 0 such that βk(t) := (t−tk)(− yk
tk

v(0, tk) = v0(yk) + tkf ∗(cid:18)−

yk

tk(cid:19) .

(9)

Since v is uniformly Lipschitz and yk, tk converges to y0, t0 respectively, we

Which proves that the straight line β(t) := (t − t0)(− y0
t0

t0(cid:17) .
pass to the limit in the equation (9) to obtain v(0, t0) = v0(y0)+t0f ∗(cid:16)− y0
(cid:17). By using the
curve. Deﬁne the straight line γ(t) := x1 + (t − T )(cid:16) α(T )−β(0)

fact that α, β are characteristics curves and f ∗ is a strict convex function,
we obtain

), is a characteristic

T

v(α(T ), T ) ≤ v0(γ(0)) + T f ∗(cid:16) α(T )−β(0)

T

< v0(β(0)) + t0f ∗( ˙β) + (T − t0)f ∗ ( ˙α) = v(0, t0) + (T − t0)f ∗ ( ˙α)
= v(α(T ), T ),

(cid:17) = v0(β(0)) + T f ∗(cid:16) α(T )−β(0)

T

(cid:17)

CONTROLLABILITY FOR DISCONTINUOUS FLUX

8

L1 curve

(x0,k, T )(x0, T )

(x1, T )

t = T

R1 curve

t = t0

(x1,k, t0)

x = 0

t = 0

Figure 2: An illustration of the Lemma 3.1

which is a contradiction. Hence the claim 2. Therefore by entropy condition
(3) and claim 2, we obtain

for all t ∈ [t0 − ǫ, T ], L1(t) = 0 and R1(t) > 0.

(10)

k=1, {tk}∞

Due to R-H condition, (8) and (10), we can consider the sequences {x0,k}∞
k=1,
{x1,k}∞
tk =
¯tk = t0 such that for all k ∈ N, x0,k+1 ≥ x0,k, x1,k+1 < x1,k, tk+1 ≤
t0, lim
k→∞
tk, ¯tk+1 > ¯tk, f (u(0+, tk)) = g(u(0−, tk)), f (u(0+, ¯tk)) = g(u(0−, ¯tk)),

k=1 with lim
k→∞

k=1, {¯tk}∞

x0,k = x0,

lim
k→∞

lim
k→∞

x1,k = 0,

curves. Note that the slopes characteristics curves ηk and ¯ηk converges

T −tk(cid:17) and ¯ηk(t) := (t − ¯tk)(cid:16) x1,k

ηk(t) := (t − tk)(cid:16) x0,k
to the slopes characteristics curves η(t) := (t − t0)(cid:16) x0
(t − t0)(cid:16) x1

T −t0(cid:17) respectively, which proves

t0−¯tk(cid:17) are characteristics
T −t0(cid:17) and ¯η(t) :=

lim
k→∞

u(0+, tk) = u(0+, t0+)(say) and lim
k→∞

u(0+, ¯tk) = u(0+, t0−)(say).

(11)

On the other hand, η(t) and ¯η(t) are characteristics curves, hence u(0+, t0+) =
(f ′)−1( x0
T −t0

) and u(0+, t0−) = (f ′)−1( x1
T −t0

). Since x0 < x1, clearly

u(0+, t0+) < u(0+, t0−).

(12)

Therefore from (11) and (12), there exists a δ1 > 0 and m ∈ N such that for
all k > m,

u(0+, ¯tk) − u(0+, tk) > δ1.

(13)

Again by R-H condition (4) and (13), there exists a δ2 > 0 such that for all
k > m,

g′(u(0+, ¯tk)) − g′(u(0+, tk)) > δ2.

(14)

CONTROLLABILITY FOR DISCONTINUOUS FLUX

9

Due to the fact that L1(t) = 0 in the neighborhood of t0, by using explicit for-
k=1 such that g′(u(0−, tk)) = − yk
mulas there exists sequences {yk}∞
tk
and g′(u(0−, ¯tk)) = − ¯yk
. The function t 7→ y−,0(t) is non increasing
¯tk
hence we conclude yk+1 ≥ yk, ¯yk+1 ≤ ¯yk,for all k. Since the sequences
{yk}∞
k=1 are monotonic, bounded and due to the fact that charac-
teristics do not intersect properly, we conclude

k=1, {¯yk}∞

k=1, {¯yk}∞

lim
k→∞

yk = y0(say) ≤ lim
k→∞

¯yk = ¯y0(say).

Exploiting the explicit formula we obtain

g′(u(0+, ¯tk)) − g′(u(0+, tk)) =

−¯yktk + yk¯tk

¯tktk

.

(15)

(16)

As lim
k→∞

tk = t0, lim
k→∞

¯tk = t0 and (15), the right hand side of (16) converges
to some non positive number but due to (14) the left hand side of (16) remain
strictly positive, which is a contradiction. This proves claim 1. Therefore
x 7→ t+(x, t) is strictly decreasing function in (0, R1(t)). Similarly one can
prove that x 7→ t−(x, t) is a strictly increasing function in (L1(t), 0). Hence
the Lemma.

REMARK 3.1. There are no rarefaction start from the interface at any
positive time.

3.2 Explicit formulas connecting the interface

The following two lemmas explains how the solution of (1) at time t = T
connected to t = 0 via characteristics through the interface.

LEMMA 3.2. Let T > 0 and denote t±(x, T ) = t±(x). Then

1. For a.e. x ∈ [0, R1(T )), we have −

2. For a.e. x ∈ (L1(T ), 0], we have −

y−,0(t+(x))

t+(x)

y+,0(t−(x))

t−(x)

= h+(cid:18)
= h−(cid:18)

x

T − t+(x)(cid:19) .
T − t−(x)(cid:19) .

x

Proof. It is enough to prove (1), (2) follows in the same direction. Let
R1(T ) > 0. Then from (6) of Theorem 2.1, R(t) > 0 for t ∈ (t+(R(T ))−, T )
and hence from (5) of Theorem 2.1, y−,0 is well deﬁned on (t+(R(T )), T ).
Again from (2) of Theorem 2.1, t+ is a strictly decreasing function, hence
the set

E+ = {t−1

+ (D+)} ∪ {points of discontinuities of t+}

is a countable set. Now from (5) of Theorem 2.1, if x /∈ E+, then t+(x) /∈ D+
and hence

f (u(0+, t+(x))) = g(u(0−, t+(x))), g′(u(0−, t+(x))) = −

y−,0(t+(x))

t+(x)

. (17)

CONTROLLABILITY FOR DISCONTINUOUS FLUX

10

From (4) and (5) of Theorem 2.1, we have f ′(u(x, T )) =
x ∈ [0, R1(T )]. This implies at the point of continuity of t+, we have

T −t+(x) for a.e.

x

f ′(u(x, T )) = f ′(u(0+, t+(x))).

(18)

Therefore from (17)-(18), for x /∈ E+, we conclude the proof of (1).

LEMMA 3.3. Let ρ : [α, β] ⊂ (0, ∞) → (−∞, 0) be a non decreasing
function.

1. Let t : [α, β] → [0, T ] be a function such that

−

ρ(x)
t(x)

= h+(cid:18)

x

T − t(x)(cid:19) a.e. x ∈ [α, β].

Then x 7→ t(x) is a strictly decreasing function.

2. For i = 1, 2, let ti : [α, β] → [0, T ] be two functions such that

−

ρ(x)
ti(x)

= h+(cid:18)

x

T − ti(x)(cid:19) a.e. x ∈ [α, β].

Then t1(x) = t2(x), a.e. x ∈ [α, β].

(19)

(20)

Proof. Let 0 < x1 < x2 and (19) holds at x1 and x2. Suppose t(x1) ≤ t(x2).
Then

x1

T −t(x2) . Hence

T −t(x1) ≤ x1
−ρ(x1) = t(x1)h(cid:18)

T −t(x2) < x2
T − t(x1)(cid:19) < t(x2)h(cid:18)

x1

x2

T − t(x2)(cid:19) = −ρ(x2) ≤ −ρ(x1),

which is a contradiction. This proves (1). Proof of (2) is immediate.

3.3 Backward wave analysis

The following lemmas proves the existence of possible functions t+, u0, given
ρ.

LEMMA 3.4. Let x0 > 0, T > t1 > t2 > 0. Deﬁne ρ1, ρ2 ∈ R such that

−

ρi
ti

= h+(cid:18) x0

T − ti(cid:19) .

(21)

Suppose ρ1 < ρ2 < 0, then there exists a solution u ∈ L∞(R × [0, T ]) for (1).

= f ′(ai), for i = 1, 2. Then by
Proof. Let us denote a1, a2, such that
strict convexity of f , one obtains a1 > a2. Let us denote b1, b2, such that
bi = g−1
(t − T ),
this line hits the x = 0 at time t = T − x0s2(t − T ) = t3 (say), where
s2 = f (a1)−f (a2)
. Again by strict convexity t1 > t3 > t2. Let us deﬁne the

+ f+(a1), for i = 1, 2. Consider the line x − x0 = f (a1)−f (a2)

a1−a2

T −ti

x0

a1−a2

CONTROLLABILITY FOR DISCONTINUOUS FLUX

11

(x0, T )

t = T

a1

b1

a2

b2

(ρ1, 0)

(ρ3, 0)

(ρ2, 0)

t = 0

Figure 3: The dotted line is the shock originating from the point (ρ3, 0) until
the point (x0, T ).

initial data u0, by u0(x) = b11x<ρ3 + b21x>ρ3. Due to the construction of
a1, a2, b1, b2, s1, s2, t3, ρ3, the solution in the region x ∈ R, T > t ≥ 0, to the
above initial data is given by (see ﬁgure 3.3)

u(x, t) =


This proves the lemma.

b1
b2
a1
a2

if
if
if
if

x − ρ3 < s1t, x < 0,
x − ρ3 > s1t, x < 0,
x < s2(t − t3), x > 0,
x > s2(t − t3), x > 0.

(22)

LEMMA 3.5. Let R > 0. Let us assume that ρ : [0, R] → (−∞, 0) and
y : R \ [0, R] → R be two non decreasing functions satisﬁes

xy(x) ≥ 0 if x ∈ R \ [R, 0] and ρ(0) ≥ y(x) if x ≤ 0.

(23)

Then there exists a solution u ∈ L∞(R×[0, ∞)) of (1) and an unique strictly
decreasing function t : [0, R) → [0, T ) such that

−

ρ(x)
t(x)

x

= h+(cid:18)
u(x, T ) = (f ′)−1(cid:18)

T − t(x)(cid:19) a.e. x ∈ [0, R),
T − t(x)(cid:19) a.e. x ∈ [0, R).

x

(24)

(25)

Proof. In order to prove the Lemma, we split into several steps. In step 1,
we construct a solution when ρ is constant. By using step 1, we allow ρ to
be two constants state in step 2. In step 3, we consider ρ to be an increasing
step function in [0, R). Finally in Step 4, we pass to limit and obtain the
result.

CONTROLLABILITY FOR DISCONTINUOUS FLUX

12

Step 1: Let 0 ≤ x1 < x2, T > 0 and ρ : [x1, x2] → (−∞, 0) be a constant
function, then there exists a strictly decreasing function t : [0, x2] → [0, T ]
and a solution u ∈ L∞(R × [0, ∞)) of (1) satisﬁes (24), (25) for a.e. x ∈
[x1, x2).
Proof of Step 1. Let ρ(x) = ρ0 ∈ (−∞, 0), ∀ x ∈ [x1, x2]. Let us consider
the initial data u0 deﬁned in R− by u0(x) = b11x<ρ0 + b21x>ρ0, where b1, b2
are going to be specify later with the properties, 0 < g′(b1) < g′(b2) and
T > − ρ0
g′(b2) = t2 (say). Then, for x < 0, 0 ≤ t < T ,
the solution u(x, t) of (1) for the above initial data is given by

g′(b1) = t1 (say), T > − ρ0

u(x, t) = 


b1

(g′)−1(cid:0) x−ρ0
t (cid:1)

b2

if x < g′(b1)t + ρ0,
if g′(b1)t + ρ0 < x < g′(b2)t + ρ0,
if x > g′(b2)t + ρ0,

(26)

By R-H condition (4), we deﬁne a1 = f −1
R-H condition and (26), for t ∈ [0, T ], we conclude

+ g(b1), a2 = f −1

+ g(b2) and again by

u(0+, t) = a11T ≥t>t1 + f −1

+ g(g′)−1(cid:0) −ρ0

t (cid:1) 1t2<t<t1 + a210≤t<t2 ,

(27)

hence for x > 0, 0 < t ≤ T , the solution is given by

u(x, t) = 


a1
f −1
+ g(g′)−1u(0+, t+(x))
a2

if x < f ′(a1)(t − t1),
if f ′(a1)(t − t1) < x < f ′(a2)(t − t2),
(28)
if x > f ′(a2)(t − t2),

where t+ : [f ′(a1)(T − t1), f ′(a2)(T − t2)] → [t1, t2] is a homeomorphism,

(x1, T )

(x2, T )

t = T

a1

b1

a2

b2

(ρ0, 0)

t = 0

Figure 4: A rarefaction originating from the point (ρ0, 0).

the existence of such homeomorphism is quite obvious. Note that the lines
x = f ′(a1)(t − t1), x = f ′(a2)(t − t2), hits t = T at x = f ′(a1)(T − t1) and

CONTROLLABILITY FOR DISCONTINUOUS FLUX

13

x = f ′(a1)(T − t2) respectively. Now we are interested to solve the following
equation for (a1, a2) and (b1, b2), i.e, given x1, x2, ρ0, ﬁnd pairs (a1, a2) and
(b1, b2) such that

x1 = f ′(a1)(T + ρ0

g′(b1) ), x2 = f ′(a2)(T + ρ0

g′(b2) ).

(29)

In order to solve the above equation (29), we need to consider following 2
cases.
Case 1: If f (θf ) ≤ g(θg): We consider the function S1 : [θg, ∞] → R deﬁned
by S1(x) = f ′g−1
S1(θg) = −∞, S1(∞) = ∞. Therefore by using Intermediate Value Theorem
we conclude the existence of pairs (a1, a2), (b1, b2) satisfying (29).
Case 2: If f (θf ) > g(θg): The argument is similar to case 1.

g′(x)(cid:17). Then S1 is a continuous function with

+ f (x)(cid:16)T + ρ0

Now we deﬁne a strictly decreasing function t : [0, x2] → [0, T ], by

f ′(a1)

T − x
t+(x)
T − x

f ′(a2)

if 0 ≤ x < f ′(a1)(t − t1),
if f ′(a1)(t − t1) < x < f ′(a2)(t − t2),
if x2 > x > f ′(a2)(t − t2).

(30)

t(x) =


From (26), (27), (28) and (30), it is easy to check (24), (25) for a.e. x ∈
[x1, x2]. Which proves Step 1.
Step 2: Let 0 ≤ x1 < x2 < x3, T > 0 and ρ : [x1, x3] → (−∞, 0) be such
that ρ(x) = ρ11[x1,x2] + ρ21[x2,x3] where ρ1, ρ2 are two constants such that
ρ1 < ρ2 < 0. Then there exists a strictly decreasing function t : [0, x3] →
[0, T ] and a solution u ∈ L∞(R × [0, ∞)) of (1) satisﬁes (24), (25) for
a.e. x ∈ [0, x3).
Proof of Step 2. Consider the function ρ in [x1, x2], then by Step 1, there
exists pairs (a1, a2) (say), (t1, t2) (say) and (b1, b2) (say) as in (29). Similarly
considering the function ρ in [x2, x3] and using Step 1, there exists other pairs
(a3, a4), (t3, t4) (say) and (b3, b4) as in (29). Then by construction t2 > t3
and it satisﬁes

−

ρ1
t2

= h+(cid:18) x2

T − t2(cid:19) , −

ρ2
t3

= h+(cid:18) x2

T − t3(cid:19) .

Now by Lemma 3.4 and Step 1, there exists S ∈ (ρ1, ρ2) which allow us
to construct the following initial data deﬁned in R− by u0(x) = b11x<ρ1 +
b21ρ1<x<S +b31S<x<ρ2 +b41x>ρ2. Then the corresponding solution in the
region {x < 0, 0 ≤ t ≤ T } is given by (see ﬁgure 3.3)

u(x, t) =




b1

b2
b3

(g′)−1(cid:0) x−ρ1
t (cid:1)
(g′)−1(cid:0) x−ρ2
t (cid:1)

b4

if x < g′(b1)t + ρ1,
if g′(b1)t + ρ1 < x < g′(b2)t + ρ1,
if g′(b2)t + ρ1 < x < g(b2)−g(b3)
if
if g′(b3)t + ρ2 < x < g′(b4)t + ρ2,
if g′(b4)t + ρ2 < x.

t + S,
t + S < x < g′(b3)t + ρ2,

g(b2)−g(b3)

b2−b3

b2−b3

(31)

CONTROLLABILITY FOR DISCONTINUOUS FLUX

14

(x1, T )

(x2, T )

(x3, T )

t = T

a1

a2

b1

b2 b3

b4

a4

a3

(ρ1, 0)

(S, 0)

(ρ2, 0)

(0, 0)

t = 0

Figure 5: An illustration Step 2.

By R-H condition (4), we deﬁne ai = f −1
+ g(bi), for i = 1, · · · , 4. Again by
R-H condition and (31), the solution in the region {x > 0, 0 < t ≤ T }, is
given by

a1
f −1
+ g(g′)−1u(0+, t+(x))
a2

a3
f −1
+ g(g′)−1u(0+, t+(x))
a4

if x < f ′(a1)(t − t1),
if f ′(a1)(t − t1) < x < f ′(a2)(t − t2),

if f ′(a2)(t − t2) < x < ˜S1(cid:16)t + S
˜S2(cid:17) ,
˜S2(cid:17) < x < f ′(a3)(t − t3),
˜S1(cid:16)t + S

if
if f ′(a3)(t − t3) < x < f ′(a4)(t − t4),
if f ′(a4)(t − t4) > x,

(32)

u(x, t) =




and t+ : [f ′(a1)(T −t1), f ′(a2)(T −
t2)] ∪ f ′(a3)(T − t3), f ′(a4)(T − t4)] → [t1, t2] ∪ [t3, t4] is a homeomor-
phism. Then we deﬁne a strictly decreasing function t : [0, x3] → [0, T ]

(cid:17), ˜S2 = g(b2)−g(b3)

b2−b3

a2−a3

where ˜S1 =(cid:16) f (a2)−f (a3)
by t(x) = (cid:16)T − x

f ′(a1)(cid:17) 1[0,f ′(a1)(t−t1)] + t+(x)1[0,x3]\[0,f ′(a1)(t−t1)]. Therefore

from deﬁnition of t, (31) and (32), it is easy to check (24), (25) for a.e.
x ∈ [0, x3]. Which proves Step 2.
Step 3: Discretization of both the functions ρ, y by piecewise constant and
develop a solution with a piecewise constant initial data such that (24), (25)
holds for each discretized function ρN .

In the present step our aim to create a piecewise constant initial data in
the region [y(0), y(R)]. Initial data ¯uN
0 (say) in the region R\[y(0), y(R)] can
be construct in the same way as in Lemma 3.6 of [2]. In order to do that we
ﬁrst discretized ρ to piecewise constants. Let N ∈ N. Let ρ(0) = z1 < z2 <
· · · < zN = ρ(R) be such that |zi − zi+1| < 1
N for i = 1, · · · , N − 1. We deﬁne
ρ−1[z1, zi+1] = [x0, xi], then 0 = x0 ≤ x1 · · · ≤ xN = R. Let us deﬁne a new

CONTROLLABILITY FOR DISCONTINUOUS FLUX

15

function ρN : [0, R] → (−∞, 0) by ρN (x) = z11[x0,x1] +
deﬁnition of ρN , we have |ρN −ρ(x)| < 1
N , for x ∈ (0, R). For i = 1, · · · , N −
1, we consider ρN in each interval [xi, xi+1] and apply step 1 and step 2, then
for each [xi, xi+1] there exist pairs (b2i+1, b2i+2), (a2i+1, a2i+2), (t2i+1, t2i+2)
and Si ∈ (zi, zi+1). Also the following equation satisﬁes for i = 1, · · · , N − 1,

zi1(xi,xi+1](x). By

Pi=2

N −1

−

ρi
t2i

= h+(cid:16) xi

T −t2i(cid:17) , − ρi+1

t2i+1

= h+(cid:18)

xi

T − t2i+1(cid:19) .

Hence we obtain the following piecewise constant initial data in the region

t = T

(xi, T )(xi+1, T )

(R, T )

t = 0

(ρi, 0)

x = 0

(yk, 0)

Figure 6: An illustration of Step 3.

[z1, zN ], combining ¯u0 ∈ R \ [y(0), y(R)] we obtain the following initial data
uN
0 (say), given by (see ﬁgure 3.3)

¯uN
0 (y(0)−)
b1
b2i
b2i+1
b2N
¯uN
0 (y(R)+)
¯uN
0

if x ∈ [y(0), ¯SN ],
if x ∈ [S0, z1],
if x ∈ [zi, Si], for i = 1, · · · , N − 1,
if x ∈ [Si, zi+1], for i = 1, · · · , N − 1,
if x ∈ [zN , 0], for i = 1, · · · , N − 1,
if x ∈ [0, y(R)],
if x ∈ R \ [y(0), y(R)],

(33)

uN
0 (x) =




where − ¯SN =

g(¯uN
0 (y(0)−)) − g(b1)
¯uN
0 (y(0)−) − b1

. Now similarly as in Step 1, Step 2

there is a homeomorphism denoting by tN : ∪N −1
i=1 [f ′(ai)(T − ti), f ′(a2)(T −
t2)] → ∪N −1
i=1 [ti, ti+1]. Which is a strictly decreasing function from [0, R] →
[0, T ] and by using the explicit formula it is easy to check (24), (25) for a.e.
x ∈ [0, R]. Let us denote the corresponding solution uN of the initial data
uN
0 , then it is to be noticed that the construction has been done such a way
that the shocks are discrete in the region [0, T ] × R.

CONTROLLABILITY FOR DISCONTINUOUS FLUX

16

in this step we prove up to a subsequence
Step 4: Passage to the limit:
loc and the corresponding solution uN also
0 converges to some u0 in L1
uN
converges to the solution u up to a subsequence and ﬁnally (24), (25) holds.
By deﬁnition, ρN → ρ(x) point-wise and by Helly’s theorem there exists
a subsequence (after relabeling) such that tN (x) → t(x) (say) a.e.. Hence
the relation (24) holds for ρ(·), t(·), for a.e. x ∈ [0, R]. Let us ﬁx C1 ∈ (0, R).
Since from Lemma 3.3, t(·) is strictly decreasing in [0, R], hence there exists
T −t(x) <
a constant C2 > 0, such that for x ∈ (0, C1), t+(x) > C2 > 0 and
T −t(C1) for x ∈ (C1, R). Therefore, there exists constant C3 > 0 such that

R

x

if x ∈ (0, R),

if x ∈ (C1, R).

(34)

(35)

Whence (34), (35) and Step 3 allow us to assume that up to a subsequence
(after relabeling)

≤ C4

if x ∈ [0, R],

(36)

x

ρ(x)

≤ C3

≤ ρ(0)
C2

h+(cid:18)

(cid:12)(cid:12)(cid:12)(cid:12)
t(x)(cid:12)(cid:12)(cid:12)(cid:12)
(cid:12)(cid:12)(cid:12)(cid:12)
T − t(x)(cid:19)(cid:12)(cid:12)(cid:12)(cid:12)
=(cid:12)(cid:12)(cid:12)
tN (x)(cid:12)(cid:12)(cid:12)
T −tN (x)(cid:17)(cid:12)(cid:12)(cid:12)
h+(cid:16)
0 ||∞, ||uN ||∞,(cid:13)(cid:13)(cid:13)
Maxn||uN

ρ(x)

x

(cid:12)(cid:12)(cid:12)

for some constant C4 > 0. By using the explicit formula and (36), there exist
a constant C5, such that

dξ

dt(cid:13)(cid:13)(cid:13)∞o ≤ C5,

(37)

where ξ be any characteristic associated to initial data uN
0 . Let us con-
sider any partition {pi}K
i=1 for the interval (ρ(0), ρ(R)). Then by explicit
formula and by our construction in Step 3, there exists corresponding par-
tition {ti}K
over due to the fact that ρ(R) < 0 and (37),

i=1 in the interval (0, T ) such that g′(uN

0 (pi)) = −

yN
−,0(ti+1)

, more-

ti+1

1
ti

≤ C6,

(38)

for some constant C6 > 0. Now by using explicit formula and using (38)
there exist a constant C7 > 0 such that

T V (g′(uN

0 ) : (ρ(0), ρ(R))) = sup
K

yN
−,0(ti+1)

ti+1

−

yN
−,0(ti)

ti

(cid:12)(cid:12)(cid:12)(cid:12)

K

Pi=1(cid:12)(cid:12)(cid:12)(cid:12)

(C6)2

K

K

Pi=1
Pi=1

≤ sup
K

+ sup
K
≤ sup
K

|ti+1 − ti||yN

−,0(ti+1)|

(39)

|ti||yN

(C6)2
−,0(ti)|
(C6)2{|ρ(0)|T + T |ρ(0) − ρ(R)|}

−,0(ti+1) − yN

= T (C6)2{|ρ(0)| + |ρ(0) − ρ(R)|}.

CONTROLLABILITY FOR DISCONTINUOUS FLUX

17

Similarly as in (39) one can prove BVloc(g′(uN
0 (0−, t)) : (0, T )) ≤ C7, for
all N ∈ N. Thanks to Helly’s Theorem, there exists subsequence (after
relabeling) such that {g′(uN
0 )} converges point-wise to some function Q
(say) in (ρ(0), ρ(R)) . Then deﬁne ˜u0(x) = (g′)−1Q(x), therefore uN
0 →
0 → ¯u0 (say) in L1(R \
˜u0 in L1(ρ(0), ρ(R)).
[y(0), y(R)]). Again by Helly’s Theorem, there exists subsequence (after
relabeling) uN
0 (0+, t) →
u(0+, t) (say) for a.e. t ∈ [0, T ]. Now we consider the following two bound-
ary value problems

0 (0−, t) → u(0−, t) (say) a.e. t ∈ [0, T ] and so uN

It can be shown that ¯uN

W N

t + f (W N )x = 0,

if x > 0, t ∈ [0, T ]

W N (t, 0) = uN (0+, t),
W N (x, 0) = uN

0 (x) |(0,∞),

if t ∈ [0, T ]

if x > 0.

V N
t + g(V N )x = 0,

if x < 0, t ∈ [0, T ]

V N (t, 0) = uN (0−, t),
V N (x, 0) = uN

0 (x) |(−∞,0),

if t ∈ [0, T ]

if x < 0.

(40)

(41)






Then one can follow a similar strategy as in ’proof of Lemma 2.1 and 2.2’
of [1] to conclude that W N → W , V N → V in L1
loc and the limits W, V is
the entropy solutions to the above boundary value problems with boundary
data u(0+, t), u(0−, t) and the initial data u0 |(0,∞), u0 |(−∞,0) respectively.
Then deﬁne a new function Z N : R × [0, T ] → R by Z N = V N 1R−×[0,T ] +
W N 1R+×[0,T ]. Therefore Z N → Z in L1
loc, for some Z. It is easy to check
that Z N is a weak solution of (1). Due to the construction, Z N satisﬁes
R-H condition, interface entropy condition and (24) for each N and hence

x

for a.e. x ∈ (0, R) and passing to the limit up to a subsequence Z(x, T ) :=

these properties holds in the limit Z. Again W N (x, T ) = (f ′)−1(cid:16)
W (x, T ) = (f ′)−1(cid:16) x

T −tN (x)(cid:17)
T −t(x)(cid:17) a.e. x ∈ (0, R). This completes the proof of the

Lemma.

The following Lemma holds in the same spirit as Lemma 3.5.

LEMMA 3.6. Let R < 0. Let us assume that ρ : [R, 0] → (0, ∞) and
y : R \ [R, 0] → R be two non decreasing functions satisﬁes

xy(x) ≥ 0 if x ∈ R \ [R, 0] and y(x) ≥ ρ(0) if x ≥ 0.

(42)

Then there exists a solution u ∈ L∞(R × [0, ∞)) of (1) and an unique
strictly increasing function t : [R, 0] → [0, T ] such that for a.e. x ∈ [R, 0],
we have

−

ρ(x)
t(x)

= h−(cid:18)

x

T − t(x)(cid:19) , u(x, T ) = (g′)−1(cid:18)

x

T − t(x)(cid:19) .

CONTROLLABILITY FOR DISCONTINUOUS FLUX

18

4 Optimal control for discontinuous ﬂux

Class of target function: Let 0 < C. Let k be a measurable function on R.
Deﬁne a new function η : R → R by η[k](x) = g′(k(x))1x≤0 + f ′(k(x))1x>0.
Then Supp η[k](x) ⊂ [−C, C] if and only if k(x) = θg for x < −C and
k(x) = θf for x > C.
Admissible class of initial data: Let us deﬁne a new function ¯θ : R → R
by ¯θ(x) = H(x)θf + (1 − H(x))θg. Then Admissible class of initial data A,
is deﬁned by

A = {u0(x) = z(x) + ¯θ(x) : z ∈ L∞(R) with compact support}.

(43)

Cost functional: Fix a T > 0 and for u0 ∈ A, let u be the corresponding
solution to (1) associated to the initial data u0. We deﬁne the cost functional
J by

J(u0) =

+

L1(T )

R1(T )

R−∞
R0

|g′(u(x, T )) − η[k](x)|2dx +

|g′g−1

+ f (u(x, T )) − η[k](x)|2dx +

0

RL1(T )

|f ′f −1

− g(u(x, T )) − η[k](x)|2dx

|f ′(u(x, T )) − η[k](x)|2dx.

(44)

∞

RR1(T )

Optimal control problem: Then the question is to ﬁnd the optimal con-
trol u0 ∈ A so that, one has

J(u0) = min
wo∈A

J(w0).

(45)

THEOREM 4.1. There exists a minimizer for (45).

Let us deﬁne the following admissible class of initial data. Let T >
0. In order to mention simple notations we denote R(t), L(t) instead of
R1(t), L1(t).

We consider the following two admissible class of initial data

A1 = {u0 ∈ A : L(T, u0) = 0} and A2 = {u0 ∈ A : R(T, u0) = 0}.

From (6) of Theorem 2.1, A = A1∪A2. R(T, u0), L(T, u0), denotes the R1, L1
curves as in Theorem 2.1 with respect to the initial data u0.

In view of (6) of Theorem 2.1, we conclude

min
uo∈A

J(u0) = min{ min
uo∈A1

J(u0), min
uo∈A2

J(u0)}.

(46)

Hence ﬁnding a minimum in (45) is equivalent to ﬁnd minimum of the func-
tional J over the sets A1, A2.

LEMMA 4.1. For u0 ∈ A, J(u0) is well deﬁned.

CONTROLLABILITY FOR DISCONTINUOUS FLUX

19

Proof. Because of ﬁnite speed of propagation, it is immediate.

Existence of minimizer over the set A1: Let us deﬁne a new admissible
set

˜A1 =(cid:8)(R(T ), ρ, y) :

i). ρ : [0, R(T )] → (−∞, 0] be a non increasing function,
ii). y : R \ [0, R(T )] → R be a non decreasing function,

From Lemma 3.5, for (R(T ), ρ, y), there exists a unique non increasing

function t such that

−

ρ(x)
t(x)

iii). xy(x) ≥ 0, and y(x) ≤ ρ(0) for all x ≤ 0(cid:9).
= h+(cid:18)

T − t(x)(cid:19) , a.e. x ∈ (0, R(T )).

x

Let us deﬁne a new cost functional ˜J associated with the admissible set ˜A1
by

˜J (R(T ), ρ, y) =

0

R−∞

| x−y(x)

T − η[k](x)|2dx +

+

Then from (44), we have

| − ρ(x)

t(x) − η[k](x)|2dx

| x−y(x)

T − η[k](x)|2dx.

(47)

R(T )

∞

R0
RR(T )

inf

(R(T ),ρ,y)∈ ˜A1

˜J(R(T ), ρ, y) ≤ inf
u0∈A1

J(u0).

(48)

Estimations: Let Supp η[k] ⊂ [−C, C]. (0, 0, x) ∈ ˜A1 and ˜J(0, 0, x) =
kη[k]k2

L2 . Hence

inf

(R(T ),ρ,y)∈ ˜A1

˜J(R(T ), ρ, y) ≤ kη[k]k2

L2 .

Let (R(T ), ρ, y) ∈ ˜A1 be such that ˜J (R(T ), ρ, y) ≤ 2kη[k]k2
R(T ) > C, then

L2 . Suppose

2

dx.

T −t(x)(cid:17)(cid:12)(cid:12)(cid:12)
h+(cid:16) x

T , we obtain 2kη[k]k2

L2 ≥

R(t)

2

R(t)

ρ(x)

dx =

2kη[k]k2

RC (cid:12)(cid:12)(cid:12)

L2 ≥ ˜J(R(T ), ρ, y) ≥

RC (cid:12)(cid:12)(cid:12)
t(x)(cid:12)(cid:12)(cid:12)
T −t(x)(cid:17) ≥ x
Since h+ is an increasing function and(cid:16) x
RC (cid:12)(cid:12)h+(cid:0) x
T(cid:1)(cid:12)(cid:12)

R(t)

2 dx → ∞ as R(T ) → ∞. Hence there exists R0 ≥ C such that

R(T ) ≤ R0. Now for x ≤ 0, y(x) ≤ ρ(0), which implies x − y(x) ≥ x − ρ(0) >
0. Hence

2kη[k]k2

L2 ≥

0

Rρ(0)(cid:12)(cid:12)(cid:12)

x−y(x)

T − η[k](x)(cid:12)(cid:12)(cid:12)

2

dx ≥ 1
2

≥ 1
2

2

dx − kη[k]k2
L2

dx − kη[k]k2
L2

0

0

Rρ(0)(cid:12)(cid:12)(cid:12)
Rρ(0)(cid:12)(cid:12)(cid:12)

x−y(x)

T

x−ρ(0)

T

2

(cid:12)(cid:12)(cid:12)
(cid:12)(cid:12)(cid:12)

= 1

6T 2 |ρ(0)|2 − kη[k]k2

L2 .

CONTROLLABILITY FOR DISCONTINUOUS FLUX

Therefore

Since 0 ≥ ρ(x) ≥ ρ(0), hence from Lemma 3.5 and (49), we have

|ρ(0)| ≤(cid:0)18T 2kη[k]k2

L2(cid:1)1/3

= ρ0(say).

20

(49)

(i). If t(x) ≤ T /2, then T − t(x) ≥ T /2, which implies

x

T −t(x) ≤ 2x

T ≤ 2R0
T .

(ii). If t(x) ≥ T /2, then h+(cid:16) x

T −t(x)(cid:17) = − ρ(x)

and hence there exists a Λ > 0 such that

x

t(x) ≤ 2|ρ(0)|

T

T −t(x) ≤ Λ. Deﬁne ˜y by

˜y(x) = 


Then

y(x)
x
y(−C)
x

if x ∈ [−C, 0],
if y(−C) ≥ −C and x < −C,
if y(−C) ≤ −C and x ∈ [y(−C), −C],
if x ≤ y(−C).

(50)

˜y(x) = y(x)1[−C,0] + min{−C, y(−C)}1[min{−C,y(−C)},−C) + x1{x<min{−C,y(−C)}}.

and therefore

˜y(x) = y(x)1[R(T ),R0] + max{y(R0), R0}1(R0,max{R0,y(R0)}] + x1{x>max{R0,y(R0)}}.

Hence if y(−C) < −C, then for x ∈ [y(−x), −C, y(x) ≤ y(−C) = ˜y(x)
which implies x−y(x)

> 0. Therefore

T ≥ x−˜y(x)

T = x−y(−C)

T

0

R−∞(cid:12)(cid:12)

2

x−y

T − η[k](cid:12)(cid:12)

=

≥

y(−C)

y(−C)

R−∞ (cid:12)(cid:12)
R−∞ (cid:12)(cid:12)(cid:12)

x−y

2

2

x−˜y

T (cid:12)(cid:12)
T (cid:12)(cid:12)(cid:12)

−C

−C

Ry(−C)(cid:12)(cid:12)
Ry(−C)(cid:12)(cid:12)(cid:12)

+

+

,

2

+

x−y

T (cid:12)(cid:12)

T

x−y(−C)

0

2

R−C (cid:12)(cid:12)
(cid:12)(cid:12)(cid:12)

+

2

0

x−y

T − η[k](cid:12)(cid:12)
R−C (cid:12)(cid:12)

T − η[k](cid:12)(cid:12)

x−y

2

≥ (−C−y(−C))3

3T 2

and if y(R0) > R0, then

∞

RR(T )(cid:12)(cid:12)

x−y

T − η[k](cid:12)(cid:12)

2

≥

∞

RR0 (cid:12)(cid:12)

x−y

2

T (cid:12)(cid:12)

≥

y(R0)

RR0

2

(cid:12)(cid:12)(cid:12)

x−˜y

T (cid:12)(cid:12)(cid:12)

= (y(R0)−R0)3

3T 2

.

Since ˜J(R(T ), y, ρ) ≤ 2kη[k]k2
|y(R0) − R0|3 ≤ 6T 2kη[k]k2
and y(R0) ≤ R0 + (6T 2kη[k]k2
˜J(R(T ), ρ, ˜y). Let us denote M1 = R0 + (6T 2kη[k]k2
the following

L2 , hence | − C − y(−C)|3 ≤ 6T 2kη[k]k2
L2 . Therefore y(−C) ≥ −C − (6T 2kη[k]k2

L2 and
L2 )1/3
L2 )1/3. Again by construction, ˜J(R(T ), ρ, y) ≥
L2 )1/3. Then we obtain

CONTROLLABILITY FOR DISCONTINUOUS FLUX

21

LEMMA 4.2. Let R0, ρ0, M1 be deﬁned as above and deﬁne a new class of
admissible set ¯A1, by

¯A1 = {(R(T ), ρ, y) : 0 ≤ R(T ) ≤ R0, ρ0 ≤ ρ ≤ 0, y(x) = x if x /∈ [−M1, M1]}.

Then

inf
¯A1

˜J = inf
A1

˜J.

LEMMA 4.3. There exists ( ¯R(T ), ¯ρ, ¯y) ∈ ¯A1 such that

inf

(R(T ),ρ,y)∈ ¯A1

˜J(R(T ), ρ, y) = ˜J( ¯R(T ), ¯ρ, ¯y).

(51)

Proof. Proof is trivial due to Helly’s theorem.

4.1 Proof of Theorem 4.1

Proof. Let ¯R(T ), ¯ρ, ¯y be as in Lemma 4.3, then the desired initial data can
be constructed from Lemmas 3.5 and 3.6.

5 Exact control problem for discontinuous ﬂux

Reachable set: Let T, C1, C2, B1, B2, R ∈ R be given so that T > 0, C1 <
0 < C2, B1 < 0 < B2. Let δ > 0 be an arbitrary small number such that
B1 + δ < 0, B2 − δ > 0. Then in order to deﬁne Reachable set we need to
consider the following 2 cases.
Case 1: R ∈ (0, C2).
Let us consider any non decreasing functions y : [C1, 0] ∪ [R, C2] → [B1 +
δ, B2 − δ] and ρ : [0, R] → [B1 − δ, 0] which satisﬁes xy(x) ≥ 0 for all
x ∈ [C1, 0] ∪ [R, C2] and y(x) ≤ ρ(0) for all x ∈ [C1, 0]. Then by Lemma
3.5 there exists a unique non increasing function t : [0, R] → [0, T ], which
satisﬁes − ρ(x)

t(x) = h+(cid:16) x

T −t(x)(cid:17) a.e.x ∈ (0, R).

Let ρ(·), y(·), t(·) be as above then we deﬁne a function W : [C1, C2] → R

by

W (x) = (g′)−1(cid:16) x−y(x)

T (cid:17) 1[C1,0] +(f ′)−1(cid:16) x
+(f ′)−1(cid:16) x−y(x)

T −t(x)(cid:17) 1[0,R]
T (cid:17) 1[R,C2].

Then we deﬁne the Reachable set associated T, δ, R, C1, C2, B1, B2 by

(52)

Reachable set+ = {W : [C1, C2] → R satisﬁes (52)}.

Case 2: R ∈ (C1, 0).
Let us consider any non decreasing functions y : [C1, R] ∪ [0, C2] → [B1 +

CONTROLLABILITY FOR DISCONTINUOUS FLUX

22

δ, B2 − δ] and ρ : [R, 0] → [0, B2 + δ] which satisﬁes xy(x) ≥ 0 for all
x ∈ [C1, R] ∪ [0, C2] and ρ(0) ≤ y(x), for all x ∈ [0, C2]. Then by Lemma
3.5 there exists a unique non increasing function t : [R, 0] → [0, T ], which
satisﬁes − ρ(x)
Let ρ(·), y(·), t(·) be as above then we deﬁne a function W : [C1, C2] → R by

T −t(x)(cid:17) a.e.x ∈ (R, 0).

t(x) = h−(cid:16) x

W (x) = (g′)−1(cid:16) x−y(x)

T (cid:17) 1[C1,R] +(g′)−1(cid:16) x
+(f ′)−1(cid:16) x−y(x)

T −t(x)(cid:17) 1[R,0]
T (cid:17) 1[0,C2].

Then we deﬁne the Reachable set associated T, δ, R, C1, C2, B1, B2 by

(53)

Reachable set− = {W : [C1, C2] → R satisﬁes (53)}.

Finally clubbing Case 1 and Case 2, we deﬁne

Reachable set = Reachable set+ ∪ Reachable set−.

THEOREM 5.1. Let T > 0, C1 < 0 < C2, B1 < 0 < B2. Assume that
¯u0 ∈ L∞(R \ (B1, B2)) and W ∈ Reachable set. Then there exist a solution
u ∈ L∞(R × (0, T )) of (1) such that

u(x, T ) = W (x) x ∈ (C1, C2),
u(x, 0) = u0(x)1R\(B1,B2) + ¯u0(x)1(B1,B2)

(54)

(55)

In order to prove the above Theorem, we need the following free region

Lemmas and the backward construction Lemmas 3.5,3.6.

LEMMA 5.1. Let 0 < B2, 0 < C2. Let us assume that u0 ∈ L∞(B2, ∞) be
given. Let P2 > C2 be any number, then there exists λ2 > 0 and a solution
u ∈ L∞(R+ × [0, T ]) of the following system

ut + f (u)x = 0
u(x, t)
u(x, 0)

= λ2 if (x, t) ∈ Q2,
= u0 if x ∈ (B2, ∞),

if (x, t) ∈ R+ × (0, T ),

(56)

where the domain Q2, is given by Q2 = {(x, t) : 0 ≤ t ≤ T, 0 ≤ x ≤
(t − T ) P2−B2

T + P2}.

Proof. One can choose u0(x) = λ2, for x ∈ (0, B2), where λ2 is some large
positive number. Roughly speaking, the superlinear growth of f allows a
large shock due to λ2, which kills the given u0 in (B2, ∞). The rigorous
proof follows as in the same spirit of the free region Lemmas 2.2, 2.3, 2.4 as
in [1].

CONTROLLABILITY FOR DISCONTINUOUS FLUX

23

LEMMA 5.2. Let B1 < 0, C1 < 0. Let us assume that u0 ∈ L∞(−∞, B1)
be given. Let P1 < C1 be any number, then there exists λ1 < 0 and a solution
u ∈ L∞(R− × [0, T ]) of the following system

ut + g(u)x = 0
u(x, t)
u(x, 0)

= λ1 if (x, t) ∈ Q1,
= u0 if x ∈ (−∞, B1),

if (x, t) ∈ R− × (0, T ),

(57)

where the domain Q1, is given by Q1 = {(x, t) : 0 ≤ t ≤ T, 0 ≥ x ≥
(t − T ) P1−B1

T + P1}.

Proof. Similarly by choosing u0(x) = λ1, for x ∈ (B1, 0), where λ2 is some
large negative number. Proof is similar like as in the previous lemma.

t = T

(C1, T )

(R, T )

(C2, T )

Large
negative
shock

λ1

t = 0

(B1, 0)

x = 0

Figure 7: An illustration of the Theorem

Large
positive
shock

λ2

(B2, 0)

Proof of Theorem 5.1. Let δ > 0 be an arbitrary small number. Then de-
ﬁne an initial data in the domain (B1, B1, +δ) ∪ (B2 − δ, B2) by u0(x) =
λ11(B1,B1,+δ) + λ21(B2−δ,B2), where λ1 and λ2 are as in Lemma 5.2 and
Lemma 5.1 respectively. From the above two Lemmas it is clear that in the
region Q1 ∪Q2 there is no inﬂuence of the given initial data u0 ∈ R\(B1, B2),
which allow us to use the backward construction Lemma 3.5, 3.6 in the do-
main Q1 ∪ Q2. Let us consider Case 1, i.e., consider any R ∈ (0, C2). Then
given ρ(·), t(·), y(·), we apply Lemma 3.5. Therefore given any W (x) ∈
Reachable set+, we obtain a solution u ∈ L∞(R × (0, T )) of (1) such that
u(x, T ) = W (x) for x ∈ (C1, C2). Similarly one can construct a solution by
using Lemma 3.6 when W (x) ∈ Reachable set−. Hence the theorem.

REMARK 5.1. Due to the explicit formulas (6), (7) in Theorem 2.1, the
reachable set in Theorem 5.1 is optimal.

CONTROLLABILITY FOR DISCONTINUOUS FLUX

24

Acknowledgments

The ﬁrst author would like to thank Gran Sasso Science Institute, L’Aquila,
Italy for the hospitality during his visit and also IFCAM for the funding.

References

[1] Adimurthi, S. S. Ghoshal and G. D. Veerappa Gowda, Exact control-
lability of scalar conservation law with strict convex ﬂux, Math. Control
Relat. Fields., 04, (2014), 401–449.

[2] Adimurthi, S. S. Ghoshal and G.D. Veerappa Gowda, Optimal control-
lability for scalar conservation law with convex ﬂux, J. Hyperbolic Diﬀer.
Equ., 11, (2014), 477–491.

[3] Adimurthi, S. S. Ghoshal and G. D. Veerappa Gowda, Structure of an
entropy solution of a scalar conservation law with strict convex ﬂux, J.
Hyper. Diﬀerential Equations, 09, (2012), 571–611.

[4] Adimurthi and G. D. Veerappa Gowda, Conservation laws with discon-

tinuous ﬂux, J. Math. Kyoto Univ. 43, 1, (2003), 27–70.

[5] Adimurthi, J. Jaﬀre and G.D. Veerappa Gowda, Godunov type methods
for scalar conservation laws with ﬂux function discontinuous in the space
variable, SIAM J. Numer. Anal. 42, 1, (2004), 179–208.

[6] Adimurthi, S. Mishra and G. D. Veerappa Gowda, Optimal entropy so-
lutions for conservation laws with discontinuous ﬂux-functions, J. Hy-
perbolic Diﬀer. Equ. 2, 4, (2005), 783–837.

[7] Adimurthi, S. Mishra and G. D. Veerappa Gowda, Explicit Hopf-Lax
type formulas for Hamilton-Jacobi equations and conservation laws with
discontinuous coeﬃcients, J. Diﬀerential Equations, 241, (2007), 1, 1–31.

[8] B. Andreianov, C. Donadello, S.S. Ghoshal and U. Razaﬁson, On the
attainability set for triangular type system of conservation laws with
initial data control, J. Evol. Equ., 15, (2015), 503–532.

[9] B. Andreianov, K. H. Karlsen and N. H. Risebro, A theory of L1-
dissipative solvers for scalar conservation laws with discontinuous ﬂux.
Arch. Ration. Mech. Anal. 201, 1, (2011), 27–86.

[10] F. Ancona and A. Marson, On the attainability set for scalar non linear
conservation laws with boundary control, SIAM J.Control Optim, 36, 1,
(1998), 290–312.

CONTROLLABILITY FOR DISCONTINUOUS FLUX

25

[11] F. Ancona and G. M. Coclite, On the attainable set for Temple class
systems with boundary controls. SIAM J. Control Optim., 43, 6, (2005),
2166–2190.

[12] A. Bressan and G. M. Coclite. On the boundary control of systems of

conservation laws. SIAM J. Control Optim., 41, 2, (2002), 607–622.

[13] R. B¨urger, K.H. Karlsen, N.H. Risebro and J. D. Towers, Well-
posedness in BVt and convergence of a diﬀerence scheme for continuous
sedimentation in ideal clariﬁer thickener units, Numer. Math. 97, 1,
(2004), 25–65.

[14] R. B¨urger, K.H. Karlsen, N.H. Risebro and J. D. Towers, Monotone
diﬀerence approximations for the simulation of clariﬁer-thickener units.
Comput. Visual. Sci., 6, (2004), 83–91.

[15] C.Castro, F.Palacios and E.Zuazua, Optimal control and vanishing vis-
cosity for the Burgers equations, Integral methods in science and engi-
neering, 2, Birkhouser Boston Inc, Boston MA, (2010), 65–90,

[16] C.Castro and E.Zuazua, Flux identiﬁcation for 1-d scalar conservation

laws in the presence of shocks, Math.Comp., 80, (2011), 2025–2070.

[17] J.-M. Coron, Global asymptotic stabilization for controllable systems

without drift, Math. Control Signals Systems., 5, 3, (1992), 295–312.

[18] J.-M. Coron, S. Ervedoza, S. S. Ghoshal, O. Glass and V. Perrollaz,
Dissipative boundary conditions for 2 × 2 hyperbolic systems of conser-
vation laws for entropy solutions in BV- submitted.

[19] C. M. Dafermos, Hyperbolic Conservation Laws in Continuum Physics,

2 nd edition, Springer Verlag, Berlin, (2000).

[20] S. Diehl, Continuous sedimentation of multi-component particles,

Math. Methods Appl. Sci., 20, (1997), 1345–1364.

[21] T. Gimse and N. H. Risebro, Solution of the Cauchy problem for a con-
servation law with a discontinuous ﬂux function, SIAM J. Math. Anal.,
23 (1992), 635–648.

[22] O. Glass and S. Guerrero, On the uniform controllability of the Burgers

equation, SIAM J. Control optim., 46, no.4 (2007), 1211–1238.

[23] T. Horsin, On the controllability of the Burger equation, ESIAM,

Control optimization and Calculus of variations, 3, (1998), 83–95.

[24] K. T. Joseph and G. D. Veerappa Gowda, Explicit formula for the
solution of Convex conservation laws with boundary condition, Duke
Math.J., 62, (1991) 401–416.

CONTROLLABILITY FOR DISCONTINUOUS FLUX

26

[25] J.D. Towers, Convergence of a diﬀerence scheme for conservation laws
with a discontinuous ﬂux, SIAM J. Numer. Anal. 38, 2, (2000), 681–698.

