Decomposing Ku+w − Ku into cycles of various

lengths

Daniel Horsley and Rosalind A. Hoyte

School of Mathematical Sciences

Monash University
Vic 3800, Australia

danhorsley@gmail.com, rahoyte@outlook.com

6
1
0
2

 
r
a

 

M
2
1
 
 
]

.

O
C
h
t
a
m

[
 
 

1
v
8
0
9
3
0

.

3
0
6
1
:
v
i
X
r
a

Abstract

We prove that the complete graph with a hole Ku+w − Ku can be decomposed into
cycles of arbitrary speciﬁed lengths provided that the obvious necessary conditions are
satisﬁed, each cycle has length at most min(u, w), and the longest cycle is at most three
times as long as the second longest. This generalises existing results on decomposing
the complete graph with a hole into cycles of uniform length, and complements work on
decomposing complete graphs, complete multigraphs, and complete multipartite graphs
into cycles of arbitrary speciﬁed lengths.

1

Introduction

A decomposition of a graph G is a collection of subgraphs of G whose edge sets form a par-
tition of the edge set of G. There is extensive literature, dating back to the 19th century
[14, 15], concerning the existence of decompositions of a graph G into cycles of speciﬁed lengths
m1, . . . , mτ . Much attention has focussed on decompositions into cycles of uniform length (when
m1 = · · · = mτ ), but more recently results on decompositions into cycles of mixed lengths have
also been obtained.

Most notably, the general mixed-length problem has been completely solved for decompo-
sitions of complete graphs [7]. This result was recently generalised to complete multigraphs
[2]. Partial results have also been obtained for decompositions of complete bipartite graphs
[9, 12, 18] and complete multipartite graphs [1]. Here, we add to this body of work by address-
ing the question of when a complete graph with a hole admits a decomposition into cycles of
arbitrary speciﬁed lengths. For positive integers u and w, the complete graph of order u + w
with a hole of size u, denoted Ku+w − Ku, is the graph obtained from a complete graph of order
u + w by removing the edges of a complete subgraph of order u. Our main result is as follows.

Theorem 1. Let u and w be integers with w ≥ 10, and let m1, . . . , mτ be a nondecreasing list
of integers such that mτ ≤ min(u, w, 3mτ −1). There exists a decomposition of Ku+w − Ku into
cycles of lengths m1, . . . , mτ if and only if

(i) u is odd and w is even;

(ii) m1 ≥ 3;

(iii) m1 + · · · + mτ = (cid:0)u+w
(iv) there are at most (cid:0)w

2(cid:1); and

2 (cid:1) −(cid:0)u
2(cid:1) odd entries in m1, . . . , mτ .

Theorem 1 is also an extension of work on decomposing the complete graph with a hole
into cycles of uniform length. Study of this problem began in 1973 when Doyen and Wilson
[10] investigated decompositions into 3-cycles, and decompositions into m-cycles for various m
have been considered in [3, 8, 17]. The strongest results obtained to date are found in [12] and
[13], where the problem is solved whenever the number of vertices outside the hole is not too
small compared with the cycle length.

It is not diﬃcult to see that conditions (i)-(iv) in Theorem 1 are necessary for the existence of
a decomposition of Ku+w −Ku into cycles of lengths m1, . . . , mτ . We establish this in Lemma 2.
Note that if m1 = m2 = · · · = mτ , then Lemma 2 specialises to [8, Lemma 1.1], which is the
analogous result for cycles of uniform length.

Lemma 2. Let m1, . . . , mτ be a nondecreasing list of integers and let u and w be positive
integers. If there exists a decomposition of Ku+w − Ku into cycles of lengths m1, . . . , mτ then

(i) u is odd and w is even;

(ii) m1 ≥ 3 and mτ ≤ min(u + w, 2w);

(iii) m1 + · · · + mτ = (cid:0)u+w
(iv) there are at most (cid:0)w

2 (cid:1) −(cid:0)u
2(cid:1);
2(cid:1) odd entries in m1, . . . , mτ ; and

2

(v) τ ≥ u+w−1

.

Proof. Suppose there exists a decomposition of Ku+w − Ku into cycles of lengths m1, . . . , mτ .
Since the degree of each vertex must be even, we have w ≡ 0 (mod 2) and u+w −1 ≡ 0 (mod 2)
so (i) follows. Clearly m1 ≥ 3 and mτ ≤ u + w. Also, every cycle has at least half of its vertices
outside the hole, so mτ ≤ 2w and thus (ii) follows. Condition (iii) clearly holds. Any odd cycle
in Ku+w − Ku must contain at least one edge that is not incident with a vertex in the hole,
thus (iv) follows. Finally, a ﬁxed vertex outside the hole must be in at least u+w−1
cycles, so
(v) follows.

2

The remainder of the paper is concerned with proving the existence of cycle decompositions
of Ku+w − Ku. Our general approach is to ﬁrst construct decompositions of Ku+w − Ku that
contain collections of short cycles and then ‘merge’ these cycles together to construct longer
cycles. This method is similar to that used in [13]. Lemma 3 below is the key result that allows
us to merge two cycle lengths.

2 Notation and preliminary results

We now introduce some deﬁnitions and notation that we will require throughout the paper.

A packing of a graph G is a decomposition of some subgraph H of G. The leave of the
packing is the graph obtained by removing the edges of H from G. We deﬁne the reduced leave
of a packing as the graph obtained from its leave by deleting any isolated vertices. If the leave
contains no edges then the reduced leave is a trivial graph with no vertices or edges. For a

2

list of positive integers m1, . . . , mτ , an (m1, . . . , mτ )-packing or (m1, . . . , mτ )-decomposition of
a graph G is a packing or decomposition of G with τ cycles of lengths m1, . . . , mτ . We say that
a graph is even if each of its vertices has even degree. Note that a graph is even if and only if
it has some decomposition into cycles.

For a set V , let KV denote the complete graph with vertex set V . For disjoint sets U and
W , let KU,W denote the complete bipartite graph with parts U and W . For graphs G and H,
let G ∪ H denote the graph with vertex set V (G) ∪ V (H) and edge set E(G) ∪ E(H). Let G − H
denote the graph with vertex set V (G) and edge set E(G) \ E(H).

The neighbourhood NbdG(x) of a vertex x in a graph G is the set of vertices in G that
are adjacent to x (not including x itself). We say vertices x and y in a graph G are twin in
G if NbdG(x) \ {y} = NbdG(y) \ {x}. Let U and W be disjoint sets and consider the graph
KU ∪W − KU . Note that two vertices are twin in KU ∪W − KU if and only if they are both in U
or both in W . We say an edge xy of KU ∪W − KU is a pure edge if x, y ∈ W and we say that it is
a cross edge if x or y ∈ U. Note that an even subgraph G of KU ∪W − KU has an even number
of cross edges and hence |E(G)| is congruent to the number of pure edges in G modulo 2.

The m-cycle with vertices x0, x1, . . . , xm−1 and edges xixi+1 for i ∈ {0, 1, . . . , m − 1} (with
subscripts modulo m) is denoted by (x0, x1, . . . , xm−1) and the n-path with vertices y0, y1, . . . , yn
and edges yjyj+1 for j ∈ {0, 1, . . . , n − 1} is denoted by [y0, y1, . . . , yn]. We will say that y0 and
yn are the end vertices of this path. We allow trivial 0-paths that consist of a single vertex and
no edges.

Given a permutation π of a set V , a subset S of V and a graph G0 with V (G0) ⊆ V , let
π(S) be the set {π(x) : x ∈ S} and π(G0) be the graph with vertex set {π(x) : x ∈ V (G0)} and
edge set {π(x)π(y) : xy ∈ E(G0)}.

Deﬁnition. Let G be a graph and let P = {G1, . . . , Gt} be a packing of the graph G. We
say that another packing P ′ of G is a repacking of P if P ′ = {G′
t} where for each
i ∈ {1, . . . , t} there is a permutation πi of V (G) such that πi(Gi) = G′
i and x and πi(x) are
twin for each x ∈ V (G).

1, . . . , G′

If P is a packing of Ku+w − Ku with leave L and P ′ is a repacking of P with leave L′, then
L and L′ have the same number of pure and cross edges. This fact will be used frequently
through the remainder of the paper.

Lemma 3. Let u ≥ 5 and w ≥ 2 be integers such that u is odd and w is even, and let M be
a list of integers. Suppose there exists an (M)-packing P of Ku+w − Ku with a reduced leave
that has exactly µ pure edges, where µ ∈ {0, 1, 2}, and has a decomposition into an h-cycle, an
m1-cycle and an m2-cycle where h is odd if µ = 2. If m1 +m2 ≤ 3h and m1 +m2 +h ≤ min(2u+
3, 2w + 1, u + w), then there exists a repacking of P whose reduced leave has a decomposition
into an h-cycle and an (m1 + m2)-cycle each containing at most one pure edge.

The following lemma from [13] is a crucial technique in proving our results. This ‘switch-
ing’ method was ﬁrst applied to packings of the complete graph [4, 5, 6], and has since been
generalised to other graphs [2, 12, 13].

Lemma 4 ([13, Lemma 2]). Let u and w be positive integers with u odd and w even, and let
M be a list of integers. Let P be an (M)-packing of Ku+w − Ku with leave L, let α and β be
twin vertices in Ku+w − Ku, and let π be the transposition (αβ). Then there exists a partition
of the set (NbdL(α) ∪ NbdL(β)) \ ((NbdL(α) ∩ NbdL(β)) ∪ {α, β}) into pairs such that, for

3

each pair {x, y} of the partition, there exists an (M)-packing P ′ of Ku+w − Ku whose leave
L′ diﬀers from L only in that αx, αy, βx and βy are edges in L′ if and only if they are not
edges in L. Furthermore, if P = {C1, C2, . . . , Ct}, then P ′ = {C ′
t}, where, for each
i ∈ {1, . . . , t}, C ′

i is a cycle of the same length as Ci such that

2, . . . , C ′

1, C ′

(i) if neither α nor β is in V (Ci), then C ′

i = Ci;

(ii) if exactly one of α and β is in V (Ci), then either C ′

i = Ci or C ′

i = π(Ci); and

(iii) if both α and β are in V (Ci), then C ′

i ∈ {Ci, π(Ci), π(Pi) ∪ P †
i are the two paths in Ci which have end vertices α and β.

P †

i , Pi ∪ π(P †

i )}, where Pi and

Note that P ′ is a repacking of P in the above. When we apply Lemma 4 we say that we
are performing the (α, β)-switch with origin x and terminus y (equivalently, with origin y and
terminus x).

3 Merging two cycle lengths

The aim of this section is to prove Lemma 3. The work required to prove the µ = 0 case of
this lemma has been done in [12].

Lemma 5. Let u and w be positive integers such that u is odd and w is even, and let M be
a list of integers. Suppose there exists an (M)-packing P of Ku+w − Ku with a reduced leave
that has no pure edges, and has a decomposition into an h-cycle, an m-cycle and an m′-cycle.
If m + m′ ≤ 3h and m + m′ + h ≤ 2 min(u + 1, w + 1), then there exists a repacking of P whose
reduced leave has a decomposition into an h-cycle and an (m + m′)-cycle.

Proof. This lemma is very similar to Lemma 3.6 from [12], but it applies to packings of
Ku+w − Ku rather than to packings of Ku,w (the leaves of the packings are still subgraphs of
Ku,w). It can be proved exactly as per the proof of [12, Lemma 3.6], except that Lemma 4 is
used in place of [12, Lemma 2.1]. Note that two vertices of Ku+w − Ku are twin if and only if
they are both in the hole or both outside it. Also note that u 6= w because u is odd and w is
even.

So it remains to prove Lemma 3 in the cases µ = 1 and µ = 2. To help with this task we

ﬁrst prove two useful lemmas and then introduce some more notation.

Lemma 6. Let G be an even graph, let y and z be twin vertices in G, and let P be an (M)-
packing of G with (unreduced) leave L. If degL(y) > degL(z), then there is an (M)-packing P ′
of G with an (unreduced) leave L′ such that degL′(y) = degL(y) − 2, degL′(z) = degL(z) + 2,
and degL′(x) = degL(x) for each x ∈ V (G) \ {y, z}. Furthermore the number of nontrivial
components in L′ is at most one greater than the number of nontrivial components in L.

Proof. Let P ′ be the repacking of P obtained by applying a (y, z)-switch whose origin and
terminus are both adjacent to y in L. Such a switch exists because degL(y) > degL(z). Examine
the diﬀerences between L′ and L.

Lemma 7. Let U and W be disjoint sets with |U| odd and |W | even, and suppose that L is a
subgraph of KU ∪W − KU such that L contains exactly µ pure edges, where µ ∈ {1, 2}, and each
vertex of L has positive even degree.

4

(i) If |E(L)| ≤ 2(|U| + 1) and U contains a vertex of degree at least 4 in L, then there is a

vertex x in U such that x /∈ V (L).

(ii) If |E(L)| ≤ min(2(|U| + 2), 2|W | + 1) and S is an element of {U, W } such that S contains
either at least two vertices of degree 4 in L or at least one vertex of degree at least 6 in
L, then there is a vertex x in S such that x /∈ V (L).

(iii) If |E(L)| ≤ min(2(|U| + 2), 2|W | + 1, |U| + |W |) and L contains either at least two vertices
of degree 4 or at least one vertex of degree at least 6, then there are twin vertices x and y
in KU ∪W − KU such that degL(x) ≥ 4 and y /∈ V (L).

Proof. Let ℓ = |E(L)| and note that ℓ ≡ µ (mod 2). If µ = 2 then the result follows by [13,
Lemma 10]. So suppose that µ = 1. Then we have

Xx∈V (L)∩U
Xx∈V (L)∩W

degL(x) = ℓ − 1, and

degL(x) = ℓ + 1.

Proof of (i). Suppose that ℓ ≤ 2(|U| + 1) and U contains a vertex of degree at least 4 in L.

Then ℓ ≤ 2|U| + 1 since ℓ is odd. If U ⊆ V (L) then ℓ − 1 = Px∈V (L)∩U degL(x) ≥ 2|U| + 2

which contradicts ℓ ≤ 2|U| + 1.
Proof of (ii). Suppose that ℓ ≤ min(2(|U| + 2), 2|W | + 1, |U| + |W |) and S is an element
of {U, W } such that S contains either at least two vertices of degree 4 in L or at least one
vertex of degree at least 6 in L. Suppose for a contradiction that S ⊆ V (L). Then we have

Px∈V (L)∩S degL(x) ≥ 2|S| + 4. So, if S = U, then ℓ − 1 ≥ 2|U| + 4, contradicting ℓ ≤ 2|U| + 3.

If S = W , then ℓ + 1 ≥ 2|W | + 4, contradicting ℓ ≤ 2|W | + 1.
Proof of (iii). Because we have proved (ii), it only remains to show that if L contains two
vertices of degree 4, one in U and one in W , and every other vertex of L has degree 2, then
there are twin vertices x and y in KU ∪W − KU such that degL(x) ≥ 4 and y /∈ V (L). Suppose
otherwise. Then it must be the case that V (L) = U ∪ W , ℓ − 1 = 2|U| + 2 and ℓ + 1 = 2|W | + 2.
But then ℓ = 2|U| + 3 and ℓ = 2|W | + 1, so |U ∪ W | = 2|U| + 1 and ℓ = |U| + |W | + 2,
contradicting ℓ ≤ |U| + |W |.

Deﬁnition. An (a1, a2, . . . , as)-chain (or s-chain) is the edge-disjoint union of s ≥ 2 cycles
A1, A2, . . . , As such that

• Ai is a cycle of length ai for 1 ≤ i ≤ s; and

• for 1 ≤ i < j ≤ s, |V (Ai) ∩ V (Aj)| = 1 if j = i + 1 and |V (Ai) ∩ V (Aj)| = 0 otherwise.

We call A1 and As the end cycles of the chain, and for 1 < i < s we call Ai an internal
cycle of the chain. A vertex which is in two cycles of the chain is said to be the link vertex of
those cycles. We denote a 2-chain with cycles A1 and A2 by A1 · A2.

Deﬁnition. An (a1, a2, . . . , as)-ring (or s-ring) is the edge-disjoint union of s ≥ 2 cycles
A1, A2, . . . , As such that

• Ai is a cycle of length ai for 1 ≤ i ≤ s;

5

• for s ≥ 3 and 1 ≤ i < j ≤ s, |V (Ai) ∩ V (Aj)| = 1 if j = i + 1 or if (i, j) = (1, s), and

|V (Ai) ∩ V (Aj)| = 0 otherwise; and

• if s = 2 then |V (A1) ∩ V (A2)| = 2.

We refer to the cycles A1, A2, . . . , As as the ring cycles of the ring in order to distinguish
them from the other cycles that can be found within the graph. A vertex which is in two ring
cycles of the ring is said to be a link vertex of those cycles.

Deﬁnition. For disjoint sets of vertices U and W , an s-chain that is a subgraph of KU ∪W − KU
is good if either s = 2 or the following conditions hold:

• an end cycle of the chain has its link vertex in W and contains at least one pure edge;

and

• each internal cycle of the chain has one link vertex in W and one link vertex in U.

Deﬁnition. For disjoint sets of vertices U and W , an s-ring that is a subgraph of KU ∪W − KU
is good if either s = 2 or one of the following holds:

• s ≥ 4 is even, and each of the ring cycles has one link vertex in U and one link vertex in

W ; or

• s ≥ 3 is odd, one ring cycle has both link vertices in W and contains a pure edge, and

each other ring cycle has one link vertex in U and one link vertex in W .

Much of the work for the µ = 2 case of Lemma 3 has also already been done in the form of

the following lemma from [13].

Lemma 8 ([13, Lemma 14]). Let U and W be disjoint sets with |U| odd and |W | even, and
let M be a list of integers. Let m, m′, k and t be positive integers such that m and m′ are
odd, m, m′ ≥ max(k + t − 1, 3), m + m′ ≤ min(2|U| + 4, 2|W |), and m + m′ ≤ 2(|U| + 1) if
3 ∈ {m, m′}. Suppose there exists an (M)-packing P of KU ∪W − KU with a reduced leave L
of size m + m′ such that L contains exactly two pure edges and L has exactly k components,
k − 1 of which are cycles and one of which is a good t-chain that, if 3 ∈ {m, m′}, is not a
2-chain with link vertex in U. Then there exists a repacking of P whose reduced leave is the
edge-disjoint union of an m-cycle and an m′-cycle.

In order to prove Lemma 3 we will require Lemma 15 which is an analogue of Lemma 8 for

packings whose leaves have one pure edge. This will be our goal in Subsection 3.1.

3.1 Proof of Lemma 15

The proof of Lemma 15 proceeds as follows. Lemmas 9 and 10 are used in proving Lemma 11,
which gives conditions under which we can repack to transform a 2-chain leave into a union
of two cycles of speciﬁed lengths. Lemma 11 then acts as a base case and is used, along with
Lemmas 12 and 13, in an induction proof of Lemma 14. Lemma 14 gives conditions under
which we can repack to transform a good s-chain or s-ring leave into a union of two cycles of
speciﬁed lengths. Finally Lemma 15 is proved from Lemma 14.

6

Lemma 9 ([13, Lemma 5]). Let G be a graph and let M be a list of integers. Let m, p and q
be positive integers with m odd, m ≥ p and p + q − m ≥ 3. Suppose there exists an (M)-packing
P of G whose reduced leave is the (p, q)-chain (x1, x2, . . . , xp−1, c) · (c, y1, y2, . . . , yq−1) and such
that either

(i) p is odd, x1, y3, y5, . . . , ym−p+1 are pairwise twin in G and y2, y4, . . . , ym−p+2 are pairwise

twin in G; or

(ii) p is even, x1, x3, . . . , xp−3 are pairwise twin in G and ym−p+2, x2, x4, . . . , xp−2 are pairwise

twin in G.

Then there exists a repacking of P whose reduced leave is the edge-disjoint union of an m-cycle
and a (p + q − m)-cycle.

Lemma 10. Let U and W be disjoint sets with |U| odd and |W | even, and let M be a list
of integers. Let m, p and q be positive integers with m odd and m, p + q − m ≥ 3. Sup-
pose there exists an (M)-packing P of KU ∪W − KU whose reduced leave L is a (p, q)-chain
(x1, x2, . . . , xp−1, x0) · (x0, y1, y2, . . . , yq−1) such that L contains exactly one pure edge, namely
xrxr+1 for some r ∈ {0, . . . , p − 1} (subscripts modulo p). If p ≤ m, or if p ≥ m + 2 and
r ≤ m − 3, then there exists a repacking of P whose reduced leave is the edge-disjoint union of
an m-cycle and a (p + q − m)-cycle.

Proof. The proof relies on several applications of Lemma 4. We consider the case when p ≤ m
and the case p ≥ m + 2 and r ≤ m − 3 separately. Note that since the p-cycle in L contains
exactly one pure edge and the q-cycle contains no pure edges, then p is odd and q is even.
Case 1. First suppose that p ≤ m. If p = m then we are done so assume p < m. Without loss
of generality, assume x0x1 is not a pure edge (otherwise relabel vertices in L). Then the result
follows by Lemma 9(i) because [x1, x0, y1, . . . , ym−p+2] is a path with no pure edges and hence
x1, y3, y5, . . . , ym−p+1 are pairwise twin and y2, y4, . . . , ym−p+2 are pairwise twin.
Case 2. Now assume that p ≥ m + 2 and r ≤ m − 3. Then by a simple induction it is suﬃcient
to obtain either the required decomposition, or a (p − 2, q + 2)-chain (x′
0) ·
0, y′
(x′
r+1 for some r ∈ {0, . . . , m − 3}.
Let P ′ be the repacking of P obtained by performing the (y1, xm−1)-switch with origin x0.
Note that {y1, xm−1} and {xm, xm−2} are twin pairs in KU ∪W −KU because r ≤ m−3 and hence
[xm−2, xm−1, . . . , xp−1, x0, y1] is a path with no pure edges. If the terminus of the switch is not
xm−2 then the reduced leave of P ′ has a decomposition into an m-cycle and a (p + q − m)-cycle
and we are done. So assume that the terminus is xm−2. Then the reduced leave of P ′ is the
(q + m − 2, p − m + 2)-chain (x1, x2, . . . , xm−2, y1, y2, . . . , yq−1, x0) · (x0, xm−1, xm, . . . , xp−1).

q−1+1) that contains exactly one pure edge x′

2, . . . , x′

1, y′

2, . . . , y′

1, x′

p−3, x′

rx′

Let P ′′ be the repacking of P ′ obtained by performing the (xm, xm−2)-switch with origin
xm−1. If the terminus of the switch is not xm−3, then the reduced leave of P ′′ has a decomposition
into an m-cycle and a (p + q − m)-cycle and we are done. Otherwise, the terminus is xm−3
and the reduced leave of P ′′ is the (p − 2, q + 2)-chain (x1, . . . , xm−3, xm, xm+1, . . . , xp−1, x0) ·
(x0, xm−1, xm−2, y1, y2, . . . , yq−1) where xrxr+1 is a pure edge.

Lemma 11. Let U and W be disjoint sets with |U| odd and |W | even, and let M be a list
of integers. Let m, p and q be positive integers with m odd and m, p + q − m ≥ 3. Suppose
there exists an (M)-packing P of KU ∪W − KU whose reduced leave L is a (p, q)-chain such
that L contains exactly one pure edge and the link vertex of L is in W if m = 3. Then there

7

exists a repacking of P whose reduced leave is the edge-disjoint union of an m-cycle and a
(p + q − m)-cycle.

Proof. Since L contains exactly one pure edge, p + q must be odd. Without loss of generality
suppose p is odd. Then the p-cycle in L contains the pure edge and the q-cycle in L contains
no pure edges.
Suppose either that p ≤ m or that p ≥ m + 2 and L can be labelled
Case 1.
(x1, x2, . . . , xp−1, x0) · (x0, y1, y2, . . . , yq−1) such that xrxr+1 is the pure edge for some r ∈
{0, . . . , m − 3}. Then the result follows by Lemma 10.
Suppose that p ≥ m + 2 and there is no such labelling. Let L be labelled
Case 2.
(x1, x2, . . . , xp−1, x0) · (x0, y1, y2, . . . , yq−1) such that xrxr+1 is the pure edge for some r ∈
{m − 2, . . . , p − 1} (subscripts modulo p). Then r ≥ 2, using the fact that x0 ∈ W if m = 3.
It is suﬃcient to show that there exists a repacking P ′ of P whose reduced leave is either a
(p, q)-chain that can be labelled as (x′
q−1) where the pure
edge is x′
r−1, or a (p − 2, q + 2)-chain. By repeating this process we eventually obtain a
repacking of P which satisﬁes the criteria of Case 1.

2, . . . , x′

2, . . . , y′

0, y′

1, y′

r−2x′

1, x′

p−1, x′

0) · (x′

Let P ′ be the repacking of P obtained by performing the (x0, x2)-switch with origin x3.
Note that x0 and x2 are twin in KU ∪W − KU because r ≥ 2 and hence [x0, x1, x2] is a path
with no pure edges. If the terminus of the switch is xp−1, then the reduced leave of P ′ is the
(p, q)-chain (x3, x4, . . . , xp−1, x2, x1, x0) · (x0, y1, y2, . . . , yq−1) and we are done. If the terminus
of the switch is not xp−1 then the reduced leave of P ′ is a (p − 2, q + 2)-chain.

Lemma 12. Let U and W be disjoint sets with |U| odd and |W | even, and let M be a list of
integers. Let p and s be integers such that p ≥ 4 and s ≥ 2. Suppose there exists an (M)-
packing P of KU ∪W − KU whose reduced leave L is a good s-chain that contains exactly one
pure edge and has a decomposition {P, L − P } into two paths such that P has length p and
each path has both end vertices in W . Suppose further that P has a subpath P0 = [x0, . . . , xr]
such that 2 ≤ r ≤ p − 1, x0 is an end vertex of P , P0 contains no pure edge, and degL(xr−1) =
degL(xr) = 2. Then there is a repacking of P whose reduced leave L′ is a good s-chain that has
a decomposition {P ′, L′ − P ′} into two paths such that P ′ has length p − 2, each path has both
end vertices in W , and P ′ contains a pure edge if and only if P does.

Proof. Label the vertices in V (P ) \ V (P0) so that P = [x0, . . . , xp]. We prove the result by
induction on the length of P0. If |E(P0)| = 2, then {P ′, L − P ′} where P ′ = [x2, . . . , xp] is
a decomposition of L with the required properties. So we can assume that |E(P0)| ≥ 3. By
induction we can assume that P0 is the shortest subpath of P satisfying the required conditions.
Because r ≥ 3, this implies that degL(xr−2) = 4 and xr−2 is a link vertex of L.

The vertices xr and xr−2 are twin in KU ∪W − KU because [xr−2, xr−1, xr] is a path with
no pure edges. Let L′ be the reduced leave of the repacking of P obtained by perform-
ing the (xr, xr−2)-switch with origin xr−3. Note that L′ is a good s-chain irrespective of
If the terminus of the switch is not xr+1, then {P ′, L′ − P ′}
the terminus of the switch.
where P ′ = [x0, x1, . . . , xr−3, xr, xr+1, . . . , xp]
is a decomposition of L′ such that P ′ has
length p − 2, each path has both end vertices in W , and P ′ contains a pure edge if and
If the terminus of the switch is xr+1, then {P ′, L′ − P ′} where P ′ =
only if P does.
[x0, x1, . . . , xr−3, xr, xr−1, xr−2, xr+1, xr+2, . . . , xp] is a decomposition of L′ into two paths such
that P ′ has length p and contains a pure edge if and only if P does, and each path has both
end vertices in W . Further P ′ has the subpath P ′
0 = [x0, . . . , xr−3, xr, xr−1] and we know that

8

x0 is an end vertex of P ′, P ′
because |E(P ′

0)| = r − 1, we are ﬁnished by our inductive hypothesis.

0 contains no pure edge, and degL′(xr) = degL′(xr−1) = 2. Thus,

Lemma 13. Let U and W be disjoint sets with |U| odd and |W | even, and let M be a list of
integers. Let m, m′ and s be integers such that m + m′ is odd, m, m′ ≥ max(s, 3) and s ≥ 2.
Suppose there exists an (M)-packing P of KU ∪W − KU whose reduced leave is a good s-chain
of size m + m′ that contains exactly one pure edge. Then there exists a repacking of P whose
reduced leave is a good s-chain that has a decomposition into an m-path and an m′-path such
that the end vertices of the paths are twin in KU ∪W − KU .

Proof. Let L be the reduced leave of P and note that |E(L)| = m + m′. Because L is good
and contains exactly one pure edge, we can ﬁnd some decomposition {H, L − H} of L into two
paths such that H has odd length and contains the pure edge, L − H has even length, and each
of the paths has both end vertices in W . Let m∗ ∈ {m, m′} and P ∈ {H, L − H} such that
|E(P )| ≥ m∗ and |E(P )| ≡ m∗ (mod 2) (such an m∗ and P exist because |E(L)| = m + m′). If
|E(P )| = m∗ then we are done, so suppose |E(P )| > m∗. Let p = |E(P )|.
Case 1. Each cycle of L contains at most two edges of P . Then exactly p − s cycles of the
chain contain two edges of P and the rest contain one edge of P . Because L is good and both
end vertices of P are in W , if C is a cycle of L that contains two edges of P then C is an end
cycle of L, the link vertex of C is in W , and C ∩ P contains no pure edges. Thus, because
p > m∗ ≥ s, it must be that p = s + 2 and m∗ = s. Then {P ′, L − P ′}, where P ′ is obtained
from P by removing the end vertices and the incident edges, is a decomposition of L into an
m-path and an m′-path such that both end vertices of each path are in U.
Case 2. There exists a cycle C in L such that C ∩ P is a path of length at least 3. Let
P0 = [x0, . . . , xr] be a subpath of P such that x0 is an end vertex of P , P0 contains no pure
edge, and P0 contains exactly two edges in C ∩ P . If C ∩ P contains no pure edge then it is
easy to see such a subpath exists. If C ∩ P contains the pure edge then (since L is good) C
is an end cycle of L whose link vertex is in W and again there exists such a subpath. So we
can apply Lemma 12 to obtain a repacking of P whose reduced leave L′ is a good s-chain that
has a decomposition {P ′, L′ − P ′} into two paths such that P ′ has length p − 2, P ′ has a pure
edge if and only if P does, and both paths have end vertices in W . It is clear that by repeating
this procedure we will eventually obtain a repacking of P whose reduced leave either has a
decomposition into two paths which satisﬁes the criteria for Case 1 or has a decomposition into
an m-path and an m′-path such that both end vertices of each path are in W .

Lemma 14. Let U and W be disjoint sets with |U| odd and |W | even, and let M be a list of
integers. Let m, m′ and s be positive integers such that s ≥ 2, m+m′ is odd, m, m′ ≥ max(s, 3),
m + m′ ≤ min(2|U| + 3, 2|W | + 1, |U| + |W |), and m + m′ ≤ 2|U| + 1 if 3 ∈ {m, m′}. Suppose
there exists an (M)-packing P of KU ∪W − KU whose reduced leave has size m + m′, contains
exactly one pure edge, and is either a good s-chain or a good s-ring that, if 3 ∈ {m, m′}, is not
a 2-chain with link vertex in U. Then there exists a repacking of P whose reduced leave is the
edge-disjoint union of an m-cycle and an m′-cycle.

Proof. Let L be the reduced leave of P. We ﬁrst show that the result holds for s = 2. If L
is a 2-chain then the result follows by Lemma 11. If L is a 2-ring then by our hypotheses and
Lemma 7 there are twin vertices x and y in KU ∪W − KU such that degL(x) ≥ 4, y /∈ V (L) and
x, y ∈ U if 3 ∈ {m, m′} (if 3 ∈ {m, m′} then apply Lemma 7(i), otherwise apply Lemma 7(iii)).
Performing an (x, y)-switch results in a repacking of P whose reduced leave is a 2-chain with

9

link vertex in W if 3 ∈ {m, m′}, and the result follows by Lemma 11. So the result holds for
s = 2 and it is suﬃcient to show, for each integer s′ ≥ 3, that if the result holds for s = s′ − 1
then it holds for s = s′.
Case 1. Suppose that L is a good s′-chain. By Lemma 13 we can obtain a repacking of P
with a reduced leave whose only component is a good s′-chain with a decomposition into paths
of length m and m′ whose end vertices are twin. Let [x0, x1, . . . , xm] be the path of length m
and let P ′ be the repacking of P obtained by performing the (x0, xm)-switch with origin x1.

If the terminus of the switch is not xm−1, then the reduced leave of P ′ is the edge-disjoint
union of an m-cycle and an m′-cycle and we are done. If the terminus of the switch is xm−1,
then the reduced leave of P ′ is a good (s′ − 1)-ring that contains exactly one pure edge and the
result follows by our inductive hypothesis.
Case 2. Suppose that L is a good s′-ring. Let A be the ring cycle of L that contains the pure
edge in L and note that if s′ is odd then both link vertices of A are in W . Let x and y be twin
vertices in KU ∪W − KU such that x is a link vertex in A, x ∈ U if s′ is even, and y /∈ V (L).
Such a vertex y exists by Lemma 7(ii) because m + m′ ≤ min(2|U| + 3, 2|W | + 1, |U| + |W |),
W contains two vertices of degree 4 in L if s′ is odd, and U contains two vertices of degree 4
in L if s′ is even (for then s′ ≥ 4). Let P ′ be the repacking of P obtained by performing an
(x, y)-switch with origin in A. If the terminus of this switch is also in A, then the reduced leave
of P ′ is a good s′-chain and we can proceed as in Case 1. Otherwise, the reduced leave of P ′ is
a good (s′ − 1)-ring and the result follows by our inductive hypothesis.

Lemma 15. Let U and W be disjoint sets with |U| odd and |W | even, and let M be a list
of integers. Let m, m′, k and t be positive integers such that m, m′ ≥ max(k + t − 1, 3),
m + m′ ≤ min(2|U| + 3, 2|W | + 1, |U| + |W |), and m + m′ ≤ 2|U| + 1 if 3 ∈ {m, m′}. Suppose
there exists an (M)-packing P of KU ∪W − KU with a reduced leave L of size m + m′ such that
L contains exactly one pure edge and L has exactly k components, k − 1 of which are cycles
and one of which is a good t-chain that, if 3 ∈ {m, m′}, is not a 2-chain with link vertex in U.
Then there exists a repacking of P whose reduced leave is the edge-disjoint union of an m-cycle
and an m′-cycle.

Proof. First note that, since L contains exactly one pure edge and L has a decomposition into
cycles, m + m′ is odd. Without loss of generality let m be odd and m′ be even.

By Lemma 14 it is suﬃcient to show that we can construct a repacking of P whose reduced
leave is a good s-chain for some s ∈ {2, . . . , k + t − 1} and is not a 2-chain with link vertex in U
if m = 3. If k = 1, then we are ﬁnished, so we can assume k ≥ 2. By induction on k, it suﬃces
to show that there is a repacking of P with a reduced leave with exactly k − 1 components, one
of which is a good t′-chain for t′ ∈ {t, t + 1} and the remainder of which are cycles.

Let H be the component of L which is a good t-chain, and let C be a component of L such
that C is a cycle and C contains the pure edge if H does not. Let H1 and Ht be the end cycles
of H where H1 contains the pure edge if H does and the link vertex of H1 is in W if t ≥ 3.
Case 1. Suppose that either t ≥ 3 or it is the case that t = 2, H1 contains a pure edge and
the link vertex of H is in W . Then let x and y be vertices such that x ∈ V (Ht), x is not a link
vertex of H, y ∈ V (C), x, y ∈ W if t is odd, and x, y ∈ U if t is even. Let P ′ be a repacking
of P obtained by performing an (x, y)-switch with origin in Ht. The reduced leave of P ′ has
exactly k − 1 components, k − 2 of which are cycles and one of which is a good t′-chain, where
t′ = t + 1 if the terminus of the switch is also in Ht and t′ = t otherwise. So we are ﬁnished by
our inductive hypothesis.

10

Case 2. Suppose that t = 2 and H contains no pure edge. Then C contains the pure edge.
Let x1 and x2 be vertices such that x1 ∈ V (C) ∩ W , x2 ∈ V (H1) ∩ W , and x2 is not the link
vertex of H. Let P ′ be a repacking of P obtained by performing an (x1, x2)-switch with origin
in H1 and let L′ be the reduced leave of P ′. If the terminus of this switch is in C, then L′ has
exactly k − 1 components, k − 2 of which are cycles and one of which is a 2-chain. In this case
we are ﬁnished by our inductive hypothesis. Otherwise the terminus of this switch is in H1 and
L′ has exactly k − 1 components, k − 2 of which are cycles and one of which is a 3-chain H ′
such that one end cycle of H ′ contains a pure edge and has its link vertex in W . If H ′ is good,
then we are again ﬁnished by our inductive hypothesis. Otherwise, it must be that both link
vertices of H ′ are in W and we proceed as follows.

Let H ′

1 and H ′

3 be the end cycles of H ′ where H ′

1 has the pure edge. Let y1, y2 ∈ W be
vertices such that y1 is the link vertex in H ′
3 and y2 /∈ V (L′) (note that y2 exists by Lemma 7(ii)).
Let P ′′ be a repacking of P ′ obtained by performing a (y1, y2)-switch with origin in H ′
3 and let
3, then L′′ has exactly
L′′ be the reduced leave of P ′′. If the terminus of this switch is not in H ′
k − 1 components, k − 2 of which are cycles and one of which is a 2-chain. In this case we are
ﬁnished by our inductive hypothesis. Otherwise, the terminus of this switch is in H ′
3 and L′′
has exactly k components, k − 1 of which are cycles and one of which is a 2-chain that contains
a pure edge and has its link vertex in W . In this case we can proceed as we did in Case 1.
Case 3. Suppose that t = 2, H1 contains the pure edge and the link vertex of H is in U.
Let x be the link vertex of H and let y be a vertex in V (C) ∩ U. Let P ′ be a repacking of P
obtained by performing an (x, y)-switch with origin in H2 and let L′ be the reduced leave of
P ′. If the terminus of this switch is in C or H1, then L′ has exactly k − 1 components, k − 2
of which are cycles and one of which is a 2-chain. In this case we are ﬁnished by our inductive
hypothesis. Otherwise the terminus of this switch is in H2 and L′ has exactly k components,
k − 1 of which are cycles and one of which is a 2-chain that contains no pure edges. In this
case we can proceed as we did in Case 2.

3.2 Proof of Lemma 3

Here we use Lemmas 5, 8 and 15 to prove Lemma 3. We ﬁrst require two more simple results.
Lemma 16 is an easy bound on the maximum number of components in the reduced leave of a
packing, and Lemma 17 allows us to ﬁnd a repacking whose reduced leave is a vertex-disjoint
union of a single 2-chain and a collection of cycles.

Lemma 16. Let U and W be disjoint sets with |U| odd and |W | even. If G is a subgraph of
KU ∪W − KU such that G contains µ pure edges, G has one vertex of degree 4, and each other

vertex of G has degree 2, then G has at most (cid:4) 1

4(|E(G)| + µ)(cid:5) − 1 components.

Proof. Because each vertex of G has even degree, G has a decomposition D into cycles. Since
there are µ pure edges in G, at most µ cycles in D have length 3 and each other cycle in D

has length at least 4. Thus |E(G)| ≥ 4(|D| − µ) + 3µ which implies |D| ≤ (cid:4) 1

least one component of G contains a vertex of degree 4 and hence contains at least two cycles,
and each component of G contains at least one cycle. The result follows.

4(|E(G)| + µ)(cid:5). At

We will use the following notation in Lemma 17 and in the proof of Lemma 3. For an

(M)-packing P of a graph G we deﬁne

d(P) =

1

2 Xx∈V (L)

(degL(x) − 2),

11

where L is the reduced leave of P.

Lemma 17. Let U and W be disjoint sets with |U| odd and |W | even, let M be a list of integers,
and let µ ∈ {1, 2}. Suppose there exists an (M)-packing P of KU ∪W − KU with a reduced leave
L such that |E(L)| ≤ min(2(|U| + 2), 2|W | + 1, |U| + |W |), L has k components, L has exactly µ
pure edges, and L has at least one vertex of degree at least 4. Then there exists a repacking P ′ of
P with a reduced leave L′ such that exactly one vertex x′ of L′ has degree 4, every other vertex of
L′ has degree 2, and L′ has at most k + d(P) − 1 components. Furthermore if |E(L)| ≤ 2|U| + 2
and there is a vertex in W with degree at least 4 in L, then x′ is in W .

Proof. The proof is by induction on d(P). Because L has at least one vertex of degree at least
4, d(P) ≥ 1. If d(P) = 1, then we are ﬁnished immediately because one vertex of L has degree
4 and every other vertex has degree 2. So suppose that d(P) ≥ 2 and hence that L contains
either at least two vertices of degree 4 or at least one vertex of degree at least 6.

Let P ′′ be the repacking of P obtained by applying Lemma 6 with y and z chosen to be
vertices in U ∪ W such that degL(y) ≥ 4, z /∈ V (L), y, z ∈ U if such vertices exist in U, and
y, z ∈ W otherwise. These choices for y and z exist by Lemma 7(iii), and by Lemma 7(i)
they will be in U unless |E(L)| > 2|U| + 2 or degL(x) = 2 for all x ∈ V (L) ∩ U. Note that
d(P ′′) = d(P) − 1 and the reduced leave of P ′′ has at most k + 1 components. Thus we can
complete the proof by applying our inductive hypothesis.

Proof of Lemma 3. Note ﬁrst that m1 + m2 + h ≡ µ (mod 2).
follows by Lemma 5. So suppose µ ∈ {1, 2}.

If µ = 0, then the result

Let U and W be disjoint sets of sizes u and w and let P be a packing of KU ∪W −KU satisfying
the hypotheses of the lemma. Let L be the reduced leave of P and let k be the number of
components of L (note that k ≤ 3). Below we will sometimes wish to apply Lemma 8 or 15
with m = h and m′ = m1 + m2. Accordingly, we note that if h = 3 then m1 + m2 + h ≤ 2u + µ
because m1 + m2 ≤ 3h, m1 + m2 + h ≡ µ (mod 2) and u ≥ 5. We also note that if µ = 2 then
m1 + m2 + h ≤ 2w because m1 + m2 + h ≡ µ (mod 2).

Let C1, C2 and H be edge-disjoint cycles in L such that V (H) = h and |V (C1)| + |V (C2)| =

m1 + m2 (we do not assume that |V (C1)| = m1 and |V (C2)| = m2).
Case 1. Suppose that k = 3. Then the components of L are C1, C2 and H. Let x and y be
vertices such that x ∈ V (C1) ∩ W and y ∈ V (C2) ∩ W . By performing an (x, y)-switch we
obtain a repacking of P whose reduced leave is either the edge-disjoint union of an h-cycle and
an (m1 + m2)-cycle or the vertex-disjoint union of an h-cycle and a 2-chain of size m1 + m2 with
link vertex in W . In the former case we are ﬁnished and in the latter case we apply Lemma 8
(if µ = 2) or Lemma 15 (if µ = 1) with m = h and m′ = m1 + m2.
Case 2. Suppose that k ∈ {1, 2}, that (k, d(P)) 6= (1, m1 + m2) and that W contains a vertex
of degree at least 4 in L if h = 3. Note that L must have a vertex of degree at least 4. Applying
Lemma 17 to P, we see that there is a repacking of P whose reduced leave L′ is the vertex-
disjoint union of a 2-chain and k′ − 1 cycles for some k′ ≤ k + d(P) − 1. Furthermore, the link
vertex of the 2-chain is in W if h = 3. If we can show that h, m1 + m2 ≥ k′ + 1, then we can
complete the proof by applying Lemma 8 or Lemma 15 with m = h and m′ = m1 + m2.
Case 2a. Suppose further that h ≤ m1 + m2. Then it is suﬃcient to show that h ≥ k′ + 1. By
Lemma 16, k′+1 ≤ ⌊ m1+m2+h+µ
⌋ ≤ h.
4
So h ≥ k′ + 1 as required.

⌋. Because m1 +m2 ≤ 3h and µ ≤ 2, we have ⌊ m1+m2+h+µ

4

12

Case 2b. Suppose further that h > m1+m2. Then it is suﬃcient to show that m1+m2 ≥ k′+1.
If k = 2 then d(P) ≤ max(m1, m2) and if k = 1 then d(P) ≤ m1 + m2. So, because we have
assumed that (k, d(P)) 6= (1, m1 + m2), we have k + d(P) ≤ m1 + m2. Thus m1 + m2 ≥
k + d(P) ≥ k′ + 1 as required.
Case 3. Suppose that (k, d(P)) = (1, m1 + m2). Then W contains more than one vertex of
degree at least 4 in L. Also L has no cut vertex because L has h vertices and contains an
h-cycle.

Let x and y be twin vertices in KU ∪W − KU such that degL(x) ≥ 4 and y /∈ V (L) (such
vertices exist by Lemma 7(iii)). Then let P ∗ be a repacking of P obtained by performing an
(x, y)-switch and let k∗ be the number of components in the reduced leave of P ∗. Note that
k∗ = 1 because L has no cut vertex and d(P ∗) = d(P) − 1 = m1 + m2 − 1. Now we can
proceed as we did in Case 2 (note that our argument in Case 2 did not depend upon L being
the edge-disjoint union of an h-cycle, an m1-cycle and an m2-cycle).
Case 4. Suppose that k ∈ {1, 2}, h = 3 and that each vertex in V (L) ∩ W has degree 2
in L. Then m1 + m2 ≤ 9 and it must be that m1 = m2 = 4 if µ = 1 and {m1, m2} ∈
{{3, 4}, {3, 6}, {5, 4}} if µ = 2.
Case 4a. Suppose further that C1 and C2 are vertex disjoint. Let x ∈ V (C1) ∩ W and
y ∈ V (C2) ∩ W , and let P ′ be the repacking of P ∪ {H} obtained by performing an (x, y)-
switch with origin in C1. If the terminus of this switch is in C2, then the reduced leave of P ′ is
an (m1 + m2)-cycle and we can remove from P ′ a 3-cycle that contains exactly one pure edge
to complete the proof. If the terminus of this switch is in C1, then the reduced leave of P ′ is
an (m1, m2)-chain with link vertex in W and we can remove from P ′ a 3-cycle that contains
exactly one pure edge and then proceed as in Case 2.
Case 4b. Suppose further that C1 and C2 share at least one vertex (in U). By applying Lemma
6 once or twice to P ∪ {H}, we can obtain a repacking P ′ of P ∪ {H} whose reduced leave L′ is
2-regular. Note that L′ is either an (m1 + m2)-cycle or the vertex-disjoint union of two cycles
whose lengths add to m1 + m2. In either case we remove from P ′ a 3-cycle H ′ that contains
one exactly pure edge. In the former case we are ﬁnished immediately and in the latter case
we can proceed as in Case 1, 2 or 4a, depending on V (L′) ∩ V (H ′). (If V (L′) ∩ V (H ′) = ∅ then
proceed as in Case 1, if W contains a vertex of degree 4 in L′ ∪ H ′ then proceed as in Case 2,
and otherwise proceed as in Case 4a.)

We conclude this section with the following result which will be used in the proof of

Lemma 34 to obtain two cycles from a leave with a vertex of degree at least 4.

Lemma 18. Let U and W be disjoint sets with |U| odd and |W | even, let M be a list of
integers, and let µ ∈ {1, 2}. Let m and m′ be positive integers such that m is odd, m, m′ ≥
max(⌊ 1
4(m + m′) + µ⌋, 3), m + m′ ≤ min(2|U| + 4, 2|W | + 1, |U| + |W |), and m + m′ ≤ 2(|U| + 1)
if 3 ∈ {m, m′}. Suppose there exists an (M)-packing P of KU ∪W − KU with a reduced leave L
of size m + m′ such that L has exactly µ pure edges, L has at least one vertex of degree at least
4 and, if 3 ∈ {m, m′}, there is a vertex of degree at least 4 in V (L) ∩ W . Then there exists a
repacking of P whose reduced leave is the edge-disjoint union of an m-cycle and an m′-cycle.

Proof. Note that m + m′ ≡ µ (mod 2). The proof splits into two cases.
Case 1. Suppose that L has exactly one vertex x of degree 4 and every other vertex of L
has degree 2. Note that, by the hypotheses of the lemma, x is in V (L) ∩ W if 3 ∈ {m, m′}.
Then L is the vertex-disjoint union of a 2-chain and k − 1 cycles, where k is the number of

13

4(m + m′) + µ⌋ − 1 by Lemma 16.)

components in L. So the result follows by Lemma 15 (if µ = 1) or Lemma 8 (if µ = 2). (Note
that m, m′ ≥ k + 1 since k ≤ ⌊ 1
Case 2. Suppose that L has at least two vertices of degree at least 4, or one vertex of degree
at least 6. Let P ′ be the repacking of P obtained by applying Lemma 17, and let L′ be the
reduced leave of P ′. Then L′ has exactly one vertex of degree 4, every other vertex of L′ has
degree 2, and there is a vertex of degree 4 in V (L) ∩ W if 3 ∈ {m, m′}. We can proceed as in
Case 1.

4 Base Decompositions

(x1, . . . , xn), let P X = Pn

For a nonnegative integer i, let (xi) denote a list of i entries all equal to x. For a list X =
i=1 xi. For a list X and a sublist Y of X, let X \ Y be the list
obtained from X by removing the entries of Y . For a real number x we denote the greatest
even integer less than or equal to x by ⌊x⌋e and the least even integer greater than or equal to
x by ⌈x⌉e. For technical reasons in the remainder of the paper we shall consider a 0-cycle to
be a trivial graph with no vertices or edges. Because we can add any number of 0-cycles to a
packing without altering its leave, we shall not distinguish between packings that diﬀer only in
their number of 0-cycles nor between lists that diﬀer only in their number of 0s.

The aim of this section is to prove Lemmas 28, 29 and 34. These lemmas share a common
form. Under various technical conditions, they guarantee the existence of an (N, 3a, 4b, 5c, 6d, k)-
decomposition of Ku+w −Ku that includes cycles with lengths (3a, 4b, 5c, 6d, k) that each contain
at most one pure edge (where k is even and perhaps 0). In order to prove Theorem 1 we will
then take a base decomposition provided by one of these lemmas and repeatedly apply Lemma 3
to produce a desired (M)-decomposition of Ku+w − Ku. Very roughly speaking, Lemma 28 will
be used when M has few odd entries, Lemma 29 will be used when M has many large entries,
and 34 will be used when M has few large entries.

In essence, Lemmas 29 and 34 are proved as follows. Consider Ku+w − Ku as KU,W ∪ KW ,
where U and W are disjoint sets of sizes u and w. For some entry m of N, we use the main
result of [7] to ﬁnd an (N \ (m))-packing P of KW whose leave L has size a + c + m − t, where
t = uw − (2a + 4b + 4c + 6d), t = 0 if m = 0 and t ∈ {2, . . . , m − 2} if m > 0. We then
use various other results to ﬁnd a (3a, 4b, 5c, 6d, k, m)-decomposition of KU,W ∪ L such that one
cycle of length m contains m − t edges of L and each other cycle contains one edge of L if it
has odd length and no edges of L if it has even length. Lemma 28 is proved similarly except
that we consider Ku+w − Ku as KU \U1,W ∪ KW ∪U1, where U and W are disjoint sets of sizes u
and w and U1 ⊆ U with |U1| = 1.

We will make use of three existing results on cycle decompositions of complete graphs and
complete bipartite graphs. Theorem 19 is the main result of [7], and Theorems 20 and 21 are
special cases of the main results of [12] and [9].

Theorem 19 ([7]). Let v be an integer and let m1, . . . , mτ be a list of integers. There exists
an (m1, . . . , mτ )-decomposition of Kv if and only if v is odd, 3 ≤ mi ≤ v for i ∈ {1, . . . , τ },

a 1-factor with vertex set V (Kv), if and only if v is even, 3 ≤ mi ≤ v for i ∈ {1, . . . , τ }, and

and m1 + · · · + mτ = (cid:0)v
2(cid:1). There exists an (m1, . . . , mτ )-decomposition of Kv − I, where I is
m1 + · · · + mτ = (cid:0)v
2(cid:1) − v
2 .

Theorem 20 ([12]). Let p and q be positive integers such that p and q are even and p ≤ q, and
let m1, . . . , mτ be even integers such that 4 ≤ m1 ≤ m2 ≤ · · · ≤ mτ . If

14

(B1) m1 + · · · + mτ = pq;

(B2) mτ ≤ 3mτ −1; and

(B3) mτ −1 + mτ ≤ 2p + 2 if p < q and mτ −1 + mτ ≤ 2p if p = q;

then there exists an (m1, . . . , mτ )-decomposition of Kp,q.

Theorem 21 ([9]). Let b, d, p and q be positive integers such that p and q are even. There
exists a (4b, 6d)-decomposition of Kp,q if and only if 4b + 6d = pq and either p, q ≥ 4 or d = 0.

The other results in this section are tools that we will use in the proofs of Lemmas 28, 29

and 34.

4.1 Preliminary results

Lemmas 22 and 23 provide cycle packings of the complete bipartite graph whose leaves have
decompositions into two paths of speciﬁed lengths. Lemmas 24, 25 and 26 provide cycle packings
of the union of the complete bipartite graph with one or more cycles. Lemma 27 allows us to
decrease the number of 4-cycles and increase the number of 6-cycles in a packing.

Lemma 22. Let U ′ and W be sets such that |U ′| and |W | are even, let m1, . . . , mτ be even
integers such that 4 ≤ m1 ≤ · · · ≤ mτ ≤ 3mτ −1 and m1 + · · · + mτ = |U ′||W |. If mτ −1 + mτ ≤
2|U ′| when |U ′| = |W | and mτ −1 + mτ ≤ 2 min(|U ′|, |W |) + 2 otherwise, then

(i) for all distinct i, j ∈ {1, . . . , τ } there exists an ((m1, . . . , mτ ) \ (mi, mj))-packing of KU ′,W
whose reduced leave has a decomposition into an mi-path and an mj-path whose end
vertices are in W ; and

(ii) for each i ∈ {1, . . . , τ }, there exists an ((m1, . . . , mτ ) \ (mi))-packing of KU ′,W whose
reduced leave has a decomposition into an (mi − 2)-path and a 2-path whose end vertices
are in W .

Proof. By Theorem 20, there exists an (m1, . . . , mτ )-decomposition D of KU ′,W .

We can remove an mi-cycle from D to obtain the packing required by (ii), so it remains
to prove (i). Let P be a packing of KU ′,W obtained from D by removing an mi-cycle and an
mj-cycle. Assume that mi ≤ mj. Let L be the reduced leave of P. The proof divides into cases
according to whether L is connected.
Case 1. Suppose that L is connected. Then L has at least one and at most mi vertices of
degree 4, and every other vertex of L has degree 2. Furthermore, if L has exactly mi vertices
of degree 4 then L has no cut vertex, since in this case L has exactly mj vertices and contains
an mj-cycle. So it can be seen that, by applying [12, Lemma 3.4] and then [12, Lemma 3.5] to
this packing, we can obtain an ((m1, . . . , mτ ) \ (mi, mj))-packing of KU ′,W with a reduced leave
L′ of size mi + mj such that exactly one vertex of L′ has degree 4, every other vertex of L′ has
degree 2, and L′ has at most mi − 1 components. Then, by applying [12, Lemma 3.2] we can
obtain an ((m1, . . . , mτ ) \ (mi, mj))-packing of KU ′,W whose reduced leave has a decomposition
into an mi-path and an mj-path whose end vertices are in W (note that 4 ≤ mi ≤ mj).
Case 2. Suppose that L is not connected. Then L must consist of two vertex-disjoint cycles.
Let x, y ∈ U ′ such that x and y are in distinct cycles of L. By applying an (x, y)-switch
we obtain an ((m1, . . . , mτ ) \ (mi, mj))-packing of KU ′,W whose reduced leave L′ is either an

15

(mi + mj)-cycle or an (mi, mj)-chain with link vertex in U ′. In either case it is easy to see that
L′ has a decomposition into an mi-path and an mj-path whose end vertices are in W .

Lemma 23. Let U ′ and W be sets such that |U ′| and |W | ≥ 8 are even, and let ℓ and t be
integers such that ℓ ∈ {2, 4, . . . , 12} and t ∈ {6, 8, . . . , |W | − 2}. Let M be a list of integers such
3 ⌉e if
t ≥ 12 and k = 0 if t ≤ 10. If max(k + 2, ℓ, 8) + t ≤ 2|U ′| + 2 and (ℓ, t, |U ′|, |W |) 6= (12, 6, 8, 8),
there exists an (M, k)-packing of KU ′,W whose reduced leave has a decomposition into an ℓ-path
and a t-path whose end vertices are in W .

that m ∈ {4, 6} for all entries m in M and (P M) + k + ℓ + t = |U ′||W |, where k = ⌈ t+2

Proof. If ℓ ∈ {4, 6, . . . , 12}, then apply Lemma 22(i) taking m1, . . . , mτ as the list (M, k, ℓ, t)
reordered to be nondecreasing and (mi, mj) = (ℓ, t). If ℓ = 2, then apply Lemma 22(ii) taking
m1, . . . , mτ as the list (M, k, t+ 2) reordered to be nondecreasing and mi = t+ 2. The condition
that mτ ≤ 3mτ −1 holds by our deﬁnition of k. If |U ′| < |W |, then mτ −1 + mτ ≤ 2|U ′| + 2
holds because max(k + 2, ℓ, 8) + t ≤ 2|U ′| + 2.
If |W | < |U ′|, it is routine to show that
mτ −1 + mτ ≤ 2|W | + 2 holds by considering the cases ℓ = 2 and ℓ ∈ {4, 6, . . . , 12} separately.
Similarly, if |W | = |U ′| then mτ −1 + mτ ≤ 2|W | holds since (ℓ, t, |U ′|, |W |) 6= (12, 6, 8, 8).

Lemma 24. Let U ′ and W be sets with |U ′|, |W | even, and let a, c, m and t be nonnegative
integers such that either

(i) (m, t) = (0, 0) and a + c ∈ {3, . . . , |W |}; or

(ii) t ∈ {2, 4, . . . , ⌊m⌋e − 2} and a + c ∈ {1, . . . , |W | − m + t

2 + 1}.

Suppose there is an (M)-packing P of KU ′,W with a reduced leave L such that degL(x) = 2 for
each x ∈ V (L) ∩ W and L is a union of edge-disjoint paths P0, . . . , Pa+c such that

• P0 has length t, a of the paths P1, . . . , Pa+c have length 2, and the remaining c have length

4;

• there are vertices x0, . . . , xa+c ∈ W such that, for i ∈ {1, . . . , a + c}, the end vertices of

Pi are xi−1 and xi; and

• the end vertices of P0 are x0 and xa+c (if (m, t) = (0, 0), xa+c = x0 and P0 is trivial).

Let C be an (a + c + m − t)-cycle such that V (C) ⊆ W if (m, t) = (0, 0) and V (C) ⊆ W ∪ {α}
for some α /∈ U ′ ∪ W if t > 0 (note that a + c + m − t ∈ {0} ∪ {3, . . . , |W |}). Then there exists
an (M, 3a, 5c, m)-decomposition P ′ of KU ′,W ∪ C that, if m > 0, includes an m-cycle containing
m − t edges of C. Furthermore, if |V (C)| + t−2
2 ≤ |W | − 1 and c ≥ 1, then P ′ includes a 5-cycle
that has exactly one edge of KW and has a vertex in W \ V (C).

Proof. It follows from (i) and (ii) that a + c + m − t ∈ {3, . . . , |W |}. Let C be such an
(a+c+m−t)-cycle. By permuting vertices in P, we can assume that x0x1, x1x2, . . . , xa+c−1xa+c
are consecutive edges in C (note that xa+c = x0 if (m, t) = (0, 0) and that |E(C)| − (a + c) ≥ 2
otherwise) and that no internal vertices of P0 are in V (C). To see that we can do this note that,
if t > 0, then t−2
2 ≤ |W |−1 and c ≥ 1,
we can ensure that some path of length 4 in {P1, . . . , Pa+c} has an internal vertex in W \ V (C).
Let P ′ be the (m − t)-path induced by the edges of C other than x0x1, x1x2, . . . , xa+c−1xa+c (if
(m, t) = (0, 0), then xa+c = x0 and P ′ is trivial). Then {P0∪P ′}∪{Pi∪[xi−1, xi] : i = 1, . . . , a+c}
is a (3a, 5c, m)-decomposition of C ∪ L and the result follows.

2 +(a+c+m−t) ≤ |W | by (ii). Furthermore, if |V (C)|+ t−2

16

Lemma 25. Let U ′ and W be sets such that |U ′| ≥ 2 and |W | ≥ 4 are even. Let a, b, c, d and
m be nonnegative integers such that

(i) d = 0 if |U ′| = 2;

(ii) 2a + 4b + 4c + 6d + t = |U ′||W | where t ∈ {0, 2, 4};

(iii) 2a + 4c + t ≤ 2|W |; and

(iv) either

– (m, t) = (0, 0) and a + c ∈ {0} ∪ {3, . . . , |W |}; or

– t ∈ {2, 4}, m ∈ {t + 2, . . . , |W |} and a + c ∈ {1, . . . , |W | − m + t

2 + 1}.

Let C be an (a + c + m − t)-cycle such that V (C) ⊆ W if t = 0 and V (C) ⊆ W ∪ {α} for
some α /∈ U ′ ∪ W if t > 0 (note that a + c + m − t ∈ {0} ∪ {3, . . . , |W |}). Then there exists
a (3a, 4b, 5c, 6d, m)-decomposition of KU ′,W ∪ C that, if m > 0, includes an m-cycle containing
m − t edges of C.

Proof. If (a, c, m, t) = (0, 0, 0, 0), then the result follows from Theorem 21. Thus, using (iv),
we may assume that a + c + m − t ∈ {3, . . . , |W |} and 2a + 4c + t ≥ 4.

Suppose there exists a (4b, 6d)-packing P ′ of KU ′,W with a reduced leave L′ such that L′ is
connected and degL′(x) = 2 for all x ∈ V (L′) ∩ W . Then |E(L′)| = 2a + 4c + t by (ii). We
claim that in this case L′ has a suitable decomposition into paths so that we can complete the
proof by applying Lemma 24 (with M = (4b, 6d)) to P ′. If |E(L′)| = 4, then (a, c, t) = (1, 0, 2)
and L′ is a 4-cycle and has a suitable decomposition into two 2-paths. If |E(L′)| ≥ 6 then,
because L′ is a connected even graph, it has a closed Eulerian trail. Because L′ is bipartite
and degL′(x) = 2 for all x ∈ V (L′) ∩ W , any subtrail of this trail that begins at a vertex in
V (L′) ∩ W and has length 2 or 4 is a path. Thus, a suitable decomposition of L′ into a 2-paths,
c 4-paths and a t-path exists. So it suﬃces to ﬁnd a (4b, 6d)-packing of KU ′,W with a reduced
leave L′ such that L′ is connected and degL′(x) = 2 for all x ∈ V (L′) ∩ W .

By applying Theorem 21 and removing cycles, we can obtain a (4b, 6d)-packing P ′′ of KU ′,W .
We can do this because |U ′||W |−4b−6d ∈ {0}∪{4, 6, . . . , |U ′||W |} by (ii) and (iv), and because
|U ′||W | − 4b − 6d ≡ 0 (mod 4) when |U ′| = 2 by (i). Let L′′ be the reduced leave of P ′′.
Case 1. Suppose degL′′(x) = 2 for all x ∈ V (L′′) ∩ W . If L′′ is connected then we are done.
Otherwise, let y1, y2 ∈ V (L′′) ∩ U ′ such that y1 is in a largest component of L′′ and y2 is in
another component of L′′. By performing a (y1, y2)-switch with origin adjacent to y2 we obtain
a repacking of P ′′ whose reduced leave has a component larger than any component in L′′. We
can repeat this process until we obtain a repacking of P ′′ whose reduced leave is connected.
Case 2. Suppose degL′′(x) ≥ 4 for some x ∈ V (L′′) ∩ W . By repeatedly applying Lemma 6
we can obtain a repacking of P ′′ whose reduced leave has no vertices of degree greater than 2
in W (note that |E(L′′)| ≤ 2|W | by (iii)). Thus we can proceed as in Case 1 to complete the
proof.

The following is a method for packing 3- and 5-cycles into the complete graph with a hole,

where each cycle has exactly one pure edge.

Lemma 26. Let W be a set of even size w ≥ 6, and let a and c be nonnegative integers such
that a is even and (a, c) 6= (0, 0). Let n and b be the integers such that a + 2c = nw − 2b

17

2 , . . . , w} for i ∈ {2, . . . , n}, ℓ1 ∈ { 1

and 0 ≤ b ≤ w−2
2 , and let U ′ be a set such that U ′ ∩ W = ∅ and |U ′| = 2n. Let ℓ1, . . . , ℓn be
integers such that ℓi ∈ { w
2(w − 2b), . . . , w − 2b} \ {1, 2} and
ℓ1 +· · ·+ℓn = a+c. Then, for any edge-disjoint cycles C1, . . . , Cn in KW with lengths ℓ1, . . . , ℓn,
there exists a (3a, 5c)-packing of KU ′,W ∪C1 ∪· · ·∪Cn whose reduced leave is a subgraph of KU ′,W
isomorphic to K2,2b. Furthermore, if a + 2c 6≡ 2 (mod w), and if c 6≡ 2 (mod w
2 ) when a = 0,
then there do exist such integers ℓ1, . . . , ℓn.

Proof. Suppose ﬁrst that we are given a list ℓ1, . . . , ℓn satisfying our hypotheses. Let U ′ =
{p1, . . . , p2n}. By Lemma 25, there is a (32ℓi−w, 5w−ℓi)-decomposition Di of K{p2i−1,p2i},W ∪ Ci
for i ∈ {2, . . . , n}. Let W1 be a set of size w − 2b such that V (C1) ⊆ W1 ⊆ W . Also by
Lemma 25, there is a (32ℓ1−w+2b, 5w−2b−ℓ1)-decomposition D1 of K{p1,p2},W1 ∪ C1. Using the facts
that nw − 2b = a + 2c and that ℓ1 + · · · + ℓn = a + c, it can be seen that D1 ∪ · · · ∪ Dn is a
(3a, 5c)-packing of KU ′,W ∪ C1 ∪ · · · ∪ Cn. The reduced leave of this packing is K{p1,p2},W \W1,
which is isomorphic to K2,2b.

Now suppose that a + 2c 6≡ 2 (mod w) and that c 6≡ 2 (mod w

2 ) if a = 0. Note that, because
a + 2c = nw − 2b, the former implies that w − 2b 6= 2 and the latter implies that w − 2b 6= 4
if a = 0. Let ℓ1 = w − 2b if a ≥ w − 2b and let ℓ1 = 1
2(w − 2b + a) if a < w − 2b. Then
ℓ1 ∈ { 1
2(w − 2b), . . . , w − 2b} \ {1, 2}. To show that there exist integers ℓ2, . . . , ℓn such that
ℓi ∈ { w
2 , . . . , w} for i ∈ {2, . . . , n} and ℓ2 + · · · + ℓn = a + c − ℓ1, and hence to complete
the proof, it suﬃces to show that w
2 (n − 1) ≤ a + c − ℓ1 ≤ w(n − 1). If a ≥ w − 2b, then
a + c − ℓ1 = a + c − w + 2b and

w

2 (n − 1) = 1

2(a + 2c − w + 2b) ≤ a + c − w + 2b ≤ a + 2c − w + 2b = w(n − 1),

where both equalities follow from a+2c = nw−2b, the ﬁrst inequality follows because a ≥ w−2b
and the second inequality follows because c ≥ 0. If a < w − 2b, then

a + c − ℓ1 = 1

2(a + 2c − w + 2b) = w

2 (n − 1),

where the ﬁrst equality follows because ℓ1 = 1
because a + 2c = nw − 2b.

2(w − 2b + a) and the second equality follows

Lemma 27. Let P = {C1, . . . , Cr, X1, . . . , X3j} be an (M, 43j)-decomposition of an even graph
G where X1, . . . , X3j are 4-cycles. If there is a set S of four vertices in G that are pairwise
twin and pairwise nonadjacent such that |V (Xi) ∩ S| = 2 for i ∈ {1, . . . , 3j}, then there is an
(M, 62j)-decomposition P ′ = {C ′
2j are 6-cycles
and, for each i ∈ {1, . . . , r}, V (C ′
i) = πi(V (Ci)) for some permutation πi of V (G) that ﬁxes
each vertex in V (G) \ S.

2j} of G such that Y ′

1, . . . , Y ′

1, . . . , Y ′

1, . . . , C ′

r, Y ′

1 , Y ⋆

Proof. The result is trivial if j = 0, so we may assume that j ≥ 1. It suﬃces to show there is
an (M, 43j−3, 62)-decomposition P ⋆ of G such that P ⋆ contains two 6-cycles Y ⋆
2 and the
packing P ⋆\{Y ⋆
2 } can be obtained from the packing P \{X3j−2, X3j−1, X3j} via a sequence of
switches on vertices in S. Then by Lemma 4, P ⋆ = {C ⋆
2 } where
1 , . . . , X ⋆
X ⋆
3j−3 are 4-cycles that each contain two vertices in S and, for each i ∈ {1, . . . , r},
C ⋆
i = πi(Ci) for some permutation πi of V (G) that ﬁxes each vertex in V (G) \ S. So the
procedure can be repeated j − 1 further times to complete the proof.

1 and Y ⋆

1 , . . . , X ⋆

1 , . . . , C ⋆

3j−3, Y ⋆

1 , Y ⋆

r , X ⋆

Let L be the reduced leave of P \{X3j−2, X3j−1, X3j} and note that L is an even subgraph of
KS,V (G)\S with exactly 12 edges (we will not make use of the fact that L has a decomposition into

18

three 4-cycles). If L contains a 6-cycle, then L has a (6, 6)-decomposition and adding these two
6-cycles to P\{X3j−2, X3j−1, X3j} produces a decomposition with the required properties. So we
may suppose that L has no 6-cycle but has a (4, 8)-decomposition or a (4, 4, 4)-decomposition.
Case 1. Suppose that no vertex in S has degree 6 in L and that L is connected. It is routine
to check that L contains a path [x0, . . . , x6] of length 6 and a vertex y /∈ {x0, . . . , x6} such that
x0, x6 ∈ S and x0y and x2y are edges in L. By performing the (x0, x6)-switch with origin x1 we
obtain a repacking of P \ {X3j−2, X3j−1, X3j} whose reduced leave has a (6, 6)-decomposition
and we are ﬁnished as above. (Note that if the terminus of the switch is x5 then the reduced
leave contains the 6-cycle (x0, y, x2, . . . , x5), and otherwise it contains the 6-cycle (x1, . . . , x6).)
Case 2. Suppose that no vertex in S has degree 6 in L and that L is disconnected. Then L
is a vertex-disjoint union of a copy of K2,4 and a 4-cycle. Let x, y ∈ S be vertices such that
degL(x) = 4 and degL(y) = 2. By performing an (x, y)-switch whose origin is adjacent to x we
obtain a repacking of P \ {X3j−2, X3j−1, X3j} that satisﬁes the conditions of Case 1 and we can
proceed as we did in that case.
Case 3. Suppose that a vertex in S has degree at least 6 in L. By repeatedly applying
Lemma 6, we can obtain a repacking of P \ {X3j−2, X3j−1, X3j} that satisﬁes the conditions of
either Case 1 or Case 2 and can proceed as we did in those cases (note that each application
of Lemma 6 is simply a switch on vertices in S).

4.2 Lists with few odd entries

Lemma 28. Let u ≥ 5 and w ≥ 8 be integers such that u is odd and w is even. Let N be a list
of integers and let a, b, c and d be nonnegative integers such that the following hold.

(i) (P N) − t + a + c = (cid:0)w+1

2 (cid:1), where t ∈ {0, 2, . . . , w − 2};

(ii) 2a + 4b + 4c + 6d + k + t = (u − 1)w, where k = ⌈ t+2

3 ⌉e if t ≥ 12 and k = 0 otherwise;

(iii) 3 ≤ ℓ ≤ min(u, w) for each entry ℓ in N, and d = 0 if u = 5;

(iv) if t > 0, there is some entry m in N such that m ≥ t + 2; and

(v) either

– a + c ≥ 6, a + 2c ≤ w, and b ≥ 1; or

– a + c = 3, (m, t) 6= (w, 2), and (a, c, t, u, w) 6= (0, 3, 6, 9, 8).

Then there exists an (N, 3a, 4b, 5c, 6d, k)-decomposition of Ku+w − Ku that includes cycles with
lengths (3a, 4b, 5c, 6d, k) that each contain at most one pure edge.

Proof. Let U and W be disjoint sets of sizes u and w and let U1 ⊆ U with |U1| = 1. Observe
that KU ∪W − KU = KU \U1,W ∪ KW ∪U1. Let m = 0 if t = 0. We ﬁrst choose integers a2, a3,
c2 and c3. Let (a3, c3) be the ﬁrst pair from the appropriate row below such that a3 ≤ a and
c3 ≤ c, and let a2 = a − a3 and c2 = c − c3. It is routine to check using (v) that some pair in
the appropriate row will always satisfy these conditions.

19

(a3, c3)
(a, c)

case
a + c = 3
a + c ≥ 6, t > 0, a even (0, 1), (2, 0)
a + c ≥ 6, t > 0, a odd
(1, 0)
a + c ≥ 6, t = 0, a even (0, 0)
a + c ≥ 6, t = 0, a odd

(3, 0), (1, 2)

This choice ensures that a2, a3, c2 and c3 are nonnegative integers such that a2 is even, a2 +a3 =
a, c2 + c3 = c, 2a3 + 4c3 ≤ 12, a3 + c3 ∈ {1, 2, 3} if t > 0, and a3 + c3 ∈ {0, 3} if t = 0.

We now construct packings P1, P2, P3 as follows (we justify that these packings exist later).

• P1 is an (N \ (m))-packing of KW ∪U1. The reduced leave of P1 is C ∗ ∪ C †, where C ∗ is
an (a2 + c2)-cycle such that U1 * V (C ∗) and C † is an (m − t + a3 + c3)-cycle such that
U1 * V (C †) if t = 0.

Let U2 ⊆ U \ U1 with |U2| = 0 if (a2, c2) = (0, 0) and |U2| = 2 otherwise. Let b2 =
1
4 (|U2|w − 2a2 − 4c2). By (v) and the choice of a2 and c2, we have b2 ∈ {0, . . . , w−4

2 }.

• If |U2| = 2, then P2 is a (3a2, 4b2, 5c2)-decomposition of KU2,W ∪ C ∗ and, if b2 > 0, the

union of the 4-cycles in P2 is a copy of K2,2b2. If |U2| = 0, then P2 = ∅.

• P3 is a (3a3, 4b−b2+3j, 5c3, 6d−2j, k, m)-decomposition of KU3,W ∪C †, where U3 = U \(U1∪U2)

and

j = (cid:26) 0

⌈ 1
3 (b2 − b)⌉

if b ≥ b2,
otherwise.

Furthermore, if m > 0, there is an m-cycle in P3 that contains m − t edges of C †.

Note that the union P ′ = P1 ∪ P2 ∪ P3 will be an (N, 3a, 4b+3j, 5c, 6d−2j, k)-decomposition
of KU ∪W − KU and will contain cycles with lengths (3a, 4b+3j, 5c, 6d−2j, k) that each con-
tain at most one pure edge (by the deﬁnition of P3 and C †, P3 has cycles with lengths
(3a3, 4b−b2+3j, 5c3, 6d−2j, k) that each contain at most one pure edge).
If b ≥ b2, then j = 0
and this will complete the proof. Otherwise b2 > b and we will be able to apply Lemma 27 to
P ′ to obtain a decomposition with the required properties provided we can ﬁnd 3j 4-cycles in
P ′ that meet the hypotheses of Lemma 27. If 3j = b2 − b, we will be able to use 3j 4-cycles
from P2. If 3j ∈ {b2 − b + 1, b2 − b + 2}, then b2 ≥ 3j + b − 2 ≥ 3j − 1 (since b ≥ 1) and we will
be able to use 3j − 1 4-cycles from P2 and any one 4-cycle from P3. (It must be the case that
b ≥ 1 by (v) because b2 > b implies (a2, c2) 6= (0, 0) and a + c ≥ 6 by our choices of b2, a2 and
c2.)

So it remains to establish the existence of the packings P1, P2, P3. In what follows we will
often use the facts that w ≥ 8 and that either (m, t) = (0, 0) or t < m ≤ w (the latter follows
from (iv)).
Proof that P1 exists. First observe that a2 + c2 ∈ {0} ∪ {3, . . . , w} and m − t + a3 + c3 ∈
{0} ∪ {3, . . . , w + 1} by (iii), (iv), (v), our choice of a3 and c3 and the deﬁnition of m. Then,
by Theorem 19, a packing with the required properties exists by (iii) and because

P(N \ (m)) + |E(C †)| + |E(C ∗)|
= ((cid:0)w+1
2 (cid:1) + t − (a + c) − m) + (m − t + a3 + c3) + (a2 + c2)
= (cid:0)w+1
2 (cid:1)

20

If t = 0, then |V (C ∗)| + |V (C †)| = a + c ≤ w by
where the ﬁrst equality follows by (i).
(v) and we can permute the vertices of this packing so that U1 * V (C ∗) ∪ V (C †). If t > 0,
then |V (C ∗)| = a2 + c2 ≤ w by (v) and we can permute the vertices of this packing so that
U1 * V (C ∗).
Proof that P2 exists. This is trivial if (a2, c2) = (0, 0) and |U2| = 0, so assume that |U2| = 2
and (a2, c2) 6= (0, 0). Then the deﬁnition of b2 implies that a2 + 2c2 = w − 2b2. So the existence
of P2 follows immediately by Lemma 26 because a2 + c2 ∈ { 1
2(w − 2b2), . . . , w − 2b2} \ {1, 2} by
(v), and our choice of a2 and c2.
Proof that P3 exists. We will show that P3 exists using either Lemma 25 (if t ∈ {0, 2, 4}) or
Lemmas 23 and 24 (if t ≥ 6). Note that |U3| = u − |U2| − 1 ∈ {u − 3, u − 1} and hence |U3| ≥ 4,
except when u = 5 and |U2| = 2. We ﬁrst establish two useful facts.

(a) b − b2 + 3j ≥ 0 and d − 2j ≥ 0. Obviously b − b2 + 3j ≥ 0 by the deﬁnition of j, and
clearly d − 2j ≥ 0 if b ≥ b2 and hence j = 0. So it remains to show that d − 2j ≥ 0 when b < b2.
Then j = ⌈ 1

3 (b2 − b)⌉. Observe that

2a3 + 4b + 4c3 + 6d + k + t = w|U3| + 4b2

(4.1)

by (ii) and the deﬁnitions of a3, c3, b2 and U3. So it cannot be that u = 5 because then b > b2
by (4.1) (since d = 0 by (iii), |U3| ≥ 2, 2a3 + 4c3 ≤ 12 and, by (iii) and (iv), t ≤ 2 and k = 0).
So assume that u ≥ 7 and hence |U3| ≥ 4. Then it follows from (4.1) that d ≥ 2
3 (b2 − b) using
the facts that 2a3 + 4c3 ≤ 12 and k ≤ t ≤ w − 2. So we have d − 2j ≥ 0.

(b) 2a3 + 4(b − b2 + 3j) + 4c3 + 6(d − 2j) + k + t = |U3|w. Observe that

2a3 + 4(b − b2 + 3j) + 4c3 + 6(d − 2j) + k + t
= (2a + 4b + 4c + 6d + k + t) − (2a2 + 4b2 + 4c2)
= |U3|w

where the ﬁnal equality follows by (ii) and because 2a2 + 4b2 + 4c2 = |U2|w by the deﬁnitions
of U2 and b2.

2 + 1} if t ∈ {2, 4} by (v) and our choice of a3 and c3.

Case 1. Suppose that t ∈ {0, 2, 4}. Then k = 0. We claim that P3 exists by Lemma 25.
To see that we can apply Lemma 25, note that |U3| ≥ 2 and that d = 0 if |U3| = 2 by
(iii). Also, using 2a3 + 4c3 ≤ 12, 2a3 + 4c3 + t ≤ 2w. Finally, a3 + c3 ∈ {0, 3} if t = 0 and
a3 + c3 ∈ {1, . . . , w − m + t
Case 2. Suppose that t ≥ 6. Then u ≥ 9 because u ≥ m ≥ 8 by (iii) and (iv). Also,
|U3| ≥ u − 3 ≥ 6. By Lemma 24, to show that P3 exists it suﬃces to ﬁnd a (4b−b2+3j, 6d−2j, k)-
packing of KU3,W whose reduced leave has a decomposition into a t-path and a (2a3 + 4c3)-path
with end vertices in W (note that 1 ≤ a3 + c3 ≤ 3 ≤ w − m + t
2 + 1). By Lemma 23,
to ﬁnd such a packing it suﬃces to show that max(k + 2, 2a3 + 4c3, 8) + t ≤ 2|U3| + 2 and
(2a3 + 4c3, t, |U3|, w) 6= (12, 6, 8, 8) (note that 2a3 + 4c3 ∈ {2, 4, . . . , 12}). We have max(k +
2, 8) + t ≤ 2|U3| + 2 because t ≤ u − 3 (by (iii) and (iv)), k ≤ t+7
3 and |U3| ≥ u − 3. We
have 2a3 + 4c3 + t ≤ 2|U3| + 2 because t ≤ u − 3, 2a3 + 4c3 ≤ 12 and either 2a3 + 4c3 ≤ 6 or
|U3| = u − 1 (by our choice of a3 and c3 and the deﬁnitions of U2 and U3). It follows directly
from (v) that (2a3 + 4c3, t, |U3|, |W |) 6= (12, 6, 8, 8).

21

4.3 Lists with many large entries

Lemma 29. Let u ≥ 7 and w ≥ 8 be integers such that u is odd and w is even. Let N be a list
of integers and let a, b, c and d be nonnegative integers such that the following conditions hold.

(i) (P N) − t + a + c = (cid:0)w

2(cid:1), where t ∈ {2, 4, . . . , w − 2};

(ii) 2a + 4b + 4c + 6d + k + t = uw, where k = ⌈ t+2

3 ⌉e if t ≥ 12 and k = 0 otherwise;

(iii) 3 ≤ ℓ ≤ min(u, w) for each entry ℓ in N;

(iv) a ≥ w

2 + 1, b ≥ 1 and c ≤ 1;

(v) there is some entry m ≥ max(t + 2, 7) in N such that uw ≥ (a + c)⌊m⌋e if a + 2c > 3w

2 + 3;

(vi) (m, t) 6= (w, 2), and if a ≥ w

2 + 4, (m, t) /∈ {(w − 1, 2), (w, 4)}.

Then there exists an (N, 3a, 4b, 5c, 6d, k)-decomposition of Ku+w − Ku that includes cycles with
lengths (3a, 4b, 5c, 6d, k) that each contain at most one pure edge.

Proof. Let U and W be disjoint sets of sizes u and w and observe that KU ∪W − KU =
KU,W ∪ KW . We ﬁrst choose integers a2, a3, c2 and c3. Let (a3, c3) be the ﬁrst pair from the
appropriate row below such that a3 ≤ a, c3 ≤ c, and a2 +2c2 6≡ 2 (mod w) where a2 = a− w
2 −a3
and c2 = c − c3. It is routine to check using (iv) that some pair in the appropriate row will
always satisfy these conditions.

case
a − w
a − w

(a3, c3)

2 even (0, 1), (2, 0), (2, 1), (4, 0)
2 odd

(1, 0), (1, 1), (3, 0)

This choice ensures that a2, a3, c2 and c3 are nonnegative integers such that a2 is even, w
a2 + a3 = a, c2 + c3 = c, a3 + c3 ∈ {1, 2, 3, 4}, and 2a3 + 4c3 ≤ 8.

2 +

We now construct packings P0, . . . , P3 as follows (we justify that these packings exist later).

• P0 is an (N \ (m))-packing of KW − I, where I is a 1-factor on vertex set W . The reduced

leave of P0 is a union of cycles C † ∪ C1 ∪ · · · ∪ Cn, where

– n and b2 are the nonnegative integers such that a2 +2c2 = nw −2b2 and 0 ≤ b2 ≤ w−4
2

(note that a2 + 2c2 6≡ 2 (mod w));

– C † is an (m − t + a3 + c3)-cycle;
– if a2 + c2 > 0, |V (Ci)| ∈ { w

2 , . . . , w} for 2 ≤ i ≤ n, and |V (C1)| ∈ { 1

2(w − b2), . . . , w −

b2} \ {1, 2};

– |V (C1)| + · · · + |V (Cn)| = a2 + c2.

The cycle lengths |V (C1)|, . . . , |V (Cn)| exist by Lemma 26, noting that c2 ≤ 1 by (iv),
that a2 is even, and that a2 + 2c2 6≡ 2 (mod w).

• P1 is a (3w/2)-decomposition of KU1,W ∪ I for some U1 ⊆ U with |U1| = 1.

• P2 is a (3a2, 4b2, 5c2)-decomposition of KU2,W ∪ C1 ∪ · · · ∪ Cn, where U2 ⊆ U \ U1 with

|U2| = 2n and, if b2 > 0, the union of the 4-cycles in P2 is a copy of K2,2b2.

22

• P3 is a (3a3, 4b−b2+3j, 5c3, 6d−2j, k, m)-decomposition of KU3,W ∪C †, where U3 = U \(U1∪U2)

and

j = (cid:26) 0

⌈ 1
3 (b2 − b)⌉

if b ≥ b2,
otherwise.

Furthermore, if m > 0, there is an m-cycle in P3 that contains m − t edges of C †.

Note that the union P ′ = P0 ∪ · · · ∪ P3 will be an (N, 3a, 4b+3j, 5c, 6d−2j, k)-decomposition
of KU ∪W − KU and will contain cycles with lengths (3a, 4b+3j, 5c, 6d−2j, k) that each con-
tain at most one pure edge (by the deﬁnition of P3 and C †, P3 has cycles with lengths
(3a3, 4b−b2+3j, 5c3, 6d−2j, k) that each contain at most one pure edge).
If b ≥ b2, then j = 0
and this will complete the proof. Otherwise b2 > b and we will be able to apply Lemma 27 to
P ′ to obtain a decomposition with the required properties provided we can ﬁnd 3j 4-cycles in
P ′ that meet the hypotheses of Lemma 27. If 3j = b2 − b, then b2 ≥ 3j and we will be able to
use 3j 4-cycles from P2. If 3j ∈ {b2 − b + 1, b2 − b + 2}, then b2 ≥ 3j − 1 because b ≥ 1 by (iv)
and we will be able to use 3j − 1 4-cycles from P2 and any one 4-cycle from P3.

So it remains to establish the existence of the packings P0, . . . , P3. Obviously P1 exists.

Proof that P0 exists. First observe that m − t + a3 + c3 ∈ {3, . . . , w} by (iii), (v), (vi) and
our choices of a3 and c3. Then, by Theorem 19, a packing with the required properties exists
by (iii) and because

P(N \ (m)) + |E(C †)| + |E(C1)| + · · · + |E(Cn)|
= ((cid:0)w
2(cid:1) + t − (a + c) − m) + (m − t + a3 + c3) + (a2 + c2)
= (cid:0)w
2(cid:1) − w
2 .

2 = a and c2 + c3 = c.

The ﬁrst equality follows by (i) and the deﬁnitions of C † and C1, . . . , Cn. The second equality
follows because a2 + a3 + w
Proof that P2 exists. This is trivial if (a2, c2) = (0, 0).
immediately by Lemma 26 because |V (Ci)| ∈ { w
b2), . . . , w − b2} \ {1, 2} and |V (C1)| + · · · + |V (Cn)| = a2 + c2.
Proof that P3 exists. We will show that P3 exists using either Lemma 25 (if t ∈ {2, 4})
or Lemmas 23 and 24 (if t ≥ 6). We ﬁrst establish some useful facts. Recall that |E(C †)| =
m − t + a3 + c3 and note that m > t.

If (a2, c2) 6= 0, then this follows
2(w −

2 , . . . , w} for 2 ≤ i ≤ n, |V (C1)| ∈ { 1

(a) b − b2 + 3j ≥ 0 and d − 2j ≥ 0. Obviously b − b2 + 3j ≥ 0 by the deﬁnition of j and we
can establish that d − 2j ≥ 0 by a similar argument to the one used in the proof of Lemma 28.

(b) 2a3 + 4(b − b2 + 3j) + 4c3 + 6(d − 2j) + k + t = w|U3|. Observe that

2a3 + 4(b − b2 + 3j) + 4c3 + 6(d − 2j) + k + t

2 ) + 4(b − b2) + 4(c − c2) + 6d + k + t

= 2(a − a2 − w
= (2a + 4b + 4c + 6d + k + t) − (2a2 + 4b2 + 4c2) − w
= w|U3|.

The ﬁrst equality follows because a2 + a3 + w
2 = a and c2 + c3 = c. The ﬁnal equality follows
because 2a + 4b + 4c + 6d + k + t = uw by (ii), 2a2 + 4b2 + 4c2 = w|U2| by the deﬁnition of U2,
and |U3| = u − |U2| − 1.

23

(c) |U3| ≥ 4. Recall |U3| = u − 2n − 1. If n ≤ 1, then |U3| ≥ 4 because u ≥ 7. So suppose
n ≥ 2. By the deﬁnition of n, this implies that a2 + 2c2 ≥ w + 4 and hence that a + 2c ≥ 3w
2 + 4
because a ≥ a2 + w

2 and c ≥ c2. Thus, using (v),

uw ≥ (a + c)⌊m⌋e ≥ ( w

2 + a2 + c2)⌊m⌋e.

Now 2a2 + 4c2 + 4b2 = 2nw by the deﬁnitions of n and b2, and hence a2 + c2 = nw − 2b2 − c2.
Observe that c2 ≤ 1 by (iv) and so a2 + c2 ≥ nw − 2b2 − 1. Using this fact, we have uw ≥
((n + 1

2)w − 2b2 − 1)⌊m⌋e. Rearranging yields

u − 2n − 1 ≥ (n + 1

2)(⌊m⌋e − 2) − 1

w (2b2 + 1)⌊m⌋e.

Because b2 ≤ w−4

2 and hence 1

w (2b2 + 1) < 1, we see that

u − 2n − 1 > (n − 1

2)(⌊m⌋e − 2) − 2.

(4.2)

So because n ≥ 2 and ⌊m⌋e ≥ 6 by (v), we have |U3| = u − 2n − 1 ≥ 4.

2 + 4 if a3 + c3 = 4).

Case 1. Suppose that t ∈ {2, 4}. Then k = 0. So P3 exists by Lemma 25 because |U3| ≥ 4,
a3 + c3 ∈ {1, 2, 3, 4}, 2a3 + 4c3 ≤ 8, and w − m + t
2 + 1 ≥ a3 + c3 by (vi) (by our choice of a3
and c3, a ≥ w
Case 2. Suppose that t ≥ 6. Then u ≥ 9 because u ≥ m ≥ 8 by (iii) and (v). By Lemma 24,
to show that P3 exists it suﬃces to ﬁnd a (4b−b2+3j, 6d−2j, k)-packing of KU3,W whose reduced
leave has a decomposition into a t-path and a (2a3 + 4c3)-path (note that a3 + c3 ∈ {1, 2, 3, 4}).
Noting that 2a3 + 4c3 ≤ 8, by Lemma 23, to ﬁnd such a packing it suﬃces to show that
max(k + 2, 8) + t ≤ 2|U3| + 2. Note that 2|U3| + 2 = 2u − 4n. If n ∈ {0, 1}, this holds because
u ≥ 9, k ≤ t+7

3 , and t ≤ u − 3 by (iii) and (v). So suppose that n ≥ 2. We have

2u − 4n > (2n − 1)(⌊m⌋e − 2) − 2 ≥ 3t − 2,

where the ﬁrst inequality follows by multiplying (4.2) by 2, and the second holds because n ≥ 2
and ⌊m⌋e ≥ t + 2 by (v). Thus max(k + 2, 8) + t ≤ 2u − 4n holds because t ≥ 6 and k ≤ t+7
3 .

4.4 Lists with few large entries

Lemma 34 is the most intricate of our base decomposition lemmas and requires some more
preliminary results. Lemma 30 is an edge-colouring result that is easily obtained by combining
a theorem of Fournier [11] with the well-known result that any graph with chromatic index at
most ℓ has a proper edge-colouring with ℓ colours such that the sizes of any two colour classes
diﬀer by at most one (see [16]). Lemma 31 will allow us to decompose the union of K3,w and
a graph on the part of size w whose vertices have odd degrees. This is useful when a is small.
Lemmas 32 and 33 are more results giving cycle packings of the union of a complete bipartite
graph with one or more cycles. The hypotheses of Lemmas 32 and 33 both concern the quantity
ρ = 2a + 4c + t. This is the number of edges of KU,W that will be used in the m-cycle that
contains m − t edges of KW , and the a 3-cycles and c 5-cycles that each contain one edge of
KW .

Lemma 30 ([11, 16]). Let G be a graph with maximum degree ℓ. If the subgraph of G induced
by the vertices of degree ℓ contains no cycle, then G has a proper edge-colouring with ℓ colours
such that the sizes of any two colour classes diﬀer by at most one.

24

Lemma 31. Let G be a graph with vertex set W such that |E(G)| = ⌈ 3
4 |W |⌉ and each vertex
of G has degree 1 or 3. Let {p1, p2, p3} be a set of three vertices not in W and let αβ be an
edge of G. Then there exists a (5⌊3|W |/4⌋)-packing P of K{p1,p2,p3},W ∪ G such that each cycle in
P contains exactly one edge from G and

• if |W | ≡ 0 (mod 4), then the reduced leave of P is empty;

• if |W | ≡ 2 (mod 4), then the reduced leave of P is the 3-cycle (p3, α, β).

Proof. Let w = |W |. Let B = {x ∈ W : degG(x) = 3} and note that |B| = ⌈ 3w
Case 1. Suppose that w ≡ 0 (mod 4). Then |E(G)| = 3w
4 . Let E = E(G) and let W ′ = {ve :
e ∈ E} be a set of |E| vertices disjoint from W ∪ {p1, p2, p3}. Let H be the graph obtained
from G by adding the vertices in W ′ and then replacing each edge yz ∈ E with the two edges
yvyz and zvyz.

4 ⌉ − w
2 .

Note that the maximum degree of H is 3, no two vertices of degree 3 are adjacent in H,
and |E(H)| = 3w
2 . So by Lemma 30 there exists a proper 3-edge colouring γ of H with colour
set {1, 2, 3} such that |γ−1(i)| = 1
2 for i ∈ {1, 2, 3}. For each vertex x ∈ V (H) we
denote by γ(x) the set of colours assigned by γ to the edges incident with x. For i ∈ {1, 2, 3},
let W ′
i = {x ∈ V (H) : γ(x) = {1, 2, 3} \ {i}} and Ai = {x ∈ W : γ(x) = {i}}. Let
A = {x ∈ W : degG(x) = 1}.

3 |E(H)| = w

We shall show that there is a bijection f : W ′ → A such that f (W ′

i ) = Ai for each

i ∈ {1, 2, 3}. Then

P = {(pγ(yvyz), y, z, pγ(zvyz), f (vyz)) : yz ∈ E}

will form a packing of K{p1,p2,p3},W ∪ G with |E| 5-cycles, each of which contains four edges of
K{p1,p2,p3},W and one edge in E. Thus the reduced leave of P will be empty. So it suﬃces to show
that such a bijection f exists, and hence it suﬃces to show that |W ′

i | = |Ai| for i ∈ {1, 2, 3}.

i | + |W ′

Obviously |W ′

1| + |W ′

2| + |W ′

3| = 1

3|E| = w

1| = |W ′

2| = |W ′

3| = |E|. Because each edge of H is incident with exactly one
vertex in W ′, we have |γ−1(k)| = |W ′
j| for {i, j, k} = {1, 2, 3}. So, because the colour
classes of γ have equal size, it follows that |W ′
4 . Furthermore,
for any {i, j, k} = {1, 2, 3}, we have 2|γ−1(i)| = |Ai| + |W ′
k| + |B| by considering the
total degree of the graph induced by the colour class γ−1(i). Solving for |Ai|, it follows that
|A1| = |A2| = |A3| = 1
Case 2. Suppose that w ≡ 2 (mod 4). Then |E(G)| = 3w+2
. The proof proceeds as in Case
1 with the following exceptions. We let E = E(G) \ {αβ}, so that |E| = 3w−2
and again
|E(H)| = 3w
2 . At most one pair of vertices of degree 3 are adjacent in H, so Lemma 30 can still
be applied and again each colour class of γ has size w
2 . We may assume without loss of generality
that γ(αβ) = 3. The reduced leave of the packing P will be the 3-cycle {p3, α, β}. Because
2| = w−2
each edge of H except αβ is incident with exactly one vertex in W ′, we ﬁnd |W ′
4
and |W ′

4 . We deduce that |A1| = |A2| = w−2

4 and |A3| = w+2
4 .

3|A| = w
4 .

j| + |W ′

4

4

1| = |W ′

3| = w+2

Lemma 32. Let U ′ and W be sets such that |U ′| ≥ 2 and |W | ≥ 6 are even, let (m, t) ∈
{(0, 0), (4, 2), (5, 2), (6, 2), (6, 4)}, let a, b, c and d be nonnegative integers, and let ρ = 2a+4c+t.
Suppose that

(i) d = 0 if |U ′| = 2;

(ii) ρ + 4b + 6d = |U ′||W |;

(iii) ρ ∈ {0} ∪ {4, 6, . . . , 2|W |};

25

(iv) t = 2 when ρ = 4, and (a, c) /∈ {(0, 2), (1, 1)} when ρ ∈ {6, 8} and t = 0; and

(v) if t ∈ {2, 4} and ρ = 2|W | − 2i for some i ∈ {0, 1, 2}, then m ≤ c + t + i + 1.

Let C be an (a+c+m−t)-cycle such that V (C) ⊆ W (note that a+c+m−t ∈ {0}∪{3, . . . , |W |}).
Then there exists a (3a, 4b, 5c, 6d, m)-decomposition of KU ′,W ∪ C that, if m > 0, includes an
m-cycle containing m − t edges of C.

Proof. The result follows immediately from Lemma 25. To see that hypothesis (iv) of
Lemma 25 is satisﬁed when t ∈ {2, 4}, it may help to note the following facts. If t ∈ {2, 4} and
ρ = 2|W | − 2i for some i ∈ {0, 1, 2}, then c + t + i + 1 = |W | + t
2 + 1 − a − c by the deﬁnition of
i, and hence m ≤ c + t + i + 1 implies |W | − m + t
2 + 1 ≥ a + c. If t ∈ {2, 4} and ρ ≤ 2|W | − 6,
then a + c ≤ |W | − 3 − t
2 + 1 because
(m, t) ∈ {(4, 2), (5, 2), (6, 2), (6, 4)}.

2 because ρ ≤ 2|W | − 6, and hence a + c ≤ |W | − m + t

Lemma 33. Let U ′ and W be sets with |U ′|, |W | even, |U ′| ≥ 4 and |W | ≥ 10, let (m, t) ∈
{(0, 0), (4, 2), (5, 2), (6, 2), (6, 4)}, and let a, b, c and d be nonnegative integers, and let ρ =
2a + 4c + t. Suppose that

(i) ρ + 4b + 6d = |U ′||W |;

(ii) ρ ∈ {2|W | − 4, 2|W | − 2, . . . , 4|W |}, t = 2 if ρ ∈ {2|W | − 4, 2|W | − 2}, and t ∈ {2, 4} if

ρ = 2|W |; and

(iii) if ρ ≥ 4|W | − 6 and t ∈ {2, 4} then c ≥ 3.

Then there are integers ℓ1, ℓ2 ∈ {3, . . . , w} such that ℓ1 + ℓ2 = a + c + m − t and, for any
edge-disjoint cycles C1 and C2 in KW with lengths ℓ1 and ℓ2,

• if |U ′| ≥ 6 or d is even, there exists a (3a, 4b, 5c, 6d, m)-decomposition P of KU ′,W ∪C1∪C2;

• if |U ′| = 4, d is odd and c ≥ 1, there exists a (3a, 4b, 5c−1, 6d−1, m)-packing P of
KU ′,W ∪ C1 ∪ C2 whose reduced leave contains exactly one edge of KW and has a (3, 4, 4)-
decomposition;

• if |U ′| = 4, d is odd and c = 0, there exists a (3a−1, 4b, 6d−1, m)-packing P of KU ′,W ∪C1∪C2
whose reduced leave contains exactly one edge of KW , has a (4, 5)-decomposition, and has
a vertex of degree 4 in W .

Furthermore, if m > 0, then in each case there is an m-cycle in P that contains m − t edges of
KW (or C2).

Proof. Let w = |W |. Let U ′
and δ = 0 if d is even. Note that, by (i),

1 ⊆ U ′ with |U ′

1. Let δ = 1 if d is odd

1| = 2 and let U ′

2 = U ′ \ U ′

ρ + 2δ ≡ 0 (mod 4).

(4.3)

We will select values for a1, b1, c1, a2, b2, c2 and d2 such that a1 + a2 + c1 + c2 = a + c according
to the following table (the criteria for the cases are given below).

26

case

a1

1

2

3

4

5

6

7

min(⌊a⌋e, w)

min(⌊a⌋e, w − 4)

min(⌊a⌋e, w − 4)

min(⌊a + δ⌋e, w)

max(0, w − 4 − 2c + 2δ)

w − 2δ

w − 4

b1

0

2

2

0

2

δ

2

c1

w−a1

2
w−a1

2 − 2
2 − 2

w−a1

a2

a − a1

a − a1

a − a1

w−a1

2

a + δ − a1

b2

b

b − 2

b + 1
b + 3(d−δ)

2 + 2δ

w−a1

2 − 2

a + δ − a1

b + 3(d−δ)

2 + 2δ − 2

c2

c − c1

c − c1

c − c1

c − δ − c1

c − δ − c1

0

0

a − δ − a1

a − δ − a1

b + 3(d−δ)

2

b + 3(d−δ)

2 + δ − 2

δ

δ

d2

d

d

d − 2

0

0

0

0

1,W ∪ C1 and a (3a2, 4b2, 5c2, 6d2, m)-packing P2 of KU ′

We will apply Lemma 32 to show that a1 + c1 and a2 + c2 + m − t are in {3, . . . , w} and that,
for any edge-disjoint cycles C1 and C2 in KW with lengths a1 + c1 and a2 + c2 + m − t, there is
a (3a1, 4b1, 5c1)-packing P1 of KU ′
2,W ∪ C2
from which we can obtain a packing with the required properties. In each case the fact that
the hypotheses of Lemma 32 are satisﬁed when constructing P1 and P2 can be deduced from
(4.3), the hypotheses of this lemma and the criteria of the relevant case. In particular, we use
w ≥ 10 frequently. For brevity, let ρ1 = 2a1 + 4c1 and ρ2 = 2a2 + 4c2 + t. For each case, we
now detail the criteria for the case, explain how a packing with the required properties can be
obtained from P1 ∪ P2, and justify some of the less obvious deductions required to see that the
hypotheses of Lemma 32 are satisﬁed. To show that hypotheses (iii), (iv) and (v) of Lemma 32
are satisﬁed in constructing P2, it suﬃces to show that

ρ2 ≥ 4, t = 2 when ρ2 = 4, and (a2, c2) /∈ {(0, 2), (1, 1)} when ρ2 ∈ {6, 8} and t = 0,

(4.4)

and

ρ2 ≤ 2w, and m ≤ c2 + t + i + 1 when t ∈ {2, 4} and i ∈ {0, 1, 2},

(4.5)

where i is the integer such that ρ2 = 2w − 2i.
Case 1: |U ′| ≥ 6, ρ ≥ 2w + 8, and t ∈ {2, 4} if ρ = 2w + 8. In this case P1 ∪ P2 is itself
a packing with the required properties. Note that ρ1 = 2w and ρ2 = ρ − 2w. We have c2 ≥ 0
because either c1 = 0 or a2 ∈ {0, 1} and 2a2 + 4c2 = ρ2 − t ≥ 4. We have (4.4) by the criteria
for this case. We have (4.5) by (iii) when c1 = 0 and because

c2 + t + i + 1 = 1

4(ρ2 − 2a2 − t) + t + i + 1 ≥ 2w+2i+3t+4−2a2

4

≥ 7 for t ∈ {2, 4}

when a2 ∈ {0, 1}.
Case 2: |U ′| ≥ 6, ρ ≤ 2w + 8, t = 0 if ρ = 2w + 8, and b ≥ 2. In this case P1 ∪ P2 is
itself a packing with the required properties. Note that ρ1 = 2w − 8 and ρ2 = ρ − 2w + 8. We
have c2 ≥ 0 because either c1 = 0 or a2 ∈ {0, 1} and 2a2 + 4c2 = ρ2 − t ≥ 4 by (ii). We have
(4.4) by (ii). We have (4.5) by the criteria for this case.
Case 3: |U ′| ≥ 6, ρ ≤ 2w + 8, t = 0 if ρ = 2w + 8, and b ∈ {0, 1}. Lemma 27 can be
applied to P1 ∪ P2 (using the two 4-cycles in P1 and any one 4-cycle in P2) to obtain a packing
with the required properties. We have d2 ≥ 0 because 4b + 6d = |U ′|w − ρ ≥ 4w − 8 by (i)
and the criteria for this case. We have c2 ≥ 0, (4.4) and (4.5) by similar arguments to those in
Case 2.
|U ′| = 4, c ≥ 1, ρ ≥ 2w + 8, and t ∈ {2, 4} if ρ ∈ {2w + 8, 2w + 10}.
Case 4:
Lemma 27 can be applied to P1 ∪ P2 (using any 3
2(d − δ) 4-cycles in P1 ∪ P2) to obtain a
(3a+δ, 4b+2δ, 5c−δ, 6d−δ, m)-decomposition of KU ′,W ∪ C1 ∪ C2. If δ = 0 this completes the proof

27

and if δ = 1 we can remove two 4-cycles and a 3-cycle to obtain a packing with the required
properties. Note that ρ1 = 2w and ρ2 = ρ − 2w − 2δ. We have c2 ≥ 0 because either c1 = 0
or a2 ∈ {0, 1} and 2a2 + 4c2 = ρ2 − t ≥ 4 (note that if δ = 1, then ρ ≥ 2w + 10 by (4.3)). We
have (4.4) by the criteria for this case. We have (4.5) by similar arguments to those in Case 1.
Case 5:
|U ′| = 4, c ≥ 1, ρ ≤ 2w + 10, and t = 0 if ρ ∈ {2w + 8, 2w + 10}.
Lemma 27 can be applied to P1 ∪ P2 (using any 3
2(d − δ) 4-cycles in P1 ∪ P2) to obtain a
(3a+δ, 4b+2δ, 5c−δ, 6d−δ, m)-decomposition of KU ′,W ∪ C1 ∪ C2. If δ = 0 this completes the proof
and if δ = 1 we can remove two 4-cycles and a 3-cycle to obtain a packing with the required
properties. Note that ρ1 = 2w − 8 and ρ2 = ρ − 2w + 8 − 2δ. We have a2 ≥ 0 because
2a + 4c = ρ − t ≥ 2w − 6 by (ii) and hence a + 2c ≥ w − 3. Further, a2 ≥ δ when ρ ≥ 2w − 2.
We have b2 ≥ 0 because 4b + 6d = 4w − ρ ≥ 2w − 10 by (i) and the criteria for this case and
hence b ≥ w−3d−5
2 − 2 or c1 = c − δ.
We have (4.4) by (ii) (note that if δ = 1, then ρ ≥ 2w − 2 by (4.3) and that a2 ≥ δ when
ρ ≥ 2w − 2). We have (4.5) by the criteria for this case.
Case 6: |U ′| = 4, c = 0, and ρ ≥ 2w + 8. If δ = 1, then we can ensure that the 4-cycle in
P1 and the 5-cycle in P2 with one edge of KW share at least one vertex in W . We will justify
this below. Lemma 27 can be applied to P1 ∪ P2 (using 3
2(d − δ) 4-cycles in P2) to obtain a
(3a−δ, 4b+δ, 5δ, 6d−δ, m)-decomposition of KU ′,W ∪ C1 ∪ C2 in which, if δ = 1, a 4-cycle with no
edges of KW and a 5-cycle with one edge of KW share a vertex in W . If δ = 0 this completes
the proof and if δ = 1 we can remove the 4-cycle and 5-cycle from the decomposition to obtain
a packing with the required properties. Note that ρ1 = 2w − 4δ and ρ2 = ρ − 2w + 6δ. We
have a2 ≥ 0 because 2a = ρ − t ≥ 2w + 4 by the criteria for this case and hence a ≥ w + 2. We
have (4.4) by the criteria for this case. We have (4.5) because ρ ≤ 4w − 6δ by (i) and because
ρ ≤ 4w − 8 when t ∈ {2, 4} by (iii) (note that if δ = 1, then ρ ≤ 4w − 10 by (4.3)).

. We have c2 ≥ 0 because either c ≥ w

2 − 2 + δ and c1 = w

2

It remains to show that, if δ = 1, then we can ensure that the 4-cycle X in P1 and the 5-cycle
Y in P2 with one edge of KW share at least one vertex in W . Note that V (X)∩W = W \V (C1).
When V (C2) * V (C1), we can permute the vertices of P2 so that the edge of Y in KW is
incident with a vertex in V (C2) \ V (C1) and hence in V (X). When V (C2) ⊆ V (C1), noting
that |V (C2)| ≤ w − 2 and t ≤ 4, we can ensure that Y has a vertex in W \ V (C2). (This can be
seen by directly applying Lemma 24 to construct P2. The hypotheses of Lemma 24 are satisﬁed
since the reduced leave of a (4b2)-packing of KU ′
2,W is a copy of K2,w−2b2, which clearly has the
required path decomposition.) We can then permute the vertices of P2 so that this vertex of
Y is in W \ V (C1) and hence in V (X).
Case 7:
|U ′| = 4, c = 0, ρ ≤ 2w + 6. A packing with the required properties can be
obtained from P1 ∪ P2 as in Case 6. Note that ρ1 = 2w − 8 and ρ2 = ρ − 2w + 8 + 2δ. We
have b2 ≥ 0 because 4b + 6d = 4w − ρ ≥ 2w − 6 by (i) and the criteria for this case and hence
b ≥ w−3d−3
. We have a2 ≥ 0 by similar arguments to those in Case 5. We have (4.4) by (ii).
We have ρ2 ≤ 16 by the criteria for this case, so (4.5) holds.

2

Lemma 34. Let u ≥ 5 and w ≥ 10 be integers such that u is odd and w is even. Let N be a
list of integers and let a, b, c and d be nonnegative integers such that the following conditions
hold.

(i) (P N) − t + a + c = (cid:0)w

2(cid:1), where t ∈ {0, 2, 4};

(ii) 2a + 4b + 4c + 6d + t = uw;

(iii) 3 ≤ ℓ ≤ min(u, w) for each entry ℓ in N, and d = 0 if u = 5;

28

(iv) either a ≥ w

2 and a + c ≥ w

2 + 3, or c ≥ 3w

4 and a + c ≥ 3w

4 + 4;

(v) if b + d ≤ 2 and t ∈ {2, 4}, then a ∈ {0, 1, 2, 3, 4, w

2 , w

2 + 1, w

2 + 2, w

2 + 3};

(vi) if t ∈ {2, 4}, there is some entry m in N such that (m, t) ∈ {(4, 2), (5, 2), (6, 2), (6, 4)}.

Then there exists an (N, 3a, 4b, 5c, 6d)-decomposition of Ku+w − Ku that includes cycles with
lengths (3a, 4b, 5c, 6d) that each contain at most one pure edge.

Proof. Let U and W be disjoint sets of sizes u and w and observe that KU ∪W − KU =
KU,W ∪ KW . Let m = 0 if t = 0. We ﬁrst choose disjoint subsets U1 and U2 of U and
nonnegative integers a1, a2, a3, c1, c2 and c3. Let a1, c1 and |U1| be given as follows.

case
a ≥ w
2
a < w
2 and w ≡ 0 (mod 4)
1 ≤ a < w
a = 0 and w ≡ 2 (mod 4)

2 and w ≡ 2 (mod 4)

a1
w
2
0
1
0

c1
0
3w
4

3w−2

4

3w−2

4

|U1|

1
3
3
3

Using (iv), we see that a1 ≤ a and c1 ≤ c. Further, let a′, c′, b3 and d3 be given as follows.

case
a = 0, w ≡ 2 (mod 4), d is even
a = 0, w ≡ 2 (mod 4), d is odd
a ≥ 1 or w ≡ 0 (mod 4)

a′
1
0

c′

b3

d3
d

c − c1 − 2
c − c1 − 1

b + 1
b + 2 d − 1

a − a1

c − c1

b

d

Let ρ = 2a′ + 4c′ + t. Using (iv) we see that a′, c′, b3 and d3 are nonnegative. Let |U2| and ρ3
be the nonnegative even integers that satisfy the conditions given below.

case
(u, |U1|) = (5, 3) or ρ ≤ 8
10 ≤ ρ ≤ (u − |U1| − 4)w + 8
ρ ≥ (u − |U1| − 4)w + 10, (u, |U1|) 6= (5, 3) ρ = |U2|w + ρ3, |U2| = u − |U1| − 4

conditions
ρ = |U2|w + ρ3, |U2| = 0
ρ = |U2|w + ρ3, ρ3 ∈ {10, 12, . . . , 2w + 8}

Note that |U2| ∈ {0, 2, . . . , u − |U1| − 4} unless (u, |U1|) = (5, 3) and |U2| = 0. Now let

a2 = min(⌊a′⌋e, 1

2|U2|w),

c2 = 1

4 (|U2|w − 2a2),

a3 = a′ − a2,

c3 = c′ − c2.

By our deﬁnitions, 2a2 + 4c2 = |U2|w and 2a3 + 4c3 + t = ρ3. Clearly, a2, c2 and a3 are
nonnegative. When ρ3 < 10 we have |U2| = 0 and (a3, c3) = (a′, c′). Thus it follows from
(iv) and the deﬁnitions of a′ and c′ that either ρ3 ≥ 10 or a3 + c3 ≥ 3. Furthermore, c3 is
nonnegative because c2 = 0 when a2 = 1
2|U2|w, and a3 ∈ {0, 1} and 2a3 + 4c3 + t = ρ3 ≥ 6
when a2 = ⌊a′⌋e. It may be that a1 + a2 + a3 6= a or c1 + c2 + c3 6= c. However, P3 (deﬁned
below) will be produced by applying Lemma 32 or 33 with (a, b, c, d) = (a3, b3, c3, d3) and then
possibly removing cycles. Observe that ρ3, w and t satisfy one of the following

ρ3 ≤ 2w, t ∈ {0, 4} if ρ3 ∈ {2w − 4, 2w − 2}, and t = 0 if ρ3 = 2w.

ρ3 ≥ 2w − 4, t = 2 if ρ3 ∈ {2w − 4, 2w − 2}, and t ∈ {2, 4} if ρ3 = 2w.

(4.6)

(4.7)

We now construct packings P0, . . . , P3 as follows (we justify that these packings exist later).

• P0 is an (N \ (m))-packing of KW − I, where I is a 1-factor on vertex set W . The reduced

leave of P0 is the edge-disjoint union of cycles C ⋆, C1, . . . , Cn, C †

1, C †

2, where

29

– C ⋆ is trivial if a ≥ w
– n = |U2|
2 , |E(Ci)| ∈ { w
– |E(C †
1)| + |E(C †

4 ⌉ otherwise; and

2 and |E(C ⋆)| = ⌈ w
2 , . . . , w} for 1 ≤ i ≤ n, and Pn

2)| = m − t + a3 + c3.

i=1 |E(Ci)| = a2 + c2; and

The cycle lengths |E(C1)|, . . . , |E(Cn)| will be given by Lemma 26 (note that a2 + 2c2 =
nw). The cycle lengths |E(C †

2)| will be given by Lemma 32 or 33.

1)| and |E(C †

• P1 is a (3a1, 5c1)-packing of KU1,W ∪ I ∪ C ⋆. The reduced leave L1 of P1 is a 3-cycle if

a = 0 and w ≡ 2 (mod 4) and is trivial otherwise.

• P2 is a (3a2, 5c2)-decomposition of KU2,W ∪ C1 ∪ · · · ∪ Cn.

• P3 is a packing of KU3,W ∪ C †

2 that, if m > 0, includes an m-cycle containing m − t
edges of KW , where U3 = U \ (U1 ∪ U2), with a reduced leave L3. The properties of P3
and L3 divide according to the following cases. The cases are mutually exclusive because
d3 is deﬁned so as to be even when a = 0 and w ≡ 2 (mod 4).

1 ∪ C †

Case 1: a = 0, w ≡ 2 (mod 4), and d is even.

Then P3 is a (3a3−1, 4b3−1, 5c3, 6d3, m)-packing, L3 has exactly one pure edge, L3 has
a (3, 4)-decomposition, and L1 ∪ L3 has a vertex of degree 4;

Case 2: a = 0, w ≡ 2 (mod 4), and d is odd.

Then P3 is a (3a3, 4b3−2, 5c3, 6d3, m)-packing, L3 has no pure edges, L3 has a (4, 4)-
decomposition, and L1 ∪ L3 has a vertex of degree 4;

Case 3: (4.7) holds, |U3| = 4, d3 is odd, and c3 ≥ 1.

Then P3 is a (3a3, 4b3, 5c3−1, 6d3−1, m)-packing, L3 has exactly one pure edge, and L3
has a (3, 4, 4)-decomposition;

Case 4: (4.7) holds, |U3| = 4, d3 is odd, and c3 = 0.

Then P3 is a (3a3−1, 4b3, 5c3, 6d3−1, m)-packing, L3 has exactly one pure edge, L3 has
a (4, 5)-decomposition, and there is a vertex in W with degree 4 in L3;

Case 5: otherwise.

Then P3 is a (3a3, 4b3, 5c3, 6d3, m)-decomposition and L3 is trivial.

Let P ′ = P0 ∪ P1 ∪ P2 ∪ P3. Then P ′ is a packing of KU ∪W − KU with reduced leave L1 ∪ L3.
If we are in Case 5 then P ′ is an (N, 3a, 4b, 5c, 6d)-decomposition with the required properties.
Otherwise we can obtain an (N, 3a, 4b, 5c, 6d)-decomposition of KU ∪W − KU with the required
properties by applying Lemma 18 with m and m′ as per the following table. (That P ′ is an
(N, 3a, 4b, 5c, 6d)-decomposition in Case 5, and that the entries in the second and third columns
of the table are correct, can be checked using the deﬁnitions of P0, . . . , P3, a′, c′, a3, b3, c3 and
d3.)

case

1
2
3
4

cycle type of P ′
(N, 3a, 4b, 5c−2, 6d)
(N, 3a, 4b, 5c−1, 6d−1)
(N, 3a, 4b, 5c−1, 6d−1)
(N, 3a−1, 4b, 5c, 6d−1)

size of L1 ∪ L3

10
11
11
9

(m, m′)
(5, 5)
(5, 6)
(5, 6)
(3, 6)

So it remains to establish the existence of the packings P0, . . . , P3. We ﬁrst establish three

useful facts.

30

(a) ρ3 + 4b3 + 6d3 = |U3|w. It follows from the deﬁnitions of a′, c′, b3 and d3 that 2a′ +
4b3 + 4c′ + 6d3 + t = 2a + 4b + 4c + 6d + t − |U1|w.
It follows from the deﬁnitions of a2
and c2 that 2a2 + 4c2 = |U2|w. Thus, because a3 = a′ − a2 and c3 = c′ − c2, we have
2a3 + 4b3 + 4c3 + 6d3 + t = (u − |U1| − |U2|)w by (ii).

(b) If |U3| = 2, t ∈ {2, 4} and ρ3 = 2w − 2i, then 6 ≤ c3 + t + i + 1. Because |U3| =
2, (u, |U1|) = (5, 3) by the deﬁnition of U2 and thus a ≤ w
2 − 1 by the deﬁnition of U1. So
and hence c3 + t + i + 1 ≥ w+3t+2i+6
from 2a3 + 4c3 + t = 2w − 2i we deduce c3 ≥ w+2−t−2i
.
Because w ≥ 10 and t ≥ 2, the result follows.

4

4

(c) ρ3 ≤ 4w and, if ρ3 ≥ 4w − 6 and t ∈ {2, 4}, then c3 ≥ 3. If ρ3 ≤ 2w + 8, then ρ3 <
4w − 6 (note w ≥ 10). If ρ3 > 2w + 8, then |U2| = u − |U1| − 4 and |U3| = 4 by the deﬁnitions of
U2 and U3. So ρ3 + 4b3 + 6d3 = 4w by (a) and hence ρ3 ≤ 4w. Furthermore, if we now suppose
that ρ3 ≥ 4w − 6, then 4b3 + 6d3 ≤ 6 and so b3 + d3 ≤ 1. Then b + d ≤ 2, because b ≤ b3 and
d ≤ d3 + 1. So by (v), a′ ≤ 4 and hence a3 ≤ 4. Because 2a3 + 4c3 + t = ρ3 ≥ 4w − 6, it follows
that c3 ≥ 6.

Proof that P0 exists. First observe that 3 ≤ ⌈ w
4 ⌉ ≤ w because w ≥ 10. We choose
lengths |E(C1)|, . . . , |E(Cn)| with the required properties, which exist by Lemma 26 because
a2 + 2c2 ≡ 0 (mod w). If |U3| = 2 or (4.6) holds, then a3 + c3 + m − t ∈ {0} ∪ {3, . . . , w} by
Lemma 32 with (a, b, c, d) = (a3, b3, c3, d3) and U ′ = U3 (the hypotheses are satisﬁed by (iii),
(a), (b), and because either ρ3 ≥ 10 or a3 + c3 ≥ 3) and we let |E(C †
1)| = a3 + c3 + m − t and
|E(C †
2)| be the cycle lengths
given by Lemma 33 with (a, b, c, d) = (a3, b3, c3, d3) and U ′ = U3 (the hypotheses are satisﬁed
by (a) and (c)). Then, by Theorem 19, a packing with the required properties exists by (iii)
and because

2)| = 0. If |U3| ≥ 4 and (4.7) holds, then we let |E(C †

1)| and |E(C †

1)| + |E(C †

P(N \ (m)) + |E(C ⋆)| + |E(C †
= ((cid:0)w
2(cid:1) + t − m − a − c) + |E(C ⋆)| + (m − t + a3 + c3) + (a2 + c2)
= (cid:0)w
2(cid:1) − (a + c) + (a′ + c′) + |E(C ⋆)|
= (cid:0)w
2(cid:1) − w
2 .

2)| + |E(C1)| + · · · + |E(Cn)|

The ﬁrst equality holds by (i) and the deﬁnitions of C1, . . . , Cn, C †
2. The second equality
holds by the deﬁnitions of a3 and c3. The ﬁnal equality holds because it follows from the
deﬁnitions of a′, c′ and C ⋆ that a + c − a′ − c′ = w
Proof that P2 exists. This follows immediately by Lemma 26 because |E(Ci)| ∈ { w

2 + |E(C ⋆)|.

1, C †

i=1 |E(Ci)| = a2 + c2.

for 1 ≤ i ≤ n and Pn
Proof that P3 exists. We established above that if |U3| = 2 or (4.6) holds, then C †
2 is
trivial and we can apply Lemma 32 with (a, b, c, d) = (a3, b3, c3, d3), U ′ = U3 and C = C †
1.
Also, we established that if |U3| ≥ 4 and (4.7) holds, then we can apply Lemma 33 with
(a, b, c, d) = (a3, b3, c3, d3), U ′ = U3 and (C1, C2) = (C †
1, C †
2). Let P ′
3 be the packing produced
by applying the appropriate lemma. In Cases 3, 4 and 5, P ′
3 is itself a packing with the required
properties. In Case 1, we can obtain a packing with the required properties by removing a 3-
cycle and a 4-cycle from P ′
3 (note that a3 ≥ 1 and b3 ≥ 1 in this case). In Case 2, we can obtain
a packing with the required properties by removing two 4-cycles from P ′
3 (note that b3 ≥ 2 in
this case). In Cases 1 and 2 we will ensure that L1 ∪ L3 has a vertex of degree 4 when we
construct P1 below.

2 , . . . , w}

31

2 , then (a1, c1) = ( w

1 of KU1,W ∪ I ∪ C ⋆ with ⌊ 3w

Proof that P1 exists. If a ≥ w
required properties clearly exists. So we may assume that a < w
packing P ′
when w ≡ 0 (mod 4), L′
1 is a 3-cycle when w ≡ 2 (mod 4), and L′
w ≡ 2 (mod 4) and a = 0. If w ≡ 0 (mod 4) or a = 0, then P ′
properties. If 1 ≤ a < w
properties.

2 , 0), C ⋆ is trivial and a packing with the
2 . By Lemma 31 there is a
1 is trivial
1 shares a vertex with L3 when
1 is a packing with the required
1 ∪ {L1} is a packing with the required

4 ⌋ 5-cycles with a reduced leave L′

2 and w ≡ 2 (mod 4), then P ′

1 such that L′

5 Proof of Theorem 1

This section contains the proof of Theorem 1. Lemma 35 dispenses with the case where the sum
of odd entries in (m1, . . . , mτ ) is small. In this case we can obtain the required decomposition
using known cycle decomposition results for the complete graph and the complete bipartite
graph. The remaining cases of Theorem 1 are proved by repeatedly applying Lemma 3 to base
decompositions given by Lemmas 28, 29 and 34.

Lemma 35. Let u ≥ 5 and w ≥ 4 be integers such that u is odd and w is even, and let
m1, . . . , mτ be a nondecreasing list such that the following hold

(i) m1 ≥ 3 and mτ ≤ min(u, w);

(ii) m1 + · · · + mτ = (cid:0)u+w
(iii) the sum of odd entries in m1, . . . , mτ is at most w(w−2)

2 (cid:1) −(cid:0)u

2(cid:1); and

2

.

Then there exists an (m1, . . . , mτ )-decomposition of Ku+w − Ku.

Proof. Let U and W be disjoint sets of size u and w respectively, let U1 ⊆ U such that |U1| = 1,
and let M = m1, . . . , mτ . We will form an (M)-decomposition of KU ∪W − KU from a packing
P0 of KW ∪U1 and a packing P1 of KU \U1,W .

Let n1, . . . , ns where n1 ≤ · · · ≤ ns be the sublist of M containing all of its even entries.
2 by (ii) and (iii). Let s′ be the largest
element of {1, . . . , s} such that ns′ ≤ 3ns′−1. Observe that n1 + · · · + ns′ > w(u − 1) because

Note that n1 + · · · + ns ≥ (cid:0)u+w

2(cid:1) − w(w−2)

2 (cid:1) −(cid:0)u

2 = uw + w

∞

∞

ns
3i ≤

w
3i <

3w
2

ns′+1 + · · · + ns <

Xi=0
where the ﬁrst inequality follows because ni < 1
3ni+1 for each i ∈ {s′, . . . , s − 1}, and the second
inequality follows because ns ≤ w by (i).

Xi=0

We now deﬁne a sublist M1 of (n1, . . . , ns′) as follows. Begin with M1 empty. Iteratively

x ≤ w(u − 1), add the largest such entry to M1. When no such entry exists, terminate the

apply the following procedure: while there is an entry x of (n1, . . . , ns′) \ M1 such that P M1 +
procedure and ﬁx M1. Let M0 = M \ M1, let t be the integer such that P M1 + t = w(u − 1).

Because n1 + · · · + ns′ > w(u − 1), this procedure will terminate and M1 will be a proper sublist
of (n1, . . . , ns′). Thus, the smallest even entry in M0 is ns′′ for some s′′ ∈ {1, . . . , s′}. Also, t is

even because P M1 and w(u − 1) are. We establish three more useful facts.
(a) PPP M1 = w(u − 1) − t and PPP M0 = (cid:0)w+1

of t and the latter follows from the former by the deﬁnition of M0 and by (ii).

2 (cid:1) + t. The former follows from the deﬁnition

32

′′ − 2 and there are at least two even entries in M0. If t were at least ns′′,
(b) t ≤ ns
then another even entry of (n1, . . . , ns′)\M1 would have been added to M1 before the procedure
terminated. So t ≤ ns′′ − 2. Because n1 + · · · + ns ≥ uw + w
2 , the even entries in M0 sum to at
least 3w

2 + t and hence there are at least two by (i).

′

−u+1, . . . , ns

′) is a sublist of M1 and t ≤ w − 4. Because ns′ ≤ w by (i), the ﬁrst
(c) (ns
u − 1 entries added to M1 are ns′, ns′−1, . . . , ns′−u+1. Thus, if t = w − 2, then ns′′ = w by (b)
and it would follow that M1 = (wu−1) and t = 0.

If t = 0, then an (M)-decomposition of KU ∪W − KU is given by P0 ∪ P1, where P0 is an
(M0)-decomposition of KW ∪U1, and P1 is an (M1)-decomposition of KU \U1,W . Noting (a), (c)
and (i), we see that P0 exists by Theorem 19 and P1 exists by Theorem 20. Thus we can
assume that t ∈ {2, 4, . . . , w − 4}.

We now deﬁne integers p, p†, b and b† and (possibly empty) lists M ′

1. We will
then show that there exists an (M0 \ M ′
0)-packing P0 of KW ∪U1 whose reduced leave L0 is the
edge-disjoint union of a p-path and a p†-path, an (M1 \ M ′
1)-packing P1 of KU \U1,W whose
reduced leave L1 is the edge-disjoint union of a b-path and a b†-path such that there exists an
(M ′
1)-decomposition P2 of L0 ∪ L1. This will suﬃce to complete the proof as P0 ∪ P1 ∪ P2
will be an (M)-decomposition of KU ∪W − KU .

0 and M ′

0, M ′

• If there is an entry q in M0 that is at least t + 3, then let M ′

1 = (r)
where r is the smallest entry of M1. Let b = t + 2, b† = r − 2, p = q − t − 2 and p† = 2.

0 = (q) and let M ′

• If t ≥ 4 and each entry in M0 is at most t + 2, then M0 contains at least two entries equal
1 be empty. Let b = 2, b† = t − 2, p = t

0 = (t + 2, t + 2), and let M ′

to t + 2 by (b). Let M ′
and p† = 4.

• If t = 2 and each entry in M0 is at most 4, then M0 contains at least two entries equal
1 = (r) where r is the smallest entry of M1. Let

0 = (4, 4) and let M ′

to 4 by (b). Let M ′
b = 4, b† = r − 2, p = 4, and p† = 2.

0 − t and b + b† = P M ′

1 + t. Hence P(M0 \ M ′

0) + p + p† =

In each case note that p + p† = P M ′
(cid:0)w+1
2 (cid:1) and P(M1 \ M ′

1) + b + b† = w(u − 1) by (a).

Proof that P1 exists. Using (a), (b), (c) and (i), it can be checked that by Lemma 22 there
is an (M1 \ M ′
1)-packing of KU \U1,W whose reduced leave has a decomposition into a b-path
B and a b†-path B† with end vertices x and y in W (apply Lemma 22(ii) with mi = b + b† if
2 ∈ {b, b†} and Lemma 22(i) with mi = b and mj = b† otherwise).
Proof that P0 exists. First suppose that M ′
0 6= (4, 4). Using (a), (c) and (i), there is an
(M0 \ M ′
0, p + p†)-decomposition of KW ∪U1 by Theorem 19 (in each case 3 ≤ p + p† ≤ w + 1).
Let P0 be the result of removing a p + p† cycle from this decomposition and permuting vertices
so that the reduced leave of the resulting packing is the edge-disjoint union of paths P and
P † with end vertices x and y such that V (P ) ∩ V (B) = V (P †) ∩ V (B†) = {x, y}. This
relabelling is possible provided that |V (B) ∩ V (B†) ∩ W | + p + p† − 2, |V (B) ∩ W | + p − 1 and
|V (B†) ∩ W | + p† − 1 are each at most w + 1 (for a proof of this, see [12, Lemma 5.2]). These
inequalities can be checked using (c) and the facts that |V (B)∩V (B†)∩W | ≤ |V (B)∩W | = b+2
2
and |V (B†) ∩ W | = b†+2
2 .
Now suppose that M ′

0 = (4, 4). We form P0 as above, except that we permute vertices so
that V (P ) ∩ V (B) = {x, y, z} where V (B) ∩ W = {x, y, z} and z is not adjacent to x or y in P .

33

In each case the properties of B, B†, P and P † ensure that there is an (M ′

0, M ′

1)-

decomposition P2 of L0 ∪ L1.

We introduce some more notation. For a list M and an integer m we let νm(M) denote the
number of entries of M that are equal to m. For a list M, let ν(M) denote the total number
of entries of M and let νo(M) denote the number of odd entries of M. For a nondecreasing list
M = (m1, . . . , ms), we say that M is well-behaved if ms ≤ 3ms−1.

We say that a list R is a reﬁnement of an integer m ≥ 3 if P R = m, each entry of R

is at least 3 and at most one entry of R is odd. For any integer m ≥ 3 the list (m) is a
reﬁnement of m. We say that a list R is a reﬁnement of a list M = (m1, . . . , ms) if R can
be reordered as (R1, . . . , Rs) where Ri is a reﬁnement of mi for each i ∈ {1, . . . , s}. The fact
that νo(R) = νo(M) is crucial and we will use it frequently. The basic reﬁnement of an integer
m ≥ 3 is R where

(4m/4),
(3, 4(m−9)/4, 6),
(4(m−6)/4, 6),
(3, 4(m−3)/4),
(5),

if m ≡ 0 (mod 4);
if m ≡ 1 (mod 4) and m ≥ 9;
if m ≡ 2 (mod 4);
if m ≡ 3 (mod 4);
if m = 5.

R =




We say that a list R is the basic reﬁnement of a list M = (m1, . . . , ms) if R can be reordered
as (R1, . . . , Rs) where Ri is the basic reﬁnement of mi for each i ∈ {1, . . . , s}.

Lemma 36 shows how Lemma 3 can be repeatedly applied to our base decompositions to

obtain the decompositions required by Theorem 1.

Lemma 36. Let u ≥ 5 and w ≥ 4 be integers, let N and Z = (z1, . . . , zq) be nondecreasing
lists of integers such that zq ≤ min(u, w, 3zq−1), and let R be a reﬁnement of Z. If there exists
an (N, R)-decomposition of Ku+w − Ku that includes cycles with lengths R that each contain at
most one pure edge, then there exists an (N, Z)-decomposition of Ku+w − Ku.

Proof. Assume that there exists such an (N, R)-decomposition D of Ku+w − Ku. Let ℓ be
the number of entries in R. Note that ℓ ≥ q, and that if ℓ = q, then R = Z and the result
is obviously true. So suppose that ℓ > q. By induction, it suﬃces to show that there is an
(N, R′)-decomposition D′ of Ku+w − Ku where R′ is a reﬁnement of Z with ℓ − 1 entries and
D′ contains cycles with lengths R′ that each contain at most one pure edge. Let R1, R2, . . . , Rq
be a reordering of R so that Ri is a reﬁnement of zi for i ∈ {1, . . . , q}.
Case 1. Suppose that there is exactly one list Ri in R1, . . . , Rq such that ν(Ri) ≥ 2. Let
Ri = a1, . . . , aν(Ri) and let j = q if i 6= q and j = q − 1 if i = q. Let C1, C2 and C3 be
cycles in D of lengths a1, a2 and zj that each contain at most one pure edge. We can obtain a
decomposition D′ with the required properties by applying Lemma 3 to D \ {C1, C2, C3} with
h = zj, m1 = a1 and m2 = a2. We have m1 + m2 + h ≤ zi + zj ≤ 2 min(u, w) from our
hypotheses. We have m1 + m2 ≤ 3h because either a1 + a2 ≤ zi ≤ zq = h or (i, j) = (q, q − 1),
in which case a1 + a2 ≤ zq ≤ 3zq−1 by our hypotheses.
Case 2. Suppose that there are at least two lists in R1, . . . , Rq that each have at least two
entries. Let r be the largest entry in R1, . . . , Rq and let i ∈ {1, . . . , q} such that r is an entry
of Ri. Let j be an element of {1, . . . , q} \ {i} such that ν(Rj) ≥ 2 and let Rj = a1, . . . , aν(Rj ).
Let C1, C2 and C3 be cycles in D of lengths a1, a2 and r that each contain at most one pure
edge. We can obtain a decomposition D′ with the required properties by applying Lemma 3 to

34

D \{C1, C2, C3} with h = r, m1 = a1 and m2 = a2. We have m1 +m2 +h ≤ zi +zj ≤ 2 min(u, w)
from our hypotheses. We have m1 + m2 ≤ 3h because a1, a2 ≤ r.

We are now ready to prove our main result.

Proof of Theorem 1. If there exists an (m1, . . . , mτ )-decomposition of Ku+w − Ku then (i)–
(iv) hold by Lemma 2. So it remains to show, for any integers u ≥ 1 and w ≥ 10 and list
M = (m1, . . . , mτ ), that if mτ ≤ min(u, w, 3mτ −1) and (i)–(iv) hold, then there exists an
(M)-decomposition of Ku+w − Ku.

If m1 = m2 = · · · = mτ then the result follows by [12, Theorem 1.2] (mi even) or [13,
Theorem 3] (mi odd). If u = 1, there is an (M)-decomposition of Kw+1 by Theorem 19 and
Kw+1 = Kw+1 − K1. If u = 3, there is an (M, 3)-decomposition of Kw+3 by Theorem 19 and
deleting the edges of a 3-cycle produces an (M)-decomposition of Kw+3 − K3. If the sum of
odd entries in M is at most w(w−2)
, then the result follows by Lemma 35. Thus we can suppose
that m1 < mτ , u ≥ 5, and the sum of odd entries in M is greater than w(w−2)

.

2

2

We will proceed as follows. First we choose a sublist Z of M such that Z is well-behaved.
Then we deﬁne a reﬁnement R = (3a, 4b, 5c, 6d, k) of Z such that a, b, c, d and M \ Z satisfy
the hypotheses of Lemma 28, 29 or 34 (R is not always the basic reﬁnement of Z but it is
always ‘close’ to it). The appropriate lemma will then yield an (M \ Z, R)-decomposition D
of Ku+w − Ku that contains cycles with lengths R that each contain at most one pure edge.
Applying Lemma 36 will then produce an (M)-decomposition of Ku+w − Ku. So it remains to
deﬁne Z and R, and to show that the hypotheses of Lemma 28, 29 or 34 are satisﬁed.

Throughout this proof we employ some notational shorthand concerning lists. For a list
X, a set S and an integer x, we write x ∈ X if at least one entry of X is equal to x, X ⊆ S
if each entry of X is an element of S, and maxe(X) for the largest even entry of X. For a

sublist X = x1, . . . , xs of M, we deﬁne Pe X = Ps
i=1 ⌊xi⌋e and t(X) = uw − Pe X. Note
that Pe X can also be written as P X − νo(X). Then Pe X = uw − t(X) and, by (iii),
P(M \ X) = (cid:0)w

2(cid:1) − νo(X) + t(X). Clearly t(X) is always even. We abbreviate t(Z) to t.

The proof splits into three cases, depending on νo(M) and ν5(M).

Case 1. Suppose that νo(M) − ν5(M) ≥ w
2 + 3. We aim to satisfy the hypotheses of either
Lemma 29 (in Case 1a) or Lemma 34 (in Case 1b). We choose Z according to the following
procedure.

1. Let Z ′′ be the list consisting of the w

2 + 3 largest odd entries of M that are not equal to 5.

Each entry in M is at most min(u, w) ≤ u, so Pe Z ′′ ≤ (u − 1)( w

+ 6 ≥ 2u + 8. Below, this will imply that ν(Z ′ \ Z ′′) ≥ 2.

t(Z ′′) ≥ (u+1)(w−6)

2 + 3) and hence

2

2. Begin with Z ′ = Z ′′ and repeatedly add the largest entry of M \ Z ′ to Z ′, until M \ Z ′ is

empty or Z ′ satisﬁes t(Z ′) ≤ max(M \ Z ′) − 2.

It follows from this deﬁnition that t(Z ′) ≥ 0 (note that t(Z ′) is even). Because P(M \
Z ′) = (cid:0)w

If
t(Z ′) ≥ 2, then t(Z ′) ≤ max(M \ Z ′) − 2 ≤ w − 2 and each entry in Z ′ \ Z ′′ is at least
max(M \ Z ′).

2(cid:1) − νo(Z ′) + t(Z ′), it follows from (iv) that t(Z ′) = 0 if M \ Z ′ is empty.

3.1 If t(Z ′) 6= 2, then let Z = Z ′ and let m = 0 if t = 0 and m = max(M \ Z ′) if t > 0. Note

that t = t(Z ′).

35

3.2 If t(Z ′) = 2 and M \ Z ′ * {3, w − 1, w}, then let Z = Z ′ and let m be the largest entry

in M \ Z ′ such that 4 ≤ m ≤ w − 2. Note that t = 2.

3.3 If t(Z ′) = 2, M \ Z ′ ⊆ {3, w − 1, w} and 3 ∈ M \ Z ′, then let Z = (Z ′, 3) and let m = 0.

Note that t = 0.

3.4 If t(Z ′) = 2, M \ Z ′ ⊆ {w − 1, w} and w ∈ M \ Z ′, then let Z = Z ′ \ (min(Z ′′)), and let

m = w. Note that t = 2 + ⌊min(Z ′′)⌋e.

We have min(Z ′′) ≤ w − 3 and hence t ≤ w − 2. Otherwise, because Z ′ \ Z ′′ ⊆ {w},
Z ′ = (wi, (w − 1)w/2+3) for some i and, by the deﬁnition of t(Z ′), t(Z ′) ≡ 6 (mod w). This
contradicts t(Z ′) = 2.

3.5 If t(Z ′) = 2 and M \ Z ′ ⊆ {w − 1}, then let Z = (Z ′ \ (w), w − 1), and let m = w − 1.

Note that t = 4.

There is a w in Z ′ for otherwise Z ′ ⊆ {w − 1} and hence M ⊆ {w − 1} which contradicts
m1 < mτ . Further, because t(Z ′) = 2 and Z ′ = (wi, (w − 1)j) for some i and j, we
have j ≡ 1 (mod w
M \ Z ′ = ((w − 1)h) for some h ≡ −1 (mod w

2 ) and hence can deduce from P(M \ Z ′) = (cid:0)w

2(cid:1) − νo(Z ′) + t(Z ′) that

2 ). Thus h ≥ 2 and so m ∈ M \ Z.

We ﬁrst show that Z is well-behaved. For i ∈ {τ − 1, τ }, because ν(Z ′ \ Z ′′) ≥ 2, if mi is not
added to Z ′′ in step 1 then it is added to Z ′ in step 2. So unless our procedure terminates at step
3.5, (mτ −1, mτ ) is a sublist of Z. If the procedure terminates at step 3.5, then Z ⊆ {w − 1, w},
and it follows that Z is well-behaved.

Let k = ⌈ t+2

3 ⌉e if t ≥ 12 and k = 0 otherwise. We now note some important properties that

hold for any reﬁnement (3a, 4b, 5c, 6d, k) of Z.

(a) 2a + 4b + 4c + 6d + k + t = uw and P(M \ Z) + a + c = (cid:0)w
2(cid:1) − νo(Z) + t.

because Pe Z = uw − t and P(M \ Z) = (cid:0)w

2(cid:1) + t. These properties follow

(b) Either (m, t) = (0, 0), or t ≥ 2 and t + 2 ≤ m ≤ w. This is easy to check in each case.

(c) a + c ≥ w
νo(Z ′′) = w
latter occurs only in case 3.4 when m = w).

2 + 2 and, if m < w, a + c ≥ w
2 + 3. This follows because a + c = νo(Z),
2 + 3 and either Z ′′ is a sublist of Z or Z ′′ \ (min(Z ′′)) is a sublist of Z (the

(d) m ∈ M \ Z if m > 0, and min(Z \ Y ) ≥ m, where Y = Z ′′ \ (min(Z ′′)) if the procedure
terminates at step 3.4 and Y = Z ′′ otherwise. This is clear if m = 0, so we may
suppose that m > 0 and, by (b), that t ≥ 2.
It is easy to check in each case that
m ∈ M \ Z and also that m ∈ M \ Z ′, and it follows that max(M \ Z ′) ≥ m. We noted
min(Z ′ \Z ′′) ≥ max(M \Z ′) after step 2. If the procedure terminated at a step other than
3.5, then min(Z \ Y ) ≥ min(Z ′ \ Z ′′) and the statement holds (note it did not terminate at
step 3.3 because m > 0). If the procedure terminated at step 3.5, then Z \ Y ⊆ {w −1, w}
and m = w − 1, so the statement holds.

Case 1a. Suppose that m ≥ 7. Then t ≥ 2 by (b). Let x = max(Z). Let (3a, 4b, 5c, 6d) be
the basic reﬁnement of (Z \ (x), x − k) if x − k 6= 9 and the basic reﬁnement of (Z \ (x), 4, 5)
if x − k = 9. Note that, by (d) and (b), x ≥ m ≥ t + 2. Thus x − k = x ≥ 7 if t ≤ 10 and,
if t ≥ 12, x − k ≥ t + 2 − ⌈ t+2
3 ⌉e ≥ 8 . It can be seen that a, b, c, d and M \ Z satisfy the
conditions of Lemma 29 using (a) – (d) and the following facts.

36

• c ∈ {0, 1} and a = νo(Z) − c ≥ w

2 + 1. We have c = 0 if x − k 6= 9 and c = 1 if
x − k = 9 because 5 /∈ Y by the deﬁnition of Y , 5 /∈ Z \ Y by (d), and x − k 6= 5. Then
a = νo(Z) − c ≥ w

2 + 1 using (c).

• b ≥ 1. This is obvious if x − k = 9. If x − k 6= 9, the basic reﬁnement of x − k contains a

4 (recall that x − k ≥ 7).

• Either a ≤ w

2 + 3 or uw ≥ (a + c)⌊m⌋e. The former holds if min(Z ′′) < m because then
each odd entry in M \ Z ′′ is less than m by the deﬁnition of Z ′′ and so every entry of
Z \ Y is even by (d). The latter holds if min(Y ) ≥ m because then min(Z) ≥ m by (d)

and so (a + c)⌊m⌋e = νo(Z)⌊m⌋e ≤ Pe Z ≤ uw − t.

• (m, t) 6= (w, 2) and, if a ≥ w

2 + 4, then (m, t) /∈ {(w − 1, 2), (w, 4)}. Clearly (m, t) 6= (w, 2)
and (m, t) 6= (w − 1, 2) because if t = 2, then the procedure terminated at step 3.2 and
m ≤ w − 2. If (m, t) = (w, 4), then Z \ Y ⊆ {w} by (d) and hence a ≤ νo(Z) = νo(Y ) ≤
w
2 + 3.

Case 1b. Suppose that m ≤ 6. Then t ∈ {0, 2, 4} by (b) and k = 0. Let (3a, 4b, 5c, 6d) be
the basic reﬁnement of Z. It can be seen that a, b, c, d and M \ Z satisfy the conditions of
Lemma 34 using (a) – (d) and the following facts.

• If u = 5 then mτ ≤ 5 by our hypotheses so d = 0.

• a ≥ w

2 + 2 because νo(Y ) ≥ w

2 + 2, 5 /∈ Y , and Y is a sublist of Z.

• If b + d ≤ 2 and t ∈ {2, 4}, then a ≤ w

2 + 3. Because b + d ≤ 2, Z \ (y1, y2) ⊆ {3, 5}
for some y1, y2 ∈ Z (note that the basic reﬁnement of any integer in {3, . . . , w} \ {3, 5}
contains a 4 or a 6). For i ∈ {1, 2}, if yi ≥ 7 and yi is odd, then yi ∈ Y and yi /∈ Z \ Y .
Because t ≥ 2, 3 /∈ Z \ Y , using (d) and (b). Thus any odd entries in Z \ Y are 5s and
a ≤ w

2 + 3.

Case 2. Suppose that νo(M) − ν5(M) < w
satisfy the hypotheses of Lemma 34. We choose Z according to the following procedure.

2 + 3, ν5(M) ≥ w and νo(M) ≥ w + 4. We aim to

1. Begin with Z ′′ = (5⌈3w/4⌉) and add the four largest odd entries of M \ (5w) to Z ′′. Note

that ν5(M \ Z ′′) ≥ ⌊ w

4 ⌋ because ν5(M) ≥ w.

Because each odd entry in M is at most min(u, w − 1) ≤ u, Pe Z ′′ ≤ 3w + 2 + 4(u − 1)

and hence t(Z ′′) ≥ (u − 3)(w − 4) − 10. This implies that t(Z ′′) > 0 (note that u ≥ 5 and
w ≥ 10).

2. Begin with Z ′ = Z ′′ and repeatedly add the largest entry of M \ Z ′ to Z ′, until M \ Z ′ is

empty or Z ′ satisﬁes t(Z ′) ≤ max(M \ Z ′) − 2.

It follows from this deﬁnition that t(Z ′) ≥ 0 (note that t(Z ′) is even). Because P(M \
Z ′) = (cid:0)w

If
t(Z ′) ≥ 2, then t(Z ′) ≤ max(M \ Z ′) − 2 ≤ w − 2 and each entry in Z ′ \ Z ′′ is at least
max(M \ Z ′).

2(cid:1) − νo(Z ′) + t(Z ′), it follows from (iv) that t(Z ′) = 0 if M \ Z ′ is empty.

3.1 If M \ Z ′ is empty or max(M \ Z ′) ≤ 6, then let Z = Z ′. Let m = 0 if t = 0 and

m = max(M \ Z) if t > 0. Note that t = t(Z ′) ≤ 4.

37

3.2 If max(M \ Z ′) > 6, then let Z = (Z ′, 5i) where i = ⌊ t(Z ′)

4 ⌋ and let m = 0 if t = 0 and

m = 5 if t = 2. Observe that t = 0 if t(Z ′) ≡ 0 (mod 4) and t = 2 if t(Z ′) ≡ 2 (mod 4).

To see that Z is a sublist of M note that

ν5(M \ Z ′) = ν5(M \ Z ′′) ≥ ⌊ w

4 ⌋ ≥ ⌊ t(Z ′)

4 ⌋ = i

because min(Z ′ \ Z ′′) ≥ max(M \ Z ′) > 6 and t(Z ′) ≤ w − 2. Furthermore, ⌊ w
t(Z ′) ≡ 2 (mod 4) and so 5 ∈ M \ Z when t = 2.

4 ⌋ > i when

We ﬁrst show that Z is well-behaved. This is obvious if u ≤ 7 and hence mτ ≤ 7 by our
hypotheses. If u ≥ 9 then t(Z ′′) ≥ (u − 3)(w − 4) − 10 > 2w and ν(Z ′ \ Z ′′) ≥ 2. Thus, for
i ∈ {τ − 1, τ } if mi is not added to Z ′′ in step 1 then it is added to Z ′ in step 2. So (mτ −1, mτ )
is a sublist of Z and Z is well-behaved.

Let (3a, 4b, 5c, 6d) be the basic reﬁnement of Z. It can be seen using arguments similar to
those of Case 1b that a, b, c, d and M \Z satisfy the hypotheses of Lemma 34. Note that c ≥ 3w
4
and a + c ≥ 3w
4 + 4 because Z ′′ is a sublist of Z. If b + d ≤ 2 and t ≥ 2, then a ≤ 4 because,
by arguments similar to those used in Case 1b, (Z \ (y1, y2)) ⊆ {3, 5} for some y1, y2 ∈ Z and
the only odd entries in Z \ Z ′′ are 5s.
Case 3. Suppose that νo(M) − ν5(M) < w
2 + 3 and that either νo(M) < w + 4 or ν5(M) < w.
We aim to satisfy the hypotheses of Lemma 28. Accordingly we redeﬁne t(X) and t. For a

sublist X of M, we deﬁne t(X) = (u − 1)w − Pe X. Then Pe X = (u − 1)w − t(X) and, by
(iii), P(M \ X) = (cid:0)w+1
2 (cid:1) − νo(X) + t(X). Again, t(X) is always even and we abbreviate t(Z)
2 ≥ 3 since the sum of odd entries in M is greater than w(w−2)
to t. Observe that νo(M) > w−2
Let σ be the sum of the νo(M) − 3 smallest odd entries in M.

.

2

Case 3a. Suppose further that σ ≤ (cid:0)w+1

2 (cid:1). We choose Z according to the following procedure.

1. Let Z ′′ be a list consisting of the largest three odd entries of M.

We have Pe Z ′′ ≤ 3(u − 1) and hence t(Z ′′) ≥ (u − 1)w − 3(u − 1) ≥ 7u − 7 > 5u. Below,

this will imply that ν(Z \ Z ′′) ≥ 5.

2. Begin with Z = Z ′′ and repeatedly add the largest even entry of M \ Z to Z, until M \ Z
contains no even entries or until Z satisﬁes t ≤ maxe(M \ Z) − 2. Let m = 0 if t = 0,
m = max(M \ Z) if t ≥ 4, and let m be an entry of M \ Z such that 4 ≤ m ≤ w − 1 if
t = 2 (we show below that such an entry exists).

It follows from this deﬁnition that t ≥ 0. To show that a suitable choice of m exists when
t = 2, suppose otherwise that M \ Z ⊆ {3, w}. Then, the sum of the odd entries in M is
at most 3(w − 1) + 3( w
2 − 6, because each of the three odd entries in Z is at
most w − 1, each odd entry in M \ Z is a 3, and νo(M) − ν5(M) ≤ w
2 + 2. This contradicts
our assumption that the sum of the odd entries in M is greater than w(w−2)
(note that
w ≥ 10).

2 − 1) = 9w

2

For i ∈ {τ − 1, τ }, because ν(Z \ Z ′′) ≥ 2, if mi is not added to Z ′′ in step 1 then it is
added to Z in step 2. Thus (mτ −1, mτ ) is a sublist of Z and Z is well-behaved. Let k = ⌈ t+2
3 ⌉e
if t ≥ 12 and k = 0 otherwise. Let (3a, 4b, 5c, 6d) be the basic reﬁnement of (Z \ (mτ ), mτ − k).
If mτ ≤ 6, then mτ − k = mτ . If mτ ≥ 7 then, as in Case 1a, mτ − k ≥ 7. Using arguments
similar to those in the previous cases and the following facts we can see that a, b, c, d and
M \ Z satisfy the conditions of Lemma 28.

38

• a + c = νo(Z) = 3 and (m, t) 6= (w, 2). The former follows from the deﬁnition of Z (note

that mτ − k and mτ have the same parity). The latter follows from our choice of m.

• m ≥ t + 2 if t > 0. If t = 2 this is obvious by our choice of m, so we may suppose that

t ≥ 4. We have P(M \ Z) = (cid:0)w+1
However, the sum of the odd entries in M \ Z is σ, and σ ≤ (cid:0)w+1

2 (cid:1) − νo(Z) + t > (cid:0)w+1

even entry and we have m ≥ maxe(M \ Z) ≥ t + 2 by the deﬁnition of Z.

2 (cid:1) because νo(Z) = 3 and t ≥ 4.
2 (cid:1). Thus M \ Z has an

Case 3b. Suppose further that σ > (cid:0)w+1

2 (cid:1). We choose Z according to the following procedure.

1. Let Z ′′ be a sublist of M with maximum sum subject to the constraints that ν(Z ′′) =

νo(Z ′′) = 6 and ν5(Z ′′) ≤ 1.

Such a sublist exists because νo(M) ≥ 6 and νo(M) − ν5(M) ≥ 5. These facts must hold

because σ > (cid:0)w+1
2 (cid:1) and since either νo(M) ≤ w + 3 or ν5(M) ≤ w − 1 by the criteria for
Case 3. We have Pe Z ′′ ≤ 6(u − 1) and hence t(Z ′′) ≥ (u − 1)w − 6(u − 1) > 3u. Below,

this will imply that ν(Z \ Z ′′) ≥ 3.

2. Begin with Z = Z ′′ and repeatedly add to Z the largest entry of M \ Z not equal to 5
until Z satisﬁes t ≤ max(M \ Z) − 2. Let m = max(M \ Z) if t > 0 and let m = 0 if
t = 0.

because P(M \ Z) = (cid:0)w+1

It follows from this deﬁnition that t ≥ 0. This process terminates with M \ Z * {5},
2 + 2) − 1 ≥ 5w − 3 and 5ν5(M \ Z) ≤
5ν5(M) ≤ 5(w−1), using the criteria for Case 3 and the fact that ν5(Z) = ν5(Z ′′) ∈ {0, 1}.
Note that t ≤ max(M \ Z) − 2 ≤ w − 2.

2 (cid:1) − νo(Z) + t ≥ 11w

2 − ( w

We must have mτ ≥ 7 for otherwise, by the criteria for Case 3, σ ≤ 3( w

13w

2 − 14, contradicting σ > (cid:0)w+1

if mi is not added to Z ′′ in step 1 then it is added to Z in step 2 (note that if mτ −1 = 5 then
mτ −1 ∈ Z ′′). Thus (mτ −1, mτ ) is a sublist of Z and Z is well-behaved.

2 + 2) + 5(w − 4) =
2 (cid:1) (note w ≥ 10). So, for i ∈ {τ − 1, τ }, because ν(Z \ Z ′′) ≥ 2,

Let k = ⌈ t+2

3 ⌉e if t ≥ 12 and k = 0 otherwise. Let (3a, 4b, 5c, 6d) be the basic reﬁnement of
(Z \ (mτ ), mτ − k) if mτ − k 6= 9 and the basic reﬁnement of (Z \ (mτ ), 4, 5) if mτ − k = 9.
As in Case 1a, mτ − k ≥ 7. Using arguments similar to those in the previous cases and the
following facts we can see that a, b, c, d and M \ Z satisfy the conditions of Lemma 28.

• a + 2c ≤ w. We have a + 2c ≤ νo(Z) + ν5(Z) + 1 (equality occurs when mτ − k = 9).
2 + 2

2 + 5 ≤ w by the deﬁnition of Z and because νo(M) − ν5(M) ≤ w

Thus, a + 2c ≤ w
and ν5(Z) = ν5(Z ′′) ≤ 1.

• a + c ≥ 6 because a + c = νo(Z) ≥ νo(Z ′′) = 6.

• b ≥ 1 as in Case 1a.

Acknowledgements

The ﬁrst author was supported by Australian Research Council grants DE120100040 and

DP150100506. The second author was supported by an Australian Postgraduate Award.

39

References

[1] Bahmanian, M. A., and ˇSajna, M. Decomposing complete equipartite multigraphs into
cycles of variable lengths: the amalgamation-detachment approach. J. Combin. Des. 24,
4 (2016), 165–183.

[2] Bryant, D. E., Horsley, D., Maenhaut, B. M., and Smith, B. R. Cycle decompositions of

complete multigraphs. J. Combin. Des. 19, 1 (2011), 42–69.

[3] Bryant, D. E., Hoﬀman, D. G., and Rodger, C. A. 5-cycle systems with holes. Des. Codes

Cryptogr. 8, 1-2 (1996), 103–108.

[4] Bryant, D. E., and Horsley, D. Decompositions of complete graphs into long cycles. Bull.

Lond. Math. Soc. 41, 5 (2009), 927–934.

[5] Bryant, D. E., and Horsley, D. An asymptotic solution to the cycle decomposition problem

for complete graphs. J. Combin. Theory Ser. A 117, 8 (2010), 1258–1284.

[6] Bryant, D. E., Horsley, D., and Maenhaut, B. M. Decompositions into 2-regular subgraphs
and equitable partial cycle decompositions. J. Combin. Theory Ser. B 93, 1 (2005), 67–72.

[7] Bryant, D. E., Horsley, D., and Pettersson, W. Cycle decompositions V: Complete graphs

into cycles of arbitrary lengths. Proc. Lond. Math. Soc. (3) 108, 5 (2014), 1153–1192.

[8] Bryant, D. E., Rodger, C. A., and Spicer, E. R. Embeddings of m-cycle systems and

incomplete m-cycle systems: m ≤ 14. Discrete Math. 171, 1-3 (1997), 55–75.

[9] Chou, C.-C., Fu, C.-M., and Huang, W.-C. Decomposition of Km,n into short cycles.

Discrete Math. 197/198 (1999), 195–203.

[10] Doyen, J., and Wilson, R. M. Embeddings of Steiner triple systems. Discrete Math. 5

(1973), 229–239.

[11] Fournier, J.-C. Colorations des arˆetes d’un graphe. Cahiers Centre ´Etudes Recherche

Op´er. 15 (1973), 311–314. Colloque sur la Th´eorie des Graphes (Brussels, 1973).

[12] Horsley, D. Decomposing various graphs into short even-length cycles. Ann. Comb. 16, 3

(2012), 571–589.

[13] Horsley, D., and Hoyte, R. A. Doyen-Wilson results for odd length cycle systems. J.

Combin. Des. (2015), doi:10.1002/jcd.21431.

[14] Kirkman, T. On a problem in combinations. Cambridge and Dublin Math. J. 2 (1847),

191–204.

[15] Lucas, E. R´ecr´eations Math´ematiques. Vol II. Gauthier-Villars, Paris, 1892.

[16] McDiarmid, C. J. H. The solution of a timetabling problem. J. Inst. Math. Appl. 9 (1972),

23–34.

[17] Mendelsohn, E., and Rosa, A. Embedding maximal packings of triples. Congr. Numer. 40

(1983), 235–247.

40

[18] Sotteau, D. Decomposition of Km,n (K ∗

m,n) into cycles (circuits) of length 2k. J. Combin.

Theory Ser. B 30, 1 (1981), 75–81.

41

