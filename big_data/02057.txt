6
1
0
2

 

b
e
F
8
1

 

 
 
]

.

R
P
h
t
a
m

[
 
 

1
v
7
5
0
2
0

.

3
0
6
1
:
v
i
X
r
a

BOOTSTRAP PERCOLATION ON GEOMETRIC

INHOMOGENEOUS RANDOM GRAPHS

CHRISTOPH KOCH

Institute of Discrete Mathematics

Graz University of Technology, 8010 Graz, Austria

JOHANNES LENGLER

Institute of Theoretical Computer Science

ETH Z¨urich, 8092 Z¨urich, Switzerland

Abstract. Geometric inhomogeneous random graphs (GIRGs) are a model
for scale-free networks with underlying geometry. We study bootstrap perco-
lation on these graphs, which is a process modelling the spread of an infection
of vertices starting within a (small) local region. We show that the process
exhibits a phase transition in terms of the initial infection rate in this region.
We determine the speed of the process in the supercritical case, up to lower
order terms, and show that its evolution is fundamentally inﬂuenced by the
underlying geometry. For vertices with given position and expected degree,
we determine the infection time up to lower order terms. Finally, we show
how this knowledge can be used to contain the infection locally by removing
relatively few edges from the graph. This is the ﬁrst time that the role of
geometry on bootstrap percolation is analysed mathematically for geometric
scale-free networks.

Keywords: geometric inhomogeneous random graphs, scale-free network, bootstrap
percolation, localized infection process, metastability threshold
Mathematics Subject Classiﬁcation: 05C80, 05C82, 60C05, 60K35, 91D25.

1. Introduction

One of the most challenging and intriguing questions about large real-world net-
works is how activity spreads through the network. “Activity” in this context can
mean many things, including infections in a population network, opinions and ru-
mours in social networks, viruses in computer networks, action potentials in neural
networks, and many more. While all these networks seem very diﬀerent, in the
last two decades there was growing evidence that most of them share fundamental
properties [4, 24]. The most famous property is that the networks are scale-free,
i.e. the degrees follow a power-law distribution Pr[deg(v) ≥ d] ≈ d1−β, typically

E-mail addresses: ckoch@math.tugraz.at , johannes.lengler@inf.ethz.ch.
Date: March 8, 2016.
Most of the research was conducted during the ﬁrst author’s stay at ETH Z¨urich. The ﬁrst

author is supported by Austrian Science Fund (FWF): P26826 and W1230.

1

2

C. KOCH AND J. LENGLER

for some 2 < β < 3. Other properties include a large connected component which
is a small world (poly-logarithmic diameter) and an ultra-small world (constant or
poly-loglog average distance), that the networks have small separators and a large
clustering coeﬃcient. We refer the reader to [15] for more detailed discussions.

Classical models for random graphs fail to have these common properties. For
example, Erd˝os-R´enyi graphs or Watts-Strogatz graphs do not have power-law de-
grees, while Chung-Lu graphs and preferential attachment (PA) graphs fail to have
large clustering coeﬃcients or small separators. The latter properties typically arise
in real-world network from an underlying geometry, either spatial or more abstract,
e.g., two nodes in a social networks might be considered “close” if they share similar
professions or hobbies. It is well-known that in real-world networks the spread of
activity (of the ﬂu, of viral marketing, ...) is crucially governed by the underlying
spatial or abstract geometry [41]. For this reason, the explanatory power of classical
models is limited in this context.

In recent years models have been developed which overcome the previously men-
tioned limitations, most notably hyperbolic random graphs (HypRGs) [13, 12, 10, 44]
and their generalization geometric inhomogeneous random graphs (GIRGs) [15], and
spatial preferential attachment (SPA) models [2, 22, 35]. Apart from the power-law
exponent β, these models come with a second parameter α > 1, which models how
strongly the edges are predicted by their distance. Due to their novelty, there are
only very few theoretical results on how the geometry impacts the spreading of
activity through these networks.

In this paper we make a ﬁrst step by analysing a speciﬁc process, bootstrap
percolation [20], on the recent and very general GIRG model.
In this process,
an initial set of infected or active vertices (the bootstrap) iteratively recruits all
vertices which have at least k infected neighbours, where k ≥ 2 is a parameter.
It was originally developed to model various physical phenomena (see [1] for a
short review), but has by now also become an established model for the spreading
of activity in networks, for example for the spreading of beliefs [32, 25, 48, 45],
behaviour [30, 31], or viral marketing [38] in social networks (see also [19]), of
contagion in economic networks [6], of failures in physical networks of infrastruc-
ture [52] or compute architecture [39, 28], of action potentials in neuronal networks
(e.g, [47, 49, 5, 21, 50, 43, 26, 27], see also [40] for a review), and of infections in
life networks [25].

1.1. Our contribution. We investigate bootstrap percolation on GIRGs with an
expected number of n vertices. We ﬁx a ball B in the underlying geometric space,
and we form the bootstrap by infecting each vertex in B independently with prob-
ability ρ. In this way, we model that an infection (a rumour, an opinion, ...) often
starts in some local region, and from there spreads to larger parts of the network.
In Theorem 1 we determine a threshold ρc such that in the supercritical case ρ ≫ ρc
whp1 a linear fraction of the graph is infected eventually, and in the subcritical case
ρ ≪ ρc infection ceases immediately. In the critical case ρ = Θ(ρc) both options
occur with non-vanishing probability: if there are enough (at least k) “local hubs”
in the starting region, i.e. vertices of relatively large expected degree, then they
become infected and facilitate the process. Without such local hubs the initial
infection is not dense enough, and comes to a halt.

1with high probability, i.e. with probability tending to 1 as n → ∞

BOOTSTRAP PERCOLATION ON GEOMETRIC INHOMOGENEOUS RANDOM GRAPHS 3

For the supercritical case, we show that it only takes O(log log n) rounds until a
constant fraction of all vertices is active, and we determine the number of rounds
until this happens up to a factor 1 ± o(1) in Theorem 2. For the matching lower
bound in this result, we need the technical condition α > β − 1, i.e. edge-formation
may not depend too weakly on the geometry. Notably, if the starting region B is
suﬃciently small then the number of rounds agrees (up to minor terms) with the
average distance in the network. In particular, it does not depend on the infection
rate ρ, as long as ρ is supercritical.

Finally we demonstrate that the way activity spreads is strongly governed by
the geometry of the process, again under the assumption α > β − 1. Starting from
B, the activity is carried most quickly by local hubs. Once the local hubs in a
region are infected, they pass on their infection (i) to other hubs that are even
further away, and (ii) locally to nodes of increasingly lower degree, until a constant
fraction of all vertices the region is infected. Indeed, given a vertex v (i.e. given its
expected degree and its distance from B), and assuming that v is not too close to
B, we can predict whp (Theorem 4) in which round it will turn active, again up to
a factor 1 ± o(1). In real applications such knowledge is invaluable: for example,
assume that a policy-maker only knows initial time and place of the infection, i.e.
she knows the region B and the current round i. In particular, she does not know
ρ, she does not know the graph, and she has no detailed knowledge about who
is infected. Then we show that she is able to identify a region B′ in which the
infection can be quarantined. In other words, by removing (from round i onwards)
all edges crossing the boundary of B′ whp the infection remains contained in B′.
The number of edges to be deleted is relatively small: it can be much smaller than
n (in fact, any function f (n) = ω(1) can be an upper bound, if i and Vol(B) are
suﬃciently small), and it is even much smaller than the number of edges inside of
B′, as was already noted in [15].

1.2. Related work. The GIRG model was introduced in [15], and we rely on
many results from this paper. The average distance of a GIRG (which, as we show,
agrees with the time until the bootstrap percolation process has infected a constant
portion of all vertices) was determined in [16] in a much more general setup.

Bootstrap percolation has been intensively studied theoretically and experimen-
tally on a multitude of networks, including trees [20, 9], lattices [3, 8], Erd˝os-
R´enyi graphs [36], various geometric graphs [49, 42, 14, 29], and scale-free net-
works [23, 11, 7, 38]. On geometric scale-free networks there are some experi-
mental results [18], but little is known theoretically. Recently, Candellero and
Fountoulakis [17] determined the threshold for bootstrap percolation on HypRGs
(in the threshold case α = ∞, cf. below), but they assumed that the bootstrap
is uniformly sampled from all vertices, and not from a geometric region as in our
paper. In particular, in this case the bootstrap needs to be polynomial in n to start
an infection, while in our setting every ball which contains an expected number of
ω(1) vertices can initiate a large infection whp. Also, due to their setup the authors
did not investigate how activity spreads along the geometry of the ground space.

While there is plenty of experimental literature and also some mean-ﬁeld heuris-
tics on other activity spreading processes on geometric scale-free networks (e.g., [51,
53, 34, 54, 33, 46]), rigorous mathematical treatments are non-existent with the no-
table exception of [37], where rumour spreading is analysed in an SPA model with
a push and a push&pull protocol.

4

C. KOCH AND J. LENGLER

2. Model and notation

2.1. Graph model. A GIRG is a graph G = (V, E) where both the vertex set V
and the edge set E are random. Each vertex v is represented by a pair (xv, wv)
consisting of a position xv (in some ground space) and a weight wv ∈ R>0.

2.1.1. Ground space and positions. We ﬁx a (constant) dimension d ≥ 1 and con-
sider the d-dimensional torus Td = Rd/Zd as the ground space. We usually think
of it as the d-dimensional cube [0, 1]d where opposite boundaries are identiﬁed and
measure distances by the ∞-norm on Td, i.e. for x, y ∈ [0, 1]d we deﬁne

kx − yk := max
1≤i≤d

min{|xi − yi|, 1 − |xi − yi|}.

The set of vertices and their positions are given by a homogeneous Poisson point
process on Td with intensity n ∈ N.2 More formally, for any (Lebesgue-)measurable
set B ⊆ Td, let V ∩ B denote (with slight abuse of notation) the set of vertices with
positions in B. Then |V ∩ B| is Poisson distributed with mean nVol(B), i.e. for any
integer m ≥ 0 we have

Pr [|V ∩ B| = m] = Pr[Po (nVol(B)) = m] =

(nVol(B))m exp(−nVol(B))

m!

,

and if B and B′ are disjoint measurable subsets of Td then |V ∩ B| and |V ∩ B′| are
independent. Note in particular that the total number of vertices |V | is Poisson
distributed with mean n, i.e. it is also random. An important property of this
process is the following: Given a vertex v = (xv, wv), if we condition on xv ∈ B,
where B is some measurable subset of [0, 1]d, then the position xv is uniformly
distributed in B.

2.1.2. Weights. For each vertex, we draw independently a weight from some dis-
tribution D on R>0. We say that the weights follow a weak power-law for some
exponent β ∈ (2, 3) if a D-distributed random variable D satisﬁes the following two
conditions: There is a constant wmin ∈ R>0 such that Pr [D ≥ wmin] = 1, and for
every constant γ > 0 there are constants 0 < c1 ≤ c2 such that

c1w1−β−γ ≤ Pr [D ≥ w] ≤ c2w1−β+γ

(1)

for all w ≥ wmin. If this condition is also satisﬁed for γ = 0, then we say that the
weights follow a strong power-law.

2.1.3. Edges. Next we ﬁx an α ∈ R>1 ∪ {∞}. Then two distinct vertices u =
(xu, wu) and v = (xv, wv) form an edge independently of all other pairs with prob-
ability p(xu, xv, wu, wv), where the function p satisﬁes

if α < ∞. In the threshold model α = ∞ we instead require that p satisﬁes

2Throughout the paper, all Landau notation will be used with respect to n. For example, the
notation x = O(1) means that there is n0 > 0 and an absolute constant C > 0 that depends only
the constant parameters of the GIRG model, such that x ≤ C for all n ≥ n0.

p(xu, xv, wu, wv) = Θ(1) min(cid:26)(cid:18)
p(xu, xv, wu, wv) =(Ω(1)

0

wuwv

kxu − xvkdn(cid:19)α
, 1(cid:27) ,
if kxu − xvk ≤ C1(cid:0) wuwv
n (cid:1)1/d
n (cid:1)1/d
if kxu − xvk > C2(cid:0) wuwv

(2)

(3)

BOOTSTRAP PERCOLATION ON GEOMETRIC INHOMOGENEOUS RANDOM GRAPHS 5

for some constants 0 < C1 ≤ C2 . Note that for C1 6= C2 the edge probability may

be arbitrary in the interval(cid:16)C1(cid:0) wuwv
n (cid:1)1/d

, C2(cid:0) wuwv

n (cid:1)1/d(cid:17).

2.2. Bootstrap percolation. Let k ≥ 2 be a constant, let B0 ⊆ Td be measurable,
and let 0 ≤ ρ ≤ 1. Then the bootstrap percolation process with threshold k, starting
region B0, and initial infection rate ρ is the following process. For every integer
i ≥ 0 there is a set V ≤i ⊆ V of vertices which are infected (or active) at time i. The
process starts with a random set V ≤0 ⊆ V which contains each vertex in V ∩ B0
independently with probability ρ, and which contains no other vertices. Then we
deﬁne iteratively

V ≤i+1 := V ≤i ∪(cid:8)v ∈ V (cid:12)(cid:12) v has at least k neighbours in V ≤i(cid:9)

for all i ≥ 0. Moreover, we set V ≤∞ :=Si∈N V ≤i.

We denote by ν := nVol(B0) the expected number of vertices in B0. Throughout
the paper we will assume that B0 is a ball, which is – without loss of generality due
to symmetry of Td – centred at 0. Moreover, we will assume that ν = ω(1).

2.3. Further notation. We often consider subsets of the vertex sets which satisfy
some restrictions on their weights, positions, or activity. We use the following
notation throughout the paper: For a weight w ∈ R>0, a measurable set B ⊆ Td,
and a time i ≥ 0 we set

V ≤i

≥w∩ B :=(cid:8)u = (xu, wu) ∈ V (cid:12)(cid:12) wu ≥ w, xu ∈ B, u ∈ V ≤i(cid:9) .

All three types of restrictions are optional. Moreover, we use the superscript “(= i)”
to describe vertices which are infected in round i, i.e. V =i := V ≤i \ V ≤i−1 and
V =0 := V ≤0 etc. Furthermore, the index “≥ w” may be replaced by “< w” or
“∈ [w, w′)”, with the obvious meaning. Additionally, we denote the neighbourhood
of a vertex v ∈ V by N (v) := {u ∈ V | {u, v} ∈ E} and this notation may be
modiﬁed by the same three types of restrictions, i.e.
≥w(v)∩ B := N (v) ∩ V ≤i

≥w∩ B.

N ≤i

For any two sets of vertices U1 and U2, we denote the set of edges between them
by E (U1, U2) := {e = {u1, u2} | u1 ∈ U1, u2 ∈ U2}. For a vertex v ∈ V , we deﬁne

its infection time as Lv := inf(cid:8)i ≥ 0(cid:12)(cid:12) v ∈ V ≤i(cid:9) and Lv := ∞ if the inﬁmum does

For any λ ≥ 0 and any closed ball B ⊆ Td of radius r ≥ 0 centred at 0 we denote

not exist.

by λB the closed ball of radius λr around 0.

Since it occurs frequently in our proofs, we abbreviate ζ := 1/(β − 2) > 1. For

all 0 < ε < ζ and all i ≥ 0, we set

ν0 := ν

eν0 :=eν0(ε) := ν(β−1)/(β−2)+ε

We deﬁne Bi := Bi(ε) and eBi := eBi(ε) to be the closed ball centred around 0 of
volume min{νi(ε)/n, 1} and min{eνi(ε)/n, 1}, respectively. Note that Bi(ε) ⊆ eBi(ε′)
for all i ≥ 0 and all 0 < ε, ε′ < ζ. The balls Bi and eBi will play a crucial role in

describing how fast the infection spreads, cf. Theorem 17 and Theorem 19.

and

and

νi := νi(ε) := ν(ζ−ε)i

0

,

eνi :=eνi(ε) :=eν(ζ+ε)i

0

6

C. KOCH AND J. LENGLER

Given any constant η > 0, we deﬁne the functions ˆw(η)
ˆw−(µ) := ˆw(η)

− (µ) := µ1/(β−1+η)

ˆw+(µ) := ˆw(η)

and

− , ˆw(η)

+ : R≥0 → R≥0 by
+ (µ) := µ1/(β−1−η).

As we will see in Lemma 15, in a region with an expected number of µ = ω(1)
vertices, whp the largest weight that occurs in this region is in [ ˆw−(µ), ˆw+(µ)].

In general we will be interested in results for large values of n, and in particular
we use the phrase with high probability (whp) to mean with probability tending to
1 as n → ∞. Moreover, any unspeciﬁed limits and asymptotics will be with respect
to n → ∞. In the proofs, for the sake of readability, we will not state each time
when we use inequalities that only hold for suﬃciently large n. For example, we
will use inequalities like ν > 2 without further comment although they are only
true for suﬃciently large n.

Furthermore, all constants hidden by Landau-notation are positive. We often
use statements that depend on parameters ε, η > 0. In this case, by the notation
O(ε), O(η) etc. we implicitly mean that the hidden constants only depend on the
parameters d, α, β, wmin, D, ρ, and k of the model, but not on ε or η. To enhance
readability, in all proofs we stick to the convention that if ε and η occur together,
then η = η(ε) > 0 is chosen so small that Cη < cε for all concrete constants C
and c in our proofs that depend only on the model parameters. In particular, the
expression Ω(ε) − O(η) will be positive for all hidden constants that appear in our
proofs.

Throughout the paper we will ignore all events of probability 0. For example,
we will always assume that V is a ﬁnite set, and that all vertices in V have diﬀerent
positions. Furthermore, whenever it does not aﬀect the argument, we omit ﬂoors
and ceilings.

3. Main results

First of all we show that bootstrap percolation on a GIRG has at threshold with
respect to the initial infection rate ρ. Since hyperbolic random graphs are a special
instance of GIRGs, this contains in particular the result of [17] on (threshold)
hyperbolic random graphs, where the case ν = n was studied.

Theorem 1. Consider a bootstrap percolation process on a GIRG G = (V, E) with
initial infection rate ρ = ρ(n) ∈ [0, 1]. We set

ρc = ρc(n) := ν− 1

β−1 .

If the weights follow a strong power-law, then:

(i) If ρ = ω(ρc), then |V ≤∞| = Θ(n) whp.
(ii) If ρ = Θ(ρc), then |V ≤∞| = Θ(n) with probability Ω(1), but also V ≤∞ = V ≤0

with probability Ω(1).

(iii) If ρ = o(ρc), then V ≤∞ = V ≤0 whp.
If the weights follow a weak power-law, then:
(iv) If there is a constant δ > 0 such that ρ ≥ ρ1+δ
(v) If there is a constant δ > 0 such that ρ ≤ ρ1−δ

c

c

, then |V ≤∞| = Θ(n) whp.
, then V ≤∞ = V ≤0 whp.

Whenever we refer to the supercritical regime we mean case (i) and (iv). Simi-
larly, (iii) and (v) form the subcritical regime and (ii) is the critical regime. Note
in particular that there is a supercritical regime regardless of how small the ex-
pected number ν of vertices in the starting region is, provided that ν = ω(1). This

BOOTSTRAP PERCOLATION ON GEOMETRIC INHOMOGENEOUS RANDOM GRAPHS 7

is in sharp contrast to non-geometric graphs like Chung-Lu graphs, where the ex-
pected size of the bootstrap must be polynomial in n (if the bootstrap is chosen at
random).

Indeed the proof of Theorem 1 will grant a deeper insight into the evolution of
the process. Since the process whp stops immediately in the subcritical regime,
we may restrict ourselves to the other cases. We show a doubly logarithmic upper
bound on the number of rounds until a constant fraction of all vertices are infected.
Furthermore, we prove that this bound is tight up to minor order terms if the
inﬂuence of the underlying geometry on the random graphs is suﬃciently strong
(α > β − 1). Remarkably, the bounds do not depend on the initial infection rate
ρ, as long as ρ is supercritical. Moreover, if the expected number ν of vertices in
the starting region is suﬃciently small (if log log ν = o(log log n)), then the bound
coincides with the average distance in the graph, again up to minor order terms.

Theorem 2. In the situation of Theorem 1, let ε > 0 be constant and set

i∞ :=

log logν n + log log n

| log(β − 2)|

.

Then in the supercritical regime whp, and in the critical regime with probability
Ω(1) we have |V ≤(1+ε)i∞ | = Θ(n).
If furthermore α > β−1 and ν = no(1) then in all regimes we have whp |V ≤(1−ε)i∞ | =
o(n).

The proof of Theorem 1 and Theorem 2 can be found in Section 8.
In fact, we can still reﬁne the statement of Theorem 2 tremendously, at least
in the case α > β − 1. In the following, we determine for every ﬁxed vertex v its
infection time Lv, up to minor order terms (with the restriction that v may not
be too close to the starting region). We will show that it is given by the following
expression (see also Remark 6 below).

Deﬁnition 3. For any x ∈ Td \ B0 and w ∈ R>0 we deﬁne

wv = ω(1) and Λ(xv, wv) ≤ log2(kxvkdn/eν0). Then whp

Lv ≤ (1 + o(1))Λ(xv, wv) + O(1).

If additionally α > β − 1 then we also have whp

Lv ≥ (1 − o(1))Λ(xv, wv) − O(1).

(5)

(6)

max(cid:26)0,

log logν(kxkdn/w)

| log(β−2)|

(cid:27) ,

if w > (kxkdn)1/(β−1),

(4)

2 log logν (kxkdn)−log logν w

| log(β−2)|

,

if w ≤ (kxkdn)1/(β−1).

Λ(x, w) :=

In the ﬁrst case we use the convention that the second term is −∞ if kxkdn/w < 1,
and thus does not contribute to the maximum.

Note that in the second case, the sign of log logν w may be either positive or neg-
ative. However, then we have the lower bound Λ(x, w) ≥ log logν(kxkdn)/| log(β −
2)| + O(1) due to the upper bound of w and thus, in particular Λ(x, w) ≥ 0, since
x ∈ Td \ B0.

Theorem 4. Assume we are in the situation of Theorem 1 in the supercritical
regime (i) or (iv). Let v = (xv, wv) be any ﬁxed vertex such that xv ∈ Td \ B0,

8

C. KOCH AND J. LENGLER

As in Theorem 2, the bounds do not depend on the initial infection rate ρ, as
long as it is supercritical. Before we come to applications, we give two explanatory
remarks on Theorem 4.

Remark 5. The technical restrictions in Theorem 4 are necessary: if a vertex has
weight wv = O(1) then the number of neighbours is Poisson distributed with mean
Θ(wv) (see Lemma 12), so v is even isolated with probability Ω(1). In particular,
we cannot expected that whp v is ever infected.

the cost of more technical proofs. However, there are already rather few vertices

the starting region. If v is too close, then it may have neighbours inside of B0,
and in this case it does depend on ρ when they are infected. (And of course, this

The restriction Λ(xv, wv) ≤ log2(kxvkdn/eν0) ensures that v is not too close to
process iterates.) The term log2(kxvkdn/eν0) is not tight and could be improved at
that violate the condition Λ(xv, wv) ≤ log2(kxvkdn/eν0). For example, recall that
At this time, we only exclude vertices which satisfy kxvkdn ≤ eν0 · (log n)O(1), so
the expected number of aﬀected vertices is also at most eν0 · (log n)O(1). Even this

is a gross overestimate, since the vertices close to the origin have much smaller
infection times Lv, and thus only very few of them are aﬀected by the condition.

it only takes O(log log n) steps until a constant fraction of all vertices are infected.

Remark 6. The ﬁrst case in Deﬁnition 3 is not needed if we restrict ourselves
to vertices as they typically appear in GIRGs. More precisely, as we will show
in Lemma 15, Section 5, whp all vertices in v = (xv, wv) ∈ V ∩ (Td \ B0) satisfy
wv ≤ (kxvkdn)1/(β−1−η) where η > 0 is an arbitrary constant. In the border case
(kxvkdn)1/(β−1) ≤ wv ≤ (kxvkdn)1/(β−1−η) both expressions in (4) agree up to
additive constants, i.e.

Λ(xv, wv) =

2 log logν (kxvkdn) − log logν wv

| log(β − 2)|

± O(1).

(7)

Therefore, we could also use (7) as deﬁnition for Λ if we would exclude vertices
which are unlikely to exist in Theorem 4 .

Finally, we give a strategy how to contain the infection within a certain region
when only the starting set and the current round a known, but not the set of infected
vertices. Note that the number of edges that need to be removed is substantially

proof can be found in Section 6.2.

Corollary 7. Assume that we are in the situation of Theorem 1, and that α > β−1.
If the starting region B0 is known, then by removing all edges crossing the boundary

smaller than the expected number of vertices eνi in the containment area eBi. The
of eBi before round i + 1, whp the infection is contained in eBi. The expected number
of edges crossing the boundary of eBi is eνmax{3−β,1−1/d}+o(1)

4. Tools

.

i

In this section we collect basic tools and observations that we use throughout
the paper. We start with a fact which often allows us to treat the case α = ∞
along with the case of ﬁnite α without case distinction.

Observation 8. For every function p satisfying (3) and every α ∈ R>1, there
is a function ¯p satisfying (2) such that ¯p(x1, x2, w1, w2) ≥ p(x1, x2, w1, w2) for all
x1, x2 ∈ Td and all w1, w2 ≥ wmin.

BOOTSTRAP PERCOLATION ON GEOMETRIC INHOMOGENEOUS RANDOM GRAPHS 9

In other words, GIRGs in the threshold case α = ∞ are dominated by GIRGs
with ﬁnite α. In particular, whenever we prove an upper bound on the number of
active vertices that holds for all GIRGs with ﬁnite α, the same upper bound also
holds for threshold GIRGs.

In [15], GIRGs were deﬁned with a ﬁxed number of vertices, while we assume
the set of vertices to be given by a homogeneous Poisson point process. Our choice
allows for slightly less technical proofs.
In particular, one of the beneﬁts of the
Poisson point process is the following elementary fact.

Fact 9. Let λ ∈ R≥0 and let X be a Poisson distributed random variable with
mean λ. Furthermore, given some 0 ≤ q ≤ 1, let Y be a random variable which
conditioned on {X = x}, for any x ∈ N0, is the sum of x independent Bernoulli
random variables with mean q. Then Y is Poisson distributed with mean qλ.

This means that for instance |N≥w(v)∩ B| is Poisson distributed with mean
nq, where q denotes the probability that a vertex u with random position xu and
random weight wu satisﬁes wu ≥ w and xu ∈ B, and is a neighbours of v. We will
apply this observation throughout the paper without giving explicit reference.

An easy way to bound the expectation

Lemma 10 (Lemma 4.1 in [16]). Let 0 ≤ w0 < w1, and let f : R≥0 → R≥0 be a
piecewise continuously diﬀerentiable function. Then in any ﬁnite set V of weighted
vertices, we have

f (wv) = f (w0)|V≥w0 | − f (w1)|V≥w1 | + Z w1

w0

|V≥w|

d
dw

f (w)dw.

Note in particular that if f (0) = 0, then, by using w0 = 0 and w1 > max{wv |

Xv∈V,w0≤wv <w1

v ∈ V }, we have

f (wv) =Z w1

0

|V≥w|

d
dw

f (w)dw =Z ∞

0

|V≥w|

d
dw

f (w)dw.

Xv∈V

The lemma is actually formulated slightly more general than Lemma 4.1 in [16].
First, in [16] the lemma was only formulated if V is the vertex set of a GIRG, but
their proof does not use this restriction. Second, f was assumed to be everywhere
continuously diﬀerentiable. However, our version follows immediately by applying
Lemma 4.1 in [16] to every continuously diﬀerentiable piece, and by noting that all
the intermediate terms cancel out.3

The next lemma spells out an almost trivial calculation, but since it is ubiquitous
in our proofs, we state it as a lemma nevertheless.
In our applications, g(w) is
typically the number of vertices of weight at least w (possibly with additional
restrictions), and f is the probability that such a vertex has a certain property
(e.g., that it forms an edge with some ﬁxed v). After application of Lemma 10, this
almost always leads to an integral as given in (8) below.

Lemma 11. Let g : R≥0 → R≥0 be a non-zero monomial, and let f : R≥0 → R≥0
be continuous and piecewise a non-zero monomial with non-negative exponent, for
a ﬁnite number of pieces. Moreover, assume that there is ˜w such that the exponent

3Formally speaking, the term d

dw f (w) is a distribution and not a function if f is not diﬀer-
entiable everywhere, and the integral is then to be understood as evaluation of the distribution.
However, in our simple applications we may just ignore the values where f is not diﬀerentiable.

10

C. KOCH AND J. LENGLER

of w in f (w)g(w) is strictly larger than 0 for w < ˜w, and strictly smaller than 0
for w > ˜w. Then for every w0 ≤ ˜w ≤ w1,

Z w1

w0

g(w)

d
dw

f (w)dw = O(f ( ˜w)g( ˜w)).

(8)

Moreover, assume that (i) the exponent of f is non-zero in an interval [(1 −
Ω(1)) ˜w, ˜w] ⊆ [w0, ˜w], or (ii) the exponent of f is non-zero in an interval [ ˜w, (1 +
Ω(1)) ˜w] ⊆ [ ˜w, w1]. Then the O(·) in (8) may be replaced by Θ(·).

Proof. Let g(w) = Cwr. Let us ﬁrst assume that, by continuity, f satisﬁes f (w) =
C0ws0 for w ≤ ˜w and f (w) = C1ws1 for w ≥ ˜w, i.e. that f consists of only two
pieces. Then by assumption r + s0 > 0 > r + s1. We ﬁrst consider the lower part
of the integral. If s0 = 0 then (df /dw)(w) = 0 for w ≤ ˜w, and the integral from
w0 to ˜w vanishes. So assume that s0 > 0. Then (df /dw)(w) = C0s0ws0−1, and the
antiderivative of g(df /dw) is CC0s0/(r + s0)wr+s0 . Since r + s0 > 0, this function
is increasing in w, and

Z ˜w

w0

g(w)

d
dw

f (w)dw =

CC0s0

r + s0 (cid:0) ˜wr+s0 − wr+s0

0

(cid:1) = Θ(f ( ˜w)g( ˜w) − f (w0)g(w0)).

(9)
Note that if w0 ≤ (1−Ω(1)) ˜w, then f ( ˜w)g( ˜w)−f (w0)g(w0) = Ω(f ( ˜w)g( ˜w)) since f g
is a polynomial with positive exponent r + s0 in [w0, ˜w], which proves the additional
statement (i).

For the upper part of the integral, we may assume s1 > 0, since otherwise this
part of the integral vanishes. Then (df /dw)(w) = C1s1ws1−1, and the antiderivative
of g(df /dw) is CC1s1/(r + s1)wr+s1 . Note crucially that the sign of this function
is negative since r + s1 < 0. Hence,

g(w)

d
dw

f (w)dw =

CC1s1

−(r + s1)(cid:0) ˜wr+s1 − wr+s1

1

(cid:1) = Θ(f ( ˜w)g( ˜w) − f (w1)g(w1)).

(10)
Similarly to the ﬁrst part, if w1 ≥ (1 + Ω(1)) ˜w, then f ( ˜w)g( ˜w) − f (w1)g(w1) =
Ω(f ( ˜w)g( ˜w)), which proves the additional statement (ii). On the other hand, Equa-
tion (8) follows immediately from (9) and (10) by leaving out the negative terms.
This proves the lemma in the case that f consists of only two pieces.

For the case of several pieces, the additional statement follows by restricting
the integral to the two pieces bounded by ˜w. For the upper piece, assume that
w0 = w(1)
0 = ˜w are the endpoints of the diﬀerent pieces below ˜w.
Then in the same way as (9), we get

0 < . . . < w(λ)

Z w1

˜w

Z ˜w

w0

g(w)

d
dw

λXi=1

f (w)dw = O(

f (w(i)

0 )g(w(i)

0 )) ≤ O(λf ( ˜w)g( ˜w)) = O(f ( ˜w)g( ˜w)),

since f g is an increasing function in [w0, ˜w]. The part [ ˜w, w1] follows analogously.
(cid:3)

5. Basic properties of GIRGs

In this section we collect some basic properties of GIRGs. The ﬁrst lemma,
taken from [16], tells us that the expected degree of a vertex equals its weight, up
to constant factors. Moreover, it gives the marginal probability that two vertices
u, v of ﬁxed weights but random positions in Td are adjacent. This probability

BOOTSTRAP PERCOLATION ON GEOMETRIC INHOMOGENEOUS RANDOM GRAPHS 11

remains the same if the position of one (but not both) of the vertices is ﬁxed. An
expert reader may recognise that it is the same marginal probability as in Chung-Lu
random graphs, cf. [16] for a discussion in depth.

Lemma 12 (Lemma 4.4 and Theorem 7.3 in [16]). Let v = (xv, wv) be a vertex
with ﬁxed weight and position. Then

E[deg(v)] = Θ(wv).

(11)

Moreover, let u = (xu, wu) be a vertex with ﬁxed weight, but with random position
xu ∈ Td. Then

Pr [{u, v} ∈ E | wu, wv, xv] = Θ(cid:16)minn wuwv

n

, 1o(cid:17) .

(12)

Note in particular that the right hand side of (12) is independent of xv, so the same
formula still applies if also the position xv of v is randomized.

The next lemma gives a bound on the expected number of neighbours of a ﬁxed

vertex of large weight.

Lemma 13. Let η > 0 be a constant and consider a vertex v = (xv, wv) with ﬁxed
weight and position. Then for every w ≥ wmin we have
(a) E[|N≥w(v)|] = O(min{wvw2−β+η, nw1−β+η}).

In particular, for a random vertex u we have, independently of xv and wv,

Pr[wu ≥ w | {u, v} ∈ E] = O(w2−β+η);

(b) E[|N≥w(v)|] = Ω(min{wvw2−β−η, nw1−β−η}).

Proof. (a) By Lemma 12, the probability that a vertex u with ﬁxed weight wu and
random position xu ∈ Td is adjacent to v is Θ(1) min{wuwv/n, 1}. The expected
number of vertices of weight at least w is at most O(nw1−β+η) by the power-law
condition (1). We distinguish two cases. If wwv ≥ n then the probability to connect
to any vertex of weight w is Θ(1), so E[|N≥w(v)|] = Θ(E[|V≥w|]), and the claim
follows. So assume wwv ≤ n. Then by Lemma 10 we can compute the expectation
as the following integral, which we then evaluate using Lemma 11.

E[|N≥w(v)|] ≤ O(cid:18)nw1−β+η wwv
≤ O(cid:0)wvw2−β+η(cid:1) .

n

+Z ∞

w

nw1−β+η

u

d

dwu

minn wvwu

n

, 1o dwu(cid:19)

We can write both cases uniformly as E[|N≥w(v)|] ≤ O(min{wvw2−β+η, nw1−β+η}).
The second statement follows because the expected total number of neighbours
of v is Θ(wv). Therefore, the probability that a random neighbour of v has weight
at least w is Pr[{u, v} ∈ E ∧ wu ≥ w]/ Pr[{u, v} ∈ E] = O(w2−β−η), as required.

(b) This follows completely analogously to (a), except that we use that the
expected number of vertices of weight at least w is at least Ω(nw1−β−η) by the
lower bound in the power-law condition (1).
(cid:3)

We often need to bound the expected number of neighbours of a given vertex in

some geometric region, which we may do by the following lemma.

12

C. KOCH AND J. LENGLER

Lemma 14. Let η > 0 and C > 1 be constants, deﬁne m := min{α, β − 1 − η} and
consider a closed ball B ⊆ Td of radius r > 0 centred at 0. Let v = (xv, wv) be a
vertex with ﬁxed weight and position. Then

E [|N (v)∩ B|] = O(nVol(B)) ·

minn wv
minn(cid:16) wv

nVol(B) , 1o ,
kxvkdn(cid:17)m

if kxvk ≤ Cr,

, 1o if kxvk ≥ Cr.

Proof. In the ﬁrst case kxvk ≤ Cr, the expected number of vertices in B is nVol(B),
so µ ≤ nVol(B). On the other hand, the expected number of neighbours of v is
O(wv), so µ = O(1) min{wv, nVol(B)}.

For the second case, as before µ ≤ nVol(B). This proves the claim in the case
wv ≥ kxvkdn, so assume otherwise. Observe that every vertex in B has distance
Θ(kxvk) from v, and that the expected number of vertices in B of weight at least
w is O(nVol(B)w1−β+η).

Consider ﬁrst the case α < β − 1 − η. Then by Lemma 10,

E [|N (v)∩ B|] ≤ O(cid:18)nVol(B) min(cid:26)(cid:18) wv

kxvkdn(cid:19)α

+Z ∞

wmin

nVol(B)w1−β+η d
dw

, 1(cid:27)
min(cid:26)(cid:18) wwv

kxvkdn(cid:19)α

, 1(cid:27) dw(cid:19) .

Note that the exponent of w in the integrand is always negative, no matter which
value the minimum attains. Moreover, recall that we assumed wv < kxvkdn and
hence for w = wmin the minimum is O((wv/(kxvkdn))α). Thus by Lemma 11 (with
˜w = wmin = Θ(1)), the integral also evaluates to O(nVol(B)·min{(wv/(kxvkdn))α, 1}),
as required.

On the other hand, if α + 1 − β + η ≥ 0, then by Observation 8 we may restrict

ourselves to α < ∞, so we can estimate using Lemma 10 (with lower bound 0)

E [|N (v)∩ B|] = O(cid:18)Z ∞

0

nVol(B)w1−β+η d
dw

min(cid:26)(cid:18) wwv

kxvkdn(cid:19)α

, 1(cid:27) dw(cid:19) .

This integral evaluates to O(nVol(B) · (wv/(kxvkdn))β−1−η), by Lemma 11 (with
˜w = kxvkdn/wv). Since we have already shown that E [|N (v)∩ B|] ≤ nVol(B), this
proves the claim.
(cid:3)

In the last lemma of this section we show that whp there are no vertices whose

weight is much larger than their distance from the origin.

Lemma 15. Let η > 0 be a constant and consider a closed ball B ⊆ Td of radius
r > 0 centred at 0, satisfying nVol(B) = Θ(rdn) = ω(1). Then with probability 1 −
(rdn)−Ω(η) there is no vertex v = (xv, wv) with xv ∈ Td \ B and wv ≥ ˆw+(kxvkdn).
Proof. Let ˆn be the number of such vertices. Let r′ > r, then the probability
density to ﬁnd a vertex v = (xv, wv) with kxvk = r′ is equal to the volume of
an r′-sphere around 0 that is intersected with Td. By ignoring the intersection,
we can only make the volume larger, so it is at most O((r′)d−1n). Moreover, the
probability that a vertex has weight at least w is at most O(w1−β+η/2) by the
power-law condition (1) (using γ = η/2). Hence, by Lemma 10 and Lemma 11 we
obtain

(r′)d−1n((r′)dn)(1−β+η/2)/(β−1−η)dr′ = (rdn)−Ω(η),

E [ˆn] = O(1)Z ∞

r

BOOTSTRAP PERCOLATION ON GEOMETRIC INHOMOGENEOUS RANDOM GRAPHS 13

and the statement follows by Markov’s inequality.

(cid:3)

6. Evolution of the process

In this section we will prove two theorems which describe the geometrical evolu-
tion of the process in detail. First we show that certain regions cannot be reached
too early in the process, providing an upper bound on its speed. From this we then
derive Corollary 7 in Section 6.2. Afterwards, we show that in the supercritical
regime the process will reach certain regions whp in a given time, yielding a lower
bound on its speed. This lower bound also applies in the critical regime if in the ﬁrst
step suﬃciently many heavy vertices were activated, an event which holds with at
least constant probability.

6.1. Upper bound on the speed. The key theorem will recursively assert that
the process does not infect too many vertices in certain regions in any round. We
formalise this idea by deﬁning several families of events.

Deﬁnition 16. Let ε > 0 be a constant and let η = η(ε) > 0 be a constant which
is suﬃciently small compared to ε, cf. Section 2.3. Moreover, let h = h(n) be a
function satisfying h(n) = ω(1), h(n) = o(log n), and h(n) = νo(1). Then we deﬁne
the following families of events:

• For all i ≥ 0

E(i) := {V ≤i∩ (Td \ eBi) = ∅},

and

• For all ℓ ≥ 0 and w ≥ wmin

in other words, no vertex outside of eBi is activated by time i;
≥w∩ 2ℓeB0(cid:12)(cid:12)(cid:12) ≤ hℓw2−β+ηeν1−(ζ+ε)−ℓ(β−1)−1
F(ℓ, w) := Fε,η,h(ℓ, w) :=n(cid:12)(cid:12)(cid:12)V ≤ℓ
i.e. the number of vertices in 2ℓeB0 being activated by time ℓ is not “too

F(ℓ) := Fε,η,h(ℓ) := \w′≥wmin

F(ℓ, w′),

large”;

• For all j ≥ 0

0

o ,

G(j) := Gε,η,h(j) :=

(E(j′) ∩ F(j′)),

j\j′=0

in other words, it is all “good” events up to time j hold.

Theorem 17. Let ε, η, h be given as in Deﬁnition 16 and assume α > β − 1. Then,
for suﬃciently large n,
(a) E(0) is always satisﬁed;
(b) Pr[F(0)] ≥ 1 − O(h−1);
(c) For all i ≥ 1 we have

Pr [E(i) | G(i − 1)] ≥ 1 − h−Ω(i);

(d) For all ℓ ≥ 1 we have

(e) Whp, the events G(j) hold for all j ≥ 0;

Pr [F(ℓ) | G(ℓ − 1)] ≥ 1 − h−Ω(ℓ);

14

C. KOCH AND J. LENGLER

(f ) For all i ≥ 1 and ℓ ≥ 0, and for every ﬁxed vertex v = (xv, wv) such that

xv ∈ Td \ 2ℓ+1eBi−1 and wv ≥ wmin we have

Pr(cid:2)v ∈ V ≤i+ℓ(cid:12)(cid:12) G(i + ℓ − 1)(cid:3) ≤ wv2ℓdeν−(ζ+ε)−ℓ−2/(β−1)

Proof. First note that all statements only become easier if the edge probabilities are
decreased. Hence, by Observation 8 we may restrict ourselves to the case α < ∞,
since this case dominates the case α = ∞.

.

i

To prove (c), (d), and (f), we will use induction on i + ℓ, where we set ℓ = 0 and
i = 0 in (c) and (d), respectively. In particular, in order to prove (c) and (d) for
i, ℓ, we will assume statement (f) for i′, ℓ′ as long as i′ + ℓ′ ≤ i + ℓ − 1. Throughout
the proof, we will mutually assume that n is suﬃciently large; for example, we will

use that h andeν0 are larger than any ﬁxed constant without further comment.
(a) This statement is trivial since only vertices in B0 ⊆ eB0 are active at time 0.

(b) Fix a weight w ≥ wmin and note that

since initially activation only occurs within B0. Furthermore, the right-hand side
is a Poisson distributed random variable and we have

(cid:12)(cid:12)(cid:12)V ≤0
≥w∩ eB0(cid:12)(cid:12)(cid:12) ≤(cid:12)(cid:12)V≥w∩ B0(cid:12)(cid:12)

β−2
β−1 −Ω(ε)
0

β−2
β−1 −Ω(ε)
0

0

),
(13)

where in the last step we used that w−1+η = O(1). Let ¯w be the weight that

w−1+η) ≤ O(w2−βeν
= h. Then by Markov’s inequality,(cid:12)(cid:12)(cid:12)V ≤0
h) = 1 − O(h−1) since h = eνo(1)

E[|V≥w∩ B0|] ≤ O(νw1−β+η) = O(w2−βeν
≥ ¯w∩ eB0(cid:12)(cid:12)(cid:12) = 0 with
satisﬁes ¯w2−βeν(β−2)/(β−1)
probability 1 − O(eν−Ω(ε)
For smaller w, observe in (13) that eν−Ω(ε)
ciently large n. Let F∗(0, w) be the event that (cid:12)(cid:12)V≥w∩ B0(cid:12)(cid:12) ≤ (2w)2−βeν(β−2)/(β−1)

dominates every O(1)-term for suﬃ-

. Note that this implies

(b) for all w ≥ ¯w.

and note that

0

0

0

0

Pr[F∗(0, w)] ≥ 1 − exph−Ω(1)(2w)2−βeν(β−2)/(β−1)

0

i

by (13) and a Chernoﬀ bound. The exponent (β − 2)/(β − 1) in (14) equals the

exponent 1−(β−1)−1 ofeν0 in F (0, w). Hence, if F∗(0, w′) holds for some w′ ≥ wmin,

then F(0, w) holds for all w ∈ [w′, 2w′]. Therefore, it remains to prove F∗(0, 2swmin)
for all s ∈ {0, . . . , log2( ¯w/wmin) − 1}. A union bound over all such s using (14)
shows that all these events hold with probability 1 − exp{−Ω(h)} = 1 − O(h−1).
This concludes the proof of (b).

(14)

(c) We will show that with suﬃciently large probability, no vertex in Td \eBi has
a neighbour in eBi−1. This will imply the statement, since we assumed G(i − 1),
which means in particular that all active vertices in round i − 1 are in eBi−1.
By Lemma 15, with probability 1 −eν−Ω(η)
v = (xv, wv) such that xv ∈ Td \ eBi and wv ≥ ˆw+(kxvkdn). So let v = (xv, wv)
be a vertex satisfying xv ∈ Td \ eBi and wv ≤ ˆw+(kxvkdn), and note in particular
that kxvk ≥ (eνi/n)1/d ≥ 2(eνi−1/n)1/d. Hence, due to Markov’s inequality, the

≥ 1 − h−Ω(i) there is no vertex

i

BOOTSTRAP PERCOLATION ON GEOMETRIC INHOMOGENEOUS RANDOM GRAPHS 15

dwvdrv.

probability of v having a neighbour in eBi−1 is at most
E[N (v)∩ eBi−1] = O(1)eνi−1(cid:18) wv

kxvkdn(cid:19)β−1−η

by Lemma 14. We call any such vertex v = (xv, wv) bad, i.e. v is bad if it satisﬁes

rd−1

wmin

r−1

(eνi/n)1/d

v n)

d

i

0

i

.

w1−β+2η

v

upper bound

Since we have

≥ 1 − h−Ω(i)

, we consider the

v n)1−β+ηwβ−1−η

v

Thus, since ( ˆw+(rd

vn)η/(β−1−η) ≤ (rd

(eνi/n)1/d
v n))η = (rd

dwveνi−1(rd

v n)η, we have

there is no such vertex. Statement (c) follows.

v nZ ˆw+(rd

eνi−1 =eν2η−Ω(ε)

Integrating over rv := kxvk and using Lemma 10, we can thus bound the expected
number nbad of bad vertices by

xv ∈ Td \ eBi and wv ≤ ˆw+(kxvkdn), and if v has at least one neighbour in eBi−1.
E[nbad] = O(1)Z ∞
E[nbad] = O(1)Z ∞
v (rdn)2−β+2ηeνi−1drv = O(1)eν2−β+2η
Thus by Markov’s inequality, with probability at least 1 −eν2η−Ω(ε)
(d) We distinguish two cases. For w ≥ eν(ζ+ε)−ℓ(1+3η)/(β−1)
Eh(cid:12)(cid:12)(cid:12)V≥w∩ 2ℓeB0(cid:12)(cid:12)(cid:12)i = O(1)2ℓdeν0w1−β+η = O(1)w2−β 2ℓdeν1−(ζ+ε)−ℓ(1+η)/(β−1)
Prh(cid:12)(cid:12)(cid:12)V≥w∩ 2ℓeB0(cid:12)(cid:12)(cid:12) ≤ 2(2w)2−β2ℓdeν1−(ζ+ε)−ℓ/(β−1)
≥ 1 − exph−Ω(1)w2−β2ℓdeν1−(ζ+ε)−ℓ/(β−1)
2ℓdeν1−(ζ+ε)−ℓ/(β−1)

by a Chernoﬀ bound. Similarly as in the proof of (b), it suﬃces to establish the
bound in (15) only for weights of the form 2swmin for s ∈ {0, . . . , log2( ¯wℓ/wmin) −
1}, where ¯wℓ is deﬁned by ¯w2−β
= hℓ. A union bound over

≥w∩ 2ℓeB0(cid:12)(cid:12)(cid:12) ≤(cid:12)(cid:12)(cid:12)V≥w∩ 2ℓeB0(cid:12)(cid:12)(cid:12) .
(cid:12)(cid:12)(cid:12)V ≤ℓ

and since this number is Poisson distributed, we obtain

1 − exp(−Ω(hℓ)) = 1 − h−Ω(ℓ).

. We claim that it
suﬃces to restrict ourselves to vertices of weight at most ˆw := ˆw0
.
More precisely, we will show that with probability at least 1 − h−Ω(ℓ), for all w ≤

all such s proves that (b) holds for all w ≥ eν(ζ+ε)−ℓ(1+3η)/(β−1)
For the second case assume that w ≤ eν(ζ+ε)−ℓ(1+3η)/(β−1)
eν(ζ+ε)−ℓ(1+3η)/(β−1)

+(eν0) =eν1/(β−1)

with probability

we have

,

i

0

0

ℓ

0

|U (w)| ≤ hℓw2−β+ηeν1−(ζ+ε)−ℓ/(β−1)

0

,

where U (w) := V ≤ℓ
ﬁciently few other vertices active: we have seen that with probability at least

∈[w, ˆw]∩ 2ℓeB0. This suﬃces since by the ﬁrst case there are suf-

= o( ˆw) (for ℓ ≥ 1) we have

(16)

i

0

0

(15)

0

1 − h−Ω(ℓ) for any w ≤eν(ζ+ε)−ℓ(β−1)−1(1+3η)
≥ ˆw∩ 2ℓeB0(cid:12)(cid:12)(cid:12) ≤ hℓ ˆw2−β+ηeν1−(ζ+ε)−ℓ/(β−1)
(cid:12)(cid:12)(cid:12)V ≤ℓ

0

≤

1
2

hℓw2−β+ηeν1−(ζ+ε)−ℓ/(β−1)

0

.

0

i

0

0

16

C. KOCH AND J. LENGLER

Thus we want to bound E[|U |] by calculating the expected number of edges

having one endpoint in V ≤ℓ−1 and the other in V∈[w, ˆw]∩ 2ℓeB0, i.e. we set

Furthermore we observe that each edge in M (w) is also contained in at least one
of the following two edge-sets: Let

M (w) := E(cid:16)V ≤ℓ−1, V∈[w, ˆw]∩ 2ℓeB0(cid:17) .
M∗(w) := E(cid:16)V ≤ℓ−1∩ 2ℓ+1eB0, V∈[w, ˆw](cid:17) ,
M ∗(w) := E(cid:16)V ∩ (Td \ 2ℓ+1eB0), V∈[w, ˆw]∩ 2ℓeB0(cid:17) ,

and

then we have M (w) ⊆ M∗(w)∪M ∗(w). It will turn out that the bound on |U (w)| ≤
|M∗(w)| + |M ∗(w)| obtained this way strong enough to prove (16).

i.e. the number of vertices in a slightly larger region that were already active in the
previous round. Since we assumed that F(ℓ − 1) holds, for those vertices which are

We start by estimating |M∗(w)|. As a preparation, we ﬁrst bound(cid:12)(cid:12)(cid:12)V ≤ℓ−1
also contained in the slightly smaller region 2ℓ−1eB0 we already know that
(cid:12)(cid:12)(cid:12)V ≤ℓ−1
≥w′ ∩ 2ℓ−1eB0(cid:12)(cid:12)(cid:12) ≤ 2(ℓ−1)d(w′)2−β+ηeν1−(ζ+ε)−ℓ+1/(β−1)

Now if ℓ = 1, then no other vertices were active in round ℓ − 1 = 0 by (a). For

≥w′ ∩ 2ℓ+1eB0(cid:12)(cid:12)(cid:12),

(17)

0

.

0

1

thus

Combining equations (17) and (18) we obtain

= O(1)hℓ(w′)2−β+ηeν1−(ζ+ε)−ℓ+1/(β−1)

ℓ ≥ 2, we need to examine the remaining region 2ℓ+1eB0 \ 2ℓ−1eB0. Note that this
area is contained in 2ℓeB1. Hence, we may apply (f) with i′ = 1 and ℓ′ = ℓ − 2, and
Eh(cid:12)(cid:12)(cid:12)V ≤ℓ−1
≥w′ ∩ (2ℓ+1eB0 \ 2ℓ−1eB0)(cid:12)(cid:12)(cid:12)i = O(1)2(ℓ+1)deν0(w′)1−β+ηw′2(ℓ−2)deν−(ζ+ε)−ℓ/(β−1)
, 2(ℓ+1)deν0(w′)1−β+η) ,
≥w′ ∩ 2ℓ+1eB0(cid:12)(cid:12)(cid:12)i = O(1) min(hℓ(w′)2−β+ηeν
Eh(cid:12)(cid:12)(cid:12)V ≤ℓ−1
i − 1. Now we denote by ˜w = Θ(1)eν(ζ+ε)−ℓ+1(β−1)−1

where the second term arises from dropping the condition on being active in round
2(ℓ+1)dh−ℓ the weight for which
the two expressions in (19) coincide. Recall that for any vertex u = (xu, wu) of
ﬁxed weight (and independently of its position) we have E[|N (u)|] = Θ(wu) by
Lemma 12. Moreover, by Lemma 13, the probability q(w) for a random neighbour
of u to have weight at least w is O(w2−β+η/2), independently of u. Therefore we
have

1− (ζ+ε)−ℓ+1
0

(19)

(18)

β−1

0

.

E[|M∗(w)|] = O(q(w)) Xu∈V ≤ℓ−1
min(hℓw2−β+η
= O(q(w))Z ∞

L. 10

≥0

u

0

∩ 2ℓ+1 eB0

E[|N (u)|]

1− (ζ+ε)−ℓ+1
0

β−1

eν

)(cid:18) d

dwu

wu(cid:19) dwu.

u

, 2(ℓ+1)deν0w1−β+η

BOOTSTRAP PERCOLATION ON GEOMETRIC INHOMOGENEOUS RANDOM GRAPHS 17

Using Lemma 11 with ˜w we obtain

(20)

0

0

0

0

.

E[|M∗(w)|] = O(1)w2−β+η/22(ℓ+1)deν0 ˜w2−β+η

Lemma 10 and Lemma 11 imply

the subset of M ∗(w) consisting of all edges incident with v. Now note that every

empty by (a), hence also M ∗(w). So assume ℓ ≥ 2. Fix a vertex v = (xv, wv) such

= O(1)w2−β+η/22(ℓ+1)d(3−β+η)hℓ(β−2−η)eν1−(ζ+ε)−ℓ+1(β−2+η)/(β−1)
≤ w2−β+η/2hℓ(β−2−2η)eν1−(ζ+ε)−ℓ(1+Ω(ε)−O(η))/(β−1)
≤ w2−β+η/2hℓ(β−2−2η)eν1−(ζ+ε)−ℓ/(β−1)
Next we turn to the edges in M ∗(w). If ℓ = 1, then V ≤ℓ−1∩ (Td \ 2ℓ+1eB0) is
that xv ∈ 2ℓeB0 and wv ≤ ˆw and denote by M ∗(w, v) := {e ∈ M ∗(w) | v ∈ e}
edge in M ∗(w, v) must bridge a distance of at least ˜rℓ := 2ℓ(eν0/n)1/d and hence
E [|M ∗(w, v)|] = O(1)Z ∞
, 1o dw∗dr
= O(1)Z ∞
= O(1)(cid:18) 2dℓeν0
E[|M ∗(w)|] = O(1)eν0Z ∞

wv (cid:19)1−β+η
wv = O(1)eν
dwv (cid:16)eν−(ζ+ε)−ℓ/(β−1)

rd−1nZ ∞
rd−1n(cid:18) rdn
wv (cid:19)2−β+η

where the last step follows from (β − 2)(β − 2 − η)(ζ + ε)2 ≥ 1 since we assumed

0

wv ≤ ˆw =eν1/(β−1)

rdn (cid:17)α
minn(cid:16) w∗wv

wv(cid:17) dwv

and ℓ ≥ 2. Hence,

dr = O(1)(˜rd

ℓ n)2−β+ηwβ−1+η

v

− (ζ+ε)−ℓ
0

β−1

w1−β+η/2

v

w1−β+η

∗

d
dw∗

rℓ

˜rℓ

d

0

wv,

Together with (20), this shows that the expected number of vertices in U (w) is also
bounded by

w

.

0

≤ O(1)w2−β+η/2eν1−(ζ+ε)−ℓ/(β−1)
E[|U (w)|] ≤ 2w2−β+η/2hℓ(β−2−2η)eν1−(ζ+ε)−ℓ/(β−1)

0

,

and therefore, by Markov’s inequality, we have

Pr(cid:20)|U (w)| ≥

1
2

(2w)2−β+ηhℓeν1−(ζ+ε)−ℓ/(β−1)

0

(cid:21) = w−η/2h−Ω(ℓ).

As in the proof of (b), by a union bound over all weights of the form 2swmin for
s ∈ {0, . . . , log2( ˆw/wmin) − 1}, we ﬁnd that with probability 1 − h−Ω(ℓ), for all
w ≥ wmin we have

|U (w)| ≤

concluding the proof of (d).

1
2

w2−β+ηhℓeν1−(ζ+ε)−ℓ/(β−1)

0

,

(e) This follows from (a)–(d) by a simple union bound.

(21)

(f ) Fix a vertex v = (xv, wv) such that xv ∈ Td \ 2ℓ+1eBi−1. The statement
(f) is trivial if wv ≥ eν(ζ+ε)−ℓ−2/(β−1)
the number of neighbours in 2ℓeBi−1. Observe that every such vertex has distance

, so assume the contrary. We ﬁrst estimate

i

18

C. KOCH AND J. LENGLER

i

i

0

≤

, we obtain

L. 11,α>β−1

w1−β+η d
dw

at least ˜ri−1,ℓ := 2ℓ(eνi−1/n)1/d of v. Therefore, using wv ≤ eν(ζ+ε)−ℓ−2/(β−1)
eν(ζ+ε)−2/(β−1)
, 1(cid:27) dw
Eh(cid:12)(cid:12)(cid:12)N (v)∩ 2ℓeBi−1(cid:12)(cid:12)(cid:12)i = O(1)2ℓdeνi−1Z ∞

O(1)wv(cid:18) 2ℓdeνi−1

wv (cid:19)2−β+η
= O(1)wv2ℓd(cid:16)eν(ζ+ε)−1−(ζ+ε)−2/(β−1)

2ℓdeνi−1(cid:19)α
min(cid:26)(cid:18) wwv
(cid:17)2−β+η
Eh(cid:12)(cid:12)(cid:12)N (v)∩ 2ℓeBi−1(cid:12)(cid:12)(cid:12)i = O(1)wv2ℓdeν−(ζ+ε)−2/(β−1)−Ω(ε)

Since (2 − β − η)[(ζ + ε)−1 − (ζ + ε)−2/(β − 1)] = −(ζ + ε)−2(1 + Ω(ε))/(β − 1) we
deduce

(22)

≤

=

.

.

i

i

1
2

i

wv2ℓdeν−(ζ+ε)−ℓ−2/(β−1)

In the case ℓ = 0, this already proves the assertion since in round i − 1 no vertex

use the induction hypothesis of statement (f) for i′ = i and ℓ′ = ℓ − 1 to estimate

outside of eBi−1 is active by E(i − 1), and thus Pr[v ∈ V =i] ≤ E[N (v) ∩ 2ℓeBi−1].
So assume ℓ ≥ 1. Set U∗ :=(cid:12)(cid:12)(cid:12)N ≤i+ℓ−1(v)∩ (Td \ 2ℓeBi−1)(cid:12)(cid:12)(cid:12). In this case, we can
, 1}! dwdr.
O(1)Z ∞

rdn(cid:17)α
, 1} min{(cid:16) wwv

rd−1nZ ∞

− (ζ+ε)−ℓ−1
i

w1−β+η d

E [|U∗|] =

β−1

0

0

dw min{whℓeν

To compute this integral, note that whenever the second minimum is attained by 1,
the inner integral runs either over a polynomial in w with exponent 1 − β + η < −1,
or over the zero function. On the other hand, whenever the second minimum is
is attained by the expression (wwv/(rdn))α, then the inner integral runs over a a
polynomial in w with exponent larger than −1 (either with exponent α−β+η > −1,
or even with exponent α − β + η + 1). Therefore, by Lemma 11 for ˜w = rdn/wv,
we obtain in all cases

rd−1n(cid:18) rdn

E [|U∗|] = O(1)Z ∞

Similarly, let r∗ be deﬁned by rd
, then the exponent of
r in the antiderivative of the integrand is positive for all r < r∗ and negative for all
r > r∗. Hence,

min(cid:26)(cid:18) rdn

wv (cid:19)1−β+η
∗n/wv = h−ℓeν(ζ+ε)−ℓ−1/(β−1)

wv (cid:19) hℓeν−(ζ+ε)−ℓ−1/(β−1)

, 1(cid:27) dr.

0

i

i

E [|U∗|] = O(1)wv(cid:16)hℓeν−(ζ+ε)−ℓ−1/(β−1)

i

(cid:17)β−2−η

≤

1
2

since (ζ + ε)(β − 2 − η) ≥ 1 and h = ω(1). Together, equations (22) and (23) prove
the claim.
(cid:3)

i

wv2ℓdeν−(ζ+ε)−ℓ−2/(β−2)

,

(23)

6.2. Isolation strategies: Proof of Corollary 7.

round i. Therefore, it suﬃces to (permanently) remove by the end of round i all

Proof. By Theorem 17, whp there is no vertex outside of eBi which is active in
edges that cross the boundary of eBi, i.e. all edges in E(eBi, Td \ eBi). This is very

similar to [15, Lemma 7.1 and Theorem 7.2], where the number of edges cutting a

BOOTSTRAP PERCOLATION ON GEOMETRIC INHOMOGENEOUS RANDOM GRAPHS 19

grid is considered. It does not follow directly from this lemma since the error terms
in [15] are too large for our purposes. However, what does follow directly from their

i

.

, 1) .

Lemma 10 and Lemma 11 to estimate

Lemma 14 (in the case α > β − 1) the expected number of neighbours of v inside

proof is that among those edges that are completely contained in 2eBi, the number
of edges that cross a ﬁxed axis-parallel hyperplane is at mosteνmax{3−β,1−1/d}+o(1)
Since the boundary of eBi consists of a constant number of faces, this proves the
bound for those edges which have both endpoints in 2eBi.
So it remains to consider the set Mi := E(eBi, Td \ 2eBi). Let η > 0 be any
constant, and let v = (xv, wv) be a vertex such that xv ∈ Td \ 2eBi. Then by
of eBi is
Note that v has distance at least ri := (eνi/n)1/d from the origin. Thus we may use
, 1(cid:27) dwvdr
E[|Mi|] = O(1)Z ∞
= O(eνi)Z ∞

kxvkdn(cid:19)β−1−η
dwveνi min(cid:26)(cid:16) wv
rd−1nZ ∞
r−1(rdn)2−β+2ηdr = O(eν3−β+2η
Since eνi = ω(1), we can deduce that E[|Mi|] ≤ eν3−β+3η

E[N (v)∩ eBi] = O(eνi) min((cid:18) wv

6.3. Lower bound on the speed. In this section we show lower bounds for the
probability that a vertex in a speciﬁc region and with a speciﬁc weight will be
active in some round, provided that we start in the supercritical case. Recall that
the supercritical case is deﬁned by ρ = ω(ρc) for strong power-law weights, and
ρ = ω(ν−1/(β−1−η)) otherwise. The same bounds also hold in the critical case if
at least k “heavy” vertices are activated in the ﬁrst round, which happens with
probability Ω(1).

Since this holds for all η > 0, the claim follows.

for suﬃciently large n.
(cid:3)

rdn(cid:17)β−1−η

w1−β+2η

v

d

0

).

i

i

ri

ri

The key idea is that the infection spreads in two ways: (i) from heavy vertices in
one region to heavy vertices in the next (surrounding) region, where the volume of
the region increases by an exponent of ζ − ε in each step, and (ii) from vertices of
weight w to nearby vertices of weight w1/(ζ−ε). We formalise the occurring weights
with the following deﬁnitions.

Deﬁnition 18. Let ε > 0 be a constant and let η = η(ε) > 0 be a constant which is
suﬃciently small compared to ε, cf. Section 2.3. For any integers i ≥ 0 and ℓ ≥ 0,
we deﬁne

wi,ℓ := ˆw−(νi)(ζ−ε)−ℓ

= ν(ζ−ε)−ℓ/(β−1+η)

i

= ν(ζ−ε)i−ℓ/(β−1+η).

We abbreviate the set of all vertices in Bi of weight at least at least wi,0 by Ui :=
V≥wi,0 ∩ Bi, and we call such vertices heavy if the value of i is clear from the context.
As usual, superscripts in the notation denote active vertices, so U ≤j
∩ Bi.
Furthermore we denote by H(i) the event that in round i + 3 all vertices in Ui are
active.

:= V ≤j

≥wi,0

i

The following theorem gives lower bounds on the probability that a vertex is
active in some round. It agrees with the above intuition in the following sense: if j

20

C. KOCH AND J. LENGLER

is the ﬁrst round in which a vertex has, say, probability 1/2 to be active according
to the bound in Theorem 19 (c), then j agrees with the round that is predicted
by the above intuition, up to additive constants. We will see in Section 7 that
Theorem 17 provides matching lower bounds on j, up to minor order terms. So in
this sense, Theorem 19 is tight.

Theorem 19. Let ε and η be as in Deﬁnition 18. Assume furthermore that we are
in the supercritical case, or instead that |U ≤1
(a) Whp |Ui| = νΩ(η)
(b) Whp all the events H(i) occur.
(c) There exist constants C0, C1, C2 > 0 such that the following holds: Let v =
(xv, wv) be any vertex with ﬁxed position and weight and let i, ℓ ≥ 0 be such
that xv ∈ Bi and wv ≥ max{wi,ℓ, C0}. Then for suﬃciently large n ∈ N,

and |Ui| = O(νi) uniformly for all i ≥ 0.

| ≥ k. Then the following is true:

i

i

Pr[v ∈ V ≤i+3+ℓ | H(0), . . . , H(i)] ≥ 1 − exph−C1νC2(ζ−ε)−ℓ

i

i .

Before we prove Theorem 19, we remark the following.

Remark 20. Our proof will in fact show that (c) still holds if we replace Bi by
an arbitrary ball of the same volume, and that it suﬃces if only a constant fraction
of all heavy vertices is active. More precisely, let B be any ball, and let H(i′, B)
be the event that in round i′ at least half of the vertices in B of weight at least
ˆw−(nVol(B)) are active. Then there are constants C0, C1, C2 > 0 such that for
any vertex v = (xv, wv) with ﬁxed position xv ∈ B, and with ﬁxed weight wv ≥

maxn(nVol(B))(ζ−ε)−ℓ/(β−1+η), C0o we have

Pr[v ∈ V ≤i′+ℓ | H(i′, B)] ≥ 1 − exph−C1(nVol(B))C2(ζ−ε)−ℓi .

For the sake of readability, we omit the details and prove Theorem (19) only in the
case B = Bi.

Proof of Theorem 19. (a) By deﬁnition of Ui,
E[|Ui|] ≥ νiw1−β−η/2

i,0

= νΩ(η)

i

.

i

The random variable |Ui| is Poisson distributed. Therefore, we have Pr[|Ui| ≤
E[|Ui|]/2] ≤ e−Ω(E[|Ui|]). By a union bound over all i, we see that whp |Ui| ≥ νΩ(η)
for all i ≥ 0. Similarly, the upper bound follows since 0 ≪ E[|Ui|] ≤ E[|Bi|] = O(νi).
(b) We ﬁrst show that in the supercritical case for weak power-law weights, whp
|U ≤1
0 | ≥ k. Let v = (xv, wv) be a vertex in U0. Then we claim that in round 1,
such a vertex will be active with at least constant probability. We may restrict
ourselves to the case wv ≤ ν, since larger weights make it only easier to become
active. Consider a ball around v with the property that every vertex of weight
at least wmin (so all vertices) in this ball have probability Ω(1) to connect to v.
Observe that by condition (2) and (3) on the edge probabilities we may choose
the ball to have volume Ω(wv/n). (For α < ∞ we may choose the volume to be
exactly wv/n, for α = ∞ we may have to choose it smaller by at most a constant
factor.) Since wv ≤ ν, at least a constant fraction of this ball lies in B0. Hence,
E[|N ≤0(v)|] = Ω(ρwv) = ω(1). Since |N ≤0(v)| is a Poisson distributed random
In particular, if we ﬁx any k
variable, v becomes active with high probability.

BOOTSTRAP PERCOLATION ON GEOMETRIC INHOMOGENEOUS RANDOM GRAPHS 21

0 | ≥ k, as claimed.
Next we show that |U ≤1

vertices in U0 then whp all k of them will be active in round 1. This implies that
whp |U ≤1

0 | ≥ k implies that whp at least an Ω(1) fraction of
all vertices in U0 is active in round 2. For α < ∞, any two vertices in U0 have
probability at least Ω(min{w2
0/ν, 1}) = Ω(1) to be adjacent, independently of each
other. For α = ∞, the probability is also Ω(1) since w2
0/ν = ω(1). Hence, by the
Chernoﬀ bound, whp |U ≤2

0 | = Ω(|U0|).

We show that the same holds in the supercritical case for strong power-law
weights, i.e. whp at least an Ω(1) fraction of U0 is active in round 2. Recall that
ρ = ω(ν−1/(β−1)) since we are supercritical. Let ρ′ be a function with the properties
ρ′ = o(ρ), ρ′ = o(1/w0) = o(ν−1/(β−1+η)), and ρ′ = ω(ν−1/(β−1)), and let w′ :=
1/ρ′. Note that E[|V≥w′ ∩ B0|] = Ω((w′)1−βν) = ω(1). As for weak power-laws, for
a vertex v of weight at least w′, we consider a ball B around v of volume w′/n. In
the case α < ∞, every vertex in B has probability Ω(min{wminw′/w′, 1}) = Ω(1)
to connect to v. In the case α = ∞, we may achieve the same by shrinking the ball
B by at most a constant factor. In either case, the expected number of vertices
in V ≤0 ∩ B is ρnVol(B) = Ω(ρ/ρ′) = ω(1). Hence, every vertex in V≥w′ ∩ B0
is in V ≤1 with probability 1 − o(1). By Markov’s inequality, whp the number of
vertices in V≥w′∩ B0 that are not in V ≤1 is o(E[|V≥w′ ∩ B0|]). In particular, whp
|V ≤1
≥w′ ∩ B0| = ω(1). Finally, for any two vertices u ∈ U0 and v ∈ V≥w′ ∩ B0, the
probability that u and v are adjacent is Ω(1), since w0w′/ν ≥ w2
0/ν = ω(1) with
room to spare. The claim now follows as for the other cases.

So we have shown that in all cases whp an Ω(1) fraction of all vertices in U0
is active in round 2, so let us assume this. To show that H(0) holds whp, recall
that any two vertices in U0 have probability Ω(1) to be connected. Therefore,
the probability that a vertex in U0 does not become active in round 3 is at most
Pr[Bin (|U0|, Ω(1)) < k] = exp[−Ω(|U0|)] = o(1/|U0|) by a Chernoﬀ bound. Hence,
by the union bound whp all vertices in U0 are active in round 3. This proves that
H(0) holds whp.

It remains to prove that the statement holds uniformly for all i ≥ 1. By (a) we

may assume that for all i ≥ 0 the set |Ui| satisﬁes |Ui| = νΩ(η)

i

and |Ui| = O(νi).

We claim that any two vertices vi−1 ∈ Ui−1 and vi ∈ Ui with ﬁxed position and
weight form an edge with probability Ω(1). Indeed, this follows immediately since
their distance is at most (νi/n)1/d, and hence

wvi−1 wvi

kxvi − xvi−1 kdn

≥

wi−1,0wi,0

νi

(ζ−ε)−1 +1

β−1+η −1

i

= ν

= νΩ(ε)−O(η)

i

= ω(1).

Therefore, the number of edges from a vertex vi ∈ Ui into Ui−1 is lower bounded

by a binomially distributed random variable Bin(cid:0)|Ui−1|, Ω(1)(cid:1). By the Chernoﬀ

bound, the probability that vi has less than k neighbours in Ui−1 is at most
exp[−Ω(|Ui|)] = exp[−νΩ(η)
i−1 ]. A union bound over all vertices in Ui−1 shows that
still with probability at least 1 − exp[−νΩ(η)
i−1 ] every vertex in Ui has at least k
neighbours in Ui−1. A union bound over all i ≥ 1 shows that whp the same is still
true for all i ≥ 1 simultaneously. Hence, by a simple induction, all the events H(i)
occur, as required.

(c) We only give the proof in the case α < ∞, and explain in the end the
changes that are necessary for α = ∞. For α < ∞, we prove the statement for

22

C. KOCH AND J. LENGLER

C0 := (8k)2d/(ε2(β−2)), C1 := 4−d/ε and C2 := [ε(β − 2)/2](ζ − ε)/(β − 1 + η), where
we assume that ε > 0 is suﬃciently small. We use induction on ℓ. If wv ≥ wi,0
then H(i) implies that v ∈ A(i + 3), so for ℓ = 0 there is nothing to show. So let
ℓ ≥ 1. Before we start with the inductive step, note that we may assume

ν(ζ−ε)−ℓ+1

i

≥ Cβ−1+η

0

≥ (8k)2d(β−1+η)/(ε2(β−2)),

(24)

since otherwise both the statements for ℓ and ℓ − 1 concern only vertices of weight
at least C0, and thus the case ℓ follows trivially from the statement for ℓ − 1. Let v
be a vertex with position xv ∈ Bi and with weight wv ≥ wi,ℓ. We claim that every
vertex in distance at most rℓ := (ν(ζ−ε)−ℓ+1
/n)1/d with weight at least wi,ℓ−1 has
probability Ω(1) to connect to v. Indeed, this follows from

i

wi,ℓ−1wi,ℓ

rd
ℓ n

= ν[2−β−η+(ζ−ε)−1](ζ−ε)−ℓ+1/(β−1+η)

i

≥ ν[ε(β−2)/2](ζ−ε)−ℓ+1/(β−1+η)

i

(24)
≥ (8k)d/ε ≥ 1

(25)

Since ℓ ≥ 1, we have rℓ ≤ (νi/n)1/d, which is the radius corresponding to the
ball Bi. Hence, if we consider a ball around v with radius rℓ, then at least a 2−d
proportion of this ball falls into Bi. Therefore, the expected size of Nℓ−1(v) satisﬁes

E[|Nℓ−1(v)|] = Ω(1)2−drd

ℓ nw1−β+η

i,ℓ−1 ν[ε(β−2)/2](ζ−ε)−ℓ+1/(β−1+η)

i

≥ c2−dν[ε(β−2)/2+2η)](ζ−ε)−ℓ+1/(β−1+η)

i

for some constant c > 0 and any suﬃciently large n. Furthermore, if the constant
ε > 0 is suﬃciently small we obtain

E[|Nℓ−1(v)|] ≥ 2−d/εν[ε(β−2)/2](ζ−ε)−ℓ+1/(β−1+η)

i

(24)
≥ (4k)d/ε ≥ 8k.

Recall that |Nℓ−1(v)| is a Poisson distributed random variable and thus we have

Pr[|Nℓ−1(v)| < k] ≤ exp(−E[|Nℓ−1(v)|]/4) · exp(−E[|Nℓ−1(v)|]/4)

≤ exp(−2k) exp(cid:16)−4−d/εν[ε(β−2)/2](ζ−ε)−ℓ+1/(β−1+η)

i

(cid:17) .

So assume that |Nℓ−1(v)| ≥ k, and pick any k vertices v1, . . . , vk ∈ Nℓ−1(v). By
induction hypothesis,

Pr[v1 6∈ A(i + ℓ + 1)] ≤ exph−4−d/εν[ε(β−2)/2](ζ−ε)−ℓ+2/(β−1+η)

i
≤ exph−2 · 4−d/εν[ε(β−2)/2](ζ−ε)−ℓ+1/(β−1+η)
≤ exp(−kd) exph−4−d/εν[ε(β−2)/2](ζ−ε)−ℓ+1/(β−1+η)

i

(24)

(24)

i

i

i

where the second inequality holds since ζ − ε ≥ 1 + ε for any suﬃciently small ε > 0.
The same bound applies to the other vj. By a simple union bound,

Pr[v1, . . . , vk ∈ A(i + ℓ + 1)] ≥ 1 − k exp(−kd) exp"−4−d/εν

[ε(β−2)/2] (ζ−ε)−ℓ+1
i

β−1+η

i
# .

[ε(β−2)/2] (ζ−ε)−ℓ+1
i

β−1+η

#

≤(cid:0)exp(−2k) + k exp(−kd)(cid:1) exp"−4−d/εν
≤ exp"−4−d/εν
= exph−C1νC2(ζ−ε)−ℓ

[ε(β−2)/2] (ζ−ε)−ℓ+1
i

#

i

β−1+η

i

BOOTSTRAP PERCOLATION ON GEOMETRIC INHOMOGENEOUS RANDOM GRAPHS 23

Hence,

Pr[v 6∈ A(i + ℓ + 2)] ≤ Pr[|Nℓ−1(v)| < k] + Pr[{v1, . . . , vk} 6⊆ A(i + ℓ + 1)]

as required.

For α = ∞, Equation (25) does not imply that the corresponding vertices connect
with probability Ω(1), but it suﬃces to decrease rℓ by at most a constant factor to
ensure this property. This can be compensated by changing (for example) C1. We
omit the details.
(cid:3)

7. Infection times: Proof of Theorem 4

Proof. Let v = (xv, wv) be an ﬁxed vertex that satisﬁes the conditions in Theorem 4.
Let ε > 0 be a constant and let η = η(ε) > 0 be a constant which is suﬃciently
small compared to ε, cf. Section 2.3.

First we remark that it suﬃces to show that for every suﬃciently small ε >
0, whp Lv = (1 ± O(ε))Λ(xv, wv) ± O(1), where the hidden constants are both
independent of ε. Then by a standard diagonalizing argument, we also have whp
Lv = (1 ± o(1))Λ(xv, wv) ± O(1). We split the proof in three parts (I), (II) and
(III), “typical” vertices are treated in (III):

(I): Assume that wv > (kxvkdn)1/(β−1) and the maximum in (4) is 0, i.e. we also
have wv ≥ kxvkdn/ν. In this case, the lower bound on Lv is trivial, so we show the
upper bound. Since then the second term in the maximum must be non-positive,
we have kxvkdn ≤ wvν. Let i ≥ 1 be so large that (ζ − ε)i/(β − 1 + η) > 1, but
observe that we may still choose i = O(1).

Assume ﬁrst kxvkdn ≤ νi, so xv ∈ Bi. By the technical condition in Theorem 4
. Hence, we may

we have kxvkdn ≥ eν0, and hence wv ≥ eν1/(β−1)

choose ℓ = O(1) such that wv ≥ wi,ℓ = ν(ζ−ε)−ℓ/(β−1+η)
, and it follows directly
from part (c) of Theorem 19 that whp v is active after i + ℓ + 3 = O(1) rounds, as
required.

= νΩ(1) = νΩ(1)

0

i

i

On the other hand, if kxvkdn ≥ νi then every vertex in Bi has distance at
most 3kxvkdn from v. Let wi := ν1/(β−1+η)
. By Theorem 19, after i + 3 rounds
all vertices in V≥wi ∩ Bi are active whp, and there are νΩ(η)
= ω(1) many such
vertices. Note that any such vertex has probability Ω(1) to form an edge with v,
since wvwi/(3dkxvkdn) ≥ wi/(3dν) = Ω(1). Therefore, whp v is active in round
i + 4 = O(1), again as required.

i

i

(II): Assume that still wv > (kxvkdn)1/(β−1), but that the maximum in (4) is
attained by the second term, i.e. kxvkdn/wv ≥ ν. We need to show an upper and a
lower bound on Lv. For the upper bound, choose i ≥ 0 minimal such that

kxvkdn/wv ≤ wi,

(26)

24

C. KOCH AND J. LENGLER

where wi = ν1/(β−1+η)

= ν(ζ−ε)i/(β−1+η) as before. Observe that this i satisﬁes
i = log logν(kxvkdn/wv)/ log(ζ − ε) + O(1) ≤ (1 + O(ε))Λ(xv , wv) + O(1).

i

By Theorem 19, whp all vertices in V≥wi ∩ Bi are active in round i + 3, and there
are ω(1) of them. As in (I), we discriminate two sub-cases.

Either kxvkdn ≥ νi.

In this case, the distance from v to any point in Bi is
at most 3kxvk, and v has probability Ω(1) to form an edge with each vertex in
V≥wi∩ Bi by (26). By Theorem 19, whp all these vertices are active in round i + 3,
and there are ω(1) of them, so whp v will be active in round i + 4.

Or kxvkdn ≤ νi, hence xv ∈ Bi. Furthermore we have wv > (kxvkdn)1/(β−1) ≥
(wi−1wv)1/(β−1) by minimality of i in (26), implying wv > w1/(β−2)
≥ wi. Thus by
Theorem 19 whp v is active in round i + 3. In either case, whp v is active in round
i + O(1), i.e. Lv ≤ i + O(1) ≤ (1 + O(ε))Λ(xv, wv) + O(1), as required.

i−1

0

such that

so there is nothing to show.

For the lower bound, if kxvkdn/wv ≤eν0 = ν(β−1)/(β−2)+ε then Λ(xv, wv) = O(1),
Otherwise, kxvkdn/wv ≥eν0 ≥eν1/(β−1−η)
=eν(ζ+ε)i/(β−1−η)
where ˜wi =eν1/(β−1−η)

i = log logν(kxvkdn/wv)/ log(ζ + ε) − O(1) ≥ (1 − O(ε))Λ(xv , wv) − O(1).

Let ℓ = O(1) be suﬃciently large such that ζℓ > (β − 1 − η). If i ≤ ℓ, then i = O(1),
and there is nothing to show. Otherwise, (27) implies in particular

, so we may choose i ≥ 0 to be maximal

as before. Note that this i satisﬁes

kxvkdn/wv ≥ ˜wi,

(27)

0

i

Hence, by Lemma 14 (with C = 21/d > 1) we obtain

i

i−ℓ

= Ω(1)eν(ζ+ε)ℓ/(β−1−η)
kxvkdn ≥ Ω(1)eν1/(β−1−η)
E[N (v) ∩ eBi−ℓ] = O(1)eνi−ℓ(cid:0)kxvkdn/wv(cid:1)1−β+η
E[N (v)∩ eBi−ℓ] = O(1)eνi−ℓ/eνi =eν−Ω(1)

,

i

> 2eνi−ℓ.

.

Using (27), we may continue

where the last step holds for any ℓ ≥ 1. By Markov’s inequality, whp v has no

neighbours in eBi−ℓ. On the other hand, by Theorem 17 whp there is no active
vertex outside of eBi−ℓ in round i − ℓ. Therefore, whp v is not active in round

i − ℓ + 1, i.e. Lv > i − ℓ + 1 ≥ (1 − O(ε))Λ(xv, wv) − O(1), as required.

(III): Assume wv ≤ (kxvkdn)1/(β−1). Again we need to show an upper and a
lower bound for Lv. For the upper bound, let i ≥ 0 be minimal with the property
that xv ∈ Bi, i.e.

kxvkdn ≤ νi = ν(ζ−ε)i

(28)

Observe that i ≥ 1 because kxvkdn ≥ eν0 > ν due to the technical assumption

in Theorem 4 and since the function Λ is non-negative. Thus, we have kxvkdn ≥
νi−1 = ν1/(ζ−ε)

by minimality of i. Let ℓ ≥ 0 be minimal with the property that

i

wv > (kxvkdn)(ζ−ε)−ℓ/(β−1+η)

(29)
Since we are in the case wv ≤ (kxvkdn)1/(β−1), we have ℓ ≥ 1, and thus (29) is false
if we replace ℓ by ℓ − 1. By minimality of i, the right hand side of (29) is at least
ν(ζ−ε)−ℓ−1/(β−1+η)
and recall that we only consider weights wv = ω(1). Hence,

i

BOOTSTRAP PERCOLATION ON GEOMETRIC INHOMOGENEOUS RANDOM GRAPHS 25

Theorem 19 applies for ℓ + 1, and, if we condition on events that hold whp, tells us
that v is active in round i + ℓ + 4 with probability

1 − exph−C1νC2(ζ−ε)−ℓ−1

i

i = 1 − o(1),

where the last inequality holds due to the following estimate

ν(ζ−ε)−ℓ−1

i

(28)

≥ (kxvkdn)(ζ−ε)−ℓ−1 (29),ℓ−1

≥ w(β−1+η)/(ζ−ε)2

v

= ω(1).

It remains to note that by choice of i and ℓ we have

i = log logν(kxvkdn)/ log(ζ − ε) + O(1)

and ℓ = i + log logν wv/ log(ζ − ε) + O(1). Hence, whp Lv ≤ i + ℓ + 4 ≤ (1 +
O(ε))Λ(xv, wv) + O(1), as required.

For the lower bound, we distinguish yet two more sub-cases. Let ℓ ≥ 0 be the

smallest non-negative integer that satisﬁes

v ≥ 2−(ℓ+1)d(kxvkdn)(ζ+ε)−ℓ−3/(β−1).
w2

(30)

with the property

(IIIa) Assume ﬁrst that kxvkdn ≥ 2ℓ+1eν0. In this case, let i ≥ 1 be maximal
It is easy to check (e.g., by using the very generous estimate 2 < eν(ζ+ε)i

kxvkdn ≥ 2ℓ+1eνi−1 = 2ℓ+1eν(ζ+ε)i−1

i ≥ log logν(kxvkdn)/ log(ζ + ε) − O(log(ℓ + 1)).

) that i

satisﬁes

(32)

(31)

0

0

.

If ℓ = O(1) then wv = (kxvkdn)Θ(1) and therefore

Λ(xv, wv) = log logν(kxvkdn)/| log(β − 2)| ± O(1).

Since by Theorem 17 (c) whp no vertex outside of eBi−1 is active in round i − 1 and
xv 6∈ eBi−1, we have whp Lv > i − 1 ≥ (1 − O(ε))Λ(xv, wv) − O(1), as required.
Next observe that there exists 0 ≤ j ≤ O(log(ℓ + 1)) such that kxvkdn ≤eνi+j.

In particular, if ℓ > C for some suﬃciently large constant C > 0 then j < ℓ. Since
we have already treated the case ℓ = O(1), we may henceforth assume that ℓ > C.
Then ℓ − j > 0, and by (31) the requirements of Theorem 17 (f) are met for i and
ℓ − j. By minimality of ℓ,

i

i

i+j

w2

(33)

and therefore Theorem 17 (f) yields that v is not active in round i + ℓ − j with
probability at least

v ≤ 2−ℓd(kxvkdn)(ζ+ε)−ℓ−2/(β−1) ≤ 2−ℓdeν(ζ+ε)−ℓ−2/(β−1)
= 2−ℓdeν(ζ+ε)−(ℓ−j)−2/(β−1)
1 − wv2(ℓ−j)deν−(ζ+ε)−(ℓ−j)−2 /(β−1)
v ≥ 2−(ℓ+1)deν(ζ+ε)i−ℓ−4/(β−1)

In order to relate i + ℓ − j with Λ(xv, wv), we derive kxvkdn ≥eν(ζ+ε)i−1

Hence, taking logarithms on both sides,

= 2−(ℓ+1)dνΘ(1)(ζ+ε)i−ℓ

and plug it into (30) to obtain

(33)
≥ 1 − w−1

v 2−jd = 1 − o(1).

Θ(1)(ζ + ε)i−ℓ log ν ≤ 2 log wv + (ℓ + 1)d log 2 ≤ O(max{log wv, ℓ}).

from (31),

(34)

w2

0

.

,

0

26

C. KOCH AND J. LENGLER

If the maximum is attained by log wv, then (34) gives ℓ ≥ i − log logν wv/ log(ζ +
ε) − O(1), and together with (32) and j = O(log(1 + ℓ)), we conclude i + ℓ − j ≥
(1−O(ε))Λ(xv, wv)−O(1), as required. On the other hand, of the maximum in (34)
is attained by ℓ, then (34) yields

ℓ + O(log ℓ) ≥ i +

log log ν
log(ζ + ε)

− O(1) ≥ i −

log logν wv
log(ζ + ε)

− O(1),

where the second inequality comes from wv = ω(1). Thus we obtain again i+ℓ−j ≥
(1−O(ε))Λ(xv, wv)−O(1), as required. This concludes the proof of the lower bound

in the case kxvkdn ≥ 2ℓ+1eν0.
(IIIb) Assume kxvkdn ≤ 2ℓ+1eν0. It remains to show the lower bound on Lv in

this case. We want to apply Theorem 17 (f) for i = 0, but we need to change the
deﬁnition of ℓ slightly. Let ℓ′ ≥ 0 be minimal with the property

0

0

.

0

w2

(35)
Similar as before, this deﬁnition implies ℓ′ + O(log(ℓ′ + 1)) ≥ − log logν wv/ log(ζ +
ε) − O(1).
.
suﬃcient condition for ℓ to satisfy (30) is

In this case, since kxvkdn ≤ 2ℓ+1eν0, a

If ℓ′ ≤ 1 then wv = eνΩ(1)

v ≥ 2−(ℓ′+1)deν(ζ+ε)−ℓ′−3/(β−1)
≥ 2−(ℓ+1)d(2ℓ+1eν0)(ζ+ε)−ℓ−3/(β−1),

eνΩ(1)

0

which is already satisﬁed for ℓ = O(1). Since ℓ was chosen minimally, this implies
, and the lower bound is trivial. So assume
instead that ℓ′ > 1. Let ℓ∗ := min{ℓ′ − 1, Λ(xv, wv)}. Then by the assumption in

ℓ = O(1) and thus kxvkdn = eνO(1)
Theorem 4, we have ℓ∗ ≤ log2(kxvkdn/eν0), and hence kxvkdn ≥ 2ℓ∗

ℓ′, the reverse of (35) holds. These two properties allow us to apply Theorem 17
(f) with i = 0 and ℓ∗ − 1, which tells us that v is not active in round ℓ∗ − 1 with
probability at least 1 − w−1
v = 1 − o(1). It remains to relate ℓ∗ with Λ(xv, wv). To
this end, all that remains to be shown is that log logν(kxvkdn) = o(ℓ′)+ O(1). Since

eν0. Since ℓ∗ <

ℓ, we have

kxvkdn ≤ 2ℓ+1eν0, we have logν(kxvkdn) ≤ o(ℓ) + O(1). However, by minimality of

v ≤ 2−ℓd(kxvkdn)(ζ+ε)−ℓ−2/(β−1−η) ≤ (2ℓ+1eν0)(ζ+ε)−ℓ−2/(β−1),

and similar as for (31) it can be easily deduced that ℓ = O(log logν wv) = O(ℓ′).
(cid:3)

w2

This concludes the proof for the case kxvkdn ≤ 2ℓeν0.

Theorem 2

8. Threshold and speed of the process: Proof of Theorem 1 and

We prove Theorem 1 and Theorem 2 together. Let ε > 0 be a constant and let
η = η(ε) > 0 be a constant which is suﬃciently small compared to ε, cf. Section 2.3.

We ﬁrst show the second statement of Theorem 2.

Claim 21. Assume that α > β − 1 and ν = no(1), then |V ≤(1−ε)i∞ | = o(n) whp.

and note that then i0 ≥ (1 − O(ε))(log logν n)/| log(β − 2)|. Moreover, for i1 :=

Proof. Let i0 be (somewhat arbitrary) the largest integer such thateνi0−1 ≤ n/ log2 n
(1 − ε)(log log n)/| log(β − 2)| we have 2i1eνi0−1 = o(n), so whp there are o(n) ver-
tices in 2i1eBi0−1. Next consider the vertices outside of 2i1eBi0−1. By Theorem 17

each such vertex of weight at most log log n has probability o(1) to be in V ≤i0+i1 .
Therefore, the expected number of vertices of weight at most log log n in V ≤i0+i1

BOOTSTRAP PERCOLATION ON GEOMETRIC INHOMOGENEOUS RANDOM GRAPHS 27

is o(n). On the other hand, the total expected number of vertices of weight larger
than log log n is also o(n). Altogether, this shows E[|V ≤i0+i1 |] = o(n), and the
statement follows from Markov’s inequality.
(cid:3)

Subcritical regime: (iii), (v). We will indeed show that whp the process does
not infect any vertices in the ﬁrst step.

Claim 22. V ≤1 = V ≤0 whp.

Proof. For any vertex v = (xv, wv) with ﬁxed weight and position we denote by
µv := E[|N (v)∩ B0|] its expected number of neighbours in B0. We have shown in
Lemma 14 that for any constant C > 1,

µv = O(ν) ·(min {wv/ν, 1} ,

min(cid:8)(cid:0)wv/(kxvkdn)(cid:1)m

if kxvk ≤ C(ν/n)1/d/2,

, 1(cid:9) if kxvk ≥ C(ν/n)1/d/2,

where m = min{α, β − 1 − η} > 1. Since initially only vertices in B0 are acti-
vated, recall that the number N ≤0(v) of initially active neighbours of v is Poisson
distributed with mean ρµv. In particular, Pr[|N ≤0(v)| ≥ k] = Pr[Po (ρµv) ≥ k] =
O(1) min{(ρµv)k, 1}. Clearly, we can bound the number |V =1| of vertices that turn
active in round 1 by the number of vertices that have at least k neighbours in V ≤0.
(It is only an upper bound since the latter also counts vertices which were already
in V ≤0.)

So let us ﬁrst consider the contribution nin := |V =1∩ 2B0| of vertices v = (xv, wv)
inside of 2B0. By (36) these satisfy µv = O(wv), and thus by Lemma 10 and 11 we
obtain

(36)

E[nin] = O(1)Z ∞

0

νw1−β+γ d
dw

min{(ρw)k, 1}dw = O(νρβ−1−γ) = o(1),

(37)

where γ = 0 in case of a strong power-law, and otherwise γ is an arbitrary positive
constant.

On the other hand, to estimate the contribution nout := |V =1∩ (Td \ 2B0)| of
vertices v = (xv, wv) outside of 2B0, we may use µv = O(ν)(wv/(kxvkdn))m by (36).
Furthermore, since each such vertex has distance at least (ν/n)1/d from the origin,
Lemma 10 and Lemma 11 imply

E[nout] = O(1)Z ∞
= O(1)Z ∞

(ν/n)1/d

(ν/n)1/d

w1−β+η d
dw

0

rd−1nZ ∞
rd−1n(cid:18) rdn

(ρν)1/m(cid:19)1−β+η

dr

= O(1)ν2−β+η(ρν)(β−1+η)/m

min(cid:26)(cid:16)ρν(cid:16) w

rdn(cid:17)m(cid:17)k

, 1(cid:27) dwdr

Now we use that ρ = O(ν−1/(β−1)). Observe that this bound holds both in case
(iii) and (v), and that it even holds for the critical case (ii). We derive ρν =
O(ν(β−2)/(β−1)), and hence E[nout] = ν−(β−2)(1−1/m)+O(η). Thus, since m > 1, if
η > 0 is small enough we have

E[nout] = o(1).

(38)

We will later use the fact that this also holds in the critical regime (ii).

Together (37) and (38) show that E[|V =1|] = o(1), and thus by Markov’s in-
(cid:3)

equality whp no vertices turned active in round 1, as claimed.

28

C. KOCH AND J. LENGLER

Critical regime: (ii). We ﬁrst show that with constant probability no further
vertices are ever activated.

Claim 23. V ≤1 = V ≤0 with probability Ω(1).

Proof. First observe that (38) also holds in this regime, i.e. by Markov’s inequality
whp no vertex outside of 2B0 is active in round 1. Furthermore, let ξ > 0 be a
(small) constant, to be determined later, and let w0 := ν1/(β−1). Moreover, note
that |V≥ξw0 ∩ 2B0| is Poisson distributed with mean O(ν(ξw0)1−β) = O(1), since
ξ = Ω(1). Therefore the event A := {V≥ξw0
∩ 2B0 = ∅} occurs with probability at
least exp[−O(1)] = Ω(1). Consequently it suﬃces to show that V ≤1
∩ 2B0 = V ≤0
with probability Ω(1) if we condition on the event A.

≤ξw0

Since every vertex v = (xv, wv) satisﬁes E[|N (v)∩ B0|] ≤ E[|N (v)|] = O(wv),
by (11), the number of neighbours in V ≤0 is a Poisson distributed random variable
with mean at most O(ρwv). Observe that this upper bound remains valid if we
condition on the event A, since this can only decrease the expected degree of v.
Therefore we obtain

(ρw)kdw!

and by Lemma 10 it follows that

Pr(cid:2)|N ≤0(v)| ≥ k(cid:12)(cid:12) A(cid:3) = O(1) min{(ρwv)k, 1} = O((ρwv)k),
≤ξw0 ∩ 2B0|(cid:12)(cid:12) A(cid:3) = O ν(ξw0)1−β(ρξw0)k +Z ξw0
E(cid:2)|V =1
ξ > 0 small enough such that Eh|V =1

= O(1)ν(ξw0)1−β(ρξw0)k = O(ξk+1−β ),

νw1−β d
dw

0

where all the hidden constants are independent of ξ. Now note that we may choose

inequality |V =1
V ≤0 with probability Ω(1), and the claim follows.

∩ 2B0| = 0 with conditional probability at least 1/2. Thus V ≤1 =
(cid:3)

≤ξw0 ∩ 2B0|(cid:12)(cid:12)(cid:12) Ai ≤ 1/2, and then by Markov’s

≤ξw0

Next we show that with constant probability at least k heavy vertices will be
activated in the ﬁrst round. Afterwards, the remaining steps will be identical with
the supercritical regime, so we prove them together, cf. below.

Claim 24. |V =1

≥w0 ∩ B0| ≥ k with probability Ω(1).

Proof. We ﬁrst consider the case α < ∞. Note that the number of vertices in B0 of
weight at least w0 = ν1/(β−1) is Poisson distributed with mean Θ(νwβ−1
) = Θ(1).
In particular, with probability Ω(1) there are at least k such vertices. So assume
this event holds, and let v1, . . . , vk be k distinct such vertices. For each 1 ≤ i ≤ k,
denote by Ki be the intersection of B0 with the ball of volume ν1/(β−1)/n around vi.
Note that nVol(Ki) = Ω(ν1/(β−1)). The number of vertices in V ≤0∩ Ki is Poisson
distributed with mean ρnVol(Ki), so in particular Pr[|V ≤0∩ Ki| ≥ k] = Ω(1). Note
that the events K(i) := {|V ≤0∩ Ki| ≥ k} are positively associated for diﬀerent i,
i.e, conditioning on the events K(i1), . . . , K(is) does not decrease the probability of
K(i) for any subset of (distinct) indices i1, . . . , is, i. Hence,

0

Pr[∀i ∈ {1, . . . k} : K(i)] ≥

by the law of conditional probability.

Pr[K(i)] = Ω(1)

kYi=1

BOOTSTRAP PERCOLATION ON GEOMETRIC INHOMOGENEOUS RANDOM GRAPHS 29

On the other hand, for each vertex v with ﬁxed weight and ﬁxed position in
Ki we have Pr[{v, vi} ∈ E] = Ω(w0/ν1/(β−1)) = Ω(1), and this lower bound is
independent for any two such vertices. So conditioned on the events K(i), we have
Pr[vi ∈ V ≤1 | K(1), . . . , K(k)] = Ω(1), and this lower bound is independent for all
i. Altogether, we have shown that with probability Ω(1) we have {v1, . . . , vk} ⊆
V =1
≥w0 ∩ B0, proving the claim in the case of α > ∞.
The case α = ∞ is completely analogous, except that it may be necessary to
shrink the balls around v1, . . . , vk be at most a constant factor, so that still every
vertex in the i-th ball has probability Ω(1) to connect to vi. Since this only de-
creases the expected number of (active) vertices in each ball by constant factors,
the remaining proof stays the same. We omit the details.
(cid:3)

Supercritical regime: (i), (iv). In this proof we also include the critical regime
(ii), provided that at least k heavy vertices got activated in the ﬁrst round, i.e.
|V =1

≥w0 ∩ B0| ≥ k, where as before w0 = ν1/(β−1). Let ε > 0 be constant.

Claim 25. E[|V ≤(1+ε)i∞ |] = Ω(n).
Proof. Let i ≥ 0 be the smallest index such that νi ≥ n (and thus Bi = Td), and
note that i ≤ (1 + ε)(log logν n)/| log(β − 2)| if n is suﬃciently large. Then there
exists ℓ ≤ (1 + ε)(log log n)/| log(β − 2)| such that wi,ℓ = O(1). Theorem 19 tells
us immediately that every vertex of weight at least C has probability Ω(1) to be in
A(i + 3 + ℓ), for some suﬃciently large constant C > 0. Since the expected number
of vertices of weight at least C is Ω(n), this already shows the claim.
(cid:3)

It remains to proof the corresponding whp statement.

Claim 26. |V ≤(1+ε)i∞ | = Ω(n) whp.

Proof. Let h = h(n) = ω(1) be a function with log log h = o(log log n). Then by the
same argument as before, every vertex of weight at least wh := ˆw−(h) = h1/(β−1+η)
has probability 1 − h−Ω(1) to be in V ≤(1+ε/2)i∞ . Now decompose the torus Td into
balls Q1, . . . , Qs of volume Θ(h/n).4 Fix any such ball Q, and call Q good if in
∩ Q are active, and
round j := (1 + ε/2)i∞ at least half of the vertices in V≥wh
bad otherwise. Recall that in expectation only a o(1) fraction of the vertices in
∩ Q are inactive in round j, so by Markov’s inequality the probability that Q
V≥wh
is bad is o(1). So in expectation only a o(1) fraction of the sets Q1, . . . , Qs are bad,
and again by Markov’s inequality, whp at least half of them are good.

Now let C > 0 be a suﬃciently large constant, and assume Q is good. Then we
may apply Remark 20 (for some suitably chosen 0 ≤ ℓ = O(log log h)) to deduce
that an expected 2/3-fraction of the vertices in V≥C∩ Q are active in round j + ℓ, if
C > 0 is suﬃciently large. In formula, E[|V ≤j+ℓ
≥C ∩ Q|] ≥ 2E[|V≥C∩ Q|]/3, and thus
by Markov’s inequality,

Prh(cid:12)(cid:12)(cid:12)V ≤j+ℓ

≥C ∩ Q(cid:12)(cid:12)(cid:12) ≥ E(cid:2)(cid:12)(cid:12)V≥C∩ Q(cid:12)(cid:12)(cid:3) /2i = Ω(1),

and this bound holds independently of the activity in any other ball. Therefore, by a
Chernoﬀ bound, whp an Ω(1) fraction of the balls Q1, . . . , Qs satisfy |V ≤j+ℓ
≥C ∩ Q| ≥

E(cid:2)(cid:12)(cid:12)V≥C∩ Q(cid:12)(cid:12)(cid:3) /2 = Ω(h), and thus whp |V ≤j+ℓ| = Ω(s · h) = Ω(n). Since j + ℓ ≤

(1 + ε)i∞ for suﬃciently large n, the claim follows.

4This is possible since we use the ∞-norm. It would also suﬃce to consider any disjoint balls

(cid:3)

with total volume Ω(1).

30

C. KOCH AND J. LENGLER

Proof of Theorem 1 and Theorem 2.

Proof. Theorem 1 follows from Claims 22, 23, 24 and 26, while Theorem 2 is proven
by Claims 21 and 26.
(cid:3)

9. Concluding remarks

We have shown that in the GIRG model for scale-free networks with underlying
geometry, even a small region can cause an infection that spreads through a linear
part of the population. We have analysed the process in great detail, and we have
determined its metastability threshold, its speed, and the time at which individual
vertices become active. Moreover, we have shown how a policy-maker can utilize
this knowledge to enforce a successful quarantine strategy. We want to emphasize
that the latter result is only a proof of concept, intended to illustrate the possibilities
that come from a thorough understanding of the role of the underlying geometry
in infection processes. In particular, we want to remind the reader that bootstrap
percolation is not a perfect model for viral infections (though it has been used to this
end), but is more adequate for processes in which the probability of transmission
grows more than proportional if more than one neighbours is active, like believes
spreading through a social network (“What I tell you three times is true.”), or
action potential spreading through a neuronal network.

Therefore, this paper is only a ﬁrst step. There are many other models for the
spreading of activity, most notably SIR and SIRS models for epidemiological appli-
cations, and we have much yet to learn from analysing these models in geometric
power-law networks like GIRGs. From a technical point of view, it is unsatisfactory
that our analysis does not include the case α ≤ β − 1. We believe that also in this
case, the bootstrap percolation process is essentially governed by the geometry of
the underlying space, only in a more complex way. Understanding this case would
probably also add to our toolbox for analysing less “clear-cut” processes.

References

1. Joan Adler and Uri Lev, Bootstrap percolation: visualizations and applications, Brazilian

Journal of Physics 33 (2003), no. 3, 641–644.

2. William Aiello, Anthony Bonato, Colin Cooper, Jeanette Janssen, and Pawe l Pra lat, A spatial
web graph model with local inﬂuence regions, Internet Mathematics 5 (2008), no. 1-2, 175–196.
3. Michael Aizenman and Joel Lebowitz, Metastability eﬀects in bootstrap percolation, Journal

of Physics A: Mathematical and General 21 (1988), no. 19, 3801.

4. R´eka Albert and Albert-L´aszl´o Barab´asi, Statistical mechanics of complex networks, Reviews

of modern physics 74 (2002), no. 1, 47.

5. Hamed Amini, Bootstrap percolation in living neural networks, Journal of Statistical Physics

141 (2010), no. 3, 459–475.

6. Hamed Amini, Rama Cont, and Andreea Minca, Resilience to contagion in ﬁnancial networks,

Mathematical ﬁnance (2013).

7. Hamed Amini and Nikolaos Fountoulakis, Bootstrap percolation in power-law random graphs,

Journal of Statistical Physics 155 (2014), no. 1, 72–92.

8. J´ozsef Balogh, B´ela Bollob´as, Hugo Duminil-Copin, and Robert Morris, The sharp thresh-
old for bootstrap percolation in all dimensions, Transactions of the American Mathematical
Society 364 (2012), no. 5, 2667–2701.

9. J´ozsef Balogh, Yuval Peres, and G´abor Pete, Bootstrap percolation on inﬁnite trees and non-

amenable groups, Combinatorics, Probability and Computing 15 (2006), no. 05, 715–730.

10. Albert-L´aszl´o Barab´asi, Network science: Luck or reason, Nature 489 (2012), no. 7417, 507–

508.

BOOTSTRAP PERCOLATION ON GEOMETRIC INHOMOGENEOUS RANDOM GRAPHS 31

11. Gareth Baxter, Sergey Dorogovtsev, Alexander Goltsev, and Jos´e Mendes, Bootstrap percola-

tion on complex networks, Physical Review E 82 (2010), no. 1, 011103.

12. Mari´an Bogu˜n´a, Dmitri Krioukov, and Kimberly Claﬀy, Navigability of complex networks,

Nature Physics 5 (2009), no. 1, 74–80.

13. Mari´an Bogu˜n´a, Fragkiskos Papadopoulos, and Dmitri Krioukov, Sustaining the internet with

hyperbolic mapping, Nature communications 1 (2010), 62.

14. Milan Bradonji´c and Iraj Saniee, Bootstrap percolation on random geometric graphs, Proba-

bility in the Engineering and Informational Sciences 28 (2014), no. 02, 169–181.

15. Karl Bringmann, Ralph Keusch, and Johannes Lengler, Geometric inhomogeneous random

graphs, arxiv (2015).

16.

, Average distance in a general class of scale-free graphs with underlying geometry,

arxiv (2016).

17. Elisabetta Candellero and Nikolaos Fountoulakis, Bootstrap percolation and the geometry of

complex networks, arXiv:1412.1301 (2014).

18. Shai Carmi, Shlomo Havlin, Scott Kirkpatrick, Yuval Shavitt, and Eran Shir, A model of in-
ternet topology using k-shell decomposition, Proceedings of the National Academy of Sciences
104 (2007), no. 27, 11150–11154.

19. Damon Centola, The spread of behavior in an online social network experiment, Science 329

(2010), no. 5996, 1194–1197.

20. John Chalupa, Paul Leath, and Gary Reich, Bootstrap percolation on a bethe lattice, Journal

of Physics C: Solid State Physics 12 (1979), no. 1, L31–L35.

21. Or Cohen, Anna Keselman, Elisha Moses, Rodr´ıguez Mart´ınez, Jordi Soriano, and Tsvi Tlusty,
Quorum percolation in living neural networks, EPL (Europhysics Letters) 89 (2010), no. 1,
18008.

22. Colin Cooper, Alan Frieze, and Pawe l Pra lat, Algorithms and models for the web graph:
9th international workshop, waw 2012, halifax, ns, canada, june 22-23, 2012. proceedings,
ch. Some Typical Properties of the Spatial Preferred Attachment Model, pp. 29–40, Springer
Berlin Heidelberg, Berlin, Heidelberg, 2012.

23. Sergey Dorogovtsev, Alexander Goltsev, and Jos´e Mendes, K-core organization of complex

networks, Physical review letters 96 (2006), no. 4, 040601.

24. Sergey Dorogovtsev and Jos´e Mendes, Evolution of networks, Advances in Physics 51 (2002),

no. 4, 1079–1187.

25. Paul Dreyer and Fred Roberts, Irreversible k-threshold processes: Graph-theoretical threshold
models of the spread of disease and of opinion, Discrete Applied Mathematics 157 (2009),
no. 7, 1615–1627.

26. Hafsteinn Einarsson, Johannes Lengler, Konstantinos Panagiotou, Frank Mousset, and Ange-

lika Steger, Bootstrap percolation with inhibition, arXiv:1410.3291 (2014).

27. Hafsteinn Einarsson, Johannes Lengler, and Angelika Steger, A high-capacity model for one
shot association learning in the brain, Frontiers in Computational Neuroscience 8 (2014),
no. 140.

28. Paola Flocchini, Elena Lodi, Fabrizio Luccio, Linda Pagli, and Nicola Santoro, Dynamic

monopolies in tori, Discrete applied mathematics 137 (2004), no. 2, 197–212.

29. Jian Gao, Tao Zhou, and Yanqing Hu, Bootstrap percolation on spatial networks, Scientiﬁc

Reports 5 (2015), 14662.

30. Allen Gersho and Debasis Mitra, A simple growth model for the diﬀusion of a new communi-
cation service, Systems, Man and Cybernetics, IEEE Transactions on SMC-5 (1975), no. 2,
209–216.

31. Mark Granovetter, Threshold models of collective behavior, American Journal of Sociology 83

(1978), no. 6, 1420–1443.

32. Mark S. Granovetter, The strength of weak ties, American Journal of Sociology 78 (1973),

no. 6, 1360–1380.

33. Randi Griﬃn and Charles Nunn, Community structure and the spread of infectious disease

in primate social networks, Evolutionary Ecology 26 (2012), no. 4, 779–800.

34. Wei Huang and Chunguang Li, Epidemic spreading in scale-free networks with community
structure, Journal of Statistical Mechanics: Theory and Experiment 2007 (2007), no. 01,
P01014.

35. Emmanuel Jacob and Peter M¨orters, Spatial preferential attachment networks: Power laws

and clustering coeﬃcients, The Annals of Applied Probability 25 (2015), no. 2, 632–662.

32

C. KOCH AND J. LENGLER

36. Svante Janson, Tomasz  Luczak, Tatyana Turova, and Thomas Vallier, Bootstrap percolation
on the random graph G(n, p), The Annals of Applied Probability 22 (2012), no. 5, 1989–2047.
37. Jeannette Janssen and Abbas Mehrabian, Algorithms and models for the web graph: 12th
international workshop, waw 2015, eindhoven, the netherlands, december 10-11, 2015, pro-
ceedings, ch. Rumours Spread Slowly in a Small World Spatial Network, pp. 107–118, Springer
International Publishing, Cham, 2015.

38. Amin Karbasi, Johannes Lengler, and Angelika Steger, Automata, languages, and program-
ming: 42nd international colloquium, icalp 2015, kyoto, japan, july 6-10, 2015, proceedings,
part ii, ch. Normalization Phenomena in Asynchronous Networks, pp. 688–700, Springer Berlin
Heidelberg, Berlin, Heidelberg, 2015.

39. Scott Kirkpatrick, Winfried Wilcke, Robert Garner, and Harald Huels, Percolation in dense
storage arrays, Physica A: Statistical Mechanics and its Applications 314 (2002), no. 1, 220–
229.

40. Robert Kozma, Neuropercolation, Scholarpedia 2 (2007), no. 8, 1360.
41. Renaud Lambiotte and Pietro Panzarasa, Communities, knowledge creation, and information

diﬀusion, Journal of Informetrics 3 (2009), no. 3, 180–190.

42. Cristian Moukarzel and Thomas Sokolowski, Long-range k-core percolation, Journal of

Physics: Conference Series 246 (2010), no. 1, 012019.

43. Javier Orlandi, Jordi Soriano, Enrique Alvarez-Lacalle, Sara Teller, and Jaume Casademunt,
Noise focusing and the emergence of coherent activity in neuronal cultures, Nature Physics 9
(2013), no. 9, 582–590.

44. Fragkiskos Papadopoulos, Maksim Kitsak, ´Angeles Serrano, Mari´an Bogu˜n´a, and Dmitri Kri-
oukov, Popularity versus similarity in growing networks, Nature 489 (2012), no. 7417, 537–
540.

45. Marlon Ramos, Jia Shao, Saulo Reis, Celia Anteneodo, Jos´e Andrade, Shlomo Havlin, and
Hern´an Makse, How does public opinion become extreme?, Scientiﬁc reports 5 (2015), 10032.
46. Christian Schmeltzer, Jordi Soriano, Igor Sokolov, and Sten R¨udiger, Percolation of spatially
constrained Erd˝os-R´enyi networks with degree correlations, Physical Review E 89 (2014),
no. 1, 012116.

47. Friedhelm Schwenker, Friedrich Sommer, and G¨unther Palm, Iterative retrieval of sparsely

coded associative memory patterns, Neural Networks 9 (1996), no. 3, 445–455.

48. Munik Shrestha and Cristopher Moore, Message-passing approach for threshold models of

behavior in networks, Physical Review E 89 (2014), no. 2, 022805.

49. Tsvi Tlusty and Jean-Pierre Eckmann, Remarks on bootstrap percolation in metric networks,

Journal of Physics A: Mathematical and Theoretical 42 (2009), no. 20, 205004.

50. Tatyana Turova, The emergence of connectivity in neuronal networks: from bootstrap perco-

lation to auto-associative memory, Brain research 1434 (2012), 277–284.

51. Christopher Warren, Leonard Sander, and Igor Sokolov, Geography in a scale-free network

model, Physical Review E 66 (2002), no. 5, 056105.

52. Duncan Watts, A simple model of global cascades on random networks, Proceedings of the

National Academy of Sciences 99 (2002), no. 9, 5766–5771.

53. Xin-Jian Xu, Xun Zhang, and Jos´e Mendes, Impacts of preference and geography on epidemic

spreading, Physical Review E 76 (2007), no. 5, 056109.

54. Zhi-Dan Zhao, Ying Liu, and Ming Tang, Epidemic variability in hierarchical geographical
networks with human activity patterns, Chaos: An Interdisciplinary Journal of Nonlinear
Science 22 (2012), no. 2, 023150.

