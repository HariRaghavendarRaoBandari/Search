On sector magnets or transverse electromagnetic ﬁelds in cylindrical coordinates∗

T. Zolkin†

Fermilab, PO Box 500, Batavia, IL 60510-5011

(Dated: March 14, 2016)

The Laplace’s equations for the scalar and vector potentials describing electric or magnetic ﬁelds in
cylindrical coordinates with translational invariance along azimuthal coordinate are considered. The
series of special functions which, when expanded in power series in radial and vertical coordinates,
in lowest order replicate the harmonic homogeneous polynomials of two variables are found. These
functions are based on radial harmonics found by Edwin M. McMillan in his more-than-40-years
”forgotten” article, which will be discussed. In addition to McMillan’s harmonics, second family of
adjoint radial harmonics is introduced, in order to provide symmetric description between electric
and magnetic ﬁelds and to describe ﬁelds and potentials in terms of same special functions. Formulas
to relate any transverse ﬁelds speciﬁed by the coeﬃcients in the power series expansion in radial or
vertical planes in cylindrical coordinates with the set of new functions are provided.

This result is no doubt important for potential theory while also critical for theoretical studies,
design and proper modeling of sector dipoles, combined function dipoles and any general sector
element for accelerator physics. All results are presented in connection with these problems.

I.

INTRODUCTION

Description of sector combined function magnets, and
in general any magnet with translational symmetry along
azimuthal coordinate in cylindrical coordinates, is very
important issue, and, without any particular reference
one can say that every modern accelerator code includes
such elements. The main idea, which goes back to orig-
inal 1968 K. Brown’s paper [1], based on a solution of
Laplace’s equation for scalar potential in cylindrical co-
ordinates using the general power series ansatz. Simi-
lar approach but for Laplace’s equation for longitudinal
component of vector potential can be found for example
in [2]. As one can see the approach is the same in most
recent books, e.g. in great details in [3].

Two major bottlenecks should be noticed. In the ﬁrst
place, if one looking for a solution in a form of a series,
these series should be truncated. In our case truncation
means that potentials do not satisfy the Laplace’s equa-
tion anymore, even if symplectic integrators are used for
numerical solution (of course potentials can “satisfy” the
Laplace’s equation up to desired order by keeping more
and more terms in expansion). But more importantly,
the recurrence equation is undetermined. That means in
every new order of recurrence one have to assign an ar-
bitrary constant, which will aﬀect all other higher order
terms. The uncertainty leads to the fact that there is no
one particular choice of basis functions; it make it almost
impossible to compare diﬀerent accelerator codes, since
diﬀerent assumptions might be used for representations
of basis functions.

The indeterminacy has simple geometrical illustration.
Looking for a ﬁeld with pure normal dipole component on
equilibrium orbit in lowest order, one can come up with

∗ Operated by Fermi Research Alliance, LLC under Contract
No. De-AC02-07CH11359 with the U.S. Department of Energy.
† zolkin@fnal.gov

almost arbitrary shape of magnet’s north pole if south
pole is symmetric with respect to midplane. In the case
of dipole, series can be truncated by keeping only dipole
component. For higher order multipoles in cylindrical co-
ordinates truncation without violation of Laplace’s equa-
tion is not possible.

Working on implementation of these magnets for Syn-
ergia, I found particular assumptions which let me to
summate series for pure electric and magnetic skew and
normal multipoles. Further look for symmetry in descrip-
tion allowed to generate full family of solutions where no
truncation is required since all series can be summated.
While discussing my results with Sergei Nagaitsev, he
brought my attention, as we found later to more-than-
40-years forgotten, article by McMillan [4] of 1975.

Brining together his and my results I would like to
present a new description for multipole expansion in
cylindrical coordinates. Any transverse ﬁeld can be ex-
panded in terms of these functions and related to power
series ﬁeld expansion in horizontal or vertical planes. The
new approach do not contradict with previous results but
embrace it. An ambiguity in choice of coeﬃcients and
problem of truncation are resolved. Thus it can be em-
ployed for theoretical studies, design and simulation of
sector magnets.

A. Article structure

Section II describes general equations of motion for a
particle in curvilinear coordinates associated with Frenet-
Serret frame. The case of transverse electromagnetic
ﬁelds described in section III.

Subsections III A,III B provide most general equations
of motion for pure electric and magnetic ﬁelds. Two
further subsections III D,III E describes the expansion of
ﬁelds in multipoles for cases with zero and constant cur-
vatures. The section III F relates new family of functions
to recurrence equations.

6
1
0
2

 
r
a

 

M
0
1

 
 
]
h
p
-
c
c
a
.
s
c
i
s
y
h
p
[
 
 

1
v
1
5
4
3
0

.

3
0
6
1
:
v
i
X
r
a

II. GENERAL EQUATIONS OF MOTION

A. Global coordinates in Lab frame

The Lagrangian of a relativistic particle of mass m with
an electric charge e in most general static electromagnetic
ﬁeld is given by

L[R, ˙R; t] = − m c2
γ(V)

− e Φ(R) + e (V · A(R)) ,

where R = (Q1, Q2, Q3) is a position vector in the conﬁg-
uration space of generalized coordinates spanned on three
dimensional right-handed Cartesian coordinate system
{ ˆE1, ˆE2, ˆE3} associated with Lab frame at the facility
of a particle accelerator, V ≡ ˙R is a vector of matching
dt is the time deriva-
generalized velocities where
tive operator. Φ(R) and A(R) are the electric scalar and
magnetic vector potentials respectively, and,

˙(. . .) ≡ d

1(cid:112)1 − β(V)2

γ(V) =

is the relativistic Lorentz factor where β is the ratio of V
to the speed of light in vacuum, c.

Substituting the Lagrangian into the Euler-Lagrange

equations (Lagrange’s equations of the second kind)

with shorthand notation

d
dt

∂
∂a

=

∂R

∂ L
∂ ˙R

− ∂ L
(cid:18) ∂

,

∂
∂a2

∂a1

= 0

,

∂
∂a3

(cid:19)

representing a vector of partial derivatives with respect
to the indicated variables, gives the equation of motion
which is the relativistic form of the Lorentz force

F = e [E + (V × B)]

or explicitly

d
dt

(γ m ˙Qi) = e (Ei + ijk ˙QjBk)

where the electric and magnetic ﬁelds related to scalar
electric and vector magnetic potentials through the gra-
dient and curl vector operators respectively
E = (E1, E2, E3) ≡ −∇ Φ,
B = (B1, B2, B3) ≡ ∇ × A.

A more abstract formulation can be given in terms
of Hamiltonian which describes phase space of canoni-
cal variables {P, Q}, where P is the particle’s canonical
(total) momentum deﬁned as

P ≡ ∂ L
∂ ˙R

= Π + e A

and Π = γ m V being the particle’s kinetic momentum.
The Hamiltonian might be constructed using the Legen-
dre transformation of L

2

3(cid:88)

i=1

(cid:113)

H[P, Q; t] = V P − L =

˙QiPi − L

= c

m2c2 + (P − e A)2 + e Φ.

The time evolution of the system is given by Hamilton’s
equations

= − ∂ H

∂Q

d P
dt

and

d Q
dt

=

∂ H
∂P

or equivalently

P − e A

(cid:112)m2c2 + (P − e A)2

˙Q = c
˙P = e (∇A) · ˙Q − e∇Φ.

,

The model of accelerator assumes the speciﬁcation of a
reference orbit designed for a particle with certain equi-
librium energy and assignment of beam line elements
placed along it. In the case of a circular accelerator the
closed orbit of a machine with alignment errors in general
will not coincide with reference orbit. For most acceler-
ator needs (except e.g. helical orbits for muon cooling)
the designed orbit is piecewise ﬂat function, which means
that it consists of a series of curves with zero torsion;
moreover, usually, these curves are straight lines and cir-
cular arcs.
In order to better exploit the geometry of
beam motion and symmetry of electromagnetic ﬁelds we
will introduce the local Frenet-Serret frame attached to
equilibrium orbit and new global coordinates associated
with it (see FIG. 1).

FIG. 1.
Schematic plot of an equilibrium orbit for an ac-
celerator consisting of ﬁve drift spaces and ﬁve 72◦ bending
magnets. Lab frame and local Frenet-Serret frames are shown
in black and blue colors respectively. The test particle wind-
ing the equilibrium orbit shown in red.

Q1Q1Q1Q3Q2Q2Q3Q3Q2Q1Q2Q3tnbtbbntnnbtB. Global coordinates associated with

Frenet-Serret frame

3

The equilibrium particle is a particle with design energy
perfectly following the reference orbit. Let R0(t) be the
position vector of it as a function of time. Then one
can describe the equilibrium orbit in terms of its natural
parametrization by arc length as

(cid:90) t

s(t) =

| ˙R0(t)| d t.

0

Now on can introduce the local right-handed orthonormal
Frenet-Serret basis {ˆn, ˆb, ˆt} (or TNB frame), where basis
vectors are deﬁned as follows:

• tangent unit vector

ˆt =

d R0(s)

ds

,

• outward-pointing normal unit vector

ˆn = − 1
κ(s)
• and binormal unit vector

d ˆt
ds

,

where κ =(cid:12)(cid:12)d ˆt/ds(cid:12)(cid:12) deﬁnes the local curvature of the equi-

ˆb = ˆt × ˆn,

librium orbit. Then, using the Frenet-Serret formulas de-
scribing the derivatives of unit vectors in terms of each
other

 =

ˆt

ˆn
ˆb

0 −κ 0

κ 0
τ
0 −τ 0

ˆt

 ds

ˆn
ˆb

d

where τ (s) is the torsion of an equilibrium orbit which
measures the failure of a curve to be planar, one can ex-
press the position vector of a test particle as a transverse
displacement from equilibrium orbit, see FIG. 2,

R(s) = R0(s) + r(s) = R0(s) + q1 ˆn + q2

ˆb.

and its’ inﬁnitesimally small displacement

dR = ˆn dq1 + ˆb dq2 + (1 + κ q1)ˆt dq3 + τ (q1

ˆb − q2 ˆn)dq3,

local

curvilinear

(q1, q2, q3) are

where
coordinates
spanned on (ˆn, ˆb, ˆt). One can see that in the case of
ﬂat orbit, i.e. τ = 0, the local Frenet-Serret frame can
be associated with global orthogonal coordinate system
with a line element in a form

3(cid:88)

FIG. 2.
pressed as a transverse, i.e.
equilibrium orbit.

Illustration of a test particle’s position vector ex-
for ﬁxed q3, displacement from

(cid:114)

The use of global coordinates with metric provided
by local Frenet-Serret frame allows to rewrite the La-
grangian as

L[r, ˙r; t] = −m c2

1 − v2

c2 − e Φ + e v · A,

where v = ( ˙q1, ˙q2, h ˙q3) is the particle’s velocity expressed
in new coordinates. Thus the new equations of motion
are

d
dt

(γ m v) = e (E + ijk ˆei vj Bk) + γ m ˙q2

3 K

where the vector in the RHS of equation deﬁned as

K = (κ h, 0, κ(cid:48) q1),

dq3

and the operator (. . .)(cid:48) ≡ d
is the derivative with re-
spect to longitudinal coordinate. Derivatives of poten-
tials expressed via electromagnetic ﬁelds using expres-
sions for diﬀerential operators in curvilinear orthogonal
coordinates form Table I. Calculating components of the
new canonical momenta
∂ L
∂ ˙qi

= γ m vi + e Ai(r)

≡ 1
hi

pi
hi

allows to write down the new Hamiltonian

(cid:118)(cid:117)(cid:117)(cid:116)m2c2 +

3(cid:88)

(cid:18) pi − e hiAi

(cid:19)2

i=1

hi

+ e Φ

H[p, q; t] = c

and equations of motion
˙qi × hi =

c2

pi − e hiAi

,

(cid:34)

hi

(cid:18) p3 − e h A3

(cid:19)2(cid:35)

h

e ijk

pj
hj

Bk +

Ki
h2

H − e Φ

c2

H − e Φ
+e Ei.

dl =

hiˆeidqi,

˙pi / hi =

where scale factors are h1 = h2 = 1 and h ≡ h3 = 1+κ q1.

i=1

tQQ1QR(s)br(s)32R  (s)0n4

TABLE I. Diﬀerential operators in general orthogonal coordinates (q1, q2, q3) where H = h1h2h3, and its expressions in orthog-
onal coordinates associated with Serret-Frenet frame.

Gradient

∇φ

Divergence

∇ · F

Curl

∇ × F

Scalar Laplacian (cid:52)φ = ∇ · (∇φ)

Vector Laplacian (cid:67)F = ∇(∇ · F) − ∇ × (∇ × F)

ˆe2 +

∂ φ
∂q3

ˆe3

1
h

(cid:19)

Fk

hk

∂(h F2)

∂q2

(cid:21)

+

∂ F3
∂q3

3(cid:88)

k=1
∂ φ
∂q1

1
hk

∂ φ
∂qk

ˆek

∂ φ
∂q2

+

H

∂q1

ijk

1
H

ˆe1 +

hk ˆek

∂
∂qk

k=1
1
h

(cid:18) H
3(cid:88)
(cid:20) ∂(h F1)
3(cid:88)
(cid:20) ∂(h F3)
(cid:18) H
3(cid:88)
(cid:19)
(cid:20) ∂
(cid:26) 1
(cid:20) 1
3(cid:88)

k=1
1
h

k=1
1
h

∂
∂qk

∂ φ
∂q1

(cid:18)

1
H

∂q1

∂q2

h2
k

hk

k=1

(cid:21)
(cid:19)

∂ φ
∂qk

∂
∂qi (hjFj)
− ∂ F2
∂q3

ˆe1 +

(cid:20) ∂ F1

∂q3

1
h

(cid:21)

ˆe2 +

(cid:20) ∂ F2

∂q1

(cid:21)

ˆe3

− ∂ F1
∂q2

− ∂(h F3)

∂q1

(cid:18)
(cid:18) H

∂
∂q2

h

∂ φ
∂q2

(cid:19)(cid:21)

(cid:19)

(cid:18) 1

h

+

∂
∂q3

− hk
H

ijk

∂
∂qi

(cid:19)(cid:21)
(cid:20) h2

∂ φ
∂q3

j ˆej
H

(cid:21)(cid:27)

∂
∂ql (hmFm)

ˆek

lmj

h

+

∂
∂qk

∂
∂qi

H

Fi

hi

III. TRANSVERSE ELECTROMAGNETIC

A.

t-representation

FIELDS

Now we will restrict ourself with the case of transverse
electromagnetic ﬁelds; in orthogonal curvilinear coordi-
nate system associated with Serret-Frenet frame these are
the ﬁelds with translation symmetry along longitudinal
coordinate q3. Thus, the scalar and vector potentials are
function of transverse coordinates only and vector poten-
tial has only one nonvanishing component which is A3.
Both potentials satisﬁes Laplace equation

(cid:18)

(cid:20) ∂
(cid:20) 1

∂q1

1
h
∂
∂q1

h

∂ Φ
∂q1

∂ (h A3)

h

∂q1

(cid:19)
(cid:21)

(cid:52)Φ =

(cid:67)A =

(cid:19)(cid:21)

(cid:18)
(cid:20) 1

h

+

+

∂
∂q2
∂
∂q2

= 0,

∂ Φ
∂q2
∂ (h A3)

(cid:21)

h

∂q2

= 0.

E = −∇Φ

and

B = ∇ × A

with diﬀerential operators deﬁned for orthogonal curvi-
linear coordinate system (Table I), and one gets

E1 = − ∂ Φ
∂q1
E2 = − ∂ Φ
∂q2

,

,

1
B1 =
h
B2 = − 1
h

∂(h A3)

∂q2

∂(h A3)

∂q1

,

.

In the case of pure electric or magnetic ﬁelds further
simpliﬁcations can be applied. For numerical integration
purposes it is very convenient to have a Hamiltonian in
a form of a sum of “kinetic” and “potential” energies
where potentials will be separated from momentum vari-
ables. In this case, one can easily construct symplectic
integrator consisting of “drifts” and “kicks” associated
with kinetic and potential terms respectively (e.g. [5]).

For pure electric ﬁeld when curvature is independent
of longitudinal coordinate not only Hamiltonian but also
p3 is an invariant of motion, and, problem is essentially
two dimensional. Measuring the time in units of c t and
normalizing the transverse momentums over the longitu-
dinal component, ˜p1,2 = p1,2/p3, one has

(cid:115)

1
h

p2
3 + h2m2c2

p2
3

+ h2(˜p2

1 + ˜p2

2) +

e
p3 c

Φ.

We will call this model Hamiltonian the t-representation;
with no assumptions made, but the ﬁeld symmetry, we
derived general equations of motion which can be used
for the basis for the construction of symplectic integrator.
In a paraxial approximation, ˜p1,2 (cid:28) 1,and for p1,2 (cid:29) m c
the form is signiﬁcantly simpler, and a limit of straight
coordinates when h = 1 is obvious

(cid:19)

(cid:18) ˜p2

1
2

H[˜p, q; c t] ≈ h

+

˜p2
2
2

+

1
h

+

e
p3 c

Φ.

The corresponding ﬁelds are given by Maxwell equations

H[˜p, q; c t] =

B.

s-representation

C. R- and S-elements

5

For pure magnetic ﬁeld the Hamiltonian is very hard to
exploit since it has only a square root and so no terms to
split. Introducing an extended Hamiltonian with a new
ﬁctitious time parameter, τ , where the old independent
variable and old Hamiltonian with a negative sign will be
treated as an additional pair of canonically conjugated
coordinates, (−H, t), one have:

0 ≡ O[p1, p2, p3,−H; q1, q2, q3, t; τ ]

(cid:115)

(cid:18) p3 − e h A3

(cid:19)2 − H.

h

= c

m2c2 + p2

1 + p2

2 +

Integration of additional equations of motion gives

H = inv

and

t = τ + C0,

where we can set a constant of integration C0 = 0.

If curvature is invariant of longitudinal coordinate the
longitudinal component of momentum conserved, as well
as in the case of electric ﬁeld, and we will use −p3 as
a new Hamiltonian, reducing number of degrees of free-
dom back up to three by using q3 as a new independent
variable:

= −h

−p3 ≡ K[p1, p2,−H; q1, q2, t; q3]

(cid:19)2 − m2c2 − p2

(cid:115)(cid:18)H
G2(t,−Π) = −t(cid:112)Π2c2 + (m c2)2

1 − p2

c

The use of generating function

2 − e h A3.

will allow to use the full kinetic momentum −Π of a par-
ticle instead of −H as one of canonical momentums:
2 − e h A3,
K[p1, p2,−Π; q1, q2, l; q3] = −h
where corresponding canonical coordinate is a particle’s
traversed path l = −∂ G2/∂Π = βc t.

Π2 − p2

1 − p2

(cid:113)

Since the Hamiltonian do not explicitly depends on l,
full momentum Π is conserved and we can exclude as-
sociated degree of freedom using the further renormal-
ization of the Hamiltonian K → K ≡ K/Π, which can
be achieved by re-normalizing transverse components of
canonical momentums p1,2 → ˜p1,2 = p1,2/Π:

− p3
Π

(cid:113)

≡ K[˜p1, ˜p2; q1, q2; q3]
1 − ˜p2
= −h

1 − ˜p2

2 − e
Π

h A3.

We will call this model Hamiltonian s-representation
since the longitudinal coordinate (sometimes referred
to the natural parameter along equilibrium orbit, s) is
used as a time-parameter. This representation is conve-
nient to use for the numerical integrator construction for
transverse magnetic ﬁelds. The paraxial approximation,
˜p1,2 (cid:28) 1, gives

(cid:19)

(cid:18) ˜p2

1
2

K[˜p, q; q3] ≈ h

+

˜p2
2
2

− h − e
Π

h A3.

So far we provided dynamical equations of motion
without specifying how to represent electromagnetic
ﬁelds. In next two subsections we will discuss the mul-
tipole ﬁeld expansion for two most important types of
elements: R-element for κ = 0 and S-element deﬁned for
κ = const = 1/R0.

R- stays for rectangular and this element is the one
whit (q1, q2, q3) simply being the right handed Cartesian
coordinate system which we will denote as (x, y, z). All
ﬁelds in such an element are invariant along z axis and
usually serves the function of regular quadrupoles, sex-
tupoles, octupoles or combined function correctors.
In
addition one can design pure R-dipoles, while combined
function bending magnets are exotic and very compli-
cated since equilibrium orbit will not anymore coincides
with axis of symmetry.

S-element is the element deﬁned whit natural sector
coordinate system. Deﬁning the set of normalized coor-
dinates (x = q1/R0, y = q2/R0, z = q3/R0), one can see
that it simply can be related to normalized right handed
cylindrical coordinates (ρ = 1 + x, y, θ = z/R0), see
FIG. 3, and thus all ﬁelds are invariant along azimuthal
coordinate θ. S-elements are suitable for the design of
combined function bending magnets, since in contrast to
R-elements, equilibrium orbit follows along θ.

FIG. 3.
Illustration of R- and S- elements. Elements are
shown in brown. Global curvilinear coordinates with associ-
ated grid lines are shown in black. Black dashed line repre-
sent an equilibrium orbit. An example of Frenet-Serret frame
attached to an equilibrium orbit drawn in blue colors. For
S-element, an additional right-handed normalized cylindrical
system is added and shown in cyan.

q2= yR0q1= xR0q3= zR0q2= yq1= xq3= zntbFrenet−SerretframeEquilibriumorbitcoordinatesGlobalCylindricalcoordinatesR  ,0ρ = 1,x = 0θ =zybtρ = 1 +xnS−elementR−elementTABLE II. Harmonic homogeneous polynomials in two variables.

6

n
0
1
2
3
4
5
6
7
8
9

An
1
x
x2 − y2
x3 − 3 x y2
x4 − 6 x2y2 + y4
x5 − 10 x3y2 + 5 x y4
x6 − 15 x4y2 + 15 x2y4 − y6
x7 − 21 x5y2 + 35 x3y4 − 7 x y6
x8 − 28 x6y2 + 70 x5y4 − 84 x3y6 + 9 x y8
x9 − 36 x7y2 + 126 x5y4 − 84 x3y6 + 9 x y8

D. Multipoles in Cartesian coordinates

In Cartesian coordinates Laplace equations for electro-
and magnetostatic ﬁelds are in the same form which sig-
niﬁcantly simplify the problem

Bn
0
y
2 x y
3 x2y − y3
4 x3y − 4 x y3
5 x4y − 10 x2y3 + y5
6 x5y − 20 x3y3 + 6 x y5
7 x6y − 35 x4y3 + 21 x2y5 − y7
8 x7y − 56 x5y3 + 56 x3y5 − 8 x y7
9 x8y − 84 x6y3 + 126 x4y5 − 36 x2y7 + y9

The second equation deﬁnes complex function of ﬁeld
components such that
Fx = −(cid:61) F (Z)

and Fy = −(cid:60) F (Z),

which all together are equivalent to F = −∇Φ = ∇ × A.
The complex function F (Z) is the holomorphic function
again and Cauchy-Riemann equation gives

ˆez = 0.

∂ F
∂Z = 0,

one can write

=

∂ Ω
∂Z = 0,
∂Z = F (Z),
∂ Ω

where ﬁrst equation is the Cauchy-Riemann condition for
Ω which guarantees that this ﬁeld can be implemented
via either magnetic or electric potentials:

Fx = − ∂ Φ
∂x
Fy = − ∂ Φ
∂y

=

∂ Az
∂y
= − ∂ Az
∂x

,

.

Explicit expressions up to 10-th order are in Table II.
These functions satisfy the Laplace equation (cid:52)⊥ = 0 and
related to each other through Cauchy-Riemann equation
as

∂ An
∂x

∂ Bn
∂y

=

and

∂ An
∂y

= − ∂ Bn

.

∂x

In addition one can introduce “ladder-like” lowering dif-
ferential operators as
n {A,B}n−1 =

{B,A}n .

{A,B}n = ± ∂
∂y

∂
∂x

(cid:52)⊥Φ =

(cid:67)⊥A =

∂2Φ
∂x2 +

(cid:18) ∂2Az

∂x2 +

(cid:19)

∂2Φ
∂y2 = 0,
∂2Az
∂y2

Introduction of complex variables allows a very compact
description of a problem with uniﬁed description of elec-
tric and magnetic ﬁelds. Suppose we have a holomorphic
function of complex variable Z = x + i y which we will
call complex scalar potential which real part is deﬁned to
be a longitudinal component of a vector potential and
imaginary part is the electric scalar potential

Ω(Z) = Az(x, y) + i Φ(x, y).

Since real or imaginary part of any holomorphic function
are harmonic functions, Az and Φ automatically satisﬁes
the Laplace equation. Indeed, suppose we have a vector
ﬁeld F = (Fx, Fy). Introducing the Wirtinger derivatives

(cid:18) ∂

(cid:19)

(cid:18) ∂

(cid:19)

∂
∂Z =

1
2

− i

∂
∂y

∂x

and

∂
∂Z =

1
2

+ i

∂
∂y

∂x

that asserts that ﬁeld F is irrotational and divergence free
which is equivalent to time-independent free of electric
charge and current densities Maxwell’s equations

∇ · F = 0

and ∇ × F = 0.

For accelerator physics purposes the expansion of ﬁelds
usually represented in terms of homogeneous harmonic
polynomials of two variables, which are deﬁned through
the complex power function

An(x, y) = (cid:60)Z n =

[(x + i y)n + (x − i y)n]

=

n
k
Bn(x, y) = (cid:61)Z n =

k=0

(cid:33)

(cid:33)

(cid:32)

(cid:32)

n(cid:88)

n(cid:88)

k=0

n
k

1
2
xn−kyk cos

1
2 i
xn−kyk sin

k π
2

,

k π
2

.

[(x + i y)n − (x − i y)n]

7

FIG. 4. Normal and skew 2n-pole magnets in Cartesian coordinates. Each ﬁgure shows magnetic (electric) ﬁeld streamlines
and poles’ shape in transverse cross section. North (positive electrostatic potential) and south (negative electrostatic potential)
poles are shown in red and blue and are given by (B,A)n = ∓Rn

p respectively, where Rp is the distance to the pole’s tip.

Thus one can deﬁne two independent of each other sets
of solutions, normal (sometimes called upright or straight)
and skew pure multipoles, which we will denote with over-
line (. . .) and underline (. . .) respectively. The complex
scalar potentials of pure multipoles are:

(n)

Ω

= − C n

Z n
n!

and

Ω(n) = −i C n

Z n
n!

where C n and C n are coeﬃcients determining the
strength of magnets. Corresponding vector ﬁelds are de-
ﬁned to have an odd and even midplane symmetries

(n)

F
F (n)

(n)
y (x, y) = F
x (x, y) = F (n)

y (x,−y)
x (x,−y)

and

and

F
F (n)

(n)
x (x, 0) = 0,
y (x, 0) = 0.

Therefore, if one provided with experimental data of
the power series expansions of the ﬁelds in a horizontal
or vertical planes

Fx|x=0 = Fx|eq +

Fy|x=0 = Fy|eq +

Fx|y=0 = Fx|eq +

Fy|y=0 = Fy|eq +

y
1!

y
1!

x
1!

x
1!

∂ Fx
∂y

∂ Fy
∂y

∂ Fx
∂x

∂ Fy
∂x

+

+

+

+

y2
2!
y2
2!
x2
2!
x2
2!

∂2 Fx
∂y2
∂2 Fy
∂y2
∂2 Fx
∂x2
∂2 Fy
∂x2

(cid:12)(cid:12)(cid:12)(cid:12)eq
(cid:12)(cid:12)(cid:12)(cid:12)eq
(cid:12)(cid:12)(cid:12)(cid:12)eq
(cid:12)(cid:12)(cid:12)(cid:12)eq

(cid:12)(cid:12)(cid:12)(cid:12)eq
(cid:12)(cid:12)(cid:12)(cid:12)eq
(cid:12)(cid:12)(cid:12)(cid:12)eq
(cid:12)(cid:12)(cid:12)(cid:12)eq

+ . . . ,

+ . . . ,

+ . . . ,

+ . . . ,

Formulas for potentials and ﬁelds are listed below in Ta-
ble III and exact expressions are provided in Appendix A.
Figure 4 shows the cross section of idealized multipole
magnet’s poles and corresponding ﬁelds.

the ﬁeld derivatives on equilibrium orbit can be related
to strength coeﬃcients, see Table IV, which allows to
expand a general R-element in terms of pure multipoles.

TABLE III. Formulas for the scalar potential, longitudinal
component of the vector potential and ﬁeld components for
pure normal and skew 2n-poles in Cartesian coordinates.

TABLE IV. Relationship between coeﬃcients determining
the strength of pure R-multipoles and power series expansion
of ﬁeld in horizontal and vertical planes on equilibrium orbit.

Normal

Φ

(n)

= −C n
z = −C n
A

(n)

F

(n)
x = C n

F

(n)
y = C n

Bn
n!
An
n!
Bn−1
(n − 1)!
An−1
(n − 1)!

Skew
Φ(n) = −C n
A(n)

z = C n

F (n)
x = C n
y = −C n
F (n)

An
n!
Bn
n!
An−1
(n − 1)!
Bn−1
(n − 1)!

n
1

2

3

4

5

x = 0

y = 0

C n
Fx

−∂y Fy
−∂2
y Fx
∂3
y Fy
∂4
y Fx

C n
Fy

∂x Fy
∂2
x Fy
∂3
x Fy
∂4
x Fy

C n
Fx

∂x Fx
∂2
x Fx
∂3
x Fx
∂4
x Fx

C n
Fy

y Fy

∂y Fx
−∂2
−∂3
∂4
y Fy

y Fx

E. Multipoles in cylindrical coordinates

In the normalized right-handed cylindrical coordinate

system the Laplace equations are

(cid:52)(cid:121)Φ = (cid:52)⊥Φ +

+

∂ Φ
1
∂ρ
ρ
∂2Φ
1
∂ Φ
∂ρ2 +
∂ρ
ρ
(cid:52)(cid:121)Aθ − Aθ
ρ2
∂ Aθ
∂ρ

(cid:18)
(cid:18) ∂2Aθ

∂ρ2 +

(cid:19)

1
ρ

=

(cid:67)(cid:121)A =

=

∂2Φ
∂y2 = 0,

(cid:19)

ˆeθ

+

∂2Aθ
∂y2 − Aθ

ρ2

ˆeθ = 0.

Compared to the case with Cartesian coordinates these
equations look quite diﬀerent from each other. In order
to retain the symmetry one can note that

(cid:21)

∂
∂ρ

+

∂2
∂y2

(ρ Aθ) .

((cid:67)(cid:121)A)θ =

1
ρ

Thus looking for the solution in a form similar to har-
monic homogeneous polynomials

Φ = − n(cid:88)
Aθ = − n(cid:88)

k=0

k=0

Fn−k(ρ)
(n − k)!
Gn−k(ρ)
(n − k)!

1
ρ

yk
k!

C n sin

C n cos

k π
2

k π
2

+ C n cos

− C n sin

k π
2

k π
2

(cid:19)
(cid:19)

,

,

ρ

(cid:20) ∂2
∂ρ2 − 1
(cid:18)
(cid:18)

yk
k!

where Fn(ρ) and Gn(ρ) are the functions to be deter-
mined, one can ﬁnd two recurrence equations

∂2Fn(ρ)

1
ρ

∂ρ2 +
∂2Gn(ρ)
∂ρ2 − 1

ρ

∂ Fn(ρ)

∂ρ

∂ Gn(ρ)

∂ρ

= n (n − 1)Fn−2(ρ),

= n (n − 1)Gn−2(ρ).

They relate Fn and Gn to each other through
1
1
n
ρ

Fn−1 =

∂ Fn
∂ρ

Gn−1 =

and

1
n

ρ

∂ Gn
∂ρ

.

and allows to construct lowering operators

Fn =

Gn =

1

(n + 1)(n + 2)

1

(n + 1)(n + 2)

Fn = n (n − 1)
Gn = n (n − 1)

(cid:20) 1
(cid:20)

ρ

ρ

∂
∂ρ
∂
∂ρ

(cid:90) ρ
(cid:90) ρ

1

(cid:90) ρ
(cid:90) ρ

1

1
ρ

ρ

1

1

(cid:19)(cid:21)
(cid:19)(cid:21)

(cid:18)
(cid:18) 1

ρ

ρ

∂
∂ρ
∂
∂ρ

Fn+2,

Gn+2,

ρFn−2 d ρ d ρ,
Gn−2 d ρ d ρ,

1
ρ

and thus deﬁnes raising operators

where limits of integration are taking care of two con-
stants of integration. These operators can be used to re-
cursively calculate all members of F− and G−functions;

8

an additional constraint to terminate recurrences deﬁnes
lowest orders n = 0, 1 as

F0 = 1, F1 = ln ρ, G0 = 1, G 1 = (ρ2 − 1)/2.

First ten members of Fn and Gn are listed in Ta-
bles VI, VII and are shown in FIG. 5; in Appendix B
one can ﬁnd Taylor series of these functions at ρ = 1.
The diﬀerence relation for Fn including ﬁrst members
have been found by E.M. McMillan and I would like to
acknowledge his result by given them a name of McMil-
lan radial harmonics. In addition to his results, adjoint
McMillan radial harmonics, Gn, are introduced in order
to provide the symmetry in description between electric
and magnetic ﬁelds.

Finally, in order to deﬁne the set of functions for pure
S-multipoles (Table V) we will deﬁne sector harmonics:

Fn−k(ρ) yk cos

(cid:32)
(cid:32)
(cid:32)
(cid:32)

n
k

n
k

n
k

n
k

k=0

n(cid:88)
n(cid:88)
n(cid:88)
n(cid:88)

k=0

k=0

k=0

(cid:33)
(cid:33) Gn−k(ρ)
(cid:33)
(cid:33) Gn−k(ρ)

ρ

ρ

k π
2

,

k π
2

,

k π
2

,

k π
2

.

yk cos

yk sin

Fn−k(ρ) yk sin

A(e)
n (ρ, y) =

A(m)
n (ρ, y) =

B(e)
n (ρ, y) =

B(m)
n (ρ, y) =

obeying diﬀerential relations

n{A,B}(e )

n−1 = ± ∂ {B,A}(e)

n

n{A,B}(m)

n−1 = ± 1
Aρ

∂

(cid:17)

(cid:16)
(cid:17)

∂

(cid:16)

=

1
∂y
ρ
Aρ{B,A}(m)

n

∂y

ρ{A,B}(m)

n

∂ρ
∂ {A,B}(e)

n

∂ρ

,

.

=

Figure 6 shows the cross section of idealized multipole
magnet’s poles and corresponding ﬁelds. First six mem-
bers of spherical harmonics are listed in Table VIII and
exact expressions for potentials and ﬁelds in Appendix A.

TABLE V. Formulas for the scalar potential, azimuthal com-
ponent of the vector potential and ﬁeld components for “pure
normal and skew 2n-poles in cylindrical coordinates.

Normal

Φ

(n)

= −C n
θ = −C n
A

(n)

F

(n)
ρ = C n

F

(n)
y = C n

B(e)
n
n!
A(m)
n
n!
B(m)
n−1
(n − 1)!
A(e)
n−1
(n − 1)!

Skew

Φ(n) = −C n

A(n)

θ = C n

F (n)

ρ = C n
y = −C n
F (n)

A(e)
n
n!
B(m)
n
n!
A(m)
n−1
(n − 1)!
B(e)
n−1
(n − 1)!

TABLE VI. First ten members of F−functions.

9

Fn(ρ)

1

ln ρ

(ρ2 − 1) − ln ρ

−(ρ2 − 1) + (ρ2 + 1) ln ρ

(cid:21)
(cid:18)

(cid:19)

(cid:21)

(ρ4 − 1) +

4

1
2

1
2

1
4

1
2

ln ρ

ln ρ

ρ2 +

ρ4 + ρ2 +

(ρ2 − 1) −

(cid:0)ρ4 − 1(cid:1) +
(cid:0)ρ6 − 1(cid:1) +
(cid:0)ρ6 − 1(cid:1) − 1
(cid:0)ρ8 − 1(cid:1) +
(cid:0)ρ8 − 1(cid:1) − 5

(cid:18) 1
(cid:0)ρ4 − 1(cid:1) − 1
ρ2(cid:0)ρ2 − 1(cid:1) +
(cid:0)ρ6 − 1(cid:1) +
ρ2(cid:0)ρ4 − 1(cid:1) +

(cid:19)
(cid:21)
(cid:19)
(cid:18) 1
(cid:0)ρ2 − 1(cid:1) −
(cid:0)ρ6 + 1(cid:1) + ρ2(cid:0)ρ2 + 1(cid:1)(cid:27)
(cid:26) 1
(cid:18) 1
(cid:0)ρ4 − 1(cid:1) − 2
(cid:0)ρ2 − 1(cid:1) −
(cid:19)(cid:18) 1
(cid:18) ρ2
(cid:26) 1

ρ4 + ρ2 +

+ ρ2

+ 1

4
9

1
6

3
8

2

4

2

3

9

3

6

16

2

8

96
− 25
192

36
− 11
54

(cid:21)

(cid:21)

ln ρ

ln ρ

3
2

7
4

(cid:21)

ln ρ

(cid:19)
(cid:21)

1
12

ln ρ

(cid:19)(cid:27)

ρ6 +

ρ4 + ρ2 +

ρ4 +

ρ2 + 1

TABLE VII. First ten members of G−functions.

n

0

1

2

3

4

5

6

7

8

9

n

0

1

2

3

4

5

6

7

8

9

1
2
3
2

3

8
− 3
8

(cid:20)
(cid:20) 1
(cid:20)
(cid:20) 1
(cid:20)
(cid:20) 1
(cid:20)

15
2

45
4

315
16

105

4

315

8

Gn(ρ)

1

1
2

1

3
2

3

4
− 5
8

(cid:20)
(cid:20) 1
(cid:20)
(cid:20) 1
(cid:20)
(cid:20) 1
(cid:20)
(cid:20) 1

12
− 5
9

15
4

45
8

105
16

35
4

315
32

(cid:21)

(ρ2 − 1)

(ρ2 − 1) + ρ2 ln ρ

− 1
2
(ρ4 − 1) − ρ2 ln ρ

(cid:21)

2

3
4

1
2

(ρ4 − 1) +

+ 1

ln ρ

(cid:19)

(cid:18) ρ2

(ρ2 − 1) + ρ2

(cid:21)
(cid:21)
(cid:0)ρ6 − 1(cid:1) +
ρ2(cid:0)ρ2 − 1(cid:1) − ρ2(cid:0)ρ2 + 1(cid:1) ln ρ
(cid:18) 1
(cid:0)ρ6 − 1(cid:1) − 1
(cid:0)ρ4 − 1(cid:1) +(cid:0)ρ2 − 1(cid:1) + ρ2
(cid:0)ρ8 − 1(cid:1) +
ρ2(cid:0)ρ4 − 1(cid:1) −(cid:0)ρ6 + 3 ρ4 + ρ2(cid:1) ln ρ
(cid:0)ρ4 − 1(cid:1) +
(cid:0)ρ8 − 1(cid:1) − 2(cid:0)ρ6 − 1(cid:1) +
(cid:0)ρ10 − 1(cid:1) +
ρ4(cid:0)ρ2 − 1(cid:1) −(cid:0)ρ8 + 6 ρ6 + 6 ρ4 + ρ2(cid:1) ln ρ
ρ2(cid:0)ρ6 − 1(cid:1) +

(cid:0)ρ2 − 1(cid:1) + ρ2

ρ4 + 2 ρ2 + 1

ρ6 + 3 ρ4 +

(cid:18) 1

(cid:19)

(cid:21)

(cid:21)

ln ρ

4
3

7
6

9
8

4

2

3

35
24

5
2

24
− 47
96

40

(cid:19)

(cid:21)

ln ρ

ρ2 + 1

9
2

(cid:21)

10

FIG. 5. First ﬁve even (top row) and odd (bottom row) members of regular polynomials Pn = ρn, Fn(ρ),
functions from the left to the right respectively.

Gn(ρ)

ρ

and Gn(ρ)

FIG. 6. Normal and skew 2n-pole magnets in cylindrical coordinates. Each ﬁgure shows magnetic (electric) ﬁeld streamlines
and poles’ shape in transverse cross section. North (positive electrostatic potential) and south (negative electrostatic potential)
n = ∓const respectively, const = 1 for this example.
poles are shown in red and blue and given by constant levels of (B,A)(e)
Bottom row shows 3D models of sector magnets with θ = 3π/2: skew S-dipole, normal S-dipole, skew S-quadrupole, normal
S-quadrupole and skew S-sextupole from the left to the right respectively. Equilibrium orbit is shown in green color

Pn(ρ)Fn(ρ)Gn(ρ)/ρGn(ρ)ρρρρρρρρ11−1−111111111−1−1−1−1−1−1−1−122222222222222111111n = 0,2,4,6,8n = 1,3,5,7,90000000011

(cid:27)

ρ2 ln ρ

TABLE VIII. Sector harmonics.

1

− ln ρ

(cid:18) ρ2 + 1

ln ρ

(cid:21)

− y2
2
ρ2 − 1
−3

(cid:21)
(cid:20) ρ2 − 1
(cid:20)
(cid:20) 3(ρ4 + 4 ρ2 − 5)
(cid:20)

9 (ρ4 − 1)

+ 3

2

8

−5

(cid:19)

(cid:21)

− y2

ln ρ

− 6

2
ρ2 − 1

2
ρ2 − 1

2

y2 + y4

y2

+ 5

(cid:21)

(cid:18) 1
(cid:18) 3(ρ4 + 4 ρ2 + 1)

+ ρ2 − 2 y2

− 3

2

(cid:19)

ln ρ

− 6

ρ2 + 1

2

y2 + y4

(cid:19)

ln ρ

8

(cid:27)

(cid:27)

+ ρ2 ln ρ

(cid:21)

ρ2 − 1

y2
2
ρ2 − 1

− 3
2

ρ2 ln ρ

(cid:21)

y2 + y4

3(2 + ρ2 − 4 y2)

ρ2 ln ρ

+ 6
ρ2 − 1

2

2
− 10

+
ρ2 − 1

2

y2 + 5

3(ρ2 + 1)

4

2

ρ2 − 1

2

y4

(cid:27)
− 15(1 + ρ2 − 4 y2)

(cid:21)

4

8

4

2

2

2

1

16

+ 5 × 6

(cid:21)

− y2
ρ2 − 1

(cid:26)
(cid:27)
(cid:26)(cid:20) ρ2 − 1
(cid:21)(cid:27)
(cid:26)(cid:20)
− ρ2 − 1
(cid:26)(cid:20) 3(ρ2 + 1)
(cid:26)(cid:20)
− 3
− 3(5 ρ4 − 4 ρ2 − 1)
(cid:26)(cid:20) 5(ρ4 + 10 ρ2 + 1)
(cid:26)
(cid:27)
(cid:26)
(cid:26)(cid:20)
(cid:26)(cid:20)
(cid:26)(cid:20)

−12
+ 4
3 (ρ4 + 4 ρ2 − 5)

2
ρ2 − 1

ρ2 − 1

− y2

(cid:27)

(cid:18)

2 ln ρ

(cid:21)

(cid:21)

1

8

3

2

3

5

8

(cid:21)(cid:27)

ρ2 − 1

2
ρ2 − 1

2

−3

2

1

(cid:26)
(cid:27)
(cid:26)(cid:20)
(cid:26)(cid:20)
(cid:26)(cid:20)
(cid:26)(cid:20)

4

(cid:21)

− y2
ρ2 − 1

1
ρ
1
ρ
1
ρ
1
ρ
1
ρ
1
ρ

0

y

y

y

y

y

0

y
ρ
y
ρ
y
ρ
y
ρ
y
ρ

(cid:27)

− 3 ln ρ

(cid:19)

ln ρ

(cid:27)
(cid:21)

y2 + y4

ρ2 + 1

− y2

2
ρ2 − 1
− 10

2

(cid:18) 3

2

− 5

(cid:19)

(cid:27)

ln ρ

+ 3 ρ2 − 2 y2

(cid:27)

(cid:21)

+ 3 ρ2 ln ρ

3(ρ2 + 1)

− 4
3(5 ρ4 − 4 ρ2 − 1)

4

2

−5

8

ρ2 − 1

2

y2
ρ2 − 1

+ 10

2

(cid:27)

(cid:18)

(cid:21)

− 6 ρ2 ln ρ

y2 + y4

+ 5

3 +

(cid:19)

(cid:27)

ρ2 ln ρ

ρ2 − 2 y2

3
2

A(e)

n

A(m)

n

B(e)

n

B(m)

n

n

0

1

2

3

4

5

0

1

2

3

4

5

0

1

2

3

4

5

0

1

2

3

4

5

F. Recurrence equations in sector coordinates

IV. SUMMARY

12

An alternative approach to ﬁnd expansions for poten-
tials is to use general power series ansatz. In Cartesian
coordinates the use of
Φ = −

∞(cid:88)

Vm,n

xm
m!

yn
n!

m,n≥0

gives the recurrence relation

Vm+2,n + Vm,n+2 = 0.

This equation immediately deﬁnes all coeﬃcients, and
up to a common factor, as easy to see, coincides with
harmonic homogeneous polynomials An and Bn.

In sector coordinates, the same substitution for Φ, and

∞(cid:88)

Aθ = −

1

Vm,n

xm
m!

yn
n!

m,n≥0

1 + x

substitution for longitudinal component of the vector po-
tential gives two new recurrences, respectively
Vm+2,n + Vm,n+2 = −(m ± 1) Vm+1.n − m Vm−1,n+2.
The detailed approach on how to treat these equations
can be found for example in [Wiedemann]. In order to
solve these recurrences, one can look for a solution where
each term can be expressed in a form
+ V (i+j−2)

+ V (i+j−3)

i,j + V (i+j−1)

Vi,j = V ∗

+ . . .

i,j

i,j

i,j

where starred variables are the “design” terms given by
pure multipole ﬁelds and thus satisfying
m,n+2 ≡ 0.

V ∗
m+2,n + V ∗

Other coeﬃcients V (k)
i,j are terms induced by lower k-th
order pure multipoles due to recurrence. Thus in order
to ﬁnd an expression for a particular 2n-pole we will start
the recurrence form the n-th order assuming that

Vn,0 = −Vn−2,2 = . . .

or Vn−1,1 = −Vn−3,3 = . . .

for normal and skew elements. Then we will start ex-
ploiting the recurrence where all terms in the form V (n)
i,j
for i + j > n are subject to be determined.

This approach has two major disadvantages. At ﬁrst,
in order to use the result on will have to truncate a re-
currence. As a result the potentials representing mag-
nets do not satisﬁes the Laplace equation anymore. This
is a strong assumption which violate the “physics” and
should be avoided. While potentials can be approximated
with any precision by keeping an appropriate number of
terms, there is another issue. At second, at each new
order when solving the recurrence one will ﬁnd that an
arbitrary constant αi ∈ (0; 1) should be introduced since
the system is undetermined. An additional assumption
(As, Φ) |x=0 ∝ yn allows to truncate or summate the se-
ries. The resulting solutions coincide with the one ob-
tained above.

The scalar and vector Laplace’s equations for static
transverse electromagnetic ﬁelds in curvilinear orthog-
onal coordinates with zero and constant curvature are
solved. In Cartesian coordinates these solutions are well
known harmonic homogeneous polynomials of two vari-
ables. The set of solutions in cylindrical coordinates
named sector harmonics, and should not be confused
with cylindrical harmonics where ρ-dependent term is
given by Bessel functions which occasionally are also
called cylindrical harmonics. In contrast, the radial part
is given by the set of introduced McMillan radial har-
monics, independently introduced by E.M. McMillan in
his “forgotten” article, and adjoint radial harmonics also
described in this work. The feature of sector harmonics
that when expanded around equilibrium orbit they re-
semble solution in Cartesian geometry. Compared to the
traditional approach, widely used in accelerator commu-
nity, of the use of recurrences based on general power
series ansatz, this set of functions has two major ad-
vantages.
It do not require any truncation and is ex-
actly satisfying Laplace equation, and, provides a well
deﬁned full basis of functions which can be related to
any ﬁeld by its expansion in radial or vertical planes, see
Table IX. Including the model Hamiltonians for t- and
s-representations, where no assumptions but the ﬁeld
symmetry has been used, one can construct numerical
scheme integrating equations of motion. Thus I would
like to suggest the set of sector harmonics as a new ba-
sis for description and design of any sector magnets with
translational symmetry along azimuthal coordinate.

ACKNOWLEDGMENTS

The author would like to thank Leo Michelotti,
Eric Stern and James F. Amundson for their dis-
cussions and valuable input. Alexey Burov for encour-
aging to ﬁnd full family of solutions. Valeri Lebedev
whose solution for electrostatic quadrupole led me to gen-
eralization, just as in the case with E. M. McMillan
and F. Krienen. And, of course, Sergei Nagaitsev
who brought back to life original unknown McMillan’s
article which helped me with symmetric description of
electromagnetic ﬁelds.

Appendix A: R- ans S- multipoles. Exact

expressions.

The scalar potentials, longitudinal component of vec-
tor potential, and ﬁeld components for pure R- and S-
multipoles up to ﬁfth order are listed in Table X–XI and
Tables XII–XIII respectively.

TABLE IX. Relationship between coeﬃcients determining the strength of “pure” normal and skew S-multipoles and power
series expansion of ﬁeld in radial and vertical planes on equilibrium orbit.

13

C n

C n

n
1

2

3

4

5

6

7

8

9

1

2

3

4

5

6

7

8

9

x = 0
Fy

∂y Fx
−∂2
−∂3

y Fy

y Fx

∂4
y Fy

∂5
y Fx
−∂6
−∂7

y Fy

y Fx

∂8
y Fy

Fx
−∂y Fy
−∂2
y Fx
∂3
y Fy
∂4
y Fx
−∂5
−∂6
∂7
y Fy
∂8
y Fx

y Fx

y Fy

y = 0
Fy

∂x Fy

∂2
x Fy + ∂x Fy

∂3
x Fy + ∂2

x Fy − ∂x Fy
x Fy − ∂2
x Fy − 3 ∂3
x Fy − 3 ∂4
x Fy − 6 ∂5
x Fy − 6 ∂6

∂4
x Fy + 2 ∂3

∂5
x Fy + 2 ∂4

∂6
x Fy + 3 ∂5

x Fy + 3 ∂6
∂7

∂8
x Fy + 4 ∂7

Fx

x Fy + ∂x Fy

x Fy + 3 ∂2

x Fy + 6 ∂3

x Fy + 12 ∂4

x Fy + 18 ∂5

x Fy − 3 ∂x Fy
x Fy − 9 ∂2
x Fy − 27 ∂3
x Fy − 51 ∂4

x Fy + 9 ∂x Fy

x Fy + 45 ∂2

x Fy + 126 ∂3

x Fy − 45 ∂x Fy
x Fy − 225 ∂2

x Fy + 225 ∂x Fy

∂x Fx + Fx
x Fx + ∂x Fx − Fx
∂2
∂3
x Fx + 2 ∂2
∂4
x Fx + 2 ∂3
∂5
x Fx + 3 ∂4
∂6
x Fx + 3 ∂5
∂7
x Fx + 4 ∂6
∂8
x Fx + 4 ∂7

x Fx − ∂x Fx + Fx
x Fx − 3 ∂2
x Fx − 3 ∂3
x Fx − 6 ∂4
x Fx − 6 ∂5
x Fx − 10 ∂6

x Fx + 3 ∂x Fx − 3 Fx
x Fx + 6 ∂2
x Fx + 12 ∂3
x Fx + 18 ∂4
x Fx + 30 ∂5

x Fx − 9 ∂x Fx + 9 Fx
x Fx − 27 ∂2
x Fx − 51 ∂3
x Fx − 105 ∂4

x Fx + 45 ∂x Fx − 45 Fx
x Fx + 126 ∂2

x Fx − 225 ∂x Fx + 225 Fx

x Fx + 330 ∂3

x Fx − 855 ∂2

x Fx + 1575 ∂x Fx − 1575 Fx

Appendix B: Taylor polynomials of Fn and Gn.
The ﬁrst ten terms of Maclaurin series of Fn(x), Gn(x)

Gn(x)
1 + x

and

are listed in Table XIV.

[1] K. L. Brown, Adv. Part. Phys. 1, 71 (1968).
[2] E. Forest, Beam dynamics, Vol. 8 (CRC Press, 1998).
[3] H. Wiedemann, Particle accelerator physics (Springer,

2015).

[4] E. M. McMillan, Nucl. Instrum. Meth. 127, 471 (1975).
[5] H. Yoshida, Phys. Lett. A150, 262 (1990).

TABLE X. Longitudinal component of the vector potential and scalar potential for pure normal and skew R-multipoles.

14

n

0

1

2

3

4

5

0

1

2

3

4

5

n

0

1

2

3

4

5

0

1

2

3

4

5

calibration

normal dipole

normal quadrupole

normal sextupole

normal octupole

normal decapole

calibration

skew dipole

skew quadrupole

skew sextupole

skew octupole

skew decapole

Az
− C 0
− 1
1!
− 1
2!
− 1
3!
− 1
4!
− 1
5!

(x) C 1
(x2 − y2) C 2
(x3 − 3 x y2) C 3
(x4 − 6 x2y2 + y4) C 4
(x5 − 10 x3y2 + 5 x y4) C 5

0

1
1!
1
2!
1
3!
1
4!
1
5!

(y) C 1

(2 x y) C 2
(3 x2y − y3) C 3
(4 x3y − 4 x y3) C 4
(5 x4y − 10 x2y3 + y5) C 5

Φ

0
− 1
1!
− 1
2!
− 1
3!
− 1
4!
− 1
5!

(y) C 1

(2 x y) C 2
(3 x2y − y3) C 3
(4 x3y − 4 x y3) C 4
(5 x4y − 10 x2y3 + y5) C 5

C 0
− 1
1!
− 1
2!
− 1
3!
− 1
4!
− 1
5!

(x) C 1
(x2 − y2) C 2
(x3 − 3 x y2) C 3
(x4 − 6 x2y2 + y4) C 4
(x5 − 10 x3y2 + 5 x y4) C 5

TABLE XI. Horizontal and vertical components of pure normal and skew R-multipole magnets’ ﬁeld.

calibration

normal dipole

normal quadrupole

normal sextupole

normal octupole

normal decapole

calibration

skew dipole

skew quadrupole

skew sextupole

skew octupole

skew decapole

Fx

—

0

1
1!
1
2!
1
3!
1
4!

(y) C 2

(2 x y) C 3
(3 x2y − y3) C 4
(4 x3y − 4 x y3) C 5

—

C 1

1
1!
1
2!
1
3!
1
4!

(x) C 2
(x2 − y2) C 3
(x3 − 3 x y2) C 4
(x4 − 6 x2y2 + y4) C 5

Fy

—

C 1

1
1!
1
2!
1
3!
1
4!

(x) C 2
(x2 − y2) C 3
(x3 − 3 x y2) C 4
(x4 − 6 x2y2 + y4) C 5

—

0
− 1
1!
− 1
2!
− 1
3!
− 1
4!

(y) C 2

(2 x y) C 3
(3 x2y − y3) C 4
(4 x3y − 4 x y3) C 5

TABLE XII. Azimuthal component of the vector potential and scalar potential for “pure” normal and skew S-multipoles.

15

+ ρ2 ln ρ

(cid:27)

(cid:21)

C 2
ρ2 − 1

y2
2
ρ2 − 1

(cid:27)

C 3

− 3
2

ρ2 ln ρ

(cid:21)

y2 + y4

3(2 + ρ2 − 4 y2)

ρ2 ln ρ

+ 6
ρ2 − 1

2

2
− 10

+
ρ2 − 1

2

y2 + 5

3(ρ2 + 1)

4

2

ρ2 − 1

2

y4

(cid:27)
− 15(1 + ρ2 − 4 y2)

C 4

(cid:21)

4

(cid:27)

C 5

ρ2 ln ρ

(n)
A
θ

(n)

Φ

A(n)
θ

Φ(n)

n

0

1

2

3

4

5

0

1

2

3

4

5

0

1

2

3

4

5

0

1

2

3

4

5

2

2

1

8

4

2

C 0

C 1

(cid:21)

− y2
ρ2 − 1

(cid:26)
(cid:27)
(cid:26)(cid:20) ρ2 − 1
(cid:21)(cid:27)
(cid:26)(cid:20)
− ρ2 − 1
(cid:26)(cid:20) 3(ρ2 + 1)
(cid:26)(cid:20)
− 3
− 3(5 ρ4 − 4 ρ2 − 1)
(cid:26)(cid:20) 5(ρ4 + 10 ρ2 + 1)
(cid:26)
(cid:27)
(cid:26)
(cid:26)(cid:20)
(cid:26)(cid:20)
(cid:26)(cid:20)

−12
+ 4
3 (ρ4 + 4 ρ2 − 5)

C 2
ρ2 − 1

2
ρ2 − 1

− y2

(cid:27)

(cid:18)

2 ln ρ

(cid:21)

(cid:21)

C 1

8

3

2

3

1

5

8

− 1
0!
− 1
1!
− 1
2!
− 1
3!
− 1
4!
− 1
5!

0

− 1
1!
− 1
2!
− 1
3!
− 1
4!
− 1
5!

1
ρ
1
ρ
1
ρ
1
ρ
1
ρ
1
ρ

y

y

y

y

y

(cid:27)

C 3

− 3 ln ρ

(cid:19)

ln ρ

(cid:27)
(cid:21)

y2 + y4

ρ2 + 1

− y2

2
ρ2 − 1
− 10

2

C 4

− 5

(cid:18) 3

2

(cid:19)

(cid:27)

ln ρ

C 5

+ 3 ρ2 − 2 y2

1

2

4

2

4

−3

−5

3(ρ2 + 1)

(cid:21)(cid:27)

2
ρ2 − 1

y
ρ
y
ρ
y
ρ
y
ρ
y
ρ

C 1
ρ2 − 1

(cid:26)
(cid:27)
(cid:26)(cid:20)
(cid:26)(cid:20)
(cid:26)(cid:20)
(cid:26)(cid:20)
(cid:27)
(cid:26)
(cid:27)
(cid:26)
(cid:26)(cid:20) ρ2 − 1
(cid:21)
(cid:26)(cid:20)
(cid:26)(cid:20) 3(ρ4 + 4 ρ2 − 5)
(cid:26)(cid:20)

− y2
2
ρ2 − 1
−3

9 (ρ4 − 1)

(cid:21)

C 1

C 0

ln ρ

+ 3

8

2

1

8

−5

16

0

1
1!
1
2!
1
3!
1
4!
1
5!

− 1
0!
− 1
1!
− 1
2!
− 1
3!
− 1
4!
− 1
5!

(cid:27)

(cid:21)

C 2
− y2
ρ2 − 1

+ 3 ρ2 ln ρ

C 3

(cid:21)

ρ2 − 1

2

y2
ρ2 − 1

+ 10

− 4
3(5 ρ4 − 4 ρ2 − 1)

2

2

(cid:19)

(cid:21)

(cid:27)
(cid:18) ρ2 + 1

C 2

− ln ρ

− y2

ln ρ

− 6

+ 5 × 6

2
ρ2 − 1

2
ρ2 − 1

2

y2 + y4

y2

+ 5

(cid:27)

C 4

(cid:18)

(cid:21)

− 6 ρ2 ln ρ

y2 + y4

+ 5

3 +

(cid:19)

(cid:27)

C 5

ρ2 ln ρ

ρ2 − 2 y2

3
2

(cid:27)
(cid:18) 1
(cid:21)
(cid:18) 3(ρ4 + 4 ρ2 + 1)

C 3
− 3

+ ρ2 − 2 y2

2

(cid:19)

(cid:27)

ln ρ

C 4

− 6

ρ2 + 1

2

y2 + y4

8

(cid:19)

(cid:27)

ln ρ

C 5

TABLE XIII. Radial and vertical components of “pure” normal and skew S-multipoles’ ﬁeld.

16

F

(n)
ρ

F

(n)
y

F (n)

ρ

F (n)

y

n

0

1

2

3

4

5

0

1

2

3

4

5

0

1

2

3

4

5

0

1

2

3

4

5

calibration

normal dipole

normal quadrupole

normal sextupole

normal octupole

normal decapole

calibration

normal dipole

normal quadrupole

normal sextupole

normal octupole

normal decapole

calibration

skew dipole

skew quadrupole

skew sextupole

skew octupole

skew decapole

calibration

skew dipole

skew quadrupole

skew sextupole

skew octupole

skew decapole

—

0

− 1
1!
− 1
2!
− 1
3!
− 1
4!

y
ρ
y
ρ
y
ρ
y
ρ

1

(cid:26)
(cid:27)
(cid:26)(cid:20)
(cid:26)(cid:20)
(cid:26)(cid:20)

2

4

(cid:21)(cid:27)

C 2
ρ2 − 1

2
ρ2 − 1

2

−3

3(ρ2 + 1)

C 3

(cid:21)

− y2
ρ2 − 1

4

2

(cid:27)

+ 3 ρ2 ln ρ

C 4

− 4

ρ2 − 1

2

y2

(cid:21)

(cid:27)

C 5

− 6 ρ2 ln ρ

(cid:27)
(cid:18) ρ2 + 1

C 3

2

ln ρ

C 2

+ 3

1

C 1

(cid:21)

− ln ρ

− y2
2
ρ2 − 1
−3

(cid:27)
(cid:26)
(cid:26)
(cid:27)
(cid:26)(cid:20) ρ2 − 1
(cid:21)
(cid:26)(cid:20)
(cid:26)(cid:20) 3(ρ4 + 4 ρ2 − 5)
(cid:27)
(cid:26)
(cid:26)(cid:20) ρ2 − 1
(cid:21)(cid:27)
(cid:26)(cid:20)
− ρ2 − 1
(cid:26)(cid:20) 3(ρ2 + 1)
(cid:26)(cid:20)
− 3
− 3(5 ρ4 − 4 ρ2 − 1)

C 2
− y2
ρ2 − 1

− 6

(cid:21)

C 1

2

2

4

2

1

8

1
ρ
1
ρ
1
ρ
1
ρ
1
ρ

8

+ ρ2 ln ρ

—

1
0!
1
1!
1
2!
1
3!
1
4!

—

1
0!
1
1!
1
2!
1
3!
1
4!

—

(cid:27)

C 3

(cid:21)

(cid:19)

(cid:27)
(cid:21)

− y2

ln ρ

C 4

y2 + y4

− 3

2
ρ2 − 1

2

(cid:19)

(cid:27)

ln ρ

C 5

+ ρ2 − 2 y2

(cid:18) 1

2

(cid:27)

C 4

ρ2 − 1

y2
2
ρ2 − 1

2

+ 6

− 3
2

ρ2 ln ρ

(cid:21)

y2 + y4

3(2 + ρ2 − 4 y2)

2

+

ρ2 ln ρ

(cid:27)

C 5

C 2

(cid:27)

1

(cid:26)
(cid:27)
(cid:26)
(cid:26)(cid:20)
(cid:26)(cid:20)

3

0

1
1!
1
2!
1
3!
1
4!

y

y

y

y

(cid:21)

(cid:21)

2 ln ρ

C 3
ρ2 − 1

2
ρ2 − 1

2

−12

− y2

− 3 ln ρ

(cid:18)

(cid:27)

C 4

+ 4

3

ρ2 + 1

2

− y2

(cid:19)

(cid:27)

ln ρ

C 5

TABLE XIV. Maclaurin series of Fn(x), Gn(x) and

1+x ; they are also Taylor polynomials of Fn(ρ), Gn(ρ) and
Gn(x)

Gn(ρ)

ρ

at ρ = 1.

17

n

0

1

2

3

4

5

6

7

8

9

n

0

1

2

3

4

5

6

7

8

9

n

0

1

2

3

4

5

6

7

8

9

T(Fn)

1

x − 1
2
x2 − 1
3
x3 − 1
2
x4 − 2
5
x5 − 1
2
x6 − 3
7
x7 − 1
2
x8 − 4
9
x9 − 1
2
T(Gn)

x2 +

1
3

x3 − 1
4
x4 − 1
5

x4 +

x5 +

1
5

x5 − 1
6
x6 − 1
7

1
6

x6 +

x7 +

1
7

x7 − 1
8
x8 − 1
9

1
8

x8 +

1
9

x9 − 1
10

x10 + O(x11)

x10 − 1
11

x11 + O(x12)

x3 +

x4 +

x5 +

x6 +

x7 +

x8 +

x9 +

1
4
7
20
3
10
5
14
9
28
13
36
1
3

x5 − 11
40
x6 − 17
70
x7 − 2
7
x8 − 11
42
x9 − 7
24
x10 − 3
11

x6 +

x7 +

x8 +

x9 +

x10 +

x11 +

8
35
23
112
27
112
25
112
131
528
185
792

x8 +

x9 +

x7 − 11
56
x8 − 5
28
x9 − 47
224

x10 − 241
1232
x11 − 689
3168
x12 − 353
1716

x9 +

1
10
x9 − 37
240
x10 − 47
330

29
168
19
120

x10 +

23
165

x11 − 7
55

x12 + O(x13)

x11 +

57
440

x12 − 17
143

x13 + O(x14)

x12 +

263
1716

x13 − 1129
8008

x14 + O(x15)

x10 +

689
3696

x11 +

x11 − 355
2112
x12 − 181
1144

123
704

x13 +

x12 +

x13 +

5339
27456
1267
6864

x13 − 9683
54912

x14 +

x14 − 3457
20592
x15 − 2
11

457
2288

x15 +

x16 +

x14 − 535
4004
x15 − 1367
9152
x16 − 855
5984

2319
16016
16
99
5647
36608
9461
56576

x15 + O(x16)

x16 + O(x17)

x17 + O(x18)

x17 − 192991
1244672

x18 + O(x19)

x10 +

4
11

x11 − 13
44

x12 +

289
1144

x13 − 509
2288

x14 +

1

x +

1
2

x2

x4 +

x5 +

x6 +

x7 +

x8 +

x9 +

x10 +

x2 +

x3 +

x4 +

x5 +

x6 +

x7 +

x8 +

x9 +

1
3
1
2
2
5
1
2
3
7
1
2
4
9
1
2

x3 − 1
12
x4 − 1
20
x5 − 1
10
x6 − 1
14
x7 − 3
28
x8 − 1
12
x9 − 1
9
x10 − 1
11

1
30
1
40
3
70
1
28
1
21
1
24
5
99

x5 − 1
60
x6 − 1
70
x7 − 13
560
x8 − 1
48
x9 − 3
112
x10 − 13
528
x11 − 23
792

x6 +

x7 +

x8 +

1

105

1

112
1
70
3

x8 +

x9 +

x10 +

x7 − 1
168
x8 − 1
168
x9 − 1
105
x10 − 17
1848

x11 +

x9 +

224
3

x10 +

x9 − 1
360
x10 − 1
330

1

252

1

240
31

x11 − 13
2640
x12 − 17
3432

4620
7

1056

x11 +

x12 +

x12 +

x13 +

x14 +

176
17

1056
97

5148

x11 − 173
14784
x12 − 103
1952
x13 − 271
20592
x14 − 29
2288

2288

41

x13 − 37
5824
x14 − 43
6864

271

32032
151

18304
199

x15 − 2425
329472
x16 − 4489
622336

20592
43

4576

x15 +

x11 +

1
22

x12 − 31
1144

x13 +

x10 +

x11 + O(x12)

x11 +

x12 + O(x13)

1

495
1

440

x12 +

8

2145

x13 + O(x14)

x13 +

61

16016

x14 + O(x15)

x14 +

x15 + O(x16)

x15 +

x16 + O(x17)

59

12012
179

36609

x16 +

x17 + O(x18)

x17 +

x18 + O(x19)

1009

175032
7079

1244672

T(Gn/ρ)
1 − x + x2 − x3 + x4 − x5 + x6 − x7 + x8 − x9 + O(x10)

x6 +

x5 − 1
2
x6 − 11
21
x7 − 45
112
x8 − 47
112
x9 − 241
672

8
15
23
56
243
560
125
336

x − 1
2
x2 − 2
3
x3 − 1
2
x4 − 3
5
x5 − 1
2
x6 − 4
7
x7 − 1
2
x8 − 5
9
x9 − 1
2

x2 +

1
2

x3 − 1
2

x4 +

1
2

x3 +

x4 +

x5 +

x6 +

x7 +

x8 +

x9 +

x5 +

x6 +

x7 +

x8 +

x9 +

x10 +

7
12
9
20
1
2
3
7
13
28
5
12
4
9

x4 − 11
20
x5 − 17
40
x6 − 16
35
x7 − 11
28
x8 − 5
12
x9 − 3
8
x10 − 13
33
x11 − 4
11

9
22

x11 +

x10 +

x12 +

x10 + O(x11)

1
2

x7 − 1
2
29
56

x7 +

x9 − 1
2
23
45

x9 +

x8 +

1
2
x8 − 37
72
x9 − 47
120

x10 − 28
55

x11 + O(x12)

x10 +

171
440

x11 − 17
44

x12 + O(x13)

x8 +

x9 +

x10 +

19
48
689
1680
123
352

263
660
773
2288

x12 +

x11 +

x10 − 71
176
x11 − 181
528
x12 − 9683
27456
x13 − 17285
54912

x13 +

x14 +

x14 − 32
99

x15 +

x13 + O(x14)

x14 + O(x15)

x12 − 1129
2860
x13 − 2675
8008
x14 − 1367
4004
x15 − 855
2816
x16 − 192991
622336

80
231
5647
18304

9461
29952

x15 + O(x16)

x16 + O(x17)

x17 + O(x18)

x15 − 1357
4576

x16 +

13851
47872

x17 − 353047
1244672

x18 + O(x19)

x11 +

x12 +

131
336
185
528
289
792

x10 − 689
1848
x11 − 353
1056
x12 − 3563
10296
x13 − 729
2288

35
104

x13 +

x14 +

5339
14784
8869
27456
2285
6864
175
572

