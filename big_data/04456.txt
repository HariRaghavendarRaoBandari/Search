6
1
0
2

 
r
a

M
 
4
1

 
 
]

.

A
N
h
t
a
m

[
 
 

1
v
6
5
4
4
0

.

3
0
6
1
:
v
i
X
r
a

Mathematical Modelling and Numerical Analysis
Mod´elisation Math´ematique et Analyse Num´erique

Will be set by the publisher

A POSTERIORI ERROR ESTIMATES FOR DISCONTINUOUS GALERKIN

METHODS USING NON-POLYNOMIAL BASIS FUNCTIONS.

PART II: EIGENVALUE PROBLEMS

Lin Lin 1 and Benjamin Stamm 2

Abstract. We present the ﬁrst systematic work for deriving a posteriori error estimates for
general non-polynomial basis functions in an interior penalty discontinuous Galerkin (DG)
formulation for solving eigenvalue problems associated with second order linear operators.
Eigenvalue problems of such types play important roles in scientiﬁc and engineering applica-
tions, particularly in theoretical chemistry, solid state physics and material science. Based on
the framework developed in [L. Lin, B. Stamm, http://dx.doi.org/10.1051/m2an/2015069] for
second order PDEs, we develop residual type upper and lower bound error estimates for mea-
suring the a posteriori error for eigenvalue problems. The main merit of our method is that
the method is parameter-free, in the sense that all but one solution-dependent constants ap-
pearing in the upper and lower bound estimates are explicitly computable by solving local and
independent eigenvalue problems, and the only non-computable constant can be reasonably
approximated by a computable one without aﬀecting the overall eﬀectiveness of the estimates
in practice. Compared to the PDE case, we ﬁnd that a posteriori error estimators for eigen-
value problems must neglect certain terms, which involves explicitly the exact eigenvalues or
eigenfunctions that are not accessible in numerical simulations. We deﬁne such terms care-
fully, and justify numerically that the neglected terms are indeed numerically high order terms
compared to the computable estimators. Numerical results for a variety of problems in 1D
and 2D demonstrate that both the upper bound and lower bound are eﬀective for measuring
the error of eigenvalues and eigenfunctions.

1991 Mathematics Subject Classiﬁcation. 65J10, 65N15, 65N30.

.

1. Introduction

Let Ω be a rectangular, bounded domain. We consider the following linear eigenvalue problem of

ﬁnding an eigenvalue λ and the corresponding eigenfunction u, with (cid:107)u(cid:107)Ω = 1, such that

− ∆u + V u = λu,

in Ω,

(1)

where V is a bounded, smooth potential. Such eigenvalue problem arises in many scientiﬁc and en-
gineering problems. One notable example is the Kohn-Sham density functional theory [27], which is
widely used in theoretical chemistry, solid state physics and material science. In order to solve Eq. (1)
in practice, it is desirable to reduce the number of degrees of freedom for discretizing Eq. (1) to have

Keywords and phrases: Discontinuous Galerkin method, a posteriori error estimation, non-polynomial basis functions,
eigenvalue problems

1 Department of Mathematics, University of California, Berkeley and Computational Research Division, Lawrence
Berkeley National Laboratory, Berkeley, CA 94720, USA. Email: linlin@math.berkeley.edu
2 Center for Computational Engineering, Mathematics Department, RWTH Aachen University, Schinkelstr. 2, 52062
Aachen, Germany and Computational Biomedicine, Institute for Advanced Simulation IAS-5 and Institute of Neuro-
science and Medicine INM-9, Forschungszentrum J¨ulich, Germany, Email: stamm@mathcces.rwth-aachen.de

c(cid:13) EDP Sciences, SMAI 1999

2

TITLE WILL BE SET BY THE PUBLISHER

a smaller algebraic problem to solve. While standard polynomial basis functions and piecewise poly-
nomial basis functions can approach a complete basis set and is versatile enough to represent almost
any function of interest, the resulting number of degrees of freedom is usually large even when high
order polynomials are used. Non-polynomial basis functions are therefore often employed to reduce the
number of degrees of freedom. Examples include the various non-polynomial basis sets used in quantum
chemistry such as the Gaussian basis set [14], atomic orbital basis set [24], adaptive local basis set [32],
planewave discretization [5]. Similar techniques also appear in other contexts, such as the planewave
basis set for solving the eigenvalue problems in photonic crystals [23], Helmholtz equations [19, 41], and
heterogeneous multiscale method (HMM) [11] and the multiscale ﬁnite element method [20] for solving
multiscale elliptic equations.

1.1. Previous work on a posteriori estimates

Concerning the Laplace eigenvalue problem (Eq. (1) with V = 0), there has been important progress
in particular in obtaining guaranteed lower bounds for the ﬁrst eigenvalue using polynomial-based
versions of the ﬁnite element method: Armentano and Dur´an [1], Hu et al. [21, 22], Carstensen and
Gedicke [8], and Yang et al. [44] achieve so via the lowest-order nonconforming ﬁnite element method.
Kuznetsov and Repin [30], and ˇSebestov´a and Vejchodsk´y [39] give numerical-method-independent
estimates based on ﬂux (functional) estimates, and Liu and Oishi [34] elaborate a priori approximation
estimates for lowest-order conforming ﬁnite elements. Canc`es et al. [7] present guaranteed bounds for
the eigenvalue error for the classical conforming ﬁnite element method. A posteriori estimates for the
polynomial hp-discontinuous Galerkin (DG) method are developed by Giani and Hall [15]. Earlier work
comprises Kato [25], Forsythe [12], Weinberger [43], Bazley and Fox [3], Fox and Rheinboldt [13], Moler
and Payne [36], Kuttler and Sigillito [28, 29], Still [40], Goerisch and He [16], and Plum [37].

The question of accuracy for both eigenvalues and eigenvectors has also been investigated previ-
ously. For conforming ﬁnite elements, relying on the a priori error estimates resumed in Babuˇska
and Osborn [2], Boﬃ [4] and references therein, a posteriori error estimates have been obtained by
Verf¨urth [42], Maday and Patera [35], Larson [31], Heuveline and Rannacher [18], Dur´an et al. [9],
Grubiˇsi´c and Ovall [17], Rannacher et al. [38], and Canc`es et al. [7].

For non-polynomial basis functions, the literature is much sparser. A posteriori estimates for
planewave discretization of non-linear Schr¨odinger eigenvalue problems are presented in Dusson and
Maday [10], and Canc`es et al. [6]. Kaye et al. [26] developed upper bound error estimates for solving
linear eigenvalue problems using non-polynomial basis functions in a DG framework, which generalizes
the work of Giani et al. [15] for polynomial basis functions.

1.2. Contribution

We present a systematic way of deriving residual-based a posteriori error estimates for the discontin-
uous Galerkin (DG) discretization of problem (1) using non-polynomial basis functions. More precisely,
we derive computable upper and lower bounds for both the error of eigenvalues and eigenvectors, up
to some terms that are asymptotically of higher order. This extends the framework introduced in the
companion paper [33] on second order PDEs. The main diﬃculty can be reduced to the non-existence
of inverse estimates for arbitrary non-polynomial basis functions and the non-existence of an accurate
conforming subspace. In the present approach, all but one basis-dependent constant appearing in the
upper and lower bound estimates are explicitly computable by solving local eigenvalue problems. For
solutions with suﬃcient regularity (for instance u ∈ H 2(Ω)), the only non-computable constant can be
reasonably approximated by a computable one without aﬀecting the overall eﬀectiveness of the esti-
mates. While the requirement of H 2(Ω) regularity appears to be a formal drawback in the context of
a posteriori error estimates, the main goal of this work is to develop a posteriori error estimates for
general basis sets rather than for h-reﬁnement, and the diﬃculty of general basis sets holds even if the
solution has C∞(Ω) regularity. Therefore we think our method can have important practical values.

Our estimators for eigenfunctions are very similar to those for second order PDEs, and our estimators
for eigenvalues are derived from the eigenfunction estimators. By leveraging the same constant related
to the regularity of the eigenfunction u ∈ H 2(Ω), we arrive at simpler treatment for upper and lower
estimators for eigenvalues. Compared to the treatment in literature [15], our treatment does not involve
the usage of lifting operators. Compared to the PDE case, we ﬁnd that a posteriori error estimators

TITLE WILL BE SET BY THE PUBLISHER

3

for eigenvalue problems must neglect certain terms, which involve explicitly the exact eigenvalues and
eigenfunctions that are not accessible in numerical simulation. We deﬁne such terms carefully, and
justify numerically that the neglected terms are indeed high order terms compared to the computable
estimators. Our numerical results in 1D and 2D illustrate the eﬀectiveness of the estimators.

1.3. Outline

We introduce in Section 2 preliminary results that are needed to introduce the discontinuous Galerkin
discretization of the eigenvalue problem (1) and the following a posteriori analysis that are both pre-
sented in Section 3. Section 4 is devoted to numerical tests, followed by the conclusion in Section
5.

2.1. Mesh, broken spaces, jump and average operators

2. Preliminary results

Let Ω = (0, 1)d, d = 1, 2, 3 and let K be a regular partition of Ω into elements κ ∈ K. That is, we
assume that the interior of κ ∩ κ(cid:48), for any κ, κ(cid:48) ∈ K, is either an element of K, a common face, edge,
vertex of the partition or the empty set. For simplicity, we identify the boundary of Ω in a periodical
manner. That means, that we also assume the partition to be regular across the boundary ∂Ω. We
remark that although the assumption of a rectangular domain with periodic boundary condition appears
to be restrictive, such setup already directly ﬁnds its application in important areas such as quantum
chemistry and materials science. However, the analysis below is not restricted to equations with periodic
boundary condition. Other boundary conditions, such as Dirichlet or Neumann boundary conditions
can be employed as well with minor modiﬁcation. Generalization to non-rectangular domain does not
introduce conceptual diﬃculties either, but may lead to changes in numerical schemes for estimating
relevant constants, if the tensorial structure of the grid points is not preserved.

Let N = (Nκ)κ∈K denote the vector of the local number of degrees of freedom Nκ on each element
κ∈K VN (κ) by any piecewise discontinuous approximation space on a partition K
of the domain Ω. It is important to highlight that little is assumed about the a priori information of
VN except that we assume that each VN (κ) contains constant functions and that VN (κ) ⊂ H 3
2 (κ), so
that the traces of ∇vN on the boundary ∂κ are well-deﬁned for all vN ∈ VN (κ), for all κ ∈ K.
We denote by H s(κ) the standard Sobolev space of L2(κ)-functions such that all partial derivatives
of order s ∈ N or less lie as well in L2(κ). By H s(K), we denote the set of piecewise H s-functions
deﬁned by

H s(K) =(cid:8)v ∈ L2(Ω)(cid:12)(cid:12) v|κ ∈ H s(κ),∀κ ∈ K(cid:9) ,

κ ∈ K. Let VN =(cid:76)

also referred to as the broken Sobolev space. We denote by H 1
on Ω. We further deﬁne the element-wise resp. face-wise scalar-products and norms as

#(Ω) the space of periodic H 1-functions

(cid:88)

κ∈K

(v, w)K =

(v, w)κ

and

(cid:107)v(cid:107)K = (v, v)

1

2K.

The L2-norm on κ and Ω are denoted by (cid:107)·(cid:107)κ and (cid:107)·(cid:107)Ω, respectively. The jump and average operators
on a face F = κ ∩ κ(cid:48) are deﬁned in a standard manner by

{{v}} = 1
{{∇v}} = 1

2 (v|κ + v|κ(cid:48)),
2 (∇v|κ + ∇v|κ(cid:48)),

and

and

[[v]] = v|κnκ + v|κ(cid:48)nκ(cid:48),
[[∇v]] = ∇v|κ · nκ + ∇v|κ(cid:48) · nκ(cid:48),

where nκ denotes the exterior unit normal of the element κ. Finally we recall the standard result of
piecewise integration by parts formula that will be employed several times in the upcoming analysis.
Lemma 2.1. Let v, w ∈ H 2(K). Then, there holds

(cid:88)

(cid:104)

κ∈K

(cid:105)

(cid:88)

(cid:104)

κ∈K

(∆v, w)κ + (∇v,∇w)κ

= 1
2

([[∇v]], w)∂κ + (∇v, [[w]])∂κ

.

(cid:105)

4

TITLE WILL BE SET BY THE PUBLISHER

2.2. Projections

For any element κ ∈ K, let us denote by Πκ

0 : L2(κ) → R the L2(κ)-projection onto constant functions

deﬁned by

that is explicitly given by Πκ

0 v = 1|κ|

(cid:82)

(Πκ

0 v, w)κ = (v, w)κ,
κ v dx. On H 1(κ) we deﬁne the following scalar product and norm

∀w ∈ R,

0 v, Πκ

0 w)κ + (∇v,∇w)κ,

(v, w)(cid:63),κ = (Πκ
(cid:107)v(cid:107)(cid:63),κ = (v, v)

1
2

(cid:63),κ,

for all v, w ∈ H 1(κ) and the corresponding projection Πκ

N : H 1(κ) → VN (κ) by

(Πκ

N v, wN )(cid:63),κ = (v, wN )(cid:63),κ

∀wN ∈ VN (κ).

Then, it is easy to see that this projection satisﬁes the following properties

or equivalently expressed as Πκ

N v) = 0. This implies that

(v − Πκ

N v, c)κ = 0,
0 (v − Πκ
N v),∇wN )κ = 0,

(∇(v − Πκ

(cid:107)∇(v − Πκ
(cid:107)v − Πκ

N v)(cid:107)κ ≤ (cid:107)∇v(cid:107)κ,
N v(cid:107)(cid:63),κ ≤ (cid:107)v(cid:107)(cid:63),κ,

∀c ∈ R,∀v ∈ H 1(κ),

∀wN ∈ VN (κ),∀v ∈ H 1(κ),
∀v ∈ H 1(κ),
∀v ∈ H 1(κ).

(2)

(3)

(4)

(5)

2.3. Local scaling constants

In this section, we recall some local constants that will be used in the upcoming a posteriori error
analysis and that were introduced in [33]. We start with recalling the local trace inverse inequality
constant dκ for each κ ∈ K deﬁned by

dκ ≡ sup

vN∈VN (κ)

(cid:107)∇vN·nκ(cid:107)∂κ

(cid:107)vN(cid:107)(cid:63),κ

> 0.

Further, we consider

aκ ≡ sup
v∈H 1(κ),
v⊥VN (κ)

(cid:107)v(cid:107)κ
(cid:107)v(cid:107)(cid:63),κ

and

bκ ≡ sup
v∈H 1(κ),
v⊥VN (κ)

(cid:107)v(cid:107)∂κ
(cid:107)v(cid:107)(cid:63),κ

,

where ⊥ is in the sense of the scalar product (·,·)(cid:63),κ deﬁned by (2).
Remark 2.2 (The computation of the constants aκ, bκ and dκ). More details on how these local
constants can be approximated by solving local eigenvalue problems is explained in detail in [33, Section
5]

3. Eigenvalue problem

We ﬁrst assume that the smallest eigenvalue λ ∈ R is non-degenerate. Consider the problem of ﬁnding
#(Ω)∩ H 2(K) with (cid:107)u(cid:107)Ω = 1 such

this smallest eigenvalue λ and the corresponding eigenfunction u ∈ H 1
that

− ∆u + V u = λu,

in Ω.

(6)

We assume that V is bounded and smooth. Observing that adding any constant to the potential results
in a modiﬁed eigenvalue which is shifted by the same value, we can assume that V is positive. The
choice of the constant only aﬀects the high order terms that is absent in the leading computable upper
and lower bound estimators.

TITLE WILL BE SET BY THE PUBLISHER

For some θ ∈ R and γ : Ω → R such that γ|κ = γκ ∈ R and using the bilinear form

(cid:104) − (∇w, [[v]])∂κ − θ([[w]],∇v)∂κ + γκ([[w]], [[v]])∂κ

a(w, v) =

(∇w,∇v)κ + (V w, v)κ

+ 1
2

(cid:105)

(cid:88)

κ∈K

(cid:88)

(cid:104)

κ∈K

5

(cid:105)

,

the approximated eigenvalue problem can be stated as: Find the smallest, non-degenerate eigenvalue
λN ∈ R and uN ∈ VN with (cid:107)uN(cid:107)Ω = 1 such that

a(uN , vN ) = λN (uN , vN )Ω,

∀vN ∈ VN .

(7)

In order to quantify the error, we introduce the broken energy norm

|||v|||2 =

κ + γκ

2 (cid:107)[[v]](cid:107)2

∂κ + (cid:107)V

1

2 v(cid:107)2

κ

,

∀v ∈ H 1(K).

(cid:105)

(cid:104)(cid:107)∇v(cid:107)2

(cid:88)

κ∈K

As usual, the penalty parameter γ needs to be chosen suﬃciently large to ensure coercivity of the
bilinear form, and the energy norm error for eigenfunctions is deﬁned to be |||u − uN|||.

Following the technique introduced in [33] we obtain the following result.

Lemma 3.1. If γκ ≥ 1

2 (1 + θ)2 (dκ)2, then the bilinear form is coercive on VN , i.e., there holds

1

2|||vN|||2 ≤ a(vN , vN ),

∀vN ∈ VN .

Proof. The proof is basically identical with the one presented in [33, Lemma 3.1]. The only slight
diﬀerence is that the broken energy norm as well as the bilinear form have now the positive contribution
(cid:107)V 1
(cid:3)

2 vN(cid:107)2
κ.

Remarkably, this lemma provides a computable and sharp value for each γκ such that the bilinear

form is coercive.

Remark 3.2. Note that even when the smallest eigenvalue λN is a non-degenerate eigenvalue, the
corresponding eigenfunction uN still has an arbitrary phase factor ±1. If such phase factors from u
and uN do not match, the error u− uN must be of order 1. Since u− uN never appears in the upper or
lower bound estimators, such phase factors will not aﬀect the computation of the estimators, and only
arise when comparing the estimators with the true error |||u− uN|||. In such case, the phase factor can be
eliminated by a “subspace alignment” procedure to be discussed in section 4. The same procedure can be
applied to align eigenfunctions when more eigenvalues and eigenfunctions are to be computed, even when
some of the eigenvalues are degenerate. Below we assume that u and uN are aligned eigenfunctions so
that the error |||u − uN||| converges to 0 as the basis function reﬁnes.

3.1. A posteriori estimates of eigenfunctions

We adapt here the residual type estimators obtained in [33] to the case of eigenvalue problems.

3.1.1. Error representation

Recall that we assumed that u ∈ H 2(κ), we introduce the constant du

κ(uN ) deﬁned by

du
κ(uN ) =

(cid:107)∇(u − uN )·nκ(cid:107)∂κ

(cid:107)∇(u − uN )(cid:107)κ

,

and deﬁne the constant cκ by

cκ = du

κ(uN ) + dκ|θ|.
κ ≡ du

Without slight abuse of notation we may use du
solution uN . We note that in practice, the constant du
Theoretically the value du
many cases du

κ(uN ), and neglect the dependence on the numerical
κ(uN ) can not be evaluated since u is unknown.
κ(uN ) can be large. However, our previous numerical studies indicate that in

κ(uN ) can be relatively well approximately by the computable constant dκ.

6

TITLE WILL BE SET BY THE PUBLISHER

We start with deﬁning the residual type quantities

where

ηR,κ ≡ aκ(cid:107)λN uN + ∆uN − V uN(cid:107)κ,
ηF,κ ≡ bκ

ηJ,κ ≡ (bκ(cid:98)γκ + cκ
2 (cid:107)[[∇uN ]](cid:107)∂κ,
(cid:98)γκ = max

x∈∂κ

2 )(cid:107)[[uN ]](cid:107)∂κ,

{{γ}}(x).

Introducing the normalized error function

ϕ =

u − uN
|||u − uN||| ,

and following the same strategy as in Section 3.2 of [33], we develop the following error representation
equation.

|||u − uN||| =

(λN uN + ∆uN − V uN , ϕ−ϕN )κ − 1

− ({{γ}}[[uN ]], (ϕ−ϕN )nκ)∂κ − 1

2 ([[∇uN ]], ϕ−ϕN )∂κ
(cid:105)
2 ([[uN ]],∇ϕ+θ∇ϕN )∂κ

(8)

+ hotub,

(cid:88)

(cid:104)

κ∈K

for any ϕN ∈ VN . In the following, we will use the particular choice ϕN = Πκ

N ϕ.

The high order term for the upper bound estimator, denoted by hotub, is deﬁned as

hotub := (λu − λN uN , ϕ)Ω.

(cid:18)(cid:107)u − uN(cid:107)Ω

(cid:19)2 |||u − uN|||.

Using the normalization condition for eigenfunctions (cid:107)u(cid:107)Ω = (cid:107)uN(cid:107)Ω = 1, the term hotub can be
simpliﬁed as

2

2

λ + λN

hotub = λ+λN

|||u − uN|||

(u − uN , ϕ)Ω =
(cid:107)u−uN(cid:107)Ω
Asymptotically as uN converges to u,
|||u−uN||| characterizes the ratio between the error measured in
L2 and H 1 norms, and converges to 0. Therefore hotub converges to 0 faster than the energy norm
|||u − uN|||, and is neglected in the practically computed upper bound estimator.
3.1.2. Upper bounds
#(Ω) ∩ H 2(K) be the solution of (6) and uN ∈ VN the DG-approximation
Theorem 3.3. Let u ∈ H 1
deﬁned by (7). Then, we have the following a posteriori upper bound for the approximation error in the
eigenfunction

(cid:32)(cid:88)

(cid:104)

κ∈K

(cid:105)2(cid:33) 1

2

|||u − uN||| ≤

ηR,κ + ηF,κ + ηJ,κ

+ hotub.

Proof. One can proceeding as in the proof of Theorem 3.3 in [33] based on the slightly modiﬁed error
representation formula (8).

(cid:3)

3.1.3. Lower bounds

We establish here lower bounds for the error in the eigenvector approximation following the strategy
established in Section 4.2 of [33]. We only explain the details when the technique diﬀers in the case of
eigenvalue approximations and summarize otherwise the results. Observe that

ηJ,κ =(cid:0)bκ(cid:98)γκ + cκ
(cid:16)

2

F,κ ≤ b2
η2

κ
2

(cid:1)(cid:107)[[uN ]](cid:107)∂κ ≤(cid:113) 2
(cid:17)2 (cid:88)

γκ

du
κ(cid:48)(uN )

max
κ(cid:48)∈ω(κ)

(cid:0)bκ(cid:98)γκ + cκ

2

(cid:1) |||u − uN|||κ,

(cid:107)∇(u − uN )(cid:107)2
κ(cid:48),

κ(cid:48)∈ω(κ)

and that

TITLE WILL BE SET BY THE PUBLISHER

7

where ω(κ) is the patch consisting of κ and its adjacent elements sharing one face.
Further, let gκ be a smooth non-negative bubble function with supx∈κ gκ(x) = 1 and local support,
i.e. supp(gκ) ⊂ κ, which in turn implies that gκ|∂κ = 0. Let us denote the residual by R = λN uN +
∆uN − V uN and deﬁne

(cid:107)R(cid:107)κ
(cid:107)g
κ R(cid:107)2
0 (κ) the local solution to Eq. (9)

σκ = aκ

1
2

κ

− ∆ϕκ = V gκR,

.

on κ,

Denote by ϕκ ∈ H 1

so that

ηR,κ = aκ(cid:107)R(cid:107)κ = σκ(cid:107)g

(cid:90)

(cid:104) − ∆(u − uN ) + V (u − uN ) + λN uN − λu
(cid:105)

1
2

gκ

κ = σκ

κ R(cid:107)2

(cid:90)
(cid:104)
(cid:104)∇(u − uN ) · ∇(gκ R) − ∇(u − uN ) · ∇ϕκ + gκ(λN uN − λu) R

∆(u − uN ) gκ R − ∆ϕκ(u − uN ) + gκ(λN uN − λu) R

(cid:105)

κ

κ

(cid:105)

= −σκ

(cid:90)

= σκ
≤ σκ(cid:107)∇(u − uN )(cid:107)κ(cid:107)∇(gκ R − ϕκ)(cid:107)κ + σκ

κ

(cid:90)

gκ(λN uN − λu) R,

(9)

R

and in consequence

κ

ηR,κ ≤ σκ(cid:107)∇(gκ R − ϕκ)(cid:107)κ|||u − uN|||κ + σκ(cid:107)λN uN − λu(cid:107)κ (cid:107)gκR(cid:107)κ.

We deﬁne

hotlb

κ = (cid:107)λN uN − λu(cid:107)κ

(cid:107)gκR(cid:107)κ

(cid:107)∇(gκ R − ϕκ)(cid:107)κ

.

Numerical results indicate that hotlb can be much smaller compared to the lower bound estimator as
the basis set reﬁnes. The results above indicate that
|||u − uN|||ω(κ) ≥ ηF,κ
cF,κ

|||u − uN|||κ ≥ ηJ,κ
cJ,κ

|||u − uN|||κ + hotlb

κ ≥ ηR,κ
cR,κ

(10)

and

,

.

where |ω(κ)| the cardinality of the set ω(κ), and

(cid:107)R(cid:107)κ(cid:107)∇(gκ R − ϕκ)(cid:107)κ

,

κ R(cid:107)2
du
κ(cid:48)(uN ),

κ

(cid:107)g1/2

(cid:113)|ω(κ)|
(cid:113) 2
(cid:0)bκ(cid:98)γκ + cκ

2 max
κ(cid:48)∈ω(κ)

γκ

2

(cid:1) .

cR,κ = aκ

cF,κ = bκ

cJ,κ =

We summarize the results in the following proposition.

Proposition 3.4 (Local lower bound). Let u ∈ H 1
the DG-approximation deﬁned by (7). Then, the quantity

#(Ω) ∩ H 2(K) be the solution of (6) and uN ∈ VN

is a local lower bound of the local error

Here

,

cR,κ

ξκ = max

(cid:26) ηR,κ
max(cid:8)|||u − uN|||κ + hotlb
(cid:88)

1

|||v|||2

ω(κ) =

|ω(κ)|

κ(cid:48)∈ω(κ)

(cid:27)

,

ηF,κ
cF,κ

,

ηJ,κ
cJ,κ

(cid:9) .

κ ,|||u − uN|||ω(κ)

(cid:107)∇v(cid:107)2

κ(cid:48) + γκ

2 (cid:107)[[v]](cid:107)2
∂κ,

8

TITLE WILL BE SET BY THE PUBLISHER

Remark 3.5. In practice, sometimes both ηF,κ and cF,κ can become very small. Since cF,κ is com-
puted inaccurately with iterative methods, the ratio ηF,κ
can become numerically unreliable. This can be
cF,κ
addressed by deﬁning

Since

ηR,κ + ηF,κ + ηJ,κ
cR,κ + cF,κ + cJ,κ

≤ max

,

ηF,κ
cF,κ

,

ηJ,κ
cJ,κ

ξκ =

ηR,κ + ηF,κ + ηJ,κ
cR,κ + cF,κ + cJ,κ

.

(cid:26) ηR,κ

cR,κ

(cid:27)

,

(11)

Eq. (11) is still a local lower error bound, but is more robust when cF,κ becomes small. Furthermore,
among the three terms ηR,κ
, one term (usually the residual or the jump term) is often in
cR,κ
practice larger than the rest of the two terms combined. In this case the use of (11) leads to little loss
of eﬃciency.

, ηJ,κ
cJ,κ

, ηF,κ
cF,κ

On a global level, the following result holds.

Proposition 3.6 (Global lower bound). Let u ∈ H 1
the DG-approximation deﬁned by (7). Then, there holds that

#(Ω) ∩ H 2(K) be the solution of (6) and uN ∈ VN
(cid:105)2

(cid:104)

(cid:80)

(cid:16)

κ∈K

ηR,κ + ηF,κ + ηJ,κ

3 maxκ∈K

c2
R,κ + b2

ω(κ)du

κ(uN )2 + c2

J,κ

ξ2 =

where

(cid:17) ≤ |||u − uN|||2 + (hotlb)2,
(cid:16) b2

(cid:17)(cid:12)(cid:12)(cid:12)F

,

κ

2 + b2
κ(cid:48)
2

{{b2

(cid:33) 1
κ}}|F = max
F∈∂κ

2

(hotlb

κ )2

.

Proof. Observe that as explained in Section 4.2 of [33]

b2
ω(κ) = max
F∈∂κ

hotlb =

η2

κ∈K

(cid:88)
(cid:105)2 ≤ 3

κ∈K

(cid:32)(cid:88)
F,κ ≤(cid:88)
(cid:88)
(cid:0)η2
(cid:16)
(cid:88)
(cid:16)

κ∈K

κ∈K

≤ 3

κ∈K
≤ 3 max
κ∈K

and then using the other local estimates for ηR,κ and ηJ,κ given by (10) yields

ηR,κ + ηF,κ + ηJ,κ

R,κ + η2

F,κ + η2
J,κ

(cid:88)

(cid:104)

κ∈K

b2
ω(κ)du

κ(uN )2(cid:107)∇(u − uN )(cid:107)2
κ,

(cid:1)

c2
R,κ + b2

ω(κ)du

κ(uN )2 + c2
J,κ

c2
R,κ + b2

ω(κ)du

κ(uN )2 + c2
J,κ

(cid:17)(cid:16)|||u − uN|||2
κ )2(cid:17)
(cid:17)(cid:16)|||u − uN|||2 + (hotlb)2(cid:17)

κ + (hotlb

.

(cid:3)

3.2. A posteriori estimates of eigenvalues

Unlike the error of eigenfunctions u − uN of which the deﬁnition requires a subspace alignment
procedure, the deﬁnition of the error of eigenvalues λ − λN is directly well deﬁned. Our strategy for
obtaining the upper and lower bound estimators for eigenvalues is to relate λ − λN with the bilinear
form a(u − uN , u − uN ), and then bound errors of eigenvalues by errors of eigenfunctions. Compared
to treatment in literature [15], our treatment is slightly simpler and does not involve lifting operators
due to regularity assumptions.
#(Ω) ∩ H 2(K) and λ be the solution of (6) and uN ∈ VN and λN the
Theorem 3.7. Let u ∈ H 1
DG-approximation deﬁned by (7). Then, we have the following a posteriori upper bound for the approx-
imation error in the eigenvalue

where

|λN − λ| ≤ max
κ∈K

η =

TITLE WILL BE SET BY THE PUBLISHER

(cid:19)(cid:0)η + hotub(cid:1)2
(cid:105)2(cid:33) 1

2

1 + du

κ|1+θ|
2γ

1
2
κ

(cid:18)
(cid:32)(cid:88)

κ∈K

(cid:104)

ηR,κ + ηF,κ + ηJ,κ

.

+ λ(cid:107)u − uN(cid:107)2
Ω,

9

Proof. Observe that

We also use the fact that

a(u − uN , u − uN ) = λ + λN − 2a(u, uN ).

and that

to derive

2 (u, uN ) = (cid:107)u(cid:107)2

a(u, uN ) = λ(u, uN ),
Ω − (cid:107)u − uN(cid:107)2

Ω + (cid:107)uN(cid:107)2

Ω = 2 − (cid:107)u − uN(cid:107)2
Ω,

a(u − uN , u − uN ) = λN − λ + λ(cid:107)u − uN(cid:107)2
Ω.

(12)

In consequence, we obtain the estimate

|λN − λ| ≤ |a(u − uN , u − uN )| + λ(cid:107)u − uN(cid:107)2
Ω.

Use that
a(u−uN , u−uN ) =

(cid:88)

κ∈K

(cid:104)(cid:107)∇(u−uN )(cid:107)2

(cid:105)

(cid:104)

(cid:88)

κ∈K

κ+(cid:107)V

1

2 (u−uN )(cid:107)2

κ

+ 1
2

(1+θ)(∇(u−uN ), [[uN ]])∂κ+γκ(cid:107)[[uN ]](cid:107)2

∂κ

The Cauchy-Schwarz inequality and the deﬁnition of du

κ yields

(∇(u − uN ), [[uN ]])∂κ ≤ (cid:107)∇(u − uN )(cid:107)∂κ(cid:107)[[uN ]](cid:107)∂κ ≤ du

κ(cid:107)∇(u − uN )(cid:107)κ(cid:107)[[uN ]](cid:107)∂κ,

and thus

a(u−uN , u−uN ) ≤(cid:88)

κ∈K

(cid:104)(cid:107)∇(u−uN )(cid:107)2

κ+(cid:107)V

1

2 (u−uN )(cid:107)2

κ+ du

κ|1+θ|

2

(cid:107)∇(u−uN )(cid:107)κ(cid:107)[[uN ]](cid:107)∂κ+ γκ

2 (cid:107)[[uN ]](cid:107)2

∂κ

Applying now Young’s inequality, we get

(13)

(cid:107)∇(u − uN )(cid:107)κ(cid:107)[[uN ]](cid:107)∂κ ≤

1

(2γκ) 1

2

(cid:107)∇(u − uN )(cid:107)2

κ +

(2γκ) 1

2

4

(cid:107)[[uN ]](cid:107)2
∂κ.

(cid:105)

.

(cid:105)

.

(cid:105)

Inserting this into (13) yields
a(u − uN , u − uN )

≤(cid:88)
(cid:88)

κ∈K

=

κ∈K
≤ max
κ∈K

(cid:104)(cid:107)∇(u − uN )(cid:107)2
(cid:104)(cid:16)
(cid:16)

κ|1+θ|
(8γκ)
κ|1+θ|
(8γκ)

1 + du

1 + du

1
2

1
2

1

κ + (cid:107)V

(cid:17)(cid:107)∇(u − uN )(cid:107)2
(cid:17)|||u − uN|||2.

2 (u − uN )(cid:107)2

κ + du

κ|1+θ|
(8γκ)

1
2

(cid:107)∇(u − uN )(cid:107)2

κ + du

(cid:107)[[uN ]](cid:107)2

∂κ + γκ

2 (cid:107)[[uN ]](cid:107)2

∂κ

κ + (cid:107)V

1

2 (u − uN )(cid:107)2

κ + γκ
2

1 + du

κ|1+θ|
(8γκ)

1
2

(cid:16)

κ|1+θ|(2γκ)

1
2

8

(cid:17)(cid:107)[[uN ]](cid:107)2

∂κ

(cid:105)

Applying now the result of Theorem 3.3, we get

|a(u − uN , u − uN )| ≤ max
κ∈K

≤ max
κ∈K

1 + du

κ|1+θ|
(8γκ)

1
2

1 + du

κ|1+θ|
(8γκ)

1
2

(cid:18)
(cid:18)

|||u − uN|||2

(cid:19)
(cid:19)(cid:32)(cid:88)

κ∈K

(cid:104)

ηR,κ + ηF,κ + ηJ,κ

(cid:105)2(cid:33) 1

2

2

,

+ hotub

10

TITLE WILL BE SET BY THE PUBLISHER

(cid:3)
which leads to the ﬁnal result.
#(Ω) ∩ H 2(K) and λ be the solution of (6) and uN ∈ VN and λN the
Theorem 3.8. Let u ∈ H 1
DG-approximation deﬁned by (7). Then, if the stabilization parameter γκ is large enough, i.e. γκ ≥
Ω < |||u − uN|||2, then, we
2 (1 + θ)2(du
have the following a posteriori lower bound for the approximation error in the eigenvalue

κ)2, and the high order terms not dominating, i.e. 2 λ(cid:107)u − uN(cid:107)2

1

ξ2 ≤ |λN − λ| + λ(cid:107)u − uN(cid:107)2

Ω +

1
2

1
2

(hotlb)2.

Proof. We ﬁrst observe that

a(u − uN , u − uN ) ≥ 1
2
under the ﬁrst assumption, i.e. that γκ ≥ 1
2 (1 + θ)2(du
κ)2. Indeed, the proof is identical to the one of
Lemma 3.1 of [33] by replacing the arbitrary discrete function vN by the error function u − uN and
using the constant du

|||u − uN|||2,

κ instead of dκ.

Then, starting from (12) we see that

|λN − λ| =(cid:12)(cid:12)a(u − uN , u − uN ) − λ(cid:107)u − uN(cid:107)2

(cid:12)(cid:12)

Ω

Now, observing that the second assumption of the Theorem implies that

a(u − uN , u − uN ) ≥ 1
2

|||u − uN|||2 ≥ λ(cid:107)u − uN(cid:107)2
Ω,

we deduce that

|λN − λ| ≥ a(u − uN , u − uN ) − λ(cid:107)u − uN(cid:107)2

Ω ≥ 1
2

|||u − uN|||2 − λ(cid:107)u − uN(cid:107)2
Ω.

Finally, we deduce the ﬁnal result by applying Proposition 3.6 to obtain a lower bound of the energy
(cid:3)
error.

4. Numerical results

In this section we test the eﬀectiveness of the a posteriori error estimators. The test program is
written in MATLAB, and all results are obtained on a 2.7 GHz Intel processor with 16 GB memory.
All numerical results are performed using the symmetric bilinear form (θ = 1).
The error in the energy norm of the i-th eigenfunction is denoted by |||ui − ui,N|||. We will compare
|||ui−ui,N||| with our parameter-free upper bound estimator ηi and lower bound estimator ξi, respectively.
For the eigenvalues, our theory in Section 3 indicates that after neglecting the high order terms, the
upper bound for the error of the i-th eigenvalue |λi − λi,N| can be taken as C1η2
i , and the lower bound
should be ξ2
i /C2, where C1, C2 are positive constants larger than 1. However, our estimate of the error
of the eigenvalues is based on the estimate of the error of the eigenfunctions, and hence the upper
and lower bound estimators for eigenvalues may deviate further from the true error of eigenvalues.
Numerical results below indicate that it is possible to choose and use η2
i as the numerical upper
and lower bound estimator, for the error of the i-th eigenvalue, respectively, i.e. setting C1 = C2 = 1.
κ. This term characterizes a
weighted L2 error of the eigenfunction, and hence is asymptotically less important than the rest of the
terms in the energy error. Nonetheless we include this term explicitly in the computation, where V 1
2 is
replaced by (V − Vm) 1
2 , and Vm the minimum of the potential V in Ω. As mentioned in Section 3, such
shift is possible since the addition of a constant only shifts all eigenvalues by a constant, without changing
the eigenfunctions. In the numerical computation, the intuitively high order terms hotub and hotlb
that are part of the upper and lower bound estimators, which were derived in Section 3, are neglected.
Although we do not have a priori error analysis for general non-polynomial basis functions to justify that
such terms are indeed of higher order compared to the upper and lower bound estimators, respectively,
we compute these terms explicitly. As we will see in the numerical examples, hotub, hotlb can indeed be

The deﬁnition of the energy norm contains the term (cid:107)V 1

2 (ui − ui,N )(cid:107)2

i and ξ2

TITLE WILL BE SET BY THE PUBLISHER

11

much smaller than the upper and lower bound estimators, respectively, when the approximate solution
converges to the true solution as the basis set is enriched.

Our test systems are selected from the same set as those used in Part I of this manuscript [33].
Numerical results indicate that our estimators for eigenfunctions capture the true error within a factor
2 ∼ 5, across a wide range of accuracy. Since the error of eigenvalues is on the order of magnitude of the
square of the error of eigenfunctions, our upper and lower bound estimators for eigenvalues is generally
within an order of magnitude of the error of the eigenvalues.

As discussed in Section 3, it is straightforward to measure the error of eigenvalues. Special care should
be taken when measuring the error of eigenfunctions. Even when all eigenvalues are simple (i.e. non-
denegerate), the computed eigenfunctions may carry an arbitrary phase factor ±1. If the multiplicity
of an eigenvalue is larger than 1, the resulting eigenfunctions may be an arbitrary normalized vector
in the corresponding eigenspace. Therefore when measuring the error of eigenfunctions, a “subspace
alignment” procedure is ﬁrst performed. Assume we would like to compute the ﬁrst m eigenfunctions.
In each element κ, we represent the solution on a ﬁne set of Legendre-Gauss-Lobatto (LGL) grid points.
With some abuse of notation, we denote by ui, for i = 1, . . . , m, a column vector, and each entry of
the vector is the value of the true eigenfunction evaluated on one such LGL grid point. This setup is
the same as that used in [33]. We also denote by W a diagonal matrix with each diagonal entry being
the quadrature weight associated with a LGL grid point, such that the discrete normalization condition
can be written as

uT
i W uj = δij,

1 ≤ i, j ≤ m.

Here δij is the Kronecker δ-symbol. Similarly ui,N denotes the column vector with each entry being the
value of the approximate eigenfunction in the DG method evaluated on a LGL grid point, and satisﬁes
the normalization condition

Deﬁne the matrix U = [u1, . . . , um] and UN = [u1,N , . . . , um,N ]. Then we deﬁne the aligned eigen-

functions, denoted by (cid:101)UN = [(cid:101)u1,N , . . . ,(cid:101)um,N ], as

uT
i,N W uj,N = δij,

1 ≤ i, j ≤ m.

(cid:101)UN = UN (U T
(cid:101)u1,N = u1,N (uT

N W U ).

1,N W u1),

(14)

When m = 1, Eq. (14) reduces to

and the subspace alignment procedure can clearly recover the potential phase factor discrepancy when
u1 and u1,N . Eq. (14) can be further used when certain eigenvalues are degenerate. Then in practice,

|||ui − ui,N||| is computed from |||ui −(cid:101)ui,N|||. With slight abuse of notation, in the discussion below ui,N
refers to the aligned eigenfunction (cid:101)ui,N . All eigenfunctions have normalized 2-norm in the real space,

and therefore the order of magnitude of absolute errors of eigenfunctions is also comparable to that of
the relative errors.

The quality of the upper and lower bound estimators for the i-th eigenfunction is measured by

Ci,η =

ηi

|||ui − ui,N||| , Ci,ξ =

ξi

|||ui − ui,N||| ,

respectively. The estimators are strictly upper and lower bound of the error if Ci,η > 1 and Ci,ξ < 1,
and the estimators are considered to be eﬀective if they are close to 1. Similarly, the estimators for the
eigenfunctions are deﬁned to be

C λ

i,η =

η2
i

|λi − λi,N| , C λ

i,ξ =

ξ2
i

|λi − λi,N| .

Our test problems include both one dimensional (1D) and two dimensional (2D) domains with pe-
riodic boundary conditions. The numerical examples are chosen to be the two diﬃcult cases in our
previous publication [33]. Our non-polynomial basis functions are generated from the adaptive local
basis (ALB) set [32] in the DG framework. The ALB set was proposed to systematically reduce the num-
ber of basis functions used to solve Kohn-Sham density functional theory calculations, which involves
large scale eigenvalue computations.

12

TITLE WILL BE SET BY THE PUBLISHER

We denote by N the number of ALBs per element. For operators in the form of A = −∆ + V with
periodic boundary condition, the basic idea of the ALB set is to use eigenfunctions computed from
local domains as basis functions corresponding to the lowest few eigenvalues. The eigenfunctions are
associated with the same operator A, but with modiﬁed boundary conditions on the local domain. More

speciﬁcally, in a d-dimensional space, for each element κ, we form an extended element (cid:101)κ consisting of
κ and its 3d − 1 neighboring elements in the sense of periodic boundary condition. On(cid:101)κ we solve the
with periodic boundary condition on ∂(cid:101)κ. The collection of eigenfunctions (corresponding to lowest N
eigenvalues) are restricted from(cid:101)κ to κ, i.e.

eigenvalue problem

(15)

− ∆(cid:101)ϕi + V(cid:101)ϕi = λi,(cid:101)ϕi.
(cid:40)(cid:101)ϕi(x), x ∈ κ;

ϕi(x) =

0,

otherwise.

After orthonormalizing the set of basis functions {ϕi}N
i=1 locally on each element κ and removing the
linearly dependent functions, the resulting set of orthonormal functions are called the ALB functions.
Since periodic boundary conditions are used on the global domain Ω, the reference solution is solved
using a planewave basis set with a suﬃciently large number of planewaves. The ALB set is also computed

using a suﬃciently large number of planewaves on the extended element(cid:101)κ. Then a Fourier interpolation
procedure is carried out from(cid:101)κ to the local element LGL for accurate numerical integration.

4.1. 1D example

We ﬁrst demonstrate the eﬀectiveness of the a posteriori error estimates for a second order operator
on a 1D domain Ω = [0, 2π], using the ALB set as non-polynomial basis functions. The potential
function V (x) is given by the sum of three Gaussian functions with negative magnitude, as shown in
Fig. 1 (a). The operator A = −∆ + V has 3 negative eigenvalues and is indeﬁnite. The domain is
partitioned into 7 elements for the ALB calculation. Fig. 1 (b) shows the ﬁrst eigenfunction u1, and
Fig. 1 (c) shows the point-wise error u1 − u1,N using N = 6 ALBs per element.

Figure 1. (a) The potential V (x) given by the sum of three Gaussians with negative
magnitude. (b) The ﬁrst eigenfunction u1(x). (c) Point-wise error between the ﬁrst
eigenfunction u1(x) and the numerical solution u1,N (x) calculated using the ALB set
with 7 elements and N = 6 basis functions per element.

Fig. 2 (a), (b) compare the error of the ﬁrst 11 eigenvalues and the corresponding eigenfunctions,
together with the upper and lower estimators, respectively, using a relatively small number of 6 basis
functions per element. For the eigenfunctions, Ci,η ranges from 1.50 to 2.82. Hence ηi is indeed an
eﬀective upper bound for |||ui − ui,N|||. The lower bound estimator Ci,ξ ranges from 0.32 to 0.58, and
therefore is eﬀective as well. In terms of eigenvalues, the upper bound estimator C λ
i,η ranges from 3.16
and 9.70, and the lower bound estimator for eigenvalues C λ
i,ξ ranges from 0.17 to 0.40. While the upper

0246−50−40−30−20−100xV(x)024600.20.40.60.811.21.4xu1(x)0246−505x 10−5xu1(x)−u1,N(x)TITLE WILL BE SET BY THE PUBLISHER

13

and lower bound of the eigenvalues remains to be true upper and lower bound, respectively, we note
that the eigenvalue estimator is less eﬀective compared to that of the eigenfunctions, and the upper
(lower) bound estimator can overestimate (underestimate) the error by around one order of magnitude.
Nonetheless, we note in Fig. 2 (a) that the error of eigenvalues spans over 4 orders of magnitude, and our
upper and lower estimators well captures such inhomogeneity in terms of accuracy among the diﬀerent
eigenvalues. The same trend is observed for eigenfunctions in Fig. 2 (b). Fig. 2 (b) also reports the
terms hotub, hotlb deﬁned in Section 3. We ﬁnd that hotub
i are signiﬁcantly smaller than ηi
and ξi, respectively, and thus justify numerically that such terms are indeed high order terms.

i and hotlb

Fig. 2 (c), (d) demonstrate the error of eigenvalues and eigenfunctions and the associated estimators
using a more reﬁned basis set, with 10 basis functions per element. Despite the small increase of the
number of basis functions, the error of eigenvalues is reduced to as low as 10−8. Ci,η for eigenfunctions is
between 2.19 and 2.45, and Ci,ξ is between 0.64 and 0.67. The eﬀectiveness parameters are remarkably
homogeneous for all eigenfunctions computed. Correspondingly C λ
i,η for eigenvalues is between 5.27
and 7.37, and C λ
i,ξ for eigenvalues is between 0.45 and 0.58. The diﬀerence between ηi, ξi compared to
hotub
is ampliﬁed even further in Fig. 2 (d) as the basis set reﬁnes, and therefore justiﬁes that
hotub

i , hotlb
i
i , hotlb
i are indeed of higher order.

6 basis

6 basis

10 basis

10 basis

Figure 2. Error of the (a) eigenvalues and (b) eigenfunctions together with upper
and lower bound estimator for the ﬁrst 11 eigenfunctions, using 6 basis functions per
element. (c),(d) are the same as (a),(b) respectively but with 10 basis functions per
element.

4.2. 2D example

Our second example is a 2D problem on Ω = [0, 2π] × [0, 2π] with periodic boundary condition. The
potential V is given by the sum of four Gaussians with negative magnitude, as illustrated in Fig. 3 (a).
Fig. 3 (b) shows the ﬁrst eigenfunction u1 and Fig. 3 (c) shows the point-wise error u1 − u1,N using
N = 11 ALBs per element. In the ALB computation, the domain is partitioned into 5 × 5 elements,
indicated by black dashed lines.

24681010−610−410−2iN=6|λi−λi,N|η2iξ2i24681010−610−510−410−310−210−1iN=6|||ui−ui,N|||ηiξihotubihotlbi24681010−810−7iN=10|λi−λi,N|η2iξ2i24681010−910−810−710−610−510−410−3iN=10|||ui−ui,N|||ηiξihotubihotlbi14

TITLE WILL BE SET BY THE PUBLISHER

Figure 3. (a) The potential V (x, y). (b) The ﬁrst eigenfunction u1(x). (c) Point-
wise error between the ﬁrst eigenfunction u1(x) and the numerical solution u1,N (x)
calculated using the ALB set with 5 × 5 elements and N = 11 basis functions per
element.

Similar to the 1D case, Fig. 4 (a), (b) compare the error of the ﬁrst 11 eigenvalues and the cor-
responding eigenfunctions, together with the upper and lower estimators, respectively, using 11 basis
functions per element. The eﬀectiveness parameter for eigenfunctions Ci,η ranges from 2.78 to 4.59,
and the Ci,ξ ranges from 0.22 to 0.36. For the eigenvalues, the upper bound estimator C λ
i,η is between
12.73 and 21.68, and the lower bound estimator for eigenvalues C λ
i,ξ is between 0.08 to 0.14. Similarly,
we observe that C λ
i,ξ are roughly on the order of magnitude of the square of the Ci,η and
Ci,ξ, respectively. Again our upper and lower bound estimator well captures the large inhomogeneity
in terms of accuracy among diﬀerent eigenvalues and eigenfunctions.

i,η and C λ

Fig. 4 (c), (d) show the error of eigenvalues and eigenfunctions and the associated estimators using
a large number of 41 basis functions per element. Ci,η for eigenfunctions is between 2.00 and 2.41,
and Ci,ξ is between 0.23 and 0.32. The eﬀectiveness parameters are remarkably homogeneous for all
eigenfunctions computed. Correspondingly C λ
i,ξ for
eigenvalues is between 0.06 and 0.11. The high order terms hotub
i are reported in Fig. 4 (b) and
(d). Again we ﬁnd that such terms are smaller than the upper and lower estimators, and the diﬀerence
become more enhanced as the basis set reﬁnes.

i,η for eigenvalues is between 4.45 and 6.85, and C λ

i , hotlb

xyV(x,y)02460123456−50−40−30−20−10xyu1(x,y)024601234560.20.40.60.81xy02460123456−101x 10−4TITLE WILL BE SET BY THE PUBLISHER

15

11 basis

11 basis

41 basis

41 basis

Figure 4. Error of the (a) eigenvalues and (b) eigenfunctions together with upper
and lower bound estimator for the ﬁrst 11 eigenfunctions, using 11 basis functions per
element. (c),(d) are the same as (a),(b) respectively but with 41 basis functions per
element.

5. Conclusion

In this paper, we extend the framework that was introduced in the companion paper (Part I) [33]
to linear eigenvalue problems for second order partial diﬀerential operators in a discontinuous Galerkin
(DG) framework. Our method provides residual type a posteriori upper and lower bounds estimators for
estimating the error of the numerically computed eigenvalues and eigenfunctions. The key-feature of our
approach is that in absence of a priori inverse type inequalities for non-polynomial basis functions, local
eigenvalue problems are solved and subsequently embedded in the a posteriori estimates. Hence our
estimate is tailored for each new set of basis functions, and numerical results illustrate the eﬀectiveness
of our approach.

Future developments will naturally concern the extension to non-linear eigenvalue problems and in

particular the Kohn-Sham equations in the framework density functional theory.

Acknowledgments

This work was partially supported by Laboratory Directed Research and Development (LDRD) fund-
ing from Berkeley Lab, provided by the Director, Oﬃce of Science, of the U.S. Department of Energy
under Contract No. DE-AC02-05CH11231, by the Scientiﬁc Discovery through Advanced Computing
(SciDAC) program and the Center for Applied Mathematics for Energy Research Applications (CAM-
ERA) funded by U.S. Department of Energy, Oﬃce of Science, Advanced Scientiﬁc Computing Research
and Basic Energy Sciences, and by the Alfred P. Sloan fellowship (L. L.). L. L. would like to thank the
hospitality of the Jacques-Louis Lions Laboratory (LJLL) during his visit. We sincerely thank Yvon
Maday for thoughtful suggestions and critical reading of the paper.

24681010−610−510−410−3iN=11|λi−λi,N|η2iξ2i24681010−410−310−210−1iN=11|||ui−ui,N|||ηiξihotubihotlbi24681010−910−810−710−610−5iN=41|λi−λi,N|η2iξ2i24681010−610−510−410−3iN=41|||ui−ui,N|||ηiξihotubihotlbi16

TITLE WILL BE SET BY THE PUBLISHER

References

[1] M. G. Armentano and R. G. Dur´an. Asymptotic lower bounds for eigenvalues by nonconforming ﬁnite element

methods. Electron. Trans. Numer. Anal., 17:93–101, 2004.

[2] I. Babuˇska and J. Osborn. Eigenvalue problems. In Handbook of numerical analysis, Vol. II, Handb. Numer. Anal.,

II, pages 641–787. North-Holland, Amsterdam, 1991.

[3] N. W. Bazley and D. W. Fox. Lower bounds for eigenvalues of Schr¨odinger’s equation. Phys. Rev. (2), 124:483–492,

1961.

[4] D. Boﬃ. Finite element approximation of eigenvalue problems. Acta Numer., 19:1–120, 2010.
[5] E. Canc`es, R. Chakir, and Y. Maday. Numerical analysis of the planewave discretization of some orbital-free and

kohn-sham models. ESAIM: Mathematical Modelling and Numerical Analysis, 46:341–388, 3 2012.

[6] E. Canc`es, G. Dusson, Y. Maday, B. Stamm, and M. Vohral´ık. A perturbation-method-based a posteriori estimator
for the planewave discretization of nonlinear Schr¨odinger equations. Comptes Rendus Mathematique, 352(11):941 –
946, 2014.

[7] E. Canc`es, G. Dusson, Y. Maday, B. Stamm, and M. Vohral´ık. Guaranteed and robust a posteriori bounds for Laplace

eigenvalues and eigenvectors: conforming approximations. working paper or preprint, Sept. 2015.

[8] C. Carstensen and J. Gedicke. Guaranteed lower bounds for eigenvalues. Math. Comp., 83(290):2605–2629, 2014.
[9] R. G. Dur´an, C. Padra, and R. Rodr´ıguez. A posteriori error estimates for the ﬁnite element approximation of

eigenvalue problems. Math. Models Methods Appl. Sci., 13(8):1219–1229, 2003.

[10] G. Dusson and Y. Maday. A Posteriori Analysis of a Non-Linear Gross-Pitaevskii type Eigenvalue Problem. 28 pages,

Aug. 2013.

[11] W. E and B. Engquist. The heterognous multiscale methods. Comm. Math. Sci., 1:87–132, 2003.
[12] G. E. Forsythe. Asymptotic lower bounds for the fundamental frequency of convex membranes. Paciﬁc J. Math.,

5:691–702, 1955.

[13] D. W. Fox and W. C. Rheinboldt. Computational methods for determining lower bounds for eigenvalues of operators

in Hilbert space. SIAM Rev., 8:427–462, 1966.

[14] M. J. Frisch, J. A. Pople, and J. S. Binkley. Self-consistent molecular orbital methods 25. supplementary functions

for gaussian basis sets. J. Chem. Phys., 80:3265–3269, 1984.

[15] S. Giani and E. J. C. Hall. An a posteriori error estimator for hp-adaptive discontinuous Galerkin methods for elliptic

eigenvalue problems. Math. Mod. Meth. Appl. Sci., 22:1250030–1250064, 2012.

[16] F. Goerisch and Z. Q. He. The determination of guaranteed bounds to eigenvalues with the use of variational methods.
I. In Computer arithmetic and self-validating numerical methods (Basel, 1989), volume 7 of Notes Rep. Math. Sci.
Engrg., pages 137–153. Academic Press, Boston, MA, 1990.

[17] L. Grubiˇsi´c and J. S. Ovall. On estimators for eigenvalue/eigenvector approximations. Math. Comp., 78(266):739–770,

2009.

[18] V. Heuveline and R. Rannacher. A posteriori error control for ﬁnite approximations of elliptic eigenvalue problems.

Adv. Comput. Math., 15(1-4):107–138, 2001.

[19] R. Hiptmair, A. Moiola, and I. Perugia. Plane wave discontinuous Galerkin methods for the 2D Helmholtz equation:

analysis of the p-version. SIAM J. Numer. Anal., 49:264–284, 2011.

[20] T. Y. Hou and X.-H. Wu. A multiscale ﬁnite element method for elliptic problems in composite materials and porous

media. J. Comput. Phys., 134:169–189, 1997.

[21] J. Hu, Y. Huang, and Q. Lin. Lower bounds for eigenvalues of elliptic operators: by nonconforming ﬁnite element

methods. J. Sci. Comput., 61(1):196–221, 2014.

[22] J. Hu, Y. Huang, and Q. Shen. The lower/upper bound property of approximate eigenvalues by nonconforming ﬁnite

element methods for elliptic operators. J. Sci. Comput., 58(3):574–591, 2014.

[23] J. D. Joannopoulos, S. G. Johnson, J. N. Winn, and R. D. Meade. Photonic crystals: molding the ﬂow of light.

Princeton Univ. Pr., 2011.

[24] J. Junquera, O. Paz, D. Sanchez-Portal, and E. Artacho. Numerical atomic orbitals for linear-scaling calculations.

Phys. Rev. B, 64:235111–235119, 2001.

[25] T. Kato. On the upper and lower bounds of eigenvalues. J. Phys. Soc. Japan, 4:334–339, 1949.
[26] J. Kaye, L. Lin, and C. Yang. A posteriori error estimator for adaptive local basis functions to solve Kohn-Sham

density functional theory. Commun. Math. Sci., 13:1741, 2015.

[27] W. Kohn and L. Sham. Self-consistent equations including exchange and correlation eﬀects. Phys. Rev., 140:A1133–

A1138, 1965.

[28] J. R. Kuttler and V. G. Sigillito. Bounding eigenvalues of elliptic operators. SIAM J. Math. Anal., 9(4):768–778,

1978.

[29] J. R. Kuttler and V. G. Sigillito. Estimating eigenvalues with a posteriori/a priori inequalities, volume 135 of

Research Notes in Mathematics. Pitman (Advanced Publishing Program), Boston, MA, 1985.

[30] Y. A. Kuznetsov and S. I. Repin. Guaranteed lower bounds of the smallest eigenvalues of elliptic diﬀerential operators.

J. Numer. Math., 21(2):135–156, 2013.

[31] M. G. Larson. A posteriori and a priori error analysis for ﬁnite element approximations of self-adjoint elliptic eigen-

value problems. SIAM J. Numer. Anal., 38(2):608–625, 2000.

[32] L. Lin, J. Lu, L. Ying, and W. E. Adaptive local basis set for Kohn-Sham density functional theory in a discontinuous

Galerkin framework I: Total energy calculation. J. Comput. Phys., 231:2140–2154, 2012.

[33] L. Lin and B. Stamm. A posteriori error estimates for discontinuous Galerkin methods using non-polynomial basis

functions. Part I: Second order linear PDE. ESAIM: Mathematical Modelling and Numerical Analysis, 2015.

TITLE WILL BE SET BY THE PUBLISHER

17

[34] X. Liu and S. Oishi. Veriﬁed eigenvalue evaluation for the Laplacian over polygonal domains of arbitrary shape.

SIAM J. Numer. Anal., 51(3):1634–1654, 2013.

[35] Y. Maday and A. T. Patera. Numerical analysis of a posteriori ﬁnite element bounds for linear functional outputs.

Math. Models Methods Appl. Sci., 10(5):785–799, 2000.

[36] C. B. Moler and L. E. Payne. Bounds for eigenvalues and eigenvectors of symmetric operators. SIAM J. Numer.

Anal., 5:64–70, 1968.

[37] M. Plum. Guaranteed numerical bounds for eigenvalues. In Spectral theory and computational methods of Sturm-
Liouville problems (Knoxville, TN, 1996), volume 191 of Lecture Notes in Pure and Appl. Math., pages 313–332.
Dekker, New York, 1997.

[38] R. Rannacher, A. Westenberger, and W. Wollner. Adaptive ﬁnite element solution of eigenvalue problems: balancing

of discretization and iteration error. J. Numer. Math., 18(4):303–327, 2010.

[39] I. ˇSebestov´a and T. Vejchodsk´y. Two-sided bounds for eigenvalues of diﬀerential operators with applications to

Friedrichs, Poincar´e, trace, and similar constants. SIAM J. Numer. Anal., 52(1):308–329, 2014.

[40] G. Still. Computable bounds for eigenvalues and eigenfunctions of elliptic diﬀerential operators. Numer. Math.,

54(2):201–223, 1988.

[41] R. Tezaur and C. Farhat. Three-dimensional discontinuous Galerkin elements with plane waves and Lagrange mul-

tipliers for the solution of mid-frequency Helmholtz problems. Int. J. Numer. Meth. Eng., 66:796–815, 2006.

[42] R. Verf¨urth. A posteriori error estimates for nonlinear problems. Finite element discretizations of elliptic equations.

Math. Comp., 62(206):445–475, 1994.

[43] H. F. Weinberger. Upper and lower bounds for eigenvalues by ﬁnite diﬀerence methods. Comm. Pure Appl. Math.,

9:613–623, 1956.

[44] Y. Yang, J. Han, H. Bi, and Y. Yu. The lower/upper bound property of the Crouzeix–Raviart element eigenvalues

on adaptive meshes. J. Sci. Comput., 62(1):284–299, 2015.

