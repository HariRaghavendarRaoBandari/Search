6
1
0
2

 
r
a

M
7

 

 
 
]
S
D
h
t
a
m

.

[
 
 

1
v
4
4
2
2
0

.

3
0
6
1
:
v
i
X
r
a

LOCAL DIMENSIONS OF MEASURES OF FINITE TYPE II -

MEASURES WITHOUT FULL SUPPORT AND WITH

NON-REGULAR PROBABILITIES.

March 8, 2016

KATHRYN E. HARE, KEVIN G. HARE, MICHAEL KA SHING NG

Abstract. Consider a sequence of linear contractions Sj (x) = ̺x + dj and
probabilities pj > 0 with P pj = 1. We are interested in the self-similar
measure µ = P pj µ ◦ S−1
, of ﬁnite type. In this paper we study the multi-
fractal analysis of such measures, extending the theory to measures arising from
non-regular probabilities and whose support is not necessarily an interval.

j

Under some mild technical assumptions, we prove that there exists a subset
of suppµ of full µ and Hausdorﬀ measure, called the truly essential class, for
which the set of (upper or lower) local dimensions is a closed interval. Within
the truly essential class we show that there exists a point with local dimension
exactly equal to the dimension of the support. We give an example where
the set of local dimensions is a two element set, with all the elements of the
truly essential class giving the same local dimension. We give general criteria
for these measures to be absolutely continuous with respect to the associated
Hausdorﬀ measure of their support and we show that the dimension of the
support can be computed using only information about the essential class.

To conclude, we present a detailed study of three examples. First, we
show that the set of local dimensions of the biased Bernoulli convolution with
contraction ratio the inverse of a simple Pisot number always admits an isolated
point. We give a precise description of the essential class of a generalized
Cantor set of ﬁnite type, and show that the kth convolution of the associated
Cantor measure has local dimension at x ∈ (0, 1) tending to 1 as k tends to
inﬁnity. Lastly, we show that within a maximal loop class that is not truly
essential, the set of upper local dimensions need not be an interval. This is in
contrast to the case for ﬁnite type measures with regular probabilities and full
interval support.

1. Introduction

In this paper we continue the investigations, begun in [11], on the multifrac-
tal analysis of equicontractive self-similar measures of ﬁnite type. For self-similar
measures arising from an IFS that satisﬁes the open set condition the multifractal
analysis is well understood. In particular, the set of attainable local dimensions is
a closed interval whose endpoints can be computed with the Legendre transform.
For measures that do not satisfy the open set condition, the multifractal analysis
is more complicated and the set of local dimensions need not be an interval. This
phenomena was discovered ﬁrst for the 3-fold convolution of the classical Cantor

Research of K. G. Hare was supported by NSERC Grant RGPIN-2014-03154.
Computational support provided in part by the Canadian Foundation for Innovation, and the

Ontario Research Fund.

Research of K. E. Hare and M. K. S. Ng was supported by NSERC Grant 2011-44597.

1

2

K. E. HARE, K. G. HARE, M. K. S. NG

measure in [14] and was further explored in [2, 9, 17, 22], for example.
In [19],
Ngai and Wang introduced the notion of ﬁnite type, a property stronger than the
weak separation condition (WSC), but satisﬁed by many interesting self-similar
measures that fail the open set condition. Examples include Bernoulli convolutions
with contraction factor the inverse of a Pisot number and self-similar Cantor-like
measures with ratio the inverse of an integer.

Building on earlier work, such as [10, 13, 16, 21], Feng undertook a study of
equicontractive, self-similar measures of ﬁnite type in [4, 5, 6], with his main focus
being Bernoulli convolutions. Motivated by this research, in [11] (and [12]) a general
theory was developed for the local dimensions of self-similar measures of ﬁnite
type assuming the associated self-similar set was an interval and the underlying
probabilities {pj}m
j=0 generating the measure µ were regular, meaning p0 = pm =
min pj. There it was shown that the set of local dimensions at points in the ‘essential
class’ (a set of full Lebesgue measure in the support of µ and often the interior of
its support) was a closed interval and that the set of local dimensions at periodic
points was dense in this interval. Formulas were given for the local dimensions.
These formulae are particularly simple at periodic points.

In contrast to much of the earlier work, in this paper we do not require any
assumptions on the probabilities and we relax the requirement that the support of
µ (the self-similar set) is an interval. In Section 2, we give formulas for calculating
local dimensions. These are relatively simple for periodic points, although neces-
sarily more complicated than under the previous assumptions. We begin Section 3
by introducing the ‘truly essential class’. We see that this set is the relative inte-
rior of the essential class and we prove that it has full µ and Hausdorﬀ s-measure,
where s is the Hausdorﬀ dimension of the self-similar set. Under a mild technical
assumption, that is satisﬁed in many interesting examples, we prove that the set
of local dimensions at the points in the truly essential class is a closed interval and
that the set of local dimensions at the periodic points is dense in that interval.

We prove that there is always a point at which the local dimension of µ coincides
with the Hausdorﬀ dimension of suppµ and give an example of a measure where
this occurs at all the truly essential points (but not at all points of the support).
A suﬃcient condition is given for a ﬁnite type measure to be absolutely continuous
with respect to the associated Hausdorﬀ measure and an example is seen that
satisﬁes this condition when s = 1, even though the self-similar set is not an interval.
We also give a formula for calculating the Hausdorﬀ dimension of the support from
just the knowledge of the essential class.

Related results were given by Feng in [6]. Here, Feng constructed a (typically,

countably inﬁnite) family of closed intervals, Ij , with disjoint interiors, whereS Ij
construction one can see that S IjT K is the essential class and SR (Ij)T K is

is of full measure and on each of these closed intervals the set of attainable local
dimensions of the restricted measure µj := µ|Ij was a closed interval. From his
contained in our truly essential class. The endpoints of the intervals Ij may or may
not be truly essential. We note that the local dimension of the restricted measure
µj at an end point of Ij is not necessarily the same as the local dimension of µ at
this point, even when it is a truly essential point.

Feng and Lau in [8] studied more general IFS that only satisfy the WSC and
showed that in this case there is also an open set U such that the set of attainable

LOCAL DIMENSIONS

3

local dimensions of the restricted measure, µ|U , is a closed interval. In the examples
given in that paper, the set U is much smaller than the truly essential class.
In [5], Feng had shown that the set of local dimensions of the uniform Bernoulli
convolutions with contraction factor the inverse of a simple Pisot number (mean-
j=0 xj ) is always a closed interval. As one
application of our work, in Section 4 we prove, in contrast, that biased Bernoulli
convolutions with these contraction factors always admit an isolated point in their
set of local dimensions.

ing the minimal polynomial is xn −Pn−1

In Section 5 we present a detailed study of the local dimensions of ﬁnite type
Cantor-like measures, extending the work done in [2, 11, 22]. In those papers, it
was shown, for example, that if p0 < pj for j 6= 0, m, then the local dimension at 0
is isolated. Here we give further conditions that ensure there is an isolated point.
But we also give examples where the measure has no isolated points and we give
a family of examples which have exactly two distinct local dimensions. We also
show that the local dimensions of the rescaled k-fold convolutions of a Cantor-like
measure converge to 1 at points in (0, 1). Previously, in [1], it had been shown that
these local dimensions were bounded.

In Section 6, we illustrate, by means of a detailed example, the complications
and diﬀerences that can arise when studying the local dimensions outside of the
truly essential class and in Section 7 investigate the connection between ﬁnite type
and Pisot contractions.

2. Notation and Preliminary Results

We begin by introducing the deﬁnition of ﬁnite type, as well as basic notation

and terminology that will be used throughout the paper.

2.1. Finite Type. Consider the iterated function system (IFS) consisting of the
contractions Sj : R → R, j = 0, . . . , m, deﬁned by
(1)
Sj(x) = ̺x + dj,
where 0 < ̺ < 1, 0 = d0 < d1 < d2 < · · · < dm and m ≥ 1 is an integer. The
unique, non-empty, compact set K satisfying

K =

m[j=0

Sj(K)

is known as the associated self-similar set. By rescaling the dj if needed, we can
assume the convex hull of K is [0, 1]. We will not assume that K = [0, 1] or even
that it has non-empty interior.

It was shown in [19, Thm. 1.2] that if s = dimH K and H s denotes the Hausdorﬀ
s-measure restricted to K, then 0 < H s(K) < ∞. Upon normalizing we can assume
H s(K) = 1. Further, we note that 0 < s ≤ 1. We remark that in the special case
that K = [0, 1], then s = 1 and H s is the normalized Lebesgue measure.
j=0 pj = 1. Throughout this
paper, our interest will be in the self-similar measure µ associated to the family of
contractions {Sj} given above, which satisﬁes the identity

Suppose probabilities pj > 0, j = 0, . . . , m satisfyPm

(2)

µ =

mXj=0

pjµ ◦ S−1

j

.

4

K. E. HARE, K. G. HARE, M. K. S. NG

These non-atomic, probability measures have support K.

We put A = {0, . . . , m}. Given an n-tuple σ = (j1, . . . , jn) ∈ An, we write Sσ

for the composition Sj1 ◦ · · · ◦ Sjn and let

Deﬁnition 2.1. The iterated function system (IFS),

pσ = pj1 · · · pjn .

{Sj(x) = ̺x + dj : j = 0, . . . , m},

is said to be of ﬁnite type if there is a ﬁnite set F ⊆ R such that for each positive
integer n and any two sets of indices σ = (j1, . . . , jn), σ′ = (j′1, . . . , j′n) ∈ An, either

̺−n |Sσ(0) − Sσ′ (0)| > c or ̺−n(Sσ(0) − Sσ′ (0)) ∈ F,

where c = (1 − ̺)−1(max dj − min dj) is the diameter of K.
(2), we also say that µ is of ﬁnite type.

If the IFS is of ﬁnite type and µ is an associated self-similar measure satisfying

Here we have given the general deﬁnition of ﬁnite type for an equicontractive
IFS in R. This simpliﬁes to c = 1 in the case where the convex hull of K is [0, 1]. It
is worth noting here that the deﬁnition of ﬁnite type is independent of the choice
of probabilities.

Finite type is a property that is stronger than the weak separation condition,
but weaker than the open set condition [20]. Examples include (uniform or biased)
Bernoulli convolutions with contraction factor the reciprocal of a Pisot number,
and Cantor-like measures associated with Cantor sets with contraction factors re-
ciprocals of integers. See Sections 4 and 5 where these are studied in detail.

2.2. Characteristic vectors and the Essential class. The structure of mea-
sures of ﬁnite type is explained in detail in [4, 5, 6] and [11]; we will give a brief
overview here.

For each integer n, let h1, . . . , hsn be the collection of elements of the set {Sσ(0),

Sσ(1) : σ ∈ An}, listed in increasing order. Put

Fn = {[hj, hj+1] : 1 ≤ j ≤ sn − 1 and (hj, hj+1) ∩ K 6= ∅}.

Elements of Fn are called net intervals of level n. By deﬁnition, a net interval
contains net subintervals of every lower level. For each ∆ ∈ Fn, n ≥ 1, there

is a unique element b∆ ∈ Fn−1 which contains ∆, called the parent (of child ∆).
We will deﬁne the left-most child of parent b∆ = [a, b] ∈ Fn−1 to be the child

∆ = [a, b′] ∈ Fn. We will similarly deﬁne the right-most child. It is worth noting
that it is possible for a child to be both the left and the right-most child.
It is
further worth observing that because we are not assuming the self-similar set is the
interval [0, 1], it is possible for a parent to have no left-most child or no right-most
child.

Given ∆ = [a, b] ∈ Fn, we denote the normalized length of ∆ by

ℓn(∆) = ̺−n(b − a).

By the neighbour set of ∆ we mean the ordered k-tuple

Vn(∆) = (a1, . . . , ak)

where

{a1, . . . , ak} = {̺−n(a − Sσ(0)) : σ ∈ An, ∆ ⊆ Sσ[0, 1]}.

LOCAL DIMENSIONS

5

Given ∆1, . . . , ∆m, (listed in order from left to right) all the net intervals of level n
which have the same parent and normalized length as ∆, let rn(∆) be the integer
r with ∆r = ∆. The characteristic vector of ∆ is the triple

Cn(∆) = (ℓn(∆), Vn(∆), rn(∆)).

Often we suppress rn(∆) giving the reduced characteristic vector (ℓn(∆), Vn(∆)).

If the measure is of ﬁnite type, there will be only ﬁnitely many distinct charac-

teristic vectors. We denote the set of such vectors by Ω,
Ω = {Cn(∆) : n ∈ N, ∆ ∈ Fn}.

By an admissible path, η, of length L(η) = L, we will mean an ordered L-tuple,
η = (γj)L
j=1, where γj ∈ Ω for all j and the characteristic vector, γj, is the parent of
γj+1. Each ∆ ∈ Fn can be uniquely identiﬁed by an admissible path of length n+1,
say (C0(∆0), . . . ,Cn(∆n)), where ∆ = ∆n, ∆0 = [0, 1], ∆j ∈ Fj and ∆j = [∆j+1 for

all j. This is called the symbolic representation of ∆; we will frequently identify ∆
with its symbolic representation.

Similarly, the symbolic representation for x ∈ K will mean the sequence

[x] = (C0(∆0),C1(∆1), . . . )

of characteristic vectors where x ∈ ∆n for all n and ∆j ∈ Fj is the parent of
∆j+1. The notation [x|N ] will mean the admissible path consisting of the ﬁrst N
characteristic vectors of [x]. We will often write ∆n(x) for the net interval in Fn
containing x ∈ K; its symbolic representation is [x|n].
If x is an endpoint of ∆n(x) for some n (and then for all larger integers) we call
x a boundary point. We remark that if x is a boundary point, then there can be
two diﬀerent symbolic representations for x, one approaching x from the left i.e., by
taking right-most descendents at all levels beyond level n, and the other approaching
x from the right, by taking left-most descendents. If x is not a boundary point,
then the symbolic representation is unique.

It is worth emphasizing that [x|N ] is deﬁned as the truncation of [x] as opposed
to deﬁning it as a sequence (C0(∆0),C1(∆1), . . . ,CN (∆N )) with x ∈ ∆i. To see
this distinction, recall that it is possible for ∆N = [hi, hi+1] to have no right-most
children. Let x = hi+1 be the right-most endpoint of ∆N . Then x is also the
left-most endpoint of the adjacent net interval, ∆′N = [hi+1, hi+2]. As ∆N has no
right-most child, we do not have a net interval of depth N +1 with x ∈ ∆N +1 ⊆ ∆N .
As K has no isolated points and x ∈ K, for all M ≥ N we must have net intervals
x ∈ ∆M ⊆ ∆′N .
In such a case, the boundary point x has a unique symbolic
representation.

A non-empty subset Ω′ ⊆ Ω is called a loop class if whenever α, β ∈ Ω′, then
there are characteristic vectors γj, j = 1, . . . , n, such that α = γ1, β = γn and
(γ1, . . . , γn) is an admissible path with all γj ∈ Ω′. A loop class Ω′ ⊆ Ω is called
an essential class if, in addition, whenever α ∈ Ω′ and β ∈ Ω is a child of α, then
β ∈ Ω′. Of course, an essential class is a maximal loop class.
In [6, Lemma 6.4], Feng proved the important fact that there is always precisely
one essential class, which we will denote by Ω0. If [x] = (γ0, γ1, γ2, . . . ) with γj ∈ Ω0
for all large j, we will say that x is an essential point (or is in the essential class) and
similarly speak of a net interval being essential. A path (γj )L
j=1 is in the essential
class if all γj ∈ Ω0. We similarly speak of a point, net interval or path as being

6

K. E. HARE, K. G. HARE, M. K. S. NG

in a given loop class. The ﬁnite type property ensures that every element in the
support of µ is contained in a maximal loop class.

We remark that the essential class is dense in the support of µ. This is because
the uniqueness of the essential class ensures that every net interval contains a net
subinterval in the essential class. In Proposition 3.6 we will show that the essential
class has full µ measure and full Hausdorﬀ s-measure in K, where s is the Hausdorﬀ
dimension of K.

2.3. Transition matrices. A very important concept in the multifractal analysis
of measures of ﬁnite type are the so-called transition matrices. These are deﬁned

as follows: Let ∆ = [a, b] be a net interval of level n with parent b∆ = [c, d] . As-
sume Vn(∆) = (a1, . . . , aN ) and Vn−1(b∆) = (c1, . . . , cM ). The primitive transition
matrix, T (Cn−1(b∆), Cn(∆)), is a M × N matrix whose jk entry is given by

= pℓ

Tjk :=(cid:16)T (Cn−1(b∆),Cn(∆))(cid:17)jk

if ℓ ∈ A and there exists σ ∈ An−1 with Sσ(0) = c− ̺n−1cj and Sσℓ(0) = a− ̺nak,
and Tjk = 0 otherwise. We note that in [11] the transition matrices are normalized
so that the minimal non-zero entry is 1. That is, we used p−1
∗ T instead of T , where
p∗ = min pj.
We observe that each column of a primitive transition matrix has at least one
non-zero entry. The same is true for each row if suppµ = [0, 1], but not necessarily
otherwise, see Example 3.10.

Given an admissible path η = (γ1, . . . , γn), we write

T (η) = T (γ1, . . . , γn) = T (γ1, γ2) · · · T (γn−1, γn)

and refer to such a product as a transition matrix. We will say the transition matrix
T (γ1, . . . , γn) is essential if all γj are essential characteristic vectors.

By the norm of a matrix T we mean

kTk =Xjk

|Tjk| .

A matrix is called positive if all its entries are strictly positive. An admissible path
η is called positive if T (η) is a positive matrix. Here is an elementary lemma which
shows the usefulness of positivity.

Lemma 2.2. Assume A, B, C are transition matrices and B is positive.

(i) There are constants a, b > 0, depending on the matrices A and B respec-

(ii) If each row of A has a non-zero entry, then there is a constant c, depending

tively, so that kACk ≥ akCk and kABCk ≥ b kAkkCk.
on matrix C, such that kACk ≥ ckAk.

(iii) There is a constant C1 = C1(B) such that if AB is a square matrix, then

sp(AB) ≤ kABk ≤ C1sp(AB).

(iv) Suppose B is a square matrix. There is a constant C2 = C2(B) such that

sp(Bn) ≤ kBnk ≤ C2sp(Bn) for all n.

LOCAL DIMENSIONS

7

Proof. Parts (i) and (ii) follow by simply writing the expressions for kACk and
kABCk in terms of the entries of A, B, C, and noting that a transition matrix has
non-negative entries and each column has a non-zero entry.

Parts (iii) and (iv) follow as in [11, Lemma 3.15].

(cid:3)

2.4. Basic facts about of local dimensions of measures of ﬁnite type.

Deﬁnition 2.3. Given a probability measure µ, by the upper local dimension of
µ at x ∈ suppµ we mean the number

dimlocµ(x) = lim sup
r→0+

log µ([x − r, x + r])

.

log r

Replacing the lim sup by lim inf gives the lower local dimension, denoted dimlocµ(x).
If the limit exists, we call the number the local dimension of µ at x and denote
this by dimloc µ(x).

It is easy to see that

(3)

dimloc µ(x) = lim
n→∞

log µ([x − ̺n, x + ̺n])

n log ̺

for x ∈ suppµ,

and similarly for the upper and lower local dimensions.

Notation: Throughout the paper, when we write Fn ∼ Gn we mean there are

positive constants c1, c2 such that

c1Fn ≤ Gn ≤ c2Fn for all n.

To calculate local dimensions, it will be helpful to know µ(∆) for net intervals

∆.

Proposition 2.4. Let ∆n = [a, b] ∈ Fn, with Vn(∆n) = (a1, . . . , aN ). Then

µ(∆n) =

NXi=1

µ[ai, ai + ℓn(∆n)] Xσ∈An

̺−n(a−Sσ(0))=ai

pσ.

Furthermore, if [∆n] = (γ0, γ1, . . . , γn) and

Pn(∆n) =

NXi=1

X

σ∈An:̺−n(a−Sσ(0))=ai

pσ ,

then

µ(∆n) ∼ Pn(∆n) = kT (γ0, γ1, . . . , γn)k

= pn

∗ kT ∗(γ0, γ1, . . . , γn)k

where p∗ = min pj.
Proof. This follows in a similar fashion to Lemma 3.2, Corollary 3.4 and the discus-
sion prior to Corollary 3.10 of [11], noting that µ[ai, ai + ℓn(∆)] ≥ µ(S−1
σ (a, b)) >
0.
(cid:3)

The analogue of Proposition 2.4 was very useful in [11] as it was the key idea in

proving the following formula.

8

K. E. HARE, K. G. HARE, M. K. S. NG

Corollary 2.5. [11, Cor. 3.10] Suppose µ is a self-similar measure satisfying iden-
tity (2), that has support [0, 1], is of ﬁnite type and has probabilities satisfying
p0 = pm = min pj. If x ∈suppµ, then
(4)

log kT ∗([x|n])k

dimloc µ(x) =

log p0
log ̺

+ lim
n→∞

n log ̺

(5)

= lim
n→∞

log kT ([x|n])k

n log ̺

and similarly for the upper and lower local dimensions.

This corollary need not be true, however, if the assumptions of suppµ = [0, 1]
and regular probabilities, i.e., p0 = pm = min pj, are not all satisﬁed. Instead, we
proceed as follows.

Terminology: Assume {hj} = {Sσ(0), Sσ(1) : σ ∈ An} with hj < hj+1 and
suppose ∆n = [hi, hi+1] is a net interval of level n. Let ∆−n be the empty set if
(hi−1, hi) ∩ K is empty and otherwise, let ∆−n = [hi−1, hi] . Similarly, deﬁne ∆+
n
to be the net interval immediately to the right of ∆n (or the empty set), with
the understanding that if ∆n is the left or right-most net interval in Fn, then ∆−n
(respectively, ∆+
n (x) as adjacent
net intervals (even if some are the empty set).
If x belongs to the interior of ∆n(x), we put
Mn(x) = µ(∆n(x)) + µ(∆+

n ) is the empty set. We refer to ∆−n (x), ∆n(x), ∆+

n (x)) + µ(∆−n (x)).

(6)

If x is a boundary point of ∆n(x) = [hi, hi+1], we put

Mn(x) = µ(∆n(x)) + µ(∆′n(x)),

(7)
where ∆′n(x) = ∆−n (x) if x = hi and ∆′n(x) = ∆+
n (x) if x = hi+1. We will refer to
∆′n(x) as the other net interval containing x, even if it is empty and so formally
not a net interval.
Theorem 2.6. Let µ be a self-similar measure of ﬁnite type and let x ∈ K. Then

dimloc µ(x) = lim
n→∞

log Mn(x)

n log ̺

,

provided the limit exists. The lower and upper local dimensions of µ at x can be
expressed similarly in terms of lim inf and lim sup.

Proof. Assume, ﬁrst, that

dimloc µ(x) = lim
n→∞

log µ[x − ̺n, x + ̺n]

n log ̺

= D

exists.

By the ﬁnite type assumption, there are constants 0 < c < C such that c̺n <

ℓ(∆n) < C̺n for all ∆n ∈ Fn. Pick j and k such that ̺j < c and 2C < ̺−k.
and

If x is a boundary point, then for suﬃciently large n, x is an endpoint of ∆n(x)

[x − ̺n+j, x + ̺n+j] ⊆ ∆n(x) ∪ ∆′n(x) ⊆ [x − ̺n−k, x + ̺n−k],

where the notation is as in (7). If x is not a boundary point, then

[x − ̺n+j, x + ̺n+j] ⊆ ∆−n (x) ∪ ∆n(x) ∪ ∆+

n (x) ⊆ [x − ̺n−k, x + ̺n−k].

In either case,

µ[x − ̺n+j, x + ̺n+j] ≤ Mn(x) ≤ µ[x − ̺n−k, x + ̺n−k].

LOCAL DIMENSIONS

9

This in turn implies that

n (cid:19)(cid:18) log µ[x − ̺n+j, x + ̺n+j]
(cid:18) n + j

(n + j) log ̺

log Mn(x)

n log ̺

(cid:19) ≥
≥(cid:18) n − k

n (cid:19)(cid:18) log µ[x − ̺n−k, x + ̺n−k]

(n − k) log ̺

(cid:19) .

The limit of the left hand side and the right hand side both go to D, hence the
limit of the middle expression exists and is equal to D.

It follows similarly that if limn→∞ log Mn(x)/n log ρ exists, then also
.

log µ[x − ̺n, x + ̺n]

log Mn(x)

= lim
n→∞

n log ̺

dimloc µ(x) = lim
n→∞

n log ̺

The arguments for the lower and upper local dimensions are similar.

(cid:3)

2.5. Periodic points. Recall that in [11], x ∈ K is called a periodic point if x has
symbolic representation

[x] = (γ0, . . . , γJ , θ−, θ−, . . . ),

where θ is an admissible cycle (a non-trivial path with the same ﬁrst and last letter)
and θ− is the path with the last letter of θ deleted. We refer to θ as a period of
x. Boundary points are necessarily periodic and there are only countably many
periodic points. Note that a periodic point is essential if and only if it has a period
that is a path in the essential class.

If there is a choice of θ for which T (θ) is a positive matrix, we call x a positive,

periodic point.

Of course, a period for a periodic point x is not unique. For example,

if
θ = (θ1, .., θL, θ1) is a period, then so is (θ−, θ) and so is (θ2, . . . , θL, θ1, θ2). How-
ever, these diﬀerent choices for the period give the same symbolic representation
for x. But if x is a boundary point, then x may have two diﬀerent symbolic rep-
resentations, one for which [x|N ] = ∆N (x) and the other having [x|N ] = ∆′N (x),
and these two representations arise from (fundamentally) diﬀerent periods.

The notation sp(T ) means the spectral radius of the matrix T ,

sp(T ) = lim

n→∞kT nk1/n .

We note that two periods associated with the same symbolic representation for x
will have the same spectral radius. This need not be the case for periods associated
with diﬀerent symbolic representations.

Here is the analogue of [11, Proposition 4.14] when there is no assumption of

regularity.

Proposition 2.7. If x is a periodic point with period θ, then the local dimension
exists and is given by

dimloc µ(x) =

log sp(T (θ))
L(θ−) log ̺

,

where if x is a boundary point of a net interval with two diﬀerent symbolic represen-
tations given by periods θ and φ, then θ is chosen to satisfy sp(T (θ)) ≥ sp(T (φ)).
Proof. First, suppose x is a boundary periodic point with two diﬀerent symbolic
representations given by periods θ, φ and that sp(T (θ)) ≥ sp(T (φ)). There is no
loss of generality in assuming the two periods have the same lengths L = L(θ−) and

10

K. E. HARE, K. G. HARE, M. K. S. NG

pre-period path of length J. Given large n, let m = [(n − J)/L], so x has symbolic
representations

and

and

for suitable t ≤ L. From Proposition 2.4,

(γ0, γ1, . . . , γJ−1, θ−, . . . , θ−

, θ1, . . . , θt)

(γ0, γ′1, . . . , γ′J−1, φ−, . . . , φ−

, φ1, . . . , φt)

m

m

|
|

{z
}
{z
}
|
{z
{z
|
, θ1, . . . , θt)(cid:13)(cid:13)(cid:13)(cid:13)(cid:13)(cid:13)
}
|
}
{z

m

m

m

T (θ−, . . . , θ−

T (γ0, . . . , γJ−1, θ−, . . . , θ−

T (γ0, . . . , γ′J−1, φ−, . . . , φ−

µ(∆n(x)) ∼(cid:13)(cid:13)(cid:13)(cid:13)(cid:13)(cid:13)
, θ1, . . . , θt)(cid:13)(cid:13)(cid:13)(cid:13)(cid:13)(cid:13)
}
, φ1, . . . , φt)(cid:13)(cid:13)(cid:13)(cid:13)(cid:13)(cid:13)
µ(∆′n(x)) ∼(cid:13)(cid:13)(cid:13)(cid:13)(cid:13)(cid:13)
}
(cid:13)(cid:13)(T (θ))m+1(cid:13)(cid:13) ≤ (cid:13)(cid:13)(cid:13)(cid:13)(cid:13)(cid:13)
|
≤ c1(cid:13)(cid:13)(cid:13)(cid:13)(cid:13)(cid:13)
, θ1, . . . , θt)(cid:13)(cid:13)(cid:13)(cid:13)(cid:13)(cid:13)
c3(cid:13)(cid:13)(T (θ))m+1(cid:13)(cid:13) ≤ µ(∆n(x)) ≤ c4 k(T (θ))mk .
c′3(cid:13)(cid:13)(T (φ))m+1(cid:13)(cid:13) ≤ µ(∆′n(x)) ≤ c′4 k(T (φ))mk ,
c3(cid:13)(cid:13)(T (θ))m+1(cid:13)(cid:13) ≤ µ(∆n(x)) + µ(∆′n(x))

= Mn(x) ≤ 2c4 k(T (θ))mk

T (γ0, . . . , γJ , θ−, . . . , θ−

kT (θt, . . . , θL, θ1)k

m

{z

.

and consequently,

Similarly,

hence

≤ c2 k(T (θ))mk ,

Lemma 2.2 implies that there are positive constants cj, independent of n, such that

If sp(T (θ)) > sp(T (φ)), then for large enough m, k(T (θ))mk > k(T (φ))mk and

Since k(T (θ))mk1/m → sp(T (θ)), Theorem 2.6 gives

dimloc µ(x) = lim
n

log Mn(x)

n log ρ

= lim
m

log kT (θ)mk
mL log ρ

=

log sp(T (θ))

L log ρ

.

If, instead, sp(T (θ)) = sp(T (φ)), then for each n,

C1 max(cid:0)(cid:13)(cid:13)(T (θ))m+1(cid:13)(cid:13) ,(cid:13)(cid:13)(T (φ))m+1(cid:13)(cid:13)(cid:1) ≤ Mn(x) ≤ C2 max (k(T (θ))mk ,k(T (φ))mk) .

As both

log sp(T (θ))

log k(T (θ))mk

mL log ρ

,

log kT (φ))mk

mL log ρ −→m→∞

L log ρ

,

the result again follows.

If x is a boundary periodic point with only one symbolic representation, then

∆′n(x) is empty for large n and the arguments are similar, but easier.

Now, assume x is not a boundary point. Then there is no loss of generality in
assuming [x] = (γ0, . . . , γJ , θ−, θ−, . . . ) where the net interval (γ0, . . . , γJ , θ−) is in

LOCAL DIMENSIONS

11

the interior of the net interval (γ0, . . . , γJ , θ1), and θ1 is the ﬁrst letter of θ. This
ensures that (γ0, . . . , γJ , θ1) is a common ancestor of the two adjacent intervals to

that is at at most 2L levels back. More generally, (γ0, . . . , γJ , θ−, . . . , θ−

, θ1) is a

(γ0, . . . , γJ , θ1, . . . , θL, θ1, . . . , θt) for 0 ≤ t ≤ L = L(θ−),
{z

|

m

common ancestor of the two adjacent intervals to the net intervals

}

(γ0, . . . , γJ , θ−, . . . , θ−

, θ1, . . . , θL, θ1, . . . , θt) for 0 ≤ t ≤ L,

again at most 2L levels back. Thus, if

|

m

{z

}

[x|n] = (γ0, . . . , γJ , θ−, . . . , θ−
}
{z

|

m

, θ1, . . . , θL, θ1, . . . , θt),

then Mn(x) is comparable to µ(∆n(x)), with constants of comparability indepen-
dent of n. As above, there are cj > 0 so that

and the argument is completed in a similar fashion to before.

(cid:3)

c1(cid:13)(cid:13)(T (θ))m+1(cid:13)(cid:13) ≤ µ(∆n(x)) ≤ c2 k(T (θ))mk

3. Local Dimensions at Truly Essential Points

In this section we will obtain our main theoretical results on the structure of
local dimensions, analogues of those found in Section 5 of [11]. Because local
dimensions may depend on adjacent net intervals, ∆−n (x) and ∆+
n (x), rather than
only on ∆n(x), we introduce a subset of the essential class that we call the truly
essential class. We will see that this subset has full µ and Hausdorﬀ s-measure for
s = dimH K. Our main results state that under a weak technical assumption the
local dimensions at periodic points are dense in the set of (upper and lower) local
dimensions at truly essential points and that the set of local dimensions at truly
essential points is a closed interval. Furthermore, we prove that there is always
a truly essential point at which the local dimension agrees with the Hausdorﬀ
dimension of the self-similar set and we give criteria for when the measure µ is
absolutely continuous with respect to the Hausdorﬀ measure.

3.1. Truly essential points.

Deﬁnition 3.1. Suppose K is the self-similar set associated with an IFS of ﬁnite
type.

(i) We will say that x ∈ K is a boundary essential point if x is a boundary
point of ∆n(x) ∈ Fn for some n, and both ∆n(x) and the other n’th level
net interval containing x, ∆′n(x), are essential (where if ∆′n(x) is empty
we understand it to be essential).

(ii) We will say that x ∈ K is an interior essential point if x is not a
boundary point and there exists an essential net interval with x in its in-
terior.

(iii) We call x a truly essential point if it is either an interior essential point

or a boundary essential point.

12

K. E. HARE, K. G. HARE, M. K. S. NG

Obviously, truly essential points are essential and if x is in the interior of some
essential net interval, then it is truly essential. In particular, any essential point
that is not truly essential must be a boundary point. Hence there can be only
countably many of these and they are periodic.

Any point in the relative interior of the essential class (with respect to the space
K), is either contained in the interior of some essential interval, or is a boundary
essential point. Hence the relative interior of the essential class is equal to the
set of truly essential points. If the essential class is a (relatively) open set, then
the essential class coincides with the truly essential class. This is the situation,
for example, with the Bernoulli convolutions and Cantor-like measures discussed in
Sections 4 and 5. Another IFS where the set of essential points is equal to the set
of truly essential points is given in Example 3.10.

However, as the example below demonstrates, these two sets need not be equal.

Example 3.2. Consider the maps Si(x) = x/4 + di/8 with di = i for i = 0, . . . , 3,
d4 = 5, and d5 = 6. The reduced transition diagram has 4 reduced characteristic
vectors. The reduced characteristic vectors are:
• Reduced characteristic vector 1: (1, (0))
• Reduced characteristic vector 2: (1/2, (0))
• Reduced characteristic vector 3: (1/2, (0, 1/2))
• Reduced characteristic vector 4: (1/2, (1/2))

The transition maps are:

• RCV 1 → [2a, 3a, 3b, 3c, 4a, 2rb, 3d, 4b]
• RCV 2 → [2, 3a, 3b, 3c]
• RCV 3 → [3a, 3b, 3c, 3d]
• RCV 4 → [4a, 2, 3, 4b]

By this we mean, for example, that the reduced characteristic vector 1 has 8 chil-
dren. Listed in order from left to right, they are the reduced characteristic vectors
1, 2, 3, 3, 3, 4, 2, 3, 4 etc. By 3a we mean the ﬁrst occurance of the child of type 3,
3b the second, etc. If there is only one child of that type we do not need to dis-
tinquish them. It is possible that the transitions matrices are diﬀerent for diﬀerent
children of the same type. These also help to distinquish paths unamibiguously. See
Example 3.10. It is easy to see from the transition maps that the essential class is
{3a, 3b, 3c, 3d}. See Figure 1 for the transition diagram.
4a being the left most child of 4. This also has symbolic representation (1, 3c, 3d, 3d, . . . ),
3d being the right-most child of 3. One of these symbolic representations is in the
essential class, whereas the other is not. As such, this point is an essential point,
but it is not a truly essential point.

Consider the boundary periodic point x with symbolic representation (1, 4a, 4a, 4a, . . . ),

The signiﬁcance of an interior essential point x is that ∆−n (x), ∆n(x) and ∆+

n (x)
have a common essential ancestor for some n. Conversely, if ∆−n (x), ∆n(x) and
∆+
n (x) have a common essential ancestor for some n, then x belongs to the relative
interior of the essential class and thus is truly essential.

A periodic point x that is an interior essential point admits a period θ with the
property that if [x] = (γ, θ−, θ−, . . . ) and θ1 is the ﬁrst letter of θ, then the net
interval (with symbolic representation) (γ, θ) is in the interior of the net interval
(γ, θ1). We will call such a period θ truly essential. Equivalently, θ is truly essential

LOCAL DIMENSIONS

13

4

2

1

3

Essential Class

Figure 1. Transition diagram for Example 3.2

if and only if θ is a path that does not consist solely of right-most descendents or
solely of left-most descendents.

It was shown [11, Proposition 4.5] that under the assumption that the self-similar
set was an interval, the essential class had full Lebesgue measure. In fact, this is
true for the truly essential class, with Lebesgue measure replaced by either the self-
similar measure µ or the (normalized) Hausdorﬀ s-measure, where s = dimH K, as
the next Proposition shows. To prove this, we ﬁrst need some preliminary lemmas.

Lemma 3.3. There exists an integer J such that for each net interval ∆ ∈ Fn
there exists a σ ∈ AJ+n with σ([0, 1]) ⊆ ∆.
Proof. Consider a net interval ∆ ∈ Fn. As there is some x ∈ K in the interior of
∆, there is an index t and σ ∈ An+t such that σ([0, 1]) ⊆ ∆. Since σ(0) is not
isolated in K, there must be a level n + T net interval ∆0 ⊆ ∆, with left end Sσ(0).
Choose the index T minimal with this property.
Assume ∆ has symbolic representation (γ0, γ1, . . . , γn) and ∆0 has representation
(γ0, γ1, . . . , γn, . . . , γn+T ). Let ∆′ = (γ0, χ1, . . . , χm−1, γn) ∈ Fm be any other net
interval with symbolic representation ending with the same characteristic vector
γn. It will also have a descendent, ∆′0, with representation ending with the path
(γn, . . . , γn+T ). Since 0 is in the neighbour set of ∆0, the same is true for ∆′0 and
thus its left endpoint is an image of 0 under Sτ for some τ ∈ Am+T . As the pairs
(∆, ∆′) and (∆0, ∆′0) have the same ﬁnite type structure (up to normalization),
it follows that Sτ ([0, 1]) ⊆ ∆′. Hence ∆′ has the same minimal index T , in other
words, T depends only upon the ﬁnal characteristic vector associated with ∆.
As there are only ﬁnitely many characteristic vectors, we can take J to be the
(cid:3)

maximum of these indices T taken over all the characteristic vectors.

Lemma 3.4. There exists a positive constant c such that for all ∆ ∈ Fn and all n
we have c̺sn ≤ H s(∆ ∩ K) ≤ ̺sn.
Proof. Fix an n’th level net interval ∆ ∈ Fn. By construction, there exists some
σ ∈ An such that ∆ ⊆ σ([0, 1]). Then ∆ ∩ K ⊆ σ(K) and hence H s(∆ ∩ K) ≤
̺nsH s(K) = ̺ns.

14

K. E. HARE, K. G. HARE, M. K. S. NG

Choose J as in the previous lemma. Then there exists some τ ∈ An+J such that
τ ([0, 1]) ⊆ ∆. Hence τ (K) ⊆ ∆ ∩ K and therefore ̺(J+n)sH s(K) ≤ H s(∆ ∩ K).
Taking c = ̺Js > 0, we are done.

(cid:3)

Corollary 3.5. We have dimH (∆ ∩ K) = s for all net intervals ∆.
Proof. This is immediate since 0 < H s(∆ ∩ K) < ∞.

(cid:3)

Proposition 3.6. Suppose µ is a self-similar measure of ﬁnite type, with support
K of Hausdorﬀ dimension s. The set of points in K that are not truly essential is
a subset of a closed set having zero µ and H s-measure.

Proof. As we already observed, every net interval contains a descendent net subin-
terval that is essential. This essential net interval contains some x ∈ K in its
interior and hence contains a further subinterval that is in its interior. For the
purposes of this proof, we will call this an interior essential net interval. The ﬁnite
type property ensures we can always ﬁnd an interior essential net subinterval within
a bounded number of generations, say at most J.

We claim that there exists some λ > 0 such that the proportion of the measure
of this net subinterval to the measure of the original interval is ≥ λ. This is because
all J’th level descendent net subintervals have comparable measure to the original
net interval. For measure H s, this property is shown in Lemma 3.4 and for the
measure µ it follows from the deﬁnition.

We now exhibit a Cantor-like construction. We begin with [0, 1]. Consider
the ﬁrst level at which there is a net interval that is interior essential. Remove the
interiors of all the net intervals of this level that are interior essential. The resulting
closed subset of [0, 1] is a ﬁnite union of closed intervals, say C1, whose measures,
either H s or µ, total at most 1− λ. We repeat the process of removing the interiors
of the interior essential net intervals at the next level at which there are interior
essential, net intervals in each of the intervals of C1. The resulting closed subset
now has measure at most (1 − λ)2.
After repeating this procedure k times one can see that the non-interior essential
points are contained in a ﬁnite union of closed intervals, denoted Ck, whose total
measure is at most (1 − λ)k. It follows that the non-interior essential points are
Ck, and this set has both µ and H s-measure 0. (cid:3)
contained in the closed set

∞Tk=1

Remark 3.7. Observe that we have actually proven that the complement of the
interior of the essential class (in K) has µ and H s-measure zero.

Another consequence of Lemma 3.4 is to obtain a new formula for the Hausdorﬀ
dimension of self-similar set of ﬁnite type.
In [19] a formula was given which
required knowing the complete transition graph. In fact, it suﬃces to know the
transition graph of the essential characteristic vectors. For the purpose of this
proof we introduce the following notation: Let γ1, . . . , γr be a complete list of the
reduced characteristic vectors. Deﬁne a r × r matrix I by (I)jk = the number of
children of γj that are of type γk. We call I the incidence matrix of the essential
class.

LOCAL DIMENSIONS

15

Proposition 3.8. Let K be a self-similar set of ﬁnite type and let I be the incidence
matrix of the essential class. Then

s = dimH K =

log(sp(I))

|log ̺|

.

Example 3.9. Consider the example Sj(x) = x/3 + bj with bj ∈ {0, 2/87, 2/3}.
This IFS has 2280 reduced characteristic vectors, hence to compute the dimension
using the full set of reduced characteristic vectors would require ﬁnding the eigenval-
ues of a 2280×2280 matrix. But there are only 2 essential vectors and the incidence
matrix of the essential class is equal to

(cid:20)2 1
1 2(cid:21) .

Using the proposition above one can easily deduce that the dimension of the self-
similar set is 1, although the set is not the full interval [0, 1].

Proof of Proposition 3.8. Choose ∆0 an essential net interval of level n0 with the
property that all essential characteristic vectors are descendents of ∆0 at level
N + n0. It can be seen from the proof of Lemma 6.4 of [6] that such a net interval
exists. For n ≥ N, let

En = {∆ ∈ Fn+n0 : ∆ ⊆ ∆0}.

From Lemma 3.4 we have (for |En| denoting the cardinality of En),

c̺sn |En| ≤ X∆∈En
0 < H s(∆0 ∩ K) = X∆∈En

H s(∆ ∩ K) ≤ C̺sn |En|

H s(∆ ∩ K) < ∞,

for positive constants c, C. Since the sets ∆ ∈ En have disjoint interiors,

thus there are positive constants A, B such that

A ≤ ̺sn |En| ≤ B for all n.

Consequently,

1

n log |En|
|log ̺|

+

log A
n log ̺ ≥ s ≥

1

n log |En|
|log ̺|

+

log B
n log ̺

.

Without loss of generality we can assume ∆0 has symbolic representation with

last letter γ1. Then |En| is the sum of the entries of row 1 of I n, so

|En| = k[1, 0, . . . , 0]I nk =(cid:13)(cid:13)[1, 0, . . . , 0]I N I n−N(cid:13)(cid:13) .

But [1, 0, . . . , 0]I N is a vector with all non-zero entries since ∆0 has all the essential

characteristic vectors as descendents at level N + n0. Hence |En| ∼(cid:13)(cid:13)I n−N(cid:13)(cid:13) and

since

|log ̺|
we deduce that this is the value of s.

1

n log(cid:13)(cid:13)I n−N(cid:13)(cid:13)

→

log(sp(I))

,

|log ̺|

(cid:3)

16

K. E. HARE, K. G. HARE, M. K. S. NG

3.2. Positive row property. Throughout the remainder of this section, we will

assume, without loss of generality, that ∆ $ b∆ whenever the net interval ∆ is a
child of b∆. To see that this assumption is without loss of generality, we note that

as µ is of ﬁnite type, there will be an integer N such that all net intervals will have
at least two descendents N levels deeper. Consider the new IFS with contractions
Si1 ◦ ··· ◦ SiN and probabilities pi1 . . . piN . This IFS gives rise to the same self-
similar measure µ. Moreover, the set of net intervals of level kN of the original
construction are precisely the level k net intervals in the new construction. This
new construction has the desired property.

In the theorems of this subsection we will also assume that the self-similar mea-
sure of ﬁnite type has the property that each essential primitive transition matrix
has a non-zero entry in each row. This is the weak technical condition referred to
in the introduction and we call it the positive row property. The property holds
automatically when the self-similar set K = [0, 1] (see [11, Sec. 3.2]), such as for
(even non-regular) Bernoulli convolutions and Cantor-like measures. This stronger
assumption is not necessary, though, as we see in Example 7.1.

The positive row property can fail to hold when K 6= [0, 1] and can even fail when
there is a positive essential transition matrix, as the example below demonstrates.

Example 3.10. Consider the self-similar measure associated with the IFS

{Sj(x) = x/3 + dj : dj = 0, 4/9, 5/9, 2/3}

I ⊆S3

and uniform probabilities. This measure is of ﬁnite type. Its support is a proper
subset of [0, 1] since (1/3, 4/9) ∩ K is empty. However, if I = [2/3, 1], then
j=0 Sj(I) and this implies that [2/3, 1] ⊆ K. Thus K has positive Lebesgue
measure. The reduced characteristic vectors are:
• Reduced characteristic vector 1: (1, (0))
• Reduced characteristic vector 2: (1/3, (0))
• Reduced characteristic vector 3: (1/3, (0, 1/3))
• Reduced characteristic vector 4: (1/3, (0, 1/3, 2/3))
• Reduced characteristic vector 5: (1/3, (1/3, 2/3))
• Reduced characteristic vector 6: (1/3, (2/3))

The transition maps are:

• RCV 1 → [1, X, 2, 3, 4, 5, 6]
• RCV 2 → [1]
• RCV 3 → [2, 3, 4]
• RCV 4 → [4, 4, 4]
• RCV 5 → [4, 4, 4]
• RCV 6 → [4, 5, 6]

The ‘X’ denotes that between the child of type 1 and the child of type 2, in the
parent 1, there is an interval [hj, hj+1] that is not a net interval, as (hj, hj+1)∩K =
∅.
The transition diagram is shown in Figure 2. There are three (non-reduced) es-
sential characteristic vectors denoted 4a, 4b, 4c and one reduced characteristic vector
4. The primitive transition matrices for the essential class are given below. For
x = a, b, c, the matrix T (4, 4x) is any of T (4a, 4x), T (4b, 4x) or T (4c, 4x) as these
three matrices coincide. Note that T (4, 4a) has a row of zeroes, while the essential
transition matrix (T (4c, 4b)T (4b, 4b)T (4b, 4c))2 is positive. Hence this example does

LOCAL DIMENSIONS

17

1

2

3

6

5

4

Essential Class

Figure 2. Transition diagram for Example 3.10

not satisfy the positive row property, although there is a positive essential transition
matrix.

T (4, 4a) =

1
4
0
0

1
4
0
0

1
4
0
1
4

 , T (4, 4b) =

1
4
0
0

1
4
0
1
4

0
1
4
0

 , T (4, 4c) =

1
4
0
1
4

0
1
4
0

0
1
4
0



If x is an essential point, but not a truly essential point, then x cannot be in
the interior of an essential interval. This means x will be on the boundary of both
an essential net interval, ∆n(x), and a non-essential net interval, ∆′n(x), for all n
suﬃciently large. It is easy to see from the transition maps that there are no such
points. Hence the truly essential set coincides with the essential set.

3.3. Main Results. We begin by establishing the existence of special paths that
we call truly essential.

Lemma 3.11. Suppose µ is a self-similar measure of ﬁnite type satisfying the
positive row property. Given any two essential characteristic vectors, γ1, γ2, there
is a positive, essential path η = (η1, . . . , ηk), that does not consist of solely left-most
descendents, or solely right-most descendents, and having η1 = γ1 and ηk = γ2.

Proof. In Proposition 4.12 of [11] it is shown that there is an admissible essential
path η0 that begins and ends at γ1 and is positive. Since any net interval contains
an element of K in its interior, there must be an essential path, η′, beginning with
γ1 and ending at, say χ, which does not consist of solely left-most or solely right-
most descendents. Now take any essential path η′′ from χ to γ2. Put η = η0η′η′′.
This is a positive path since the product (in either order) of any positive matrix by
a matrix with a non-zero entry in each row and column is again positive.
(cid:3)

We will call a path η = (η1, . . . , , ηs), as described in the lemma above, a truly es-
sential, positive path. If ∆ = (γ0, . . . , γN , η1, . . . , ηs), then the two adjacent intervals

18

K. E. HARE, K. G. HARE, M. K. S. NG

of ∆ are both descendents of the essential interval (γ0, . . . , γN , η1). Consequently
any x whose symbolic representation begins (γ0, . . . , γN , η) is truly essential. Fur-
ther, if x is a periodic point with period θηφ for some θ and φ, then x is an interior
essential point.

Notation: For the remainder of this section, F will denote a ﬁxed, ﬁnite set
of truly essential, positive paths with the property that given any two essential
characteristic vectors, there is a path in F joining them in either order.

Theorem 3.12. Suppose µ is a self-similar measure of ﬁnite type satisfying the
positive row property. Then the set of lower local dimensions of µ at interior es-
sential, positive, periodic points is dense in the set of all local dimensions of µ at
truly essential points. A similar statement holds for the (upper) local dimensions.

Proof. We will ﬁrst assume dimloc µ(x) exists. The arguments for upper and lower
local dimensions are similar.

Step 1: To begin, we will show that if x is a boundary essential (necessarily
periodic) point, then its local dimension can be approximated by that of a truly
essential, positive, periodic point.

First, suppose x has two diﬀerent symbolic representations, say

(γ0, γ1, . . . , γJ , θ−, θ−, . . . ) and (γ0, γ′1, . . . , γ′J ′ , φ−, φ−, . . . ).

There is no loss of generality in assuming the two periods have the same lengths
L = L(θ−) and pre-period path of length J. Without loss of generality assume that
sp(T (θ)) ≥ sp(T (φ)), so Proposition 2.7 gives

dimloc µ(x) =

log sp(T (θ))
L(θ−) log ρ

.

Let η ∈ F be a truly essential, positive path chosen so that θ−ηθ is well deﬁned.
Consider the periodic point

where ψn = (θ−, . . . , θ−

[yn] = (γ0, . . . , γJ , ψ−n , ψ−n , . . . ),
η, θ1), θ1 being the ﬁrst letter of θ. As noted above, this

|

n

{z

}

construction produces an interior essential point and therefore

dimloc µ(yn) =

log sp(T (ψn))
L(ψ−n ) log ρ

.

As η is a positive path, Lemma 2.2 implies

sp(T (ψn)) ≤ kT (ψn)k ≤ c1 k(T (θ))nk ≤ c2sp(T (θn))

and

where the constants are positive and independent of n. It follows that

sp(T (ψn)) ≥ c3 kT (ψn)k ≥ c4sp(T (θ))n,

dimloc µ(yn) =

log Cnsp(T (θ))n

(nL(θ−) + L(η)) log ρ

where the constants, Cn, are bounded above and bounded below from zero. Hence

dimloc µ(yn) =

log Cn

(nL(θ−) + L(η)) log ρ

+

log sp(T (θ))

(L(θ−) + 1

n L(η)) log ρ

LOCAL DIMENSIONS

19

log Cn

=

(nL(θ−) + L(η)) log ρ
→ dimloc µ(x) as n → ∞.

+ dimloc µ(x)

L(θ−)
L(θ−) + 1

n L(η)

The case where x has a unique representation is similar. This completes step 1.
Step 2: Now, suppose x is an interior essential point with ∆N (x) and its two
adjacent N ’th level intervals having common essential ancestor at level J. If the
symbolic representation for x begins with the path (γ0, . . . , γJ ), then for any n > N ,
all three of ∆n(x), ∆+
n (x), ∆−n (x) have symbolic representation also beginning with
(γ0, . . . , γJ ).

Without loss of generality assume

max(cid:8)µ(∆n(x)), µ(∆+

n (x)), µ(∆−n (x))(cid:9) = µ(∆+

n (x))

along a subsequence not renamed. (The other cases are similar.) Of course, then
we have

Suppose

µ(∆+

n (x)) ≤ Mn(x) ≤ 3µ(∆+

n (x)).

∆+

n (x) = (γ0, . . . , γJ , χ(n)

J+1, . . . , χ(n)
n )

and let η be a path in F joining χ(n)
will depend on n as ∆+

n to γJ . We remark here that the χ(n)

J+1, . . . , χ(n)

n

n may not be a descendent of ∆+
n−1, η)

J+1, . . . , χ(n)

θn = (γJ , χ(n)

n−1. Put

and denote by yn the interior essential, positive, periodic point with symbolic rep-
resentation

Of course,

[yn] = (γ0, . . . , γJ−1, θ−n , θ−n , . . . ).

dimloc µ(yn) =

log sp(T (θn))

L(θn) log ρ

.

Lemma 2.2 implies there is a constant c1 > 0, independent of n, such that

c1 kT (θn)k ≤ sp(T (θn)) ≤ kT (θn)k .

As L(θn) = n − J + L(η), it follows by similar reasoning to the above that
(8)

log kT (θn)k

log kT (θn)k

dimloc µ(yn) =

Cn

+

.

n log ρ → lim

n

n log ρ

n log ρ

Yet another application of Lemma 2.2 shows that

Mn(x) ≤ 3µ(∆+

n (x)) ≤ c1(cid:13)(cid:13)(cid:13)T (γ0, . . . , γJ , χ(n)

J+1, . . . , χ(n)

n , η)(cid:13)(cid:13)(cid:13) ≤ c3 kT (θn)k

≤ c2(cid:13)(cid:13)(cid:13)T (γJ , χ(n)

J+1, . . . , χ(n)

n )(cid:13)(cid:13)(cid:13)

where the constants are independent of n, and similarly
n (x)) ≥ ckT (θn)k .
Thus Mn(x) ∼ kT (θn)k and hence it follows from (8) that

Mn(x) ≥ µ(∆+

dimloc µ(x) = lim
n

log kMn(x)k

n log ρ

= lim
n

log kT (θn)k

n log ρ

= lim
n

dimloc µ(yn)

(cid:3)

20

K. E. HARE, K. G. HARE, M. K. S. NG

Theorem 3.13. Suppose µ is a self-similar measure of ﬁnite type satisfying the
positive row property. Assume (xn) are interior essential, positive, periodic points.
There there is an interior essential point x such that

dimlocµ(x) = lim sup

n

dimloc µ(xn)

dimlocµ(x) = lim inf

n

dimloc µ(xn).

Proof. This is similar to the proof of Theorem 5.5 of [11] with some technical
complications that we highlight here. To begin, suppose xn has truly essential,
positive period θn where, without loss of generality,

(cid:12)(cid:12)(cid:12)(cid:12)

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

log sp(T (θ2n))

L(θ−2n)

− lim sup

k

log sp(T (θk))

L(θ−k )

log sp(T (θ2n+1))

log sp(T (θk))

L(θ−2n+1)

− lim inf

k

L(θ−k )

1
n

,

1
n

,

(cid:12)(cid:12)(cid:12)(cid:12) <
(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

<

all even labelled paths θ−2n have the same ﬁrst letter and the same last letter, and
similarly for the odd labelled paths.

Choose truly essential, positive paths ηe and ηo, from the ﬁnite set F so that ηo
joins the last letter of an odd path to the ﬁrst letter of even path and ηe does the
opposite.

Let Ln = 2L(θ−n+1) + L(ηo) + L(ηe). Choose Cn such that for all ℓ ≤ Ln and
j > ℓ we have µ(∆j ) ≥ Cnµ(∆j−ℓ) when ∆j−ℓ ∈ Fj−ℓ is the ancestor of ∆j ∈ Fj.
Now choose kn ≥ 2 suﬃciently large so that in addition to the requirements of kn
in the proof of [11, Thm. 5.5], we also have

3 + log Cn

kn

→ 0.

Suppose x ∈ K has symbolic representation
[x] = (γ0, . . . , γJ , θ−1 , . . . , θ−1

, ηo, θ−2 , . . . , θ−2

, ηe, . . . ).

|

k1

{z

}

|

k2

{z

}

We remark that as ηe and ηo are truly essential paths, the point x is interior
essential.

Suppose

[x|j] = (γ0, . . . , γJ , θ−1 , . . . , θ−1
{z
}

|

k1

|

kn

{z

, ηo, . . . , θ−n , . . . , θ−n

, η′, (θ−n+1, θ−n+1))

where η′ is either ηoor ηe, as appropriate, and the notation (θ−n+1, θ−n+1) means any
subpath of the path θ−n+1, θ−n+1. As η′ is truly essential, ∆j (x) and its two adjacent
intervals have common ancestor

[x|j − ℓ] = (γ0, . . . , γJ , θ−1 , . . . , θ−1
}
{z
|
for some ℓ ≤ 2L(θ−n+1) + L(η′). If, instead,
[x|j] = (γ0, . . . , γJ , θ−1 , . . . , θ−1
|
{z
}

{z

|

, ηo, . . . , θ−n , . . . , θ−n

}

kn

k1

k1

, ηo, . . . , θ−n , . . . , θ−n

)

kn

{z
{z

pn

}

}

, η′, θ−n+1, . . . , θ−n+1

, (θ−n+1, η′′))

}

|

|

LOCAL DIMENSIONS

21

with 2 ≤ pn ≤ kn+1 (where we may include a subset of η′′ = ηe or ηo if pn =
kn+1 − 1), then ∆j(x) and its two adjacent intervals have common ancestor

[x|j − ℓ] = (γ0, . . . , γJ , θ−1 , . . . , θ−1
}
{z

|

k1

, ηo, . . . , η′, θ−n+1, . . . , θ−n+1

)

|

pn−1

{z

}

In either case, for all such j, there is some ℓ ≤ Ln such that ∆j−ℓ(x) is a common

where ℓ ≤ 2L(θ−n+1) + L(η′′).
ancestor of ∆j(x) and its two adjacent intervals. Since
Cnµ(∆j−ℓ(x)) ≤ µ(∆j (x)) ≤ Mj(x)

≤ µ(∆+
j (x) ∪ ∆j(x) ∪ ∆−j (x))
≤ 3µ(∆j−ℓ(x)) for all l ≤ Ln,

it will be suﬃcient to study the behaviour of the subsequences

(cid:13)(cid:13)(cid:13)(cid:13)(cid:13)(cid:13)(cid:13)

)(cid:13)(cid:13)(cid:13)(cid:13)(cid:13)(cid:13)(cid:13)

(cid:3)

}

T (γ0, . . . , γJ , θ−1 , . . . , θ−1

, ηo, . . . , η′, θ−n+1, . . . , θ−n+1

for pn ≤ kn+1 and this we do in the same manner as in [11].

|

k1

{z

}

|

pn

{z

It was shown in [11, Thm. 5.7] that the set of local dimensions at essential
points was a closed interval. Here we prove the same conclusion for the set of local
dimensions at truly essential points.

Theorem 3.14. Suppose µ is a self-similar measure of ﬁnite type satisfying the
positive row property. Let y, z be interior essential, positive, periodic points. Then
the set of local dimensions of µ at truly essential points contains the closed interval
with endpoints dimloc µ(y) and dimloc µ(z).

Proof. Let y and z have truly essential, positive periods φ and θ respectively, with
T (φ) = A and T (θ) = B. Let η1, η2 be truly essential, positive paths joining the
last letter of φ to the ﬁrst letter of θ and vice versa. Given 0 < t < 1, choose
subsequences mk, nk → ∞ such that

L(θ−)mk

L(θ−)mk + L(φ−)nk → t.

Put

T (ψk) = Bmk T (η1)Ank T (η2)

and consider a truly essential, positive, periodic point xk with period ψk. Using
Lemma 2.2 we deduce that

sp(Bmk T (η1)Ank T (η2)) ∼ sp(B)mk sp(A)nk .

Coupled with Proposition 2.7, this implies

lim
k

dimloc µ(xk) = lim
k

log sp(B)mk + log sp(A)nk
(L(θ−)mk + L(φ−)nk) log ̺

= t dimloc µ(z) + (1 − t) dimloc µ(y).

Now appeal to the previous theorem.

(cid:3)

The three theorems combine to yield the following important corollary.

22

K. E. HARE, K. G. HARE, M. K. S. NG

Corollary 3.15. Let µ be a self-similar measure of ﬁnite type satisfying the positive
row property. Let I = inf{dimloc µ(x) : x interior essential, positive, periodic} and
S = sup{dimloc µ(x) : x interior essential, positive, periodic}. Then

{dimloc µ(x) : x interior essential} = {dimloc µ(x) : x truly essential} = [I, S].

A similar statement holds for the lower and upper local dimensions.

It is worth commenting here that this need not be the case for the set of upper
local dimensions of a maximal loop class (outside of the truly essential class). An
example is given in Section 6.

Remark 3.16. In Example 3.2, the local dimension of the boundary point x with
symbolic representations (1, 4a, 4a, 4a, . . . ) and (1, 3c, 3d, 3d, . . . ) is

|log(max sp(T (4a, 4a)), sp(T (3d, 3d)))|

log 4

.

Regardless of the choice of probabilities, this local dimension is always contained
within the interval that is the set of local dimensions of truly essential points. It
would be interesting to know if there were any examples of self-similar measures of
ﬁnite type and essential points x where dimloc µ(x) is not contained in the set of
local dimensions of the truly essential points.

3.4. Local dimension and the dimension of the support. In this section we
show that, assuming the positive row property, the essential class must contain a
point x such that dimloc µ(x) = dimH (K).

Lemma 3.17. Let µ be a self-similar measure of ﬁnite type, with s = dimH K. Let
E denote the set of truly essential points and put

G1 = {x ∈ E | dimlocµ(x) > s},
G2 = {x ∈ E | dimlocµ(x) < s}.

Then µ(G1) = 0 = H s(G2).

Proof. We recall that there are only countably many boundary essential points
and every non-atomic measure assigns mass zero to a countable set. Hence the
statement will be true if and only if it is true for E= the set of interior essential
points.

Let x ∈ G1, say with dimlocµ(x) = s(1 + ε) for some ε > 0. Then there will exist

inﬁnitely many n such that

By Lemma 3.4 we have

log µ(∆n(x))

n log ̺

> s(cid:16)1 +

ε

2(cid:17) .

log H s(∆n(x))

n log ̺

lim
n

= s.

This implies that there are inﬁnitely many n such that

and therefore

log µ(∆n(x))

ε

log ̺

log ̺

>(cid:16)1 +

3(cid:17) log H s(∆n(x))
µ(∆n(x)) ≤ H s(∆n(x))H s(∆n(x))ε/3.

Deﬁne

µ(∆n(x)) ≥ bH s(∆n(x)).
1,n =[{∆ ∈ Fn : µ(∆) ≤ aH s(∆)},
2,n =[{∆ ∈ Fn : µ(∆) ≥ bH s(∆)},

Ea

Eb

Ea

Eb

1 =[n
2 =[n

Ea

1,n

Eb

2,n

LOCAL DIMENSIONS

23

Since H s(∆n) → 0 as n → ∞, it follows that for all 0 < a < 1 there exists an n
such that

In a similar way, if x ∈ G2 and b > 1, then there exists an n such that

µ(∆n(x)) ≤ aH s(∆n(x)).

The comments above show that G1 ⊆ Ea
b > 1. Put

1 for all 0 < a < 1 and G2 ⊆ Eb

2 for all

F a
1,1 = Ea

1,1, F a
2,n. Then Ea

1,n \ ∪n−1

1,n = Ea
1 is the disjoint union of the sets F a

k=1 F a

2. Further, we observe that each set F a

and similarly deﬁne F b
1,n and
similarly for Eb
1,n is a union of intervals, ∆,
with disjoint interiors and the property that µ(∆) ≤ aH s(∆). Hence σ-additivity
and the continuity of H s implies
µ(G1) ≤ µ(Ea

H s(F a

1,n)

1,k

µ(F a

1 ) ≤Xn
1,n) ≤ aXn
1 ) ≤ aH s(K) ≤ a.

= aH s(Ea

As 0 < a < 1 is arbitrary, we have that µ(G1) = 0.

Similarly

1
2) ≤
b
and as b > 1 is arbitrary, we have that H s(G2) = 0.

H s(G2) ≤ H s(Eb

2) ≤

µ(Eb

1
b

µ(K) ≤

1
b

(cid:3)

Theorem 3.18. Let µ be a self-similar measure of ﬁnite type satisfying the positive
row property. Then there exists a truly essential element x with dimloc µ(x) =
dimH K.

Proof. In fact, we will show a stronger result, that there exists an interior essential
point x such that dimloc µ(x) = dimH K.

Let E be the set of interior essential points. According to Corollary 3.15, the
set of local dimensions at the interior essential points is an interval. So it suﬃces
to show that the supremum of this interval is at least dimH K and the inﬁmum is
at most dimH K.

Assume, for a contradiction, that the inﬁmum is strictly greater than dimH K.

This implies for all x ∈ E,

dimH K < dimlocµ(x) ≤ dimlocµ(x)

and hence E ⊆ G1. This fact, combined with Proposition 3.6 and Lemma 3.17,
gives 1 = µ(E) ≤ µ(G1) = 0, a contradiction.
Similarly, if the supremum of the local dimensions of E was strictly less than
dimH K, then E ⊆ G2, and hence 1 = H s(E) ≤ H s(G2) = 0, a contradiction. (cid:3)

24

K. E. HARE, K. G. HARE, M. K. S. NG

It would be interesting to know if the set of such points has full µ measure.
Notice that Lemma 3.17 implies that this is true if µ is absolutely continuous with
respect to H s. Our next result gives conditions under which this latter statement
is true.

Proposition 3.19. Suppose µ is a self-similar measure of ﬁnite type, with dimH K =
s. Assume that the norm of any product of n essential, primitive transition matri-
ces is bounded above by C̺sn(1−εn), where supn nεn < ∞ and C > 0 is a constant.
Then µ is absolutely continuous with respect to H s.
Proof. By [18, p.35], µ ≪ H s if and only if D(x) < ∞ for µ almost all x, where

D(x) = lim inf
r→0

µ(B(x, r))
H s(B(x, r))

.

Appealing to Proposition 3.6, we see it suﬃces to prove D(x) < ∞ for all interior
essential points x. Standard arguments show it will be suﬃcient to prove

lim inf
n→∞

µ(∆n(x) ∪ ∆+
H s(∆n(x) ∪ ∆+

n (x) ∪ ∆−n (x))
n (x) ∪ ∆−n (x))

< ∞.

For x an interior essential point, choose J such that for all n suﬃciently large,
J+n(x) and ∆−J+n(x) have a common essential ancestor at level J. Thus

∆J+n(x), ∆+
for ∆′n+J (x) denoting any of ∆n+J (x) or its two adjacent net intervals,

µ(∆′n+J (x)) ∼ (cid:13)(cid:13)T (γ0, . . . , γJ , γ′J+1, . . . , γ′n+J )(cid:13)(cid:13)

∼ (cid:13)(cid:13)T (γJ, γ′J+1 . . . , γ′n+J )(cid:13)(cid:13) ≤ C̺sn(1−εn)

for a constant C not dependent on n. Here the last inequality comes from the
hypothesis of the proposition. Since Lemma 3.4 implies H s(∆n) ∼ ̺ns for any n’th
level net interval,

̺sn(1−εn)

µ(∆n(x) ∪ ∆+
H s(∆n(x) ∪ ∆+

n (x) ∪ ∆−n (x))
n (x) ∪ ∆−n (x)) ≤ lim inf

lim inf
n→∞
as sup nεn < ∞.
Remark 3.20. We note that this proposition did not require the assumption of the
positive row property. Moreover, similar arguments show that H s|suppµ is absolutely
continuous with respect to µ if the norm of any product of n essential, primitive
transition matrices is bounded below by C̺sn(1+εn), where supn nεn < ∞ and C > 0
is a constant.

< ∞

n→∞

̺ns

C

(cid:3)

In the next example the self-similar measure is mutually absolutely continuous
to Lebesgue measure restricted to suppµ and the local dimension is identical at all
the truly essential points.
Example 3.21. Consider the example Sj(x) = x/4+bj/12 where bj ∈ {0, 1, 2, 7, 8, 9}
and associate to these the probabilities p0 = p1 = p4 = p5 = 1/8, p2 = p3 = 1/4.
This measure does not have full interval support, although the support is still of
dimension one. To see this, we observe that K = [0, 5/12]∪ [7/12, 1]. There is one
reduced characteristic vector within the essential class. The four transition matrices
from this vector to itself are:
1
8
0
1
8

1
8
0
1
8

1
8
0
1
8

1
8
0
1
8

0
0
1
4

1
4
0
0

1
4
0
0

0
1
4
0

1
8
0
1
8

1
8
0
1
8

0
0
1
4

0
1
4

0  , 





 , 

 , 

LOCAL DIMENSIONS

25

We notice that all column sums of all of these matrices are exactly the same at 1/4.
Hence the norm of any n-fold product of these matrices is comparable to 4−n. This
gives that the local dimension at all truly essential points is 1 and the measure µ is
mutually absolutely continuous with respect to Lebesgue measure on its support. It
is worth observing that this is true, despite this example not satisfying the positive
row property. Note that the points outside the essential class do not necessarily
have local dimension 1. For instance dimloc µ(0) = log 8/ log 4 = 3/2.

Another illustration of this is seen in Example 5.11 where this phenomena occurs

for a Cantor-like measure, when H s is the normalized Lebesgue measure.

4. Biased Bernoulli convolutions with simple Pisot contractions

In this section we will assume µ is a Bernoulli convolution generated by the IFS

{S0(x) = ̺x, S1(x) = ̺x + (1 − ̺)}

and probabilities p, 1−p, where ̺ is the inverse of a simple Pisot number (one whose
minimal polynomial is of the form xk − xk−1 − · · · − x − 1) and 0 < p < 1. The
self-similar set is [0, 1], hence the positive row property holds for all these Bernoulli
convolutions.

Feng in [5] showed that if p = 1/2, then µ has no isolated point in its multifractal
spectrum. In contrast, we will show here that if p 6= 1/2 there is always an isolated
point, either dimloc µ(0) or dimloc µ(1), depending on whether p is less than or
greater than 1/2.

In [5, Sect. 5], Feng determined the characteristic vectors, transition graph, and
primitive transition matrices for the case p = 1/2. Using this information, it is
not diﬃcult to determine the primitive transition matrices for the general case. In
what follows, we use Feng’s notation to label the characteristic vectors as a, b, d, ci,
c1, ej fj, g, where i = 1, . . . , k and j = 1, . . . , k − 1. Here all but a, b, d are in the
essential class.

Lemma 4.1. The primitive transition matrices for the vectors in the essential class
are given by:

0

0

0

1 − p p(cid:21) ,

0

p

T (cj−1, cj) =(cid:20)p
T (ck, c1) =(cid:20) p
T (g, f1) = T (fj, fj+1) =(cid:2)p(cid:3) ,
T (g, e1) = T (fj, e1) =(cid:2)1 − p(cid:3) ,
T (g, c1) = T (ej, c1) =(cid:2)1 − p p(cid:3) ,

1 − p(cid:21) for 2 ≤ j ≤ k, T (ck, g) =(cid:20) p
1 − p(cid:21) ,
T (ck, c1) =(cid:20)1 − p
1 − p(cid:21) ,
T (fj, c1) =(cid:2)1 − p p(cid:3) for j ≤ k − 2,
T (ej, f1) =(cid:2)p(cid:3) for j ≤ k − 1
T (ej, ej+1) =(cid:2)1 − p(cid:3) for j ≤ k − 2.

Proof. We leave this as an exercise for the reader as it follows in a straight forward
manner from the information gathered in [5]. The main points to observe are
that if the i’th neighbour of a parent coincides with the j’th neighbour of a child,
then Tij = p, while if they diﬀer by (common) normalized distance 1 − ̺, then
Tij = 1 − p. We also remind the reader that for simple Pisot numbers, ρ−1, with
minimal polynomial of degree k, 1 − ̺ = ̺ − ̺k.
We illustrate this with T (cj−1, cj). From [5] it can be seen that the (normalized)
neighbours of cj are 0 and 1− ̺k−j+1, and cj is the only child of the parent cj−1. If
we renormalize so they can be compared, we see that the two 0 neighbours coincide

26

K. E. HARE, K. G. HARE, M. K. S. NG

and the non-0 neighbours diﬀer by 1− ̺. Thus T is diagonal with the entries being
p and 1 − p, respectively.

(cid:3)

Notation: Given a matrix T , denote by kTkmin the pseudo-norm

kTkmin = min

|Tij|

j Xi

where the sum is over all the rows of the matrix. That is, kTkmin is the minimal
column sum of T . Obviously, kTk ≥ kTkmin. A useful property is that kT1T2kmin ≥
kT1kmin kT2kmin.
Lemma 4.2. There exists an integer N such that if x ∈ (0, 1) then

[x] = (γ1, . . . , γM , η1, η2, . . . )

where γ1, . . . , γM are characteristic vectors, ηj are essential paths of length at most
N whose ﬁrst letter, denoted ηj,1, equals c1, c1 or f1, and

kT (ηj, ηj+1, ηj+2,1)kmin ≥ min(pL−1(1 − p), (1 − p)L−1p)

where L = L(ηj, ηj+1).

Proof. One can see from the transition maps given in [5, Sec 5.1] that the sym-
bolic representation for any x ∈ (0, 1) begins either as [x] = (a, c1, . . . ) or [x] =
(a,∗,∗, . . . ,∗, y, . . . ) where ∗ denotes (all) b′s or d′s and y is either c1, e1 or f1. In
the case when y = e1 the path must continue as (e1, . . . , ej−1, z) where z = c1 or
f1 and j ≤ k − 2, or as (e1, . . . , ek−1, f1). Whichever is the case, one can see that
each essential x must eventually admit either a (ﬁrst) c1 or f1. This will be the
ﬁrst letter of η1. Now deﬁne ηj to begin with the jth occurrence of either c1 (or c1
in Feng’s notation) or f1. We need to check that with this construction the ηj are
paths of bounded length (independent of x) and have the required property on the
pseudo-norm of the transition matrices.

First, suppose a path ηj begins with c1. Then it must continue as (c1, . . . , ck).
If ck is followed by c1 (or c1), then we stop and take (c1, . . . , ck) as ηj having
length k. Otherwise ck is followed by g and if that is followed by c1 or f1 then
ηj = (c1, . . . , ck, g) has length k + 1. The only other possibility is that g is followed
by e1, but in that case, as we saw above, the path will continue as (e2, . . . , , ej) with
j ≤ k − 1, before continuing with either c1 or f1 (necessarily with f1 if j = k − 1).
Such a path ηj has length at most k + 1 + k − 1 = 2k.
To summarize, the paths ηj that begin with c1, together with the ﬁrst letter of
ηj+1, are of the form (c1, . . . , ck) with next letter either c1 or c1, (c1, . . . , ck, g) with
next letter either c1 or f1, or (c1, . . . , ck, g, e1, . . . , ej) with j ≤ k− 1 and next letter
either c1 or f1 (necessarily f1 if j = k − 1).
The arguments are similar for the paths that begin with f1, with these paths
having length at most 2k − 2.
Now we verify the claimed pseudo-norm property. For this we apply the previous
lemma to analyze the product of the appropriate transition matrices. Of course,
any primitive transition matrix has pseudo-norm at least min(p, 1 − p).

For paths ηJ that begin with c1, we will see that even

kT (ηJ , ηJ+1,1)kmin ≥ min(cid:0)pL−1(1 − p), (1 − p)L−1p(cid:1) for L = L(ηJ )

and this will certainly imply the claim. To prove this, we consider the diﬀerent
paths individually.

LOCAL DIMENSIONS

27

Case 1: (ηJ , ηJ+1,1 ) = (c1, . . . , ck, y) with y1 = ηJ+1,1 = c1 or c1: If y = c1,

then

T (ηJ , ηJ+1,1) = T (c1, . . . , ck)T (ck, c1) =(cid:20)

pk

(1 − p)k

0

(1 − p)k−1p (cid:21)

and hence has pseudo-norm with the required lower bound. The argument when
the ﬁrst letter of ηJ+1 = c1 is similar.

Case 2: (ηJ , ηJ+1,1 ) = (c1, . . . , ck, g, y) with y = c1 or f1: If y = c1, then an

easy calculation shows

T (ηJ, ηJ+1,1) = T (c1, . . . , ck)T (ck, g)T (g, c1) =(cid:20) pk(1 − p)

(1 − p)k+1

pk+1

p(1 − p)k (cid:21) .

If y = f1, then

T (ηJ , ηJ+1,1) =(cid:20)

pk+1

(1 − p)kp (cid:21) .

The cases (ηJ , ηJ+1,1 ) = (c1, . . . , ck, g, e1, . . . , ej, y) for y = c1 or f1, or (ηJ , ηJ+1,1 ) =

(f1, . . . , fj, e1, . . . , ei, f1) are similar.

The only case where we must consider two consecutive paths, ηJ ηJ+1, are when

ηJ = (f1, . . . , fj) and either the next letter is c1 or the path continues as (f1, . . . , fj, e1, . . . , ei)
with i, j ≥ 1 and the next letter is c1. But in that case the next path, ηJ+1, is one
of the paths beginning with c1 discussed above and we already know that then
kT (ηJ+1, ηJ+2,1)kmin ≥ min(pL−1(1 − p), (1 − p)L−1p) for L = L(ηJ+1).

Combining this bound with the fact that kT (ηJ, ηJ+1,1)kmin ≥ min(pL, (1 − p)L)
for L = L(ηJ ) completes the proof.

(cid:3)

Theorem 4.3. Suppose µ is a Bernoulli convolution with contraction factor ̺ the
inverse of a simple Pisot number, and with probabilities p 6= 1 − p. Then there is
an isolated point in the set of local dimensions of µ at either 0 or 1, depending on
which of p or 1 − p is smaller.
Proof. Without loss of generality assume p < 1/2. Standard arguments show that
dimloc µ(0) = log p/ log ̺.

Consider any x ∈ (0, 1). As the set of local dimensions of boundary essential
points is contained in the set of local dimensions of interior essential points, we
can assume without loss of generality that x is an interior essential point. Write
[x] = (γ1, . . . , γM , η1, η2, . . . ) with the notation as in the previous lemma. We have
the formula

log kT (η1, η2, . . . , η2J , η2J+1,1)k

,

should the local dimension of µ at x exist.

Set Li = L(η2i−1, η2i). Then

i=1 L(ηi) log ̺

dimloc µ(x) = lim
J

kT (η1, η2, . . . , η2J , η2J+1,1)k ≥

P2J
JYi=1
≥ pPi(Li−1)(1 − p)J .
log kT (η1, η2, . . . , η2J , η2J+1,1)k = Xi

Hence

Li − J! log p + J log(1 − p),

kT (η2i−1, η2i, η2i+1,1)kmin

28

so that

K. E. HARE, K. G. HARE, M. K. S. NG

log kT (η1, η2, . . . , η2J , η2J+1,1)k

J(log(1 − p) − log p)

.

≥ log p +

i=1 Li

PJ

log p
log ̺

= dimloc µ(0).

(cid:3)

i=1 Li

PJ

But Li ≤ 2N (where N is as in the lemma), hence for any J,
log kT (η1, η2, . . . , η2J , η2J+1,1)k
log(1 − p) − log p
<

+

log p
log ̺

≤

2N log ̺

and therefore dimloc µ(x) is bounded away from dimloc µ(0).

i=1 L(ηi) log ̺

P2J

5. Cantor-like measures of Finite type

The focus of this section will be the Cantor-like self-similar sets and measures

generated by the IFS

(9)

(cid:26)Sj(x) =

1
d

x +

j
md

(d − 1) : j = 0, . . . , m(cid:27)

d x, S1(x) = 1

for integers d ≥ 2 and probabilities pj > 0, j = 0, . . . , m. The self-similar set is
the m-fold sum of the Cantor set with contraction factor 1/d, rescaled to [0, 1],
and is the full interval when m ≥ d − 1. We will assume this to be the case for
otherwise the IFS satisﬁes the open set condition and is well understood. This class
of measures includes, for example, the m-fold convolution of the uniform Cantor
measure associated with the Cantor set generated by S0(x) = 1
d x+ d−1
d .
As K = [0, 1] when m ≥ d− 1, we see that all of these examples satisfy the positive
row property.
These measures were studied by diﬀerent methods in [2] and [22] where it was
shown, for example, that {dimloc µ(x) : x ∈ (0, 1)} was a closed interval. In [11,
Sect. 7] it was shown that the essential class for any of these Cantor-like mea-
sures is (0, 1), hence all x ∈ (0, 1) are truly essential. Consequently, the fact that
{dimloc µ(x) : x ∈ (0, 1)} is a closed interval can also be deduced from our Corollary
3.15.
In this section we will establish more reﬁned information about the local di-
mensions of these measures. In particular, we give a new proof of the fact that
dimloc µ(0) (or dimloc µ(1)) is an isolated point if p0 (resp., pm) is the minimal
probability, as was shown by other methods in [2] and [22]. We give an example to
show that there need not be an isolated point if this is not the case, as well as ex-
amples of Cantor-like measures whose set of local dimensions consists of (precisely)
two points.

For this detailed analysis it is helpful to completely determine the ﬁnite type
structure of these measures. There are two cases to consider, m ≡ 0 mod(d − 1)
and m 6= 0 mod(d − 1).
Proposition 5.1. Assume µ is the self-similar Cantor-like measure of ﬁnite type
generated by the IFS (9), with m = k(d − 1) for integer k.

(i) The essential class has one reduced characteristic vector, E, with normal-
ized length 1/k and neighbour set (j/k : j = 0, . . . , k − 1). The reduced
characteristic vector E has d children, identical to itself, labelled as E(i),
i = 1, . . . , d.

(ii) There are m − k + 2 net intervals at level one with reduced characteristic

vector E. These are the intervals [ k−1

kd , k

kd ], . . . , [1 − k

kd , 1 − k−1
kd ].

LOCAL DIMENSIONS

29

(iii) The primitive transition matrix T (E, E(i)) is given by the following for-

mula: For x, y = 0, .., k − 1,

(T (E, E(i)))x,y =(cid:26) pdx−y+i−1

0

if 0 ≤ dx − y + i − 1 ≤ m
otherwise

.

Example 5.2. Consider the IFS as in (9) with d = 4 and m = 9, k = 3. The
essential class consists of the one reduced characteristic vector (1/3, (0, 1/3, 2/3)).
There are four transition matrices from E to E. They are

and

p1
p5
p9

 .

Proof of Proposition 5.1. As noted in the proof of Proposition 7.1 of [11],

p0
p4
p8

0
p3
p7

0
p2
p6



p2
p6
0

p3
p7
0

p2
p6
0

0
p3
p7

p1
p5
p9

p0
p4
p8

p0
p4
p8

p1
p5
p9

 , 
 , 
{Sσ(0) : σ ∈ An} =(cid:26) (d − 1)j
{Sσ(1) : σ ∈ An} =(cid:26) (d − 1)(j + k)
∆(j) =(cid:20) (d − 1)j

 , 
: 0 ≤ j ≤ (dn − 1)k(cid:27)
: 0 ≤ j ≤ (dn − 1)k(cid:27) .
dnk (cid:21)
(cid:21) = (cid:20) j

(d − 1)(j + 1)

,

dnk

,

dnm

j + 1

dnm

mdn

mdn

First, consider the level n net intervals that lie in [1/dn, 1 − 1/dn]. These have the
form

for j = k, . . . , k(dn − 1) − 1. They have normalized length (d − 1)/m = 1/k and
normalized neighbours as claimed in (i) of the statement of the Proposition. These
net intervals have d children,

(cid:20) (d − 1)(dj + i)

dn+1m

,

(d − 1)(dj + i + 1)

dn+1m

(cid:21) for i = 0, . . . , d − 1,

all of the same type again.

At level 1, the net intervals have the form [ j−1

dk ]. If j < k − 1, then there are
only j neighbours because j − 1 − i < 0 if i ≥ j. If j > m there are < k neighbours
because (j − 1)/dk is not an iterate of 0. All other net intervals are type E. This
proves (ii).

dk , j

Now consider the x neighbour of E(j) at level n, for 0 ≤ x ≤ k − 1, namely

Sσx (0) =

(d − 1)(j − x)

,

dnm

and the y neighbour of its i’th child, E(i), for 0 ≤ y ≤ k − 1,

Sσy (0) =

(d − 1)(dj + i − 1 − y)

dn+1m

For any 0 ≤ w ≤ m it follows that
Sσxw(0) =

(d − 1)(d(j − x) + w)

dn+1m

.

.

Hence, whenever 0 ≤ dx − y + i − 1 = w ≤ m we have Sσxw(0) = Sσy (0), and this
proves (iii).

(cid:3)

30

K. E. HARE, K. G. HARE, M. K. S. NG

Example 5.3. Suppose m = k(d − 1) is even. Then 1/2 = Sσ(0) for some
σ ∈ A and therefore 1/2 is a left endpoint of a net interval of level one, and
hence is a boundary essential point. Thereafter, 1/2 is the left endpoint of the
left-most child of the parent net interval and thus 1/2 has symbolic representa-
tion (E(m/2), E(1), E(1), . . . ). Similarly, 1/2 is also the right-most endpoint of the
right-most child of the net interval immediately to the left of this net interval. Con-
sequently, 1/2 also has symbolic representation (E(m/2)−1, E(d), E(d), . . . ).

When k = 2 (m = 2(d − 1)), for example, then T (E(1), E(1)) =(cid:20) p0
and T (E(d), E(d)) =(cid:20) pd−1

pm (cid:21), so that we have

pd−2

pd

0

0

pd−1 (cid:21)

dimloc µ(1/2) = |log(max(p0, pd−1, pm))| / log d.

Proposition 5.4. Assume µ is the self-similar Cantor-like measure of ﬁnite type
generated by the IFS (9), with m = k(d − 1) + r, 1 ≤ r ≤ d − 2.

(i) The essential class consists of two reduced characteristic vectors, E with
normalized length r/m and neighbour set (j(d − 1)/m : j = 0, . . . , k), and
F with normalized length (d−1−r)/m and neighbour set ((r+j(d−1))/m :
j = 0, . . . , k − 1).
(ii) At level one the essential net intervals are alternately E and F , beginning
with the interval [ 1
md )]
also type E. There are m − k + 1 net intervals with characteristic vector
E and m − k with characteristic vector F .
(iii) Type E has 2r + 1 children labelled (from left to right) E(1), F (2), . . . ,
E(2r+1).

d ] of type E and ending with [1− 1

d , 1− ( 1

d − r

d − r

md , 1

Type F has 2(d − r) − 1 children labelled F (1), E(2), . . . ,F 2(d−r)−1.
(iv) The non-zero entries of the primitive transition matrices are as follows:
• For i = 0, . . . , r and 0 ≤ x, y ≤ k, (T (E, E(2i+1)))xy = pdx−y+i if 0 ≤
• For i = 1, . . . , r and 0 ≤ x ≤ k, 0 ≤ y ≤ k−1, (T (E, F (2i)))xy = pdx−y+i−1
• For i = 0, . . . , d−r−1 and 0 ≤ x, y ≤ k−1, (T (F, F (2i+1)))xy = pdx+r−y+i
• For i = 1, . . . , d − r − 1 and 0 ≤ x ≤ k − 1, 0 ≤ y ≤ k, (T (F, E(2i)))xy =

dx − y + i ≤ m;
if 0 ≤ dx − y + i − 1 ≤ m;
if 0 ≤ dx + r − y + i ≤ m;
pdx+r−y+i if 0 ≤ dx + r − y + i ≤ m.

Proof. The proof is similar to the previous case, but with two characteristic vectors
arising because the iterates of 0 and 1 do not coincide. Indeed

{Sσ(1) : σ ∈ An} =(cid:26) (d − 1)(j + k) + r

mdn

: 0 ≤ j ≤ (dn − 1)k(cid:27) .

The net intervals whose left endpoint is an iterate of 0 give one characteristic vector
and those whose left endpoint is an iterate of 1 is the second. We leave the details
for the reader.
(cid:3)

Example 5.5. Suppose k = 1, m = d − 1 + r where 1 ≤ r ≤ d − 2 and m is even.
There are an odd number of net intervals at level one and by symmetry 1/2 lies at the
centre of the middle interval. This is a net interval of type F since 2(m− 1) + 1 ≡ 3
mod 4. At all other levels there are an odd number of net intervals, so again 1/2

LOCAL DIMENSIONS

31

lies at the centre of the middle one and again this is a type F, namely F (2i+1) where
i = (d− r − 1)/2, since 2(d− r) − 1 ≡ 1mod 4. As T (F (2i+1), F (2i+1)) = [pm/2], we

have dimloc µ(1/2) =(cid:12)(cid:12)log pm/2(cid:12)(cid:12) / log d.

the previous section, and also the norm

In the proof of the next result we will use the pseudo norm kTkmin, deﬁned in

kTkmax = max

|Tij|

j Xi

where the sum is over all the rows of the matrix. That is, kTkmax is the maximal
column sum of T . For matrices with non-negative values it is easy to see that

kT1T2kmin ≥ kT1kmin kT2kmin , kT1T2kmax ≤ kT1kmax kT2kmax

and

kTkmin ≤ kTk ≤ C kTkmax

where C is the number of columns of T .

Proposition 5.6. Let Pi =Pi≡j mod d pj, Pmax = max(Pi), and Pmin = min(Pi).

For any x ∈ (0, 1), we have
|log Pmax|
log d ≤ dimlocµ(x) ≤ dimlocµ(x) ≤ |log Pmin|

log d

.

Proof. From the formulas given in Proposition 5.1 and 5.4 one can see that the
column sums of an essential, primitive transition matrix T are of the form Pi.
Hence if T is a product of m essential, primitive transition matrices, then

where C is a bound for the number of columns of a primitive transition matrix.

P m
min ≤ kTk ≤ CP m

max

Since any x ∈ (0, 1) is truly essential and the set of local dimensions of bound-
ary essential points is contained in the set of local dimensions of interior essential
points (Cor. 3.15), we can assume without loss of generality that x is an interior
essential point. Hence there exists a k so that ∆k(x) is an essential net interval
and a common ancestor for ∆−n (x), ∆n(x) and ∆+
n (x) for all n ≥ k. Consequently,
µ(∆−n (x)), µ(∆n(x)) and µ(∆+
n (x)) can all be approximated by the norms of prod-
ucts of n − k primitive transition matrices within the essential class. From this the
result follows.

(cid:3)

Corollary 5.7.

(i) If p0 < Pmin, then dimloc µ(0) is an isolated point.

(ii) If m ≥ d and p0 < pj for j 6= 0, m, then dimloc µ(0) is an isolated point.

Similar statements can be made for pm and dimloc µ(1).

Proof. We have that (i) is immediate since dimloc µ(0) = | log p0|/ log d.
For (ii), one can easily check from these formulas that p0 (and pm) are never
the only non-zero entries in a column when m ≥ d. Hence the hypothesis of (i) is
satisﬁed.

(cid:3)

Remark 5.8. We remark that it is possible for (i) to be satisﬁed without p0 being
minimal. For instance, if m ≥ 2d, then every column admits at least two non-zero
entries and hence it would suﬃce to have p0 < 2pj for all j in order for dimloc µ(0)
to be an isolated point.

On the other hand, it is also possible for such a measure to have no isolated

points. Here is an example.

32

K. E. HARE, K. G. HARE, M. K. S. NG

Example 5.9. Consider the IFS {Sj(x) = x/3+j/6 : j = 0, . . . , 4} and probabilities
p0 = p4 = 1/3, p1 = p2 = p3 = 1/9. The essential class is composed of one reduced
characteristic vector, with three transition matrices from this vector to itself. The
transition matrices are

(cid:20)1/3
1/9 1/9(cid:21) , (cid:20)1/9 1/3

1/3 1/9(cid:21) , (cid:20)1/9 1/9
1/3(cid:21) .

0

0

One can check that the second matrix has 4/9 as an eigenvalue. Further, all ma-
trices have maximal column sum equal to 4/9. This gives an exact lower bound
for the set of local dimensions. One can compute that the local dimension of the
essential class, (0, 1), contains the interval I = [ log(9/4)
log 3 , 1.24] ≈ [0.738, 1.24] and is
contained in [ log(9/4)
log 3 , 2.00]. We can establish the upper bounds by explicitly ﬁnding
a point of local dimension 1.24 in the ﬁrst case, and by using the || · ||max norm
for the second case. The local dimension of the self-similar measure at the two end
points of the support is 1 and 1 ∈ I.
Corollary 5.10. If Pmax = Pmin, then {dimloc µ(x) : x ∈ (0, 1)} = {1}.

Proof. This follows from the observation that d · Pmin ≤ P Pi ≤ d · Pmax and
P Pi = 1.

Here is a family of examples of this phenomena, generalizing [11, Ex. 6.1].

(cid:3)

Example 5.11. Suppose µ is the self-similar measure associated to the IFS (9)
with m + 1 ≡ 0 mod d and pj = 1/(m + 1) for all j = 0, . . . , m ≥ d. Then

and

dimloc µ(x) = 1 for all x ∈ (0, 1)

dimloc µ(0) = dimloc µ(1) =

log(m + 1)

log d

> 1,

so the set of local dimensions is a doubleton.

Proof. The assumption that m + 1 ≡ 0 mod d ensures that each column of each
essential primitive transition matrix T has exactly k non-zero entries, where m+1 =
kd. Consequently, Pi = k/(m + 1) = 1/d for each i and the result follows from the
previous corollary.
(cid:3)

Remark 5.12. These measures are also an example of the phenomena addressed
in Proposition 3.19. The proof above shows there exists a constant C such that
d−n ≤ kTk ≤ Cd−nfor all n-fold products of primitive transition matrices. As
dimH suppµ = 1, the proposition implies µ restricted to the truly essential class is
absolutely continuous with respect to Lebesgue measure on [0, 1].

Corollary 5.13. Suppose {µn} is a sequence of Cantor-like measures, all with
contraction factor 1/d. Let P (n)
min be the maximal and minimal column
sums associated with µn. If P (n)
min → 0, then the set of local dimensions at
any x ∈ (0, 1) tends to 1.
Proof. Similar reasoning to the proof of the previous corollary shows that P (n)
1
d .

max and P (n)
max −P (n)

min, P (n)

(cid:3)

max →

LOCAL DIMENSIONS

33

Example 5.14. Let µ be the self-similar measure associated to the IFS (9) and let
µk be the k-fold convolution of µ, normalized to [0, 1]. Then

dimloc µk(x) → 1 for all x ∈ (0, 1) and dimloc µk(x) → ∞ for x = 0, 1.

To see this, let Q(x) = p0+p1x+···+pnxn. The measure µk is also a Cantor-like
measure with contraction factor 1/d. With the contractions ordered in the natural
way, the probability of the jth term, denoted p(k)
, is equal to the coeﬃcient of xj in
Q(x)k and

j

P (k)

i = Xj≡i mod d

p(k)
j =

1
d

dXj=1

Q(ζj

d)kζ−ji

d

min − P (k)

where ζd is a primitive dth root of unity. It is easy to see that Q(1) = 1 and
|Q(ζj
i → 1/d as k → ∞ for all i. This in
turn implies that P (k)
max → 0 and hence dimloc µk(x) → 1 for each x ∈ (0, 1).

d)| < 1 for j 6= d. Hence we see that P (k)

In contrast, dimloc µk(0) = lim(cid:12)(cid:12)log pk
generated by the IFS (9) and probabilities pj = 2−m(cid:0)m

Example 5.15. Suppose ν is the uniform Cantor measure associated with the IFS
{S0(x) = x/d, S1(x) = x/d + (d − 1)/d}. Then νm is the measure of ﬁnite type
about the minimum and maximum local dimensions (other than at 0, m) in [2, Thm.
6.1] for m ≤ 2d − 1.
We can extend the maximum local dimension result to m < 3(d− 1) when m− d
is odd, as follows. First, note that the column sums of essential primitive transition
matrices have the form

0(cid:12)(cid:12) / log d → ∞ and similarly for dimloc µk(1).
j(cid:1). Information was given

Pj = 2−m ∞Xk=−∞(cid:18) m
j + kd(cid:19)

and reasoning as in [2, Lem.6.2] shows that these are minimized at j =(cid:2) m−d

can assume m = 2(d − 1) + r for 1 ≤ r ≤ d − 2. Consider the periodic element x0
with period θ = (F (2i+1), F (2i+1)) for i = (d − r − 1)/2 = (m − d + 1)/2 − r. Then

2 (cid:3). We

T (F (2i+1), F (2i+1)) =" p m−d+1

p m+d+1

2

2

p m−d−1
p m+d−1

2

2

# .

The two column sums are equal and minimal among all column sums of essential
primitive transition matrices. Thus kTk ∼ kTkmin and further, this is a lower
bound on the norm of any essential primitive transition matrix. Hence dimloc µ(x0)
is maximal over all x ∈ (0, 1).

Since the column sums are maximized when j = [m/2], we deduce from Examples

5.3 and 5.5 that dimloc νm(1/2) =(cid:12)(cid:12)log pm/2(cid:12)(cid:12) / log d is minimal when m < 2(d − 1)

is even, as was also seen in [2].

6. Maximal loop classes outside the essential class

In [11], it is shown that if µ is a self-similar measure of ﬁnite type, with full
support and regular probabilities, then the set of upper (or lower) local dimensions
at points in any maximal loop class is an interval. In this section we show that this
is not true for ﬁnite type measures satisfying only the positive row property. The
example we use is a self-similar measure that would be Cantor-like, in the sense of
the previous section, if there we had allowed some probabilities to be zero.

34

K. E. HARE, K. G. HARE, M. K. S. NG

1

5

6

7

4

Essential Class

2

3

Figure 3. Transition diagram for example in Section 6

The measure µ will arise from the maps Si(x) = x/4 + di/12 with di = i for
i = 0, 1, . . . , 5, d6 = 8 and d7 = 9, and probabilities p0 = 1/2, pi = 1/14 for
i = 1, . . . , 7. The reduced transition diagram has 7 reduced characteristic vectors.
The reduced characteristic vectors are:

• Reduced characteristic vector 1: (1, (0))
• Reduced characteristic vector 2: (1/3, (0))
• Reduced characteristic vector 3: (1/3, (0, 1/3))
• Reduced characteristic vector 4: (1/3, (0, 1/3, 2/3))
• Reduced characteristic vector 5: (1/3, (1/3, 2/3))
• Reduced characteristic vector 6: (1/3, (2/3))
• Reduced characteristic vector 7: (2/3, (0, 1/3))

The maps are:

• RCV 1 → [2, 3, 4, 4, 4, 4, 5, 6, 2, 7, 6]
• RCV 2 → [2, 3, 4, 4]
• RCV 3 → [4, 4, 4, 4]
• RCV 4 → [4, 4, 4, 4]
• RCV 5 → [4, 4, 5, 6]
• RCV 6 → [2, 7, 6]
• RCV 7 → [4, 4, 4, 4, 4, 4, 5, 6]

We refer to Figure 3 for the transition diagram.
As the probabilities are not regular, the reduced transition diagram does not
contain all of the necessary information to compute the local dimension at a point,
since to calculate dimloc µ(x) we need to know about ∆−n (x), ∆+
n (x), in addition
to ∆n(x). To keep track of this information, we introduce the triple transition
diagram. Each triple consists of a net interval and its adjacent net intervals. If there
is no adjacent net interval, then we represent this with an X. The triple transition

LOCAL DIMENSIONS

35

diagram also displays the transitions from each triple to their triple children and
denotes which transitions are right or left-most descendents. See Figure 4 for the
triple transition diagram.

We deﬁne, in the obvious way, the triple loop classes, triple maximal loop classes
and the triple essential class. In this example, the set of points that are in the triple
essential class, [4, 4, 4], is the same as the set of truly essential points. To see this,
observe that if x is an interior essential point, then there exists an integer n such that
x is in the interior of the net interval ∆n(x) whose reduced characteristic vector is of
type 4. As x is not equal to the end point of ∆n(x), there will exist some k such that
∆n+k(x) and its two neighbours will all have reduced characteristic vector of type 4.
Hence [∆−n+k(x), ∆n+k(x), ∆+
n+k(x)] = [4, 4, 4]. If, instead, x is a boundary essential
point, then there exists an n such that two adjacent ∆n(x) and ∆′n(x) are the
reduced characteristic vector of type 4. In this case, regardless of which net interval
containing x we use, we see that ∆n+1(x) and its two adjacent net intervals will be
the reduced characteristic vector of type 4. Hence [∆−n+1(x), ∆n+1(x), ∆+
n+1(x)] =
[4, 4, 4]. The other inclusion is clear.

From the triple transition diagram, we can see that there are four triple max-
imal loop classes, in addition to the triple essential class. Three of these are sin-
gletons, [7, 6, X], [X, 2, 3] and [6, 2, 3]. It is very easy to compute the local dimen-
sions of these points. The ﬁnal maximal loop class is formed by the four triples
[2, 7, 6], [4, 5, 6], [5, 6, 2], [7, 6, 2] and is of positive type. See Figure 5 for the triple
transition diagram of this triple maximal loop class. We have indicated on this
diagram which of these transitions are right or left-most descendents.

We will determine the local dimension of points in this (non-singleton) triple
maximal loop. It is important to note that this triple loop class admits no left-
most descendents.

First, assume that the symbolic representation of a point x in the loop class does
not contain arbitrarily long, right-most paths, say these lengths are bounded by K.
This implies that ∆n(x) is in the interior of ∆n−K(x), hence ∆n(x), ∆+
n (x) and
∆−n (x) are all comparable to ∆n−K(x) for all n. Thus we may ignore the ∆+
n (x)
and ∆−n (x) and this allows us to use the techniques from [11] without modiﬁcation.
(We will not be able to ignore ∆+
n (x) and ∆−n (x) later, when we allow arbitrarily
long right-most paths.)

In this case, the relevant transition matrices are:

T (5, 5) = T (7, 5) =(cid:20) 1/14 1/14
1/14 1/14 (cid:21)
T (6, 7) =(cid:2) 1/14 1/14 (cid:3)

T (5, 6) = T (7, 6) =(cid:20) 1/14
1/14 (cid:21)
T (6, 6) =(cid:2) 1/14 (cid:3)

For these matrices, the minimal column sum is 1/14, and the maximal sum is
1/7. These numbers are also the eigenvalues of T (6, 6) and T (5, 5) respectively.
As we are only concerned with ∆n(x), and do not need to worry about ∆+
n (x) or
∆−n (x), we see that the standard convexity argument can be used to show that
the set of local dimensions is an interval. Consequently, such points produce the
interval

(cid:20) log 7

log 4

,

log 14

log 4 (cid:21) ≈ [1.403677461, 1.903677461]

as the set of local dimensions.

36

K. E. HARE, K. G. HARE, M. K. S. NG

[2, 7, 6]

R

[4, 5, 6]

L

[4, 4, 5]

LR

[X, 1, X]

R

[7, 6, X]

R

R

[5, 6, 2]

L

R

L

L

[7, 6, 2]

R

L

L

[6, 2, 7]

L

[X, 2, 3]

L

[6, 2, 3]

L

R

R

[3, 4, 4]

R

[2, 3, 4]

R

L

LR

[4, 4, 4]

Essential Class

Figure 4. Triple transition diagram for example in Section 6

To consider the the case when x contains arbitrarily long right-most paths, we
n (x) and ∆−n (x). We will need to know about the additional

now need to consider ∆+
transition matrices

T (2, 2) =(cid:2) 1/2 (cid:3)

T (6, 2) =(cid:2) 1/14 (cid:3)

First, consider an x whose tail consists of the right-most branch of the triples
[7, 6, 2], [7, 6, 2], [7, 6, 2], . . .. We observe in this case that ∆−n (x) is comparable to
∆n(x) as they share the common ancestor ∆n−1(x), so that µ(∆n(x)) and µ(∆−n (x))
are comparable to kT (6, 6)nk = 1/14n. We further see that ∆+
n (x) is not compa-
rable to ∆n(x), as it does not share a common ancestor a bounded number of gen-
eration back. In fact, the symbolic representation of ∆+
n (x) has tail (2, 2, 2, . . . , 2)

LOCAL DIMENSIONS

37

[2, 7, 6]

[4, 5, 6]

R

R

[5, 6, 2]

R

[7, 6, 2]

R

Figure 5. Triple transition diagram for maximal loop class for
example in Section 6

and hence µ(∆+
local dimension at x is

n (x)) is comparable to kT (2, 2)nk = 1/2n. This gives us that the

dimloc µ(x) = lim
n

= lim
n

= lim
n

= 1/2

log Mn(x)
n log 1/4
log (µ(∆−n (x)) + µ(∆n(x)) + µ(∆+

n (x))

n log 1/4

log ((1/14)n + (1/14)n + (1/2)n)

n log 1/4

Next, consider the case where x has arbitrarily long right-most paths, but not
inﬁnitely-long, right-most paths from [7, 6, 2] → [7, 6, 2]. We claim that in this case
the upper local dimension must be greater than log 7/ log 4 ∼ 1.403677461. To
see this, we note that for all n where ∆n(x) is not a right-most child of ∆n−1(x)
(which happens inﬁnitely often) the value of µ(Mn(x)) ∼ µ(∆n(x)), as µ(∆n(x)) ∼
µ(∆+
n (x)) ∼ µ(∆−n (x)). As on this subsequence we have that the lim sup must be
greater than log 7/ log 4, it follows that the set of upper local dimensions is not an
interval.

This is in contrast to the lower local dimension, where we can achieve any value

z in the intervalh 1

2 , log 14

log 4i. We will prove this by constructing an x in this maximal

loop class such that dimlocµ(x) = z.

Let A = T ((7, 6, 2), (2, 7, 6))· T ((2, 7, 6), (5, 6, 2))· T ((5, 6, 2), (7, 6, 2)) be a triple
of the transition matrices for the path through (7, 6, 2) → (2, 7, 6) →R (5, 6, 2) →R
(7, 6, 2). We note here that these transition matrices may work on the middle or
the right-most matrix of the previous transition, depending upon the nature of the
transition. Consider the path with transition matrices
Tk := T ((7, 6, 2), (7, 6, 2))n1·A·T ((7, 6, 2), (7, 6, 2))n2·A . . . A·T ((7, 6, 2), (7, 6, 2))nk.
We let x be the point in K with symbolic path limk Tk. Let Lk be the length of
Tk, that is, Lk = n1 + 2 + n2 + 2 + ··· + 2 + nk. We see that the three matrices

38

K. E. HARE, K. G. HARE, M. K. S. NG

associated with T1 are

The three matrices associated with T2 are

(cid:0)(cid:2)14−n1
(cid:0)2(cid:2)14−(n1+2 +n2)
=(cid:0)2(cid:2)14−L2
(cid:0)2k−1(cid:2)14−Lk

14−n1(cid:3) ,(cid:2)14−n1(cid:3) ,(cid:2)2−n1(cid:3)(cid:1) =(cid:0)(cid:2)14−L1

14−L1(cid:3) ,(cid:2)14−L1(cid:3) ,(cid:2)2−L1(cid:3)(cid:1) .
14−(n1+2+ n2)(cid:3) , 2(cid:2)14−(n1+2 +n2)(cid:3) ,(cid:2)2−(n2+1)14−(n1+1)(cid:3)(cid:1)
14−Lk(cid:3) , 2k−1(cid:2)14−Lk(cid:3) , 2k−2(cid:2)2−(nk+1)14−(Lk−1+1)(cid:3)(cid:1)

14−L2(cid:3) , 2(cid:2)14−L2(cid:3) ,(cid:2)2−(n2+1)14−(L1+1)(cid:3)(cid:1) .

In general, for k ≥ 2, we have that the three matrices associated to Tk are

So, on the subsequence associated to Lk we see that MLk (x) is approximately
2k−22−(nk+1)14−(Lk−1+1). Choosing the nk such that

z = lim
k→∞

log(2k−22−(nk+1)14−(Lk−1+1))

log(4−Lk)

gives that the local dimension, computing along this subsequence, is equal to z. For
2 , log 14
example taking nk ≈ log 14−z log 4
log 4 )
we see that this is always a positive constant times Lk−1.

(2z−1) log 2 Lk−1 will suﬃce. Note: so long as z ∈ ( 1

It is straightforward to see that this subsequence of lower local dimension esti-
mates gives a lower bound for the sequence, which proves the desired result. To
see this just note that if we consider a path for x of length N ∈ (Lk−1, Lk), then
MLk(x))1/Lk < MN (x))1/N .
Thus the set of lower local dimensions at points in the loop class is the interval
2 , log 14

h 1
the loop class, which is the union of the interval h log 7

log 4i. This is in contrast to the set of upper local dimensions at points in
log 4i together with the

log 4 , log 14

singleton 1/2.

7. When finite type IFS have Pisot contractions

In this section we explore the connection between ﬁnite type and Pisot contrac-
tion factors. This was motivated by Feng’s observation in [7] showing that the IFS
{Sj(x) = ̺x +j(1 − ̺)/m : j = 0, . . . , m} satisﬁes the ﬁnite type condition if and
only if ̺−1 is Pisot.
In Example 7.1, the IFS is of ﬁnite type, does not satisfy the open set condition,
but the contraction factor is not necessarily the inverse of a Pisot number. This
example also illustrates that we can have a measure of ﬁnite type whose support is
not the full interval [0, 1], yet every row of each primitive transition matrix admits
a non-zero entry. In addition, it has the interesting property that every element of
the self-similar set is truly essential.

Example 7.1. Pick any positive number ε < 1/8. Let 0 < ̺ < 1 be a root of
ε − 2x2 + 4x − 1 and consider the self-similar set K generated by the contractions
Si(x) = ̺x + di, with d0 = 0, d1 = −̺2 + ̺, d2 = ε− ̺2 + 2̺, and d3 = ε− 2̺2 + 3̺.
Consider the associated probability measure with uniform probabilities, pi = 1/4
for i = 0, . . . , 3. There are 5 reduced characteristic vectors: (1, (0)), (1 − ̺, (0)),
(̺, (0, 1− ̺)), (1− ̺, (̺)), and (1− 2̺, (̺)). Figure 6 shows the transition diagram.
The essential class are all the characteristic vectors except 1 and there are no loop
classes outside of the essential class. Hence K is the truly essential set. As this
satisﬁes the positive row property, the set of local dimensions is a closed interval.

LOCAL DIMENSIONS

39

1

2

3

5

4

Essential Class

Figure 6. Transition diagram for Example 7.1

We list below the transition matrices that are not equal to [1/4].

T (1, 3) = T (2, 3) = T (4, 3) =(cid:2) 1/4 1/4 (cid:3) , T (3, 5) =(cid:20) 1/4
1/4 (cid:21)
1/4 1/4 (cid:21) , T (3, 3) =(cid:20) 1/4 1/4
1/4 (cid:21) .

0

0

T (3, 3) =(cid:20) 1/4
log(cid:18)sp(cid:20)1/4 1/4

0

1/4(cid:21)(cid:20)1/4

1/4 1/4(cid:21)(cid:19)

0

2 log ̺

log 3+√5
32
2 log ̺

=

Using techniques similar to [11] one can show that the minimal local dimension is

and the maximal local dimension is

log(cid:18)sp(cid:20)1/4 1/4
1/4(cid:21)(cid:19)

0

log ̺

=

log 1/4
log ̺

.

The details are left to the reader.

The incidence matrix of the essential class is

I =

2 1
0 2
1 1
1 0

1 0
0 1
2 0
1 0

 .

40

K. E. HARE, K. G. HARE, M. K. S. NG

Its spectral radius is 2 + √2, thus the formula from Proposition 3.8 gives that
dimH K = log(2 + √2)/ |log ̺|.

In this example the overlap was ‘perfect’, that is, all overlaps were of the form
̺nK for some integer n, (̺ the contraction factor, K the self-similar set). But
K 6= [0, 1].
In our ﬁnal proposition we show that if the self-similar set is a full
interval and the overlaps are perfect, in this sense, then ̺ is Pisot.

Proposition 7.2. Suppose [0, 1] is the self-similar set associated with contractions
Sj, each with contraction factor ̺. Assume that, for each j, the length of the interval
Sj([0, 1])∩ Sj+1([0, 1])) is either equal to ̺kj for some integer kj or has length equal
to 0. Then ̺ is Pisot.

Proof. Assume that we have n contractions. As the self-similar set is [0, 1], we have
that

n̺ −

n−1Xi=1

̺ki = 1.

Let N = max(kj ) and q = ̺−1. Let f (z) = zN − nzN−1 and g(z) = Pj zN−kj .

Then (f + g)(q) = 0. Clearly f (n) = 0 and all other zeros of f are inside the unit
disc (namely, at 0). Further, on the unit disc |f (z)| ≥ n − 1 ≥ |g(z)|. By Rouche’s
theorem, f + g has n− 1 zeros in the closure of the unit disk and therefore its other
root, q, is a Pisot number.

(cid:3)

Remark 7.3. It would be interesting to fully understand the connection between
ﬁnite type and a Pisot contraction factor. Note that if dimH K = 1, then as
dimH K = log(sp(I))/ |log ̺|, and the incidence matrix I is integer valued, it follows
that ̺−1 is an algebraic integer.

References

[1] C. Bruggeman and K. E. Hare, Multi-fractal analysis of convolution powers of measures,

Real Anal. Exch. 38(2013), 391-408.

[2] C. Bruggeman, K. E. Hare and C. Mak, Multi-fractal spectrum of self-similar measures with

overlap, Nonlinearity 27(2014), 227-256.

[3] A-H. Fan, K-S. Lau and S-M. Ngai, Iterated function systems with overlaps, Asian J. Math.

4(2000), 527-552.

[4] D-J. Feng, Smoothness of the Lq -spectrum of self-similar measures with overlaps, J. London

Math. Soc. 68(2003), 102-118.

[5] D-J. Feng, The limited Rademacher functions and Bernoulli convolutions asociated with

Pisot numbers, Adv. in Math. 195(2005), 24-101.

[6] D-J. Feng, Lyapunov exponents for products of matrices and multifractal analysis. Part II:

General matrices, Isr. J. Math. 170(2009), 355-394.

[7] D-J. Feng, On the topology of polynomials with bounded integer coeﬃcients, to appear J. Eur.

Math. Soc., arXiv. 1109:1407

[8] D-J. Feng and K-S. Lau, Multi-fractal formalism for self-similar measures with weak separa-

tion condition, J. Math. Pures Appl. 92(2009), 407-428.

[9] D-J. Feng, K-S. Lau and X-Y. Wang, Some exceptional phenomena in multi-fractal formal-

ism: Part II, Asian J. Math. 9(2005), 473-488.

[10] D-J. Feng and E. Olivier, Multifractal analysis of the weak Gibbs measures and phase
transition-application to some Bernoulli convolutions, Ergodic Theory Dynamical Systems
23(2003), 1751-1784.

[11] K.E. Hare, K.G. Hare, K.R. Matthews, Local dimensions of measures of ﬁnite type, to appear

J. Fractal Geometry, arXiv:1504.00510

[12] K.E. Hare, K.G. Hare, K.R. Matthews, Local Dimensions of measures of ﬁnite type – sup-

plementary information, preprint 2015, arXiv:1504.00510

LOCAL DIMENSIONS

41

[13] T-Y. Hu, The local dimensions of Bernoulli convolution associated with the golden number,

Trans. Amer. Math. Soc. 349(1997), 2917-2940.

[14] T-Y. Hu and K-S. Lau, Multi-fractal structure of convolution of the Cantor measure, Adv.

App. Math. 27(2001), 1-16.

[15] K. S. Lau and S. M. Ngai, Multifractal measures and a weak separation condition, Adv.

Math. 141(1999), 45-96.

[16] K. S. Lau and S. M. Ngai, Lq -spectrum of the Bernoulli convolution associated with the

golden ratio, Studia Math. 131(1998), 225-251.

[17] K-S. Lau and X-Y. Wang, Some exceptional phenomena in multi-fractal formalism: Part I,

Asian J. Math 9(2005), 275-294.

[18] P. Mattila, Geometry of sets and measures in Euclidean spaces, Cambridge studies in ad-

vanced mathematics 44, Cambridge University Press, Cambridge, 1995.

[19] S. M. Ngai and Y. Wang, Hausdorﬀ dimension of self-similar sets with overlaps, J. London

Math. Soc. 63(2001), 655-672.

[20] N. T. Nguyen, Iterated function systems of ﬁnite type and the weak separation property, Proc.

Amer. Math. Soc. 130(2001), 483-487.

[21] A. Porzio, On the regularity of the multifractal spectrum of Bernoulli convolutions, J. Stats.

Phys. 91(1998), 17-29.

[22] P. Shmerkin, A modiﬁed multi-fractal formalism for a class of self-similar measures with

overlap, Asian J. Math 9(2005), 323-348.

Dept. of Pure Mathematics, University of Waterloo, Waterloo, Ont., N2L 3G1,

Canada

E-mail address: kehare@uwaterloo.ca

Dept. of Pure Mathematics, University of Waterloo, Waterloo, Ont., N2L 3G1,

Canada

E-mail address: kghare@uwaterloo.ca

Dept. of Pure Mathematics, University of Waterloo, Waterloo, Ont., N2L 3G1,

Canada

