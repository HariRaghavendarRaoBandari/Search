6
1
0
2

 
r
a

 

M
4
1

 
 
]
T
N
h
t
a
m

.

[
 
 

1
v
3
2
1
4
0

.

3
0
6
1
:
v
i
X
r
a

SCIENCE CHINA

Mathematics

. ARTICLES .

January 2016 Vol. 59 No. 1: 1–XX
doi: 10.1007/s11425-000-0000-0

On a Critical Case of Rallis Inner Product Formula

WU Chenyan1,∗

1Shanghai Center for Mathematical Sciences, Fudan University, 220 Handan Rd. Shanghai, 200433, China;

Email:chywu@fudan.edu.cn

Received November 17, 2014; accepted January 22, 2015; published online January 22, 2016

Abstract Let π be a genuine cuspidal representation of the metaplectic group of rank n. We consider the theta
lifts to the orthogonal group associated to a quadratic space of dimension 2n + 1. We show a case of regularised
Rallis inner product formula that relates the pairing of theta lifts to the central value of the Langlands L-function
of π twisted by a character. The bulk of this article focuses on proving a case of regularised Siegel-Weil formula,
on which the Rallis inner product formula is based and whose proof is missing in the liter ature.

Keywords

regularised Siegel-Weil formula, Rallis inner product formula, theta lift, L-function

MSC(2010)

11F27, 11F70

Citation: Chenyan WU. Rallis Inner Product Formula. Sci China Math, 2016, 59, doi: 10.1007/s11425-000-0000-0

1

Introduction

In this article we study the case of the regularised Rallis inner product formula that relates the pairing
of theta lifts to the central value of Langlands L-function. We study a case of the regularised Siegel-Weil
formula ﬁrst, as it is a key ingredient in the proof. It should be pointed out that even though this case
of Siegel-Weil formula is stated in several places, for example, in [24], a proof for the metaplectic case is
never written down and it is not clear if the proof for the symplectic case in [16] or that for the unitary
case in [8] generalises readily. We need analytic continuation of degenerate Whittaker functionals on
certain submodules Rn(Uv) of the induced representation I(χψχ, s0) at every local place. This is not yet
known for metaplectic groups at archimedean places. To work around it, we use some lengthy induction
arguments that reﬁne the arguments in [7, 10]. We take no credit in the originality of the method. This
case of the Siegel-Weil formula has already been used to prove other theorems. For example, Gan, Qiu
and Takeda [3] used it as the basis for induction in the proof of the Siegel-Weil formula in the so-called
second term range. Thus a detailed proof for this well-known case is needed. Our proof is indebted to
various work that preceded it that made clear structures and properties of various objects.

Let k be a number ﬁeld and let A be its adeles. Let U be a vector space of dimension m over k with
quadratic form Q and let r denote its Witt index. We consider the reductive dual pair H = O(U ) and

which is the nontrivial double cover of G(A). We remark that even though there is no algebraic group

G = Sp(2n) where n is the rank of the symplectic group. We use eG(A) to denote the metaplectic group
eG, we prefer writing eG(A) to ]G(A) for aesthetic reasons.
with the case m = n + 1. Let Φ be in the space of Schwartz functions S0(U n(A)) on which eG(A) × H(A)

Set s0 = (m − n − 1)/2. We review the Siegel-Weil formula in general and point out what is special

acts via the Weil representation ω. To talk about Weil representation, in fact, we need to ﬁx an additive

∗Corresponding author

c(cid:13) Science China Press and Springer-Verlag Berlin Heidelberg 2016

math.scichina.com link.springer.com

2

Wu C Sci China Math

January 2016 Vol. 59 No. 1

character ψ of k \ A. Thus ω depends on ψ, but we have suppressed it from notation. We associate to

the reader to Sec. 2 for the notation |a(g)| and any other unexplained notation in this introduction. This
section lies in the space of some induced representation IndeG(A)
χχψ| |s where P is a Siegel parabolic of G
eP (A)

the Schwartz function Φ the Siegel-Weil section fΦ(g, s) := |a(g)|s−s0 ω(g)Φ(0) for g ∈ eG(A). We refer
and tilde means taking preimage in the metaplectic group. Here the character χχψ of eP (A) is determined

by U and ψ. Form the Siegel Eisenstein series E(g, s, fΦ). It can be meromorphically continued to the
whole s-plane. Also form the theta integral I(g, Φ). The theta integral is not necessarily absolutely
convergent. Kudla and Rallis treated the regularisation of the theta integral in [16]. Their regularised
theta integral involves a complex variable s and may have a simple or double pole at s = (m − r − 1)/2.
Ichino [7] used an element in the Hecke algebra at a local place to regularise the theta integral and his
regularised theta integral IREG(g, Φ) coincides with the leading term of Kudla-Rallis’s regularised theta
integral in the range m 6 n + 1. As it is the complementary space U ′ of U that is used in [7], in fact, the
range m = dim U > n + 1 is used. We say U ′ is the complementary space of U if dim U + dim U ′ = 2n + 2
and the two vector spaces are in the same Witt tower, meaning that U ′ is U with some hyperbolic planes
stripped away or added on. Then very loosely speaking, the Siegel-Weil formula gives an identity between
the leading term of the Siegel Eisenstein series at s0 and the regularised theta integral associated to U ′.
A formulation that does not use the complementary space can be found in [24].

When the Siegel Eisenstein series and the theta integral are both absolutely convergent, Weil [23] proved
the formula in great generality. In the case where the groups under consideration are orthogonal group
and metaplectic group, Weil’s condition for absolute convergence for the theta integral is m − r > n + 1
or r = 0. The Siegel Eisenstein series E(g, s, fΦ) is absolutely convergent for Re s > (n + 1)/2. Thus
if m > 2n + 2, E(g, s, fΦ) is absolutely convergent at s0 = (m − n − 1)/2 and the theta integral is also
absolutely convergent.

Then assuming only the absolute convergence of theta integral, i.e., m− r > n + 1 or r = 0, Kudla and
Rallis in [13] and [14] proved that the analytically continued Siegel Eisenstein series is holomorphic at s0
and showed that the Siegel-Weil formula holds between the value at s0 of the Siegel Eisenstein series and
the theta integral.

In [16] Kudla and Rallis introduced the regularised theta integral to remove the requirement of absolute
convergence of the theta integral. The formula then relates the residue of Siegel Eisenstein series at s0
with the leading term of their regularised theta integral. However they worked under the condition that
m is even, in which case the Weil representation reduces to a representation of the symplectic group.
Note that here to avoid excessive complication we have excluded the split binary case which requires a
slightly diﬀerent statement. In a later paper [12, Thm. 3.1] Kudla announced the Siegel-Weil formula
for m = n + 1 without parity restriction, but he referred back to [16] for a proof of the m odd case. The
formula also appears in Yamana’s paper [24], which gives a more transparent proof for the regularised
Siegel-Weil formula, but for the case m = n + 1 he wrote down a proof only for the Siegel-Weil formula
with the Eisenstein series on the orthogonal group. Thus for our case with Eisenstein series on the
metaplectic group, there is still no explicit proof.

For m odd Ikeda in [10] proved an analogous formula. The theta integral involved is associated to the
complementary space U ′. In the case m = n + 1, U ′ is just U and the Eisenstein series is holomorphic at
s0 = 0. Ikeda’s theta integral does not require regularisation since he assumed that the complementary
space U ′ of U is anisotropic in the case n + 1 < m < 2n + 2 or that U is anisotropic in the case
m = n + 1. The method for regularising theta integral was generalised by Ichino [7] so that k is no
longer required to have a real place as in [16]. Instead of using diﬀerential operator at a real place as did
Kudla-Rallis [16], he used a Hecke operator at a ﬁnite place. In Ichino’s notation the Siegel-Weil formula
is an equation between the residue at s0 of the Siegel Eisenstein series and the regularised theta integral
IREG,Q′(g, πKπQ′
Q Φ) where Q′ is the quadratic form of the complementary space. He considered the case
where n + 1 < m 6 2n + 2 and m − r 6 n + 1 with no parity restriction on m. The interesting case
m = n + 1 with m odd is still left open. We will prove this case in Thm. 3.1.

Next we deduce the critical case of the Rallis inner product formula from this case of the Siegel-Weil

Wu C Sci China Math

January 2016 Vol. 59 No. 1

3

formula. Let G(cid:3) be the ‘doubled group’ of G. Thus it is a symplectic group of rank 2n. Let π be

has dimension 2n + 1. Via the doubling method, to compute the inner products of such theta lifts we
ultimately need to apply the regularised Siegel-Weil formula where the orthogonal group is O(U ) and

a genuine cuspidal representation of eG(A) and consider theta lifts of π from eG(A) to O(U ) where U
the metaplectic group is gG(cid:3)(A). Via [5], this leads to a central L-value. We show that the pairing of

theta lifts can be expressed in terms of the central value of the Langlands L-function of π twisted with
a character (Thm. 6.1). We also show a relation between the non-vanishing of central L-value and the
non-vanishing of theta lift in Thm. 6.4. The arithmetic inner product formula which involves the central
derivative of L-function will be part of my future work.

The idea of the proof of the regularised Siegel-Weil formula originates from [16]. We try to show the
identity by comparing the Fourier coeﬃcients of the Siegel Eisenstein series and those of the regularised
theta integral. We follow closely what was done in [7, 10]. In fact most of the arguments carry through.
Let A(g, Φ) denote the diﬀerence between E(g, s, Φ)|s=s0 and a certain multiple of IREG(g, Φ). Via the
theory of Fourier-Jacobi coeﬃcients we are able to show the vanishing of nonsingular Fourier coeﬃcients
of A can be deduced from lower rank cases. However for the case (m, r) = (3, 1), not all Fourier-Jacobi
coeﬃcients can lead to lower rank cases. Thus we need further analysis to show that the vanishing of
nonsingular Fourier coeﬃcients of A can be deduced from consideration of those Fourier-Jacobi coeﬃcients
leading to lower rank cases. We also ﬁll in some details omitted in [7]. Finally this case of the Siegel-Weil
formula coupled with doubling method enables us to show the critical case of the Rallis inner product
formula.

The structure of the article is organised as follows. After setting up necessary notation in Sec. 2, we
state the theorem of regularised Siegel-Weil formula in the so-called boundary case in Sec. 3 where we
also summarise previous results on the regularisation of theta integrals and some properties of Siegel
Eisenstein series. Then in Sec. 4 we compute the Fourier-Jacobi coeﬃcients for both regularised theta
integral and Siegel Eisenstein series. The proof of the regularised Siegel-Weil formula is done in Sec. 5
by using an induction process enabled by the Fourier-Jacobi coeﬃcients. Finally in Sec. 6 we deduce
our main result of the critical case of the Rallis inner product formula from the regularised Siegel-Weil
formula. As a result, we get a relation between non-vanishing of theta lifts and non-vanishing of certain
L-function at the critical point s = 1/2. Our future research project on the arithmetic Rallis inner
product formula will depend on this case of the Rallis inner product formula.

I would like to thank my adviser, Professor Shou-Wu Zhang, for lots of helpful conver-
Acknowledgements
sations and encouragement during the preparation of the bulk of this article. Thanks also go to Professor Dihua
Jiang for his patience with my nagging questions on the topic and for pointing out a ﬂaw in the original argument.

This work was supported by Program of Shanghai Subject Chief Scientist (#16XD1400400).

2 Notation and Preliminaries

Let k be a number ﬁeld and A its adele ring. Let U be a vector space of dimension m over k with quadratic
form Q. The associated bilinear form h·,·iQ on U is deﬁned by hx, yiQ = Q(x + y) − Q(x) − Q(y). Thus
hx, xiQ = 2Q(x). The choice is made so that our notation conforms with [11]. Let ∆Q = deth·,·iQ. It
is equal to 2m det Q in our setup. Let r denote the Witt index of U , i.e., the dimension of a maximal
isotropic subspace of U . Let H = O(U ) denote the orthogonal group of (U, Q). The action of H on U
is from the left and we view the vectors in U as column vectors. Let G = Sp2n be the symplectic group

−1n 0n(cid:1). The action of G on the symplectic space is from the
of rank n that ﬁxes the symplectic form(cid:0) 0n 1n
right. For each real or ﬁnite place v of k there is a unique non-trivial double cover eG(kv) of G(kv) and
when v ∤ ∞ and v ∤ 2, eG(kv) splits uniquely over the standard maximal compact subgroup Kv of G(kv).
of the splitting. We deﬁne eG(A) to be the quotient of the restricted product of eG(kv) with respect to

For each complex place v of k, the metaplectic double cover of G(kv) splits. Still let Kv denote the image

4

Wu C Sci China Math

January 2016 Vol. 59 No. 1

these Kv’s by the central subgroup

{z ∈ ⊕vµ2|evenly many components are −1}.

This is a non-trivial double cover of G(A). We describe more precisely the multiplication law of eG(kv).
As a set eG(kv) is isomorphic to G(kv) × µ2. Then the multiplication law on G(kv) × µ2 is given by

(g1, ζ1)(g2, ζ2) = (g1g2, cv(g1, g2)ζ1ζ2)

where cv(g1, g2) is Rao’s 2-cocycle on G(kv) with values in µ2. The deﬁnition of cv can be found in [20,
Theorem 5.3] where it is denoted by c∼. There the factor (−1,−1)
as
pointed out, for example, in Kudla’s notes [11, Remark. 4.6].

should be (−1,−1)

l(l−1)

l(l+1)

2

2

Fix a nontrivial additive character ψ of A/k and set ψS(·) = ψ(S·) for S ∈ k×. The Weil representation

ω is a representation of eG(A) × H(A) and can be realised on the space of Schwartz functions S(U n(A)).

To give explicit formulae, we set for A ∈ GLn

and for B ∈ Symn

and

m(A) =(cid:0) A 0
n(B) =(cid:0) 1 B
wn =(cid:0)

0 tA−1(cid:1) ∈ Sp2n
0 1(cid:1) ∈ Sp2n
(cid:1).

−1n

1n

Locally the Weil representation ω is characterised by the following properties (see e.g., [10, (1.1)-(1.3)] ).
For Φ ∈ S(U n(kv)), X ∈ U n(kv), A ∈ GLn(kv), B ∈ Symn(kv), ζ ∈ µ2 and h ∈ H(kv):

ωv((m(A), ζ))Φ(X) = χv(A)χψv ((A, ζ))| det A|m/2
ωv((n(B), ζ))Φ(X) = ζmψv(

tr(hX, XiQv B))Φ(X),

1
2

v Φ(XA),

ωv((w−1

n , ζ))Φ(X) = ζmγv(ψv ◦ Qv)−nF Φ(−X),
ωv(h)Φ(X) = Φ(h−1X)

(2.1)

(2.2)

(2.3)

(2.4)

where the notation is explained below.

The quantity γv(ψ ◦ Qv) denotes the Weil index of the character of second degree x 7→ ψv ◦ Qv(x) and
has values in 8-th roots of unity and as a shorthand γv(ψ) denotes the Weil index of the character of
second degree x 7→ ψv(x2). For a ∈ k×

v , deﬁne also

γv(a, ψv, 1

2

) =

γv(ψv, a
γv(ψv, 1

2

2

)
)

.

The restriction of the double cover to the Siegel-Levi subgroup is isomorphic to fGLn(kv) ∼= GLn(kv)× µ2

and the group law is given by

(g1, ζ1) · (g2, ζ2) = (g1g2, ζ1ζ2(det g1, det g2)kv )

where ( , )kv denotes the Hilbert symbol of kv. Then χψv is a character of fGLn(kv) given by

if m is odd,

)−1

χψv ((A, ζ)) =(ζγv(det A, ψv, 1

1

2

if m is even.

The symbol χv denotes the quadratic character of GLn(kv) deﬁned as follows:

χv(A) = (det A, (−1)

m(m−1)

2 ∆Qv )kv .

(2.5)

(2.6)

Wu C Sci China Math

January 2016 Vol. 59 No. 1

5

The matrix hX, XiQv has hXi, XjiQv as (i, j)-th entry if we write X = (X1, . . . , Xn) with Xi column
vectors in U (kv). The Fourier transform F Φ of Φ with respect to ψv and Qv is deﬁned to be

F Φ(X) =ZU n(kv )

ψv(trhX, Y iQv )Φ(Y )dY.

From the Weil representation we get the theta function

Θ(g, h; Φ) = Xu∈U n(k)

ω(g, h)Φ(u)

where g ∈ eG(A), h ∈ H(A) and Φ ∈ S(U n(A)). The series is absolutely convergent. Consider the theta

integral

I(g, Φ) =ZH(k) \ H(A)

Θ(g, h; Φ)dh

which may not converge. It is well-known that it is absolutely convergent for all Φ ∈ S(U n(A)) if either
r = 0 or m − r > n + 1. Thus in the case considered in this paper we will need to regularise the theta
integral unless Q is anisotropic. The regularised theta integral is a natural extension of I. It is deﬁned
in Sec. 3.1 and is denoted by IREG(g, Φ).

over N (kv), we will still use N (kv) to denote the image of N (kv) under the splitting. Also N (A) denotes

Let P be the Siegel parabolic subgroup of G and N the unipotent radical. Since eG(kv) splits uniquely
the image of N (A) under the splitting of eG(A) over N (A). Since eG(A) splits uniquely over G(k), we
also identify G(k) with its image under the splitting. For any subgroup J of G(A) we let eJ denote the
preimage of J under the projection eG(A) → G(A).
For g ∈ eG(A) decompose g as g = m(A)nk with A ∈ GLn(A), n ∈ N (A) and k ∈ eK. Set a(g) = det A

in any such decomposition of g. Even though there are many choices for a(g), the quantity |a(g)|A is
well-deﬁned. Set s0 = (m− n− 1)/2. The Siegel-Weil section associated to Φ ∈ S(U n(A)) is then deﬁned
to be

ω(g)Φ(0).
This is a section in the normalised induced representation IndeG(A)
eP (A)
of weak Siegel-Weil section.
Siegel-Weil section at s = s0.

fΦ(g, s) = |a(g)|s−s0

A

A. We introduce also the notion
It is a section of the induced representation such that it agrees with a

χχψ| |s

Now we deﬁne the Eisenstein series

E(g, s, fΦ) = Xγ∈P (k) \ G(k)

fΦ(γg, s).

It is absolutely convergent for Re(s) > (n + 1)/2 and has meromorphic continuation to the whole s-plane

when Φ is eK-ﬁnite. In the case where m = n + 1, s0 is 0 and E(g, s, fΦ) is known to be holomorphic at

s = s0.

3 Statement of the Siegel-Weil Formula

Let S0(U n(A)) denote the eK-ﬁnite part of S(U n(A)). As our main concern is for U with odd dimension,

we exclude the split binary case which requires a separate treatment in the statement. We normalise the
Haar measure on H(k)\ H(A) so that it has volume 1. We will show the following
Theorem 3.1.

Assume that m = n + 1 and that U is not split binary. Then

for all Φ ∈ S0(U n(A)).

E(g, s, fΦ)|s=0 = 2IREG(g, Φ)

6

Wu C Sci China Math

January 2016 Vol. 59 No. 1

The regularised theta integral IREG will be deﬁned in Sec. 3.1. For the split binary
Remark 3.2.
case, the Siegel-Weil formula also relates the leading term of the Eisenstein series and the regularised
theta integral, but as the Eisenstein series vanishes at s = 0, the equation takes a diﬀerent form. As m
is even, it is covered by Kudla-Rallis’s result [16]. A more precise statement for the split binary case is
in [24, Proposition 5.8.(ii)]:

3.1 Regularisation of Theta Integral

∂
∂s

E(g, s, fΦ)|s=0 = 2IREG(g, Φ).

When Q is isotropic and m − r 6 n + 1, the theta integral is not necessarily absolutely convergent for all
Φ ∈ S(U n(A)). We summarise how one regularises theta integrals according to Ichino [7, Section 1]. We
make use of the notation there and explain what they are without going into too much detail.

maximal compact subgroup of G(kv). Identify KG,v with the image of the splitting. Let HG,v and HH,v

Take v a ﬁnite place of k. If v ∤ 2 then there is a canonical splitting of eG(kv) over KG,v, the standard
denote the spherical Hecke algebras of eG(kv) and H(kv):

HG,v = {α ∈ H(eG(kv)//KG,v)|α(ǫg) = ǫmα(g) for all g ∈ eG(kv)},

HH,v = H(H(kv)//KH,v)

where ǫ = (12n,−1) ∈ eG(kv).

The following is due to Ichino [7, Section 1].

Proposition 3.3.
for Φ. Then there exists a Hecke operator α ∈ HG,v satisfying the following conditions:

Assume m 6 n + 1 and r 6= 0. Fix Φ ∈ S(U n(A)) and choose a ‘good’ place v of k

1. I(g, ω(α)Φ) is absolutely convergent for all g ∈ eG(A);

2. θ(α).1 = cα.1 with cα 6= 0.

For the notion of good place please refer to [7, Page 209]. In the above proposition, θ is
Remark 3.4.
the algebra homomorphism from HG,v to HH,v such that ω(α) = ω(θ(α)) as in [7, Prop 1.1]. The trivial
representation of H(kv) is denoted by 1 here.

Deﬁnition 3.5. Deﬁne the regularised theta integral by

IREG(g, Φ) = c−1

α I(g, ω(α)Φ).

Remark 3.6.
also write IREG(g, Φ) for I(g, Φ) when Q anisotropic.

The above deﬁnition is in fact independent of the choice of v and α. To unify notation

It should be pointed out that IREG is a natural extension of I in the following sense. Let S(U n(A))abc
denote the (nonzero) subspace of S(U n(A)) consisting of all Φ’s such that I(g, Φ) is absolutely convergent
for all g. Then I deﬁnes an H(A)-invariant map

I : S(U n(A))abc → A∞(G)

where A∞(G) is the space of smooth automorphic forms on eG(A) (left-invariant by G(k)) without the
eKG-ﬁniteness condition.

[7, Lemma 1.9] Assume m 6 n + 1. Then IREG is the unique H(A)-invariant

Proposition 3.7.

extension of I to S(U n(A)).

3.2 Siegel Eisenstein Series

Now we deﬁne the Siegel Eisenstein series. Temporarily let eχ be an arbitrary character of eP (A). Let
I(eχ, s) denote the induced representation IndeG(A)
eP (A)eχ| |s. Then the holomorphic sections of I(eχ, s) are

functions f such that

Wu C Sci China Math

January 2016 Vol. 59 No. 1

7

A

1. f (g, s) is holomorphic with respect to s for each g ∈ eG(A),
2. f (pg, s) =eχ(p)|a(p)|s+(n+1)/2
f (g, s) for p ∈ eP (A) and g ∈ eG(A) and
3. f (·, s) is eKG-ﬁnite.
For f a holomorphic section of I(eχ, s) we form the Siegel Eisenstein series
E(g, s, f ) = Xγ∈P (k) \ G(k)
Note that eG(A) splits over G(k) and thus G(k) is identiﬁed with a subgroup of eG(A).
We will specialise to the case where eχ is the trivial extension from fM (A) to eP (A) of the character

χU χψ whose local versions, χU,v and χψv , are deﬁned in (2.6) and (2.5) respectively. For Φ ∈ S0(U n(A))
deﬁne the Siegel-Weil section by

f (γg, s).

fΦ(g, s) = |a(g)|s− m−n−1

2 ω(g)Φ(0).

Then fΦ is a holomorphic section of I(χU χψ, s). The Eisenstein series E(g, s, fΦ) is absolutely convergent
for Re(s) > (n+1)/2 and has meromorphic continuation to the whole s-plane. We know from the summary
given in [7, Page 216] that if m = n + 1, E(g, s, fΦ) is holomorphic at s = 0.

The following deﬁnition will be useful later.

Deﬁnition 3.8. A holomorphic section f ∈ I(χU χψ, s) is said to be a weak Siegel-Weil section asso-
ciated to Φ ∈ S(U n(A)) if f (g, m−n−1

) = ω(g)Φ(0).

2

Now we discuss some local aspects. Deﬁne similarly Iv(χU,vχψv , s) in the local cases. Fix one place
w(gw, s) be the associated Siegel-Weil section in

v. For every w 6= v, ﬁx Φ0
Iv(χU,vχψv , s) where we suppress the subscript Φ0

w ∈ S(U n(kw)) and let f 0

w to avoid clutter. Then if m = n + 1 we have a map

Iv(χU,vχψv , s) → A(G)

fv 7→ E(g, s, fv ⊗ (⊗w6=vf 0

w))|s=0.

(3.1)

It follows from verbatim from the proof of [14, Prop. 2.2] that it is eG(kv)-intertwining if v is ﬁnite or
(gv, eKG,v)-intertwining if v is archimedean.

4 Fourier-Jacobi Coeﬃcients

A key step in the proof of Siegel-Weil formula is the comparison of the nonsingular Fourier coeﬃcients
of the Eisenstein series and those of the regularised theta integral. This comparison is done recursively
by applying Fourier-Jacobi coeﬃcients.

Let B be a nonsingular matrix in Symn(k). It is easy to see that the B-th Fourier coeﬃcient of the
Eisenstein series is a product of entire degenerate Whittaker functions when m is even. This is also
known when n = 1 and m arbitrary. However in the case m odd and n 6= 1, the analytic continuation of
the degenerate Whittaker distributions in the archimedean places has not been proved. To work around
the problem Ikeda [10] used Fourier-Jacobi coeﬃcients to initiate an induction process. The vanishing of
B-th Fourier coeﬃcients can be determined from Fourier coeﬃcients of lower dimensional objects.

We generalise slightly the calculation done in [10] and ﬁll in some computation omitted in [7]. First we
introduce some subgroups of G, describe Weil representation of a certain Heisenberg group V and then
deﬁne the Fourier-Jacobi coeﬃcients of an automorphic form. The exposition closely follows that in [7].

Put

v(x, y, z) =

V =





1

x

1n−1

z
ty

y

1
−tx 1n−1



(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

x, y ∈ kn−1, z ∈ k

,



8

Wu C Sci China Math

January 2016 Vol. 59 No. 1

Z = {v(0, 0, z) ∈ V } ,
L = {v(x, 0, 0) ∈ V } ,
L∗ = {v(0, y, 0) ∈ V } ,

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)


1

1

a

c

1

1n−1

b

d

1

G1 =

N1 =







n1

1n−1

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)


n1 ∈ Symn−1

.

 a b

d! ∈ Spn−1

c

,





We will just identify L (resp. L∗) with row vectors of length n − 1. Then V is the Heisenberg group
H(W ) = W ⊕ k associated to the symplectic space W = L ⊕ L∗. Note that v(x, y, z) corresponds to the
element ((x, y), z/2) in H(W ) and that L and L∗ are transversal maximal isotropic subspaces of W . The
symplectic form on W will be denoted by h , i and it is given by
hv(x, 0, 0), v(0, y, 0)i = xty.

Temporarily we let ψ be an arbitrary nontrivial character of k \ A. The Schr¨odinger representation ω of
V (A) with central character ψ can be realised on the Schwartz space S(L(A)) and is given by [11, Lemma
2.2, Chap. I]:

ω(v(x, y, z))φ(t) = φ(t + x)ψ(

z + ht, yiW + hx, yiW )

(4.1)

1
2

for φ ∈ S(L(A)). By the Stone-von Neumann theorem, ω is irreducible and unique up to isomorphism. As

G1(A) acts on V (A), the representation ω of V (A) can be extended to a representation ω of V (A)⋊eG1(A)
on S(L(A)). See also [11, Prop. 2.3]. Let eKG1 denote the standard maximal compact subgroup of eG1(A)
and S0(L(A)) the eKG1-ﬁnite elements in S(L(A)).

For each φ ∈ S(L(A)) deﬁne the theta function

ϑ(vg1, φ) = Xt∈L(k)

ω(vg1)φ(t)

for v ∈ V (A) and g1 ∈ eG1(A). For A an automorphic form on eG(A) and φ ∈ S(L(A)), we deﬁne the
Fourier-Jacobi coeﬃcient of A, which is a function on G1(k)\eG1(A), by

A(vg1)ϑ(vg1, φ)dv.

FJφ(g1; A) =Z[V ]

Then for β ∈ Symn−1(k), we consider the β-th Fourier coeﬃcient FJφ
Let ψ be our ﬁxed additive character of k \ A again. With this setup we will use the character ψS as the
central character in the representation of the Heisenberg group discussed above and add subscripts in the
Weil representation ωS and Fourier-Jacobi coeﬃcients FJφ

S to indicate the additive character involved.

β(g1; A) of FJφ(g1; A).

As we follow a diﬀerent convention of the relation between quadratic form and bilinear form from that

of [7], to avoid confusion we state and prove the following lemma.

Lemma 4.1.
and assume that FJφ
AB = 0 where

[7, Lemma 4.1] Let S ∈ k× and β ∈ Symn−1(k). Let A be an automorphic form on eG(A),
S,β(g1; ρ(f )A) = 0 for all φ ∈ S0(L(A)) and all f in the Hecke algebra H(eG(A)). Then

B = S/2

β! .

Wu C Sci China Math

January 2016 Vol. 59 No. 1

9

Proof. For u ∈ N we set b(u) to be the upper-right block of u of size n × n and set b1(u) to be the
lower-right block of b(u) of size (n − 1) × (n − 1). For u1 ∈ N1, also set b1(u1) to be the upper-right
block of u of size (n − 1) × (n − 1). In the computation below the subscript S in FJφ
S is suppressed. We
compute

FJφ

β(g1, A)

=Z[N1]Z[V ]
=Z[L]Z[N ]
=Z[L]Z[N ] Xt∈L(k)
=Z[L] Xt∈L(k)Z[N ]
=Z[L] Xt∈L(k)Z[N ]
=ZL(A)Z[N ]

A(vu1g1)ϑ(vu1g1, φ)ψ(− tr(b1(u1)β))dvdu1

A(uxg1)ϑ(uxg1, φ)ψ(− tr(b1(u)β))dudx

A(uxg1)ωS(tuxg1)φ(0)ψ(− tr(b1(u)β))dudx

A(tuxg1)ωS(tuxg1)φ(0)ψ(− tr(b1(u)β))dudx

A(utxg1)ωS(utxg1)φ(0)ψ(− tr(b1(u)β))dudx

A(uxg1)ωS(uxg1)φ(0)ψ(− tr(b1(u)β))dudx.

If u is of the form

1n

z
y
ty w





then it follows from (4.1) and (2.2), ωS(u)φ(0) = ψS( 1

1n
2 z)φ(0). Thus we ﬁnd that FJφ

β(g1, A) is equal to

ZL(A)Z[N ]
=ZL(A)Z[N ]
=ZL(A)

A(uxg1)ωS(g1)φ(x)ψS (

1
2

z)ψ(− tr(b1(u)β))dudx

A(uxg1)ωS(g1)φ(x)ψ(− tr(b(u)B))dudx

AB(xg1)ω(g1)φ(x)dx.

Since FJφ

β(g1, A) = 0 for all g1 ∈ eG1(A) we conclude that AB(g1) = 0 for all g1 ∈ eG1(A). Then
we apply a sequence of fi ∈ H(eG(A)) that converges to the Dirac delta at g ∈ eG(A) to conclude that
AB(g) = 0 for all g ∈ eG(A).

4.1 Fourier-Jacobi coeﬃcients of the regularised theta integrals

The Fourier-Jacobi coeﬃcient of the regularised theta integrals is, by deﬁnition, given by:

FJφ

S(g1; IREG(Φ)) = c−1

α Z[V ]Z[H]

Θ(vg1, h; ω(α)Φ)ϑS(vg1, φ)dhdv.

In the computation below, it will be related to a regularised theta integral associated to a smaller
orthogonal group. We set up some notation to describe the result of the computation.

Assume that Q represents S/2. Decompose U into an orthogonal sum k ⊕ U1 such that the bilinear
form h , iQ is equal to h , iS/2 ⊕ h , iQ1 where S/2 and Q1 are quadratic forms on k and U1 respectively.
In fact S/2 is just a scalar in k× and so hx, yiS/2 = Sxy. Let H1 = O(U1). Put

Ψ(u, Φ, φ) =ZL(A)

0 u! φ(x)dx
Φ 1 x

10

Wu C Sci China Math

January 2016 Vol. 59 No. 1

for u ∈ U n−1
map:

1

i.e.,

(A) and one can check that this is a Schwartz function in u. It deﬁnes a eG1(A)-intertwining

S(U n(A)) ⊗ S(L(A)) → S(U n−1
Φ ⊗ φ 7→ Ψ(Φ, φ)

1

(A))

ωψ,Q1(g1)Ψ(Φ, φ) = Ψ(ωψ,Q(g1)Φ, ωψS (g1)φ)

for g1 ∈ eG1(A). We indicate in the subscripts what additive characters and what quadratic spaces are
used in the Weil representations. When there is no confusion, the subscripts will be dropped. Usually we
will write ωS for ωψS . Notice that on S(U n(A)) and S(U n−1
(A)) the Weil representations are associated
with the character ψ and on S(L(A)) the Weil representation is associated with the character ψS. Then
we have:

1

Proposition 4.2.

Assume m = n + 1. Suppose that β ∈ Symn−1(k) with det(β) 6= 0. Then
FJφ

IREG,β(g1, Ψ(ω(h)Φ, φ))dh

S,β(g1; IREG(Φ)) =ZH1(A) \ H(A)

if Q represents S/2. The integral on the right-hand side is absolutely convergent. If Q does not represent
S/2, FJφ

S,β(g1; IREG(Φ)) vanishes.

Proof. By the deﬁnition of Fourier-Jacobi coeﬃcients, we need to compute the following integral:

FJφ

S,β(g1; IREG(Φ))

α Z[N1]Z[V ]Z[H]

=c−1

θ(vn1g1, h0, ω(α)Φ)ϑS(vn1g1, φ)ψ(− tr b1(n1)β)dh0dvdn1.

(4.2)

Here b1(n1) is the upper-right block of n1.

Formally we exchange order of integration so that we integrate over v ﬁrst. This will be justiﬁed later.

Temporarily absorb ω(α) into Φ. We consider

Z[V ]

θ(vg1, h0, Φ)ϑS(vg1, φ)dv.

(4.3)

We expand out the action of v ∈ V (A) and observe that some terms must vanish.

Suppose v = v(x, 0, 0)v(0, y, z). Then

θ(vg1, h0, Φ)

ω(vg1, h0)Φ(t)

= Xt∈U n(k)
= Xt∈U n(k)
= Xt∈U n(k)
= Xt=(cid:16) t1 t2

1!)
ω(v(0, y, z)g1, h0)Φ(t 1 x
1!)ψ(
ω(g1, h0)Φ(t 1 x
tr ht 1 x
1!)ψ(
ω(g1, h0)Φ(t 1 x
2h t1
t3!, t1
where t1 ∈ k, t2 ∈ kn−1, t3 ∈ U1(k) and t4 ∈ U n−1

t3 t4 (cid:17)

1
2

1

1

y

1!iQ  z
1!, t 1 x
t3!iQ(z + 2xty))ψ(h t1

ty !!)
t3!, t2

t4!iQ

ty)

(k). Also we expand

ϑS(vg1, φ) = Xt∈L(k)

ωS(g1)φ(t + x)ψS(

1
2

z + hx, yi + ht, yi).

because by our decomposition of U ,

Then the stabiliser of ( 1
to

0! ,
t3! = h−1 1
 t1
0!iQ = S.
0!, 1
h 1
0 ) in H(k) is H1(k). After changing(cid:0) t2
0 h−1 1

ω(g1, 1H)Φ(h−1

0

Z[L∗]Z[L] Xh∈H1(k) \ H(k)Xt2,t4 Xt∈L(k)
× ψ(h 1
=Z[L∗]Z[L] Xh∈H1(k) \ H(k)Xt2,t4 Xt∈L(k)

0!, t2

t4!iQ

× ωS(g1)φ(t + x)ψ(St2

ty)ψS(−ht, yi)dxdy

t4(cid:1) to h−1(cid:0) t2
t4! 1 x

t4(cid:1) we ﬁnd that (4.3) is equal
1!)ωS(g1)φ(t + x)

t2

Wu C Sci China Math

January 2016 Vol. 59 No. 1

11

Thus if we integrate against z, the integral (4.3) vanishes unless

h t1
t3!, t1

t3!iQ = S.

We continue the computation assuming that Q represents S/2. By Witt’s theorem there exists some
h ∈ H(k) such that

ω(g1, 1H)Φ(h−1

0 h−1 1

0

t2

1!)
t4! 1 x

Now the integration against y vanishes unless t = t2 and we ﬁnd that the above is equal to

ty)ψS(−ht, yi)dxdy.
0 h−1 1

t4! 1 x
ω(g1, 1H1)Ψ(t4, ω(1eG(A), hh0)Φ, φ).

ω(g1, 1H)Φ(h−1

0

t

Z[L] Xh∈H1(k) \ H(k)Xt4 Xt∈L(k)
= Xh∈H1(k) \ H(k) Xt4∈U n−1

(k)

1

1!)ω(g1, 1H1)φ(t + x)dx

(4.4)

Then we consider the integration over [N1] in (4.2). This will kill those terms in (4.4) such that

ht4, t4iQ1 6= 2β. Unabsorbing ω(α) from Φ, we ﬁnd that (4.2) is equal to

c−1

α Z[H] Xh∈H1(k) \ H(k) Xt∈U n−1

1

(k),
ht,tiQ1 =2β

ω(g1, 1H1 )Ψ(t, ω(1eG(A), hh0)ω(α)Φ, φ)dh0.

(4.5)

We assume that h·,·iQ1 represents 2β, since otherwise the two expressions in the statement of the
lemma are both zero and the lemma holds trivially. As rk β = n − 1, Ωβ = {t ∈ U n−1
(k)|ht, tiQ1 = 2β}
is a single H1(k)-orbit. Fix a representative t0 of this orbit. Since the stabiliser of t0 in H1(k) is of order
2, (4.5) is equal to

1

1
2

c−1

α Z[H] Xh∈H(k)

ω(g1, 1H1)Ψ(t0, ω(1eG(A), hh0)ω(α)Φ, φ)dh0.

It can be checked that an analogue of the convergence lemma [7, Lemma 4.3] also holds for our case
and this is recorded here as Lemma 4.3 which shows that the above integral is absolutely convergent.
Thus we have justiﬁed exchanging the order of integration in FJφ
S,β(g1; IREG(Φ)). We now continue the
computation from (4.5) and ﬁnd that (4.2) is equal to

c−1

α ZH1(k) \ H(A) Xht,tiQ1 =2β

ω(g1, 1H1)Ψ(t, ω(1eG(A), h)ω(α)Φ, φ)dh

12

Wu C Sci China Math

January 2016 Vol. 59 No. 1

=c−1

α ZH1(A) \ H(A)Z[H1] Xht,tiQ1 =2β
=ZH1(A) \ H(A)Z[H1] Xht,tiQ1 =2β
=ZH1(A) \ H(A)

IREG,β(g1, Ψ(ω(1eG(A), h)Φ, φ))dh.

ω(g1, h′)Ψ(t, ω(1eG(A), h)ω(α)Φ, φ)dh′dh

ω(g1, h′)Ψ(t, ω(1eG(A), h)Φ, φ)dh′dh

Lemma 4.3.

Assume m = n + 1.

1. Let t ∈ U n(k). If rk t = n thenRH(A) ω(h)Φ(t)dh is absolutely convergent for any Φ ∈ S(U n(A)).
2. Let t1 ∈ U n−1

(k). If rk t1 = n − 1 then

1

ZH(A)

Ψ(ω(h)Φ, φ, t1)dh =ZH(A)ZL(A)

ω(h)Φ 1 x

t1! φ(x)dxdh

0

is absolutely convergent for any Φ ∈ S(U n(A)) and φ ∈ S(L(A)).

Proof. The argument in [16, pp. 59-60] also includes the case m = n + 1 and it proves (1). For (2)
consider the function on U n(A)

ϕ(u) =ZL(A)

Φ(u 1

x

1n−1!)φ(x)dx.

This integral is absolutely convergent and deﬁnes a smooth function on U n(A). Furthermore it can be
checked that ϕ ∈ S(U n(A)). Then we apply (1) to get (2).

4.2 Fourier-Jacobi coeﬃcients of the Siegel Eisenstein series

In this subsection we compute the Fourier-Jacobi coeﬃcients of the Siegel Eisenstein series

FJφ

S(g1, E(f, s)) =ZV (k) \ V (A)

E(vg1, f, s)ϑS(vg1, φ)dv.

We will show a relation between the Fourier-Jacobi coeﬃcient of the Eisenstein series and an Eisenstein
series associated to groups of lower rank. This is parallel to Prop. 4.2. Let χ1 be the character of
GLn−1(A) deﬁned analogously to χ in (2.6) except that it is associated to Q1 instead of Q. Recall
that Q1 is a certain quadratic form given at the beginning of Sec. 4.1. We may view the character χψ

as a character of fGLn−1(A) as well. Most of the computation here is due to Ikeda [10]. We show that

Lemma 4.5 holds for more cases than was shown by Ikeda and this is key for the case where (m, r) = (3, 1)
and n = 2.

Proposition 4.4.

1. For φ ∈ S0(L(A)) we have

FJφ

S(g1, E(f, s)) = Xγ∈P1(k) \ G1(k)

RS(γg1, f, s, φ)

where for Re s >> 0

RS(g1, f, s, φ) =ZL(A)ZA

f (wnv(0, y, z)wn−1g1, s)ωS(g1)φ(−y)ψS(

1
2

z)dzdy

(4.6)

is a holomorphic section of IndG1(A)
if m is even.

P1(A) (χ1, s) if m is odd and is a holomorphic section of IndeG1(A)
eP1(A)

(χ1χψ, s)

Wu C Sci China Math

January 2016 Vol. 59 No. 1

13

2. The section RS(g1, f, s, φ) is absolutely convergent for Re s > −(n−3)/2 and can be meromorphically

continued to the domain Re s > −(n − 1)/2.

3. The section RS(g1, f, s, φ) is holomorphic in Re s > −(n − 2)/2.
4. When m is odd, the section RS(g1, f, s, φ) is holomorphic in Re s > −(n − 1)/2 if S is not in the

square class of (−1)(m(m−1)/2)∆Q.

Proof. This proposition was proved in [9, Thm. 3.2, Lemma 3.3] except for the last statement which is a
reﬁnement. See also [10, Prop. 7.1].

Assume that m is odd. The unramiﬁed computation of (4.6) in [9, Pages 633–634] leads to the factors

LT (s + n

2 , χχS)

LT (2s + n)

,

where T denotes the set of ‘ramiﬁed’ places. Note that the notation m in [9] is 1. Thus when S is not in
the square class of (−1)(m(m−1)/2)∆Q, there is no pole for LT (s + n

2 , χχS).

Now we will relate RS(g1, fΦ, s, φ) to Ψ(g1, Φ, φ). First we need a lemma to integrate the ‘z-part’. We

deviate from our usual notation and let fΦ be a weak Siegel-Weil section associated to Φ ∈ S(U (A)).
Lemma 4.5.

Let n = 1 and S ∈ k×. Assume (m, r) 6= (3, 1), (2, 1) or (m, r) = (3, 1) and S not in the

ZA

square class of −∆Q. Let w =(cid:0) 0 1

−1 0(cid:1) and s0 = m
fΦ(w 1 z
is 0 if h , iQ does not represent S. If Q =(cid:16) S/2
cQZH1(A) \ H(A)

convergent integral

0

2 − 1. Then for Φ ∈ S(U (A)),

(4.7)

1! , s)ψS(z/2)dz
Q1(cid:17) then its value at s = s0 is equal to the absolutely
Φ(h−1 1

0!)dh,

(4.8)

can be meromorphically continued to the whole s-plane and is holomorphic at s = s0. Its value at s = s0

where cQ = 1 if m > 5 or (m, r) = (4, 0), (4, 1), (3, 0) and cQ = 2 if (m, r) = (2, 0).

Proof. From proof of Prop. 4.4, (4.7) is holomorphic at s = s0. (The modular character results in the
shift of s0.) Then by [19, Prop. 4.2] the two integrals are equal up to a constant which does not depend
on S. Note that (4.7) is the S/2-th Fourier coeﬃcient ES/2(g, s, fΦ) of E(g, s, fΦ) while (4.8) is the
S/2-th Fourier coeﬃcient of cQI(g, Φ) if the theta integral is absolutely convergent. When m > 5 or
(m, r) = (4, 0), (4, 1), (3, 0), (2, 0), the theta integral is absolutely convergent. Thus from the Siegel-Weil
formula for n = 1 we get that the value of cQ are as stated in the lemma.

For the cases (m, r) = (4, 2) or (3, 1), cQ is not determined in this lemma. The values
Remark 4.6.
will be shown in Prop. 5.3 to be 1. For the excluded case (m, r) = (3, 1) and S in the square class of
−∆Q, ES/2(g, s, fΦ) has a pole at s = s0. For the excluded case (m, r) = (2, 1), ES/2(g, s, fΦ) vanishes
at s = s0.

Assume m = n + 1. Also assume (m, r) 6= (2, 0), (2, 1), (3, 1) or (m, r) = (3, 1)
Proposition 4.7.
and S not in the square class of −∆Q. Let φ ∈ S0(L(A)) and fΦ(s) be the Siegel-Weil section of I(χ, s)
associated to Φ ∈ S(U n(A)). If h·,·iQ does not represent S then R(g1, fΦ, s, φ) = 0. If h·,·iQ represents
S, assume

Then

Q = S/2

Q1! .
S(g1; E(s, fΦ))|s=0 = cQZH1(A) \ H(A)

FJφ

E(g1, s, fΨ(ω(h)Φ,φ))dh|s=0

14

Wu C Sci China Math

January 2016 Vol. 59 No. 1

Proof. Embed Sp2(A) into G(A) = Sp2n(A) by

g0 = a b

d! 7→

c

a

c



1n−1

b

d

0n−1

0n−1

1n−1



and denote this embedding by ι. Also denote the lift fSp2(A) →fSp2n(A) by ι. Observe that

z

and the cocycles on both sides agree. To simplify notation temporarily set

0

wnv(0, 0, z) = ι(w 1
X = wn−1

0
ty

1n

0n

1n

y

0n−1

1!)wn−1
 wn−1g1.

Then as a function of g0 ∈fSp2(A),

is a weak Siegel-Weil section associated to

fΦ(ι(g0)X, s)

u 7→ ω(X)Φ(u, 0),

which is a Schwartz function in S(U (A)). Since we are simply restricting, the normalisation of s is diﬀerent
from that in Lemma 4.5. Then by Lemma 4.5, if h , iQ does not represent S then R(g1, f, 0, φ) = 0. If

Q1(cid:17) then using Lemma 4.5 to integrate the z-part, we ﬁnd that R(g1, fΦ, s, φ)|s=0 is equal to

Q =(cid:16) S/2

cQZL(A)ZH1(A) \ H(A)

ω(X)Φ(h−1 1

0

0

0!)ωS(g1)φ(−y)dhdy.

The action of ω(X) can be explicitly computed:

ω(X)Φ(h−1 1 0

0 !).
0 0!) = ω(g1)Φ(h−1 1 −y

0

Changing the order of integration and taking into account the deﬁnition of Ψ, we ﬁnd

R(g1, fΦ, s, φ)|s=0 = cQZH1(A) \ H(A)

ωQ1(g1)Ψ(0, ωQ(h)Φ, φ)dh,

where we put back subscripts to indicate which Weil representation is used. This proves the proposition.

The calculation relies on Lemma 4.5. Thus for the case (m, r) = (3, 1) we can only
Remark 4.8.
go down to an Eisenstein series of lower rank for certain S’s. However for the proof of the Siegel-Weil
formula in our case, this is enough.

5 Proof of Siegel-Weil Formula

First we summarise some results on irreducible submodules of the local induced representations.
In
particular we note that they are nonsingular in the sense of Howe [6]. See statement of Lemma 5.2

Wu C Sci China Math

January 2016 Vol. 59 No. 1

15

for the precise deﬁnition. We will ﬁx one place v and let only Φv vary in the diﬀerence A(g, Φ) =
E(g, s, fΦ)|s=0 − 2cQIREG(g, Φ), where cQ is as in Lemma 4.5. It will be shown in the proof of Prop. 5

that in fact those undetermined cQ’s are all 1. We may interpret A(g, Φ) as a eG(kv)-intertwining operator

from such an irreducible nonsingular submodule to the space of automorphic forms. This helps deal with
the B-th Fourier coeﬃcients of A for B not of full rank.

Fix v a ﬁnite place of k and suppress it from notation. We consider the local case. Let Rn(U ) denote

the image of the map

S(U n) → I(χψχ, s0)
Φ 7→ ω(g)Φ(0).

This map induces an isomorphism S(U n)H ∼= Rn(U ) by [18]. Let U ′ be the quadratic space with the
same dimension and determinant as U but with opposition Hasse invariant. We form also Rn(U ′). If no
such U ′ exists for reason of small dimension we just set Rn(U ′) to 0 .

Lemma 5.1. Assume m = n + 1. The eG(kv)-modules Rn(U ) and Rn(U ′) are irreducible and unitaris-
able. Moreover I(χψχ, s0) ∼= Rn(U ) ⊕ Rn(U ′),

We refer the reader to [15, Cor. 3.7] for the symplectic case and [26, Cor. 4.14] for the metaplectic
case. See also Sweet’s preprint [22] for the metaplectic case. A summary of decomposition of principal
degenerate series is given in [2, Prop. 7.2].

Lemma 5.2.

[14, Prop 3.2(ii)] Assume m = n + 1. Then Rn(U ) is a nonsingular representation of

eG(kv) in the sense of Howe [6], i.e., there exists a Schwartz function f on Symn(Fv) such that its Fourier

transform ˆf vanishes on all singular matrices in Symn(Fv) and such that the action of f on Rn(U ) is
not the zero action.

Combining the results above we are ready to show the Siegel-Weil formula. Now we are back in the
global case. Note the assumption that m = n + 1. Set A(g, Φ) = E(g, s, fΦ)|s=0 − 2cQIREG(g, Φ), where
cQ is as in Lemma 4.5.

Assume m = n + 1. Assume that U is not the split binary space. Then for

Proposition 5.3.
B ∈ Symn(k) with rank n, the Fourier coeﬃcients AB = 0.
Proof. The matrix B is always congruent to

 S/2

β!

(5.1)

for some S ∈ k× and β ∈ Symn−1(k) nonsingular. We may just consider B-th Fourier coeﬃcients for B
of the form (5.1). For (m, r) = (3, 1), we claim that we may further assume that S is not in the square

class of −∆Q. In this case B is a 2 × 2-matrix. If B =(cid:0) b1
b2! 0

then we are done already. If b1 ≡ −2∆Q and b2 6≡ −2∆Q, then
1

b2(cid:1) with b1 not in the square class of −2∆Q,
0!

1

0! b1

 0

1

1

has the desired property. Thus we just need to show that the quadratic form

q(x) = tx −2∆Q

−2∆Q! x

represents an element in k× which is not in the square class of −2∆Q. In other words we need to show
that the quadratic form

q(x) = tx 1

1! x

16

Wu C Sci China Math

January 2016 Vol. 59 No. 1

represents a non-square in k×. By [21], if we take a ∈ k×− (k×)2 which is positive under each embedding
of k into R and such that (−1, a)v = 1 for all v ∤ ∞, then a is represented by q. Taking a to be a norm
in k[√−1] which is not a square, we have proved our claim.
we assume that S is not in the square class of −2∆Q.

Then we proceed to compute B-th Fourier coeﬃcients for B of the form (5.1) and when (m, r) = (3, 1)

Q1(cid:17). Note that Q1 is still

anisotropic. Again by Prop. 4.2 and Prop. 4.7 and the induction hypothesis we conclude that AB=0.

Q1(cid:17). From Section 4 we get by Prop. 4.2 and Prop. 4.7 and the m even case FJφ

First we prove the anisotropic case r = 0. The base case m = 2 and n = 1 was proved in [19, Chapter
4]. Now for m = n + 1, we take ψS-th Fourier-Jacobi coeﬃcient of A(g, Φ) and make use of Lemma 4.1.
If h , iQ does not represent S then by Prop. 4.2 and Prop. 4.7 obviously FJφ
S,β(g1, A(·, Φ)) = 0 and
hence AB = 0. If h , iQ represents S then we can just assume that Q =(cid:16) S/2
Secondly we assume Q to be isotropic and m > 5, so h , iQ represents S. We can just assume that
Q =(cid:16) S/2
S,β(A) = 0 for
all φ ∈ S(L(A)) if the rank of β is n − 1. Then by Lemma 4.1, AB vanishes for B ∈ Symn(k) such that
det B 6= 0.
The case where m = 4 belongs to the even case and we know that the constant cQ must be 1 for
m = 4 from the even case of Siegel-Weil formula. Finally assume that Q is isotropic and m = 3. By the
assumption on S we can take ψS-th Fourier-Jacobi coeﬃcients and still use Prop. 4.7 to do induction.
Notice then Q1 must be anisotropic and we are reduced to the case (m, r) = (2, 0). For now we have shown
that for (m, r) = (3, 1), E(g, s, fΦ)|s=0 and IREG(g, Φ) are proportional. The constant of proportionality
can be computed by comparing constant terms of both expressions. The constant term of E(g, s, fΦ)|s=0
is given in [13, Lemma 2.4]

nXk=0 Xa∈Qn−k \ GL(n)ZN ′

k(A)

f (wn−kn′m(a)g, s)dn′.

Here Qn−k is the parabolic subgroup of GL(n) whose Levi has blocks of sizes k and n − k; N ′
of unipotent elements of the form n(b) with

k consists

b = 0k

0

0

b0!

where b0 is of size (n − k) × (n − k); wn−k is the Weyl element
0

0

0

1k
0



0

0

0
0 −1n−k

0

1k
0

1n−k

0

0

.



Since the metaplectic group splits over N (A), the computation for symplectic group carries through.
Denote the k-th term by Ek(g, s, f ) and restrict it to the subgroup m(GL(n, A)), so it becomes a function
on GL(n, A). We ﬁnd that

Ek((m(zIn), ζ)g, s, f ) = χχψ(z2k−n, ζ)|z|(2k−n)s+n(n+1)/2+k2−nk

A

Ek(g, s, f ).

Thus E0 and En have the same central character and for k 6= 0, n, Ek has a diﬀerent central character.
Note that E0(g, s, f ) = f (g, s), En(g, s, f ) = M (s)f (g, s) and the intertwining operator M (0) acts as 1
on the coherent part of IndeG(A)
χχψ (c.f. [3, Lemma 6.3]), so in fact E0 = En. Next we consider the
eP (A)
constant term of IREG(g, Φ). This was computed in Sec. 6 of [14]. We get

c−1
α

min(r,n)Xk=0

Xx∈U n(F )

rank(x)=k,hx,xiQ=0

Z[H]

ω(g, h)ω(α)Φ(x)dh.

Wu C Sci China Math

January 2016 Vol. 59 No. 1

17

Denote the k-th term by Ik(g, Φ). We have

Ik((m(zIn), ζ)g, Φ) = χχψ(zn, ζ)|z|mn/2−(m−k−1)k

A

Ik(g, Φ).

For the case at hand with (m, r) = (3, 1) and n = 2, there are only two terms I0 and I1. They have
distinct ‘central characters’. Also note that in fact I0(g, Φ) = ω(g, 1)Φ(0) = fΦ(g, 0). When s = 0, I0,
E0 and En have the same ‘central character’. From the equality 2I0 = E0 + En, we conclude that our cQ
must be 1.

Remark 5.4.
at 0, so the Siegel-Weil formula takes a diﬀerent form.

For the split binary case please refer to [16] and note that the Eisenstein series vanishes

Proof of Theorem 3.1. Fix a ﬁnite place v of k and ﬁx for each place w not equal to v a Φ0
Consider the map Av which sends Φv ∈ S0(U n(kv)) to A(g, Φv ⊗ (⊗w6=vΦ0

theorem Rn(U (kv)) ∼= S(U n(kv))Hv . Thus Av deﬁnes a eG(kv)-intertwining operator

S(U n(kv)) → A(G)

w ∈ S0(U n(kw)).
w)). By invariant distribution

which actually factors through Rn(U (kv)).

As in Lemma 5.2 we can ﬁnd f ∈ S(Symn(kv)) such that its Fourier transform is supported on
nonsingular symmetric matrices and f does not act by zero. Then for all g ∈ eG(A) with gv = 1 and all

B ∈ Symn(k) we have

f (c)A(Φ)(ngn(c))ψ(− tr(Bb))dcdb

f (c)A(Φ)(nn(c)g)ψ(− tr(Bb))dcdb

f (c)A(Φ)(ng)ψ(− tr(B(b − c)))dcdb

(ρ(f ).A(Φ))B (g) =Z[Symn]ZSymn(kv )
=Z[Symn]ZSymn(kv )
=Z[Symn]ZSymn(kv )

= ˆf (B)A(Φ)B (g).

If rk B < n, the above is 0, since ˆf (B) = 0.

A(Φ)B ≡ 0. Thus ρ(f )A(Φ) = 0 as G(k)Qw6=v G(kw) is dense in G(A). Since f does not act by zero and

Rn(Uv) is irreducible we ﬁnd that in fact A(Φ) = 0. This concludes the proof.

If rk B = n, the above is again 0, since by Prop. 5.3,

6 Rallis Inner Product Formula

We will apply the regularised Siegel-Weil formula (Theorem 3.1) to show the critical case of Rallis Inner
Product formula via the doubling method. We will also deduce the location of poles of Langlands L-
function from information on the theta lifting.

Let G = Sp2n be the symplectic group of rank n. Let H = O(U, Q) with (U, Q) a quadratic space of
dimension 2n + 1 and χ the character associated to Q as in (2.6). Let π be a genuine irreducible cuspidal

Θ(h; f, Φ) =Z[eG]

automorphic representation of eG(A). For f ∈ π and Φ ∈ S(U n(A)) deﬁne the theta lift of f to H:
To save space we will use the notation [eG] to denote G(k)\eG(A). Note that as f (g) and Θ(g, h; Φ) are

Now consider G to be the group of isometry of the 2n-dimensional space W with symplectic form
h , iW . We will sometimes write G(W ) for the symplectic group. Let W ′ be the symplectic space such
that the underlying vector space is still W and such that the symplectic form is −1 times that of W .
Then W (cid:3) = W ⊕ W ′ is endowed with the symplectic form h , iW (cid:3) such that

both genuine in g the product can be viewed as a function on G(A).

f (g)Θ(g, h; Φ)dg.

h(w1, w2), (w′

1, w′

2)iW (cid:3) = hw1, w′

1iW + hw2, w′

2iW ′ = hw1, w′

1iW − hw2, w′

2iW .

18

Wu C Sci China Math

January 2016 Vol. 59 No. 1

Let G(cid:3) denote the ‘doubled’ group G(W (cid:3)), which is the symplectic group of rank 2n. Let eG(cid:3)(A) be

If we ﬁx a symplectic basis for W , the induced basis of W ′ is
the corresponding metaplectic group.
not directly a symplectic basis. The isomorphism between the two symplectic groups G(W ) and G(W ′)
is given by the conjugation by an element in the similitude symplectic group with similitude −1. For
g ∈ G(A) set

−1n! .
The conjugation ν extends uniquely to an automorphism of eG(A)

−1n! g 1n

ν(g) = 1n

ν((g, ζ)) = (ν(g), ǫ(g)ζ)

where ǫ(g) = ±1. More precisely, it is determined as follows:

ǫ(m(A)) = χ−1(det A)

ǫ(n(B)) = 1
ǫ(w−1

n ) = 1.

We have the natural embedding

ι : G(A) × G(A) → G(cid:3)(A)

(g1, g2) 7→



a1

c1

a2

−c2

b1

d1



−b2

d2

meaning that the ﬁrst copy of G(A) is mapped to the subgroup G(W )(A) of G(cid:3)(A) and the second copy
is mapped to the subgroup G(W ′)(A) with identiﬁcation given as above. The embedding ι lifts to a
homomorphism

a1

eι : eG(A) × eG(A) → eG(cid:3)(A)


((g1, ζ1), (g2, ζ2)) 7→ (

c1

b1

d1

a2

−c2



−b2

d2

, ǫ(g2)ζ1ζ2).

With this we ﬁnd Θ(eι(g1, g2), h; Φ) = Θ(g1, h; Φ1)Θ(g2, h; Φ2) for gi ∈ eG(A) if we set Φ = Φ1 ⊗ Φ2 for

Consider the inner product between two theta lifts. Let fi ∈ π and Φi ∈ S(U n(A)). Suppose the inner

Φi ∈ S(U n(A)).

product

is absolutely convergent. Then we exchange order of integration to get

hΘ(f1, Φ1), Θ(f2, Φ2)i =Z[H]Z[eG×eG]
f1(g1)f2(g2) Z[H]
f1(g1)f2(g2) Z[H]

Z[eG×eG]
=Z[eG×eG]

f1(g1)Θ(g1, h; Φ1)f2(g2)Θ(g2, h; Φ2)dg1dg2dh

Θ(g1, h; Φ1)Θ(g2, h; Φ2)dh! dg1dg2
Θ(eι(g1, g2), h; Φ)! dg1dg2

Wu C Sci China Math

January 2016 Vol. 59 No. 1

19

Thus we deﬁne the regularised inner product by

f1(g1)f2(g2)I(eι(g1, g2); Φ)dg1dg2.

=Z[eG×eG]
hΘ(f1, Φ1), Θ(f2, Φ2)iREG =Z[eG×eG]

f1(g1)f2(g2)IREG(eι(g1, g2); Φ)dg1dg2

(6.1)

in case the usual inner product diverges.

Let W = X ⊕ Y be a polarisation of W . Then the Weil representation ω considered up till now is
in fact realised on S(U ⊗ X(A)). Thus Φ lies in S(U ⊗ (X ⊕ X)(A)). We could apply the Siegel-Weil
formula now, but then we would not be able to use the basic identity in [5] directly. Thus we proceed as
follows. The space U ⊗ W (cid:3) has two complete polarisations

U ⊗ W (cid:3) = (U ⊗ (X ⊕ X)) ⊕ (U ⊗ (Y ⊕ Y ));
U ⊗ W (cid:3) = (U ⊗ W ∆) ⊕ (U ⊗ W ∇)

where W ∆ = {(w, w)|w ∈ W} and W ∇ = {(w,−w)|w ∈ W}. Let P (cid:3) be the Siegel parabolic of G(cid:3)
ﬁxing the maximal isotropic subspace W ∇. There is an isometry given by Fourier transform

δ : S((U ⊗ (X ⊕ X))(A)) → S((U ⊗ W ∆)(A))

Then (6.1) is equal to

intertwining the action of eG(cid:3)(A).
Z[eG×eG]

Note that here the theta function implicit in IREG is associated to the Weil representation realised on
S(U ⊗ W ∆(A)). Now we apply the regularised Siegel-Weil formula to get

f1(g1)f2(g2)IREG(eι(g1, g2); δΦ)dg1dg2.

2−1Z[eG×eG]

f1(g1)f2(g2)E(eι(g1, g2), s, FδΦ)|s=0dg1dg2

where to avoid conﬂict of notation we use FδΦ to denote the Siegel-Weil section in IndeG(cid:3)(A)
eP (cid:3)(A)
associated to δΦ.

For a section F in this induced representation, set the zeta function to be

Thus

Z(f1, f2, s, F ) =Z[eG×eG]

f1(g1)f2(g2)E(eι(g1, g2), s, F )dg1dg2.

hΘ(f1, Φ1), Θ(f2, Φ2)iREG = 2−1Z(f1, f2, 0, F ).

χψχ| |s

(6.2)

(6.3)

By the basic identity in [5] generalised to the metaplectic case and by [17, Eq. (25)], the zeta function
Z(f1, f2, s, F ) is equal to

f1(g′g)f2(g′)dg′dg

F (eι(g, 1), s)Z[eG]
ZeG(A)
=ZeG(A)
F (eι(g, 1), s).hπ(g)f1, f2idg.

In fact the integrand is a function of G(A). Suppose F and fi are factorisable. Then the above factorises
into a product of local zeta integrals

Z(f1,v, f2,v, s, Fv) =ZeG(kv)

Fv(ι(gv, 1), s)hπv(gv)f1,v, f2,vidgv.

20

Wu C Sci China Math

January 2016 Vol. 59 No. 1

Let S be a ﬁnite set of places of k containing all the archimedean places, even places, outside which πv
is an unramiﬁed principal series representation, fi,v is KG,v-invariant and normalised, Fv is a normalised
spherical section and ψv is unramiﬁed. Then by [17, Prop. 4.6] the local integral Z(f1,v, f2,v, s, Fv) is
equal to

where Lv(s + 1

2 , πv × χv, ψv) is the Langlands L-function as developed in [4] and where

Lv(s + 1

2 , πv × χv, ψv)

(s)

v

edG(cid:3)
nYi=1

(s) =

ζv(2s + 2i).

v

edG(cid:3)

Note here we normalise the Haar measure on eGv so that eKGv has volume 1. Our edG(cid:3)

is slightly diﬀerent
from that in [17], because we are using a diﬀerent local L-factor. Compare with the statement in [1,
Prop. 6.1]. Note also that the deﬁnition of this L-function depends on the chosen additive character ψv.
For v ∈ S, the local L-factor is shown to be the ‘g.c.d’ of the zeta integrals of ‘good’ sections by
Yamana in [25]. Since we are using holomorphic sections, we need to account for the diﬀerence by having

v

v

edG(cid:3)

(s) in our formula. Set

Z(f1,v, f2,v, s, Fv) = Z(f1,v, f2,v, s, Fv)(Lv(s +

1
2

, πv × χv, ψv))−1edG(cid:3)

v

(s).

Then Z(f1,v, f2,v, s, Fv) is entire and for all s ∈ C and all places v, there exist f1,v, f2,v ∈ π and Fv ∈
IndeG(cid:3)(A)
eP (cid:3)(A)

χψχ| |s such that it is non-vanishing. We have that

Z(f1, f2, s, F ) =

L(s + 1

2 , π × χ, ψ)

Yv∈S

Z(f1,v, f2,v, s, Fv).

edG(cid:3)(s)

We set s to 0 in the zeta function to get the Rallis inner product formula.

Theorem 6.1.

Suppose m = 2n + 1. Then

hΘ(f1, Φ1), Θ(f2, Φ2)iREG =

2−1L( 1

2 , π × χ, ψ)

edG(cid:3)(0)

·Yv∈S

Z(f1,v, f2,v, 0, Fv),

χψχ| |s associated to the Schwartz function δ(Φ1 ⊗ Φ2).

where F is the Siegel-Weil section in IndeG(cid:3)(A)
eP (cid:3)(A)

Returning to (6) we deduce the possible location of poles of L-function.

Proposition 6.2.
set

The poles of L(s + 1

2 , π × χ, ψ) in Re(s) > 1/2 are simple and are contained in the

3
2

,

{

5
2

,··· , n +

1
2}.

Proof. We note that the poles of L(s+ 1
The poles of the Eisenstein series in Re(s) > 0 are simple and are contained in {1, 2, . . . , n}, c.f. [7, Page
216]. From this we get the proposition.

2 , π×χ, ψ) are contained in the set of poles ofedG2 (s)E(s, ι(g1, g2), F ).

We give an analogue of Kudla and Rallis’s [16, Thm. 7.2.5] in the case where m = 2n + 1. Let
ΘU (π) denote the space of theta lift of π to the orthogonal group of U . Recall that we have deﬁned the
sub-modules Rn(Uv) of IndeG(cid:3)(kv )
eP (cid:3)(kv )

χψ,vχv for each place v to be the image of the map

S(U (kv)n) → IndeG(cid:3)(kv )
eP (cid:3)(kv )
Φ 7→ ω(g)Φ(0).

χψ,vχv

The parameter s here is 0 since we require the dimension m of U to be equal to 2n + 1. The structure
of IndeG(cid:3)(kv)
eP (cid:3)(kv )

χψ,vχv is summarised by [3, Propositions 5.2, 5.3]:

Wu C Sci China Math

January 2016 Vol. 59 No. 1

21

Proposition 6.3. We have

IndeG(cid:3)(kv )
eP (cid:3)(kv)

χψ,vχv = MUv :χUv =χ

Rn(Uv).

Theorem 6.4.

Let χ be a quadratic character. Suppose L(s, π × χ, ψ) does not vanish at s = 1/2.

Then there exists a quadratic space U over k with dimension m and χU = χ such that ΘU (π) 6= 0.
Proof. For v ∈ S we choose f1,v, f2,v ∈ π and Fv ∈ IndeG(cid:3)(A)
χψχ| |s such that Z(f1,v, f2,v, s, Fv) is
eP (cid:3)(A)
non-vanishing at s = 0. Furthermore because of the module structure of IndeG(cid:3)(kv )
χψ,vχv, we may take
eP (cid:3)(kv )
Fv to belong to some Rn(Uv) with χUv = χv. By [3, Prop. 6.2], the Eisenstein series of an incoherent
section of IndeG(cid:3)(A)
eP (cid:3)(A)
for a global quadratic space U .

χψχ| |s vanishes at s = 0. In this way we may assume that F belongs toQv Rn(Uv)
2 , π × χ, ψ) is assumed to be non-vanishing at s = 0, edG(cid:3) (s) does not have a pole at s = 0

and the data are chosen so that Z(f1,v, f2,v, s, Fv) is non-vanishing at s = 0, the regularised pairing of
theta lifts hΘ(f1, Φ1), Θ(f2, Φ2)iREG is non-vanishing. This means that ΘU (π) 6= 0 for this U .

As L(s + 1

7 Conclusion

The Siegel-Weil formula has been widely used in the literature and much work has been done toward
its proof in various cases.
In this article we have written down a complete proof for the regularised
Siegel-Weil formula in the boundary case and thus closed the gap in literature. From it we have deduced
the Rallis inner product formula in the critical case. As this case of the Rallis inner product formula
expresses the central value of the L-function L(s, π × χ, ψ) in terms of the inner product of theta lifts, it
is of particular importance. It also forms the foundation of the arithmetic Rallis inner product formula
which relates the central derivative of the L-function to the conjectured Beilinson-Bloch height pairing
of arithmetic theta lifts. This will be part of our future research project.

References

1 Gan W T. Doubling zeta integrals and local factors for metaplectic groups. Nagoya Math. J., 2012, 208:67–95
2 Gan W T, Ichino A. Formal degrees and local theta correspondence. Invent. Math., 195(3):509–672, 2014
3 Gan W T, Qiu Y, Takeda S. The regularized Siegel-Weil formula (the second term identity) and the Rallis inner

product formula. Invent. Math., 2014, 198(3):739–831

4 Gan W T and Savin G. Representations of metaplectic groups I: epsilon dichotomy and local Langlands correspondence.

Compos. Math., 2012, 148(6):1655–1694

5 Gelbart S, Piatetski-Shapiro I, Rallis S. Explicit constructions of automorphic L-functions, volume 1254 of Lecture

Notes in Mathematics. Springer-Verlag, Berlin, 1987

6 Howe R. On a notion of rank for unitary representations of the classical groups.

In Harmonic analysis and group

representations, Liguori, Naples, 1982, 223–331

7 Ichino A. On the regularized Siegel-Weil formula. J. Reine Angew. Math., 2001, 539:201–234
8 Ichino A. A regularized Siegel-Weil formula for unitary groups. Math. Z., 2004, 247(2):241–277
9 Ikeda T. On the theory of Jacobi forms and Fourier-Jacobi coeﬃcients of Eisenstein series. J. Math. Kyoto Univ.,

1994, 34(3):615–636

10 Ikeda T. On the residue of the Eisenstein series and the Siegel-Weil formula. Compositio Math., 1996, 103(2):183–218
11 Kudla S. Notes on the local theta correspondence. Notes from 10 lectures given at the European School on Group

Theory, September 1996.

12 Kudla S. Central derivatives of Eisenstein series and height pairings. Ann. of Math., 1997, (2), 146(3):545–646
13 Kudla S, Rallis S. On the Weil-Siegel formula. J. Reine Angew. Math., 1988, 387:1–68
14 Kudla S, Rallis S. On the Weil-Siegel formula.

II. The isotropic convergent case. J. Reine Angew. Math., 1988,

391:65–84

15 Kudla S, Rallis S. Ramiﬁed degenerate principal series representations for Sp(n). Israel J. Math., 1992, 78(2-3):209–256
16 Kudla S, Rallis S. A regularized Siegel-Weil formula: the ﬁrst term identity. Ann. of Math., (2), 140(1):1–80, 1994.

22

Wu C Sci China Math

January 2016 Vol. 59 No. 1

17 Li J S. Nonvanishing theorems for the cohomology of certain arithmetic quotients. J. Reine Angew. Math., 1992,

428:177–217

18 Rallis S. On the Howe duality conjecture. Compositio Math., 1984, 51(3):333–399
19 Rallis S. L-functions and the oscillator representation, volume 1245 of Lecture Notes in Mathematics. Springer-Verlag,

Berlin, 1987.

20 Rao R R. On some explicit formulas in the theory of Weil representation. Paciﬁc J. Math., 1993, 157(2):335–371
21 Serre J-P. A course in arithmetic. Springer-Verlag, New York, 1973. Translated from the French, Graduate Texts in

Mathematics, No. 7.

22 Sweet W J. Functional equations of p-adic zeta integrals and representations of the meta- plectic group. Preprint.
23 Weil A. Sur la formule de Siegel dans la th´eorie des groupes classiques. Acta Math., 1965, 113:1–87
24 Yamana S. On the Siegel-Weil formula: the case of singular forms. Compos. Math., 2011, 147(4):1003–1021
25 Yamana S. L-functions and theta correspondence for classical groups. Invent. Math., 2014, 196(3):651–732
26 Zorn C. Theta dichotomy and doubling epsilon factors for fSpn(F ). Amer. J. Math., 2011, 133(5):1313–1364

