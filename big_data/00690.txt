6
1
0
2

 
r
a

M
2

 

 
 
]

.

R
P
h
t
a
m

[
 
 

1
v
0
9
6
0
0

.

3
0
6
1
:
v
i
X
r
a

Toroidal dimer model and Temperley’s bijection

Wangru Sun

Abstract. Temperley’s bijection relates the toroidal dimer model to cycle rooted
spanning forests (CRSF ) on the torus. The height function of the dimer model
and the homology class of CRSF are naturally related. When the size of the torus
tends to inﬁnity, we show that the measure on CRSF arising from the dimer model
converges to a measure on (disconnected) spanning forests or spanning trees. There
is a phase transition, which is determined by the average height change.

1

Introduction

The dimer model, also called the perfect matching model, was ﬁrst introduced
in physics and chemistry to model the adsorption of di-atomic molecules on the
surface of a crystal [FR37]. In the 1960’s Kasteleyn ([Kas61], [Kas67]), Fisher and
Temperley ([TF61]) have shown how to calculate the partition function. Many
progresses have been made since the late 1990s, for example, [Ken97], [CKP01],
[KO06], etc. In [KOS06], the authors reveal the existence of a phase diagram for
the dimer model on inﬁnite bipartite bi-periodic graphs.

A spanning tree of a graph is a connected, contractible union of edges where
every vertex is covered. Pemantle ([Pem]) proves that the uniform spanning tree
measures on ﬁnite subgraphs of Zd converge weakly, as the subgraphs tend to the
whole of Zd. When d ≤ 4, the limiting measure is supported on a spanning tree of
Zd, otherwise there are almost surely inﬁnitely many trees. Burton and Pemantle
([BP]) prove a transfer current theorem.

Temperley ([Tem74]) ﬁrst introduced a bijection on the square grid between
spanning trees and dimer conﬁgurations. It was generalized by Burton and Peman-
tle in [BP] to unweighted planar graphs. Kenyon, Propp and Wilson ([KPW00])
generalized this construction to directed weighted planar graphs by providing a
measure preserving bijection between oriented weighted spanning trees of the pla-
nar graph and dimer conﬁgurations of its double graph, see Section 2 for deﬁnitions.

Let G be a bi-periodic planar graph, and for N ∈ N∗, consider the toroidal
graph GN = G/(NZ)2. Then, Temperley’s bijection relates dimer conﬁgurations
of its double graph to Cycle Rooted Spanning Forests (CRSF ) of GN . On CRSF
there is a natural probability measure arising from that of the dimer model.

A dimer conﬁguration gives a height function.

If the graph is toroidal, the
height function is additively multivalued. Dub´edat and Gheissari ([DG15]) show
that, under Temperley’s bijection, the height function of the dimer model and the
homology class of the CRSF are naturally related. Proposition 2.1 of this paper
gives an independent proof, which relies on geometric considerations.

1

When N → ∞, such measures on CRSF converge to a limiting Gibbs mea-

sure µ.

A natural question is the topology of the support of the limiting measure. In
this paper we give a characterization of the number of connected components. It
can loosely be stated as follows. A precise statement is given in Theorem 4.2 and
Theorem 5.3.

Theorem 1.1 When the slope of the limiting dimer measure is non-zero, then under µ,
there are a.s. inﬁnitely many connected components.

Theorem 1.2 Let G be a graph verifying the condition ((cid:63)). When the slope of the limiting
dimer measure is zero, then under µ, there is a.s. one connected spanning tree.

For the deﬁnition of the condition ((cid:63)), see Section 5. Especially, this condition
is veriﬁed by the drifted square grid graph, see Example 5.6 for deﬁnition. This
name is inherited form [Chh12].

Combining Theorems 1.1 and 1.2 gives a full picture of the phase diagram.
When the slope of the limiting dimer measure is not zero, there are a.s. inﬁnitely
many trees, and when the slope is zero, there is a.s. only one spanning tree. Zero
magnetic ﬁeld lies in the connected phase. In the case of the drifted square grid
graph, this can be pictured as in Figure 1. A more detailed statement is given in
Section 6.

Figure 1: Phase diagram of a typical weighting.

Acknowledgements.

I would like to thank C´edric Boutillier and B´eatrice
de Tili`ere for their directions, comments and references. Also it’s my pleasure to
thank Richard Kenyon for his insightful comments.

2

BBxyConnectedDisconnected2 Deﬁnitions and Facts

2.1 Basic structures

Let G = (V, E) be a planar connected graph, where V is the set of vertices and E
is the set of edges. We take G∗ = (V ∗, E∗) as its dual, whose vertices correspond
to faces of G and two vertices are joined by an edge in E∗ if and only if these two
faces are neighboring in G (G is also called the primal ). If we take the union of G
and G∗, color V and V ∗ in black (in the ﬁgures we use grey diamonds to represent
vertices in V ∗), take the intersections of the edges as vertices and color them in
white, the new graph we obtain is denoted by Gd and called the double graph of G.
Every black vertex of Gd has only white neighbors and vice-versa. Such property
is called bipartite.

Figure 2: Graph G and its double Gd.

If G is an inﬁnite Z2-periodic graph, then its quotient graph of size N is the
toroidal graph GN = G/(NZ)2. We use Gd
N and G∗N to denote the quotient graphs
of Gd and G∗. Note that, in the notation for graphs, calligraphic letters (like G)
symbolize toroidal graphs, and normal letters (like G) symbolize planar ones or
both of them (when we talk about something for both planar and toroidal graphs).

We say that a graph G is weighted and directed if every directed edge uv of G
is assigned a non-negative weight, which in general is diﬀerent from that of vu. A
weight function c is a non-negative function deﬁned on directed edges of G. By
saying that a graph is unweighted, we mean that all edges have weight 1. For G∗
arising from G, by default we set G∗ to be unweighted.

We say that Gd is weighted if every (non-directed) edge of Gd is assigned a
non-negative weight. We denote this weight function by c again, and in general
there is no ambiguity when we use the same letter c to denote weight functions
deﬁned on diﬀerent objects.

There exits a bijection between the weight functions on G and G∗ (as weighted
and directed graphs) and the weight functions on Gd (as a weighted graph). For
every edge uv of G, on Gd let w be the white vertex between u and v (as in ﬁgure
3). Given a weight function c on G and G∗, we let c(uw) be c(uv) and let c(vw)
be c(vu). In the same way we assign a weight for every edge arising from G∗. This
bijection is to be used in the setting of Temperley’s bijection, see Section 2.2.

3

(a) Weights of G.

(b) Weights of Gd.

Figure 3: Weights.

An oriented spanning tree (OST ) of a graph G is a connected, contractible
union of directed edges such that every vertex of G except one has exactly one
outgoing edge. The only vertex having no outgoing edge is called the root of the
tree. The weight of the tree is the product of the weights of the edges.

An oriented cycle-rooted spanning forest (OCRSF ) of a toroidal graph G is
a union of directed edges such that every vertex of G has exactly one outgoing
edge, and edges don’t form contractible cycles. Each connected component of an
OCRSF is called oriented cycle-rooted tree (OCRT ), which contains exactly one
non-trivial oriented cycle, and every edge other than those on the cycle is oriented
towards the cycle. This cycle is called the root-cycle of the OCRT . For each
conﬁguration, the root-cycles are all parallel (in the sense of homotopy).

A dimer conﬁguration of a bipartite graph is a subset of edges such that every
vertex is incident to exactly one edge in the subset. The weight of a dimer con-
ﬁguration is the product of the weights of edges present. We denote the set of all
dimer conﬁgurations of a graph by M.

For spanning trees and dimer conﬁgurations, we can always deﬁne a probability
measure arising from the weighting, where the probability of a conﬁguration is
proportional to its weight.

The key object for calculating the partition function of the dimer model is the
Kasteleyn matrix, see [Kas61] for example. A Kasteleyn orientation of a graph is
an orientation of edges such that when traveling clockwise around the boundary
of a face, the number of co-oriented edges is odd. If the graph is weighted and
bi-partite, the Kasteleyn matrix K has rows indexed by black vertices, columns
indexed by white vertices, and coeﬃcients deﬁned by:

c(bw)

−c(bw)
0

Kb,w =

if b ∼ w, b → w
if b ∼ w, b ← w
else,

where b is a black vertex and w is a white one.

The dimer partition function of a planar graph is equal to det K up to a sign.
For a toroidal graph, choose a simple curve γx (resp. γy) on the dual of the graph
which winds once horizontally (resp. vertically) around the torus. For every edge
crossing γx, multiply the corresponding entry by z if its black end is on the left of γx
and by z−1 if the white end is on the left, respectively w or w−1 for edges crossing
γy. Such modiﬁed Kasteleyn matrix is denoted by K(z, w). The characteristic

4

c(uv)uvc(vu)uvwc(uw)c(vw)polynomial is deﬁned as

P (z, w) = det K(z, w).

(2.1)

Figure 4: Adding z and w for a toroidal double graph.

If we let z = (−1)θ and w = (−1)τ and we denote the corresponding Kasteleyn
matrix by K(θ,τ ), then the partition function is a linear combination of K(θ,τ ), see
[Kas67] or [CKP01] for example. After choosing a proper Kasteleyn orientation,
we have

Z =

1
2

(− det K(0,0) + det K(0,1) + det K(1,0) + det K(1,1)).

(2.2)

2.2 Temperley’s bijection

The authors of [KPW00] construct a general version of Temperley’s bijection for
directed weighted planar graphs. The construction also applies to graphs on other
surfaces. In this paper, we use Temperley’s bijection on toroidal graphs and on
planar graphs.

2.2.1 Planar case

We begin by the planar case. Let G be a planar graph. Suppose that a vertex v0
is incident to a face f0. If v0, f0 and the edges of Gd incident to them are taken
away, then we denote the rest of Gd by Gd(v0, f0).

Temperley’s bijection ([KPW00]) is deﬁned as a mapping between dimer con-
ﬁgurations of Gd(v0, f0) and spanning trees of G rooted at v0 (in fact spanning-tree
pairs of G and G∗), given by the following procedure. We start from a spanning
tree T of G rooted at v0. For G∗, edges not crossing T form a connected conﬁg-
uration without cycle, thus a tree. We denote it by T ∗ and call it the dual of T .
Take f0 as its root. The set of such pairs (T, T ∗) is denoted by T (G, G∗).

5

γxγxγyγyabcd1111γxγxγyγyabcw−1dz−111zwFigure 5: Rooted spanning tree T and its dual T ∗.

Let M be a subset of edges of Gd. An edge uw of Gd is in M if the directed
edge uv is in T or T ∗, where w is the white vertex of Gd between u and v. Edges
in M form a perfect matching of Gd(v0, f0).

(a) Part of a spanning tree T .

(b) Corresponding dimer conﬁg-
uration.

Figure 6: Temperley’s bijection from a spanning tree to a perfect matching.

By the same rule, from any perfect matching M ∈ M

a spanning-tree-pair (T, T ∗) ∈ T (G, G∗). A directed edge uv of G (resp. G∗) is in
T (resp. T ∗) if uw is in M .

(cid:0)Gd(v0, f0)(cid:1), we can build
(cid:0)Gd(v0, f0)(cid:1) to (T, T ∗) ∈ T (G, G∗),

Figure 7: Graph Gd(v0, f0) and the perfect matching arising from T and T ∗ in Figure 5.

In [KPW00], the authors prove that such a map is a measure preserving bijec-

tion:

if Temperley’s bijection relates M ∈ M

6

v0f0uvuvw(cid:81)
(cid:126)e∈T c((cid:126)e)(cid:81)

then the probability of M is equal to the probability of (T, T ∗), which is deﬁned as

Here the partition functions ZT (G,G∗) is the sum of(cid:81)

.

(cid:126)e∈T c((cid:126)e)(cid:81)

(2.3)

(cid:126)e∗

∈T ∗ c( (cid:126)e∗) over all

∈T ∗ c( (cid:126)e∗)

(cid:126)e∗
ZT (G,G∗)

pairs (T, T ∗).

2.2.2 Toroidal case

For any toroidal graph G, let F be an OCRSF of G and F ∗ be an OCRSF of
G∗. We say that F ∗ is a dual of F if F and F ∗ don’t cross. If F has k connected
components, then it has 2k duals. Every dual of F has also k components, and
its root-cycles are parallel to those of F . We denote the pairs of such dual forests
(F, F ∗) by F(G,G∗). The weight of (F, F ∗) is deﬁned as the product of the weights
of all directed edges present. This gives rise to a probability measure on F(G,G∗):

,

(2.4)

P(F, F ∗) =

where the partition function is:

(cid:81)
(cid:126)e∈F c((cid:126)e)(cid:81)
(cid:89)
(cid:88)

(cid:126)e∗
ZF (G,G

∈F ∗ c( (cid:126)e∗)
∗)
(cid:89)

ZF (G,G

∗) =

c((cid:126)e)

c( (cid:126)e∗).

(F,F ∗)∈F (G,G

∗)

(cid:126)e∈F

(cid:126)e∗

∈F ∗

If we suppose that the weights of the edges of G∗ are all 1 (the by-default-setting

for Gd arising from G), then the probability of (F, F ∗) is:

(cid:81)

P(F, F ∗) =

(cid:126)e∈F c((cid:126)e)
∗)
ZF (G,G

.

(2.5)

Summing over all G∗, this gives rise to a probability measure on OCRSF of G
not proportional to weights. The weight of a conﬁguration is multiplied by a factor
2k where k is the number of its connected components. Such measure, if compared
to the normal weighted measure on OCRSF of G, encourages conﬁgurations to
have more cycles.

Temperley’s bijection between OCRSF pairs of G,G∗ and dimer conﬁgurations
of Gd is deﬁned as in the planar case. It is easy to verify that it is indeed a bijection
and is measure preserving.

2.3 Height function

Following [KPW00], given a dimer conﬁguration of the planar bipartite graph Gd,
we deﬁne a height function on faces of Gd as follows.

We suppose that Gd is embedded. Note that every face of Gd is a quadrilateral
with two black vertices and two white vertices. When we say a diagonal of a face,
we mean the one linking two opposite black vertices. A dimer can be viewed as a
cut on the plane. Given a dimer conﬁguration M , we choose a face as base (the

7

diagonal of this face has 0 height), then prolong this to its neighboring diagonals
by the turning angle without passing cuts. This can be prolonged to the whole
plane([KPW00]). The height hM (.) of a face is deﬁned as the height of its diagonal.
Note that the height function such deﬁned depends on the embedding of the graph
on the plane.

Figure 8: Height function corresponding to a local dimer conﬁguration.

Note that there is another natural deﬁnition of height function, which depends
on the choice of a reference conﬁguration M0, see [KOS06] for example. We denote
the height function of M by ˜h(M,M0). These two deﬁnitions are coherent:

˜h(M,M0) = (hM − hM0)/2π.

In the remainder of this paper, when we speak of height, we use the ﬁrst deﬁ-

nition h by default.

For the inﬁnite Z2-periodic planar graph G, its double graph Gd is also Z2-
periodic. A dimer conﬁguration M of Gd gives a height function hM on the whole
plane. If M is also Z2-periodic, then it gives rise to a dimer conﬁguration of Gd
1 . Let
(ˆx, ˆy) be a base of Z2. The height function hM induces a height change (hM
x , hM
y ),
y ), for any face f of Gd, is equal to hM (f + ˆx) − hM (f ) (resp.
where hM
hM (f + ˆy) − hM (f )), whose value doesn’t depend on the choice of f .
(cid:88)

Proposition 3.1 in [KOS06] shows that the characteristic polynomial (2.1) can

be interpreted by the height changes as follows:

x (resp. hM

(cid:0) (cid:89)

c(e)(cid:1)z−hM

P (z, w) =

M∈M(Gd
1 )

e∈M

x w−hM

y (−1)hM

x hM

y +hM

x +hM
y .

(2.6)

Temperley’s bijection relates a dimer conﬁguration M of Gd(v0, f0) to a span-
ning tree T of G. The height function hM has a natural relation to the winding of
T , which is deﬁned, for a ﬁnite directed path on G, as the total angle of the left
turns minus the right turns along this path.

8

0π23π2ππ2π3π23π2π2π3π2πA branch γ = (v1, ..., vr+1) of an oriented tree T is a ﬁnite directed path of T
keeping co-oriented or anti-oriented with the orientation of T (either every edge
vivi+1 is oriented from vi to vi+1 or from vi+1 to vi).

Denote the white vertex between vi and vi+1 in Gd by wi. Let (f1, ..., fr) be
the faces of Gd lying on the left of γ and every fi is incident to viei. Note that
fi and fi+1 are not neighboring in Gd. For any i ∈ {1, ..., r}, deﬁne αT (fi) as the
counterclockwise angle from the vector viei to the diagonal of fi. Note that for
given T , hM (fi)− αT (fi) only depends on the vertex vi and doesn’t depend on the
choice of path (or face).

of a branch γ = (v1, ..., vr) is equal to(cid:0)hM (fr) − αT (fr)(cid:1)

(cid:0)hM (f1) − αT (f1)(cid:1).

−

Theorem 3 in [KPW00] proves that under planar Temperley’s bijection, winding

To simplify notations, we deﬁne a height function on vertices of G: for any T
and v ∈ T , chose a branch passing v, deﬁne hT (v) as hM (f ) − αT (f ) where f is
a face incident to v as above. So the theorem above says that going along a path,
the change of height hT is equal to the winding.

On the torus, Temperley’s bijection maps a dimer conﬁguration M of Gd

1 to an
OCRSF pair (F, F ∗) of G1 and G∗1 . Height change (hM
y ) is closely related to
the homology class of (F, F ∗). This fact is already shown by authors of [DG15].
Here we give another proof because some geometric facts revealed in this proof are
useful in the subsequent parts of this paper.

x , hM

Suppose that F has k connected components, each component containing a

root-cycle of homology class ±(m, n), m, n ∈ Z, where we choose m to be non-

negative, and when m = 0 we choose n to be positive. Note that m and n are
relatively prime. Suppose that there are k1 (resp. k2) primal (resp. dual) root-
cycles of homology class (m, n), then:

Proposition 2.1 ([DG15]) The height change of M can be expressed as a signed sum of
homology classes of OCRSF of G1 and of G∗1 , as below:
hM
x = −n(k − k1 − k2),
hM
y = m(k − k1 − k2).

If M is a dimer conﬁguration of Gd

1 , then it gives rise to a Z2-periodic
Proof.
dimer conﬁguration of Gd. Via Temperley’s bijection, on the Z2-periodic graphs G
and G∗ this gives a pair of oriented spanning forest rooted on inﬁnite paths. Each
of its connected component is a tree, and we call a tree on G as primal tree, a tree
on G∗ as dual tree, and the only inﬁnite path of a tree as its root.

Let us study the height change along the y axis. Take a vertex v0. We can
choose a path on the inﬁnite planar graph G between v0 and v1 = v0 + ˆy in the
following way.

On G there are mk primal trees T and mk dual trees T ∗ between v0 and v1.
Any edge on the root of a T ∗ (e in the ﬁgure) has two neighboring G-vertices (v
and v(cid:48) in the ﬁgure), lying on each side of the root. For both of them we follow the
branches before we arrive at their roots. This gives a path between roots of two
neighboring primal trees. We also allow walking along the roots of primal trees.

9

Thus, by choosing one edge on every dual tree T ∗, we construct a path on G from
v0 to v1 with k jumps over the roots of dual trees.

(a) How to choose the neighboring G-
vertices of e.

(b) How to construct such path.

Figure 9: Construction of a periodic path.

When such a path jumps over a dual root, the local height change is the winding
(by adding an imaginary edge between the two ends of the jump) plus −π if it is
from right to left over the root, and π if it is from left to right. Walking along a path
always co-oriented or anti-oriented gives a height change equal to winding. Enter-
ing a root, walking along the root and exiting into another branch, the observed
orientation is reversed exactly once (from co-orientated to anti-oriented), either at
the time of entering the root or the time of exiting the root. In both cases it can
be viewed as joining another path and reversing the orientation. Joining from the
right side of another path means a height change equal to winding plus −π and
from the left side means winding plus π. The proof is geometrical, as illustrated in
the following ﬁgures.

After normalizing the height change by 2π, we conclude that the total height
change from v0 to v1 is the winding plus 1
2 (−a + b) where a is the number of the
crosses over the roots of both primal and dual trees from right to left along the
path, and respectively b is the number of crosses from left to right. Since such path

can be repeated between v0 + nˆy and v0 + (n + 1)ˆy for any n ∈ Z without self-joint,

the winding of this path between v0 and v1 is 0.
The height change along the x-axis is similar.

(cid:3)

10

evv′v1v0Path(a) Jump: Winding=(α1 − π) + (π −
α2) − (π − α3) = h + π.

(b) Join: Winding=π − α = h + π.

Figure 10: Jump or join from the right side of a directed path.

3 Laplacian, Kasteleyn Matrix and measure

A dimer probability measure on the Z2-periodic planar graph Gd is characterized
by the inﬁnite inverse Kasteleyn matrix K−1. By Temperley’s bijection, the dimer
measure gives rise to a measure on the directed edges of G. For the later one,
it is more natural to characterize it by Laplacian, and if we take into account a
magnetic ﬁeld B, then we should consider the Laplacian with connection (Section
3.1). This characterization (Theorem 3.2) will be used in Section 5 to study the
topology property of the conﬁgurations under the limiting measure.

3.1 Laplacian with connection

Following [Ken], for a ﬁnite graph G = (V, E), to every v ∈ V and e ∈ E we assign
a space isomorphic to C, denoted by Cv and Ce. A connection Φ on the graph
G is the choice for every edge (cid:126)e = uv an isomorphism φuv : Cu → Cv such that
vu . This isomorphism is called the parallel transport from Cu to Cv. This
φuv = φ−1
is generalized by assigning for every (cid:126)e = uv an isomorphism φve : Cv → Ce with
the property that φve = φ−1

ev and letting φuv = φev ◦ φue.

On a weighted and directed graph G, the Laplacian associated to this connection

Φ is the operator ∆Φ : CV → CV deﬁned by

(cid:88)

u∼v

∆Φf (v) =

cvu(f (v) − φuvf (u)),

where the sum is over all neighbors of v.

The Laplacian can be decomposed in the following way. We ﬁx an arbitrary edge
orientation, then edges in E can be viewed as directed edges. Let Λ0(G, Φ) be the
space of 0-forms and Λ1(G, Φ) be that of 1-forms. Deﬁne d : Λ0(G, Φ) → Λ1(G, Φ)
and d∗ : Λ1(G, Φ) → Λ0(G, Φ) as

df ((cid:126)e) = φvef (v) − φv(cid:48)ef (v(cid:48)),

11

α1α2α3h0=0h1=α1h2=α1−α2h=α1−α2+α3−2παh0=0h1=−α(cid:88)

(cid:126)e=v(cid:48)v

d∗(ω)(v) =

cvv(cid:48)φevω((cid:126)e),

and we have the decomposition

∆Φ = d∗d.

(3.7)

The Laplacian ∆Φ and the operators d and d∗ can all be written in matrix
form. The matrix d∗ has rows indexed by vertices of G and columns indexed by
edges of G with chosen orientation, while d has rows indexed by edges of chosen
orientation and columns indexed by vertices. Note that the operator d∗ is a part
of the Kasteleyn matrix, see Section 3.3.

In [For93], the author proves that:

det ∆Φ =

c((cid:126)e)

(1 − w(γ)),

(3.8)

(cid:88)

(cid:89)

(cid:89)

OCRSF

(cid:126)e∈F

cycles γ

where the second product is the sum over all directed cycles γ and w is the mon-
odromy of this cycle.

Equations (2.6), (3.8) and Proposition 2.1 yield the following proposition as a
corollary, which says that the dimer characteristic polynomial of the double graph
Gd arising from a toroidal graph G is also some Laplacian with connection. See also
[BdT10] where the authors prove this result for isoradial graphs.

Proposition 3.1 On G, choose two paths γx and γy on its dual graph, respectively winding
once horizontally or vertically, and choose parallel transport as follows: φvv(cid:48) = z (resp. w)
if vv(cid:48) traverses γx (resp. γy) from left to right, and φvv(cid:48) = z−1 (resp. w−1) if it traverses
from right to left, otherwise let φ = 1, then

Pdimer(z, w) = det ∆Φ.

Proof. Since m, n in Proposition 2.1 are relatively prime, they can not be both
even. Let a = (k − k1 − k2), then the sign in (2.6) can be simpliﬁed as:

(−1)hxhy+hx+hy = (−1)−nma2−na+ma = (−1)a.

So,

Pdimer(z, w) =

=

=

=

(cid:89)

M∈M(Gd)

e∈M

(F,F ∗)∈F (G,G

∗)

(cid:88)
(cid:88)
(cid:88)
(cid:88)

F∈OCRSF (G)

(cid:126)e∈F

F∈OCRSF (G)

(cid:126)e∈F

(cid:89)
c(e)z−hxw−hy (−1)hxhy+hx+hy
(cid:89)
(cid:89)

c((cid:126)e)z−hxw−hy (−1)hxhy+hx+hy
k2=k(cid:88)

(cid:19)
(−znw−m)k−k1−k2

(cid:18) k

(cid:126)e∈F

c((cid:126)e)

k2

k2=0

c((cid:126)e) · (1 − z−nwm)k1(1 − znw−m)k−k1.

(3.9)

(cid:3)

12

3.2 Magnetic ﬁeld and connection

Let G be a Z2−periodic graph, GN = G/(NZ)2. Following [KOS06], in the dimer
model, by adding a magnetic ﬁeld B = (Bx, By) on the toroidal bipartite graph
Gd
N , we mean choosing two dual paths γx and γy in Gd
1 winding once horizontally
or vertically around the torus, and for every edge of Gd
N , if its copy in Gd
1 cross γx
(resp. γy), multiplying its weight by e±Bx (resp. e±By ).
y in Gd

N winding
once horizontally or vertically around the torus, and letting z = eN Bx and w = eN By
for z and w as in Proposition 3.1.

This is gauge-equivalent to choosing two dual paths γN

x and γN

By Temperley’s bijection, such modiﬁcation gives rise to a modiﬁcation of the
weights of directed edges of G and G∗: it changes the weight of a directed edge of G
or G∗ whose copy in G1 or G∗1 crosses γx or γy in one direction but not in the other,
depending on the choice of γx and γy and the position of the edge. Proposition
3.1 says that an equivalent way to have this is just to consider the primal OCRSF
with corresponding parallel transport.

The dimer measure with magnetic ﬁeld B = (Bx, By) yields a natural proba-
bility measure on OCRSF of GN . The partition function with this modiﬁcation is
a direct corollary of Proposition 3.1. It is equal to

c((cid:126)e) · (1 + e−nN Bx+mN By )k1(1 + enN Bx−mN By )k−k1,

(cid:89)

(cid:126)e∈F

where the notations m, n, k and k1 are as in Proposition 3.1. In fact, if we replace
all terms as −z−nwm and −znw−m in (3.9) by 1, the right hand side of (3.9) is

(cid:88)

2k(cid:89)

c((cid:126)e),

which is the partition function without magnetic ﬁeld.

F∈OCRSF (GN )

(cid:126)e∈F

3.3 Laplacian and inverse of Kasteleyn matrix on ﬁnite graphs

Equation (3.7), as is mentioned, can also be viewed as a matrix multiplication. Let
G be a ﬁnite graph, here we suppose that G is planar or toroidal. For any given
edge-orientation of G, the matrix d∗ is indexed by vertices of G on rows and by
edges of G with chosen orientation on columns, while d is indexed by edges with
chosen orientation on rows and by vertices on columns.

Any given edge-orientation of G generates an orientation on edges of G∗, where
the orientation of (cid:126)e∗ is from the left side of (cid:126)e to its right side.
If edges of the
double graph Gd inherit the orientation of those of E and E∗, then its orientation
is a Kasteleyn orientation. To see this, we remark that every simple face is a
quadrilateral and we just need to verify the 4 possible cases.

We can also deﬁne the operators d∗dual and ddual as analog of d∗ and d on the

dual graph G∗.

If G is toroidal, choose the connection corresponding to the magnetic ﬁeld B
as in Proposition 3.1 and (θ, τ ) as in (2.2), and if G is planar, we take a trivial

13

connection. Then ∆Φ is the Laplacian with this connection, and the matrix

(cid:18) d∗

(cid:19)

d∗dual

K =

is a Kasteleyn matrix (with z and w in toroidal case) whose rows are indexed by
vertices of G and G∗ and whose columns can either be viewed as directed edges or
as white vertices of Gd.

Similarly we deﬁne the matrix

M =(cid:0)d ddual

(cid:1) .

Let v ∈ G and v∗ ∈ G∗ be opposite black vertices in any quadrilateral of Gd,
and denote the white vertices in this quadrilateral by e1 and e2. Without losing
generality we suppose that dual edges are oriented form v∗ to e1 and e2, so the
oriented primal edges are e1v and ve2. Note that c(v∗e1) = c(v∗e2) = 1, we have

and in other cases this value is trivially 0.

Thus, we can write a matrix equation:

(d∗duald)v∗,v = φe1v∗φve1 − φe2v∗φve2 = 0,
(cid:19)

(cid:18)∆Φ

(cid:18) d∗

(cid:63)
0 ∆Φ

dual

(cid:19)(cid:0)d ddual
(cid:18)∆Φ

(cid:63)
0 ∆Φ

(cid:1) =
(cid:19)

dual

KM =

d∗dual

.

(3.10)

By taking inverse of K (when invertible), we have:

K−1

= M.

(3.11)

We will see that equation (3.11) gives a useful characterization of K−1 for

studying the limiting behavior of OCRSF .

3.4 Inﬁnite Laplacian and inverse of Kasteleyn matrix

Now we focus on a Z2-periodic graph G and its quotient graph GN . We denote the
Kasteleyn matrix on GN by KN (keep in mind that this is the Kasteleyn matrix
corresponding to B and (θ, τ )), and the one on G by K. Same convention for other
matrices.

In [KOS06] the authors prove that when N → ∞, K−1

K−1 which is the inverse of K (regardless of (θ, τ ) of K−1
and so does (3.11).

N converge to a matrix
N ). Equation (3.10) holds,

By construction of KN , here the ﬁrst half columns of K−1 are indexed by
vertices of G and the second half are by those of G∗. We are only interested in
the ﬁrst half (primal OCRSF ), fully described by (K−1)V , where (K−1)V is the
submatrix of the inﬁnite matrix K−1 whose columns are indexed by the vertices

of V . We may write K−1 =(cid:0)(K−1)V (K−1)V ∗(cid:1) and then by verifying the block

product version of (3.11) we have (K−1)V ∆Φ = d.

14

Fixing a row in this equation means ﬁxing some edge e (i.e. choosing a white
e and de the corresponding row vectors of (K−1)V and

vertex). Denote by (K−1)V
d.

Theorem 3.2 below gives a description of (K−1)V by a statement of existence

and uniqueness. A similar argument can be found in [BdT10].

A vertex u of Gd can be written in the form (x, y; v), where (x, y) ∈ Z2, v ∈ Gd
1 .
1 -vector-valued functions decaying at inﬁnity, and

Deﬁne C0(Z2) as the space of Gd
deﬁne CB

0 (Z2) as its (magnetic ﬁeld B) modiﬁed version:

0 (Z2) := {f : Z2 → Gd
CB

1 : exBy+yBxf (x, y; v) ∈ C0(Z2)}.

Theorem 3.2 The matrix (K−1)V is the unique inﬁnite matrix A such that every row
Ae ∈ CB

0 (Z2) and A∆Φ = d.

Proof. To prove the uniqueness here we use Fourier transform. Following [BdT10],
the space of rapidly decaying Gd

1 -vector-valued functions is

S(Z2) := {f : Z2 → Gd

1 : ∀(m, n) ∈ Z2,

lim

(cid:107)(x,y)(cid:107)→∞(cid:107)xmynf (x, y)(cid:107) = 0},

and its B-modiﬁed version:

S B(Z2) := {f : Z2 → Gd
Also denote by S(T2) the space of Gd
(cid:88)
The Fourier transform of a Gd

1 : exBy+yBxf (x, y; v) ∈ S(Z2)}.
1 -vector-valued smooth function on the torus.

1 -vector-valued function f , when exists, is

and we deﬁne the Fourier transform with magnetic ﬁeld B as

(cid:98)f (z, w) =
(cid:88)

(cid:98)f B(z, w) =

(x,y)∈Z2

f (x, y)wxzy, (z, w) ∈ T2,

(x,y)∈Z2

f (x, y)(weBy )x(zeBx)y, (z, w) ∈ T2.

The fourier transform gives a bijection between S(Z2) and S(T2). Denote by (cid:104) , (cid:105)Z2
(resp. (cid:104) , (cid:105)T2) the duality bracket between between S(Z2) and its dual S(cid:48)(Z2) (resp.
between S(T2) and its dual S(cid:48)(T2)). The Fourier transform extends as a bijection
from S(cid:48)(Z2) to S(cid:48)(T2) by duality.

The Laplacian acting on the right side is:

f ∆Φ(u) =

where the parallel transport is

cu(cid:48)u[f (u) − φuu(cid:48)f (u(cid:48))],

(cid:88)

u(cid:48)

∼u

φu,u(cid:48) = φ(x,y;v)(x(cid:48),y(cid:48);v(cid:48)) = eBy(x(cid:48)

−x)+Bx(y(cid:48)

−y).

15

Thus,

B

(cid:91)
f ∆Φ

=

(cid:88)
(cid:88)
= (cid:100)gf ∆,

=

(x,y)∈Z2

(x,y)∈Z2

(weBy )x(zeBx)y (cid:88)
wxzy (cid:88)

u(cid:48)

u(cid:48)

∼u

cu(cid:48)u[f (u) − eBy(x(cid:48)

−x)+Bx(y(cid:48)
cu(cid:48)u[exBy+yBxf (u) − ex(cid:48)By+y(cid:48)Bxf (u(cid:48))]

∼u

−y)f (u(cid:48))]

where gf (x, y, v) = exBy+yBxf (x, y, v) and ∆ is the Laplacian with trivial connec-
0 (Z2), then gf ∈ C0(Z2), and the action
tion. By deﬁnition we see that when f ∈ CB
of ∆ preserves the space C0(Z2).
0 (Z2) is 0. Then its Fourier transform with B, which is equal to (cid:100)gf ∆, is also
To prove the uniqueness it suﬃces to show that the only solution of f ∆Φ = 0
in CB
0. Their Fourier transforms (with or without B) are well deﬁned, and for any test
function h ∈ S(T2),

0 = (cid:104)(cid:100)gf ∆, h(cid:105)T2
= (cid:104)(cid:98)gf ,(cid:98)∆h(cid:105)T2.

= (cid:104)gf ∆, ˇh(cid:105)Z2
= (cid:104)gf , ∆ˇh(cid:105)Z2

The second line and fourth line are by Parseval’s theorem, the fourth line is also
by the fact that ∆ acts on ˇh as a convolution rather than a product. The third line

is well deﬁned as gf ∈ C0(Z2) ⊂ S(cid:48)(Z2), and (cid:98)gf in the forth line is in S(cid:48)(T2) deﬁned
by duality. Since (cid:98)∆ is invertible except at (1, 1), the above calculations show that
∀ψ ∈ S(T2) s.t. ˆψ has support contained in T2\{(1, 1)}, let h be (cid:98)∆−1ψ ∈ S(T2),
so the support of (cid:98)gf is contained in {(1, 1)}. For gf ∈ C0(Z2), the only possibility

is gf = 0, so f = 0.

To prove the existence, knowing that (K−1)V exists and veriﬁes (K−1)V ∆Φ = d,
0 (Z2). By deﬁnition

we should also prove that every row (K−1)V
it is equivalent to proving that g(K−1)V

e is in the space CB
e ∈ C0(Z2), and we have
= (cid:99)gde.
(cid:92)
(K−1)V

= (cid:98)de

e ∆Φ

B

B

(cid:92)g(K−1)V

e

∆ =

In the last term gde = eByx+Bxyd0
e ∈ C0(Z2)
ﬁeld B is 0. Thus, in the case that e satisﬁes x(e) = y(e) = 0, (K−1)V
by the same proof as in Proposition 5 of [BdT10], where the crucial fact is that
Proposition 3.1 gives a characterization of the zeros of det K(z, w) on the torus T2.
By translation invariance it is true for all e.

e is the matrix form of d where the magnetic

e, d0

(cid:3)

3.5 Measures on GN and G
A dimer probability measure on the Z2-periodic planar graph Gd can be obtained
as a limit of Boltzmann probability measures on Gd
N when N goes to inﬁnity. In

16

[KOS06], the authors prove that the limiting measure µ is a determinantal process
with kernel K−1.

For all N ∈ N, Temperley’s bijection gives a probability measure on OCRSF
of GN . The results of [KOS06] and Temperley’s bijection directly imply that, when
N → ∞, OCRSF measures also converge weakly to a limiting Gibbs measure µ (we
use the same letter since they are the same measure) on the conﬁgurations of the
directed edges of the Z2-periodic planar graph G. This measure is a determinantal
process with kernel (K−1)V , which is characterized by Theorem 3.2.

Now we give a brief discussion on the measures on non-oriented edges. As
mentioned in the introduction, the main interest of this paper is the topology of
the conﬁgurations under the limiting measure. The similarity of the non-oriented-
edge measure and the spanning-tree measure inspires our Section 5.

Repeat the result of [KOS06] in the language of OCRSF . Oriented edges (cid:126)ei in

OCRSF form a determinantal process, and

P((cid:126)e1, ..., (cid:126)em) =(cid:0)(cid:89)

i

K((cid:126)ei)(cid:1) det(K−1) (cid:126)E,

(3.12)

where (cid:126)E is the set of oriented edges {(cid:126)e1, ..., (cid:126)em}, K((cid:126)ei) is equal to ±c((cid:126)ei)φ(cid:126)e where its
sign depends on the orientation and φ(cid:126)e is the parallel transport along (cid:126)e. We write
(cid:126)ei = viv(cid:48)i. Rows of (K−1) (cid:126)E are indexed by edges of (cid:126)E and columns are indexed by
{vi}, the starting points of the oriented edges {(cid:126)ei}.

We suppose that edges of (cid:126)E have no common edges and no common starting
points, otherwise this is automatically 0. By entering K((cid:126)ei) into columns, we can
rewrite the term on the right hand side of (3.12) as a single determinant. The
(ei, vj)th element of this matrix is

(cid:16)

K((cid:126)ej)

K−1
eivj

.

(cid:17)

(cid:16)

Consider the probability of non-directed edges E, which is a binomial sum
over directed edges. Denote the reverse of (cid:126)e by ˇ(cid:126)e. Such probability measure is a
determinantal process with an edge-edge matrix kernel whose (ei, ej)th element is

(cid:16)

(cid:17)

(cid:17)

K((cid:126)ej)

K−1
eivj

+ K(ˇ(cid:126)ej)

K−1
eiv(cid:48)

j

.

(3.13)

We note that when the magnetic ﬁeld is 0 and the weights of edges are all equal
to 1, formally (3.11) says that K−1 is the diﬀerence of two Green’s functions g, and
we can rewrite (3.13) as

(cid:0)g(v(cid:48)i, vj) − g(vi, vj)(cid:1)

(cid:0)g(v(cid:48)i, v(cid:48)j) − g(vi, v(cid:48)j)(cid:1) ,

−
although only diﬀerences of g make sense.

This result is the same as the probability measure on uniform spanning trees
on the inﬁnite equal-weighted Z2-lattice studied in [BP]. Thus for G = Z2 with
equal weight-setting, OCRSF of GN converges weakly to spanning trees of Z2.

17

4 Non-zero slope

In the previous section, by comparing to the results of [BP], we showed that in the
simplest case (square lattice whose edges are equally weighted), under the limiting
measure there is a.s. exactly one connected component. A natural question is
about the number of connected components in more general cases. In this section,
we will prove that when the slope of the limiting measure is non-zero, then there
are a.s.
inﬁnitely many connected components, and in the next section we prove
that in some setting, zero slope means one connected component.

Consider a Z2-periodic planar graph G. We may add a magnetic ﬁeld on its
double graph Gd. Following [Pem], for two given vertices v1 and v2 in G, and for
any N ∈ N such that GN contains v1 and v2, we consider the event in GN that v1
and v2 are connected within a ball BL by OCRSF of the toroidal graph GN (we
ask that the size N of torus is larger than the diameter of BL so that BL doesn’t
superpose with itself). The probability that, under the limiting measure µ, v1 and
v2 are connected is equal to:

P

lim
L→

lim
N→∞

GN [v1 and v2 are connected within BL].

The measure on OCRSF -pairs of the torus gives rise to a measure on their
roots (oriented cycles). Proposition 2.1 proves that for any simple close curve γx
(resp. γy) that winds once horizontally (resp. vertically), the signed sum of the
crossings of the oriented cycles on such a curve is equal to the horizontal (resp.
vertical) height change.

Lemma 4.1 For (F, F ∗) as an OCRSF pair, we omit the branches and look at the cycles.
Vertices v1 and v2 are not connected within BL if the absolute value of the signed sum of
the number of the cycles passing γ between v1 and v2 is not less than two.

Proof. For any simply connected ﬁnite region on the torus, if two vertices lie on
diﬀerent side of a dual cycle, then they are not connected within the region. If the
signed sum of the cycles passing γ between these vertices is not less than two, then
(cid:3)
there should be at least one dual cycle passing γ between these vertices.

When N → ∞, the average height change converges to the slope (s, t) of the

Gibbs measure µ, see [KOS06].

Theorem 4.2 If the slope (s, t) of the limiting dimer measure is non-zero, then under the
limiting OCRSF measure there are a.s. inﬁnitely many connected components.

Proof. We suppose that t > 0. On G we choose v1 arbitrarily and choose v2 being
a copy of v1 laying k units upper (v2 = v1 + k ˆy).

We choose γy as a periodic path on G (so on the path there are only the white
vertices and the primal black vertices of Gd), winding vertically and passing v1 and
v2. Let M − 1 be the number of the black vertices on γy between v1 and v1 + ˆy, so
there are kM − 1 black vertices and kM white vertices on γy between v1 and v2.

18

For any ball BL that contains v1 and v2, and for any N large enough such that
BL is contained in GN as a simply connected set, Lemma 4.1 says that the proba-
bility that v1 and v2 are not connected are bounded from below by the probability
that the signed sum of the cycles passing through γ between them are strictly
bigger than 1 or strictly less than −1.

For any N , and any OCRSF of GN , the total height change along y-axis hy
is the total signed sum of the primal cycles and dual cycles that pass through the
once-vertically winding curve γy. So for v1 and v2, the expected height diﬀerence
hy(v1, v2) is the expected signed sum of the number of crossings of the cycles
between v1 and v2.

As N goes to inﬁnity, E[hy(v1, v2)] → kt. So ∀α > 0 small, when N is large,
we have E[hy(v1, v2)] ≥ kt − α. As there are at most 2kM − 1 vacancies that allow

the cycles to pass through, the expectation of the signed sum can be written as:

p−2kM +1(−2kM + 1) + ... + p−1(−1) + p1 + ... + p2kM−1(2kM − 1),

where pi is the probability that the signed sum is i. And if |i| ≥ 2, then there are
at least two cycles passing between v1 and v2.

In hypotheses we suppose that t is positive. We want to maximize p−1 + p0 + p1

under the constraints

2kM−1(cid:88)

2kM−1(cid:88)

pii ≥ kt − α,

pi = 1.

i=−2kM +1

i=−2kM +1

If p−1 + p0 + p1 is equal to p, then their contribution to the expectation is at
most p, and the remaining terms contribute at most (1− p)(2kM − 1). So we have

which turns to be

p + (1 − p)(2kM − 1) ≥ kt − α,

p(2kM − 2) ≤ 2kM − kt − 1 + α.

Choose k bigger than 1/M and 1/t, α suﬃciently small, then p < 2kM−1−kt+α
,
which is less than 1, and this is bigger than the probability that v1 and v2 is
not connected. Especially, we remark that this upper bound when N is large
enough doesn’t depend on L. As L tends to inﬁnity, the probability that v1 and
v2 are connected is less than 1, so the probability that there is a unique connected
component is less than 1.

2kM−2

By the same method we can generalize this result to ﬁnite vertices, saying that
there exist v1, ...vk ∈ V , the probability that any two of them is connected is less
than 1, so the probability that there are at most k − 1 connected components is
less than 1.

Since the measure is ergodic, and whether there are at most k−1 components is
a translation-invariant event, the probability that there are at most k−1 connected
(cid:3)
components is 0, and we prove the theorem.

19

5 Zero slope

The following lemma is an important observation for a graph Gd arising form its
primal graph G.

Lemma 5.1 In the phase diagram of the dimer measure of Gd, the point B = (0, 0) always
corresponds to a zero slope.

Proof. When B = (0, 0), (z, w) = (e0, e0) = (1, 1) is always a real zero of the
characteristic polynomial det K(z, w) = det ∆Φ, so either B = (0, 0) lies on the
boundary of the amoeba (when (1, 1) is a single root) or in the interior of the
amoeba (when (1, 1) is a double root). In either case, it corresponds to an integer
point in the Newton’s polygon.

If the graph G have a symmetric weight setting (i.e. c(uv) = c(vu) for all edges
uv), then the Laplacian ∆Φ is symmetric in z and z−1 (resp. in w and w−1). Since
det K(z, w) = det ∆Φ, the amoeba is symmetric with respect to the origin and so
does the Newton’s polygon, and B = (0, 0) corresponds to (s, t) = (0, 0). For this
symmetric Laplacian, (1, 1) is a double real root, so B = (0, 0) lies in the interior
of the amoeba (a liquid phase). Also, as an interior integer point, (s, t) = (0, 0)
corresponds either to a liquid phase or to a gaseous phase.

In general, any weight setting can be obtained from the symmetric weight set-
ting via continuous deformation. Along this deformation, for any ﬁxed magnetic
ﬁeld B the slope (s, t) changes continuously, while the point B = (0, 0) always
corresponds to an integer point (s, t). Thus B = (0, 0) always corresponds to
(s, t) = (0, 0). This ﬁnishes the proof.

(cid:3)

Note that same slope means same limiting measure. To study the case where
the slope is zero, we just need to study the case where the magnetic ﬁeld is zero.
The advantage is that B = (0, 0) enables us to approach the limiting Gibbs measure
µ by another sequence of measures mN but on ﬁnite planar graphs. The later one
has a random-walk interpretation, which gives some tools to study connectivity.

In the following part we suppose that B = (0, 0), and we omit the connection

Φ (which is trivial) of the Laplacian ∆Φ to simplify the notation.

Let the ﬁnite graphs (GN )N form an exhausting sequence of G but with a wired
boundary condition. A wired boundary is to glue every vertex on the boundary into
one. Let G∗N be its dual and let Gd
N be the double graph. They are both square
lattice except vertices near boundary.

For a non-oriented spanning tree of GN , we choose the boundary vertex r as
root, denote the tree oriented to r by T , and choose an arbitrary vertex in G∗N
incident to r, denoted by r∗. T ∗ is dual of T rooted at r∗. Such T is called wired
spanning trees (W ST ), which was implicit in [Pem], then made explicit in [H¨ag95]
and further developed in [BLPS]. We denote this weighted wired spanning tree
measure by mN .

In [BLPS], the authors prove the existence of a weak limit measure on W ST
on non-directed weighted graphs, also called networks. Such name is given because
of its natural relation to electrical networks.

20

Graphs arising from dimer models are directed and weighted. We show that

the same approach still works.

Recall that for the ﬁnite planar graph GN with wired boundary condition, Tem-
perley’s bijection gives a measure preserving bijection between dimer conﬁgurations
of Gd
N \ {r, r∗} and spanning-tree-pairs (T, T ∗), T rooted at r and T ∗ rooted at r∗,
see Section 2.2.1. Here the weight of T ∗ is always 1 and every T has only one dual
T ∗, so the spanning-tree-pair measure is the same as mN .

A spanning tree of a ﬁnite planar graph is automatically related to a random

walk by Wilson’s algorithm.

A random walk on weighted graph G is a Markov chain X0, X1, X2, ... on G

that for all n ∈ Z, v, u ∈ G,

P(Xn+1 = v|Xn = u) =

(cid:80)

c(uv)
∼u c(uv(cid:48))
v(cid:48)

.

Wilson’s algorithm ([Wil],[BLPS]): for the ﬁnite graph GN and root r chosen

Let p = (v0, v1, ..., vn) be a path on G. The loop erasure of p is a path LE(p) =
(u0, u1, ..., um), such that u0 = v0, and conditioned on that uj is set and k is the
largest number such that vk = uj, then uj+1 = vk+1.

as a vertex of GN , the algorithm constructs a growing sequence of trees (cid:0)T (i)(cid:1)
from T (0) = r, and once(cid:0)T (i)(cid:1)

i
i is generated, we randomly and independently pick
a vertex v not in T (i), start an independent random walk X starting at v and end
it once it hits T (i). The new tree T (i + 1) is deﬁned as T (i) plus the loop erasure
of the path of X. Continue this process until every vertex is in the tree. The
constructed spanning tree has a probability proportional to its weight.

We forget the restriction of staying in GN and consider random walk in the
Z2-periodic graph G. For any N , consider GN . Similar to what we have in toroidal
case, the oriented-edge-measure of the spanning trees of GN rooted at r forms a
determinantal measure of kernel (K−1
N )V , which is the submatrix of the inverse
Kasteleyn matrix of Gd

N \ {r, r∗} indexed by vertices of GN .

Here the matrix relation (3.7) is ∆N = d∗N dN . We rearrange the columns and
rows such that ﬁrst half of the blacks are indexed by the vertices of GN . Taking
away r and r∗ corresponds to deleting the corresponding rows and columns in the
matrices, the matrices such modiﬁed are denoted by symbols with tildes:

(cid:32) (cid:101)d∗N(cid:101)d∗dual N

(cid:33)(cid:16)(cid:101)dN (cid:101)ddual N

(cid:17)

=

(cid:32)(cid:101)∆N

0

(cid:33)

.

(cid:101)∆dual N

(cid:63)

exactly the Kasteleyn matrix KN . So (K−1

Removing r and r∗ leaves (cid:101)∆N and (cid:101)∆dual N invertible. The matrix
Let D be a diagonal matrix indexed by v ∈ GN \{r}, and Dv,v =(cid:80)

Then

N )V is the only matrix AN which satisﬁes

(cid:18) ˜d∗N

˜d∗dual N

(cid:19)

is

v(cid:48)

∼v c(vv(cid:48)).

(cid:16)

N (cid:101)∆N

D−1

(cid:17)

v,v(cid:48) =

AN(cid:101)∆N = (cid:101)dN .
(cid:40)
−c(vv(cid:48))/(cid:80)

v(cid:48)(cid:48)

1

21

∼v c(vv(cid:48)(cid:48))

v(cid:48) = v
v(cid:48) (cid:54)= v.

When v(cid:48) (cid:54)= v, the (v, v(cid:48))th entry is the transition probability of the random walk

from v to v(cid:48). Write

pv,v(cid:48) = c(vv(cid:48))/

(cid:88)
N (cid:101)∆N = (cid:101)dN is (K−1

c(vv(cid:48)(cid:48)).

∼v

v(cid:48)(cid:48)

The only matrix BN satisfying BN D−1

N )V DN . Meanwhile,
there is a natural solution of this equation given by Green’s function. For white
vertex w associated to directed edge (cid:126)e = v1v2 (see Figure 11), and for any vertex v,
if we deﬁne RW GN
as the random walk on GN starting at a and killed at boundary
r, then

a

(BN )w,v = E(cid:2)#RW GN

v1 visits v(cid:3) .

v2 visits v − #RW GN

(5.14)

Figure 11: (cid:126)e = v1v2.

Condition 5.2 If the right hand side of (5.14) converges when N → ∞ and decays to
zero when the distance between w and v tends to inﬁnity, we say that the graph G veriﬁes
the condition ((cid:63)).

Theorem 5.3 When the condition ((cid:63)) is veriﬁed, as N goes to inﬁnity, mN converges to
a measure m on the drifted square grid graph G which is the same as µ, the weak limit of
µN . The measure m is supported on spanning trees, so is µ.

The condition ((cid:63)) is true for a big class of graphs. See the following propositions.

Proposition 5.4 If the graph G is transient, then the condition ((cid:63)) is veriﬁed.

Proof. We have

E(cid:2)#RW GN

v2 visits v(cid:3) = P(cid:0)RW GN

v2 visits v(cid:1) E(cid:2)#RW GN

v

visits v(cid:3) .

In a transient Z2-periodic case, the second factor on the right hand side converges
when N → ∞ and is bounded. The ﬁrst factor also converges when N → ∞, and it
tends to zero when the distance between v2 and v tends to inﬁnity, since in scaling
the random walk γ behaves like a drift of order n plus a term of variance √n. For
a ﬁxed-size ball, the probability that such a path visits it decays to zero as the
(cid:3)
distance between the ball and the origin tends to inﬁnity.

Proposition 5.5 If the graph is non-directed, then the condition ((cid:63)) is veriﬁed.

Non directed graph is a network, and such property can be seen in [BLPS].

22

v1v2w~e=v1v2Example 5.6 The drifted grid graph.

Here we look at an example: the drifted square grid graph, which is a square
lattice with drifted weight setting: every vertex have four incident edges with the
conductances being a, b, c and d clockwise, see Figure 12. Its dual G∗ is the square
lattice with edges weighted 1. The fundamental domain of Gd is the same as the
example in Figure 4.

Figure 12: Drifted square grid.

The phase diagram of the dimer model on Gd with typical weighting is as in
Figure 1 (black and grey curves give the amoeba). There is only one possible
bounded gaseous region for any value of (a, b, c, d) such that a (cid:54)= c or b (cid:54)= d,
otherwise such region vanishes. In Figure 1 the gaseous region is in light blue.

If the random walk associated is recurrent, then a = c and b = d. This is a
network, so Proposition 5.5 applies. Otherwise this is a transient graph and Propo-
sition 5.4 applies. So the drifted square grid graph always satisﬁes the condition
((cid:63)).

Proof of Theorem 5.3. When the condition ((cid:63)) is veriﬁed, any entry of BN
converges when N → ∞. Denote its limit by B. Measures (mN )N converge to
a limiting measure m. The entry of B decays to 0 as the distance between two
vertices tends to inﬁnity. Let A = BD−1. It is the kernel of m and satisﬁes the
equation A∆ = d. Each row vector of the matrix A can be viewed as a function
on the vertices of G.

Theorem 3.2 says that the kernel of µ is the unique matrix verifying this equa-
tion and decays at inﬁnity. This proves that m = µ. To ﬁnish the proof of Theorem
5.3, we just need to prove that the measure m is supported by spanning trees, and
this is proven in Lemma 5.7.

Lemma 5.7 The measure m is supported on spanning trees of Z2.

Proof.
In [Pem], the author shows that spanning trees of equal weighted square
grid converge to trees of Z2 if and only if independent simple random walk and loop
erased random walk intersect inﬁnitely often a.s. The same argument still applies
to other cases. This is also known to the authors of [LPS] in their Proposition 2.1.
Here in our case where the weight function is deﬁned on directed edges, there is
nothing new.

23

adcbTheorem 1.1 in [LPS] shows that, for two independent transient Markov chains
RW 1 and RW 2 on the same graph and having the same transition probabilities,
if the path of RW 1 and that of RW 2 intersect inﬁnitely a.s., then LERW 1 and
RW 2 intersect inﬁnitely a.s. too.

In our case, in scaling the random walk γ behaves like a drift term of order n
plus a term of variance √n. The paths of two independent random walk meets a.s.
(cid:3)
as the time tends to inﬁnity. This ﬁnishes the proof.

Remark: Here we choose wired spanning tree measure m to approach µ. However,
we conjecture that the local behavior of the spanning tree ﬁnally does not depend
on the choice of root r on the boundary of GN , i.e. we choose the root vertex
simply to be a vertex on the boundary of GN instead of gluing the boundary, and
when N → ∞ this always converges to the same measure no matter where the root
is.

Our result is true for any graph with the property ((cid:63)), among which the drifted
square grid graph is an interesting example. Proposition 5.4 works for all transient
graphs. So the main diﬃculty for getting such results as Theorem 5.3 on general
Z2-periodic graphs is that we don’t know how to prove that the diﬀerence of the
Green’s function for recurrent random walk on directed graphs killed at wired
boundary converges when the size of graph tends to inﬁnity and decays when the
distance of the vertices tends to inﬁnity. We conjecture that this is true, and we
remark that without this boundary condition, the decay of the diﬀerence of the
Green’s function can be found in some references, for example, [KU08].

6 Phase diagram

Combining the results in Section 4 and Section 5, we give a phase diagram for
graphs verifying the condition ((cid:63)). Figure 1 gives the phase diagram of a drifted
square grid graph of a typical weighting (Figure 12). If for this G we take G2 as its
fundamental domain and for each of its four vertices we independently assign an
arbitrary weighting, the phase diagram is as Figure 13.

The bounded closed set corresponding to a 0 slope (the region in light blue)
corresponds to the phase where there is a.s. exactly one connected component (a
spanning tree). Outside this set there are a.s.
inﬁnitely many connected compo-
nents (a spanning forest). This bounded set corresponds to a gaseous phase in the
dimer model (as in Figure 1 and Figure 13) or reduces to a single point in the liquid
phase.

24

Figure 13: Phase diagram of a square grid graph with fundamental domain 2 × 2.

There are also some interesting properties other than connectivity. Some are
just repetitions of the results on the dimer model ([KOS06]). In the liquid phase,
the oriented edge-edge correlations decay polynomially and the variances of the
height functions grow in the logarithm order. In the gaseous phases, the oriented
edge-edge correlations decay exponentially, and the variances of the height functions
are bounded. In the frozen phase, some of the height diﬀerences are deterministic.

7 Remarks and open questions

When we talk about the height, we mean the height function hM rather than
˜h(M,M0). The zero height change has a speciﬁc role in our problem.

The result that a measure of non-zero slope almost surely gives inﬁnite con-
nected components is true for any Z2-periodic graph. We conjecture that for gen-
eral Z2-periodic graphs it is still true that there is only one connected component
when slope is zero. Note that 0 slope is an integer point in Newton polygon, if the
weights are arbitrarily chosen, this is likely to correspond to a gaseous phase, and
the origin B = (0, 0) lies on its boundary, see Lemma 5.1.

Measure corresponding to slope 0 gives spanning trees whose branches are de-
scribed by LERW . When slope is not 0, there are bi-inﬁnite bands. Inside such
bands there are free spanning forests rooted at boundaries of bands, which are
bi-inﬁnite paths. It is interesting to see what such paths are.

When the slope is zero and the condition ((cid:63)) is veriﬁed, the toroidal dimer
measure on GN and the wired-spanning-tree measure on GN converge to the same
limiting measure. By this fact we may conclude that their asymptotic entropies are
the same. In fact, [CKP01] states that the asymptotic entropy of a region depends
loosely on the boundary height function. For spanning-tree measures on GN , the
boundary height function is given by the winding of a LERW killed at boundary,

25

BBxyConnectedDisconnectedand by geometric intuition this is about zero when renormalized by N . For the
toroidal dimer measure in our case, the slope is zero.

References

[BdT10] C´edric Boutillier and B´eatrice de Tili`ere. The critical Z-invariant Ising model
via dimers: the periodic case. Probab. Theory Related Fields, 147:379–413, 2010.

[BLPS]

Itai Benjamini, Russel Lyons, Yuval Peres, and Oded. Schramm. Uniform span-
ning forests. The Annals of Probability, 29:1–65.

[BP]

Robert Burton and Robin Pemantle. Local characteristics, entropy and limit
theorems for spanning trees and dominos tilings via transfer-impedance. The
Annals of Probability, 21:1329 – 1371.

[Chh12]

Sunil Chhita. The height ﬂuctuations of an oﬀ-critical dimer model on the
square grid. J. Stat. Phys., 148(1):67–88, 2012.

[CKP01] Henry Cohn, Richard Kenyon, and James Propp. A variational principle for

domino tilings. J. Amer. Math. Soc., 14(2):297–346 (electronic), 2001.

[DG15]

Julien Dub´edat and Reza Gheissari. Asymptotics of height change on toroidal
Temperleyan dimer models. J. Stat. Phys., 159(1):75–100, 2015.

[For93]

[FR37]

Robin Forman. Determinants of Laplacians on graphs. Topology, 32(1):35–46,
1993.

RH Fowler and GS Rushbrooke. An attempt to extend the statistical theory of
perfect solutions. Transactions of the Faraday Society, 33:1272–1294, 1937.

[H¨ag95] Olle H¨aggstr¨om. Random-cluster measures and uniform spanning trees. Stochas-

tic Process. Appl., 59(2):267–275, 1995.

[Kas61] P. W. Kasteleyn. The statistics of dimers on a lattice : I. the number of dimer

arrangements on a quadratic lattice. Physica, 27:1209–1225, December 1961.

[Kas67] P. W. Kasteleyn. Graph theory and crystal physics.

In Graph Theory and

Theoretical Physics, pages 43–110. Academic Press, London, 1967.

[Ken]

Richard Kenyon. Spanning forests and the vector bundle laplacian. The Annals
of Probability, 39(5):1983–2017.

[Ken97] Richard Kenyon. Local statistics of lattice dimers. Ann. Inst. H. Poincar´e

Probab. Statist., 33(5):591–618, 1997.

[KO06] Richard Kenyon and Andrei Okounkov. Planar dimers and harnack curves.

Duke Math. J., 131(3):499–524, 2006.

[KOS06] Richard Kenyon, Andrei Okounkov, and Scott Sheﬃeld. Dimers and amoebae.

Ann. of Math. (2), 163(3):1019–1056, 2006.

[KPW00] R.W. Kenyon, J.G. Propp, and D.B. Wilson. Trees and matchings. Electron.

J. Combin, 7(1):R25, 2000.

26

[KU08]

Takahiro Kazami and Kˆohei Uchiyama. Random walks on periodic graphs.
Trans. Amer. Math. Soc., 360(11):6065–6087, 2008.

[LPS]

Russel Lyons, Yuval Peres, and Oded. Schramm. Markov chain intersections
and the loop-erased walk. Annales de l’Institut Henri Poincare: Probability and
Statistics, 39.

[Pem]

Robin Pemantle. Choosing a spanning tree for the integer lattice uniformly.
The Annals of Probability, 19:1559 – 1574.

[Tem74] H. N. V. Temperley. In Combinatorics: Proceedings of the British Combinatorial

Conference 1973, 13:202 204, 1974.

[TF61]

H. N. V. Temperley and Michael E. Fisher. Dimer problem in statistical
mechanics—an exact result. Philos. Mag. (8), 6:1061–1063, 1961.

[Wil]

D.B. Wilson. Generating random spanning trees more quickly than the cover
time. Proceedings of the twenty-eighth annual ACM Symposium of Theory of
Computing, pages 296–313.

27

