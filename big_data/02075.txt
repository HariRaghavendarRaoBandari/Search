6
1
0
2

 
r
a

M
 
7

 
 
]

.

C
O
h
t
a
m

[
 
 

1
v
5
7
0
2
0

.

3
0
6
1
:
v
i
X
r
a

A New Approach To Inverting Backscatter and Scatter from Photon-Limited Lidar Observations

Willem J. Marais1,2,†, Robert E. Holz2, Yu Hen Hu1, Ralph E. Kuehn2, Edwin E. Eloranta3, and Rebecca M. Willett1

1Department of Electrical and Computer Engineering (ECE), University of Wisconsin-Madison, Madison, Wisconsin, USA

2Cooperative Institute for Meteorological Satellite Studies (CIMSS), University of Wisconsin-Madison, Madison, Wisconsin, USA

3Space Science and Engineering Center (SSEC), University of Wisconsin-Madison, Madison, Wisconsin, USA

†Corresponding author: willem.marais@ssec.wisc.edu

March 8, 2016

Abstract

Atmospheric lidar observations provide a unique capability to directly observe the vertical column of cloud and aerosol
scattering properties. However, detector and solar background noise hinder the ability of lidar systems to provide reliable
backscatter and extinction (scatter) estimates. Standard methods for solving this inverse problem are only effective with
high signal-to-noise ratio observations that are only available at low-resolution in uniform scenes. This paper describes a
novel method for solving the inverse problem with high-resolution, lower signal-to-noise ratio observations that are effective
in non-uniform scenes. Speciﬁcally, the noise associated with photon-counting lidar observations can be modeled using a
Poisson distribution, and state-of-the-art tools for solving Poisson inverse problems are adapted to the atmospheric lidar
problem. It is demonstrated through photon-counting HSRL (High Spectral Resolution Lidar) simulations that the proposed
algorithm yield inverted backscatter and scatter cross-sections (per unit volume) with smaller MSE (Mean Squared Error)
values at higher spatial resolutions, compared to the standard approach. A limited case study of real experimental data is
also provided where the proposed algorithm is applied on HSRL observations and the inverted optical depths are compared
against those of AERONET. In addition, three case studies on real data are also provided to juxtapose the inversion results of
the new and the standard approaches.

Contents

1 Introduction

2 Preliminary - The unknowns & the HSRL and noise models

3 The standard approach in inverting the backscatter and scatter cross-sections

4 A new approach in inverting for the backscatter and scatter cross-sections

5 Experimental results

6 Case studies to evaluate the new approach

7 Conclusion and future work

A Thinning a Poisson distributed matrix in creating the training and testing matrices

1

3

6

7

12

14

19

20

20

B Proof of Theorem 1

1

Introduction

Atmospheric lidar systems measure the proﬁles of attenuated
backscatter. From these the proﬁles of backscatter and extinction
cross-sections are inferred, and are used in radiative transfer mod-
els of climate models [1]. Examples of lidar systems are the NASA-
CNES CALIPSO (Cloud-Aerosol Lidar and Infrared Pathﬁnder
Satellite Observations) mission, the NASA Langley HSRL (High
Spectral Resolution Lidar) instrument, the NASA CPL (Cloud
Physics Lidar) instrument, the MPL (Micro-Pulsed Lidar) network
and the upcoming ESA-JAXA ATLID (ATmospheric LIDar) which

1

will be on the Earthcare satellite [1, 2, 3, 4, 5]. Another example
of ground-based lidar is the Wisconsin-Madison HSRL system,
which is the ﬁrst system for which we have developed scatter
inference tools, with the intention to extend it to other lidar in-
struments in the near future. All these lidar systems provide the
earth science community with the unique capability to resolve the
atmospheric vertical structure with very high sensitivity.

For the most part the lidar signal of interest is typically weak
when observing tenuous aerosols and clouds. The implication is
that the photon detectors employed are typically photon starved,
and the detectors produce noisy energy rate measurements ac-

companied with spurious detections due to the dark current [6].
Furthermore, the solar background is another noise source and it
further increases the difﬁculty to detect small changes in the signal.
An extra complication is that the lidar detector noise is in most
cases non-Gaussian, and the noise variance is signal dependent
[6, 7]. Thus, statistical estimators well known in the atmospheric
science community, such as the “optimal estimator” or Tikhonov
regularization1 [8, 9], cannot be directly applied unless a substan-
tial amount of averaging is employed so to invoke the central limit
theorem with a strong set of assumptions.

The predominant methodology used by lidar experts to esti-
mate the cross-sections is to 1) divide the noisy images into non-
overlapping blocks, 2) average the noisy observations in each
block to reduce the noise variance, 3) solve for the unknowns
using a physical model for each averaged block and 4) employ a
lowpass ﬁlter across the range and temporal axes after the calcula-
tions to suppress residual noise [10, 11, 12, 13]. The size of each
block is not always ﬁxed, it depends on the lidar expert’s own
judgement on how much averaging should be done. Averaging
can introduces unnecessary biases, since most lidar observations
of clouds and aerosols are not spatially uniform. Lowpass ﬁltering
can sometimes yield satisfactory results, but it is not suited for
features that have high frequency components, such as clouds that
have sharp boundaries. Furthermore, current parameter inversion
techniques are ill-equipped to reliably invert the desired physical
parameters. For example, in single channel lidar systems such as
CALIOP a type of ﬁxed point iteration algorithm is used which is
not always numerically stable [12, § 2.3.2.3].

1.1 Contributions

The primary contribution of this paper is the introduction of sta-
tistical estimators that use the noise physical model in conjunction
with a lidar physical model, to ﬁt the estimates of the backscat-
ter and scatter cross-sections onto the noisy observations. The
estimates are constrained to be spatially piecewise smooth. With
this approach 1) spatial information of the noisy observations is
utilized and 2) the discontinuities and high frequency components
of the backscatter and scatter cross-sections are preserved. The
algorithms presented in this paper are based on sound theory that
guarantees uniqueness of an estimate under reasonable conditions.
We demonstrate that an immediate beneﬁt of the new algorithms,
is that fewer observations have to be accumulated to increase the
SNR (Signal to Noise Ratio), in order to obtain accurate estimates
of the backscatter and scatter cross-sections.

We speciﬁcally focus on inverting the particulate backscatter
and scatter cross-sections from low SNR photon-counting HSRL
observations. The noise of photon-counting systems can be ac-
curately modeled by a Poisson distribution [6]. Our intention is
to extend our research to single channel lidar system, and other
photon detection systems in the near future, such as analog mode
PMT lidar systems, where the noise is Compounded Poisson [7].
The statistical estimator that we employ is known as the TV
(Total Variation) PMLE (Penalized Maximum Likelihood Estima-
tor). Compelling results have been obtained with the TV-PMLE
in medical imaging systems [14, 15]. Some medical imaging sys-
tems, such as PET (Positron Emission Tomography), low-dose
CT (Computed Tomography) and confocal microscopy, also use
photon-counting detectors and have the same noise characteristics
as photon-counting lidar system [16]. We demonstrate, through
simulated observations and four case studies on real data, that the

backscatter and scatter cross-sections can be inverted at a lower
SNR with smaller MSE (Mean Squared Error) and normalized
MSE values compared to the standard inversion approach. We
achieve this by using the algorithm SPIRAL (Sparse Poisson Image
Reconstruction ALgorithm), and an adaptation of the algorithm
log-SPIRAL [14, 15]. These algorithms are well established and
are numerically stable under reasonable assumptions, such as the
convexity of the optimization problems.

Our secondary contribution is a novel approach to estimat-
ing the lidar ratio2 directly, compared to customary approach of
estimating the scatter cross-sections directly. The approach we
propose has the beneﬁt of exploiting the inverted backscatter cross-
sections to constrain the estimating of the lidar ratio, and hence
the scatter cross-sections.

Although we mainly focus on ground based HSRL photon-
counting systems, we believe that the research we present is a
necessary step to further improve upon the backscatter and scat-
ter inversion techniques for all types of single channel lidar sys-
tems, such as the space-based analog lidar systems CALIOP. In
particular, it is necessary to consider the noise model if further
improvements are to be made on backscatter and scatter inversion
techniques. This is apposed to either assuming that the noise is
Gaussian, or to not take the noise model in account at all.

1.2 Paper outline
The paper starts off in §2 with an introduction to the physical
observation model and its connection to the unknown backscatter
and scattering cross-sections of interest. Included in this section
are the assumptions related to the physical models. Next in §3 we
describe the standard approach to estimating the unknown coef-
ﬁcients and other contributions that had been made in inferring
the unknown parameters. Our proposed approach is presented in
§4. This section includes brief overviews of the PMLE and the TV
seminorm. In §5 we present two simulation results to compare the
performances of the standard and new approaches against each
other. Thereafter in §6 we present four case studies to demonstrate
the capabilities of the proposed approach. The paper ends with
the conclusion and discussion of future work in §7.

1.3 Assumptions and naming convention
When we refer to the backscatter cross-section, we speciﬁcally
refer to the backscatter cross-section per unit volume. The same
applies to the extinction cross-section. The backscatter (extinction)
cross-section is also known as the backscatter (extinction) volume
coefﬁcient in the realm of atmospheric science [12, 17]. Through-
out this paper we assume that there is negligible absorption, by
any atmospheric particulates, at the laser pulse wavelength. There-
fore, the extinction cross-section is assumed to be equal to the
scatter cross-section in this paper. Thus, we use the term scatter
cross-section throughout the paper.

We primarily focus on the backscatter cross-section estimated
from the parallel polarized photon-counts. It is assumed that an
estimate of the depolarization coefﬁcients are available, which are
used to normalize the backscatter cross-section when estimating
for the scatter cross-section.

1.4 Notation convention
The set of non-negative real numbers is denoted by R+, and the
set of non-negative integers is denoted by Z+. To save space, we

1Tikhonov regularization is also known as ridge regression.

2The lidar ratio is also known as the extinction-to-backscatter ratio [12, § 2.3.1.1].

2

squeeze a double summation term ∑N
n=1,k=1.
The vector en ∈ RN is a canonical vector. The symbol 1N ∈ RN
represents a vector of N ones.

k=1 into one ∑N,K

n=1 ∑K

In several of the models described in this paper, it is more
convenient to use pointwise multiplication operations than linear
algebra multiplication operations. The symbol · indicates that two
matrices are multiplied pointwise. For example, if A, B ∈ RN×K,
we have that

n [A · B]ek = [eT
eT

n Aek][eT

n Bek],

(1)

+

and β ∈ RN×K

where with a slight abuse of notation the en and ek vectors are of
different lengths.
We denote the particulate backscatter and scatter cross-sections
by the symbols ν ∈ RN×K
; these are the pri-
mary unknown parameters of interest which are introduced in
§2. Whenever ν is estimated with say algorithm number one, its
estimate will be denoted by ˆν alg−1; the same applies to β.
The matrix Q ∈ RN×N is a lower triangular matrix of ones,
scaled by a constant ∆r. The constant ∆r is the range sampling
resolution of the lidar instrument. Each row of Q represent the
Riemann integral:

+

n [Qβ]ek = ∆r
eT

n∑

l=1

eT
l βek.

(2)

Hence, when Q acts on a matrix β, the output is the scaled cumu-
lative sum of each column of β.
The Poisson noisy observations of the HSRL molecular and
combined channels (deﬁned in §2.4) are denoted by Ym ∈ ZN×K
and Yc ∈ ZN×K
. The letter m is an abbreviation of the word
molecular, and c is an abbreviation of the word combined. The
symbol ι ∈ {c, m} is used to index c and m. The mean energy rates
of the Poisson noisy observations are denoted by E[Yι] = Sι, and
each entry in Yι is statistically independent from each other.

+

+

2 Preliminary - The unknowns & the HSRL and

noise models

+

+

and backscatter ν ∈ RN×K

A lidar image consists of N range bins (row axis) and K proﬁles
(column axis); a proﬁle refers to a single column. The range and
proﬁles are expressed in meters and seconds. The unknown pa-
rameters that we consider in this paper are the particulate scatter
β ∈ RN×K
cross-sections. The units of
both these coefﬁcients are m−1. We only refer to depolarization
measurements when necessary, and it is assumed that we already
have an estimate of the depolarization measurements. The scatter
cross-section describes the attenuation of the laser pulse due to
scattering, and are always non-negative if multiple scattering is ex-
cluded from the scatter cross-section. The energy that is scattered
back towards the lidar instrument is described by the backscatter
cross-section. The relation between the backscatter and scatter
cross-sections are described in §2.2.

In addition to the unknowns β and ν, we are also interested
in what are known as the optical depth and the lidar ratio. The
optical depth is the integration of the scatter cross-section between
two ranges. It is denoted by the symbol τ ∈ RN×K
and its relation
to β is τ ≡ Qβ, where Q ∈ RN×N represents integration (see §1.4).
The lidar ratio is the ratio between the scatter and backscatter
cross-sections and is denoted by µ ≡ β/ν. The reciprocal of µ
represents the fraction of the total scattering observed by the lidar
instrument, and is referred to as the backscatter phase function.

+

In the following section we give visual examples of the un-
knowns. To ease the introduction to the HSRL (High Spectral
Resolution Lidar) system, we ﬁrst describe the single scatter lidar
equation. It models the relation between what a lidar instrument
measures and the unknowns β and ν. With single channel lidar
systems, the inversion amounts to having more unknowns than ob-
servations. In contrast an HSRL system measures can measure the
scatter cross-section almost independently from the backscatter
cross-section, by taking advantage of molecular doppler broad-
ening [10, 2]. Hence, in an ideal case when there is no noise, the
unknowns can be uniquely solved for with the observations of an
HSRL system. We end the section by stating the assumptions we
make throughout the paper in regards with the lidar models.

2.1 Visual examples of the unknown parameters
Figure 1 shows an example image of inverted particulate backscat-
ter β using the standard approach algorithm (see §3); the lidar
observations are from the Wisconsin-Madison ground based HSRL
instrument [10, 18] (see §2.4). This purpose of Figure 1 is to show
the non-uniformity of a typical scene. The HSRL instrument is
stationary, therefore we see the backscatter of the atmosphere as it
moves across the instrument. The backscatter image was averaged

Figure 1: An example of the inverted particulate backscatter cross-
section of the Wisconsin-Madison HRSL system [10, 18]. A signiﬁ-
cant amount of averaging was done to increase the SNR, which
has the detrimental effect of introducing biases due to the non-
uniformity of clouds and aerosols. Each hour consists of 770
columns and each 1 km range consists of about 133 rows. The
vertical noisy stripes are due to the complete attenuation of the
laser pulse by the clouds.

from a resolution of 7.5m (row-axis) by 2.5s (column-axis) to 30m
by 30s, thus the detector noise is not clearly visible. Between 0km
and 3km at 3:00 various small dense clouds are present, which
have backscatter cross-section of about 10−3 or larger. To the left
and right of these low level clouds are faint aerosol layers which
have backscatter cross-section ranging from 10−5 to 10−6. Various
ripples are present on top of the aerosol layers and various “holes”
or “empty” horizontal layers are present below 4km. Above 8km a
large cloud is present that has backscatter cross-section that ranges
from 10−6 to 10−3.

Figure 2 show examples of the inverted backscatter and scatter
cross-sections of a single proﬁle, using the standard approach
algorithm (see §3). The lidar observations were averaged over
1min. The inverted scatter cross-sections are much smoother than

3

Inverted backscatter via standard approach - 10-Aug-2013 - HuntsvilleUTC time00:0003:0006:00Range [km]2468101214log10 Backscatter-7.5-7-6.5-6-5.5-5-4.5-4-3.5-3wavelength of interest. Nitrogen gas (N2) and oxygen (O2) are ex-
amples of molecules that scatter radiation at visible wavelengths.
Examples of particulates are smoke and ice particles. Let r[m] de-
note the distance between the point at which the laser pulse is cur-
rently and the lidar instrument. Let ˜β(r) = ˜βp(r) + ˜βm(r) repre-
sent the scatter cross-sections of both particulates and molecules at
range r. The attenuation of the laser pulse is denoted by the trans-

mittance exp(cid:0)−(cid:82) r
dar instrument is directly proportional to ˜ν(r) exp(cid:0)−(cid:82) r
tor of exp(cid:0)−(cid:82) r

˜β(z)dz(cid:1); this follows from the Beer-Bouguer-
˜β(z)dz(cid:1),
˜β(z)dz(cid:1). The mean energy rate measured by a

where ˜ν(r) = ˜νp(r) + ˜νm(r) is the particulate and molecular
backscatter cross-section. As the backscattered energy traverses
back towards the lidar instrument, it is attenuated again by a fac-

Lambert’s law [17]. The subscripts p and m are abbreviations of
the words particulate and molecular.

At range r the energy that is scattered back towards to the li-

0

0

0

lidar instrument is modeled by
−2

˜S(r) = ˜x(r) ˜ν(r) exp

(cid:19)

(cid:18)

(cid:90) r

0

˜β(z)dz

+ b,

(3)

where b is the background energy rate which includes both the
dark current of the detector and the solar background radia-
tion. Since the energy of the laser pulse is attenuated twice by

˜β(z)dz(cid:1), the factor 2 is present in (3). The molecular

exp(cid:0)−(cid:82) r

backscatter and scatter cross-sections can be precomputed using a
temperature and pressure proﬁle of the atmosphere [10].

0

The function ˜x(r) includes various calibration terms and is ap-

proximated by

˜x(r) =

E0ADcl

2r2

ηξ(r),

(4)

where E0 [J] is the transmitted laser energy, AD is the area of the
telescope, AD/r2 is the solid angle, cl is the speed of light and
η ∈ [0, 1] is the system optical efﬁciency. The function ξ(r) encom-
passes two non-ideal optical properties, since the laser pulse is
not a perfect impulse. The ﬁrst is the distribution of the laser en-
ergy over the target plane. The second is known as the geometric
overlap function. The geometric overlap function describes the
FOV (Field Of View) mismatch with the laser pulse. We assume
throughout this paper that all the calibration parameters have
already being estimated.

2.3.1 Discretizing single scatter lidar equation

Let N denote the total number of range bins (sampling points),
uniformly spaced, for one laser shot. Each range bin n corresponds
to a range rn ∈ [0, R] and the sampling time interval between
each range bin is ∆ts. Let K denote the total number of columns.
The time interval between consecutive laser shots is considered
constant and is larger than N∆ts.

The matrices β ∈ RN×K

represent the particulate
scatter ˜βp(r) and backscatter ˜νp(r) cross-sections (see §2.3). The
matrices βm ∈ RN×K
represent the molecular
scatter and backscatter cross-sections. The discretized version of
(3) is deﬁned as

and ν ∈ RN×K
and νm ∈ RN×K

+

+

+

+

S = x · (ν + νm) · exp (−2τ) + b
τ = Q(β + βm)
S, x, τ ∈ RN×K
,

+

(5)
(6)
(7)

where Q is an integrator matrix (see §1.4). The integration is
done across each column. The symbol · represent the pointwise

4

Figure 2: The black graph shows the inverted backscatter cross-
section of the 1min averaged HSRL observations, corresponding
to ﬁgure 1, using the standard approach algorithm (see §3). The
red graph shows the corresponding inverted scatter cross-section.

the backscatter cross-sections, since the noise suppression of the
standard approach was set to be very aggressive. Figure 2 gives
a rough idea of how the backscatter and scatter cross-sections
are related. The scatter cross-sections can be about two orders of
magnitude larger than the backscatter cross-sections, and it more
or less have the same upward and downward trends compared to
the backscatter cross-sections.

2.2 The relation between the backscatter ν and scatter β

cross-sections

In theory the backscatter phase function, the ratio between ν and
β, is non-negative and has no upper bound. For example ori-
entated platelet ice-crystals have this speciﬁc property, if a lidar
instrument’s laser and receiving axes are aligned with the nadir
axis [19]. Most lidar systems’ laser and receiving axes are at an off-
nadir angle, such as CALIP and the UW-Madison HSRL [10, 20].
Hence, it can be argued that only in exceptional scenarios would
the backscatter phase function exceed the value of one. Thus,
throughout the rest of this paper we assume that that the backscat-
ter cross-section is always less or equal to the scatter cross-section.

2.3 The single scatter lidar equation

To ease the introduction to the HSRL system, a brief intuitive
overview of the so called single scatter lidar equation is given
in this section for single polarization. The single scatter lidar
equation is based on several assumption, of which the following
two are the most important: 1) multiple scattering is negligible and
2) at any range r the atmosphere in the FOV is plane-parallel [17,
21]. For a detailed derivation of the single scatter lidar equation,
the reader should refer to [22] or [23]. Throughout this subsection
the continuous function versions of β and ν are used, and these
are denoted by ˜βp(r) and ˜νp(r). The underscript p and index r are
explained in the next paragraph.

When a visibile wavelength laser pulse traverses the atmo-
sphere, its intensity is attenuated by both molecules and particu-
lates. Scattering, the redirection of energy, is the primary contribu-
tor to the attenuation when there is negligible absorption at the

10-810-710-610-510-410-310-2Scatter and backscatter [m−1]2468101214Range [km]10-Aug-2013 3:47 UTC - HuntsvilleScatterBackscattermultiplication between two matrices. The integration of the scatter
cross-sections, τ, is called the optical depth.

The element S(n, k) is the mean energy that the instrument
measures, originating from range bin n and column k. The relation
between S(n, k) and (3) is
˜S(r)dt ≈

˜S(rn)dt = ∆ts ˜S(rn).

S(n,·) =

(cid:90)

(cid:90)

(8)

∆ts

∆ts

2.4 The HSRL physical models
Scattering due to molecules can be observed separately from scat-
tering due to particulates, and this is what an HSRL instrument
does [10, 24]. Molecules are in constant motion and their velocities
are stochastic. The instrument is stationary, hence the wavelength
at which the molecules scatter the photons toward the observer is
Doppler-shifted [17, p. 262]. In effect the molecules broadens the
frequency spectrum of the single frequency laser pulse as a func-
tion of atmosphere temperature, and this is referred to as Doppler
broadening. In the context of this paper, doppler broadening due
to aerosol particles is negligible compared to molecular Doppler
broadening.

A typical HSRL system has two channels, which we will re-
fer to as the combined and molecular channels. With these two
channels the inversion of the backscatter ν and scatter β are more
constrained than a single channel lidar system. Prior to the two
channels, just before they are split into separate channels, the solar
background energy rate is reduced by a bandpass ﬁlter [2, 24]. A
band reject ﬁlter, such as an iodine ﬁlter, can be used to suppress
the particulate contribution in the single scatter lidar equation;
refer to Figure 1 in [2] for an illustration of this. The corresponding
physical model for the molecular channel, after the band rejection,
is

Sm = xm · (ν · θm + νm · φm) · exp (−2τ) + bm.

(9)
The calibration term θm ∈ [0, 1] represents the attenuation due to
solar bandpass and the molecular band-reject ﬁlters. The calibra-
tion term φm ∈ [0, 1]N×K represents the fraction of the molecular
broadened signal that is not ﬁltered by the solar bandpass and
band-reject ﬁlters. And bm represent the solar background energy
rate with the dark current energy rate for the molecular channel.
The coefﬁcients xm also include the system optical inefﬁciencies
for the molecular channel.

The second channel - the combined channel, corresponds to
the signal just after the solar bandpass ﬁlter. The corresponding
physical model for the combined channel is

Sc = xc · (ν · θc + νm · φc) · exp (−2τ) + bc,

(10)
The calibration term θc ∈ [0, 1] represents the attenuation due to
solar bandpass ﬁlter; it is larger than θm. The calibration term
φc ∈ [0, 1]N×K represents the fraction of the molecular broadened
signal after the solar bandpass ﬁlter. The coefﬁcients xc, like the
xm, include the system optical inefﬁciencies that is speciﬁc to the
combined channel.
Figure 3 shows an example of noisy observations of Sm and
Sc, where Yι ∼ Poisson (Sι). These noisy observations are of a
single column of the observations that were used to create Fig-
ures 1 and 2. Observe that Ym is smoother than Yc, since the
molecular channel primarily measures the attenuated backscatter
of molecules, whereas the combined channel is very sensitive to
particulate backscatter. This is due to θm (cid:28) θc. Also notice also
that rate at which the photon counts decrease, which is due to
the acceptance solid angle AD/r2 and the attenuation of the laser
pulse.

Figure 3: An example of noisy observations of molecular Sm and
combined Sc channels, where Yι ∼ Poisson (Sι). These noisy
observations are of a single column of the observations that were
used to create ﬁgures 1 and 2. The range resolution is 7.5m and
the temporal resolution of the proﬁle is 2.5s.

2.5 The physical noise model

It is well-known that the noise of a photon-counting system can
be modeled by a Poisson PMF (Probability Mass Function) [6, 16].
Let Yι ∈ ZN×K
be the Poisson noisy observations of Sι, where
ι ∈ {c, m}. The Poisson PMF of Yι is deﬁned as

+

N∏

P(Yι = y) =

n=1
n E[Yι]ek
n (y)ek,

Sι,n,k = eT
yn,k = eT

K∏

k=1

exp(−Sι,n,k)

(Sι,n,k)yn,k

yn,k!

(11)

(12)
(13)

where en and ek are canonical vectors and with a slight abuse of
notation these two vector differ in lengths (see §1.4). The PMLE
(Penalized Maximum Likelihood Estimator) is a well-known tech-
nique which uses the noise model to ﬁt the desired parameters
to the noisy observations, where the desired parameters are con-
strained to enforce some a priori information [25, 16, 26]. We show
in §4 how the HSRL physical models are use in conjunction with
the Poisson noise model to infer the scatter β and backscatter ν
cross-sections.

2.6 Further assumptions about HSRL models

The HSRL instrument data that are used in this paper is from the
Wisconsin-Madison HSRL [18, 10]. The telescope and detector con-
ﬁguration is mono-axial and avalanche Geiger-mode photodiodes
are used as photon detectors [27]. The vertical spatial resolution
is 7.5m and the horizontal temporal resolution is 2.5s. The wave-
length of the laser pulse is 532nm. Refer to [10] for a complete
description of the Wisconsin-Madison HSRL system.

There are several non-ideal system characteristics that we don’t
take in account in this paper. These non-ideal characteristics are
non-trivial to solve; we list these for the sake of clarity.

5

Photon counts100101102103Range [km]246810121410-Aug-2013 03:45:27 UTC - HuntsvilleYcYm2.6.1 Multiple scattering

The heuristic derivation of the single scatter lidar equation in §2.3
assumes that the scattered laser energy, is either scattered 1) di-
rectly towards the receiver or 2) outside of the lidar receiver ﬁeld of
view. This is problematic if the ratio between the radius of the par-
ticulates and the laser wavelength is approximately greater than
1/2π. According to Mie theory, the forward diffraction increases
as the radius of the particulates increases. Thus, the assumption
of the single scatter lidar equation does not hold in such cases
and multiple scattering becomes more apparent. Decreasing the
FOV angle decreases the incoming energy rate due to multiple
scattering [28].

2. Next the averaged energy rates are plugged into (14) and (15)

to obtain estimates of ν and Qβ.

3. In order to obtain an estimate of β, the estimate of Qβ has to
differentiated. A lowpass ﬁlter is used prior to applying a
discrete derivative so to prevent the aggravation of any noise.
For example in [10] one lowpass ﬁlter is applied across the
temporal axis, then another lowpass ﬁlter on the range axis.
The passband widths of the lowpass ﬁlters are set manually.

Algorithm 1 concisely describes the necessary steps to invert for
ν and β. Figure 2 shows an example of inverted backscatter and
scatter cross-sections of Algorithm 1.

2.6.2 Detector saturation

An avalanche Geiger-mode photodiode saturates when it is ex-
posed to signiﬁcant energy rates, and the saturation effect is non-
linear [27]. This occurs when the incoming photon rate exceeds the
linear regime of the detector. We only account for saturation due
to the transmitted laser pulse, and assume that the saturation due
to clouds is insigniﬁcant. Refer to [27] for more details in regards
about the non-linear saturation effects of avalanche Geiger-mode
photodiodes.

3 The standard approach in inverting the backscat-

ter and scatter cross-sections

Ideally when there is no detector noise and the calibration pa-
rameters are fully known, the unknowns ν and β can be solved
algebraically. We have

Algorithm 1 The standard approach in the inverting for the backscatter
ν and scatter β cross-sections. Typically the tuning parameters of FAvg
and FLow are set by a lidar expert or an automated system. Note that
whenever the unknown parameters are estimated with this algorithm, it
is indicated by a superscript alg − 1.
Let FLow(·) be a lowpass ﬁlter function, and let FAvg(·) be an
averaging function. And let FDiff(·) be a discrete derivative opera-
tor.
1: SAvg
2: SAvg
3: ˆν alg−1 ← plug SAvg
m into (14)
4: τalg−1 ← plug SAvg
m into (15)
ˆβ alg−1 = FDiff(FLow(τalg−1 − Qβm))
5:
ˆµ alg−1 = ˆβ alg−1/ ˆν alg−1
6:
7: return ˆν alg−1, ˆβ alg−1, ˆµ alg−1, ˆτ alg−1

c = FAvg(Yc)
m = FAvg(Ym)
c

and SAvg
and SAvg

c

− (Sm − bm) · φc
ν = νm · (Sc − bc) · φm
xc
xm
(Sm − bm) · θc
− (Sc − bc) · θm
xc
xm

(14)

3.1 An overview of other inversion methods

and

τ = Qβ
= − 1
2

loge

(cid:34) (Sc − bc) · θm

xc

− (Sm − bm) · θc
xm

νm · (φc · θm − φm · θc)

(cid:35)

(15)

(16)

− Qβm.

The scatter cross-section β can be obtained from τ using a discrete
derivative operation.

The standard approach relies on either block or moving aver-
aging to reduce the noise variance. With block averaging a lidar
scene is divided into non-overlapping blocks, and an average is
calculated for each block. With moving averaging a sliding block
is used, which is equivalent to a two-dimensional convolution of
the image with a normalized two-dimensional rectangular func-
tion. Typically block averaging is used, where the block averaging
is done over distinct features such as clouds and clear-sky. Mov-
ing averages are typically not used, since a pure molecular signal
can adversely bias the inversion of the scatter cross-section, when
averaging is done at a cloud boundary.

The standard approach of inverting the particulate backscatter
and scatter cross-sections from noisy observations can be summa-
rized into three steps [10].

1. The measured energy rates Yc and Ym are either block aver-
aged or a moving average is used to reduce the noise. The
rectangular block size of either averaging technique is manu-
ally set by a lidar expert.

6

Past research, similar to ours, has investigated inference of the
particulate backscatter ν and scatter β cross-sections. Our contri-
bution relies on a HSRL system that has the beneﬁt of not having
to make a priori assumptions about the lidar ratio, whereas some
of the cited contributions only use a single channel lidar system.
With a single channel lidar system stronger assumptions have to
be made about the relation between the scatter and backscatter
cross-sections, since two unknowns have to be estimated from one
set of observations. Hence, a direct comparison cannot be made
between this paper’s contribution and some of the contributions
cited in this section. Nevertheless, we list the past contributions
to highlight the advantages of the proposed method.

Averaging is the standard noise reduction method for lidar
observations in combination of other noise suppressing techniques
[10, 11, 12, 13]. In [10] a Savitzky-Golay lowpass ﬁlter is used
suppress residual noise prior to retrieving the particulate scatter
cross-section from HSRL observations (see step 3 of Figure 1)
[29]. This has the drawback of smoothing the desired signal itself
and inadvertently introducing signiﬁcant estimation biases to the
inverted cross-sections on top of the bias introduced by averaging.
The algorithm developed in [12] tries to avoid biasing due to
averaging, by selectively applying different amounts of averaging
on pre-classiﬁed features. In our contribution we try to do the
least amount of accumulations of photon counts, and use a penalty
function which does not impose over-smoothing constraints on the
estimated cross-sections and introduce less bias. We demonstrate
in §5 and §6 the backscatter can be inverted at a higer resolution
than the standard approach.

In [30] the physical model was transformed into linear system
which acts on a scatter cross-section vector. The scatter cross-
section vector is solved for by employing the iterative Levenberg-
Marquardt algorithm. The solution for the scatter vector is regu-
lated by choosing the number of iterations of the algorithm, and
this is achieved by using the L-curve method [30]. Although it is
not explicitly stated, it seems that it is implicitly assumed in [30]
that the noise is Gaussian distributed whereas in our approach we
use a more accurate Poisson noise model.

A recent suggested approach relies on a transform method to
remove high frequency components from the measured energy
rates of a single channel lidar system [31]. The transform method,
referred to as the empirical mode decomposition, decomposes the
measured energy rates into low and high frequency components
[31]. It appears that in [31] it is assumed that the noise can have
negative values and therefore is not Poisson, even though the
lidar instrument that [31] refers to employs photon-counting [32].
Again, our proposed approach uses the more accurate Poisson
noise model.

4 A new approach in inverting for the backscatter

and scatter cross-sections

Our goal with the new approach is to invert the scatter β and
backscatter ν cross-sections at lower SNRs compared to the stan-
dard approach. In other words a smaller number of photon-counts
have to be accumulated, vertically and temporally, to increase the
SNR of the observations in order to invert for β and ν. We achieve
this by ensuring that the estimated cross-sections adhere to sev-
eral constraints. A TV (Total Variation) smoothness constraint is
imposed on ν and β, which enforce the estimates to be piecewise
smooth. With block averaging the cross-section being estimated is
constrained to be a single value, whereas with the TV constraint
how much the estimate varies is limited. With block averaging the
estimate of a block is calculated independently from the rest of the
blocks, whereas with the TV constraint the whole image is taken
in account. As explained in §4.1, the TV constraint ensures that
the estimates are piecewise constant with few discontinuities. The
TV constraint imposes no restrictions on where the discontinuities
are and hence allows high-resolution estimates.

Figures 1 and 2 suggest that the backscatter and scatter cross-
sections can be approximated accurately with piecewise constant
functions, since both these cross-sections are piecewise smooth.
In addition to imposing a smoothness constraint on ν and β, we
want to use the inverted backscatter cross-sections ν to constrain
the inversion of the scatter cross-sections β. We motivate this
approach by noting that in the presence of Poisson noise, the
estimation of β is statistically ill-posed [33]. In other words, when
the estimation of β is not constrained, any small changes in the
observations - due to for example Poisson noise - can lead to
signiﬁcant changes to an estimate of β.

We achieve our goals by employing a well known technique:
the PMLE (Penalized Maximum Likelihood Estimator). The basic
idea of the PMLE is that we seek estimates which 1) are a good
ﬁt to the observed data as measured using the Poisson likelihood
in (11) and 2) adhere to our a priori model of piecewise smooth-
ness. This idea can be formulated as an optimization problem in
which we search over all candidate cross-sections, and choose the
cross-sections which minimize the sum of the negative Poisson
log likelihood and a penalty term which is smaller for piecewise
smooth cross-sections with small TV. The MLE use the noise model
to ﬁt the desired parameters on the noisy observations and it is

based on well established theorems [26]. The TV seminorm has
been used in several other signal-processing applications to pro-
mote piecewise smoothness with satisfactory results [14, 34, 15].
A regularization parameter is used to set the degree to which the
smoothness is promoted, and the regularization parameter is au-
tomatically set using a cross validation heuristic [15]. We adopt
the algorithms SPIRAL and log-SPIRAL to compute the PMLE
[14, 15].

In order to guarantee the uniqueness of the backscatter and
scatter estimates, the single scatter lidar equation has to be repa-
rameterized. The reparameterization and the formulation of the
TV-PMLE are discussed in the subsection §4.2. The algorithm
of the new approach is presented in §4.3. The conditions under
which the estimate of the scatter cross-section β are unique is
discussed in §4.4.

4.1 Overview of the MLE and the behaviour of the TV

seminorm

This section gives a brief overview of the MLE and the TV semi-
norm, to aid the reader who is unfamiliar with both these concepts.
The reader should refer to [8], [26] or any good statistics textbook
for more detailed information of the MLE technique.

4.1.1 The MLE and PMLE techniques

Suppose we observe the output of a linear system, where the obser-
vation are contaminated with AWGN (All White Gaussian Noise)
and the noise standard deviation is σ. Furthermore, suppose we
want to estimate the parameters from the observations, on which
the linear system acted. Denote the observations by y1, . . . , yN
and the linear system by Aω, where ω ∈ RK are the unknown
parameters and A ∈ RN×K. With this a noisy observation yn can
be modeled as
K∑

An,kωk + zn = eT

n Aω + zn,

yn =

(17)

k=1

where zn ∼ Gaussian (0, σ2) and the symbol An,k indicates that
we are selecting the nth row and kth column of the matrix A.

The basic idea of the MLE is to ﬁnd the parameters ω, for a
given set of observations y1, . . . , yN, that maximizes the joint PDF
(Probability Density Function) of the observations. This is nor-
mally referred to maximizing the likelihood function, since with
a PDF the parameters are held ﬁxed and the realization of the
random variables (e.g. the noisy observations) are variables. Max-
imizing the joint Gaussian likelihood function of white-Gaussian
noise, is equivalent the minimizing the negative logarithm of the
joint likelihood function. Hence, the parameter estimation of our
example is simply written by

ˆω = argmin
ω∈RK

N∑

n=1

(yn − eT

n Aω)2 = argmin
ω∈RK

(cid:107)y − Aω(cid:107)2
2.

(18)

If K = 1 such that ω ∈ R and A = 1 is a scalar, then the estimator
ˆω is simply the average of the observations. Note that if the noise
was not Gaussian and K > 1, the function to be minimized will be
different from (18).

If the column rank of the matrix A is K, then the MSE of ˆx can

,

(19)

(cid:16)

[ATA]−1(cid:17)

be analytically derived:

E[(cid:107)ω − ˆω(cid:107)2

2] = σ2tr

7

where tr (·) is the trace operator. So we can see that MSE of ˆω is
approximately directly proportional to σ2K/N. It clear that it is
preferable to have N (cid:29) K.
If it is not possible to have N (cid:29) K, it is required to constrain
the parameters ω by incorporating some a priori information.
Suppose we known a priori that the majority of the elements of ω
are zero. In other words, the parameter is known to be sparse. A
well known technique to constrain ω to be approximately sparse,
is the constraint the absolute value norm of ω:

(cid:107)ω(cid:107)1 =

|ωk|;

K∑

k=1

(20)

refer to [8, §3.4] for more detailed information about this con-
straint. To incorporate the absolute value norm constraint into
the optimization problem (18), we can reformulate the problem as
a Lagrange optimization problem. Suppose we want (cid:107)ω(cid:107)1 to be
upper bounded by say γ > 0. The Lagrange optimization problem
is then

ˆx(λ) = argmin
x∈RK

(cid:107)y − Aω(cid:107)2

2 + λ((cid:107)ω(cid:107)1 − γ),

(21)

where λ ≥ 0 is the Lagrange multiplier and ˆω(λ) shows that
the estimate depends on the value of the Lagrange multiplier. If
K = N and A is an identity matrix, the estimate ˆω(λ) has an
If A is not an identity matrix, various
analytical solution [8].
algorithms exist to obtain ˆω(λ), for example SpaRSA (Sparse
Reconstruction by Separable Approximation)[35]. The appropriate
Lagrange multiplier value λ is obtained by fulﬁlling the KKT
(Karush-Kuhn-Tucker) conditions [36].
If it is not known a priori what the upper bound of (cid:107)ω(cid:107)1 should
be, then λ is chosen using an error criteria or a cross-validation
technique. In this case the estimator (21), without the term λγ, is
known as a PMLE (Penalized MLE). And λ is called the regularizer
parameter, and is also known as the tuning parameter.

4.1.2 The TV seminorm
A variant of the TV seminorm of a vector ω ∈ RN, is the l1-norm
of the discrete derivative of the vector:

(cid:107)ω(cid:107)TV =

N−1∑

n=1

|ωn+1 − ωn|.

(22)

If (cid:107)ω(cid:107)TV is used a constraint in conjunction with the MLE tech-
nique, the discrete derivative will be approximately sparse. This
implies that the constrained estimate will be approximately piece-
wise constant. The amount of sparsity that is induced depends on
how large the regularizer parameter λ is.

Figure 4 illustrates these concepts, where a white-Gaussian
noisy signal has been denoised using the TV seminorm with two
different regularizer values. It also show the discrete derivative of
each denoised signal. Let n = 1, . . . , N. The true signal is

(cid:40)

ωn =

1 + (tn − 0.25)2
1.75 − tn

tn ∈ [0, 0.5)
tn ∈ [0.5, 1)

,

(23)

where tn = (n − 1)/N, N = 128 and the noisy signal is yn ∼
Gaussian (ωn, 0.05). Each denoised signal is the minimizer of the
optimization problem

ˆω(λ) = argmin
ω∈RN

(cid:107)ω − y(cid:107)2

2 + λ(cid:107)ω(cid:107)TV,

(24)

8

Figure 4: Examples of denoised signals using the TV seminorm.
Each denoised signal is a minimizer of (24) for different regular-
izer values. The topmost image shows the denoised signal when
λ = 0.05, and the image below it shows the sparsity of the discrete
derivative of the denoised signal. The third image shows when a
larger regularizer value λ = 0.5 is used, and the bottommost im-
age shows that the sparsity of discrete derivative of the denoised
signal has been increased.

where ω = [ω1, . . . , ωN]T and y = [y1, . . . , yN]T. The algorithm
FGP of [37] has been used to obtain the denoised signals.
The topmost image shows the denoised signal for λ = 0.05,
where in this case (cid:107) ˆω(λ)(cid:107)TV = 1.01. The image below it shows
the discrete derivative of the denoised signal. Observe that the
majority of the derivative coefﬁcients are close to being zero. The
third image shows the denoised signal for a larger regularizer
value λ = 0.5, where in this case (cid:107) ˆω(λ)(cid:107)TV = 0.42. The variation
of the denoised signal has been decreased, and its ﬁrst derivative
(bottommost image) is sparser compared to when λ = 0.05.

0.00.20.40.60.81.00.40.60.81.01.21.4λ=0.05Noisy signal yDe-noised signal ˆωTrue signal ω0.00.20.40.60.81.00.40.60.81.01.21.4λ=0.5Noisy signal yDe-noised signal ˆωTrue signal ω0.00.20.40.60.81.00.150.100.050.000.050.100.150.20λ=0.05Discrete derivative of ˆω0.00.20.40.60.81.00.150.100.050.000.050.100.150.20λ=0.5Discrete derivative ˆω4.2 Formulation of TV-PMLE optimization problem

and the algorithm

First in §4.2.1 we describe the formulation of the TV-PMLE when
estimating the backscatter cross-section ν. The inverted backscat-
ter is then used to constrain the estimation of the scatter cross-
section β, which is described in the following subsection §4.2.2.

4.2.1

Inversion of the backscatter cross-section ν

To estimate the backscatter, we reparameterize the HSRL mod-
els (9) and (10). Let fι(·) be the reparameterization of Sι, which is
deﬁned as

(25)
(26)

fι(ωι) = Bι · ωι + bι
Bι = xι · νm · φι · exp(−2Qβm)

(cid:18) ν · θι

(cid:19)

· exp(−2Qβ),

+

ωι =

+ 1N×K
(27)
νm · φι
where ωι ∈ RN×K
are the unknown parameters. The symbol ·
indicates pointwise multiplication and Q is the integrator matrix
(see §1.4). The matrix 1N×K ∈ RN×K is a matrix of ones. The
quantities Bι and bι are assumed to be known, as they can typically
be estimated via system calibration. With this formulation the
backscatter ν is a function of ωι and is expressed by

ωc − ωm

ν =

ωm · ac − ωc · am

, where aι =

θι

νm · φι

.

(28)

The divisions are pointwise operations.

With the MLE technique the estimate ˆωι is obtained, for a given
Yι, by minimizing the negative log-likelihood of (11) with respect
to the constraint ωι ∈ RN×K
. A penalty function is added to the
MLE to regularize the estimate of ωι. If is reasonable to assume
that ωι can be approximate with piecewise constant functions,
then an adequate penalty function is the TV seminorm; a brief
overview of the TV seminorm was given in §4.1. The speciﬁc TV
seminorm that is used in this paper is

+

(cid:12)(cid:12)ωn,k − ωn+1,k

(cid:12)(cid:12) +

(cid:12)(cid:12)ωn,k − ωn,k+1

(cid:12)(cid:12) ,

(29)

(cid:107)ω(cid:107)TV =

N−1,
K∑
n=1,
k=1

N,

K−1∑

n=1,
k=1

where the subscripts in this case are indices to the rows and
columns of the matrix ω. This variant of the TV seminorm is
known as the anisotropic TV seminorm.

The TV-PMLE is formulated by

(30)

ˆωι = argmin
ω∈Ωι

{(cid:96)(ω; Yι) + λ(cid:107)ω(cid:107)TV}
N [ fι(ω) − Yι · loge fι(ω)] 1K,

(cid:96)(ω; Yι) = 1T

(31)
where λ ≥ 0 is referred to as the regularizer parameter. The
vectors 1N ∈ RN and 1K ∈ RK are vectors of ones, and the symbol
· indicates that the matrices are multiplied pointwise. Throughout
this paper (31) is referred to as the loss function. A cross validation
heuristic is used to choose an appropriate regularizer parameter λ
[14].

The minimizer ˆωι is unique if the negative log-likelihood is
strictly convex, since the TV seminorm is convex. This will hold
true if none of the elements of Yι are zero. The algorithms SPIRAL
and log-SPIRAL guarantee convergence to a solution if 1) the
gradient of the loss function (31) is Lipschitz continuous and 2)
the objective function (30) is coercive [15, §III.D]. The loss function
(31) satisﬁes both these conditions; refer to [15] for more details.

9

Interpretation of ωι
The interpretation of ωι is as follows. Whenever there are very few
particulates in a region (the dark blue parts of Figure 1), the cor-
responding matrix values of β and ν will be approximately 10−7.
Furthermore, if a weak aerosol or cloud layer is present, the values
of β and ν will be close to 10−6 (the light blue parts of Figure 1).
Thus, optical depth will increase slowly as function of range. In
n exp(−2Qβ)ek will
other words, for a ﬁxed k the transmittance eT
decrease slowly as n increases. Overall, the columns of ωι will
have less pronounced exponentially decaying components when
considering scenes with tenuous aerosols and clouds.

Situations when an estimate of ωι will be inaccurate and how
to resolve it

If ωm is estimated over a dense feature, such as a water cloud, it
can potentially be inaccurate. This is speciﬁcally due to the trans-
mittance term exp(−2Qβ): A transmittance that decreases sharply
over a short range interval, cannot necessarily be accurately ap-
proximated with a piecewise constant function. To resolve this
issue, an alternative is to redeﬁne (25) and set Bι equal to 1N×K
. In other words, in this case, ωι represents the mean energy rate
of the channel without the background energy rate. Subsection
§4.6 describes a method for deciding whether Bι should be equal
to (26) or Bι = 1N×K.

4.2.2

Inversion of the scatter cross-section β

The inverted backscatter cross-section ˆν (see §4.2.1) can be used to
constrain the inversion of the scatter cross-section β. We do this by
estimating the lidar ratio µ using the inverted backscatter, since
there is a linear relation between the lidar ratio and the scatter
cross-section: β = ν · µ. Once we obtain an estimate of β, we
can then algebraically compute the estimate of the optical depth
τ. This is essentially the procedure described in Algorithm 2,
only Algorithm 2 also includes a cross validation procedure for
choosing the tuning parameters.
To estimate the lidar ratio, we reparameterize the HSRL mod-
els (9) and (10). Let gι(·) be the reparameterization of Sι, which is
deﬁned as

gι(µ, ˆν) = Cι · exp (−2Q [ ˆν · µ]) + bι
Cι = xι · ( ˆν · θι + νm · φι) · exp(−2Qβm),

(32)
(33)
where µ ∈ [1, ∞)N×K. The MLE technique is used to estimate
the lidar ratio by minimizing the negative log-likelihood of (11).
It is reasonable to assume that lidar ratio can be approximated
by piecewise constant functions. Furthermore in the atmospheric
science community the lidar ratio is typically assumed to be piece-
wise constant. Hence, the TV seminorm is used a penalty function
to regularize the estimate of µ. The TV-MPLE is formulated by

{(cid:96)(µ; Yc) + (cid:96)(µ; Ym) + λ(cid:107)ω(cid:107)TV}

(34)

N [gι(µ) − Yι · loge gι(µ)] 1K,

(35)
where the loss function (cid:96)(·,·) has been redeﬁned and λ ≥ 0 is the
regularizer parameter. The loss function (35) is not necessarily
strictly convex for all µ ∈ [1, ∞)N×K, unless bι = 0. Subsection
§4.4 describes for what values of µ are (35) strictly convex. Also
the gradient of (35) is not Lipschitz continuous, since exp(·) is not
a Lipschitz continuous function. Thus µ has to be constrained to a
closed subset of [1, ∞)N×K so that the conditions can be met under
which the log-SPIRAL algorithm converge to a minimizer.

ˆµ = argmin
µ∈[1,∞)N×K
(cid:96)(µ; Yι) = 1T

4.3 The algorithm and details regarding it
A succinct outline of the new algorithm is given in Algorithm 2.
To make Algorithm 2 more readable, the details regarding TV-
PMLE and the cross-validation are presented in Algorithm 2-a.
The backscatter cross-section is inverted between lines 2 and 6 in
Algorithm 2, and the inverted backscatter is denoted by ˆν alg−2.
Then ˆν alg−2 is used to invert for the lidar ratio between lines 8 and
10, and the inverted lidar ratio is denoted by ˆµ alg−2. Thereafter
the scatter cross-section and the optical depth are computed, and
these are denoted by ˆβ alg−2 and ˆτ alg−2.

N [ fι(ω) − Yι · loge fι(ω)] 1K
ˆωι = Algorithm 2-a [(cid:96)(ω; Yι), Yc, Ym, RN×K

Algorithm 2 The new approach in inverting for the particulate backscat-
ter ν and scatter β cross-sections. Note that whenever the unknown
parameters are estimated with this algorithm, it is indicated by a super-
script alg − 2.
1: /* Invert the backscatter cross-section */
2: Set (cid:96)(ω; Yι) = 1T
3: for all ι ∈ {c, m} do
4:
5: end for
(cid:104)
6: ˆν alg−2 = ( ˆωc − ˆωm)/( ˆωm · ac − ˆωc · am)
7: /* Invert the scatter cross-section */
8: Set (cid:96)(µ; Yι) = 1T
N
9: (cid:96)(µ; Yc, Ym) = (cid:96)(µ; Yc) + (cid:96)(µ; Ym)
10:
11:
12: ˆτ alg−2 = Q ˆβ alg−2
13: return ˆν alg−2, ˆβ alg−2, ˆµ alg−2, ˆτ alg−2

ˆµ alg−2 = Algorithm 2-a [(cid:96)(µ; Yc, Ym), Yc, Ym, M]
ˆβ alg−2 = ˆν alg−2 · ˆµ alg−2

gι(µ, ˆν alg−2) − Yι · loge gι(µ, ˆν alg−2)

(cid:105)

1K

+

]

Algorithm 2-a The TV-PMLE with cross-validation to estimate either
ωι or µ; see Algorithm 2.
Input: A loss function such as (cid:96)(ψ; Yc, Ym), the Poisson noisy ma-

trices Yc, Ym and the constraint set Ψ for ψ.
c ← Poisson Thinning (Yc)
, Ytst
c
m ← Poisson Thinning (Ym)
m , Ytst

{(cid:96)(ψ; Ytrn
c

m ) + λ(cid:107)ψ(cid:107)TV}
, Ytrn

1: Ytrn
2: Ytrn
3: for all λ in Λ do
ˆψ(λ) = argmin
4:
ψ∈Ψ

5: end for
∗ = argmin
6: λ
λ∈Λ
7: return ˆψ(λ∗)

(cid:96)( ˆψ(λ); Ytst
c

, Ytst
m )

The optimization problem in line 4 is solved using the SPIRAL
algorithm [15]. Since each column of Bι is strictly positive, the
estimates ˆωι(λ) are unique when Ytrn

is strictly positive.

In line 6 the regularization parameter is chosen that minimizes
the loss function with Ytst
. It can be argued that the KL (Kullback-
Leibler) divergence between Sι and f ( ˆω(λ)ι) is minimized in this
step. Next, in line 6 of Algorithm 2 the backscatter cross-section is
computed using ˆωc and ˆωm; refer to (28).

ι

ι

4.3.2 Scatter inversion algorithm - lines 8 to 10

As with the backscatter inversion algorithm, the lidar ratios are
estimated by varying a regularizer parameter λ. The set Λ will
likely be different from what was used for the backscatter inver-
sion algorithm, since lidar ratio smoothness constraint will be
different.
The loss function (cid:96)(µ; Yc, Ym) is not necessarily strictly con-
vex for all µ ∈ [1, ∞)N×K, and µ has to be constrained to a set
M ⊂ [1, ∞)N×K. Furthermore the set M has to be bounded, since
it is required that the gradient of the loss function is Lipschitz
continuous. The next subsection §4.4 deﬁnes the set M.

An adaptation of the log-SPIRAL algorithm is used to imple-
ment line 4 of Algorithm 2-a [14], where the gradient matrix of
(cid:96)(µ; Yι) is

(cid:20)

(cid:18)

∇(cid:96)(µ; Yι) = −2 ˆν · QT

(gι(µ; ˆν) − bι) ·

1N×K − Yι

gι(µ; ˆν)

(36)

Once the lidar ratio is estimated, in line 10 of Algorithm 2, the
scatter cross-section ˆβ alg−2 are estimated using both ˆµ alg−2 and
ˆν alg−2. Thereafter the optical depth, ˆτ alg−2, is computed by cu-
mulatively integrating every column of ˆβ alg−2.

4.4 Ensuring uniqueness of the inverted scatter cross-

section β

We will now show that Algorithm 2 can only invert scatter cross-
sections that have a total optical depth less than a predeﬁned
threshold. Without loss of generality assume that K = 1. The
Hessian matrix of the loss function (cid:96)(µ; Yι) (line 13 of Algorithm 2)
is

(cid:19)(cid:21)

.

Hι(µ) = 4 diag{ ˆν} QTD(µ)Q diag{ ˆν}
D(µ) = diag

(gι(µ; ˆν) − bι) ·

1N − Yι ·

(cid:26)

(cid:18)

(cid:19)(cid:27)

(37)

,

(38)

bι

[gι(µ; ˆν)]2

4.3.1 Backscatter inversion algorithm - lines 2 to 6

Algorithm 2-a is used to estimate ˆωc and ˆωm, in order to estimate
the backscatter cross-section. From lines 1 and 5, of Algorithm 2-a,
a cross-validation heuristic is used to ﬁnd the regularizer param-
eters that best constrain the estimates ˆωι. The cross-validation
heuristic requires two independent copies of the random ma-
trix Yι, and these can be created using Poisson thinning (see ap-
pendix §A) [14]. In lines 1 and 2 the Poisson noisy observations Yι
are thinned into two matrices Ytrn
ι + Ytst
] = 0.5 × Sι. The superscripts trn and tst are abbrevia-
ι
and E[Ytrn
tions of the words train and test.

, where Yι = Ytrn

and Ytst

Between lines 3 and 5 the unknown ˆωι is estimated by varying
the piecewise constant constraint with a regularizer parameter
λ. The regularizer parameter λ is selected from a list of non-
negative numbers Λ; for example Λ = {10−2, 10−1.8, . . . , 100.8, 10}.

ι

ι

ι

10

where the division is taken to be pointwise. The loss function
(cid:96)(µ; Yι) is strictly convex if the Hessian matrix Hι is positive deﬁ-
nite, and p.d. (positive deﬁniteness) is ensured if

gι(µ; ˆν) >

⇒ ˆτ = Q[ ˆν · µ] < − 1
2

loge

(cid:20)√

Yι · bι − bι

Cι

(cid:21)

(39)

(40)

.

(cid:112)Yι · bι

In other words, there is an upper bound limit on the optical depth
that can be uniquely estimated and the upper bound is inﬂuenced
by the background energy rate bι. This in turn restricts the range of
scatter cross-section that can be uniquely estimated. The constraint
set of µ is then

M =

µ ∈ [1, ∞)N×K : Hc(µ) and Hm(µ) are p.d.

.

(41)

(cid:110)

(cid:111)

An easy, albeit crude, approach to determine M, is to assume a
single lidar ratio for the whole scene and then ﬁnd the maximum
lidar ratio for which the Hessian matrices are p.d. The disadvan-
tage of this approach is that the lidar ratio upper bound can be
too conservative, since clear-sky portions of a scene could have
negligible lidar ratios.

4.4.1 Theoretical upper bound of the lidar ratio for given

backscatter cross-section

Suppose we want to know beforehand, for given backscatter cross-
section ν, whether the Algorithm 2 will be able to uniquely esti-
mate the lidar ratio µ. We can then deﬁne the range of lidar ratio
values for which the Hessian matrices of the loss functions (cid:96)(µ; Yι)
are strictly convex with high probability. Such a situation will arise
when a simulation scene is constructed to test the performance of
Algorithm 2. Or when an analysis is done to determine what the
range of background energy rates bι can be tolerated in a design
of an HSRL instrument, whilst ensuring that a predeﬁned range
of lidar ratios can be uniquely estimated with high probability.
We can probabilistically deﬁne the set M over which the esti-
mate ˆµ by Algorithm 2 is unique. We deﬁne the set Mι to be such
that for every µ ∈ Mι the Hessian matrix (37) is postive deﬁnite
with probability of at least ζ:

.

Mι =

µ ∈ [1, ∞)N×K : P(Hι(µ) is p.d.) ≥ ζ

(42)
Then the set M is deﬁned to be M ≡ Mc ∩ Mm. The following
theorem provides a means with which we can deﬁne M. It takes
in account that Algorithm 2 does not have perfect knowledge of
the backscatter cross-section ν.
Theorem 1. Let K = 1 and let ˆSι = fι ( ˆωι) represent the denoised Yι,
where E[Yι] = Sι. Suppose an oracle tells us that

(cid:110)

(cid:111)

n ˆSι
eT
δU

≤ eT

n ˆSι
nSι ≤ eT
δL

.

(43)

Then the lower bound on the probability that the Hessian matrix Hι(µ)
is p.d. (positive deﬁnite), for a given ν and µ, is
exp [−ξ(n)] ,

P(Hι(µ) is p.d.) ≥ 1 − N∑

(44)

n=1

2 + 1.5(n)

2(n)

(cid:18) [gι(µ; ˆν)]2

(n) = −1 + δLeT

bι · ˆSι
with the condition that for all n ≤ N

n

where

ξ(n) = eT
n

ˆSι
δU

(n) > 0

⇒ eT

n gι(µ; ˆν) > eT
n

(cid:115)

bι · ˆSι
δL

(cid:19)

(45)

(46)

(47)

(48)

The proof of this theorem is given in appendix §B. It should
be noted that this theorem use a loose upper bound (the union
bound) in the proof. Thus, the lower bound in the theorem is very
conservative. A better lower bound can be derived by using the
law of total probability, but with the expense of being computa-
tionally intensive. Hence, this theorem should be used with the
intention to ﬁnd a quick lower bound probability value.
deﬁne the sets Mι.

The following list shows the steps required to use Theorem 1 to

11

1. Set ζ ∈ (0, 0.5] to lower bound P (Hι(µ) is p.d.) with 1 − ζ.
2. For a ι ∈ {c, m}, let µ be a constant matrix. Increase the
values of matrix µ until the lower bound in (44) is equal to
1 − ζ and the condition (47) is satisﬁed. Set the maximum
constant value of µ equal to uι.

3. Deﬁne Mι = [1, uι]N×K.
We have now that with probability of at leasts 1 − 2ζ, the loss
function in line 15 of Algorithm 2 is strictly convex on the set M.

4.5 Another algorithm worthy of notice to invert the

scatter cross-section β

It is not always clear whether it is better to regularize an estimate
of the lidar ratio µ, and then to compute the scatter cross-section β.
Or to regularize an estimate of β, and then compute the lidar ratio
µ. With this in mind, Algorithm 3 shows another approach to
invert the scatter cross-section β, where the reparameterized lidar
model is

hι(β, ˆν) = Cι · exp(−2Qβ) + bι.

(49)

The matrix Cι is deﬁned in (33). In this case the scatter cross-
section is constrained to be greater or equal to the inverted
backscatter.

Algorithm 3 Another approach in inverting for the particulate scat-
ter cross-section β. Note that whenever the unknown parameters are
estimated with this algorithm, it is indicated by a superscript alg − 3.
(cid:104)
(cid:105)
Input: Previously inverted backscatter ˆν, such as ˆν alg−2.
1: /* Invert the scatter cross-section */
hι(β, ˆν alg−2) − Yι · loge hι(β, ˆν)
2: Set (cid:96)(β; Yι) = 1T
(cid:8)(cid:96)(β; Ytrn
(cid:9)
1K
N
3: for every λ in Λ
β do
m ) + λ(cid:107)β(cid:107)TV
ˆβ(λ) = argmin
4:
(cid:96)(cid:0) ˆβ(λ); Ytst
(cid:1)

(cid:1) + (cid:96)(cid:0) ˆβ(λ); Ytst

5: end for
6: λ‡ = argmin

) + (cid:96)(β; Ytrn

β∈B

c

m

c

λ∈Λ

β

ˆβ alg−3 = ˆβ(λ‡)
7:
ˆµ alg−3 = ˆβ alg−3/ ˆν
8:
9: ˆτ alg−3 = Q ˆβ alg−3
10: return ˆβ alg−3, ˆµ alg−3, ˆτ alg−3

As with Algorithm 2, the scatter cross-section β has to be upper
bounded so that the loss function (line 4 of Algorithm 3) is strictly
convex. Let B be the set over which the loss function is strictly
convex. The procedure given in §4.4 to deﬁne thet set M, can be
used to deﬁne the set B with some minor modiﬁcations.

4.6 How to choose the best estimate of the backscatter

cross-section

As it was described in §4.2, depending on the rate of decrease of
the transmittance exp(−2Qβ), at times it is better to let Bι equal
alg−2
1N×K rather than (26). Suppose ˆω
represents the inferred ωι
ι
alg−2
when Bι = 1N×K. We can use
when Bι equals (26), and ˘ω
ι
a log likelihood ratio test, which is part of the cross-validation
heuristic, to determine whether ˆω
is more accurate than
˘ω
is more

. Let hypothesis H0 represent the case when ˆω

alg−2
ι

alg−2
ι

alg−2
ι

accurate than ˘ω
The log likelihood ratio test is then

alg−2
ι

, and let H1 represent the opposite hypothesis.

(cid:16)

(cid:17) H1≷

(cid:16)

(50)

(51)
(52)

(cid:17)

alg−2
ι

alg−2
ι

ι

ι

(cid:96)

(cid:96)

ˆω

˘ω

H0

; Ytst

; Ytst
H0: Bι = xι · νm · φι · exp(−2Qβm)
H1: Bι = 1N×K.
The function (cid:96)(·; Ytst
§4.3.

ι ) is deﬁned by (31) and Ytst

ι was described in

5 Experimental results

Two synthetic datasets were used to juxtapose the performance of
Algorithms 1, 2 and 3. The synthetic datasets were chosen to be
horizontally uniform, which is beneﬁcial for Algorithm 1. All the
algorithms were expected to infer the backscatter and scatter cross-
sections at a maximum range resolution. The synthetic datasets
are described in §5.1. The results of the simulation experiments
are presented in §5.2.

5.1 Synthetic datasets

Both the synthetic datasets represent nighttime scenes, where the
background energy rate in each scene is approximately 0.5. The
simulate backscatter cross-section for each scene was created by
taking an actual HSRL scene,

1. average 2880 columns of the scene, which is equivalent to

two hours of observations,

2. invert for the backscatter cross-section using Algorithm 1 and

3. apply a low-pass ﬁlter to suppress the residual noise.

Piecewise constant lidar ratios were used to calculate reasonable
simulated scatter cross-section.

Figure 5 shows the ﬁrst synthetic dataset. This dataset repre-
sents a scene with a two layer, 5km thick planetary boundary
layer and clear-sky above it. The total optical depth of this scene
is 0.1775. Figure 6 show the backscatter, scatter cross-sections and
energy rates of the second synthetic datasets. The second synthetic
dataset represent a scene with a 2km thick planetary boundary
layer, with various types of cloud layers of different optical depth
values. The total optical depth of the scene is 0.1496. Refer to
Figure 3.3 in [28, p. 21] for a description of what each lidar ratio
represents.

5.2 Simulation experiments

For the ﬁrst and second simulation scenes, each column in an
image represents the accumulation of several laser shots. This
was done to increase the SNR of the energy rates. The temporal
and spatial resolution for the two scene were 7.5m × 30s and
7.5m × 120s, where the native row and columns resolutions are
7.5m and 2.5s. For both scenes the number of rows and columns
are 1940 by 12.

For Algorithm 1 all the columns, of each scene, were averaged
together. Also a SG (Savitzky-Golay) lowpass ﬁlter was used
for Algorithm 1 [29], where the frame size and polynomial order
differed for each simulation scene. For the ﬁrst simulation scene
these were set to 41 and 2. For the second simulation scene the
parameters were 499 and 5. These parameters were chosen based

12

Figure 5: A column of synthetic dataset 1, which is representative
of the whole scene, where no accumulation across the columns
have been performed. Top left: The backscatter ν and scatter
β cross-sections. Top right: The lidar ratio µ. Bottom row: An
example of the energy rate observations Yc and Ym, with the corre-
sponding mean energy rates Sc and Sm.

on the minimization of the MSE of the inverted scatter cross-
section.

For Algorithm 2 the range of scatter cross-section that can be
uniquely inverted, is limited by the background energy rate. The-
orem 1 can be used to calculate an upper bound on the total maxi-
mum optical depth that can be uniquely estimated. For the ﬁrst
simulation scene, with probability of at least 0.999, Algorithm 2
can uniquely estimate a scatter proﬁle that has a total optical depth
of less than 0.8768. And for the second simulation scene is upper
bound is 0.7643 with the same probability. Using the steps listed
in §4.4, it turns out that for both simulation the maximum lidar
ratio is more than a 500. Hence, we can set M = [1, 500]N×K.

5.2.1 Error performance measurements

We consider two error measurements to compare the performance
of the different algorithms. The ﬁrst is the MSE (Mean Square
Error),

(cid:104)(cid:107)ν − E[ ˆν alg−1](cid:107)2

MSE ( ˆν alg−1) = E
(cid:124)
(cid:123)(cid:122)

= E

bias

(cid:104)(cid:107)ν − ˆν alg−1(cid:107)2
(cid:105)
(cid:125)

+ E

(cid:124)

F

(cid:105)
(cid:104)(cid:107) ˆν alg−1 − E[ ˆν alg−1](cid:107)2

F

(cid:123)(cid:122)

F

standard deviation

(cid:105)
(cid:125)

(53)

(54)

10-910-810-710-610-510-4Scatter or backscatter [m−1]2468101214Range [km]νβ10203040506070Lidar ratio [m−1]2468101214µ100101102103Counts2468101214Range [km]YcSc100101102Counts2468101214YmSmSynthetic scene 1The inverted scatter and lidar ratio coefﬁcients of Algorithm 2
have smaller error values than that of Algorithm 3, since the
optimization problem of Algorithm 2 is more constrained.

The performance of Algorithm 1 can be improved by also in-
cluding range averaging; for example more aggressive averaging
can be done from ranges 6km to 14 km. The problem is that with
Algorithm 1 a lidar expert has to manually determine the non-
overlapping range-intervals over which averaging has to be done
to further improve the estimate of the scatter-cross section. Fur-
thermore, the lidar expert does not have an objective measure to
determine how much averaging has to be done. In comparison
Algorithms 2 and 3 circumvent these issues; Algorithms 2 and 3
impose a smoothness constraint which is automatically set using
a cross-validation heuristic.

Table 1: The MSE, bias, std (standard deviation) and R-MSE mea-
surements of the different algorithms for the ﬁrst simulation. Al-
gorithm 2 consistently outperforms the Algorithm 1. Algorithm 1
performs poorly in estimating the scatter cross-section β and the
lidar ratio µ above 6km, and this is the reason for the large errors.
Algorithm 2 ﬁrst estimates the lidar ratio µ, then algebraically
computes the scatter cross-section β and the optical depth τ, while
Algorithm 3 directly estimates β and then algebraically computes
µ and τ. The two approaches are comparable when it comes
to estimating β and τ, but Algorithm 2 is signiﬁcantly better at
estimating µ.

2.56e-16
2.52e-17

1.25e-08
3.17e-11
5.64e-11

Inversion MSE
ˆν alg−1
ˆν alg−2
ˆβ alg−1
ˆβ alg−2
ˆβ alg−3
ˆµ alg−1
ˆµ alg−2
ˆµ alg−3
ˆτ alg−1
ˆτ alg−2
ˆτ alg−3

2.25e-04
3.42e-07
9.68e-07

5.12e+12
2.73e+01
1.14e+06

Bias

Std.

R-MSE

2.42e-06
5.48e-08

1.27e-10
5.67e-12
7.78e-12

5.27e+10
8.35e+00
1.20e+04

2.42e-06
2.01e-08
1.75e-07

1.49e-02
1.16e-03

1.11e-04
5.10e-06
6.98e-06

2.25e+06
4.35e+00
1.06e+03

1.49e-02
5.67e-04
8.91e-04

1.71e+01
2.74e-01

4.86e+06
3.45e-01
1.33e+02

3.24e+10
3.30e-02
7.19e+03

1.24e-02
5.48e-04
5.43e-04

Figure 7 shows the inverted backscatter (ﬁrst row), scatter (sec-
ond row) and lidar ratio (third row) results of Algorithms 2 and 1
of one experiment. The error performance of Algorithm 2 depends
on the accuracy of the inverted ˆν alg−2. Since ν is approximated by
a piecewise constant function, block-shaped artifacts can appear
in the inverted ˆβ alg−2 and ˆµ alg−2; this is evident in at range 1km
of the middle-right and bottom-right images of Figure 7.

5.2.3 Simulation scene 2

Table 2 shows the MSE, bias, standard deviation and R-MSE of
the different algorithms applied to scene 2 data. The inverted pa-
rameters ˆν alg−1 and ˆτ alg−1 are less biased than the other inverted
parameters. But, in regards with MSE and R-MSE, Algorithms 2
and 3 outperform Algorithm 1. Algorithm 2 is the best for all
parameter estimates, especially when estimating the lidar ratio µ.

Figure 6: A column of synthetic dataset 2, which is representative
of the whole scene, where no accumulation across the columns
have been performed. Top left: The backscatter ν and scatter
β cross-sections. Top right: The lidar ratio µ. Bottom row: An
example of the energy rate observations Yc and Ym, with the corre-
sponding mean energy rates Sc and Sm.

and we speciﬁcally compare the bias and standard deviation of
each algorithm. The norm (cid:107) · (cid:107)2
F is know as the Frobenius norm
and it is deﬁned as

(cid:16)

(cid:17)

(cid:107)ν(cid:107)2

F = trace

νTν

.

(55)

The second error measurement is the R-MSE (Relative-MSE),
It is

which scale the difference between ν and ˆν alg−1 with ν.
deﬁned as

(cid:13)(cid:13)(cid:13)(cid:13)(cid:13) ν − ˆν alg−1

ν

 .

(cid:13)(cid:13)(cid:13)(cid:13)(cid:13)2

F

R-MSE ( ˆν alg−1) = E

(56)

If an element of ν is less than one, the corresponding difference
is enlarged and is therefore more signiﬁcant. This error mea-
surement is useful to compare the algorithm performance when
different simulation scenes are considered.

The simulation experiments were repeated 100 times in order to
obtain values for the MSE and R-MSE of the different algorithms.

5.2.2 Simulation scene 1

Table 1 shows the MSE, bias, standard deviation and R-MSE of
the different algorithms. Overall in regards with MSE and R-
MSE, Algorithms 2 and 3 consistently outperforms Algorithm 1.

13

10-910-810-710-610-510-4Scatter or backscatter [m−1]2468101214Range [km]νβ020406080100120140Lidar ratio [m−1]2468101214µ100101102103Counts2468101214Range [km]YcSc100101102Counts2468101214YmSmSynthetic scene 2Table 2: The MSE, bias, std (standard deviation) and R-MSE mea-
surements of the different algorithms for the second simulation.
Algorithm 2 consistently outperforms Algorithms 1. Algorithm 1
performs poorly in estimating the scatter cross-section β and the
lidar ratio µ between 4km and 11km, and this is the reason for
the large errors. Algorithm 2 ﬁrst estimates the lidar ratio µ, then
algebraically computes the scatter cross-section β and the optical
depth τ, while Algorithm 3 directly estimates β and then alge-
braically computes µ and τ. The two approaches are comparable
when it comes to estimating τ, but Algorithm 2 is signiﬁcantly
better at estimating β and µ.

1.49e-16
1.06e-16

1.08e-10
1.51e-11
1.76e-10

Inversion MSE
ˆν alg−1
ˆν alg−2
ˆβ alg−1
ˆβ alg−2
ˆβ alg−3
ˆµ alg−1
ˆµ alg−2
ˆµ alg−3
ˆτ alg−1
ˆτ alg−2
ˆτ alg−3

5.93e+09
4.34e+02
1.44e+05

9.70e-05
3.06e-06
5.42e-06

Bias

Std.

R-MSE

9.77e-07
1.50e-06

5.03e-11
9.44e-12
1.40e-10

5.96e+07
3.96e+02
1.04e+05

9.77e-07
2.55e-06
4.39e-06

9.80e-03
1.02e-03

7.62e-06
2.37e-06
5.93e-06

7.66e+04
6.12e+00
2.01e+02

9.80e-03
7.13e-04
1.02e-03

2.57e+00
2.90e-01

7.09e+03
3.77e+00
3.85e+03

3.76e+07
1.97e+00
1.04e+03

1.15e-02
3.89e-04
7.05e-04

Table 2 and Figure 8.

From the bottom right image of Figure 8 we observe that Algo-
rithm 2 mostly overestimates the lidar ratio. Further investigation
is required to determine what is necessary to further improve
upon this result.

6 Case studies to evaluate the new approach

Four case studies of real experimental data are presented to jux-
tapose the inverted backscatter and scatter cross-sections of Al-
gorithms 1 and 2. Each case study focuses on a speciﬁc aspect of
Algorithm 2. The ﬁrst case study demonstrates the capability of
Algorithm 2 to invert the backscatter cross-section at a higher reso-
lution than Algorithm 1. To validate Algorithm 2, the second case
study compares the aerosol optical depth inverted by Algorithm 2
against AERONET optical depth retrievals [38]. And the last two
case studies demonstrate the capability of Algorithm 2 to invert
the scatter cross-section at a higher resolution than Algorithm 1.
With all four case studies, observations of the Wisconsin-
Madison HSRL instrument was used, while it was situated at
the DOE’s SGP (Southern Great Plains) ARM (Atmospheric Radi-
ation Measurement) site during the CHARMS3 experiment in the
summer of 2015. The backscatter and scatter cross-sections were
estimated from parallel-polarized photon-counts. An auxiliary de-
polarization estimate was used to normalized the backscatter cross-
section estimates, when estimating for the scatter cross-section.

3Combined HSRL and Raman Measurement Study funded by the DOE.

Figure 7: The six images show examples of the inverted backscat-
ter, scatter cross-sections and lidar ratio of the ﬁrst simulation
scene. The black graphs in these images show the corresponding
true backscatter ν, scatter β cross-sections and the true lidar ratio
µ. The blue graphs in leftmost images show examples of, from top
to bottom, the inverted backscatter, scatter cross-sections and lidar
ratio of Algorithm 1. And the red graphs in the rightmost images
show examples of the inverted cross-sections of Algorithm 2. It
is clear from these images that Algorithm 2 outperforms Algo-
rithm 1.

Figure 8 shows the inverted backscatter (ﬁrst row), scatter (sec-
ond row) and lidar ratio (third row) results of an experiment.
In this simulation scene the SG ﬁlter’s has a narrower bandpass
bandwidth compared to that of the ﬁrst simulation scene. Thus,
Algorithm 1 can somewhat resolve the scatter cross-section be-
tween ranges 10 km and 13 km. But this is at the expense of
over-smoothing the scatter cross-section below the 2 km range.
Overall Algorithms 2 and 3 outperform Algorithms 1, based on

14

10-1010-910-810-710-610-5Backscatter: ν2468101214Range [km]ˆνalg−1ν10-1010-910-810-710-610-5Backscatter: ν2468101214ˆνalg−2ν10-910-810-710-610-510-410-3Scatter: β2468101214Range [km]ˆβalg−1β10-910-810-710-610-510-410-3Scatter: β2468101214ˆβalg−2β101102103Lidar ratio: µ2468101214Range [km]ˆµalg−1µ101102103Lidar ratio: µ2468101214ˆµalg−2µResult of simulation scene 1 - 7.5m by 30sversion of ˆν alg−1, where the resolution is 60m by 60s. This ﬁg-
ure demonstrates the decrease in sensitivity of noise of ˆν alg−2 in
comparison with ˆν alg−1. Furthermore the ﬁgure also suggests
that there is a gain in spatial information when using Algorithm 2,
since with Algorithm 1 further averaging has to be done to reduce
the residual noise.

Figure 9: This ﬁgure demonstrates the gain of spatial information
of the new approach (Algorithm 2). The top image shows the
backscatter cross-section ˆν alg−2 inverted with the new approach.
The middle image shows the backscatter cross-section ˆν alg−1 in-
verted with the standard approach (Algorithm 1). The bottommost
image show a block averaged version of ˆν alg−1, where the resolu-
tion is 60m by 60s.

Figures 10 and 11 validates the backscatter cross-section of Al-
gorithm 2 by using a uniform aerosol scene. The resolution of
the data in both ﬁgures is 7.5m by 2.5s. The leftmost image of
Figure 10 shows the inverted backscatter cross-section ˆν alg−2 of
the new approach. The middle image is the inverted backscatter of
the standard approach ˆν alg−1 with no averaging. In the rightmost
image another version of ˆν alg−1 is shown where a moving average
ﬁlter was used with a window-width of 1min (24 columns).
Figure 11 shows two columns of Figure 10. For the most part
the inverted backscatter cross-section ˆν alg−2 of the new approach
agrees with the backscatter cross-section ˆν alg−1 of the averaged
observations. Since the scene is almost uniform, the inverted
backscatter ˆν alg−1 with moving averaging should be accurate.
Furthermore, for a simple scene like we have in Figure 10, the
inverted backscatter ˆν alg−2 with the new approach should very
similar compared to ˆν alg−1; and this is conﬁrmed by Figure 11.
There are speciﬁc instances where the new approach potentially

Figure 8: The six images show examples of the inverted backscat-
ter, scatter cross-section and lidar ratio of the second simulation
scene. The black graphs in these images show the corresponding
true backscatter ν, scatter β cross-sections and the true lidar ratio
µ. The blue graphs in leftmost images show examples of, from top
to bottom, the inverted backscatter, scatter cross-section and lidar
ratio of Algorithm 1. And the red graphs in the rightmost images
show examples of the inverted cross-section of Algorithm 2. It
is clear from these images that Algorithm 2 outperforms Algo-
rithm 1.

6.1 Case study one - backscatter cross-section of high

altitude cloud

The top image of Figure 9 shows the backscatter cross-section
ˆν alg−2 inverted with the new approach of a cirrus cloud, and the
middle image shows the inverted backscatter cross-section ˆν alg−1
of the standard approach. Both these images have a resolution
of 15m by 15s. The bottommost image shows a block averaged

15

10-910-810-710-610-5Backscatter: ν2468101214Range [km]ˆνalg−1ν10-910-810-710-610-5Backscatter: ν2468101214ˆνalg−2ν10-810-710-610-510-410-310-2Scatter: β2468101214Range [km]ˆβalg−1β10-810-710-610-510-410-310-2Scatter: β2468101214ˆβalg−2β101102103104Lidar ratio: µ2468101214Range [km]ˆµalg−1µ101102103104Lidar ratio: µ2468101214ˆµalg−2µResult of simulation scene 2 - 7.5m by 120s1314Range [km]7 September 2015 - SGP ARM site - 15m by 15sBackscatter cross-section estimates ˆνalg−1, ˆνalg−2 and block-averaged ˆνalg−21314Range [km]07:3307:3907:4407:5007:5508:0108:0708:1208:1808:23Time (UTC)1314Range [km]8.07.67.26.86.46.0log10νFigure 10: In conjunction with Figure 11, this ﬁgure demonstrates
that the inverted backscatter cross-section of the new and standard
approaches agrees with each other. The symbol ˆν alg−1M indicate
a moving average ﬁlter was used in Algorithm 1, with a window-
width of 1min (24 columns). The leftmost image is the inverted
backscatter of the new approach, and the middle column is the
inverted backscatter of the standard approach without averaging.
The rightmost image is the inverted backscatter cross section of
the standard approach, with averaging.

over-smooth the backscatter, for example at 4.6km and 6.2km.

6.2 Case study two - aerosol optical depth

To validate the inverted scatter cross-section of Algorithm 2,
we compare the optical depth of it against that of AERONET.
AERONET (AErosol RObotic NETwork) is an instrument that
measures the radiation from the sun to retrieve the aerosole opti-
cal depth [38]. Figure 12 shows the aerosole optical depth values
of the new approach ˆτ alg−2, the standard approach ˆτ alg−1 and
AERONET. The smallest solar zenith angle of the AERONET mea-
surements is at 18:37 UTC.

There are several sources of uncertainty that contribute to the
optical depth difference between the HSRL and the AERONET
instrument. The ﬁrst is the signiﬁcant uncertainty in the geo-
metric overlap function between range 0km and 5km, which is
typical of all ground based lidar systems. The second uncertainty
is that the HSRL instrument points away from the sun, while the
AERONET line of sight is pointed towards the sun. Thus, differ-
ent atmospheric columns are observed by these two instruments.
Although optical depth measurements differ by between 0.06 and
0.09, the upward and downtrend in the AERONET optical depth
measurements are also present in the inverted optical depth of the
new approach.

16

Figure 11: In conjunction with Figure 10, this ﬁgure demonstrates
that inverted backscatter cross-section of the new ˆν alg−2 and stan-
dard ˆν alg−1M approach agrees with each other for the most part.
The symbol 1M in ˆν alg−1M indicates that a moving average ﬁl-
ter was used in Algorithm 1, with a window-width of 1min (24
columns).

Figure 12: The optical depth values inverted with the new ˆτ alg−2
and standard ˆτ alg−1 approaches are compared against that of
AERONET. This image shows that the optical depth inverted with
the new approach agrees with the standard approach, and differ
with the AERONET retrievals by a factor of less than 1.8. The
difference between between the HSRL and AERONET instrument
optical depth values are due to uncertainties of geometric over-
lap function. Furthermore these two instruments do not exactly
observe the same atmospheric columns.

03:3003:3103:3203:3303:35456Range [km]ˆνalg−203:3003:3103:3203:3303:35Time (UTC) 17 August 2015 - SGP ARM site - 7.5m by 2.5sBackscatter cross-section estimatesˆνalg−103:3003:3103:3203:3303:35ˆνalg−1M8.07.67.26.86.46.0log10ν10-810-710-610-5Backscatter [m−1]4.04.55.05.56.06.5Range [km]Backscatter at 03:31:44ˆνalg−1ˆνalg−1Mˆνalg−210-810-710-610-5Backscatter [m−1]4.04.55.05.56.06.5Backscatter at 03:33:0017 August 2015 - SGP ARM site - 7.5m by 2.5s17:2217:3717:5218:0718:2218:3718:52Time (UTC)0.100.120.140.160.180.20Optical depth28 July 2015 - SGP ARM site - 7.5m by 4.96minˆτalg−1ˆτalg−2AERONET6.3 Case study three - scatter cross-section of a cirrus

cloud

In this case study the scatter cross-section of a dense cirrus cloud
were inverted. The top image of Figure 13 shows the inverted scat-
ter cross-section ˆβ alg−2 of the new approach, and the bottommost
image is the inverted scatter cross-section ˆβ alg−1 of the standard
approach. With the new approach the matrix Bι was set to 1N×K.
And with the standard approach, a Savitzky-Golay lowpass ﬁlter
was used for both the range and temporal axes [29]. The window-
length of the range axis was set to 600m and for the temporal
axis it was 600s. And for both axes, the polynomial order for the
Savitzky-Golay ﬁlter was set to one. The resolution of data that
were used was 7.5m by 1:52.5min (45 columns). The optical depth
of the cloud is between 0.4 and 0.55, hence the inverted scatter
cross-section above the cloud have larger uncertainties than the
cross-sections in and below the cloud.

is approximately 60. In other words, to guarantee that the Hessian
matrix of the loss function is positive deﬁnite for a constant lidar
ratio, the lidar ratio should be less than 60. For this case study we
did set the lidar ratio upper bound to 600, and from the experi-
ments that were conducted we observed that the estimation of the
lidar ratios was numerically stable.

On a last note, for this case study only the molecular channel
observations Ym were used to estimate for the scatter cross-section,
whereas in the the simulations both Yc and Ym were used. We
found that any uncertainties in the inverted backscatter ˆν alg−2
propagates through the inversion of the scatter cross-section. Since
the calibration coefﬁcient θm is very small (see §2.4), less un-
certainty of the backscatter cross-section ˆν alg−2 is introduced in
ˆβ alg−2 when only the molecular channel is used.

6.3.1 Validation

The inverted lidar ratios are used to validate the estimated scat-
ter cross-section. We validate the inverted lidar ratio of Algo-
rithm 2 by comparing it against inverted lidar ratio of Algorithm 1,
since there are no alternative data sources at our disposal (like
AERONET) which we can use. The inverted lidar ratio values of
Algorithms 2 and 1 should be in agreement, since a large number
of columns are accumulated to increase the signal SNR.

In addition to the lidar ratio that are inverted with Algorithms 1
and 2, we also use the bulk lidar ratio to validate the inverted scat-
ter cross-section; the bulk lidar ratio is deﬁned in the following
subsection. For both the lidar ratio and bulk lidar ratio, we only
consider the region within the cloud. The cloud boundaries were
determined using the inverted backscatter ˆν alg−2 with a thresh-
old of 10−6. Hence, we are excluding the inﬂuence of multiple
scattering outside the cloud.

Bulk lidar ratio

We deﬁne the bulk lidar ratio as ratio between the averaged
inverted scatter and backscatter cross-sections, which are con-
strained to the inner part of the cloud. In other words, for a contin-
uous region on a ﬁxed column delineated by the top and bottom
of the cloud, the inverted scatter and backscatter cross-sections are
averaged and divided with each other. Since the bulk lidar ratio is
ratio of two averaged quantities, it should be less noisy than the
full waveform lidar ratio computed using Algorithms 1 and 2.

The topmost image of Figure 14 shows the bulk lidar ratio of
the new and standard approaches. The bottommost image shows
the reciprocal of the bulk lidar ratio, which is the bulk 180◦ phase
function. The difference between the lidar ratios of the different
approaches are within ±5. Furthermore, the lidar ratio are within
the range of lidar ratios of Figure 3.3 of [28, §3.3].

Figure 13: The two image show the inverted scatter cross-section
of the new ˆβ alg−2 and standard ˆβ alg−1 approaches, where the
topmost image corresponds to the new approach. Although the
inverted cross-section ˆβ alg−2 do look considerably better than
ˆβ alg−1, there are several artifacts such as at 10km at between 7:00
UTC and 7:23 UTC. We are yet to establish what the predominant
source is of these artifacts.

Recall that Algorithm 2 estimates the scatter cross-section by
ﬁrst estimating for the lidar ratio, and that the lidar ratio has to be
constrained to a closed subset of [1, ∞)N×K so that the loss func-
tion is strictly convex; see §4.4. If a single lidar ratio is assumed
for the whole scene, the maximum lidar ratio of the constraint set

Full waveform lidar ratio

The top left image of Figure 15 shows a single column of the
inverted lidar ratio of the new ˆµ alg−2 and standard ˆµ alg−1 ap-
proaches. The top right image is the corresponding backscatter
cross-section of the different approaches. The bottommost image
is the average lidar ratio over the different columns, where each
average was calculated within the cloud.
Although the lidar ratio ˆµ alg−2 appears to be “blocky”, it does
follow the upper and downward trends of ˆµ alg−1. Recall from
§4.1 that the TV-PMLE implicitly constrains the lidar ratio to be
piecewise constant. Hence, in a low SNR image, any variation
of the lidar ratio will be approximated with block shaped curves.

17

891011121314Range [km]12 September 2015 - SGP ARM site - 7.5m by 1.875min07:0007:0607:1207:1807:2407:3007:3607:43Time (UTC)891011121314Range [km]7.56.04.53.0log10 scatter cross-section [m−1]Figure 14: This ﬁgure corresponds to Figure 13; it demonstrates
that the bulk lidar ratio of the new ˆµ alg−2 and standard ˆµ alg−1
approaches agrees with each other within a difference of ±5. The
bulk lidar ratio is the ratio between the averaged inverted scatter
and backscatter cross-sections in the cloud region. The topmost
image shows the bulk lidar ratio of the new approach and the
standard approach. The bottommost image shows the reciprocal
of the bulk lidar ratio, which is the bulk 180◦ backscatter phase
function.

Furthermore, uncertainty in the inverted backscatter cross-section
ˆν alg−2 potentially contribute to the uncertainties in ˆµ alg−2. In
fact, although it is not clearly visible in the top right image of Fig-
ure 15, the inverted backscatter cross-section ˆν alg−2 are potentially
slightly biased. This is due to the piecewise constant approxima-
tion of the scaled attenuated backscatter (see §4.2.1). We plan to
circumvent this issue in our future research.

6.4 Case study four - scatter cross-section of a cirrus

cloud

A less dense cirrus cloud is used in this case study, compared to the
case study three §6.3. The topmost image of Figure 16 shows the
inverted scatter cross-section ˆβ alg−2 of the new approach. And the
bottommost image show the inverted scatter cross-section ˆβ alg−1
of the standard approach. With the new approach the matrix Bι
was set to 1N×K. And with the standard approach, a Savitzky-
Golay lowpass ﬁlter was used for both the range and temporal
axes [29]. The window-length of the range axis was set to 600m
and for the temporal axis it was 600s. And for both axes, the
polynomial order for the Savitzky-Golay ﬁlter was set to one. As
with case study three, we use the bulk lidar ratio and the lidar
ratio to validate the inverted scatter cross-section.
Recall that with Algorithm 2 the lidar ratio has to be constrained
to a closed subset of [1, ∞)N×K, so that the loss function is strictly
convex; see §4.4. If a single lidar ratio is assumed for the whole
scene, the maximum lidar ratio of the constraint set is approxi-
mately 100. In other words, to guarantee that the Hessian matrix
of the loss function is positive deﬁnite for a constant lidar ratio,
the lidar ratio should be less than 100. For this case study we did
set the lidar ratio upper bound to 200, and from the experiments
that were conducted we observed that the estimation of the lidar
ratios was numerically stable.

18

Figure 15: This ﬁgure corresponds to Figure 13. The top left image
shows a single column of the inverted lidar ratios of the new
ˆµ alg−2 and the standard ˆµ alg−1 approaches. The top right image
shows the corresponding inverted backscatter cross-sections of the
new and standard approaches. The bottommost image show the
average lidar ratios horizontally across the cloud, where the each
average was calculated within the cloud. The bottommost image
shows that the lidar ratios of the new and standard approaches
are similar.

6.4.1 Validation

Bulk lidar ratio

The topmost image of Figure 17 shows the bulk lidar ratio of
the new and standard approaches. Refer to §6.3.1 for the def-
inition of the bulk lidar ratio quantity. The cloud bottom and
top boundaries were determined using the inverted backscatter
cross-section ˆν alg−2 with a threshold of 3 × 10−7. The difference
between the new and standard approach bulk lidar ratios are
within ±10. There are larger uncertainties in the inverted bulk
lidar ratios compared to case study three, since the backscatter
cross-section of the cloud is less than 10−5. Apart from this, there
is agreement between the bulk lidar ratios in regards with upward
and downward trends. The bottommost image shows the recipro-
cal of the bulk lidar ratio, which is the bulk 180◦ backscatter phase
function.

Full waveform lidar ratio

The top left image of Figure 18 shows a single column of the
inverted lidar ratio of the new ˆµ alg−2 and standard ˆµ alg−1 ap-
proaches. The top right image is the corresponding backscatter
cross-sections of the different approaches. The bottommost image

151617181920212223Bulk lidar ratioBulk lidar ratio comparison07:0007:0607:1207:1807:2407:3007:3607:43Time (UTC)4.04.55.05.56.06.57.0Bulk 180◦ phase1e2Bulk 180◦ phase function comparison12 September 2015 - SGP ARM site - 7.5m by 1:52.5min0510152025303540Lidar ratio9.510.010.511.011.512.0Range [km]Lidar ratio at 07:22 UTCˆµalg−1ˆµalg−210-810-710-610-5log10 Backscatter [m−1]9.510.010.511.011.512.0Backscatter at 07:22 UTC07:0007:0407:0907:1407:1907:2307:2807:3307:3807:43Time (UTC)161820222426283032Average lidar ratioAverage lidar ratio within cloud12 September 2015 - SGP ARM site - 7.5m by 1:52.5minFigure 17: This ﬁgure corresponds to Figure 16; it demonstrates
that the bulk lidar ratios of the new ˆµ alg−2 and standard ˆµ alg−1
approaches agrees with each other within a difference of ±10. The
topmost image shows the bulk lidar ratios of the new approach
and the standard approach. The bulk lidar ratio is the ratio be-
tween the averaged inverted scatter and backscatter cross-sections
in the cloud region. The bottommost image shows the reciprocal
of the bulk lidar ratio, which is the bulk 180◦ backscatter phase
function.

7 Conclusion and future work

We presented a new approach to invert backscatter and scatter
cross-sections from photon-counting HSRL observations. Consid-
erably better estimates - smaller errors - of the backscatter and
scatter cross-sections can be obtained with the TV-PMLE estima-
tors (see §4) compared to the standard approach (see §3), as it
was demonstrated in §5 and §6. The improved results, like that
of Figure 16, are due to the fact that the new estimators take in
account the noise model and the estimators impose a smoothness
contraint on the estimates.

The advantage of using a TV-PMLE is that smoothness con-
straint is imposed on a whole image, whereas with block aver-
aging a smoothness constraint is set on individual blocks inde-
pendent from each other. In addition to taking the noise physical
model in account, the TV-PMLE utilizes the spatial information
of the noisy observations, whereas the standard approach does
not. We deduce that the SNR required by the algorithms that
are presented in this paper is less than the standard approach, in
order to obtain a more accurate estimate (smaller MSE) of either
the scatter and backscatter cross-sections. This assertion is based
on the results presented in sections §5 and §6.

In addition to further validate our algorithms, our long term
goals are to expand our work so that it will be applicable to 1)
single channel lidar systems and 2) to analog-mode lidar systems
and 3) space-based lidar systems. With single-channel lidar sys-
tems further constraint have to be imposed so that meaningful
inverted backscatter and scatter cross-sections can be obtained.
Further research will be required to determine what appropriate
constraints can be imposed, and how it can be imposed. With
analog-mode lidar systems, the research challenge will be to de-
rive or approximate the MLE for Compounded Poisson noise [7];
this noise differ signiﬁcantly from Gaussian and Poisson noise.
Once the technique has been adapted for single channel lidar and
Compounded Poisson noise, the technique has the potential to

Figure 16: The two images show the inverted scatter cross-section
of the new ˆβ alg−2 and standard ˆβ alg−1 approaches, where the
topmost image corresponds to the new approach. The scatter
cross-section below the cloud in this case is larger than in case
three (see Figure 13), although the backscatter cross-sections are
in the order of 3 × 10−8. A potential contributor to this issue is
uncertainty in the geometric overlap function.

is the average lidar ratio of the different columns, where each
average was calculated within the cloud. As it was mentioned in
§6.3, the lidar ratio in the top left image appears to be “blocky”,
since the lidar ratio coefﬁcients are implicitly approximated by
piecewise constant functions. The bottommost image shows that
the average lidar ratio are alike, though the average inverted lidar
ratio ˆµ alg−1 appears to be more noisy.

The inverted lidar ratios in Figure 18 is interesting, in the sense
that the lidar ratios differ as a function of range in correspon-
dence with the depolarization coefﬁcients of the cloud. In other
words, there is a slight correlation between the depolarization and
lidar ratios. The topmost image of Figure 19 shows the inverted
backscatter cross-section ˆν alg−2 of Figure 18 and the linear depo-
larization coefﬁcients are shown in the bottommost image. At 4:34
UTC the linear depolarization varies between approximately 0.3
and 0.6. In the top left image of Figure 18 we observe that the
lidar ratio changes as a function of the linear depolarization. For
example the lidar ratios between 12.6km and 13km differ from
those between 12km and 12.6km. The lidar ratios at 13.6km and
14.2km are mixed with clear-sky observations, hence do not purely
represent lidar ratios of clouds.

19

1011121314Range [km]17 August 2015 - SGP ARM site - 7.5m by 2min03:3003:4704:0504:2204:4004:5705:1505:32Time (UTC)1011121314Range [km]7.56.04.53.0log10 scatter cross-section [m−1]101520253035Bulk lidar ratioBulk lidar ratio comparison03:3003:4704:0504:2204:4004:5705:1505:32Time (UTC)345678Bulk 180◦ phase1e2Bulk 180◦ phase function comparison17 August 2015 - SGP ARM site - 7.5m by 2minFigure 18: This ﬁgure corresponds to Figure 16. The top left image
shows a single column of the inverted lidar ratios of the new
ˆµ alg−2 and the standard ˆµ alg−1 approaches. The top right image
shows the corresponding inverted backscatter cross-sections of the
new and standard approaches. The bottommost image show the
average lidar ratios horizontally across the cloud, where the each
average was calculated within the cloud. The bottommost image
shows that the lidar ratios of the new and standard approaches
are similar.

Figure 19: This ﬁgure corresponds to Figure 16. The top image
shows the inverted backscatter cross-section of the Algorithm 2.
The bottom image shows the linear depolarization measurements,
indicating that the cloud consisted of a mix of different ice crystal
types. From these two images we deduce that cloud in Figure 16
consists of various ice crystal types, and in Figure 18 we can
observe a slight correlation between the depolarization and lidar
ratios.

greatly improve current systems such as CATS and the ten year
record of CALIPSO observations [39, 1].

B Proof of Theorem 1

APPENDIX

Aι,n =

eT
n [gι(µ; ˆν)]2 > eT

n [Yι · bι]

Deﬁne the event

(cid:110)

(cid:111)

.

(57)

A Thinning a Poisson distributed matrix in creat-

ing the training and testing matrices

Without loss of generality, suppose Y be a Poisson random variable
where each entry is independent from each other and EY[Y] = λ.
And for a given Y, let Z be a Binomial random variable, where
EZ|Y[Z|Y = y] = yp and p ∈ (0, 1). The random variables Y and
Z are independent from each other. It can be proved that Z is
Poisson distributed with EZ,Y[Z] = EY[EZ|Y[Z|Y]] = pλ, where
the expectation is taken over the PMFs of both Y and Z.

Now suppose Yι is Poisson distributed random matrix. Using
the procedure described in the previous paragraph, we can create
a “training” matrix Ytrn
] = pE[Yι]. The “testing” ma-
trix Ytst
from Yι. This is achieved
ι
by subtracting the two matrices.

is created by the removing Ytrn

ι

ι where E[Ytrn

ι

The probability that the Hessian matrix Hι(µ) is positive deﬁ-
n=1Aι,n. To prove
nite, is equal to the probability of the event ∩N
Theorem 1 we breakup the proof in several lemmas. The purpose
of each of the following lemmas are:

Lemma 2: A concentration inequality of a Poisson random vari-
able is given. This is required to ﬁnd a probabilistic lower
bound for Theorem 1.

Lemma 3: A lower bound is proven of the probability P(Aι,n).
Lemma 4: A lower bound of P(∩N

n=1Aι,n) is proven.

Lemma 5: Lemmas 2, 3 and 4 are put together to prove Theorem 1.

Lemma 2. Let Y be a Poisson random variable and  > 0. The Chernoff

20

0102030405060Lidar ratio11.512.012.513.013.514.014.5Range [km]Lidar ratio at 04:34 UTCˆµalg−1ˆµalg−210-910-810-710-610-5log10 Backscatter [m−1]11.512.012.513.013.514.014.5Backscatter at 04:34 UTC03:3003:4303:5704:1004:2404:3804:5105:0505:1905:32Time (UTC)1015202530354045Average lidar ratioAverage lidar ratio within cloud17 August 2015 - SGP ARM site - 7.5m by 2min1011121314Range [km]17 August 2015 - SGP ARM site - 7.5m by 2minBackscatter cross-section estimate ˆνalg−2 and depolarization coefficients03:3003:4303:5704:1004:2404:3804:5105:0505:1905:32Time (UTC)1011121314Range [km]7.26.45.64.84.0log10β0.20.30.40.50.6Depolarizationbound of Y is

where

P(Y ≥ (1 + )E[Y])

loge

≤ −E[Y] [(1 + ) loge(1 + ) − ]
≤ −E[Y]

(cid:18) 2

(cid:19)

.

2 + 1.5

(58)
(59)

(60)

Proof. The ﬁrst upper bound is straightforward to compute by
using the Chernoff bound technique [40, §4.5]. Refer to Lemma 2.4
of [41] to see a proof of the second upper bound.

Lemma 3. Let ˆν be given and let Yι be a Poisson random vector such
that E[Yι] = Sι. Deﬁne

˜ξ(n) = eT

nSι

˜2(n)

2 + 1.5˜(n)

˜(n) = −1 + eT
n

[gι(µ; ˆν)]2

bι · Sι

.

Then

loge

P(Ac

Proof. We have that

P(eT

nYι ≥ (1 + ˜(n))eT

nSι)

ι,n) = loge

≤ − ˜ξ(n).

(cid:26)
(cid:110)

Ac
ι,n =

=

[gι(µ; ˆν)]2

≤ eT
eT
nYι
n
nYι ≥ (1 + ˜(n))eT
eT
nSι

bι

(cid:27)
(cid:111)

.

Invoking Lemma 2 we get
ι,n) ≤ − ˜ξ(n),
which completes the proof.

P(Ac

loge

(61)

(62)

(63)
(64)

(65)

(66)

(67)

2(n)

n ˆSι
eT
δU

ξ(n) =

2 + 1.5(n)

(cid:19)
and with the condition that for all n ≥ N

(cid:18) [gι(µ; ˆν)]2

(n) = −1 + δLeT
(cid:115)

bι · ˆSι

n

eT
n gι(µ; ˆν) > eT
n

bι · ˆSι
δL

.

(73)

(74)

(75)

Proof. We want to relax the lower bound given in Lemma 4 by
using the inequality (71). We do this by ﬁnding a function which is
smaller than ˜ξ(n). If ˜(n) > 0, the coefﬁcient ˜ξ(n) monotonically
increases as ˜(n) increases. To prove this assertion, let

q( ˜(n)) =

˜(n)2

2 + 1.5˜(n)

.

The ﬁrst derivative of q( ˜(n)) is

q(1)( ˜(n)) =

1.5˜2(n) + 4˜(n)
[1.5˜(n) + 2]2

,

(76)

(77)

which is strictly positive if ˜(n) > 0. To ensure that ˜(n) > 0, we
require that

(cid:115)

(cid:112)bι · Sι.

bι · ˆSι
δL

≥ eT
n

eT
n gι(µ; ˆν) > eT
n

With the condition (78), we have that (n) ≤ ˜(n) and

(78)

(79)

ˆSι
δU

˜2(n)

2 + 1.5˜(n)

≥ ξ(n).

˜ξ(n) ≥ eT
n
(cid:35)

(cid:34) N(cid:92)

The conclude the proof with the assertion that
exp[− ˜ξ(n)] ≥ 1 − N∑

≥ 1 − N∑

Aι,n

P

n=1

n=1

exp[−ξ(n)]. (80)

(cid:34) N(cid:92)

(cid:35)

Lemma 4. Let ˆν be given. The probability that the Hessian matrix (37)
is positive deﬁnite is lower bounded by

Aι,n

≥ 1 − N∑

exp[− ˜ξ(n)].

P

n=1

(cid:105)
(cid:104)(cid:83)N
(cid:105)
(cid:104)(cid:84)N
n=1 Ac
Proof. If we ﬁnd an upper bound for P
ι,n
n=1 Aι,n
= 1 − P

n=1

, then we are

(cid:104)(cid:83)N
n=1 Ac

(cid:105)

.

ι,n

n=1

(68)

done with the proof, since P
We have that
Ac
ι,n

(cid:34) N(cid:91)

≤ N∑

P(Ac

(cid:35)

P

ι,n)

n=1

n=1

≤ N∑

n=1

exp[− ˜ξ(n)],

Acknowledgments

The authors would like to thank Zachary Harmany and Albert
Oh for sharing their most recent source code of [14]. We thank
Rick Wagener for maintaining the AERONET instruments and
making the data available at the SGP ARM site. We also thank
Ilya Razenkov, Joe Garcia and Martin Lawson for their dedicated
hard work in maintaining and developing the Wisconsin-Madison
HSRL system.

(69)

(70)

where the ﬁrst inequality we used the union bound inequality (see
[40, §1]) and the second inequality is from Lemma 3.

References

Lemma 5. Let ˆν be given. Let Yι be a Poisson random vector such that
E[Yι] = Sι, and the corresponding denoised estimate is ˆSι = fι( ˆωι).
Suppose an oracle tells us that

n ˆSι
eT
δU

≤ eT

Then

P

(cid:34) N(cid:92)

n=1

.

n ˆSι
nSι ≤ eT
δL
(cid:35)

Aι,n

≥ 1 − N∑

n=1

exp[−ξ(n)],

(71)

(72)

21

[1] D. M. Winker, M. A. Vaughan, A. Omar, Y. Hu, K. A. Pow-
ell, Z. Liu, W. H. Hunt, and S. A. Young, “Overview of the
CALIPSO mission and CALIOP data processing algorithms,”
Journal of Atmospheric and Oceanic Technology, vol. 26, no. 11,
pp. 2310–2323, 2009.

[2] J. W. Hair, C. A. Hostetler, A. L. Cook, D. B. Harper, R. A.
Ferrare, T. L. Mack, W. Welch, L. R. Izquierdo, and F. E. Hovis,
“Airborne high spectral resolution lidar for proﬁling aerosol
optical properties,” Applied Optics, vol. 47, no. 36, pp. 6734–
6752, 2008.

[3] Y. Durand, A. Hélière, J. Bézy, and R. Meynart, “The ESA
EarthCARE mission: results of the ATLID instrument pre-
developments,” in Proc. SPIE, vol. 6750, 2007, p. 675015.

[4] M. McGill, D. Hlavka, W. Hart, V. S. Scott, J. Spinhirne, and
B. Schmid, “Cloud physics lidar: Instrument description and
initial measurement results,” Applied Optics, vol. 41, no. 18,
pp. 3725–3734, 2002.

[5] E. J. Welton, J. R. Campbell, J. D. Spinhirne, and V. S. Scott III,
“Global monitoring of clouds and aerosols using a network of
micropulse lidar systems,” in Second International Asia-Paciﬁc
Symposium on Remote Sensing of the Atmosphere, Environment,
and Space.
International Society for Optics and Photonics,
2001, pp. 151–158.

[16] R. M. Willett and R. D. Nowak, “Platelets: a multiscale ap-
proach for recovering edges and surfaces in photon-limited
medical imaging,” Medical Imaging, IEEE Transactions on,
vol. 22, no. 3, pp. 332–350, 2003.

[17] G. W. Petty, A ﬁrst course in atmospheric radiation.

Pub, 2006.

Sundog

[18] E. Eloranta. (2014, 10) http://hsrl.ssec.wisc.edu. [Online].

Available: http://hsrl.ssec.wisc.edu

[19] P. Yang, Y. X. Hu, D. M. Winker, J. Zhao, C. A. Hostetler,
L. Poole, B. A. Baum, M. I. Mishchenko, and J. Reichardt, “En-
hanced lidar backscattering by quasi-horizontally oriented
ice crystal plates in cirrus clouds,” Journal of Quantitative Spec-
troscopy and Radiative Transfer, vol. 79, pp. 1139–1157, 2003.

[6] Z. Liu, W. Hunt, M. Vaughan, C. Hostetler, M. McGill, K. Pow-
ell, D. Winker, and Y. Hu, “Estimating random errors due to
shot noise in backscatter lidar observations,” Applied optics,
vol. 45, no. 18, pp. 4437–4447, 2006.

[20] C. A. Hostetler, Z. Liu, J. Reagan, M. Vaughan, D. Winker,
M. Osborn, W. Hunt, K. Powell, and C. Trepte, “CALIOP
Algorithm Theoretical Basis Document–Part 1: Calibration
and Level 1 Data Products,” Doc. PC-SCI, vol. 201, 2006.

[7] Z. Liu and N. Sugimoto, “Simulation study for cloud detec-
tion with space lidars by use of analog detection photomul-
tiplier tubes,” Applied optics, vol. 41, no. 9, pp. 1750–1759,
2002.

[8] T. Hastie, R. Tibshirani, and J. Friedman, The Elements of Sta-
tistical Learning: Data Mining, Inference, and Prediction, 2nd ed.,
ser. Springer Series in Statistics. Springer New York, 2009.

[9] C. D. Rodgers, Inverse methods for atmospheric sounding: theory

and practice. World scientiﬁc Singapore, 2000, vol. 2.

[10] E. Eloranta, “High Spectral Resolution Lidar Measurements
of Atmospheric Extinction: Progress and Challenges,” in
Aerospace Conference, 2014 IEEE.

IEEE, 2014, pp. 1–6.

[11] T. Nishizawa, N. Sugimoto, I. Matsui, A. Shimizu, B. Tatarov,
and H. Okamoto, “Algorithm to retrieve aerosol optical prop-
erties from high-spectral-resolution lidar and polarization
mie-scattering lidar measurements,” Geoscience and Remote
Sensing, IEEE Transactions on, vol. 46, no. 12, pp. 4094–4103,
2008.

[12] S. A. Young, D. Winker, M. Vaughan, Y. Hu, and R. Kuehn,
“CALIOP Algorithm Theoretical Basis Document, Part 4: Ex-
tinction retrieval algorithms,” NASA Langley Research Cen-
ter, Tech. Rep., 2008.

[13] A. Ansmann, U. Wandinger, O. Le Rille, D. Lajas, and A. G.
Straume, “Particle backscatter and extinction proﬁling with
the spaceborne high-spectral-resolution Doppler lidar AL-
ADIN: methodology and simulations,” Applied optics, vol. 46,
no. 26, pp. 6606–6622, 2007.

[14] A. Oh, Z. Harmany, and R. Willett, “Logarithmic total vari-
ation regularization for cross-validation in photon-limited
imaging,” in Image Processing (ICIP), 2013 20th IEEE Interna-
tional Conference on, Sept 2013, pp. 484–488.

[15] Z. T. Harmany, R. F. Marcia, and R. M. Willett, “This
is SPIRAL-TAP: Sparse Poisson Intensity Reconstruction
ALgorithms—Theory and Practice,” Image Processing, IEEE
Transactions on, vol. 21, no. 3, pp. 1084–1096, 2012.

[21] S. Chandrasekhar, Radiative Transfer, ser. Dover Books on In-
termediate and Advanced Mathematics. Dover Publications,
1960.

[22] R. Measures, Laser Remote Sensing: Fundamentals and Appli-
John Wiley &

cations, ser. Wiley-Interscience publication.
Sons, 1984.

[23] R. M. Measures, Laser remote chemical analysis, ser. Chemical
analysis. New York : Wiley, 1988, "A Wiley-Interscience
publication.".

[24] E. E. Eloranta, High spectral resolution lidar. Springer, 2005.

[25] R. M. Willett and R. D. Nowak, “Multiscale poisson intensity
and density estimation,” Information Theory, IEEE Transactions
on, vol. 53, no. 9, pp. 3171–3187, 2007.

[26] P. P. B. Eggermont, V. N. LaRiccia, and V. LaRiccia, Maximum

penalized likelihood estimation. Springer, 2001, vol. 1.

[27] I. Razenkov, “Characterization of a Geiger-mode Avalanche
Photodiode Detector for High Spectral Resolution Lidar,”
Ph.D. dissertation, University of Wisconsin-Madison, 2010.

[28] R. E. Holz, “Measurements of cirrus backscatter phase func-
tions using a high spectral resolution lidar,” Master’s thesis,
University of Wisconsin-Madison, 2002.

[29] R. W. Schafer, “On the Frequency-Domain Properties of
Savitzky-Golay Filters,” in Proc. 2011 DSP/SPE Workshop,
2010, pp. 54–59.

[30] P. Pornsawad, G. D’Amico, C. Böckmann, A. Amodeo, and
G. Pappalardo, “Retrieval of aerosol extinction coefﬁcient
proﬁles from Raman lidar data by inversion method,” Applied
Opticsptics, vol. 51, no. 12, pp. 2035–2044, 2012.

[31] P. Tian, X. Cao, J. Liang, L. Zhang, N. Yi, L. Wang, and
X. Cheng, “Improved empirical mode decomposition based
denoising method for lidar signals,” Optics Communications,
vol. 325, pp. 54–59, 2014.

[32] Cimel. (2016, 2) http://support.cimel.fr/photo/pdf/ce370_us.pdf.

[Online]. Available: http://support.cimel.fr/photo/pdf/
ce370_us.pdf

22

[33] F. O’Sullivan, “A statistical perspective on ill-posed inverse

problems,” Statistical science, pp. 502–518, 1986.

[34] D. Needell and R. Ward, “Stable image reconstruction us-
ing total variation minimization,” SIAM Journal on Imaging
Sciences, vol. 6, no. 2, pp. 1035–1058, 2013.

[35] S. J. Wright, R. D. Nowak, and M. A. Figueiredo, “Sparse Re-
construction by Separable Approximation,” Signal Processing,
IEEE Transactions on, vol. 57, no. 7, pp. 2479–2493, 2009.

[36] J. Nocedal and S. Wright, Numerical optimization. Springer

Science & Business Media, 2006.

[37] A. Beck and M. Teboulle, “Fast Gradient-Based Algorithms
for Constrained Total Variation Image Denoising and Deblur-
ring Problems,” Image Processing, IEEE Transactions on, vol. 18,
no. 11, pp. 2419–2434, 2009.

[38] B. Holben, T. Eck, I. Slutsker, D. Tanre, J. Buis, A. Setzer, E. Ver-
mote, J. Reagan, Y. Kaufman, T. Nakajima et al., “AERONET -
A federated instrument network and data archive for aerosol
characterization,” Remote sensing of environment, vol. 66, no. 1,
pp. 1–16, 1998.

[39] M. McGill, E. Welton, J. Yorks, and V. S. Scott, “CATS: A new

earth science capability,” Newsletter, May June 2012.

[40] J. Gubner, Probability and Random Processes for Electrical and

Computer Engineers. Cambridge University Press, 2006.

[41] C. McDiarmid, “Concentration,” in Probabilistic methods for
algorithmic discrete mathematics. Springer, 1998, pp. 195–248.

23

