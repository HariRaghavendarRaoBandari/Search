A GODEMENT–JACQUET TYPE INTEGRAL AND THE METAPLECTIC

SHALIKA MODEL

EYAL KAPLAN AND JAN M ¨OLLERS

6
1
0
2

 
r
a

M
5

 

Abstract. We present a novel integral representation for a quotient of global automor-
phic L-functions, the symmetric square over the exterior square. The pole of this integral
characterizes a period of a residual representation of an Eisenstein series. As such, the
integral itself constitutes a period, of an arithmetic nature. The construction involves the
study of local and global aspects of a new model for double covers of general linear groups,
the metaplectic Shalika model. In particular, we prove uniqueness results over p-adic and
Archimedean ﬁelds, and a new Casselman–Shalika type formula.

 
 
]
T
N
h
t
a
m

.

[
 
 

1
v
1
7
6
1
0

.

3
0
6
1
:
v
i
X
r
a

Introduction

Let A be the ring of ad`eles of a global ﬁeld and let π be a cuspidal automorphic repre-
sentation of GLk(A). One of the pillars of the Langlands program is the study of global
automorphic L-functions, as mediating agents in the framework of functoriality.
Integral
representations are an indispensable tool in this study. Godement and Jacquet [GJ72] con-
structed the integral representation of the standard L-function of π. Jacquet, Piatetski-
Shapiro and Shalika developed Rankin–Selberg integrals for GLk × GLm. Numerous au-
thors considered integral representations for a product of a classical group and GLm, e.g.,
[GPSR87, Gin90, Sou93, GPSR97, GRS98], to name a few.

In several settings, Rankin–Selberg integrals oﬀer a “bonus”, namely a period integral
characterizing the pole or central value of the L-function. For example, the pole of the
exterior square L-function at s = 1 was characterized by the nonvanishing of a global Sha-
lika period [JS90]. A similar result was obtained for the symmetric square L-function by
Bump and Ginzburg [BG92]. Periods of automorphic forms have been studied extensively,
e.g., [GRS99a, GRS99b, GJR04], and they are especially interesting when they are of an
arithmetic nature [GJR04].

We present a new integral representation and use it to characterize the nonvanishing of a
co-period of an Eisenstein series. Let f be a global matrix coeﬃcient of π, and ϕ and ϕ′ a
pair of automorphic forms in the space of the exceptional representation of a double cover of
GLn(A), n = 2k. The cover and the exceptional representation were constructed by Kazhdan
and Patterson [KP84]. We deﬁne a zeta integral Z(f, ϕ, ϕ′, s) (see § 5.2), where we integrate
f against the Fourier coeﬃcients of ϕ and ϕ′ along the Shalika unipotent subgroup and its
(Shalika) character. Technically, it resembles the Godement–Jacquet zeta integral, where a
matrix coeﬃcient was integrated against a Schwartz–Bruhat function [GJ72], but they are
not to be confused - our integral is not an entire function. It is absolutely convergent in
some right half-plane, and for decomposable data becomes Eulerian. The computation of the
resulting local integrals with unramiﬁed data lets us identify the L-functions represented.

2010 Mathematics Subject Classiﬁcation. Primary 11F70; Secondary 11F27.
Key words and phrases. L-functions, co-period integral, periods, Shalika model, covering groups.

1

2

EYAL KAPLAN AND JAN M ¨OLLERS

We obtain the meromorphic continuation from the known properties of these L-functions,
and a detailed analysis of the local integrals.

Theorem A (see Theorem 5.4). The zeta integral extends to a meromorphic function on
the plane, and represents the quotient of partial L-functions

LS(2s, Sym2, π)
LS(2s + 1,∧2, π)

.

The corresponding local integrals are studied at both p-adic and Archimedean places in
§ 5.1. In light of existing Rankin–Selberg constructions, the denominator is expected to arise
from the normalization of an Eisenstein series on SO2n. This is not evident at present (see
the discussion below). On the other hand, the presence of exceptional representations and a
cover of GLn in an integral representing the symmetric square L-function is well understood,
considering the role these played in the Rankin–Selberg integral of Bump and Ginzburg
[BG92], and in its extension to the twisted symmetric square L-function by Takeda [Tak14].
The symmetric square L-function has been studied extensively, both via the Langlands–
Shahidi method by Shahidi (e.g., [Sha81, Sha88, Sha90]), and the Rankin–Selberg method
by Bump and Ginzburg [BG92]. The present zeta integral is weaker than these works, in the
sense that it does not seem to yield a global functional equation. At least at p-adic places,
local multiplicity-one results are known (proved in [Kap15a]), then any “similar” type of
integral may be used to deﬁne a functional equation with a proportionality factor. However,
for this to be useful the local proportionality factors should also be related to a global one.
See Remark 5.2 for more details. On the other hand, we can place the global integral in a
diﬀerent framework, that of periods.

The notion of co-period integrals was introduced by Ginzburg, Jiang and Rallis [GJR01],
for the purpose of characterizing the zero of the symmetric cube L-function of a cuspidal
automorphic representation of GL2(A) at 1/2, using the spectral decomposition of a tensor
of two exceptional representations of the 3-fold cover of GL2(A). Their co-period was an
integral of an Eisenstein series against two automorphic forms in the space of an exceptional
representation of the 3-fold cover of the exceptional group G2(A). A co-period involving an
Eisenstein series and two automorphic forms in the space of an exceptional representation
of a cover of SO2n+1(A) (or GSpin2n+1(A)) was analyzed in [Kap15b, Kap16] (following
[GJS10]).

In an ongoing work, Shunsuke Yamana and the ﬁrst named author study a co-period inte-
gral on GLn(A). Assume that π is self-dual with a trivial central character. Let E(g; ρ, s) be
an Eisenstein series corresponding to a vector ρ, of the representation parabolically induced
from π ⊗ π∨ to GLn(A), such that the residue E1/2(g; ρ) of the series at s = 1/2 is related
to the pole of L(s, π × π) at s = 1 (in fact, a more general setting is studied). The global
co-period integral CP (E1/2(· ; ρ), ϕ, ϕ′) is an integral of the residue against ϕ and ϕ′ (see
§ 6.1). The integral lends itself to a close scrutiny using the truncation operator of Arthur
[Art78, Art80]. Shunsuke Yamana and the ﬁrst named author proved that this co-period
is nonvanishing if and only if LS(s, Sym2, π) has a pole at s = 1. Moreover, the co-period
was unfolded to an explicit “outer period”, resembling the integral of the symmetric square
L-function of [BG92].

It turns out that, using a diﬀerent analysis and under a mild assumption regarding the
Archimedean places (see Assumption 5.5), we can obtain a more precise “outer period”.
Namely, we prove:

3

Theorem B (see Theorem 6.2). CP (E1/2(· ; ρ), ϕ, ϕ′) = ´K Ress=1/2Z(fkρ, kϕ, kϕ′, s) dk,

where K is the standard (global) compact subgroup and fkρ is a matrix coeﬃcient on π.
Moreover, the co-period is not identically zero if and only if the zeta integral has a nontrivial
residue at s = 1/2.

The results on the co-period have a local p-adic counterpart, proved in [Kap15a]. Let τ be
a self-dual irreducible supercuspidal representation of GLk. The results of [Kap15a] imply
that if the symmetric square L-function of τ has a pole at s = 0, the Langlands quotient of
the representation parabolically induced from | det|1/2τ ⊗| det|−1/2τ to GLn has a nontrivial
bilinear GLn pairing with a tensor of exceptional representations.
Our zeta integral involves a new model for double covers of GLn, the metaplectic Shalika
model, ﬁrst discovered in [Kap15a] during the computation of twisted Jacquet modules of
the p-adic exceptional representation (of [KP84]). The Jacquet module of this representation
along the Shalika unipotent subgroup and character is one-dimensional, and the reductive
part of its stabilizer acts by a Weil factor. Therefore, this representation admits a unique
embedding in a space of metaplectic Shalika functions. The key observation underlying this
model for the cover, is that the restriction of the cover to the Shalika group is simple, in the
sense that the cocycle is given by the quadratic Hilbert symbol. This follows immediately
from the block-compatibility of the cocycle of Banks, Levy and Sepanski [BLS99]. See § 3.1
for a precise introduction to this model.
Roughly speaking, a model of a representation is an embedding, preferably unique, into a
space of functions on the group, which is beneﬁcial and convenient in terms of applications.
One important model is the Whittaker model, which has had a profound impact on the study
of representations, with a vast number of applications, perhaps most notably the Langlands–
Shahidi theory of local coeﬃcients. This model has a natural extension to covering groups,
because unipotent subgroups are split under the cover. Indeed, the metaplectic Whittaker
model has been studied, e.g., in [KP84, BFH91, McN11, CO13]. The main downside to using
this model for covering groups, is that multiplicity one no longer holds. For instance over an
r-fold cover of GLn, the dimension of the space of Whittaker functionals on an unramiﬁed
principal series representation is essentially rn.

The (non-metaplectic) Shalika model was ﬁrst introduced in a global context in the afore-
mentioned work of Jacquet and Shalika [JS90]. Friedberg and Jacquet [FJ93] used it to
characterize cuspidal automorphic representations aﬀording linear models, in terms of the
pole of the exterior square L-function at s = 1 (see also [BF90]). Ash and Ginzburg [AG94]
used this model to construct p-adic L-functions. Multiplicity one results were proved by
Jacquet and Rallis [JR96] (over p-adic ﬁelds) and by Aizenbud, Gourevitch and Jacquet
[AGJ09] over Archimedean ﬁelds. Globally, a cuspidal automorphic representation π af-
fords a Shalika functional (given by an integral) if and only if LS(s,∧2, π) has a pole at
s = 1, and equivalently is a weak functorial lift from SO2n+1 ([JS90, GRS99b, GRS01]).
A similar local result was proved for supercuspidal representations in [JNQ08], and is ex-
pected to hold in greater generality. Further studies and applications of this model include
[GRS99a, JQ07, JNQ10].

In this work we launch a study of the metaplectic Shalika model. In sharp contrast to the
Whittaker model, we conjecture that the metaplectic Shalika model does enjoy multiplicity
one. We establish the following result.

Theorem C (see Theorems 3.10 and 3.37). Let I(χ) be a principal series representation of
a double cover of GLn, over any local ﬁeld, but over a p-adic ﬁeld assume it is unramiﬁed.

4

EYAL KAPLAN AND JAN M ¨OLLERS

Assume χ satisﬁes a certain regularity condition, which does not preclude reducibility. Then
the space of metaplectic Shalika functionals on I(χ) is at most one-dimensional. Over a
p-adic ﬁeld and when I(χ) is irreducible, this space is one-dimensional if and only if I(χ) is
a “lift” from a classical group.

It is perhaps premature to discuss lifting problems for covering groups; here we simply
mean the natural condition one expects χ to satisfy, analogous to the case of GLn. This
result is our main tool to deduce that the (global) zeta integral is Eulerian.

Another practical starting point for the study of the metaplectic Shalika model, is the
unramiﬁed setting. We prove a Casselman–Shalika formula for an unramiﬁed principal series
representation of a double cover of GLn. For GLn this formula was proved by Sakellaridis
[Sak06], and our proof closely follows his arguments.

Theorem D (see Theorem 3.28 and Corollary 3.35). Let I(χ) be an unramiﬁed principal
series representation of a double cover of GLn, which admits a metaplectic Shalika model.
There is an explicit formula for the values of the unique unramiﬁed normalized function in
the model, in terms of the character χ.

We apply our formula to the exceptional representation and use it to compute the local

zeta integrals with unramiﬁed data.

In his proof, Sakellaridis [Sak06] used a variant of the Casselman–Shalika method devel-
oped by Hironaka [Hir99, Proposition 1.9]. The original approach of Casselman and Shalika
[CS80] was to compute functionals on torus translates of the Casselman basis element cor-
responding to the longest Weyl element. A somewhat more versatile approach has been
introduced by Hironaka, namely to compute the projection of the functional, say, the Sha-
lika functional, onto the Iwahori invariant subspace. So, our ﬁrst step is to extend some of
the ideas from [Hir99] to the cover. Hironaka established a formula for expressing a spherical
function on certain spherical homogeneous spaces, which is applicable also in the absence
of uniqueness results. We verify this formula for the double cover of GLn, see Lemma 2.15
and Corollary 2.17. In fact, our proof is general and applicable to a large class of covering
groups, e.g., the central extensions of unramiﬁed reductive p-adic groups by ﬁnite cyclic
groups, studied by McNamara [McN11, McN12, McN14] (at present, with his assumption
on the cardinality of the residue ﬁeld). See the discussion in the end of § 2.3.
Since the formula of [Hir99] does not depend on a uniqueness property, it may well be more
adequate for covering groups, where multiplicity one results may fail (e.g., for the Whittaker
model). Our analog of [Hir99, Proposition 1.9] involves the veriﬁcation of several results well
known in the non-metaplectic setting. We greatly beneﬁted from the work of Chinta and
Oﬀen [CO13], explaining how to extend the results of Casselman [Cas80] to (r-fold) covers
of GLn. We must point out that the study of spherical functions on spherical varieties is
vigorously expanding. The aforementioned techniques (e.g., of [Hir99]) have been extended
and generalized by Sakellaridis [Sak13]. While his work does not include covering groups,
his ideas are expected to apply to this context, albeit with some modiﬁcations.

As mentioned above, the Shalika model has global aspects and the same applies to its
metaplectic analog. In a global setting, as with the Whittaker model, one requires a (perhaps)
stronger notion. An automorphic representation is called globally generic if it admits a
Whittaker functional given by a Fourier coeﬃcient. Surprisingly enough, we prove:

Theorem E (see Theorem 4.22). The global exceptional representation admits a metaplectic
Shalika functional, given by a Fourier coeﬃcient.

5

Using this, we prove that exceptional representations over Archimedean ﬁelds also admit
a metaplectic Shalika model, which is then unique, because of Theorem C. Theorem E also
plays a key role in the deﬁnition of the zeta integral. Moreover, we study a family of Fourier
coeﬃcients of exceptional representations and use their properties to prove Theorem B.

Theorem E demonstrates a very special phenomenon, although not estranged from ex-
ceptional representations of other groups (see, e.g., [Kap15b, § 3.4.2]). In fact, it is inti-
mately related to the fact that minimal, or small representations are supported on small
unipotent orbits, in the sense that generic Fourier coeﬃcients of their automorphic forms
vanish on suﬃciently large (with respect to the partial ordering) unipotent orbits. See
[Car93, CM93, BFG03, Gin06] for more details. We mention that Shalika functionals writ-
ten solely in terms of a unipotent integration already appeared in a work of Beineke and
Bump [BB06] in the non-metaplectic case, for a speciﬁc representation.

As mentioned above, the proof of meromorphic continuation of the global zeta integrals
involves establishing meromorphic continuation of the local integrals. Over Archimedean
ﬁelds, such a result is usually diﬃcult to obtain, the analysis must be performed carefully,
due to the involvement of topological vector spaces. To achieve this, we develop an asymp-
totic expansion of metaplectic Shalika functions over Archimedean ﬁelds, using tools and
techniques from Wallach [Wal83, Wal88, Wal92] and Soudry [Sou95], see § 3.2. This result
may be of independent interest (it also applies to the non-metaplectic setting). Note that as
a preliminary result, we write an asymptotic expansion of smooth matrix coeﬃcients, on a
whole Weyl chamber. This result applies to any real reductive group.

The rest of this work is organized as follows.

In § 1 we establish some notation and
preliminaries, and recall several facts about the double cover. Section 2 is dedicated to p-
adic unramiﬁed theory. Section 3 begins with a general discussion of the metaplectic Shalika
model, then we compute the Casselman–Shalika formula.

In § 4 we discuss exceptional representations. We brieﬂy recall their deﬁnition in § 4.1.
Local results are contained in § 4.2, where we apply Theorem D to unramiﬁed exceptional
representations, and Theorem C to exceptional representations over R. In § 4.3 we study
global Fourier coeﬃcients. The local and global theory of the zeta integral is contained in
§ 5. Section 6 is devoted to the co-period.
Acknowledgments. The ﬁrst named author wishes to express his gratitude to David
Ginzburg, Erez Lapid and David Soudry for many encouraging conversations. We thank
Yiannis Sakellaridis for his interest in Theorem D and useful remarks. We thank Dmitry
Gourevitch and Nolan Wallach for helpful correspondences. Lastly, the authors are grateful
to Jim Cogdell and Robert Stanton for their kind encouragement and helpful remarks.

Contents

Introduction
1. Preliminaries
2. Metaplectic Hironaka Theory
3. The metaplectic Shalika model
4. Metaplectic Shalika model for exceptional representations
5. A Godement–Jacquet type integral
6. The co-period
References

1
6
12
22
46
58
65
71

6

EYAL KAPLAN AND JAN M ¨OLLERS

1. Preliminaries

1.1. The groups. Let Gn = GLn. Fix the Borel subgroup Bn = Tn ⋉Nn of upper triangular
matrices in Gn, where Tn is the diagonal torus. For any k ≥ 0, let Qk = Mk ⋉ Uk be the
standard maximal parabolic subgroup of Gn, whose Levi part Mk is isomorphic to Gk×Gn−k.
For any parabolic subgroup Q, δQ denotes its modulus character. If U is a unipotent radical
of a standard parabolic subgroup, let U − denote the unipotent radical opposite to U.

Let W be the Weyl group of Gn. The longest Weyl element is denoted by w0 and the
identity element by e. For w ∈ W , let ℓ(w) be the length of w. Let ΣGn be the set of roots,
Σ+
Gn be the subset of positive roots and ∆Gn be the set of simple roots compatible with our
choice of Bn. For α ∈ ∆Gn, denote the simple reﬂection along α by sα. Of course W is
generated by the set of simple reﬂections.
In general for any group G, CG denotes its center. If Y < G and d ∈ Z, Y d = {yd : y ∈ Y }.
Also for x, y ∈ G, xy = xyx−1, xY = {xy : y ∈ Y }.
Throughout, all ﬁelds will be assumed to have characteristic diﬀerent from 2. If F is a
local ﬁeld, we usually denote Gn = Gn(F ). For a global ﬁeld F , its ring of ad`eles is denoted
A. The vector space of k × k matrices over a ring R (usually a local ﬁeld) is denoted Rk×k.
In the Archimedean case we use small gothic letters like gn and uk to denote the Lie algebras
of the corresponding groups Gn and Uk. For F = C we regard the complex Lie algebras as
real ones. Write U(gn) for the universal enveloping algebra of the complexiﬁcation of gn and
Z(gn) for its center.
1.2. The local metaplectic cover. Let F be a local ﬁeld, (· , · )2 be the Hilbert symbol
of order 2 of F , and µ2 = {−1, 1}. Put Gn = Gn(F ). Kazhdan and Patterson [KP84]
[Mat69] and the embedding g 7→ diag(g, det g−1) of Gn in SLn+1.

constructed the double cover eGn of Gn, using the double cover of SLn+1 of Matsumoto
Given a 2-cocycle σ : Gn × Gn → µ2, let eGn be the associated central extension of Gn
by µ2, p : eGn → Gn be the natural projection and s : Gn → eGn be a section such that
of Gn to the identity element of eGn). For any subset X ⊂ Gn, put eX = p−1(X).

p(s(g)) = g and σ(g, g′) = s(g)s(g′)s(gg′)−1 (we also require s to take the identity element

We use the block-compatible cocycle σ = σn of Banks, Levi and Sepanski [BLS99]. The

block-compatibility formula is given by

σ(diag(a, b), diag(a′, b′)) = σk(a, a′)σn−k(b, b′)(det a, det b′)2,

(a, b), (a′, b′) ∈ Mk.

(1.1)

This cocycle is trivial when n = 1, and for n = 2 coincides with the cocycle of Kubota
[Kub67]. Speciﬁcally if g = ( a b

c d ) ∈ G2, put x(g) = c if c 6= 0, otherwise x(g) = d, then

σ(g, g′) =(cid:16) x(gg′)

x(g)

,

x(gg′)

x(g′) det g(cid:17)2

.

(1.2)

The cocycle σ and its twist

σ(1)(g, g′) = (det g, det g′)2σ(g, g′)

exhaust the nontrivial cohomology classes. All of our results in this work hold for both σ
and σ(1). In fact, all of the computations will involve g and g′ such that (det g, det g′)2 = 1
(e.g., det g ∈ F ∗2).
We mention several properties of σ (and σ(1)), that will be applied throughout. For any
If gv ∈ Nn, then s(gv) =
g ∈ Gn and v ∈ Nn, s(gv) = s(g)s(v) and s(vg) = s(v)s(g).
s(g)s(v)s(g)−1. Consequently if s is a splitting of M < Gn (i.e., a homomorphism), U < Nn

7

and MU = M ⋉ U, s is a splitting of MU. Note that C eGn
otherwise e = 2.

Gn, where e = 1 if n is odd,

= eC e

For computations we ﬁx a concrete set of elements W ⊂ Gn as in [BLS99], which is in
) in the subgroup of Gn

bijection with W . For α ∈ ΣGn, let wα be the image of ( −1
corresponding to α. Deﬁne

1

W = {wα1 · . . . · wαℓ(w) : w ∈ W, w = sα1 · . . . · sαℓ(w)}.

1.3. The global metaplectic cover. Let F be a global ﬁeld. For a ﬁnite place v of F , let
Ov denote the ring of integers of Fv and ̟v be a generator of the maximal ideal. The group
ν Gn(Fν) with respect to the compact subgroups

Gn(A) is the restricted direct product Q′
{Kv}v, where Kv = Gn(Ov) for almost all v, and we denote K =Qv Kv. The global double
cover eGn(A) was constructed in [KP84, § 0.2] (see also [FK86, Tak14]). For all v < ∞ such
ν eGn(Fν), where
s =Qv sv, which is not deﬁned on Gn(A), but is a splitting of Gn(F ) and Nn(A) and is well
deﬁned on Tn(A). We identify Gn(F ) and Nn(A) with their image under s in eGn(A).

that qv = |̟vOv\Ov| is odd and qv > 3, there are canonical splittings κv of Kv ([Moo68,
pp. 54-56], see also [KP84, Proposition 0.1.3]). We extend them to sections of Gn(Fv). Also
set µ×
the restricted direct product is taken with respect to {κv(Kv)}v. There is a global function

v eGn(Fv) : ǫv ∈ µ2,Qv ǫv = 1}. Then eGn(A) = µ×
2 \Q′

2 = {(ǫv)v ∈Q′

1.4. Local representations. Let Alg G be the category of complex and smooth represen-
tations of G, if G is an l-group (in the sense of [BZ76]), or smooth admissible Fr´echet
representations of moderate growth if G is a real reductive group.

For π ∈ Alg G we denote by π∨ the contragredient representation of π. If V is the space of
π, V ∨ will denote the space of π∨. For a real reductive group G, π∨ is the smooth admissible
Fr´echet globalization of moderate growth, of the K-ﬁnite vectors in the dual representation.
Then a matrix coeﬃcient of π is a function of the form f (g) = ξ∨(π(g)ξ) where ξ ∈ V and
ξ∨ ∈ V ∨.
Induction is not
normalized. Over an Archimedean ﬁeld induction denotes smooth induction.

Regular induction is denoted Ind, and ind is the compact induction.

functions on X.

For an l-space or an abelian Lie group X, let S(X) be the space of Schwartz–Bruhat
Let G be an l-group and π ∈ Alg G. Let U < G be a closed subgroup, exhausted by its
compact subgroups (here U will be a unipotent subgroup of Gn), ψ be a character of U, and
M < G be the normalizer of U and stabilizer of ψ. The Jacquet module of π with respect
to U and ψ is denoted πU,ψ. It is a representation of M. The action is not normalized. The
kernel of the surjection π → πU,ψ is denoted π(U, ψ), and occasionally we write the elements
of πU,ψ in the form ξ + π(U, ψ) (ξ in the space of π). When ψ = 1, we simply write πU and
π(U).

Let π ∈ Alg Gn be irreducible and Q = M ⋉ U be a parabolic subgroup of Gn. Assume
that the underlying ﬁeld is p-adic. The normalized exponents of π along Q are the central
characters of the irreducible constituents of δ−1/2
πU . For example if π is an irreducible
representation with a unitary central character, then it is square integrable if and only if its
normalized exponents along any standard parabolic subgroup lie in the open cone spanned
by the positive roots in M.

Q

1.5. Asymptotic expansions over Archimedean ﬁelds. We derive an asymptotic ex-
pansion for matrix coeﬃcients f (g) = ξ∨(π(g)ξ) of Gk. The key ideas are due to Wallach

8

EYAL KAPLAN AND JAN M ¨OLLERS

(see [Wal83, Theorem 7.2], [Wal88, Chapters 4.3, 4.4] and [Wal92, Chapter 15.2]), we adapt
them to our setting (see also [Sou95, Theorem 1 in § 4]). The novelty is that we derive an
expansion into an exponential power series, not only on a one-parameter group but on a
whole Weyl chamber, depending continuously on ξ and ξ∨. We carry out the details for Gk,
but the proof extends to any real reductive group.

Let F be an Archimedean ﬁeld. Recall the maximal parabolic subgroups Qℓ = Mℓ ⋉ Uℓ
of Gk. The non-compact central factor of Mℓ is given by Aℓ = exp(aℓ) with aℓ = RIk + RHℓ

and Hℓ = diag(Iℓ, 0k−ℓ). For x = (x1, . . . , xk) ∈ Rk put ax = exp(−Pk

ℓ=1 xℓHℓ).
For a representation π ∈ Alg Gk on a space V , we write E1(Qℓ, π) ⊂ (aℓ)∗

set of generalized aℓ-weights in V /uℓV . Put

C for the ﬁnite

E(ℓ)
1 (π) = {µ(Hℓ) : µ ∈ E1(Qℓ, π)} ⊂ C,
E(ℓ)(π) = E(ℓ)
Λπ,ℓ = min{Re z : z ∈ E(ℓ)(π)} = min{Re z : z ∈ E(ℓ)
Λπ = (Λπ,1, . . . , Λπ,k).

1 (π) + N,

1 (π)},

(1.3)

∀x ∈ Rk

Here N = {0, 1, 2, . . .}. By [Wal92, Theorem 15.2.4] there exist continuous seminorms q1, q2
on V , V ∨ (resp.) and d ≥ 0 such that

>0, ξ ∈ V, ξ∨ ∈ V ∨.

|ξ∨(π(ax)ξ)| ≤ q1(ξ)q2(ξ∨)(1 + |x|)de−Λπ·x,

(1.4)
For a subset I = {i1, . . . , ir} of {1, . . . , k} with i1 < . . . < ir, let xI = (xi1, . . . , xir ) and

I = {1, . . . , k}−I.
Theorem 1.1. Let π ∈ Alg Gk be an irreducible representation on a space V . For any D =
(D1, . . . , Dk) ∈ Rk there exist ﬁnite subsets Cℓ ⊂ E(ℓ)(π) and functions pI,z : Rk×V ×V ∨ → C
for I ⊂ {1, . . . , k}, z ∈Qℓ∈I Cℓ, such that the following holds.
(1) For all ξ ∈ V , ξ∨ ∈ V ∨ and x ∈ Rk,
ξ∨(π(ax)ξ) =XI,z
pI,z(x; ξ, ξ∨) · e−z·xI ,

where the (ﬁnite) summation is over all I ⊂ {1, . . . , k} and z ∈Qℓ∈I Cℓ.

(2) Each function pI,z(x; ξ, ξ∨) is polynomial in xI:

(1.5)

cα(xI; ξ, ξ∨)xα
I ,

(1.6)

pI,z(x; ξ, ξ∨) = Xα∈NI

where the coeﬃcients cα(xI ; ξ, ξ∨) are smooth in xI, linear in ξ and ξ∨, and satisfy bounds
of the form

|cα(xI ; ξ, ξ∨)| ≤ q1(ξ)q2(ξ∨)(1 + |xI|)de−DI ·xI ,

∀xI ∈ RI
with d ≥ 0 and continuous seminorms q1, q2 on V , V ∨ (resp.).

>0, ξ ∈ V, ξ∨ ∈ V ∨,

(1.7)

Proof. It is enough to show the above statement for arbitrarily large Dℓ, ℓ = 1, . . . , k. We
achieve this by ﬁrst treating the case D = Λπ, then proving that any D can be replaced by
D + eℓ for some ℓ = 1, . . . , k. Repeatedly applying this argument yields the claim.

For D = Λπ one may choose the sum in (1.5) to consist of only one summand, for the
empty set I, then the statement follows from (1.4). Now let D ∈ Rk be arbitrary and assume
(1.5), (1.6) and (1.7). We ﬁx 1 ≤ ℓ ≤ k and prove that the same is true for D replaced by
D + eℓ. For brevity, set H = Hℓ, t = xℓ and x′ = (x1, . . . , xℓ−1, 0, xℓ+1, . . . , xk).

9

Let {Xp}p be a basis of uℓ. In [Wal92, § 15.2.4] Wallach constructed E1 = 1, E2, . . . , Er ∈

U(gk) as well as ﬁnite sets {Zi,j}i,j ⊂ Z(gk) and {Up,i}p,i ⊂ U(gk) such that

HℓEi =Xj

Zi,jEj +Xp

XpUp,i,

∀i = 1, . . . , r.

(1.8)

Since π is irreducible, the elements Zi,j act by scalars Bi,j = π(Zi,j) ∈ C and we form
the matrix B = (Bi,j)i,j. Note that the eigenvalues of B are contained in the ﬁnite set
E(ℓ)
1 (π) = {ζ1, . . . , ζN} (the generalized eigenvalues of π(Hℓ) on the Jacquet module V /uℓV ).
Deﬁne

F (t, x′; ξ, ξ∨) =
G(t, x′; ξ, ξ∨) =Xp



ξ∨(π(e−tH)π(ax′)π(E1)ξ)

...

ξ∨(π(e−tH )π(ax′)π(Er)ξ)

ξ∨(π(e−tH )π(ax′)π(Xp)π(Up,1)ξ)

 ,

...

ξ∨(π(e−tH)π(ax′)π(Xp)π(Up,r)ξ)



The ﬁrst coordinate of F (t, x′; ξ, ξ∨) is equal to ξ∨(π(ax)ξ) and the function F (t, x′; ξ, ξ∨)
satisﬁes the following diﬀerential equation:

d
dt

F (t, x′; ξ, ξ∨) = −BF (t, x′; ξ, ξ∨) − G(t, x′; ξ, ξ∨).

The solution of this system is given by

F (t, x′; ξ, ξ∨) = e−tBF (0, x′; ξ, ξ∨) − e−tB ˆ t

0

eτ BG(τ, x′; ξ, ξ∨) dτ.

(1.9)

We claim that each coordinate on the right-hand side is a ﬁnite sum of terms of the form

c(xI; ξ, ξ∨)xα

I e−z·xI

(1.10)

in xI, linear in ξ and ξ∨ and satisﬁes

with I ⊂ {1, . . . , k}, α ∈ NI and z ∈Qi∈I E(i)(π), and a function c(xI; ξ, ξ∨) which is smooth
|c(xI; ξ, ξ∨)| ≤ q1(ξ)q2(ξ∨)(1 + |xI|)de−(D+eℓ)I ·xI ,

>0, ξ ∈ V, ξ∨ ∈ V ∨,

∀xI ∈ RI

(1.11)

for some continuous seminorms q1, q2 and d ≥ 0. This will ﬁnish the proof.

Note that

eτ B =

NXj=1

Pj(τ )eζj τ

(1.12)

for some matrix-valued polynomials Pj(τ ). Let us treat the two summands in (1.9) separately.
(1) The coordinates of F (0, x′; ξ, ξ∨) are of the form ξ∨(π(ax′)π(Ei)ξ), and by (1.12) multi-

plying with e−tB yields sums of terms of the form

(1.13)
where m ≥ 0. The map ξ 7→ π(Ei)ξ is continuous, hence for every continuous seminorm
q′
1 on V there exists a continuous seminorm q1 such that q′
1(π(Ei)ξ) ≤ q1(ξ) for all

tme−ζj t · ξ∨(π(ax′)π(Ei)ξ),

10

EYAL KAPLAN AND JAN M ¨OLLERS

ξ ∈ V . Applying the induction assumption to the matrix coeﬃcients ξ∨(π(ax′)π(Ei)ξ)
then shows that the terms (1.13) are ﬁnite sums of the form

tme−ζj t · c(x′

J ; ξ, ξ∨)(x′

J )αe−z′·x′

J

c(x′

J , linear in ξ and ξ∨, and satisﬁes

where J ⊂ {1, . . . , k}−{ℓ}, J = {1, . . . , k}−(J ∪ {ℓ}), α ∈ NJ, z′ ∈ Qi∈J E(i)(π) and
J ; ξ, ξ∨) is smooth in x′
|c(x′
(ζj, z′) ∈ E(ℓ)(π) ×Qi∈J E(i)(π), then (1.14) is clearly of the form (1.10) and c(xI ; ξ, ξ∨)

for some continuous seminorms q1, q2 and d ≥ 0. Let I = J ∪ {ℓ}, x = x′ + teℓ and z =
satisﬁes (1.11) since ℓ /∈ I.

J ; ξ, ξ∨)| ≤ q1(ξ)q2(ξ∨)(1 + |x′

>0, ξ ∈ V, ξ∨ ∈ V ∨,

J|)de−DJ ·x′

J ∈ RJ

∀x′

J ,

(2) The coordinates of G(t, x′; ξ, ξ∨) are sums of the terms

(1.14)

ξ∨(π(e−tH )π(ax′)π(Xp)π(Up,i)ξ) = e−tξ∨(π(ax′)π(Xp)π(e−tH )π(Up,i)ξ).

e−te−β·x′

Note that π(ax′)π(Xp) is a sum of terms of the form e−β·x′π(X)π(ax′) with X ∈ uℓ and
β ∈ Nk−1. Hence, each coordinate of G(t, x′; ξ, ξ∨) is a sum of terms of the form
U, X ∈ U(gk), β ∈ Nk−1.

· (π∨(X)ξ∨)(cid:16)π(e−tH)π(ax′)π(U)ξ(cid:17),

Since ξ 7→ π(U)ξ and ξ∨ 7→ π∨(X)ξ∨ are continuous linear operators we can apply the
induction assumption to the matrix coeﬃcients (π∨(X)ξ∨)(π(e−tH )π(ax′)π(U)ξ) and ﬁnd
that the coordinates of G(t, x′; ξ, ξ∨) are linear combinations of terms of the form
J · e−t

with J ⊂ {1, . . . , k}−{ℓ}, J = {1, . . . , k}−(J ∪ {ℓ}), α ∈ NJ , m ∈ N, z′ ∈Qi∈J E(i)(π),

zℓ ∈ E(ℓ)(π), where the coeﬃcients c(x′
also t in the second case, linear in ξ and ξ∨, and satisfy estimates of the form

J ; ξ, ξ∨) are smooth in x′

J ; ξ, ξ∨) and c(t, x′

J · tme−(zℓ+1)·t

J ; ξ, ξ∨)(x′

J ; ξ, ξ∨)(x′

J )αe−z′·x′

J )αe−z′·x′

J and

c(t, x′

c(x′

and

J ; ξ, ξ∨)| ≤ q1(ξ)q2(ξ∨)(1 + |x′
J ; ξ, ξ∨)| ≤ q1(ξ)q2(ξ∨)(1 + |x′

|c(x′
|c(t, x′
(1.16)
J ∈ RJ
>0, t ≥ 0 and ξ ∈ V , ξ∨ ∈ V ∨. Here we have attributed the factors e−βixi
for all x′
either to e−z′·x′
J in case i ∈ J, or to c(x′
J ; ξ, ξ∨) in case i /∈ J. Then
by (1.12) the components of e(τ −t)BG(τ, x′; ξ, ξ∨) are linear combinations of terms of the
form

J ,
J (1 + t)de−Dℓt

J|)de−DJ ·x′
J|)de−DJ ·x′

J ; ξ, ξ∨) and c(t, x′

(1.15)

J · τ me(ζj −zℓ−1)·τ
J · τ me(ζj −1)τ .
We treat the integration over τ for these two types separately.

I1 = tne−ζj t · c(x′
I2 = tne−ζj t · c(τ, x′

J ; ξ, ξ∨)(x′

J ; ξ, ξ∨)(x′

J )αe−z′·x′

J )αe−z′·x′

For I1 we know that

ˆ t

0

τ me(ζj −zℓ−1)·τ dτ = p(t)e(ζj −zℓ−1)t + C

for some polynomial p(t) and a constant C. Hence

and

ˆ t

0

I1 dτ = p(t)tne−(zℓ+1)tc(x′

J ; ξ, ξ∨)(x′

J )αe−z′·x′

J

+ Ctne−ζj tc(x′

J ; ξ, ξ∨)(x′

J )αe−z′·x′
J .

11

Both summands are linear combinations of terms of the form (1.10) for I = J ∪{ℓ} since
both zℓ + 1, ζj ∈ E(ℓ)(π), and the corresponding estimates (1.11) follow from (1.15) since
ℓ /∈ I.

For I2 we ﬁrst assume Dℓ > Re ζj − 1. Then rewrite
I2 dτ −ˆ ∞

I2 dτ = ˆ ∞

ˆ t

0

0

t

I2 dτ.

The ﬁrst integral

ˆ ∞

0

I2 dτ = tne−ζjt(x′

J )αe−z′·x′

J ˆ ∞

0

c(τ, x′

J ; ξ, ξ∨)τ me(ζj −1)τ dτ

is of the form (1.10) for I = J ∪ {ℓ}. The estimate (1.11) follows from (1.16) since
|c(τ, x′

J ; ξ, ξ∨)τ me(ζj −1)τ| is bounded by

q1(ξ)q2(ξ∨)(1 + |x′

J|)de−DJ ·x′

J · τ m(1 + τ )de(Re ζj−Dℓ−1)τ ,

The second integral

which is integrable over R>0 since Dℓ > Re ζj − 1.
J · tne−ζjtˆ ∞

I2 dτ = (x′

J )αe−z′·x′

ˆ ∞

t

t

c(τ, x′

J ; ξ, ξ∨)τ me(ζj −1)τ dτ

is of the form (1.10) for I = J. The integral is by the previous estimation smooth in t
and x′

J , and the estimate (1.11) follows from

(cid:12)(cid:12)(cid:12)(cid:12)tne−ζj tˆ ∞

t

c(τ, x′

J ; ξ, ξ∨)τ me(ζj −1)τ dτ(cid:12)(cid:12)(cid:12)(cid:12)

J|)de−DJ ·x′
≤ q1(ξ)q2(ξ∨)(1 + |x′
≤ constant × q1(ξ)q2(ξ∨)(1 + |x′

J · tne− Re ζj tˆ ∞
J|)de−DJ ·x′

t

τ m(1 + τ )de(Re ζj −Dℓ−1)τ dτ

J · (1 + t)m+d+ne−(Dℓ+1)t.

It remains to consider I2 when Dℓ ≤ Re ζj − 1. Then

ˆ t

0

I2 dτ = (x′

J )αe−z′·x′

J · tne−ζjtˆ t

0

c(τ, x′

J ; ξ, ξ∨)τ me(ζj −1)τ dτ

is of the form (1.10) for I = J. The estimate (1.11) now follows from (1.16) since

(cid:12)(cid:12)(cid:12)(cid:12)tne−ζj tˆ t

0

c(τ, x′

J ; ξ, ξ∨)τ me(ζj −1)τ dτ(cid:12)(cid:12)(cid:12)(cid:12)

≤ q1(ξ)q2(ξ∨)(1 + |x′
≤ q1(ξ)q2(ξ∨)(1 + |x′

J|)de−DJ ·x′
J|)de−DJ ·x′

J · tne−(Re ζj)tˆ t
J · tn+1(1 + t)de−(Dℓ+1)t.

0

τ m(1 + τ )de(Re ζj −Dℓ−1)τ dτ

The proof is complete.

(cid:3)

12

EYAL KAPLAN AND JAN M ¨OLLERS

1.6. The Weil symbol. Let F be a local ﬁeld. We usually denote by ψ a nontrivial additive
character of F . Then γψ is the normalized Weil factor ([Wei64, § 14]), γψ(· )4 = 1. For
a ∈ F ∗, ψa denotes the character ψa(x) = ψ(ax) and γψ,a = γψa. We have the following
formulas (see the appendix of [Rao93], γψ(a) is γF (a, ψ) in his notation):

γψ(xy) = γψ(x)γψ(y)(x, y)2,

γψ(x2) = 1,

γ−1
ψ = γψ−1,

γψ,a(x) = (a, x)2γψ(x).

(1.17)

2. Metaplectic Hironaka Theory

normalize the Haar measure dg on Gn such that vol(K) = 1. Let κ : K → eGn be the

2.1. Preliminaries. In this section F is a local non-Archimedean ﬁeld and Gn = Gn(F ).
Then O, ̟, K and q are deﬁned as in § 1.3. Assume q > 3 and |2| = 1 in the ﬁeld. We
canonical splitting of K. It coincides with s on Tn ∩ K, W and Nn ∩ K (W was deﬁned in
§ 1.2, and is a subset of K). We use this freely, e.g., it implies that s is a splitting of W.
2.2. Metaplectic review of Casselman’s theory. In this section we describe a metaplec-
tic analog of several results of Casselman [Cas80], needed in the following section to prove
a result of Hironaka [Hir99]. We deﬁne an analog of Casselman’s basis for the Iwahori ﬁxed
subspace of an unramiﬁed principal series. Following [Hir99], we use this basis to deduce a
general formula for functionals on this space. The bulk part of this section has already ap-
peared in the works of Chinta and Oﬀen [CO13] and McNamara [McN12], speciﬁc references
are given below.

In order to apply the ideas of [Cas80] we need several auxiliary results. Let I < K be the
Iwahori subgroup which is compatible with Bn. The section κ is in particular a splitting of
I. The Iwahori factorization of I reads I = I +I 0I− where I + = I ∩ Nn, I 0 = I ∩ Tn and
I− = I ∩ N −

n . Note that

I = (I ∩ Bn)I− = (K ∩ Bn)I−.

(2.1)

For a representation π ∈ AlgeGn and a compact open subgroup K0 < K, the space of

κ(K0)-invariants is denoted πK0 and the projection on πK0 is denoted PK0. For any vector
ξ in the space of π,

PK0(ξ) = ˆK0

π(κ(k))ξ dk,

where the measure is normalized such that vol(K0) = 1.

Let

T −
n = {t ∈ Tn : |α(t)| ≤ 1,
The following is a version of Jacquet’s First Lemma.

∀α ∈ ∆Gn}.

Claim 2.1. Let π ∈ AlgeGn be admissible. For any ξ in the space of πI 0I − and t ∈ C eTn ∩eT −

PI(π(t)ξ) − π(t)ξ ∈ π(Nn).

PI(π(t)ξ) = PI +(π(t)ξ),

n ,

Proof. Write the integral PI using the Iwahori decomposition I = I +I 0I−. Then

PI(π(t)ξ) = ˆI + ˆI 0 ˆI −
= ˆI + ˆI 0 ˆI −

π(κ(x)κ(y)κ(z)t)ξ dz dy dx

π(κ(x)tκ(y) t−1

κ(z))ξ dz dy dx

= PI +(π(t)ξ).

Here we used the facts that t−1κ(I−) < κ(I−), t commutes with κ(I 0) and ξ ∈ πI 0I −. Then
the Jacquet-Langlands lemma (see e.g., [BZ76, 2.33]) implies that PI +(π(t)ξ) and π(t)ξ
have the same image in πNn.
(cid:3)

The following claim is a weak analog of [Cas80, Proposition 2.4].

13

Claim 2.2. Let π ∈ AlgeGn be admissible. The representation πI injects as a vector space

into πI0
Nn.
Proof. We have to prove πI ∩ π(Nn) = 0. Let ξ belong to the space of πI ∩ π(Nn). We prove
ξ = 0. According to the Jacquet-Langlands lemma ([BZ76, 2.33]) there is a compact open
subgroup N < Nn with

ˆN

π(v)ξ dv = 0.

Let t ∈ C eTn ∩ eT −

n be such that N < p(t)−1I +. Then by Claim 2.1,
PI(π(t)ξ) = ˆI +
π(s(p(t)−1

π(κ(x)t)ξ dx = π(t)ˆI +

x))ξ dx = 0,

by our choice of t. However, by [Sav88, Proposition 3.1.4] the mapping ξ 7→ PI(π(t)ξ)
on the ﬁnite-dimensional space πI is invertible (this mapping is essentially π(Tp(t)) in the
notation of loc. cit.).
(cid:3)

Remark 2.3. The original claim in [Cas80] also included surjectivity. In the metaplectic
case this does not hold in general, e.g., when π is a genuine unramiﬁed principal series.

Tn,∗ = {diag(t1z, . . . , tnz) : ti ∈ F ∗2O∗, z ∈ F ∗e}

We recall the parametrization of genuine unramiﬁed principal series representations of eGn.
Let eTn,∗ be the centralizer of eTn ∩ κ(K) in eTn, it is a maximal abelian subgroup. Explicitly,
(e was deﬁned in § 1.2). Assume s ∈ Cn. Let γ : F ∗ → C be a function satisfying
γ(zz′) = γ(z)γ(z′)σ(zIn, z′In) for z, z′ ∈ F ∗e, and γ|F ∗2 = γ|O∗ = 1. The genuine unramiﬁed
character χ = χs,γ of eTn,∗ is deﬁned by
χ(ǫs(diag(t1, . . . , tn))s(zIn)) = ǫγ(z)|z|s1+...+sn

∀ǫ ∈ µ2, ti ∈ F ∗2O∗, z ∈ F ∗e.

|ti|si,

nYi=1

Put Bn,∗ = Tn,∗Nn, it is a closed subgroup of Gn, open and normal in Bn. Then

I(χ) = Ind

eGn
eBn,∗

(δ1/2

Bn χ)

is a genuine unramiﬁed principal series representation, i.e., I(χ)K is one dimensional, and
Z (as opposed to
any such representation takes this form, where si is unique modulo πi
log q
2πi
Z in Gn). The dependency on γ will not appear in the formulas and in fact when n is
log q
even, γ is irrelevant. For a general discussion of these representation for r-fold covers of Gn
see [CO13].

We regard the elements in the space of I(χ) as complex-valued functions. The unramiﬁed
normalized element of I(χ) is the unique function fχ ∈ I(χ) such that fχ(gκ(k)) = fχ(g)

14

EYAL KAPLAN AND JAN M ¨OLLERS

fχ(s(t)) = 0,

∀t ∈ Tn−Tn,∗.

(Lemma I.1.3, see also [McN12] Lemma 2) that for any unramiﬁed fχ,

for any g ∈ eGn and k ∈ K, and fχ(s(In)) = 1. We will use the observation of [KP84]
Let S gen(eGn) denote the subspace of S(eGn) consisting of genuine functions. Given an open
subset K0 ⊂ K, one can lift any f ∈ S(K0) to f gen ∈ S gen(eGn) by putting
For example, for any subset X ⊂ Gn let chX be the characteristic function of X, then chgen
vanishes oﬀ eK and is 1 on κ(K).
The group eGn acts on the right on S gen(eGn). We have a surjection Pχ : S gen(eGn) → I(χ)
of eGn-representations
Pχ(f )(g) = ˆBn,∗

f gen(g) =(ǫf (k0)

g = ǫκ(k0), ǫ ∈ µ2, k0 ∈ K0,

Bn (b∗)χ−1(s(b∗)) dlb∗

g /∈ eK0.

f (s(b∗)g)δ1/2

K

(2.3)

(2.2)

0

= ˆTn,∗ ˆNn

f (s(tn)g)δ1/2

Bn (t)χ−1(s(t)) dn dt.

Here dlb∗ is the left Haar measure normalized by requiring vol(Bn,∗∩K) = 1, this is consistent
with the normalization in the non-metaplectic setting because Bn,∗ ∩ K = Bn ∩ K. Note
that s is a splitting of Bn,∗.

The unramiﬁed normalized function of I(χ) is then ϕK,χ = Pχ(chgen
For w ∈ W , let w ∈ W be a representative of w and deﬁne ϕw,χ = Pχ(chgen
the function supported on eBn,∗κ(wI) = eBn,∗s(w)κ(I), which is right-invariant by κ(I) and

ϕw,χ(s(w)) = 1. Then {ϕw,χ}w∈W is a basis of I(χ)I. In particular

IwI). This is

K ).

(2.4)

ϕK,χ =Xw

ϕw,χ.

Given that χ lies in a certain cone, the integral is absolutely convergent, otherwise it is
deﬁned by meromorphic continuation in χ (i.e., in the parameter s).

Henceforth assume χ is regular, i.e., wχ 6= χ for any e 6= w ∈ W . In this case (see [McN12,

Theorem 4])

dim Hom eGn

(I(χ), I(wχ)) = 1,

∀w ∈ W.

(2.5)

We introduce the intertwining operators.

subgroup of α. For any w ∈ W , let

If α ∈ ΣGn, let Nα < Gn denote the root

Tw = Tw,χ : I(χ) → I(wχ)

be the standard intertwining operator deﬁned by

Twfχ(g) = ˆNn(w)
where w ∈ W is the representative of w and
Nn(w) = Y{α>0:w−1α<0}

fχ(s(w−1v)g) dv,

Nα < Nn.

We recall the Gindikin-Karpelevich formula ([Cas80] Theorem 3.1), whose extension to

15

eGn was proved in [KP84]. For any root α, let Rα be the group generated by Nα and N−α
(Rα ∼= SL2), a′
and w ∈ W ,

α be the embedding of diag(̟2, ̟−2) in Rα and put aα = s(a′

α). Deﬁne for α

cα(χ) =

Then

1 − q−1χ(aα)
1 − χ(aα)

,

cw(χ) = Yα>0:wα<0

cα(χ).

TwϕK,χ = cw(χ)ϕK,wχ.

(2.6)

This implies the analog of [Cas95, Proposition 3.5]:
Claim 2.4. Tw(= Tw,χ) is an isomorphism if and only if cw−1(wχ)cw(χ) 6= 0. Furthermore,
I(χ) is irreducible if and only if Tw0 is an isomorphism.

Proof. The ﬁrst part follows exactly as in [Cas95]. For the second part one can verify that
the arguments in the case of Gn apply here as well (see [Cas95] Theorem 6.6.2). Brieﬂy, if
Tw0 is not an isomorphism, either I(χ) or I(w0χ) is reducible, but these representations have
the same irreducible constituents ([BZ77, Theorem 2.9]). Suppose Tw0 is an isomorphism
and π is a proper irreducible quotient of I(χ). Then π can be embedded in I(wχ) for some
w ∈ W ([BZ77, Theorem 2.9 and Theorem 2.4b]). This embedding is proportional to Tw by
(2.5), and it follows that Tw is not an isomorphism, thus cw(χ) or cw−1(wχ) vanish. But then
cw0(χ) or cw0(χ−1) is zero, contradiction.
(cid:3)

We mention that when ℓ(w) + ℓ(w′) = ℓ(ww′), Tw′,wχTw,χ = Tw′w,χ, and in general for any

w, w′ (see e.g., [CO13, (3.17)]),

Tw′,wχTw,χ =

cw′(wχ)cw(χ)

cw′w(χ)

Tw′w,χ.

(2.7)

In contrast with the non-metaplectic case, here I(χ)Nn is not linearly isomorphic with I(χ)I
(compare to [Cas80, Proposition 2.4]). Indeed, the dimension of the former is |W|·|Tn,∗\Tn|.
However, we can still deﬁne an analog of the Casselman basis.
For each w ∈ W let Υw be the functional on I(χ) given by

Υw(fχ) = Twfχ(s(In)).

Clearly

Υw(tfχ) = δ1/2
Bn

wχ(t)Υw(fχ),

For any genuine character ω of eTn,∗, let ρ(ω) = ind

the restriction of ω to C eTn
[BZ77, Theorem 5.2], and because χ is regular,

(ω). In fact ρ(ω) depends only on
. According to the Geometric Lemma of Bernstein and Zelevinsky

eTn
eTn,∗

∀fχ ∈ I(χ),

t ∈ C eTn

.

(2.8)

I(χ)Nn = Mw∈W

δ1/2
Bn ρ(wχ).

(2.9)

Since Υw factors through I(χ)Nn, we can consider it as a functional on this ﬁnite direct sum,
of ﬁnite-dimensional vector spaces. For any w′ 6= w, if fχ + I(χ)(Nn) belongs to the space of
ρ(w′χ),

Υw(tfχ) = Υw(δ1/2
Bn

w′

χ(t)fχ) = δ1/2
Bn

w′

χ(t)Υw′(fχ),

∀t ∈ C eTn

.

(2.10)

16

EYAL KAPLAN AND JAN M ¨OLLERS

Combining this with (2.8) implies that Υw vanishes onLw′6=w δ1/2

Claim 2.5. The functionals {Υw}w restricted to I(χ)I are linearly independent.
Proof. According to [CO13, Remark 1], if we put

Bn ρ(w′χ).

fw,χ = Tw−1w0ϕw0,(w−1w0)−1 χ ∈ I(χ)I,

Υw′(fw,χ) = δw′,w,

where δw′,w is the Kronecker delta.

(cid:3)

Let {fw,χ}w be the basis of I(χ)I dual to {Υw}w, given in the proof of Claim 2.5. By

deﬁnition

fw0,χ = ϕw0,χ,

as in the non-metaplectic setting ([Cas95, Proposition 3.7]) the computation there can also
be performed here, to obtain a direct proof).

Next we compute the image of fw,χ in I(χ)Nn and relate it to the direct sum of (2.9).

, the image of tfw,χ in I(χ)Nn is δ1/2
Bn

Claim 2.6. The image of fw,χ in I(χ)Nn belongs to the space of ρ(wχ). Consequently, for
any t ∈ C eTn

Proof. Looking at (2.9), we can write the image of fw,χ in I(χ)Nn in the form Pw∈W ξw,
6= w. We prove ξw′ = 0, by showing that any functional on ρ(w′χ)

wχ(t)fw,χ + I(χ)(Nn).

ξw ∈ ρ(wχ). Fix w′
vanishes on ξw′.

For a representative b of Tn,∗\Tn, consider the linear functional on I(χ) given by

Υw′,b(fχ) = Tw′fχ(s(b)).

It is deﬁned on I(χ)Nn and satisﬁes equalities similar to (2.8) and (2.10), i.e.,

Υw′,b(tfχ) = δ1/2
Bn
Υw′,b(tfχ) = δ1/2
Bn

w′

χ(t)Υw′,b(fχ),

w′′

χ(t)Υw′,b(fχ),

∀t ∈ C eTn
,
∀t ∈ C eTn

,

Hence Υw′,b vanishes on ρ(w′′χ) for any w′′ 6= w′.

The set {Υw′,b}b is linearly independent, since for b1 ∈ Tn,

fχ + I(χ)(Nn) ∈ ρ(w′′

χ).

Υw′,b(s(b1)fw′,χ) = Tw0ϕ

w0,(w′ −1w0)−1 χ

(s(b)s(b1)) =(δ1/2

Bn
0

w′χ(s(b)s(b1))

bb1 ∈ Tn,∗,
otherwise.

This is because for t ∈ Tn, if w0Nnt intersects the projection of the support of ϕw0,..., then
t ∈ Tn,∗ (use (2.1) and the fact that w0t ∈ Bn,∗N −

n implies t ∈ Tn,∗).
Thus {Υw′,b}b is a basis of the linear dual of ρ(w′χ) and moreover,

Υw′,b(ξw′) = Υw′,b(fw,χ).

Recall that we have to show ξw′ = 0, we prove Υw′,b(ξw′) = 0 for all b ∈ Tn. For b ∈ Tn,∗,
Υw′,b is a scalar multiple of Υw′, hence vanishes on fw,χ (by deﬁnition). It remains to show
Υw′,b(fw,χ) = 0 for all b /∈ Tn,∗. Using (2.7),

Υw′,b(fw,χ) =

Tw′w−1w0ϕw0,(w−1w0)−1 χ(s(b)) = 0,

cw′(w−1w0χ)cw−1w0(χ)

cw′w−1w0(χ)

since for any w ∈ W and v ∈ Nn, wvb ∈ Bn,∗w0I implies b ∈ Tn,∗ (use (2.1), ﬁrst deduce
w = w0).

(cid:3)

Remark 2.7. This claim will be used to prove Claim 2.8 below, which is the analog of
[Cas80, Proposition 3.9]. In [Cas80], the fact that the image of fw,χ in I(χ)Nn belongs to ρ(wχ)
followed directly from the deﬁnition of the basis {fw,χ}, because in the non-metaplectic setting
the spaces wρ(χ) are one-dimensional, then Υw′(fw,χ) = 0 immediately implies ξw′ = 0.

17

Claim 2.8. ([Cas80, Proposition 3.9]) For any w ∈ W and t ∈ C eTn ∩ eT −

wχ(t)fw,χ.

n ,

PI(tfw,χ) = δ1/2
Bn
Proof. By Claims 2.1 and 2.6, PI(tfw,χ) and δ1/2
Bn
Because fw,χ = PI(fw,χ), this implies
PI(tfw,χ − δ1/2

where we used Claim 2.2. The result follows.

Bn

wχ(t)fw,χ) ∈ I(χ)(Nn) ∩ I(χ)I = 0,

(cid:3)

wχ(t)fw,χ have the same image in I(χ)Nn.

For each w ∈ W , if w is the representative of w, put q(w) = [IwI : I]. E.g., q(sα) = q

for α ∈ ∆Gn. Then [K : I] =Pw∈W q(w) and since vol(K) = 1,

q(w))−1.

(2.11)

vol(I) = (Xw∈W

We have the following analog of [Cas95, Theorem 3.4]:

Claim 2.9. If α ∈ ∆Gn, w ∈ W and ℓ(sαw) > ℓ(w),

Tsαϕsαw,χ = ϕw,sα χ + (cα(χ) − q−1)ϕsαw,sα χ,
Tsαϕw,χ = (cα(χ) − 1)ϕw,sα χ + q−1ϕsαw,sα χ.

Proof. Let wα be the representative of sα. In the domain of absolute convergence

Tsαϕe,χ(s(wα)) = ˆNα

ϕe,χ(s(wα)−1s(v)s(wα)) dv.

The integrand vanishes unless v ∈ Nα(̟O) < K, then s(wα)−1s(v)s(wα) = κ(w−1
integral equals vol(̟O). Hence

α v) and the

Tsαϕe,χ(s(wα)) = q−1.

This is true for all χ by meromorphic continuation. A similar computation gives

Tsαϕsα,χ(s(In)) = ϕsα,χ(s(wα)−1) = 1.

Here we used the fact that s(wα)−1 = s(wα)s(t0) for some t0 ∈ Tn∩K. Exactly as in [Cas95],
the rank one case of (2.6) implies

cα(χ)ϕK,sα χ = Tsαϕe,χ + Tsαϕsα,χ

and we deduce

Tsαϕsα,χ(s(wα)) = cα(χ) − q−1,
Tsαϕe,χ(s(In)) = cα(χ) − 1.
If w′ ∈ W−{e, sα} and w′ is the representative of w′,

Tsαϕe,χ(s(w′)) = Tsαϕsα,χ(s(w′)) = 0,

18

EYAL KAPLAN AND JAN M ¨OLLERS

because w−1
with the previous equalities,

α Nαw′ does not intersect with the support of the integrands. Combining this

Tsαϕsα,χ = ϕe,sα χ + (cα(χ) − q−1)ϕsα,sα χ,
Tsαϕe,χ = (cα(χ) − 1)ϕe,sα χ + q−1ϕsα,sα χ.

Now the assertions of the claim follow because if w is the representative of w,
q(w)PI(s(w−1)ϕsα,χ) = ϕsαw,χ.

q(w)PI(s(w−1)ϕe,χ) = ϕw,χ,

To see these formulas one can compute the integrals directly at s(w) (resp. s(wαw)), then
verify that for w′ 6= w (resp. w′ 6= wαw), w′Iw−1 does not intersect Bn,∗I (resp. Bn,∗wαwI).

(cid:3)

Combining (2.4) with (2.6) and the deﬁnition of the Casselman basis implies

cw(χ)fw,χ.

ϕK,χ = Xw∈W
Bn(b)ˆK

The eGn-pairing on I(χ) × I(χ−1) is given by (see [CO13, (10.2)])

δ−1

fχ(s(b)κ(k))fχ−1(s(b)κ(k)) dk.

hfχ, fχ−1i = Xb∈Bn,∗\Bn

The following result was proved in [Cas80] in the course of computing Macdonald’s formula

(2.12)

(2.13)

([Cas80, § 4]).
Claim 2.10. For any w ∈ W ,

PK(fw,χ)(1) =

cw0(w0wχ)
Qcw(χ)

,

Proof. We prove the identity using the formula for the zonal spherical function. Put

Γχ(g) = hgϕK,χ, ϕK,χ−1i,

In the non-metaplectic setting a formula for Γχ(g) was proved by MacDonald [Mac95, Chap-
ter V, § 3], then generalized to reductive groups in [Cas80], as an application of the basis
{fw,χ}. In the metaplectic case the formula was computed in [CO13, § 10] and in particular

q(w)−1.

Q = Xw∈W
g ∈ eGn.

cw0(w0wχ)δ1/2
Bn

wχ(t).

(2.14)

On the other hand using (2.13) and the fact that ϕK,χ−1(s(b)) = 0 unless b ∈ Bn,∗ (see (2.2)),

ϕK,χ(s(b)κ(k)g)ϕK,χ−1(s(b)κ(k)) dk

for any t ∈ C eTn ∩ eT −

n ,

Γχ(t) = Q−1Xw∈W
Bn(b)ˆK

δ−1

Γχ(g) = Xb∈Bn,∗\Bn

= ˆK

ϕK,χ(κ(k)g) dk = PK(gϕK,χ)(1).

Putting (2.12) into this equality shows

Γχ(t) = Xw∈W

cw(χ)PK(tfw,χ)(1).

Since PK(tfw,χ)(1) = PK(PI(tfw,χ))(1), Claim 2.8 implies

Γχ(t) = Xw∈W

cw(χ)PK(fw,χ)(1)δ1/2
Bn

wχ(t).

19

Comparing this with (2.14) and since the characters χ are linearly independent as functions
(cid:3)

n , we obtain the result.

We described the tools of [Cas80] that we need and proceed to formulate an analog of

Hironaka’s theorem [Hir99, Proposition 1.9], for computing functionals on I(χ).

on t ∈ C eTn ∩ eT −

2.3. Metaplectic version of Hironaka’s theorem. Let I(χ)∗ denote the linear dual of
I(χ). For any w ∈ W , by deﬁnition

w−1,wχ−1 : I(χ−1)∗ → I(wχ−1)∗.
T ∗

Since I(χ) is the subspace of I(χ−1)∗ of smooth functionals and T ∗
ness,

w−1,wχ−1 preserves smooth-

w−1,wχ−1|I(χ) : I(χ) → I(wχ).
Claim 2.11. ([Hir99, Lemma 1.5, Proposition 1.6]) If cw(χ) 6= 0,

w−1,wχ−1 = T ∗
T ∨

T ∨
w−1,wχ−1 =

cw−1(wχ−1)

cw(χ)

Tw,χ.

If also cw−1(wχ−1) 6= 0, the map
Tw−1,wχ−1 =

cw(χ)

cw−1(wχ−1)

extends Tw,χ.

w−1,wχ−1 : I(χ−1)∗ → I(wχ−1)∗
T ∗

Proof. By (2.5) the mappings T ∨
tionality factor, exactly as in [Hir99] we compare
hTw,χ(ϕK,χ), ϕK,wχ−1i to hT ∨

w−1,wχ−1(ϕK,χ), ϕK,wχ−1i

w−1,wχ−1 and Tw,χ are proportional. To compute the propor-

using (2.6) and (2.13). The eGn-pairing given by (2.13) involves a ﬁnite summation, but by

(2.2) applied to ϕK,wχ−1, it reduces to one summand corresponding to the trivial coset. (cid:3)

As a corollary we obtain the following result, explaining the normalization factor used to

deﬁne Tw−1,wχ−1.
Corollary 2.12. ([Hir99, Proposition 1.7]) If cw(χ)cw−1(wχ−1) 6= 0, then for any compact
open K0 < K,

PK0 ◦ Tw−1,wχ−1 = Tw,χ ◦ PK0.

Proof. Since PK0 takes I(χ−1)∗ to (I(χ−1)∗)K0 ⊂ I(χ), both sides are mappings I(χ−1)∗ →
I(wχ). Consider the left-hand side. Since Tw−1,wχ−1 and PK0 commute, so do Tw−1,wχ−1 and
PK0, but on the image of PK0, according to Claim 2.11, Tw−1,wχ−1 extends Tw,χ.

(cid:3)

20

EYAL KAPLAN AND JAN M ¨OLLERS

Asssume we have a family {Λa,χ}a∈A of functionals Λa,χ ∈ I(χ−1)∗ indexed by a ﬁnite
set A, and such that for each a, Λa,χ is a meromorphic function in χ. We ﬁx an arbitrary
ordering on A. Furthermore, assume that for each w ∈ W there is an invertible matrix
A(w, χ) = (A(w, χ)a,a′) such that

(T ∗

w−1,wχ−1Λa,χ)a∈A = A(w, χ) (Λa,wχ)a∈A.

(2.15)

The entries of A(w, χ) are by deﬁnition meromorphic in χ.
Remark 2.13. In [Hir99] the matrix is deﬁned using Tw−1,wχ−1, we followed the convention
of [KP84, CO13].

For example, one can consider the family {Υw,b} of functionals introduced in the proof of
Claim 2.6, then A(w, χ) exists because these form a basis of (I(χ)Nn)∗. Another example is the
Whittaker functionals, then A can be a set of representatives of Tn,∗\Tn (see [KP84, CO13]).
(I(χ−1)∗)I ⊂ I(χ)I, there is a function λa,χ,g ∈ I(χ)I satisfying
∀f ′

We are interested in obtaining a formula for Λa,χ(gϕK,χ−1), where g ∈ eGn. Since PI(g−1Λa,χ) ∈

χ−1 ∈ I(χ−1).

(2.16)

PI(g−1Λa,χ)(f ′

χ−1) = hλa,χ,g, f ′

χ−1i,

In other words λa,χ,g is the image of PI(g−1Λa,χ) in I(χ).

Claim 2.14. Λa,χ(gϕK,χ−1) = PK(λa,χ,g)(1).

Proof. Equality (2.16) together with (2.13) and (2.2) imply

PI(g−1Λa,χ)(ϕK,χ−1) = PK(λa,χ,g)(1).

Then since

the result holds.

Λa,χ(gϕK,χ−1) = g−1Λa,χ(ϕK,χ−1) = PI(g−1Λa,χ)(ϕK,χ−1),

(cid:3)

Here is the analog of [Hir99, Proposition 1.9].

Lemma 2.15.

(Λa,χ(gϕK,χ−1))a∈A = Xw∈W

cw0(w0wχ)

Qcw−1(wχ−1)

A(w, χ)(λa,wχ,g(1))a∈A.

Proof. The formal steps in [Hir99] can be carried out immediately, because we established the
machinery used in loc. cit. for the metaplectic setting. We repeat the steps, for readability.
For the proof we may assume cw(χ)cw−1(wχ−1) 6= 0. Since λa,χ,g ∈ I(χ)I, we can write

da,χ(g)fw,χ,

(2.17)

λa,χ,g = Xw∈W

for some complex coeﬃcients da,χ(g). The coeﬃcients can be computed by applying Υw,χ,

By the deﬁnition of λa,χ,g and using Corollary 2.12,

da,χ(g) = Tw,χλa,χ,g(1).

Then Claim 2.11 implies

Tw,χλa,χ,g = Tw,χPI(g−1Λa,χ) = PI(Tw−1,wχ−1g−1Λa,χ).

da,χ(g) = PI(Tw−1,wχ−1g−1Λa,χ)(1) =

cw(χ)

cw−1(wχ−1)

PI(g−1T ∗

w−1,wχ−1Λa,χ)(1).

By Claim 2.14, to compute Λa,χ(gϕK,χ−1) we apply PK to (2.17) and evaluate at 1. Claim 2.10
gives the values of PK(fw,χ)(1). We obtain

Λa,χ(gϕK,χ−1) = Xw∈W

Now since

PK(fw,χ)(1)da,χ(g) = Xw∈W

cw0(w0wχ)

Qcw−1(wχ−1)

PI(g−1T ∗

w−1,wχ−1Λa,χ)(1).

21

PI(g−1T ∗

w−1,wχ−1Λa,χ) = T ∗

w−1,wχ−1PI(g−1Λa,χ),

(2.15) implies

as claimed.

(Λa,χ(gϕK,χ−1))a∈A = Xw∈W

cw0(w0wχ)

Qcw−1(wχ−1)

A(w, χ)(λa,wχ,g(1))a∈A,

(cid:3)

As observed in [Sak06], the value of λa,χ,g(1) corresponds to the evaluation of the functional

at gϕe,χ−1. Namely,
Claim 2.16. λa,χ,g(1) = vol(I)−1Λa,χ(gϕe,χ−1).
Proof. We show

Then the result follows from (2.16) because

λa,χ,g(1) = vol(I)−1hλa,χ,g, ϕe,χ−1i.

PI(g−1Λa,χ)(ϕe,χ−1) = Λa,χ(gϕe,χ−1).

For b ∈ Bn and k ∈ K, if s(b)κ(k) belongs to the support of ϕe,χ−1, then b ∈ Bn,∗ and
k ∈ I. This is because when tTn,∗ 6= t′Tn,∗, the sets tBn,∗K and t′Bn,∗K are disjoint and
K ∩ Bn,∗I = I (use (2.1)). Hence looking at (2.13) we obtain

hλa,χ,g, ϕe,χ−1i = ˆI

λa,χ,g(κ(k)) dk = vol(I)λa,χ,g(1),

(cid:3)

as required.

Corollary 2.17.

(Λa,χ(gϕK,χ−1))a∈A =

1

Qvol(I) Xw∈W

cw0(w0wχ)
cw−1(wχ−1)

A(w, χ)(Λa,wχ(gϕe,χ−1))a∈A.

As mentioned in the introduction, the proofs in § 2.2-2.3 apply to a more general setting
of covering groups. The preliminary results we used are essentially the Gindikin-Karpelevich
formula (2.6), the description of Casselman’s basis using intertwining operators (in the proof
of Claim 2.5) and a formula for the zonal spherical function (used for the proof Claim 2.10).
These results were established in [CO13] for r-fold covers of Gn, hence our results apply to
these groups as well.

McNamara has generalized substantially several results of [CO13], to any central exten-
sion of G by a ﬁnite cyclic group, where G is an unramiﬁed reductive group over a p-adic
ﬁeld. See [McN11, Theorem 6.4] regarding the Gindikin-Karpelevich formula and [McN14,
Proposition 5.2] (Casselman’s basis). As mentioned in [McN14], the zonal spherical formula
can also be proved using his tools. To be cautious, we refrain from stating our results in this
generality.

The normalizer of Uk and stabilizer of ψ is

ψ((cid:0) Ik u
G△
k = {c△ : c ∈ Gk},

Ik(cid:1)) = ψ(tr(u)).

c△ = diag(c, c).

22

EYAL KAPLAN AND JAN M ¨OLLERS

3. The metaplectic Shalika model

3.1. Deﬁnition. Let F be a local ﬁeld and ψ be a nontrivial additive character of F . First
we recall the notion of the Shalika model, introduced by Jacquet and Shalika [JS90].

Put n = 2k. Consider the unipotent radical Uk of the parabolic subgroup Qk < Gn, and

the (Shalika) character ψ of Uk given by

The group G△
⋉ Uk is called the Shalika group. Let π ∈ Alg Gn. A ψ-Shalika functional
k
on the space of π is a functional l such that for any vector ξ in the space of π, c ∈ Gk and
u ∈ U,

l(π(c△u)ξ) = ψ(u)l(ξ).

Here on the left-hand side u =(cid:0) Ik u

continuous.

Ik(cid:1). If the ﬁeld is Archimedean we also demand that l is

Jacquet and Rallis [JR96] proved that over a non-Archimedean ﬁeld, when π is irreducible,
the space of such functionals is at most one-dimensional. First they proved that (Gn, Mk) is
a Gelfand pair, then they used analytic techniques similar to [FJ93] to show that a Shalika
functional induces an Mk-invariant functional. Their result was extended to Archimedean
ﬁelds in [AGJ09].

We mention that Ash and Ginzburg [AG94] already proved uniqueness results for a certain
class of irreducible unramiﬁed representations, we will adapt their proof to the metaplectic
case (see Theorem 3.10 below).

Granted that l exists, one may deﬁne the Shalika model S (π, ψ) of π as the space of

functions Sξ(g) = l(π(g)ξ), as ξ varies in the space of π.

We explain the metaplectic analog (following [Kap15a]). According to (1.1), restriction
k is a “simple cover” in the sense that σ(c△, c′△) = (det c, det c′)2.

of the cover of Gn to G△
Hence

s((cc′)△) = σ(c△, c′△)s(c△)s(c′△) = (det c, det c′)2s(c△)s(c′△).

(3.1)

takes the form π ⊗ γψ′, where π is a representation of Gk and

Then if ψ′ is another nontrivial additive character of F , any genuine representation of eG△
For a genuine π ∈ Alg eGn, we call l a metaplectic (ψ′, ψ)-Shalika functional on π if

π ⊗ γψ′(ǫs(c△)) = ǫγψ′(det c)π(c),

l(π(s(c△u))ξ) = γψ′(det c)ψ(u)l(ξ).

ǫ ∈ µ2.

(3.2)

k

The terminology is reasonable because γψ′ corresponds to the trivial character of Gk. If π is
irreducible, we denote the corresponding metaplectic Shalika model by S (π, ψ′, ψ). It is a
subrepresentation of Ind

(γψ′ ⊗ ψ), where γψ′ ⊗ ψ(ǫs(c△u)) = ǫγψ′(det c)ψ(u).

eGn
eG△

k Uk

Remark 3.1. Since det c△ ∈ F ∗2, we also have σ(1)(c△, c′△) = (det c, det c′)2 and (3.1) also
holds for the section corresponding to σ(1). (The cocycle σ(1) was deﬁned in § 1.2, as we
mentioned there our work applies to both covers.)

We have the following bound for Shalika functions.

23

Claim 3.2. Assume that π ∈ Alg eGn is genuine irreducible and admits a metaplectic Shalika

model. Then there exists α > 0 such that for any ξ in the space of π, there exists a positive
φ ∈ S(Fk×k) such that

|Sξ(s(diag(g, Ik)))| ≤ | det g|−αφ(g),

∀g ∈ Gk.

k instead of Tk, the group T 2

This implies that for dg = s(diag(g, Ik)) we have

Proof. Over a p-adic ﬁeld, the proof is a simple adaptation of Lemma 6.1 of Jacquet and
Rallis [JR96] for the non-metaplectic setting. The main diﬀerence is that the asymptotic
expansion is written for T 2
k is abelian and splits under the cover.
If F is Archimedean, by the Dixmier–Malliavin Lemma applied to the representation π|Uk

there exist ξj in the representation space of π and φj ∈ S(Uk) such that ξ = Pj θ(φj)ξj.
Sξ(dg) =Xj
φj(u)ψ(gu) du =Xj bφj(g)Sξj (dg).

φj(u)Sξj (dgs(u)) du =Xj

It remains to show that each term Sξj (dg) is bounded by a constant times | det g|−α for
some α independent of ξj. This follows from [AGJ09, Lemma 3.2], which also holds in the
metaplectic setting since the proof merely uses the Lie algebra action.
(cid:3)

Sξj (dg)ˆUk

ˆUk

The next claim is a simple analog of the relation between Whittaker and Kirillov models

(see [GK75, Proposition 2]).

Claim 3.3. Assume F is non-Archimedean. Let π be a genuine irreducible subrepresentation
of Ind

(γψ′⊗ψ). The restriction of functions in the space of π to eQn contains any element

eGn
eG△
eQn
eG△

of ind

k Uk

(γψ′ ⊗ ψ).

k Uk

Proof. For any ξ in the space of π and φ ∈ S(Uk), the function φ(ξ) deﬁned by

belongs to the space of π.

that the group of characters of Uk is isomorphic to the direct product of k2 copies of F . We

Given dg = s(diag(g, Ik)) ∈ eQn, one can ﬁnd ξ such that ξ(dg) 6= 0 and we also have
φ(ξ)(dg) = bφ(g)ξ(dg), where bφ denotes the Fourier transform of φ with respect to ψ. Note
can select φ such that the support of bφ is contained in gV, where V < Gk is a small compact

open neighborhood of the identity. Then φ(ξ)| eQn
space is spanned by these functions, as g and V vary.
3.2. Asymptotic expansion of metaplectic Shalika functions. As with Whittaker
functions, one can write an asymptotic expansion for Shalika functions, as functions on
the torus. Over p-adic ﬁelds, such an expansion was obtained by Jacquet and Rallis [JR96,
§ 6.2] and their result can be easily extended to the metaplectic setting. Over Archimedean
ﬁelds, as a rule, the problem is more diﬃcult, because one has to deal with delicate continu-
ity properties. Here we provide an asymptotic expansion for metaplectic Shalika functions
over F = R or C. In particular, the same result holds in the non-metaplectic setting for the
Shalika functional.

(γψ′ ⊗ ψ). The latter

belongs to ind

eQn
eG△

k Uk

(cid:3)

φ(ξ)(x) = ˆUk

φ(u)ξ(xs(u))du,

x ∈ eGn,

24

EYAL KAPLAN AND JAN M ¨OLLERS

Remark 3.4. The results of this section will be used in § 5 to prove the meromorphic
continuation of the local integrals (see the proof of Theorem 5.3).

Let n = 2k. We use the notation and deﬁnitions of § 1.5, e.g., Aℓ, ax, E1(Qℓ, π) and Λπ,ℓ,

Gn rather than Gk by embedding Gk into Gn via g 7→ diag(g, Ik).

where now π ∈ Alg eGn is a genuine representation. Note that ax is viewed as an element in
Theorem 3.5. Let π ∈ Alg eGn be a genuine irreducible representation on a space V , that
admits a metaplectic Shalika functional l. Then for all D = (D1, . . . , Dk) ∈ Rk there exist
ﬁnite subsets Cℓ ⊂ E(ℓ)(π) and functions pI,z : Rk × V → C for I ⊂ {1, . . . , k}, z ∈Qℓ∈I Cℓ,
such that the following holds.
(1) For all ξ ∈ V and x ∈ Rk,

l(π(s(ax))ξ) =XI,z

pI,z(x; ξ) · e−z·xI ,

where the (ﬁnite) summation is over all I ⊂ {1, . . . , k} and z ∈Qℓ∈I Cℓ.

(2) Each function pI,z(x; ξ) is polynomial in xI:

(3.3)

(3.4)

pI,z(x; ξ) = Xα∈NI

cα(xI; ξ)xα
I ,

where the coeﬃcients cα(xI; ξ) are smooth in xI, linear in ξ, and satisfy bounds of
the form

|cα(xI; ξ)| ≤ q(ξ)(1 + |xI|)de−DI ·xI ,

with d ≥ 0 and a continuous seminorm q on V .

∀xI ∈ RI

>0, ξ ∈ V,

(3.5)

Proof. The proof is similar to the proof of Theorem 1.1, we explain the necessary modiﬁca-
tions. The main diﬀerence is, of course, that l is not a smooth functional.

In contrast to the situation in Theorem 1.1 we cannot replace l by π∨(X)l for X ∈ U(gn)
since in general π∨(X)l is not a metaplectic Shalika functional. This replacing was used
in Theorem 1.1 for elements X ∈ uℓ, 1 ≤ ℓ ≤ k (in Theorem 1.1 everything depended
continuously on the funtional). However, each X ∈ uℓ can be written as X = X1 + X2 with
X1 ∈ uk and X2 = diag(Y, 0) for some Y ∈ gk (here 0 denotes the k × k zero matrix). By
(3.2) we obtain

l(π(X)π(s(ax))ξ) = l(π(X1)π(s(ax))ξ) + l(π(diag(Y, 0))π(s(ax))ξ)
= ψ(X1)l(π(s(ax))ξ) − l(π(diag(0, Y ))π(s(ax))ξ)
= ψ(X1)l(π(s(ax))ξ) − l(π(s(ax))π(diag(0, Y ))ξ).

In the second term we can replace π(diag(0, Y ))ξ by ξ since the map ξ 7→ π(diag(0, Y ))ξ is
continuous and all data in the statement depends continuously on ξ. This shows that the
recursive argument in the proof of Theorem 1.1 extends to our setting.

It remains to show that an estimate of the form (1.4) also holds for l. More precisely, we

show that there exists a continuous seminorm q on V and d ≥ 0 such that
>0, ξ ∈ V.

|l(π(s(ax))ξ)| ≤ q(ξ)(1 + |x|)de−Λπ·x,

∀x ∈ Rk

First, l is a continuous linear functional on V , so there exists a continuous seminorm q1 on
V such that

(3.6)

|l(ξ)| ≤ q1(ξ),

∀ξ ∈ V.

Since π is of moderate growth there exists N ≥ 0 and a continuous seminorm q2 on V such
that

25

q1(π(g)ξ) ≤ q2(ξ)kgkN,

∀g ∈ eGn, ξ ∈ V,

khk =

where k · k is the pullback to eGn of the usual norm function on Gn, i.e.,
For x ∈ Rk

nXi,j=1
(|hi,j|2 + |(h−1)i,j|2),
kaxkN ≤ CeD·x,

∀x ∈ Rk
>0,
for some C > 0 and D = (D1, . . . , Dk) ∈ Rk. For q = Cq2,

>0 we clearly have

h ∈ Gn.

|l(π(s(ax))ξ)| ≤ q(ξ)eD·x,

∀x ∈ Rk

>0, ξ ∈ V.

(cid:3)

We now argue as in [Wal88, Section 4.3.5]. More precisely, applying the recursive argument
in the proof of Theorem 1.1 shows that after possibly multiplying with a power of (1 + |x|),
we can replace D by D − eℓ for any 1 ≤ ℓ ≤ k as long as Dℓ − 1 ≥ −Λπ,ℓ. Repeating this
shows that D can actually be replaced by −Λπ after multiplying with a certain power of
(1 + |x|), and hence we obtain (3.6).
Remark 3.6. As stated, the estimates for l(π(s(ax))ξ) in Theorems 1.1 and 3.5 only hold
for x ∈ Rk
>0. However, one can also expand l(π(s(ax))ξ) for x1, . . . , xk−1 ≥ 0 and xk ≤ 0
into an exponential power series, and the remainder terms are at least bounded by e−N xk
for some N ≥ 0. To see this, ﬁrst note that l(π(s(ax))ξ) = l(π(s(ax′))π(s(e−xkHk ))ξ) where
x′ = (x1, . . . , xk−1, 0). Then apply the expansion with ξ replaced by π(s(e−xkHk))ξ, and use
the fact that for each seminorm q there exists another seminorm q′ and N ≥ 0 such that
q(π(s(e−xkHk))ξ) ≤ q′(ξ)e−N xk for all xk ≤ 0 (see the proof of Theorem 3.5).
3.3. The unramiﬁed metaplectic Shalika function. In this section we develop an ex-
plicit formula for the unramiﬁed metaplectic Shalika function. Our arguments closely follow
those of Sakellaridis [Sak06], who established this formula in the non-metaplectic setting.
We use the deﬁnitions and results of § 2, in particular |2| = 1 and we have the canonical
splitting κ of K as in § 2.1.
Assume n = 2k. Let I(χ) be a genuine unramiﬁed principal series representation, χ = χs
(since n is even, γ can be ignored). Let ψ and ψ′ be a pair of nontrivial additive characters
of F , and assume they are both unramiﬁed, i.e., their conductor is O. Assuming that s is in
a “suitable general position”, we construct a metaplectic (ψ′, ψ)-Shalika functional (see § 3.1
for the deﬁnition) on I(χ), and provide an explicit formula for the value of such a functional
on the normalized unramiﬁed element of I(χ).

Identify ∆Gn with the pairs (i, i + 1), 1 ≤ i < n, and put αi = (i, i + 1), then ΣGn consists
of the pairs (i, j) with 1 ≤ i 6= j ≤ n. We will need a few simple auxiliary results for
computing conjugations.
Claim 3.7. Let w ∈ W and t ∈ Tn. Assume that w is the representative of w ∈ W . Then
s(w)s(t) = σ(w, t)s(wt), where

σ(w, t) =

Y{(i,j)=α>0:wα<0}

(−tj, ti).

26

EYAL KAPLAN AND JAN M ¨OLLERS

Proof. Since s(w)s(t)s(wt)−1 = σ(w, t),

s(w)s(t)s(w)−1 = σ(w, t)s(wt)s(w)−1 = σ(w, t)s(wtw)s(w)−1 = σ(w, t)s(wt).

For the last equality we used the fact that σ(t′, w) = 1 for any t′ ∈ Tn ([BLS99, § 3,
Theorem 7]). The value of σ(w, t) was given in [BLS99, § 3, Lemma 3].

(cid:3)

For any t, t′ ∈ Tn, according to the computation of σ(t, t′) in [BLS99, § 3, Lemma 1],

[s(t), s(t′)] = s(t)s(t′)s(t)−1s(t′)−1 =Yi<j

(ti, t′

j)2(t′

i, tj)2.

(3.7)

Remark 3.8. Let w be a permutation matrix. One can ﬁnd unique w ∈ W and t0 ∈ Tn
such that w = t0w, where the diagonal coordinates of t0 are ±1. Then for any t ∈ Tn,
s(w)s(t) = s(t0)(s(w)s(t)), which can be computed using Claim 3.7 and (3.7).

Corollary 3.9. Let w be a permutation matrix and write w = t0w as in Remark 3.8. For
any t ∈ Tn,∗, s(w)s(t) = s(w)s(t). If s(t) ∈ C eTn

, s(w)s(t) = s(wt).

The following theorem shows that when the inducing data is in a certain general position,
which does not preclude reducibility, the space of metaplectic Shalika functionals is at most
one-dimensional. Ash and Ginzburg [AG94, Lemma 1.7] proved this for Gn. Our proof
follows theirs, with certain modiﬁcations.

For 1 ≤ i < j ≤ n and x ∈ F ∗, let ti,j(x) = s(diag(Ii−1, x2, Ij−i−1, x2, In−j)) ∈ C eTn

.

Theorem 3.10. Assume that χ satisﬁes the following conditions.
(1) χ(ti,j) 6= 1 for all 1 ≤ i < j ≤ k.
(2) There exists a permutation τ on {1, . . . , k} such that χ(ti,k+j) 6= 1 for all 1 ≤ i, j ≤ k

such that j 6= τ (i).

The space of metaplectic Shalika functionals on I(χ) is at most one-dimensional. Further-
more, it is zero dimensional unless χ(ti,k+τ (i)) = 1 for all 1 ≤ i ≤ k.
Proof. For the ﬁrst assertion we have to show

dim Hom eGn

For g ∈ G△

k Uk\Gn/Bn,∗, denote

(I(χ), Ind

eGn
eG△

k Uk

(γψ′ ⊗ ψ)) ≤ 1.

(3.8)

k Uk)g−1 = g−1(G△

H(g) = Hom( eG△

k Uk)s(g)−1 (s(g)(γ−1

ψ′ ⊗ ψ−1) ⊗ χ, δ),
k Uk)∩eBn,∗; for a representation π of eG△

k Uk)s(g)−1 = s(g)−1(eG△

k Uk)s(g)−1 on the space of π given by s(g)π(x) = π(s(g)x); δ(x) = δ−1/2

is a representation of (G△
sentation of the cover, where δg is the modulus character of (G△

where (eG△
k Uk, s(g)π is the repre-
sentation of (eG△
(x)δg(x)
k Uk) ∩ Bn,∗ on C, lifted to a nongenuine repre-
k Uk)g−1. We recall that χ
is a genuine character of eTn,∗ which is trivial on eTn ∩ κ(K) (see the discussion following
By [AG94] (proof of Proposition 1.3) Gn =Sw G△
0 = (δi,τ (j))1≤i,j≤k, ω−1 =(cid:16) ω−1

k UkwBn where w varies over the permu-
tation matrices. Hence we may assume g = wt for a permutation matrix w and t ∈ Tn. Set
ω−1

ψ′ ⊗ ψ−1) ⊗ χ acts trivially on µ2.

Remark 2.3). Also s(g)(γ−1

0

Ik

(cid:17).

Bn

By deﬁnition dimH(g) ≤ 1 for any g. According to the Bruhat Theory (see e.g., [Sil79,

Theorems 1.9.4 and 1.9.5]), to prove (3.8) it is enough to show
k UkwBn 6= G△
k Ukω−1tBn,∗ 6= G△

H(g) = 0,
H(ω−1t) = 0,

∀g = wt such that G△

∀t such that G△

k Ukω−1Bn,
k Ukω−1Bn,∗.

27

(3.9)

(3.10)

Claim 3.11. Equality (3.9) holds.

Remark 3.12. In [AG94] this claim already completed the proof of uniqueness, because in
Gn one could a priori take g = w.

Before proving the claim, let us complete the proof of the theorem. We establish (3.10).
Put g = ω−1t. The condition on t implies that we can assume t = diag(t1, . . . , tk, Ik) and
for some 1 ≤ i ≤ k, ti /∈ F ∗2O∗. Let i be minimal with this property. Note that for any
y ∈ F ∗−F ∗2O∗, there is x ∈ O∗ such that (y, x)2 6= 1. Then by (3.7) there is x ∈ O∗ such
that for d = diag(Ii−1, x, , Ik−i)△,
s(t)−1

s(ωd) = (ti, x)2s(ωd) = −s(ωd).

Then we obtain

s(g)−1

s(d) = s(t)−1

(s(ω)s(d)) = s(t)−1

(s(ωd)) = −s(ωd).

Here for the second equality we used Corollary 3.9 and Claim 3.7. Clearly s(g)−1
s(d) ∈
(eG△
k Uk)s(g)−1 and we see that (γψ′⊗ψ)(s(d)) = 1 (because γψ′ is trivial on O∗) and χ(s(g)−1
−χ(s(ωd)) = −1, because χ is trivial on s(Tn ∩ K). But δBn and δg are modulus characters
and as such, are trivial on g−1d. Thus H(ω−1t) = 0.
Therefore the space of metaplectic Shalika functionals on I(χ) is at most one-dimensional.
For the second assertion of the theorem consider H(ω−1). In this case
ι(Nα),

(G△

k Uk)ω = ι((Tk ∩ K)T 2

s(d)) =

k ) ⋉ Y{α∈Σ+

Gk

:τ −1α>0}

where Nα on the right-hand side is a subgroup of Gk and for any c ∈ Gk, ι(c) = diag(c, w0c).
For d = x△ with x ∈ Tk such that its coordinates lie in F ∗2O∗, (γψ′ ⊗ ψ)(s(d)) = 1. Also s
is a homomorphism of ι((Tk ∩ K)T 2

k ). Hence

H(ω−1) = Homs(ι((Tk∩K)T 2

k ))(χ, δ−1/2

Bn δω−1).

For all 1 ≤ i ≤ k, ti,k+τ (i) ∈ s(ι((Tk ∩ K)T 2
k )) and a direct computation of δω−1, exactly as
in the proof of Claim 3.11 below (only roots of the form (l, i) with 1 ≤ l < i, and (i, l) with
i < l ≤ k, may contribute), shows
δω−1(ti,k+τ (i)) = |x|2(−|{1≤l<i:τ (l)<τ (i)}|+k−τ (i)−|{1≤l<i:τ (l)>τ (i)}|) = |x|2(k−τ (i)−i+1) = δ1/2
Hence there is no metaplectic Shalika functional on I(χ), unless χ(ti,k+τ (i)) = 1.

Bn (ti,k+τ (i)).
(cid:3)

Proof of Claim 3.11. As mentioned above, the arguments are similar to [AG94, Lemma 1.7].
One diﬀerence is that we consider a general τ , whereas in [AG94] the permutation was taken
(for simplicity) to be the identity. This is only a minor complication.

Let g = wt be as prescribed and write w = (δi,ji)1≤i,j≤n. For each 1 ≤ l ≤ k, if jl < jk+l,
then for U = N(l,k+l) (the root subgroup of (l, k + l)), w−1U = Njl,jk+l < Bn,∗ and ψ|U 6= 1,
and since δ|U = 1, H(g) = 0. Hence jk+l < jl for all 1 ≤ l ≤ k.

28

EYAL KAPLAN AND JAN M ¨OLLERS

We may assume jτ (1) < . . . < jτ (k). Suppose jτ (1) ≤ k and put m = τ (1). For x ∈ F ∗ set

Then s(g)−1

s(d) ∈ (eG△

d = diag(Im−1, x2, Ik−m)△ ∈ G△

k ∩ Bn,∗.
, by Corollary 3.9

k Uk)s(g)−1. Since s(d) ∈ C eTn

s(g)−1

s(d) = s(w)−1

s(d) = s(w−1

d) = tjk+m,jm.

s(d)) = χ(tjk+m,jm) 6= 1 by assumption (1)

To compute δ(g−1d), we count the roots from U and G△

On the one hand (γψ′ ⊗ ψ)(s(d)) = 1 and χ(s(g)−1
(because jk+m < jm ≤ k). On the other hand, we show δ(g−1d) = 1.
k that are conjugated by w to
Nn.
In the conjugation row l moves into row jl and similarly for the columns. For the
computation we only care about rows and columns m and k + m. Our assumption on τ
implies {l : jl < jm} ⊂ {l : l > k}.
First consider roots from U. Precisely jm − 1 roots from row m are conjugated to columns
smaller than jm. The other k − jm + 1 roots are conjugated to columns bigger than jm, so
they do not contribute. Row m + k and column m do not contain any root of U, so do not
contribute. Regarding column m + k, since jm+k < jm, the last jm+k − 1 rows from column
m + k are conjugated into the ﬁrst jm+k − 1 rows of column jm+k, and these do not contain
roots. Summarizing, the roots from U contribute |x|2(k−jm+1).
k . In general, a root (i, j) with 1 ≤ i 6= j ≤ k contributes only if both the
(i, j)-th and (i+k, j +k)-th coordinates are conjugated into Nn. The roots from row m (k−1
roots) are conjugated to columns greater than jm. The last jm− 1 columns are conjugated to
the ﬁrst jm−1 columns, so only k−1−(jm−1) roots from row m contribute. Regarding row
m + k, the ﬁrst k − jm roots were already accounted for. But jm − jm+k roots from the last
jm columns are conjugated into columns jm+k + 1, . . . , jm, and also contribute because their
copies from row k were conjugated into positive roots. The rows conjugated into the ﬁrst
jm − 1 rows are from the last k rows. Therefore, roots from column m are not conjugated
into positive roots in column jm. Hence their copies in column m + k cannot contribute as
well. Altogether the roots from G△

k contribute |x|2(k−jm)+2(jm−jm+k) = |x|2(k−jm+k).

Next consider G△

w′

In total, δ(g−1d) = |x|2n−2(jm+jk+m−1) = δ1/2
It follows that H(g) = 0, unless jτ (l) > k for all 1 ≤ l ≤ k. In the latter case we can assume
w =(cid:0)

(cid:1) (so, the assumption jτ (1) < . . . < jτ (k) is no longer valid). Let 1 ≤ i1, . . . , ik ≤ k

be such that τ (il) = l for all 1 ≤ l ≤ k. We prove by induction on l, that jil = k + l.

Bn (g−1d), hence δ(g−1d) = 1.

d = diag(Ii−1, x2, Ik−1, x2, Ik−i) ∈ G△

Suppose otherwise ji = k + 1 with i 6= i1. Proceeding as above take
k ∩ Bn,∗,

(3.11)
s(d) = s(w−1d) = ti,k+1. We see that (γψ′ ⊗ ψ)(s(d)) = 1, χ(s(w−1d)) 6= 1 by
then s(g)−1
assumption (2) (because τ (i) 6= τ (i1) = 1), while δ(g−1d) = 1. In fact, we compute δ as
above. Here only roots from G△
k may contribute. On row i, the ﬁrst i − 1 roots do not
contribute, because their copies are mapped into negative roots. On column i, the positive
roots do not contribute because they are mapped into rows greater than k + 1 of column
k + 1. This leaves the last k − i roots of row i, which are mapped into row k + 1 and
columns greaater than k + 1, and their copies are mapped into positive roots. Altogether
δg(g−1d) = |x|2(k−i) = δ1/2
Then i 6= il′ for 1 ≤ l′ ≤ l. We take d as in (3.11). Then s(g)−1

Assuming for all 1 ≤ l′ < l, jil′ = k + l′, we show jil = k + l. Suppose ji = k + l for i 6= il.
s(d) = ti,k+l, χ(s(w−1d)) 6= 1

Bn (g−1d). Thus H(g) = 0, unless ji1 = k + 1.

Ik

29

and we have to show δ(g−1d) = 1. Indeed, as in the case l = 1, we need only consider the
positive roots from G△
k , on the i-th row and column. Their copies are conjugated to positive
roots. According to the induction hypothesis, for each 1 ≤ l′ < l, the (il′, i)-th (resp. (i, il′)-
th) entry is conjugated into a positive root if and only if il′ < i (resp. il′ > i). This implies
that the contribution consists of |{1 ≤ l′ < l : il′ < i}| roots from column i (contributing
negative powers of |x|) and k − i − |{1 ≤ l′ < l : il′ > i}| from row i (contributing positive
powers). Thus δg(g−1d) = |x|2(k−i−l+1) = δ1/2
Bn (g−1d) and H(g) = 0, unless jil = k + l. The
proof is complete, since jl = k + τ (l) for all 1 ≤ l ≤ k, i.e., w′ = ω−1
Remark 3.13. Recall that χ = χs, s ∈ Cn (see § 2.2). Assume q2si
6= q±2sj for all 1 ≤
i < j ≤ k and q2si = q−2sk+i for all 1 ≤ i ≤ k, perhaps after a reordering of (sk+1, . . . , sn).
By Theorem 3.10, I(χ) and I(χ−1) admit at most one metaplectic Shalika functional (up to
scalar multiplication).

0 and w = ω−1.

(cid:3)

Remark 3.14. If I(χ) is irreducible, then we may have simply ﬁxed one permutation τ in
the statement of the theorem. However, we will also apply the theorem to reducible represen-
tations.

We deﬁne a functional satisfying the prescribed equivariance properties (3.2). It will be
deﬁned using an integral, which is absolutely convergent in a certain cone in χ. Then we
extend it to a meromorphic function, thereby obtaining a functional for all χ.

Following Sakellaridis [Sak06], we realize the metaplectic Shalika functional using a similar
functional on a group H, which is a twist of the Shalika group. Working with H instead
of the Shalika group was advantageous in [Sak06] for computational reasons. Let Jk be the
permutation matrix

1

0

. . .

Jk =
 ∈ Gk.
k Uk) =(cid:26)(cid:18) c
Jkcu JkcJk (cid:19) : c ∈ Gk(cid:27) ,

1

0

0

Put

H = ω(G△

ω =(cid:18)

Jk

Ik

(cid:19) .

We form a section h of H by

h(h) = s(ω)s(ω−1

h)s(ω)−1.

For h ∈ H, write ω−1h = c△
h uh with ch ∈ Gk and uh ∈ Uk. The mapping h 7→ ch is a group
epimorphism, the mapping h 7→ uh is onto U, and h 7→ ψ(uh) is a character of H (trivial on
ωG△

k ). According to (3.1), the section h satisﬁes

h(hh′) = (det ch, det ch′)2h(h)h(h′).

(3.12)

A functional l on a genuine π ∈ Alg eGn is called a (metaplectic) (H, ψ′, ψ)-functional if for

any ξ in the space of π and h ∈ H,

l(π(h(h))ξ) = γψ′(det ch)ψ(uh)l(ξ).

(3.13)

The deﬁnitions of H and h imply the following relation between these functionals and meta-
plectic Shalika functionals.

30

EYAL KAPLAN AND JAN M ¨OLLERS

Claim 3.15. Let π ∈ AlgeGn be genuine. The dimension of the space of (H, ψ′, ψ)-functionals

on π is equal to the dimension of metaplectic (ψ′, ψ)-Shalika functionals.
Proof. If l is an (H, ψ′, ψ)-functional on π, ξ 7→ l(π(s(ω))ξ) is a (ψ′, ψ)-Shalika functional. If
l is a (ψ′, ψ)-Shalika functional, ξ 7→ l(π(s(ω)−1)ξ) is an (H, ψ′, ψ)-functional.

With Claim 3.15 in mind, we construct (H, ψ′, ψ)-functionals. Our main tool will be the
metaplectic analog of Hironaka’s theorem, Corollary 2.17. To preserve the notation, we
construct the functional on I(χ−1).

(cid:3)

The group H is closed and unimodular. Sakellaridis proved [Sak06, Lemma 3.1] that BnH
is Zariski open in Gn. Therefore BnH is dense and open in Gn, making it convenient for
integration formulas. Here we are forced to work with Bn,∗H, which is in particular not
dense. Next we describe certain structural results involving Bn,∗ and H, which will enable
us to adapt the integration formulas from [Sak06] to the metaplectic setting.

Claim 3.16. BnH =`t∈Tk,∗\Tk

diag(t, Ik)Bn,∗H.

Proof. Since H contains the subgroup {diag(x1, . . . , xk, xk, . . . , x1) : xi ∈ F ∗}, it is clear that
any bh ∈ BnH is contained in one of the cosets on the right-hand side. The union is disjoint
because if diag(t, Ik)Bn,∗H = diag(t′, Ik)Bn,∗H, using the fact that Bn,∗ is normal in Bn
leads to diag(tt′−1, Ik)b∗ ∈ H for some b∗ ∈ Bn,∗. Let the diagonal of b∗ be diag(c1, . . . , cn),
ci ∈ F ∗2O∗. Then the diagonal of diag(tt′−1, Ik)b∗ takes the form diag(x1, . . . , xk, xk, . . . , x1)
−1 ∈ F ∗2O∗ for all i
and we must have tit′
i
and tTk,∗ = t′Tk,∗.

−1ci = xi = cn−i+1 for all 1 ≤ i ≤ k, whence tit′

(cid:3)

i

We will use the following geometric results from [Sak06, Lemma 5.1]:

N −
α (̟O) ⊂ (Tn ∩ K)Nα(O)Nα′(O)(H ∩ K),
I− ⊂ (Bn ∩ K)(H ∩ K).

∀α > 0,

(3.14)

Here for (i, j) = α > 0, α′ = α if i ≤ k < j otherwise α′ = (n − j + 1, n − i + 1). The latter
inclusion along with (2.1) and the fact that Bn ∩ K < Bn,∗ implies

I ⊂ (Bn ∩ K)(H ∩ K) ⊂ Bn,∗H.

(3.15)

Claim 3.17. The set Bn,∗H is open (in Gn).
Proof. According to (3.15), for any b∗ ∈ Bn,∗ and h ∈ H, b∗Ih ⊂ Bn,∗H. The set b∗Ih is
open (because I is) and contains b∗h. Therefore Bn,∗H is open.

(cid:3)

The following two claims relate the sections h, s and κ.

k Uk) ∩ K. Consequently, h and κ agree on

Claim 3.18. The sections s and κ agree on (G△
H ∩ K.
Proof. First we compare s and κ. We have (G△
k Uk) ∩ K = Gk(O)△Uk(O), where Gk(O)△ =
{c△ : c ∈ Gk(O)}. According to (3.1) and because (O∗,O∗)2 = 1, s is a splitting of
Gk(O)△ and thereby of Gk(O)△Uk(O). The section κ is also a splitting of the latter. Since
s|Nn∩K = κ|Nn∩K, it is enough to show that s and κ agree on Gk(O)△. The mapping
c 7→ s(c△)κ(c△)−1 is a homomorphism Gk(O) → µ2, which is trivial on Tk ∩ Gk(O) because
s|Tn∩K = κ|Tn∩K. Moreover, there is only one homomorphism SLk(O) → µ2, the trivial one
(when |2| = 1 and q > 3). Thus c 7→ s(c△)κ(c△)−1 is the identity.

Next we have H ∩ K = ω(Gk(O)△Uk(O)). The section h is a splitting of H ∩ K by
k Uk) ∩ K. The assertion for h now follows from

deﬁnition and because s is a splitting of (G△
the previous result because κ(ω) = s(ω).
Remark 3.19. One can check that for u 6= 0, h ( 1 0
not coincide, even on ωUk(O).

Next we consider

u 1 ) = (u, u)2s ( 1 0

u 1 ), whence h and s do

31

(cid:3)

H ∩ Bn,∗ = {diag(t1, . . . , tk, tk, . . . , t1) : ti ∈ F ∗2O∗}.

It is closed and unimodular.
Claim 3.20. The sections h and s agree on H ∩ Bn,∗.
Proof. Let t = diag(t1, . . . , tk, tk, . . . , t1) ∈ H ∩ Bn,∗. Then h(t) = s(ω)s(ω−1t). We compute
this conjugation as explained in Remark 3.8. Put ω = t0w, where t0 ∈ Tn ∩ K and w ∈ W.
Then σ(w, t) = 1 because (· , · )2 is trivial on F ∗2O∗ × F ∗2O∗. Also s(t0) and s(t) commute
because t0, t ∈ Tn,∗. Thus s(ω)s(ω−1t) = s(t).
Let dh be a Haar measure on H. Consider the functional lH on S gen(eH) given by
This integral is absolutely convergent because |f| ∈ S gen(H) (|f| is non-genuine and p : eH →
Hence lH satisﬁes (3.13) and is an (H, ψ′, ψ)-functional on the space of S gen(eH), where eH
Next consider the space of S gen(s(H ∩ Bn,∗)\eH). There is a surjection

H is continuous). Since f is genuine, (3.12) and (1.17) imply

lH(h(h)f ) = γψ′(det ch)ψ(uh)lH(f ).

ψ′ (det ch)ψ−1(uh) dh.

lH (f ) = ˆH

acts by right-translations.

f (h(h))γ−1

(cid:3)

given by f 7→ f Bn,∗∩H, where

S gen(p−1(Bn,∗H)) → S gen(s(H ∩ Bn,∗)\eH)
f Bn,∗∩H (h) = ˆBn,∗∩H
h ∈ eH.
Bn,∗)\eH) deﬁned by (see [Sak06, (44)])
lH∩Bn,∗\H (f ) = ˆH∩Bn,∗\H

f (s(b∗)h) db∗,

f (h(h))γ−1

Note that h(b∗) = s(b∗) (Claim 3.20). Then we have a functional lH∩Bn,∗\H on S gen(s(H ∩

ψ′ (det ch)ψ−1(uh) dh.

(3.16)

The integrand is invariant on the left by H ∩ Bn,∗: for b∗ ∈ H ∩ Bn,∗ and h ∈ H, by (3.12),
Claim 3.20, (1.17) and the fact that h 7→ γ−1

ψ′ (det ch) is trivial on H ∩ Bn,∗,

γ−1
ψ′ (det cb∗h)h(b∗h) = γ−1
= γ−1
= γ−1

ψ′ (det cb∗ det ch)(det cb∗, det ch)2h(b∗)h(h)
ψ′ (det cb∗)γ−1
ψ′ (det ch)s(b∗)h(h).

ψ′ (det ch)s(b∗)h(h)

32

Hence

EYAL KAPLAN AND JAN M ¨OLLERS

f (h(b∗h))γ−1

ψ′ (det cb∗h) = f (h(h))γ−1

ψ′ (det ch).

Also the character ψ−1 satisﬁes ψ−1(ub∗h) = ψ−1(uh) because ub∗ = In. Of course, lH∩Bn,∗\H
satisﬁes the same equivariance properties as lH.

Henceforth assume

q2si 6= q±2sj ,

∀1 ≤ i < j ≤ k,

q2si = q−2sn−i+1,

∀1 ≤ i ≤ k.

(3.17)

By Theorem 3.10 and Claim 3.15 the space of (H, ψ′, ψ)-functionals on I(χ−1) is at most
one-dimensional.

We chose χ in this form so that it is trivial on s(H ∩ Bn,∗). The modulus character δBn
is also trivial on H ∩ Bn,∗. We may then regard the elements of I(χ−1) as genuine locally

constant functions on s(H ∩ Bn,∗)\eH. Deﬁne a functional Λχ on I(χ−1) by

Λχ(fχ−1) = lH∩Bn,∗\H (fχ−1).

First we prove that this makes sense, for suﬃciently many characters χ. Later we extend it
to all relevant characters by meromorphic continuation. The equivariance properties of lH
imply that Λχ is an (H, ψ′, ψ)-functional.
Claim 3.21. Assuming Re(si) < Re(si+1) for all 1 ≤ i < k and Re(sk) < 0, the integral
lH∩Bn,∗\H(fχ−1) given by (3.16) is absolutely convergent for all fχ−1.
Proof. Since |fχ−1| can be regarded as a function on Gn, the proof in [Sak06, Proposition 7.1]
applies to our setting as well. Brieﬂy, writing dh on Ak\Tk × Nk × Gk(O) with Ak =
(Tk ∩ Gk(O))T 2
k ,

ˆH∩Bn,∗\H |fχ−1|(h) dh = ˆUk Xt∈Ak\Tk

ˆNk

ˆGk(O) |fχ−1|(ωt△v△k△uω−1) dk dv du.

We may assume fχ−1 is unramiﬁed. Then the integral is majorized by a ﬁnite sum of integrals

ˆUk

ˆNk |fχ−1|(ω(cid:18) v u

Ik (cid:19) ω−1 ω(t△)) dv du

(we omitted a constant depending on the change of measure dvdu, caused by the conjugation
by t△), which are known to converge given our assumption on χ.
(cid:3)

Recall the surjection Pχ : S gen(eGn) → I(χ) given by (2.3). We combine Pχ−1 with (3.16)
to obtain a formula convenient for computations (as in [Sak06, (45)]). For g ∈ Bn,∗H, one
can write g = b∗h with b∗ ∈ Bn,∗ and h ∈ H. This writing is not unique. We still put
bg = b∗ and hg = h. The arguments after (3.16) imply that the mappings g 7→ ψ−1(uhg) and
g 7→ s(bg)h(hg)γ−1
Bn (bg) is independent of the choice
of bg and the assumption χ|s(H∩Bn,∗) = 1 implies g 7→ χ(s(bg)) is independent of the speciﬁc
writing. Now we formally obtain

ψ′ (det chg) are well deﬁned. Also g 7→ δ1/2

Λχ(Pχ−1(f )) = ˆBn,∗H

δ1/2
Bn (bg)χ(s(bg))f (s(bg)h(hg))γ−1

ψ′ (det chg)ψ−1(uhg) dg.

(3.18)

This formula is valid whenever the right-hand side is absolutely convergent. The measure dg
is taken to be the restriction of the Haar measure on Gn to Bn,∗H and on the left-hand side

we normalize the measure dh accordingly (the measure dlb∗ has already been normalized,
see after (2.3)).

For any λ = (λ1, . . . , λk) ∈ Zk, put ̟λ = diag(̟λ1, . . . , ̟λk) and denote tλ = diag(̟λ, Ik).

Let

33

Zk

Zk

≥ = {(λ1, . . . , λk) ∈ Zk : λ1 ≥ . . . ≥ λk},
+ = {(λ1, . . . , λk) ∈ Zk : λ1 ≥ . . . ≥ λk ≥ 0}.

We also use 2Zk

+, where for all i, λi ∈ 2Z.

The following lemma describes the evaluation of Λχ(ϕw,χ−1) for certain elements w, where
it can be done succinctly. It is the main technical result of this section. The proof is parallel
to the proof of Propositions 5.2, 8.1 and 8.2 in [Sak06], the complications involve the various
sections s, h and κ. The results will be used below to deduce the general formula.
Lemma 3.22. Assume Re(si) < Re(si+1) for all 1 ≤ i < k and Re(sk) < 0. Also assume
ψ′ = ψ̺, for some ̺ ∈ O∗ (i.e., ψ′(x) = ψ(̺x)). The following holds.
Bn χ(s(tλ)) λ ∈ 2Zk
+,
+−2Zk
λ ∈ Zk
+.
q−1/2χ−1/2(aαk )).

Λχ(s(t−λ)ϕe,χ−1) =(vol(I)δ1/2

Λχ(ϕsαk ,χ−1) = vol(IwI)(1 − q−1 + (−̺, ̟)2(̟, ̟)k−1

(3.19)

(3.20)

0

2

For all 1 ≤ i < k,

Λχ(ϕsαi sαn−i ,χ−1) = vol(IwI)(1 − q−1 + q−2 + (1 − q−1)2 χ−1(aαi)
1 − χ−1(aαi)

).

(3.21)

Here χ−1/2(aαk ) = q2sk.
Remark 3.23. Note that χ−1/2(aα) is well deﬁned because χ(s(diag(Ii−1, ̟2, In−i))) = q−2si.

Proof. We use (3.18) for the computation. We ﬁrst proceed formally, the computation will
also imply that (3.18) is absolutely convergent, providing the justiﬁcation for replacing (3.16)
with (3.18).

Consider (3.19) and assume λ ∈ Zk

g ∈ Itλ. For λ ∈ Zk

+, tλ ∈ T −

+. Note that t−1
λ (I−)tλ < I− and by (2.1) and (3.15),

n whence t−1
Itλ ⊂ (Bn ∩ K)tλ(Bn ∩ K)(H ∩ K).

−λ = tλ. The integrand vanishes unless

In particular Itλ ⊂ tλBn,∗H, the latter does not intersect Bn,∗H unless λ ∈ 2Zk
Claim 3.16. So the integrand vanishes unless λ ∈ 2Zk
for some b0, b′
so that both (3.18) and (3.16) equal

+, by
+. In this case one can take bg = b0tλb′
0
ψ′ (det chg) = 1 because hg ∈ K,

0 ∈ Bn ∩ K and hg ∈ H ∩ K. Then ψ(uhg) = γ−1

Next we prove (3.20). Let w be the representative of sαk . Using (2.1) and (3.14) we obtain

vol(I)δ1/2
IwI = (Bn ∩ K)wNαk (O) Yβ>0:β6=αk

Bn χ(s(tλ)).

N −
β (̟O) ⊂ (Bn ∩ K)wNαk (O)(H ∩ K).

The integrand vanishes unless g ∈ IwI. Write
b0 ∈ Bn ∩ K,

g = b0wvh0,

v ∈ Nαk (O),

h0 ∈ H ∩ K.

34

EYAL KAPLAN AND JAN M ¨OLLERS

We decompose wv = b∗h ∈ Bn,∗H, using 2× 2 matrix computations, where the matrices are
regarded as elements of G2 embedded in Gn such that its derived group is Rαk (Rαk was
deﬁned after (2.5)). Then w is the matrix ( −1

). If v = ( 1 z

1 ) and z 6= 0,

z2 (cid:19) ,
b∗ =(cid:18) 1 −z

Then bg = b0b∗ and hg = hh0, hence

1

h =(cid:18) z−1

z−2 z−1 (cid:19) .

(3.22)

ψ−1(uhg) = ψ−1(uh) = ψ−1(z−1),
ψ′ (det chg) = (det ch, det ch0)2γ−1
γ−1
δ1/2
Bn (bg) = |z|−1,
χ(s(bg)) = |z|2sk+1 = |z|−2sk .

ψ′ (det ch) = (z, det ch0)2γ−1

ψ′ (z−1),

Next we show

chsαk ,χ−1(s(bg)h(hg)) = (z, z)k−1

2

(z, det ch0)2.

Because g ∈ IwI, this will follow immediately from

s(bg)h(hg) = (z, z)k−1

2

(z, det ch0)2κ(g).

(3.23)

To show this, start with κ(g) = κ(b0)κ(w)κ(v)κ(h0). Since s(w)s(v) = s(wv) = s(b∗h),

κ(g) = σ(b∗, h)κ(b0)s(b∗)s(h)κ(h0).

(3.24)

Using (1.2) we see σ(b∗, h) = 1. Next we claim s(h) = (z, z)k−1
s(ω)s(ω−1h)s(ω)−1. Write ω−1h = cu, where c = diag(Ik−1, z−1, Ik−1, z−1) and

2 h(h). Start with h(h) =

u =

Ik−1

1

Ik−1

z−1

1

 ∈ U.
kYi=1

Then s(ω−1h) = s(c)s(u). We ﬁnd s(ω)s(c) using Remark 3.8. Write ω = t0wω with

wω = (wαn−1 · . . . · wα1) · . . . · (wαn−1 · . . . · wαk ) =
t0 = diag((−1)kIk, (−1)k−1, (−1)k−2, . . . , 1).

(wαn−1 · . . . · wαi) ∈ W,

If wω is the Weyl element corresponding to wω (or ω),

{α > 0 : wωα < 0} = {(i, j) : 1 ≤ i ≤ k,

i < j ≤ n}.

Then

s(ω)s(c) = (−1, z−1)k−1

2

s(t0)s(ωc) = (z, z)k

2s(ωc).

Consider s(ω)s(u). If ω′ ∈ Gn satisﬁes ω′−1ωu = u, then s(ω′ −1ω)s(u) = s(u) hence s(ω)s(u) =
s(ω′)s(u). One can take

ω′ = diag(Ik−1, (−1)k, Ik)wαk · . . . · wαn−1.

35

The conjugation of s(u) by s(wαk+1 · . . . · wαn−1) commutes with s (i.e., s(...)s(u) = s(...u)),
because it keeps u in Nn. The last two conjugations are computed using (1.1) and (1.2),

s((cid:18)

(−1)k−1

1

(cid:19))s((cid:18) 1 (−1)k−1z−1

1

(cid:19))s((cid:18)

(−1)k−1

1

(cid:19)) = s((cid:18) 1

z−1 1 (cid:19)).

Therefore s(ω)s(u) = s(ωu). Also by (1.2), s(ωc)s(ωu) = (z, z)2s(ω(cu)). Altogether

h(h) = s(ω)(s(c)s(u)) = (z, z)k

2s(ωc)s(ωu) = (z, z)k−1
Plugging this into (3.24), using (3.12) and Claim 3.18 yields

2

s(ω(cu)) = (z, z)k−1

s(h).

2

κ(g) = κ(b0)s(b∗)(z, z)k−1

2 h(h)h(h0) = (z, z)k−1

2

(z, det ch0)2s(b0b∗)h(hh0),

thereby giving (3.23).

We see that (3.18) becomes

vol(IwI)

(q2sk+1)lq−l(̟−l, ̟−l)k−1

2

ˆO∗

γ−1
ψ′ (̟−lx)ψ−1(̟−lx) dx.

∞Xl=0

Note that dx is the additive measure of F (in particular ´O∗ dx = 1 − q−1).

Remark 3.24. This dx-integral is a particular instance of an integral studied by Szpruch
[Szp09], who used it to represent a local coeﬃcient resembling Tate’s γ-factor.

For l > 1 the dx-integral vanishes, since

ψ′ (̟−lx)ψ−1(̟−lx) dx = γ−1
γ−1

ˆO∗
because the conductor of ψ is O. Consider l = 1. Then (1.17) and the assumption |̺| = 1
show γ−1

ψ′ (̟−1x) = (−̺, ̟)2γψ(̟−1x), then dx-integral equals (−̺, ̟)2 multiplied by

ψ′ (̟−l) Xζ∈(1+̟O)\O∗

(̟−l, ζ)ˆ1+̟O

ψ−1(̟−lζx) dx = 0,

ˆO∗

γψ(̟−1x)ψ−1(̟−1x) dx.

This integral was computed in [Szp09, Lemma 1.12] (this is J1(F, ψ−1, χ0) in his notation)
and equals q−1/2. Altogether we obtain

vol(IwI)(1 − q−1 + q2sk−1/2(−̺, ̟)2(̟, ̟)k−1

2

).

Finally we prove (3.21). Let w be the representative of sαisαn−i. The argument is similar
to the previous case, we point the relevant changes in the computation. Using (3.14) and
the fact that w ∈ H,

IwI ⊂ (Bn ∩ K)wNαi(O)Nαn−i(O)w−1(H ∩ K).

Then g = b0wvw−1h0 with v ∈ Nαi(O)Nαn−i(O) (b0, h0 as above). Decompose wvw−1 = b∗h,
now we compute using 2 blocks of 2 × 2 matrices, belonging to G2 × G2 embedded in Gn
such that its derived group is Rαi × Rαn−i. For v = (( 1 z1
1 )) with z1z2 6= 1 and
(1 − z1z2) ∈ F ∗2O∗,

1 ) , ( 1 z2

b∗ =(cid:18)(cid:18) (1 − z1z2)−1 z2(1 − z1z2)−1
h =(cid:18)(cid:18) 1 −z2
1 (cid:19) ,(cid:18) 1 −z1
1 (cid:19)(cid:19) .

−z1

−z2

1

(cid:19) ,(cid:18) (1 − z1z2)−1 z1(1 − z1z2)−1

1

(cid:19)(cid:19) ,

36

EYAL KAPLAN AND JAN M ¨OLLERS

When (1 − z1z2) /∈ F ∗2O∗ we still have wvw−1 = b∗h but b∗ /∈ Bn,∗, and since

g ∈ diag(Ii−1, (1 − z1z2)−1, (1 − z1z2), In−i−1)Bn,∗H,

by Claim 3.16 we obtain g /∈ Bn,∗H. Hence we can assume 1 − z1z2 ∈ F ∗2O∗. Then

ψ−1(uhg) = 1,
ψ′ (det chg) = γ−1
γ−1
δ1/2
Bn (bg) = |1 − z1z2|−1,
χ(s(bg)) = |1 − z1z2|−si−sn−i = |1 − z1z2|−si+si+1.

ψ′ (1 − z1z2) = 1,

We may also take z1 6= 0. Next we prove

s(bg)h(hg) = (−z1, 1 − z1z2)2κ(g),

whence

As with the proof of (3.23), we begin with proving σ(b∗, h) = 1. This is immediate if

chsαi sαn−i ,χ−1(s(bg)h(hg)) = (−z1, 1 − z1z2)2.

z2 = 0. When z2 6= 0, apply (1.2) separately to each G2-block, then use (1.1). We obtain

(−z1, 1 − z1z2)2 (−z2, 1 − z1z2)2 ((1 − z1z2)−1, (1 − z1z2))2 = 1.

Here we used the fact that (x, 1− x) = 1 for any x 6= 0 and 1− z1z2 ∈ F ∗2O∗. Next we show

s(h) = (z1, 1 − z1z2)2h(h). Put x =(cid:0) 1 −z2

d1(g) = diag(Ii−1, g, In−i−1),

1 (cid:1). For any g ∈ G2, let

d2(g) = diag(Ik+i−1, g, Ik−i−1).

−z1

Then ω−1h = d1(x)d2(x) and h(h) = s(ω)s(d1(x)d2(x)). Now (1.1) implies

s(d1(x)d2(x)) = s(d1(x))s(d2(x)).

(3.25)

To compute s(ω)s(dj(x)) we write x using the Iwasawa decomposition in G2,
0

1 (cid:19)(cid:18) 1 −z2(1 − z1z2)−1

1

(cid:19)(cid:18) 1

−z1 1 (cid:19) .

x = x1x2x3 =(cid:18) 1 − z1z2

Then by (1.2),

s(dj(x)) = (−z1, 1 − z1z2)2s(dj(x1))s(dj(x2))s(dj(x3)),

j = 1, 2.

(3.26)

We compute the conjugation separately for each xi:

s(ω)s(dj(x1)) = s(ωdj(x1)): If ω = t0wω as above, s(wω )s(dj(x1)) = s(wω dj(x1)) by Claim 3.7
and s(t0)s(wω dj(x1)) = s(wω dj(x1)) because (−1, 1 − z1z2)2 = 1 (1 − z1z2 ∈ F ∗2O∗). Hence
s(ω)s(dj(x1)) = s(ωdj(x1)).
s(ω)s(dj(x2)) = s(ωdj(x2)): For j = 1 we argue as in the case of s(ω)s(u) above, this time

with

ω′ = diag(In−i−1,−1, Ii)wαn−i · . . . · wαiwαn−i · . . . · wαi+1,

and obtain s(ω)s(d1(x2)) = s(ωd1(x2)). For j = 2 this holds simply because ωd2(x2) ∈ Nn.

s(ω)s(dj(x3)) = s(ωdj(x3)): A direct computation using (1.2) shows

s(x3) = s(cid:18)

−1

1

(cid:19) s(cid:18) 1 z1

1 (cid:19) s(cid:18)

−1

1

(cid:19) = κ(x3)

(z1 ∈ O and s and κ agree on Nn ∩ K). Hence s(ω)s(dj(x3)) = s(ωdj(x3)).

37

(3.27)

(3.28)

(3.29)

(3.30)

Summarizing,

s(ω)s(dj(x)) = (−z1, 1 − z1z2)2s(ωdj(x1))s(ωdj(x2))s(ωdj(x3)).

Similarly we see that

s(ωd1(x)) = s(ωd1(x1))s(ωd1(x2))s(ωd1(x3)),
s(ωd2(x)) = (−z1, 1 − z1z2)2s(ωd(x1))s(ωd(x2))s(ωd(x3)),
s(ω(d1(x)d2(x))) = s(ωd1(x))s(ωd2(x)).

Thus (3.25)-(3.30) yield

h(h) = s(ω)s(d1(x)d2(x))

= s(ω)s(d1(x)) s(ω)s(d2(x))
= s(ωd1(x1))s(ωd1(x2))s(ωd1(x3))s(ωd2(x1))s(ωd2(x2))s(ωd2(x3))
= (−z1, 1 − z1z2)2s(ωd1(x))s(ωd2(x))
= (−z1, 1 − z1z2)2s(ω(d1(x)d2(x)))
= (−z1, 1 − z1z2)2s(h).

Altogether (3.18) becomes

vol(IwI)ˆO ˆO

(−z1, 1 − z1z2)2|1 − z1z2|−si+si+1−1chF ∗2O∗(1 − z1z2) dz1 dz2.

dz1 dz2 +ˆ̟OˆO∗

Here chF ∗2O∗ is the characteristic function of F ∗2O∗. As in [Sak06] (proof of Proposition 8.2)
we split the integral into the following sum,
ˆO ˆ̟O
dz1 dz2 +ˆO∗ ˆO∗ |1 − z1z2|−si+si+1−1chF ∗2O∗(1 − z1z2) dz1 dz2.
We used the fact that when either z1 or z2 belongs to ̟O (and both z1, z2 ∈ O), |1−z1z2| = 1
and 1 − z1z2 ∈ F ∗2, in particular (−z1, 1 − z1z2)2 = 1. For the rightmost integral note that
when z1 ∈ O∗, chF ∗2O∗(1 − z1z2) = 1 implies (−z1, 1 − z1z2)2 = 1. The ﬁrst summand
contributes q−1, the second q−1(1 − q−1). We proceed with the integral on the right. After
a change of variables it becomes

(1 − q−1)ˆO∗ |1 − z|−si+si+1−1chF ∗2O∗(1 − z) dz.

Put |1 − z| = q−l for some l ≥ 0. Then chF ∗2O∗(1 − z) 6= 0 if and only if l is even. Hence we
get

(1 − q−1)(1 − 2q−1 + (1 − q−1)

Summing up we obtain

q−2(si+1−si)

1 − q−2(si+1−si) ).

vol(IwI)(1 − q−1 + q−2 + (1 − q−1)2

The proof is complete.

q−2(si+1−si)

1 − q−2(si+1−si) ).

(cid:3)

38

EYAL KAPLAN AND JAN M ¨OLLERS

section if its restriction to `t∈Tn,∗\Tn

Recall that we assume χ satisﬁes (3.17). We say that fχ−1 is a polynomial (resp. rational)
s(t)κ(K) depends polynomially (resp. rationally) on
χ−1, or more precisely on q±2s1, . . . , q±2sk. The deﬁnition is independent of the actual choice
of representatives of Tn,∗\Tn.
Proposition 3.25. The functional Λχ has a meromorphic continuation to all χ satisfying
(3.17), in the sense that if fχ−1 is a rational section, Λχ(fχ−1) is a rational function, i.e.,
belongs to C(q−2s1, . . . , q−2sk).
Proof. The argument appeared in [Sak06, § 7]. According to Theorem 3.10 and Claim 3.15,
there exists at most one solution (a functional) to the system of equations, deﬁned by (3.13)
with the additional condition that ϕe,χ−1 is mapped to vol(I). Furthermore, according to
Claim 3.21 and (3.19), in an open subset of Ck, there exists a nontrivial solution. Hence by
Bernstein’s continuation principle (in [Ban98]) Λχ(fχ−1) extends to a rational function. (cid:3)

Corollary 3.26. The results of Lemma 3.22 hold for all χ satisfying (3.17), by means of
meromorphic continuation.

Below we state the explicit formula for the unramiﬁed function g 7→ Λχ(gϕK,χ−1). The
≥. The following simple claim shows that these elements

formula is for g = tλ with λ ∈ Zk
already determine the values of the function.

Claim 3.27. Let l be a metaplectic (ψ′, ψ)-Shalika functional (resp. (H, ψ′, ψ)-functional)

on a genuine unramiﬁed π ∈ Alg eGn. Let ξ be an unramiﬁed vector in the space of π and
consider the function lξ(g) = l(π(g)ξ).
k U) ∩ K (resp. k0 ∈ H ∩ K), g ∈ eGn and k ∈ K.
(1) lξ(κ(k0)gκ(k)) = lξ(g) for any k0 ∈ (G△
(2) lξ is uniquely determined by its values on tλ (resp. t−λ), where λ ∈ Zk
≥.
≥−Zk
(3) lξ(tλ) = 0 (resp. t−λ) for λ ∈ Zk
+.
Proof. The ﬁrst assertion follows from Claim 3.18 and (3.13). The second and third follow
by a straightforward adaptation of the proofs of these results in the non-metaplectic setting
([JR96, § 6.2]). For example, we explain the proof of (3) for the (H, ψ′, ψ)-functional.
Consider λ ∈ Zk

≥. Let u ∈ Ok×k and h = ω(cid:0) Ik u

s(t−λ)h(h) = h(ω(cid:16) Ik u̟λ

Ik(cid:1) ∈ H ∩ K. Then
Ik (cid:17))s(t−λ),
lξ(s(t−λ)) = lξ(s(t−λ)h(h)) = ψ((cid:16) Ik u̟λ

Ik (cid:17))lξ(s(t−λ)).

whence by Claim 3.18,

(cid:3)

Thus lξ(s(t−λ)) = 0, unless λ ∈ Zk
+.

Let Spk be the symplectic group on n variables, embedded in Gn as the subgroup

{g ∈ Gn : tg(cid:0)

Jk

−Jk

Jk

−Jk

(cid:1) g =(cid:0)

(cid:1)},

where tg denotes the transpose of g. We ﬁx the Borel subgroup Spk ∩ Bn and let ΣSpk (resp.
Σ+
) be the corresponding root system (resp. positive roots) of Spk. The map ΣGn → ΣSpk
Spk
is two-to-one onto the short roots, and injective onto the long roots. Recall that we assumed
q2si = q−2sn−i+1 for all 1 ≤ i ≤ k (in (3.17)). Equivalently, χ is trivial on s(H ∩ Bn,∗). Hence
if β, β′ ∈ ΣGn are the two roots corresponding to a short root α ∈ ΣSpk, cβ(χ) = cβ′(χ).

Thus we may extend the notation cα(χ) to short roots α, meaning cβ(χ). The same applies
to χ−1. Similarly, we deﬁne cα(χ) for long roots (there is no ambiguity here, for any χ).

39

Denote the Weyl group of Spk by WSpk, it is the group generated by sk and sisn−i, 1 ≤
i < k. For w ∈ WSpk , let ℓSpk(w) be the minimal number of simple reﬂections in WSpk whose
product is w, i.e., the usual length with respect to WSpk .
. For any α ∈ Σ+
α is short,

Recall that ψ′ = ψ̺ (see Lemma 3.22), put ǫ̺,k = (−̺, ̟)2(̟, ̟)k−1

let

Spk

2

1 − χ(aα)

cα(χ−1)cα(χ)
(1 + q−1/2ǫ̺,kχ−1/2(aα))(1 − q−1/2ǫ̺,kχ1/2(aα))

yα(χ−1) =
As in Lemma 3.22, if α is the long root (i, n − i + 1), χ−1/2(aα) = q−2si.
Theorem 3.28. Let λ ∈ Zk
this case,
Λχ(s(t−λ)ϕK,χ−1) = Q−1 Xw∈WSpk Y{α>0:wα>0}
β(χ−1) = Yα∈Σ+
Λχ(s(t−λ)ϕK,χ−1) = Q−1cw0(χ−1)β(χ−1)−1 Xw∈WSpk

cα(χ−1) Y{α∈Σ+
(1 − q−1χ−1(aα)) Ylong α∈Σ+

χ1/2(aα) Yshort α∈Σ+

More compactly, put

Then

:wα<0}

Spk

Spk

Spk

Spk

α is long.

yα(χ−1)δ1/2
Bn

wχ(s(tλ)).

(1 − q−1/2ǫ̺,kχ−1/2(aα)).

≥. The function Λχ(s(t−λ)ϕK,χ−1) vanishes unless λ ∈ 2Zk

+. In

(−1)ℓSpk (w)β(wχ−1)δ1/2

Bn

wχ(s(tλ)).

Remark 3.29. The product over χ1/2(aα) in this formula is well deﬁned because

Spk

Qα∈Σ+
Qα∈Σ+

Spk

wχ1/2(aα)

χ1/2(aα)

= Y{α∈Σ+

Spk

:wα<0}

χ−1(aα).

Remark 3.30. To obtain the formula for the (non-metaplectic) Shalika model, simply remove
the product over long roots in the deﬁnition of β(χ−1). Up to a factor independent of λ this
was the formula obtained by Sakellaridis [Sak06] (see also [Sak13, § 5.5.2]).
Proof. We use the notation of § 2.3. The space of (H, ψ′, ψ)-functionals on I(χ−1) is at most
one-dimensional. Therefore (2.15) becomes

where A(w, χ) is a scalar (a rational function of χ). By virtue of Corollary 2.17,

T ∗
w−1,wχ−1Λχ = A(w, χ)Λwχ,

(3.31)

Λχ(s(t−λ)ϕK,χ−1) =

1

Qvol(I) Xw∈W

cw0(w0wχ)
cw−1(wχ−1)

A(w, χ)(Λwχ(s(t−λ)ϕe,χ−1).

According to Lemma 3.22,

Λwχ(s(t−λ)ϕe,χ−1) =(vol(I)δ1/2

Bn

0

wχ(s(tλ)) λ ∈ 2Zk
+,
λ ∈ Zk
+−2Zk
+.

(3.32)

40

EYAL KAPLAN AND JAN M ¨OLLERS

More precisely Λwχ is a functional on I(wχ−1), and the domain of absolute convergence
changes after the conjugation, so actually we apply Corollary 3.26 and deduce this equality
in the sense of meromorphic continuation.

Therefore Λχ(s(t−λ)ϕK,χ−1) vanishes, unless λ ∈ 2Zk

Equality (3.32) also implies Λwχ(ϕe,χ−1) 6= 0. Therefore A(w, χ) is given by the quotient

+. Henceforth assume this is the case.

T ∗
w−1,wχ−1Λχ(ϕe,wχ−1)

Λχ(Tw−1,wχ−1ϕe,wχ−1)

A(w, χ) =

Λwχ(ϕe,wχ−1)

=

vol(I)

.

(3.33)

We claim that only elements of WSpk contribute to the sum.
Claim 3.31. If w ∈ W−WSpk , A(w, χ) = 0.

Using the fact that cw0(w0wχ) = cw0(wχ−1), we obtain (this is [Sak06, (48)])

Λχ(s(t−λ)ϕK,χ−1) = Q−1 Xw∈WSpk Y{α>0:wα>0}

cα(χ−1)A(w, χ)δ1/2
Bn

wχ(s(tλ)).

It remains to compute A(w, χ) for w ∈ WSpk. Let ℓSpk(w) = l and write w = s′

1 · . . . · s′
l,

where s′

i is either sαk or sαisαn−i with 1 ≤ i < k. Then
lχ) . . . A(s′

A(w, χ) = A(s′

2·...·s′

1, s′

l−1, s′

lχ)A(s′

l, χ).

We will compute A(s′

i, χ) succinctly using Claim 2.9 and Corollary 3.26.

Claim 3.32. We have A(sαk, χ) = yαk(χ−1) and A(sαisαn−i, χ) = yαi(χ−1).

We conclude that for any w ∈ WSpk,

A(w, χ) = Y{α∈Σ+

Spk

:wα<0}

yα(χ−1).

Plugging this into the last expression for Λχ(s(t−λ)ϕK,χ−1) yields the theorem. To obtain the
compact form with β(χ−1) one can apply manipulations similar to [Sak06, (75)–(78)].
(cid:3)

Proof of Claim 3.31. According to (3.33) it is enough to show that T ∗

w−1,wχ−1Λχ vanishes on

of T ∗
We prove Λ = 0. The argument was adapted from [Sak06, Proposition 5.2].

ϕe,wχ−1. By (3.15) the support of ϕe,wχ−1 is contained in eBn,∗H. Let Λ denote the restriction
w−1,wχ−1Λχ to the subspace of functions in I(wχ−1), whose support is contained in eBn,∗H.
Consider the space S gen(p−1(Bn,∗H), δ1/2

wχ−1) of complex-valued locally constant genuine

Bn

functions f on p−1(Bn,∗H) such that

f (s(b∗)h) = δ1/2
Bn

wχ−1(s(b∗))f (h),

∀b∗ ∈ Bn,∗, h ∈ H.

(3.34)

Since Bn,∗H is open in Gn (Claim 3.17), Λ is the restriction of T ∗

w−1,wχ−1Λχ to this subspace.

These spaces are isomorphic:

H, and note that δBn is trivial there.

Also consider S gen(s(H ∩ Bn,∗)\eH, wχ−1), where the functions satisfy (3.34) on b∗ ∈ Bn,∗ ∩
in one direction use restriction to eH, conversely one can
extend a function f in S gen(s(H ∩ Bn,∗)\eH, wχ−1) to the former space using

wχ−1(s(b∗))f (h(h))

s(b∗)h(h) 7→ δ1/2

Bn

(to see this is well deﬁned use (3.12)).

41

h ∈ eH, f ∈ S gen(eH).

Thus we may regard Λ as a functional on S gen(s(H ∩ Bn,∗)\eH, wχ−1). Then it lifts to a
functional on S gen(eH), by virtue of the projection

wχ(s(b∗))f (s(b∗)h) db∗,

f Bn,∗∩H,wχ−1

(h) = ˆBn,∗∩H

Furthermore, since Λ is an (H, ψ′, ψ)-functional, it is a scalar multiple of the functional lH
(deﬁned after Claim 3.20). Indeed, this follows from the Frobenius reciprocity:
if we let ι

eH

h(h) to γψ′(ch)ψ(uh), both Λ and lH belong to

Hom eH(S gen(eH), γψ′ ⊗ ψ ⊗ ι) = Hom eH(ind

be the identity character of µ2 and regard γψ′ ⊗ ψ ⊗ ι as the genuine character of eH taking
Finally for b∗ ∈ Bn,∗ ∩ H and f ∈ S gen(eH), let L(b∗)f (h) = f (s(b∗)h). Since H is
But this contradicts the fact that Λ factors through S gen(s(H ∩ Bn,∗)\eH, wχ−1), because for

unimodular we see that lH(L(b∗)f ) = lH(f ), so assuming Λ 6= 0, the same holds for Λ.
w ∈ W−WSpk, wχ−1 is not trivial on s(H ∩ Bn,∗).
Proof of Claim 3.32. First note that by Claim 2.9, for any α ∈ ∆Gn,
Tsαϕe,sα χ−1 = (cα(sαχ−1) − 1)ϕe,χ−1 + q−1ϕsα,χ−1.

µ2(ι), γψ′ ⊗ ψ ⊗ ι) = Homµ2(ι, ι).

(3.35)

(cid:3)

Consider A(sαk , χ). Assume that w represents sαk . We apply Λχ to (3.35) with α = αk.

By Corollary 3.26,

Λχ(Tsαk

ϕe,sαk χ−1) =vol(I)(cαk (sαk χ−1) − 1)

+ q−1vol(IwI)(1 − q−1 + (−̺, ̟)2(̟, ̟)k−1

2

q−1/2χ−1/2(aαk )).

Since cαk(sαk χ−1) = cαk(χ) and vol(IwI) = q · vol(I), we ﬁnd that
q−1/2χ−1/2(aαk )

A(sαk , χ) = cαk(χ) − q−1 + (−̺, ̟)2(̟, ̟)k−1

2

= −χ−1(aαk)

1 − χ−1(aαk )
We turn to A(sαisαn−i, χ). Applying Claim 2.9 twice,

(1 + q−1/2ǫ̺,kχ−1/2(aαk))(1 − q−1/2ǫ̺,kχ1/2(aαk ))

= yαk(χ−1).

Tsαi sαn−i

ϕe,

sαi

sαn−i χ−1 =(cαn−i(sαn−i χ−1) − 1)(cαi(sαi sαn−i χ−1) − 1)ϕe,χ−1

+ q−1(cαi(sαi sαn−i χ−1) − 1)ϕsαn−i ,χ−1
+ q−1(cαn−i(sαn−i χ−1) − 1)ϕsαi ,χ−1
+ q−2ϕsαi sαn−i ,χ−1.

(3.36)

As in [Sak06] the value of Λχ on the second and third summands is already determined:
ϕe,sαi χ−1 hence when we apply Λχ to (3.35) with
Claim 3.31 implies that Λχ vanishes on Tsαi
α = αi,

Λχ(ϕsαi ,χ−1) = q(1 − cαi(sαi χ−1))Λχ(ϕe,χ−1) = vol(I)q(1 − cαi(sαi χ−1)).

Similarly

Λχ(ϕsαn−i ,χ−1) = vol(I)q(1 − cαn−i(sαn−i χ−1)).

42

EYAL KAPLAN AND JAN M ¨OLLERS

Also by Corollary 3.26,

Λχ(ϕsαi sαn−i ,χ−1) = vol(IwI)(1 − q−1 + q−2 + (1 − q−1)2 χ−1(aαi)
1 − χ−1(aαi)

).

Note that now vol(IwI) = q2vol(I). Plugging these identities into (3.36) and using the fact
that cαn−i(χ) = cαi(χ) (because sn−i = −si+1 and sn−i+1 = −si) yields

ϕe,

sαi sαn−i χ−1)

Λχ(Tsαi sαn−i
= vol(I)(−(cαi(χ) − 1)2 + 1 − q−1 + q−2 + (1 − q−1)2 χ−1(aαi)
1 − χ−1(aαi)

We see that

).

A(sαisαn−i, χ) = − χ−1(aαi)
completing the proof of the claim.

1 − q−1χ(aαi)
1 − q−1χ−1(aαi)

cαi(χ−1)2 = cαi(χ)cαi(χ−1) = yαi(χ−1),

(cid:3)

The following corollary strengthens Proposition 3.25.

Corollary 3.33. Let χ be a character satisfying (3.17). Then Λχ is a nonzero (H, ψ′, ψ)-
functional on I(χ−1). Moreover it depends polynomially on χ, in the sense that for a poly-
nomial section fχ−1, Λχ(fχ−1) belongs to C[q−2s1, . . . , q−2sk].

Proof. According to Proposition 3.25, the functional Λχ is deﬁned on I(χ−1) by means
It is nonzero because it does not vanish on ϕe,χ−1 (Corol-
of meromorphic continuation.
lary 3.26). It remains to show it does not have a pole. Claim 3.27 and Theorem 3.28 show

that there are no poles on the eGn-space spanned by ϕK,χ−1. Claim 2.4 implies that for almost

all χ (except for a discrete subset of Ck), this space is all of I(χ−1). Since Λχ is determined
by meromorphic continuation, the assertion holds.
(cid:3)

Remark 3.34. The representation I(χ−1) might be reducible. In this case it may happen
that

Y{α>0:wα>0}

cα(χ−1) Y{α∈Σ+

Spk

:wα<0}

yα(χ−1) = 0,

∀w ∈ WSpk,

and consequently Λχ will vanish on the eGn-space spanned by ϕK,χ−1.

functional, on the unramiﬁed normalized element of I(χ−1).

We ﬁnally relate between the (H, ψ′, ψ)-functional and the metaplectic (ψ′, ψ)-Shalika

Corollary 3.35. Assume χ satisﬁes (3.17) and let l be the functional on I(χ−1) given by

l(fχ−1) = Λχ(s(w)fχ−1).

(1) l is a nonzero metaplectic (ψ′, ψ)-Shalika functional.
(2) l depends polynomially on χ.
(3) l(s(tλ)ϕK,χ−1) = Λχ(s(t−λ)) for all λ ∈ Zk
≥.

In particular l(s(tλ)ϕK,χ−1) vanishes on
+. Consequently, Theorem 3.28 gives the Casselman–Shalika formula for the

λ ∈ Zk
metaplectic Shalika model.

≥−2Zk

Proof. We adapt the argument from [Sak06, (25)]. We have h wtλ = t−λ with

h = diag(̟−λ, Jk̟−λJk) ∈ H.

Put h(h)s(w)s(tλ) = ǫs(t−λ) for some ǫ ∈ µ2. Because ϕK,χ−1 is unramiﬁed,

l(s(tλ)ϕK,χ−1) = Λχ(s(w)s(tλ)ϕK,χ−1) = ǫγψ′(det ch)−1Λχ(s(t−λ)ϕK,χ−1).

43

+, but then ǫ = 1 and γψ′(det ̟λ) = 1. The result follows.

This vanishes unless λ ∈ 2Zk
3.4. Archimedean uniqueness results. In this section we establish uniqueness results
for the metaplectic Shalika model of a principal series representation, analogous to those of
Theorem 3.10. We assume F = R, but the proof applies to C as well. In fact, we only need
the real case, because we will apply this result to the exceptional representation, which is
irreducible, and then over C uniqueness was proved in [AGJ09].

(cid:3)

Over R it is convenient to work with the Langlands decomposition Bn = TnNn = MnAnNn,

where

Mn = {diag(t1, . . . , tn) : ti ∈ µ2} ∼= µn
2 ,
An = {diag(t1, . . . , tn) : ti ∈ R>0} ∼= Rn
>0.

Note that An splits under the cover. The group fMn is a non-trivial extension of Mn which we

now describe in more detail. Let C(n) denote the Cliﬀord algebra in n generators e1, . . . , en
with relations e2

i = 1 and eiej + ejei = 0. Then

fMn ∼= {±ei1 · · · eir : 1 ≤ i1 < . . . < ir ≤ n}.

The covering map fMn → Mn is given by ±ei1 · · · eir 7→ εI with I = {i1, . . . , ir}, where εI is

the diagonal matrix having −1 on the diagonal at positions i1, . . . , ir, and 1 at the remaining
ones. Further, the section s is on Mn given by

s(εI) = eir · · · ei1 = (−1)

r(r−1)

2

ei1 · · · eir .

ters and one genuine representation of dimension 2k. The genuine representation σ is the

2 there are 2n non-isomorphic characters of Mn which lift

Claim 3.36. The group fMn has 2n + 1 irreducible representations, 2n non-genuine charac-
restriction of the pin-representation of Pin(n) ⊂ C(n) to fMn.
Proof. It is easy to see that fMn has 2n + 1 conjugacy classes and hence 2n + 1 irreducible
representations. Since Mn ∼= µn
to non-isomorphic characters of fMn. Since the squares of the dimensions of all irreducible
representations of fMn sum up to the order of fMn the last remaining irreducible representa-
tion must have dimension 2k. The restriction of the pin-representation to fMn is easily seen
The genuine principal series of eGn is given by
where ν = (ν1, . . . , νn) ∈ Cn corresponds to the character of the Lie algebra an of An given
by ν(diag(t1, . . . , tn)) = Pn
2 ) denotes half
the sum of all positive roots.

to be genuine and has dimension 2k, hence has to be irreducible by a complete reducibility
argument.
(cid:3)

j=1 νjtj, and ρ = (ρ1, . . . , ρn) = ( n−1

(σ ⊗ eν+ρ ⊗ 1),

2 , n−3

2 , . . . , 1−n

eGn
fMnAnNn

J(ν) = Ind

44

EYAL KAPLAN AND JAN M ¨OLLERS

Theorem 3.37. Assume that ν ∈ Cn satisﬁes the condition

νi + νj 6= 0,

∀1 ≤ i ≤ k, 1 ≤ j ≤ n with j 6= i, n − i + 1.

Then the space of metaplectic Shalika functionals on J(ν) is at most one-dimensional. Fur-
thermore, it is trivial unless νi + νn−i+1 = 0 for all 1 ≤ i ≤ k.

Proof. By Archimedean Bruhat theory we have for any two closed subgroups H1, H2 ⊂ eGn

and any two (ﬁnite-dimensional) representations ξ1 and ξ2 of H1 and H2 that

dim Hom eGn

(Ind

eGn
H1 (ξ1δ1/2

H1 ), Ind

H2 ))

eGn
H2 (ξ2δ1/2
dim HomH(g)(ξ1 ⊗ (ξg

≤ XH1gH2

∞Xm=0

2)∨,

δH(g)
H2)1/2 ⊗ Sm(V (g))),

(δH1δg

(3.37)

V (g) = gn/(h1 + Ad(g)h2) and ξg(h) = ξ(g−1hg) for h ∈ H(g) and ξ a representation of H2.

where the sum is over all double cosets H1gH2 ∈ H1\eGn/H2, and H(g) = H1 ∩ (gH2g−1),
Here gn, h1 and h2 denote the Lie algebras of eGn, H1 and H2. Further, δH(g) is the modulus
character of H(g). In our case H1 = eG△
k Uk, H2 = eBn and ξ1 = γψ′ ⊗ ψ, ξ2 = σ ⊗ eν, δH1 = 1,
k Uk\eGn/eBn is parametrized by diag(Sk)\Sn,
δH2 = e2ρ. Further, the double coset space eG△

where Sn is the symmetric group in n letters and diag(Sk) ⊂ Sn the diagonal embedding of
the symmetric group Sk acting on the ﬁrst and last k letters in the same fashion. For such
a permutation matrix g we write g = (δi,ji)i=1,...,n, then geji = ei.

For a permutation matrix g ∈ Gn and m ≥ 0 we put

the Hom-space in (3.37). We claim that H(g, m) = 0 unless m = 0 and

H(g, m) = HomH(g)((γψ′ ⊗ ψ) ⊗ ((σg)∨ ⊗ e−g(ν−ρ)), δH(g) ⊗ Sm(V (g))),
g = g0 =(cid:18)

2 g1)ei = ek−i+1, i = 1, . . . , k.

(cid:19) ,

where

(g−1

g1

g2

Note that H1g0H2 is the same equivalence class for all choices of g1 and g2. Further, for this
particular g = g0 we have H(g0, 0) = 0 unless νi + νn−i+1 = 0 for all i = 1, . . . , k, and in this
case dim H(g0, 0) = 1. We prove these claims in 3 steps.
(1) First, the same analysis as in the proof of Theorem 3.10 shows that for m = 0 we have

H(g, 0) = 0 for g 6= g0.
(2) Next we claim that whenever V (g) 6= 0 then H(g, m) = 0 for all m > 0. The H(g)-
representation V (g) = gn/(h1+Ad(g)h2) is the sum of the equivalence classes of Eℓ,m with
either ℓ, m ∈ {1, . . . , k}, ℓ, m ∈ {k + 1, . . . , n}, or ℓ ∈ {k + 1, . . . , n} and m ∈ {1, . . . , k}.
We claim that if the equivalence class of some Eℓ,m in V (g) is nonzero, then there exists a
root subgroup of H(g) that acts nilpotently on Eℓ,m. This root subgroup acts on the left
hand side of H(g, m) either trivially or by the character ψ, and on the right hand side
it only acts on Sm(V (g)). Hence, no homomorphism in H(g, m) can have a component
of Eℓ,m in its image. This is true for all generators of V (g) and hence H(g, m) = 0 for
m > 0.
It remains to show that every nonzero equivalence class Eℓ,m in V (g) has a root subgroup
in H(g) acting nilpotently on it. First, if ℓ ∈ {k +1, . . . , n} and m ∈ {1, . . . , k} with Eℓ,m
nonzero in V (g), then Eℓ,m /∈ Ad(g)h2. Hence Ejℓ,jm /∈ h2 which means jℓ > jm. But
then Ejm,jℓ ∈ h2 and therefore Em,ℓ ∈ Ad(g)h2. Since also Em,ℓ ∈ h1 we have Em,ℓ ∈ h(g),
so H(g) contains the root subgroup Nm,ℓ which acts nilpotently on Eℓ,m.

45

Next, if ℓ, m ∈ {1, . . . , k} with Eℓ,m non-trivial in V (g), then Eℓ,m /∈ Ad(g)h2 and also
Eℓ+k,m+k /∈ Ad(g)h2, because Eℓ,k + Eℓ+k,m+k ∈ h1. Hence Ejℓ,jm, Ejℓ+k,jm+k /∈ h2. As
before this implies Ejm,jℓ, Ejm+k,jℓ+k ∈ h2 and hence Em,ℓ, Em+k,ℓ+k ∈ Ad(g)h2. Therefore
Em+ℓ + Em+k,ℓ+k ∈ h(g) and the corresponding root subgroup acts nilpotently on Eℓ,m.
We note that in this case ℓ 6= m. This shows the claim.
(3) Finally we show that H(g0, 0) is non-trivial if and only if νi + νn−i+1 = 0 for all i =
1, . . . , k, and in this case dimH(g0, 0) = 1. For g = g0 we have H(g) = ^(MkAk)
which
is the direct product of A△

△

k and

k = {±ei1ei1+k · · · eir eir+k : 1 ≤ i1 < . . . < ir ≤ k, r ∈ {0, . . . , k}}.

fM△

Hence δH(g) = 1, ψ|H(g) = 1 and we have

H(g, 0) = HomH(g)(γψ′ ⊗ (σg)∨ ⊗ e−g(ν−ρ), C)

= Hom fM△

k

(γψ′, σg) ⊗ HomA△

k

(e−g(ν−ρ), C).

The second factor is nonzero if and only if νi+νn−i+1 = ρi+ρn−i+1 = 0 for all i = 1, . . . , k,
in which case it is one-dimensional.
It remains to show that the ﬁrst factor is one-
dimensional. For this we use some Cliﬀord analysis.

The k-dimensional subspace X ⊂ Cn spanned by fi = ei + √−1ei+k, i = 1, . . . , k, is
isotropic with respect to the standard bilinear form on Cn. Let X ′ ⊂ Cn be the subspace
i = ei − √−1ei+k, i = 1, . . . , k, then Cn = X ⊕ X ′. There is an algebra
spanned by f ′
isomorphism Φ : C(n) → End(Λ∗ X), x 7→ Φx which is on X, X ′ ⊂ C(n) given by
x ∈ X,
x′ ∈ X ′,

Φx(x1 ∧ · · · ∧ xr) = x ∧ x1 ∧ · · · ∧ xr,
Φx′(x1 ∧ · · · ∧ xr) = 2

(−1)i−1(x′|xi)x1 ∧ · · · ∧bxi ∧ · · · ∧ xr,
of fMn on Λ∗ X is given by σ(x) = Φx. We compute the action of fM△

i.e. X acts by exterior multiplication and X ′ by contractions. The pin-representation σ
k on Λ∗ X. For this
we use the basis of Λ∗ X given by fI = fi1 ∧ . . . ∧ fir with I = {i1, . . . , ir} ⊂ {1, . . . , k},
1 ≤ i1 < . . . < ir ≤ k. First, each monomial eiei+k acts on the basis elements as by
σ(eiei+k)(fi1 ∧ . . . fir ) =

rXi=1

i )(fI) =

)(fI)

σ(f ′

(Φf ′

1

1

i

i fi − fif ′
Φfi − Φf ′

i

1

4√−1
4√−1
√−1

1

=

=

(2Φf ′

fI ×(+1

−1

if i /∈ I,
if i ∈ I.

4√−1

i fi+fif ′
i

)(fI) =

i

Φfi − ΦfiΦf ′
1
4√−1

(2Φf ′

i

Φfi − 4)(fI)

Hence,

σ(±ei1ei1+k · · · eir eir+k)fI = ±(−√−1)r(−1)#(I∩{i1,...,ir}).

k

k

= σ| fM△

Note that σg| fM△
γψ′(−1) = √−1. The case of γψ′(−1) = −√−1 is handled similarly. Then
2 γψ′(eir+k · · · ei1+keir · · · ei1)
2 γψ′(s(εI∪(I+k))

. To determine the action of fM△

γψ′(±ei1ei1+k · · · eir eir+k) = ±(−1)r+ r(r−1)
= ±(−1)r+ r(r−1)

k under γψ′ we assume that

46

EYAL KAPLAN AND JAN M ¨OLLERS

= ±(−1)r+ r(r−1)
= ±(−√−1)r.

2 γψ′((−1)r)

Hence, an intertwining operator in Hom fM△
set I, so this space is one-dimensional.

k

(γψ′, σg) can only map onto fI for the empty
(cid:3)

4. Metaplectic Shalika model for exceptional representations

4.1. Exceptional representations. The exceptional representations were introduced and
studied by Kazhdan and Patterson [KP84], locally and globally. Over a local ﬁeld, the

exceptional representation θn of eGn is the unique irreducible quotient of a principal series

representation corresponding to a genuine character, which is a lift of δ1/4
the notation of § 2.2 θ is a quotient of I(χ) where χ|T 2
[F ∗ : F ∗2] possible lifts of δ1/4
θ2k is unique.

(in
Bn ). When n is odd, there are
, resulting in non-isomorphic representations, but

n = δ1/4

n to C eTn

n to C eTn

Bn |T 2

Bn |T 2

F ∗ (pulled back to Gn via det). Here for simplicity we take this character to be trivial.

Any exceptional representation of eGn can be obtained by twisting θn with a character of

Over a global ﬁeld we denote this representation by Θn, it has an automorphic realization
as the residual representation of an Eisenstein series on Bn(F )\Gn(F ). Abstractly, it is iso-
morphic to the restricted tensor product of local exceptional representations. For a detailed
description of the properties of exceptional representations see [KP84, BG92, Kab01].
Remark 4.1. Over C the group Gn splits under the cover, then the results of Vogan [DAV86,
Lemma 2.4, Corollary 11.6 and Lemma 11.11] show that θ2k is isomorphic to the Stein
complementary series representation IndG2k
). In particular
Qk
it is unitary, its K-types have multiplicity one, and it contains the trivial K-type. In the

) ∼= IndG2k

(δ1/2−1/(2k)

(δ1/2+1/(2k)

Qk

Qk

Qk

to induce from.

4.2. Local metaplectic Shalika model. Let F be a p-adic ﬁeld, n = 2k and θ = θn. In

real case this is not true since θ2k is genuine and eQk does not have any genuine characters
[Kap15a, Theorem 3.1] we proved that θUk,ψ is the one-dimensional representation of eG△

given by

k

ǫs(c△) → ǫγψ,(−1)k (det c),

ǫ ∈ µ2.

In particular θ admits a unique (up to scalar multiplication) metaplectic (ψ(−1)k , ψ)-Shalika
functional and a unique metaplectic Shalika model S (θ, ψ(−1)k , ψ).

Assume all data are unramiﬁed as in § 2.1. Then θ is also unramiﬁed. The unramiﬁed
normalized function S ∈ S (θ, ψ(−1)k , ψ) is the unique function which is identically 1 on
κ(K).
Lemma 4.2. For any λ ∈ Zk
≥,

S (s(tλ)) =(δ1/4

Bn (tλ) λ ∈ 2Zk
+,
otherwise.
0

Proof. In the notation of § 2.2, θ is a quotient of I(χ) where χ = χs = δ1/4
Bn ,

1
4

s =

(n − 1, n − 3, . . . , 3 − n, 1 − n).

This character satisﬁes (3.17). Put ψ′ = ψ̺ with ̺ = (−1)k. On the one hand let lθ be
the metaplectic (ψ′, ψ)-Shalika functional on θ such that S (g) = lθ(θ(g)ϕK,χ). Clearly it
extends to a similar nonzero functional on I(χ).

On the other hand let l be the nonzero metaplectic (ψ′, ψ)-Shalika functional on I(χ),
whose existence was guaranteed by Corollary 3.35. By Theorem 3.10 the functionals lθ and
l are proportional, in particular l is nonzero on ϕK,χ, so that lθ = l(ϕK,χ)−1l and

47

S (g) = l(ϕK,χ)−1l(gϕK,χ),

∀g ∈ eGn.

Looking at the formula of Theorem 3.28 for I(χ) and ϕK,χ, the coeﬃcient corresponding

to w ∈ WSpk takes the form

Q−1 Y{α>0:wα>0}

cα(χ) Y{α∈Σ+

Spk

:wα<0}

yα(χ).

Observe that none of the terms here has a pole, and by deﬁnition for any α ∈ ∆Gn (a simple
root), χ(aα) = q−1 so that cα(χ−1) = 0. Now consider the product of factors yα(χ).
If
wα < 0 for some short root α ∈ Σ+
, yα(χ) = cα(χ)cα(χ−1) = 0. Otherwise if w 6= e, we
must have wαk < 0. But then since

Spk

ǫ̺,k = (−(−1)k, ̟)2(̟, ̟)k−1
(1 + q−1ǫ̺,k)(1 − ǫ̺,k)

yαk(χ) =

2 = 1,

= 0.

1 − q

Therefore all coeﬃcients except the one for w = e vanish and for λ ∈ 2Zk
+,
Bn χ−1(s(tλ)) = Q−1cw0(χ)δ1/4

l(s(tλ)ϕK,χ) = Q−1cw0(χ)δ1/2

Bn (tλ).

We conclude lθ = Qcw0(χ)−1l and the result immediately follows.

(cid:3)

Remark 4.3. The proof implies that l factors through the quotient θ, which is also the image
of the intertwining operator Tw0. Since by (2.6), Tw0ϕK,χ = cw0(χ)ϕK,χ−1, it is natural to
ﬁnd cw0(χ) in the normalization.
Remark 4.4. One could attempt to consider θ as a subrepresentation of I(χ−1). As such, it
contains ϕK,χ−1 and the formula of Theorem 3.28 for (I(χ−1), ϕK,χ−1) may be used. However
unless k = 1, all the coeﬃcients, which now take the form

Q−1 Y{α>0:wα>0}

cα(χ−1) Y{α∈Σ+

Spk

:wα<0}

yα(χ−1),

vanish (if w = w0 and k > 1, yα1(χ−1) = 0). In other words, the functional Λχ vanishes on
θ. This is the phenomena described in Remark 3.34. This also means that the metaplectic
Shalika functional on θ does not extend to I(χ−1).

Now assume F = R. The representation θ is the unique irreducible quotient of a principal
series representation, which satisﬁes the assumptions of Theorem 3.37. Hence the space of
metaplectic Shalika functionals on θ is at most one-dimensional. This remains true over C,
because then the cover is split over Gn and since θ is an irreducible admissible smooth Fr´echet
representation, the bound follows from [AGJ09]. We will prove that the space of metaplectic
Shalika functionals on θ is precisely one-dimensional over both R and C: existence of the
functional will follow from a local–global argument in § 4.3 (Corollary 4.25).

48

EYAL KAPLAN AND JAN M ¨OLLERS

4.3. Fourier coeﬃcients of exceptional representations. Let F be a global ﬁeld and
Θ = Θn. For an automorphic form ϕ in the space of Θ, a unipotent subgroup U, and
a character ψ of U(A) which is trivial on U(F ), let ϕU,ψ be the corresponding Fourier
coeﬃcient, given by

ϕU,ψ(g) = ˆU (F )\U (A)

ϕ(ug)ψ−1(u) du,

g ∈ eGn(A).

(4.1)

These coeﬃcients are related to local twisted Jacquet modules at the ﬁnite places. More
explicitly, if a Fourier coeﬃcient does not vanish identically on Θ, then for each place v < ∞
of F , (Θv)U,ψ 6= 0. Conversely if (Θv)U,ψ = 0 for some v < ∞, the coeﬃcient (4.1) is zero for
any ϕ and g (see e.g., [JR92, Proposition 1]).
Let θ = Θv for some v < ∞. In [Kap15a] we described the twisted Jacquet modules of θ
along the unipotent subgroups Uk. We use these results to deduce several properties of the
Fourier coeﬃcients.

For 0 < k < n, Mk < Gn acts on the set of characters of Uk, with min(k, n− k) + 1 orbits.

We choose representatives

uk−i+1,k+j−i+1),

0 ≤ j ≤ min(k, n − k).

(Here u is regarded as an n × n matrix.) In particular ψ0 is trivial and when n = 2k, ψk is
the Shalika character. For n = 5 and k = 3, say, ψ1(u) = ψ(u3,4) and ψ2(u) = ψ(u3,5 + u2,4).
The stabilizer of ψj in Mk is

ψj(u) = ψ(

jXi=1
Stn,k(ψj) =


b v
c

 : b ∈ Gk−j, c ∈ Gj, d ∈ Gn−k−j

.

c y
d

Let Vj and Yj be the unipotent subgroups of Stn,k(ψj) deﬁned by the coordinates of v and
y. Note that V0 and Y0 are trivial.

The Jacquet module θUk,ψj is a representation of p−1(Stn,k(ψj)). The following theorem

was proved in [Kap15a] (with minor notational diﬀerences):
Theorem 4.5. For any 0 ≤ j ≤ min(k, n − k), the representation θUk,ψj is isomorphic

to δ1/4(θk−je⊗θn−k−j) ⊗ γψ,(−1)j ψj. Here δ is the modulus character of the standard parabolic
subgroup of Gn corresponding to the partition (k−j, 2j, n−k−j); e⊗ is the metaplectic tensor
of Kable [Kab01]; γψ,(−1)j is a genuine character of eG△
representation of eG△

j and γψ,(−1)j ψj is a one-dimensional
⋉ Uj is regarded as a subgroup of the middle block of

is identiﬁed with the coordinates of c).

the partition (G△
j

⋉ Uj, where G△
j

j

This theorem implies in particular that Vj(Fv) and Yj(Fv) act trivially on θUk,ψj , and
when n = 2k = 2j, θ admits a unique metaplectic (ψ(−1)k , ψ)-Shalika model (as mentioned
in § 4.2). The case j = 0 of Theorem 4.5 was already proved by Kable [Kab01, Theorem 5.1],
in this case δ = δQk and the result can be used to read oﬀ the exponents of θ (see the proof
of Theorem 5.1 in § 5.1).
Proposition 4.6. For any ϕ in the space of Θ, 0 < k < n and 0 ≤ j ≤ min(k, n− k), ϕUk,ψj
is trivial on Vj(A) and Yj(A).

49

Proof. Write the Fourier expansion of ϕUk,ψj along Vj(F )\Vj(A). Any coeﬃcient with respect
to a nontrivial character vanishes, because by virtue of Theorem 4.5, at any v < ∞, Vj(Fv)
acts trivially on (Θv)Uk,ψj .

(cid:3)

The next theorem describes the constant term of automorphic forms in the space of Θ,
along any unipotent radical of a standard parabolic subgroup. The constant term deﬁnes an
automorphic representation of the Levi part, and as such, it is often convenient to identify
it with a tensor representation. Unfortunately, this is not simple to do for covering groups
of Gn, because the preimages in the cover, of the direct factors of the Levi part, do not
commute (see e.g., [BG92, Kab01, Tak14]). To avoid this problem, at least to some extent,
we deﬁne exceptional representations of Levi subgroups. This approach was suggested by
Bump and Ginzburg [BG92, § 1], and was perhaps implicit in [Kab01, § 5]. Let ∆ ⊂ ∆Gn
and Q = Q∆ be the corresponding standard parabolic subgroup, Q = M ⋉ U. Let BM < M
be the Borel subgroup such that Bn = BM ⋉U, BM = Tn ⋉NM . Denote by δBM the modulus
character of BM , as a subgroup of M. Also let WM be the Weyl group of M and wM its
longest element.

Consider a local context ﬁrst. A genuine character χ of C eTn

χ(aα) = |q| for all α ∈ ∆ (aα was deﬁned after (2.5)). The representation Ind

lands Quotient Theorem because χ belongs to the positive Weyl chamber in WM . Note that
the Langlands Quotient Theorem was proved for covering groups over p-adic ﬁelds by Ban
and Jantzen [BJ13], and over Archimedean ﬁelds the proof of Borel and Wallach [BW80]

where χ′ is an irreducible genuine representation of eTn corresponding to χ, has a unique
irreducible quotient called an exceptional representation of fM. This follows from the Lang-
is applicable to covering groups. The exceptional representation of fM is isomorphic to the

image of the intertwining operator with respect to wM (over Archimedean ﬁelds this follows
from [BW80], over p-adic ﬁelds one can argue as in [KP84, Theorem I.2.9]).

Globally, we construct exceptional representations as residual representations of Eisenstein
series. The discussion in [KP84, § II] (see also [BFG03, § 3]) can be extended to Levi
subgroups. For s = (s1, . . . , sn) ∈ Cn, put

is called M-exceptional if
χ′),

(δ1/2
BM

fM
eBM

m 7→ Ress=0EBM (m; f, s) = lim

sαEBM (m; f, s).

s→0Yα∈∆

χs(diag(t1, . . . , tn)) =

nYi=1

|ti|si.

We extend χs to a right K-invariant function on M(A) using the Iwasawa decomposition,
χ′), where
and lift it to a function on the cover. Let f be an element of Ind
χ′ corresponds to a global M-exceptional character χ (deﬁned similarly to the local one).

fM (A)
eBM (A)

(δ1/2
BM

Denote by fs the standard section given by fs(m) = χs(m)f (m), m ∈ fM(A). Form the

Eisenstein series

EBM (m; f, s) = Xm0∈BM (F )\M (F )

fs(m0m),

Identify ΣGn with the pairs (i, j), 1 ≤ i 6= j ≤ n, and ∆Gn with the pairs (i, i + 1), 1 ≤ i < n.
For α = (i, j) ∈ ΣGn, put sα = si − sj. The global exceptional representation is spanned by
the functions

m ∈ fM(A).

50

EYAL KAPLAN AND JAN M ¨OLLERS

It is isomorphic to the restricted direct product of local exceptional representations. The
proof is analogous to [KP84, Proposition II.1.2 and Theorems II.1.4 and II.2.1] and [BFG03,
Proposition 3.1 and Theorem 3.2].

Let ΘM (resp., θM,v) be the global (resp., local over Fv) exceptional representation corre-
vΘM,v. In

sponding to a genuine character, which is a lift of δ1/4
particular ΘGn = Θ.

. Then ΘM = ⊗′

n to C eTn

BM|T 2

Remark 4.7. Over a p-adic ﬁeld, the aforementioned result [Kab01, Theorem 5.1] also

exceptional representations of the preimages of the direct factors of M.

We are ready to state the result regarding the constant term of elements of Θ.

implies that an exceptional representation of fM is isomorphic to a metaplectic tensor of
Theorem 4.8. Let ϕ belong to the space of Θ. The function m 7→ ϕU (m) on fM (A) belongs

to the space of δ1/4

Q ΘM .

Remark 4.9. This was proved in [KP84] for Q = Bn.

Remark 4.10. If F is a function ﬁeld, this result follows immediately from the computation
of the Jacquet modules of θ over p-adic ﬁelds in [Kab01, Theorem 5.1].

Remark 4.11. A priori, the constant term does not vanish identically, because it does not
vanish for Nn (this follows from the construction of the exceptional representation in [KP84,
§ II]).
Remark 4.12. Similar results were obtained in [Kap15b] for the small representation of a
cover of SO2n+1 (in the sense of [BFG03]), and in [Kap16] for the analog of this representa-
tion for GSpin2n+1. In the case of SO2n+1, the direct factors of maximal parabolic subgroups
do commute in the cover, so that a more precise result could be obtained. For GSpin2n+1
the direct factors commute only for the maximal parabolic subgroup obtained by removing the
unique short simple root.

Proof. As explained above and keeping the same notation (with M = Gn), we can assume

ϕ(g) = Ress=0EBn(g; f, s),

for some f in the space of Ind

Let W ⊂ W be with Gn =`w∈W Bnw−1Q. For X < Q and w ∈ W, set X w = wBn ∩ X.

Deﬁne

(δ1/2

Bn χ′), where χ′ corresponds to a genuine lift of δ1/4

eGn(A)
eBn(A)

Bn |T 2
n.

(4.2)

(4.3)

fs,w(m) = M(w, χs)fs(m) = ˆU w(F )\U (A)
EM w(fs,w(m)) = Xm0∈M w(F )\M (F )

fs,w(m0m).

fs(w−1um) du,

Here m ∈ fM (A) (although the deﬁnition is valid also on eGn(A)). The intertwining operator

M(w, χs) is in fact deﬁned by the meromorphic continuation of this integral. According to
Mœglin and Waldspurger [MW95, § II.1.7],

Ress=0EM w(fs,w(m)).

(4.4)

ϕU (m) = Xw∈W

51

We can take the representatives W such that for all w ∈ W,

NM < wNn.

(4.5)
Indeed this follows from [BZ77, 2.11] (applied to W Tn,M in their notation, w−1(M∩Bn) < Bn).
Claim 4.13. fs,w is holomorphic at s → 0, except for simple poles in the variables sα with
α ∈ ∆Gn such that wα < 0.
Claim 4.14. EM w(fs,w(m)) is holomorphic at s → 0, except for at most |∆Gn| simple poles.
There are less than |∆Gn| poles unless w = wM w0, in which case m 7→ EM w(fs,w(m)) belongs
to the space of ΘM .

Granted the claims, the result quickly follows: by Claim 4.14, any summand with w 6=
wM w0 vanishes when we take the residue, and we are left with EM wM w0 (fs,wM w0(m)). Since
at most one summand is nonzero, as explained in Remark 4.11 this summand is nonzero for
some data.
(cid:3)

Proof of Claim 4.13. Since f is left-invariant under Nn(A) and U w < Nn, we may rewrite
the integration in (4.2) over U w(A)\U(A). Moreover (4.5) implies
wBn ∩ NM U = wBn ∩ Nn = N w
n ,

NM U w = NM

n \Nn so that we can write the integral in (4.2) over N w

n (A)\Nn(A). Now we
hence U w\U = N w
proceed as in [Kap16, Claim 3.5]. We can assume that f is a pure tensor. At any ﬁnite place,
the local intertwining operator is holomorphic for s in a small neighborhood of 0, because
then the local component of χ′χs belongs to the positive Weyl chamber. Thus the poles are
global, in the sense that they appear in the product of local intertwining operators applied to
the unramiﬁed normalized components of f . Now we use the Gindikin-Karpelevich formula
(2.6) to identify the possible poles.

Let α ∈ Σ+

Gn and assume wα < 0. Recall the function cα(· · · ) (deﬁned before (2.6)). The

poles occur in the products

cα((χ′χs)v) =

ζ(Cα + 2sα)

ζ(Cα + 2sα + 1)

,

Yv

where ζ is the partial Dedekind zeta function of F and 0 < Cα ∈ Z is an integer depending
on χ′. As a function of sα, there is a pole when sα → 0 if and only if Cα = 1, this occurs
precisely when α ∈ ∆Gn. We also deduce that the poles are simple.
Proof of Claim 4.14. The poles of EM w(fs,w(m)) are either poles of fs,w(m), which were
identiﬁed in Claim 4.13, or poles incurred by the summation over M w\M. Because U w\U =
N w
n \Nn, fs,w is an element in the space of
eGn(A)
eBn(A)

w(χ′χs)).

(δ1/2
Bn

Ind

(cid:3)

Then the restriction of fs,w to fM (A) belongs to

δ1/2
Q Ind

fM(A)
eBM (A)

(δ1/2
BM

w(χ′χs)).

Since NM < wBn ∩ M (by (4.5)), BM = wBn ∩ M (w cannot conjugate more positive roots
from Nn into M, because NM is a maximal unipotent subgroup in M). Hence (4.3) is a series
over BM\M. To locate its poles we consider the constant term along NM . Arguing as in

52

EYAL KAPLAN AND JAN M ¨OLLERS

[KP84, Proposition II.1.2], the constant term is a sum of intertwining operators M(ω, χs)fs,w,
where ω varies over WM .

Fix ω and let ΣM (resp., Σ+

M ) be the set of roots (resp., positive roots) spanned by the
roots in ∆. Assumption (4.5) implies that w(χ′χs) belongs to the positive Weyl chamber of
WM (when s → 0). Therefore, as in the proof of Claim 4.13 any pole must be located in a
quotient of ζ functions

cα(w(χ′χs)v) =

ζ(Cw,α + 2sw−1α)

ζ(Cw,α + 2sw−1α + 1)

.

(4.6)

Yv

Here α ∈ Σ+
The quotient has a pole if and only if Cw,α = 1. Since Cα = 1 if and only if α ∈ ∆Gn,

M and ωα < 0; 0 < Cw,α ∈ Z depends on wχ′, speciﬁcally (wχ′)v(aα) = q−Cw,α

v

.

{α ∈ Σ+

M : Cw,α = 1} = {α ∈ ∆Gn : wα ∈ Σ+

M}.

(4.7)

Thus the number of poles of the series is bounded by the size of (4.7). Since the conditions
wα ∈ Σ+
M and wα < 0 are disjoint, the number of poles of EM w(fs,w(m)) is at most |∆Gn|.
The poles of fs,w are simple, they occur in the variables sβ where β > 0 and wβ < 0. A pole
of (4.6) is also simple, it occurs in sw−1α with α > 0, and because w(w−1α) = α > 0, this
pole does not appear in the set of poles of fs,w. Thus the poles of EM w(fs,w(m)) are simple.

Assuming |∆Gn| poles are obtained, we prove w = wM w0. In this case we must have

∆Gn = {α ∈ ∆Gn : wα < 0} ∐ {α ∈ ∆Gn : wα ∈ Σ+

M},

and then (4.5) immediately implies w = wM w0. Since in this case wδBn = δ−1

Q δBM , the
χ′′), where χ′′ corresponds to a lift

restriction of fs,w to fM (A) belongs to δ1/4

n, and the deﬁnition of ΘM implies that

BM|T 2

of δ1/4

Q Ind

fM (A)
eBM (A)

(δ1/2
BM

m 7→ Ress=0EM w(fs,w(m))

belongs to the space of δ1/4

Q ΘM .

(cid:3)

Remark 4.15. Takeda [Tak14, Proposition 2.45] computed the constant term along the
unipotent radical corresponding to the partition (2, . . . , 2), for the twisted exceptional rep-
resentation (his proof does not apply to the non-twisted version, i.e., to our setting). He
developed a generalized Weil representation for the preimage of the Levi part, deﬁned a global
block-compatible cocycle and was able to provide an explicit realization, whose properties we
shall use below (see the proof of Claim 4.24). However, it is not expected that a similar
realization will apply for a general Levi subgroup: the realization of θn as essentially a Weil
representation is only valid for n = 2.

Now we describe the Fourier coeﬃcient along the Shalika unipotent subgroup and charac-

ter. Assume n = 2k. The stabilizer of ψk in Mk is now G△
k .

Claim 4.16. The section s is well deﬁned on G△
k (A) and satisﬁes a global relation similar
to (3.1), with the Hilbert symbol replaced by the product of local Hilbert symbols at all places.
Proof. If g ∈ G△
Hence s is well-deﬁned. The global relation follows from the local one, since s =Qv sv. (cid:3)

k (Ov) and then by Claim 3.18, sv(gv) = κv(gv).

k (A), for almost all v, gv ∈ G△

53

Henceforth we identify G△

k (A) with its image in eGn(A) under s.

Let π be any automorphic representation of eGn(A). We say that l is a global metaplectic
Shalika functional on π, if l satisﬁes the global analog of (3.2), where c ∈ Gk(A), u ∈ Uk(A)
is now the global Weil factor. As in the case of the Whittaker model, we are
and γψ′
interested in concrete realizations of such functionals, e.g., given as integrals. A global
integral for the Shalika model of Gn was studied in [JS90, FJ93], involving an integration
over G△
k (A) × Uk(A). For exceptional representations, we will show that ϕUk,ψk already
satisﬁes the required properties, i.e., the reductive part of the integration is not needed.

Remark 4.17. Beineke and Bump [BB06] also studied, in the non-metaplectic case, local and
global Shalika functionals given solely by unipotent integration, for a speciﬁc representation.
To study the properties of ϕUk,ψk, we ﬁrst relate it to the Fourier coeﬃcient of Θ along Nn

and its degenerate character ψ◦ given by

(called a semi-Whittaker coeﬃcient in [BG92]).

ψ◦(v) =

ψ((−1)k−iv2i−1,2i)

kXi=1

Deﬁne w ∈ Gn(F ) as follows. For all 1 ≤ i ≤ k, it has 1 on the (2i − 1, i)-th coordinate
and (−1)k−i on the (2i, k + i)-th coordinate.
Its other entries are zero. Let V < Uk be
the subgroup obtained from Uk by zeroing all upper diagonal entries except those on rows
i + 1, . . . , k of column k + i, for all 1 ≤ i ≤ k − 1.
Example 4.18. When k = 2,

w =

1

−1

1

1

 ,

V =


1

1 v1
1

1

.




We prove:

Lemma 4.19. For any ϕ in the space of Θ,

ϕUk,ψk(g) = ˆV (A)

ϕNn,ψ◦

(wvg) dv.

Proof. For 0 ≤ l ≤ k− 1, deﬁne U (l) < Nn, a character ψ(l) of U (l)(F )\U (l)(A), w(l) ∈ Gn(F ),
and V (l) < Nn as follows. Let

U (l) =

ψ(l)(u) =

z


lXi=1

x1
Ik−l

x2
u
Ik−l

 : z ∈ N2l

,

ψ((−1)k−iz2i−1,2i)ψ(tr(u)).

Note that ψ(l) is the product of a degenerate character depending only the odd rows of z,
and the Shalika character on the coordinates of u.

The matrix w(l):

for 1 ≤ i ≤ l, has 1 in the (2i − 1, i)-coordinate and (−1)k−i in the
(2i, k + i)-coordinate, and for 1 ≤ i ≤ k − l, has 1 in coordinates (2l + i, l + i) and (k + l +
i, k + l + i), and 0 elsewhere.

54

EYAL KAPLAN AND JAN M ¨OLLERS

The subgroup V (l):

it is obtained from Nn by zeroing all upper diagonal entries except

those in rows i + 1, . . . , k of column k + i, for all 1 ≤ i ≤ l.
Example 4.20. When k = 3,

w(1) =

V (1) =



1 0 0 0 0 0

1

1

1

1

1

1

1

0
v1
1 v2
1

1

1








,

w(2) =

,

V (2) =

0

0

−1

1

1 0 0 0
1

1

1

1

1

0
v1

0
0
1 v2 v3

1

1





,





1

.

In particular U (0) = Uk, ψ(0) = ψk (the Shalika character of Uk), w(0) = In, V (0) = {In};

and U (k−1) = Nn, ψ(k−1) = ψ◦, w(k−1) = w, V (k−1) = V .
Claim 4.21. For any 0 ≤ l ≤ k − 2,
ˆV (l)(A)ˆU (l)(F )\U (l)(A)
= ˆV (l+1)(A)ˆU (l+1)(F )\U (l+1)(A)

ϕ(uw(l)v)(ψ−1)(l)(u) du dv

The lemma follows from the repeated application of this claim.

ϕ(uw(l+1)v)(ψ−1)(l+1)(u) du dv.

(4.8)

(cid:3)

Proof of Claim 4.21. We apply the technique of “exchange of roots”, following Ginzburg
[Gin90] (see also [GRS01, Sou05, GRS11]). Identify Uk−l with the subgroup of U (l) deﬁned
by the coordinates of u. Denote an element of Uk−l by

u1
Ik−l−1 u3
1

u2
u4

Ik−l−1

 .

1

u(u1, u2, u3, u4) =
X =



Ik−l−1

Ik−l

.

1

e

By deﬁnition the restriction of ψ(l) to Uk−l is given by ψ(u1)ψ(tr(u4)). Set
Y = {u(0, 0, u3, 0)} < Uk−l, C = {u(u1, u2, 0, u4)} < Uk−l,

Let U ′ < U (l) be deﬁned by the coordinates of z, x1 and x2, and deﬁne the following function

on eGn(A),

ϕ′(g) = ˆU ′(F )\U ′(A)

ϕ(u′g)(ψ−1)(l)(u′) du′.

55

In particular, ϕ′ is trivial on Uk−l(F ). Since U (l) = U ′ ⋊ Uk−l, the left-hand side of (4.8)
becomes

ˆV (l)(A)ˆUk−l(F )\Uk−l(A)

ϕ′(uw(l)v)(ψ−1)(l)(u) du dv.

(4.9)

According to Ginzburg, Rallis and Soudry [GRS11] (Lemma 7.1, with X, Y and C as

above),

ˆUk−l(F )\Uk−l(A)

ϕ′(u)(ψ−1)(l)(u) du = ˆY (A)ˆCX(F )\CX(A)

ϕ′(uy)(ψ−1)(l)(u) du dy.

(4.10)

Here ψ(l) is extended trivially on X. Put

w′ =

I2l+1

(−1)k−l−1

Ik−l−1

Ik−l−1

 .

(4.11)

Since w′ normalizes U ′ and stabilizes ψ(l)|U ′, we may replace ϕ′ with its left-translate by w′.
The right-hand side of (4.10) becomes

ˆY (A)ˆU ′′(F )\U ′′(A)

ϕ(uw′y)ψ−1(u) du dy,

(4.12)

where

U ′′ = U ′ ⋊ w′

(CX) =

z x1 x2
1 u1
1

x3
e

Ik−l−1

x4
u2

u4

Ik−l−1



: z ∈ N2l

,





m(a, b) =

lXi=1
M ′′′ =

ψ(u) =

ψ((−1)k−iz2i−1,2i)ψ((−1)k−l−1u1)ψ(tr(u4)).
Next we show that the du-integration can be extended to U (l+1).

Let U ′′′ < U ′′ be obtained from U ′′ by zeroing out the coordinates of u4. Deﬁne

I2l+1

1 a

b  : b ∈ G2(k−l−1)

and denote A′′′ = m(a, I2(k−l−1)), B′′′ = m(0, b). The function

g 7→ ˆU ′′′(F )\U ′′′(A)

ϕ(ug)ψ−1(u) du

is well-deﬁned on M ′′′(F )\M ′′′(A). In particular, we can consider its Fourier expansion along
the abelian unipotent subgroup A′′′. There are two orbits under the action of B′′′(F ), the
trivial one and the one corresponding to a character ψ⋆ depending only on the leftmost
coordinate of a. However, for each v < ∞, the Jaquet module (Θv)U ′′′A′′′,ψψ⋆ = 0. To see
this, ﬁrst note that by Theorem 4.5, as a vector space (Θv)U ′′′A′′′,ψψ⋆ is a quotient of

θ2l ⊗ ((θ2(k−l))U1,1,2(k−l−1),ψψ⋆),

56

EYAL KAPLAN AND JAN M ¨OLLERS

where U1,1,2(k−l−1) is the unipotent radical of the standard parabolic subgroup of G2(k−l)
with a Levi part isomorphic to G1 × G1 × G2(k−l−1) (we restricted the Jacquet module to a
representation of the unipotent subgroup to pass from the metaplectic tensor to the standard
one, see [Kab01, Theorem 3.1]). However, by [Kap15a, Lemma 2.8] for any m ≥ 3, (θm)U1,ψ is
(and 2(k − l) ≥ 4),

a quotient of (θm)U2 (where on U1, ψ is given by ψ((cid:0) 1

Im−1(cid:1)) = ψ(z1)). Since ψ⋆ is nontrivial

z

Hence only the trivial character remains and (4.12) becomes

(θ2(k−l))U1,1,2(k−l−1),ψψ⋆ = 0.

ˆY (A)ˆU (l+1)(F )\U (l+1)(A)

ϕ(uw′y)(ψ−1)(l+1)(u) du dy.

(4.13)

Plugging this into the left-hand side of (4.9) and using the fact that

(w(l))−1Y w(l)V (l) = V (l+1),

w′w(l) = w(l+1)

leads to the desired equality.
Theorem 4.22. The mapping ϕ 7→ ϕUk,ψk on the space of Θ(= Θ2k) is nonzero and satisﬁes

(cid:3)

ϕUk,ψk(c△) = γψ,(−1)k (det c)ϕUk,ψk(1),

∀c ∈ Gk(A).

Consequently, Θ admits a global metaplectic Shalika model given by a Fourier coeﬃcient.
Moreover, the functional ϕ 7→ ϕUk,ψk(1) is factorizable.
Proof. We begin with the proof of the formula, the non triviality will be deduced during the
computation. First we show that for c ∈ SLk(A),

ϕUk,ψk(c△) = ϕUk,ψk(1).

(4.14)

To show this, because ϕ is invariant on the left by Gn(F ), it is enough to consider

As in the proof of Proposition 4.6 we consider the Fourier expansion along the abelian sub-
group of matrices c△ with c of this form. The nontrivial coeﬃcients vanish by Theorem 4.5.
This proves (4.14).

It remains to consider c = t = diag(t1, . . . , tk) ∈ Tk. To this end we claim the following.

c =

x ∈ A.

1

0

x
Ik−2 0

1  ,

kYi=l+1
kYl=1

Claim 4.23.

Claim 4.24.

ϕNn,ψ◦

wt =

(tl,

k−1Yl=1

kYi=l+1

ti)2(

ti,

ti)2diag(t1, t1, . . . , tk, tk).

kYi=l+1

(diag(t1, t1, . . . , tk, tk)) =

γψ,(−1)k+1−i(ti)δBk (diag(t1, . . . , tk))ϕ(1).

kYi=l+1

kYi=l+1

kYi=l+1
kYi=l+1

kYi=l+1

kYi=l

kYi=l+1

= (tl,

ti)2γψ,(−1)k+1−l(tl)γψ,(−1)k+1−l(

ti) = γψ,(−1)k+1−l(

ti).

As a corollary, the Fourier coeﬃcient ϕUk,ψk does not vanish identically on the space of Θ.
Indeed, the arguments in Lemma 4.19 can be repeated in “the opposite direction” to relate
ϕNn,ψ◦ to an integration of ϕUk,ψk. The former is nonzero by Claim 4.24, hence ϕUk,ψk cannot
be zero for all ϕ.

57

According to (1.17), for any 1 ≤ l ≤ k − 2,

(tl,

ti)2(

ti,

ti)2γψ,(−1)k+1−l(tl)γψ,(−1)k+1−l+1(

ti)

The conjugation of V by t multiplies the measure by δ−1
Bk
claims yields the result.

(diag(t1, . . . , tk)). Combining the

The assertion regarding factorizability follows from the local uniqueness of the metaplectic
Shalika model at all the local components of Θ (see § 4.2, we only need to know that the
dimension of the space of metaplectic Shalika functionals on Θv is at most one, for all v). (cid:3)

Proof of Claim 4.23. This follows from the local properties of the cocycle of [BLS99]. Specif-
ically, write t in the form diag(t1, t′, t1, t′) ∈ Tn with t′ ∈ Tk−1 and let w′ be given by (4.11)
with l = 0. Using [BLS99] (§ 2 Lemma 2, § 3 Lemmas 3 and 1) we see that

w′

s(t) = σ(w′, t)s(wt) = (t1, det t′)2(det t′, det t′)2s(diag(t1, t1, t′, t′))

= (t1, det t′)2(det t′, det t′)2s(diag(t1, t1, I2n−2))s(diag(I2, t′, t′)).

For l = 1, w′ commutes with s(diag(t1, t1, I2n−2)), and by (1.1) we can apply the same
arguments to compute w′
s(diag(I2, t′, t′)). Since w is a product if elements w′ (with l varying),
we can repeat this for all l = 1, . . . , k − 1 and obtain the result.
(cid:3)
Proof of Claim 4.24. Let Q = M ⋉ U < Gn be the standard parabolic subgroup, whose Levi
part M is isomorphic to k copies of G2. According to Theorem 4.8, the mapping m 7→ ϕU (m)
belongs to the space of δ1/4
Q ΘM . The representation ΘM is isomorphic to the global Weil

representation Π ⊗eϕ−1 constructed by Takeda [Tak14, § 2.3 and p. 204] (this is Πχ ⊗eϕ−1
in his notation with the unitary character χ = 1, see [Tak14, 2.26]). The mapping eϕ was
deﬁned in [Tak14, § A.1, p. 261] to correct a global block-compatibility issue. If m ∈ M(A),
eϕ(m) = mbS(m), where bS =Qv(bS)v(mv) and at each place v,

m = diag(m1, . . . , mk) ∈ M(Fv).

i=1 sv(mi)
sv(m)

P

,

Therefore ϕNn,ψ◦ is the application of a Fourier coeﬃcient corresponding to (NM , ψ◦|NM ), to
an automorphic form in the space of δ1/4

i ) = sv(t). Hence
Q (d) = δBk (diag(t1, . . . , tk)). Lastly, following the deﬁnitions and formulas
from [Tak14, Proposition 2.55 and (2.56)] we see that for any automorphic form φ in the
(cid:3)

For d = diag(t1, t1, . . . , tk, tk), bS(d) = 1 because for all v, Qk
eϕ(d) = d. Also δ1/4
space of Π, φNM ,ψ◦(d) =Qk

Corollary 4.25. Let θ(= θ2k) be an exceptional representation over an Archimedean ﬁeld
(in fact, over any local ﬁeld). Then θ admits a metaplectic (ψ(−1)k , ψ)-Shalika functional.

Q (Π ⊗eϕ−1).

l=1 γψ,(−1)k+1−i(ti)φ(1).

i=1 sv(t△

(bS)v(m) = Qk

58

EYAL KAPLAN AND JAN M ¨OLLERS

Proof. The functional ϕ 7→ ϕUk,ψk(1) deﬁnes a metaplectic (ψ(−1)k , ψ)-Shalika functional on
each of the local pieces of Θ. Now the result follows from Theorem 4.22 and a standard
globalization argument applied to the exceptional representation.
(cid:3)

5. A Godement–Jacquet type integral

5.1. Local theory. Let F be a local ﬁeld and π ∈ Alg Gk be irreducible. Set n = 2k
and θ = θn (θn was deﬁned in § 4.1). Regard Gk as a subgroup of Gn via the embedding
g 7→ diag(g, Ik).
We deﬁne the following local Godement–Jacquet type integral. Let f be a matrix coeﬃ-
cient of π, S ∈ S (θ, ψ(−1)k , ψ), S ′ ∈ S (θ, ψ(−1)k+1, ψ−1) and s ∈ C. Deﬁne
f (g)S (s(g))S ′(s(g))| det g|s−k/2 dg.

Z(f, S , S ′, s) = ˆGk

(5.1)

Note that the actual choice of section s here does not matter, because S and S ′ are both
genuine. Henceforth we omit it from the notation.

Theorem 5.1. Assume F is a p-adic ﬁeld.
(1) The integral (5.1) is absolutely convergent for Re(s) ≫ 0, the domain of convergence
(2) One can choose data (f, S , S ′) such that Z(f, S , S ′, s) is absolutely convergent and

depends only on the representations.

equals 1, for all s.

(3) The integral has a meromorphic continuation to a rational function in C(q−s).
(4) When all data are unramiﬁed,

Z(f, S , S ′, s) =

L(2s, Sym2, π)
L(2s + 1,∧2, π)

.

(5) Assume that π satisﬁes the following condition: if ε is a normalized exponent of π along
a standard parabolic subgroup Q (see § 1.4 for the deﬁnition), then δ1/2
Q |ε| lies in the open
cone spanned by the positive roots in the Levi part of Q. In particular, this condition
holds when π is tempered. Then Z(f, S , S ′, s) is holomorphic at Re(s) = 1/2.

Proof. The ﬁrst three assertions have already been proved in [Kap15a], in a slightly diﬀerent
form. By virtue of Claim 3.2 the integral is bounded by the zeta integral of Godement and
Jacquet,

ˆG

f (g)φ(g)| det|r(g)dg,

where φ ∈ S(Fk×k) is positive and r ∈ R depends only on θ (i.e., not on S and S ′). This
integral is absolutely convergent for r > r0, where r0 is independent of the speciﬁc coeﬃcient
f ([GJ72, p. 30]).

Applying Claim 3.3 to θ, one can choose elements S and S ′ such that the mapping
c (Gk). This implies (2), when

g 7→ S (g)S ′(g) is an arbitrary function in indQn
we take some f which does not vanish at the identity.

(1) ∼= C ∞

G△

k Uk

We turn to the meromorphic continuation. For a, b ∈ Gk, put m = diag(a, b) ∈ Mk. Then

for any g ∈ Gk,

S (gm)S ′(gm) =(S S ′)(diag(g, Ik)m)

= γψ(det b)γ−1
= (S S ′)(b−1ga).

ψ (det b)(S S ′)(diag(b−1ga, Ik))

Additionally for u ∈ Uk,

S (gu)S ′(gu) = ψ(gu)ψ−1(gu)(S S ′)(g) = (S S ′)(g).

Hence in its domain of absolute convergence (5.1) satisﬁes

Z(mf, muS , muS ′, s) = δ1/2−s/k

Qk

(m)Z(f, S , S ′, s).

Therefore it is a nonzero element of

HomMk ((θ ⊗ θ′)Uk, δ1/2

Qk | det|−sπ∨ ⊗ | det|sπ).

In [Kap15a, Claim 4.6] we proved that this space is at most one-dimensional, outside of a
ﬁnite set of values of q−s. We mention that the proof utilized the structure of the twisted
Jacquet modules of θ along Uk.

Now the one-dimensionality result combined with the ﬁrst two assertions imply (3), by

virtue of Bernstein’s continuation principle (in [Ban98]).

Assume all data are unramiﬁed. We prove (4). The function f is bi-Gk(O)-invariant and

by Claim 3.27 (1), for any k1, k2 ∈ Gk(O),

(S S ′)(k1gk2) = (S S ′)(g).

59

(5.2)

Note that on its own, S is not bi-κ(Gk(O))-invariant because elements of κ(diag(Ik, Gk(O)))

and s(diag(Gk, Ik)) do not commute in eGn. Nonetheless, the integrand is bi-Gk(O)-invariant.
Hence we can write (5.1) using the Cartan decomposition`λ∈Zk
implies that the integrand vanishes unless λ ∈ 2Zk
Let tπ ∈ Gk(C) be the Satake parameters of π. For λ ∈ Zk
[Mac95, Chapter V § 2 (2.9) and § 3 (3.4)] (f (̟λ) is ωs(π−λ) in his notation) show

+ (see § 3.3 for the notation).

+, the formulas of Macdonald

Gk(O)̟λGk(O) and Lemma 4.2

≥

f (̟λ) = vol(Gk(O)̟λGk(O))−1δ−1/2

Bk

(̟λ)Pλ(tπ; q−1).

Here Pλ is the Hall-Littlewood polynomial in the Satake parameters, see [Mac95, Chapter
III § 2] for the deﬁnition. Using Lemma 4.2 and δ1/2
(̟λ), the integral
becomes

Bn (tλ)| det ̟λ|−k/2 = δ1/2

Bk

Xλ∈2Zk

+

Pλ(tπ; q−1)q−|λ|s,

|λ| = λ1 + . . . + λk.

Since Pλ(tπ; q−1)q−|λ|s = Pλ(tπ| det |s; q−1), the required formula follows immediately from the
formal identity of [Mac95, Chapter III § 5, example 2]:

Xλ∈2Zk

+

Pλ(x1, . . . , xk; r) = Qi<j(1 − rxixj)
Qi≤j(1 − xixj)

.

Finally consider (5). Assume π satisﬁes the assumption on the exponents. We prove that
the integral is absolutely convergent, uniformly on compact sets, if r = Re(s) ≥ 1/2 − ǫ0,
for some ǫ0 > 0 (depending on the exponents of π). Let ∆ ⊂ ∆Gk and P = P∆ be the
corresponding standard parabolic subgroup, P = M ⋉ U. Let ζ > 0. Let C +
M be the set
of ̟λ ∈ CM such that |α(t)| < ζ for all α ∈ ∆Gk−∆. Let K be a principal congruence
subgroup on which the integrand is bi-K. For the proof of convergence, we may replace K

60

EYAL KAPLAN AND JAN M ¨OLLERS

in the Cartan decomposition with K, and we see that it is enough to prove the convergence
of the following sum, for each ∆,

X̟λ∈C+

M

|f S S ′δ−1

Bk|(̟λ)q−|λ|(r−k/2).

Here the modulus character δ−1
Bk

is bounding vol(K̟λK).

This sum can be bounded using the exponents of the representations. Let P ∧ be the
standard parabolic subgroup of Gn, whose Levi part is isomorphic to M × Gk. According to
[JR96, Lemma 6.2], if ζ is suﬃciently small with respect to ϕ, S is bounded on C +
M by the
exponents of θ along P ∧. Kable proved that the normalized Jacquet module of θ along the
unipotent radical of P ∧ is an irreducible representation with a central character ω such that
[Kab01, Theorem 5.1]. The normalized exponent of θ along P ∧ is thus δ−1/4
|ω| = δ−1/4
P ∧ .
Since on CM , | det|−k/4δ−1/4
(on the right-hand side CM is embedded in M), we
obtain (up to a constant)

= δ−1/4

P ∧

P ∧

Bk

X̟λ∈C+

M

|δ−1/2

Bk

f|(̟λ)q−|λ|r.

This is bounded in the proper right half-plane, given our assumption on π.

(cid:3)

Remark 5.2. As we have seen in the proof, the local zeta integral can be regarded as an
element of (5.2), which according to [Kap15a, Claim 4.6] is at most one-dimensional, outside
of a ﬁnite set of values of q−s. This is the uniqueness property underlying the standard
deﬁnition of the local gamma factor of Rankin–Selberg integrals. One typically considers a
“similar zeta integral”, absolutely convergent in a left half-plane, which also belongs to (5.2),
then the proportionality factor between these integrals is the gamma factor. The problem is
to ﬁnd the similar integral. It should be related to a global construction, because the product
of local gamma factors, over all places (including the Archimedean ones) should be 1, and
this usually follows from a global functional equation.

Theorem 5.3. Assume F is an Archimedean ﬁeld.
(1) The integral (5.1) is absolutely convergent for Re(s) ≫ 0, the domain of convergence
(2) For each r > 0 one can choose data (f, S , S ′) such that Z(f, S , S ′, s) is absolutely

depends only on the representations.

(3) For ﬁxed (f, S , S ′) the function Z(f, S , S ′, s) has a meromorphic continuation in

convergent and nonzero for s in the strip {s ∈ C : | Im(s)| ≤ r}.
s ∈ C.

Proof. As in the p-adic case, by Claim 3.2 the convergence is reduced to the convergence of
a Godement–Jacquet type integral, which was proved in [GJ72, Theorem 8.7].

Consider (2). Let f be a matrix coeﬃcient with f (Ik) = 1. We choose a compact
neighborhood V of the identity in Gk, such that both f and | det|s−k/2 take values in
{z ∈ C : arg(z) < π/8}, on V and whenever | Im(s)| ≤ r. We will show that, possibly
taking a smaller V, one can choose S and S ′ such that S S ′(g) is supported in V, is
equal to 1 at the identity, and takes values in {arg(z) < π/4}. We see that the integrand
is supported in V, equals 1 at the identity, and in its support takes values in {Re(z) > 0},
for | Im(s)| ≤ r. Hence, the corresponding integral over Gk converges for any such s and is
nonzero.

To ﬁnd S and S ′ with the above properties, we imitate the argument used in the proof
of Claim 3.3. In fact, this argument shows that for any ϕ in the representation space of θ

61

such that Sϕ(s(In)) = 1, then possibly making V smaller we can achieve that Sϕ(dg) takes
in V, then put S = Sθ(φ)ϕ. The function S ′ is chosen similarly.

and any φ ∈ S(Fk×k), Sθ(φ)ϕ(dg) = bφ(g)Sϕ(dg), where dg = s(diag(g, Ik)). We choose ϕ
values in {arg(z) < π/8} for g ∈ V. We take φ such that bφ ≥ 0, φ(Ik) = 1, and has support
sumPj

Now we prove (3). As explained in the proof of Claim 3.2, we may replace S by a ﬁnite
Sjφj with metaplectic Shalika functions Sj and φj ∈ S(Fk×k). Hence it is enough

to prove meromorphic continuation for an integral of the form

ˆGk

f (g)S S ′(g)φ(g)| det(g)|s−k/2 dg,

φ ∈ S(Fk×k).

We use the integration formula

ˆGk

ϑ(g) dg = ˆK ˆK ˆRˆRk−1

>0

ϑ(k1axk2)J(x) d(x1, . . . , xk−1) dxk dk1 dk2,

where K is the maximal compact subgroup of Gk (the orthogonal group over R, the unitary
group if F = C) and for x = (x1, . . . , xk) ∈ Rk,

ax = diag(e−(x1+···+xk), e−(x2+···+xk), . . . , e−xk),

J(x) = Y1≤i<j≤k

sinh (xi + · · · + xj−1) ,

for F = R, and J(x) has to be replaced by J(x)2 if F = C. Since J(x) is a ﬁnite sum of
terms of the form ep·x′ with p ∈ Zk−1 and x′ = (x1, . . . , xk−1), it suﬃces to show that every
integral of the form

ˆK ˆK ˆRˆRk−1

>0

f S S ′φ(k1axk2)e−(s+s1)x1e−(2s+s2)x2 · · · e−(ks+sk)xkd(· · · )

(5.3)

with s1, . . . , sk ∈ R (coming from the exponent k/2 in | det(g)|s−k/2 and from ep·x′) converges
absolutely for Re(s) ≫ 0 and extends to a meromorphic function in s ∈ C.
Note that f (g) = ξ∨(π(g)ξ) for some ξ ∈ V and ξ∨ ∈ V ∨, where V is the space of π, so
that

f (k1axk2) = π∨(k−1

1 )ξ∨(π(ax)π(k2)ξ).

Also k1 7→ π∨(k−1
1 )ξ∨ and k2 7→ π(k2)ξ are smooth. Hence Theorem 1.1 can be applied
with π∨(k−1
1 )ξ∨ instead of ξ∨ and π(k2)ξ instead of ξ. Furthermore S (resp. S ′) is of the
form S (g) = l(θ(g)ϕ) (resp. S ′(g) = l′(θ(g)ϕ′)) with ϕ (resp. ϕ′) in the space of θ and a
metaplectic Shalika functional l (resp. l′). Then (3.2) implies

S S ′(k1axk2) = S S ′(axdiag(k2, k−1

1 )),

and we can apply Theorem 3.5 with θ(s(diag(k2, k−1

1 )))ϕ instead of ϕ (similarly for ϕ′).

We split the dxk-integration in (5.3) into xk ≥ 0 and xk ≤ 0. First assume xk ≥ 0. By the
above considerations and Theorems 1.1 and 3.5, f S S ′(k1axk2) can be written as a ﬁnite
sum of terms of the form

c(xI; k1, k2)xα

I e−z·xI

ˆK ˆK ˆRk

>0

c(xI; k1, k2)xα

Substitute yj = e−xj and obtain

ˆK ˆK ˆ 1

0 · · ·ˆ 1

0

c′(yI; k1, k2)(cid:16)Yj∈I
|c′(yI; k1, k2)| ≤ CyDI

I

,

e−(js+sj)xj(cid:17)d(· · · ).

I e−z·xI φ(k1axk2)(cid:16) kYj=1
logαj yj(cid:17)(cid:16)Yj /∈I

yjs+sj+zj
j

yjs+sj
j

(cid:17)φ(k1byk2) d(· · · ),

where by = diag(y1 · · · yk, y2 · · · yk, . . . , yk) and c′(e−xI ; k1, k2) = c(xI ; k1, k2) satisﬁes

∀yI ∈ (0, 1)I, k1, k2 ∈ K.

62

EYAL KAPLAN AND JAN M ¨OLLERS

where I ⊂ {1, . . . , k}, α ∈ NI, z ∈ CI with Re zj ≥ Λj = Λπ,j + Λθ,j + Λθ′,j for all j ∈ I (see
(1.3) for the deﬁnition of Λπ,j), and c(xI; k1, k2) is smooth in xI, k1 and k2, and satisﬁes

|c(xI; k1, k2)| ≤ Ce−DI ·xI ,

∀xI ∈ RI

>0, k1, k2 ∈ K.

Here the numbers Dj ∈ R can be chosen arbitrarily large. The resulting integral is

The function φ(k1byk2) together with all its y-derivatives is bounded for all k1, k2 ∈ K and
y1, . . . , yk ∈ (0, 1). Hence, the integral
Bc′(y) = ˆK ˆK

c′(yI; k1, k2)φ(k1byk2) dk1 dk2

converges absolutely and deﬁnes a smooth function in y1, . . . , yk ∈ (0, 1) such that for all
diﬀerential operators D in yI with constant coeﬃcients we have
∀y ∈ (0, 1)k.

,

This implies that the integral

I

|DBc′(y)| ≤ CDyMI
Bc′(y)(cid:16)Yj∈I

yjs+sj+zj
j

ˆ 1
0 · · ·ˆ 1

0

logαj yj(cid:17)(cid:16)Yj /∈I

yjs+sj
j

(cid:17)dy1 · · · dyk

j

j

j

≥ − Re zj+sj +1
for j /∈ I. By the usual technique writing (s + 1)ys = d

converges absolutely whenever Re s > − Re Λj+sj+1
for j ∈ I and Re s >
− Dj +sj+1
dy ys+1 and integrating by
parts it is easy to see that the integral further extends to a meromorphic function in the
region where Re s > − Dj +sj+1
for j /∈ I (the region where the integrals over yI always con-
verge absolutely). Since the Dj can be chosen arbitrarily large, this shows the meromorphic
extension to s ∈ C.
Now assume xk ≤ 0. Let x′ = (x1, . . . , xk−1, 0) with x1, . . . , xk−1 ≥ 0 and xk ≤ 0. By
Theorems 1.1 and 3.5 and Remark 3.6 the product f S S ′(k1axk2) can be written as a ﬁnite
sum of terms of the form

j

c(x′

J , xk; k1, k2)(x′

J )αe−z′·x′

J

where J ⊂ {1, . . . , k − 1}, J = {1, . . . , k − 1}−J, α ∈ NJ , z′ ∈ CJ with Re z′
Λπ,j + Λθ,j + Λθ′,j for all j ∈ J, and c(x′
satisﬁes

J , xk; k1, k2) is smooth in x′

j ≥ Λj =
J , xk, k1 and k2, and

|c(x′

J , xk; k1, k2)| ≤ Ce−D′

J

·x′

J e−N xk,

∀xI ∈ RI

>0, xk ≤ 0, k1, k2 ∈ K.

j ∈ R can be chosen arbitrarily large and N ∈ R depends on D′

j. The

Here the numbers D′
resulting integral is

J φ(k1axk2)(cid:16) kYj=1

63

e−(js+sj)xj(cid:17) d(· · · ).

ˆK ˆK ˆ 0

−∞ˆRk−1

>0

c(x′

J , xk; k1, k2)(x′

J )αe−z′·x′

Again substitute yj = e−xj and obtain

1 ˆ 1

0 · · ·ˆ 1
logαj yj(cid:17)(cid:16)Yj /∈J
where by = diag(y1 · · · yk, y2 · · · yk, . . . , yk) and c′(e−x′

ˆK ˆK ˆ ∞
×(cid:16)Yj∈J

yjs+sj+zj
j

c′(y′

0

J , yk; k1, k2)

yjs+sj
j

(cid:17)φ(k1byk2) d(· · · ),

J , e−xk; k1, k2) = c(x′

J , xk; k1, k2) satisﬁes

|c′(y′

J , yk; k1, k2)| ≤ C(y′

J)D′

J yN
k ,

∀y′

J ∈ (0, 1)J, yk ∈ (1,∞), k1, k2 ∈ K.

Note that yk is a single coordinate in by and φ ∈ S(Fk×k). This implies that the function
φ(k1byk2) together with all its y′-derivatives is bounded by a constant times y−L
k with L ∈ R
arbitrarily large. Then Bc′(y) (deﬁned as above) converges absolutely and deﬁnes a smooth
function in y1, . . . , yk−1 ∈ (0, 1), yk ∈ (1,∞) such that for all diﬀerential operators D in y′
with constant coeﬃcients we have
|DBc′(y)| ≤ CD(y′
ˆ ∞
1 ˆ 1

∀y′ ∈ (0, 1)k−1, yk ∈ (1,∞).
(cid:17) d(· · · )

This implies that the integral

Bc′(y)(cid:16)Yj∈J

0 · · ·ˆ 1

yjs+sj+zj
j

yjs+sj
j

J yN −L

J )D′

converges absolutely whenever Re s > − Re Λj +sj+1
for j ∈ J and Re s < L−N −sk−1
and we can proceed as before.

for j ∈ J, Re s > − Dj +sj+1
. Since L is arbitrarily large the last condition is superﬂuous
(cid:3)

k

,

logαj yj(cid:17)(cid:16)Yj /∈J
≥ − Re zj +sj+1

j

J

k

0

j

j

5.2. Global theory. Let F be a global ﬁeld. Let π be a cuspidal (irreducible) automorphic
representation of Gk(A). We construct a global integral representation.

Put n = 2k and let ϕ and ϕ′ be a pair of automorphic forms belonging to the space of

the global exceptional representation Θ of eGn(A) (deﬁned in § 4.1). The Fourier coeﬃcient
ϕUk,ψk(g) is a global Shalika functional on Θ. By restriction it is a function on fGk(A), where
Gk is embedded in Gn in the top left block of Mk. Then g 7→ ϕUk,ψk(g)ϕ′Uk,ψ−1
deﬁned on Gk(A) and trivial on Gk(F ).
Let f be a matrix coeﬃcient of π, i.e.,

k (g) is well

f (g) = ˆCGk (A)Gk(F )\Gk(A)

v(hg)v∨(h) dh,

where v (resp. v∨) is a cusp form in the space of π (resp. π∨). Also let s ∈ C. Consider the
integral

Z(f, ϕUk,ψk, ϕ′Uk,ψ−1

k , s) = ˆGk(A)

f (g)ϕUk,ψk(g)ϕ′Uk,ψ−1

k (g)| det g|s−k/2 dg.

(5.4)

Theorem 5.4. The integral Z(f, ϕUk,ψk, ϕ′Uk,ψ−1
(1) It is absolutely convergent for Re(s) ≫ 0.

k , s) satisﬁes the following properties.

64

EYAL KAPLAN AND JAN M ¨OLLERS

(2) For factorizable data f =Qv fv, ϕ and ϕ′, write ϕUk,ψk =Qv

In the domain of absolute convergence, the integral is equal to a product

Sv and ϕ′Uk,ψ−1

k =Qv

S ′
v.

Moreover, for any suﬃciently large ﬁnite set of places S of F ,

Z(f, ϕUk,ψk, ϕ′Uk,ψ−1

Z(fv, Sv, S ′

v, s)

LS(2s, Sym2, π)
LS(2s + 1,∧2, π)

.

Z(fv, Sv, S ′

v, s).

Yv
k , s) =Yv∈S

(3) For a suitable choice of data, the integral is not identically zero (as a function of s).
(4) It admits a meromorphic continuation to the complex plane.

Proof. We merely have to establish convergence: the integral is Eulerian by virtue of The-
orem 4.22; the other properties follow immediately from the corresponding local results of
Theorems 5.1 and 5.3, and the properties of LS(s, Sym2, π) and LS(s,∧2, π).

As in [GJ72, § 12], ﬁrst we show that for r ≫ 0,

ˆGk(A) |ϕUk,ψk(g)ϕ′Uk,ψ−1

k (g)| · | det g|r−k/2 dg < ∞.

(5.5)

This implies the absolute convergence of Z(f, ϕUk,ψk, ϕ′Uk,ψ−1
k , s), because |f (g)| ≤ Cf| det g|r0
for some Cf > 0 independent of g, and a ﬁxed r0 depending only on π (when π is unitary,
r0 = 0). It is enough to consider factorizable data ϕ and ϕ′. Then we need to bound

ˆGk(Fv) |Sv(g)S ′

v(g)| · | det g|r−k/2

v

dvg.

(5.6)

Yv

At any v, the integral is ﬁnite by Theorem 5.1 (1) and Theorem 5.3 (1). Let S be a ﬁnite
set of places such that for v /∈ S, all data are unramiﬁed. Arguing as in the proof of
Theorem 5.1 (4), for v /∈ S,

v(g)| · | det g|r−k/2

v

vol(Gk(Ov)̟λ

v Gk(Ov))δ1/2

Bk

(̟λ

v )q−|λ|r

v

.

dvg = Xλ∈2Zk

+

ˆGk(Fv) |Sv(g)S ′
Since vol(Gk(Ov)̟λ

v ), this sum is bounded by

Bk

(̟λ

v Gk(Ov)) ≤ δ−1
kYi=1
(1 − q−2r−2i+k+1

v

)−1.

According to Weil [Wei95, Chapter VII § 1, Proposition 1] the product of these factors over
all the ﬁnite places of F is ﬁnite for r ≥ (k + 1)/2, and then
v(g)| · | det g|r−k/2

ˆGk(Fv) |Sv(g)S ′

dg < ∞.

v

Yv /∈S

Therefore (5.6) is ﬁnite, when we take r ≫ (k + 1)/2 to guarantee the convergence of the
integrals also at v ∈ S.

(cid:3)

The next theorem will be used in § 6 to compute the co-period. It relies on the following

assumption on π and Θ.

65

Assumption 5.5. At each Archimedean place v of F , there is a neighborhood of 1/2 such
that the local zeta integral is holomorphic for all data, i.e., matrix coeﬃcients of πv and local
metaplectic Shalika functions.

As we show in the proof below, if π is unitary with a trivial central character, the analogous
assumption at p-adic places is valid. This gap will probably be closed once the exponents
of θn are determined over Archimedean ﬁelds; for n = 2 this can be done directly using the
realization of θ2 as a Weil representation and the assumption holds.

Theorem 5.6. Assume that π is unitary with a trivial central character, and Assumption 5.5
holds.
(1) The global integral has a pole at s = 1/2 if and only if LS(s, Sym2, π) has a pole at s = 1.
(2) For any data (f, ϕUk,ψk, ϕ′Uk,ψ−1
k ), there is a punctured neighborhood around 1/2 such
k , s) is holomorphic for all k ∈ K and s in this

that the integral Z(kf, kϕUk,ψk, kϕ′Uk,ψ−1
neighborhood.

Proof. The ﬁrst part follows from Theorem 5.4 (2), assuming we can control the integrals at
the places in S. One can choose data, for which these do not contribute poles or zeros in a
neighborhood of 1/2, by Theorem 5.1 (2) and Theorem 5.3 (2). Hence if LS(s, Sym2, π) has
a pole at s = 1, the integral will have a pole at s = 1/2, for some choice of data. In the other
direction, we need to show that the integrals at the places of S cannot contribute any pole.
At Archimedean places this is guaranteed by Assumption 5.5. At a p-adic place v ∈ S we
can use Theorem 5.1 (5): since πv is a local component of a unitary cuspidal automorphic
representation of Gk(A), it satisﬁes the prescribed condition on the exponents, by virtue
of the results of Luo, Rudnick and Sarnak [LRS99] towards Ramanujan type bounds (see
[CKPSS04, p. 221]).

For the second part, ﬁrst note that if f is a pure tensor, k-translations leave most of its
components unchanged. The global partial L-functions are meromorphic, so one can ﬁnd a
punctured neighborhood of 1/2 where their quotient is holomorphic, and we only have to
deal with a ﬁnite number of local integrals. At the Archimedean places we again resort to
Assumption 5.5. For the remaining p-adic places we use Theorem 5.1 (5) and its proof, to
choose a neighborhood of 1/2 depending only on the exponents of πv, at which the local
integrals are holomorphic.
(cid:3)

Remark 5.7. We mention that over a function ﬁeld Laﬀorgue [Laf02a, Laf02b] (following
[Dri80, Dri88]) proved the Generalized Ramanujan Conjecture for Gk(A), so πv is already
tempered.

6. The co-period

6.1. The co-period integral. Let F be a global ﬁeld and π be a cuspidal self-dual auto-
morphic representation of Gk(A) with a trivial central character. Put n = 2k and denote
by A+ the subgroup of id`eles of F whose ﬁnite components are trivial and Archimedean
components are equal and positive.

Let ρ be a smooth complex-valued function on Gn(A) × Mk(A) satisfying the following
for g ∈ Gn(A), the function g 7→ ρ(g, In) is right K-ﬁnite; for any m, m1 ∈
properties:
Mk(A) and u ∈ Uk(A), ρ(mug, m1) = δ1/2
(m)ρ(g, m1m); and the function m 7→ ρ(g, m) is
a cusp form in the space of π ⊗ π∨. The standard section corresponding to ρ is deﬁned by

Qk

66

EYAL KAPLAN AND JAN M ¨OLLERS

ρs(muk, m1) = δs/k
Qk
the space of

(m)ρ(muk, m1), for any k ∈ K and s ∈ C. The function ρs belongs to

IndGn(A)

Qk(A)(δ1/2+s/k

Qk

π ⊗ π∨).

For simplicity, denote ρs(g) = ρs(g, In). Form the Eisenstein series

E(g; ρ, s) = Xg0∈Qk(F )\Gn(F )

ρs(g0g),

g ∈ Gn(A).

Let E1/2(g; ρ) = Ress=1/2E(g; ρ, s) denote the residue of the series at s = 1/2. The residue
here is in the sense lims→1/2(s − 1/2)E(g; ρ, s). If we let ρ vary, then E1/2(g; ρ) is nontrivial
if and only if L(π × π, s) has a pole at s = 1; equivalently, LS(π × π, s) has a pole at s = 1
for any suﬃciently large ﬁnite set of places S ([JS81, 1.5 and 3.16]).
Also let ϕ and ϕ′ be a pair of automorphic forms belonging to the space of the global
Gn(A)).
The function g 7→ ϕ(g)ϕ′(g) is well deﬁned and moreover, it is left-invariant on a subgroup
k (A) (see
C ′ < CGn(A) of ﬁnite index, which contains C 2
[BG92, pp. 159-160]). Speciﬁcally, let S′ be a ﬁnite set of places of F such that for all v /∈ S′,
g 7→ ϕ(g)ϕ′(g) is right Kv-invariant, then

exceptional representation Θ of eGn(A). The central character of Θ is trivial on s(C 2

Gn(A) and is also contained in G△

C ′ = {zIn : z ∈ F ∗A∗2Yv /∈S′ O∗

v}.

The global co-period integral is

CP (E1/2(· ; ρ), ϕ, ϕ′) = ˆC ′G(F )\G(A)

E1/2(g; ρ)ϕ(g)ϕ′(g) dg.

(6.1)

This integral was deﬁned by Shunsuke Yamana and the ﬁrst named author (albeit using a
slightly diﬀerent quotient for the integration domain). One may replace E1/2(· ; ρ) with any
complex-valued function on the quotient, such that the integral is absolutely convergent. As
long as ϕ and ϕ′ are ﬁxed, this does not change the integration domain (in particular, e.g.,
the co-period is a linear function in the ﬁrst variable).

Exactly as in [Kap15b], since the cuspidal support of E1/2(· ; ρ) is δ−1/(2k)

π ⊗ π∨ and the
[KP84, Proposition II.1.2, Theorems II.1.4 and II.2.1],

only cuspidal exponent of Θ is δ−1/4
and using [MW95, Lemma I.4.1], one proves the following claim:

Qk

Bn

Claim 6.1. Integral (6.1) is absolutely convergent.

For the function ρ, and with C ′ selected as described above (depending on ϕ and ϕ′) deﬁne

fρ(g) = ˆC ′G△

k (F )\G△

k (A)

ρ(In, c diag(g, Ik)) dc,

g ∈ Gk(A).

As noted above, C ′ < G△
k (A). Then fρ is a matrix coeﬃcient of π. Since the integrand is
left-invariant on CGn(A), taking a diﬀerent C ′ only multiplies fρ by some nonzero constant.

Theorem 6.2. Assume F is a function ﬁeld or Assumption 5.5 holds. The co-period (6.1)
satisﬁes the following properties.

(1) CP (E1/2(· ; ρ), ϕ, ϕ′) = ´K Ress=1/2Z(fkρ, kϕUk,ψk, kϕ′Uk,ψ−1

k , s) dk.

(2) It is nonzero for some choice of data (ρ, ϕ, ϕ′) if and only if

Ress=1/2Z(fρ1, ϕUk,ψk

1

, ϕ′
1

Uk,ψ−1

k , s)

67

does not vanish for some matrix coeﬃcient fρ1 of π and automorphic forms ϕ1, ϕ′
space of Θ.

1 in the

(3) The co-period is nonzero if and only if LS(s, Sym2, π) has a pole at s = 1.

Remark 6.3. Part (3) was obtained by Shunsuke Yamana and the ﬁrst named author, it is
included here because we can also deduce it from Theorem 5.6.

Proof. We apply the truncation operator of Arthur [Art80, Art78] to E(g; ρ, s) as in, e.g.,
[JR92, Jia98, GRS99b, GJR01, Kap15b]. For a real number d > 1, let ch>d : R>0 → {0, 1}
be the characteristic function of R>d and set ch≤d = 1− ch>d. Also extend δQk to Gn(A) via
the Iwasawa decomposition. The truncation operator is given by

ΛdE(g; ρ, s) = E(g; ρ, s) − Xg0∈Qk(F )\Gn(F )

EUk(g0g; ρ, s)ch>d(δQk(g0g)),

where EUk is the constant term of the series along Uk. Since π is cuspidal, EUk (g; ρ, s) =
ρs(g) + M(w, s)ρs(g). Here M(w, s) is the global intertwining operator corresponding to a
Weyl element w taking Uk to U −

k . Write

1 (g; s) − E d
an equality between meromorphic functions in s, where

2 (g; s),

ΛdE(g; ρ, s) = E d
1 (g; s) = Xg0∈Qk(F )\Gn(F )
E d
2 (g; s) = Xg0∈Qk(F )\Gn(F )
E d

ρs(g0g)ch≤d(δQk(g0g)),

M(w, s)ρs(g0g)ch>d(δQk(g0g)).

Claim 6.4. Fix d > 1. The integral obtained from (6.1) by replacing E1/2(· ; ρ) with E d
j (· ; s)
and taking the absolute value of ρs (M(w, s)ρs for j = 2), ϕ and ϕ′, is ﬁnite for Re(s) ≫ 0.
It follows that for ﬁxed d > 1 and Re(s) ≫ 0, CP (ΛdE(· ; ρ, s), ϕ, ϕ′) is absolutely con-

vergent and

CP (ΛdE(· ; ρ, s), ϕ, ϕ′) = CP (E d

1 (· ; s), ϕ, ϕ′) − CP (E d

2 (· ; s), ϕ, ϕ′).

(6.2)

The heart of the argument is in the following result.
j (· ; s), ϕ, ϕ′) admit
Proposition 6.5. Assume d is suﬃciently large. The integrals CP (E d
meromorphic continuation to the plane. There exist complex-valued functions α0(s), α1(s, d),
α2(s) and α3(d, s) such that

CP (E d
CP (E d

1 (· ; s), ϕ, ϕ′) =
2 (· ; s), ϕ, ϕ′) =

ds/k
sk
d−s/k
sk

α0(s) + α1(d, s),

α2(s) + α3(d, s).

The function α0(s) is entire; for j > 0 the functions αj(· · · ) are meromorphic in s (for ﬁxed
d if j = 1, 3);

Ress=1/2α1(d, s) = ˆK

Ress=1/2Z(fkρ, kϕUk,ψk, kϕ′Uk,ψ−1

k , s) dk,

68

EYAL KAPLAN AND JAN M ¨OLLERS

α2(s) has at most a simple pole at s = 1/2, and

lim
d→∞

Ress=1/2α3(d, s) = 0.

Furthermore, when F is a number ﬁeld, α0(s) = α0 is a constant, and if F is a function
ﬁeld, we in fact have CP (E d

2 (· ; s), ϕ, ϕ′) = 0.

Exactly as argued in [Kap15b, pp. 14-15], the properties of the truncated series imply that

when we take the residue in (6.2),

CP (ΛdE1/2(· ; ρ), ϕ, ϕ′) = Ress=1/2CP (E d

1 (· ; s), ϕ, ϕ′) − Ress=1/2CP (E d

2 (· ; s), ϕ, ϕ′).

According to Labesse and Waldspurger [LW13, Proposition 4.3.3], ΛdE1/2(g; ρ) is bounded
by a sum E1/2(g; ρ) + ϑ(g, d; ρ), where ϑ(g, c; ρ) is uniformly rapidly decreasing in d and
rapidly decreasing in g. Since |ΛdE(· ; ρ, s)| ≤ |E(· ; ρ, s)|, Claim 6.1 and the Dominated
Convergence Theorem imply that we can take the limit d → ∞ under the integral sign on
the left-hand side of the last equality. Then according to the proposition,
Ress=1/2Z(fkρ, kϕUk,ψk, kϕ′Uk,ψ−1

k , s) dk.

CP (E1/2(· ; ρ), ϕ, ϕ′) = ˆK

This completes part (1) of the theorem.

The dk-integral has a pole at s = 1/2 for some choice of data (ρ, ϕ, ϕ′) if and only if
Ress=1/2Z(· · · ) 6= 0, for some choice of data (fρ1, ϕ1, ϕ′
1). This follows exactly as in [GJR01,
Theorem 3.2] (see also [JR92, Proposition 2] and [Jia98]), their arguments are general and
apply to our setting. The proof of the second part of the theorem is complete. The third
part follows immediately from the second and Theorem 5.6 (1).
(cid:3)

Proof of Claim 6.4. Collapsing the summation of the Eisenstein series into the integral and
using the Iwasawa decomposition we obtain

ˆK ˆC ′Mk(F )\Mk(A) |ρs|(mk)ch≤d(δQk(m))δr/k−1/2
× ˆUk(F )\Uk(A) |ϕϕ′|(umk) du dm dk,

Qk

(m)

where r = Re(s). This is ﬁnite for r ≫ 0, because ϕ and ϕ′ have moderate growth, and
m 7→ ρ(m) is a cusp form.
1 (· ; s), ϕ, ϕ′). We take s
Proof of Proposition 6.5 - number ﬁeld case. First consider CP (E d
in the domain of absolute convergence, where our integral manipulations are justiﬁed. Col-
lapsing the summation and using the Iwasawa decomposition,

(cid:3)

CP (E d

1 (· ; s), ϕ, ϕ′) =ˆK ˆC ′Mk(F )\Mk(A)

ρs(mk)ch≤d(δQk(m))

×ˆUk(F )\Uk(A)

ϕ(umk)ϕ′(umk) du δ−1
Qk

(m) dm dk.

Next we appeal to the results of § 4.3 and replace ϕ with its Fourier expansion along Uk. In

the notation of § 4.3, the integral becomes a sum of integralsPk
Ij =ˆK ˆC ′Stn,k(ψj )(F )\Mk(A)

ρs(mk)ch≤d(δQk(m))ϕUk,ψj (mk)ϕ′Uk,ψ−1

j (mk)δ−1
Qk

j=0 Ij, where

(m) dm dk.

69

This formal manipulation is justiﬁed using the fact that ϕ has uniform moderate growth. See
[Kap15b, p. 17] for the complete argument leading to the sum of integrals Ij, the identities
here are very similar (and simpler). By virtue of Proposition 4.6, the integrals Ij with

0 < j < k vanish, because we may introduce an inner integration ´Vj (F )\Vj (A) ρs(vg)dv along
a unipotent subgroup Vj of Mk, which vanishes because m 7→ ρ(m) is a cusp form.
Consider I0. Then ψ0 = 1 and Stn,k(ψ0) = Mk. For a subgroup H < Mk(A), let H 1 =
{h ∈ H : |δQk(h)| = 1}. Since C ′Mk(F ) < Mk(A)1 and

Mk(A) = Mk(A)1 × {diag(tIk, Ik) : t ∈ A+},

we obtain

I0 =ˆK ˆC ′Mk(F )\Mk(A)1 ˆR>0

ρsϕUkϕ′Uk(diag(tIk, Ik)mk)

× ch≤d(tk2

)δ−1
Qk

(diag(tIk, Ik)) t−1dt dm dk.

Here we identiﬁed A+ with R>0, dt is the standard Lebesgue measure on R and the constant
normalizing the measure dm on the right-hand side is omitted. For m ∈ Mk(A)1,

ρs(diag(tIk, Ik)mk) = δ1/2+s/k

Qk

(diag(tIk, Ik))ρ(mk).

(6.3)

By virtue of Theorem 4.8, the function ϕUk onfMk(A) belongs to the space of δ1/4

ΘMk corresponds to a character which is a lift of (δ1/4
of Mk is Bk × Bk). Therefore

ΘMk, where
n (the chosen Borel subgroup

)|T 2

Bk ⊗ δ1/4

Bk

Qk

ϕUkϕ′Uk(diag(tIk, Ik)mk) = δ1/2
Qk

(diag(tIk, Ik))ϕUkϕ′Uk(mk),

Combining (6.3) and (6.4) we obtain an inner integral

ˆ0<tk2 ≤d

tsk−1 dt =

ds/k
sk

,

(6.4)

(6.5)

multiplied by a dmdk-integral, which is independent of s and d. Therefore I0 = ds/k

sk α0.

Regarding Ik, ψk is the Shalika character and Stn,k(ψk) = G△

k . According to Theorem 4.22,

ϕUk,ψkϕ′Uk,ψ−1

k (c△mk) = ϕUk,ψkϕ′Uk,ψ−1

k (mk),

∀c ∈ Gk(A).

Therefore we may introduce the inner integration given by the formula for fρ and

Ik =ˆK ˆGk(A)

fkρ(g)ϕUk,ψkϕ′Uk,ψ−1

k (diag(g, Ik)k)| det g|s−k/2ch≤d(| det g|k) dg dk.

Consider the inner integral, for a ﬁxed k ∈ K. Without the function ch≤d, it is the integral
Z = Z(fkρ, kϕUk,ψk, kϕ′Uk,ψ−1
k , s) given by (5.4). Denote by Z≤d (resp. Z>d) the integral
ch>d). Then for Re(s) ≫ 0,
obtained when the integrand is multiplied by ch≤d (resp.
Z = Z≤d + Z>d. The following claim is the main observation needed to complete the proof.

Claim 6.6. Fix d, suﬃciently large. For any s, Z>d is absolutely convergent, uniformly for s
in compact subsets of C. Hence Z>d has a holomorphic continuation to the plane. Moreover
for any ﬁxed s, Z>d = 0 as d → ∞.

70

EYAL KAPLAN AND JAN M ¨OLLERS

The proof will be given below. Assume that d is large enough. By Theorem 5.4 (4),
Z admits a meromorphic continuation to C, and therefore the claim implies that Z≤d has
a meromorphic continuation to the plane. Furthermore, because Z>d is holomorphic, we
deduce that for any s0, Ress=s0Z = Ress=s0Z≤d, and since the left-hand side is independent
of d, the residues of Z≤d are also independent of d.

Because K is compact, Ik also has a meromorphic continuation. It follows that

Ress=1/2Ik =Ress=1/2ˆK

Z≤d(fkρ, kϕUk,ψk, kϕ′Uk,ψ−1

k , s) dk.

According to Theorem 5.6 (2) and its proof, at s = 1/2 the integral Z has at most a simple
pole, and there is a punctured neighborhood of 1/2 where the integral is holomorphic for all
k ∈ K. The same applies to Z≤d, hence by virtue of Cauchy’s Residue Theorem and Fubini’s
Theorem we can take the residue under the integral sign and obtain

Ress=1/2Z≤d(fkρ, kϕUk,ψk, kϕ′Uk,ψ−1

k , s) dk

ˆK
= ˆK

Ress=1/2Z(fkρ, kϕUk,ψk, kϕ′Uk,ψ−1

k , s) dk.

In
The right-hand side is independent of d. Hence Ik qualiﬁes as the function α1(s, d).
addition, now that we proved that both I0 and Ik admit meromorphic continuations, the
same holds for CP (E d
2 (· ; s), ϕ, ϕ′). We may proceed as above and obtain a sum of two
integrals I0 + Ik, where ρs and ch≤d are replaced by M(w, s)ρs and ch>d. Now I0 takes the
form

Next we handle CP (E d

1 (· ; s), ϕ, ϕ′).

I0 =ˆK ˆC ′Mk(F )\Mk(A)1 ˆR>0

M(w, s)ρsϕUkϕ′Uk(diag(tIk, Ik)mk)

× ch>d(tk2

)δ−1
Qk

(diag(tIk, Ik)) t−1dt dm dk.

Since

M(w, s)ρs(diag(tIk, Ik)mk) = δ1/2−s/k

Qk

(diag(tIk, Ik))M(w, s)ρs(mk),

the inner integral in this case becomes

ˆd<tk2 <∞

t−sk−1 dt.

Thus

I0 =

d−s/k

sk ˆK ˆC ′Mk(F )\Mk(A)1

M(w, s)ρsϕUkϕ′Uk(mk) dm dk.

The dmdk-integral still depends on s, because of the intertwining operator, but it is a
meromorphic function in s and if it has a pole at s = 1/2, this pole is simple. Hence the
constant α0 is replaced by a function α2(s) with the stated properties.

Regarding Ik, with the above notation

Ik =ˆK

Z>d(fkM (w,s)ρs, kϕUk,ψk, kϕ′Uk,ψ−1

k ,−s) dk.

Note that since m 7→ ρ(g, m) is a cusp form, the matrix coeﬃcient fM (w,s)ρs is a meromorphic
function in s and Ress=1/2fM (w,s)ρs = fRess=1/2M (w,s)ρs. The convergence properties of Z>d

71

stated above, imply that Ik admits a meromorphic continuation whose poles are contained
in the set of poles of M(w, s), and also

Ress=1/2Ik = ˆK

Z>d(fRess=1/2kM (w,s)ρs, kϕUk,ψk, kϕ′Uk,ψ−1

k ,−s) dk.

Hence when we let d → ∞, Ress=1/2Ik = 0.
Proof of Claim 6.6. Consider the function φ(g) = |ϕUk,ψkϕ′Uk,ψ−1
k (diag(g, Ik))| on Gk(A).
The global matrix coeﬃcient fρ is bounded, therefore it is enough to establish the stated
convergence properties for an integral of the form

(cid:3)

ˆGk(A)

φ(g)ch>d(| det g|)| det g|r dg = ˆGk(A)1 ˆR

>d1/k

φ(gt)tkr−1 dt dg,

r ∈ R.

But according to (5.5), for d > 1, this integral is ﬁnite even for r ≫ 0.
Proof of Proposition 6.5 - function ﬁeld case. We argue as in the case of a number ﬁeld and
1 (· ; s), ϕ, ϕ′) as a
use similar notation, but the proof is greatly simpliﬁed. We write CP (E d
sum of integrals, the only surviving ones are I0 and Ik. We can then write I0 in the form

(cid:3)

I0 =ˆK ˆ(CGk (A)C ′Mk(F ))\Mk(A)ˆCGk (F )\CGk (A)

ρsϕUkϕ′Uk(zmk)

× ch≤d(δQk(zm))δ−1

Qk

(zm) dz dm dk.

Since over a function ﬁeld, a cusp form on Gk(A) is compactly supported modulo CGk(A)Gk(F ),
I0 becomes a linear combination of integrals of the form

ˆF ∗\A∗

ρsϕUkϕ′Uk(diag(tIk, Ik))ch≤d(tk2

)δ−1
Qk

(diag(tIk, Ik)) dt.

(6.6)

Set (A∗)1 = {a ∈ A∗ : |a| = 1} and identify (A∗)1\A∗ with R>0. Since (6.3) and (6.4) still
hold, the integrand is invariant on {diag(tIk, Ik) : t ∈ (A∗)1}. Thus we see that (6.6) equals
(6.5) multiplied by the volume of F ∗\(A∗)1 (which is ﬁnite).
Next note that according to Claim 3.2, the projection of the support of ϕUk,ψk on Gk(A)
is contained in the support of some φ ∈ S(Ak×k). Hence if g ∈ Gk(A) satisﬁes | det g|k > d
for a large enough d (depending only on ϕ), ϕUk,ψkϕ′Uk,ψ−1
k (diag(g, Ik)) = 0. This means that
the integrals Z>d vanish identically. We can conclude that Ik satisﬁes the stated properties
2 (· ; s), ϕ, ϕ′) = 0, because in the corresponding summands I0 and Ik
and moreover, CP (E d
appears ch>d.

(cid:3)

References

[AG94]
[AGJ09]

[Art78]

[Art80]

A. Ash and D. Ginzburg. p-adic L-functions for GL(2n). Invent. Math., 116(1-3):27–73, 1994.
A. Aizenbud, D. Gourevitch, and H. Jacquet. Uniqueness of Shalika functionals:
Archimedean case. Paciﬁc J. Math., 243(2):201–212, 2009.
J. G. Arthur. A trace formula for reductive groups. I. Terms associated to classes in G(Q). Duke
Math. J., 45(4):911–952, 1978.
J. Arthur. A trace formula for reductive groups. II. Applications of a truncation operator. Com-
positio Math., 40(1):87–121, 1980.

the

[Ban98] W. Banks. A corollary to Bernstein’s theorem and Whittaker functionals on the metaplectic

[BB06]

group. Math. Res. Letters, 5(6):781–790, 1998.
J. Beineke and D. Bump. A summation formula for divisor functions associated to lattices.
Forum Math., 18(6):869–906, 2006.

72

[BF90]

[BFG03]

[BFH91]

[BG92]

[BJ13]

EYAL KAPLAN AND JAN M ¨OLLERS

D. Bump and S. Friedberg. The exterior square automorphic L-functions on GL(n). In Festschrift
in honor of I. I. Piatetski-Shapiro on the occasion of his sixtieth birthday, Part II (Ramat Aviv,
1989), volume 3 of Israel Math. Conf. Proc., pages 47–65. Weizmann, Jerusalem, 1990.
D. Bump, S. Friedberg, and D. Ginzburg. Small representations for odd orthogonal groups.
Internat. Math. Res. Notices, 2003(25):1363–1393, 2003.
D. Bump, S. Friedberg, and J. Hoﬀstein. p-adic Whittaker functions on the metaplectic group.
Duke Math. J., 63(2):379–397, 1991.
D. Bump and D. Ginzburg. Symmetric square L-functions on GL(r). Ann. of Math. (2),
136(1):137–205, 1992.
D. Ban and C. Jantzen. The Langlands quotient theorem for ﬁnite central extensions of p-adic
groups. Glas. Mat. Ser. III, 48(2):313–334, 2013.

[BLS99] W. D. Banks, J. Levy, and M. R. Sepanski. Block-compatible metaplectic cocycles. J. Reine

[BW80]

[BZ76]

[BZ77]

[Car93]

[Cas80]

[Cas95]

[CM93]

[CO13]

[CS80]

[DAV86]

[Dri80]

[Dri88]

[FJ93]
[FK86]

[Gin90]
[Gin06]

[GJ72]

[GJR01]

[GJR04]

[CKPSS04] J. W. Cogdell, H.H. Kim, I. I. Piatetski-Shapiro, and F. Shahidi. Functoriality for the classical

Angew. Math., 1999(507):131–163, 1999.
A. Borel and N. R. Wallach. Continuous cohomology, discrete subgroups, and representations
of reductive groups, volume 94 of Annals of Mathematics Studies. Princeton University Press,
Princeton, N.J., 1980.
I. N. Bernstein and A. V. Zelevinsky. Representations of the group GL(n, F ) where F is a local
non-Archimedean ﬁeld. Russian Math. Surveys, 31(3):1–68, 1976.
I. N. Bernstein and A. V. Zelevinsky. Induced representations of reductive p-adic groups I. Ann.
Scient. ´Ec. Norm. Sup., 10(4):441–472, 1977.
R. W. Carter. Finite groups of Lie type. Wiley Classics Library. John Wiley & Sons Ltd.,
Chichester, 1993. Conjugacy classes and complex characters, Reprint of the 1985 original, A
Wiley-Interscience Publication.
W. Casselman. The unramiﬁed principal series of p-adic groups I: the spherical function. Com-
positio Math., 40(3):387–406, 1980.
W. Casselman. Introduction to the theory of admissible representations of p-adic reductive
groups, 1995. preprint, http://www.math.ubc.ca/∼cass/research/pdf/p-adic-book.pdf.
groups. Publ. Math. IHES., 99:163–233, 2004.
D. H. Collingwood and W. M. McGovern. Nilpotent orbits in semisimple Lie algebras. Van
Nostrand Reinhold Mathematics Series. Van Nostrand Reinhold Co., New York, 1993.
G. Chinta and O. Oﬀen. A metaplectic Casselman-Shalika formula for GLr. Amer. J. Math.,
135(2):403–441, 2013.
W. Casselman and J. A. Shalika. The unramiﬁed principal series of p-adic groups II: the Whit-
taker function. Compositio Math., 41(2):207–231, 1980.
Jr. D. A. Vogan. The unitary dual of GL(n) over an Archimedean ﬁeld. Invent. Math., 83(3):449–
505, 1986.
V. G. Drinfel′d. Langlands’ conjecture for GL(2) over functional ﬁelds. In Proceedings of the
International Congress of Mathematicians (Helsinki, 1978), pages 565–574. Acad. Sci. Fennica,
Helsinki, 1980.
V. G. Drinfel′d. Proof of the Petersson conjecture for GL(2) over a global ﬁeld of characteristic
p. Funktsional. Anal. i Prilozhen., 22(1):34–54, 96, 1988.
S. Friedberg and H. Jacquet. Linear periods. J. Reine Angew. Math., 1993(443):91–139, 1993.
Y. Z. Flicker and D. A. Kazhdan. Metaplectic correspondence. Inst. Hautes ´Etudes Sci. Publ.
Math., 64(1):53–110, 1986.
D. Ginzburg. L-functions for SOn × GLk. J. Reine Angew. Math., 405:156–180, 1990.
D. Ginzburg. Certain conjectures relating unipotent orbits to automorphic representations. Israel
J. Math., 151(1):323–355, 2006.
R. Godement and H. Jacquet. Zeta functions of simple algebras, volume 260 of Lecture Notes in
Math. Springer-Verlag, Berlin, 1972.
D. Ginzburg, D. Jiang, and S. Rallis. Nonvanishing of the central critical value of the third
symmetric power L-functions. Forum Math., 13(1):109–132, 2001.
D. Ginzburg, D. Jiang, and S. Rallis. On the nonvanishing of the central value of the Rankin-
Selberg L-functions. J. Amer. Math. Soc., 17(3):679–722 (electronic), 2004.

73

[GJS10]

[GK75]

D. Ginzburg, D. Jiang, and D. Soudry. Periods of automorphic forms, poles of L-functions and
functorial lifting. Sci. China Math., 53(9):2215–2238, 2010.
I. M. Gel′fand and D. A. Kajdan. Representations of the group GL(n, K) where K is a local
ﬁeld. In Lie groups and their representations (Proc. Summer School, Bolyai J´anos Math. Soc.,
Budapest, 1971), pages 95–118. Halsted, New York, 1975.

[GPSR87] S. Gelbart, I. I. Piatetski-Shapiro, and S. Rallis. L-Functions for G × GL(n), volume 1254 of
[GPSR97] D. Ginzburg, I. I. Piatetski-Shapiro, and S. Rallis. L-functions for the orthogonal group, volume

Lecture Notes in Math. Springer-Verlag, New York, 1987.

[GRS98]

128, no. 611 of Mem. Amer. Math. Soc. Amer. Math. Soc., Providence, R. I., 1997.
D. Ginzburg, S. Rallis, and D. Soudry. L-functions for symplectic groups. Bull. Soc. math.
France, 126:181–244, 1998.

[GRS99a] D. Ginzburg, S. Rallis, and D. Soudry. On a correspondence between cuspidal representations

[GRS99b] D. Ginzburg, S. Rallis, and D. Soudry. On explicit lifts of cusp forms from GLm to classical

[GRS01]

[GRS11]

[Hir99]

[Jia98]
[JNQ08]

[JNQ10]

[JQ07]

[JR92]
[JR96]
[JS81]

[JS90]

[Kab01]

[Kap15a]

[Kap15b]

[Kap16]

[KP84]

[Kub67]

[Laf02a]

[Laf02b]

of GL2n and fSp2n. J. Amer. Math. Soc., 12(3):849–907, 1999.

groups. Ann. of Math. (2), 150(3):807–866, 1999.
D. Ginzburg, S. Rallis, and D. Soudry. Generic automorphic forms on SO(2n + 1): functorial
lift to GL(2n), endoscopy, and base change. Internat. Math. Res. Notices., 2001(14):729–764,
2001.
D. Ginzburg, S. Rallis, and D. Soudry. The Descent Map from Automorphic Representations of
GL(n) to Classical Groups. World Scientiﬁc Publishing, Singapore, 2011.
Y. Hironaka. Spherical functions and local densities on Hermitian forms. J. Math. Soc. Japan,
51(3):553–581, 1999.
D. Jiang. G2-periods and residual representations. J. Reine Angew. Math., 497:17–46, 1998.
D. Jiang, C. Nien, and Y. Qin. Local Shalika models and functoriality. Manuscripta Math.,
127(2):187–217, 2008.
D. Jiang, C. Nien, and Y. Qin. Symplectic supercuspidal representations of GL(2n) over p-adic
ﬁelds. Paciﬁc J. Math., 245(2):273–313, 2010.
D. Jiang and Y. Qin. Residues of Eisenstein series and generalized Shalika models for SO4n. J.
Ramanujan Math. Soc., 22(2):101–133, 2007.
H. Jacquet and S. Rallis. Symplectic periods. J. Reine Angew. Math., 1992(423):175–197, 1992.
H. Jacquet and S. Rallis. Uniqueness of linear periods. Compositio Math., 102(1):65–123, 1996.
H. Jacquet and J. A. Shalika. On Euler products and the classiﬁcation of automorphic represen-
tations I. Amer. J. Math., 103(3):499–558, 1981.
H. Jacquet and J. Shalika. Exterior square L-functions. In Automorphic forms, Shimura varieties,
and L-functions, Vol. II (Ann Arbor, MI, 1988), volume 11 of Perspect. Math., pages 143–226.
Academic Press, Boston, MA, 1990.
A. C. Kable. The tensor product of exceptional representations on the general linear group. Ann.
Sci. ´Ecole Norm. Sup. (4), 34(5):741–769, 2001.
E. Kaplan. The characterization of theta-distinguished representations of GLn. arXiv:1502.06643
[math.RT], http://arxiv.org/pdf/1502.06643v1.pdf, 2015.
E. Kaplan. The theta period of a cuspidal automorphic representation of GL(n). Internat. Math.
Res. Notices, 2015(8):2168–2209, 2015.
E. Kaplan. The double cover of odd general spin groups, small representations and applications.
J. Inst. Math. Jussieu, FirstView:1–63, 1 2016.
D. A. Kazhdan and S. J. Patterson. Metaplectic forms. Inst. Hautes ´Etudes Sci. Publ. Math.,
59(1):35–142, 1984.
T. Kubota. Topological covering of SL(2) over a local ﬁeld. J. Math. Soc. Japan, 19(1):114–121,
1967.
L. Laﬀorgue. Chtoucas de Drinfeld et correspondance de Langlands. Invent. Math., 147(1):1–241,
2002.
L. Laﬀorgue. Chtoucas de Drinfeld, formule des traces d’Arthur-Selberg et correspondance de
Langlands. In Proceedings of the International Congress of Mathematicians, Vol. I (Beijing,
2002), pages 383–400. Higher Ed. Press, Beijing, 2002.

74

EYAL KAPLAN AND JAN M ¨OLLERS

[LW13]

[Moo68]

[MW95]

[Rao93]

[McN12]

[Mac95]

[Mat69]

[McN11]

[Sak06]

[Sak13]

[McN14]

[LRS99] W. Luo, Z. Rudnick, and P. Sarnak. On the generalized Ramanujan conjecture for GL(n).
In Automorphic forms, automorphic representations, and arithmetic (Fort Worth, TX, 1996),
volume 66 of Proc. Sympos. Pure Math., pages 301–310. Amer. Math. Soc., Providence, RI,
1999.
J.-P. Labesse and J.-L. Waldspurger. La formule des traces tordue d’apr`es le Friday Morning
Seminar, volume 31 of CRM Monograph Series. American Mathematical Society, Providence,
RI, 2013. With a foreword by Robert Langlands [dual English/French text].
I. G. Macdonald. Symmetric functions and Hall polynomials. Oxford University Press, New
York/London, second edition, 1995.
H. Matsumoto. Sur les sous-groupes arithm´etiques des groupes semi-simples d´eploy´es. Ann. Sci.
´Ecole Norm. Sup. (4), 2(1):1–62, 1969.
P. J. McNamara. Metaplectic Whittaker functions and crystal bases. Duke Math. J., 156(1):1–31,
2011.
P. J. McNamara. Principal series representations of metaplectic groups over local ﬁelds. In
Multiple Dirichlet series, L-functions and automorphic forms, volume 300 of Progr. Math., pages
299–327. Birkh¨auser/Springer, New York, 2012.
P. J. McNamara. The Metaplectic Casselman-Shalika Formula, 2014. arXiv:1103.4653 [math.RT],
http://arxiv.org/pdf/1103.4653v3.pdf, to appear in Trans. Amer. Math. Soc.
C. C. Moore. Group extensions of p-adic and adelic linear groups. Inst. Hautes ´Etudes Sci. Publ.
Math., 35(1):157–222, 1968.
C. Mœglin and J.-L. Waldspurger. Spectral decomposition and Eisenstein series. Cambridge
University Press, New York, 1995.
R. Rao. On some explicit formulas in the theory of Weil representations. Paciﬁc J. Math.,
157(2):335–371, 1993.
Y. Sakellaridis. A Casselman-Shalika formula for the Shalika model of GLn. Canad. J. Math.,
58(5):1095–1120, 2006.
Y. Sakellaridis. Spherical functions on spherical varieties. Amer. J. Math., 135(5):1291–1381,
2013.
G. Savin. Local Shimura correspondence. Math. Ann., 280(2):185–190, 1988.
F. Shahidi. On certain L-functions. Amer. J. Math., 103(2):297–355, 1981.
F. Shahidi. On the Ramanujan conjecture and ﬁniteness of poles for certain L-functions. Ann.
of Math. (2), 127(3):547–584, 1988.
F. Shahidi. A proof of Langlands’ conjecture on Plancherel measures; complementary series of
p-adic groups. Ann. of Math., 132(2):273–330, 1990.
A. J. Silberger. Introduction to harmonic analysis on reductive p-adic groups. Princeton Univer-
sity Press and University of Tokyo Press, Princeton, New Jersey, 1979.
D. Soudry. Rankin–Selberg convolutions for SO2l+1 × GLn: local theory, volume 105, no. 500 of
Mem. Amer. Math. Soc. Amer. Math. Soc., Providence, R. I., 1993.
D. Soudry. On the Archimedean theory of Rankin–Selberg convolutions for SO2l+1 × GLn. Ann.
Scient. ´Ec. Norm. Sup., 28(2):161–224, 1995.
D. Soudry. On Langlands functoriality from classical groups to GLn. In J. Tilouine, H. Carayol,
M. Harris, and M.-F. Vign´eras, editors, Formes Automorphes (I); Actes du Semestre du CEB,
Printemps 2000, volume 298 of Ast´erisque, pages 335–390, 2005.
D. Szpruch. Computation of the local coeﬃcients for principal series representations of the
metaplectic double cover of SL2(F). J. Number Theory, 129(9):2180–2213, 2009.
S. Takeda. The twisted symmetric square L-function of GL(r). Duke Math. J., 163(1):175–266,
2014.
N. R. Wallach. Asymptotic expansions of generalized matrix entries of representations of real
reductive groups. In Lie group representations, I (College Park, Md., 1982/1983), volume 1024
of Lecture Notes in Math., pages 287–369. Springer, Berlin, 1983.
N. R. Wallach. Real reductive groups. I, volume 132 of Pure and Applied Mathematics. Academic
Press, Inc., Boston, MA, 1988.
N. R. Wallach. Real reductive groups. II, volume 132 of Pure and Applied Mathematics. Academic
Press, Inc., Boston, MA, 1992.

[Sav88]
[Sha81]
[Sha88]

[Sou93]

[Sou95]

[Wal88]

[Wal92]

[Szp09]

[Tak14]

[Wal83]

[Sha90]

[Sil79]

[Sou05]

[Wei64]
[Wei95]

A. Weil. Sur certains groupes d’op´erateurs unitaires. Acta Math., 111(1):143–211, 1964.
A. Weil. Basic number theory. Classics in Mathematics. Springer-Verlag, Berlin, 1995. Reprint
of the second (1973) edition.

Department of Mathematics, The Ohio State University, Columbus, OH 43210, USA
E-mail address: kaplaney@gmail.com

Department Mathematik, FAU Erlangen–N¨urnberg, Cauerstr. 11, 91058 Erlangen, Ger-

many

E-mail address: moellers@math.fau.de

75

