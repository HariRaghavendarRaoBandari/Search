6
1
0
2

 
r
a

 

M
7
1
 
 
]

.

C
O
h
t
a
m

[
 
 

1
v
4
3
5
5
0

.

3
0
6
1
:
v
i
X
r
a

ON EXISTENCE OF L2-SOLUTIONS OF COUPLED BOLTZMANN

CONTINUOUS SLOWING DOWN TRANSPORT EQUATION

SYSTEM

J. TERVO1, P. KOKKONEN2, M. FRANK3, AND M. HERTY4

Abstract. The paper considers a coupled system of linear Boltzmann transport
equation (BTE), and its Continuous Slowing Down Approximation (CSDA). This
system can be used to model the relevant transport of particles used e.g.
in
dose calculation in radiation therapy. The evolution of charged particles (e.g.
electrons and positrons) are in practice often modelled using the CSDA version of
BTE because of the so-called forward peakedness of scattering events contributing
to the particle ﬂuencies (or particle densities), which causes severe problems for
numerical methods. First, we prove the existence and uniqueness of solutions,
under suﬃcient criteria and in appropriate L2-based spaces, of a single (particle)
CSDA-equation by using two complementary techniques, the Lions-Lax-Milgram
Theorem (variational approach), and the theory evolution operators (semigroup
approach). The necessary a priori estimates are shown. In addition, we prove the
corresponding results and estimates for the system of coupled transport equations.
The related results are given for the adjoint problem as well. We also bring up
some computational points (e.g. certain explicit formulas), and we sketch a related
inverse problem in a remark at the end of the paper.

1. Introduction

The Boltzmann transport equation (BTE) models changes of the number den-
sity of particles in phase space (position, velocity direction, energy). In this paper
the species of particles include photons, electrons and positrons and the explored
analysis of transport equations is mainly intended for dose calculation in radiation
treatment planning. However, various other kinds of transport phenomena can be
modelled by equations of similar type including in e.g.
transport of particles in
optical tomography, in cosmic radiation and in nanotechnology. For general theory
of linear BTE with relevant boundary conditions we refer to [19] and [3]. See also
[12], [13], [20], [47] where the subject is considered from more physical point of view.
For some recent issues (including certain inverse problems) related to linear BTE
can be found in [42], and general non-linear aspects e.g.
in [59], [8]. A thorough
mathematical survey (mathematical and physical foundations, results, problems) of
non-linear collision theory of particle transport is given in [62]. This survey is mainly
intended to collision processes in dilute gases and plasmas but analogous results and
problems arise in other ﬁelds of particle physics. Finally, for topics related to Monte
Carlo methods in the context of BTE, both from theoretical and practical point of
view, we refer to [35], [50] and [51].

1University of Eastern Finland, Department of Applied Physics, Kuopio, Finland
2Varian Medical Systems Finland Oy, Helsinki, Finland
3RWTH Aachen University, MATHCCES, Schinkelstrasse 2, 52062, Germany
4RWTH Aachen University, IGPM, Templergraben 5, 52062, Germany
E-mail addresses: 2pvkokkon@gmail.com, 3frank@mathcces.rwth-aachen.de,

4herty@igpm.rwth-aachen.de.

1

ON EXISTENCE OF L2-SOLUTIONS FOR COUPLED CSDA

2

Dose calculation has a crucial importance in radiation therapy. Relevant dose
calculation models require (approximate) solution of a coupled system of (linear)
transport equations for ﬂuencies (number densities in the phase space) for all con-
sidered evolving particles. This is a diﬃcult problem, at least from computational
point of view. For that reason traditional dose calculation algorithms have applied
some closed-form formulas which have their origins in analytical solutions, or Monte-
Carlo derived solutions, of simpliﬁed problems but which however contain (often)
empirically derived corrections to take more accurately into account the underlying
particle physics. Certain ”factors” which account for e.g. the spatial inhomogeneities
must be included to improve the accuracy of the ﬁnal solution. These approaches
lead to methods that are fast enough but have a limited accuracy. Commonly used
models are based on the so-called pencil beams, or point kernels, see [6], [10], [36],
[41] and [57], [60] for more details. A notable exception to these approximate (de-
terministic) methods is the Acuros code [61], which is based on a discretization of
the BTE.

In radiation therapy BTE describes how radiation is scattered and absorbed in
tissue. The dose delivery methods can be roughly divided into two categories. In
external therapy the sources (below denoted by g) of high energy particles (usually
photons, electrons or protons) are on the patches of patient’s surface. In internal
therapy, on the other hand, the sources (below denoted by f ) are inside the patient
close to the cancerous tissue.
In the energy range, say up to 25 MeV, relevant
for photon and electron therapy, the three species of particles whose simultaneous
evolution should be taken into account in a realistic transport model, are photons,
electrons and positrons. In this setting, the potential creation of (or contamination
by) other heavy particles (such as neutrons) will not be taken into account since
their contribution to the dose is negligible (see [50]).

The transport of relevant particles in tissue (in an appropriate energy range) can

be modelled by the following linear coupled system of three BTEs

ω · ∇ψj(x, ω, E) + Σj(x, ω, E)ψj(x, ω, E) − (Kjψ)(x, ω, E) = fj(x, ω, E),

(1)

for j = 1, 2, 3, combined with an inﬂow boundary condition (for the deﬁnition of Γ−,
see section 2.1)

ψj |Γ−

= gj,

j = 1, 2, 3,

(2)

where for j = 1, 2, 3,

(Kjψ)(x, ω, E) =

σkj(x, ω′, ω, E′, E)ψk(x, ω′, E′)dω′dE′.

(3)

3

Xk=1ZS×I

For a derivation of linear BTE, see e.g.
[3], [4], [20], [52]. The ﬁrst term on the
left in (1) is called a convection (or advection) operator, the second term is a (total)
scattering operator and the third one is a collision operator. Notice that the (total)
scattering operator Σ = Σt = Σa + Σs (we drop the index j here to simplify the
notation) contains contribution from both the absorption (term Σa) and the scatter
(term Σs), see [52] (Sec. 9.1). On the right in (1), the functions fj represent (in-
ternal) sources and gj in (2) are (inﬂow) boundary sources. The system is coupled
through the integral operators Kj (unless, of course, σkj = 0 for j 6= k). The solution
ψ = (ψ1, ψ2, ψ3) of the problem (1)-(2) is a vector-valued function whose compo-
nents describe the radiation ﬂuxes of photons, electrons and positrons, respectively.
Roughly speaking, the ﬂux ψ(x, ω, E) is the ﬂux of energy through a surface normal
to the direction ω. The particle number density N, which is another usual unknown

ON EXISTENCE OF L2-SOLUTIONS FOR COUPLED CSDA

3

in kinetic theory, is related to ψ by ψ = kvk N, where kvk is the particle speed
([52]).

The equation (1) is a steady state counterpart of the dynamical equation

1
kvjk

∂ψj
∂t

+ ω · ∇ψj + Σjψj − Kjψ = fj,

j = 1, 2, 3,

(4)

where vj is the velocity of the j-th particle type.
In radiation therapy related
applications, it is suﬃcient to consider the steady state equations because the ﬂux
ψ reaches the steady state nearly instantly ([11]). The existence of solutions for
the problem (1), (2), as well as for the time-dependent problem (4), (2) (with an
appropriate initial condition) in L1-based spaces has been studied in [55] (the results
of which remaining valid, after slight modiﬁcations, for any 1 ≤ p < ∞).
We notice that in the expression of Kj the integration is performed only with
respect to ω′ and E′, while x-variable is kept ﬁxed. In general therefore, Kj only a
so-called partial (singular) integral operator (cf. [5]). This implies that the familiar
properties of (singular) integral operators (compactness, for example) are not valid
for collision operators. The diﬀerential cross-sections, whose detailed consideration
is omitted here, may have singularities or even hyper-singularities, which would lead
to extra partial diﬀerential (or pseudo-diﬀerential) terms in the transport equation
([33], Sec. 7.1, pp. 353-394).

The transport of electrons (and positrons) is forward-peaked. This implies that
the grid in numerical computations needs to be very tight in order to achieve reliable
results. To reduce the computational complexity, one possibility is to apply to the
evolution of electrons and positrons the so-called continuous slowing down approx-
imation (CSDA). The CSDA equations are vastly applied e.g.
in various cosmic
radiation problems ([48], [64]). From the physical point of view, the basic feature of
CSDA model of transport is that the energy is released continuously, not discretely
as quanta.

In CSDA-method one replaces Eqs. (1) for ψj, j = 2, 3 (electrons and positrons)

by the following equations ([64], [36], [26])

∂(Sj,rψj)

∂E

−

+ ω · ∇ψj + Σj,rψj − Kj,rψ = fj,

j = 2, 3,

(5)

where

and

(K2,rψ)(x, ω, E) = ZS×I
+ZS×I
+ZS×I
(K3,rψ)(x, ω, E) = ZS×I
+ZS×I
+ZS×I

Above, for j = 2, 3, the functions Σj,r = Σj,r(x, ω, E) are the restricted total cross-
sections, Sj,r = Sj,r(x, E) are the restricted stopping powers, and σjj,r(x, ω′, ω, E′, E)

σ12(x, ω′, ω, E′, E)ψ1(x, ω′, E′)dω′dE′

σ22,r(x, ω′, ω, E′, E)ψ2(x, ω′, E′)dω′dE′

σ32(x, ω′, ω, E′, E)ψ3(x, ω′, E′)dω′dE′

σ13(x, ω′, ω, E′, E)ψ1(x, ω′, E′)dω′dE′

σ23(x, ω′, ω, E′, E)ψ2(x, ω′, E′)dω′dE′

σ33,r(x, ω′, ω, E′, E)ψ3(x, ω′, E′)dω′dE′.

ON EXISTENCE OF L2-SOLUTIONS FOR COUPLED CSDA

4

are the restricted diﬀerential cross-sections, which do not include soft inelastic inter-
actions ([9]). Besides the inﬂow boundary condition (2), one needs to impose on the
solutions ψj, j = 2, 3, of (5) an energy-boundary condition. We make a reasonable
assumption that at some (high enough, but ﬁnite) cut-oﬀ energy Em > 0 the ﬂuxes
ψ2, ψ3 vanish, i.e. we take the energy-boundary condition to be

ψ2(x, ω, Em) = ψ3(x, ω, Em) = 0,

(below, we often call this an initial condition as well). One could also demand the
cut-oﬀ energy Em to be inﬁnite, in which case the corresponding energy boundary
condition would become,

lim
E→∞

ψ2(x, ω, E) = lim
E→∞

ψ3(x, ω, E) = 0.

However, we shall restrict our discussion to the case where Em is ﬁnite. The require-
ment that such energy initial condition be satisﬁed (by ψ2, ψ3) makes the overall
problem mathematically well-posed that is, under relevant (physical) assumptions
the problem has a unique solution.

We give a short heuristic derivation of CSDA based on the presentation given in
[64] (pp. 14-17). Firstly, we decompose for k = 2, 3 the diﬀerential cross-section
into two parts

σkk(x, ω′, ω, E′, E) = σat

kk(x, ω′, ω, E′, E) + σnu

kk(x, ω′, ω, E′, E), k = 2, 3

where ”at” refers to interactions with atomic electrons, and ”nu” refers to nuclear
interactions. The term σat
kk(x, ω′, ω, E′, E) contains the ”problematic” features that
are to be approximated by the continuous slowing down model. Secondly, we write
formally

N

kk(x, ω′, ω, E′, E) =
σat

k,n(x, E + ǫn)˜δω(ω′)δE+ǫn(E′),
σat

where ˜δω is the Dirac measure on the sphere S concentrated at ω, and δE+ǫn is
the Dirac measure on R concentrated at E + ǫn. Applying these concepts and the
Taylor’s formula, we ﬁnd that

Xn=0

σat
kk(x, ω′, ω, E′, E)ψk(x, ω′, E′)dω′dE′ =

σat
k,n(x, E + ǫn)ψk(x, ω, E + ǫn)

N

Xn=0

σat
k,n(x, E)ψk(x, ω, E) +

≈
The restricted total atomic cross-sections and the restricted stopping powers are

(x, ω, E)ǫn.

Xn=0

(6)

N

∂(σat
k,nψk)
∂E

Σat

k,r(x, E) :=

σat
k,n(x, E), Sk,r(x, E) :=

N

Xn=0

σat
k,n(x, E)ǫn.

N

Xn=0

ZS×I
Xn=0

N

ZS×I
= ZS×I
≈ Σat

Let σkk,r := σnu

kk. Then by (6) we obtain for k = 2, 3,

σkk(x, ω′, ω, E′, E)ψk(x, ω′, E′)dω′dE′

σat

kk(x, ω′, ω, E′, E)ψk(x, ω′, E′)dω′dE′ +ZS×I
(x, ω, E) +ZS×I

∂(Sk,rψk)

∂E

k,r(x, E)ψk(x, ω, E) +

σkk,r(x, ω′, ω, E′, E)ψk(x, ω′, E′)dω′dE′

σkk,r(x, ω′, ω, E′, E)ψk(x, ω′, E′)dω′dE′.

(7)

ON EXISTENCE OF L2-SOLUTIONS FOR COUPLED CSDA

5

Finally, writing Σj,r := Σj − Σat
mately the equations (5) for j = 2, 3.

j,r and substituting (7) into (1), we obtain approxi-

The so-called CSDA-Fokker-Plank model includes (cf. [2]) additionally (roughly
speaking) the second order partial derivatives with respect angle in the above Taylor
expansion (for ψ2, ψ3). It is a further approximation that in addition to small energy
changes assumes small angle changes for the scattering. The hierarchy of the Boltz-
mann equation, its CSDA approximation and the Fokker-Planck approximation is
detailed in Appendix A of [37]. Typically, the Fokker-Planck approximation is con-
sidered not valid for electrons in tissues [37]. In addition, in [46] a formal asymptotic
analysis is performed that sheds light onto the validity of these approximations. For
example, it was shown that the Fokker-Planck approximation is not valid for the
often used Henyey-Greenstein kernel.

The dose D(x) = (Dψ)(x) is calculated from the solution of the problem

∂(Sj,rψj)

∂E

−

ω · ∇ψ1 + Σ1ψ1 − K1ψ = f1,
+ ω · ∇ψj + Σj,rψj − Kj,rψ = fj,

j = 2, 3,

= gj,

ψj |Γ−
ψj(·,·, Em) = 0,

j = 1, 2, 3,

j = 2, 3,

D(x) =

3

Xj=1ZS×I

κj(x, E)ψj(x, ω, E)dωdE,

(8)

(9)

(10)

(11)

(12)

by

where κj(x, E) are stopping powers, which in general can be diﬀerent from the re-
stricted stopping powers Sj,r. The dose calculation is a forward problem. The
determination of the external particle ﬂux g = (g1, g2, g3) and/or the distribution of
internal source f = (f1, f2, f3) is called inverse radiation treatment planning problem
(IRTP) which is an inverse problem. It always requires a dose calculation model.
We refer to [49], [55], [63] and references therein for some details concerning the
IRTP-problem. In [26] the IRTP-problem has been studied in the context of CSDA-
equation for a single particle (when the stopping power is independent of x). See
also [9] where related spatially 3-dimensional numerical simulations (real case simu-
lations applying ﬁnite element methods, FEM) have been explored. The numerical
results point at open questions (oscillations are reported which are probably due to
the lack of suﬃcient regularity of solutions).

This paper contains several novel contributions to the study of particle transport
in tissues. In the beginning we expose the preliminaries including some details (many
of which are reproductions of known results) of the so-called escape-time mapping
and inﬂow trace theory. These tools are essential in the treated analysis. After that
we consider the existence and uniqueness of solutions for a single (particle) CSDA
equation

∂(S0ψ)

∂E

−

+ ω · ∇ψ + Σψ − Kψ = f,

ψ|Γ− = g,

(13)

(14)

(15)
in L2(G × S × I)-based spaces. Here G ⊂ R3 is the spatial domain, S ⊂ R3 is
the unit sphere and I = [0, Em] is the energy interval. Γ− is ”the inﬂow boundary

ψ(·,·, Em) = 0,

ON EXISTENCE OF L2-SOLUTIONS FOR COUPLED CSDA

6

part of ∂G”. We extend the results of [26], where a spatially homogeneous stopping
power was assumed.

In section 3.2 we give a variational formulation of the problem (13), (14), (15)
in appropriate spaces. We give suﬃcient conditions under which the correspond-
ing bilinear form and linear form obey the assumptions of the so-called Lions-Lax-
Milgram Theorem (generalized Lax-Milgram Theorem). This guarantees the exis-
tence of solutions for the equation (13). Under certain regularity assumption (that
is, ψ ∈ W 2
1 (G × S × I)) this solution is unique and additionally it satisﬁes the
boundary and initial conditions (14), (15).
In section 3.4 we show the existence and uniqueness results for the solution of
the problem (13), (14), (15) by using an alternative technique, based on the theory
of evolution equations and (m-)dissipative operators, but for a restricted class of
collision operators K. This gives also a suﬃcient criterion for the regularity of the
solution assumed in section 3.2.

In section 4 we extend the corresponding existence and uniqueness results for the
coupled transport system (8)-(11), which has so far not been studied in the litera-
ture, in L2(G×S×I)3-based spaces. We also show certain a priori estimates (needed
e.g. in section 7) which in particular show (under speciﬁc assumptions) that the so-
lution depends continuously on the data. Section 5 considers certain computational
aspects, and the emphasis is on how to calculate numerical solution (for the forward
problem), in principle, without inversion of (huge) matrices. Analogous results for
the adjoint problem are formulated in section 6. Finally, in the last section 7 we
outline a related IRTP-problem but its thorough study remains open.

2. Preliminaries

2.1. Notations, Assumptions and Introduction of Relevant Function Spaces.
We assume that G is an open bounded set in R3 such that G is a C 1-manifold with
boundary (as a submanifold of R3) which may have corners as deﬁned in [38]. Syn-
onymously, we say in this speciﬁc sense that G is a bounded open set with piecewise
C 1-boundary. In particular, it follows from this deﬁnition that G lies on one side of
its boundary.

The regular part (∂G)r of the boundary ∂G of G consists of points where ∂G is
a C 1-manifold of dimension 2. The unit outward pointing normal on the regular
part (∂G)r of ∂G is denoted by ν and the surface measure on ∂G is µ∂G. We let
S = S2 be the unit sphere in R3 equipped with the usual rotationally invariant
surface measure µS. Here and in what follows we typically refer to the measures of
interest to us, namely Lebesgue measure L3 in R3, and the above (surface) measures
µ∂G and µS simply by dx, dσ and dω in the sense that for all sets A measurable
with respect to relevant one of them,

L3(A) =ZA

dx, µ∂G(A) =ZA

dσ, µS(A) =ZA

dω.

Furthermore, let I = [0, Em] where 0 < Em < ∞. We could replace I by I =
[E0, Em] or I = [E0,∞[ where E0 ≥ 0 but we omit this generalization here. We shall
denote by I ◦ the interior ]0, Em[ of I.

ON EXISTENCE OF L2-SOLUTIONS FOR COUPLED CSDA

7

Deﬁnition 2.1 For (x, ω) ∈ G × S the escape time (in the direction ω) t(x, ω) =
t−(x, ω) is deﬁned by

t(x, ω) = inf{s > 0 | x − sω 6∈ G}

= sup{T > 0 | x − sω ∈ G for all 0 < s < T},

for (x, ω) ∈ G × S.

(16)

and continuous if G is convex. See e.g. [55].

The escape time function t(·,·) is known to be lower semicontinuous in general,
Recalling that (∂G)r stands for the the regular part of ∂G, we deﬁne

and

Γ := (∂G) × S × I
Γr := (∂G)r × S × I

Γ0 := {(y, ω, E) ∈ Γr | ω · ν(y) = 0}
Γ− := {(y, ω, E) ∈ Γr | ω · ν(y) < 0}

= {(y, ω) ∈ (∂G)r × S | ω · ν(y) < 0} × I

Γ+ := {(y, ω, E) ∈ Γr | ω · ν(y) > 0}

= {(y, ω) ∈ (∂G)r × S | ω · ν(y) > 0} × I.

Let µΓ = µ∂G⊗ µS ⊗L1, written typically as dσdωdE in the same sense as discussed
above. It follows that µΓ(Γ\Γr) = µΓ(Γ0) = 0 and
Γr = Γ0 ∪ Γ− ∪ Γ+.

Let y := x − (t(x, ω)ω and denote
N0 := {(x, ω, E) ∈ G × S × I | either y ∈ ∂G \ (∂G)r, or y ∈ (∂G)r and ω · ν(y) = 0}

and

(17)

(18)

D := (G × S × I) \ N0.

Recall that N0 has a measure zero in G × S × I ([55], Theorem 3.8).
Deﬁnition 2.2 Deﬁne escape-time mappings τ±(y, ω) from boundary to boundary
in the direction ω as follows

τ−(y, ω) := inf{s > 0 | y + sω 6∈ G},
τ+(y, ω) := inf{s > 0 | y − sω 6∈ G},

(y, ω) ∈ ∂G × S,
(y, ω) ∈ ∂G × S.

(19)

(20)

Note that for (y, ω, E) ∈ Γ− the vector (y+, ω, E) ∈ Γ+ where y+ := y +

τ−(y, ω)ω ∈ Γ+ and

τ−(y, ω) = τ+(y+, ω).

Below the maps t : G × S → [0,∞] and τ± : ∂G × S → [0,∞], will often be
interpret as maps t : G × S × I → [0,∞] and τ± : Γ → [0,∞], by dropping oﬀ the
energy variable, e.g. t(x, ω, E) = t(x, ω).

Lemma 2.3 Let (y0, ω0) ∈ ∂G × S be such that there exists a bounded open cone
< r, 0 < kxk < r} ⊂ R3, a 6= 0 containing −ω0 such that

kxk − a

for some λ0 > 0 one has y0 + λ0C ⊂ R3\G. Then we have the following:

C := {x ∈ R3 | (cid:12)(cid:12)(cid:12)

kak(cid:12)(cid:12)(cid:12)

x

ON EXISTENCE OF L2-SOLUTIONS FOR COUPLED CSDA

8

(i) The map t(·,·) is continuous at any point (x0, ω0) ∈ G × S such that y0 =
(ii) Letting y+ = y0 + τ−(y0, ω0)ω0, one has the following limits

x0 − t(x0, ω0)ω0.

lim

(x,ω)→(y0,ω0)

lim

(x,ω)→(y+,ω0)

t(x, ω) = 0,

t(x, ω) = τ−(y0, ω0),

where (x, ω) ∈ G × S when taking the limits.
Proof. By using charts of a C 1-manifold with corner and the assumption, there exists
a bounded open cone C ′ containing −ω0, a λ′
0 > 0 and a neighbourhood U of y0 in
R3 such that

y + λ′

0C ′ ⊂ R3\G,

∀y ∈ U ∩ ∂G.

(i) First, let us show that t(·,·) is lower-semicontinous on G × S.

Indeed, if
(x, ω) ∈ G × S and 0 < s < t(x, ω), we have x − [0, s]ω := {x − tω | t ∈ [0, s]} ⊂ G.
Thus if (xn, ωn) is a sequence in G×S converging to (x, ω), one has xn−[0, s]ωn ⊂ G
for all large enough n, which implies t(xn, ωn) ≥ s, and thus lim inf n→∞ t(xn, ωn) ≥ s.
Letting s → t(x, ω) from the left, we conclude that lim inf n→∞ t(xn, ωn) ≥ t(x, ω),
which gives the lower semi-continuity we were to show.
It remains to show that t(·,·) is upper semi-continuous at (x0, ω0) which then
implies that t(·,·) is continuous at (x0, ω0) since we already known that t(·,·) is
lower-semicontinous at (x0, ω0).

Indeed, let (xn, ωn) → (x0, ω0) when n → ∞. Fix λ ∈]0, λ0]. Then

y0 − λω0 ∈ y0 + λC ′ ⊂ y0 + λ0C ′ ⊂ R3\G,

from which it follows that for all large enough n (which we assume from now on),

xn − (t(x0, ω0) + λ)ωn ∈ y0 + λ0C ′ ⊂ R3\G.

Therefore, t(xn, ωn) ≤ t(x0, ω0) + λ, and hence

lim sup

n→∞

t(xn, ωn) ≤ t(x0, ω0) + λ,

for all λ > 0, which gives us the desired upper semi-continuity at (x0, ω0),

lim sup

n→∞

t(xn, ωn) ≤ t(x0, ω0).

case (xn, ωn) → (y0, ω0) where (xn, ωn) ∈ G×S . Then y0−λ′
implies that for all n large enough, one has xn − λωn ∈ y0 + λ′
0 < λ ≤ λ′
lim supn→∞ t(xn, ωn) = 0.

(ii) Arguments are analogous to the ones employed in case (i). Consider ﬁrst the
0C ′ ⊂ R3\G
0C ′ ⊂ R3\G for all
0, hence t(xn, ωn) ≤ λ, from which lim supn→∞ t(xn, ωn) ≤ λ, and ﬁnally
We then suppose that (xn, ωn) → (y+, ω0). Since y0 = y+ − τ−(y0, ω0)ω0 and
0C ′ ⊂ R3\G, one has for all n large enough and all 0 < λ ≤ λ′
0,

0ω0 ∈ y0 + λ′

0ω0 ∈ y0+λ′

y0 − λ′
that

0C ′ ⊂ R3\G,
whence t(xn, ωn) ≤ τ−(y0, ω0) + λ, which gives the upper limit

xn − (τ−(y0, ω0) + λ)ωn ∈ y0 + λ′

lim sup

n→∞

t(xn, ωn) ≤ τ−(y0, ω0).

In order to obtain the corresponding lower limit, which then shows the existence
and the correct value of the limit we were set out to show, notice that if 0 < σ <

ON EXISTENCE OF L2-SOLUTIONS FOR COUPLED CSDA

9

τ−(y0, ω0), then y0+σω0 ∈ G, hence for all n large enough xn−(τ−(y0, ω0)−σ)ωn ∈ G
(since xn − (τ−(y0, ω0)− σ)ωn → x0 − (τ−(y0, ω0)− σ)ω0 = y0 + σω0) , which implies
that t(xn, ωn) ≥ τ+(y+, ω0) − σ, and thus lim inf n→∞ t(xn, ωn) ≥ τ−(y0, ω0) − σ.
Letting σ → 0+ allows us to conclude that

lim inf
n→∞

t(xn, ωn) ≥ τ−(y0, ω0).

Lemma 2.4 Let (x0, ω0, E0) ∈ (G × S × I) ∪ Γ+ ∪ Γ−. Then

(cid:3)

lim

(x,ω,E)→(x0,ω0,E0)

t(x, ω) =

t(x0, ω0),

τ+(x0, ω0),

0,

if (x0, ω0, E0) ∈ G × S × I
and (cid:0)x0 − t(x0, ω0)ω0, ω0, E0(cid:1) ∈ Γ−,
if (x0, ω0, E0) ∈ Γ+
and (x0 − τ+(x0, ω0)ω0, ω0, E0) ∈ Γ−,
if (x0, ω0, E0) ∈ Γ−.




where (x, ω, E) ∈ G × S × I when taking the limits.
Proof. Deﬁne

z0 =
x0 − t(x0, ω0)ω0,
x0 − τ+(x0, ω0)ω0,

x0,

if (x0, ω0, E0) ∈ G × S × I
if (x0, ω0, E0) ∈ Γ+
if (x0, ω0, E0) ∈ Γ−.

In each of the limits concerned, we have thus assumed that (z0, ω0, E0) ∈ Γ−, which
implies, using the fact that G is C 1-manifold with corners and ω0 · ν(z0) < 0, that
there is an open ﬁnite cone C ⊂ R3 and λ0 > 0 such that z0 + λ0C ⊂ R3\G and
−ω0 ∈ C. The claim then follows from Lemma 2.3. Note in particular that when
considering the limit lim t(x, ω) = τ+(x0, ω0) = τ−(y0, ω0) one takes in the lemma
y0 = x0 − τ+(x0, ω0)ω0 and (hence) y+ = x0.

(cid:3)

Proposition 2.5 Deﬁne

(Γ+)c := {(y, ω, E) ∈ Γ+ | (y − τ+(y, ω)ω, ω, E) ∈ Γ−}.

Then Γ+\(Γ+)c has zero-measure in Γ and there is a continuous extension t of
t : D → R onto D− := D ∪ Γ− ∪ (Γ+)c given by

t(x, ω) =


t(x, ω),
τ+(x, ω),
0,

if (x, ω, E) ∈ D,
if (x, ω, E) ∈ (Γ+)c,
if (x, ω, E) ∈ Γ−.

Proof. The result is a straightforward consequence of the above Lemmas.

(cid:3)

Example 2.6 Note that in the case where G is convex and its boundary is C 1-
regular the above extension t is continuous on G× S. For example, for the ball G =
B(0, r) we have τ+(x, ω) = 2| hx, ωi| and t(x, ω) = hx, ωi +qhx, ωi2 + r2 − kxk2
([55], Example 3.1). We ﬁnd that for (y, ω) ∈ Γ′ = ∂G × S

lim

(x,ω)→(y,ω),(x,ω)∈G×S

t(x, ω) = hy, ωi + | hy, ωi|.

(21)

ON EXISTENCE OF L2-SOLUTIONS FOR COUPLED CSDA

10

For (y, ω) ∈ Γ′
τ+(y, ω)) and for (y, ω) ∈ Γ′
t : G × S → R is continuous.

+ the projection hy, ωi is non-negative (and then the limit (21) is
− it is non-positive and then the limit (21) is 0). Hence

Due to the Proposition 2.5 we can (almost everywhere) uniquely set t(y, ω) = 0
for (y, ω, E) ∈ Γ−. For (y, ω, E) ∈ Γ+ we set t(y, ω) := τ+(y, ω). For further
(unexplained) notations we refer to [55].

Deﬁne the (Sobolev) space W 2(G × S × I) by

W 2(G × S × I) = {ψ ∈ L2(G × S × I) | ω · ∇xψ ∈ L2(G × S × I)}

and its subspace W 2

1 (G × S × I) by

(22)

(23)

W 2

1 (G × S × I) =(cid:8)ψ ∈ W 2(G × S × I) (cid:12)(cid:12)

Here ∇x is taken with respect to x-variable only, and ω·∇xψ and ∂ψ
∂E are understood
in the distributional sense. In what follows, we denote shortly ∇x = ∇, and ω · ∇ψ
will stand for (the distribution) Ω ·∇xψ where Ω : G× S × I → R3; Ω(x, ω, E) = ω.
The spaces W 2(G × S × I), W 2
1 (G × S × I) are equipped with the inner products,
respectively

∂ψ

∂E ∈ L2(G × S × I)(cid:9).

hψ, viW 2(G×S×I) = hψ, viL2(G×S×I) + hω · ∇ψ, ω · ∇viL2(G×S×I)

(24)

and

hψ, viW 2

1 (G×S×I) = hψ, viL2(G×S×I) + hω · ∇ψ, ω · ∇viL2(G×S×I) +(cid:28) ∂ψ

∂E

,

∂v

∂E(cid:29)L2(G×S×I)

(25)

.

These spaces are Hilbert spaces. Let

C 1(G × S × I) := {φ|G×S×I | φ ∈ C 1

0 (R3 × S × R)}.

(26)

We have (cf. e.g. [28], [7]. The proof can also be shown by the similar considerations
as in [27], pp. 11-19)

Theorem 2.7 The space C 1(G× S × I) is a dense subspace of W 2(G× S × I) and
of W 2

1 (G × S × I).

For Γ− := {(y, ω, E) ∈ (∂G)r × S × I)| ω · ν(y) < 0} we deﬁne the space of L2-
functions with respect to the measure |ω · ν| dσdωdE which is denoted by T 2(Γ−)
that is, T 2(Γ−) = L2(Γ−,|ω · ν| dσdωdE). T 2(Γ−) is a Hilbert space and its inner
product is (in this paper all functions are real-valued)

hh1, h2iT 2(Γ−) =ZΓ−

h1(y, ω, E)h2(y, ω, E)|ω · ν| dσdωdE.

(27)

The space T 2(Γ+) (and its inner product) of L2-functions on Γ+ := {(y, ω, E) ∈
(∂G)r × S × I)| ω · ν(y) > 0} with respect to the measure |ω · ν| dσdωdE is similarly
deﬁned. T 2(Γ) denotes the space of L2-functions with respect to the measure |ω ·
ν| dσdωdE that is, T 2(Γ) = L2(Γ,|ω · ν| dσdωdE). The inner product in T 2(Γ) is
(28)

h1(y, ω, E)h2(y, ω, E)|ω · ν| dσdωdE.

hh1, h2iT 2(Γ) =ZΓ

ON EXISTENCE OF L2-SOLUTIONS FOR COUPLED CSDA

11

One can show ([19], pp. 230-231, [55]) that for any compact set K ⊂ Γ−
ZK |ψ(y, ω, E)|2|ω · ν| dσdωdE ≤ CK kψk2
∀ψ ∈ C 1(G × S × I).
Hence any element ψ ∈ W 2(G × S × I) has well deﬁned trace ψ|Γ− in L2
ν| dσdωdE) deﬁned by

W 2(G×S×I)

ψ|K := lim
j→∞

ψj |K for any compact subset K ⊂ Γ−,

loc(Γ−,|ω ·

(29)

(30)

where {ψj} ⊂ C 1(G×S×I) is a sequence such that limj→∞ kψj − ψkW 2(G×S×I) = 0.
In addition the trace mapping γ− : W 2(G× S × I) → L2
loc(Γ−,|ω · ν| dσdωdE) such
that γ−(ψ) = ψ|Γ− is continuous. Similarly one has a continuous trace mapping
γ+ : W 2(G × S × I) → L2
loc(Γ+,|ω · ν| dσdωdE) and so we can deﬁne (a.e. unique)
the trace γ(ψ) on Γ for ψ ∈ W 2(G × S × I).
By the Sobolev Embedding Theorem for ψ ∈ C 1(G × S × I) (cf. [27], p. 22, or
[58], p. 220; or see (51) in the proof of Theorem 2.14 below)

kψ(·,·, E)kL2(G×S) ≤ C(cid:16)kψkL2(G×S×I) +(cid:13)(cid:13)(cid:13)(cid:13)

∂ψ

∂E(cid:13)(cid:13)(cid:13)(cid:13)L2(G×S×I)(cid:17),

and then the traces ψ(·,·, 0), ψ(·,·, Em) ∈ L2(G × S) are well-deﬁned for any
ψ ∈ W 2
1 (G × S × I).
The trace γ(ψ), ψ ∈ W 2(G × S × I) is not necessarily in the space T 2(Γ). Hence
we deﬁne the spaces

∀E ∈ I,

(31)

˜W 2(G × S × I) = {ψ ∈ W 2(G × S × I) | γ(ψ) ∈ T 2(Γ)}.

which is equipped with the inner product

(32)

hψ, vi ˜W 2(G×S×I) = hψ, viW 2(G×S×I) + hγ(ψ), γ(v)iT 2(Γ) .

(33)
The space ˜W 2(G×S×I) is a Hilbert space (cf. [55]). Moreover, we deﬁne subspaces
˜W 2
±,0(G × S × I) of it by

˜W 2
±,0(G × S × I) = {ψ ∈ ˜W 2(G × S × I) | γ±(ψ) = 0}.

(34)

(ω · ∇ψ)v dxdωdE +ZG×S×I

For v ∈ ˜W 2(G × S × I) and ψ ∈ ˜W 2(G × S × I) it holds the Green’s formula
ZG×S×I
(35)
which is obtained by Stokes Theorem for v, ψ ∈ C 1(G × S × I) and then by the
limiting considerations for general v ∈ ˜W 2(G × S × I) and ψ ∈ ˜W 2(G × S × I).
Remark 2.8 By Green’s formula

(ω · ∇v)ψ dxdωdE =Z∂G×S×I

(ω · ν)v ψ dσdωdE,

kγ±(ψ)kT 2(Γ±) ≤ kψk ˜W 2

∓(G×S×I)

and thus γ± : ˜W 2

∓,0(G × S × I) → T 2(Γ±) is bounded.

Occasionally we work in the (energy independent) spaces L2(G × S). The corre-
±), T 2(Γ′) and ˜W 2(G × S) are similarly
− = {(y, ω) ∈ ∂G × S | ω · ν(y) < 0}
+. In addition the trace γ′(ψ) := ψ|Γ′ for ψ ∈ ˜W 2(G × S) is

sponding Hilbert spaces W 2(G × S), T 2(Γ′
deﬁned where Γ′ := (∂G) × S and where Γ′
and analogously for Γ′
deﬁned as γ(ψ) above.

ON EXISTENCE OF L2-SOLUTIONS FOR COUPLED CSDA

12

In the context of CSDA-equations we need the following additional Hilbert spaces.

Let H be the completion of C 1(G × S × I) with respect to the inner product

hψ, viH := hψ, viL2(G×S×I) + hγ(ψ), γ(v)iT 2(Γ)

(36)
The elements of H are of the form ˜ψ = (ψ, q) ∈ L2(G×S×I)×T 2(Γ). Actually, they
are exactly elements of the closure of the graph of trace operator γ : C 1(G×S×I) →
C 1(∂G × S × I) in L2(G × S × I) × T 2(Γ). The inner product in H is

= hψ, ψ′iL2(G×S×I) + hq, q′iT 2(Γ) ,

(37)

D ˜ψ, ˜ψ′EH
for ˜ψ = (ψ, q), ˜ψ′ = (ψ′, q′) ∈ H.
product

Furthermore, let H1 be the completion of C 1(G× S × I) with respect to the inner

hψ, viH1

:= hψ, viL2(G×S×I) + hγ(ψ), γ(v)iT 2(Γ)

+ hψ(·,·, 0), v(·,·, 0)iL2(G×S) + hψ(·,·, Em), v(·,·, Em)iL2(G×S) .

(38)
The elements of H1 are of the form ˜ψ = (ψ, q, p0, pm) ∈ L2(G × S × I) × T 2(Γ) ×
L2(G × S)2. More precisely, the elements of H1 are the elements of the closure (in
L2(G × S × I) × T 2(Γ) × L2(G × S)2) of the graph of the (trace) operator C 1(G ×
S × I) → C 1(∂G× S × I)× C 1(G× S)2 deﬁned by ψ 7→ (γ(ψ), ψ(·,·, 0), ψ(·,·, Em)).
The inner product in H1 is

D ˜ψ, ˜ψ′EH1

= hψ, ψ′iL2(G×S×I) + hq, q′iT 2(Γ)

+ hp0, p′
0, p′

0iL2(G×S) + hpm, p′
m) ∈ H1.

miL2(G×S) ,

for ˜ψ = (ψ, q, p0, pm), ˜ψ = (ψ′, q′, p′

Finally, let H2 be the completion of C 1(G × S × I) with respect to the inner

product

hψ, viH2

,

∂v

∂E

:= hψ, vi ˜W 2(G×S×I) +(cid:28) ∂ψ
∂E(cid:29)L2(G×S×I)
= hψ, viL2(G×S×I) + hω · ∇ψ, ω · ∇viL2(G×S×I)
∂E(cid:29)L2(G×S×I)
+ hγ(ψ), γ(v)iT 2(Γ) +(cid:28) ∂ψ

∂E

∂v

,

.

(39)

Obviously H2 ⊂ ˜W 2(G × S × I) ∩ W 2
given by (39).

1 (G × S × I) and the inner product in H2 is

2.2. Some Details on (Inﬂow) Trace Theory. We still bring up a reﬁnement
of the above explained trace theory. Let us deﬁne T 2
τ±(Γ±) := L2(Γ±, τ±(·,·)|ω ·
ν|dσdωdE) equipped with the inner product

hh1, h2iT 2

τ±

(Γ±) =ZΓ±

h1(y, ω, E)h2(y, ω, E)τ±(y, ω)|ω · ν| dσdωdE.

(40)

Suppose that g ∈ C(Γ−) such that ∂g

local basis of the tangent space of (∂G)r (and ∂g
local sense), and Σ ∈ C(G× S × I) such that ∂Σ

∂ ˜yi ∈ C(Γ−), i = 1, 2, where ∂

denotes any
∂ ˜yi ∈ C(Γ−) is to be understood in a
∂xj ∈ C(G× S × I), j = 1, 2, 3. Then

∂ ˜yi

ON EXISTENCE OF L2-SOLUTIONS FOR COUPLED CSDA

13

the unique (classical) solution of the homogeneous convection-scattering equation
(recall the deﬁnition of D in (18))

satisfying the inhomogeneous inﬂow boundary condition

ω · ∇ψ + Σψ = 0 on D,

ψ(y, ω, E) = g(y, ω, E) ∀(y, ω, E) ∈ Γ−,

is given by ([55], Theorem 3.13)

ψ(x, ω, E) = e− R t(x,ω)

0

Σ(x−sω,ω,E)dsg(x − t(x, ω)ω, ω, E).

(41)

(42)

(43)

We denote by L−g (= ψ) the solution of the problem (41)-(42) that is, L−g is given
by the right hand side of (43). Note that L−g is not generally even continuous (for
non-convex G) even if g happens to be smooth. We show, however, that the formula
(43) gives a weak solution of the problem (41)-(42) in the whole domain G × S × I
for any g ∈ T 2

τ−(Γ−) and that L−g ∈ W 2(G × S × I).

We record the following Lemma for later use.

Lemma 2.9 Assume that Σ ∈ L∞(G × S × I) and that Σ ≥ 0. Then for any
g ∈ T 2
τ−(Γ−) the function L−g deﬁned by (43) (is measurable) and belongs to L2(G×
S × I), and that in fact

kL−gkL2(G×S×I) ≤ kgkT 2

τ−

(Γ−) .

(44)

Moreover, equality holds here if Σ = 0.

Proof. Write LΣ,− for the lift-operator deﬁned in (43) for a given Σ ≥ 0, i.e. ψ =
LΣ,−g. Then

kL0,−gk2

L2(G×S×I) =ZG×S×I

g(x − t(x, ω)ω, ω, E)2dxdωdE

g(y, ω, E)2τ−(y, ω)|ω · ν(y)|dσ(y)dωdE

= ZΓ−
= kgk2

(Γ−) ,

T 2

τ−

where in the second step we applied the change of variables in integration explained
in the proof of Theorem 2.14 below (see Remark 2.15), and noticed that t(y+sω, ω) =
s whenever (y, ω, E) ∈ Γ−. Therefore,
kLΣ,−gk2

Σ(x−sω,ω,E)dsg(x − t(x, ω)ω, ω, E)(cid:1)2dxdωdE

L2(G×S×I) =ZG×S×I(cid:0)e− R t(x,ω)

0

≤ZG×S×I
=kL0,−gk2

g(x − t(x, ω)ω, ω, E)2dxdωdE
L2(G×S×I) = kgk2

(Γ−) .

T 2

τ−

Since t(y, ω) = 0 a.e.

in Γ− we see that γ−(L−g) = g. When we verify (Lemma
2.10) that ω · ∇(L−g) + L−g = 0 (weakly) in G × S × I we can conclude that
L−g ∈ ˜W 2(G × S × I).

(cid:3)

ON EXISTENCE OF L2-SOLUTIONS FOR COUPLED CSDA

14

Lemma 2.10 Assume that Σ ∈ L∞(G × S × I) and that Σ ≥ 0. Let L− :
T 2
τ−(Γ−) → L2(G × S × I) be deﬁned by

(L−g)(x, ω, E) = e− R t(x,ω)

0

Σ(x−sω,ω,E)dsg(x − t(x, ω)ω, ω, E).

Then in the weak sense on G × S × I,

ω · ∇(L−g) + Σ(L−g) = 0.

τ−(Γ−), choosing a sequence gn in C 1

Proof. Given g ∈ T 2
0 (Γ−) that converges to
g in T 2
τ−(Γ−) (the proof of the existence of this kind sequence is quite standard
and is omitted), we have by the continuity of L− (see (44)), that L−gn → L−g in
L2(G × S × I), hence in D′(G × S × I ◦), where I ◦ :=]0, Em[, from which we deduce
that ω·∇(L−gn) + Σ(L−gn) → ω·∇(L−g) + Σ(L−g). in D′(G× S × I ◦). This shows
that we may assume g ∈ C 1

0 (Γ−).

Let ϕ ∈ C ∞

0 (G × S × I ◦). Then by Fubini’s Theorem

e− R t(x,ω)

− (ω · ∇(L−g))(ϕ) = (L−g)(ω · ∇ϕ)
= ZG×S×I
= ZS×IZGωZJy,ω
·
= ZS×IZGωZJy,ω
·

ϕ(y + τ ω, ω, E)dτ dydωdE

ϕ(y + τ ω, ω, E)dsdydωdE

e− R τ

d
dτ

d
dτ

0

Σ(x−sω,ω,E)dsg(x − t(x, ω)ω, ω, E)(ω · ∇ϕ)(x, ω, E)dxdωdE
e− R t(y+τ ω,ω)
Σ(y+(τ −s)ω,ω,E)dsg(y + τ ω − t(y + τ ω, ω)ω, ω, E)

0

τ −t(y+τ ω,ω) Σ(y+sω,ω,E)dsg(y + τ ω − t(y + τ ω, ω)ω, ω, E)

Here Gω is the orthogonal projection of G along ω,

Gω = {x − (x · ω)ω | x ∈ G},

which is an (n − 1)-dimensional open submanifold of Rn. Moreover, Jy,ω is the
intersection of G and the straight line y + Rω,

Jy,ω = {τ ∈ R | y + τ ω ∈ G}.

Notice that Jy,ω is open subset of R, hence disjoint union of countably many open
intervals J i
y,ω = ∅ for all big enough i if there is
only ﬁnitely many non-empty ones)

y,ω[, i ∈ N (we take J i

y,ω =]ai

y,ω, bi

J i
y,ω.

Jy,ω =ai∈N

Noticing also that for all τ ∈ J i

y,ω,

t(y + τ ω, ω) = τ − ai

y,ω

ON EXISTENCE OF L2-SOLUTIONS FOR COUPLED CSDA

15

we have

g(y + ai

y,ωω, ω, E)

d
dτ

ϕ(y + τ ω, ω, E)dτ dydωdE

ϕ(y + τ ω, ω, E)(cid:12)(cid:12)(cid:12)

τ =bi

τ =ai

y,ω

y,ω(cid:17)dydωdE

Σ(y+sω,ω,E)ds

− R τ
ai

y,ω

Σ(y+sω,ω,E)ds

y,ω

y,ω

y,ω

− R τ
ai

Σ(y+sω,ω,E)ds

g(y + ai

y,ωω, ω, E)(cid:16)e

− (ω · ∇(L−g))(ϕ)
= ZS×IZGωXi ZJ i
− R τ
ai
e
= ZS×IZGωXi
+ZS×IZGωXi ZJ i
· g(y + ai
= 0 +ZG×S×I
· g(x − t(x, ω)ω, ω, E)ϕ(x, ω, E)dxdωdE
=(cid:0)Σ(L−g)(cid:1)(ϕ),

Σ(x, ω, E)e− R t(x,ω)

Σ(y + τ ω, ω, E)e

y,ω

0

Σ(x−sω,ω,E)ds

y,ωω, ω, E)ϕ(y + τ ω, ω, E)dydωdE

where at the 3rd equality we used the fact that ϕ vanishes on the boundary of G
and y + ai

y,ωω ∈ ∂G. This completes the proof.

y,ωω ∈ ∂G and y + bi

(cid:3)

Remark 2.11 A. Note that if we assume that there exists c > 0 such that Σ ≥ c
on G × S × I, then in the previous lemma one can take G to be unbounded as well.
τ+(Γ+) the weak solution of the
problem

B. Analogously to Lemma 2.10 for any g ∈ T 2

ω · ∇ψ + Σψ = 0,

for (y, ω, E) ∈ Γ+
is given by (note that (y, ω) ∈ Γ− if and only if (y,−ω) ∈ Γ+)

ψ(y, ω, E) = g(y, ω, E)

(L+g)(x, ω, E) := ψ(x, ω, E) = e− R t(x,−ω)

0

Σ(x−sω,ω,E)dsg(x + t(x,−ω)ω, ω, E).

For later use (section 5) we also treat the inhomogeneous convection-scattering
equation with the homogeneous boundary data. Suppose that f ∈ C(G×S×I) such
that ∂f
∂xj ∈ C(G×S×I), j =
1, 2, 3 . Then the unique (classical) solution of the equation

∂xj ∈ C(G×S×I), and let Σ ∈ C(G×S×I) such that ∂Σ

satisfying the homogeneous inﬂow boundary condition

ω · ∇ψ + Σψ = f

on D,

is given by (cf. [19], or [55], section 3.3)

ψ(y, ω, E) = 0

for (y, ω, E) ∈ Γ−,

ψ(x, ω, E) =Z t(x,ω)

0

We need the next lemma.

e− R t

0 Σ(x−sω,ω,E)dsf (x − tω, ω, E)dt.

(45)

(46)

(47)

Lemma 2.12 Assume that G is bounded, d := diag(G), Σ ∈ L∞(G × S × I)
and that Σ ≥ 0. Then for any f ∈ L2(G × S × I) the formula (47) deﬁnes a

ON EXISTENCE OF L2-SOLUTIONS FOR COUPLED CSDA

16

L2(G × S × I)-function ψ = SΣf and that

kSΣfkL2(G×S×I) ≤ d kfkL2(G×S×I)

(48)

Proof. We have

0

0

kSΣfk2
= ZΓ−Z τ−(y,ω)
= ZΓ−Z τ−(y,ω)
≤ZΓ−Z τ−(y,ω)
= ZΓ−Z τ−(y,ω)
≤ZΓ−

0

0

L2(G×S×I) =ZG×S×I(cid:16)Z t(x,ω)

0

0

e− R t

e− R t

e− R t

0 Σ(x−sω,ω,E)dsf (x − tω, ω, E)dt(cid:17)2
0 Σ(y+(r−s)ω,ω,E)dsf (y + (r − t)ω, ω, E)dt(cid:17)2

(cid:16)Z t(y+rω,ω)
(cid:16)Z r
0 Σ(y+(r−s)ω,ω,E)dsf (y + (r − t)ω, ω, E)dt(cid:17)2
rZ r
0 |f (y + (r − t)ω, ω, E)|2dtdr|ω · ν(y)|dσ(y)dωdE
rZ r
0 |f (y + tω, ω, E)|2dtdr|ω · ν(y)|dσ(y)dωdE

0

τ−(y, ω)2Z τ−(y,ω)

0

|f (y + tω, ω, E)|2dt|ω · ν(y)|dσ(y)dωdE,

dxdωdE

dr|ω · ν(y)|dσ(y)dωdE

dr|ω · ν(y)|dσ(y)dωdE

where we again in the second step applied the change of variables in integration
explained in the proof of Theorem 2.14 below and in the fourth step applied the
Cauchy-Schwartz inequality. Since τ−(y, ω) ≤ d, this gives

kSΣfk2

L2(G×S×I) ≤d2ZΓ−Z τ−(y,ω)

0

= d2 kfk2

L2(G×S×I) .

|f (y + tω, ω, E)|2dt|ω · ν(y)|dσ(y)dωdE

(cid:3)

More generally, we have the following.

Lemma 2.13 Assume that Σ ∈ L∞(G × S × I) and that Σ ≥ 0. Then ψ deﬁned
by (47) satisﬁes weakly in G × S × I,

ω · ∇ψ + Σψ = f,

(49)

and the inﬂow boundary condition (46) is valid.

Proof. Due to (48) it suﬃces to show (49) only for f ∈ C 1(G × S × I). Using the
notations from the proof of Lemma 2.10, for ϕ ∈ C ∞
0 (G × S × I ◦) we get by the

ON EXISTENCE OF L2-SOLUTIONS FOR COUPLED CSDA

17

Fubin’s Theorem

ψ(x, ω, E)(ω · ∇ϕ)(x, ω, E)dxdωdE

ψ(y + τ ω, ω, E)

d
dτ

ϕ(y + τ ω, ω, E)dτ dydωdE

e− R t

0 Σ(y+(τ −s)ω,ω,E)dsf (y + (τ − t)ω, ω, E)

0

y,ω

y,ω

d
dτ

y,ωZ τ −ai

− (ω · ∇ψ)(ϕ) = ψ(ω · ∇ϕ)
= ZG×S×I
= ZS×IZGωXi ZJ i
= ZS×IZGωXi ZJ i
·
= ZS×IZGωXi ZJ i
·
= ZS×IZGωXi ZJ i
·

y,ωZ τ

d
dτ

d
dτ

y,ω

y,ω

ai

ϕ(y + τ ω, ω, E)dtdτ dydωdE

ϕ(y + τ ω, ω, E)dtdτ dydωdE

e− R τ −t

0

Σ(y+(τ −s)ω,ω,E)dsf (y + tω, ω, E)

f (y + tω, ω, E)Z bi

t

y,ω

e− R τ

t Σ(y+sω,ω,E)ds

ϕ(y + τ ω, ω, E)dτ dtdydωdE.

In the last step, we changed the order of integration dtdτ → dτ dt, in which the
domain of integration

{(τ, t) | τ ∈ J i

y,ω =]ai

y,ω, bi

y,ω[, t ∈]ai

y,ω, τ [}

changes to

as usual.

Observing that

{(t, τ ) | t ∈ J i

y,ω =]ai

y,ω, bi

y,ω[, τ ∈]t, bi

y,ω[}

ϕ(y + τ ω, ω, E)dτ

τ =bi

y,ω

τ =t (cid:17)

t

y,ω

d
dτ

e− R τ

t Σ(y+sω,ω,E)ds ·

Z bi
t Σ(y+sω,ω,E)dsϕ(y + τ ω, ω, E)(cid:12)(cid:12)(cid:12)
=(cid:16)e− R τ
+Z bi
= − ϕ(y + tω, ω, E) +Z bi

Σ(y + τ ω, ω, E)e− R τ

y,ω

y,ω

t

t

t Σ(y+sω,ω,E)dsϕ(y + τ ω, ω, E)dτ

Σ(y + τ ω, ω, E)e− R τ

t Σ(y+sω,ω,E)dsϕ(y + τ ω, ω, E)dτ,

ON EXISTENCE OF L2-SOLUTIONS FOR COUPLED CSDA

18

we obtain

y,ω

y,ω

t

Σ(y + τ ω, ω, E)e− R τ

f (y + tω, ω, E)(cid:16) − ϕ(y + tω, ω, E)

− (ω · ∇ψ)(ϕ)
= ZS×IZGωXi ZJ i
+Z bi
= −ZG×S×I
+ZG×S×I
= ZG×S×I(cid:0) − f (x, ω, E) + Σ(x, ω, E)ψ(x, ω, E)(cid:1)ϕ(x, ω, E)dxdωdE

Σ(x, ω, E)Z t(x,ω)

f (x, ω, E)ϕ(x, ω, E)dxdωdE

t Σ(y+sω,ω,E)dsϕ(y + τ ω, ω, E)dτ(cid:17)dtdydωdE

which is what we set out to prove.

e− R t

0 Σ(x−sω,ω,E)dsf (x − tω, ω, E)dtϕ(x, ω, E)dxdωdE

0

Choosing especially Σ = 0, f = 1 in Lemma 2.13 we ﬁnd that in the weak sense

ω · ∇t = 1 in G × S × I.
We are now ready to prove the inﬂow trace theorem. Since kωk = 1 and since
the domain G is bounded we have τ±(y, ω) ≤ d. Hence from [19], p. 252, [15] or
[16] (where the result is considered for a more general G) we obtain the following
theorem. For completeness we give its detailed proof.

(cid:3)

Theorem 2.14 The trace mappings

γ± : W 2(G × S × I) → T 2

τ±(Γ±)

are (well-deﬁned) bounded surjective operators with bounded right inverses L± :
T 2
τ±(Γ±) → W 2(G × S × I) that is, γ± ◦ L± = I (the identity). The operators L±
are called lifts.

Below we use abbreviation L := L− if no confusion is possible.

Proof. A. For the ﬁrst instance we recall an elementary estimate for (smooth) func-
tions deﬁned on an interval [0, T ] ⊂ R. Let f ∈ C 1([0, T ]). Then for any s ∈ [0, T ]

which implies (by the Cauchy-Schwartz’s inequality) that

f (0) = −Z s

0

f ′(t)dt + f (s)

Hence integrating over [0, T ] we obtain the estimate

|f (0)|2 ≤ 2(cid:16)sZ s

0 |f ′(t)|2dt + |f (s)|2(cid:17) ≤ 2(cid:16)T kf ′k2
T|f (0)|2 ≤ 2(cid:16)T 2 kf ′k2
L2([0,T ]) + kfk2

L2([0,T ]) + |f (s)|2(cid:17).
L2([0,T ])(cid:17).

(50)

(51)

B. We shall only deal with the trace γ− because the treatment of the trace γ+ is
analogous. At ﬁrst we show the boundedness of γ−. Since C 1(G × S × I) is dense
in W 2(G × S × I) (by Theorem 2.7) it suﬃces to prove that there exists a constant
C > 0 such that

kγ−(ψ)kT 2

τ−

(Γ−) ≤ C kψkW 2(G×S×I)

∀ψ ∈ C 1(G × S × I).

(52)

ON EXISTENCE OF L2-SOLUTIONS FOR COUPLED CSDA

19

We apply the change of variables given in [55], the proof of Lemma 5.8 (cf. also
[16], Prop. 2.1). Assume for simplicity that ∂G has a C 1-parametrization (which is
almost global), say h : V → ∂G \ Γ1 where Γ1 has zero surface measure. Generally
we have a ﬁnite number of parametrized patches that cover ∂G. Applying for each
ﬁxed ω the change of variables (in x-variable) x = h(v) + tω =: H(v, t), we ﬁnd that
the Jacobian JH of H is

JH(v, t) = ω · (∂1h × ∂2h)(v) = ω · ν(h(v))k(∂1h × ∂2h)(v)k ,

since ν(h(v)) = (∂1h×∂2h)(v)
k(∂1h×∂2h)(v)k . We notice that JH(v, t) depends only on v (and ω), but
not on t, and hence we write it as JH(v). Moreover, almost everywhere H(W ) = G,
where W := {(v, t) | v ∈ V−, 0 < t < τ−(h(v), ω)} and V− := {v ∈ V | ω · ν(h(v)) <
0} (which depend on ω). Hence for any ψ ∈ C 1(G × S × I)

ZG×S×I |ψ(x, ω, E)|2dxdωdE =ZS×I(cid:16)ZG |ψ(x, ω, E)|2dx(cid:17)dωdE
= ZS×IZW |ψ(H(v, t), ω, E)|2|JH(v, t)|dvdtdωdE
= ZS×IZV−Z τ−(h(v),ω)
[0, τ−(h(v), ω)] → R deﬁned by

|ψ(h(v) + tω, ω, E)|2|JH(v, t)|dtdvdωdE.

For a ﬁxed (v, ω) ∈ V− and E ∈ I we apply (51) to the C 1-mapping f :

(53)

0

f (t) := ψ(h(v) + ωt, ω, E).

Noting that f ′(t) = (ω · ∇ψ)(h(v) + ωt, ω, E) we obtain the estimate
τ−(h(v), ω)|ψ(h(v), ω, E)|2 ≤ 2(cid:16)τ−(h(v), ω)2Z τ−(h(v),ω)

0

|(ω · ∇ψ)(h(v) + ωt, ω, E)|2dt

(54)

Utilizing these preliminaries and the fact that τ−(h(v), ω) ≤ d we get

0

+Z τ−(h(v),ω)

|ψ(h(v) + ωt, ω, E)|2dt(cid:17).
(Γ−) =ZΓ− |ψ(y, ω, E)|2τ−(y, ω)|ω · ν(y)|dσdωdE

τ−

T 2

kγ−(ψ)k2
= ZS×IZV− |ψ(h(v), ω, E)|2τ−(h(v), ω)|ω · ν(h(v))| k(∂1h × ∂2h)(v)k dvdωdE
= ZS×IZV− |ψ(h(v), ω, E)|2τ−(h(v), ω)|JH(v)|dvdωdE
≤ZS×IZV−

0

2(cid:16)d2Z τ−(h(v),ω)
+Z τ−(h(v),ω)
L2(G×S×I) + kψk2

0

|(ω · ∇ψ)(h(v) + ωt, ω, E)|2|JH(v)|dt
|ψ(h(v) + ωt, ω, E)|2|JH(v)|dt(cid:17)

= 2(cid:16)d2 kω · ∇ψk2
where we in the last step applied (53) to ω · ∇ψ and to ψ. This completes the
boundedness claim of γ−.
C. Next we prove the existence of the right inverses. Again we consider only
the case of γ−. We choose Σ = 0 in Lemma 2.10 and deﬁne the right inverse

L2(G×S×I)(cid:17)

(55)

ON EXISTENCE OF L2-SOLUTIONS FOR COUPLED CSDA

20

L− : T 2

τ−(Γ−) → W 2(G × S × I) by

(56)
Then by (44) L− : T 2
τ−(Γ−) → W 2(G × S × I) is a well-deﬁned bounded linear
operator, which is even isometric embedding (which follows since Σ = 0). This
completes the proof.
(cid:3)

L−g := g(x − t(x, ω)ω, ω, E).

Remark 2.15 From the proof of the previous lemma we get the following useful
formulas (when the integrals exist)

(57)

g(y, ω, E)dσdωdE =ZS×IZV−

ZΓ−
g(h(v), ω, E)k(∂1h × ∂2h)(v)k dvdωdE,
where V− = {v ∈ V | ω · ν(h(v)) < 0} (which depends on ω), and (see (53))
ZG×S×I |ψ(x, ω, E)|2dxdωdE
= ZS×IZV−Z τ−(h(v),ω)
= ZΓ−Z τ−(y,ω)
Remark 2.16 A. For any compact set K ⊂ Γ− we have τ−(y, ω) ≥ cK > 0 for all
(y, ω, E) ∈ K and so the estimate (29) follows from Theorem 2.14.
B. The formula (56) gives the lift L−g explicitly which is useful e.g. in numerical
computations. Note that the lift is not unique (for example, we are able to deﬁne
L− = LΣ,− for any Σ given above).

|ψ(h(v) + tω, ω, E)|2|ω · ν(h(v))| k(∂1h × ∂2h)(v)k dtdvdωdE

|ψ(y + tω, ω, E)|2|ω · ν(y)|dtdσ(y)dωdE.

(58)

0

0

Analogously to L− the (isometric) lift L+ : T 2

τ+(Γ+) → W 2(G × S × I) can be

chosen to be

(L+g)(x, ω, E) := g(x + t(x,−ω)ω, ω, E).

C. We have for any w ∈ L2(G × S × I) and g ∈ T 2(Γ−) (as in (53)
hL−g, wiL2(G×S×I) =ZG×S×I
g(x − t(x, ω)ω, ω, E)w(x, ω, E)dxdωdE
=ZS×IZV−Z τ−(h(v),ω)
=ZS×IZV−
=(cid:10)g, L∗
−w(cid:11)T 2

where we used the fact t(h(v) + tω) = t and deﬁned

g(h(v), ω, E)(L∗

(Γ−)

τ−

0

g(h(v) + tω − t(h(v) + tω)ω, ω, E)w(h(v) + tω, ω, E)|JH(v, t)|dvdωdEdt

−w)(h(v), ω, E)τ−(h(v), ω)|ω · ν(h(v))| k∂1h × ∂2hk dvdωdE

(59)

(L∗

−w)(y, ω, E) :=

w(y + tω, ω, E)dt.

(60)

1

τ−(y, ω)Z τ−(y,ω)

0

Hence L∗
the preceding computations we ﬁnd that

− is the adjoint of the operator L− : T 2

τ−(Γ−) → L2(G × S × I). Applying

(Γ−) ≤ kwkL2(G×S×I) .

(cid:13)(cid:13)L∗
−w(cid:13)(cid:13)T 2

τ−

ON EXISTENCE OF L2-SOLUTIONS FOR COUPLED CSDA

21

τ−

− : T 2

we recall that the adjoint γ∗

(Γ−) =(cid:10)ψ, γ∗

τ−(Γ−)
τ−(Γ−) → L2(G × S × I) exists and it is deﬁned by

D. Interpreting γ− as a densely deﬁned linear operator L2(G × S × I) → T 2
−(g)(cid:11)L2(G×S×I) for ψ ∈ W 2(G × S × I), g ∈ D(γ∗

hγ−(ψ), giT 2
The knowledge of adjoints is signiﬁcant in the theory of existence of solutions. For
example, the Fredholm alternative theorem is essential in the cases where the unique
solution does not exist. To demonstrate that, consider (for simplicity) the problem
(1), (2). Let T = (T1, T2, T3) be the transport operator related to the problem that
is, Tjψ := ω · ∇ψj + Σjψj − Kjψj. Then the transport problem reads

−).

Aψ :=(cid:18) T

γ−(cid:19) ψ =(cid:18)f
g(cid:19)

(61)

(62)

where A is interpreted as a densely deﬁned closed operator L2(G × S × I)3 →
τ−(Γ−)3 with D(A) := W 2(G× S × I)3. We ﬁnd that the adjoint
L2(G× S × I)3 × T 2
τ−(Γ−)3 → L2(G × S × I)3
A∗ of A is a densely deﬁned operator L2(G × S × I)3 × T 2
given by

A∗(cid:18)u

v(cid:19) :=(cid:0)T ∗ γ∗

−(cid:1)(cid:18)u

v(cid:19) for (cid:18)u

v(cid:19) ∈ D(A∗)

where T ∗ = (T ∗
j is given
in section 6). Supposing that A is a Fredholm operator we have R(A) = N(A∗)⊥.

j u := −ω·∇uj +Σjuj−K ∗

j u (the operator K ∗

3 ) with T ∗

2 , T ∗

1 , T ∗

Hence a necessary and suﬃcient condition for the existence of solutions of Aψ =(cid:18)f
g(cid:19)

is the orthogonality criterion

h(f, g), (u, v)iL2(G×S×I)3×T 2

τ−

(Γ−)3 = 0

(63)

for all (u, v) ∈ N(A∗) that is, for all (u, v) ∈ D(A∗) ⊂ L2(G × S × I)3 × T 2
which obey

τ−(Γ−)3

T ∗u + γ∗

−v = 0.

Under the due assumptions the transport operator T is (after an appropriate
change of variables) a pseudo-diﬀerential operator (actually only the term K needs
careful treatment). Hence the application of the pseudo-diﬀerential boundary value
operator calculus is possible. We omit here all details concerning for these ap-
proaches.

E. For (y, ω, E) ∈ Γ+ it is reasonable to set (cf. Proposition 2.5)

(L−g)(y, ω, E) := g(y − τ+(y, ω)ω, ω, E),

g ∈ T 2

τ−(Γ−).

From [19], p. 253 (or [15]) it follows that for g ∈ T 2
and τ|Γ0 = 0, there exists an element ˜ψ ∈ ˜W 2(G × S × I) such that

τ (Γ), where τ|Γ− = τ−, τ|Γ+ = τ+

γ−( ˜ψ) = g|Γ− =: g− and γ+( ˜ψ) = g|Γ+ =: g+

if and only if

(g − L−(g−))|Γ+ ∈ L2(Γ+, τ −1

+ (y, ω)|ω · ν(y)|dσdωdE).

G. It can also be shown that γ− : ˜W 2

− (y, ω)|ω· ν|dσdE)
is bounded (note again that for bounded G we have τ−(x, ω) ≤ d) and that it has a
bounded right inverse L−,0 : L2(Γ−, τ −1
−,0(G × S × I) ([14]
or [19], p.252). Similar result hold for γ+.

−,0(G× S × I) → L2(Γ−, τ −1
− (y, ω)|ω · ν|dσdE) → ˜W 2

ON EXISTENCE OF L2-SOLUTIONS FOR COUPLED CSDA

22

We still consider the following special case of the trace theory for an exterior
of a convex bounded domain G. Let Ge be the complement (the exterior of G)
Ge := R3 \ G. Then ∂Ge = ∂G. Denote (as above for G)

Γe,+ := {(y, ω, E) ∈ (∂Ge)r × S × I) = (∂G)r × S × I)| ω · νe(y) > 0},

Γe,− := {(y, ω, E) ∈ (∂Ge)r × S × I) = (∂G)r × S × I)| ω · νe(y) < 0},

Γe := Γe,+ ∪ Γe,−

where νe is the unit outward pointing normal vector on (∂Ge)r. We ﬁnd that νe = −ν
and then Γe,± = Γ∓ and γe,±(ψ) := ψ|Γe,± = γ∓(ψ). Furthermore, let te(x, ω) be the
escape time mapping for the domain Ge and let for an element (y, ω, E) ∈ Γe,− (as
above) τe,−(y, ω) = inf{s > 0 | y + sω 6∈ Ge}. We observe that for the convex set G
actually τe,−(y, ω) = ∞ for all (y, ω, E) ∈ Γe,−.
Theorem 2.17 The trace mappings

γe,± : W 2(Ge × S × I) → T 2(Γe,±)

are (well-deﬁned) bounded surjective operators with bounded right inverses (lifts)
Le,± : T 2(Γe,±) → W 2(Ge × S × I).
Proof. Again it needs only to consider the trace operator γ−. The proof runs simi-
larly to the proof of Theorem 2.14 with following changes. Instead of estimate (51)
we utilize the inequality

0

0

0

0

d
dt

0

2f ′(t)f (t)dt(cid:12)(cid:12)(cid:12)
≤Z ∞

=(cid:12)(cid:12)(cid:12)Z ∞
|f (t)|2dt(cid:17)1/2

|f (0)|2 =(cid:12)(cid:12)(cid:12)Z ∞
(f (t)2)dt(cid:12)(cid:12)(cid:12)
≤ 2(cid:16)Z ∞
|f ′(t)|2dt(cid:17)1/2(cid:16)Z ∞
which is valid for all f ∈ C 1
W := {(v, t) | v ∈ V−, 0 < t < ∞} and V− := {v ∈ V | ω · νe(h(v)) < 0}.
Ψ of the problem

Let λ > 0. For any ge ∈ C(Γe,−) such that ∂ge

|f ′(t)|2dt +Z ∞

0 ([0,∞[) (note that f (t) = 0 for suﬃciently large t).

In addition, one applies the change of variables H we have H(W ) = Ge where

∂ ˜yi ∈ C(Γe,−) the (classical) solution

|f (t)|2dt,

0

(64)

ω · ∇Ψ + λΨ = 0 on De,

Ψ|Γe,− = ge,

(65)

where De is the set (18) corresponding to Ge× S × I, is given explicitly by (cf. (43))
Ψ(x, ω, E) =(e−λte(x,ω)ge(x − te(x, ω)ω, ω, E), when te(x, ω) is ﬁnite
Similarly to the proof of Lemma 2.10 we ﬁnd that (65) holds weakly in Ge × S × I.
For ge ∈ T 2(Γe,−) we deﬁne the lift explicitly by
Le,−ge := Ψ.

otherwise

(67)

(66)

0,

.

ON EXISTENCE OF L2-SOLUTIONS FOR COUPLED CSDA

23

Then as in the proof of Lemma 5.8 given in [55] we get that Le,−ge ∈ ˜W 2(Ge×S×I)
and (note that kω · ∇ΨkL2(Ge×S×I) = λkΨkL2(Ge×S×I))

kLe,−gekW 2(Ge×S×I) = kΨkW 2(Ge×S×I) = √1 + λ2 kΨkL2(Ge×S×I)

since (cf. Remark 2.15)

=r 1 + λ2
L2(Ge×S×I) = ZΓe,−Z τe,−(x,ω)

0

kΨk2

2λ kgekT 2(Γe,−) ,

(68)

(cid:3)

(cid:0)e−λsge(y, ω, E)(cid:1)2|ω · ν(y)|dsdσ(y)dωdE

ge(y, ω, E)2|ω · ν(y)|dσ(y)dωdE

=

=

1

2λZΓe,−
1
2λ kgek2

T 2(Γe,−) ,

where τe,− is τ− for the domain Ge × S × I. We omit further details.
Remark 2.18 A. By (66) one can show that

Le,−(ge,−)|Γe,+ = 0.

B. The lift Le,+ : T 2(Γe,+) → W 2(Ge × S × I) is given by
(Le,+)(x, ω, E) =(e−λte(x,−ω)ge(x + te(x,−ω)ω, ω, E), when te(x,−ω) is ﬁnite,

otherwise.

0,

We ﬁnd that

Le,+(ge,+)|Γe,− = 0.

C. Let ge ∈ T 2(Γe) and let ge,± := ge|Γe,±. Then for

˜Ψ := Le,−(ge,−) + Le,+(ge,+) ∈ W 2(Ge × S × I),

we ﬁnd that ˜Ψ ∈ ˜W 2(Ge × S × I) and

˜Ψ|Γe,± = ge,±.

(See Remark 2.16, Part E.)

As a corollary we show the following extension result. In the proof we explicitly

construct the extension of ψ (cf. [19], p. 415, the proof of Lemma 2).

Corollary 2.19 Suppose that G ⊂ R3 is as above and that it is convex. Then for
any ψ ∈ ˜W 2(G× S × I) there exists an extension Eψ ∈ W 2(R3 × S × I) of ψ that is,
Eψ|G×S×I = ψ. In addition, the linear operator E : ˜W 2(G×S×I) → W 2(R3×S×I)
is bounded.

Proof. Suppose that ψ ∈ ˜W 2(G × S × I). Denote g := ψ|Γ, which belongs to
T 2(Γ) = T 2(Γe). Let ˜Ψ ∈ ˜W 2(Ge × S × I) given in Remark 2.18, Part C. Deﬁne Eψ
by

ψ
γ±(ψ) = γe,∓( ˜Ψ)
˜Ψ

on G × S × I
on Γ±
on Ge × S × I

Eψ :=


(69)

ON EXISTENCE OF L2-SOLUTIONS FOR COUPLED CSDA

24

Then Eψ is in W 2(R3 × S × I). This follows from the Green’s formula (35) since for
all v ∈ C ∞

0 (R3 × S × I ◦)
ZR3×S×I
= ZG×S×I
= −ZG×S×I
−ZGe×S×I
= −ZG×S×I

(Eψ) (ω · ∇v)dxdωdE
(Eψ) (ω · ∇v)dxdωdE +ZGe×S×I
(ω · ∇ψ)vdxdωdE +Z∂G×S×I
(ω · ∇ ˜Ψ)vdxdωdE +Z∂Ge×S×I
(ω · ∇ψ)vdxdωdE −ZGe×S×I

(Eψ) (ω · ∇v)dxdωdE

γ(ψ) γ(v)(ω · ν)dσdωdE
γe( ˜Ψ) γe(v)(ω · νe)dσdωdE

(ω · ∇ ˜Ψ)vdxdωdE

(70)

(71)

(73)

(74)

where we used the facts that ∂G = ∂Ge and νe = −ν and so γ±(ψ) =: g± = ge,∓ :=
γe,∓( ˜Ψ). Hence ω · ∇(Eψ) ∈ L2(R3 × S × I), as desired.

Finally, we ﬁnd that by (68) (recall Remark 2.18, Part C.)

kEψkW 2(R3×S×I) = kψkW 2(G×S×I) +(cid:13)(cid:13)(cid:13)
≤kψkW 2(G×S×I) + kLe,−(ge,−)kW 2(Ge×S×I) + kLe,+(ge,+)kW 2(Ge×S×I)
= kψkW 2(G×S×I) +r 1 + λ2
2λ (cid:16)kγ+(ψ)kT 2(Γe,−) + kγ−(ψ)kT 2(Γe,+)(cid:17)

˜Ψ(cid:13)(cid:13)(cid:13)W 2(Ge×S×I)

which implies the boundedness of E. This completes the proof.

(72)

(cid:3)

Let ˜W

2

(G×S×I) be the completion of C 1(G×S×I) with respect to k·k ˜W 2(G×S×I)-

norm. For a convex set G ⊂ R3 have the following density result.
Corollary 2.20 Suppose that G ⊂ R3 is as above and that it is convex. Then

˜W2(G × S × I) = ˜W 2(G × S × I),

and

H2 = ˜W 2(G × S × I) ∩ W 2

1 (G × S × I).

(Deﬁnitions of the spaces W 2
tively.)

1 , ˜W 2 and H2 were given in (23), (32) and (39), respec-

Proof. At ﬁrst, we deal with the claim (73). The inclusion ” ⊂ ” is clear and then
it suﬃces to prove only the opposite inclusion.

Because G is convex we have by Theorem 2.17

kγe(Ψ)kT 2(Γe) ≤ C kΨkW 2(Ge×S×I)

(75)
Let ψ ∈ ˜W 2(G × S × I) and let Eψ ∈ W 2(R3 × S × I) be its extension provided
by Lemma 2.19. Since C 1
0 (R3 × S × R) is dense in W 2(R3 × S × I) there exists a
sequence {Ψn} ⊂ C 1
0 (R3 × S × R) such that kΨn − EψkW 2(R3×S×I) → 0 for n → ∞.
Let ψn := Ψn|G×S×I. We have

∀Ψ ∈ W 2(Ge × S × I).

kγ(ψn − ψ)kT 2(Γ) = kγe(Ψn − Eψ)kT 2(Γe) .

ON EXISTENCE OF L2-SOLUTIONS FOR COUPLED CSDA

25

Hence we get by (75)

kψn − ψk2

˜W 2(G×S×I) = kψn − ψk2
≤kΨn − Eψk2
≤kΨn − Eψk2

W 2(G×S×I) + kγ(ψn − ψ)k2
W 2(G×S×I) + C 2 kΨn − Eψk2
W 2(R3×S×I) + C 2 kΨn − Eψk2

T 2(Γ)

W 2(Ge×S×I)
W 2(R3×S×I) ,
which implies that ψ ∈ ˜W2(G × S × I). This completes the proof of (73).
and so the proof is complete.

0 (R3 × S × I) is dense in W 2

1 (R3 × S × I) the proof of (74) is quite similar

Since C 1

(76)

(cid:3)

Finally, we notice that the following continuous inclusions are valid

˜W 2(G × S × I) ⊂ H;

ψ 7→ (ψ, γ(ψ)),

and

˜W 2(G × S × I) ∩ W 2

1 (G × S × I) ⊂ H1;

ψ 7→ (ψ, γ(ψ), ψ(·,·, 0), ψ(·,·, Em)).

Remark 2.21 Let ρ1, ρ2 : I → R be positive (weight) functions in L∞(I). We
can deﬁne a linear space (more generally instead of W 2(G × S × I)) by

W 2
ρ1,ρ2(G × S × I) = {ψ ∈ L2(G × S × I) |

ρ1ω · ∇ψ ∈ L2(G × S × I),
∂ψ
∂E ∈ L2(G × S × I)},
ρ2

which can be equipped with the inner product

hψ, viW 2

ρ1,ρ2

(G×S×I) = hψ, viL2(G×S×I) + hρ1ω · ∇ψ, ρ1ω · ∇viL2(G×S×I)

+(cid:28)ρ2

∂ψ
∂E

, ρ2

∂v

∂E(cid:29)L2(G×S×I)

,

(77)

(78)

(79)

rendering W 2
ρ1,ρ2(G × S × I) to a Hilbert space. Similar weighted spaces can be
deﬁned generalizing other spaces above. These spaces are needed e.g. in the context
of time-dependent transport equations (where ρ1 = ρ2 = √E).

3. Single Continuous Slowing Down equation

3.1. Preliminaries. At ﬁrst we consider a single CSDA transport equation given
by

∂(S0ψ)

∂E

−

+ ω · ∇ψ + Σψ − Kψ = f

on G × S × I,

where the solution satisﬁes inﬂow boundary and initial value conditions

We assume that

ψ|Γ− = g
ψ(·,·, Em) = 0

on Γ−,

on G × S.

Σ ∈ L∞(G × S × I), Σ ≥ 0

(80)

(81)

(82)

(83)

ON EXISTENCE OF L2-SOLUTIONS FOR COUPLED CSDA

26

in a.e. sense on G × S × I. Furthermore, the collision operator is given for ψ ∈
L2(G × S × I) by

(Kψ)(x, ω, E) =ZS×I

σ(x, ω′, ω, E′, E)ψ(x, ω′, E′)dω′dE′,

(84)

where σ : G × S2 × I 2 → R is a non-negative measurable function such that

ZS×I
ZS×I

σ(x, ω′, ω, E′, E)dω′dE′ ≤ M1,
σ(x, ω, ω′, E, E′)dω′dE′ ≤ M2,

(85)

for a.e. (x, ω, E) ∈ G × S × I, and we assume that there exists c ≥ 0 such that

Σ(x, ω, E) −ZS×I
Σ(x, ω, E) −ZS×I

σ(x, ω, ω′, E, E′)eC(E′−E)dω′dE′ ≥ c,
σ(x, ω′, ω, E′, E)eC(E−E′)dω′dE′ ≥ c,

(86)

for a.e. (x, ω, E) ∈ G × S × I, and where the constant c ≥ 0 is speciﬁed below (see
(102)). Note that in some cases we will assume c to be strictly positive, c > 0. This
assumption has been relaxed in [22] (cf. also [19], Remark 15, pp. 241-242). We
have by Cauchy-Schwarz inequality and (85),

kKk ≤(cid:13)(cid:13)(cid:13)(cid:13)
ZS×I
≤M1

σ(·, ω′,·, E′,·)dω′dE′(cid:13)(cid:13)(cid:13)(cid:13)
L∞(cid:13)(cid:13)(cid:13)(cid:13)
ZS×I

1/2,

1/2M2

1/2

σ(·,·, ω′,·, E′)dω′dE′(cid:13)(cid:13)(cid:13)(cid:13)

1/2

L∞

(87)

where L∞ = L∞(G× S × I), kKk is the norm of K as an operator in L2(G× S × I),
and
(cid:13)(cid:13)(cid:13)(cid:13)
ZS×I
(cid:13)(cid:13)(cid:13)(cid:13)
ZS×I

σ(·, ω′,·, E′,·)dω′dE′(cid:13)(cid:13)(cid:13)(cid:13)L∞(G×S×I)
σ(·,·, ω′,·, E′)dω′dE′(cid:13)(cid:13)(cid:13)(cid:13)L∞(G×S×I)

(x,ω,E)∈G×S×IZS×I
(x,ω,E)∈G×S×IZS×I

σ(x, ω′, ω, E′, E)dω′dE′,

σ(x, ω, ω′, E, E′)dω′dE′.

= ess sup

= ess sup

(88)

In what follows, we assume that the stopping power S0 : G × I → R satisﬁes the

following assumptions:

S0 ∈ L∞(G × I),
∂S0
∂E ∈ L∞(G × I),
κ := inf

(x,E)∈G×I

S0(x, E) > 0

∇S0 ∈ L∞(G × I).

(89)

(90)

(91)

(92)

We remark that the assumption (92) will be needed only in the context of the theory
of evolution operators in section 3.4.

ON EXISTENCE OF L2-SOLUTIONS FOR COUPLED CSDA

27

Remark 3.1 Assume that ˜σ : G × S2 × I → R is a measurable non-negative
function, and that the cross-section σ is (formally) of the form
σ(x, ω′, ω, E′, E) = ˜σ(x, ω′, ω, E)δ(E′ − E),

in the sense that the collision operator K is given by

(Kψ)(x, ω, E) =ZS

˜σ(x, ω′, ω, E)ψ(x, ω′, E)dω′, ψ ∈ L2(G × S × I).

(93)

In this case the assumptions (85) and (86) for any C mean that

ZS
ZS
for a.e. (x, ω) ∈ G × S × I, and

˜σ(x, ω′, ω, E)dω′ ≤ M1,
˜σ(x, ω, ω′, E)dω′ ≤ M2,

Σ(x, ω, E) −ZS
Σ(x, ω, E) −ZS

˜σ(x, ω, ω′, E)dω′ ≥ c,
˜σ(x, ω′, ω, E)dω′ ≥ c,

(94)

(95)

(97)

(98)

(99)

for a.e. (x, ω, E) ∈ G × S × I. All results proved in this paper are valid for these
(simpliﬁed) collision operators. The estimate (87) in this case is

1/2

L∞(G×S×I) ≤ M1

1/2M2

1/2,

(96)

where kKk is the norm of K as an operator in L2(G × S × I), and

ZS

1/2

ZS

L∞(G×S×I)(cid:13)(cid:13)(cid:13)(cid:13)
˜σ(·, ω′,·,·)dω′(cid:13)(cid:13)(cid:13)(cid:13)
kKk ≤(cid:13)(cid:13)(cid:13)(cid:13)
˜σ(·, ω′,·,·)dω′(cid:13)(cid:13)(cid:13)(cid:13)L∞(G×S×I)
(cid:13)(cid:13)(cid:13)(cid:13)
ZS
˜σ(·,·, ω′,·)dω′(cid:13)(cid:13)(cid:13)(cid:13)L∞(G×S×I)
(cid:13)(cid:13)(cid:13)(cid:13)
ZS

Let

˜σ(·,·, ω′,·)dω′(cid:13)(cid:13)(cid:13)(cid:13)
(x,ω,E)∈G×S×IZS
(x,ω,E)∈G×S×IZS

= ess sup

= ess sup

˜σ(x, ω′, ω, E)dω′

˜σ(x, ω, ω′, E)dω′

∂S0
∂E

(x, E) ≥ 0(cid:9).

We begin with a lemma.

C+ :=(cid:8)(x, E) ∈ G × I (cid:12)(cid:12)
Lemma 3.2 For all ψ ∈ C 1(G × S × I)
(cid:28) ∂(S0ψ)

, ψ(cid:29)L2(G×S×I) ≤ q kψk2

L2(G×S×I)

∂E

+

where

1

2ZG×S(cid:0)S0(x, Em)ψ2(x, ω, Em) − S0(x, 0)ψ2(x, ω, 0)(cid:1)dxdω,

q :=

.

1

2(cid:13)(cid:13)(cid:13)(cid:13)

∂S0

∂E(cid:13)(cid:13)(cid:13)(cid:13)L∞(C+)

ON EXISTENCE OF L2-SOLUTIONS FOR COUPLED CSDA

28

Proof. Integrating by parts, we have

∂E

∂E

=(cid:28) ∂S0

, ψ(cid:29)L2(G×S×I)
ψ, ψ(cid:29)L2(G×S×I) −(cid:28)ψ,

(cid:28) ∂(S0ψ)
= (cid:28) ∂S0
+ZG×S(cid:0)S0(x, Em)ψ(x, ω, Em)2 − S0(x, 0)ψ(x, ω, 0)2(cid:1)dxdω,

ψ, ψ(cid:29)L2(G×S×I)
∂E (cid:29)L2(G×S×I)

+(cid:28) ∂ψ

∂(S0ψ)

∂E

∂E

and therefore

, S0ψ(cid:29)L2(G×S×I)

(100)

∂E

∂E

2(cid:28)∂(S0ψ)
= (cid:28) ∂S0
≤(cid:28) ∂S0
≤2q kψk2

, ψ(cid:29)L2(G×S×I)
ψ, ψ(cid:29)L2(G×S×I)
+ZG×S(cid:0)S0(x, Em)ψ(x, ω, Em)2 − S0(x, 0)ψ(x, ω, 0)2(cid:1)dxdω
ψ, ψ(cid:29)L2(A+)
+ZG×S(cid:0)S0(x, Em)ψ(x, ω, Em)2 − S0(x, 0)ψ(x, ω, 0)2(cid:1)dxdω
L2(G×S×I) +ZG×S(cid:0)S0(x, Em)ψ(x, ω, Em)2 − S0(x, 0)ψ(x, ω, 0)2(cid:1)dxdω,

∂E

(101)

where A+ := {(x, ω, E) ∈ G × S × I | (x, E) ∈ C+}. This ﬁnishes the proof.

(cid:3)

C below vanishes).

Note that if E 7→ S0(x, E) is decreasing for every x ∈ G then q = 0 (and therefore
Let

C :=

q
κ

=

1

2(cid:13)(cid:13)

∂S0

∂E(cid:13)(cid:13)L∞(C+)

inf (x,E)∈G×I S0(x, E)

.

(102)

We make the following change of the unknown function. We replace ψ by φ(x, ω, E) :=
eCEψ(x, ω, E). This substitution changes the equation (80) to (here and below by
writing eCE we mean a function (x, ω, E) 7→ eCE)

∂(S0φ)

−

∂E

+ ω · ∇φ + CS0φ + Σφ − KCφ = eCEf,

(103)

where KC is given by

(KCφ)(x, ω, E) =ZS×I

σ(x, ω′, ω, E′, E)eC(E−E′)φ(x, ω′, E′)dω′dE′.

(104)

The inﬂow boundary and the initial conditions are
φ|Γ− = eCEg,

φ(x, ω, Em) = 0,

(105)

(106)

the latter (initial) condition holding for a.e. (x, ω) ∈ G × S.
Lemma 3.3 Assume that the conditions (83), (85) and (86) are valid. Then

Σ − KC : L2(G × S × I) → L2(G × S × I)

is a bounded operator and it satisﬁes the following accretivity condition
L2(G×S×I) , φ ∈ L2(G × S × I).

h(Σ − KC)φ, φiL2(G×S×I) ≥ ckφk2

(107)

ON EXISTENCE OF L2-SOLUTIONS FOR COUPLED CSDA

29

Proof. Since I = [0, Em], where Em < ∞, we ﬁnd that the conditions (85) are
valid also for σC(x, ω′, ω, E′, E) := σ(x, ω′, ω, E′, E)eC(E−E′), possibly with diﬀerent
M1, M2. This observation combined with assumptions (83), (86), implies the result
by a fairly simple application of Cauchy-Schwarz inequality, see [19], Theorem 4, p.
241.
(cid:3)

τ−(Γ−), or g ∈ T 2

Remark 3.4 In the study below, the standing assumption for the (inﬂow) bound-
ary condition is g ∈ T 2(Γ−) (single equation), or g ∈ T 2(Γ−)3 (coupled equation),
however we point out that in some parts, one could do with the more general as-
sumption g ∈ T 2
τ−(Γ−)3. In this paper we omit these generalizations.
3.2. Existence of Solutions for a Single Continuous Slowing Down Equa-
tion by a Variational Formulation. We shall consider the existence of solutions
for the problem (103), (105), (106) by applying the so-called Lions-Lax-Milgram
Theorem (or generalized Lax-Milgram Theorem) which is based on the variational
formulation. Hence we begin with some computations which lead one to ﬁnd the
related bilinear and linear forms. In the following we denote

f = eCEf,

g = eCEg.

Let f− (f+) be the negative (positive) part of a function. Recall that

f = f+ − f− and |f| = f+ + f−.

(108)

(109)

Applying the Green’s formula (35) and integrating by parts, we have for and φ ∈
C 1(G × S × I) that satisﬁes the equation (103) and for any v ∈ C 1(G × S × I),

+ hω · ∇φ, viL2(G×S×I) + hCS0φ, viL2(G×S×I)

∂E

, v(cid:29)L2(G×S×I)

−(cid:28) ∂(S0φ)
+ hΣφ, viL2(G×S×I) − hKCφ, viL2(G×S×I)
= (cid:28)φ, S0
S0φv(cid:12)(cid:12)(cid:12)
− hφ, ω · ∇viL2(G×S×I) +Z∂G×S×I
(ω · ν)φvdσdωdE
+ hφ, CS0viL2(G×S×I) + hφ, Σ∗viL2(G×S×I) − hφ, K ∗

∂E(cid:29)L2(G×S×I) −ZG×S

CviL2(G×S×I)

∂v

E=Em

E=0

dxdω

= hf, viL2(G×S×I)

where

and

Σ∗ = Σ

(110)

(111)

(K ∗

Cv)(x, ω, E) =ZS×I

σ(x, ω, ω′, E, E′)eC(E′−E)v(x, ω′, E′)dω′dE′.

(112)

Clearly

and

Z∂G×S×I
Z∂G×S×I

(ω · ν)−gvdσdωdE = hg, γ−(v)iT 2(Γ−)

(ω · ν)+φvdσdωdE = hγ+(φ), γ+(v)iT 2(Γ+) .

(113)

(114)

(115)

(116)

ON EXISTENCE OF L2-SOLUTIONS FOR COUPLED CSDA

30

∂v

∂E(cid:29)L2(G×S×I)

+ hφ(·,·, 0), S0(·,·, 0)v(·,·, 0)iL2(G×S) − hφ, ω · ∇viL2(G×S×I)

Assuming that the inﬂow boundary condition φ|Γ− = g and the initial condition
φ(·,·, Em) = 0 are valid, the equation (110) is equivalent to
(cid:28)φ, S0
+Z∂G×S×I
+ hφ, Σ∗viL2(G×S×I) − hφ, K ∗
= hf, viL2(G×S×I) +Z∂G×S×I

(ω · ν)+φvdσdωdE + hφ, CS0viL2(G×S×I)

(ω · ν)−gvdσdωdE.

CviL2(G×S×I)

One thus deduces that the relevant bilinear from B and linear form F are

B(φ, v) = (cid:28)φ, S0

∂v

∂E(cid:29)L2(G×S×I) − hφ, ω · ∇viL2(G×S×I)

+ C hφ, S0viL2(G×S×I) + hφ, (Σ∗ − K ∗
+ hγ+(φ), γ+(v)iT 2(Γ+) + hφ(·,·, 0), S0(·, 0)v(·,·, 0)iL2(G×S) ,

C)viL2(G×S×I)

and

F (v) = hf, viL2(G×S×I) + hg, γ−(v)iT 2(Γ−) .

The variational equation corresponding to the problem (103), (105), (106) (in the
classical sense) is

B(φ, v) = F (v) ∀v ∈ C 1(G × S × I).

We show that the bilinear form B : C 1(G × S × I) × C 1(G × S × I) → R obeys

the following boundedness and coercivity conditions:

Theorem 3.5 Suppose that the assumptions (83), (85), (86) (with C = q
κ and
with c > 0), (89), (90) and (91) are valid. Then there exists a constant M > 0 such
that

|B(φ, v)| ≤ M kφkH1 kvkH2

∀φ, v ∈ C 1(G × S × I)

and

B(φ, φ) ≥ c′ kφk2

H1

∀φ ∈ C 1(G × S × I)

where we assume that

c′ := min{

1
2

,

κ
2

, c}

(117)

(118)

(119)

is strictly positive. Note that κ is deﬁned in (91) and c in (86). (Recall that the
spaces H1 and H2 were deﬁned in equations (38) and (39), respectively.)

ON EXISTENCE OF L2-SOLUTIONS FOR COUPLED CSDA

31

Proof. A. At ﬁrst we show the boundedness of B(·,·). The assumptions (89), (90)
and the fact that the (energy) interval I is bounded imply by the Sobolev Embedding
theorem (see (31)) that S0(·, 0) ∈ L∞(G). Hence we ﬁnd that

|B(φ, v)| ≤kφkL2(G×S×I) kS0kL∞(G×I)(cid:13)(cid:13)(cid:13)(cid:13)

∂v

∂E(cid:13)(cid:13)(cid:13)(cid:13)L2(G×S×I)

+ kφkL2(G×S×I) kω · ∇vkL2(G×S×I)
+ C kS0kL∞(G×I) kφkL2(G×S×I) kvkL2(G×S×I)
+ kφkL2(G×S×I) k(Σ − KC)∗kkvkL2(G×S×I)
+ kγ(φ)kT 2(Γ) kγ(v)kT 2(Γ)
+ kφ(·,·, 0)kL2(G×S) kS0(·, 0)kL∞(G) kv(·,·, 0)kL2(G×S) .

(120)

This implies the assertion (117) by the deﬁnition of the spaces H1, H2, and after
observing that Sobolev Embedding theorem (see (31)) implies the existence of a
constant C ′ ≥ 0 such that

kw(·,·, 0)kL2(G×S) ≤ C ′ kwkH2

,

∀w ∈ H2.

B. We verify the coercitivity (118). Integrating by parts we have

∂φ

(cid:28)φ, S0
∂E(cid:29)L2(G×S×I)
+ hφ(·,·, Em), S0(·, Em)φ(·,·, Em)iL2(G×S) − hφ(·,·, 0), S0(·, 0)φ(·,·, 0)iL2(G×S)

∂E (cid:29)L2(G×S×I)

= −(cid:28)φ,

∂(S0φ)

(121)

Using the Green’s formula (35) we have

−hφ, ω · ∇φiL2(G×S×I) = hω · ∇φ, φiL2(G×S×I) −Z∂G×S×I

(ω · ν)φ2dσdωdE

(122)

(123)

(124)

which implies

hω · ∇φ, φiL2(G×S×I) =

=

=

1

1

2Z∂G×S×I
2Z∂G×S×I
2(cid:0)kγ+(φ)k2

1

(ω · ν)φ2dσdωdE
((ω · ν)+ − (ω · ν)−)φ2dσdωdE
T 2(Γ+) − kγ−(φ)k2

T 2(Γ−)(cid:1).
κ ≥ q

S0

By the deﬁnition of C and assumption (91), we have C = q

a.e. and hence

C hφ, S0φiL2(G×S×I) ≥ q kφk2

L2(G×S×I) .

ON EXISTENCE OF L2-SOLUTIONS FOR COUPLED CSDA

32

Taking Lemmas 3.2 and 3.3 into account, one can thus estimate

B(φ, φ) = −(cid:28)φ,

∂(S0φ)

∂E (cid:29)L2(G×S×I)

+ hφ(·,·, Em), S0(·, Em)φ(·,·, Em)iL2(G×S)

1

T 2(Γ−)(cid:1) + kγ+(φ)k2
2(cid:0)kγ+(φ)k2
−
+ C hφ, S0φiL2(G×S×I) + h(Σ − KC)φ, φiL2(G×S×I)

T 2(Γ+) − kγ−(φ)k2

T 2(Γ+)

≥ − q kφk2

L2(G×S×I) −

1
2 hφ(·,·, Em), S0(·, Em)φ(·,·, Em)iL2(G×S)

+

+

1
2 hφ(·,·, 0), S0(·, 0)φ(·,·, 0)iL2(G×S) + hφ(·,·, Em), S0(·, Em)φ(·,·, Em)iL2(G×S)
1
2 kγ(φ)k2
2(cid:0)kφ(·,·, 0)k2

T 2(Γ) + q kφk2
L2(G×S) + kφ(·,·, Em)k2

L2(G×S×I) + ckφk2

L2(G×S)(cid:1) +

T 2(Γ) + ckφk2

1
2 kγ(φ)k2

L2(G×S×I) .

L2(G×S×I)

(cid:3)

κ

≥

Because C 1(G × S × I) × C 1(G × S × I) is dense in H1 × H2 and since (117)
holds, the bilinear form B(·,·) : C 1(G × S × I) × C 1(G × S × I) → R has an unique
extension ˜B(·,·) : H1 × H2 → R which satisﬁes

+ C hφ, S0viL2(G×S×I) + hφ, (Σ∗ − K ∗
C)viL2(G×S×I)
+ hq, γ+(v)iT 2(Γ+) + hp0, S0(·, 0)v(·,·, 0)iL2(G×S) ,

(127)
when ˜φ = (φ, q, p0, pm) ∈ H1 and v ∈ H2. In addition, since for v ∈ C 1(G × S × I)
we have kγ−(v)kT 2(Γ−) ≤ kγ(v)kT 2(Γ), it follows that

|F (v)| ≤ | hf, viL2(G×S×I) | + | hg, γ−(v)iT 2(Γ−) |

(128)
and therefore, since C 1(G×S×I) is dense in H1, the linear form F : C 1(G×S×I) →
R has a unique bounded extension, which we still denote by F ,

≤ kfkL2(G×S×I) kvkL2(G×S×I) + kgkT 2(Γ−) kγ(v)kT 2(Γ) ,

F : H1 → R; F ( ˜φ) = hf, φiL2(G×S×I) + hg, qiT 2(Γ−) ,

(129)
when ˜φ = (φ, q, p0, pm) ∈ H1. Recall also that the embedding H2 ⊂ H1 is continuous.
We need the following result, so called Lions-Lax-Milgram Theorem (generalized
Lax-Milgram Theorem).

Theorem 3.6 Let X and Y be Hilbert spaces, with Y continuously embedded
into X. Assume that B(·,·) : X × Y → R is a bilinear form satisfying the following
properties with M ≥ 0, c > 0,

|B(u, v)| ≤ M kukX kvkY

∀u ∈ X, v ∈ Y

(boundedness)

(130)

and

| ˜B( ˜φ, v)| ≤ M(cid:13)(cid:13)(cid:13)

˜φ(cid:13)(cid:13)(cid:13)H1 kvkH2

∀ ˜φ ∈ H1, v ∈ H2

We see that actually

H1

∀v ∈ H2.

˜B(v, v) ≥ c′ kvk2
∂E(cid:29)L2(G×S×I) − hφ, ω · ∇viL2(G×S×I)

∂v

˜B( ˜φ, v) = (cid:28)φ, S0

(125)

(126)

ON EXISTENCE OF L2-SOLUTIONS FOR COUPLED CSDA

33

and

B(v, v) ≥ ckvk2

X

∀v ∈ Y

(coercivity).

(131)

Suppose that F : X → R is a bounded linear form. Then there exists u ∈ X
(possibly non-unique) such that

Proof. See e.g. [58], p. 403 or [31], p. 234.

B(u, v) = F (v) ∀v ∈ Y.

For some arguments we need the following (density) assumption

H2 = ˜W 2(G × S × I) ∩ W 2

1 (G × S × I).

(132)

(cid:3)

(133)

In general, H2 is only a subspace of ˜W 2(G× S × I)∩ W 2
1 (G× S × I), but recall that
for any convex (bounded) domain G, Corollary 2.20 guarantees the equality (133) of
these spaces. The validity of (133) for more general open sets G will not be further
discussed in this work.

We are now in position to formulate and prove the main result of this section.

Theorem 3.7 Suppose that the assumptions (83), (85), (86) (with C = q
κ and
c > 0), (89), (90) and (91) are valid. Let f ∈ L2(G × S × I) and g ∈ T 2(Γ−). Then
the following assertions hold.

(i) The variational equation (see (127), (129))

˜B( ˜φ, v) = F (v) ∀v ∈ H2,

(134)

(ii) If a solution φ of the equation (103) obtained in part (i) belongs to W 2

has a solution ˜φ = (φ, q, p0, pm) ∈ H1. Furthermore, φ ∈ L2(G × S × I) is a weak
(distributional) solution of the equation (103).
1 (G ×
S × I), then φ belongs also to ˜W 2(G × S × I), and it is a solution of the problem
(103), (105), (106).
1 (G×
S × I) of the problem (103), (105), (106) is unique, belongs to H2 and obeys the
estimate

(iii) Suppose that (133) (density property) is valid. Then any solution φ ∈ W 2

kφkH1 ≤

where c′ is given in (119).

1

c′(cid:0)kfkL2(G×S×I) + kgkT 2(Γ−)(cid:1),

(135)

Proof. The proof is based on ”variations” and it is quite standard.

(i) We apply Theorem 3.6 with X = H1, Y = H2, and with B(·,·) = ˜B(·,·) and
F given by (127) and (129), respectively. As mentioned above ˜B(·,·) satisﬁes (130)
and (131), while F is a bounded linear functional, hence Theorem 3.6 guarantees
the existence of a solution ˜φ = (φ, q, p0, pm) ∈ H1 such that (134) holds.
I ◦ :=]0, Em[. From (134) it follows that

We verify that φ ∈ L2(G × S × I) is a weak solution of the equation (103). Let

˜B( ˜φ, v) = F (v),

∀v ∈ C ∞

0 (G × S × I ◦).

(136)

ON EXISTENCE OF L2-SOLUTIONS FOR COUPLED CSDA

34

Since for v ∈ C ∞
we see from (127) that

0 (G × S × I ◦) we have v(·,·, 0) = v(·,·, Em) = 0 and v|∂G×S×I = 0,

˜B( ˜φ, v) = (cid:28)φ, S0

∂v

∂E(cid:29)L2(G×S×I) − hφ, ω · ∇viL2(G×S×I)

+ hCS0φ, viL2(G×S×I) + h(Σ − KC)φ, viL2(G×S×I)

= F (v) = hf, viL2(G×S×I) ,

(137)

0 (G × S × I ◦), which means that (103) holds in the weak sense.

(ii) Suppose that ˜φ = (φ, q, p0, pm) ∈ H1 satisﬁes (134) where φ ∈ W 2

1 (G× S × I).

for all v ∈ C ∞
Then for all v ∈ H2

∂v

∂E(cid:29)L2(G×S×I) − hφ, ω · ∇viL2(G×S×I)

(cid:28)φ, S0
+ C hφ, S0viL2(G×S×I) + hφ, (Σ∗ − K ∗
+ hq, γ+(v)iT 2(Γ+) + hp0, S0(·, 0)v(·,·, 0)iL2(G×S)

C)viL2(G×S×I)

= hf, viL2(G×S×I) + hg, γ−(v)iT 2(Γ−) .

(138)

Recall that Γ′ = ∂G×S and Γ′

− = {(y, ω) ∈ (∂G)r×S | ω· ν(y) < 0}. Choose any
0 (R) such that η(0) = 0 and θ ∈ C 1(G×S) such that supp(θ)∩Γ′ is a compact
η ∈ C 1
subset of Γ′
−. Then w(y, ω, E) := θ(y, ω)η(E) ∈ C 1(G × S × I) and w(·,·, 0) = 0,
w|Γ+ = 0. Hence hp0, S0(·, 0)w(·,·, 0)iL2(G×S) = 0 and hq, γ+(w)iT 2(Γ+) = 0, and so
by (138) for these w,

∂w

∂E(cid:29)L2(G×S×I) − hφ, ω · ∇wiL2(G×S×I)

(cid:28)φ, S0
+ hφ, CS0wiL2(G×S×I) + hφ, (Σ∗ − K ∗

C)wiL2(G×S×I)

= hf, wiL2(G×S×I) + hg, γ−(w)iT 2(Γ−) .

(139)

1 (G × S × I) and since C 1(G × S × I) is dense in
1 (G × S × I) (by Theorem 2.7) there exists a sequence {φn} ⊂ C 1(G × S × I)

Since by assumption φ ∈ W 2
W 2
such that kφn − φkW 2

1 (G×S×I) → 0 for n → ∞. In virtue of (139) one sees that

∂w

∂E(cid:29)L2(G×S×I) − hφn, ω · ∇wiL2(G×S×I)

(cid:28)φn, S0
+ hφn, CS0wiL2(G×S×I) + hφn, (Σ∗ − K ∗

C)wiL2(G×S×I)

−→n→∞hf, wiL2(G×S×I) + hg, γ−(w)iT 2(Γ−) ,

(140)

ON EXISTENCE OF L2-SOLUTIONS FOR COUPLED CSDA

35

On the other hand by partial integration and by the Green’s formula (recall the
choice of w)

∂w

∂E

, w(cid:29)L2(G×S×I)

∂E(cid:29)L2(G×S×I) − hφn, ω · ∇wiL2(G×S×I)

(cid:28)φn, S0
+ hφn, CS0wiL2(G×S×I) + hφn, (Σ∗ − K ∗
C)wiL2(G×S×I)
= −(cid:28) ∂(S0φn)
+ hω · ∇φn, wiL2(G×S×I)
+ hCS0φn, wiL2(G×S×I) + h(Σ − KC)φn, wiL2(G×S×I)
+ hφn(·,·, Em), S0(·, Em)w(·,·, Em)iL2(G×S) +Z∂G×S×I
+ ω · ∇φ + CS0φ + (Σ − KC)φ, w(cid:29)L2(G×S×I)

∂(S0φ)

∂E

−→n→∞(cid:28)−

(ω · ν)−φnwdσdωdE

+ hφ(·,·, Em), S0(·, Em)w(·,·, Em)iL2(G×S) +Z∂G×S×I
= hf, wiL2(G×S×I)
+ hφ(·,·, Em), S0(·, Em)w(·,·, Em)iL2(G×S) + hγ−(φ), γ−(w)iT 2(Γ−) ,

(ω · ν)−φwdσdωdE

(141)

∂φn
∂E →

, ω · ∇φn → ω · ∇φ in L2(G × S × I)

since, when n → ∞,
∂φ
φn → φ,
∂E
φn(·,·, Em) → φ(·,·, Em)
γ−(φn) → γ−(φ)
(by (30)).
∂E → ∂(S0φ)
Note also that the convergence ∂φn
in L2(G × S × I). Finally, in the last step of (141) we observed that by part (i) φ is
a weak (distributional) solution of (103) in G× S × I, which by assumption belongs
to W 2

(by (31))
loc(Γ−,|ω · ν|dσdωdE)

∂E implies by (89), (90) that ∂(S0φn)

1 (G × S × I), and thus (103) holds in L2(G × S × I) (with eCEf = f).

Combining (140) and (141) we get that
hφ(·,·, Em), S0(·, Em)w(·,·, Em)iL2(G×S) + hγ−(φ), γ−(w)iT 2(Γ−) = hg, γ−(w)iT 2(Γ−) ,
(142)

in L2(G × S)
in L2

∂E → ∂φ

∂E

for all w(y, ω, E) = θ(y, ω)η(E) chosen above.

Choose in (142) ζ ∈ C 1

kind of w′ equation (142) reduces to

0 (]0, Em[) and w′(y, ω, E) = θ(y, ω)ζ(E). Then for this

(143)
which implies that γ−(φ) = g ∈ T 2(Γ−), and hence φ ∈ ˜W 2(G × S × I). Finally,
from (134) we see that

hγ−(φ), γ−(w′)iT 2(Γ−) = hg, γ−(w′)iT 2(Γ−) ,

hφ(·,·, Em), S0(·, Em)v(·,·, Em)iL2(G×S) = 0,

for all v ∈ H2, which implies that φ(·,·, Em) = 0 a.e. in G × S (since S0 ≥ κ > 0),
as desired.
(iii) Suppose that the assumption (133) holds. Then we know by part (ii) that
any solution φ lying in W 2
1 (G × S × I) belongs to H2. Let φ ∈ H2 and φ′ ∈ H2
be two solutions of the problem (103), (105), (106). Viewing φ, φ′ also as elements
of H1 through H2 ⊂ H1, we then have ˜B(φ, v) = F (v) = ˜B(φ′, v) for all v ∈ H2.
Choosing v = φ − φ′ ∈ H2 we see that ˜B(φ − φ′, φ − φ′) = 0 and so φ = φ′ by (126).

ON EXISTENCE OF L2-SOLUTIONS FOR COUPLED CSDA

36

This shows that a solution belonging to H2 is unique. The estimate (135) follows
from (126), (128) and (134). This completes the proof.
(cid:3)

Similarly as above we see that the variational equation corresponding to the prob-

lem (80), (81), (82) is

˜B0( ˜ψ, v) = F0(v) ∀v ∈ H2,

where ˜ψ ∈ H1 and ˜B0(·,·) is the continuous extension onto H1 × H2 of the bilinear
form B0(·,·) : C 1(G × S × I) × C 1(G × S × I) → R deﬁned by (that is, the bilinear
form (116) with C = 0)
B0(ψ, v) = (cid:28)ψ, S0
∂E(cid:29)L2(G×S×I) − hψ, ω · ∇viL2(G×S×I) + hψ, (Σ∗ − K ∗)viL2(G×S×I)

∂v

+ hγ+(ψ), γ+(v)iT 2(Γ+) + hψ(·,·, 0), S0(·, 0)v(·,·, 0)iL2(G×S) .

(144)

The linear form F0 : C 1(G × S × I) → R is given by

F0(v) = hf, viL2(G×S×I) + hg, γ−(v)iT 2(Γ−) ,

and it admits a unique extension to a bounded linear form F0 : H1 → R. Note that
the bilinear form (144) is not necessarily coercive that is (118) does not necessarily
hold, which justiﬁes the need for the change of unknown φ = eCEψ performed above.
We have the following immediate corollary for the existence of solutions of the

original CSDA-problem.

Corollary 3.8 Suppose that the assumptions (83), (85), (86) (with c > 0), (89),
(90) and (91) are valid. Let f ∈ L2(G× S × I) and g ∈ T 2(Γ−). Then the following
assertions hold.

(i) The variational equation

˜B0( ˜ψ, v) = F0(v) ∀v ∈ H2

(ii) If the solution ψ of the equation (80) obtained in part (i) belongs to W 2

(145)
has a solution ˜ψ = (ψ, q, p0, pm) ∈ H1. Furthermore, ψ ∈ L2(G × S × I) is a weak
(distributional) solution of the equation (80).
1 (G ×
S × I), then ψ belongs also to ˜W 2(G × S × I), and it is a solution of the problem
(80), (81), (82).
1 (G×
S×I) of the problem (80), (81), (82) is unique, belongs to H2 and obeys the estimate

(iii) Suppose that (133) (density property) is valid. Then any solution ψ ∈ W 2

qEm

κ

e

kψkH1 ≤

c′ (cid:0)kfkL2(G×S×I) + kgkT 2(Γ−)(cid:1).

(146)

(Recall that κ is deﬁned in (91), q in (99), c′ in (119) and that Em is the cutoﬀ
energy.)

Proof. Let f ∈ L2(G × S × I) and g ∈ T 2(Γ−). Since I is ﬁnite interval we see that
f := eCEf ∈ L2(G × S × I) and g := eCEg ∈ T 2(Γ−), where C = q
κ (see (102),
(108)). By Theorem 3.7 the variational problem (134) has a solution ˜φ ∈ H1, from
which one deduces without diﬃculty that ˜ψ := e−CE ˜φ ∈ H1 is a solution of the
variational problem (145). This can be seen by substituting e−CEv ∈ H2 instead
of v into (134). Besides the estimate (146) all the claims are consequences of the
corresponding items in Theorem 3.7.

ON EXISTENCE OF L2-SOLUTIONS FOR COUPLED CSDA

37

Recalling that f = eCEf, g = eCEg the estimate (146) is obtained as follows,

kψkH1

= (cid:13)(cid:13)e−CEφ(cid:13)(cid:13)H1 ≤ kφkH1 ≤

eCEm

≤

c′ (cid:0)kfkL2(G×S×I) + kgkT 2(Γ−)(cid:1).

Since C = q

κ, this ﬁnishes the proof.

1

c′(cid:0)kfkL2(G×S×I) + kgkT 2(Γ−)(cid:1)

(147)

(cid:3)

We leave open in this work the systematic study of suﬃcient criteria for the
regularity of solutions needed in parts (ii)-(iii) of Theorem 3.7 and its Corollary 3.8.
Nevertheless, in the next section we shall consider a particular situation in which the
(unique) solution ψ to the problem (80), (81), (82) has, under speciﬁc assumptions
on the data of the problem, regularity in this sense, ψ ∈ W 2
1 (G× S × I) (for a more
precise statement on regularity, see Theorem 3.19).

Remark 3.9 Deﬁne the transport operator

TCφ := −

∂(S0ψ)

∂E

+ ω · ∇ψ + CS0φ + (Σ − KC)φ.

Then from the estimate (118) it follows that for all φ ∈ C 1(G × S × I),

c′ kφkH1 ≤ kTCφkL2(G×S×I) + kγ−(φ)kT 2(Γ−) + kS0kL∞(G×I) kφ(·,·, Em)kL2(G×S) .

This a priori estimate might be (as standard) a useful point of departure of regularity
results at least in the case where G = R3.

Remark 3.10 We make a brief observation on the regularity assumption in parts
(ii) of Corollary 3.8. Make the assumptions (89), (90) and (91) as in Corollary
3.8. Then ψ ∈ L2(G × S × I) if and only if S0
∂E ∈ L2(G × S × I), and moreover
ψ ∈ L2(G × S × I) is a weak (distributional) solution of (80) if and only if it is a
weak solution of

∂ψ

S0

∂ψ
∂E − ω · ∇ψ = −

∂S0
∂E

ψ + Σψ − Kψ − f.

This shows that, under the mentioned assumption, if ψ ∈ L2(G× S × I) solves (80)
in a weak sense, one has ψ ∈ W 2
1 (G × S × I) if and only if ψ ∈ W 2(G × S × I) if
and only if ∂ψ
1 (G × S × I), in
which ψ belongs to by assumption in part (ii) of Corollary 3.8, could be replaced by
W 2(G × S × I), or by the space {ψ ∈ L2(G × S × I) | ∂ψ
∂E ∈ L2(G × S × I)}. Of
course, essentially the same remark holds for Theorem 3.7 part (ii).

∂E ∈ L2(G × S × I). An implication of this is that W 2

Remark 3.11 The variational methods used above apply (after relevant modiﬁ-
cations of the assumptions) also to more general problems of the form

a

∂ψ
∂E

+ F · ∇˜ωψ + ω · ∇xψ + (Σ − K)ψ = f

ψ|Γ− = g, ψ(·,·, Em) = 0,

(148)

where a = a(x, ω, E), F = (F1(x, ω, E), F2(x, ω, E), F3(x, ω, E)) and ∇˜ω is the gra-
dient operator with respect to the Riemannian metric on the sphere S induced by
the Euclidean metric on R3. Notice that since ∇˜ωψ is tangent to S, we may as-
sume that ω · F (x, ω, E) = 0 for all (x, ω, E). More explicitly, if φ ∈ C 1(S), and if

ON EXISTENCE OF L2-SOLUTIONS FOR COUPLED CSDA

38

˜φ : R3\{0} → R is given by ˜φ(y) = φ( y

kyk ), then

∇˜ωφ = ∇y ˜φ − (ω · ∇y ˜φ)ω

where ∇˜ωφ = ((∇˜ωφ)1, (∇˜ωφ)2, (∇˜ωφ)3) and ω = (ω1, ω2, ω3) as elements of R3.
In this context the space H2 must be replaced with the space H2 deﬁned as follows.
The space H2 is the completion of C 1(G × S × I) with respect to the inner product

hψ, viH2

+ hF · ∇˜ωψ, F · ∇˜ωviL2(G×S×I) .

This observation is based on the fact that

2 hF · ∇˜ωψ, ψiL2(G×S×I) = hdψ, ψiL2(G×S×I) ,

where

d := −div ˜ω(F ),

and div ˜ω is the divergence operator on S with respect to its Riemannian metric.

Moreover, we could add into (148) a term b∆s

˜ωψ, b = b(x, ω, E) where ∆s

˜ω, 0 <

s ≤ 1/2 is the Laplace-Beltrami operator on the sphere.

The equation (148) in velocity coordinates (x, v) ∈ R3 × R3 looks as

˜F · ∇vΨ + v · ∇xΨ + ( ˜Σ − ˜K)Ψ = ˜f
which is known as the (linear) Vlasov-Boltzmann equation.

(149)

section. Nevertheless, the m-dissipativity of the operator ψ 7→ 1
Cψ), for C large enough (in relevant modiﬁed spaces), requires extra analysis.

Similar observations concern the evolution theory based method used in the next
a(F ·∇˜ωψ + ω·∇ψ +
Finally notice that no boundary condition is needed in (148) with respect to

ω-variable because the unit sphere S is a compact manifold without boundary.

3.3. On the Non-negativity of Solutions. We will outline an argument to show
that the solution ψ obtained by Corollary 3.8, when the assumptions given in parts
(i), (ii) (and (iii)) of it are valid, is non-negative if the data f and g are non-negative.
A. Assume ﬁrst that g = 0. Using a change of unknown φ = eCEψ, with C given

in (102), we return the problem to the one considered in Theorem 3.7, that is

∂(S0φ)

∂E

−

+ ω · ∇φ + CS0φ + Σφ − KCφ = f

on G × S × I,

φ|Γ− = g on Γ−,

φ(·,·, Em) = 0

on G × S.

(150)

(151)

(152)

Deﬁne a linear operator TC,0 : L2(G× S × I) → L2(G× S × I) with domain D(TC,0)
by

D(TC,0) := {φ ∈ ˜W 2(G × S × I) ∩ W 2
TC,0φ := −

∂(S0φ)

+ ω · ∇φ + CS0φ + Σφ − KCφ.

∂E

1 (G × S × I) | φ|Γ− = 0, φ(·,·, Em) = 0},

(153)

It is not diﬃcult to see that TC,0 is densely deﬁned and closable.

ON EXISTENCE OF L2-SOLUTIONS FOR COUPLED CSDA

39

Let ˜TC,0 be the smallest closed extension (closure) of TC,0 that is,
D( ˜TC,0) = {φ ∈ L2(G × S × I) | there exists an element f ∈ L2(G × S × I)

and a sequence {φn} ⊂ D(TC,0) such that kφn − φkL2(G×S×I) → 0,
kTC,0φn − fkL2(G×S×I) → 0, when n → ∞}

˜TC,0φ = f.

It can be veriﬁed that for any λ > 0,

h(TC,0 + λI)φ, φiL2(G×S×I) ≥ (c′ + λ)kφk2

L2(G×S×I) ,

∀φ ∈ D(TC,0),

or equivalently

h(−TC,0 + c′I)φ, φiL2(G×S×I) ≤ 0,

From (154) it follows that also for ˜TC,0,

∀φ ∈ D(TC,0).

D( ˜TC,0 + λI)φ, φEL2(G×S×I) ≥ (c′ + λ)kφk2
and hence, in particular, − ˜TC,0 + c′I is dissipative.

Suppose additionally that (R( ˜TC,0) being the range of ˜TC,0)

L2(G×S×I) , φ ∈ D( ˜TC,0)

which holds e.g. under the assumptions of Theorem 3.19. By (156)

R( ˜TC,0) is dense in L2(G × S × I),

(154)

(155)

(156)

(157)

˜TC,0φ(cid:13)(cid:13)(cid:13)L2(G×S×I) ≥ c′ kφkL2(G×S×I) , φ ∈ D( ˜TC,0)
(cid:13)(cid:13)(cid:13)

and so R( ˜TC,0) is closed in L2(G× S × I). Hence R( ˜TC,0) = R(cid:0)(− ˜TC,0 + c′I)− c′I(cid:1) =
L2(G×S×I), and we conclude that − ˜TC,0 is m-dissipative, which therefore generates
a contraction C 0-semi-group ˜G(t), t ≥ 0 (cf. [23]). In addition,

φ =Z ∞

0

˜G(t)fdt.

We decompose the operator −TC,0 as follows

where linear operators B0 and A0 are deﬁned by

−TC,0 = B0 + A0 − (Σ + CS0I) + KC

(158)

(159)

∂(S0φ)

∂E

.

D(A0) := ˜W 2

−,0(G × S × I), A0φ := −ω · ∇φ
1 (G × S × I) | φ(·,·, Em) = 0}, B0φ :=

D(B0) := {φ ∈ W 2

The semi-groups generated by the last three components are as follows (below H is
the Heaviside function)

TKC (t) = e−tKC ,
T−(Σ+CS0I)(t) = et(Σ+CS0I),
(TA0(t)f )(x, ω, E) = H(t(x, ω) − t)f (x − tω, ω, E),

all of which are of positive type.

(160)

Also the semi-group of B0 is of positive type. Indeed, letting (U(t))(x, ω, E) :=

(TB0(t)f )(x, ω, E) for a given f , then U satisﬁes the Cauchy problem

∂U
∂t − B0U = 0, U(0) = f,

ON EXISTENCE OF L2-SOLUTIONS FOR COUPLED CSDA

40

or equivalently

∂U
∂t −

∂(S0U)

∂E

= 0, U(0) = f.

(161)

The solution of (161) is (cf. Example 5.1 below)

U(x, ω, E, t) =

S0(x, R−1

x (R(E) + t))
S0(x, E)

f (x, ω, E, R−1

x (Rx(E) + t)),

(162)

where

In other words,

Rx(E) :=Z E

0

1

S0(x, τ )

dτ.

(TB0(t)f )(x, ω, E) =

S0(x, R−1

x (R(E) + t)
S0(x, E)

f (x, ω, E, R−1

x (Rx(E) + t)),

and so TB0(t) is of positive type.

By the Trotter’s formula ([23], Corollary 5.8, p. 227) for f ≥ 0 (which is equivalent

˜G(t)f = lim

n→∞hTB0(t/n)TA0(t/n)T−(Σ+CI)(t/n)TKC (t/n)in

f ≥ 0

(163)

and so by (158) φ ≥ 0 (even for the solutions of ˜TC,0φ = f). This implies that ψ ≥ 0.
B. Suppose that g ≥ 0 is more general. Assume that g ∈ H 1(I, L2(G × S)) for
which g(Em) = 0. We decompose the solution as follows. Let u ∈ ˜W 2(G × S × I) ∩
W 2
1 (G × S × I) be the solution of the problem

that f ≥ 0)

∂(S0u)

∂E

PCu := −
u|Γ− = g,
u(·,·, Em) = 0.

+ ω · ∇u + CS0u + Σu = 0,

(164)

(165)

(166)

Furthermore, let w ∈ ˜W 2(G× S × I)∩ W 2

1 (G× S × I) be the solution of the problem
(167)

+ ω · ∇w + CS0w + Σw − KCw = f + KCu,

∂(S0w)

∂E

TCw := −
w|Γ− = 0,
w(x, ω, Em) = 0.

(168)

(169)

Then ψ := w + u is the solution of (150)-(152).

We are able to show that u ≥ 0. For example, in the case of Example 5.1 given

below u can be solved even explicitly and the result is

u =

1

S0(E)

H(rm − R(E) − t(x, ω))e− R t(x,ω)

0

Σ(x−sω,ω)ds˜g(x − t(x, ω)ω, ω, R(E) + t(x, ω)),

(170)

1

0

where R(E) :=R E
S0(τ )dτ and ˜g(y, ω, η) := S0(R−1(η))g(y, ω, R−1(η)). In addition,
rm := R(Em). By Part A above, w ≥ 0 since f ≥ 0 and KCu ≥ 0 for u ≥ 0. We
conclude that φ ≥ 0 and so ψ ≥ 0, as desired.
We will give a detailed proof and more advanced criteria for the additional as-
sumption (157) in a future paper. The same argument is valid for the coupled system
considered below.

ON EXISTENCE OF L2-SOLUTIONS FOR COUPLED CSDA

41

3.4. An Existence Result Based on the Theory of Evolution Equations.
Due to the existence result (part (i)) of Corollary 3.8 one has,

∂(S0ψ)

∂E

−

+ ω · ∇ψ ∈ L2(G × S × I),

but we do not know a priori if ∂ψ
∂E ∈ L2(G×S×I), or if ω·∇ψ ∈ L2(G×S×I). Hence
it is not known if ψ ∈ W 2
1 (G × S × I), and so the regularity assumption in parts
(ii)-(iii) of Corollary 3.8 is not in general guaranteed. Here we give an alternative
approach for a less general problem (80), (81), (82), which gives more regularity for
its solution ψ, and in particular provides the regularity criterion ψ ∈ W 2
1 (G× S × I)
used above.

We assume that the collision operator is of the form

(Kψ)(x, ω, E) =ZS

˜σ(x, ω′, ω, E)ψ(x, ω′, E)dω′.

(171)

This situation corresponds to the case where the diﬀerential cross-section is of the
form σ(x, ω′, ω, E′, E) = ˜σ(x, ω′, ω, E)δ(E′ − E) (cf. Remark 3.1). Then K can be
written as (Kψ)(E) = K(E)ψ(E), where ψ(E)(x, ω) := ψ(x, ω, E) and where for
any ﬁxed E ∈ I, the linear operator K(E) is deﬁned by

(K(E)φ)(x, ω) =ZS

˜σ(x, ω′, ω, E)φ(x, ω′)dω′, φ ∈ L2(G × S).

For a condition related to the property (Kψ)(E) = K(E)ψ(E), see [23] (Ch. VI,
Prop. 9.13). By an argument similar to the one leading to the estimate (87), we
have for all E ∈ I,
kK(E)k ≤(cid:13)(cid:13)(cid:13)(cid:13)
ZS

where kK(E)k is the norm of K(E) as an operator in L2(G × S). Hence under the
assumption (94) the operator K(E) : L2(G × S) → L2(G × S) is bounded and

˜σ(·,·, ω′, E)dω′(cid:13)(cid:13)(cid:13)(cid:13)

˜σ(·, ω′,·, E)dω′(cid:13)(cid:13)(cid:13)(cid:13)

L∞(G×S)

1/2

L∞(G×S)(cid:13)(cid:13)(cid:13)(cid:13)
ZS

1/2

,

(172)

kK(E)k ≤ M 1/2

1 M 1/2

2

,

uniformly for E ∈ I.
Consider the problem (80), (81), (82), where K is of the particular form given
in (171). We shall assume that the restricted cross-sections Σ, ˜σ and the stopping
power S0 satisfy somewhat diﬀerent assumptions than in the previous section. We
make the following change of variables and of the unknown function

˜ψ(x, ω, E) := ψ(x, ω, Em − E),

φ := e−CE ˜ψ,

(173)

and denote

˜S(x, E) = S0(x, Em − E),
˜Σ(x, ω, E) = Σ(x, ω, Em − E)

σ(x, ω, ω′, E) = ˜σ(x, ω, ω′, Em − E)

˜f (x, ω, E) = f (x, ω, Em − E)
˜g(y, ω, E) = g(y, ω, Em − E)

( ˜Kφ)(x, ω, E) = ZS

σ(x, ω′, ω, E)φ(x, ω′, E)dω′,

(174)

ON EXISTENCE OF L2-SOLUTIONS FOR COUPLED CSDA

42

with φ ∈ L2(G × S × I) in the deﬁnition of ˜K. Making the changes in (173), we
ﬁnd that the problem (80), (81), (82) is equivalent to φ satisfying the equation

∂φ
∂E

+

1
˜S

ω · ∇φ + Cφ +

∂ ˜S
∂E

1
˜S

φ +

1
˜S

˜Σφ −

1
˜S

˜Kφ =

e−CE ˜f ,

1
˜S

(175)

on G × S × I, along with satisfying the following inﬂow boundary and initial value
conditions,

φ|Γ− = e−CE ˜g,

φ(·,·, 0) = 0.

(on G × S).

(176)

(177)

Furthermore, deﬁne for any ﬁxed E ∈ I and C ≥ 0 the linear operator AC(E) :
L2(G × S) → L2(G × S) with domain D(AC(E)) by (here ˜S(E) = ˜S(·, E) and
˜Σ(E) = ˜Σ(·,·, E)),
D(AC(E)) = ˜W 2

−,0(G × S) := {φ ∈ ˜W 2(G × S) | γ′
˜Σ(E)φ +

1

˜S(E)

ω · ∇φ + Cφ +

AC(E)φ = −(cid:16) 1
and a function f(E) : G × S → R such that

˜S(E)

−(φ) = 0},
∂ ˜S
∂E

˜S(E)

1

(E)φ −

1

˜S(E)

˜K(E)φ(cid:17),

(178)

f(E)(x, ω) =

where

1

˜S(x, E)

e−CE ˜f (x, ω, E),

σ(x, ω′, ω, E)φ(x, ω′)dω′, φ ∈ L2(G × S),

( ˜K(E)φ)(x, ω) =ZS
− = {(y, ω) ∈ (∂G)r × S | ω · ν(y) < 0}, while γ′
is the trace mapping (see section 2.1).

− : ˜W 2(G × S) → Γ′
and where Γ′
−;
γ′
−(ψ) = ψ|Γ′
We interpret φ as a mapping I → L2(G× S) by deﬁning φ(E)(x, ω) := φ(x, ω, E).
Assuming that φ(E) ∈ D(AC(E)) for any E ∈ I (which takes care of the inﬂow
boundary condition) the problem (175), (176), (177) for g = 0 can be put into the
abstract form

−

∂φ
∂E − AC(E)φ = f(E), φ(0) = 0.

(179)

We recall the following result from the theory of evolution equations.

Theorem 3.12 Suppose that X is a Banach space and that for any ﬁxed t ∈ [0, T ]
the operator A(t) : X → X is linear and closed, with domain D(A(t)) ⊂ X. In
addition, we assume that the following conditions hold:
(i) The domain D := D(A(t)) is independent of t and is a dense subspace of X.
(ii) The operator A(t) is m-dissipative for any ﬁxed t ∈ [0, T ]
(iii) For every u ∈ D, the mapping fu : [0, T ] → X deﬁned by fu(t) := A(t)u is in
(iv) f ∈ C 1([0, T ], X) and u0 ∈ D.
Then the (evolution) equation

C 1([0, T ], X).

∂u
∂t − A(t)u = f,

u(0) = u0,

(180)

ON EXISTENCE OF L2-SOLUTIONS FOR COUPLED CSDA

43

has a unique solution u ∈ C([0, T ], D) ∩ C 1([0, T ], X). In addition, the solution is
given by

u(t) = U(t, 0)u0 +Z t

0

U(t, s)f (s)ds

(181)

where U(t, s) : X → X, 0 ≤ t ≤ s ≤ T , is a family of bounded operators, strongly
continuous in (t, s), called the (two-parameter) evolution system of operators of A(t),
t ∈ [0, T ], and U(·, s)u0 solves (for a ﬁxed s) for every u0 ∈ D the Cauchy problem
(182)

∂

∂t(cid:0)U(t, s)u0(cid:1) − A(t)U(t, s)u0 = 0, U(s, s)u0 = u0.

Proof. See [53], pp. 89-106 (Theorem 4.5.3.), [43], pp. 126-182 , [23], pp. 477-
496.
(cid:3)

Remark 3.13 We make a brief remark concerning the meaning of the claim in
Theorem 3.12 that u ∈ C([0, T ], D), since here the topology of D needs to be
speciﬁed in order to speak of continuity of maps into D. In fact, in [53] (Corollary
to Theorem 4.4.2, pp. 102-103) one equips D with the graph norm of A(0). Recall
that for t ∈ [0, T ], the graph norm of A(t) on D(A(t)) (= D) is deﬁned as kvkA(t) :=
kvkX + kA(t)vkX , for v ∈ D.

In Theorem 3.12 the deﬁnition of the concept of a solution of (180) comprises that
u(t) ∈ D = D(A(t)) for any t ∈ [0, T ]. Deﬁne a closed (see [55]) densely deﬁned
linear operator A0(E) : L2(G × S) → L2(G × S) by

D(A0(E)) = ˜W 2
−,0(G × S) =: D (independent of E)
1

A0(E)φ = −

˜S(E)

ω · ∇φ.

(183)

We begin with a lemma on dissipativity properties of A0(E).

Lemma 3.14 Suppose that the assumptions (89), (91) and (92) are valid, and let

1
2

C0 :=

κ−2 k∇SkL∞(G×I) .

(184)
Then for any C ≥ C0 the operator A0(E) − CI : L2(G × S) → L2(G × S) is
m-dissipative for all E ∈ I.
Proof. A. Dissipativity. We have for φ ∈ D,

φ

ω · ∇(cid:16)
and ∇(cid:16) 1
˜S(E)1/2(cid:17) = − 1
˜S(E)1/2 ∈ ˜W 2
that
ω · ν > 0 on Γ′
(cid:28)ω · ∇(cid:16)

˜S(E)1/2(cid:17),

φ

+ and since φ|Γ′

φ

1

˜S(E)1/2

˜S(E)1/2(cid:17) =
˜S(E)−3/2∇ ˜S(E). By the assumptions (91) and (92) we get
−,0(G × S) = D. From the Green’s formula (35) we obtain (since

ω · ∇φ + ω · ∇(cid:16)

˜S(E)1/2(cid:17)φ

(185)

2

1

1

˜S(E)1/2(cid:29)L2(G×S)

− = 0) that for φ ∈ D,
φ
2Z∂G×S
2ZΓ′

=

=

1

+

φ2
(ω · ν)
˜S(E)
φ2
˜S(E)

(ω · ν)

dσdω

dσdω ≥ 0.

(186)

ON EXISTENCE OF L2-SOLUTIONS FOR COUPLED CSDA

44

That is why by (185) we have

1

˜S(E)

(ω · ∇φ)φdωdx

1

1

φdωdx

˜S(E)1/2

˜S(E)1/2

h−A0(E)φ, φiL2(G×S) =ZG×S
=ZG×S
=ZG×S
ω · ∇(cid:16)
≥ −ZG×S
ω · ∇(cid:16)
≥ −(cid:13)(cid:13)(cid:13)(cid:13)
∇(cid:16)
˜S(·)1/2(cid:17)
κ−2(cid:13)(cid:13)(cid:13)∇ ˜S(cid:13)(cid:13)(cid:13)L∞(G×I) kφk2

(ω · ∇φ)
φ
˜S(E)1/2(cid:17)(cid:16)
˜S(E)1/2(cid:17)
˜S(·)1/2(cid:13)(cid:13)(cid:13)(cid:13)L∞(G×I) kφk2

≥ −
= − C0 kφk2

L2(G×S) ,

˜S(E)1/2

1

1

L2(G×S)

1
2

1

φ

˜S(E)1/2(cid:17)dωdx −ZG×S

φ2

dωdx

L2(G×S)

ω · ∇(cid:16)

1

˜S(E)1/2(cid:17)

φ2

˜S(E)1/2

dωdx

(187)

and hence

h(A0(E) − CI)φ, φiL2(G×S) = hA0(E)φ, φiL2(G×S) − C kφk2

L2(G×S)

≤ (C0 − C)kφk2

L2(G×S) .

Choosing C ≥ C0, one ﬁnds that A0(E) − CI is dissipative for any E ∈ I.
The equation

B. We still have to show that R(λI− (A0(E)− CI)) = L2(G× S) for (any) λ > 0.

means that φ ∈ ˜W 2

−,0(G × S) and that

which is equivalent to

˜S(E)

(λI − (A0(E) − CI))φ = f,

1

ω · ∇φ + (λ + C)φ = f,

(188)

(189)

(190)
since by (89) and (91) f ∈ L2(G × S) if and only if ˜S(E)f ∈ L2(G × S). Let
B0 : L2(G × S) → L2(G × S) be a linear operator with domain D(B0) deﬁned by

ω · ∇φ + (λ + C) ˜S(E)φ = ˜S(E)f,

D(B0) = ˜W 2
B0φ = −ω · ∇φ.

−,0(G × S),

Then B0 is m-dissipative ([55], [19]). Let λ′ := κ(λ + C). The equation (190) is
equivalent to

where B1 is deﬁned by

(λ′I − (B0 + B1))φ = ˜S(E)f

(191)

B1φ = −((λ + C) ˜S(E) − λ′)φ.

It is clear that the operator B1 : L2(G × S) → L2(G × S) is bounded, and since
(λ + C) ˜S(E) − λ′ ≥ 0 by the assumption (91) and the deﬁnition of λ′, it follows
that B1 is dissipative. These observations imply that B0 + B1 is m-dissipative (cf.
[23] Ch. III, or [55], Theorem 4.2). Since (188) is equivalent to (191) as explained

ON EXISTENCE OF L2-SOLUTIONS FOR COUPLED CSDA

45

above, this shows that R(λI − (A0(E) − CI)) = L2(G × S), and thus completes the
proof.

(cid:3)

For E ∈ I, let A1(E) : L2(G × S) → L2(G × S) be the linear operator
˜K(E)φ.

(E)φ +

1

1

1

A1(E)φ := −

˜S(E)

˜Σ(E)φ −

˜S(E)

∂ ˜S
∂E

˜S(E)

We have the following uniform bound for the family of operators {A1(E) | E ∈ I}.
Lemma 3.15 Under the assumptions (83), (90) and (94) the operator A1(E) is
bounded for any ﬁxed E ∈ I, and collectively they obey a uniform bound,
1/2(cid:17) =: C ′
sup

1/2M2

+ M1

E∈I kA1(E)k ≤ κ−1(cid:16)(cid:13)(cid:13)(cid:13)

˜Σ(cid:13)(cid:13)(cid:13)L∞(G×S×I)

0 < ∞,
(192)

+(cid:13)(cid:13)(cid:13)(cid:13)(cid:13)

∂ ˜S

∂E(cid:13)(cid:13)(cid:13)(cid:13)(cid:13)L∞(G×I)

where Mj ≥ 0, j = 1, 2 are as in (94).
Proof. The (uniform) estimate follows immediately from the assumptions and the
estimate (172).
(cid:3)

Using the above notations we have for C := C0 + C ′

AC(E) = A0(E) − C0I − C ′
0 were deﬁned in (184) and (192). Since by Lemma 3.15,

0I + A1(E).

0 the following decomposition
(193)

Recall that C0 and C ′

h(−C ′
≤ − C ′

0 kφk2
L2(G×S×I) = 0,

0I + A1(E))φ, φiL2(G×S×I) = −C ′
0 kφk2
L2(G×S×I) + C ′
we see that −C ′
0I + A1(E) is bounded and dissipative. On the other hand, according
to Lemma 3.14, A0(E)− C0I is m-dissipative. Hence AC(E) is m-dissipative for any
E ∈ I (cf. [23], Theorem 2.7 in Chapter III, or [55], Theorem 4.2). We record this
observation into the next lemma.

L2(G×S×I) + hA1(E))φ, φiL2(G×S×I)

0 kφk2

Lemma 3.16 For C = C0 + C ′
m-dissipative.

0 and for every ﬁxed E ∈ I, the operator AC(E) is

We shall assume that

˜σ ∈ C(I, L∞(G × S, L1(S′))) ∩ C(I, L∞(G × S′, L1(S))),

where ˜σ interpreted as an element of C(I, L∞(G × S, L1(S′))) is

˜σ(E)(x, ω)(ω′) = ˜σ(x, ω′, ω, E),

and when interpreted as an element of C(I, L∞(G × S′, L1(S))) it is

˜σ(E)(x, ω′)(ω) = ˜σ(x, ω′, ω, E).

Furthermore, in order to avoid ambiguity, we have denoted by S′ (resp. S) the unit
sphere in R3 for the variable ω′ (resp. ω). We ﬁnd that the conditions (94) are then
satisﬁed valid for σ with

M1 := max

M2 := max

E∈I kσ(E)kL∞(G×S),L1(S′)) = kσkC(I,L∞(G×S),L1(S′))) ,
E∈I kσ(E)kL∞(G×S′),L1(S)) = kσkC(I,L∞(G×S′),L1(S))) .

ON EXISTENCE OF L2-SOLUTIONS FOR COUPLED CSDA

46

ess sup

Moreover, for all E1, E2 ∈ I,
(x,ω)∈G×SZS′ |σ(x, ω′, ω, E1) − σ(x, ω′, ω, E2)|dω′ = kσ(E1) − σ(E2)kL∞(G×S,L1(S′))
(x,ω′)∈G×S′ZS |σ(x, ω′, ω, E1) − σ(x, ω′, ω, E2)|dω = kσ(E1) − σ(E2)kL∞(G×S′,L1(S)) .

ess sup

(194)

Supposing additionally that

˜σ ∈ C 1(I, L∞(G × S, L1(S′))) ∩ C 1(I, L∞(G × S′, L1(S))),

(195)

then for any ﬁxed E the operator ∂K

∂E (E) : L2(G × S) → L2(G × S) deﬁned by

(cid:16) ∂ ˜K

∂E

(E)φ(cid:17)(x, ω) :=ZS

∂σ
∂E

(x, ω′, ω, E)φ(x, ω′)dω′

(196)

is a bounded operator and

ess sup

(x,ω)∈G×SZS′(cid:12)(cid:12)
(x,ω′)∈G×S′ZS(cid:12)(cid:12)

ess sup

∂σ
∂E

(x, ω′, ω, E1) −

∂σ
∂E

∂σ
∂E

(x, ω′, ω, E1) −

∂σ
∂E

(x, ω′, ω, E2)(cid:12)(cid:12)dω′ =(cid:13)(cid:13)(cid:13)(cid:13)
(x, ω′, ω, E2)(cid:12)(cid:12)dω =(cid:13)(cid:13)(cid:13)(cid:13)

∂σ
∂E

∂σ
∂E

(E1) −

(E1) −

∂σ
∂E

∂σ
∂E

(E2)(cid:13)(cid:13)(cid:13)(cid:13)L∞(G×S,L1(S′))
(E2)(cid:13)(cid:13)(cid:13)(cid:13)L∞(G×S′,L1(S))

(197)

,

.

The following lemma justiﬁes the notation given in (196).

Lemma 3.17 Under the assumption (195), for any ﬁxed φ ∈ L2(G × S) the map

kφ : I → L2(G × I);

kφ(E) = ˜K(E)φ

is in C 1(I, L2(G × I)) and ∂kφ
Proof. If β : G×S′×S×I → R is measurable, and one deﬁnes for any φ ∈ L2(G×S)
such that the integral converges,

∂E (E) = ∂ ˜K

∂E (E)φ.

Lβ(E)φ :=ZG×S

β(x, ω′, ω, E)φ(x, ω′)dωdx,

then for every E ∈ I one has (compare to (172)),

kLβ(E)φk2

L2(G×S) ≤ kβ(E)kL∞(G×S,L1(S′)) kβ(E)kL∞(G×S′,L1(S)) kφk2

L2(G×S) ,

(198)

with the conventions β(E)(x, ω)(ω′) = β(E)(x, ω′)(ω) = β(x, ω′, ω, E) as above.

For a ﬁxed E0 ∈ I, taking β(x, ω′, ω, E) = σ(x, ω′, ω, E)− σ(x, ω′, ω, E0), we have
kφ(E) − kφ(E0) = Lβ(E)φ, and the above estimate shows that kφ is continuous at
E0, by assumption (195). Similarly, one sees that E 7→ ∂ ˜K
∂E (E)φ, is continuous at
E0, by choosing β(x, ω′, ω, E) = ∂σ
Finally, the diﬀerentiability of kφ at E0 is obtained by taking in the above estimate,

∂E (x, ω′, ω, E) − ∂σ

∂E (x, ω′, ω, E0).

β(x, ω′, ω, E) =

σ(x, ω′, ω, E) − σ(x, ω′, ω, E0)

E − E0

−

(x, ω′, ω, E0),

∂σ
∂E
φ(E0) = ∂ ˜K

whence kφ(E)−kφ(E0)
completes the proof of the lemma.

− ∂ ˜K

E−E0

∂E (E0)φ = Lβ(E)φ, and we have k′

∂E (E0)φ. This
(cid:3)

ON EXISTENCE OF L2-SOLUTIONS FOR COUPLED CSDA

47

Remark 3.18 In fact, the proof of the previous lemma shows that ˜K as a map
I → L(L2(G × S)) is C 1, where for a Banach space Z the set L(Z) is the space of
bounded linear operators Z → Z equipped with the uniform operator norm topology.
With the above notations and results at hand, we are ready to state the central

result of this section.

Theorem 3.19 Suppose that the assumptions (83), (91), (92) and (94) are valid,
that ˜σ ≥ 0, and that

Σ ∈ C 1(I, L∞(G × S)),
S0 ∈ C 2(I, L∞(G)),
˜σ ∈ C 1(I, L∞(G × S, L1(S′))) ∩ C 1(I, L∞(G × S′, L1(S))).

(201)
Let f ∈ C 1(I, L2(G × S)) and let g ∈ C 2(I, T 2(Γ−)) which satisﬁes the compati-

(200)

(199)

bility condition

g(Em) = 0.

(202)
Then the problem (80), (81), (82) has a unique solution ψ ∈ C(I, ˜W 2(G × S)) ∩
C 1(I, L2(G × S)).
If in addition the assumptions (95) (with c > 0) and (133) are also valid, the
estimate

qEm

κ

e

kψkH1 ≤

c′ (cid:0)kfkL2(G×S×I) + kgkT 2(Γ−)(cid:1).

(203)

holds. (The constants κ, q and c′ were deﬁned in (91), (99) and (119), respectively.)

Proof. A. Assume at ﬁrst that g = 0. We make the change of variables and the
change of unknown function as above by setting ˜ψ(x, ω, E) = ψ(x, ω, Em − E) and
φ = e−CE ˜ψ. Choose C = C0 + C ′
0 (see (184), (192)). Then, as observed above, the
problem (80), (81), (82) can be cast into an equivalent form (see (179))

∂φ
∂E − AC(E)φ = f(E), φ(0) = 0,

(204)

where the domain D(AC(E)) = ˜W 2
−,0(G×S) =: D of deﬁnition of AC(E) is indepen-
dent of E. We have, moreover, demonstrated (see Lemma 3.16) that the (densely
deﬁned) operator AC(E) : L2(G × S) → L2(G × S) is m-dissipative for any ﬁxed
E ∈ I.
The assumptions (199), (200), (201) imply that for any ﬁxed φ ∈ D the mapping

is diﬀerentiable and

h′
φ(E) = −

+

hφ(E) := AC(E)φ,

∂

hφ : I → L2(G × S);
∂E(cid:16) 1
∂E(cid:16) 1

˜S(E)(cid:17)ω · ∇φ −
˜S(E)(cid:17) ˜K(E)φ +

∂

∂

∂E(cid:16) 1

1

˜S(E)
∂ ˜K
∂E

(E)φ,

˜S(E)

˜Σ(E)(cid:17)φ −

∂

∂E(cid:16) 1

˜S(E)

∂ ˜S

∂E(cid:17)φ

∂E (E)φ is deﬁned in (196), and the derivative ∂

where ∂ ˜K
∂E (E)φ is
provided by Lemma 3.17. By assumptions (199), (200), (201) we thus see that hφ
is in C 1(I, L2(G × S)).

∂E ( ˜K(E)φ) = ∂ ˜K

ON EXISTENCE OF L2-SOLUTIONS FOR COUPLED CSDA

48

By Theorem 3.12 there exists a unique solution φ ∈ C(I, W 2

−,0(G×S))∩C 1(I, L2(G×
S)) of (204). Then ψ(x, ω, E) := eC(Em−E)φ(x, ω, Em − E) is the required solution
of the problem (80), (81), (82) for g = 0.
B. Suppose that more generally g ∈ C 2(I, T 2(Γ−)) and that the compatibil-
ity condition (202) holds. By Lemma 5.10 given in [55] there exists a lift Lg ∈
C 2(I, ˜W 2(G× S)) for which γ−(Lg) = g, and (Lg)(·,·, Em) = 0 (follows from (202)),
and furthermore ω · ∇(Lg) = 0. Substituting into the problem (80), (81), (82) the
function u := ψ − Lg for ψ we obtain the following problem for u,

−

where

∂(S0u)

∂E

+ ω · ∇u + Σu − Ku = ˜f ,

u|Γ− = 0,

u(·,·, Em) = 0,

(205)

˜f := f −(cid:16) −

∂(S0(Lg))

∂E

+ Σ(Lg) − K(Lg)(cid:17),

and we have ˜F ∈ C 1(I, L2(G × S)) under the assumption (199), (200), (201).
By Part A of the proof, the problem (80), (81), (82) (for g = 0) has a unique
solution u ∈ C(I, ˜W 2
−,0(G × S)) ∩ C 1(I, L2(G × S)). As argued above, ψ := u + Lg
is then then desired unique solution for the problem (80), (81), (82), for the given,
arbitrary g ∈ C 2(I, T 2(Γ−)).
Indeed, since ψ ∈
C 1(I, L2(G × S)), we have ψ ∈ L2(G × S × I) and ∂ψ
∂E ∈ L2(G × S × I). On the
other hand, since ψ solves (80), these imply, together with the assumptions made,
that ω · ∇ψ ∈ L2(G × S × I), which conﬁrms the claim.
from Corollary 3.8 (part (iii)). This completes the proof.

Hence, under the additional assumptions (95) and (133), the estimate (203) follows
(cid:3)

We claim that the solution ψ belongs to W 2

1 (G × S × I).

The term compatibility condition used above for the assumption (202) for g comes
from the observation that since the solution ψ is to satisfy (82) and we have ψ ∈
C(I, ˜W 2(G × S)), it follows that ψ(Em) = 0, and therefore 0 = ψ(Em)|Γ− = g(Em).
Remark 3.20 Strictly speaking, in the proof of Theorem 3.19 above we did not
fully address the claim that u ∈ C(I, ˜W 2
−,0(G× S)), since, as pointed out in Remark
3.13, the common domain D = D(AC(E)) = ˜W 2
−,0(G × S) of the operators AC(E),
E ∈ I, is to be equipped with the graph norm of AC(0) when applying Theorem
−,0(G × S) is equivalent to the graph
3.12. However, the norm k·k ˜W 2
norm k·kAC (E) in D = ˜W 2
−,0(G × S), for every E ∈ I, and in particular for E = 0.
This can be readily seen from the estimates, for φ ∈ D,

−,0(G×S) of ˜W 2

κ(cid:0) kω · ∇φkL2(G×S) + C2 kφkL2(G×S)(cid:1),
kAC(E)φkL2(G×S) ≤
kω · ∇φkL2(G×S) ≤ C1 kAC(E)φkL2(G×S) + C2 kφkL2(G×S) ,
(E)(cid:13)(cid:13)(cid:13)(cid:13)(cid:13)L∞

, C2 := CC1 +(cid:13)(cid:13)(cid:13)

˜Σ(E)(cid:13)(cid:13)(cid:13)L∞

˜S(E)(cid:13)(cid:13)(cid:13)L∞

+(cid:13)(cid:13)(cid:13)(cid:13)(cid:13)

∂ ˜S
∂E

,

+(cid:13)(cid:13)(cid:13)
˜K(E)(cid:13)(cid:13)(cid:13)

and we have used a short hand notation L∞ for L∞(G × S). Notice also that
kγ−(φ)kT 2(Γ−) = 0 when φ ∈ ˜W 2

−,0(G × S).

where

C1 :=(cid:13)(cid:13)(cid:13)

1

ON EXISTENCE OF L2-SOLUTIONS FOR COUPLED CSDA

49

Let H m(I, X), m ∈ N0 be the Sobolev space for Hilbert space valued functions

I → X. We have the following corollary.
Corollary 3.21 Suppose that the assumptions (83), (91), (92), (94) and (199),
(200) and (201) of Theorem 3.19 are valid, and ˜σ ≥ 0. Let f ∈ H 2(I, L2(G × S))
and g ∈ H 3(I, T 2(Γ−)) which satisﬁes the compatibility condition

g(Em) = 0.

(206)
Then the problem (80), (81), (82) has a unique solution ψ ∈ C(I, ˜W 2(G × S)) ∩
C 1(I, L2(G × S)).
If in addition the assumptions (95) (with c > 0) and (133) are also valid, the
estimate (203) holds.

Proof. By the Sobolev Embedding Theorem

H m(I, X) ⊂ C j(I, X) for m > j +

1
2

and then the assertion follows from Theorem 4.11.

(cid:3)

Remark 3.22 The evolution equation based approach given above can be general-
ized for Lp-theory when 1 ≤ p < ∞. The approach based on the Lions-Lax-Milgram
Theorem (section 3.2) is limited to the Hilbert space structure, and can therefore
be only applied for p = 2. However, some (recent) generalizations for reﬂexive Ba-
nach spaces of Lions-Lax-Milgram theory might allow methods of section 3.2 to be
generalized also for 1 < p < ∞.
3.5. On the Existence of Solutions for Volterra Type Collision Operators.
In the previous section, we assumed that the collision operator K is of the form

(Kψ)(x, ω, E) = RS σ(x, ω′, ω, E)ψ(x, ω′, E)dω′ in order to avoid integration over

I with respect to E′. Considerations were founded on the fact that Kψ had a
representation (Kψ)(E) = K(E)ψ(E). However, for some collision operators of
special type, also integration with respect to E′ is possible in evolution operator
based approaches. In this section, we give a short and formal description of such a
technique for Volterra type collision operators.

Consider the problem (80), (81), (82) with g = 0,

∂ψ
∂E

−

+

1

S0(E)

ω · ∇ψ +

1

S0(E)

Σ(E)ψ −

1

S0(E)

∂S0
∂E

(E)ψ −

1

S0(E)

Kψ =

1

S0(E)

f,

ψΓ− = 0, ψ(·,·, Em) = 0.

For simplicity we denote
S0(E) K again by f and K. Assume that I =
[0,∞[ =: R+ and that K is of the Volterra type operator (cf. e.g. [23], pp. 447-452)

S0(E) f and

1

1

(Kψ)(x, ω, E) =Z E
0 ZS

σ(x, ω′, ω, E − E′, E)ψ(x, ω′, E′)dω′dE′.

In other words, Kψ = RS×I ˜σ(·, ω′,·, E′,·)ψ(·, ω′, E′)dω′dE′ for a diﬀerential cross
section ˜σ of the form ˜σ(x, ω′, ω, E′, E) = χI(E − E′)σ(x, ω′, ω, E − E′, E), where χI
is the characteristic function of I. Assume additionally that σ has a decomposition

σ(x, ω′, ω, E − E′, E) = σ1(x, ω′, ω, E)σ2(E − E′).

ON EXISTENCE OF L2-SOLUTIONS FOR COUPLED CSDA

50

Let K1(E) (for a ﬁxed E) be a linear operator L2(G × S) → L2(G × S) deﬁned by

Then we ﬁnd that

(K1(E)φ)(x, ω) =ZS
(Kψ)(x, ω, E) =Z E

0

σ1(x, ω′, ω, E)φ(x, ω′)dω′.

σ2(E − E′)K1(E)ψ(E′)dE′.

Deﬁne an extended space by X := L2(G × S) × L1(R+, L2(G × S)) and a linear
operator A(E) : X → X for a ﬁxed E by (here the argument of R+ is denoted by s)

D(A(E)) = D := ˜W 2
−,0(G × S) × H 1,1(R+, L2(G × S)),
A(E) :=(cid:18)A(E)
ds(cid:19) ,
δ0
d

B(E)

where

H 1,1(R+, L2(G × S)) := {F ∈ L1(R+, L2(G × S)) | F ′ ∈ L1(R+, L2(G × S))},

is the domain of the derivative operator d
the linear operator A(E) : L2(G × S) → L2(G × S) with domain ˜W 2
(independent of E) is given by,
(E)φ(cid:17),

ds : L1(R+, L2(G×S)) → L1(R+, L2(G×S)),
−,0(G × S)

A(E)φ = −(cid:16) 1

Σ(E)φ −

ω · ∇φ +

∂S0
∂E

S0(E)

S0(E)

S0(E)

1

1

the linear operator δ0 is bounded and deﬁned by

δ0 : H 1,1(R+, L2(G × S)) → L2(G × S);

δ0F = F (0),

and ﬁnally B(E) is the bounded linear operator deﬁned by

(B(E)φ)(s) = σ2(s)K1(E)φ.

B(E) : L2(G × S) → L1(R+, L2(G × S));
Let (cid:18)φ
η(cid:19) ∈ X and let (cid:18)ψ
R+ → L1(R+, L2(G × S)); here the argument of ψ and F is denoted by E).
this extended setting, for a given (cid:18)F1
F(cid:19) − A(E)(cid:18)ψ

F(cid:19) ∈ H 1(R+,X ) (note that ψ : R+ → L2(G × S), F :
F2(cid:19) ∈ C(R+,X ), the validity of the evolution
F(cid:19) =(cid:18)F1

F(cid:19) (0) =(cid:18)φ
η(cid:19) ,

F2(cid:19) , (cid:18)ψ

∂E (cid:18)ψ

equation

(207)

In

∂

implies (from the ﬁrst row of the matrix equation) that

∂ψ
∂E − A(E)ψ = F1(E) + δ0(F (E)) = F1(E) + F (E)(0).

(208)

In some cases the evolution system of the operators A(E) has properties which

enable one to deduce the existence of solutions for the transport problem

∂ψ
∂E − A(E)ψ − Kψ = f,
ψΓ− = 0, ψ(0) = φ.

(209)

Note that carrying out the change of variables as above, one is able to replace the
initial condition ψ(0) = φ with ψ(Em) = φ.

ON EXISTENCE OF L2-SOLUTIONS FOR COUPLED CSDA

51

The basis of the idea is as follows. Assume, for example, that S0, Σ and σ1 are
independent of E. Then the operators A(E), K1(E), B(E) and A(E) are indepen-
dent of E as well. Let T (E) be the C 0-semigroups generated by A. Deﬁne a linear
operator R(E) : L1(R+, L2(G × S)) → L2(G × S) by

R(E)η :=Z E

0

T (E − s)η(s)ds.

Denote by S(E) the (left) translation semigroup on L1(R+, L2(G × S)),

(S(E)η)(s) := η(E + s).

(210)

Finally, let

T (E) :=(cid:18)T (E) R(E)
S(E)(cid:19) .
Then T (E) is the C 0-semigroup generated by (cid:18)A δ0
ds(cid:19) : X → X ([23], pp. 437-
438). Furthermore, letting S(E) : X → X be the C 0-semigroup generated by the
perturbed operator

0

0

d

A :=(cid:18)A δ0

ds(cid:19) +(cid:18) 0

B 0(cid:19) ,

0

0

d

Corollary III.1.7)

F(cid:19) (E) := S(E)(cid:18)φ

it follows that (cid:18)ψ
η(cid:19) is the solution of (207) for (cid:18)F1
The above semigroups obey the following formula, for every (cid:18)φ
η(cid:19) ds
F(cid:19) (s)ds, .

0 T (E − s)BS(s)(cid:18)φ
0 T (E − s)B(cid:18)ψ

η(cid:19) =T (E)(cid:18)φ
=T (E)(cid:18)φ

η(cid:19) +Z E
η(cid:19) +Z E

S(E)(cid:18)φ

F2(cid:19) =(cid:18)0
0(cid:19).
η(cid:19) ∈ X : ([23],

from which the last row gives us

F (E) = S(E)f +Z E

0

S(E − s)Bψ(s)ds,

0

B 0(cid:19).

where B :=(cid:18) 0
Choose η := f and (cid:18)F1
F2(cid:19) =(cid:18)0
f(cid:19)
F(cid:19) (E) = S(E)(cid:18)φ
(cid:18)ψ
f(cid:19) +Z E
=(cid:18)T (E) R(E)
S(E)(cid:19)(cid:18)φ
f(cid:19) +Z E
=(cid:18)T (E) R(E)
S(E)(cid:19)(cid:18)φ

0

0

0(cid:19). Applying the above facts we have

0

0

0 (cid:18)T (E − s) R(E − s)
0 (cid:18)T (E − s) R(E − s)

S(E − s)(cid:19)(cid:18) 0
S(E − s)(cid:19)(cid:18) 0

B 0(cid:19)(cid:18)ψ
Bψ(s)(cid:19) ds,

0

F(cid:19) (s)ds

(211)

(212)

(213)

ON EXISTENCE OF L2-SOLUTIONS FOR COUPLED CSDA

52

and then (recall (210) and that (Bψ(s))(t) = σ2(t)K1ψ(s))

F (E)(0) = f (E) +Z E

0 (cid:0)S(E − s)(Bψ(s))(cid:1)(0)ds = f (E) +Z E

0

σ2(E − s)K1ψ(s)ds.
(214)

Combining (214) and (208) we ﬁnally see that ψ is a solution of the transport
problem (209).

˜W 2
row of matrix equation (212) that ψ(0) = T (0)φ + R(0)f = φ.

Finally, we note that in the case where (cid:18)ψ
F(cid:19) ∈ D(A), we have ψ(E) ∈ D(A) =
−,0(G × S), for any E ≥ 0, and thus in particular, ψ|Γ− = 0. We ﬁnd by the ﬁrst
It might be worth attempting to generalize this method under less restrictive
assumptions, especially for the case where S0, Σ, σ1 are allowed to be E-dependent.

4. Existence of Solutions for the Coupled System

In this section, we consider the coupled transport problem. For simplicity denote
Σj := Σj,r, Sj := Sj,r, σjj,r := σjj for j = 2, 3. Let f = (f1, f2, f3) ∈ L2(G × S × I)3
and g = (g1, g2, g3) ∈ T 2(Γ−)3.
We deal with the following coupled system of integro-partial diﬀerential equations
for ψ = (ψ1, ψ2, ψ3) on G × S × I,

ω · ∇ψ1 + Σ1ψ1 − K1ψ = f1,
+ ω · ∇ψj + Σjψj − Kjψ = fj,

∂(Sjψj)

∂E

−

j = 2, 3.

(215)

(216)

In order to guarantee uniqueness of solutions, we moreover impose the inﬂow bound-
ary condition on Γ−,

ψj |Γ−

= gj,

j = 1, 2, 3,

and initial value (or energy boundary) condition on G × S,

ψj(·,·, Em) = 0,

j = 2, 3,

(217)

(218)

where Em is the cut-oﬀ energy. As mentioned in the introduction the problem
(215)-(218) is an approximation of the problem (1), (2).

We assume that the total (restricted) cross sections Σj : G × S × I → R, for

j = 1, 2, 3, are functions such that

j = 1, 2, 3.

Σj ∈ L∞(G × S × I), Σj ≥ 0,

σkj(x, ω′, ω, E′, E)dω′dE′ ≤ M1,

(219)
Furthermore, we assume that the diﬀerential (restricted) cross sections σkj : G ×
S2 × I 2 → R, k, j = 1, 2, 3, are measurable functions such that
Xk=1ZS×I
Xk=1ZS×I
σkj ≥ 0,
Deﬁne the (restricted) scattering operator Σj and the (restricted) collision operator
Kj corresponding to the particle type j, for j = 1, 2, 3 and ψj ∈ L2(G × S × I), as

a.e. G × S × I,
a.e. G × S2 × I 2,

σjk(x, ω, ω′, E, E′)dω′dE′ ≤ M2,

j = 1, 2, 3,

(220)

a.e. G × S × I,

j = 1, 2, 3,

3

3

k, j = 1, 2, 3.

ON EXISTENCE OF L2-SOLUTIONS FOR COUPLED CSDA

53

follows

(Σjψj)(x, ω, E) = Σj(x, ω, E)ψj(x, ω, E),

(221)

and for ψ = (ψ1, ψ2, ψ3) ∈ L2(G × S × I)3,

(Kjψ)(x, ω, E) =

σkj(x, ω′, ω, E′, E)ψk(x, ω′, E′)dω′dE′.

(222)

3

Xk=1ZS×I

Furthermore, we deﬁne for ψ = (ψ1, ψ2, ψ3) ∈ L2(G × S × I)3,

Σψ = (Σ1ψ1, Σ2ψ2, Σ3ψ3)

(223)

and

(224)
One immediately sees that Σ : L2(G × S × I)3 → L2(G × S × I)3 is a bounded
linear operator. In addition, by applying H¨older’s inequality we have the following
(cf. [19], pp. 227-228 and [55], Theorem 5.2 for p = 1; see also (87), (88)).

Kψ = (K1ψ, K2ψ, K3ψ).

Theorem 4.1 The linear operator K : L2(G×S×I)3 → L2(G×S×I)3 is bounded
and

kKk ≤ max

j=1,2,3(cid:13)(cid:13)(cid:13)(cid:13)(cid:13)

1/2M2

≤M1

3

Xk=1ZS×I

1/2,

1/2

3

σkj(·, ω′,·, E′,·)dω′dE′(cid:13)(cid:13)(cid:13)(cid:13)(cid:13)
L∞(cid:13)(cid:13)(cid:13)(cid:13)(cid:13)
Xk=1ZS×I

σjk(·,·, ω′,·, E′)dω′dE′(cid:13)(cid:13)(cid:13)(cid:13)(cid:13)

(225)

1/2

L∞

where L∞ = L∞(G × S × I).

We assume that functions Sj : G × I → R, j = 2, 3, the so-called restricted

stopping powers, satisfy the following assumptions:

Sj ∈ L∞(G × I),
∂Sj
∂E ∈ L∞(G × I),
κj := inf
∇Sj ∈ L∞(G × I),

(x,E)∈G×I

Sj(x, E) > 0,

(226)

(227)

(228)

(229)
where as before ∇ = ∇x is taken with respect to the spatial variable x ∈ G only.
Note that (228) implies that in G × I,
1
Sj ≤

(230)

1
κj

.

We point out that the assumption (229) will, in fact, be needed only in section 4.2
when considering (a special case of) the problem (215)-(218) within the context of
the theory of evolution operators (see Theorem 4.11, Eq. (294)).

In order to prove some accretivity properties for the scattering-collision operator
Σ − K : L2(G × S × I)3 → L2(G × S × I)3 (or, equivalently, dissipativity properties
for the operator −Σ + K) we assume that the cross-sections Σj, σjk, satisfy the
following condition: There exists c ≥ 0 such that for a.e. (x, ω, E) ∈ G× S × I, and
for every j = 1, 2, 3,

Σj(x, ω, E) −

3

Xk=1ZS×I

σjk(x, ω, ω′, E, E′)dω′dE′ ≥ c,

(231)

ON EXISTENCE OF L2-SOLUTIONS FOR COUPLED CSDA

54

and

Σj(x, ω, E) −

3

Xk=1ZS×I

σkj(x, ω′, ω, E′, E)dω′dE′ ≥ c.

(232)

(See [19], pp. 241 for one particle, [56] for coupled system, and [55] within L1-theory.)

The following accretivity result holds (see Lemma 3.3).

Theorem 4.2 Let the assumptions (219), (220), (231) and (232) be valid. Then
for every ψ ∈ L2(G × S × I)3,

h(Σ − K)ψ, ψiL2(G×S×I)3 ≥ ckψk2

L2(G×S×I)3 .

(233)

Notice that the estimate (233) is equivalent to the property that for every λ > 0,

and ψ ∈ L2(G × S × I)3,

k(λI − (−Σ + K + cI))ψkL2(G×S×I)3 ≥ λkψkL2(G×S×I)3 ,

(234)
which means that the operator −Σ + K + cI : L2(G × S × I)3 → L2(G × S × I)3 is
dissipative ([23], Section II.3.b, or [43], Section 1.4).

Remark 4.3 In certain situations one may assume that the restricted cross-sections
are of the form

(235)
where δ is the Dirac measure at zero. Hence σkj 6∈ L∞(G×S2×I 2), but the collision
operators are simpler,

σkj(x, ω′, ω, E′, E) = ˜σkj(x, ω′, ω, E)δ(E − E′),

(Kjψ)(x, ω, E) =

˜σkj(x, ω′, ω, E)ψk(x, ω′, E)dω′,

(236)

3

Xk=1ZS

where ψ = (ψ1, ψ2, ψ3) ∈ L2(G× S × I)3. In the assumptions, (220) and (231), (232)
RS×I σjk(x, ω, ω′, E, E′)dω′dE′)
the integrals RS×I σjk(x, ω′, ω, E′, E)dω′dE′ (resp.
over S × I are to be replaced withRS ˜σkj(x, ω′, ω, E)dω′ (resp. RS σjk(x, ω, ω′, E)dω′)

over S.

For the original coupled BTE system (1), (2) we formulate the following result

which is a slight modiﬁcation of results given in [55].

Theorem 4.4 Suppose that the assumptions (219), (220), (231), (232) are valid,
τ−(Γ−)3
and that c is strictly positive. Then for every f ∈ L2(G × S × I)3 and g ∈ T 2
the following assertions hold.

(i) The boundary value problem

ω · ∇ψj + Σjψj − Kjψ = fj,

ψj |Γ−

= gj,

(ii) There exists a constant C > 0 such that

for j = 1, 2, 3, has a unique solution ψ ∈ W 2(G × S × I)3.
(Γ−)3(cid:1).

kψkW 2(G×S×I)3 ≤ C(cid:0)kfkL2(G×S×I)3 + kgkT 2

τ−

(iii) If f ≥ 0 and g ≥ 0, then ψ ≥ 0, i.e. the solution ψ is non-negative for

non-negative data f, g.

(237)

(238)

ON EXISTENCE OF L2-SOLUTIONS FOR COUPLED CSDA

55

Proof. The assertions follow from the considerations expressed in [55] noting that
in Lemma 5.8 (see its proof) of [55] we actually have

kLgkL2(G×S×I) ≤ kgkT 2

τ−

(Γ−) , for g ∈ T 2

τ−(Γ−).

We omit details here.

(cid:3)

The corresponding result for time-dependent coupled system of BTEs has been

proven in [55] as well.

4.1. Existence of Solutions Based on Variational Formulation. As before,
we perform a change of unknown functions, by setting

φj := eCEψj,

j = 1, 2, 3,

(239)

where the constant C will be ﬁxed below. This transforms the problem (215)-(218)
into an equivalent form, with transport equation on G × S × I,

ω · ∇φ1 + Σ1φ1 − K1,Cφ = f1,

(240)

+ ω · ∇φj + CSjφj + Σjφj − Kj,Cφ = fj,

j = 2, 3,

(241)

∂(Sjφj)

∂E

−

boundary condition on Γ−,

and initial condition on G × S,

φ|Γ− = g,

where φ = (φ1, φ2, φ3) and

φj(·,·, Em) = 0,

j = 2, 3,

(242)

(243)

fj = eCEfj,

gj = eCEgj,

j = 1, 2, 3.

The operator KC = (K1,C, K2,C, K3,C) in (240), (241) above is given by

Kj,Cφ :=

3

Xk=1ZS×I

σkj,C(x, ω′, ω, E′, E)φk(x, ω′, E′)dω′dE′,

(244)

where the corresponding diﬀerential cross-sections are

σkj,C(x, ω′, ω, E′, E) := σkj(x, ω′, ω, E′, E)eC(E−E′),

j, k = 1, 2, 3.

(245)

Remark 4.5 We could perform a more reﬁned change of the unknown functions by
setting φ1 := ψ1, φj := eCj Eψj. In this case, the modiﬁed diﬀerential cross-sections
σkj,C would be

σ11,C = σ11,
σk1,C = σk1e−CkE′

,

σ1k,C = σ1keCkE,
σkj,C = σkjeC2E−CkE′

k = 2, 3,

,

j, k = 2, 3.

We omit further considerations of such reﬁnement in this work.

In the rest of the section, work under the assumptions (219), (220), (226), (227),
(228) (as already mentioned, the assumption (229) will be needed only in section

ON EXISTENCE OF L2-SOLUTIONS FOR COUPLED CSDA

56

4.2) and suppose furthermore that (for C given below in (250) and) for some c ≥ 0
the estimates

3

3

Σj(x, ω, E) −

σjk,C(x, ω, ω′, E, E′)dω′dE′ ≥ c,

Xk=1ZS×I
Xk=1ZS×I
hold for a.e. (x, ω, E) ∈ G × S × I.
Remark 4.6 Note that if σkj were (cf. Remark 4.3) of the form σkj(x, ω′, ω, E′, E) =
˜σkj(x, ω′, ω, E)δ(E − E′) then

σkj,C(x, ω′, ω, E′, E)dω′dE′ ≥ c,

Σj(x, ω, E) −

(247)

(246)

ZS×I

σkj,C(x, ω′, ω, E′, E)dω′dE′ =ZS

˜σkj(x, ω′, ω, E)dω′,

for any C, and hence the conditions (246), (247) would be independent of C. All the
considerations below, after obvious adaptations, are valid for this simpliﬁed case.

At ﬁrst, we apply the variational formulations to deduce existence of solutions.

Recall that the inner product in L2(G × S × I)3 is given by
hφj, vjiL2(G×S×I) ,

hφ, viL2(G×S×I)3 =

3

Xj=1

and analogously in other products of inner product spaces.
Integrating by parts
and applying the Green’s formula (35) we ﬁnd (similarly as in section 3.2) that the
bilinear form B(·,·) : C 1(G × S × I)3 × C 1(G × S × I)3 → R and the linear form
F : C 1(G × S × I)3 → R corresponding to the problem (240)- (243) are
B(φ, v) = Xj=2,3(cid:28)φj, Sj

∂E(cid:29)L2(G×S×I) − hφ, ω · ∇viL2(G×S×I)3

∂vj

C hφj, SjvjiL2(G×S×I) + hφ, (Σ∗ − K ∗

C)viL2(G×S×I)3

+ Xj=2,3
+ hγ+(φ), γ+(v)iT 2(Γ+)3 + Xj=2,3

and

hφj(·,·, 0), Sj(·, 0)vj(·,·, 0)iL2(G×S) , (248)

F(v) = hf, viL2(G×S×I)3 + hg, γ−(v)iT 2(Γ−)3 .

(249)

For j = 2, 3, deﬁne

Cj,+ := {(x, E) ∈ G × I |

∂Sj
∂E

(x, E) ≥ 0},

and let

Moreover, deﬁne

qj :=

.

1

2(cid:13)(cid:13)(cid:13)(cid:13)

∂Sj

∂E(cid:13)(cid:13)(cid:13)(cid:13)L∞(Cj,+)

Cj :=

,

j = 2, 3,

qj
κj

C := max{C1, C2}.

(250)

ON EXISTENCE OF L2-SOLUTIONS FOR COUPLED CSDA

57

The appropriate Hilbert spaces are deﬁned as

H := H × H1 × H1,
˜H := ˜W2(G × S × I) × H2 × H2,

(251)
where the space ˜W2(G× S × I) was deﬁned just before Corollary 2.20. Recall from
section 2.1 that the elements of H are of the form

˜φ = ( ˜φ1, ˜φ2, ˜φ3) =(cid:0)(φ1, q1), (φ2, q2, p02, pm2), (φ3, q3, p03, pm3)(cid:1),

with φi ∈ L2(G × S × I), qi ∈ T 2(Γ) for i = 1, 2, 3, and p0j, pmj ∈ L2(G × S) for
j = 2, 3. Moreover, ˜H ⊂ H through the continuous embedding

j = 2, 3.

(252)

v = (v1, v2, v2) 7→(cid:0)(v1, γ(v1)), ̺(v2), ̺(v3)(cid:1),
̺(vj) :=(cid:0)vj, γ(vj), vj(·,·, 0), vj(·,·, Em)(cid:1),
In spaces H and ˜H we use respectively the inner products
hφj, vjiH1

hφ, viH = hφ1, v1iH + Xj=2,3

and

hφ, vi ˜H = hφ1, v1i ˜W2(G×S×I) + Xj=2,3

hφj, vjiH2

.

The bilinear form B : C 1(G × S × I)3 × C 1(G × S × I)3 → R has the following
boundedness and coercivity properties.

Theorem 4.7 Suppose that the assumptions (219), (220), (226), (227), (228) are
valid and that (246), (247) hold for c > 0 and for C given in (250). Then there
exists M > 0 such that

|B(φ, v)| ≤ M kφkH kvk ˜H ∀φ, v ∈ C 1(G × S × I)3,

B(φ, φ) ≥ c′ kφk2

H ∀φ ∈ C 1(G × S × I)3,

and

where

c′ := min{
In addition, for all v ∈ C 1(G × S × I)3,

1
2

,

κ2
2

,

κ3
2

, c}.

(253)

(254)

(255)

(256)

|F(v)| ≤(cid:0)kfkL2(G×S×I)3 + kgkT 2(Γ−)3(cid:1)kvkH .

Proof. The boundedness (253) can be seen as in the proof of Theorem 3.5. The
assumptions (246), (247) imply by Theorem 4.2 that
h(Σ − KC)φ, φiL2(G×S×I)3 ≥ ckφk2

(257)
Hence we see as in the proof of Theorem 3.5 that for C = max{C1, C2} the coercitiv-
ity (254) holds with the stated c′ > 0. The estimate (256) is immediate (see (128))
and so the proof is ﬁnished.
(cid:3)

L2(G×S×I)3 .

Due to the above theorem, the bilinear form B(·,·) has a unique extension ˜B(·,·) :

H × ˜H → R which satisﬁes

| ˜B( ˜φ, v)| ≤ M(cid:13)(cid:13)(cid:13)

˜φ(cid:13)(cid:13)(cid:13)H kvk ˜H ∀ ˜φ ∈ H, v ∈ ˜H,

(258)

ON EXISTENCE OF L2-SOLUTIONS FOR COUPLED CSDA

58

and

˜B(v, v) ≥ c′ kvk2

H ∀v ∈ ˜H.

(259)

Likewise, (256) implies that the linear form F has a unique bounded extension
H → R, which we still denote by F. The variational equation corresponding to the
problem (240)-(243) is

We have

˜B( ˜φ, v) = F(v) ∀v ∈ ˜H.

(260)

Theorem 4.8 Suppose that the assumptions (219), (220), (226), (227), (228) are
valid, and that (246), (247) hold for c > 0 and for C given in (250). Let f ∈
L2(G × S × I)3 and g ∈ T 2(Γ−)3. Then the following assertions hold.

(i) The variational equation

˜B( ˜φ, v) = F(v) ∀v ∈ ˜H,

(261)
has a solution ˜φ = ( ˜φ1, ˜φ2, ˜φ3) ∈ H. Writing ˜φ1 = (φ1, q1), ˜φj = (φj, qj, p0j, pmj),
j = 2, 3, and φ = (φ1, φ2, φ3) ∈ L2(G × S × I)3, then φ is a weak (distributional)
solution of the system of equations (240), (241) and φ1 ∈ W 2(G × S × I).
(ii) If a solution φ of the system of equations (240), (241) obtained in part (i)
1 (G× S × I)2, then φ belongs also to ˜W 2(G× S × I)3
belongs to W 2(G× S × I)× W 2
and it is a solution of the problem (240)-(243).
(iii) Suppose that the density property (133) is valid. Then any solution φ ∈
1 (G × S × I)2 of the problem (240)-(243) is unique, belongs to

W 2(G × S × I) × W 2
˜H and obeys the estimate

kφkH ≤

where c′ is given in (255).

1

c′(cid:0) kfkL2(G×S×I)3 + kgkT 2(Γ−)3(cid:1),

(262)

Proof. The proofs of items (i)-(ii) are analogous to the proofs of the corresponding
items in Theorem 3.7. Note that the claim φ1 ∈ W 2(G × S × I) in part (i) follows
from noticing that by (240) we have ω · ∇φ1 = −Σ1φ1 + K1,Cφ + f1, and the right
hand side belongs to L2(G × S × I).
It is not diﬃcult to see that the assumption (133) implies the equality of spaces
(73), from which we have

˜W 2(G × S × I) ×(cid:0) ˜W 2(G × S × I) ∩ W 2

1 (G × S × I)(cid:1)2 = ˜H,

whenever (133) is assumed. Hence the assertion (iii) is proved by the same argument
as that for part (iii) in Theorem 3.7.
(cid:3)

(263)

The problem (215)-(218) also admits a variational formulation. Deﬁne bilinear

˜B0(·,·) : H × ˜H → R by
˜B0( ˜ψ, v) = Xj=2,3(cid:28)ψj, Sj
∂vj

∂E(cid:29)L2(G×S×I) − hψ, ω · ∇viL2(G×S×I)3 + hψ, (Σ∗ − K ∗)viL2(G×S×I)3

+ hq, γ+(v)iT 2(Γ+)3 + Xj=2,3

hp0j, Sj(·, 0)vj(·,·, 0)iL2(G×S) ,

(264)

where ˜ψ = ( ˜ψ1, ˜ψ2, ˜ψ3), ˜ψ1 = (ψ1, q1), ˜ψj = (ψj, qj, p0j, pmj), j = 2, 3, and ψ =
(ψ1, ψ2, ψ3), q = (q1, q2, q3). In other words, ˜B0 is the unique extension of (248) with

ON EXISTENCE OF L2-SOLUTIONS FOR COUPLED CSDA

59

C = 0. Then by part (ii) of Theorem 4.8, a given ψ ∈ W 2(G×S×I)×W 2
is a solution of the problem (215)-(218) if (and only if) the variational equation

1 (G×S×I)2

˜B0( ˜ψ, v) = F0(v),

∀v ∈ ˜H,

holds. Here ψ is identiﬁed with ˜ψ ∈ H through the mapping given in (252), and

F0(v) = hf, viL2(G×S×I)3 + hg, γ−(v)iT 2(Γ−)3 .

(265)

We have the following corollary for the original problem.

Corollary 4.9 Suppose that the assumptions of Theorem 4.8 are valid. Let f ∈
L2(G × S × I)3 and g ∈ T 2(Γ−)3. Then the following assertions hold.

(i) The variational equation

˜B0( ˜ψ, v) = F0(v) ∀v ∈ ˜H

(266)
has a solution ˜ψ = ( ˜ψ1, ˜ψ2, ˜ψ3) ∈ H. Writing ˜ψ1 = (ψ1, q1), ˜ψj = (ψj, qj, p0j, pmj), j =
2, 3, and ψ = (ψ1, ψ2, ψ3) ∈ L2(G×S×I)3, then ψ ∈ L2(G×S×I)3 is a weak (distri-
butional) solution of the system of equations (215), (216), and ψ1 ∈ W 2(G× S × I).
(ii) If the solution ψ of equations (215), (216) obtained in part (i) belongs to
1 (G × S × I)2, then ψ belongs also to ˜W 2(G × S × I)3 and it is
W 2(G × S × I) × W 2
a solution of the problem (215)-(218).
(iii) Suppose that the density property (133) is valid. Then any solution ψ ∈
1 (G × S × I)2 of the problem (215)-(218) is unique, belongs to

W 2(G × S × I) × W 2
˜H and obeys the estimate
kψkH ≤

eCEm

c′ (cid:0)kfkL2(G×S×I)3 + kgkT 2(Γ−)3(cid:1).

(267)

(Recall that C is deﬁned in (250), c′ > 0 in (255) and that Em is the cutoﬀ energy.)

Proof. A solution ψ of the problem (215)-(218) is obtained from a solution φ of the
problem (240)-(243) by taking ψ = e−CEφ. Note that if φ1 ∈ W 2(G × S × I), then
ψ1 ∈ W 2(G × S × I) as well. Moreover, we point out that assuming (133) implies
the equality of spaces (263). The rest of the proof proceeds in exactly the same
way as that for Corollary 3.8 (of course, one uses Theorem 4.8 instead of Theorem
3.7).
(cid:3)

4.2. Existence of Solutions Based on the Theory of Evolution Equation.
For collision operator of special type, the existence result based on the theory of
evolution operators is valid also for the coupled system. One of the important
features of this approach is that it yields more regularity for the solution.

We assume that the collision operator K = (K1, K2, K3) is of the form (see Re-

mark 4.3)

(Kjψ)(x, ω, E) =

3

Xk=1ZS

˜σkj(x, ω′, ω, E)ψk(x, ω′, E)dω′,

j = 1, 2, 3.

(268)

For a ﬁxed E ∈ I we deﬁne bounded linear operators L2(G × S) → L2(G × S) by

(Σ1(E)v)(x, ω) := Σ1(x, ω, E)v(x, ω),

(K 1(E)v)(x, ω) :=ZS

˜σ11(x, ω′, ω, E)v(x, ω′)dω′.

In order to avoid ambiguity, below we often denote by S′ the sphere S for the
variable ω′, while S is reserved for ω. For example, saying that h is a function

ON EXISTENCE OF L2-SOLUTIONS FOR COUPLED CSDA

60

S → (S′ → R) (resp. S′ → (S → R)) means that we would write h(ω)(ω′) (resp.
h(ω′)(ω)).

Lemma 4.10 Suppose that

Σ1 ∈ C 1(I, L∞(G × S)),

˜σ11 ∈ C 1(I, L∞(G × S, L1(S′))) ∩ C 1(I, L∞(G × S′, L1(S))),

Σ1 ≥ 0,

˜σ11 ≥ 0,

and that for some c > 0 the following hold a.e. (x, ω, E) ∈ G × S × I,

Σ1(x, ω, E) −ZS
Σ1(x, ω, E) −ZS

˜σ11(x, ω, ω′, E)dω′ ≥ c,
˜σ11(x, ω′, ω, E)dω′ ≥ c.

Then for every q ∈ C 1(I, L2(G × S)) and every E ∈ I the problem

ω · ∇v + Σ1(E)v − K 1(E)v = q(E),

v|Γ′

− = 0,

has a unique solution v = v(E) ∈ ˜W 2
−,0(G × S), and
1
c kq(E)kL2(G×S) ,

kv(E)kL2(G×S) ≤

∀E ∈ I.

(269)

(270)

(271)

(272)

(273)

(274)

(275)

In addition, v(·) : I → L2(G × S) belongs to C 1(I, L2(G × S)) and for all E ∈ I,

1

(E)(cid:13)(cid:13)(cid:13)(cid:13)L2(G×S) ≤

∂v
∂E

(cid:13)(cid:13)(cid:13)(cid:13)

where

+

1

+

∂q
∂E

∂K 1
∂E

c(cid:16)(cid:13)(cid:13)(cid:13)(cid:13)
(E)(cid:13)(cid:13)(cid:13)(cid:13)L2(G×S)
(E)(cid:13)(cid:13)(cid:13)(cid:13)
c (cid:13)(cid:13)(cid:13)(cid:13)
(E)v(cid:17)(x, ω) :=ZS

∂ ˜σ11
∂E

(cid:16)∂K 1

∂E

∂Σ1
∂E

1

c (cid:13)(cid:13)(cid:13)(cid:13)

(E)(cid:13)(cid:13)(cid:13)(cid:13)L∞(G×S) kq(E)kL2(G×S)

(276)

kq(E)kL2(G×S)(cid:17),

(x, ω′, ω, E)v(x, ω′)dω′.

Proof. That the problem (274) has, for every ﬁxed E ∈ I, a unique solution v =
v(E), and that the estimate (275) holds can be proven similarly to Corollary 5.15
in [55] (for the existence of solutions, see also [19], Lemma 4, p. 241).

A. At ﬁrst we show that v ∈ C(I, L2(G × S)). Let E1, E2 ∈ I. Since v(E) ∈
−,0(G × S) for all E ∈ I, it follows that (v(E1) − v(E2))|Γ′
− = 0. Moreover,

˜W 2
v(E1) − v(E2) satisﬁes the equation

ω · ∇(cid:0)v(E1) − v(E2)(cid:1) + Σ1(E1)(cid:0)v(E1) − v(E2)(cid:1) − K 1(E1)(cid:0)v(E1) − v(E2)(cid:1)
= q(E1) − q(E2) −(cid:0)Σ1(E1) − Σ1(E2)(cid:1)v(E2) +(cid:0)K 1(E1) − K 1(E2)(cid:1)v(E2).

(277)

ON EXISTENCE OF L2-SOLUTIONS FOR COUPLED CSDA

61

Therefore, one can apply the estimate (275), obtaining

(278)

L∞(G×S′,L1(S)) .
(279)

1

≤

≤

kv(E1) − v(E2)kL2(G×S)
1
c(cid:16)kq(E1) − q(E2)kL2(G×S) + k(Σ1(E1) − Σ1(E2))v(E2)kL2(G×S)
+(cid:13)(cid:13)(K 1(E1) − K 1(E2))v(E2)(cid:13)(cid:13)L2(G×S)(cid:17)
c(cid:16)kq(E1) − q(E2)kL2(G×S) + kΣ1(E1) − Σ1(E2)kL∞(G×S) kv(E2)kL2(G×S)
+(cid:13)(cid:13)K 1(E1) − K 1(E2)(cid:13)(cid:13)kv(E2)kL2(G×S)(cid:17),
(cid:13)(cid:13)K 1(E1) − K 1(E2)(cid:13)(cid:13) ≤ k˜σ11(E1) − ˜σ11(E2)k1/2

L∞(G×S,L1(S′)) k˜σ11(E1) − ˜σ11(E2)k1/2

where (see (172) or (198))

The continuity of v : I → L2(G × S) follows immediately from these estimates and
assumptions (269), (270).
B. Next we verify that v ∈ C 1(I, L2(G × S)) and that the estimate (276) holds.
For a map k : G × S × I → R, which we identify as a map I → (G × S → R);
k(E)(x, ω) = k(x, ω, E) whenever appropriate, deﬁne for h 6= 0 small enough

(δhk)(E) :=

k(E + h) − k(E)

h

where at E-boundaries E = 0 or E = Em we take h > 0 and h < 0, respectively.
Since v(E′) ∈ ˜W 2
− = 0, and from the
equation (274) we obtain (from (277), with E1 = E, E2 = E + h)

−,0(G × S) for all E′ ∈ I, we have (δhv)(E)|Γ′

ω · ∇((δhv)(E)) + Σ1(E)(δhv)(E) − K 1(E)(δhv)(E)
= (δhq)(E) − (δhΣ1)(E)v(E + h) + (δhK 1)(E)v(E + h),

(280)

where for any w ∈ L2(G × S),

(δhK 1)(E)w :=ZS
=ZS

˜σ11(x, ω′, ω, E + h) − ˜σ11(x, ω′, ω, E)

h

w(x, ω′)dω′

(δh˜σ11)(E)(x, ω′, ω)w(x, ω′)dω′.

To show that the limit limh→0(δhv)(E) exists in L2(G × S) it suﬃces to verify
that limn→∞(δhnv)(E) exists in L2(G × S) for any sequence {hn} tending to zero
as n → ∞, or equivalently that {(δhnv)(E)} is a Cauchy sequence in L2(G × S) for
any such sequence {hn}.

We see by (280) that for n, m ∈ N,

ω · ∇(cid:0)(δhnv)(E) − (δhmv)(E)(cid:1) + Σ1(E)(cid:0)(δhnv)(E) − (δhmv)(E)(cid:1)
− K 1(E)(cid:0)(δhnv)(E) − (δhmv)(E)(cid:1)
= (δhnq)(E) − (δhmq)(E) −(cid:0)(δhnΣ1)(E)v(E + hn) − (δhmΣ1)(E)v(E + hm)(cid:1)
+(cid:0)(δhnK 1)(E)v(E + hn) − (δhmK 1)(E)v(E + hm)(cid:1)

=: fhn,hm(E).

(281)

ON EXISTENCE OF L2-SOLUTIONS FOR COUPLED CSDA

62

The following estimates hold (see (278), (279))

k(δhnΣ1)(E)v(E + hn) − (δhmΣ1)(E)v(E + hm)kL2(G×S)
≤k(δhnΣ1)(E) − (δhmΣ1)(E)kL∞(G×S) kv(E + hn)kL2(G×S)

+ k(δhmΣ1)(E)kL∞(G×S) kv(E + hn) − v(E + hm)kL2(G×S) ,

and

where

(cid:13)(cid:13)(δhnK 1)(E)v(E + hn) − (δhmK 1)(E)v(E + hm)(cid:13)(cid:13)L2(G×S)
≤(cid:13)(cid:13)(δhnK 1)(E) − (δhmK 1)(E)(cid:13)(cid:13)kv(E + hn)kL2(G×S)
+(cid:13)(cid:13)(δhmK 1)(E)(cid:13)(cid:13)kv(E + hn) − v(E + hm)kL2(G×S) ,
L∞(G×S,L1(S′)) k(δhm ˜σ11)(E)k1/2

and

L∞(G×S′,L1(S)) ,

(cid:13)(cid:13)(δhmK 1)(E)(cid:13)(cid:13) ≤ k(δhm ˜σ11)(E)k1/2
(cid:13)(cid:13)(δhnK 1)(E) − (δhmK 1)(E)(cid:13)(cid:13)
≤k(δhn ˜σ11)(E1) − (δhm ˜σ11)(E2)k1/2
Therefore, since we assume (269), (270) and q ∈ C 1(I, L2(G × S)), and since v ∈
C(I, L2(G×S)) by part A of the proof, we ﬁnd that fhn,hm(E) in (281) convergences
to zero in L2(G×S) when n, m → ∞. This fact combined with the estimate obtained
by applying (275),

L∞(G×S,L1(S′)) k(δhn ˜σ11)(E1) − (δhm ˜σ11)(E2)k1/2

k(δhnv)(E) − (δhmv)(E)kL2(G×S) ≤

1
c kfhn,hm(E)kL2(G×S) ,

(282)

shows that {(δhnv)(E)} is a Cauchy sequence, and so ∂v
for every E ∈ I.

Applying the estimate (275) to (δhv)(E) which satisﬁes (280), we get

∂E (E) exists (in L2(G × S))

L∞(G×S′,L1(S)) .

1

1

(283)

∂v
∂E

(cid:13)(cid:13)(cid:13)(cid:13)

k(δhv)(E)kL2(G×S) ≤

(E)(cid:13)(cid:13)(cid:13)(cid:13)L2(G×S) ≤

Under the standing assumptions (and the fact that v is continuous), the inequality
(283) gives in the limit h → 0,
∂q
∂E

c(cid:16)k(δhq)(E)kL2(G×S) + k(δhΣ1)(E)kL∞(G×S) kv(E + h)kL2(G×S)
+(cid:13)(cid:13)(δhK 1)(E)(cid:13)(cid:13)kv(E + h)kL2(G×S)(cid:17).
c(cid:16)(cid:13)(cid:13)(cid:13)(cid:13)
+(cid:13)(cid:13)(cid:13)(cid:13)
∂E (E)(cid:17) ∈ L2(G × S) for all E ∈ I, and
(280) we get that ω · ∇(cid:16) ∂v
ω · ∇(cid:16) ∂v
(E)(cid:17) + Σ1(E)

(E)(cid:13)(cid:13)(cid:13)(cid:13)L∞(G×S) kv(E)kL2(G×S)

∂E ∈ C(I, L2(G × S)). By letting h → 0 in equation

(E)(cid:13)(cid:13)(cid:13)(cid:13)L2(G×S)
(E)(cid:13)(cid:13)(cid:13)(cid:13)

and thus, using (275) once more, we obtain (276) as claimed.

kv(E)kL2(G×S)(cid:17),

It remains to be shown that ∂v

+(cid:13)(cid:13)(cid:13)(cid:13)

∂K 1
∂E

∂Σ1
∂E

(284)

∂E

∂v
∂E

∂v
∂E

(E) − K 1(E)(cid:0)
(E) −

∂q
∂E

=

(E)(cid:1)

∂Σ1
∂E

(E)v(E) +

(E)v(E).

(285)

∂K 1
∂E

ON EXISTENCE OF L2-SOLUTIONS FOR COUPLED CSDA

63

In addition, (δhv)(E) → ∂v
∂E (E) in W 2(G × S × I) when h → 0, and therefore,
− = 0 (by applying inﬂow trace
since ((δhv)(E))|Γ′
results; see e.g. Remark 2.8). Finally, an application of (275) yields, as in (277),
(278) (we write L2 = L2(G× S), L∞ = L∞(G× S) in order to slightly compress the
formulas),

− = 0, we conclude that ( ∂v

∂E )(E)|Γ′

(286)

∂q
∂E

∂Σ1
∂E

∂Σ1
∂E

(E1) −

(E2)(cid:13)(cid:13)(cid:13)(cid:13)L∞ kv(E2)kL2
(E2)(cid:13)(cid:13)(cid:13)(cid:13)L∞ kv(E2) − v(E1)kL2 + kΣ1(E1) − Σ1(E2)kL∞(cid:13)(cid:13)(cid:13)(cid:13)
(E2)(cid:13)(cid:13)(cid:13)(cid:13)

+(cid:13)(cid:13)(cid:13)(cid:13)
kv(E2)kL2 +(cid:13)(cid:13)(cid:13)(cid:13)
(E2)(cid:13)(cid:13)(cid:13)(cid:13)L2(cid:17),

∂K 1
∂E

∂K 1
∂E

∂v
∂E

∂v
∂E

kv(E2) − v(E1)kL2

(E2)(cid:13)(cid:13)(cid:13)(cid:13)L2

(287)

1

≤

∂q
∂E

∂v
∂E

∂v
∂E

∂Σ1
∂E

∂K 1
∂E

(E1) −

(E1) −

(E1) −

(cid:13)(cid:13)(cid:13)(cid:13)
(E2)(cid:13)(cid:13)(cid:13)(cid:13)L2
c(cid:16)(cid:13)(cid:13)(cid:13)(cid:13)
(E2)(cid:13)(cid:13)(cid:13)(cid:13)L2
+(cid:13)(cid:13)(cid:13)(cid:13)
(E2)(cid:13)(cid:13)(cid:13)(cid:13)
+(cid:13)(cid:13)(cid:13)(cid:13)
+(cid:13)(cid:13)K 1(E1) − K 1(E2)(cid:13)(cid:13)(cid:13)(cid:13)(cid:13)(cid:13)
≤(cid:13)(cid:13)(cid:13)(cid:13)

(E2)(cid:13)(cid:13)(cid:13)(cid:13)

∂K 1
∂E

∂ ˜σ11
∂E

(E1) −

∂K 1
∂E

(cid:13)(cid:13)(cid:13)(cid:13)

and one can further estimate (see (279)),

(E1) −

∂ ˜σ11
∂E

∂ ˜σ11
∂E

(E1) −

∂ ˜σ11
∂E

(E2)(cid:13)(cid:13)(cid:13)(cid:13)

1/2

L(S,S′)(cid:13)(cid:13)(cid:13)(cid:13)

1/2

,

L(S′,S)

(E2)(cid:13)(cid:13)(cid:13)(cid:13)

where we have written L(S, S′) := L∞(G × S, L1(S′)) and L(S′, S) := L∞(G ×
S′, L1(S)). This implies the continuity of ∂v
∂E that we were to demonstrate, and
completes the proof.
(cid:3)

We are ready to formulate, in the context of the theory of evolution operators,
the key existence result for the coupled transport problem (215)-(218), assuming the
collision operator K = (K1, K2, K3) is of the (special) form (268).

Theorem 4.11 Assume that the cross-sections Σj, ˜σjk, where j, k = 1, 2, 3, satisfy

Σj ∈ C 1(I, L∞(G × S)),
˜σjk ∈ C 1(I, L∞(G × S, L1(S′))) ∩ C 1(I, L∞(G × S′, L1(S))),
Σj ≥ 0,

˜σjk ≥ 0,

and that for some c > 0,

Σ1(x, ω, E) −ZS
Σ1(x, ω, E) −ZS

˜σ11(x, ω, ω′, E)dω′ ≥ c,

˜σ11(x, ω′, ω, E)dω′ ≥ c,

(288)

(289)

(290)

(291)

(292)

ON EXISTENCE OF L2-SOLUTIONS FOR COUPLED CSDA

64

for a.e. (x, ω, E) ∈ G × S × I. Furthermore, assume that the stopping powers Sj,
where j = 2, 3, satisfy

Sj ∈ C 2(I, L∞(G)),
∇Sj ∈ L∞(G × I),
κj := inf

(x,E)∈G×I

Sj(x, E) > 0.

(293)

(294)

(295)

Let f ∈ C 1(I, L2(G × S)3) and let g ∈ C 2(I, T 2(Γ′

ibility condition

−)3) which satisﬁes the compat-

gj(Em) = 0,

j = 2, 3.

Then the problem (215)-(218) has a unique solution ψ ∈ ˜W 2(G×S×I)×(cid:0)C(I, ˜W 2(G×
S)2) ∩ C 1(I, L2(G × S)2)(cid:1). In particular, ψ ∈ ˜W 2(G × S × I) × ( ˜W 2(G × S × I) ∩
1 (G × S × I))2.
If in addition the density assumption (133) is valid, and that for some c > 0 the

W 2

inequalities

Σj(x, ω, E) −

Σj(x, ω, E) −

3

Xk=1ZS
Xk=1ZS

3

˜σjk(x, ω, ω′, E)dω′ ≥ c,

˜σkj(x, ω′, ω, E)dω′ ≥ c,

(296)

(297)

hold for j = 1, 2, 3 and for a.e. (x, ω, E) ∈ G × S × I, then the solution ψ satisﬁes
the estimate (267).

Proof. At ﬁrst we notice that by the assumption (289), for a.e. (x, ω, E) ∈ G×S×I,

3

Xk=1ZS
Xk=1ZS

3

3

˜σkj(x, ω′, ω, E)dω′ ≤

˜σjk(x, ω′, ω, E)dω ≤

3

E∈I k˜σkj(E)kL∞(G×S,L1(S′)) =: M1 < ∞,
sup

Xk=1
Xk=1
E∈I k˜σjk(E)kL∞(G×S′,L1(S)) =: M ′
sup

1 < ∞.

(298)

(299)

We begin by treating the special case where g = 0. Recall that the system of

equations of interest on G × S × I for ψ = (ψ1, ψ2, ψ3) is

ω · ∇ψ1 + Σ1ψ1 − K1ψ = f1
−

∂(Sjψj)

∂E

+ ω · ∇ψj + Σjψj − Kjψ = fj,

Equation (300) can be written as

where

ω · ∇ψ1 + Σ1ψ1 − K 1ψ1 − K ˆψ = f1,

ˆψ := (ψ2, ψ3),

j = 2, 3.

(300)

(301)

(302)

ON EXISTENCE OF L2-SOLUTIONS FOR COUPLED CSDA

65

and

K 1ψ1 :=ZS
Xk=2ZS

K ˆψ :=

3

˜σ11(x, ω′, ω, E)ψ1(x, ω′, E)dω′ = K 1(E)ψ1(E)

˜σk1(x, ω′, ω, E)ψk(x, ω′, E)dω′ = K(E) ˆψ(E),

when we deﬁne

K 1(E)v :=ZS
Xk=2ZS

K(E)u :=

3

˜σ11(x, ω′, ω, E)v(x, ω′)dω′,

v ∈ L2(G × S),

˜σk1(x, ω′, ω, E)uk(x, ω′)dω′, u = (u2, u3) ∈ L2(G × S)2.

For any q ∈ L2(G × S × I) the problem

ω · ∇ψ1 + Σ1ψ1 − K 1ψ1 = q

ψ1Γ− = 0

has a unique solution and

kψ1kL2(G×S×I) ≤

1
c kqkL2(G×S×I) .

(303)

(304)

This can also be proven similarly to Corollary 5.15 in [55] (for the existence of
solutions cf. also [19], Lemma 4, p. 241).

Deﬁne a linear operator T1,0 : L2(G×S×I) → L2(G×S×I) with domain D(T1,0)

by

D(T1,0) := ˜W 2
T1,0ψ1 := ω · ∇ψ1 + Σ1ψ1 − K 1ψ1.

−,0(G × S × I)

(305)

Then ψ1 = T −1

1,0 q (exists and) is the solution of (303), and it follows from (304) that

(cid:13)(cid:13)T −1
1,0 q(cid:13)(cid:13)L2(G×S×I) ≤

Equations (301) can be written as

1
c kqkL2(G×S×I) ,

∀q ∈ L2(G × S × I).

(306)

∂(Sjψj)

∂E

−

+ ω · ∇ψj + Σjψj − ˆKj ˆψ − ˆK1,jψ1 = fj,

j = 2, 3

(307)

where

3

ˆKj ˆψ :=

Xk=2ZS
ˆK1,jψ1 :=ZS

˜σkj(x, ω′, ω, E)ψk(x, ω′, E)dω′ = ˆKj(E) ˆψ(E)

˜σ1j(x, ω′, ω, E)ψ1(x, ω′, E)dω′ = ˆK1,j(E)ψ1(E)

when one deﬁnes

3

ˆKj(E)u :=

Xk=2ZS
ˆK1,j(E)v :=ZS

˜σkj(x, ω′, ω, E)uk(x, ω′)dω′, u = (u2, u3) ∈ L2(G × S)2,

˜σ1j(x, ω′, ω, E)v(x, ω′)dω′,

v ∈ L2(G × S).

ON EXISTENCE OF L2-SOLUTIONS FOR COUPLED CSDA

66

Therefore, if ψ = (ψ1, ψ2, ψ3) = (ψ1, ˆψ) is a solution of (300), (301), we have by
equation (302),

ψ1 = T −1

1,0 (f1 + K ˆψ)

and hence by (307) the function ˆψ satisﬁes the equation, for j = 2, 3,

∂(Sjψj)

∂E

−

where we wrote

+ ω · ∇ψj + Σjψj − ˆKj ˆψ − ˆK1,j(T −1

1,0 (K ˆψ)) = fj + ˆfj,

(308)

(309)

Consider the term ˆK1,j(T −1

1,0 f1),

ˆfj := ˆK1,j(T −1
1,0 (K ˆψ)). We ﬁnd that for a ﬁxed E ∈ I

j = 2, 3.

ˆK1,j(T −1

1,0 (K ˆψ)) = ˆK1,j(E)T1,0(E)−1(K(E) ˆψ(E))

where for every E ∈ I the linear operator T1,0(E) : L2(G × S) → L2(G × S) with
domain D(T1,0(E)) is deﬁned to be

D(T1,0(E)) := ˜W 2
T1,0(E)v := ω · ∇v + Σ1(E)v − K 1(E)v.

−,0(G × S)

By (the proof of) Lemma (4.10), the operator T1,0(E) is invertible and
∀˜q ∈ L2(G × S).

(310)
Deﬁne linear operators Qj(E) : L2(G × S)2 → L2(G × S), j = 2, 3, E ∈ I, by

(cid:13)(cid:13)T1,0(E)−1 ˜q(cid:13)(cid:13)L2(G×S) ≤

1
c k˜qkL2(G×S) ,

setting

Qj(E)u := ˆK1,j(E)T1,0(E)−1(K(E)u),

and let Q(E) := (Q1(E), Q2(E)). Then we have by (310) and (298), (299) (see e.g.
(172)) that for all E ∈ I,

kQj(E)k ≤(cid:13)(cid:13)(cid:13)

ˆK1,j(E)(cid:13)(cid:13)(cid:13)(cid:13)(cid:13)T1,0(E)−1(cid:13)(cid:13)(cid:13)(cid:13)K(E)(cid:13)(cid:13) ≤

where the operator norms used are taken, in an obvious way, with respect to the
space L2(G × S) and its product L2(G × S)2.
Using assumption (289) and Lemma 4.10, we ﬁnd that for any ﬁxed u ∈ L2(G×S)2
the mapping hu : I → L2(G×S)2 given by hu(E) := Q(E)u belongs to C 1(I, L2(G×
S)2). Similarly, we ﬁnd that ˆf := ( ˆf1, ˆf2) ∈ C 1(I, L2(G × S)2), since we have

,

(311)

M1M ′
1

c

ˆfj(E) = ˆK1,j(E)T1,0(E)−1(f1(E)), E ∈ I, j = 2, 3,

where ˆfj(E)(x, ω) = ˆfj(x, ω, E).

Let C := max{C2, C3} where for j = 2, 3,
Cj :=

κ−2
j k∇SjkL∞(G×I)

1
2

+ κ−1

(cid:17).
Replacing ˆψ with ˆφ(x, ω, E) := e−CE ˆψ(x, ω, Em − E) (as in section 3.4) we ﬁnd that
the system (309) is equivalent to

j (cid:16) kΣjkL∞(G×S×I) +(cid:13)(cid:13)(cid:13)(cid:13)

∂E(cid:13)(cid:13)(cid:13)(cid:13)L∞(G×I)

+pM1M ′

M1M ′
1

1 +

∂Sj

c

∂ ˆφ
∂E − AC(E) ˆφ = F (E),

ˆφ(0) = 0,

(312)

ON EXISTENCE OF L2-SOLUTIONS FOR COUPLED CSDA

67

where

ˆφ = (φ2, φ3),

AC(E) ˆφ = (AC,2(E) ˆφ, AC,3(E) ˆφ),

F = (F2, F3),

and for j = 2, 3,

and

Fj(E) :=

1

˜Sj(E)

e−CE(cid:0) ˜fj(x, ω, E) +

˜ˆfj(x, ω, E)(cid:1),

AC,j(E) ˆφ := −(cid:16) 1

˜Sj(E)

ω · ∇φj + Cφj +

1

˜Sj(E)
1

−

˜Sj(E)

˜Σj(E)φj +

˜ˆKj(E) ˆφ −

1

˜Sj(E)
1

˜Sj(E)

∂ ˜Sj
∂E

(E)φj

˜Qj(E) ˆφ(cid:17).

(313)

Here ˜Sj(x, E) := Sj(x, Em − E) and similarly for other expressions equipped with
”tilde”.
Considering AC(E) as an (unbounded) operator L2(G × S)2 → L2(G × S)2 with

domain

D(AC(E)) = ˜W 2

−,0(G × S) × ˜W 2

−,0(G × S),

we get by applying Theorem 3.12 along with computations analogous to the ones
done in section 3.4, that the system (312) has a unique solution ˆφ ∈ C(I, ˜W 2
−,0(G ×
S)2) ∩ C 1(I, L2(G × S)2), which satisﬁes the homogeneous boundary and initial
conditions, ˆφ|Γ− = 0, ˆφ(·,·, 0) = 0.
Then ˆψ(x, ω, E) = eC(Em−E) ˆφ(x, ω, Em − E), and ψ1 is obtained from (308) that
1,0 (f1 + K ˆψ), giving us the solution ψ = (ψ1, ψ2, ψ3) = (ψ1, ˆψ) for homoge-
is, ψ1 = T −1
neous (inﬂow) boundary, and initial condition data, that is ψ|Γ− = 0, ψj(·,·, Em) = 0
for j = 2, 3, which is what we were looking for.
By applying the lifts, the existence of a unique solution of the problem (215)-(218)

satisfying the inhomogeneous boundary condition

ψj |Γ−

= gj,

j = 1, 2, 3,

(314)

is obtained as in section 3.4 as well (see the proof of Theorem 3.19). The estimate
(267) under the assumptions (133), (296), (297) follows from Corollary 4.9. This
completes the proof.
(cid:3)

Corollary 4.12 Suppose that the assumptions (288)-(292) of Theorem 4.11 are
−)3)
valid. Furthermore, suppose that f ∈ H 2(I, L2(G × S)3) and g ∈ H 3(I, T 2(Γ′
which satisﬁes the compatibility condition

gj(Em) = 0,

j = 2, 3.

Then the problem (215)-(218) has a unique solution ψ ∈ ˜W 2(G×S×I)×(cid:0)C 1(I, L2(G×
S)2)∩C(I, ˜W (G×S)2)(cid:1). If in addition (133) and (296), (297) are valid, the estimate

(267) holds.

Proof. Follows from the Sobolev Embedding Theorem as in Corollary 3.21.

(cid:3)

ON EXISTENCE OF L2-SOLUTIONS FOR COUPLED CSDA

68

Remark 4.13 The evolution operator based approach given above can be gener-
alized for Lp-theory when 1 ≤ p < ∞.
4.3. Note on Reﬂective Boundary Conditions. Let R := (R1, R2, R3) : L2(Γ+)3 →
L2(Γ−)3 be a linear, possibly unbounded operator with domain D(R). In some prob-
lems the inﬂow boundary condition

ψ|Γ− = g,

(315)

of the problem (215)-(218) is substituted with a more general, so-called reﬂective
boundary condition (cf. [19], Chapter XXI, Appendix of §2, p. 249-262)

ψ|Γ− = R(ψ|Γ+) + g,

(316)
where g ∈ T 2(Γ−)3. We call R a reﬂection operator. Note that when R = 0, we
obtain (315).
We consider here one speciﬁc type of reﬂection operator R = Rb which is of inter-
est in applications where backscattering from outside the region G is of importance.
Let G′ ⊂ R3 be an open bounded set such that G′ is a C 1-manifold with bound-
ary (i.e. G′ has the same regularity properties as G) and such that G ⊂ G′. Let
Ge := G′ \ G. Then

∂Ge = ∂1Ge ∪ ∂2Ge,

where ∂1Ge := ∂G and ∂2Ge := ∂Ge\∂1Ge. Let

Γe := (∂Ge) × S × I = Γe,+ ∪ Γe,− ∪ Γe,0,

where on the right hand side, the decomposition of Γe into the three disjoint subsets
corresponds to Γ = Γ+ ∪ Γ− ∪ Γ0 when considering Ge × S × I instead of G× S × I.
Finally, we can decompose Γe,+ and Γe,− respectively as

where for j = 1, 2,

Γe,± = Γ1

e,± ∪ Γ2

e,±,

Notice that Γ1

e,− = Γ+, while Γ1

Γj

e,± :=(cid:0)(∂jGe) × S × I(cid:1) ∩ Γe,±.

e,+ = Γ−.

We assume (for simplicity) that f = 0. Consider the problem (215)-(218) that is,
ﬁnd ψ = (ψ1, ψ2, ψ3) that satisﬁes on G × S × I the system of transport equations,
(317)

ω · ∇ψ1 + Σ1ψ1 − K1ψ = 0,
+ ω · ∇ψj + Σjψj − Kjψ = 0,

∂(Sjψj)

∂E

−

under the (inﬂow) boundary condition on Γ−,

ψj |Γ−
and the initial condition on G × S,

= gj,

j = 1, 2, 3,

ψj(·,·, Em) = 0,

j = 2, 3.

j = 2, 3

(318)

(319)

(320)

Since Γ1

e,− = Γ+, we ﬁnd that the ﬂux ψ|Γ+ is an inﬂow boundary source for the
domain Ge, on the part ∂1Ge = ∂G of its boundary. Suppose that Ge does not

ON EXISTENCE OF L2-SOLUTIONS FOR COUPLED CSDA

69

contain any extra internal or boundary sources. Then the transport of particles in
Ge is governed by the system of equations on Ge × S × I,
ω · ∇Ψ1 + Σe,1Ψ1 − Ke,1Ψ = 0,
+ ω · ∇Ψj + Σe,jΨj − Ke,jΨ = 0,
for Ψ = (Ψ1, Ψ2, Ψ3), along with the boundary conditions

∂(Se,jΨj)

j = 2, 3,

(321)

(322)

−

∂E

Ψj |Γ1
Ψj |Γ2

e,−

e,−

= ψj |Γ+
= 0

on Γ1

e,− = Γ+,

on Γ2

e,−,

j = 1, 2, 3,

and the initial condition

(323)

(324)

(325)

Ψj(x, ω, Em) = 0 on Ge × S × I,

j = 2, 3.

Above Σe,j, σe,kj and Se,j are the (restricted) cross-sections and the (restricted)
stopping powers for the medium inside Ge, and

(Ke,jΨ)(x, ω, E) :=

σe,kj(x, ω′, ω, E′, E)Ψk(x, ω′, E′)dω′dE′,

3

Xk=1ZS×I

e,+

= Ψ|Γ−,

for Ψ ∈ L2(Ge × S × I)3.
In this setup, we deﬁne a reﬂection operator R = Rb by setting (recall that
Γ1
e,+ = Γ−)
Rb(ψ|Γ+) := Ψ|Γ1
D(Rb) := {ψ|Γ+ | ψ is a solution of (317) − (320) for some g ∈ T 2(Γ−)3}.

If the assumptions of Theorem 4.8 hold for G′ in place of G (and for the respective
cross-sections, stopping powers, Σ′
j), the operator Rb is a linear operator
T 2(Γ+)3 → T 2(Γ−)3 with domain of deﬁnition D(Rb) ⊂ T 2(Γ+)3. In general, Rb is
not bounded.
The meaning of this deﬁnition is that Rb(ψ|Γ+) models an extra source on Γ− (i.e.
an inﬂow boundary source for G) due to backscattering of particles from the given
external region Ge. The ﬂux u = (u1, u2, u3) contributed by this inﬂow source is
governed by the system of equations

kj, S′

(326)

j, σ′

ω · ∇u1 + Σ1u1 − K1u = 0,
+ ω · ∇uj + Σjuj − Kju = 0,

∂(Sjuj)

∂E

−

j = 2, 3,

on G × S × I, such that on Γ−,

u|Γ− = Rb(ψ|Γ+),

(327)

(328)

(329)

and for almost every (x, ω) ∈ G × S,

(330)
We point out that if ψ ∈ D(Rb) and if u solves the problem (327)-(330), and is

uj(x, ω, Em) = 0,

j = 2, 3.

such that

Rb(u|Γ+) = 0,

(331)

holds, i.e. no particles are backscattered repeatedly from Ge into G, then for ϕ :=
ψ + u we have

ϕ|Γ− = ψ|Γ− + u|Γ− = g + Rb(ψ|Γ+) = g + Rb((ψ + u)|Γ+) = g + Rb(ϕ|Γ+),

ON EXISTENCE OF L2-SOLUTIONS FOR COUPLED CSDA

70

and hence ϕ = (ϕ1, ϕ2, ϕ3) = ψ+u is a solution of the following problem on G×S×I,
with boundary and initial conditions holding on Γ− and G × S, respectively,

ω · ∇ϕ1 + Σ1ϕ1 − K1ϕ = 0,

∂(Sjϕj)

−

∂E

+ ω · ∇ϕj + Σjϕj − Kjϕ = 0,
ϕ|Γ− = Rb(ϕ|Γ+) + g,

ϕj(·,·, Em) = 0,

(332)

(333)

(334)

(335)

where j = 2, 3. This shows that solving for ϕ (in place of ψ) the problem (317),
(318), (320) under boundary condition (316), is equivalent to solving ﬁrst for ψ the
problem (317)-(320), and then for u the problem (327)-(330) under the additional
condition (331).

We will not explore the question of the existence of solutions for the problem

(332)-(335) (or for (327)-(331)) in this paper.

5. Some Notes on Computational Methods

5.1. A Decomposition of Solutions Corresponding to Primary and Sec-
ondary Particles. Consider the system of transport equations as above,

ω · ∇ψ1 + Σ1ψ1 − K1ψ = f1,
+ ω · ∇ψj + Σjψj − Kjψ = fj,

∂(Sjψj)

∂E

−

j = 2, 3,

(336)

holding a.e. on G × S × I, together with the inﬂow boundary and initial values

ψ|Γ− = g
ψj(·,·, Em) = 0

a.e. on Γ−,

a.e. on G × S, j = 2, 3.

(337)

(338)

The solution ψ = (ψ1, ψ2, ψ3) for this problem can be decomposed as follows. Let

u = (u1, u2, u3) be the solution of the problem without collisions

ω · ∇u1 + Σ1u1 = f1,
+ ω · ∇uj + Σjuj = fj,
together with the inﬂow boundary and initial values

∂(Sjuj)

−

∂E

j = 2, 3,

(339)

(340)

(341)

u|Γ− = g,
uj(·,·, Em) = 0,

j = 2, 3.

Furthermore, let w = (w1, w2, w3) be the solution of the problem

ω · ∇w1 + Σ1w1 − K1w = K1u
+ ω · ∇wj + Σjwj − Kjw = Kju,

∂(Sjwj)

∂E

−

j = 2, 3,

(342)

together with homogeneous inﬂow boundary and initial values

w|Γ− = 0,
wj(·,·, Em) = 0,

j = 2, 3.

(343)

(344)

Then we ﬁnd that ψ = u + w is the solution of (336)-(338). This corresponds to
decomposing the evolution of the particle ﬁeld ψ obeying the full CSDA Boltzmann

ON EXISTENCE OF L2-SOLUTIONS FOR COUPLED CSDA

71

transport problem (336)-(338) in terms of the evolution of the primary (uncollided)
particles, represented by u, and of secondary (collided) particles, represented by w.
The method of decomposing ψ = u + w in this way is useful e.g.
in constructing
numerical solutions, and is known, for example in neutron transport theory, under
the name collided-uncollided split (cf. the recent work [32] and references therein).
To explain a bit this terminology, notice that the primary, uncollided ﬁeld u obeys
(339) which does not involve the collision operator K = (K1, K2, K3), and u contains
a direct contribution from the external (boundary) sources g (through (340)). On
the other hand, the ﬁeld u right after collision as modelled by the term Ku, acts
as an internal source in the equation (342) for the secondary ﬁeld w, while external
sources do not contribute to w directly (a fact captured by (343)).

Note especially that the system (339)-(341) is uncoupled, in that the diﬀerent par-
ticle species (photon, electron, positron that we consider here) evolve independently
of each other. In some cases the primary component u can be calculated exactly
such as the following example shows.

Example 5.1 Suppose that Σ1 ∈ L2(G × S × I), Σ1 ≥ c > 0 for some constant
c, and that, Σj(x, ω, E) = Σj(x, ω) (i.e. Σj does not depend on E) and Σj ∈
L2(G × S), Σj ≥ c > 0, for j = 2, 3. Furthermore, suppose that Sj(x, E) = Sj(E),
j = 2, 3 (i.e. Sj is independent of x) and that Sj : I → R+ are continuous, strictly
positive functions. Finally, let f1 ∈ L2(G × S × I), g1 ∈ T 2(Γ−), and for j = 2, 3
let fj ∈ H 1(I, L2(G × S)), gj ∈ H 1(I, T 2(Γ′
−)), such that gj(Em) = 0 (compatibility
condition). Deﬁne Rj : I → R by

Rj(E) :=Z E

0

1

Sj(τ )

dτ,

j = 2, 3.

(345)

Let rm,j := Rj(Em). Then Rj : I → [0, rm,j] are continuously diﬀerentiable and
strictly increasing bijections. Let R−1
: [0, rm,j] → I be their inverses. We denote
the argument of R−1
j (η) (or equivalently η = Rj(E)).

on [0, rm,j] by η, i.e. E = R−1
Consider ﬁrst the (primary) uncoupled problem,

j

j

∂(Sjuj)

+ ω · ∇uj + Σjuj = fj,

−

∂E
uj |Γ−

= gj,

uj(·,·, Em) = 0,

(346)

where j = 2, 3. We perform a well-known change of variables (cf. e.g. [26], [48]) in
the problem (346) by deﬁning a new unknowns vj, for j = 2, 3, by setting

vj(x, ω, η) := Sj(R−1

j (η))uj(x, ω, R−1

j (η)),

i.e.

Then we ﬁnd that

vj(x, ω, Rj(E)) = Sj(E)uj(x, ω, E).

∂(Sjuj)

∂E

=

∂vj
∂η

R′

j(E) =

∂vj
∂η

1

Sj(E)

=

∂vj
∂η

1
Sj(R−1
j (η))

,

and so, after writing

˜fj(x, ω, η) := Sj(R−1
˜gj(y, ω, η) := Sj(R−1

j (η))fj(x, ω, R−1
j (η))gj(y, ω, R−1

j (η)),
j (η)),

(x, ω, η) ∈ G × S × [0, rm,j],
(y, ω, η) ∈ ˜Γ−,j,

(347)

(348)

(349)

ON EXISTENCE OF L2-SOLUTIONS FOR COUPLED CSDA

72

where

˜Γ−,j := {(y, ω, η) ∈ (∂G)r × S × [0, rm,j] | ω · ν(y) < 0},

we see that the problem (346) is equivalent to

∂vj
∂η

−

+ ω · ∇vj + Σjvj = ˜fj

a.e. on G × S × [0, rm,j],

subject to inﬂow boundary and initial value conditions,

vj |˜Γ−,j

= ˜gj
vj(·,·, rm,j) = 0

a.e. on ˜Γ−,j,
a.e. on G × S, j = 2, 3.

(350)

(351)

(352)

Notice that ˜gj(rm,j) = 0 since gj(Em) = 0. The original unknowns uj, j = 2, 3, are
given in terms of vj by

uj(x, ω, E) =

1

Sj(E)

vj(x, ω, Rj(E)).

(353)

The problem (350)-(352) can be solved explicitly, at least formally. The solution
vj of (350) is the sum v1,j + v2,j of solutions v1,j and v2,j of the following problems

∂v1,j
∂η

−
v1,j |˜Γ−,j

+ ω · ∇v1,j + Σjv1,j = ˜fj,
v1,j(·,·, rm,j) = 0,
= 0,

(354)

and

∂v2,j
−
∂η
v2,j |˜Γ−,j

+ ω · ∇v2,j + Σjv2,j = 0,
v2,j(·,·, rm,j) = 0,
= ˜gj,

(355)
where the (partial diﬀerential) equations are to be satisﬁes on G × S × [0, rm,j], the
(inﬂow) boundary conditions on ˜Γ−,j and the initial (energy) conditions on G × S.
The solution of (355) is (cf. [19], Ch. XXI, Sec. 3.2, pp. 233-235, or [55], proof
of Theorem 6.3; replace ﬁrst η by rm,j − η)
v2,j(x, ω, η)
= H(rm,j − η − t(x, ω))eR t(x,ω)

−Σj(x−sω,ω)ds˜gj(x − t(x, ω)ω, ω, η + t(x, ω)),

where H is the Heaviside function. By performing similar computations as in the
proof of Lemma 2.10, one sees that v2,j deﬁned by (356) is in fact a weak (distri-
butional) solution of (355). Moreover, v2,j satisﬁes (in generalized sense) the inﬂow
boundary condition, since t(y, ω) = 0 on ˜Γ−,j (see Lemma 2.4) and rm,j − η > 0
(therefore H(rm,j−η−t(y, ω)) = 1 on ˜Γ−,j), as well as the initial (energy) condition,
since t(x, ω) > 0 on G × S (hence H(rm,j − η − t(x, ω)) = 0 for all η close to rm,j).
The solution of (354), on the other hand, is obtained as follows. Let V1,j(x, ω, η) :=
v1,j(x, ω, rm,j − η). Then the problem (354) is equivalent to

(356)

0

∂V1,j
∂η
V1,j |˜Γ−,j

+ ω · ∇V1,j + ΣjV1,j = Fj,
V1,j(·,·, 0) = 0,

= 0,

(357)
where Fj(x, ω, η) := ˜f (x, ω, rm,j − η). Let B0 : L2(G × S) → L2(G × S) be a densily
deﬁned operator (as in section 3.4) such that

D(B0) = ˜W 2

−,0(G × S), B0ψ = −ω · ∇ψ.

ON EXISTENCE OF L2-SOLUTIONS FOR COUPLED CSDA

73

Then B0 generates a contraction C 0-semigroup T (η), and in fact for h ∈ L2(G × S)
we have (cf. [19], Ch. XXI, Sec. 2.2, p. 222, or [55], proof of Theorem 5.15)

(T (η)h)(x, ω) = H(t(x, ω) − η)h(x − ηω, ω),

where H is the Heaviside function. The problem (357) can be put into the abstract
form

∂V1,j
∂η − (B0 − Σj)V1,j = Fj,

V1,j(0) = 0,

(358)

where (V1,j(η))(x, ω) = V1,j(x, ω, η) and (Fj(η))(x, ω) = Fj(x, ω, η). The C 0-semigroup
G(η) generated by B0 − Σj is (by the Trotter’s formula) given by

(G(η)h)(x, ω) = e− R η

0 Σj (x−τ ω,ω)dτ H(t(x, ω) − η)h(x − ηω, ω).

Hence the solution V1,j is (cf. [23], p. 439, [43], pp. 105-108)

V1,j(η) =Z η

0

G(η − s)Fj(s)ds,

and thus

(359)

(360)

v1,j(x, ω, η) = V1,j(x, ω, rm,j − η) =Z rm,j −η
=Z rm,j −η
· H(t(x, ω) − (rm,j − η − s)) ˜fj(x − (rm,j − η − s)ω, ω, rm,j − s)ds.

(cid:0)G(rm,j − η − s)Fj(s)(cid:1)(x, ω)ds

rm,j −η−s
0

Σj(x−τ ω,ω)dτ

e− R

0

0

(361)

This can be shown to be a weak (distributional) solution of (354) by a similar
argument as in the proof of Lemma 2.13.

Moreover, the weak solution of the (primary) problem

ω · ∇u1 + Σ1u1 = f1,
u1|Γ− = g1,

is given by (see Lemmas 2.10 and 2.13)

u1(x, ω, E) =Z t(x,ω)

0

e− R t

+ e− R t(x,ω)

0

0 Σ1(x−sω,ω,E)dsf1(x − tω, ω, E)dt
Σ1(x−sω,ω,E)dsg1(x − t(x, ω)ω, ω, E).

(362)

Hence the explicit solution of the total primary problem

−

∂E

ω · ∇u1 + Σ1(x, ω, E)u1 = f1,
∂(Sjuj)
+ ω · ∇uj + Σjuj = fj,
u|Γ− = g
uj(·,·, Em) = 0,

j = 2, 3

j = 2, 3,

(363)

is given by u = (u1, u2, u3), where u1 is obtained from (362) and uj, j = 2, 3 are
obtained from formulas (353), (356) and (361), recalling that vj = v1,j +v2,j, j = 2, 3.

ON EXISTENCE OF L2-SOLUTIONS FOR COUPLED CSDA

74

5.2. A Solution Based on the Neumann Series. Consider the transport prob-
lem (336), (337), (338). Setting φ = eCEψ as in Section 4, we recall that the problem
then takes the equivalent form (240)-(243). Denote

T1,Cφ := ω · ∇φ1 + Σ1φ1 − K1,Cφ
Tj,Cφ := −

∂(Sjφj)

∂E

j = 2, 3,

(364)
and deﬁne a (densily deﬁned) closed linear operator TC : L2(G × S × I)3 → L2(G ×
S × I)3 by setting

+ ω · ∇φj + CSjφj + Σjφj − Kj,Cφ,

D(TC) := {φ ∈ L2(G × S × I)3 | Tj,Cφ ∈ L2(G × S × I), j = 1, 2, 3}
TCφ := (T1,Cφ, T2,Cφ, T3,Cφ).

(365)
Let f ∈ L2(G × S × I)3 and g ∈ T 2(Γ−)3. In the case where φ is regular enough,
say φ ∈ ˜W 2(G × S × I) × ( ˜W 2(G × S × I) ∩ W 2
1 (G × S × I))2 , the problem (336),
(337), (338) can be expressed equivalently as

TCφ = f, φ|Γ− = g, φj(·,·, Em) = 0,

where f = eCEf , g = eCEg as in Section 4.

j = 2, 3,

(366)

Assume that g ∈ H 1(I, T 2(Γ′

−)3) such that gj(Em) = 0, j = 2, 3. Then g ∈
−)3) and gj(Em) = 0, j = 2, 3. Applying on g the lift operator L given

H 1(I, T 2(Γ′
by

(cid:0)(Lg)(E)(cid:1)(x, ω) := g(E)(x − t(x, ω)ω, ω) = g(x − t(x, ω)ω, ω, E),
we have Lg ∈ H 1(I, ˜W 2(G × S × I)3), and it satisﬁes (cf. [55], Lemma 5.11)

Furthermore, the condition gj(Em) = 0 implies that

ω · ∇(Lg) = 0,

(Lg)|Γ− = g.

Denoting

(Lgj)(·,·, Em) = 0,

j = 2, 3.

(367)

P1φ1 := ω · ∇φ1 + Σ1φ1
Pj,Cφj := −

∂(Sjφj)

∂E

+ ω · ∇φj + CSjφj + Σjφj,

j = 2, 3,

(368)

and PCφ := (P1φ1, P2,Cφ2, P3,Cφ3), KCφ = (K1,Cφ, K2,Cφ, K3,Cφ), we ﬁnd that TC =
PC − KC. To simplify the notation, we shall write below T = TC, K = KC, P = PC.

Let P0 be the densely deﬁned linear operator acting in L2(G × S × I),

D(P0) := {φ ∈ ˜W 2(G × S × I) × ( ˜W 2(G × S × I) ∩ W 2

1 (G × S × I))2 |

φ|Γ− = 0, φ(·,·, Em) = 0},

P0φ := P φ.

(369)

Writing u := φ − Lg, we see that φ = u + Lg is a solution of (366) if and only if

(P − K)(u + Lg) = f,

u|Γ− = 0,

uj(·,·, Em) = 0,

j = 2, 3,

(370)

or equivalently,

P0u = Ku + f − (P − K)(Lg).

Now suppose that for some k = 0, 1, 2, . . . the following assumptions hold:
(A1) f := f − (P − K)(Lg) ∈ H k(I, L2(G × S)3),
(A2) Ku ∈ H k(I, L2(G × S)3) for all u ∈ L2(G × S × I)3, and
(A3) P −1

exists as an operator H k(I, L2(G × S)3) → L2(G × S × I)3.

0

(371)

ON EXISTENCE OF L2-SOLUTIONS FOR COUPLED CSDA

75

These assumptions can be met if the data (and the geometry) are regular enough;
see the example below.
Then Eq. (371) gives

u = P −1

0 Ku + P −1

0

f,

which is equivalent to

where

(I − Q)u = P −1

0

f ,

Q := P −1

0 K.

If 1 belongs to the resolvent set ρ(Q) of Q we thus have

and therefore

u = (I − Q)−1P −1

0

f ,

φ = (I − Q)−1P −1

0

f + Lg,

(372)

(373)

(374)

(375)

where we recall that f = f − (P − K)(Lg).

Assuming that Q : L2(G × S × I)3 → L2(G × S × I)3 is bounded and that

(376)
which implies in particular that 1 ∈ ρ(Q), the solution u of (371) can be computed
through Neumann series

kQk < 1,

u =

Qk(P −1

0

f) =

∞

Xk=0

Finally, the solution φ of (366) is then

(P −1

0 K)k(P −1

0

f ).

(377)

∞

Xk=0

φ =

(P −1

0 K)k(P −1

0

f) + Lg,

(378)

∞

Xk=0

from which the solution ψ of the original problem (336)-(338) is obtained by

ψ = e−CEφ.

This method is known in the neutron transport community under the name source
iteration [39]. It can also be used to prove existence, uniqueness and positivity of
solutions for the standard transport equation (see e.g. [24]).

Example 5.2 In the case treated in Example 5.1, choose C = 0 and k = 0. Then
a bounded inverse P −1
: L2(G × S × I)3 → L2(G × S × I)3 exists and, in fact, can
be explicitly computed using formulas given in Example 5.1 (choose ˜g = 0 in Eqs.
(353), (362), (361)), and it is

0

P −1

0 h)1, (P −1

0 h =(cid:0)(P −1
0 h)1(x, ω, E) =Z t(x,ω)

0

(P −1

(P −1

0 h)j(x, ω, E) =

e− R t

0 h)2, (P −1

0 h)3(cid:1),
0 Σ1(x−sω,ω,E)dsh1(x − tω, ω, E)dt,
S2(E)(cid:16)Z rm,j−Rj (E)

rm,j −Rj (E)−s
0

e− R

1

0

Σ2(x−τ ω,ω)dτ

· H(t(x, ω) − (rm,j − Rj(E) − s))˜hj(x − (rm,j − Rj(E) − s)ω, ω, rm,j − s)ds(cid:17),

(379)

ON EXISTENCE OF L2-SOLUTIONS FOR COUPLED CSDA

76

for j = 2, 3, and where H is the Heaviside function, and

˜hi(x, ω, η) = Si(R−1

i (η))hi(x, ω, R−1

i (η)),

i = 1, 2, 3.

Hence under the stated assumptions the solution ψ (= φ) is obtained from (378)
(note that f = f , g = g for C = 0) and (379). This shows that the assumption
(A1)-(A3) can indeed be met (here for k = 0).

It is also worth noticing that the above expression for (P −1

0 h)j, j = 2, 3, can be

simpliﬁed into

(P −1

0 h)j(x, ω, E)

=

1

S2(E)(cid:16)Z min{rm,j −Rj (E),t(x,ω)}

0

e− R s

0 Σ2(x−τ ω,ω)dτ ˜hj(x − sω, ω, Rj(E) + s)ds(cid:17).

(380)

The Neumann series based method enables one to compute the solution, or an
approximation of it by considering in the series (378) only ﬁnitely many terms,
without any explicit inversion of matrices (coming from a chosen discretization of
the problem), which tend to be large due to the dimensionality of the problem,
which is 6: there are 3 spatial (x), 2 angular (ω) and one energy (E) dimensions.
Suﬃcient criteria for the condition kQk < 1 must be retrieved.
Remark 5.3 The applicability of the above method for general cases remains open.
One possibility to apply formulae like (379) for spatially inhomogeneous substance
(that is, Sj and Σj are dependent on x ∈ G) is to apply domain decomposition
method in such a way that Sj are assumed to be constant in subdomains.

Example 5.4 In this example, we write out Eq. (380) in special case of constant
S0 ≥ 0 and Σ ≥ 0. Moreover, we consider a single particle CSDA transport equation
only. Let

D(P0) = {u ∈ D(T0) | u|Γ− = 0, u(·,·, Em) = 0}

P0u = −

∂(S0u)

∂E

+ ω · ∇u + Σu,

corresponding in the case C = 0 to Pj,C, j = 2, 3, in Eqs. (368), (369), as well as to
P1 if S0 = 0.

In this case, R(E) = R E
the notation η(E) := (Em − E)/S0 and noticing that rm := R(Em) = Em

E, and Eq. (380) gives, when S0 > 0, using

dτ = 1
S0

1
S0

0

,

S0

(P −1

0 h)(x, ω, E) =Z min{η(E),t(x,ω)}

0

e−Σsh(cid:0)x − sω, ω, E + S0s(cid:1)ds,

for h ∈ L2(G × S × I). It is clear that this last formula gives the correct (explicit)
expression for P −1
also in the case where S0 = 0, if we make the convention that
η(E) = +∞ for all E ∈ I when S0 = 0.

0

ON EXISTENCE OF L2-SOLUTIONS FOR COUPLED CSDA

77

5.3. An Approximative Solution Based on the Theory of Evolution Equa-
tions. In this section we for simplicity restrict ourselves to a single particle CSDA-
equation

−

∂(S0ψ)

+ ω · ∇ψ + Σψ − Kψ = f,

∂E
ψ|Γ− = g, ψ(·,·, Em) = 0.

(381)

(382)

Suppose that the assumptions given in items (i), (i), (iii) of Theorem 3.7 are valid
and that the density assumption R( ˜TC,0) = L2(G × S × I) holds, where ˜TC,0 is the
operator introduced in Section 3.3.
Another method to compute approximately the solution of the problem (381),
(382) which avoids the explicit inversions of matrices, can be (formally) described
as follows. Note that we will be using throughout this section the notations of
Section 3.3. After the change of unknown φ = eCEψ the problem is

TCφ = f, φΓ− = g, φ(·,·, Em) = 0,

(383)

where

TCφ := −

∂(S0φ)

∂E

+ ω · ∇φ + CS0φ + Σφ − KCφ.

Assume that g satisﬁes appropriate regularity assumptions, and that g(·,·, Em) = 0
on G × S. Let u := φ − L(g). Then u satisﬁes the conditions,
u(·,·, Em) = 0.

TC,0u = ˜f,

uΓ− = 0,

(384)

where

By the Trotter’s formula, the semigroup G(t) generated by TC,0 is given by

˜f := f − TC(L(g)).

˜G(t)˜f = lim

n→∞(cid:16)TB0(t/n)TA0(t/n)T−(Σ+CI)(t/n)TKC (t/n)(cid:17)n

˜f,

(385)

where the convergence is uniform on compact t-intervals [0, T ]. Note that the in-
dividual semi-groups TB0(t), TA0(t), T−(Σ+CI)(t) and TKC (t) contributing to this
expression can be computed explicitly. Hence we get

0

0

0

˜G(t)˜f dt

ψ = Z ∞
= Z T
≈ Z T

˜G(t)˜fdt ≈Z T
n→∞(cid:16)TB0(t/n)TA0(t/n)T−(Σ+CI)(t/n)TKC (t/n)(cid:17)n
0 (cid:16)TB0(t/n0)TA0(t/n0)T−(Σ+CI)(t/n0)TKC (t/n0)(cid:17)n0˜fdt,

˜f dt

lim

(386)

for large enought T and n0. On the other hand, the semi-group TKC generated by
the bounded operator KC can be approximately computed from

TKC (t) ≈

1
k!

N0

Xk=0

(tKC)k,

for large enough N0.

We point out that this semi-group theory -based approach, unlike the one given
in the previous section, does not require extra assumptions on cross-sections, like
the ones imposed by the condition (376).

ON EXISTENCE OF L2-SOLUTIONS FOR COUPLED CSDA

78

Remark 5.5 Assume that K is of the form

(Kψ)(x, ω, E) =ZS

σ(x, ω′, ω, E)ψ(x, ω′, E)dω′.

Furthermore, as in Example 5.1 we assume that S0 = S0(E) (independent of x) and
S0(τ ) dτ , η := R(E), rm := R(Em) and ˜I := R(I) = [0, rm].

0

we deﬁne R(E) := R E

Let

1

v(x, ω, η) := S0(R−1(η))ψ(x, ω, R−1(η)),

˜Σ(x, ω, η) := Σ(x, ω, R−1(η)),

˜σ(x, ω′, ω, η) := σ(x, ω′, ω, R−1(η)),

( ˜Kv)(x, ω, η) :=ZS

˜σ(x, ω′, ω, η)v(x, ω′, η)dω′,

˜f (x, ω, η) := S0(R−1(η))f (x, ω, R−1(η)),

˜g(x, ω, η) := S0(R−1(η))g(y, ω, R−1(η)).

As a further simpliﬁcation, suppose that g = 0. After some technical considera-

tions, the problem (381), (382) can be cast into the abstract form

∂V
∂η − A(η)V = F (η),

V (0) = 0,

(387)

where V (η) := v(rm − η), F (η) := ˜f (·,·, rm − η). In the case where appropriate
assumptions are valid (cf. Theorem 3.12), the solution of (387) is given by

V (η) =Z η

0

U(η, s)F (s)ds,

(388)

where U(η, s) : L2(G × S) → L2(G × S), 0 ≤ η ≤ s ≤ rm, is the evolution family of
operators A(η), η ∈ ˜I.
By making use of the explicit expressions for the semi-groups TB0(s) (here B0 is as
in the proof of Lemma 3.14), T ˜Σ(η)(s), and T ˜K(η)(s), there exist some approximative
methods (e.g. Cauchy-Peano approximations) for computing the family of evolution
operators U(η, s) (cf. [30]). This gives an approach for calculating V approximately
by

V (η) ≈ ˜V (η) :=Z η

0

˜U (η, s)F (s)ds,

where ˜U(η, s) is an approximation of U(η, s). The solution ψ would then be approx-
imated as

ψ(x, ω, E) ≈

1

S0(E)

˜V (rm − R(E)).

(389)

For general g the idea remains the same. It is worth studying this approach under
more general assumptions as well.

ON EXISTENCE OF L2-SOLUTIONS FOR COUPLED CSDA

79

6. Adjoint Transport Problem

We will discuss brieﬂy the adjoint version of the transport problem (215)-(218),

and related operators. Write

T1ψ := ω · ∇ψ1 + Σ1ψ1 − K1ψ,
Tjψ := −

∂(Sjψj)

∂E

+ ω · ∇ψj + Σjψj − Kjψ,

j = 2, 3,

and deﬁne a (densely deﬁned) linear operator T : L2(G × S × I)3 → L2(G× S × I)3
by

D(T ) := {ψ ∈ L2(G × S × I)3 | Tjψ ∈ L2(G × S × I), j = 1, 2, 3},
T ψ := (T1ψ, T2ψ, T3ψ).

(390)
Let f ∈ L2(G× S × I)3 and g ∈ T 2(Γ−)3. The problem (215)-(218) can be expressed
equivalently as the problem

T ψ = f, ψ|Γ− = g, ψj(·,·, Em) = 0,

j = 2, 3.

(391)

As in section 3.2, an application of integration by parts and the Green’s formula

(35) implies

hT ψ, viL2(G×S×I)3 = hψ, T ∗viL2(G×S×I)3

∀v ∈ C 1

0 (G × S × I ◦),

(392)

where T ∗v = (T ∗

2 v, T ∗

3 v), and

1 v, T ∗
T ∗
1 v := − ω · ∇v1 + Σ∗
T ∗
j v := Sj

1v1 − K ∗
1 v,
∂vj
∂E − ω · ∇vj + Σ∗
j vj − K ∗
j v,

Moreover, we have Σ∗

j = Σj and for v ∈ L2(G × S × I)3, j = 1, 2, 3,

j = 2, 3.

(393)

(K ∗

j v)(x, ω, E) =

σjk(x, ω, ω′, E, E′)ψk(x, ω′, E′)dω′dE′.

3

Xk=1ZS×I

Let f ∗ ∈ L2(G × S × I)3 and g∗ ∈ T 2(Γ+)3. The adjoint problem of (391) (or

equivalently (336)-(338)) is deﬁned by (cf. e.g. [3], pp. 24-28)

T ∗ψ∗ = f ∗, ψ∗

or more explicitly

|Γ+ = g∗, ψ∗

j (·,·, 0) = 0,

j = 2, 3,

(394)

1 + Σ∗

1ψ∗

1 ψ∗ = f ∗
1 ,

−ω · ∇ψ∗
∂ψ∗
j
∂E − ω · ∇ψ∗

Sj

1 − K ∗
j − K ∗

j + Σ∗

j ψ∗

j ψ∗ = f ∗
j ,

j = 2, 3,

(395)

|Γ+ = g∗
ψ∗
j (·,·, 0) = 0

holding a.e. on G × S × I, together with the outﬂow boundary and initial values
(396)

a.e. on Γ+,

ψ∗

a.e. on G × S,

j = 2, 3.

(397)

The adjoint problem has various kind of applications both in the existence theory of
solutions and in computations. At the end of this section we give an example which
is related to the dose calculation in radiation therapy. We refer also to computations
concerning a related optimal control problem considered in [55] (section 7), where
the adjoint problem plays a signiﬁcant role. In addition, recall that the concept of
Green distribution (or Green function) is usually founded on the theory of adjoint

ON EXISTENCE OF L2-SOLUTIONS FOR COUPLED CSDA

80

problem. We also point out that the adjoint ﬁeld ψ∗ obeying Eq. (395) is sometimes
called an importance function (cf. [21], Ch. 5, Sec. V).

Consider the variational formulation of the adjoint problem. As in sections 3 and
0(·,·) : C 1(G×S×I)3×C 1(G×S×I)3

4 (for C = 0) we ﬁnd that the bilinear form B∗
and the linear form F∗ corresponding to the adjoint problem are

B∗

j ,

+ hψ∗, ω · ∇viL2(G×S×I)3

∂(Sjvj)

∂E (cid:29)L2(G×S×I)

0(ψ∗, v) = − Xj=2,3(cid:28)ψ∗
+ hψ∗, (Σ − K)viL2(G×S×I)3 + hγ−(ψ∗), γ−(v)iT 2(Γ−)3
+ Xj=2,3(cid:10)ψ∗
j (·,·, Em), Sj(·, Em)vj(·,·, Em)(cid:11)L2(G×S)
2, ψ∗
3) and v = (v1, v2, v2), and
0(v) = hf ∗, viL2(G×S×I)3 + hg∗, γ+(v)iT 2(Γ+)3 .
F∗

1, ψ∗

,

where ψ∗ = (ψ∗

Similarly as in Theorem 4.7 we ﬁnd that

|B∗

0(ψ∗, v)| ≤ M kψ∗kH kvk ˜H ∀ψ∗, v ∈ C 1(G × S × I)3

and

(398)

(399)

(400)

0(·,·) has a unique extension ˜B∗

The bilinear form B∗
has an explicit expression in the same way as in (264)) which satisﬁes
m) ∈ H, v ∈ ˜H.

0(v)| ≤(cid:0) kf ∗kL2(G×S×I)3 + kg∗kT 2(Γ+)3(cid:1)kvkH ∀v ∈ C 1(G × S × I)3.
|F∗
0( ˜ψ∗, v)| ≤ M(cid:13)(cid:13)(cid:13)

˜ψ∗(cid:13)(cid:13)(cid:13)H kvk ˜H ∀ ˜ψ∗ = (ψ∗, q∗, p∗

(402)
0 has a unique extension to a bounded linear form H → R
0. The variational equation corresponding to the adjoint

0(·,·) : H × ˜H → R (and ˜B∗

Moreover, the linear form F∗
which we still denote by F∗
problem (395), (396), (397) is then

(401)
0(·,·)

| ˜B∗

0, p∗

˜B∗

0( ˜ψ∗, v) = F∗

0(v),

∀v ∈ ˜H.

(403)

Suppose that the assumptions (219), (220), (226), (227) and (228) are valid. Using

integration by parts and Green’s formula (35) we have the following.

Proposition 6.1 For all ψ, ψ∗ ∈ ˜W 2(G×S×I)×( ˜W 2(G×S×I)∩W 2
one has

1 (G×S×I))2

˜B∗

0(ψ∗, ψ) = ˜B0(ψ, ψ∗),

(404)

where ˜B0(·,·) is the bilinear form (264).

The relation (404) is the justiﬁcation for the term adjoint problem. For the exis-

tence of solutions of the adjoint problem we formulate

Theorem 6.2 Suppose that (219), (220), (226), (227), (228) are valid and that
(246), (247) hold for C given in (250). Let f ∗ ∈ L2(G×S×I)3 and that g∗ ∈ T 2(Γ+)3.
Then the following assertions hold.

(i) The variational equation
˜B∗

0( ˜ψ∗, v) = F∗
1 := (ψ∗

0(v) ∀v ∈ ˜H,
j := (ψ∗
1, q∗

1), ˜ψ∗

has a solution ˜ψ∗ ∈ H. Writing ˜ψ∗
ψ∗ = (ψ∗
the system of equations (395), and ψ∗

mj), j = 2, 3, and
3) ∈ L2(G × S × I)3, then ψ∗ is a weak (distributional) solution of

0j, p∗

1, ψ∗

2, ψ∗

j , p∗

j , q∗

1 ∈ W 2(G × S × I).

(405)

ON EXISTENCE OF L2-SOLUTIONS FOR COUPLED CSDA

81

S × I)× W 2
of the problem (395)-(397).

(ii) If the solution ψ∗ of equations (395) obtained in part (i) belongs to W 2(G ×
1 (G× S × I)2, then ψ∗ belongs also to ˜W 2(G× S × I)3 and it is a solution
(iii) Suppose that the density property (133) is valid. Then any solution ψ∗ ∈
1 (G × S × I)2 of the problem (395)-(397) is unique, belongs to

W 2(G × S × I) × W 2
˜H and obeys the estimate
kψ∗kH ≤

eCEm

(Constant c′ > 0 is deﬁned in (255) and Em is the cutoﬀ energy.)

c′ (cid:0)kf ∗kL2(G×S×I)3 + kg∗kT 2(Γ+)3(cid:1).
Note that if ψ∗ ∈ ˜W 2(G × S × I) × ( ˜W 2(G × S × I) ∩ W 2

1 (G × S × I))2 is a
solution of the problem (395)-(397), then it is a solution of the variational problem
(405) and vice versa.

(406)

The existence result analogous to Theorem 4.11 (based on the theory of evolution
operators) holds also for the adjoint problem, and it guarantees that ψ∗ ∈ ˜W 2(G ×
S × I)× ( ˜W 2(G× S × I)∩ W 2
1 (G× S × I))2. In this case, one assumes that K takes
the form (268), and that consequently its adjoint version K ∗ = (K ∗
Xk=1ZS

˜σkj(x, ω, ω′, E)ψk(x, ω′, E)dω′,

j ψ)(x, ω, E) =

j = 1, 2, 3.

1 , K ∗

(407)

2 , K ∗

3 ) is,

(K ∗

3

The adjoint version of Theorem 4.11 can be formulated as follows.

Theorem 6.3 Suppose that the adjoint collision operator is of the form (407),
and that the assumptions (288)-(292) of Theorem 4.11 are valid for Σj, σjk and Sj.
+)3) which
Furthermore, suppose that f ∗ ∈ C 1(I, L2(G × S)3) and g∗ ∈ C 2(I, T 2(Γ′
satisﬁes the compatibility condition

g∗
j (0) = 0,

j = 2, 3.

Then the problem (395)-(397) has a unique solution ψ∗ ∈ ˜W 2(G×S×I)×(cid:0)C(I, ˜W 2(G×
S)2) ∩ C 1(I, L2(G × S)2)(cid:1). In particular, ψ∗ ∈ ˜W 2(G × S × I) ×(cid:0) ˜W 2(G × S × I) ∩
1 (G × S × I)(cid:1)2.

If in addition the density property (133) and the conditions (296), (297) are valid,

then the solution ψ∗ satisﬁes the estimate (406).

W 2

It is clear that a Sobolev space version of the above theorem analogous to Corollary

4.12, holds for the adjoint problem as well.

Example 6.4 In radiation therapy the absorbed dose from the particle ﬁeld ψ =
(ψ1, ψ2, ψ3) is deﬁned by the functional

D(x) = (Dψ)(x) :=

3

Xj=1ZS×I

κj(x, E)ψj(x, ω, E)dωdE,

(408)

where ψ is the solution of (336)-(338). We see that

(Dψ)(x) =

3

Xj=1

hκj(x,·), ψj(x,·,·)iL2(S×I) = hκ(x,·), ψ(x,·,·)iL2(S×I)3 .

(409)

ON EXISTENCE OF L2-SOLUTIONS FOR COUPLED CSDA

82

Deﬁne for any ﬁxed x ∈ G distribution Tκj,x on S × I ◦ by
0 (S × I ◦),

Tκj,xϕ := hκj(x,·), ϕiL2(S×I) , ϕ ∈ C ∞

Then for all ψj = φj ⊗ ϕj, where φj ∈ C ∞
(φj ⊗ ϕj)(x, ω, E) := φj(x)ϕj(ω, E), we ﬁnd that
Xj=1
Xj=1

(δx ⊗ Tκj,x)(ψj) =

δx(φj)Tκj,x(ϕj) =

3

3

3

0 (G), ϕj ∈ C ∞

j = 1, 2, 3.
(410)
0 (S × I ◦), and where

φj(x)ZS×I

κj(x, E)ϕj(ω, E)dωdE

κj(x, E)(φj ⊗ ϕj)(x, ω, E)dωdE = (Dψ)(x).

(411)

3

Xj=1
Xj=1ZS×I

=

Hence also for a general element ψ = (ψ1, ψ2, ψ3) ∈ C ∞

0 (G × S × I ◦) one has

3

(Dψ)(x) =

Xj=1
(δx ⊗ Tκj,x)(ψj) =: Tx(ψ),

(412)

where Tx is a distribution on G × S × I ◦ with values in R3.
exists a solution Ψ∗
to the variational problem

The following discussion will be formal. Let x ∈ G be ﬁxed. Assume that there
1 (G× S× I))2

x belonging to ˜W 2(G× S× I)× ( ˜W 2(G× S× I)∩ W 2

˜B∗

0(Ψ∗

x, v) = Tx(v),

∀v ∈ ˜H.

(413)

Furthermore, assume that ψ (which depends on f, g) is a solution of (215)-(218)
that belongs to ˜W 2(G × S × I) × ( ˜W 2(G × S × I) ∩ W 2
1 (G × S × I))2, and that
x = Ψ∗
Ψ∗
x). Then
we have

x(x′, ω, E) is a solution of (413) such that (404) holds (for ψ and Ψ∗

(Dψ)(x) = Tx(ψ) = ˜B∗

0(Ψ∗

x, ψ) = ˜B0(ψ, Ψ∗
xiL2(G×S×I)3 + hg, γ−(Ψ∗

x) = F0(Ψ∗
x)
x)iT 2(Γ−)3 ,

= hf, Ψ∗

(414)

implying that the dose can be obtained with the help of Ψ∗
x. That is why, when the
equation (413) is solved once, one can obtain the dose (Dψ)(x) at x ∈ G for any f
and g from (414).

7. On the Inverse Radiation Treatment Problem

As mentioned above, in radiation therapy the dose absorbed from particle ﬁeld

ψ = (ψ1, ψ2, ψ3) is deﬁned by

3

Xj=1ZS×I

D(x) = (Dψ)(x) :=

κj(x, E)ψj(x, ω, E)dωdE,

(415)

where κj ∈ L∞(G × I), κj ≥ 0 are the so-called (total) stopping powers.
Also, it is worth recalling that the component ﬁelds of ψ, relevant to photon and
electron radiation therapy, are ψ1 = photons, ψ2 = electrons and ψ3 = positrons.
Clearly, nothing we have said above depends on the number, or designation (to
certain particle species) of ﬁelds treated (or even the dimensionality of the spaces
G, S or I in fact), with the exception that typically only charged particle ﬁelds
(are assumed to) obey CSDA version of the transport equation (cf.
(5)), while
non-charged particles obey the standard linear BTE (cf.
(1)). Thus with very
minor modiﬁcations, and in particular if one is interested in radiation therapy, what

ON EXISTENCE OF L2-SOLUTIONS FOR COUPLED CSDA

83

will and has been said works in principle equally well in proton (and ion) therapy
framework as well.

We ﬁnd that D : L2(G × S × I)3 → L2(G) is a bounded linear operator and
its adjoint operator D∗ : L2(G) → L2(G × S × I)3 is simply a multiplication type
operator,

D∗d = (κ1, κ2, κ3)d,

for d ∈ L2(G).

(416)

We describe shortly an optimization problem related to inverse radiation treat-
ment planning. We restrict ourselves to external radiation therapy in which the
particles are inﬂowing through the patch(es) of patient surface. This means that
in the transport problem f = 0 (i.e. the internal particle source vanishes) and g
(the inﬂow particle ﬂux) is the variable to be controlled. Conversely, for the inter-
nal radiation therapy problems one sets g = 0, and f would be the variable to be
controlled. Anyhow, the results presented below would be analogous in this situ-
ation. We refer to [55] (section 7) and to the references therein for a more detail
exposition of inverse problem (optimization) in this setting. Let g ∈ T 2(Γ−)3 and
let ψ = ψ(g) ∈ ˜W 2(G× S × I)× ( ˜W 2(G× S × I)∩ W 2
1 (G× S × I))2 be the solution
of the variational equation (see (264), (265) and (266))
˜B0(ψ(g), v) = F0(v) ∀v ∈ ˜H,

(417)

where (since f = 0)

F0(v) = (F0g)(v) :=

(ω · ν)−gjvjdσdωdE = hg, γ−(v)iT 2(Γ−)3 .

(418)

3

Xj=1Z∂G×S×I

The deposited dose is then

D(x) = (D(ψ(g)))(x),

x ∈ G.

(419)

We shall also denote D(g) := D(ψ(g)).
Denote the target region by T ⊂ G, the critical organ region by C ⊂ G and
the normal tissue region by N ⊂ G. Then G = T ∪ C ∪ N where the union is
mutually disjoint. Suppose that dT ∈ L2(T), dC ∈ L2(C), dN ∈ L2(N) are given
dose distributions in the respective regions (for example, they may be constants).
We deﬁne a strictly convex object (cost) function J : X → R by (see [55])

J(g) = cT kdT − D(g)k2

L2(T) + cC kdC − D(g)k2

L2(C)

+ cN kdN − D(g)k2
−)3) equipped with the inner product

L2(N) + ckgk2
X ,

where X := H 3(I, T 2(Γ′

(420)

∂kh

∂Ek(cid:29)T 2(Γ−)3

.

hg, hiX :=

3

Xk=0ZI(cid:28) ∂kg

∂Ek ,

∂kh

∂Ek(cid:29)T 2(Γ′

−)3

dE =

3

Xk=0(cid:28) ∂kg

∂Ek ,

Let Y be a closed subspace of X deﬁned by (here we denote g(y, ω, E) := (g(E))(y, ω))

A relevant admissible set (of controls) is

Y := {g ∈ X | gj(·,·, Em) = 0, j = 2, 3}.

which is a closed convex subset of X.

Uad = {g ∈ Y | g ≥ 0 a.e. on G × S × I},

(421)

(422)

Suppose that the assumptions (133) and (288)-(292), (296), (297) of Corollary
4.12 are valid. Furthermore, suppose that κj ∈ H 2(I, L∞(G)), j = 1, 2, 3. Then
the minimum ming∈Uad J(g) exists. In addition, a necessary and suﬃcient condition

ON EXISTENCE OF L2-SOLUTIONS FOR COUPLED CSDA

84

that g ∈ Uad is the minimum point, is that the following relations are hold (cf. [55],
the proof of Theorem 7.7)

− hγ−(ψ∗), wiT 2(Γ−)3 + chg, wiX ≥ 0 ∀w ∈ Uad,
− hγ−(ψ∗), giT 2(Γ−)3 + ckgk2
˜B0(ψ, v) = hg, viT 2(Γ−)3
˜B∗
0(ψ∗, v) + 2cT hDψ, DviL2(T) + 2cC hDψ, DviL2(C) + 2cN hDψ, DviL2(N)
∀v ∈ ˜H,
= 2cT hdT, DviL2(T) + 2cC hdC, DviL2(C) + 2cN hdN, DviL2(N)

X = 0,
∀v ∈ ˜H,

(423)

(424)

(425)

0(·,·) are as above.

where B0(·,·) and B∗
We emphasize that here the described solution g of optimal control problem can
be used only as an initial point for the actual treatment planning where global
optimization (see e.g.
[44]) is required. The determination of a carefully chosen
initial point for a large dimensional global optimization scheme is very essential for
achieving (time savings and) satisfactory results ([45]).

Generalizations of the above result of optimality, under weaker assumptions in-
stead of assumptions of Corollary 4.12, can obviously be formulated. The cru-
cial fact is to seek suﬃcient criteria for the regularity of solutions (that is, ψ ∈
˜W 2(G×S×I)×( ˜W 2(G×S×I)∩W 2
1 (G×S×I))2) in Theorem 4.7. In this context the
admissible set could be larger, say Uad = {g ∈ T 2(Γ−)×H 1(I, T 2(Γ′
−)2 | gj(·,·, Em) =
0, j = 2, 3, g ≥ 0}. We also notice that if we contented ourselves only with the so-
called mild solutions ([43], p. 146) the existence of an optimal control g (the admissi-
ble set being a subset of T 2(Γ−)3), together with an explicit formula g = 1
c (γ−(ψ∗))+
for it, can be proved under quite weak assumptions. Here (h)+ denotes the positive
part of a function h. In any case the validity of estimate (267) is essential to guar-
antee that D is a bounded linear operator in appropriate spaces. The use of mild
solutions, however, has the drawback that the inﬂow boundary conditions are not
necessarily valid for solutions (and then solutions may be non-physical).

We remark that, for example with respect to x-variable the solution is generally
at most in H 2,(s,0,0)(G × S × I ◦) with s < 3
2 where H 2,(s,0,0)(G × S × I ◦) is the
mixed-norm Sobolev-Slobodeckij space with fractional index s and Lebesgue index
2 (with respect to x-variable).

Finally, we notice that the system of the above variational equations can be im-
plemented within e.g. a FEM-type numerical scheme to get numerical solutions for
the optimal control g. In virtue of Cea’s estimate, the boundedness and coercivity
(after replacing the unknown ψ by φ = eCEψ) of the bilinear forms B0(·,·), B∗
0(·,·)
guarantee the convergence of the scheme in principle. Nevertheless, the limited
regularity of solutions of transport problems implies that the standard local inter-
polation results are not necessarily applicable and more advanced analysis (e.g. in
choosing relevant basis functions) is needed.

We omit in this paper further discussion of the inverse radiation treatment prob-
lem which was outlined above. Nevertheless, we refer to [26] for related treatments.

References

[1] Ackroyd, R.T. Finite Element Methods for Particle Transport, John-Wiley and Sons, 1997
[2] Adams, K. J., Multi-group Fokker-Planck proton transport in MCNP, Los Alamos National

Lab., 1997

[3] Agoshkov, V. Boundary Value Problems for Transport Equations, Springer Science +Business

Media, 1998

ON EXISTENCE OF L2-SOLUTIONS FOR COUPLED CSDA

85

[4] Allaire, G., Golse, H. Transport et diﬀusion, lecture notes for MAP/MAT 567, Ecole polytech-

nique, 2012

[5] Appell, J., A.S. Kalitvin, P.P. Zabrejko. Partial Integral Operators and Integro-Diﬀerential

Equations: Pure and Applied Mathematics, Marcel Dekker, 2000

[6] Asadzadeh M. and T. Geb¨ack. Analytical solutions for the pencil beam equation with energy

loss and straggling. Preprint 2011:23, Univ. of Gothenburg.

[7] Bardos, C. Probl`emes aux limites pour les ´equations aux d´eriv´ees partielles du premier ordre
`a coeﬃcients r´eels; th´eor`emes d’approximation; application `a l’´equation de transport. Th`ese
Paris 1969, Ann. Sci. Ecole Norm Sup., pp. 185-233, 1970

[8] Bellamo, N., A. Palczewsky and G. Toscani. Mathematical Theory in Nonlinear Kinetic Theory,

World Scientiﬁc, 1988

[9] Boman, E., Radiotherapy Forward and Inverse Problem Applying Boltzmann Transport Equa-

tion, Doctoral Dissertation, University of Kuopio, 2007.

[10] B¨orgers C. and E.W. Larsen. On the accuracy of the Fokker-Planck and Fermi pencil beam

equations for charged particle transport. Med. Phys. 23 (10): 1749-1759, 1996

[11] B¨orgers, C. Radiation Therapy Planning Problem, Computational Radiology and Imaging
Therapy and Diagnostic, The IMA Volumes in Mathematics and Applications, Volume 110,
pp. 1-16, 1999

[12] Case, K.M. and P.F. Zweifel. Linear Transport Theory, Addison-Wesley, 1967
[13] Cercignani, C. The Boltzmann Equation and Its Applications, Springer, 1988
[14] Cessenat, M. Th´eor´emes de trace Lp pour des espaces de fonctions de la neutronique, C.R.

Acad. Sc. Paris, t. 299, Serie 1, number 16, 1984

[15] Cessenat, M., Th´eor`emes de trace pour des espaces de functions de la neutronique, C.R. Acad.

Sc. Paris, t. 300, Serie 1, number 3, 1985

[16] Choulli M. and P. Stefanov. An inverse boundary value problem for stationary transport equa-

tion. Osaka J. Math. 36 (1), 1998, pp. 87-104

[17] Cipolatti, R., Motta, C. M., Roberty N. C., Stability Estimates for an Inverse Problem for

the Linear Boltzmann Equation, Rev. Mat. Complut., 2006.

[18] Dautray, R., Lions, J-L. Mathematical Analysis and Numerical Methods for Science and Tech-

nology, Vol. 5. Evolution Problems I, Springer, 1999.

[19] Dautray, R., Lions, J-L. Mathematical Analysis and Numerical Methods for Science and Tech-

nology, Vol. 6. Evolution Problems II, Springer, 1999.

[20] Duderstadts, J. and W. Martin. Transport Theory, Wiley, 1979
[21] Duderstadt, J. and Hamilton, L., Nuclear Reactor Analysis, John Wiley & Sons, 1976.
[22] Egger, H. and Schlottbom, M., Stationary radiative transfer with vanishing absorption, Math.

Mod. Meth. Appl. Sci., 24 (2014) 973?990.

[23] Engel, K.-J., Nagel, R., One-Parameter Semigroups for Linear Evolution Equations, Springer,

2000.

[24] Frank, M., Goudon, T. On a generalized Boltzmann equation for non-classical particle trans-

port, Kinet. Relat. Models 3 (2010) 395-407.

[25] Frank, M., M. Herty, M. Sch¨afer. Optimal Treatment planning in radiotherapy based on

Boltzmann transport calculations, Math. Mod. Meth. Appl. Sci. 18 (4), 2008, pp. 573-592

[26] Frank, M., M. Herty and A.N. Sandjo. Optimal radiotherapy treatment planning governed by

kinetic equations, Math. Mod. Meth. Appl. Sci. 20 (4), 2010, pp. 661-678

[27] Friedman A. Partial Diﬀerential Equations, Robert, E. Krieger Publishing Co. , 1976
[28] Friedrichs, K. O.,Symmetric Positive Deﬁnite Systems of Diﬀerential Operators, Comm. Pure.

Math. 7, 1954.

[29] Fukuoka, R. Molliﬁer smoothing of tensor ﬁelds on diﬀerentiable manifolds and applications

to Riemannian geometry, arXiv:math/060823v1 [math.DG] 9 Aug 2006

[30] Goldstein, J.A. Semigroups of Linear Operators and Applications, Oxford University Press,

1985

[31] Grisvard, P. Elliptic problems in nonsmooth domains, vol. 24 of Monographs and Studies

(Mathematics), Pitman, 1985

[32] Hauck, C.D. and McClarren, R.G., A collision-based hybrid method for time-dependent, linear,

kinetic transport equations, Multiscale Model. Simul. 11 (2013) 1197-1227.

[33] Hsiao, G.C. and Wendland, W.L. Boundary Integral Equations, Springer, 2008
[34] Kythe, P.K. Green’s Functions and Partial Diﬀerential Equations: Theory, Applications and

Computation. Chapman and Hall/CRC, 2011

[35] Lapayre, B., Pardoux, E. and Sentis, R. Introduction to Monte Carlo Methods for Transport

and Diﬀusion Equations, Oxford University Press, 2003

[36] Larsen E.W., M.M. Miften, B.A. Fraass and I.A.D. Bruinvis. Electron dose calculation using

the method of moments. Med. Phys. 24 (1), 1997, pp. 111-125

ON EXISTENCE OF L2-SOLUTIONS FOR COUPLED CSDA

86

[37] Larsen, E.W., Miften, M.M., Fraass, B.A., Bruinvis, I.A.D. Electron dose calculations using

the method of moments, Med. Phys. 24 (1997) 111–125.

[38] Lee, J., Introduction to Smooth Manifolds, Springer, 2002.
[39] Lewis, E.E., Miller Jr., W.F. Computational Methods in Neutron Transport, John Wiley and

Sons, 1984.

[40] Lions, J.-L., Optimal Control of Systems Governed by Partial Diﬀerential Equations, Springer

1971.

[41] Mayles, P., Nahum A., Rosenwald, J. C. Handbook of Radiotherapy Physics: Theory and

Practice, CRC Press, 2007

[42] Mokhtar-Kharroubi, M. Mathematical Topics in Neutron Transport Theory, World Scientiﬁc,

1997.

[43] Pazy, A. Semigroups of Linear Operators and Applications to Partial Diﬀerential Equations,

Springer, 1983.

[44] Pinter, J.D. Global Optimization in Action, Kluwer, 1996
[45] Pinter, J.D. How diﬃcult is nonlinear optimization? A practical solver tuning approach, with

illustrative results, Submitted for publication, 2014

[46] Pomraning, G.C., The Fokker-Planck operator as an asymptotic limit, Math. Models Methods

Appl. Sci. 2 (1992) 21-36.

[47] Pomraning, G.C. The Equations of Radiation Hydrodynamics, Pergamon Press, 1973
[48] Rockell, C.L. and Tweed, J. A Green’s function technique for radiation transport in three

dimensions, 2009

[49] Schepard, D.M., M.C. Ferris, G.H. Olivera and T.R. Mackie. Optimization the delivery of

radiation therapy to cancer patients. SIAM Reviews 41, 1999, pp. 721-744

[50] Seco, J. and Verhaegen, F. Monte Carlo Techniques in Radiation Therapy, CRC Press, 2013
[51] Spanier, J. and Gelbard, E. M. Monte Carlo Principles and Neutron Transport Problems,

Dover, 2008

[52] Stacey, W. M., Nuclear Reactor Physics, Wiley-VCH, 2001
[53] Tanabe, H. Equations of Evolution, Pitman, 1979
[54] Tanabe, H. Functional Analytic Methods for Partial Diﬀerential Equations, Marcel Dekker,

1997.

[55] Tervo, J. and Kokkonen, P. On existence of L1-solutions for coupled Boltzmann transport
equation and radiation therapy treatment planning, ArXiv: 1406.3228v1 [ math.OC ] 12 Jun
2014

[56] Tervo, J., On coupled Boltzmann transport equation related to radiation therapy, J. Math.

Anal. Appl. 335:2, 819-840, 2007.

[57] Tillikainen, L., Helminen, H., Torsti, T., Siljam¨aki, S., Alakuijala, J., Pyyry, J., Ulmer, W.
A 3D pencil-beam-based superposition algorithm for photon dose calculation in heterogeneous
media, Phys Med Biol. 2008 Jul 21;53(14):3821-39

[58] Treves, F. Basic Linear Partial Diﬀerential Equations, Academic Press, 1975
[59] Ukai, S. and T. Yang. Mathematical Theory of Boltzmann Equation, Reprint, City University

of Hong Kong, 2010

[60] Ulmer, W., Pyyry, J. and Kaissl, W. A 3D-photon superposition/convolution algorithm and
its foundation on results of Monte Carlo calculations, Phys. Med. Biol. 50, pp. 1767-1790, 2005
[61] Vassiliev, O.N., Wareing, T.A., McGhee, J., Failla, G., Salehpour, M.R. and Mourtada, F.
Validation of a new grid-based Boltzmann equation solver for dose calculation in radiotherapy
with photon beams, Phys. Med. Biol. 55 (2010) 581-598.

[62] Villani, C. A review of mathematical topics in collision kinetic theory, in Handbook of Math-
ematical Fluid Dynamics (Vol. 1), edited by S. Friedlander and D. Serre, Elsevier Science,
2002

[63] Webb, S. The Physics of Three-Dimensional Radiation Therapy, IOP Publishing, 1993
[64] Wilson J.W. et.al. Transport Methods and Interactions for Space Radiations, NASA RP-1257,

pp. 14-17, 1991

