6
1
0
2

 
r
a

M
2

 

 
 
]
T
N
h
t
a
m

.

[
 
 

1
v
4
3
5
0
0

.

3
0
6
1
:
v
i
X
r
a

MODULAR PERIODICITY OF EXPONENTIAL SUMS OF SYMMETRIC BOOLEAN

FUNCTIONS AND SOME OF ITS CONSEQUENCES

FRANCIS N. CASTRO AND LUIS A. MEDINA

Abstract. This work brings techniques from the theory of recurrent integer sequences to the problem of
balancedness of symmetric Booleans functions. In particular, the periodicity modulo p (p odd prime) of
exponential sums of symmetric Boolean functions is considered. Periods modulo p, bounds for periods and
relations between them are obtained for these exponential sums. The concept of avoiding primes is also
introduced. This concept and the bounds presented in this work are used to show that some classes of
symmetric Boolean functions are not balanced. In particular, every elementary symmetric Boolean function
of degree not a power of 2 and less than 2048 is not balanced. For instance, the elementary symmetric
Boolean function in n variables of degree 1292 is not balanced because the prime p = 176129 does not divide
its exponential sum for any positive integer n. It is showed that for some symmetric Boolean functions, the
set of primes avoided by the sequence of exponential sums contains a subset that has positive density within
the set of primes. Finally, in the last section, a brief study for the set of primes that divide some term of
the sequence of exponential sums is presented.

1. Introduction

Boolean functions are beautiful combinatorial objects with applications to many areas of mathematics
as well as outside the ﬁeld. Some examples include combinatorics, electrical engineering, game theory, the
theory of error-correcting codes, and cryptography. In the modern era, eﬃcient implementations of Boolean
functions with many variables is a challenging problem due to memory restrictions of current technology.
Because of this, symmetric Boolean functions are good candidates for eﬃcient implementations.

In many applications, especially ones related to cryptography, it is important for Boolean functions to
be balanced. Every symmetric function is a combination of elementary symmetric polynomials, thus an
important step should be to understand the balancedness of them. In [9], Cusick, Li and Stˇanicˇa proposed
a conjecture that explicitly states when an elementary symmetric function is balanced:
There are no nonlinear balanced elementary symmetric Boolean functions except for degree k = 2l and
2l+1D − 1-variables, where l, D are positive integers.
Surprisingly, this conjecture is still open, but some advances have been made. For some history of the
problem, as well as its current state, the reader is invited to read [5, 6, 7, 9, 10, 12, 13, 25].

The subject of Boolean functions can be studied from the point of view of complexity theory or from the
algebraic point of view as it is done in this article, where the periodicity of exponential sums of symmetric
Boolean functions modulo a prime is exploited. The study of divisibility properties of Boolean functions
is not new.
In fact, it is an active area of research [1, 2, 19, 20, 21, 22]. However, the authors believe
that the modular periodicity of these functions has not been study in detail nor its possible connections to
Cusick-Li-Stˇanicˇa’s conjecture.

In [6], Castro and Medina viewed exponential sums of symmetric Boolean functions as integer sequences.
As part of their study, they showed that these sequences satisfy homogenous linear recurrences with integer
coeﬃcients. Moreover, in the case of one elementary symmetric function, they were able to provide the
minimal homogenous linear recurrence.
It is a well-established result in number theory that recurrent
integer sequences are periodic or eventually periodic modulo an integer m, with the ﬁrst serious study being
done by Lucas [16]. Some of the results available on this topic are used in this manuscript to ﬁnd bounds for
the periods of these sequences. These bounds and the periodicity of exponential sums of symmetric Boolean
functions are used to show that some families are not balanced. For example, every elementary symmetric

Date: March 3, 2016.
2010 Mathematics Subject Classiﬁcation. 05E05, 11T23, 11B50.
Key words and phrases. Symmetric Boolean functions, exponential sums, recurrences, Pisano periods.

1

2

FRANCIS N. CASTRO AND LUIS A. MEDINA

Boolean function of degree not a power of 2 and less than 2048 is not balanced. In particular, the elementary
symmetric Boolean function in n variables of degree 1292 is not balanced because the prime p = 176129
does not divide its exponential sum for any positive integer n. One of the main goals of this manuscript
is to provide some insights about the p-divisibility (p prime) of the exponential sum of symmetric Boolean
functions.

This work is divided in various parts.

It starts with some preliminaries (section 2) about symmetric
Boolean functions. It follows with a review of the periodicity modulo m of linear recurrences (section 3).
This is done because, to the knowledge of the authors, it is not common to ﬁnd the subjects of Boolean
functions and periodicity modulo m of recurrent sequences together in a manuscript. Section 3 also contains
Theorem 3.2 (Vince [27]), which is an important tool for ﬁnding upper bounds for the periods of the sequences
considered in this article. After that, in section 4, the periodicity modulo p (p an odd prime) of exponential
sums of symmetric Boolean functions is studied in more detail. In particular, the reader can ﬁnd bounds and
relations for these periods. In section 5, the concept of avoiding primes is introduced. This concept and the
bounds presented in section 4 are used to show that some of these families are not balanced. Moreover, it is
showed that for some symmetric Boolean functions, the set of primes avoided by the sequence of exponential
sums has positive density within the set of primes. Finally, in section 6, a small study for the set of primes
that divide some term of the sequence of exponential sums is presented.

2. Preliminaries

Let F2 be the binary ﬁeld, F n

2 = {(x1, . . . , xn)|xi ∈ F2, i = 1, ..., n}, and F (X) = F (X1, . . . , Xn) be a

polynomial in n variables over F2. The exponential sum associated to F over F2 is

(2.1)

S(F ) =

(−1)F (x1,...,xn).

(cid:88)

x1,...,xn∈F2

A Boolean function F is called balanced if S(F ) = 0, i.e. the number of zeros and the number of ones are
equal in the truth table of F . This property is important for some applications in cryptography.

Any symmetric Boolean function is a linear combination of elementary symmetric polynomials. Let σn,k

be the elementary symmetric polynomial in n variables of degree k. For example,

(2.2)

σ4,3 = X1X2X3 + X1X4X3 + X2X4X3 + X1X2X4.

Then, every symmetric Boolean function can be identiﬁed with an expression of the form

(2.3)
where 1 ≤ k1 < k2 < ··· < ks are integers. For the sake of simplicity, the notation σn,[k1,··· ,ks] is used to
denote (2.3). For example,

σn,k1 + σn,k2 + ··· + σn,ks ,

(2.4)

σ3,[2,1] = σ3,2 + σ3,1

It is not hard to show that if 1 ≤ k1 < k2 < ··· < ks are ﬁxed integers, then

= X1X2 + X3X2 + X1X3 + X1 + X2 + X3.

(2.5)

S(σn,[k1,k2,··· ,ks]) =

(−1)( j

k1)+( j

k2)+···+( j
ks)

(cid:18)n

(cid:19)

.

j

n(cid:88)

j=0

Remark 2.1. Observe that the right hand side of (2.5) makes sense for n ≥ 1, while the left hand side exists
for n ≥ ks. Throughout the rest of the article, S(σn,[k1,k2,··· ,ks]) should be interpreted as the expression on
the right hand side, so it makes sense to talk about “exponential sums” of symmetric Boolean functions with
less variables than their degrees.

Equation (2.5) links the problem of balancedness of σn,[k1,··· ,ks] to the problem of bisecting binomial

coeﬃcients (this was ﬁrst discussed by Mitchell [18]). A solution (δ0, δ1,··· , δn) to the equation

(2.6)

(cid:18)n

(cid:19)

xj

j

n(cid:88)

j=0

= 0, xj ∈ {−1, 1},

MODULAR PERIODICITY OF EXPONENTIAL SUMS OF SYMMETRIC BOOLEAN FUNCTIONS

is said to give a bisection of the binomial coeﬃcients(cid:0)n
(cid:1), 0 ≤ j ≤ n. Observe that a solution to (2.6) provides
(cid:19)
(cid:18)n
(cid:88)

us with two disjoints sets A, B such that A ∪ B = {0, 1, 2,··· , n} and
= 2n−1.

(cid:18)n
(cid:19)

(cid:88)

(2.7)

=

3

j

j∈A

j

j∈B

j

If n is even, then δj = ±(−1)j, for j = 0, 1,··· , n, are two solutions to (2.6). On the other hand, if n is
odd, then the symmetry of the binomial coeﬃcients implies that (δ0,··· , δ(n−1)/2,−δ(n−1)/2,··· ,−δ0) are
2(n+1)/2 solutions to (2.6). These are called trivial solutions. A balanced symmetric Boolean function in n
variables which corresponds to one of the trivial solutions of (2.6) is said to be a trivially balanced function.
Computations suggest that a majority of the balanced symmetric Boolean functions are trivially balanced,
thus it is of great interest to ﬁnd non-trivially balanced symmetric Boolean functions. In the literature, these
functions are called sporadic balanced symmetric Boolean functions, see [8, 9, 14] for more information.
In [6], Castro and Medina used (2.5) to study exponential sums of symmetric polynomials from the point
of view of integer sequences. As part of their study, they showed that the sequence {S(σn,[k1,··· ,ks])}n∈N
satisﬁes the homogeneous linear recurrence

(2.8)

xn =

where r = (cid:98)log2(ks)(cid:99) + 1 (this result also follows from [3, Th. 3.1, p. 248]) and used this result to compute
the asymptotic behavior S(σn,[k1,··· ,ks]) as n → ∞. To be speciﬁc,

(cid:18)2r

(cid:19)

j

(−1)j−1

xn−j,

2r−1(cid:88)

j=1

lim
n→∞

1

2n S(σn,[k1,··· ,ks]) = c0(k1,··· , ks)

c0(k1,··· , ks) =

1
2r

(−1)( j

k1)+···+( j

ks).

2r−1(cid:88)

j=0

(2.9)

where

(2.10)

(2.11)

where

(2.12)

Limit (2.9) gives rise to the concept of asymptotically balanced symmetric Boolean function, which was also
introduced in [6]. A symmetric Boolean function σn,[k1,··· ,ks] is asymptotically balanced if c0(k1,··· , ks) = 0.
They used this concept to show that Cusick-Li-Stˇanicˇa’s conjecture is true asymptotically (this result was
recently re-established in [13]). See [6] for more details.

In [7], Castro and Medina extended many of the results presented in [6] to some perturbations of symmetric
Boolean functions. Recall that σn,k is the elementary symmetric polynomial of degree k in the variables
X1,··· , Xn. Suppose that 1 ≤ j < n and let F (X) be a binary polynomial in the variables X1,··· , Xj (the
ﬁrst j variables in X1,··· , Xn). Castro and Medina showed that the exponential sum of the perturbation
σn,[k1,··· ,ks] + F (X) satisﬁes the following relation

(cid:33)

S(σn,[k1,··· ,ks] + F (X)) =

(σn−j,[k1−i,··· ,ks−i])

,

(cid:32) m(cid:88)

(cid:18)m
(cid:19)

i

i=0

j(cid:88)

m=0

Cm(F )S

(cid:88)

Cm(F ) =

(−1)F (x).

of (cid:0)m

(cid:1) that is inside the exponential sum can be taken mod 2, since only the parity matters. Second, if

Remark 2.2. There are three things to observe about equation (2.11). First, it is clear that the value
kl − i < 0, then the term σn−j,kl−i does not exist and so it is not present in the equation. Finally, in the
case that kl − i = 0, the elementary polynomial σn−j,0 should be interpreted as 1.

x∈F2 with w2(x)=m

i

Note that equation (2.11) implies that these type of perturbations also satisfy recurrence (2.8) and there-
fore many of the results presented in this article about the periodicity modulo a prime of exponential sums of
symmetric Boolean functions also apply to them. In fact, later in section 5 these perturbations are examined
in the context of sequences avoiding primes.

4

FRANCIS N. CASTRO AND LUIS A. MEDINA

The periodicity modulo an integer of a recurrent sequence is closely related to its characteristic polynomial
(as expected). The main focus of this manuscript is the periodicity modulo p of exponential sums of symmet-
ric Boolean functions, which, as mentioned before, satisfy recurrence (2.8). Observe that the characteristic
polynomial of (2.8) is given by

(t − 2)Φ4(t − 1)Φ8(t − 1)··· Φ2r (t − 1),

where Φn(t) represents the n-th cyclotomic polynomial. This factorization is crucial and it is used in section
4 to ﬁnd bounds for the Pisano period of

{S(σn,[k1,··· ,ks]) mod p}n∈N,

(2.13)

(2.14)

when p is a prime. This factorization also implies that sequence (2.14) is periodic for every odd prime p.

Naturally, a sequence may satisfy (2.8) but have a minimal linear recurrence with integer coeﬃcients
diﬀerent from it. In the case of the elementary symmetric polynomial, Castro and Medina were able to ﬁnd
the minimal homogenous linear recurrence with integer coeﬃcients that {S(σn,k)} satisﬁes. To be speciﬁc,
let (n) be deﬁned as

(cid:26) 0,

if n is a power of 2,

1, otherwise.

(2.15)

(n) =

Then, the following result holds.

Theorem 2.3. Let k be a natural number and χk(t) be the characteristic polynomial associated to the
minimal linear recurrence with integer coeﬃcients that {S(σn,k)}n∈N satisﬁes. Let ¯k = 2(cid:98)k/2(cid:99) + 1. Express
¯k as its 2-adic expansion

(2.16)
where the last exponent is given by al = (cid:98)log2(¯k)(cid:99). Then,
l(cid:89)

χk(t) = (t − 2)(k)

(2.17)

¯k = 1 + 2a1 + 2a2 + ··· + 2al ,

Φ2aj +1(t − 1).

j=1

In particular, the degree of the minimal linear recurrence that {S(σn,k)}n∈N satisﬁes is equal to 2(cid:98)k/2(cid:99)+(k).
A generalization of Theorem 2.3 for the case of a general symmetric Boolean function also appears in [6],
but such generalization is not needed for the work presented in this article, thus the authors decided not
to include it. What is important, however, is the fact that if χk1,··· ,ks (t) is the characteristic polynomial
associated to the minimal homogenous linear recurrence that {S(σn,[k1,··· ,ks])} satisﬁes, then Φ2r (t− 1), with
r = (cid:98)log2(ks)(cid:99) + 1, is always a factor of χk1,··· ,ks(t). This is used in section 4 to ﬁnd lower bounds for the
period of (2.14).

In the next section, a brief introduction to the periodicity modulo an integer of linear recurrences is
presented. The expert reader may skip the majority of it, however he/she is encouraged to review Theorem
3.2, as it is a result used in later sections. Later, in section 4, the period mod p of {S(σn,[k1,··· ,ks])} is studied
in more detail.

3. Periodicity mod m of linear recurrences

As mentioned in the introduction, it is a well-established result that integer sequences satisfying homoge-
nous linear recurrences with integer coeﬃcients are periodic or eventually periodic modulo an integer m.
Below is a review of this fact.

Suppose that the integer sequence {xn} satisﬁes the linear recurrence

(3.1)
with a1,··· , ar ∈ Z and initial conditions x0,··· , xr−1. Let

xn = a1xn−1 + a2xn−2 + ··· + arxn−r,

for n ≥ r,



0
0
...
0
ar

1
0
...
0

0
1
...
0

ar−1 ar−2

···
···
. . .
···
···

0
0
...
1
a1

 and Xn =



 .

xn
xn+1
...

xn+r−1

(3.2)

A =

MODULAR PERIODICITY OF EXPONENTIAL SUMS OF SYMMETRIC BOOLEAN FUNCTIONS

5

It is clear that Xn+1 = AXn, thus iteration leads to

(3.3)
The r × r matrix A is called the companion matrix of the recurrence. The vector X0 is called the initial
valued vector. The initial valued vector is simply the vector whose entries are the initial conditions of the
linear recurrence. It is assumed throughout the article that X0 is not the zero vector.
Equation (3.3) links the periodicity of {xn mod m} to the periodicity of {An mod m}. Consider the list

Xn = AnX0.

(3.4)

I, A, A2, A3,··· , An,···

where each Ai has been reduced modulo m. As a list, (3.4) is inﬁnite. However, when viewed as a set, it is
ﬁnite because the set of all r × r matrices with entries from the group Z/mZ is a ﬁnite set. Therefore, the
Pigeonhole Principle implies the existence of a pair of integers n and k such that

An+k ≡ Ak mod m

Invoke the Well-Ordering Principle to conclude that {An mod m}, and thus {xn

(3.5)
and n + k > k ≥ 0.
mod m}, is eventually periodic.
In the case when det(A) is relatively prime to m, the matrix A is invertible mod m. In view of (3.5), this
means that there is a positive integer n such that An ≡ I mod m, which is equivalent to saying that the
sequence {xn mod m} is periodic. The least possible n such that
(3.6)
for all k ≥ 0 is called the Pisano period of the sequence and it is usually denoted by π(m) if the context of
the sequence is clear. Also, it is clear that if n0 is the order of A mod m, then n0 satisﬁes (3.6). Therefore,
π(m) divides the order of the companion matrix modulo m. The order of A mod m is called the weak Pisano
period and is denoted by π∗(m).

xn+k ≡ xk mod m

Continue with the case gcd(det(A), m) = 1. Suppose that X0 is not the zero vector modulo m. The least

possible integer n such that

Xn+k ≡ sXk mod m,

(3.7)
for all k ≥ 0 where s is some integer, is called the restricted period of the sequence {xn mod m}. The
restricted period is usually denoted by α(m). Observe that the existence of α(m) follows from the fact that
the sequence is periodic. To be speciﬁc, the periodicity of {xn mod m} implies
(3.8)
for all k ≥ 0. Therefore, the set of positive integers satisfying (3.7) is not empty (π(m) belongs to this set).
The integer 0 < s(m) < m such that

Xπ(m)+k ≡ Xk mod m

(3.9)
for all k ≥ 0 is called the multiplier of the sequence {xn mod m}.

Xα(m)+k ≡ s(m)Xk mod m,

It is not hard to show that Xn+k ≡ sXk mod m, for all k ≥ 0 and some integer s, if and only if α(m)| n.
Therefore, not only does (3.8) imply the existence of α(m), it also implies that α(m) divides π(m). Write
π(m) = α(m)l(m). Observe that

(3.10)

X0 ≡ Xπ(m) ≡ Xα(m)l(m) ≡ s(m)l(m)X0 mod m.

Thus, s(m) is a unit modulo m. The order of s(m) is denoted by β(m). Note that

(3.11)

β(m)| l(m) =

π(m)
α(m)

.

On the other hand, since β(m) is the order of the multiplier modulo m, then
Xα(m)β(m)+k ≡ s(m)β(m)Xk ≡ Xk mod m,

(3.12)
for all k ≥ 0. This implies that π(m) divides α(m)β(m). Together, (3.11) and (3.12) yield π(m) = α(m)β(m).
As it was the case for the Pisano period, one can deﬁne the corresponding weak restricted period. The

natural way to deﬁne it is as the least positive integer n such that

(3.13)

An ≡ sI mod m,

6

FRANCIS N. CASTRO AND LUIS A. MEDINA

for some integer s. The weak restricted period is denoted by α∗(m). The numbers s∗(m) and β∗(m) are
deﬁned in the usual sense. It is not hard to show that

(1) π∗(m) = α∗(m)β∗(m),
(2) α(m)| α∗(m),
(3) β∗(m)| β(m).
The literature of Pisano periods and restricted periods is very fascinating and extensive. The case of
second order recurrences was intensively studied by Lucas [16]. Beautiful treatments for the Fibonacci
sequence are presented in [24, 28]. In [15], Somer presents a thorough treatment for the second order Lucas
sequence of the ﬁrst kind. In a short note [23], Robinson considers the Pisano period modulo m for higher
order Lucas sequences. Finally, in [27], Vince considers Pisano periods in the more general setting of a
number ﬁeld K, its ring of integers A, and a an ideal of A.

Remark 3.1. Let π(m) represents the Pisano period of the Fibonacci numbers modulo m. In [28], Wall
posed the question of whether there is a prime p for which π(p2) = π(p). This is still an open problem known
as Wall’s question. A prime p that satisﬁes

Fp−( p

5 ) ≡ 0 mod p2,

where Fn is the n-th Fibonacci number is known as a Wall-Sun-Sun prime. The existence of a Wall-Sun-Sun
prime provides an aﬃrmative answer to Wall’s question. In [26], Z. H. Sun and Z. W. Sun proved that if
the ﬁrst case of Fermat’s last theorem was false for a prime p, then p must be a Wall-Sun-Sun prime. It is
conjectured that there are inﬁnitely many Wall-Sun-Sun primes. As of today, none has been found. In 2007,
R. McIntosh and E. Roettger [17] showed that if a Wall-Sun-Sun prime p exists, then p > 2 × 1014. In 2014,
PrimeGrid showed that such a prime must satisfy p > 2.8 × 1016.

This manuscript considers the Pisano period of {S(σn,[k1··· ,ks])} modulo p where p is an odd prime. Thus,
from now on, let p be a ﬁxed prime such that p does not divide det(A) where A is the companion matrix
of some recurrent integer sequence {xn}. The assumption on p implies that the sequence {xn mod p} is
periodic instead of just eventually periodic.
The Pisano period π(p) and weak Pisano period π∗(p) are closely related to the minimal polynomial of A

µA(t) = f1(t)e1f2(t)e2 ··· fr(t)er

over Fp. In particular, A. Vince [27] proved the following result.
Theorem 3.2. Let {xn} be an integer sequence satisfying a homogenous linear recurrence with integer
coeﬃcients. Let A be the companion matrix of {xn}, µA(t) be the minimal polynomial of A over Fp and
(3.14)
be its irreducible factorization. Let αi be a root of fi(t) in some algebraically closed extension of Fp and
si = (cid:100)logp(ei)(cid:101). Then,
(3.15)
The weak Pisano period will be re-labeled as π∗(p; A) in order to make the dependence presented in Theorem
3.2 more explicit. As expected, the Pisano period π(p), which already depends on A (see Theorem 3.2), also
depends on the initial valued vector. Because of this, the Pisano period will be re-labeled as π(p; A; X0). It
is known [27] that if the initial valued vector X0 is a cyclic vector for A over Fp, then π(p; A; X0) = π∗(p; A).
However, if X0 is not a cyclic vector, then it may happen that π(p; A; X0) < π∗(p; A).
Example 3.3. Consider the sequence deﬁned by

π∗(p) = lcm(ps1 ord(α1),··· , psr ord(αr)).

xn = 4xn−1 − 6xn−2 + 4xn−3 − 2xn−4,

(3.16)
with initial valued vector X0 = (0, 2, 0, 1)T . Let A be its companion matrix. Note that det(A) = 2, thus the
primes 3 and 5 do not divide it.

Consider the sequence {xn mod 3}. The minimal polynomial of A over F3 is

for n ≥ 5,

µA,3(t) =(cid:0)t2 + 1(cid:1)(cid:0)t2 + 2t + 2(cid:1) .

However, note that the annihilator of X0 is ρX0(t) = t2 + 1. This is because ρX0 (t) is irreducible over F3
and ρX0 (A)X0 = 0. Therefore, X0 is not a cyclic vector for A over F3. In this case, the Pisano period is
π(3; A; X0) = 4, while the weak Pisano period is π∗(3; A) = 8.

MODULAR PERIODICITY OF EXPONENTIAL SUMS OF SYMMETRIC BOOLEAN FUNCTIONS

7

Consider now the sequence {xn mod 5}. The minimal polynomial of A over F5 is

µA,5(t) =(cid:0)t2 + 3t + 3(cid:1)(cid:0)t2 + 3t + 4(cid:1) .

The vector X0 is a cyclic vector of A over F5 and thus, the Pisano period and weak Pisano period coincide.
In this case, π(5; A; X0) = π∗(5; A) = 24.

Theorem 3.2 is one of the main tools used in this work. In the next section, the periodicity of {S(σn,[k1,··· ,ks])
mod p} is considered. In particular, Theorem 3.2 is used to obtain upper bounds for the Pisano periods.
Later, in section 5, these bounds are used to prove that some of the sequences {S(σn,[k1,··· ,ks]) mod p} are
never zero, which implies that the corresponding symmetric functions are never balanced.

4. Bounds and relations on the Pisano periods

Let A(k1,··· , ks) and χk1,··· ,ks(t) be the companion matrix and characteristic polynomial (resp.) associ-
ated to the minimal linear recurrence that {S(σn,[k1,··· ,ks])} satisﬁes. It is known (see [6]) that χk1,··· ,ks (t)
is a product (no repetitions) of terms among the list

Moreover, the term Φ2r (t − 1) is always a factor of χk1,··· ,ks (t). This implies that det(A(k1,··· , ks)) is a
power of 2. Therefore, if p (cid:54)= 2 is prime, then

t − 2, Φ4(t − 1), Φ8(t − 1),··· , Φ2r (t − 1).

{S(σn,[k1,··· ,ks]) mod p}

(p) respectively.

is periodic. The Pisano period and weak Pisano period of this sequence are denoted by πk1,··· ,ks(p) and
π∗
k1,··· ,ks
Consider the characteristic polynomial χk1,··· ,ks (t) over Fp. It turns out that it coincides with the minimal
polynomial of A over Fp. To show this, ﬁrst observe that gcd(t−2, Φ2i(t−1)) = 1. Now, it is a well-established
result that gcd(Φm(t), Φn(t)) = 1 in Fp[t] for m < n and neither m nor n is divisible by p. This implies
that, for i (cid:54)= j, gcd(Φ2i(t − 1), Φ2j (t − 1)) = 1 over Fp. Thus, the claim holds because Φ2i(t) does not have
repeated factors over Fp.

This information and Theorem 3.2 are all that is needed to have the following upper bound on the period

modulo p.
Theorem 4.1. Let p > 2 be prime and let 1 ≤ k1 < ··· < ks be integers with ks > 1. Let r = (cid:98)log2(ks)(cid:99) + 1.
Then,

(4.1)

π∗
k1,··· ,ks

(p)| pord2r (p) − 1,

where ordn(m) represent the order of m modulo n.
Proof. Let Ki/Fp be the splitting ﬁeld of Φ2i+1(t − 1) and K/Fp the splitting ﬁeld of χk1,··· ,ks (t). Then,

(1) Ki is the 2i+1 cyclotomic extension over Fp,
(2) [Ki, Fp] = ord2i+1(p),
(3) Ki ⊆ Ki+1 for all i.
Therefore, K = Kr−1. Write χk1,··· ,ks(t) = (t − 2)(t − α1)··· (t − αw) over K. Theorem 3.2 shows that
(p) = lcm(ord(2), ord(α1),··· , ord(αw)). It is clear that lcm(ord(2), ord(α1),··· , ord(αw)) divides
π∗
k1,··· ,ks
|K×| = pord2r (p) − 1. This concludes the proof.
(cid:3)
Corollary 4.2. Let p ≡ 1 mod 4 be prime and let 1 ≤ k1 < ··· < ks be integers with ks > 1. Suppose that
p = 2rb + 1 with b odd and that ks < 2r. Then,
π∗
k1,··· ,ks
(4.2)
(cid:3)
Proof. Note that Fp is the splitting ﬁeld of the characteristic polynomial. This concludes the proof.
Corollary 4.3. Let p ≡ 3 mod 4 be prime and let 1 ≤ k1 < ··· < ks be integers with ks > 1. Suppose that
p2 − 1 = 2rb with b odd and that ks < 2r. Then,
π∗
k1,··· ,ks
(4.3)
Proof. Let r0 = (cid:98)log2(ks)(cid:99). Observe that the hypotheses imply r0 + 1 ≤ r. Clearly, ord2(p) = 1 and
ord22(p) = ord23(p) = ··· = ord2r0+1(p) = 2. The result follows from Theorem 4.1.
(cid:3)

(p)| p2 − 1.

(p)| p − 1.

8

FRANCIS N. CASTRO AND LUIS A. MEDINA

Theorem 4.1 and its corollaries provide upper bounds for the Pisano period of these sequences. The next
result provides a lower bound for the weak Pisano period. The proof depends on the following concept.
Consider a recurrent sequence {xn} which is periodic modulo m for some positive integer m. Fix an integer
i ≥ 0. The local period modulo m at position i is deﬁned as the least positive integer n such that xi ≡ xi+kn
mod m for every integer k. The local period at position i is denoted by λ(m; i). Note that its existence
follows from the fact that {xn mod m} is periodic. Moreover, it is clear that λ(m; i) divides the Pisano
period π(m) of the sequence.
Theorem 4.4. Let p > 2 be prime and let 1 ≤ k1 < ··· < ks be integers. If r = (cid:98)log2(ks)(cid:99) + 1, then

π∗
k1,··· ,ks

(p) ≡ 0 mod 2r.

Proof. Let p be an odd prime. Observe that if the result holds for powers of two, then it is true in general.
This is because Φ2r (t − 1) is always a factor of χk1,··· ,ks(t) and therefore π∗

2r−1(p)| π∗

Suppose that k is a power of two, say k = 2l for l ≥ 1. Recall that

k1,··· ,ks

(p).

n(cid:88)

j=0

(−1)( j
2l)

(cid:18)n
(cid:19)

j

(4.4)

S(σn,2l ) =

and that the characteristic polynomial of the minimal recurrence associated to it is Φ2l+1(t− 1). The degree
of this polynomial is 2l. Thus, in order to construct {S(σn,2l )} from this recursion, one needs 2l initial
values.

The ﬁrst 2l values of S(σn,2l ) (starting from n = 1) are

2, 4, 8,··· , 22l−1, 22l − 2.

These values can be used to obtain every other value of S(σn,2l ). However, note that in this case, one can
start the recurrence at n = 0 instead of n = 1. This is because the value at n = 0 is 1 and −Φ2l+1(t− 1) + t2l
returns 22l − 2 when t = 2. Thus, the values

can be used to generate the value 22l − 2 and therefore any other value of S(σn,2l ). Moreover, since

1, 2, 4, 8,··· , 22l−1

(−Φ2l+1(t − 1) + t2l

+ 2)/2

returns 22l−1 when t = 2, then the sequence deﬁned by x0 = 0 and xj = 2j−1 for j = 1, 2,··· , 2l − 1 is such
that x0 = 0 and xn = S(σn−1,2l) for n ≥ 1.
cases). This implies that λ(p; 0)| 2l+1. However, λ(p; 0) (cid:54)= 2j for 0 ≤ j < l + 1, because

Observe x2l+1D = S(σ2l+1D−1,2l ) = 0 = x0 for every natural number D (these are trivially balanced

x2j = 22j−1 (cid:54)≡ 0 = x0 mod p.

Thus, λ(p; 0) = 2l+1 and the result follows from the fact that
λ(p; 0)| π2l (p)| π∗

2l (p).

(cid:3)
This concludes the proof.
Example 4.5. Consider the prime p = 41. The terms corresponding to k = 2, 3,··· , 15 of the sequence of
Pisano periods {πk(41)}k≥2 are given by

20, 20, 40, 40, 40, 40, 1680, 1680, 1680, 1680, 1680, 1680, 1680, 1680.

Note that

(4.5)

π2(41) = π3(41) = 20 ≡ 0 mod 4

as Theorem 4.4 predicted. Moreover, 20 is a divisor of 40, as predicted by Corollary 4.2. From k = 4 to
k = 7, the period is πk(41) = 40, thus the bound provided by Theorem 4.1 can be attained. Furthermore,
πk(41) = 40 ≡ 0 mod 8. Finally, from k = 8 to k = 15 the period is πk(41) = 1680 = 412 − 1 and 1680 ≡ 0
mod 16.

MODULAR PERIODICITY OF EXPONENTIAL SUMS OF SYMMETRIC BOOLEAN FUNCTIONS

9

Example 4.6. Consider now the prime p = 13. The terms corresponding to k = 2, 3,··· , 15 of the sequence
of Pisano periods {πk(13)}k≥2 are given by

12, 12, 168, 168, 168, 168, 5712, 5712, 5712, 5712, 5712, 5712, 5712, 5712.

The reader can verify that Theorems 4.1 and 4.4 hold. Observe that from k = 8 to k = 15, the period is
πk(13) = 5712, which is a divisor of 134 − 1 = 28560. Therefore, the bound provided by Theorem 4.1 is not
always sharp.

Examples 4.5 and 4.6 show how Theorems 4.1 and 4.4 work, but also suggest a beautiful relation between
the Pisano periods of the sequences considered in this article. Observe that in both cases, πk1(p) divides
πk2 (p) for k1 < k2. Moreover, in both examples one has πk1(p) = πk2 (p) = π2r−1(p) when 2r−1 ≤ k1, k2 < 2r.
The next series of results shows that this relation holds for weak Pisano periods.
Lemma 4.7. Let p > 2 be prime and r > 0 be an integer. Let α1,··· , α2r be the roots of χ2r (t) in some
extension of Fp. Similarly, let β1,··· , β2r+1 be the roots of χ2r+1(t) in some extension of Fp. Then,

lcm(ord(α1),··· , ord(α2r ))| lcm(ord(β1),··· , ord(β2r+1)).

Proof. Let α be a root of χ2r (t) = Φ2r+1(t − 1) in some extension of Fp. This is, (α − 1)2r
be a root of t2 − 2t + 2 − α, i.e. (β − 1)2 + 1 = α. Note that
χ2r+1(β) = (β − 1)2r+1
= ((β − 1)2)2r
= ([(β − 1)2 + 1] − 1)2r
= (α − 1)2r
= 0,

+ 1

+ 1

+ 1

+ 1

+ 1 = 0. Let β

and therefore β is a root of χ2r+1(t). The converse is also true, i.e. if β is a root of χ2r+1(t) in some extension
of Fp, then α = (β − 1)2 + 1 is such that χ2r (α) = 0. Since t2 − 2t + 2 − α does not have repeated roots,
then all roots of χ2r+1(t) can be obtained from α1,··· , α2r by ﬁnding the roots of t2 − 2t + 2 − αi for
i = 1, 2, 3,··· , 2r.

The proof for r = 1 (instead of the general case) is presented next. This is done for the simplicity of the
writing. The general case can be done using the same argument and induction. Let α1 and α2 be the roots
of χ2(t). Write t2 − 2t + 2 = (t − α1)(t − α2) and observe that
α1 + α2 = 2
α1α2 = 2.

Let β1, β2, β3, β4 be the roots of χ4(t). Say β1, β2 are the roots of t2 − 2t + 2 − α1 and β3, β4 are the roots
of t2 − 2t + 2 − α2. Then,

β1 + β2 = 2

β1β2 = 2 − α1 = α2

β3 + β4 = 2

β3β4 = 2 − α2 = α1.

Let m2 = lcm(ord(α1), ord(α2)) and m4 = lcm(ord(β1), ord(β2), ord(β3), ord(β4)). Observe that

αm4
1 = (β3β4)m4 = βm4

3 βm4

4 = 1 · 1 = 1.

2 = 1. It follows that m2 | m4. This concludes the proof.

(cid:3)
Similarly, αm4
Theorem 4.8. Let p > 2 be prime and 1 ≤ 1 < k1 < ··· < ks be integers with ks > 1. Let r = (cid:98)log2(ks)(cid:99)+1.
Then,

Proof. Recall that χk1,··· ,ks(t) is a square-free product of terms among the list

t − 2, Φ4(t − 1), Φ8(t − 1),··· , Φ2r (t − 1),

π∗
k1,··· ,ks

(p) = π∗

2r−1(p).

10

FRANCIS N. CASTRO AND LUIS A. MEDINA

and that Φ2r (t − 1) = χ2r−1(t) is always a factor of χk1,··· ,ks (t). Let
α1,··· , α2r−1 , α2r−1+1,··· , αw

be the roots of χk1,··· ,ks(t) in some extension of Fp. Suppose that α1,··· , α2r−1 are the roots that come from
the factor Φ2r (t − 1). Theorem 3.2 and Lemma 4.7 imply

π∗
k1,··· ,ks

(p) = lcm(ord(α1),··· , ord(α2r−1), ord(α2r−1+1),··· , ord(αw))

= lcm(ord(α1),··· , ord(α2r−1))
= π∗

2r−1(p).

This concludes the proof.
Corollary 4.9. Let p > 2 be prime. If 2 ≤ k1 < k2 are integers, then π∗
2r−1 ≤ k1, k2 < 2r, then π∗
Proof. This is a direct consequence of Lemma 4.7 and Theorem 4.8.

(p) = π∗

(p) = π∗

2r−1(p).

k1

k2

k1

(p) divides π∗

k2

(p). Moreover, if

(cid:3)

(cid:3)

In the next section Pisano periods are used to show that some symmetric Boolean functions are not
balanced. The idea is simple: given a Boolean function σn,[k1,··· ,ks] and a prime p, check that S(σn,[k1,··· ,ks]) (cid:54)≡
0 mod p for n = 1, 2,··· , πk1,··· ,ks(p). Note that in practice, it suﬃces to use weak Pisano periods instead
of Pisano periods. The reason for this is that there are at most a ﬁnite amount of primes p for which the
initial valued vector X0 of {S(σn,[k1,··· ,ks ])} is not a cyclic vector for the companion matrix A(k1,··· , ks).
Thus, for almost all primes one is guaranteed to have πk1,··· ,ks (p) = π∗
(p). In fact, for powers of two,
2l (p) for every odd prime. This is because for X0 = (1, 2, 4, 8,··· , 22l−1)T and A = A(2l),
one has π2l (p) = π∗
the determinant of the matrix

k1,··· ,ks

(4.6)
is det(B) = −2 if l = 1 and det(B) = 22l−1 if l (cid:54)= 1. Therefore, the vector X0 is a cyclic vector of A over Fp
for every odd prime and the claim holds.

B = (X0, AX0, A2X0,··· , A22l−1−1X0)

5. Avoiding primes

Suppose that one encounters the problem of showing that a sequence {xn} is never zero, i.e. xn (cid:54)= 0 for
every n. In practice, this can be a very diﬃcult problem to tackle. However, if one can show that there is
a prime p such that it does not divide xn for every n, then the sequence is never zero. An integer sequence
{xn} is said to avoid a prime p if p does not divide xn for every n, otherwise {xn} cannot avoid p (it is
common in the literature to say that, in the later case, p divides {xn}). Of course, there are sequences that
cannot avoid any prime, yet they are never zero. The most simple example is {n}n∈N, a sequence that is
even periodic modulo m for every positive integer m.
Consider the sequence given by the exponential sum of an elementary symmetric polynomial {S(σn,k)},
which is at the root of Cusick-Li-Stˇanicˇa’s conjecture. It is known that if k is odd, then S(σn,k) is never
zero [10]. On the other hand, if k = 2r is a power of two, then n = 2r+1m − 1, for m a positive integer, is
such that S(σn,k) = 0 (these are trivially balanced cases). Therefore, the ﬁrst case that neither of these two
results rule out is {S(σn,6)}.

The sequence {S(σn,6)} satisﬁes the linear recurrence

xn = 8xn−1 − 28xn−2 + 56xn−3 − 70xn−4 + 56xn−5 − 28xn−6 + 8xn−7.

(5.1)
Choose the prime p = 3, which is the smallest one for which {S(σn,6) mod p} is periodic. In this case, the
Pisano period is given by π6(3) = 8. The fundamental period for this sequence is

2, 1, 2, 1, 2, 2, 1, 1.

This implies that 3 does not divide S(σn,6) for any n, i.e. the sequence avoids the prime 3. Thus the Boolean
function σn,6 is not balanced for any n.

The fact that σn,6 is never balanced is already known and it follows from [4, Th. 4, p. 2805], however,
the above discussion shows how the technique works. The same technique can be used to prove that other
symmetric polynomials are not balanced because they avoid primes. However, the choice of the prime p = 3
seems to be a rather bad one. In fact, it looks like the only sequence of the form {S(σn,k)} that avoids 3 is
the one when k = 6 and there might be a heuristic argument behind this.

MODULAR PERIODICITY OF EXPONENTIAL SUMS OF SYMMETRIC BOOLEAN FUNCTIONS

11

In the case of {S(σn,k) mod 3}, for 2 ≤ k ≤ 7, the Pisano period is 8. The probability that a vector of

length 8 with entries in F3, which is chosen at random, does not contain 0 is

(cid:19)8 ≈ 0.03901844231.

(cid:18) 2

3

The situation gets worse for k > 7. In particular, for 8 ≤ k ≤ 15, the Pisano period is given by πk(3) = 80
and (2/3)80 is already minuscule. Thus, one expects that if a vector in F80
is chosen at random, then it
contains a good amount of zeros (the expected number of zeros is 80/3 = 26.66¯6). Indeed, let

3

(5.2)

Then,

zk(p) = amount of 0’s in {S(σn,k) mod p| 1 ≤ n ≤ πk(p)}.

k

zk(3)

8
9
38 21

10 11 12 13
27 26 17 22
For 16 ≤ k ≤ 31, the Pisano period is πk(3) = 6560 and one has
20
2081
28
2194

16
zk(3) 2402
24
zk(3) 2091

17
2079
25
2324

18
2100
26
2204

19
2117
27
2169

k

k

14 15
17 21

21
2143
29
2108

22
2081
30
2049

23
2133
31
2153

For 32 ≤ k ≤ 63, the period is πk(3) = 316 − 1 = 43046720 and for 64 ≤ k ≤ 127, the value is πk(3) =
332 − 1 = 1853020188851840. For 128 ≤ k < 255, πk(3) = 364 − 1 and for 256 ≤ k < 511, the period is
πk(3) = 3128 − 1, which is a number with 62 digits. This data suggests that it should not be “expected” to
ﬁnd an elementary symmetric polynomial of degree k bigger than 7 such that {S(σn,k)} avoids 3.

The above analysis does not suggest the absence of symmetric Boolean functions for which their expo-
nential sums avoid the prime 3, it only suggests that for elementary symmetric Boolean functions. However,
given the magnitude of the Pisano periods πk(3), if there are other symmetric Boolean functions for which
their exponential sums avoid 3, then it is probable that their degrees are less than or equal to 7. In fact,
given that there are 127 symmetric Boolean functions of degree less than or equal to 7, then it is almost
certain that they exist. Indeed, an exhaustive search found all the symmetric Boolean functions of degree
less than or equal to 7 such that their exponential sums avoid the prime 3,

(5.3)

σn,[2,3,5] σn,6
σn,[4,7]

σn,[4,6]

σn,[4,5,6]

σn,[2,3,5,6]

σn,[4,5,6,7] σn,[2,3,4,5,7] σn,[2,3,4,5,6,7].

These might be all of the symmetric Boolean functions with this property.

Remark 5.1. The symmetric Boolean function σn,[2,3,5] is peculiar in the sense that every other symmetric
Boolean function in (5.3) is asymptotically not balanced while σn,[2,3,5] is not. This means that even without
the knowledge that their exponential sums avoid the prime 3, one knows that every symmetric Boolean
function in (5.3) diﬀerent from σn,[2,3,5] is not balanced for n big enough. The same cannot be said about
σn,[2,3,5], thus the fact that its exponential sum avoids 3 holds the key to show that it is not balanced.
Figure 1 is a graphical representation of S(σn,[2,3,5])/2n. Observe that even though the graph oscillates
between positive and negative numbers and can get as close to zero as one desires, it is never zero because
{S(σn,[2,3,5])}n∈N avoids the prime 3.

The quest now is to identify primes that are excellent candidates for these sequences to avoid. These
should be primes p with “small” period relative to p. Theorem 4.1 and Corollary 4.2 oﬀer a clue. In fact,
the case p ≡ 1 mod 4 provides some optimism. Recall that Corollary 4.2 states that if p = 2rb + 1 with b
odd, then, for 1 ≤ k1 < ··· < ks < 2r, the Pisano period πk1,··· ,ks(p) divides p − 1 and

(5.4)

0.3678794412 ≈ 1
e

<

(cid:18) p − 1

(cid:19)p−1 ≤

p

(cid:18) 4

(cid:19)4

5

= 0.4096.

Therefore, heuristically, if a symmetric Boolean function is not balanced and its degree is ks, then there
is a good chance that its exponential sum avoids a prime of the form 2rb + 1 where b is an integer and
r = (cid:98)log2(ks)(cid:99) + 1.

12

FRANCIS N. CASTRO AND LUIS A. MEDINA

Figure 1. Graphical representation of S(σn,[2,3,5])/2n.

The case p ≡ 3 mod 4 is diﬀerent. Theorem 4.1 implies that the smallest possible Pisano period is a

divisor of p2 − 1 and

(5.5)

(cid:18) p − 1

(cid:19)p2−1 → 0 as p → ∞.

p

Thus, if the exponential sum of an individual symmetric Boolean function is considered, then these primes
do not seem to be good candidates for the sequence to avoid. However, as it was the case of the prime 3,
there is strength in numbers. To be precise, if p ≡ 3 mod 4 and p2−1 is highly divisible by 2, then Corollary
4.3 implies that the exponential sum of every symmetric Boolean function of degree less than the higher
power of 2 that divides p2 − 1 has Pisano period divisor of p2 − 1. If the number of these symmetric Boolean
functions is big enough, one may have that the expected number of them that avoid p is bigger than 1 and
therefore these primes also become good candidates. For example, consider the prime p = 7. In this case,
p2 − 1 = 48 and 48 = 16 · 3. There are 215 − 1 = 32767 symmetric Boolean functions of degree less than 16
and

(5.6)

(215 − 1)

(cid:19)48 ≈ 20.0443.

(cid:18) 6

7

This suggests that about 20 of them have exponential sums that avoid 7. An exhaustive search found out
that there are exactly 18 of them. These are

(5.7)

σn,[2,3,5,7,9,12]
σn,[2,3,6,7,9,12,13]

σn,[2,3,4,5,9,10,11]
σn,[3,6,8,9,12,13]
σn,[2,3,4,5,6,7,9,10,11,12,13] σn,[3,6,10,13,14]
σn,[5,6,8,10,13,14]
σn,[3,4,5,6,8,9,14]
σn,[5,6,8,11,13,15]

σn,[8,9,10,11,12,14]
σn,[3,5,8,9,10,12,14] σn,[3,5,8,10,11,12,13,14]
σn,[3,4,5,7,8,9,15]
σn,[2,3,8,9,10,12,14,15].

σn,[3,4,5,7,10,11,12]
σn,[2,3,5,7,8,9,10,11,12,13]
σn,[2,3,5,7,9,14]
σn,[8,9,10,12,13,14]

Remark 5.2. The ﬁrst prime that it is not a “good candidate” in the sense described above is the prime
11. From degree 4 to degree 7, the weak Pisano period is 120. From degree 8 to degree 15, the weak
Pisano period is 14640 and from degree 16 to degree 31 the weak Pisano period is already an astonishing
number: 214358880. It has been veriﬁed that the prime 11 divides the sequence of exponential sums of every
symmetric Boolean function degree less than or equal to 24 and there is a total of 224 − 1 = 16777217 of such
functions. The prime 19 is similar. Moreover, it appears that for every prime p > 2, there is a number K(p)
such that p divides the sequence of exponential sums of every symmetric Boolean function of degree bigger
than or equal to K(p). For example, computer experiments suggest that K(3) = 8, K(7) = 16 and K(11) = 1.

Now take a step back and consider once again the case of an elementary symmetric Boolean function.
Since the focus is on an individual function, then only primes p ≡ 1 mod 4 are considered, as they seem to
be excellent candidates to avoid. Suppose that k is a positive integer which is not a power of two. Deﬁne r
by 2r−1 < k < 2r and let p(k) be the smallest prime p of the form p = 2rm + 1, m a positive integer, such
that {S(σn,k)} avoids p. For example, p(3) = 5. Of course, in general this number might not exist, however
its existence would imply Cusick-Li-Stˇanicˇa’s conjecture. It has been veriﬁed that the prime p(k) exists for
all k in the range 1 < k < 2048 that are not powers of 2 showing that σn,k is not balanced for any n and

20406080100-0.20.20.40.60.81.0MODULAR PERIODICITY OF EXPONENTIAL SUMS OF SYMMETRIC BOOLEAN FUNCTIONS

13

such k’s. For for example, p(1292) = 176129. The reader is invited to see the table included in Appendix
A, which contains p(k) for k ≤ 263. Note that this supports the claim that primes p ≡ 1 mod 4 are good
candidates to avoid. This information leads the authors to the following conjecture:

Conjecture 5.3. Let k be a natural number which is not a power of two. The prime p(k) exists.

Remark 5.4. As mentioned before, an aﬃrmative answer to this conjecture implies that Cusick-Li-Stˇanicˇa’s
conjecture is true. However, Conjecture 5.3 is much stronger. Recurrence (2.8) can be used to extend
{S(σn,k)}n∈N inﬁnitely to the left (non-positive values of n) with the compromise that the value of S(σn,k)
for such an n may be a rational number instead of an integer. For example, the sequence {S(σn,6})}n∈Z is
given by

··· ,

233
128

,

65
64

, 1, 2, 4, 8, 16, 32, 62, 112,··· .

,− 19
32

,− 19
16

,− 5
8

,

1
4

The existence of the prime p(k) implies that {S(σn,k)}n∈Z is never zero, regardless of the integer value of
n. This is much stronger than asserting that S(σn,k) (cid:54)= 0 for n ≥ k. For instance, S(σn,[3,2,1]) (cid:54)= 0 for
n ≥ 3, which means, in terms of the theory of Boolean functions, that σn,[3,2,1] is not balanced. However,
every prime divides {S(σn,[3,2,1])} for the simple reason that the value 0 is obtained when n = 1. A Boolean
function σn,[k1,··· ,ks] is said to be strongly non-balanced if S(σn,[k1,··· ,ks]) (cid:54)= 0 for any integral value of n. For
example, σn,6 is strongly non-balanced, while σn,[3,2,1] is non-balanced, but not strongly non-balanced. Of
course, if Conjecture 5.3 is true, it would imply that every elementary symmetric Boolean function σn,k is
strongly non-balanced for k not a power of two.

The above argument provides examples of symmetric Boolean functions whose exponential sums avoid
primes. This leads to the following question: given a sequence of exponential sums like {S(σn,[k1,··· ,ks])},
how many primes are avoided by it? In order to try to answer this question, the focus is now shifted to the
set of primes avoided by a given sequence of exponential sums. Since all the theory discussed throughout the
article also applies to perturbations, then they are also included in the study below. These perturbations
will prove to be useful when the case of degree two is considered.

Let 1 ≤ k1 < ··· < ks and deﬁne

Av(k1,··· , ks) = {p prime | S(σn,[k1,··· ,ks]) avoids p}

(5.8)
Similarly, for a perturbation σn,[k1,··· ,ks] + F (X), the set of primes avoided by {S(σn,[k1,··· ,ks] + F (X))} is
denoted by Av(k1,··· , ks; F (X)). Following the literature, the complements of the sets Av(k1,··· , ks) and
Av(k1,··· , ks; F (X)), i.e. the sets of primes that divide the sequences {S(σn,[k1,··· ,ks])} and {S(σn,[k1,··· ,ks] +
F (X))}, are denoted by P (k1,··· , ks) and P (k1,··· , ks; F (X)), respectively. Suppose {xn}n∈N is an integer
sequence that satisﬁes a homogenous linear recurrence with integer coeﬃcients. The set of primes dividing the
sequence {xn} is denoted by P (xn). The sequence {xn} is said to be degenerate if the associated characteristic
polynomial is either inseparable or has two diﬀerent roots whose quotient is a root of unity, otherwise the
sequence is said to be non-degenerate. In 1921, P´olya proved that if the sequence is non-degenerate, then
P (xn) is inﬁnite.
Consider the sequence {S(σn,[k1,··· ,ks])}. It has been established that its characteristic polynomial is a

square-free product of terms among the list

t − 2, Φ4(t − 1), Φ8(t − 1),··· , Φ2r (t − 1),

where r = (cid:98)log2(ks)(cid:99)+1, and that Φ2r (t−1) is always a factor. Consider the numbers α1 = 1−exp(πi/2r) and
α2 = 1+exp((2r−1)πi/2r), which are two roots of Φ2r (t−1). Observe that quotient α1/α2 = − exp(πi/2r) is
a root of unity and so {S(σn,[k1,··· ,ks])} is degenerate (the same reason implies that sequences of exponential
sums of the perturbations considered in this article are also degenerate). This means that P´olya’s result
does not guarantee that P (k1,··· , ks) is inﬁnite and thus, Av(k1,··· , ks) may very well be inﬁnite or even
dense within the set of primes. However, it can also be ﬁnite, which is clearly the case if one of the initial
conditions is 0. For instance, if the degrees 1 ≤ k1 < ··· < ks are such that k1 = 1, then it is clear from the
deﬁnition of S(σn,[1,k2,··· ,ks]) as a binomial sum that S(σ1,[1,k2,··· ,ks]) = 0, i.e. the ﬁrst initial condition is 0.
This implies that Av(1, k2,··· , ks) = ∅, which is equivalent to say that every prime p divides inﬁnitely many
terms of the sequence {S(σn,[1,k2,··· ,ks])}. The same applies to {S(σn,[2,k2,··· ,ks])} when k2 ≥ 4 because the
third initial condition is 0.

14

FRANCIS N. CASTRO AND LUIS A. MEDINA

Deﬁnition 5.5. Suppose that S is a subset of the set of primes. The natural density of S is deﬁned by

(5.9)

whenever this limit exists.

δ(S) = lim
N→∞

#{p ∈ S : p ≤ N}
#{p prime : p ≤ N}

The fact that these sequences are degenerate can be explicitly seen for the case of the exponential sum of
σn,2 and its perturbations. In particular, for any perturbation σn,2 + F (X), the set P (2; F (X)) is either the
set of all primes (because the sequence {S(σn,2 + F (X))}n>j has zeros in it) or a ﬁnite set. In particular,
the following result holds.

Theorem 5.6. Let n and j be positive integers. Suppose that j < n and let F (X) be a binary polynomial in
the variables X1,··· , Xj (the ﬁrst j variables in X1,··· , Xn). Let DF (n) = σn,2 + F (X). If

(5.10)

S(DF (2 + j))
S(DF (1 + j))

− 1 /∈ {0,±1,∞},

then DF (n) is not balanced for every n > j. Moreover, the set of primes that divide the sequence
(5.11)

{S(DF (n))}n>j

is ﬁnite, which implies that the set of primes avoided by (5.11) has density 1.
Proof. Let d(n) = S(DF (n)). Then, the sequence {d(n)}n>j satisﬁes the recurrence
(5.12)

xn = 2xn−1 − 2xn−2.

Finding the roots of the characteristic polynomial and solving the corresponding system for this perturbation,
one ﬁnds

d(n) = 2

1

2 (−j+n+1)−1

d(j + 1) sin

(5.13)

1

2 (−j+n+1)−1

+2

(d(j + 1) − d(j + 2)) cos

Therefore, DF (n) is balanced, i.e. d(n) = 0, if and only if

(cid:18)

(cid:18)

(cid:18) π(n − j + 1)

4

(cid:19)(cid:19)
(cid:18) π(n − j + 1)
(cid:17)

4

(cid:19)(cid:19)

.

(cid:16)

d(j + 2)
d(j + 1)

− 1 = tan

(n − j + 1)

π
4

.

d(j + 2)
d(j + 1)

− 1 /∈ {0,±1,∞},

(5.14)

Thus, if

then the perturbation DF (n) is not balanced for any n > j.

Suppose that the perturbation DF (n) is not balanced. The quest now is to ﬁnd the set of primes that
divide d(n). Dividing the values of d(n) according to the remainders of n on division by 4, one ﬁnds that a
prime p divides d(n) if and only if it divides one of the following four numbers

2d(j + 1) − d(j + 2), d(j + 1), d(j + 2), or d(j + 1) − d(j + 2).

Therefore, the set of primes that divide {S(DF (n))}n>j is ﬁnite and so the set of primes avoided by (5.11)
(cid:3)
has density 1.
Observe that the above proof implies that once {S(σn,2 + F (X))}n>j has a zero at position n0, then there
are zeros at the positions n0 + 4k for k ∈ Z. Also, if the zeros in {S(σn,2 + F (X))}n>j are removed, then
there is only a ﬁnite amount of primes that divide the remaining terms.

Example 5.7. Consider the perturbation σn,2 + X1X2X3 + X4X5X6. Let d(n) = S(σn,2 + X1X2X3 +
X4X5X6). Observe that
Since d(8)/d(7) − 1 /∈ {0,±1,∞}, then σn,2 + X1X2X3 + X4X5X6 is never balanced. Moreover, since

d(7) = −24 and d(8) = 8.

{2d(7) − d(8), d(7), d(8), d(7) − d(8)} = {−56,−24, 8,−32},

then only the primes 2, 3 and 7 divide some terms of the sequence {S(σn,2 +X1X2X3 +X4X5X6)}. Explicitly,
2 divides every term of the sequence (trivial), 3 divides d(7 + 4m) and 7 divides d(10 + 4m) for every m ≥ 0.

MODULAR PERIODICITY OF EXPONENTIAL SUMS OF SYMMETRIC BOOLEAN FUNCTIONS

15

The story of the case of degree two and its perturbations is short: either Av(2; F (X)) is empty or has
density 1 because P (2; F (X)) is ﬁnite. The next step (naturally) is the case of degree 3. At this early
stage the study becomes hard. The next result, which considers the cases for σn,3 and σn,[3,2], serves as an
example.
Theorem 5.8. The sequences {S(σn,3)} and {S(σn,[3,2])} avoid a prime p > 2 if and only if ordp(4) ≡ 2
mod 4. In particular, both sequences avoid all primes of the form 8q + 5.
Proof. The proof for {S(σn,3)} is presented next. A similar argument can be applied to {S(σn,[3,2])}.

Recall that {S(σn,3)} satisﬁes the recurrence

(5.15)

xn = 4xn−1 − 6xn−2 + 4xn−3,

with initial conditions x1 = 2, x2 = 4 and x3 = 6. Finding the roots of the characteristic polynomial and
using the initial conditions yield

(5.16)

Thus,

(5.17)

S(σn,3) =



S(σn,3) = 2n−1 + 2n/2 sin(nπ/4).

24m−1
4m(4m + (−1)m)
22m+1(4m + (−1)m)
22m+1(22m+1 + (−1)m)

if n = 4m
if n = 4m + 1
if n = 4m + 2
if n = 4m + 3.

Equation (5.17) implies that an odd prime p divides S(σn,3) if and only if p divides 4m + (−1)m for some
m or p divides 22m+1 + (−1)m for some m. Thus, the problem is reduced to ﬁnd primes p for which the
congruences

(5.18)

and

(5.19)

have solutions.

4m + (−1)m ≡ 0 mod p

22m+1 + (−1)m ≡ 0 mod p

It is not hard to show that if (5.19) has a solution, then (5.18) has a solution, thus it is enough to ﬁnd

solutions for (5.18). According to the parity of m, the solutions must be integers a such that

(5.20)

42a ≡ −1 mod p or 42a+1 ≡ 1 mod p.

Suppose ordp(4) = 4l, then 42l ≡ −1 mod p. Thus, there are solutions to (5.20) and therefore p divides
{S(σn,3)}. Also, it is clear that if ordp(4) = 2l + 1, then (5.20) has solutions and therefore p also divides
{S(σn,3)} in this case. Consider now the last case, this is, suppose that ordp(4) = 4l + 2. Then,

44l+2 ≡ 1 mod p
42l+1 ≡ −1 mod p.

This implies that every solution to 4j ≡ 1 mod p is even and every solution to 4j ≡ −1 mod p is odd.
Therefore, (5.20) does not have solutions mod p, which implies that {S(σn,3)} avoids p. This concludes the
ﬁrst statement of the theorem.

Suppose now that p = 8q + 5. Since 4 is a square, then

p−1

2 = 44q+2 ≡ 1 mod p

4

(5.21)
and therefore ordp(4)| 4q + 2. Suppose that ordp(4) is an odd factor of 4q + 2. Say ordp(4) = 2k + 1. Then,
42k+1 ≡ 1 mod p. Let x = 2k and observe that
(5.22)
But p cannot divide 2x2 − 1 because this would imply that (p + 1)/2 is a square modulo p and (p + 1)/2 is a
quadratic non-residue for p ≡ 5 mod 8. Similarly, p does not divide 2x2 + 1 because (p− 1)/2 is a quadratic
non-residue for p ≡ 5 mod 8. Therefore, ordp(4) odd leads to a contradiction. It must be that ordp(4) is
even. Since ordp(4)| 4q + 2, then ordp(4) is divisible by 2, but not by 4. Therefore ordp(4) ≡ 2 mod 4 and,
by previous argument, {S(σn,3)} avoids p. This concludes the proof.
(cid:3)

(2x2 − 1)(2x2 + 1) ≡ 0 mod p.

16

FRANCIS N. CASTRO AND LUIS A. MEDINA

It is a classical result that the natural density of the set of primes in the arithmetic progression an + b,
gcd(a, b) = 1, is 1/ϕ(a) where ϕ is the Euler’s totient function. The above theorem shows that Av(3) =
Av(3, 2) contains a subset that has positive natural density, namely {p prime | p ≡ 5 mod 8}, which has
density 1/4. This implies that Av(3) = Av(3, 2) is inﬁnite. Observe that if p ≡ 3 mod 4, then ordp(4) is
odd. This implies that {p prime| p ≡ 3 mod 4} ⊆ P (3) = Av(3)c. Therefore, if Av(3) has natural density,
then 1/4 ≤ δ(Av(3)) ≤ 1/2. Experiments suggest that δ(Av(3)) is close to 1/3. Calculating the exact density
of a subset of primes is, generally, not easy. Perhaps an argument similar to the one presented in [11] by
Hasse is needed to calculate the exact density of Av(3). This problem will not be considered in this work.

Continue with the case of degree 3. The other two symmetric Boolean functions of degree 3 that have not
been considered are σn,[3,1] and σn,[3,2,1]. In these cases, the sets Av(3, 1) and Av(3, 2, 1) are empty because
{S(σn,[3,1])} and {S(σn,[3,2,1])} satisfy (5.15) with initial conditions 0, 0, 2 and 0,−2,−6, respectively. Thus,
this method cannot be used to identify them as not balanced. However, observe that these symmetric
Boolean functions are asymptotically not balanced. In fact,

(5.23)

lim
n→∞

S(σn,[3,1])

2n

=

1
2

and lim
n→∞

S(σn,[3,2,1])

2n

= − 1
2

.

Solving (5.15) with the corresponding initial conditions leads to
S(σn,[3,1]) = 2n−1 − 2n/2 sin

(5.24)

and

(5.26)

(5.25)
From here it is not hard to see that for all n ≥ 4,

S(σn,[3,2,1]) = −2n−1 + 2n/2 cos

(cid:12)(cid:12)(cid:12)(cid:12) S(σn,[3,1])

2n

(cid:12)(cid:12)(cid:12)(cid:12) <

− 1
2

1
3

and

4

(cid:17)
(cid:16) πn
(cid:17)
(cid:16) πn
(cid:12)(cid:12)(cid:12)(cid:12) S(σn,[3,2,1])

2n

+

4

.

(cid:12)(cid:12)(cid:12)(cid:12) <

1
3

.

1
2

Thus, σn,[3,1] and σn,[3,2,1] are in fact are not balanced for every n ≥ 3, even though {S(σn,[3,1])} and
{S(σn,[3,2,1])} are divisible by every prime.

Perturbations of σn,3 exhibit a similar behavior. The next result provides an example.

Proposition 5.9. The set of primes avoided by the sequence

{S(σn,3 + X1 + X2X3 + X1X2X3)}n≥4

is inﬁnite. In particular, it contains a subset with positive density.
Proof. Let F (X) = X1 +X2X3 +X1X2X3. The sequence {S(σn,3 +F (X))}n≥4 satisﬁes the linear recurrence
(5.15) with initial conditions 4, 4,−4. Solving the corresponding characteristic equation, using the initial
conditions and simpliﬁcation yield

(5.27)

S(σn,3 + F (X)) =



−22m−3(cid:0)22m + (−1)m12(cid:1)
−22m−2(cid:0)22m + (−1)m8(cid:1)
−22m−1(cid:0)22m + (−1)m2(cid:1)
−22m(cid:0)22m − (−1)m2(cid:1)

if n = 4m
if n = 4m + 1
if n = 4m + 2
if n = 4m + 3.

Thus, the sequence {S(σn,3 +F (X))}n≥4 avoids a prime p if and only if p does not divide any of the following
numbers

(5.28)

22m + (−1)m12, 22m + (−1)m8, 22m + (−1)m2, 22m − (−1)m2

for every positive integer m.

MODULAR PERIODICITY OF EXPONENTIAL SUMS OF SYMMETRIC BOOLEAN FUNCTIONS

17

The proof now follows the path of less resistance. Recall that

p

(cid:18) 2
(cid:18)−2
(cid:18) 3
(cid:18)−3

p

p

(cid:19)
(cid:19)
(cid:19)
(cid:19)

p

=

=

=

=

(cid:40)
(cid:40)
(cid:40)
(cid:40)

1
−1

1
−1

1
−1

1
−1

if p ≡ 1, 7, 17, 23 mod 24
if p ≡ 5, 11, 13, 19 mod 24
if p ≡ 1, 11, 17, 19 mod 24
if p ≡ 5, 7, 13, 23 mod 24
if p ≡ 1, 11, 13, 23 mod 24
if p ≡ 5, 7, 17, 19 mod 24
if p ≡ 1, 7, 13, 19 mod 24
if p ≡ 5, 11, 17, 23 mod 24.

Therefore, if p ≡ 5 mod 24, then ±2,±3 are quadratic non-residues. This implies that p does not divide
any of the numbers in (5.28). Since

(5.29)

then the result follows.

δ({p prime| p ≡ 5 mod 24}) =

1

ϕ(24)

=

1
8

,

(cid:3)

The cases of degree 4 and beyond have not been studied in detail. However, experimentations lead the
authors to believe that they are harder to tackle (as expected). As an example, consider the perturbation
σn,4 + F (X) where F (X) = X1X2. The set Av(4; F (X)) appears to be inﬁnite.
In fact, it looks like it
contains an inﬁnite amount of primes of the form 8q + 1. For instance, the following primes, which are of
the form 8q + 1, are members of Av(4; F (X)) :

17, 73, 89, 97, 113, 193, 233, 241, 257, 281, 337, 401, 433, 449.

At the moment of writing this manuscript, the authors did not see any pattern on them.

This section gave some insights of the set Av(k1,··· , ks). This set is important from the Boolean functions
point of view. In the literature, however, it is common to study the set of primes that divide some term of
an integer sequence, in other words, the complement of Av(k1,··· , ks). Because of this, a short study for
the set P (k1,··· , ks) is presented in the next section.

6. The set P (k1,··· , ks)

This work ﬁnishes with a study of set P (k1,··· , ks), i.e. the set of primes that divide some term of the
sequence {S(σn,[k1,··· ,ks])}. It has been stated that P´olya’s result does not guarantee that P (k1,··· , ks) is
inﬁnite. In fact, Theorem 5.6 shows that for some perturbations of the form σn,2 + F (X), the set of primes
that divide some term of the sequence {S(σn,2 + F (X))} is ﬁnite. The reality is, however, that at least for
elementary symmetric Boolean functions this set is inﬁnite. The idea behind the approach to prove this
claim is very simple: to identify the odd primes p with the property that p|S(σp,[k1,··· ,ks]), i.e. odd primes
p that divide the p-th term of the sequence (it is not hard to see that 2 always divides S(σ2,[k1,··· ,ks]) and
so only odd primes are of interest). For a general integer sequence, this might not be an easy task, however
the representation of S(σn,[k1,··· ,ks]) as the binomial sum

(6.1)

S(σn,[k1,··· ,ks]) =

(−1)( j

k1)+···+( j
ks)

simpliﬁes the eﬀorts. Indeed, if n = p is an odd prime, then
(−1)( j

(6.2)

Since p|(cid:0)p

j

(cid:1) for every 1 ≤ j ≤ p− 1, then it is clear that p|S(σp,[k1,··· ,ks]) if and only if (−1)( p

S(σp,[k1,··· ,ks]) =

j=0

j

.

k1)+···+( j
ks)

It is a known that the sequence

(cid:26)(cid:18) j

(cid:19)

k1

(cid:18) j

(cid:19)

ks

+ ··· +

(cid:27)

mod 2

j≥0

k1)+···+( p

k1) = −1.

n(cid:88)
p(cid:88)

j=0

(cid:18)n
(cid:19)
(cid:18)p
(cid:19)

j

18

FRANCIS N. CASTRO AND LUIS A. MEDINA

is periodic. To be speciﬁc, if r = (cid:98)log2(ks)(cid:99) + 1, then

(cid:18)j + m · 2r

(cid:19)

(cid:18)j + m · 2r

(cid:19)

(cid:18) j

(cid:19)

≡

(cid:18) j

(cid:19)

+ ··· +

(6.3)

for every integer m. Let j1,··· , jt be all integers in {0, 1,··· , 2r − 1} with the property that(cid:0) j

is odd. Assume for the moment that at least one of j1,··· , jt is an odd integer, say jo is such number. Every
integer of the form jo + m · 2r satisﬁes

(cid:1) +··· +(cid:0) j

mod 2

(cid:1)

k1

k1

ks

ks

k1

ks

+ ··· +

(−1)(jo+m·2r

)+···+(jo+m·2r

) = −1,

k1

(6.4)
and the classical result of Dirichlet implies that there are an inﬁnite amount of primes of the form jo + m· 2r.
Of course, if every integer in j1,··· , jt is even, then every odd prime p satisﬁes p (cid:45) S(σp,[k1,··· ,ks]) because
S(σp,[k1,··· ,ks]) ≡ 2 mod p. This information is summarized in the following results.
Theorem 6.1. Let 1 ≤ k1 < ··· < ks be integers. Let j1,··· , jt be all integers in {0, 1,··· , 2r − 1} with the
property that

ks

(cid:18) j

(cid:19)

k1

(cid:18) j

(cid:19)

ks

+ ··· +

is odd. Then, there is at least one odd prime p such that p|S(σp,[k1,··· ,ks]) if and only if at least one of the
integers j1,··· , jt is odd. Moreover, if jo1,··· , jof are the odd integers in j1,··· , jt, then the odd primes p
with the property p|S(σp,[k1,··· ,ks]) are precisely the primes in the arithmetic progressions

jo1 + m · 2r,··· , jof + m · 2r,

where r = (cid:98)log2(ks)(cid:99) + 1.
(cid:3)
Proof. This is a direct consequence of the previous discussion.
Corollary 6.2. Let 1 ≤ k1 < ··· < ks be integers. Let j1,··· , jt be all integers in {0, 1,··· , 2r − 1} with the
property that

(cid:18) j

(cid:19)

k1

+ ··· +

(cid:18) j

(cid:19)

ks

b(k1,··· , ks)
2(cid:98)log2(ks)(cid:99)

is odd. Let b(k1,··· , ks) the number of odd integers in j1,··· , jt and assume that b(k1,··· , ks) > 0. Then
P (k1,··· , ks) is an inﬁnite set because it contains a subset of density

within the set of primes.

Proof. This is a consequence of the statement of Theorem 6.1 and the classical result of Dirichlet.

(cid:3)

In the case of the elementary symmetric Boolean function of degree k, the set P (k) is inﬁnite.

Corollary 6.3. Suppose that k is a natural number. The set P (k) is inﬁnite.
Proof. The statement is clearly true if k is a power of 2, therefore suppose that k (cid:54)= 2l for some integer l.
The idea is to identify the set of primes in Theorem 6.1 for such k.

Let k = 2a1 + ··· + 2ae be the 2-adic expansion of k. Lucas’ Theorem implies that j is such that(cid:0)j

(cid:1) is

k

odd if and only if

(6.5)

j = k +

(cid:88)

δi2i

2i /∈{2a1 ,··· ,2ae}

where δi ∈ {0, 1}. By Theorem 6.1, one must identify the odd j’s of the form (6.5) that lie in the set
{1, 2, 3,··· , 2r − 1}, where r = (cid:98)log2(k)(cid:99) + 1. If k is odd, it is not hard to see that there are 2r−w2(k) of
such j, where w2(n) represents the sum of the binary digits of n. If k is even, then the total is 2r−w2(k+1).
In either case, the set P (k) is inﬁnite. Moreover, making the transformation ¯k = 2(cid:98)k/2(cid:99) + 1, one sees that
(cid:3)
P (k) is inﬁnite because it contains a subset of density 1/2w2(¯k)−1 within the set of primes.

MODULAR PERIODICITY OF EXPONENTIAL SUMS OF SYMMETRIC BOOLEAN FUNCTIONS

19

Example 6.4. Consider the case k1 = 3, k2 = 4, k3 = 7 and k4 = 9. The integers j’s in {1, 2,··· , 15} for
which

(6.6)

+

+

(cid:18)j

(cid:19)

3

(cid:18)j

(cid:19)

4

(cid:18)j

(cid:19)

7

(cid:18)j

(cid:19)

9

+

is odd are 3, 4, 5, 6, 7, 9, 12, and 14. Theorem 6.1 implies that all primes p in the arithmetic progressions

satisfy p|S(p, [3, 4, 7, 9]). Therefore, P (3, 4, 7, 9) is inﬁnite because it contains a subset of density

3 + 16m, 5 + 16m, 7 + 16m, 9 + 16m

4/2(cid:98)log2(9)(cid:99) = 4/8 = 1/2

within the set of all primes.

(6.7)

(cid:19)

Theorem 6.1 identiﬁes the condition on the degrees k1,··· , ks for the existence of odd primes p with the
property p|S(p, [k1,··· , ks]). A natural question to consider is to identify the symmetric Boolean functions
for which Theorem 6.1 fails to apply. These are symmetric Boolean functions σn,[k1,··· ,ks] with the property
that every integer j for which

is very simple to explain. Lucas’ Theorem implies that every time (cid:0)j
(cid:0)j
(cid:1) +(cid:0)j

(cid:1) is odd precisely when(cid:0)j

k1

ks

(cid:18) j

(cid:19)
(cid:18) j
(cid:1). This means that
(cid:1) is even, but this occurs when j = 4 + 8m or j = 6 + 8m
(cid:1) is odd and(cid:0)j

(cid:1) is odd, so is (cid:0)j

+ ··· +

is odd is an even integer. An example of such Boolean function is σn,[4,5] and the reason the theorem fails

5

5

4

4
for m non-negative integer. The same argument applies to σn,[2,3], σn,[6,7] and every Boolean function of the
form σn,[2l,2l+1]. Also, any combination of them have the same property, for example, p (cid:45) S(σp,[2,3,6,7]) for
every odd prime. The reader can convince himself/herself that Theorem 6.1 does not apply to a symmetric
Boolean function if and only if it is a combination of terms of the form σn,[2l,2l+1].
Theorem 6.1 provides a suﬃcient condition for P (k1,··· , ks) to be inﬁnite and the above discussion char-
acterizes all symmetric Boolean functions for which Theorem 6.1 fails to apply. The amount of these “bad”
symmetric Boolean functions increases exponentially as the degree grows. To be speciﬁc, if all symmetric
Boolean functions of degree ks ≤ M are considered, then 2(cid:98)(M−1)/2(cid:99) − 1 of them are such that Theorem
6.1 fails to apply. However, it is also true that this number is exponentially smaller than the total amount
of all symmetric Boolean functions of degree less than or equal to M . For example, consider all symmetric
Boolean functions of degree less than or equal to 15. There is a total of 32767 of such Boolean functions,
but only 127 of them are such that p (cid:45) S(σp,[k1,··· ,ks]) for every odd prime p. Note that

5

4

1 − 127
32767

≈ 0.9961241493,

(6.8)
which means that Theorem 6.1 can be used to identify P (k1,··· , ks) as an inﬁnite set for 99.61% of them.
Of course, the other 0.39% of the sets P (k1,··· , ks) may still be inﬁnite. For example, consider the case of
σn,[3,2]. By Theorem 6.1, p (cid:45) S(σp,[3,2]) for every odd prime p, yet the set P (3, 2) is inﬁnite. The reason for
this is that p ∈ Av(3, 2) if and only if ordp(4) ≡ 2 mod 4. However, if p ≡ 3 mod 4, then ordp(4) is odd
and so p ∈ P (3, 2), which clearly implies that P (3, 2) is an inﬁnite set.

Acknowledgments. The authors would like to thank Professor Thomas W. Cusick for reading a previous
version of this article. His comments and suggestions improve the presentation of this work. The second
author acknowledges the partial support of upr-ﬁpi 1890015.00.

References

[1] A. Adolphson and S. Sperber. p-adic Estimates for Exponential Sums and the of Chevalley-Warning. Ann. Sci. Ec. Norm.

Super., 4e s´erie, 20, 545-556, 1987.

[2] J. Ax. Zeros of polynomials over ﬁnite ﬁelds. Amer. J. Math., 86, 255-261, 1964.
[3] J. Cai, F. Green and T. Thierauf. On the correlation of symmetric functions. Math. Systems Theory, 29, 245258, 1996.
[4] A. Canteaut and M. Videau. Symmetric Boolean Functions IEEE Transactions on Information Theory, 51, 2791-2807,

2005.

[5] F. Castro, O. Gonz´alez and L. A. Medina. A divisibility approach to the open boundary cases of Cusick-Li-Stˇanicˇa’s

conjecture. Cryptography and Communications, 7(4), 379-402, 2015.

20

FRANCIS N. CASTRO AND LUIS A. MEDINA

[6] F. Castro and L. A. Medina. Linear Recurrences and Asymptotic Behavior of Exponential Sums of Symmetric Boolean

Functions. Elec. J. Combinatorics, 18:#P8, 2011.

[7] F. Castro and L. A. Medina. Asymptotic Behavior of Perturbations of Symmetric Functions. Annals of Combinatorics,

18:397-417, 2014.

[8] T. W. Cusick, Y. Li. k-th order symmetric SAC Boolean functions and bisecting binomial coeﬃcients Discrete Appl. Math.,

149, 73?86, 2005.

[9] T. W. Cusick, Yuan Li, and P. Stˇanicˇa. Balanced Symmetric Functions over GF (p). IEEE Trans. on Information Theory

5, 1304-1307, 2008.

[10] T. W. Cusick, Yuan Li and P. Stˇanicˇa. On a conjecture for balanced symmetric Boolean functions J. Math. Crypt., 3,
[11] H. H. Hasse. Uber die Dichte der Primzahlen p, f ur die eine vorgegebene ganzrationale Zahl a (cid:54)= 0 von gerader bze.

1-18, 2009.

ugerader Ordung mod p ist. Math. Annalen, 168, 19–23, 1966.

[12] G-P. Gao, W-F Liu and X-Y. Zhang. The degree of balanced elementary symmetric Boolean functions of 4k + 3 variables.

IEEE Trans. Inf. Theory 57, 4822-4825, 2011.

[13] Y. Guo, G. Gao, Y. Zhao. Recent Results on Balanced Symmetric Boolean Functions. IEEE Trans. Inf. Theory, 2015,

DOI: 10.1109/TIT.2015.2455052.

[14] N. Jeﬀeries Sporadic partitions of binomial coeﬃcients. Electr. Lett., 27, 1334?1336, 1991.
[15] S. Lawrence. The divisibility properties of primary Lucas recurrences with respect to primes. The Fibonacci Quarterly,

18.4:316–334, 1980.

[16] E. Lucas Th`eorie des functions num`eriques simplement p`eriodiques. American Journal of Mathematics, 1::184–240, 1978
[17] R. J. Mcintosh and E. L. Roettger. A search for Fibonacci-Wieferich and Wolstenholme primes. Math. Comp., 76:2087–2094,

2007.

[18] C. Mitchell. Enumerating Boolean functions of cryptographic signiﬁcance. J. Cryptology, 2 (3), 155170, 1990.
[19] O. Moreno and F. Castro. Divisibility properties for covering radius of certain cyclic codes. IEEE Trans. Inform. Theory

49, no. 12, 3299-3303, 2003.

[20] O. Moreno and C. J. Moreno. Improvement of the Chevalley-Warning and the Ax-Katz theorems. Amer. J. Math. 117,

241-244, 1995.

[21] O. Moreno and C. J. Moreno. The MacWilliams-Sloane Conjecture on the Tightness of the Carlitz-Uchiyama Bound and

the Weights of Dual of BCH Codes. IEEE Trans. Inform. Theory 40, 1894-1907, 1994.

[22] O. Moreno, K. Shum, F. N. Castro and P.V. Kumar. Tight Bounds for Chevalley-Warning-Ax Type Estimates, with

Improved Applications. Proc. of the London Mathematical Society, 88, 545-564, 2004.

[23] D. W. Robinson. A Note on Linear Recurrent Sequences Modulo m. The American Mathematical Monthly, 73 (6): 619–621,

1966.

[24] D. W. Robinson. The Fibonacci Matrix Modulo m. The Fibonacci Quarterly, 1: 29–36, 1963.
[25] Wei Su, Xiaohu Tang, Alexander Pott. A Note on a Conjecture for Balanced Elementary Symmetric Boolean Functions.

IEEE Transactions on Information Theory 59, 665-671, 2013.

[26] Z. H. Sun and Z. W. Sun. Fibonacci numbers and Fermat’s last theorem. Acta Arith., 60(4):371–388, 1992.
[27] A. Vince. Period of a linear recurrence. Acta Arith., 39(4):303–311, 1981.
[28] D. D. Wall. Fibonacci series modulo m. Amer. Math. Monthly, 67:525–532, 1960.

MODULAR PERIODICITY OF EXPONENTIAL SUMS OF SYMMETRIC BOOLEAN FUNCTIONS

21

Appendix A. Table containing p(k) for 5 ≤ k ≤ 263

k

p(k)

k

p(k)

k

p(k)

k

p(k)

k

p(k)

k

p(k)

k

p(k)

k

p(k)

k

p(k)

k

p(k)

k

p(k)

k

p(k)

k

p(k)

k

p(k)

k

p(k)

k

p(k)

k

p(k)

k

p(k)

k

p(k)

k

p(k)

k

p(k)

k

p(k)

k

p(k)

6
5
41
17
19
18
97
97
30
29
97
97
42
41
769
449
53
52
193
449
65
63
1153
193
76
75
257
1409
87
86
3329
257
98
97
769
769
109
108
3329
257
120
119
257
641
132
131
769
257
143
142
257
257
154
153
257
7681
165
164
7937
257
176
175
7937
257
187
186
257
257
197
198
7937 10753
209
208
3329
257
220
219
257
257
231
230
257
257
242
241
7937
769
253
252
257
257

7
73
20
97
31
97
43
257
54
193
66
257
77
641
88
2689
99
257
110
257
121
257
133
3329
144
257
155
257
166
3329
177
3329
188
257
199
257
210
257
221
257
232
257
243
257
254
257

9
97
21
449
33
449
44
193
55
193
67
769
78
257
89
2689
100
769
111
257
122
257
134
3329
145
7681
156
257
167
257
178
257
189
257
200
257
211
257
222
257
233
257
244
257
255
257

10
17
22
257
34
193
45
449
56
257
68
641
79
257
90
641
101
641
112
257
123
769
135
257
146
257
157
257
168
769
179
257
190
257
201
769
212
257
223
257
234
257
245
257
257
7681

11
17
23
97
35
1409
46
257
57
449
69
257
80
257
91
257
102
1153
113
641
124
257
136
7681
147
257
158
257
169
257
180
257
191
257
202
257
213
257
224
257
235
257
246
257
258
7681

12
17
24
97
36
193
47
193
58
257
70
769
81
641
92
257
103
257
114
3329
125
1153
137
7937
148
7937
159
257
170
257
181
257
192
257
203
257
214
257
225
3329
236
257
247
257
259
7681

15
13
17
17
27
25
193
97
39
37
257
193
50
48
193
193
61
59
449
257
73
71
641
641
84
82
257
257
95
93
257
257
106
104
769
1153
117
115
641
257
129
126
769
257
140
138
3329
257
151
149
257
257
162
160
9473
257
173
171
257
257
184
182
257
257
195
193
257
769
206
204
257
257
217
215
257
9473
228
226
257
257
239
237
257
257
250
248
257
257
260
262
15361 19457 7681

14
17
26
97
38
193
49
193
60
257
72
257
83
641
94
257
105
257
116
257
127
641
139
257
150
3329
161
3329
172
257
183
769
194
257
205
257
216
257
227
257
238
257
249
257
261

17
1601
28
257
40
193
51
257
62
641
74
769
85
257
96
257
107
641
118
257
130
769
141
769
152
257
163
769
174
257
185
257
196
257
207
257
218
257
229
769
240
257
251
257
263
10753

Department of Mathematics, University of Puerto Rico, San Juan, PR 00931
E-mail address: franciscastr@gmail.com

Department of Mathematics, University of Puerto Rico, San Juan, PR 00931
E-mail address: luis.medina17@upr.edu

