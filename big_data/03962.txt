6
1
0
2

 
r
a

 

M
2
1

 
 
]
h
p
-
t
n
a
u
q
[
 
 

1
v
2
6
9
3
0

.

3
0
6
1
:
v
i
X
r
a

Quantum Dynamics in Phase Space using Projected

von Neumann Bases

Shai Machnesa,∗, Elie Assémata, Henrik R. Larssonb, David Tannora

aDept. of Chemical Physics, Weizmann Institute of Science, 76100 Rehovot, Israel

bInstitut für Physikalische Chemie, Christian-Albrechts-Universität zu Kiel,

Olshausenstraße 40, D-24098 Kiel, Germany

Abstract

We describe the mathematical underpinnings of the biorthogonal von Neu-
mann method for quantum mechanical simulations (PvB). In particular, we
present a detailed discussion of the important issue of non-orthogonal pro-
jection onto subspaces of biorthogonal bases, and how this diﬀers from or-
thogonal projection. We present various representations of the Schrödinger
equation in the reduced basis and discuss their relative merits. We conclude
with illustrative examples and a discussion of the outlook and challenges
ahead for the PvB representation.

∗Corresponding author, shai.machnes@gmail.com

Contents

1 Introduction

2 A Review of PvB

2.1 The Fourier grid . . . . . . . . . . . . . . . . . . . . . . . . . .
2.2 The von Neumann lattice and its projection onto the Fourier
grid (PvN) . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
. . . . . . . . . . . . . . . . . . . . . . . .

6
2.3 Biorthogonal bases
7
2.4 PvB - A sparse representation in the basis biorthogonal to PvN 9
2.5 The Schrödinger equation in PvB . . . . . . . . . . . . . . . .
9

3 The reduced Hilbert space

3.1 Deﬁning the reduced Hilbert space, (cid:101)H . . . . . . . . . . . . . . 11
3.2 Biorthogonal bases for (cid:101)H . . . . . . . . . . . . . . . . . . . . . 12
3.3 Projecting into (cid:101)H . . . . . . . . . . . . . . . . . . . . . . . . . 16
3.4 Projecting into the subspace spanned by Gaussians, ˇH . . . . 20

4 The Hamiltonian and the Schrödinger equation for the re-

3

4
5

10

23

duced state

4.1 The equation of motion in the (cid:101)H subspace . . . . . . . . . . . 23
4.2 Alternatives to the (cid:101)H-projected equations of motion . . . . . . 25

4.3 The equation of motion in hybrid subspaces
. . . . . . . . . . 27
4.4 Comparing the accuracy of the dynamical formulations . . . . 28

5 Examples

30
1D Morse Oscillator . . . . . . . . . . . . . . . . . . . . . . . . 30
2D Coupled Harmonic Oscillator
. . . . . . . . . . . . . . . . 31
2D Double Well Dynamics . . . . . . . . . . . . . . . . . . . . 33

5.1
5.2
5.3

6 Conclusions and outlook

35

2

1. Introduction

The quantum dynamics of many physical systems involves multiparticle con-
tinuua. Examples range from ionization and high harmonic generation in
multielectron atoms to molecular processes such as photodissociation and
chemical reactions of polyatomics. The large Hilbert space of these systems
makes full simulations extremely challenging. It is therefore of great interest
to ﬁnd a compact representation for quantum dynamics in the continuum
where accuracy can be easily controlled.
An attractive option is to represent states as phase space objects, so that
only those areas of phase space that are actually occupied are needed for
the calculation. The most commonly used phase space representation, the
Wigner representation, has proven to be expensive computationally, although
there has been some recent progress [1]. An alternative is the Husimi rep-
resentation, although this too is awkward for direct numerical calculations
[2].
A third option for a phase space representation is the von Neumann lattice
[3, 4]. This representation consists of a discrete lattice of phase space Gaus-
sians, one per each cell of area hD where h is Planck’s constant and D is the
number of degrees of freedom. Initial work using this representation found
it to be poorly convergent [5]. About ten years ago, Poirier and coworkers
[6, 7] found a way to converge the method and have applied it recently to
several challenging applications [8, 9]. Independently, a few years later, our
group discovered a diﬀerent way to converge the von Neumann lattice, based
on modifying the Gaussians to be periodic and band-limited [10, 11, 12]. We
named the method PvN, Periodic von Neumann. The PvN basis is guaran-
teed to have exactly the same accuracy as a discrete Fourier representation
[13, 14, 15, 16], while having the ﬂexibility of a Gaussian basis set.
Since the PvN basis is non-orthogonal, a key aspect of the mathematical for-
mulation involves the concept of biorthogonal bases. We deﬁne the Biorthog-
onal von Neumann (BvN) basis as the basis biorthogonal to PvN. Since a
crucial part of our method is to exchange the roles of the PvN and BvN
bases we refer to the method more generally as Periodic von Neumann with
Biorthogonal exchange or PvB. In this work we further develop the math-
ematical underpinnings of the PvB method.
In particular, we derive new
relations for the reduced Hilbert space associated with non-orthogonal bases

3

when projecting down from the full Hilbert space. Furthermore, we analyze
the possible forms of the Schrödinger equation in the reduced basis. These
developments become crucial when applying the methodology to more chal-
lenging systems, such as the helium atom in strong ﬁelds[17].
The paper is organized as follows. In Section 2 we present a brief review of
the PvB approach as applied to the full Hilbert space. We begin by clarify-
ing the underlying Hilbert space spanned by the Fourier grid method. We
then deﬁne the von Neumann lattice of Gaussians. By projecting the von
Neumann basis onto the Hilbert space spanned by the Fourier grid we gen-
erate the Periodic von Neumann (PvN) basis (Section 2.2). Since the PvN
basis is non-orthogonal we can deﬁne the basis that is biorthogonal (Sec-
tion 2.3). In Section (2.4) we show that the role of the PvN basis and the
biorthogonal basis must be exchanged to obtain a sparse representation. We
conclude Section 2 with a discussion of the possible forms of the Schrödinger
equation in the PvB representation. Having established the formalism on the
full Hilbert space, we turn to the representation on a reduced space. Section
3 introduces the reduced PvB method, allowing one to represent only those
regions of phase space actually occupied by the current state. We then deﬁne
the biorthogonal bases for the reduced subspace (Section 3.2) and analyze
the projection into the reduced subspace (Section 3.3), highlighting the dif-
ferences between orthogonal and non-orthogonal projections. In Section 4 we
derive the various forms of the Schrödinger equation in the reduced represen-
tations and discuss approximations and performance considerations. Section
5 gives some illustrative examples and Section 6 gives an outlook and some
ideas for future work.

2. A Review of PvB

The PvB representation, developed in[10, 11, 12], projects the von Neumann
lattice of Gaussians (Section 2.2) onto the subspace spanned by the Fourier
grid (Section 2.1). As the projected Gaussians form a non-orthogonal ba-
sis, we deﬁne the basis biorthogonal to the projected Gaussians (Section
2.3). Together these building blocks deﬁne the PvB representation (Section
2.4). We then present several alternative but equivalent formulations of the
Schrödinger equation in the PvB representation (Section 2.5).

4

2.1. The Fourier grid

The pseudospectral Fourier method[16, 18, 19] (also known as the periodic
sinc DVR (Discrete Variable Representation[20])) is the underlying Hilbert
space on which we construct the PvB method. A comprehensive exposition
can be found in [21].
Functions with support on a ﬁnite segment x ∈ [0, L] may be assumed,
without loss of generality, to be cyclic, and reside in a Hilbert space spanned
by

ϕn (x) =

1
√L

exp(cid:16)2πi

x
L

1
√L

exp (iknx) , ∀n ∈ Z, kn =

2π
L

n.

(1)

n(cid:17) =
´

L

n=1 (cid:104)ϕn, f(cid:105) ϕn (x), allowing us to

Limiting bandwidth to K implies n ∈ [−nmax + 1, . . . , nmax] where nmax :=
(cid:4) KL
2π(cid:5) . This deﬁnes a rectangular area of phase space of area 2KL which
n=1, with N = 2nmax. With an inner
is spanned by the spectral basis, {ϕn}N
0 f∗ (x) g (x) dx this constitutes the Fourier
product deﬁned as (cid:104)f, g(cid:105) :=
grid (FG) Hilbert space, H.
Any f ∈ H can be expanded as f (x) =(cid:80)N
represent f as a column vector of the expansion coeﬃcients, (cid:126)fϕ := ((cid:104)ϕ1, f(cid:105) ,(cid:104)ϕ2, f(cid:105) , . . .(cid:104)ϕN , f(cid:105))T .
We shall drop the basis designation when implied by context.
Deﬁne the Fourier grid points, or sampling points, as the set of N equidistant
N(cid:9)N−1
points(cid:8)xj = x0 + L j
j=0 with x0 ∈(cid:2)0, L
of H as the set of pseudo-spectral functions Θ = {θm (x)}N
for f (x) ∈ H, f (x) =(cid:80)N
sampling vector, (cid:126)f = (cid:126)fθ =
(f (x1) , f (x2) . . . , f (xN ))T .
By expanding the spectral basis functions in the pseudo-spectral basis, one
may derive the explicit form of the latter, θm (x) = 1
eiπ x−xm

N(cid:3). Deﬁne the pseudo-spectral basis
m=1 ∈ H such that
m=1 f (xm) θm (x). f may now be represented by its

n=−nmax+1 exp (ikn (x − xm)) =

[11, Supplementary Material 1].

, with α := 2π x−xm

L

N(cid:80)nmax

L

sin(N α
2 )
N sin( α
2 )

These are periodic sinc functions, which are localized around xm with θm (xn) =
δmn. The pseudo-spectral basis functions satisfy the normalization condition
(cid:104)θn, θm(cid:105) = N
Thus, functions in H may be represented in the pseudo-spectral basis by

L δnm [23].

5

their sampling vector. Unlike the spectral basis representation, this does not
require integration to compute the coeﬃcients. The existence of the pseudo-
spectral basis, allowing reconstruction of a function from sampled values, is
equivalent to the Shannon-Nyquist theorem for band-limited functions.
The projector into the FG Hilbert space is

P :=

L
N

N(cid:88)m=1|θm(cid:105)(cid:104)θm| =

N(cid:88)n=1 |ϕn(cid:105)(cid:104)ϕn| .

(2)

When f (x) /∈ H, the projector P minimizes the distance to the projected
state, and consequently maximizes the overlap, i.e. (cid:104)f,Pf(cid:105) /(cid:107)Pf(cid:107) ≥ (cid:104)f, g(cid:105) /(cid:107)g(cid:107) ∀g ∈
H (see[24]). The pseudo-spectral functions are the projection of the sampling
functions into H, i.e. Pδ (x − xm) = θm (x). Deﬁning the collocation or sam-
pling pseudo-projection,

Qf (x) :=

N(cid:88)m=1

f (xm) θm (x) ,

(3)

generally Qf (cid:54)= Pf, unless f ∈ H. For functions that are almost within
H, one may opt to accept the easy-to-compute Q as an approximation of P,
which requires costly integration.
Note that H and the associated pseudo-spectral functions are just one possi-
ble choice for the phase space underlying PvB. See [25, 26, 27] for alternative
possibilities.

2.2. The von Neumann lattice and its projection onto the Fourier grid (PvN)

Consider a lattice of Gaussians in the (x, p) plane. Let (¯xi, ¯pi) indicate the
center of Gaussian no. i, and let (∆x, ∆p) be the spacing between the lattice
sites, with ∆x

. We deﬁne

∆p = σx
σp

g¯xi,¯pi(x) =(cid:18) 1

2πσ2

x(cid:19)1/4

exp(cid:32)−(cid:18) x − ¯xi
2σx (cid:19)2

i

 ¯pi(x − ¯xi)(cid:33) .

+

(4)

If the lattice spans the inﬁnite plane in the x-p phase space it is known as
the von Neumann lattice [3, 28, 4]. However, in any real calculation the

6

lattice must be truncated to a ﬁnite domain Nx × Np = N. This leads to a
lack of convergence, as discovered independently in the context of quantum
mechanics[5] and the time-frequency analog in signal processing [29]. How-
ever, if one projects the von Neumann lattice onto the FG basis one builds
in periodic boundary conditions and obtains the same convergence as for the
FG.
Deﬁne a cyclic formulation of the Gaussians,

L(cid:107) ,
modLx := x − L(cid:106) x

gmod
¯xi,¯pi

(x) := (Qg0,0(modL (x − ¯xi)) e

i ¯pi modL(x−¯xi).
(5)
The cyclic projected Gaussians, known as the Periodic von Neumann or PvN
basis, constitute a periodic Gabor basis, where all basis functions are related
to each other by shifts in x and p [30]. For the conditioning of the overlap
matrices (eq. 11) it is beneﬁcial to choose the von Neumann lattice points
such that ¯xi are a subset of the FG sample points and ¯pi are a subset of the
spectral basis frequencies.
The representation of the PvN basis functions in the θ basis is given by

Gjk := gmod
¯xk,¯pk

(xj).

(6)

The FG deﬁnes an area of (2K) L = 2πN in phase space. Therefore one may
intuitively assign a phase space area of 2π to each of the N Gaussians of the
PvN basis, and consider them “phase space pixels”. Deﬁning P := K, each
such pixel covers a phase space area of 2π = h.

2.3. Biorthogonal bases

In this section we consider the general theory of non-orthogonal bases and
their biorthogonal bases. In the next section we will specialize to the periodic
von Neumann basis and its biorthogonal basis. In anticipation of that section,
we use the notation G and B here.
k=1 in H may serve
Any set of N linearly independent vectors G = {|gk(cid:105)}N
as a non orthogonal basis of H. Let G be represented in the Θ orthogonal
basis of H by the invertible matrix G. Let B be a similarly deﬁned non-
orthogonal basis of H, represented in Θ by B. The bases G and B are

7

considered biorthogonal bases (a reciprocal relationship) if

(cid:104)bj| gk(cid:105) = δjk ⇐⇒ B†G = 1N .

(7)

The relation is reciprocal, i.e.

(cid:104)gj| bk(cid:105) = δjk ⇐⇒ G†B = 1N .

(8)
If, and only if, G is orthogonal, then so is B and G = B. According to
eq. 8, the rows of G† represent the bra states {(cid:104)gk|}, while the columns of
B represent the ket states. The representation in the B basis of any state
|ψ(cid:105) ∈ H associated with the sampling vector (cid:126)ψ is
(cid:126)ψB := B−1 (cid:126)ψ = G† (cid:126)ψ,

(9)

with the elements ψB denoting the overlaps (cid:104)gk| ψ(cid:105).
The completeness relation for H is

BG† = GB† = 1N

⇐⇒

P =

N(cid:88)j=1 |bj(cid:105)(cid:104)gj| =

N(cid:88)j=1 |gj(cid:105)(cid:104)bj| .

(10)

By construction, the projector in eq. 10 spans the full FG Hilbert space, and
therefore is equal to the projectors in eq. 2.
We deﬁne the overlap matrices of the G and B bases,respectively:

S := G†G,

S−1 = B†B.

From these relations it follows that

G = BS,
B = GS−1,

(cid:126)ψB = S (cid:126)ψG,
(cid:126)ψG = S−1 (cid:126)ψB.

(11)

(12)

Norms of vectors in B and G are computed via (cid:107)ψG(cid:107)2 = (cid:126)ψ†
(cid:107)ψB(cid:107)2 = (cid:126)ψ†
normalized.

GS (cid:126)ψG and
BS−1 (cid:126)ψB. Note that the G and B bases cannot be independently

8

2.4. PvB - A sparse representation in the basis biorthogonal to PvN

Many wavefunctions of interest, whether bound states or traveling wavepack-
ets, are fairly well-localized in phase space. Therefore a representation whose
coeﬃcients are βk = (cid:104)gk| ψ(cid:105), is expected to be sparse, i.e. to have many near-
zero elements.
Consider a Fourier grid Hilbert space H. Using eq. 10, any state |ψ(cid:105) ∈ H
can be represented as

|ψ(cid:105) =(cid:32) N(cid:88)j=1 |gj(cid:105)(cid:104)bj|(cid:33)|ψ(cid:105) =

N(cid:88)j=1 (cid:104)bj| ψ(cid:105)|gj(cid:105).

(13)

We shall use the term PvN to denote this representation. Alternatively, any
state in H can be represented as

|ψ(cid:105) =(cid:32) N(cid:88)j=1 |bj(cid:105)(cid:104)gj|(cid:33)|ψ(cid:105) =

N(cid:88)j=1 (cid:104)gj| ψ(cid:105)|bj(cid:105).

(14)

This deﬁnes the biorthogonal von Neumann representation, PvB.
Note that while the (cid:104)g| states are highly localized in phase space, the |b(cid:105)
states are highly delocalized. As a result, the PvB representation is sparse,
while the PvN representation is not. The PvB and PvN bases both span
H and therefore these representations contain exactly the same information.
From this point onward, we shall assume all states are in H, and default to
the pseudo-spectral representation unless otherwise noted. We will also drop
the explicit vector notation for states.

2.5. The Schrödinger equation in PvB

We now turn to the form of the time independent and time dependent
Schrödinger equations (TISE and TDSE, respectively) in the PvB basis.
Starting from the TISE, Hψ = λψ, where λ is the energy, and using eqs.
8 and 9, gives

(cid:0)G†HB(cid:1) ψB = λψB.

9

(15)

Similarly, the TDSE ∂tψ = − i

 Hψ takes the form:

∂tψB = −

i

(cid:0)G†HB(cid:1) ψB.

The term G†HB = B−1HB is a similarity transformation of H and therefore
all eigenvalues are real and all evolutions are unitary. One can make Her-
miticity in eq. 15 explicit by multiplying it from the left by B†B and using
eq. 10, which transforms it into a generalized eigenvalue problem,

(16)

(17)

(cid:0)B†HB(cid:1) ψB =(cid:0)B†B(cid:1) λψB.

One may rewrite the TDSE in four distinct ways, all strictly equivalent. We
denote a Hamiltonian taking a state in basis X and returning a state in basis
Y by HY X,

G†HB = B−1HB =: HBB
B†HB = G−1HB =: HGB
G†HG = B−1HG =: HBG
B†HG = G−1HG =: HGG

− i
−→ ∂tψB =
 HBB ψB ,
− i
−→ ∂tψB =
 S HGB ψB ,
 HBG S−1 ψB ,
−→ ∂tψB = − i
 S HGG S−1 ψB .
−→ ∂tψB = − i

(18)
Although the forms are mathematically equivalent, they require diﬀerent
computational eﬀorts. HBG = G†HG is quick to compute as the integrations
on both sides are with the highly-local Gaussians. This is counter-balanced
by the need to compute S−1. This issue shall be revisited in Section 4.

3. The reduced Hilbert space

As discussed above, many of the coeﬃcients of ψB are negligible, since the
phase space-localized state does not overlap with many of the localized Gaus-
sians. We therefore deﬁne a reduced Hilbert subspace, spanned by a subset
of the |b(cid:105) vectors, whose coeﬃcients are all above some pre-deﬁned threshold
(Section 3.1). Next we deﬁne the biorthogonal bases for this reduced space
(Section 3.2) and the projector into it (Section 3.3). Finally we mention a
diﬀerent subspace, spanned by a subset of |g(cid:105) vectors (Section 3.4), which
will be useful in later discussions.

10

In such a case, we can save computational resources by reducing the vector

3.1. Deﬁning the reduced Hilbert space, (cid:101)H
Consider a Hilbert space H, of dimension N, spanned by the orthogonal
pseudo-spectral basis Θ and a set of biorthogonal bases B, G, represented in
Θ by the N × N matrices B and G, with G being the periodic von Neumann
Gaussian lattice, as deﬁned in eq. 6. A state |ψ(cid:105) that is localized in phase
space will be sparse in the B-representation, i.e. ψB will have many near-zero
elements. For the sake of notational convenience, let us assume the ﬁrst (cid:101)N
coeﬃcients in ψB are signiﬁcant, while the remaining N − (cid:101)N are negligible.
ψB of length N to a vector ψ(cid:101)B of length (cid:101)N (cid:28) N.
Deﬁne the reduced subspace, (cid:101)H ⊆ H as the Hilbert space spanned by the ﬁrst
(cid:101)N vectors of B, i.e. all states whose B-basis representation is strictly zero in
entries(cid:16)(cid:101)N + 1(cid:17) . . . N.
(cid:101)N
j=1(cid:17) .
(cid:101)H = span(cid:16){|bj(cid:105)}
Note that generally, (cid:101)H is quite diﬀerent from
(cid:101)N
j=1(cid:17) ,
ˇH := span(cid:16){|gj(cid:105)}
as is evident when (cid:101)N = 1. We shall discuss ˇH further in 3.4.
Deﬁne the complementary subspace, ¯H, by
H = (cid:101)H ⊕ ¯H ,

requiring that every vector in the complementary subspace ¯H is orthogonal
to every vector in the reduced subspace, (cid:101)H. As the B basis is non-orthogonal,
there is no partitioning of the B functions that allows one to span both
subspaces separately. However, the complementary space may be written as

(21)

(19)

(20)

¯H = span(cid:16){|gk(cid:105)}N

k=(cid:101)N +1(cid:17) .

(22)

By construction, (cid:101)H is rank (cid:101)N, ¯H is rank N − (cid:101)N, and (cid:101)H ⊥ ¯H due to
the biorthogonality of their respective base vectors. Therefore rank(cid:16)(cid:101)H(cid:17) +

11

rank(cid:0) ¯H(cid:1) = rank (H) and we conclude that indeed H = (cid:101)H ⊕ ¯H. Given any

state |ψ(cid:105) ∈ H, we may therefore decompose it as

(23)

|ψ(cid:105) =(cid:12)(cid:12)(cid:12)(cid:101)ψ(cid:69) +(cid:12)(cid:12) ¯ψ(cid:11)

s.t. (cid:68)(cid:101)ψ(cid:12)(cid:12)(cid:12) ¯ψ(cid:69) = 0 and(cid:12)(cid:12)(cid:12)(cid:101)ψ(cid:69) ∈ (cid:101)H,(cid:12)(cid:12) ¯ψ(cid:11) ∈ ¯H,

in Section 3.3.

where(cid:12)(cid:12)(cid:12)(cid:101)ψ(cid:69) is the reduced state and(cid:12)(cid:12) ¯ψ(cid:11) the complementary state. Projection
may be viewed as subtracting(cid:12)(cid:12) ¯ψ(cid:11) from |ψ(cid:105), a view that will be made explicit
3.2. Biorthogonal bases for (cid:101)H

We now turn to the biorthogonal bases for the reduced subspace,

(cid:101)N
j=1 .

(cid:101)H = {|bj(cid:105)}

We deﬁne these bases in a manner similar to that of the unreduced bases.

Let us denote the ﬁrst (cid:101)N columns of the B matrix with the matrix (cid:101)BN×(cid:101)N,
i.e. (cid:101)B is the Θ representation of the basis deﬁning (cid:101)H. (cid:101)G will be deﬁned as
a basis which is biorthogonal to (cid:101)B, and spans the same Hilbert space as (cid:101)B;
i.e. the pair (cid:101)G and (cid:101)B satisfy the completeness relation on the subspace. We
stress that (cid:101)B is the natural basis of (cid:101)H, while (cid:101)G is deﬁned in terms of (cid:101)B. One

should note that while ˜B is a truncated version of B, the ˜G matrix is not a
simple truncation of G, but rather that individual g functions are modiﬁed
by a projection into the subspace spanned by ˜B. This will be discussed in
detail later in this section.
The biorthogonality requirement is

(cid:101)G†(cid:101)B = 1(cid:101)N .

(24)

The requirement that (cid:101)B and (cid:101)G span the same subspace, is equivalent to the
statement that (cid:101)G vectors are expressible as linear combinations of (cid:101)B vectors,

and vice versa, i.e.

∃C s.t. (cid:101)B = (cid:101)GC,

12

(25)

k=1 Ck,1(cid:12)(cid:12)(cid:12)(cid:101)bk(cid:69), etc). The biorthogonality requirement is satisﬁed

(26)

,

(i.e. |(cid:101)g1(cid:105) =(cid:80)(cid:101)N
by the right pseudo-inverse of (cid:101)B†,

∃D s.t. (cid:101)G = (cid:101)BD.
(cid:101)G := (cid:101)B(cid:16)(cid:101)B†(cid:101)B(cid:17)−1
and eq. 25 and 26 are satisﬁed by D = (cid:101)S where
(cid:101)S :=(cid:16)(cid:101)B†(cid:101)B(cid:17)−1
= (cid:101)G†(cid:101)G,
and C = (cid:101)S−1 where
(cid:101)S−1 = (cid:101)B†(cid:101)B =(cid:16)(cid:101)G†(cid:101)G(cid:17)−1

(27)

(28)

(29)

.

. Using

Note that the biorthogonality requirement alone, eq. 24, is insuﬃcient to

Therefore (cid:101)G and (cid:101)B are biorthogonal bases, both spanning (cid:101)H. As biorthog-
onality is a reciprocal relation, eq. 27 is echoed by (cid:101)B = (cid:101)G(cid:16)(cid:101)G†(cid:101)G(cid:17)−1
eq. 28 and 29, we may relate (cid:101)G and (cid:101)B using (cid:101)S: (cid:101)G = (cid:101)B(cid:101)S and (cid:101)B = (cid:101)G(cid:101)S−1.
uniquely deﬁne (cid:101)G. For example, both the Gaussians, |g(cid:105), and the vectors
|(cid:101)g(cid:105) of (cid:101)G are biorthogonal to the |b(cid:105) = (cid:12)(cid:12)(cid:12)(cid:101)b(cid:69) vectors spanning the reduced
subspace, i.e. (cid:104)gk| bj(cid:105) =(cid:68)gk(cid:12)(cid:12)(cid:12)(cid:101)bj(cid:69) = δjk =(cid:68)(cid:101)gk(cid:12)(cid:12)(cid:12)(cid:101)bj(cid:69) ∀j, k ∈ 1 . . . (cid:101)N. But while
(cid:101)N
(cid:101)N
(cid:110)(cid:12)(cid:12)(cid:12)(cid:101)bj(cid:69)(cid:111)
j=1 do
not (except when (cid:101)N = N). At the extreme, when (cid:101)N = 1, it is clear that |b1(cid:105)
and |g1(cid:105) span diﬀerent (trivial) Hilbert spaces.
Similarly to the deﬁnitions of (cid:101)B and (cid:101)G, we deﬁne the basis for the comple-
mentary Hilbert space ¯H with ¯G of size N ×(cid:16)N − (cid:101)N(cid:17) as the last N − (cid:101)N
columns of G, and ¯B := ¯G(cid:0) ¯G† ¯G(cid:1)−1.

(cid:101)N
j=1 span the same subspace, {|bj(cid:105)}

(cid:101)N
j=1 and {|gj(cid:105)}

j=1

and {|(cid:101)gj(cid:105)}

13

The discussion above, and particularly eq. 27, leads to the conclusion that

The deformation of the (cid:101)G functions and the (cid:101)S matrix on the reduced subspace
the columns of (cid:101)G are no longer exactly Gaussians, but have been deformed

as the result of the basis reduction. This is depicted in ﬁg. 1. Note that
Gaussians that are far away from the reduction boundary are not as aﬀected
as the Gaussians closer to the boundary. This is consistent with the intuitive
notion that the localized Gaussians should not be aﬀected by changes in areas
of phase space into which they do not signiﬁcantly extend. This intuition is
made precise in the following section.

following circuitous path,

Schematically, the reduced (cid:101)S matrix is constructed from the S matrix by the

(30)

One starts with the unmodiﬁed SN×N, inverts to get S−1

N×N, truncates to

not decompose into products of their one-dimensional counterparts, while the

, and then inverts back to get (cid:101)S(cid:101)N×(cid:101)N. The chain of relationships
get (cid:101)S−1(cid:101)N×(cid:101)N
suggest that although G is simpler than B, (cid:101)G is more complicated than (cid:101)B.
Speciﬁcally, in the multi-dimensional case the columns of the (cid:101)G matrix do
columns of the (cid:101)B matrix do decompose into 1D components. The reduced
(cid:101)S−1 = (cid:101)B†(cid:101)B matrix is a subset (of rows and columns) of the unreduced S−1
matrix, but the reduced (cid:101)S = (cid:101)G†(cid:101)G matrix is not a subset of the full S, due to
the inversion in eq. 30. Non-decomposability of the multi-dimensional (cid:101)S and
(cid:101)G matrices has signiﬁcant impact on the computational resources required to
We summarize the identities involving the reduced (cid:101)S matrix that are coun-

compute the reduced Hamiltonian. The issue is discussed in depth in Section
4.

14

inversiontruncationinversionbackFigure 1: Depiction of modiﬁed Gaussians associated with the reduced basis. The reduced

basis is the non-gray area in both plots. On the left, the modiﬁed Gaussian (cid:101)g, which is

centered around a non-edge location in the phase space, is almost unchanged. On the right,
we see a heavily deformed Gaussian, i.e. the function is delocalized throughout the edge
region. This results from the projection of the ˜G basis functions into the subspace spanned
by ˜B. The deformation is much more signiﬁcant for Gaussians whose centers are near the
edge. See eq. 40 and the detailed discussion following eq. 41 for an explanation The states
are plotted as heat maps, where the value of each cell of the von Neumann lattice is the
absolute value of the overlap of the state plotted (here the modiﬁed Gaussians), with the

Gaussian centered at that cell of the lattice,(cid:12)(cid:12)(cid:12)(cid:68)g¯xj ,¯kj(cid:12)(cid:12)(cid:12)(cid:101)g(cid:105)(cid:12)(cid:12)(cid:12).

15

terparts of the identities for the unreduced S matrix, eq. 11:

We can now expand a state using the reduced basis, echoing eq. 14,

(cid:101)S := (cid:101)G†(cid:101)G,
(cid:101)S−1 = (cid:101)B†(cid:101)B,
3.3. Projecting into (cid:101)H
(cid:12)(cid:12)(cid:12)(cid:101)ψ(cid:69) :=

(cid:101)G = (cid:101)B(cid:101)S,
(cid:101)B = (cid:101)G(cid:101)S−1,
(cid:101)N(cid:88)j=1 (cid:104)(cid:101)gj| ψ(cid:105)(cid:12)(cid:12)(cid:12)(cid:101)bj(cid:69) =
(cid:101)N(cid:88)j=1(cid:12)(cid:12)(cid:12)(cid:101)bj(cid:69)(cid:68)(cid:101)gj(cid:12)(cid:12)(cid:12) =

(cid:126)ψ(cid:101)B = (cid:101)S (cid:126)ψ(cid:101)G,
(cid:126)ψ(cid:101)G := (cid:101)S−1 (cid:126)ψ(cid:101)B.
(cid:101)N(cid:88)j=1(cid:12)(cid:12)(cid:12)(cid:101)bj(cid:69)(cid:68)(cid:101)gj(cid:12)(cid:12)(cid:12)
|ψ(cid:105),
(cid:101)N(cid:88)j=1(cid:12)(cid:12)(cid:12)(cid:101)gj(cid:69)(cid:68)(cid:101)bj(cid:12)(cid:12)(cid:12) .

(cid:101)P :=

In Dirac notation,

providing us with a representation-free form of the projector from H to (cid:101)H.

(31)

(32)

(33)

(34)

with the second equation following by Hermiticy of the projection. Note

similarity to eqs. 13 and 14. Recall that(cid:12)(cid:12)(cid:12)(cid:101)bj(cid:69) = |bj(cid:105) ∀j = 1 . . . (cid:101)N.

The projector in the Θ representation (i.e. both input and output are repre-
sented on the Fourier grid) is given by

(cid:101)P := (cid:101)B(cid:101)G†,

transforms a general state to the state closest to it within the subspace [24].

where we omit the basis designation Θ. One may directly show that (cid:101)P
is idempotent, i.e. (cid:101)P 2 = (cid:101)P , and Hermitian. Moreover, the projector (cid:101)P
The idempotent property of (cid:101)P requires that the bra matrix in eq. 34, (cid:101)G†, be
biorthogonal to the ket matrix, (cid:101)B. Therefore, the projector is non-orthogonal
if and only if the bases are non-orthogonal, which is the case if and only if (cid:101)B
and (cid:101)G are not identical. The projection operator may be rewritten in several
representations. We shall denote by (cid:101)PY X the projection operator from the
full Hilbert space H into the reduced subspace (cid:101)H, where the Fourier grid
representation of the input basis for H is the matrix X, and the Fourier grid

16

representation for (cid:101)H is the matrix Y . (cid:101)PY X may be square or rectangular,

depending on the choice of output basis. The projection operator transforms
as do all operators, using

PY X = Y −1P X.

operation.

33 gives

(35)
When Y is not square, Y −1 should be taken to be the left pseudo-inverse of
Y .
To better understand the diﬀerence between this non-orthogonal projector
and a standard orthogonal projector we shall examine two representations:

(cid:101)P(cid:101)BB where the projection operation will be viewed as an additive operation,
and (cid:101)P(cid:101)GG, where the projection operation will be viewed as a subtractive
(cid:101)P(cid:101)BB - All basis vectors contribute to the reduced subspace
Given a state in the B basis, |ψ(cid:105) =(cid:80)N
(cid:101)N(cid:88)j=1
βk|(cid:101)gj(cid:105)(cid:68)(cid:101)bj(cid:12)(cid:12)(cid:12) bk(cid:69) .
N(cid:88)k=1

Note that all bk vectors contribute to the coeﬃcients in the reduced subspace,

k=1 βk|bk(cid:105), the application to |ψ(cid:105) of eq.

24, giving

as indicated by the(cid:68)(cid:101)bj(cid:12)(cid:12)(cid:12) bk(cid:69) term of eq. 36. The participation of all bk vectors
in the coeﬃcients is reﬂected in the (cid:101)P(cid:101)BB representation of the projector, as
depicted in ﬁg. 2. We derive the explicit form of (cid:101)P(cid:101)BB from eq. 35, using eq.
(37)
Examining the top panel of ﬁg. 2, the right block of (cid:101)P(cid:101)BB depicts the overlap of
(cid:101)N
j=(cid:101)N +1, with the {|bj(cid:105)}
all B vectors of the unreduced basis, including {|bj(cid:105)}N
j=1
subset. This added contribution is unique to non-orthogonal projections.
(cid:101)N
If this were an orthogonal projection, only the basis vectors deﬁning the
j=1, which make up the identity matrix appearing in the
reduced basis, {|bj(cid:105)}
left square, would play a part.

(cid:101)P(cid:101)BB = (cid:101)G†(cid:101)P B.

(cid:101)P|ψ(cid:105) =

(36)

17

projectors,

(cid:101)P(cid:101)GG - Projection as a subtractive process
Recalling eq. 21, H = (cid:101)H ⊕ ¯H, we express the identity operator as a sum of
I = (cid:101)P + ¯P,
j=(cid:101)N +1(cid:12)(cid:12)¯bj(cid:11)(cid:10)¯gj(cid:12)(cid:12). Using |¯gj(cid:105) =
where, by analogy to (cid:101)P, we deﬁne ¯P := (cid:80)N
|gj(cid:105) ∀j = (cid:101)N + 1 . . . N,
N(cid:88)j=(cid:101)N +1(cid:12)(cid:12)¯bj(cid:11)(cid:10)gj(cid:12)(cid:12) .

We shall apply both sides of eq. 39 to |gk(cid:105)k≤(cid:101)N. On the l.h.s, using eq. 33

(cid:101)P = 1 −

(39)

(38)

gives

Applying the r.h.s of eq. 39 to |gk(cid:105) and equating it with eq. 40 results in

(cid:101)P|gk(cid:105) = |(cid:101)gk(cid:105).
N(cid:88)j=(cid:101)N +1

(cid:104)gj| gk(cid:105)(cid:12)(cid:12)¯bj(cid:11) ∀k ≤ (cid:101)N .

|(cid:101)gk(cid:105) = |gk(cid:105) −

Note that (cid:101)P, applied to |gk(cid:105)k>(cid:101)N is zero, as the state is part of the basis
it is the result of subtraction of (cid:12)(cid:12)¯b(cid:11)

spanning the complementary subspace.
We now have a new insight into the deformation of the Gaussians due to the
basis reduction, as depicted in ﬁg. 1:
vectors, weighted by the overlap of the Gaussians inside the reduced subspace
with the Gaussians spanning the complementary space. This clariﬁes why
Gaussians at the boundary of the reduced subspace are modiﬁed more —
they have a larger overlap with Gaussians outside the reduced subspace.

k=1 γk|gk(cid:105) and using Eq. 40

gives

Applying (cid:101)P to a superposition state |ψ(cid:105) = (cid:80)N
γk|(cid:101)gk(cid:105).

(cid:101)P|ψ(cid:105) =

(cid:101)N(cid:88)k=1

(40)

(41)

(42)

Gaussians spanning the complementary subset are dropped, and the coeﬃ-

18

cients of the remaining Gaussians are unchanged but now serve as coeﬃcients
of the modiﬁed Gaussians. If this were an orthogonal basis, these coeﬃcients
would have been unchanged without modifying the underlying basis.
An equivalent view is provided by examining the projector representation

(cid:101)P(cid:101)GG. Deﬁne the matrix

RN×(cid:101)N :=

allowing us to write

1

0

1
0
...
...
0 . . .
0
0
...

0
...
0

0



0
...
...
0
. . .

...
. . .

. . .
...
0
1
0

0
...
0

,



(cid:101)B := BR.
(cid:101)P(cid:101)GG = R†.

(43)

(44)

(45)

Combining eqs. 34, 35 and 27, and using eqs. 44 and 7, we obtain

j=1

This uniquely simply form is depicted in the bottom panel of ﬁg. 2.

are the same as their unreduced counterparts, {bj}

(cid:101)P(cid:101)BB and (cid:101)P(cid:101)GG provide two complementary views of the non-orthogonal projec-
tion. With (cid:101)P(cid:101)BB, projection is an additive process: The vectors of the reduced
(cid:101)N
(cid:101)N
basis, (cid:110)(cid:101)bj(cid:111)
j=1, as is
the case for orthogonal projections. However, the projection modiﬁes their
j=(cid:101)N +1, which is unique to
coeﬃcients due to additive contributions by {bj}N
non-orthogonal projections. With (cid:101)P(cid:101)GG, projection is a subtractive process:
If |ψ(cid:105) =(cid:80)N
changing |g(cid:105) to |(cid:101)g(cid:105). This modiﬁcation is again unique to non-orthogonal

(cid:101)N
k=1 γk|gk(cid:105), then the coeﬃcients {γk}
k=1 are unchanged by the pro-
jection and the rest are removed completely, as in an orthogonal projection.
However, the Gaussian basis vectors are modiﬁed by subtraction proportional
to their overlap with the Gaussians spanning the complementary subspace,

19

Hilbert space dimension

H

(cid:101)H
¯H

N

(cid:101)N
N − (cid:101)N

b-like basis
†
B = (G−1)

g-like basis
†
G = (B−1)

Biorthogonality

G†B = 1

(cid:101)G := (cid:101)B(cid:16)(cid:101)B†(cid:101)B(cid:17)−1

¯G = G ¯R

(cid:101)G†(cid:101)B = 1

¯G† ¯B = 1

(cid:101)B = BR
¯B := ¯G(cid:0) ¯G† ¯G(cid:1)−1

Table 1: Summary of properties of the full, reduced and complementary Hilbert spaces.

Completeness

GB† = 1

 (cid:101)G = (cid:101)B(cid:16)(cid:101)B†(cid:101)B(cid:17)−1
(cid:101)B = (cid:101)G(cid:16)(cid:101)G†(cid:101)G(cid:17)−1
(cid:40) ¯G = ¯B(cid:0) ¯B† ¯B(cid:1)−1
¯B = ¯G(cid:0) ¯G† ¯G(cid:1)−1

projections.

3.4. Projecting into the subspace spanned by Gaussians, ˇH
(cid:101)N
We have deﬁned the reduced subspace (cid:101)H in eq. 19 as the Hilbert space
(cid:101)N
k=1. One may deﬁne a diﬀerent reduced subspace, ˇH =
spanned by {|bk(cid:105)}
k=1(cid:17), as in eq. 20. As discussed in Section 3.2, these subspaces
span(cid:16){|gk(cid:105)}
are not identical (unless (cid:101)N = N), as is evident when (cid:101)N = 1 and (cid:101)H =
span (|b1(cid:105)) and ˇH = span (|g1(cid:105)).
Following the discussion in Sections 3.1, 3.2 and 3.3 one may deﬁne the
projector into this subspace and the subspace’s biorthogonal bases. Let us
denote the ﬁrst (cid:101)N columns of the G matrix with the matrix ˇGN×(cid:101)N, i.e. ˇG

(cid:101)N
k=1, the basis spanning ˇH. To satisfy the
is the Θ representation of {|gk(cid:105)}
biorthogonality requirement, eq. 8, in the ˇH basis, one must deﬁne

(46)

(47)

ˇG := GR

ˇB := ˇG ˇS−1.

20

the operator projecting the state ψB,

Figure 2: (top panel) The (cid:101)P(cid:101)BB projector, i.e.
into the reduced Hilbert space (cid:101)H and representing the result in the (cid:101)B basis. Notice the
block structure. The left square is the identity matrix, since if |ψ(cid:105) =(cid:12)(cid:12)(cid:12)bk≤(cid:101)N(cid:69) it remains
unchanged by the projection. The right block provides insight into the unique additive
j=(cid:101)N +1
contributions characteristic of non-orthogonal projections: as {|bj(cid:105)}
overlap, when projecting into (cid:101)H, all b vectors have some overlap into the reduced subspace,
and therefore contribute to the projected vector. (bottom panel) The (cid:101)P(cid:101)GG projector. The
right block is empty, denoting the subtraction of all ¯G vectors, which span the comple-
mentary subspace ¯H, from the G representation of the state. The left block is the identity
matrix, denoting the coeﬃcients in this block remain unchanged. However, since |(cid:101)g(cid:105) (cid:54)= |g(cid:105),
the vector represented by these coeﬃcient does change, due to the subtraction of the ¯G
subspace from the ˇG vectors, resulting in the (cid:101)G basis.

(cid:101)N
j=1 and {|bj(cid:105)}N

21

Figure 3: Transitions between the unreduced and reduced bases, represented on the

a projection (surjective; with information loss), continuous arrows are injective (one-to-

middle and outer circles, respectively, with dimension N and (cid:101)N. Dashed arrows indicate
one but not necessarily on-to) mappings. The nomenclature (cid:101)PY X is used to indicate
the projection from representation X of H into representation Y of (cid:101)H. This diagram
may be used, for example, to construct (cid:101)P(cid:101)BB by going through the following series of
projecting with R†, (3) transforming back to (cid:101)B using (cid:101)S, (4) transforming to base B using
R. Multiplying the matrices appearing from right to left gives (cid:101)PBB = R(cid:101)SR†S−1.

transformations: (1), from the B basis to G using the transformation matrix S−1, (2)

22

with ˇS = ˇG† ˇG. The projector into ˇH may then be deﬁned as

ˇP =

(cid:101)N(cid:88)j=1(cid:12)(cid:12)ˇgj(cid:11)(cid:10)ˇbj(cid:12)(cid:12) ,

ˇP = ˇG ˇB†

(48)

(49)

with |ˇgj(cid:105) = |gj(cid:105). Therefore, in the Θ representation the projector is

Note both ¯H and ˇH are spanned by Gaussians. Speciﬁcally, ¯H is the reduced
subspace spanned by the set of Gaussians complementary to ˇG. It must be
stressed that (cid:101)H (cid:54)= ˇH (cid:54)= ¯H.
As discussed in Section 2.4, the representation of a state as a sum of of
Gaussians (PvN) is not sparse. Therefore, given a well-localized state |ψ(cid:105), if
one wishes to use the ˇH subspace, one can expect that a very large number of
functions will be needed. This is in stark contrast to (cid:101)H, where well-localized
states are well-approximated by a small number of functions. Thus, given
a ﬁxed size of the representation, one will achieve much higher accuracies
with (cid:101)P than with ˇP. This will be explicitly demonstrated when we discuss

the various representations of the reduced Hamiltonian and their accuracy,
in section 4.

4. The Hamiltonian and the Schrödinger equation for the reduced

state

The Schrödinger equation for the reduced state requires projecting the Hamil-
tonian into the reduced subspace. In this section we consider three possibil-
ities from both the theoretical and practical viewpoints: Projecting into the

a pseudo-projection into a combination of the two (Section 4.3). Finally we
benchmark the respective accuracies of the possible projections (Section 4.4).

(cid:101)H subspace (Section 4.1), into the ˇH subspace (Section 4.2) and performing
4.1. The equation of motion in the (cid:101)H subspace
To arrive at the reduced Hamiltonian, we apply the (cid:101)P projection on both

the input and output of the Hamiltonian. As the state is represented in the

23

(cid:101)B basis, one can either convert the vector to Θ, project into (cid:101)H, apply H,
project the resulting state again into (cid:101)H, and transform it to (cid:101)B, or, equiv-

alently, ﬁrst apply the projection and then the base transformation. These
two alternatives correspond to the following two expressions for H1:

Utilizing eq. 34, 37 and 27

H1 := (cid:101)G†(cid:16)(cid:101)P H(cid:101)P(cid:17)(cid:101)B = (cid:101)P(cid:101)BB(cid:0)G†HB(cid:1)(cid:101)PB(cid:101)B.
H1 = (cid:101)G†H(cid:101)B =(cid:16)(cid:101)B†(cid:101)B(cid:17)−1(cid:16)(cid:101)B†H(cid:101)B(cid:17) .

The TISE and TDSE then take the form

Eψ(cid:101)B = H1ψ(cid:101)B
∂tψ(cid:101)B = −
 H1ψ(cid:101)B.

i

(50)

(51)

(52)

(53)

(54)

Eq. 51, 52 and 53 will be the key working equations for the remainder of this
article.

is to replace all matrices in any of the forms of eq. 18 by their reduced

The formulation using only (cid:101)B matrices (r.h.s. of 51) is appealing, as (cid:101)B = BR
is the naturally reduced matrix in (cid:101)P . An equivalent, more heuristic approach,
counterparts, B −→ (cid:101)B, G −→ (cid:101)G, S −→ (cid:101)S, etc. All four variations transform
(cid:101)B†(cid:19)(cid:16)(cid:101)B(cid:17) = 1. Therefore eigenvalues are real and evolution is
(cid:18)(cid:16)(cid:101)B†(cid:101)B(cid:17)−1

to the reduced Hamiltonian in eq. 51.
Finally, we note that H1 is similar to a Hermitian matrix, in that the prod-
uct of matrices to the left and right of H in eq. 51 produce the identity,

unitary. Moreover, combining eq. 51 and 52 the TISE may be reformulated
as a generalized eigenvalue equation with Hermitian matrices.

(cid:16)(cid:101)B†(cid:101)B(cid:17) λψ(cid:101)B =(cid:16)(cid:101)B†H(cid:101)B(cid:17) ψB

thus avoiding the matrix inversion required to compute (cid:101)S. This form is

24

solvable with an iterative eigensolver, such as Arnoldi. Unfortunately, in this
form it is not possible to implement the eigensolver with just matrix-vector
multiplications (i.e. it is not possible to avoid matrix-matrix multiplications)
[31]. This is in contrast with the pseudo-projection discussed in Section 4.3,
which can be implemented with just matrix-vector multiplications.
While accurate and mathematically rigorous, computing the H1 form in
eq. 51 is time consuming. Most signiﬁcantly, calculation of elements of

the reduced Hamiltonian (cid:101)B†H(cid:101)B can be laborious, particularly in the multi-

dimensional case, as the B functions are non-localized. Fortunately, there
are symmetry considerations and numerical techniques which can accelerate
this computation by several orders of magnitude. Alternatively, using eq. 51,
44, 11 and 31, one may rewrite H1 as

(55)

H1 = (cid:101)S(cid:0)R†S−1G†HGS−1R(cid:1)

Eq. 55 may be quicker to compute then 50: due to the locality of G and the
fact that elements of H are usually functions of either position or momentum
(but rarely both), the vast majority of G†HG elements are vanishingly small.
Note that G and S−1 decompose dimensionally. Indeed, one would still have

to calculate (cid:101)S, which requires the inversion of (cid:101)B†(cid:101)B, but this may be acceler-

ated, if one is able to store the matrix. If we then use an iterative algorithm
for solving the TISE (e.g. Arnoldi) and the TDSE (e.g. Taylor propagator),
one may use only matrix-vector type operations to further accelerate the
process. Similar considerations have been noted in [27].

consider. First, we shall examine the possible choices for state representation:

In the previous section we presented the projection of the TISE and TDSE

4.2. Alternatives to the (cid:101)H-projected equations of motion
into the (cid:101)H subspace. There are, however, additional alternatives we should
In addition to the (cid:101)B representation which we have been using, there are
have three additional a priori candidates: (cid:101)G, ˇB and ˇG. Then, we shall
For example, H2, deﬁned in eq. 62 using a hybrid of (cid:101)P and ˇP is used in [27].
The ﬁrst alternative state representation, (cid:101)G, spans (cid:101)H just as (cid:101)B does and

consider various projections for the Hamiltonians. This analysis is of some
importance, as alternatives to eq. 51 are currently in use by the community.

25

therefore provides the same accuracy. However, it has a disadvantage: the

coeﬃcients are determined by an overlap with (cid:101)B-s, which are highly non-
local. As a result, the coeﬃcients are not expected to drop-oﬀ sharply at
the boundary of the reduced subspace, where the wavepacket is absent. As
a result, we cannot use their declining values to determine the selection of
basis functions for the reduced subspace, as one may do with an amplitude
cutoﬀ threshold for ψ(cid:101)B. This issue is of primary concern, especially for the
TDSE, where the coeﬃcients of the state at the boundary of the reduced
phase space serves determine how to modify the subspace over time. We

therefore conclude that the (cid:101)G is unﬁt for our purposes.

The two remaining options, ˇB and ˇG, are disqualiﬁed because the subspace
to which such states belong, ˇH, is spanned by Gaussians, and hence does
not provide a sparse representation for localized states.
In other words,
many Gaussians (or many ˇB vectors) are required to accurately represent a

viable option for state representation.
Next we proceed to examine the possible projections of the Hamiltonian.

localized state (see Section 3.4). We therefore conclude that (cid:101)B is the only
Until now we have been considering projection into (cid:101)H. The other natural
alternative is projection into ˇH. This may be performed either by acting
with ˇP on H on the left and the right, or by using the replacement rules
G −→ ˇG, S −→ ˇS = ˇG† ˇG, B −→ ˇB = ˇG ˇS−1 on any of the Hamiltonian
forms in eq. 18. This leads to

H4 := ˇG† ˇP H ˇP ˇB = ˇG†H ˇB =(cid:0) ˇG†H ˇG(cid:1)(cid:0) ˇG† ˇG(cid:1)−1

.

(56)

Note that we would like to continue to represent states in the (cid:101)B representa-

tion, in accordance with the above discussion of its compactness. Then the
TISE and TDSE take the form

Eψ(cid:101)B = H4ψ(cid:101)B
 H4ψ(cid:101)B.
∂tψ(cid:101)B = −

i

(57)

(58)

However, because the subspace into which H4 is projected does not span the
subspace deﬁned by the ψ(cid:101)B, the accuracy may be signiﬁcantly lower than

26

that of H1 (see ﬁg. 4 and the discussion in Section 4.4). Nevertheless, H4
greatly beneﬁts from having a highly local Hamiltonian transform, ˇG†H ˇG,
making it usable when fast low-accuracy results are acceptable.

With the strict application of (cid:101)P leading to an accurate but slow H1, and the

application of ˇP leading to an inaccurate alternative, in the following section
we explore the possibility of a hybrid projection that combines some of the
beneﬁts of both.

4.3. The equation of motion in hybrid subspaces

Recall the discussion in Section 3.2 regarding the modiﬁcation of the (cid:101)G Gaus-

sians when near the edge of the reduced subspace. One may hypothesize that
if we extend the reduced subspace beyond the minimal volume required to
represent the state, so that Gaussians near the boundary do not have signiﬁ-
cant overlap with the state, we may achieve a good approximation while still
using the unmodiﬁed Gaussians. In the nomenclature established in Section

altogether.

not span the same subspace the completeness relations do not hold.

3.4, we wish to replace (cid:101)G with ˇG, and possibly avoid the non-local (cid:101)B matrix
We note that ˇG†(cid:101)B = 1(cid:101)N, i.e. they are biorthogonal. However, as they do
Recalling eq. 51, H1 = (cid:101)G†H(cid:101)B and eq. 56, H4 = ˇG†H ˇB, we shall deﬁne the

hybrid form

with the corresponding TISE and TDSE:

H2 := ˇG†H(cid:101)B,
Eψ(cid:101)B = H2ψ(cid:101)B
 H2ψ(cid:101)B.
∂tψ(cid:101)B = −

i

(59)

(60)

(61)

This form is advantageous over eq. 51 in that no matrix inversion is necessary
(implying there is no generalized eigenvalue problem to solve for the TISE),
and the localized nature of ˇG can be used to simplify the calculation of

27

multi-dimensional terms in ˇG†H(cid:101)B. H2 is similar to a Hermitian matrix (as
ˇG†(cid:101)B = 1(cid:101)N) and hence diagonalizable with real eigenvalues.

Eq. 62 may be reformulated using eq. 46, 44 and 11 as

H2 = R†G†HGS−1R.

(62)

This form allows the TDSE to be solved using only matrix-vector type op-
erations. S−1 decomposes into a product of one-dimensional matrixes and
G†HG may be calculated analytically by expanding the potential term as a
Taylor series around the center of the Gaussian. Such an approach may be
suﬃciently quick to eliminate the need to store the reduced Hamiltonian, by
making use of an iterative eigensolver as described in [27] along with a Taylor
propagator for the TDSE.

A ﬁnal possible hybrid is H3 := (cid:101)G†H ˇB but we do not see any immediate

usefulness in this form.

4.4. Comparing the accuracy of the dynamical formulations

We now compare the accuracy of the various reduced Hamiltonians intro-
duced in the previous sections. From ﬁg. 4 we can conclude that H1 is
indeed the most accurate. This is expected as it contains no approxima-
tions beyond the amplitude cutoﬀ used to deﬁne the reduced subspace. H2
provides two orders of magnitude lower accuracy for the same reduced basis
size or alternatively, requires a boundary width of 5 lattice cells to achieve
equivalent accuracy. The latter translates to 30% to 80% larger reduced ba-
sis size for 1D problems, and is expected to grow exponentially with higher
dimensions, making it an unappealing option for high-dimensional problems.
The lower accuracy of H2 may be understood when we compare equations

by the basis reduction, as depicted in ﬁg. 1. H2 ignores this deformation,
instead acting with the unmodiﬁed Gaussians. If we enlarge the boundary
of the reduced subspace suﬃciently so that there is little overlap between

62 to 51, i.e. ˇG†H(cid:101)B to (cid:101)G†H(cid:101)B, and recall the deformation of the Gaussians
the state represented and the deformed Gaussians, then (cid:101)G†ψ (cid:117) ˇG†ψ. There-

fore, H2 may achieve accuracy equal to H1 provided the reduced subspace is
expanded.

28

Figure 4: Accuracy of the ground state energy of the 1D Harmonic oscillator as a function
of the reduced basis size (lower x-axis) or reduced-basis boundary width (upper x-axis)
computed using diﬀerent reduced Hamiltonians. As expected from the theoretical discus-

reduced subspace is increased to the point where the state does not signiﬁcantly over-

sion, H1 = (cid:101)G†H(cid:101)B is orders of magnitude more accurate then H2 = ˇG†H(cid:101)B, until the
lap any of the distorted Gaussians, and the distinction between (cid:101)G and ˇG becomes moot.
H3 = (cid:101)G†H ˇB and H4 = ˇG†H ˇB are signiﬁcantly less accurate.

29

Size of reduced basisEnergy error (relative)  H1H2H3H4Full grid10210310−1210−1010−810−610−410−2100Size of reduced basisEnergy error (relative)  05101520253035404550Boundary widthH3 and H4 provide almost identically poor performance, never achieving an
accuracy of 10−5, except when utilizing the full grid, where the diﬀerence be-
tween the various reduced Hamiltonians disappears. This is again expected,

as by using the projector ˇP instead of (cid:101)P on the input state to the Hamilto-

nian, we are projecting into a subspace spanned by Gaussians (Section 3.4),
which is non-sparse. As analyzed in [11], in this case the full Hilbert space
is required to achieve highly accurate results.
To conclude, for highly accurate results, H1 is the form of choice. In some
instances where high accuracy is not paramount, or one opts for a signiﬁcant
increase in the reduced subspace size, H2 may allow for greater speed.

5. Examples

We provide some illustrative examples of the use of the PvB representation for
both the TISE and TDSE. The algorithms used to solve the time dependent
and time independent Schrödinger are described in detail in [32] and an
application of PvB to the challenging problem of double ionization of helium,
is given in [17].

5.1. 1D Morse Oscillator

The Hamiltonian for the Morse oscillator, in atomic units, is

+ 12(cid:16)1 − e− 1

2 (x−2)(cid:17)2

.

(63)

HMorse = −

∂2
x
2 × 6

The PvB representation for the 21st eigenstate is shown in ﬁg. 5.
The mean error of the ﬁrst 21 states as a function of the reduced basis size
is depicted in ﬁg. 6. The behavior of H2 compared to H1 for the Morse
oscillator is similar to their behavior for the harmonic oscillator ground state
(ﬁg. 4).
If the reduced basis is large enough, so that the basis functions
near the subspace boundary have negligible overlap with the state, then ˜G†ψ
is almost equal to ˇGψ and the results using H2 do not diﬀer signiﬁcantly
In other words, ˜S ˜N× ˜N = ( ˜B† ˜B)−1 is similar
from the results using H1.
to ˇS = RT SN×N R. At the other extreme, if the Hilbert space is pruned too
drastically, parts of phase space with signiﬁcant population are left out of the

30

Figure 5: PvB representation of the 21st eigenstate of the one dimensional Morse oscillator,
eq. (63). Pixel colors represent the absolute value squared of the PvB expansion coeﬃ-
cients. Only the basis functions corresponding to colored pixels are part of the reduced
subspace.

reduced subspace. In that case, the errors induced by the excessive pruning
become more signiﬁcant than the errors caused by approximating ˜G by ˇG
and the distinction between H1 and H2 becomes negligible. We conclude
that H2 may be useful for low accuracy applications.

5.2. 2D Coupled Harmonic Oscillator

The observations of Section 5.1 are applicable to higher dimensional systems.
We repeat the previous analysis for a coupled two-dimensional harmonic
oscillator described by

H2D-HO = −

1
2

(∂2

x + ∂2

y) +

1
2

(x2 + y2) − 0.3xy.

(64)

Figure 7 shows the error of the ﬁrst 22 eigenstates of this system as a function
of the subspace size. The results are qualitatively similar to those of ﬁg. 6.
For a large reduced space, the results of H1 and H2 are similar, with the
results of H2 actually slightly more accurate. The slightly higher accuracy
of H2 may originate from the additional inversion of ˜S−1 that is required for

31

Figure 6: Mean error of the ﬁrst 21 eigenstates in a one dimensional Morse oscillator,
as a function of the ratio between the reduced and unreduced basis sizes. The system
supports 24 bound states; the size of the reduced basis is 97. The error is shown for the
two Hamiltonians, H1 and H2. Eigenstate error is computed as the inﬁdelity with respect
to the eigenstate computed with the unreduced Hilbert space.

32

110010−1610−1410−1210−1010−810−610−410−2102030405060708090100Meanerrorofﬁrst21states˜NN/%H1H2Figure 7: Mean error of the ﬁrst 22 eigenstates in a two dimensional coupled harmonic
oscillator, eq. (64), as a function of the ratio of the reduced and unreduced basis sizes.
The error is shown for the two Hamiltonians, H1 and H2.

H1. For intermediate basis sizes, the error of H2 is larger than for H1, until
the error introduced by excessive pruning of the basis dominates at small
basis sizes.

5.3. 2D Double Well Dynamics

We now turn to the time-dependent case. When propagating a wavefunc-
tion in time, the reduced basis changes as the phase space occupied by the
state evolves. To compare the accuracy of H1 and H2, we consider a two di-
mensional double well potential with strong coupling between x and y, with

H2D-DW = −

1

2 × 200

(∂2

x +∂2

y )+6.4(x−1)2(x−2)2+37.5(y−2)2+10x2y, (65)

33

110−1410−1210−1010−810−610−410−20102030405060708090100Meanerrorofﬁrst22states˜NN/%H1H2Figure 8: Potential surface for 2D double well (eq. (65)), overlaid with the initial (left
panel) and ﬁnal (right panel) state. Wavefunction z coordinate is proportional to the
absolute value squared of its amplitude.

and the initial wave packet is given by

(cid:104)xy| ψinitial(cid:105) =

(cid:113) 2

π

(0.04 × 0.02)

exp(cid:32)−

1
4

(x − 2.1)2

0.04 −

0.02 (cid:33).
(y − 2.05)2

(66)

The wave packet was propagated from t0 = 0 to t2 = 24.6. The potential
surface and the initial and ﬁnal wave packets are shown in ﬁg. 8. At the ﬁnal
time, the wave packet has spread across the barrier and oscillates in x and
y. The wave packet was also investigated at t1 = 16.6 (not shown), when the
packet is at the barrier but still retains a compact form.
Figure 9 compares the accuracy of the dynamics computed using H1 and H2.
Here we observe a signiﬁcant deterioriation in H2 performance. Speciﬁcally,
H2 fails to achieve 10−4 accuracy, both at t1 and t2, unless more than half of
the unreduced Hilbert space is used. This is in stark contrast to H1, which
can achieve better than 10−8 accuracy with less than 30% of the Hilbert space.
Moreover, the ≈ 10−4 accuracy of H2 for a very small basis size at t1 is lost
for t2. Both aspects of this reduction in H2 accuracy can be explained by
recognizing the importance of the low-amplitude boundary dynamics as the
wavepacket tunnels across the barrier. The Gaussians at the boundary are
the ﬁrst to be removed in the pruning process, as depicted in ﬁg. 1. Therefore,
H2 may not be used where the low-amplitude boundary is essential for getting

34

Figure 9: Accuracy of the wavepacket dynamics for the 2D double-well as a function of
the ratio of the reduced and unreduced basis sizes. The ﬁdelity is shown for the two
Hamiltonians, H1 and H2, at two times t1 and t2.

acceptable accuracy. In contrast, H1 can be used in such situations with no
diﬃculty, as long as the amplitude cutoﬀ is suﬃciently low so as to retain
the tunneling amplitude.

6. Conclusions and outlook

In this paper we presented the mathematical underpinnings of the PvB
(biorthogonal von Neumann) method for quantum mechanical simulations.
The PvB method exploits the phase phase space localization of the von Neu-
mann basis to provide a sparse representation of quantum mechanical states
that spans only the part of phase space where there is signiﬁcant amplitude.
This in turn can lead to signiﬁcant computational savings in both CPU and
memory.
A detailed analysis was given of the subtle issues of projection onto sub-
spaces of biorthogonal bases. Two complementary ways of understanding
this projection were provided. The ﬁrst focuses on the basis functions:
it

35

110010−1210−1010−810−610−410−20102030405060708090kΨtexact−Ψtprunedk2D˜NNE/%t1=16.6,H1t1=16.6,H2t2=24.6,H1t2=24.6,H2was shown that under projection one of the biorthogonal bases remains un-
changed while the other becomes signiﬁcantly distorted. We showed that the
distortions may be viewed as arising from subtraction of the ¯G Gaussians
that span the complementary subspace. This explains why Gaussians near
the boundary of the reduced phase space boundary are signiﬁcantly distorted,
while Gaussians far from the boundary are essentially unperturbed. The sec-
ond way to understand the eﬀect of non-orthogonal projection focuses on the
coeﬃcients: in the ¯G basis all ¯B basis vectors contribute to the coeﬃcients,
since all basis vectors overlap one another due to the non-orthogonality of
the basis.
We then analyzed the various representations of the Schrödinger equation in
the reduced basis and approximations thereto. We concluded that for high-

it comes which a relatively high computational cost. For medium to low

accuracy applications H1 = (cid:101)G†H(cid:101)B (eq. 50) is the preferred form, although
accuracy applications, an approximate form, H2 = ˇG†H(cid:101)B (eq. 62) may be

used.
Several numerical examples were brought, showing the relative merits of H1
and H2. A more challenging application of PvB, the double ionization of
helium, is presented in [17].
Despite the signiﬁcant methodological progress further development is possi-
ble. Speciﬁcally, one may further reduce the representation by decomposing
multi-dimensional objects into a sum-of-products, and truncating the sum
when the correlation is suﬃciently low. This strategy is used by the POT-
FIT algorithm to decompose the potential, but a similar approach could be
used for the wavefunction and the reduced Hamiltonian. This is a challenging
problem, however, as the dynamics continuously modify the reduced basis,
which generally is not easily decomposable.
Further areas of research include the correspondence between PvB and other
phase space representations, including the discrete Husimi and Wigner rep-
resentation. We also plan to explore the treatment of particle symmetries
(Bosonic, Fermionic) in multi-particle implementations of the PvB method.
Beyond method development, there is a wide range of problems which are
amenable to the PvB methodology, including high-harmonic generation, multi-
electron ionization, photodissociation and chemical reactions. We intend to
explore these applications in the near future.

36

To conclude, PvB is an accurate, scalable and eﬃcient method for quantum
dynamics simulations, and it is our hope that it will ﬁnd its place as part of
the standard quantum numerics toolbox.

Acknowledgement

The authors thank Tucker Carrington for useful correspondence. This work
was supported by the Israel Science Foundation (533/12), the Minerva Foun-
dation with funding from the Federal German Ministry for Education and
Research and the Koshland Center for Basic Research. H. R. Larsson ac-
knowledges support by the Deutscher Akademischer Austauschdienst, Studi-
enstiftung des deutschen Volkes and the Fonds der Chemischen Industrie.

Bibliography

References

[1] Cabrera, R.; Bondar, D. I.; Jacobs, K.; Rabitz, H. A. Phys. Rev. A

2015, 92, 042122.

[2] Esposti, M. D.; Graﬃ, S. In The Mathematical Aspects of Quantum
Maps; Esposti, M. D., Graﬃ, S., Eds.; Springer Berlin Heidelberg:
Berlin, Heidelberg, 2003; Chapter Mathematical Aspects of Quantum
Maps, pp 49–90.

[3] Neumann, J. Mathematische Annalen 1931, 104, 570–578.

[4] Gabor, D. Journal of the Institution of Electrical Engineers - Part III:

Radio and Communication Engineering 1946, 93, 429–441.

[5] Davis, M. J.; Heller, E. J. J. Chem. Phys. 1979, 71, 3383–3395.

[6] Poirier, B.; Salam, A. J. Chem. Phys. 2004, 121, 1704–1724.

[7] Lombardini, R.; Poirier, B. Phys. Rev. E 2006, 74, 036705.

[8] Halverson, T.; Poirier, B. Chemical Physics Letters 2015, 624, 37–42.

37

[9] Halverson, T.; Poirier, B. J. Phys. Chem. A 2015, 119, 12417–12433,

PMID: 26418314.

[10] Dimler, F.; Fechner, S.; Rodenberg, A.; Brixner, T.; Tannor, D. J. New

Journal of Physics 2009, 11, 105052.

[11] Shimshovitz, A.; Tannor, D. J. Phys. Rev. Lett. 2012, 109, 070402.

[12] Takemoto, N.; Shimshovitz, A.; Tannor, D. J. J. Chem. Phys. 2012,

137, 011102.

[13] Whittaker, E. T. Proceedings of the Royal Society of Edinburgh 1915,

35, 181–194.

[14] Nyquist, H. American Institute of Electrical Engineers, Transactions of

the 1928, 47, 617–644.

[15] Shannon, C. Proceedings of the IRE 1949, 37, 10–21.

[16] Kosloﬀ, R. In Numerical Grid Methods and Their Application to
Schrödinger’s Equation; Cerjan, C., Ed.; Springer Netherlands: Dor-
drecht, 1993; Chapter The Fourier Method, pp 175–194.

[17] Assémat, E.; Machnes, S.; Tannor, D. J. arXiv:1502.05165 2015,

[18] Marston, C. C.; Balint-Kurti, G. G. J. Chem. Phys. 1989, 91, 3571–

3576.

[19] Fattal, E.; Baer, R.; Kosloﬀ, R. Phys. Rev. E 1996, 53, 1217–1227.

[20] Colbert, D. T.; Miller, W. H. J. Chem. Phys. 1992, 96, 1982–1991.

[21] Tannor, D. J. Introduction to Quantum Mechanics: A Time-Dependent
Perspective, by David J. Tannor. ISBN-10 1-891389-23-8; ISBN-13 978-
1-891389-23-8. Published by University Science Books, Sausalito, CA
USA, 2007.; University Science Books, 2007.

[22] Ref. 11, Supplementary Material 1.

[23] Note the diﬀerent deﬁnition of the norm from that in Ref. [21].

[24] Genossar, T.; Porat, M. IEEE Transactions on Systems, Man and Cy-

bernetics 1992, 22, 449–460.

38

[25] Tannor, D. J.; Takemoto, N.; Shimshovitz, A. Advances in Chemical

Physics 156 (2014) 1–34 ; 2014.

[26] Shimshovitz, A.; Bacic, Z.; Tannor, D. J. J. Chem. Phys. 2014, 141,

234106.

[27] Brown, J.; Carrington, T. J. Chem. Phys. 2015, 143, 044104.

[28] Fechner, S.; Dimler, F.; Brixner, T.; Gerber, G.; Tannor, D. J. Opt.

Express 2007, 15, 15387–15401.

[29] Daubechies, I. IEEE Transactions on Information Theory 1990, 36,

961–1005.

[30] The transformation from the Fourier to the PvN basis can be ac-
complished using approximately N ln N operations using a Fast Gabor
Transform [33], which is closely related to the Fast Fourier Transform.

[31] Bai, Z.; Demmel, J.; Dongarra, J.; Ruhe, A.; van der Vorst, H. In Tem-
plates for the Solution of Algebraic Eigenvalue Problems; Bai, Z., Dem-
mel, J., Dongarra, J., Ruhe, A., van der Vorst, H., Eds.; Society for
Industrial and Applied Mathematics, 2000.

[32] Machnes, S.; Assémat, E.; Tannor, D. J. To be published 2016,

[33] Wang, L.; Chen, C.-T.; Lin, W.-C. IEEE Transactions on Image Pro-

cessing 1994, 3, 87–92.

39

