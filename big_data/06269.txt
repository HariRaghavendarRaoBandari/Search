6
1
0
2

 
r
a

 

M
0
2

 
 
]
T
N
h
t
a
m

.

[
 
 

1
v
9
6
2
6
0

.

3
0
6
1
:
v
i
X
r
a

The mean number of 2-torsion elements in class groups of odd

degree number ﬁelds arising from binary n-ic forms

Wei Ho, Arul Shankar, and Ila Varma

March 22, 2016

Abstract

For any odd integer n ≥ 3, we study the ideal class groups of degree n number ﬁelds whose
rings of integers arise as the coordinate rings of the subschemes of P1 cut out by integral binary
n-ic forms. For this family of number ﬁelds, we determine, conditional on the ABC conjecture,
the average size of the 2-torsion subgroups in their class groups, when the ﬁelds are ordered by
the size of the coeﬃcients of the corresponding binary n-ic forms. Additionally, for any order
Of in a degree n number ﬁeld arising from an integral binary n-ic form f in this way, we study
Cl2(Of ), the group of ideal classes in Of of order 2, and I2(Of ), the group of ideals in Of of
order 2. Restricting to those orders contained in degree n number ﬁelds with ﬁxed signature
(r1, r2), we prove that the mean value of the diﬀerence |Cl2(Of )| −
21−r1 −r2 |I2(Of )| is equal to
1, independent of whether one averages over the family of all orders or maximal orders arising
from integral binary n-ic forms. These computations imply that within this family, a majority
of degree n ﬁelds have odd class number. Furthermore, they give theoretical evidence towards
the Cohen-Martinet-Malle heuristics.

1

1

Introduction

The Cohen-Lenstra and Cohen-Martinet heuristics [9, 10] give precise predictions for the distribu-
tion of ideal class groups in families of ﬁxed-degree number ﬁelds. Very few cases of these heuristics
have been proved (see, e.g., [12, 2, 14]). In 2010, Malle [18] proposed a modiﬁcation of the Cohen-
Martinet heuristics to account for observed variations in the behavior of the p-part of the class
groups of families of number ﬁelds over a ﬁxed base ﬁeld containing the pth roots of unity; for
example, when p = 2, the Cohen-Martinet-Malle heuristics yield predictions for class groups of
number ﬁelds over Q. In particular, in [18, Conj. 2.1 & Prop. 2.2], the following conjecture for the
mean size of the 2-torsion subgroup in certain ﬁxed-degree families of number ﬁelds is given:

Conjecture 1 (Cohen-Martinet-Malle). Fix an odd integer n ≥ 3 and a pair of nonnegative integers
(r1, r2) such that r1 + 2r2 = n. Consider the set of isomorphism classes of degree n number ﬁelds
with signature (r1, r2), i.e., with r1 real embeddings and r2 pairs of complex embeddings. The
average number of 2-torsion elements in the ideal class groups of such ﬁelds is

when these ﬁelds are ordered by discriminant.

1 + 21−r1−r2

The only veriﬁed cases of Conjecture 1 are for cubic ﬁelds, due to Bhargava [2]. The original
proof involves associating quartic ﬁelds to index-2 subgroups in the class groups of cubic ﬁelds,
and then proving results on the density of quartic ﬁelds to conclude that the mean number of

1

2-torsion elements in totally real (respectively, complex) cubic ﬁelds ordered by discriminant is
3/2 (resp. 5/4). A more direct proof can be found in [7]; it uses the parametrization of 2-torsion
elements in class groups of cubic ﬁelds (and cubic orders) by pairs of ternary quadratic forms
from [1, Thm. 4]. In this paper, we give theoretical evidence for Conjecture 1 for odd n ≥ 3 by
generalizing the strategy in [7]; in particular, we use a parametrization of 2-torsion ideal classes in
certain number ﬁelds by pairs of n-ary quadratic forms described in [22]. To state our main results,
we ﬁrst describe the subfamily of number ﬁelds we study.

For any integer n ≥ 3, an integral binary n-ic form naturally gives rise to a ring that has rank
n as a Z-module, e.g., as the coordinate ring of the subscheme of P1 cut out by the form (see §2.1
for an explicit algebraic construction). In this paper, we restrict our attention to the case when n
is odd, and we consider degree n number ﬁelds whose rings of integers arise from binary n-ic forms
in this way. Note that this family does not contain all—not even most!—degree n number ﬁelds
when n > 3. Nevertheless, there are inﬁnitely many rings of integers within this family, and we
order them by height, i.e., by the size of the coeﬃcients of the corresponding binary n-ic forms.

Theorem 2. Fix an odd integer n ≥ 3 and a pair of nonnegative integers (r1, r2) such that r1+2r2 =
n. Consider the set of isomorphism classes of degree n number ﬁelds with signature (r1, r2) whose
rings of integers arise from integral binary n-ic forms. When these ﬁelds are ordered by the size of
the coeﬃcients of the corresponding binary n-ic form, the average number of 2-torsion elements in
the ideal class groups of such ﬁelds is

1 + 21−r1−r2

conditional on the ABC conjecture.

In the case of n = 3, this family contains all cubic ﬁelds, and so our results in conjunction with
those of [2] give concrete evidence that these mean values are independent of whether the family is
ordered by height or discriminant. In other words, the Cohen-Lenstra and Cohen-Martinet-Malle
heuristics should be true under any natural ordering. Additionally, Theorem 2 immediately implies
that most number ﬁelds within this family have trivial 2-torsion subgroup in their ideal class groups.
More precisely, we have:

Corollary 3. Fix an odd integer n ≥ 3 and signature (r1, r2). Assuming the ABC conjecture, a pos-
itive proportion (at least 1−21−r1−r2) of degree n number ﬁelds with signature (r1, r2) corresponding
to integral binary n-ic forms, when ordered by height, have odd class number.

Given the possible choices for signatures (r1, r2) satisfying r1 + 2r2 = n, Corollary 3 implies
that a majority of degree n number ﬁelds with signature (r1, r2) arising from integral binary n-ic
forms have odd class number, when these ﬁelds are ordered by height.

Our methods are not limited to studying maximal orders in number ﬁelds; we also study the
ideal class groups of all (degree n) orders arising from binary n-ic forms in this way. Speciﬁcally,
for each odd n ≥ 3, we compute on average how many 2-torsion ideal classes in the class groups
of such orders arise from nontrivial elements of order 2 in the ideal groups of such orders (of which
the class group is a quotient). More precisely, if O is an order in a number ﬁeld, let the ideal
group I(O) denote the group of invertible fractional ideals of O; recall that the class group Cl(O)
is deﬁned as the quotient of I(O) by the subgroup of principal ideals in I(O). Denote the p-torsion
subgroups of Cl(O) and I(O) by Clp(O) and Ip(O) for any prime p. Although Ip(O) is trivial for
maximal orders O, this is not necessarily true for non-maximal orders O.

In [7], the authors show that the mean value of the diﬀerence |Cl2(O)| −

21−r1−r2 |I2(O)| is
equal to 1, when averaging over maximal orders O in cubic ﬁelds of a ﬁxed signature (r1, r2), over
all orders in such cubic ﬁelds, or even over certain acceptable families of orders deﬁned by local

1

2

conditions ordered by discriminant. An analogous result is also known for 3-torsion elements of
class groups of acceptable families of quadratic orders and ﬁelds (see [8]). In this paper, we obtain
a similar statement for the family of orders in higher degree number ﬁelds arising from binary n-ic
forms ordered by height:

Theorem 4. Fix an odd integer n ≥ 3 and signature (r1, r2). Consider the set of orders Of arising
from integral binary n-ic forms f whose fraction ﬁelds have degree n and signature (r1, r2). When
such orders are ordered by the height of the corresponding binary n-ic forms, then the average size
of

over all such Of is 1.

|Cl2(Of )| −

|I2(Of )|

1

21−r1−r2

The main strategy to prove both Theorems 2 and 4 relies on parametrizing 2-torsion ideal
classes of the appropriate rings by certain integral orbits of a particular representation, and then
using geometry-of-numbers methods to give asymptotic counts of the relevant orbits. More pre-
cisely, we study the orbits of SLn(Z) acting on Z2 ⊗ Sym2(Zn), i.e., the space of pairs (A, B) of
n-ary quadratic forms. Each such pair gives rise to an invariant binary n-ic form

f(A,B)(x, y) := det(Ax − By)

when A and B are written as symmetric n × n matrices.
If f is an integral binary n-ic form
corresponding to an order Of in a degree n number ﬁeld, then certain projective SLn(Z)-orbits of
pairs (A, B) with invariant binary n-ic f(A,B) = f are equipped with a composition law coming
from the group structure on the 2-torsion subgroup of the class group of Of ; this implies that the
number of such orbits is determined by the number of 2-torsion ideal class elements of Of . Thus to
compute the average in Theorem 4, we count the number of integral binary n-ic forms of bounded
height that correspond to orders in degree n number ﬁelds, and we compare it to the number
of relevant SLn(Z)-orbits whose binary n-ic invariant is bounded by the same height. To obtain
Theorem 2, we restrict to integral binary n-ic forms corresponding to maximal orders; however, a
squarefree sieve dependent upon the ABC conjecture (see §4.2) is then required.

When n = 3, the same spaces are considered in [7] with an additional group action: the
GL2(Z) × SL3(Z)-orbits of pairs of ternary quadratic forms are counted relative to the number
of GL2(Z)-orbits of invariant binary cubic forms. In this case, the GL2(Z)-orbits of binary cubic
forms are in exact bijection with all isomorphism classes of rank 3 rings (see [13, 15]), and the
discriminant of a binary cubic form is invariant under GL2(Z) while the height is not. This results
in the computation of the average number of 2-torsion elements in ideal classes of cubic ﬁelds
ordered by discriminant.
In this paper, we order SLn-orbits of pairs of n-ary quadratic forms
(A, B) by the height of their binary n-ic invariants, which is not a GL2-invariant ordering. Note
that if a ring of rank n arises from an integral binary n-ic form f (x, y), then the binary n-ic form
γf (x, y) := f ((x, y)γ) for any γ ∈ GL2(Z), gives rise to the same ring up to isomorphism, but f
and γf may not have the same height. In forthcoming work, we consider GL2(Z) × SLn(Z)-orbits
of pairs of n-ary quadratic forms by ordering their invariant binary n-ic forms by Julia invariant
[17]. This allows us to compute the analogous mean values to Theorems 2 and 4, when the rings
we average over are instead ordered by the Julia invariants of the corresponding binary n-ic forms.
We obtain that these average sizes do not change when one orders by height or Julia invariant,
providing more evidence that the Cohen-Martinet-Malle heuristics should hold under any natural
ordering.

3

We now give a short description of the organization of the paper. In Section 2, we recall and expand
on the details of the construction of rank n rings Rf from binary n-ic forms f given in [19, 21] as
well as a correspondence between SLn-orbits of pairs of n-ary quadratic forms and order 2 ideal
classes of such rings Rf from [22]. Section 3 focuses on using geometry-of-numbers methods to
count the appropriate projective integral orbits of pairs of n-ary quadratic forms, i.e., those with
irreducible and nondegenerate binary n-ic invariant f , which is equivalent to restricting the rings
Rf to those arising as an order in a degree n number ﬁeld. In Section 4, we describe several sieves
that allow us to restrict our count from §3 to orbits that correspond to invertible ideal classes in
orders (or maximal orders). Finally, in Section 5, the analytic methods in §3 and §4 are combined
with the algebraic interpretation of the orbits given in §2 to conclude the main results.

Acknowledgments

We thank Manjul Bhargava, Christophe Delaunay, Gunter Malle, and Melanie Matchett Wood for
helpful conversations.

2 Parametrizations of 2-torsion ideal classes and composition laws

In this section, we describe two “orbit parametrizations,”
Let n ≥ 3 be a ﬁxed odd integer.
speciﬁcally representations whose orbits correspond to arithmetic data related to rank n rings and
their ideal classes. In the ﬁrst case, we explain how binary n-ic forms (namely, elements of the
space SymnR2 for a ring R), up to a change of variables, correspond to isomorphism classes of rank
n rings over R, along with an ideal class. Then we show that elements of the space R2 ⊗ Sym2Rn
naturally give rise to binary n-ic forms (and thus rank n rings and ideal classes) over R, as well as
an additional two-torsion ideal class for the ring. Some of the ideas and theorems in this section
are based on parametrizations over arbitrary base schemes found in [22], though we simplify some
of the statements for our setting.

In §2.3, we describe the orbits and stabilizers of these representations more explicitly for a few
speciﬁc base rings R, since we will use these interpretations in later sections. In §2.4, we describe a
type of “composition law” for most elements in R2 ⊗ Sym2Rn, arising from the group law on ideal
classes in rings. Finally, in §2.5, we discuss “reducible” elements in the space R2 ⊗ Sym2Rn and
how to identify them; these are elements that will be excluded in the counts in later sections.

2.1 Rings associated to binary n-ic forms

We ﬁrst describe the construction of a rank n ring over Z and ideals from an integral binary n-ic
form. Let f (x, y) = f0xn + f1xn−1y + · · · + fnyn, where fi ∈ Z and f0 6= 0, and let Bf0 = Z[ 1
].
f0
We then deﬁne the ring Rf as a subring of Bf0[θ]/f (θ, 1), generated as a Z-module as

Rf = h1, f0θ, f0θ2 + f1θ, . . . , f0θn−1 + f1θn−2 + · · · + fn−2θi.

(1)

For k > 0, deﬁne ζk = f0θk + · · · + fk−1θ, and let ζ0 = 1.
(Both [19] and [21] show that
Rf = hζ0, · · · , ζn−1i is closed under multiplication.) We deﬁne the following Z-submodule of
Bf0[θ]/f (θ, 1):

If = h1, θ, ζ2, · · · , ζn−1i.

(2)

As shown in [21, 19], the module If is closed under multiplication by elements of Rf and thus is
an ideal of Rf . It is easy to check that for 0 ≤ k ≤ n − 1, we have

f = h1, θ, θ2, . . . , θk, ζk+1, · · · , ζn−1i
I k

(3)

4

as a Z-submodule of Bf0[θ]/f (θ, 1). For n odd, the ideal I n−3
has the following explicit basis as a Z-module:

f

is a square of the ideal I

n−3

2

, which

f

n−3

2

f = h1, θ, θ2, . . . , θ

I

n−3
2 , ζ n−3

2 +1, . . . , ζn−1i.

Additionally, there is a natural action of γ ∈ GL2(Z) on f sending γ · f (x, y) = f ((x, y)γ); under
this action, the ring Rf and the ideal If (and its powers) are invariant (up to isomorphism). If f
is irreducible, then Rf is an order of Q[θ]/f (θ, 1), and the discriminants of Rf and f coincide [19,
Proposition 1.1]. In addition, the form f is primitive (i.e., the gcd of its coeﬃcients is 1) if and
only if If is invertible [21, Proposition 2.1].

In fact, by recording the basis (3), the ideals I k

f may be considered as based ideals of Rf , i.e.,
ideals of Rf along with an ordered basis as a rank n Z-module. The norm N(J) of a based ideal J
of Rf is the determinant of the Z-linear transformation taking the chosen basis of J to the basis of
Rf given by (1).

We also introduce dual elements to θk for all 0 ≤ k ≤ n − 1. Let {ˇθ0, ˇθ1, . . . , ˇθn−1} be the
(Bf0[θ]/f (θ, 1), Bf0) dual to {1, θ, θ2, . . . , θn−1}. Additionally, deﬁne
, and note that ˇζn−1(ζk) = δk,n−1 for all 0 ≤ k ≤ n − 1. In [22, Proposition 2.1], Wood

Bf0-module basis of HomBf0
ˇζn−1 :=
computes that for any r ∈ Bf0[θ]/f (θ, 1) and 0 ≤ k ≤ n − 2,

ˇθn−1
f0

which will be useful for computations in the following section.

ˇθk(r) = ˇζn−1(ζn−1−kr) + fn−1−k ˇζn−1(r),

(4)

The above construction holds if one replaces Z with any integral domain T [21]; this gives an
explicit way of associating a ring Rf , which is rank n as a T -module, and a distinguished (based)
ideal If of Rf to a binary n-ic form over T . We refer to Rf as the ring associated to f and If as the
distinguished ideal of Rf or f . Geometrically, the ring Rf is the ring of functions on the subscheme
Xf of P1
T to
Xf .

T cut out by the binary n-ic form f , and the ideal I k

f is the pullback of O(k) from P1

We are interested in counting the 2-torsion ideal classes of the rings Rf associated to irreducible
forms f when n is odd. A key ingredient is a parametrization of such ideal classes in terms of pairs
of n × n symmetric matrices. We next describe this orbit space, using constructions found in [22].

2.2 Parametrization of order 2 ideal classes in Rf
Let T be a principal ideal domain, and let W (T ) = SymnT 2 denote the space of binary n-ic forms
with coeﬃcients in T . Let V (T ) = Sym2T n ⊕Sym2T n denote the space of pairs (A, B) of symmetric
n × n matrices with coeﬃcients aij of A and bij of B in T (for 1 ≤ i, j ≤ n) where aij = aji and
bij = bji. The group GLn(T ) acts naturally on V (T ), where g ∈ GLn(T ) acts on (A, B) by

g · (A, B) = (gAgt, gBgt).

(5)

There is a map det : V (T ) → W (T ) sending (A, B) 7→ det(Ax − By), which is clearly GLn(T )-
equivariant. We call f(A,B) := det(A, B) the binary n-ic invariant of the pair (A, B) (or of the
GLn(T )-equivalence class of (A, B)). Recall that a binary n-ic form f is nondegenerate if and only
if its discriminant is nonzero, and we will call the pair (A, B) nondegenerate if and only if f(A,B) is.
The map det deﬁned above has a Kostant section e : W (T ) → V (T ) such that det ◦ e = id. For
example, for n = 3, the section e takes a binary cubic form f (x, y) = f0x3 + f1x2y + f2xy2 + f3y3
to the pair

0

0
0 −f0
1

0 −f2

1
0







0
1
1 f1
0
0

0
0
f3





 .

 ,



5

For n = 5, the map e sends a binary quintic form f (x, y) = f0x5 + f1x4y + f2x3y2 + f3x2y3 +
f4xy4 + f5y5 to

0
0 0
0 0
0
0 0 f0
0
0 1
1 0
0

0
1
0
f2
0

1
0
0
0
f4







0
1

0 0
0 0
0 1 −f1
1 0
0 0




,




1
0
0

0
0
0
0

.







0 −f3
0

0 −f5

For general n, a binary n-ic form f (x, y) = f0xn + f1xn−1y + f2xn−2y2 + · · · + fnyn is mapped under
e to ((aij), (bij )) where:

• ak,n−k = 1 for 1 ≤ k < n−1

• a n−1

2 +k, n−1

2 +k = (−1)

2 or n−1

2 < k < n
2 f2k for 0 ≤ k ≤ n−1
2

n−1

• bk,n−1−k = 1 for 1 ≤ k < n

• b n−1

2 +k, n−1

2 +k = (−1)

(6)
2 f2k+1 for 0 ≤ k ≤ n−1
2

n+1

• aij = 0 otherwise

• bij = 0 otherwise.

The following theorem describes how SLn(T )-orbits of V (T ) are related to rank n rings and
ideal classes; it is a restatement of [22, Thm. 1.4], using the fact that our base ring T is a principal
ideal domain:

Theorem 2.1. Let f ∈ W (T ) be a nondegenerate primitive binary n-ic form with nonzero leading
coeﬃcient. Then there is a bijection between SLn(T )-orbits of (A, B) ∈ V (T ) with f(A,B) = f and
equivalence classes of pairs (J, δ) where J ⊂ Kf := T [x]/(f (x, 1)) is an ideal of Rf and δ ∈ K ×
f
satisfying J 2 ⊂ δI n−3

as ideals and N(J)2 = N(δ) N(I n−3

).

f

f

Two pairs (J, δ) and (J ′, δ′) are equivalent if there exists κ ∈ K ×

f such that J ′ = κJ and

δ′ = κ2δ.

The next subsection describes this bijection explicitly in the case T = Z. Following that, we
discuss how Theorem 2.1 follows from descending a similar bijection with rigidiﬁed data; we obtain
a description of the stabilizer of (A, B) ∈ V (T ) as a result of the rigidiﬁed theorem.

An explicit description of the maps over Z

In the case where T = Z, we explicitly describe the bijective map of Theorem 2.1, as some of these
computations will be needed in §2.5. The correspondence over other principal ideal domains T is
very similar.

We start with how to associate an element of V (Z) to a pair (J, δ). Fix a primitive nondegener-
ate f = f0xn +f1xn−1y +· · ·+fnyn ∈ W (Z) with f0 6= 0 and thus Rf , and let J be a fractional ideal
of Rf and δ be an invertible element of Rf ⊗Z Q such that J 2 ⊂ δI n−3
).
This implies that there is a map

and N(J)2 = N(δ) N(I n−3

f

f

ϕ : J ⊗ J → If
jj′
δ

j ⊗ j′ 7→

.

(7)

Composing ϕ with the quotient map If 7→ If /h1, θ, · · · , θn−3i gives a symmetric bilinear map and
corresponds to an element of (A, B) ∈ V (Z). Equivalently, we can explicitly write a Z-basis for J as
hα1, · · · , αni with the same orientation as h1, ζ1, ζ2, . . . , ζn−1i, i.e., the change-of-basis matrix from
hζii to hαii has positive determinant. Because J 2 ⊂ δI n−3

, we have that for all i, j ∈ {1, . . . , n},

f

ϕ(αi ⊗ αj) = c(0)

ij + c(1)

ij θ + . . . + c(n−3)

ij

θn−3 + bijζn−2 + aijζn−1

(8)

6

where aij, bij, c(k)
integral symmetric n × n matrices.

ij ∈ Z for 0 ≤ k ≤ n − 3. Then (A, B) = ((aij), (bij )) yields the desired pair of

Conversely, let (A, B) ∈ V (Z) satisfy det(A, B) = f with coeﬃcients aij for A and bij for
B. Note that det A = f0, so the desired condition that f0 6= 0 is equivalent to requiring A to be
invertible. We want to construct a fractional ideal J of Rf along with an element δ ∈ (Rf ⊗Z Q)×
such that the map ϕ described in equation (7) is well-deﬁned. We describe J explicitly in terms of
a Z-basis hα1, · · · , αni.

First, we consider the action of θ on αi. By [22, Proposition 3.3], if we write elements of J as
row vectors relative to the basis hα1, · · · , αni, then θ acts on J by right multiplication by BA−1,
i.e.,

θ · (α1, α2, · · · , αn)t = (α1, α2, · · · , αn)t · BA−1.

This completely determines the action of Rf (and even the action of Bf0[θ]/f (θ, 1)) on J. We
now deﬁne the map ϕ by explicitly writing its image on basis elements hαi ⊗ αji of J ⊗ J. For
0 ≤ k ≤ n − 3, let C (k) be the matrix

C (k) := (f0 · (BA−1)n−k−2 + f1 · (BA−1)n−k−3 + . . . + fn−k−3 · BA−1)B,

and let c(k)

ij denote the (i, j)th entry of C (k). Then

ϕ : J ⊗ J → If
αi ⊗ αj 7→ c(0)

ij + c(1)

ij θ + . . . + c(n−3)

ij

θn−3 + bijζn−2 + aijζn−1.

(9)

Finally, we set δ = αiαj
satisfy the following ratios:

ϕ(αi⊗αj ) . Equation (9) shows that for each 1 ≤ j ≤ n, we have that the αi

α1 : α2 : . . . : αn−1 : αn = c(0)
1,j + · · · + c(n−3)
c(0)
2,j + · · · + c(n−3)
c(0)
n−1,j + · · · + c(n−3)
c(0)
n,j + · · · + c(n−3)

n,j

1,j

2,j

θn−3 + b1,jζn−2 + a1,jζn−3 :
θn−3 + b2,jζn−2 + a2,jζn−3 : · · · :

n−1,j θn−3 + bn−1,jζn−2 + an−1,jζn−3 :

θn−3 + bn,jζn−2 + an,jζn−3.

The ratios are independent of the choice of j, so this determines hα1, α2, . . . , αni up to a scalar
factor in Rf ⊗Z Q. Once we ﬁx a choice of hα1, α2, . . . , αni, then δ is uniquely determined.

To construct the matrices C (k), recall that ζn−2 = f0θn−2 + f1θn−3 + · · · + fn−3θ and ζn−1 =

f0θn−1 + f1θn−2 + · · · + fn−2θ, so from the deﬁnition of δ and ϕ, we have

αi · αj

δ

= c(0)

ij + (c(1)
+ · · · + (c(n−3)

ij

ij + fn−3bij + fn−2aij)θ + (c(2)

ij + fn−4bij + fn−3aij)θ2

+ f1bij + f2aij)θn−3 + (bij + f1aij)θn−2 + aijθn−1.

(10)

Thus, the coeﬃcients c(k)

ij must satisfy

c(k)

ij = ˇθk(cid:16) αi · αj

δ

(cid:17) − fn−k−2 · bij − fn−k−1 · aij.

Using equation (4), we then have that c(k)

ij must satisfy

c(k)

ij = fn−k−1 ˇζn−1(cid:16) αi · αj

δ

(cid:17) + ˇζn−1(cid:16)ζn−k−1 ·

αi · αj

δ

(cid:17) − fn−k−2 · bij − fn−k−1 · aij

7

αi · αj

= ˇζn−1(cid:16)ζn−k−1 ·
= ˇζn−1(cid:18) (f0θn−k−1 + f1θn−k−2 + . . . + fn−k−2θ) · αi · αj

(cid:17) − fn−k−2 · bij

δ

δ

The middle equality follows from the fact that ˇζn−1(cid:0) αiαj

notation, we thus have

(cid:19) − fn−k−2 · bij.
δ (cid:1) = aij by equation (9).

In matrix

C (k) = (f0 · (BA−1)n−k−1 + f1 · (BA−1)n−k−2 + . . . + fn−k−2 · BA−1)A − fn−k−2B

(11)

with entries c(k)

ij . It is clear that the c(k)

ij are determined by the pair (A, B).

The action of SLn(Z) on V (Z) corresponds to the action gn ∈ GLn(Z) on the chosen basis for

J which sends

hα1, α2, . . . , αni 7→ hα1, α2, . . . , αni · gt
n.

(12)

Thus, the ideal J is invariant under the action of SLn(Z).

A rigidiﬁed theorem and stabilizers

In order to understand the stabilizer of the action of SLn(T ) on an element (A, B) ∈ V (T ), we
discuss precisely with what the elements (instead of SLn(T )-orbits) of V (T ) are in correspondence,
in terms of the pair (J, δ) along with a basis for J.

Proposition 2.2. Let f ∈ W (T ) be a nondegenerate primitive binary n-ic form with nonzero
leading coeﬃcient. Let Kf := T [x]/(f (x, 1)). Then the nonzero elements (A, B) ∈ V (T ) with
f(A,B) = f are in bijection with equivalence classes of triples (J, B, δ) where J ⊂ Kf is a based ideal
of Rf , with an ordered basis given by an isomorphism B : J → T n of T -modules, and δ ∈ K ×
f ,
satisfying J 2 ⊂ δI n−3

as ideals and N(J)2 = N(δ) N(I n−3

).

f

f

Two such triples (J, B, δ) and (J ′, B′, δ′) are equivalent if and only if there exists κ ∈ K ×

f such

that J ′ = κJ, B ◦ (×κ) = B′, and δ′ = κ2δ.

This proposition follows from the same constructions that give Theorem 2.1, by keeping track
of the basis B given by hα1, · · · , αni. (It may also be obtained by the proof of part of [22, Thm. 3.1]
over T instead of Z, and then considering the “symmetric” version and simplifying the conditions
due to T being a principal ideal domain. See also [22, Thms. 4.1 & 5.7] and [3, Thm. 6].)

For any (A, B) ∈ V (T ) corresponding to (J, B, δ) in Proposition 2.2, the action of SLn(T ) on
(A, B) as in equation (5) induces an action of SLn(T ) on the basis B through the correspondence,
namely as given in equation (12). This action of SLn(T ) takes J to itself and does not aﬀect δ, so
SLn(T ) acts on the triples (J, B, δ).

In general, the group GLn(T ) does not act on the set of triples (J, B, δ) in the bijection;
only transformations with determinant ±1 preserve the norm condition N(J)2 = N(δ) N(I n−3
).
Such transformations (with determinant ±1) form a subgroup SL±
n (T ) of GLn(T ) isomorphic to
{±1} × SLn(T ), as n is odd here. However, a transformation with determinant −1 acting on (A, B)
does not preserve the binary n-ic form f(A,B); in particular, it sends f(A,B) to −f(A,B).
Thus, quotienting both sides of the correspondence in Proposition 2.2 by SL±

n (T ) gives a
bijection between SL±
n (T )-orbits of V (T ) with f(A,B) = ±f for (A, B) in that orbit and equivalence
classes of (J, δ) where J is an ideal of Rf and δ ∈ K ×
as ideals and
N(J)2 = N(δ) N(I n−3
f such
that J ′ = κJ and δ′ = κ2δ. Because the SLn(T )-orbits of V (T ) with invariant binary n-ic f are in
bijection with the SL±

). Two pairs (J, δ) and (J ′, δ′) are equivalent if there exists κ ∈ K ×

n (T )-orbits of V (T ) associated to ±f , we recover Theorem 2.1.

f , satisfying J 2 ⊂ δI n−3

f

f

f

8

For the computations in later sections, we are interested in the stabilizer of (A, B) ∈ V (T )
in SLn(T ). The automorphism group of the pair (J, δ) is in bijection with the set of κ ∈ K ×
f
such that κ2 = 1, i.e., the 2-torsion K ×
n (T ) of (A, B)
corresponding to (J, δ) is precisely this automorphism group, since SL±
n (T ) is the group that removes
the rigidiﬁcation of B and there are no nontrivial automorphisms of a triple (J, B, δ). The stabilizer
in SLn(T ) of (A, B) corresponding to (J, δ) is thus isomorphic to the subgroup of K ×
f [2] that
preserves the norm of J, i.e., the norm 1 elements of K ×

f [2] of the units in Kf . The stabilizer in SL±

f [2].

2.3 Orbits and stabilizers over speciﬁc types of rings

From the discussion in the previous section, we may easily compute the stabilizers of SLn(T ) acting
on V (T ) for speciﬁc rings T , namely T = Z, a ﬁeld, or Zp. In the latter two cases, we also record
for future use a relatively simple description of the orbits.

Stabilizers over Z

The following corollary records the stabilizer in SLn(Z) of an element of V (Z) in terms of the
automorphism group of the corresponding pair (J, δ) from Theorem 2.1; it follows directly from the
previous section.

Corollary 2.3. Let (A, B) ∈ V (Z) be a nondegenerate element with primitive binary n-ic invariant
f whose leading coeﬃcient is nonzero, corresponding to the ring Rf and the pair (J, δ) under
Theorem 2.1. Then the stabilizer in SLn(Z) of (A, B) is (EndRf (J)×[2])N≡1.

Orbits and stabilizers over ﬁelds

Let k be a ﬁeld and let f be a separable nondegenerate binary n-ic form with coeﬃcients in k
whose leading coeﬃcient is nonzero. Then Rf is a commutative k-algebra of dimension n, and in
particular, a direct product of ﬁeld extensions of k and thus a principal ideal ring. It is easy to
check that If = Rf here.

In this case, Theorem 2.1 implies that SLn(k)-orbits on k2 ⊗Sym2kn with binary n-ic invariant
f correspond to equivalence classes of pairs (J, δ), where J is a fractional ideal of Rf and δ ∈ R×
f
such that J 2 = δI n−3
= δRf . The only ideals in Rf are products of either the unit ideal (1) or
the zero ideal (0) in each of the factors; since δ must be invertible, we must have J = Rf and so
N(δ) = 1. Thus, the equivalence classes of the pairs (J, δ) are parametrized by norm 1 elements of
R×

f )2. In summary, we have:

f /(R×

f

Corollary 2.4. Let k be a ﬁeld and let f be a separable nondegenerate binary n-ic form with
coeﬃcients in k whose leading coeﬃcient f0 is nonzero. Then the SLn(k)-orbits of k2 ⊗ Sym2kn
with invariant binary n-ic form f are in bijection with elements δ of (R×
f )2)N≡1. The stabilizer
in SLn(k) of such an element in k2 ⊗ Sym2kn is isomorphic to R×
Example 2.5. For k = R, for a given f as above, we have that Rf is isomorphic to Rr1 × Cr2 for
some nonnegative integers r1 and r2 with r1 + 2r2 = n. Then the number of SLn(R)-orbits with
invariant binary n-ic form f is 2r1−1, and the order of the stabilizer in SLn(R) is 2r1+r2−1.

f [2]N ≡1.

f /(R×

Orbits and stabilizers over local rings

Now let T = Zp. Just as when T is a ﬁeld, the ring Rf is a direct product of ﬁnite extensions of Zp
and is thus a principal ideal ring. We again ﬁnd that for pairs (J, δ) as in Theorem 2.1, the norm

9

condition implies that J 2 = δI n−3
Furthermore, since n − 3 is even, we obtain that

f

. As a result, the ideal J is determined by the element δ of R×
f .

N(δ) =


N(J)

N(I (n−3)/2

f

2

)


is a square, so the set of equivalence classes of pairs (J, δ) are parametrized by

For each pair (J, δ), the stabilizer in SL±

n (Zp) is isomorphic to the 2-torsion of the units of Rf .

(R×

f /(R×

f )2)N≡1.

Corollary 2.6. Let f be a separable nondegenerate binary n-ic form with coeﬃcients in Zp whose
leading coeﬃcient f0 is nonzero. Then the SLn(Zp)-orbits of Z2
p with invariant binary
n-ic form f are in bijection with elements δ of (R×
f )2)N≡1. The stabilizer in SLn(Zp) of such
an element in Z2
f [2].

p is isomorphic to R×

p ⊗ Sym2Zn

p ⊗ Sym2Zn

f /(R×

2.4 Composition of elements of V (Z) with the same binary n-ic invariant

Let O be an order in a degree n number ﬁeld K. Consider the set of pairs (J, δ), where J is a
fractional ideal of R, δ ∈ K ×, J 2 ⊂ (δ), and N (J)2 = N (δ). Recall that we called two such pairs
(J, δ) and (J ′, δ′) are equivalent if there exists κ ∈ K × such that J ′ = κJ and δ′ = κ2δ. We have a
natural law of composition on equivalence classes of such pairs given by

(J, δ) ◦ (J ′, δ′) = (JJ ′, δδ′).

(13)

We say that a pair (J, δ) is projective if J is projective as an O-module, i.e., if J is invertible as a
fractional ideal of O; the pair (J, δ) is projective if and only if J 2 = (δ). The set of projective pairs
(J, δ) for O forms a group under the composition law (13), which we denote by H(O).

There exists a natural group homomorphism from H(O) to Cl2(O), given by sending the pair
(J, δ) to the ideal class of J. This map is clearly well-deﬁned and surjective. The kernel consists
of equivalence classes of pairs (J, δ) where J is a principal ideal. For any equivalence class in the
kernel, there is a representative of the form (O, δ) where δ is a norm 1 unit. Therefore, we obtain
the exact sequence

1 →

N =1

O×
(O×)2 → H(O) → Cl2(O) → 1,

(14)

which implies that H(O) is an extension of the 2-part of the class group of O. Using Dirichlet’s
unit theorem and the fact that −1 ∈ O× has norm −1, we immediately obtain the following lemma:

Lemma 2.7. Let O be an order in a degree n number ﬁeld K having signature (r1, r2). Then
|H(O)| = 2r1+r2−1|Cl2(O)|.

Assume f ∈ W (Z) is nondegenerate and irreducible so that Rf = Of is an order in a degree n
number ﬁeld. Further assume that f is primitive, which implies that If is invertible. We say that
a pair (A, B) ∈ V (Z) ∩ det−1(f ) is projective if the corresponding pair (J, δ) under the bijection of
Theorem 2.1 is projective. We then have the following result:

10

Proposition 2.8. Let Of be an order corresponding to the integral, nondegenerate, irreducible,
and primitive binary n-ic form f . Then H(Of ) is in natural bijection with the set of projective
SLn(Z)-orbits on V (Z) ∩ det−1(f ). The number of such projective orbits is equal to

2r1+r2−1 |Cl2(Of )|,

where (r1, r2) is the signature of the fraction ﬁeld of Of .

Proof. From Theorem 2.1, projective orbits V (Z)∩det−1(f ) are in bijection with pairs (J, δ), where
J is a fractional ideal of Of , δ ∈ K × and J 2 = δI n−3
. The set of such pairs is clearly in bijection

f

with H(Of ) by simply mapping (J, δ) to(cid:16)JI

follows immediately from Lemma 2.7.

− n−3
f

2

, δ(cid:17). The second assertion of the proposition now

2.5 Reducible elements in V (Z)

We say that an element (A, B) ∈ V (Q) is reducible if the quadrics in Pn−1(Q) corresponding to A
and B have a common isotropic subspace of dimension (n − 3)/2 in Pn−1(Q). The condition of
reducibility has the following arithmetic signiﬁcance:

Theorem 2.9. Let (A, B) be a projective element of V (Z) whose binary n-ic invariant is primitive,
irreducible, and nondegenerate, and let (J, δ) denote the corresponding pair as given by Theorem
2.1. Then (A, B) is reducible if and only if δ is a square in (Rf ⊗Z Q)×.

Proof. Suppose ﬁrst that δ = r2 is the square of an invertible element in (Rf ⊗ Q)×. By replacing
I with r−1I and δ with r−2δ, we may assume that δ = 1. Let α1, . . . α n−1
be a Z-basis for

n−3
2 ), and extend it to a basis α1, . . . , αn of I. It follows from (8) that, with
I ∩ (Z ⊕ Zθ ⊕ · · · ⊕ Zθ
these coordinates, we have aij = bij = 0 for 1 ≤ i, j ≤ (n − 1)/2, which is suﬃcient for (A, B) to be
reducible.

Now assume that (A, B) is reducible; we would like to prove that δ is a square. Let x1, x2, . . . , xn
denote a set of coordinates for Pn−1. By replacing (A, B) with an SLn(Q)-translate if necessary,
we may assume that the common isotropic subspace is the one generated by x1, . . . , x(n−1)/2. This
implies that aij = bij = 0 for 1 ≤ i, j ≤ (n − 1)/2. From (10) and (11), we see that the quantity
αiαj/δ is given by the ijth coordinate of the matrix

n−1

2

(C (k) + fn−k−2B + fn−k−1A) · θk

n−1

n−k−1

D :=

=

=

Xk=0
Xk=0(cid:16)
Xj=0
Xj,k≥0

j+k≤n−1

fn−k−j−1(BA−1)j(cid:17)A · θk

fn−j−k−1(BA−1)jA · θk

(15)

where f = f0xn + f1xn−1y + · · · + fnyn is the binary n-ic invariant of (A, B). (Note that A is
invertible because f is assumed to be irreducible, so f0 = det A 6= 0.)

We now prove that the 11-coeﬃcient d11 of D is a square using the fact that aij = bij = 0
for 1 ≤ i, j ≤ (n − 1)/2. This implies that δ = α2
1/d11 is a square as well. First, from (15), note
that the coeﬃcients of θn−1 and θn−2 of d11 are 0, since a11 = b11 = 0. We start with the following
lemma:

11

Lemma 2.10. The coeﬃcient of θn−3 in d11 is a square.

Proof. From (15) and the fact that a11 = b11 = 0, the coeﬃcient of θn−3 in d11 is equal to the
11-coeﬃcient of the matrix f0(BA−1)2A = f0BA−1B. Let M denote the cofactor matrix of A, i.e.,
the ij-coeﬃcient mij of M is equal to (−1)i+j times the determinant of the matrix obtained by
removing the ith row and the jth column of A. Then the coeﬃcient of θn−3 in d11 is equal to the
11-coeﬃcient of BM B, which is easily computed to be a square.

Next, we show that the constant coeﬃcient of d11 (considered as a polynomial in θ) is a square.

Lemma 2.11. The constant coeﬃcient d11(0) of d11(θ) is a square.

Proof. Because the binary n-ic invariant of (A, B) is f , we have det(Ax − By) = det(Ix −
BA−1y) det(A) = f (x, y). Since BA−1 satisﬁes its characteristic polynomial, we obtain

fn−j(BA−1)j = 0.

n

Xj=0

By (15), we compute d11(0) to be the 11-coeﬃcient of the matrix

n−1

Xj=0

(cid:16)

fn−j−1(BA−1)j(cid:17)A =(cid:16)
=(cid:16)

fn−(j+1)(BA−1)j+1(cid:17)AB−1A
fn−j(BA−1)j(cid:17)AB−1A − fnAB−1A.

= −fnAB−1A

n−1

n

Xj=0
Xj=0

Note that B is invertible because det B = fn 6= 0 since f is irreducible. The lemma now follows
from the proof of Lemma 2.10 and symmetry (and the fact that n is odd).

We next show that d11(m) is a square for every integer m, by applying Lemma 2.11 on the
pair (A, B − mA). Let g denote the binary n-ic invariant of the pair (A, B − mA), and let gk denote
the coeﬃcient of xn−kyk in g(x, y). We have

g(x, y) = det(Ax − (B − mA)y) = det(A(x + my) − By) = f (x + my, y).

As a consequence, we compute the gk to be

gk =

k

Xj=0(cid:18)n − j

k − j(cid:19)fjmk−j.

By applying Lemma 2.11 to (A, B − mA), we see that the 11-coeﬃcient of the following matrix is
a square:

n−1


Xj=0

= n−1
Xk=0

gn−j−1(BA−1 − mI)j
 A
gk(BA−1 − mI)n−k−1! A

12

k

n−1

n−1

n−1

n−k−1

=
k − j(cid:19)fjmk−j(cid:19)(BA−1 − mI)n−k−1
Xk=0(cid:18) k
Xj=0(cid:18)n − j
 A

=
Xk=0(cid:18) k
k − j(cid:19)fjmk−j(cid:19)(cid:18)n−k−1
Xj=0(cid:18)n − j
(−1)k+i(cid:18)n − k − 1
Xi=0

=
(−1)i+kfj(BA−1)imn−i−j−1(cid:18)n − j
Xk=0
Xj=0
Xi=0

=
(−1)k+i(cid:18)n − j
Xi,j≥0

= i+j≤n−1
Xi,j≥0

Xk=j
fj(BA−1)imn−i−j−1!A,

fj(BA−1)imn−i−j−1

i+j≤n−1

n−i−1

i

(cid:19)(BA−1)imn−k−i−1(cid:19)
 A

i

(cid:19)
k − j(cid:19)(cid:18)n − k − 1
 A
(cid:19)
k − j(cid:19)(cid:18)n − k − 1
 A

i

(16)

where the last equality is a consequence of the following lemma:

Lemma 2.12. For nonnegative integers n, i, and j satisfying i + j ≤ n − 1, we have

n−i−1

Xk=j

(−1)k+i(cid:18)n − j

k − j(cid:19)(cid:18)n − k − 1

i

(cid:19) = (−1)n+1.

Proof. By taking the ith derivative of both sides of the identity

(1 + x)n−j − 1

x

=

n−1

Xk=j

xn−k−1(cid:18)n − j
n − k(cid:19)

and setting x = −1, we obtain the lemma.

Comparing the formulas (16) and (15) with θ = m shows that d11(m) is a square for any
integer m. Since a polynomial that takes only square values on integers must itself be a square, it
follows that the 11-coeﬃcient of D is a square. This concludes the proof of Theorem 2.9.

For an order O, let I2(O) denote the 2-torsion subgroup of the ideal group of O, i.e., the
group of invertible fractional ideals I of O such that I 2 = O. Note that the group I2(O) is trivial
when O is maximal. We have the following result parametrizing elements of I2(O) for all primitive
orders O arising from integral binary n-ic forms.

Proposition 2.13. Let Of be an order corresponding to the integral primitive irreducible and
nondegenerate binary n-ic form f . Then I2(Of ) is in natural bijection with the set of projective
reducible SLn(Z)-orbits on V (Z) ∩ det−1(f ).

Proof. In Theorem 2.9 we proved that a projective SLn(Z)-orbit on V (Z) corresponding to the
pair (J, δ) is reducible exactly when δ is a square, say δ = κ2. The map from projective reducible
SLn(Z)-orbits on V (Z) ∩ det−1(f ) to I2(R) that sends such an orbit to κ−1JI
bijection.

is clearly a

− n−3
f

2

13

3 Counting irreducible integral orbits of bounded height

Let n ≥ 3 be a ﬁxed odd integer. Let V denote the (reducible) representation Sym2(n) ⊕ Sym2(n)
of SLn. For any ring R, we think of elements of V (R) as pairs (A, B) of n × n symmetric matrices
with entries aij and bij, respectively, in R, for 1 ≤ i ≤ j ≤ n. Let W denote the space Symn(2)
of binary n-ic forms. Then W (R) consists of elements f (x, y) = f0xn + f1xn−1y + · · · + fnyn with
fi ∈ R for 0 ≤ i ≤ n. Let π denote the invariant map

π : V (R) → W (R)

(A, B)

7→ det(Ax − By).

(17)

We deﬁne the following height function on W (R), and use it to deﬁne an SLn(R)-invariant height
function on V (R):

H(f0xn + · · · + fnyn)
H(A, B)

:=

|fi|;

n

max
i=0

:= H(π(A, B)).

(18)

Note that H is a homogeneous function of degree 1 on S(R) and is a homogeneous function of
degree n on V (R).

An element (A, B) ∈ V (Z) is said to be absolutely irreducible if it has nonzero discriminant,
has an invariant binary n-ic form that is irreducible over Q, and is not reducible in the sense of
Theorem 2.9. In this section, we use geometry-of-numbers methods to determine asymptotics for
the number of absolutely irreducible SLn(Z)-orbits on V (Z) having bounded height.

3.1 Construction of fundamental domains

Let W (R)nd denote the subset of nondegenerate binary n-ic forms in W (R). For 0 ≤ r2 ≤ (n−1)/2,
let W (R)(r2) denote the set of binary n-ic forms in W (R)nd that have r2 distinct pairs of complex
conjugate roots in P1
R. Let V (R)(r2) denote the set of elements in
V (R) whose image under π lies in W (R)(r2). In this subsection, we construct fundamental domains
for the action of SLn(Z) on V (R)(r2) for 0 ≤ r2 ≤ (n − 1)/2.

C and n − 2r2 distinct roots in P1

Fundamental sets for the action of SLn(R) on V (R)(r2)

First, we construct convenient fundamental sets for the action of SLn(R) on V (R)(r2). The number
of SLn(R)-orbits in π−1(f ) ⊂ V (R), for f ∈ W (R)(r2), depends only on r2. We denote it by
τ (r2). Then there exist fundamental sets R(r2) for the action of SLn(R) on V (R)(r2) that satisfy
the following two properties.

1. For every element f in W (R)(r2), there exist exactly τ (r2) elements in R(r2) having invariant

f .

2. The coeﬃcients of an element (A, B) ∈ R(r2) having height X are bounded by O(X 1/n),

where the implied constant is independent of (A, B).

These sets are constructed as follows: let f (x, y) = f0xn +· · ·+fnyn be an element in W (R)(r2)
∼= Rr1 × Cr2, where r1 = n − 2r2, independent of f .
having height 1 and with f0 6= 0. Then Rf
From Corollary 2.4, we see that the SLn(R)-orbits on those elements in V (R) with invariant f are in
bijection with square classes δ of R×
f having norm 1. There are precisely τ (r2) such square classes,
and we may uniformly choose representatives for δ to be those elements (±1)r1 × (1)r2 in Rr1 × Cr2
having norm 1.

14

We now consider the pair (A, B) of matrices corresponding to a pair (Rf , δ). We choose the
basis h1, θ, . . . , θn−1i for Rf . Then the corresponding pair (A, B) can be written down using (7)
and (8). From the deﬁnitions of θi and δ, it follows that φ(θi ⊗ θj) can be written as polynomials
of degree less than n in θ, whose coeﬃcients are polynomials in the fi and 1/f0. Since ζn−2 and
ζn−1 are polynomials in θ both with leading coeﬃcent f0, it follows that the coeﬃcients of A and
B are polynomials in the fi and 1/f0.

This construction produces a bounded set of pairs (A, B) corresponding to those f having
height 1 whose xn-coeﬃcient is absolutely bounded from below. To produce a bounded set L of
pairs (A, B) corresponding to the set of elements f ∈ W (R)(r2) having height 1, we choose for every
f , whose xn-coeﬃcient is less than 1/2 in absolute value, an element γ ∈ SL2(R) such that γ · f
has xn-coeﬃcient greater than 1/2 and such that γ has absolutely bounded coeﬃcients. (Such a
γ exists because f has height 1.) We construct the pairs (A, B) corresponding to γ · f , and take
γ−1 · (A, B) to be the pairs corresponding to f . Clearly this produces a bounded set L. We now
take R(r2) to be R>0 · L and easily check that it satisﬁes the two required conditions.

A fundamental domain for the action of SLn(Z) on SLn(R)

Let SLn(R) = N T K be the Iwasawa decomposition of SLn(R), where N ⊂ SLn(R) denotes the
set of unipotent lower triangular matrices, T ⊂ SLn(R) denotes the set of diagonal matrices, and
K = SOn(R) ⊂ SLn(R) is the maximal compact subgroup. Let S be a Siegel domain in SLn(R)
deﬁned as

where N ′ ⊂ N is a bounded set and T ′ ⊂ T is given by

S := N ′T ′K,

T ′ := {diag(t−1

n ) : t1/t2 > c, . . . , tn−1/tn > c},

1 , t−1

2 , . . . , t−1

for some suﬃciently small constant c > 0. This means that there exists a fundamental domain F
for the action of SLn(Z) on SLn(R) that is contained in S.

Fundamental domains for the action of SLn(Z) on V (R)(r2)

For h ∈ SLn(R), consider the multiset Fh · R(r2), where the multiplicity of B in Fh · R(r2) is
given by #{g ∈ F : B ∈ gh · R(r2)}. Similarly to the arguments in [5, §2.1], it follows that the
SLn(Z)-orbit of any v ∈ V (R) is represented #StabSLn(R)(v)/#StabSLn(Z)(v) times in this multiset
Fh · R(r2). Note that StabSLn(Z)(v) is nontrivial only for a measure 0 set of v in V (R), and the size
of StabSLn(R)(v) is constant for v ∈ V (R)(r2). Thus, the multiset Fh · R(r2) is a σ(r2)-cover of a
fundamental domain for the action of SLn(Z) on V (R)(r2), where σ(r2) is the size of the stabilizer
in SLn(R) of any v ∈ V (R)(r2).

For any SLn(Z)-invariant set S ⊂ V (Z)(r2) := V (R)(r2) ∩V (Z), let N (S; X) denote the number
of absolutely irreducible SLn(Z)-orbits on S that have height bounded by X. In Proposition 3.8,
we show that the number of absolutely irreducible SLn(Z)-orbits on V (Z) having height less than
X and nontrivial stabilizer in SLn(Z) is bounded by o(X n+1). Therefore, we have

N (S; X) =

1

σ(r2)

#{FhR(r2)(X) ∩ Sirr} + o(X n+1)

(19)

for any h in SLn(R), where R(r2)(X) denotes the elements in R(r2) having height bounded by X
and Sirr denotes the set of absolutely irreducible elements in S.

15

The main diﬃculty of counting integer points in the region FhR(r2)(X) is that this region is
not compact. We simplify the counting by averaging (19) over all h lying in a bounded subset G0
of SLn(R).

3.2 Averaging and cutting oﬀ the cusp

Let G0 be a bounded open K-invariant ball in SLn(R). Averaging (19) over h ∈ G0 we obtain:

N (S; X) =

1

σ(r2)Vol(G0)Zh∈G0

#{FhR(r2)(X) ∩ Sirr} dh,

(20)

for any Haar measure dh on SLn(R), and where the volume of G0 is computed with respect to dh.
We use (20) to deﬁne N (S; X) even when S is not SLn(Z)-invariant. By an argument identical to
the proof of [5, Theorem 2.5], we obtain

N (S; X) =

1

σ(r2)Vol(G0)Zh∈F

#{hG0 · R(r2)(X) ∩ Sirr} dh.

(21)

To estimate the number of integral points in the bounded region hG0 · R(r2)(X), we use the

following result of Davenport [11].

Proposition 3.1. Let R be a bounded, semi-algebraic multiset in Rn having maximum multiplicity
m, and that is deﬁned by at most k polynomial inequalities each having degree at most ℓ. Then the
number of integral lattice points (counted with multiplicity) contained in the region R is

Vol(R) + O(max{Vol( ¯R), 1}),

where Vol( ¯R) denotes the greatest d-dimensional volume of any projection of R onto a coordinate
subspace obtained by equating n − d coordinates to zero, where d takes all values from 1 to n − 1.
The implied constant in the second summand depends only on n, m, k, and ℓ.

We need to divide the fundamental domain F into a “main body” and “cusps” (in this case,
just a single cusp). Let F ′ ⊂ F be the set consisting of h ∈ F such that the a11-coeﬃcient of every
(A, B) ∈ hG0 · R(r2)(X) is less than 1 in absolute value. We will use F ′ · R(r2)(X) as the cusp and
(F \ F ′) · R(r2)(X) as the main body.

Few points in the cusp

We shall now prove that the number of absolutely irreducible integral points in the cusp is negligible
and thus only need to count points in the main body. First, we need to ﬁnd suﬃcient conditions
to guarantee that an element (A, B) ∈ V (Z) is not absolutely irreducible:

Proposition 3.2. Let (A, B) ∈ V (Z) be such that all the variables in one of the following sets
vanish:

1. {aij, bij : 1 ≤ i ≤ m, 1 ≤ j ≤ n − m} for some 1 ≤ m ≤ n − 1.

2. {aij, bij : 1 ≤ i, j ≤ (n − 1)/2}.

Then (A, B) is not absolutely irreducible.

16

Proof. If (A, B) satisﬁes condition 1, then it is easy to see that the binary n-ic invariant of (A, B) has
a repeated factor over Q. Thus, the discriminant of the form vanishes. If (A, B) satisﬁes condition 2,
then clearly the quadratic forms A and B have a common isotropic subspace of dimension (n−1)/2.
In either case, the pair (A, B) is not absolutely irreducible.

Proposition 3.3. We have the bound

#{hG0 · R(r2)(X) ∩ V (Z)irr} dh ≪ X n+1− 1
n .

Zh∈F ′

Proof. Let Var denote the set {aij, bij : 1 ≤ i ≤ j ≤ n} of entries of A and B. We may think of
elements in Var as functions on V (R) in the obvious way.

We would like to bound

Zh∈F ′

#{v ∈ hG0 · R(r2)(X) ∩ V (Z)irr : a11(v) = 0} dh

(22)

by O(X n+1− 1
n ). Note that this integral is the same as that in the statement of the proposition,
since a11 = 0 for integral points in hG0 · R(r2)(X) for h ∈ F ′. Let BX denote the set G0 · R(r2)(X).
Since the fundamental domain F is contained in the Siegel domain S, we have

Zh∈F

#{h · BX ∩ V (Z)irr : a11 = 0} dh ≪ Zh∈S
≪ Zt∈T ′

#{h · BX ∩ V (Z)irr : a11 = 0} dh

#{t · BX ∩ V (Z)irr : a11 = 0}η(t) d×t,

(23)

where

n−1

η(t) d×t =

t2k−2n
k

dtk
tk

.

Yk=1

Recall that the condition for t = (t−1
1 ≤ i ≤ n − 1. To simplify our computations, we use a change of variables:
1 ≤ i ≤ n − 1. With these coordinates, the term in the last line of (23) is

n ) to be an element of T ′ is that ti/ti+1 > c for
let si = ti/ti+1 for

1 , . . . , t−1

where

n−1

Zs∈T ′

#{s · BX ∩ V (Z)irr : a11 = 0}η′(s) d×s,

η′(s) d×s =

s−k(n−k)
k

dsk
sk

Yk=1

and s = (s1, . . . , sn−1) is contained in T ′ if and only if si > c for each i.

For α ∈ Var, we deﬁne the weight w(α) to be the rational monomial in the si by which the
action of (s1, . . . , sn−1) scales α. It is easy to see that w(aij) = w(bij ) for all 1 ≤ i, j ≤ n and

that Qα∈Var w(α) = 1. We deﬁne a partial ordering on Var by setting w(α1) . w(α2) whenever

w(α2)/w(α1) is a product of nonnegative powers of si for each i. The variables a11 and b11 have
minimal weights under this partial ordering. We multiplicatively extend the function w to products
of integral powers of elements in Var.

For any subset U ⊂ Var, let M (U ) be the set of minimal elements in Var \ U under the partial
ordering. Let V (Z)(U ) denote the set of v ∈ V (Z) such that α(v) = 0 for α ∈ U and |α(v)| ≥ 1 for
α ∈ M (U ). To prove the proposition, it suﬃces to prove that we have

#{s · BX ∩ V (Z)(U )}η′(s) d×s ≪ X n+1− 1

n

(24)

Zs∈T ′

17

for every U ⊂ Var containing a11 such that U does not contain any of the sets of Proposition 3.2.
For a subset U of Var, let V (R)[U ] denote the set of elements v ∈ V (R) such that α(v) = 0
for all α ∈ U . Let T (U ) ⊂ T ′ denote the set of elements s ∈ T ′ such that s · BX ∩ V (Z)(U ) is
nonempty. Then s ∈ T (U ) only when the projection of s · BX onto every coordinate α ∈ Var \ U
is ≫ 1. Therefore, by Proposition 3.1, we have

Zs∈T ′

#{s · BX ∩ V (Z)(U )}η′(s) d×s ≪ Zs∈T (U )
≪ Zs∈T (U )
≪ Zs∈T (U )

Vol(s · BX ∩ V (R)[U ])η′(s) d×s

X n+1−#U/n(cid:16) Yα∈Var\U
X n+1−#U/n(cid:16)Yα∈U

w(α)(cid:17)η′(s) d×s
w(α)−1(cid:17)η′(s) d×s.

Furthermore, the set s · BX ∩ V (Z)(U ) is empty unless X 1/nw(α) ≫ 1 for each α 6∈ U . It follows
that

Zs∈T ′

#{s·BX∩V (Z)(U )}η′(s) d×s ≪Zs∈T (U )

for any nonnegative real numbers kα.

X n+1− #U

n + P kα

n (cid:16)Yα∈U

w(α)−1(cid:17)(cid:16)Yα6∈U

w(α)kα(cid:17)η′(s) d×s,

(25)

We now have the following lemma proving the desired bound for certain sets U ⊂ Var:

Lemma 3.4. Let U0 ∈ Var denote the set

U0 := {aij, bij : 1 ≤ i ≤ j ≤ m = (n − 1)/2}.

Then (24) holds for every set U ⊂ U0 containing a11.

Proof. For α = aij ∈ U0 or α = bij ∈ U0, deﬁne ρ(α) to be aim. For α ∈ U0, it is easy to check that
w(α−1)w(ρ(α)) is a product of nonnegative powers of si for 1 ≤ i ≤ n − 1. Therefore, from (25),
we have

#{s · BX ∩ V (Z)(U )}η′(s) d×s

Zs∈T ′
≪ Zs∈T (U )
≪ Zs∈T (U )

≪ X n+1− 1

≪ X n+1− 1
n ,

X n+1− 1

X n+1− 1

n Zs∈T ′

w(ρ(α))
w(ρ(α))

w(α)−1!
n  Yα∈U
 Yα∈U \{a11}
n 

w(α)−1
 Yα∈U0
 Yα∈U0\{a11}

w(a1m)−1 m−1
! η′(s) d×s
Yk=1

sk(k+1)
k

 η′(s) d×s
 η′(s) d×s

where the last inequality follows because the power of sk in

is negative for each k.

sk(k+1)
k

(cid:17)η′(s)

w(a1m)−1(cid:16)

m−1

Yk=1

18

We now prove (24) in the general case. First note that if α ∈ U , then we may assume that U
is closed under ., i.e., β ∈ U for all β . α. Indeed, if this were not the case, then the bound for
the set corresponding to U would follow from the bound on the set corresponding to U ∪ {β}\{α}.
In particular, we may assume that aij ∈ U if and only if bij ∈ U . Let U1 denote the set

U1 := {aij, bij : i + j ≤ n − 1, (i, j) 6= (m, m)},

where m = (n − 1)/2. Then, from Proposition 3.2, we can assume that U ⊂ U1. To every α ∈ U1,
we now deﬁne ρ(α) to be a product of coeﬃcients in Var \ U1, where each coeﬃcient is raised to a
nonnegative real number:

ρ(aij) = ρ(bij) :=

ai,n−i

(ai,n−iaj,n−j)1/2
(ai,n−iam,m)1/2
(ai,n−ian−j,j)1/2

if 1 = j ≤ m − 1;

if i < j ≤ m − 1;

if i < j = m, m + 1;

if 1 ≤ i ≤ m − 2, m + 2 ≤ j ≤ n − 1 − i.

(26)




Then we have the following lemma regarding ρ, which follows from an elementary computation.

Lemma 3.5. We have

1. The weight w(a−1

ij ρ(aij)) is a product of nonnegative powers of the si for (i, j) in the ﬁrst,

second, and fourth cases of (26).

2. The weight w(a−1

ima−1

i,m+1ρ(aim)ρ(ai,m+1)) is a product of nonnegative powers of the si.

3. The product

Yα∈U1

tm (cid:17)n−3
w(α)−1w(ρ(α)) = (cid:16) tm+1
=  m−1
Yk=1

sk(n−k)
k

m−1

Yk=1(cid:18) tk
! s

tn−k(cid:19)n−2k+1
  n−2
Yk=m+1

(n−1)(n−3)

4

m

s(k+1)(n−k−1)
k

!

Therefore, if U ⊂ U1 is closed under ., then

 Yα∈U

w(α)−1w(ρ(α))!.  m−1
Yk=1

sk(n−k)
k

! s

(n−1)(n−3)

4

m

  n−2
Yk=m+1

s(k+1)(n−k−1)
k

!!

is a product of nonpositive powers of si.

We now conclude the proof of Lemma 3.4 by noting that if U ⊂ U1 is a set of coeﬃcients
closed under . such that a11 ∈ U and U 6⊂ U0, then (25) and the ﬁrst two parts of Lemma 3.5
imply that

Zs∈T ′

#{s·BX∩V (Z)(U )}η′(s) d×s ≪Zs∈T (U )

X n+1− 1

n(cid:16)Yα∈U

w(α)−1(cid:17)(cid:16)Yα6∈U

w(ρ(α))(cid:17)w(amm)−1η′(s) d×s.

Proposition 3.3 follows because the powers of si appearing in

(cid:16)Yα∈U

w(α)−1(cid:17)(cid:16)Yα6∈U

w(ρ(α))(cid:17)w(amm)−1η′(s)

are all negative.

19

Points in the main body

We have shown that the number of absolutely irreducible integral points in the cusp is negligible.
To obtain a count of the number of absolutely irreducible integral points in the main body, we ﬁrst
show that the total number of integral points in the main body is well approximated by the volume
of the fundamental domain F · R(r2)(X), and then check that the number of reducible elements in
the main body is negligible.

Proposition 3.6. We have

1

Vol(G0)Zh∈(F \F ′)

#{hG0 · R(r2)(X) ∩ V (Z)} dh = Vol(F · R(r2)(X)) + o(X n+1).

Proof. The coeﬃcients a11 and b11 have minimal weight among all the coeﬃcients. Furthermore,
for h ∈ F \F ′, the length of the projection of hG0 ·R(r2)(X) onto the a11- and b11-lines are bounded
away from 0 by the deﬁnition of F ′. Therefore, for h ∈ F \ F ′, all smaller dimensional projections
of hG0 · R(r2)(X) are bounded by a constant times its projection onto either the a11 = 0 hyperplane
or the a11 = b11 = 0 hyperplane. Proposition 3.1 thus implies that

Vol(G0)Zh∈(F \F ′)
Vol(G0)Zh∈(F \F ′)

1

1

1

#{hG0 · R(r2)(X) ∩ V (Z)} dh

Vol(hG0 · R(r2)(X)) dh + O(X (n2+n−1)/n)

=

=

Vol(F)Vol(G0 · R(r2)(X)) + o(X n+1),

Vol(G0)

where the ﬁnal equality follows since Vol(F ′) tends to zero as X tends to inﬁnity, and Vol(hG0 ·
R(r2)(X)) is independent of h. The proposition now follows from the Jacobian change of variables
in Theorem 5.1.

We now show that the number of reducible elements in the main body is negligible.

Proposition 3.7. We have

Zh∈(F \F ′)

#{hG0 · R(r2)(X) ∩ V (Z)red} dh = o(X n+1).

Proof. For each prime p, let V (Fp)irr denote the set of elements in v ∈ V (Fp) such that any lift
˜v ∈ V (Z) is absolutely irreducible. Every element in V (Fp), having irreducible resolvent form,
that corresponds to a nonidentity element in K ×/(K ×)2
N ≡1, under the bijection of Corollary 2.4,
belongs to V (Fp)irr. Therefore, there exists a constant 0 < c < 1 independent of p such that
#V (Fp)irr ≫ c#V (Fp). It follows that for every Y > 0, there exists a suﬃciently large X such that

Zh∈(F \F ′)

#{hG0 ·R(r2)(X)∩ V (Z)red} dh = O(cid:16)X n+1 ·Yp<Y(cid:0)1−

#V (Fp)irr

#V (Fp) (cid:1)(cid:17) = O(cid:0)X n+1 Yp<Y

(1− c)(cid:1).

Letting Y tend to inﬁnity, we obtain the proposition.

We may similarly show that the number of absolutely irreducible integral elements in V (Z)

that have nontrivial stabilizer in SLn(Z) and bounded height is negligible:

20

Proposition 3.8. Let V (Z)bigstab denote the set of elements in V (Z) that have nontrivial stabilizer
in SLn(Z). Then

N (V (Z)bigstab) = o(X n+1).

The proof of Proposition 3.8 exactly follows that of Proposition 3.7 since a positive proportion,

independent of p, of elements in V (Fp) have trivial stabilizer in SLn(Fp) from Corollary 2.4.

We thus have the following theorem:

Theorem 3.9. We have

N (V (Z)(r2); X) =

1

σ(r2)

Vol(F · R(r2)(X)) + o(X n+1).

4 Sieving to projective elements

Let W (Z)(r2),prim ⊂ W (Z)(r2) denote the subset of primitive elements, and let W (Zp)prim ⊂ W (Zp)
denote the set of elements that are not divisible by p. Then from the tail estimate obtained from
[4, Theorem 3.3] in conjunction with the usual inclusion-exclusion sieve, we obtain the following
theorem.

Theorem 4.1. We have

#{f ∈ W (Z)(r2),prim : H(f ) < X} = Vol(W (R)(r2)

X )Yp

Vol(W (Zp)prim) + o(X n+1),

where the volumes of sets in W (Zp) are computed with respect to the Euclidean measure normalized
so that W (Zp) has measure 1.

Let V (Z)(r2),proj ⊂ V (Z)(r2) denote the set of projective elements (A, B) whose binary n-ic
invariants are primitive. In this section, we determine asymptotics for N (V (Z)(r2),proj, X). Recall
that projectivity is a local condition. We deﬁne V (Zp)proj to be the set of elements (A, B) ∈ V (Zp)
whose binary n-ic invariants are not divisible by p, and which correspond to a pair (J, δ) such that
J 2 = (δ). Then

Our next goal is to prove the following theorem.

V (Z)(r2),proj = V (Z)(r2)\(cid:0)\p

V (Zp)proj(cid:1).

Theorem 4.2. We have

N (V (Z)(r2),proj, X) =

1

σ(r2)

Vol(F · R(r2)(X))Yp

Vol(V (Zp)proj) + o(X n+1),

where the volumes of sets in V (Zp) are computed with respect to the Euclidean measure normalized
so that V (Zp) has measure 1.

4.1 Uniform tail estimates

For a prime p, let Wp denote the set of elements in V (Z) that do not belong to V (Zp)proj. We have
the following theorem:

21

Theorem 4.3. We have

N (∪p≥M Wp, X) = O(X n+1/M 1+ǫ) + o(X n+1)

where the implied constant is independent of X and M .

Proof. If (A, B) ∈ Wp gives rise to the binary n-ic form f , then the ring Rf is nonmaximal at
p, which implies that p2 | ∆(A, B) = ∆(f ). Let (A, B) ∈ Wp, regarded as an element of V (Zp),
correspond to a pair (J, δ) with J 2 6= (δ)If . Then the reduction of (A, B) modulo p corresponds to
the pair (J ⊗ Fp, δ), where δ is the reduction of δ modulo p. From Nakayama’s lemma, it follows
that J 2 ⊗ Fp 6= (δ)If ⊗ Fp.

Let (A1, B1) ∈ V (Z) be any element congruent to (A, B) modulo p. Denote the binary n-ic
form associated to (A1, B1) by f1. If (A1, B1) corresponds to the pair (J1, δ1), then it follows (again
from Nakayama’s lemma) that J 2

1 6= (δ1)If1. Thus (A1, B1) ∈ Wp.

Also, the set of elements in Wp whose binary n-ic invariants are divisible by p is the preimage
under V (Zp) → V (Fp) of the set of elements in V (Fp) having binary n-ic invariant 0. It follows
that Wp is deﬁned via congruence conditions modulo p, i.e., the set Wp is the preimage of some
subset of V (Fp) under the reduction modulo p map.

To prove the theorem, we start with the fundamental domain F chosen in §3. For every
0 < ǫ < 1, we pick a set F (ǫ) ⊂ F which is open and bounded and whose measure is (1 − ǫ) times
the measure of F. Let R be the union of the R(r2) over all possible splitting types (r2), and let
RX denote the set of elements in R having height bounded by X. Then we have

#{F (ǫ) · RX ∩ (∪p≥M Wp)} = O(X n+1/M log M )

from an immediate application of [4, Theorem 3.3]. We further obtain

#{(F\F (ǫ)) · RX ∩ V (Z)irr} = O(ǫX n+1)

from the methods of the previous section. The theorem follows.

Theorem 4.2 now follows from Theorem 4.3 just as [5, Theorem 2.21] follows from [5, Theorem

2.13].

4.2 Squarefree sieves

Let W (Z)(r2),sf and V (Z)(r2),sf denote the set of elements in W (Z)(r2) and V (Z)(r2), respectively,
having squarefree discriminants. Let W (Zp)sf and V (Zp)sf denote the set of elements in W (Zp) and
V (Zp), respectively, whose discriminants are not divisible by p. The following theorem is proved in
[6]:

Theorem 4.4. We have

#{f ∈ W (Z)(r2),sf : H(f ) < X} = Vol(W (R)(r2)

X )Yp

Vol(V (Zp)sf ) + o(X n+1),

where the volumes of sets in W (Zp) are computed with respect to the Euclidean measure normalized
so that W (Zp) has measure 1.

The analogous result for V (Z) is as of yet unknown. However, work of Granville [16] and

Poonen [20] implies the result conditional on the ABC conjecture:

22

Theorem 4.5. Assume the ABC conjecture. Then we have

N (V (Z)(r2),sf, X) =

1

σ(r2)

Vol(F · R(r2)(X))Yp

Vol(V (Zp)sf ) + o(X n+1),

where the volumes of sets in V (Zp) are computed with respect to then Euclidean measure normalized
so that V (Zp) has measure 1.

5 Proof of the main theorems

In this section, we prove Theorems 2 and 4. To do so, we study the local volumes that arise in
Theorems 4.1, 4.2, 4.4 and 4.5 in order to count the number of primitive (or squarefree) SLn(Z)-
equivalence classes of absolutely irreducible integral pairs of n-ary quadratic forms of bounded
height as well as the number of projective (respectively, squarefree) irreducible integral binary n-
ic forms of bounded height. We relate the local volumes of V (Zp)proj (and V (Zp)sf ) to those of
W (Zp)prim (resp. W (Zp)sf ) so that the quotient W (Zp)prim/V (Zp)proj (resp. W (Zp)sf /V (Zp)sf ) is
easy to compute, in terms of the size of stabilizers in SLn(Zp) of pairs of n-ary quadratic forms (see
Corollary 5.2). Following a similar strategy for the inﬁnite places, we then use the description of
these stabilizers from §2.3 to conclude the main results.

5.1 Computing the product of local volumes

We ﬁrst prove a statement about the “compatibility of measures” and use it to compute the volume
of F · R(X) and the volumes of V (Zp)sf and V (Zp)proj. Let dv and df denote Euclidean measures
on V and W , respectively, normalized so that V (Z) and W (Z) have covolume 1. Let ω be an
algebraic diﬀerential form that generates the rank 1 module of top-degree left-invariant diﬀerential
forms on SLn over Z. We start with the following theorem, whose proof is identical to that of [5,
Props. 3.11 & 3.12].

Theorem 5.1. Let T be R, C, or Zp for some prime p. Let s : W (T ) → V (T ) be a continuous
function such that the invariant binary n-ic of wf := s(f ) is f . Then there exists a rational nonzero
constant J such that for any measurable function φ on V (T ), we have

Zv∈SLn(T )·s(W (T ))
ZV (T )

φ(v) dv = |J |ZW (T )ZSLn(T )
φ(v) dv = |J |Zf ∈W (T )
∆(f )6=0(cid:16) Xv∈

V (T )(f )
SLn(T )

φ(g · wf ) ω(g) df

1

|StabSLn(T )(v)|Zg∈SLn(T )

φ(g · v)ω(g)(cid:17) df

where we regard SLn(T ) · s(R) as a multiset and V (T )(f )
action of SLn(T ) on elements in V (T ) having invariant f .

SLn(T ) denotes a set of representatives for the

For r2 ∈ {1, . . . , (n − 1)/2} and for f ∈ V (Zp) we deﬁne local masses

mp(f ) :=

f )2)N ≡1|

|(R×

f /(R×
|R×

f [2]N ≡1|

and m∞(r2) := (cid:12)(cid:12)(cid:12)(cid:16)(Rn−2r2 × Cr2)×/(cid:0)(Rn−2r2 × Cr2)×(cid:1)2(cid:17)N ≡1(cid:12)(cid:12)(cid:12)

|(Rn−2r2 × Cr2)×[2]N ≡1|

We may now write the volumes of F · R(X) in terms of m∞ and the volume of W (R)X, as well
as the volumes of V (Zp)proj (resp. V (Zp)sf ) in terms of the volumes of W (Zp)prim (resp. W (Zp)sf )
and the values mp(f ).

23

Corollary 5.2. We have

1

σ(r2)

Vol(F · R(r2)(X)) = |J |m∞(r2)Vol(F)Vol(W (R)(r2)

X ),

Vol(V (Zp)proj) = |J |Vol(SLn(Zp))Zf ∈W (Zp)prim
Vol(V (Zp)sf ) = |J |Vol(SLn(Zp))Zf ∈W (Zp)sf

mp(f ) df,

mp(f ) df,

where the volume of F is computed with respect to ω.

Proof. The ﬁrst equality follows immediately from Theorem 5.1. To obtain the second equality,
note that Theorem 5.1 implies

ZV (Zp)proj

dv = |J |Vol(SLn(Zp))ZW (Zp)prim Xv∈ det−1(f )

SLn(Zp)

1

|StabSLn(Zp)(v)|

dv,

where the sum runs over representatives in projective SLn(Zp)-orbits of det−1(f ). The result now
follows from Corollary 2.6. The proof of the third equality is identical.

It is easy to compute m∞(r2). By Corollary 2.4 and Example 2.5, the numerator of m∞(r2) is
2n−2r2−1 and the denominator is the size σ(r2) = 2n−r2−1 of the stabilizer in SLn(R) of any element
of V (R)(r2). We thus have

m∞(r2) = 2−r2.

(27)

In [7, Lemma 22], the values of mp(f ) are computed for cubic rings. We now compute these values
for degree n rings using a similar argument.

Lemma 5.3. Let R be a nondegenerate ring of degree n over Zp. Then

|(R×/(R×)2)N ≡1|

|R×[2]N ≡1|

(28)

is 1 if p 6= 2 and 2n−1 if p = 2.

Proof. The unit group of R× is the direct product of a ﬁnite abelian subgroup and Zn
norm 1 part R×

N ≡1 is also a direct product of a ﬁnite abelian group and Zn−1

p , and the
. Since the expression

p

|G/G2|
|G[2]|

(analogous to (28)) takes the value 1 for G a ﬁnite abelian group and for G = Zn
value of (28) is 1 for p 6= 2. When p = 2, because 2 is not a unit in Z2, the Z2-module 2Zn−1
index 2n−1 in Zn−1

instead, implying that (28) evaluates to 2n−1.

p when p 6= 2, the
has

2

2

It follows that for a ﬁxed prime p, the value of mp(f ) is independent of f ∈ V (Zp)prim. We

denote this value by mp.

24

5.2 Proof of Theorem 4

From Propositions 2.8 and 2.13, we know that

N (V (Z)(r2),proj, X) = Xf ∈W (Z)

(r2),prim
X

2r1+r2−1|Cl2(Of )| − |I2(Of )|.

To compute the average size, we compute

Xf ∈W (Z)

(r2),prim
X

lim
X→∞

2r1+r2−1|Cl2(Of )| − |I2(Of )|

Xf ∈W (Z)(r2),prim

X

1

= lim
X→∞

N (V (Z)(r2),proj, X)

#W (Z)(r2),prim

X

.

By Theorems 4.1 and 4.2, we see that

lim
X→∞

N (V (Z)(r2),proj, X)

#W (Z)(r2),prim

X

= lim
X→∞

and by Corollary 5.2, we obtain

1

σ(r2) Vol(F · R(r2)(X))Yp

Vol(W (R)(r2)

X )Yp

Vol(V (Zp)proj)

Vol(W (Zp)prim)

,

1

σ(r2) Vol(F · R(r2)(X))Yp

Vol(W (R)(r2)

lim
X→∞

Vol(V (Zp)proj)

Vol(W (Zp)prim)

X )Yp

= t(SLn(Q)) · m∞(r2)Yp

mp

where t(SLn(Q)) := Vol(SLn(Z)\SLn(R))Qp SLn(Zp) is the Tamagawa number of SLn(R), which

is known to be 1. Substituting in the values of m∞ and mp by Lemma 5.3 and equation (27), we
conclude that

Xf ∈W (Z)

(r2 ),prim
X

lim
X→∞

2r1+r2−1|Cl2(Of )| − |I2(Of )|

Xf ∈W (Z)

(r2),prim
X

1

= 2n−1−r2.

Theorem 4 then follows by dividing both sides of the above equation by 2r1+r2−1 = 2n−1−r2.

(cid:3)

5.3 Proof of Theorem 2 and Corollary 3

Proof of Theorem 2. In the case of squarefree discriminant, we know that any f ∈ W (Z)(r2),sf
corresponds to a maximal order Of , and so |I2(Of )| = 1. In combination with Propositions 2.8
and 2.13, we have that

X

lim
X→∞

Xf ∈W (Z)

(r2 ),sf
X

2r1+r2−1|Cl2(Of )| − 1

Xf ∈W (Z)

(r2),sf
X

1

25

= lim
X→∞

N (V (Z)(r2),sf , X)

#W (Z)(r2),sf

X

.

By Theorems 4.4 and 4.5, we know that

lim
X→∞

N (V (Z)(r2),sf, X)

#W (Z)(r2),sf

X

= lim
X→∞

1

σ(r2) Vol(F · R(r2)(X))Yp

Vol(V (Zp)sf )

X )Yp

Vol(W (R)(r2)

Vol(W (Zp)sf )

,

conditional on the ABC conjecture for n 6= 3. Using Lemma 5.3 and equation (27), an identical
argument to that in the proof of Theorem 4 allows us to conclude that

lim
X→∞

Xf ∈W (Z)

(r2),sf
X

|Cl2(Of )|

Xf ∈W (Z)

(r2),sf
X

1

= 1 +

1

2n−1−r2

.

Proof of Corollary 3. Fix a signature (r1, r2), and suppose a lower proportion than 1 − 21−r1−r2 of
ﬁelds of signature (r1, r2) whose ring of integers correspond to a binary n-ic form have odd class
number. This implies that a larger proportion than 21−r1−r2 of such ﬁelds would have nontrivial
2-torsion in their class group and thus have |Cl2| ≥ 2. Then the limsup of the mean number of 2-
torsion elements in class groups of such ﬁelds would be strictly larger than 1+ 1
2n−1−r2 , contradicting
Theorem 2.

References

[1] Manjul Bhargava. Higher composition laws. II. On cubic analogues of Gauss composition.

Ann. of Math. (2), 159(2):865–886, 2004.

[2] Manjul Bhargava. The density of discriminants of quartic rings and ﬁelds. Ann. of Math. (2),

162(2):1031–1063, 2005.

[3] Manjul Bhargava. Most hyperelliptic curves over Q have no rational points, 2013.

http://arxiv.org/abs/1308.0395.

[4] Manjul Bhargava. The geometric squarefree sieve and unramiﬁed nonabelian extensions of

quadratic ﬁelds, 2014. http://arxiv.org/abs/1402.0031.

[5] Manjul Bhargava and Arul Shankar. Binary quartic forms having bounded invariants, and the
boundedness of the average rank of elliptic curves. Ann. of Math. (2), 181(1):191–242, 2015.

[6] Manjul Bhargava, Arul Shankar, and Xiaoheng Wang. Squarefree values of polynomial dis-

criminants II. in progress.

[7] Manjul Bhargava and Ila Varma. On the mean number of 2-torsion elements in the class
groups, narrow class groups, and ideal groups of cubic orders and ﬁelds. Duke Math. J.,
164(10):1911–1933, 2015.

[8] Manjul Bhargava and Ila Varma. The mean number of 3-torsion elements in the class
groups and ideal groups of quadratic orders. Proceedings of the London Mathematical So-
ciety, 112(2):235–266, 2016.

26

[9] H. Cohen and H. W. Lenstra, Jr. Heuristics on class groups of number ﬁelds. In Number theory,
Noordwijkerhout 1983 (Noordwijkerhout, 1983), volume 1068 of Lecture Notes in Math., pages
33–62. Springer, Berlin, 1984.

[10] H. Cohen and J. Martinet. Class groups of number ﬁelds: numerical heuristics. Math. Comp.,

48(177):123–137, 1987.

[11] H. Davenport. On a principle of Lipschitz. J. London Math. Soc., 26:179–183, 1951.

[12] H. Davenport and H. Heilbronn. On the density of discriminants of cubic ﬁelds. Bull. London

Math. Soc., 1:345–348, 1969.

[13] B. N. Delone and D. K. Faddeev. The theory of irrationalities of the third degree. Translations
of Mathematical Monographs, Vol. 10. American Mathematical Society, Providence, R.I., 1964.

[14] ´Etienne Fouvry and J¨urgen Kl¨uners. On the 4-rank of class groups of quadratic number ﬁelds.

Invent. Math., 167(3):455–513, 2007.

[15] Wee Teck Gan, Benedict Gross, and Gordan Savin. Fourier coeﬃcients of modular forms on

G2. Duke Math. J., 115(1):105–169, 2002.

[16] Andrew Granville. ABC allows us to count squarefrees. Internat. Math. Res. Notices, (19):991–

1009, 1998.

[17] Gaston Julia. ´Etude sur les formes binaires non quadratiques `a ind´etermin´ees r´eelles ou com-
plexes. M´emoires de l’Acad´emie des Sciences de l’Institut de France, 55:1–296, 1917. also in
Julia’s Œuvres vol. 5.

[18] Gunter Malle. On the distribution of class groups of number ﬁelds. Experiment. Math.,

19(4):465–474, 2010.

[19] Jin Nakagawa. Binary forms and orders of algebraic number ﬁelds. Invent. Math., 97(2):219–

235, 1989.

[20] Bjorn Poonen. Squarefree values of multivariable polynomials. Duke Math. J., 118(2):353–373,

2003.

[21] Melanie Matchett Wood. Rings and ideals parameterized by binary n-ic forms. J. Lond. Math.

Soc. (2), 83(1):208–231, 2011.

[22] Melanie Matchett Wood. Parametrization of ideal classes in rings associated to binary forms.

J. Reine Angew. Math., 689:169–199, 2014.

27

