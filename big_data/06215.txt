6
1
0
2

 
r
a

 

M
0
2
 
 
]

.

C
A
h
t
a
m

[
 
 

1
v
5
1
2
6
0

.

3
0
6
1
:
v
i
X
r
a

WHICH SERIES ARE HILBERT SERIES OF GRADED

MODULES OVER POLYNOMIAL RINGS?

LUKAS KATTHÄN, JULIO JOSÉ MOYANO-FERNÁNDEZ, AND JAN ULICZKA

Dedicated to Winfried Bruns on the occasion of his 70th birthday

Abstract. Let S be a multigraded polynomial ring such that the degree of
each variable is a unit vector; so S is the homogeneous coordinate ring of a
product of projective spaces. In this setting, we characterize the formal Laurent
series which arise as Hilbert series of ﬁnitely generated S-modules.

Also we provide necessary conditions for a formal Laurent series to be the
Hilbert series of a ﬁnitely generated module with a given depth. In the bigraded
case (corresponding to the product of two projective spaces), we completely
classify the Hilbert series of ﬁnitely generated modules of positive depth.

1. Introduction

Let K be a ﬁeld. We consider the polynomial ring R = K[X1, . . . , Xm] in m
indeterminates equipped with a Zn-grading, such that the degree of each variable
is one of the unit vectors ei of Zn. This setup includes the standard N-grading,
as well as the ﬁne grading, where m = n and deg Xi = ei for i ∈ [n].

Let M =La∈Zn Ma be a ﬁnitely generated Zn-graded R-module. The ✿✿✿✿✿✿✿✿

series of M is the formal Laurent series

Hilbert

✿✿✿✿✿✿

HM := Xa∈Zn

(dimK Ma) · ta ∈ Z((t1, . . . , tn)),

1 · · · tan

where we set ta := ta1
n for a = (a1, . . . , an). This is well-deﬁned, because
the graded components Ma of M are ﬁnite-dimensional K-vector spaces, and,
since R is positively graded, there exists a b ∈ Zn such that Ma = 0 if a (cid:3) b
(componentwise). The Hilbert series is known to carry important information
about M, for example its dimension or its multiplicity. In the present work, we
consider the following question:

Question 1.1. Which formal Laurent series arise as Hilbert series of R-modules
(in a certain class)?

An obvious property of Hilbert series is that all their coeﬃcients are nonneg-
If we allow non–ﬁnitely generated modules then this is already all that

ative.

can be said: Any nonnegative series H = Pa cata is the Hilbert series of the
R–module La (R/m) (−a)ca, for m = (X1, . . . , Xm).

2010 Mathematics Subject Classiﬁcation. Primary: 13C05; Secondary: 05E40, 13A02.
Key words and phrases. Hilbert series, Hilbert polynomial, Multigrading, Polynomial ring.
The ﬁrst author was partially supported by the German Research Council DFG-GRK 1916.
The second author was partially supported by the Spanish Government Ministerio de Economía
y Competitividad (MINECO), grants MTM2012-36917-C03-03 and MTM2015-65764-C3-2-P, as
well as by Universitat Jaume I, grant P1-1B2015-02.

1

2

LUKAS KATTHÄN, JULIO JOSÉ MOYANO-FERNÁNDEZ, AND JAN ULICZKA

So we restrict our attention to ﬁnitely generated modules. This condition yields
a second necessary condition for a series H to be a Hilbert series: It has to be

a rational function with denominator Qi(1 − tdeg Xi). In the standard-N-graded

situation, these two conditions already characterize Hilbert series, as it was shown
by the third author in [10, Corollary 2.3]. However, they are not suﬃcient in the
multigraded situation, cf. Example 3.7.

One of the main results of the present paper is a complete answer to Question
1.1 in the Zn-graded situation, see Theorem 3.5. This generalization is non-
trivial, as there are new phenomena in this setting. While this result is somewhat
technical, we obtain very satisfying specializations in the ﬁne-graded and the
bigraded situations, respectively; see Corollary 3.14 and Proposition 5.1. Also,
we clarify the relation between Hilbert series and merely nonnegative series in
Theorem 3.13.

It seems natural to further generalize these ideas to arbitrary multigradings.
However, in this generality, arithmetical issues arise. For instance, there exists a
formal Laurent series with integral coeﬃcients which is not a Hilbert series, but
after multiplication with 2 it is, cf. Example 3.2; the example already shows that
one cannot hope for a characterization using linear inequalities in this setting. In
the present paper, we do not further pursue this direction.

One of the diﬃculties of Question 1.1 is that if H is a Hilbert series of some
module, then any nonnegative series which coincides with H in all but ﬁnitely
many coeﬃcients is also a Hilbert series (to see this, if H = HM for some module
M, then one might replace ﬁnitely many components of M in the lowest degrees
by copies of K). Thus it seems natural to rule this out, i.e. to consider modules
which do not contain a copy of the residue ﬁeld as a submodule. Algebraically,
this amounts to requiring that the depth of M should be positive. Generalizing
this idea leads to the notion of ✿✿✿✿✿✿✿✿
depth, introduced by the third author in
[10]. Recall that the Hilbert depth1 of a formal Laurent series H is deﬁned as

Hilbert ✿✿✿✿✿✿

Hdep(H) := sup { depth(N) | N f. g. gr. R–module with HN = H } .

We consider the Hilbert depth only for those formal Laurent series which actually
arise as Hilbert series of some module. Again, in the standard-N-graded setting,
Hilbert series of a given Hilbert depth have been classiﬁed in [10]. Our next main
result is a quite general class of linear inequalities which are satisﬁed by every
Hilbert series with a given Hilbert depth. We formulate our result in terms of the
projective dimension, but at least over the polynomial ring, this is equivalent to
the depth via the Auslander-Buchsbaum formula.

Theorem 4.1. Let R = La Ra be a (commutative Noetherian) Zn-graded K-

algebra, such that dimK R0 < ∞. Let further p ∈ N and M, N be ﬁnitely generated
R-modules. If pdim M ≤ p and N is a p-th syzygy module, then the following

1In the literature concerned with the Stanley depth, the term “Hilbert depth” refers to a
diﬀerent invariant, see for example Bruns, Krattenthaler and Uliczka [3]. The latter is deﬁned
via Hilbert decompositions and so it is sometimes called decomposition Hilbert depth. In the
standard-Z-graded setup, these two notions coincide, but in general our Hilbert depth is only
an upper bound for the decomposition Hilbert depth.

WHICH SERIES ARE HILBERT SERIES?

inequality holds:

HM HN

HR

≥ 0.

3

(4.1)

In general, a classiﬁcation of Hilbert series with a given Hilbert depth seems to
be very diﬃcult. Therefore, we contempt ourselves with an important special case.
Our third main result is a complete characterization of the Hilbert series with
positive Hilbert depth in the bigraded (i.e. Z2-graded) setup, see Theorem 5.3.
The condition that we obtain is similar to the general inequalities of Theorem 4.1,
but quite diﬀerent in nature to the condition of Theorem 3.5.

In the previous paper [7], the second and the third author characterized Hilbert
series of positive Hilbert depth over a bivariate polynomial ring K[X, Y ] endowed
with a non-standard Z-grading. In Theorem 6.1 we show that this result can be
restated in a way analogous to Theorem 5.3.

Related work. The classical result of Macaulay [6] answers Question 1.1 for
cyclic modules in the standard-N-graded situation. This work has recently been
extended by Boij and Smith in [1]. These authors study Hilbert series in the
standard-N-graded setup, with the additional assumption that only modules ge-
nerated in degree 0 are considered. The main diﬀerence to the present work,
however, is that in [1] closure of the set of Hilbert series is considered (with
respect to a suitable topology on the space of formal Laurent series).

2. Notation and preliminaries

Let us ﬁx some notation before continuing. We will use boldface letters a, u, g, . . .

to denote elements of Zn or Nn. For such a vector a, we write ai for its i-th com-
ponent.

For i ∈ [n] we denote by ei the i-th unit vector. Moreover, for d = (d1, . . . , dn) ∈

Nn and t = (t1, . . . , tn), we deﬁne
n

tdi
i

and

td :=

(1 − t)d :=

n

Yi=1
Yi=1

(1 − ti)di.

For a formal Laurent series H ∈ Z((t1, . . . , tn)) we write c(H, a) for the coeﬃ-
nonnegative if every coeﬃcient of H is nonnegative

cient of ta in H. We call H ✿✿✿✿✿✿✿✿✿✿✿✿
and we denote this by H ≥ 0.

We consider the partial order on Zn which is given by coordinatewise compar-
ison. In other words, for u, v ∈ Zn we write u ≤ v if and only if ui ≤ vi for all
i ∈ [n]. Moreover, we denote the coordinate minimum resp. maximum of u and
v by u ∧ v resp. u ∨ v.

2.1. Multivariate Hilbert Polynomials. Let H = Pi hiti be a univariate

formal Laurent series, such that H · (1 − t)d is a Laurent polynomial. Then it is
well-known that there exist a polynomial p ∈ Q[Z] and i0 ∈ Z, such that hi = p(i)
for all i ≥ i0. If H is a Hilbert series, then p is called the ✿✿✿✿✿✿✿✿

Hilbert ✿✿✿✿✿✿✿✿✿✿✿✿
polynomial.

Here we give a multivariate generalization of this fact.

4

LUKAS KATTHÄN, JULIO JOSÉ MOYANO-FERNÁNDEZ, AND JAN ULICZKA

Lemma 2.1. Let Q ∈ Z[t±1

1 , . . . , t±1

n ] be a Laurent polynomial, d ∈ Nn and

H =

Q

(1 − t)d .

Then there exist a u ∈ Zn and a polynomial p ∈ Z[Z1, . . . , Zn] such that c(H, a) =
p(a) for a ≥ u. Moreover, p is uniquely determined (but u is not), and degZi p ≤
di − 1 for 1 ≤ i ≤ n.

Proof. Write Q = Pu∈Ω cutu for a suitable ﬁnite set Ω ⊆ Zn. Recall the series

expansion

(cid:19)ti.

tu

d − 1

(1 − t)d =Xa≥u(cid:18)a − u + d − 1
cu(cid:18)a1 − u1 + d1 − 1

d1 − 1

(cid:19)
(cid:19) · · ·(cid:18)an − un + dn − 1

dn − 1

From this, it is clear that

c(H, a) =Xu∈Ω

for all a ≥Wu∈Ω u. Hence c(H, a) is given by a polynomial of the claimed degree.

The uniqueness follows from the fact that the Zariski closure of Nn inside Cn
(cid:3)

equals Cn.

Deﬁnition 2.2. In the situation of Lemma 2.1, we call p the ✿✿✿✿✿✿✿
Hilbert✿✿✿✿✿✿✿✿✿✿✿✿✿
polynomial
of H and denote it with P(H). In the degenerate case n = 0, H is an integer and
we set P(H) = H.

3. Which series are Hilbert series?

Let K be a ﬁeld. We consider the polynomial ring R = K[X1, . . . , Xm] equipped
with a Zn-grading, such that each variable is homogeneous. In this section, we
deal with the question of which formal Laurent series H ∈ Z((t1, . . . , tn)) arise as
Hilbert series of ﬁnitely generated R-modules. There are two obvious necessary
conditions:
⋄ H ≥ 0 coeﬃcientwise, and

i=1(1 − tdeg Xi)H is a Laurent polynomial.

It is a consequence of [10, Theorem 2.1] that in the case of the standard N-grading
(i.e. n = 1), these conditions are already suﬃcient. In general, this is not true,
as we will see below.

In a previous work, the second and third author already obtained a general

characterization of Hilbert series, cf. [7, Corollary 2.2]:

Theorem 3.1. A formal Laurent series H ∈ Z((t1, . . . , tn)) is the Hilbert series
of a ﬁnitely generated R-module if and only if it can be written in the form

⋄ Qn

H = XI⊆[m]

QI

Qi∈I(1 − tdeg Xi)

(3.1)

for Laurent polynomials QI ∈ Z[t±1
ﬁcients.

1 , . . . , t±1

n ] and I ⊆ [m] with nonnegative coef-

A decomposition as in Equation (3.1) is called a ✿✿✿✿✿✿✿✿

decomposition of H.
This result is stated and proven in [7] for Z-gradings only, but the proof given
there can be easily extended for multigradings.

Hilbert ✿✿✿✿✿✿✿✿✿✿✿✿✿✿✿

WHICH SERIES ARE HILBERT SERIES?

5

Example 3.2. Let R = K[X1, X2, X3] with the N-grading given by deg X1 =
2, deg X2 = 3 and deg X3 = 5. Consider the series

1 − t2 +

1

1 − t3 +

1 + t
1 − t5 +

t7

(1 − t3)(1 − t5)(cid:19)

H =

=

1

2(cid:18) t
t + t3
1 − t6 +

1

(1 − t5)(1 − t6)

One sees immediately that 2H has a Hilbert decomposition and therefore it is
indeed a Hilbert series of a ﬁnitely generated R-module. In particular, 2H and
thus H satisfy the necessary conditions mentioned above. However, H is not a
Hilbert series, as it does not admit a Hilbert decomposition.

To see this, note that H has a pole of order 2 at t = 1. Considering the
possible summands in Equation (3.1), it follows that Q{ 2,3,5 } = 0 and that at
least one of Q{ 2,3 }, Q{ 2,5 } and Q{ 3,5 } is non-zero. One can compute that the
30 + O(1). On the other hand, the i-th
i-th coeﬃcient of H is of the order
coeﬃcient of 1/(1 − ta)(1 − tb) is of the order 1
ab + O(1) for coprime a, b ∈ N. As
2 · 3, 2 · 5, 3 · 5 < 30, the series H does not have a Hilbert decomposition and thus
it does not arise as a Hilbert series.

i

3.1. The standard Zn-grading. The criterion of Theorem 3.1 is very useful
for showing that a given Laurent series is a Hilbert series: One only needs to
construct a Hilbert decomposition. However, it is rather diﬃcult to use this
criterion to show that a given series is not a Hilbert series. Moreover it does not
provide a good insight into the structure of the set of Hilbert series. We would
like to have a characterization of the Hilbert series in terms of inequalities. In
view of the preceding example there is no hope for such a characterization in full
generality.

So we now specialize our considerations to the case that the degree of every
variable of R is a unit vector. More precisely, we consider the case that R =
K[Xij 1 ≤ i ≤ n, 1 ≤ j ≤ mi], where n ∈ N, m = (m1, . . . , mn) ∈ Nn and
deg Xij = ei.
In this setting, we give a characterization of the Hilbert series
of ﬁnitely generated modules over R in terms of certain inequalities. Roughly
speaking, this can be seen as an implicitization of the set of Hilbert series. Before
we can state our result we need to introduce some notation.

Deﬁnition 3.3. Let H =Pa∈Zn hata ∈ Z((t1, . . . , tn)) be a formal Laurent series.

For I ⊆ [n] and u ∈ Zn we deﬁne

H|I,u := Xa∈NI

hu+ata ∈ Z((ti|i ∈ I)),

where NI := (cid:8)Pi∈I ciei ci ∈ N(cid:9) ⊆ Nn. We call H|I,u the ✿✿✿✿✿✿✿✿✿✿✿

u + NI.

restriction ✿✿of✿✿✿H to

Note that H|∅,u = P(H|∅,u) = c(H, u) for u ∈ Zn. Also, note that the sum-
mands of tuH|I,u are summands of H. It is more convenient to consider H|I,u
instead of tuH|I,u, because the former lives in a smaller ring of Laurent series.

Deﬁnition 3.4. Let p ∈ Q[Z1, . . . , Zn] be a polynomial. We call a monomial Z r
appearing in p ✿✿✿✿✿✿✿✿✿
extremal if it does not divide any other monomial of p. Moreover,

6

LUKAS KATTHÄN, JULIO JOSÉ MOYANO-FERNÁNDEZ, AND JAN ULICZKA

we say that p has ✿✿✿✿✿✿✿✿
monomial of p is positive.

positive✿✿✿✿✿✿✿✿✿✿

extremal ✿✿✿✿✿✿✿✿✿✿✿

coeﬃcients if the coeﬃcient of every extremal

The following characterization of Hilbert series of R-modules is the main result

of this section.

Theorem 3.5. The following statements are equivalent for a formal Laurent
series H ∈ Z((t1, . . . , tn)):

(1) There exists a ﬁnitely generated graded R-module M whose Hilbert series

equals H.

(2) H satisﬁes the following two conditions:

i=1(1 − ti)mi is a polynomial, and

(a) H ·Qn

(b) for every u ∈ Zn and every I ⊆ [n], the Hilbert polynomial of the

restriction H|I,u of H has positive extremal coeﬃcients.

Remark 3.6. The condition that H ≥ 0 is implicit in the last condition of
Theorem 3.5 above, because P(H|∅,u) = c(H, u) for u ∈ Zn.

Example 3.7. Let n = 2 and m = (3, 3). Consider the series
1 − 6t1t2 + t2
(1 − t1)3(1 − t2)3

(i − j)2ti

1t2 + t2

2 + t2

t1t2

1tj

2 =

2 + t1 + t2

.

H :=Xi≥0 Xj≥0

Clearly H ·Q2

i=1(1 − ti)mi is a polynomial, and it is also clear that H ≥ 0. So H

satisﬁes the obvious necessary conditions for being a Hilbert series.

Moreover, P(H) = (i − j)2 = i2 − 2ij + j2. Here, all three monomials are
extremal, so in particular P(H) does not have positive extremal coeﬃcients.
Hence H does not arise as Hilbert series of a ﬁnitely generated R-module.

Although this can be obtained from Theorem 3.5, one way to see this directly
is as follows: Assume to the contrary that there H = HM for a ﬁnitely generated
R-module M. We write deg1 and deg2 for the ﬁrst and second component of the
degree of an element m ∈ M, respectively. Let g1, . . . , gr be a set of generators of
M and let deg gk = (ik, jk). If ik < jk, then (Rgk)(jk,jk) = 0 and hence deg1 m < jk
for any m ∈ Rgk. Similarly, if ik > jk, then deg2 m < ik for any m ∈ Rgk.
Hence, in both cases we have that min(deg1 m, deg2 m) ≤ max(ik, jk) for all
m ∈ Rgk. As M is generated by g1, . . . , gr, it follows that min(deg1 m, deg2 m) ≤
max(i1, . . . , ir, j1, . . . , jr) for all m ∈ M. This contradicts our assumption that
HM = H.

Example 3.8. Our next example shows that it is not suﬃcient to consider only
the Hilbert polynomial of H. Let

H :=Xi≥0 Xj≥0Xj≥0(cid:0)(i − j)2 + ijk(cid:1) ti

1tj

2tk
3.

It holds that P(H) = (i − j)2 + ijk, so all extremal coeﬃcients are nonnegative.
On the other hand, for I = { 1, 2 } , u = 0 it holds that P(H|I,u) = (i − j)2 and
this polynomial does not have positive extremal coeﬃcients. Thus H is not a
Hilbert series.

One common trait in the theory of Hilbert series is that many properties can
be determined by examining only those exponents which are below the exponent

WHICH SERIES ARE HILBERT SERIES?

7

g which is the join of the exponents of the numerator. So one might hope to
sharpen Theorem 3.5 by showing that one only needs to consider restrictions
HI,u for u ≤ g. However, the next example shows that this does not hold.

Example 3.9. For λ ∈ N, consider the series

H :=Xi≥0 Xj≥0Xk≥0(cid:0)i2 + j2 + ij(k − λ)(k − λ − 2)(cid:1) ti

This series is nonnegative, because for i, j, k ∈ N it holds that

1tj

2tk
3.

i2 + j2 + ij(k − λ)(k − λ − 2) ≥ i2 + j2 + ij · (−1) ≥ 0.

The Hilbert polynomial clearly has nonnegative extremal coeﬃcients. Moreover,
for I = { 2, 3 } and any u ∈ Zn, the Hilbert polynomial of the restriction is

P(H|I,u) = j2 + jk2 + lower terms

so it has nonnegative extremal coeﬃcients. By symmetry, the same holds for I =
{ 1, 3 }. Further, it follows from Theorem 3.13 below that the Hilbert polynomials
of restrictions H|I,u with |I| = 1 have nonnegative extremal coeﬃcients.

So it remains to consider the case I = { 1, 2 }. Let u = (0, 0, κ) ∈ Z3. Then

P(H|I,u) = i2 + j2 + (κ − λ)(κ − λ − 2)ij

and all three terms are extremal. So this restriction has nonnegative extremal
coeﬃcients if and only if κ 6= λ + 1. In particular, H is not a Hilbert series.

On the other hand, writing H as a rational function one sees that the degrees
of all terms in the numerator are less or equal than g := (2, 2, 2) ∈ Nn. Thus for
λ ≥ 2 it is not suﬃcient to consider restrictions H|I,u with u ≤ g.

We need some preparations before we give the proof of Theorem 3.5. First,
note that Hilbert decompositions are compatible with restrictions in the following
sense:

Lemma 3.10. Let H ∈ Z((t1, . . . , tn)) be a formal Laurent series. If H has a
Hilbert decomposition, then so does every restriction H|I,u of H for u ∈ Zn, I ⊆
[n].

Proof. If H has a Hilbert decomposition, then there exists a ﬁnitely generated

graded R-module M =La Ma with H = HM . Set

Ma.

M ′ := Ma∈u+NI

This is a module over R′ := K[Xij
i ∈ I] ⊆ R in a natural way. We give it the
structure of an R-module by letting the other variables act as zero. Its Hilbert
series equals tuH|I,u, hence this series has a Hilbert decomposition. But then
H|I,u clearly has a Hilbert decomposition as well.
(cid:3)

Next, we show that polynomials with positive extremal coeﬃcients admit a

certain decomposition. This is the key step in our proof of Theorem 3.5.

Proposition 3.11. For a polynomial p ∈ Q[Z1, . . . , Zn], the following statements
are equivalent:

(1) p has positive extremal coeﬃcients.

8

LUKAS KATTHÄN, JULIO JOSÉ MOYANO-FERNÁNDEZ, AND JAN ULICZKA

(2) p can be written as follows:

p = X(a,r)∈Ω

c(a,r)(cid:18)Z1 + r1 − a1

r1

(cid:19) · · ·(cid:18)Zn + rn − an

rn

(cid:19)

for some ﬁnite set Ω ⊆ Zn × Nn and c(a,r) > 0 for all (a, r) ∈ Ω.

If, in addition, there exists a u ∈ Zn such that p(a) ∈ Z for all a ≥ u, then the
coeﬃcients c(a,r) can be chosen to be natural numbers.

Proof. We start with the implication (1) ⇒ (2). Let Z r, for r ∈ Nn, be an
extremal monomial of p, and let c be its coeﬃcient. For a ∈ Zn consider

Q :=(cid:18)Z1 + r1 − a1

r1

(cid:19) · · ·(cid:18)Zn + rn − an

rn

(cid:19).

It is easy to see that Z r is also an extremal monomial of Q, and in fact it is
its only extremal monomial. Further, its coeﬃcient 1/r1! · · · rn! > 0. Hence, the
corresponding terms cancel in

p1 := p −

c

r1! · · · rn!

Q.

We show that p1 still satisﬁes the hypothesis (1), so the claim follows by induc-
tion. For this, note that the only possible new extremal monomials of p1 are the
monomials Z r/Zi for 1 ≤ i ≤ n, so we need to compute their coeﬃcients in Q.
We start with one factor of Q:

(cid:18)Z + r − a

r

(cid:19) =

=

=

This implies that

1
r!

(Z + r − a)(Z − r − a − 1) · · · (Z + 1 − a)

1

r! Z r +  r−1
Xℓ=0
r!(cid:18)Z r + r(cid:18)r + 1

r − a − ℓ! Z r−1 + · · ·!
− a(cid:19) Z r−1 + · · ·(cid:19) .

2

1

Q =

1

r1! · · · rn! Z r +

n

Xi=1

ri(cid:18)ri + 1

2

− ai(cid:19) Z r

Zi

+ lower terms! .

Note that for a suﬃciently large choice of a1, . . . , an, the coeﬃcients of Z r/Zi
become arbitrarily negative. Hence, for large a, p1 still satisﬁes the hypothesis.

For the other implication, note that if p can be written as in (2), then there
can be no cancellation between the extremal monomials on the right-hand side.
So the coeﬃcients of the extremal monomials of p are (sums of) multiples of the
ci, and thus positive.

Finally, assume that p(a) ∈ Z for all a ∈ Zn which are greater than some ﬁxed
u. We ﬁrst note that this implies that p(a) ∈ Z for all a ∈ Zn, cf. Corollary
I.1.2 and Corollary XI.1.5 in Cahen and Chabert [4]. So by a classical result of
Ostrowski [8] (see also [4, Corollary XI.1.11]), p can be written as an integral
linear combination of polynomials of the form

Hk1,...,kn :=(cid:18)Z1

kn(cid:19)
k1(cid:19) · · ·(cid:18)Zn

WHICH SERIES ARE HILBERT SERIES?

9

If Z r is an extremal monomial of p, then only Hr1,...,rn
with k1, . . . , kn ∈ N.
contributes to this term, so its coeﬃcient c is a multiple of the corresponding
coeﬃcient in Hr1,...,rn, which is 1/r1! · · · rn!. It now follows from the construction
above that the c(a,r) are positive integers.
(cid:3)

Proof of Theorem 3.5. We start with the necessity: If H has a Hilbert decomposi-
tion, then so does every restriction of H. Hence we only need to consider the case
I = [n] and thus we need to show that P(H) has positive extremal coeﬃcients.
Consider a Hilbert decomposition

H = X(a,e)∈Ω

c(a,e)ta
(1 − t)e

of H, where Ω ⊆ Zn × Nn is a suitable ﬁnite index set and c(a,e) ≥ 0 for all
(a, e) ∈ Ω. Expanding every summand into a series, it follows that

P(H) = X(a,e)∈Ω

c(a,e)(cid:18)Z1 + e1 − a1 − 1

e1 − 1

(cid:19).
(cid:19) · · ·(cid:18)Zn + en − an − 1

en − 1

Hence P(H) has positive extremal coeﬃcients by Proposition 3.11.

Now we turn to the suﬃciency: We proceed by induction over the number of
variables of H, with the base case being trivial. First, assume that P(H) 6= 0. By
assumption, its extremal coeﬃcients are nonnegative, so Proposition 3.11 yields
a decomposition

P(H) = X(a,r)∈Ω

c(a,r)(cid:18)Z1 + r1 − a1

r1

(cid:19) · · ·(cid:18)Zn + rn − an

rn

(cid:19)

for a ﬁnite set Ω ∈ Zn × Nn and c(a,r) > 0 for all (a, r) ∈ Ω. Moreover, P(H)
takes integer values on large a ≫ 0, so c(a,r) ∈ N for all (a, r) ∈ Ω. Let

H1 := X(a,r)∈Ω

c(a,r)ta

Qi(1 − ti)ri+1 .

It is easy to see that P(H1) = P(H), so there exists a g ∈ Zn such that c(H, a) =
c(H1, a) for all a ≥ g.

Set H ′ := H − tgH1|[n],g.

It holds that P(H ′) = 0 and we claim that H ′
still satisﬁes the hypothesis on the extremal coeﬃcients. To see this, consider
I ⊆ [n] and u ∈ Zn. If u + NI ∩ g + Nn = ∅, then H ′|I,u = H|I,u; otherwise, let
v ∈ u + NI ∩ g + Nn. Then c(H ′, a) = 0 for all a ≥ v and hence P(H ′|I,u) = 0.
In both cases, the hypothesis is satisﬁed.

Next, we consider the case that P(H) = 0. In this case, the exponent vectors
of the nonzero terms of H are contained in ﬁnitely many translates of coordinate
hyperplanes. Hence we may decompose H as a sum of series in n − 1 variables
as follows: Choose g ∈ Zn such that c(H, a) = 0 for all a ≥ g. For 1 ≤ i ≤ n and
0 ≤ j ≤ gi − 1 let u(i, j) := (g1, . . . , gi−1, j, 0, . . . , 0) ∈ Zn. We decompose H as
follows:

H =

n

Xi=1

gi−1

Xj=0

tu(i,j)H|[n]\{i},u(i,j)

10

LUKAS KATTHÄN, JULIO JOSÉ MOYANO-FERNÁNDEZ, AND JAN ULICZKA

Every restriction of H is a series in at most n − 1 variables, so the claim follows
by induction.
(cid:3)

3.2. Non-Negative series. Our next goal is to clarify the relation between series
satisfying the hypothesis of Theorem 3.5 and series which are merely nonnegative.
We will need the following convex geometric lemma.

Lemma 3.12. Let P ⊆ Rn be a polytope and v ∈ P a vertex, such that v + u /∈ P
≥0, u 6= 0. Then there exists a linear form σ ∈ (Rn)∗ which attains
for all u ∈ Rn
its maximum over P exactly at v and whose coeﬃcients are nonnegative integers.

Proof. Let P ′ ⊆ P be the convex hull of all vertices of P which are diﬀerent from
≥0. Both P ′ and Q are convex sets, and our assumption
v. Further, let Q := v + Rn
implies that P ′ ∩ Q = ∅. Then there exists a separating hyperplane, i.e. a linear
form σ ∈ (Rn)∗ such that

max(σ(p) p ∈ P ′) < inf(σ(q) q ∈ Q).

(3.2)

We may assume that σ has rational coeﬃcients, and after clearing denominators
we may even assume that the coeﬃcients of σ are integers. We show that σ has
the claimed properties. It is clear that the maximum of σ over P is attained only
at v. To see that the coeﬃcients of σ are nonnegative assume that σ(ei) < 0 for
some unit vector ei. Then σ(v + λei) can be arbitrarily negative for large λ ≫ 0,
contradicting (3.2).
(cid:3)

The following lemma shows that if H ≥ 0 then some extremal coeﬃcients are

automatically nonnegative.

Theorem 3.13. Let H ∈ Z((t1, . . . , tn)) be a formal Laurent series, such that
H · (1 − t)m is a Laurent polynomial for some m ∈ Nn. The following conditions
are equivalent:
(1) H ≥ 0.
(2) For all u ∈ Zn and I ⊆ [n], every extremal monomial of P(H|u,I) which

is also a vertex of its Newton polytope has a positive coeﬃcient.

Proof. The implication (2) ⇒ (1) is clear, because c(H, a) = P(H|a,∅) for all
a ∈ Zn. So we only need to show the other implication.

Let Z r be an extremal monomial of p := P(H|u,I) which is also a vertex of
its Newton polytope. By Lemma 3.12, there exists a linear form σ ∈ (Rn)∗ with
nonnegative integral coeﬃcients, which attains its maximum over the Newton
polytope exactly at r. Consider the linear map ˆσ : Z[Z1, . . . , Zn] → Z[Z], given
by Z r 7→ Z σ(r). Then ˆσ(p) is a univariate polynomial, which attains nonnegative
values at suﬃciently large integers. Hence its leading coeﬃcient is nonnegative.
On the other hand, by our choice of σ, this leading coeﬃcient of ˆσ(p) equals the
coeﬃcient of Z r in p. So the claim is proven.
(cid:3)

3.3. The ﬁne graded case. If there are at most two variables with the same
degree, then the obvious necessary conditions for Hilbert series are also suﬃcient.
This includes in particular the case of the ﬁne graded polynomial ring.

Corollary 3.14. In the situation of Theorem 3.5, assume that mi ≤ 2 for all i.
Then the following two statements are equivalent for a formal Laurent series

H ∈ Z((t1, . . . , tn)):

WHICH SERIES ARE HILBERT SERIES?

11

(1) There exists a ﬁnitely generated graded S-module M whose Hilbert series

equals H.

(2) H satisﬁes the following two conditions:

(a) H ≥ 0, and

(b) H ·Qn

i=1(1 − ti)mi is a polynomial.

Proof. For I ⊆ [n] and u ∈ Zn let p = P(H|I,u). The hypothesis that mi ≤ 2 for
all i implies that every monomial of p is squarefree. Hence its Newton polytope is
a 0/1-polytope, so every lattice point in it is a vertex. In particular, all extremal
monomials of p are vertices of its Newton polytope, so the claim follows from
Theorem 3.13.
(cid:3)

4. General inequalities for the Hilbert depth

In this section, we present a class of linear inequalities for the Hilbert series
of modules with a given depth. We relax our assumptions on R and allow it to
be an arbitrary (commutative) K-algebra with a positive Zn-grading, such that
dimK R0 < ∞. The general idea is to compare the Hilbert series in question
with all Hilbert series of modules from a certain class. Recall that an R-module
N is called p-th syzygy module if it can be realized as the p-th syzygy of some
R-module N ′. See [2] for alternative characterizations of syzygy modules.

The following is the main result of this section.

Theorem 4.1. Let R = La Ra be a (commutative Noetherian) Zn-graded K-

algebra, such that dimK R0 < ∞. Let further p ∈ N and M, N be ﬁnitely generated
R-modules. If pdim M ≤ p and N is a p-th syzygy module, then the following
inequality holds:

HM HN

HR

≥ 0.

(4.1)

Proof. First note that every free R-module F satisﬁes HF ⊗N = HF HN
. This
HR
clearly holds for F = R(a) with a ∈ Zn, and it is easily seen that the equality is
preserved under direct sums.

Consider a free resolution of M:

We compute that

F : 0 → Fp → · · · → F0 → 0.

On the other hand, it holds that

(−1)i HFiHN
HR

HN

(−1)iHFi⊗N =Xi≥0
Xi≥0
Xi≥0

(−1)iHFi⊗N =Xi≥0

=

HR Xi≥0
(−1)iHHi(F⊗N ) =Xi≥0

(−1)iHFi =

HN
HR

HM .

(−1)iHTori(M,N ).

Let N ′ be an R-module such that N is the p-th syzygy module of N ′. Then it
holds for i > 0 that TorR
i+p(M, N ′) = 0 because pdim M ≤ p. We
conclude that

i (M, N) = TorR

HM HN

HR

=Xi≥0

(−1)iHTori(M,N ) = HM ⊗N ≥ 0.

(cid:3)

12

LUKAS KATTHÄN, JULIO JOSÉ MOYANO-FERNÁNDEZ, AND JAN ULICZKA

Remark 4.2. Let us consider some extremal cases of this theorem in the case
that R is the polynomial ring (with an arbitrary Zn-grading).
(1) If p = dim R, all p-th syzygies modules are free. Hence (4.1) reduces to the

statement that HM ≥ 0 for every R-module M.

(2) For p = 0, every module with pdim M ≤ p is free. On the other hand, let
M be a module satisfying the inequality (4.1) for all 0-th syzygy modules N.
Choosing N = K = R/(X1, . . . , Xm) yields that HM is of the form

Q

for some Q ∈ N[t±1

1 , . . . , t±1

i=1(1 − ti)

Qn
n ]. If Q =Pa∈Zn qata, then the free module
M ′ := Ma∈Zn

R(−a)qa

has the same Hilbert series as M. Hence, (4.1) exactly describes the Hilbert
series of free modules.

In general, the inequalities (4.1) are not suﬃcient for a Hilbert series to have
a given Hilbert depth. Nevertheless, in the next two sections, we consider two
special situations where slightly stronger inequalities are indeed suﬃcient.

For later use, we also record a useful criterion for Hilbert series of modules of

positive depth.

Proposition 4.3. Let R be a Zn-graded polynomial ring, such that every variable
is homogeneous. Then a formal Laurent series H ∈ Z((t1, . . . , tn)) is the Hilbert
series of a ﬁnitely generated R-module of positive depth if and only if it can be
written in the form

H = XI⊆[m]

I6=∅
for Laurent polynomials QI ∈ Z[t±1
cients.

QI

Qi∈I(1 − tdeg Xi)

1 , . . . , t±1

n ], I ⊆ [m] with nonnegative coeﬃ-

(4.2)

The diﬀerence to Theorem 3.1 is that there is no term Q∅. We call a Hilbert
decomposition as in Equation (4.2) a ✿✿✿✿✿✿✿
without✿✿✿✿✿✿✿✿✿✿✿✿✿
polynomial
✿✿✿✿part. As in Theorem 3.1, this result is essentially contained in [7, Prop. 2.4], but
there it is stated only for Z-graded rings; the proof in our context follows by the
same method.

Hilbert✿✿✿✿✿✿✿✿✿✿✿✿✿✿✿✿

decomposition ✿✿✿✿✿✿✿✿

5. The Bigraded case

In this section we consider the Z2–graded situation. More precisely, let R =
K[X1, . . . , Xm, Y1, . . . , Y ˜m] be the polynomial ring with a Zn-grading given by
deg Xi = (1, 0) for all i ∈ [m] and deg Yi = (0, 1) for all i ∈ [ ˜m].

Specializing Theorem 3.5 to this situation we obtain the following characteri-

zation of Hilbert series over R:

Proposition 5.1. For a formal Laurent series H ∈ Z((t1, t2)), there exists a
ﬁnitely generated graded R-module M with H = HM if and only if H satisﬁes the
following conditions:

WHICH SERIES ARE HILBERT SERIES?

13

(1) H ≥ 0,
(2) H · (1 − t1)m · (1 − t2) ˜m is a Laurent polynomial, and
(3) P(H) has positive extremal coeﬃcients.

Proof. The necessity of the conditions is clear from Theorem 3.5.

For the suﬃciency, we show that given conditions imply the hypotheses of
If I = ∅, then P(H|I,u) =

Theorem 3.5. So consider I ⊆ [2] and u ∈ Z2.
c(H, u) ≥ 0, and P(H) has positive extremal coeﬃcients by assumption.

So we only need to consider the case that |I| = 1.

In this case P(H|I,u)
is a univariate polynomial, so its only extremal monomial is the leading one,
which is also a vertex of its Newton polytope. Thus the claim follows from
Theorem 3.13.
(cid:3)

Our next main result will be the characterization of Hilbert series of positive
Hilbert depth over R. For this we will consider certain pairs of sequences of
indices in Z2.

Deﬁnition 5.2.

(1) A sequence (cid:0)u(i)(cid:1)p

and u(i)

2 > u(i+1)

u(i)
1 < u(i+1)

1

i=1 in Z2 is called declining, if

2

for

i = 1, . . . , p − 1.

The set of all declining sequences will be denoted by S.

i=1 we deﬁne D(U) := (u(i) ∧ u(i+1))p−1
i=1 .

(2) For a sequence U =(cid:0)u(i)(cid:1)p

The two sequences U and D(U) can be visualized as a “staircase”, see Figure 1.

Figure 1. A declining sequence U = {(1, 5), (3, 4), (4, 3), (7, 1)}
with D(U) = {(1, 4), (3, 3), (4, 1)}.

Theorem 5.3. Let H ∈ Z((t1, t2)) be a formal Laurent series, which is the Hilbert
series of some ﬁnitely generated graded R-module. Let further S := K[X, Y ] be
the standard–Z2–graded polynomial ring in two variables. Then the following
statements are equivalent:
(a) H has positive Hilbert depth.
(b) For any ﬁnitely generated torsionfree S-module N, it holds that

H · HN

HS

≥ 0.

(5.1)

(c) Condition (b) holds for any ﬁnitely generated torsionfree S module of rank 1,

i.e. every fractional monomial ideal I ⊆ K[X ±1, Y ±1].

14

LUKAS KATTHÄN, JULIO JOSÉ MOYANO-FERNÁNDEZ, AND JAN ULICZKA

(d) H =Pi,j hij ti

1tj

2 satisﬁes the condition

X(i,j)∈D(U )

hij ≤ X(i,j)∈U

hij

for all U ∈ S.

(ST)

Remark 5.4. 1) Note that the torsionfree modules (over a domain) are exactly

the ﬁrst syzygy modules.

2) If (u(i))1

i=1 is a declining sequence with only one entry, then (ST) asserts that
hu(1) ≥ 0. Hence any series satisfying condition (ST) is in particular nonnega-
tive.

3) Although condition (ST) resembles its counterpart in the non-standard–Z-
graded case, namely the condition (⋆) of Theorem 6.1 below, there are impor-
tant diﬀerences: The inequalities required by condition (⋆) only relate coeﬃ-
cients lying within one common period of the module’s Hilbert function, they
have the same number of terms on both sides, and this number is bounded
above by

min{deg X, deg Y }.

By contrast, a declining sequence U may have any number of entries, which
may be arbitrarily separated, and the right-hand side of (ST) has always one
term more than the left-hand side. One might think that it could be possible to
weaken condition (ST) by restricting it to a subset of S consisting of somehow
bounded sequences, but this turns out to be a vain hope. For instance, the
examples

Hk = 1 +

ti
1

1 − t2

,

k ∈ N

k

Xi=0

show that we cannot aﬀord to restrict condition (ST) to those sequences U =
(u(i))p

i=0 where maxi∈[m−1]{u(i+1)

1 } ≤ C for some C ∈ N.

− u(i)

1

Before we present the proof of Theorem 5.3 we give several lemmata. First of
all, it turns out to be convenient to consider a slightly larger class of inequalities.
and
for i = 0, . . . , p − 1 and let S′ denote the set of all weakly declining

For this, we call a sequence (cid:0)u(i)(cid:1)p
sequences. Moreover, for a formal Laurent series H =Pu∈Z2 hutu ∈ Z((t)) and a

i=0 in Z2 weakly declining, if u(i)

sequence U, we set

u(i)
2 ≥ u(i+1)

1 ≤ u(i+1)

2

1

σU (H) := Xu∈U

hu − Xu∈D(U )

hu

Lemma 5.5. Let H ∈ Z((t1, t2)) be a formal Laurent series. Then σU (H) ≥ 0 for
all U ∈ S if and only if σU (H) ≥ 0 for all U ∈ S′.

consider a weakly declining sequence U = (cid:0)u(i)(cid:1)p

Proof. One implication is trivial. So assume that σU (H) ≥ 0 for all U ∈ S and
for
some index i, then u(i+1) = u(i) ∧ u(i+1). Hence if U ′ is the sequence obtained
from U by deleting u(i+1), then σU (H) = σU ′(H). Similarly, if u(i)
then
u(i) = u(i) ∧ u(i+1), so we may delete u(i) from U. After ﬁnitely many such
deletions, we obtain a declining sequence U ′′ ∈ S with σU (H) = σU ′′(H). As
σU ′′(H) ≥ 0 by assumption, the claim follows.
(cid:3)

1 = u(i+1)

1 = u(i+1)

i=0 in Z2.

If u(i)

1

1

WHICH SERIES ARE HILBERT SERIES?

15

The following lemma essentially reduces the question to the ﬁne-graded situa-

tion.

Recall that c(H, u) denotes the coeﬃcient of tu in the series H.

Lemma 5.6. Assume that H ∈ N((t1, t2)) admits a Hilbert decomposition without
polynomial part. Then there exists an g0 ∈ Z2 with the following property:

For any g ≥ g0, there exists a decomposition H = H1 + H2 such that
(1) H1 is of the form Q1
1−t1

for some Q1, Q2 ∈ N[t±1

+ Q2
1−t2

1 , t±1

holds that c(H1, g) = 0 and c(H1, u ∧ g) = c(H1, u) for all u ∈ Z2.

2 ]. Moreover, it

(2) H2 has a Hilbert decomposition without polynomial part and it satisﬁes

c(H2, u) = 0 for all u < g.

Proof. Choose a Hilbert decomposition of H without polynomial part:

H = Xa∈N2,a6=0

Q2

Qa

.

i=1(1 − ti)ai

Choose g0 ∈ Z2 which is strictly larger than the degrees of all monomials in the
numerator polynomials Q(1,0) and Q(0,1). By repeatedly using the relation

1

1

i=1(1 − ti)ai

i=1(1 − ti)ai

+ (1 − tj)

= tj

Q2

1

,

i=1(1 − ti)ai

Q2

Q2

we may modify the Hilbert decomposition such that it satisﬁes the following:

⋄ Q(0,0) = 0.
⋄ For every a ∈ N2, a 6= (0, 1), (1, 0) such that Qa 6= 0, it holds that Qa

contains no monomials of degree strictly less than g.

⋄ The polynomial (1 − t1)Q(0,1) + (1 − t2)Q(1,0) contains only monomials

which are strictly less than g.

We set

H1 :=

Q(1,0)
1 − t1

+

Q(0,1)
1 − t2

and H2 := H − H1. The claimed properties of H1 and H2 follow readily.

(cid:3)

The third lemma is the key step in our proof of Theorem 5.3. Here we show
how to decompose a non-negative Laurent series of the form Q0 + Q1/(1 − t1) +
Q2/(1 − t2).

Lemma 5.7. Let

∞

∞

H =

Xi=k

Xj=ℓ

hij ti

1tj

2

be a formal Laurent series satisfying condition (ST). Assume further that hpℓ = 0
for some p ≥ k and let µ := min { hiℓ

i > p }. Then the series

H −

1

1 − t2

satisﬁes condition (ST) as well.

p−1

Xi=k

hiℓti

1tℓ

2 −

1

1 − t1

µtp+1

1

tℓ
2

Proof. To prove the lemma, it is enough to show the following two claims:

16

LUKAS KATTHÄN, JULIO JOSÉ MOYANO-FERNÁNDEZ, AND JAN ULICZKA

(1) For any k ≤ r < p the series

˜H := H − hrℓ

tr
1tℓ
2
1 − t2

satisﬁes condition (ST).

(2) Further, for µ := min { hiℓ

i > p } the series

ˆH := H − µ

tp+1
tℓ
2
1
1 − t1

satisﬁes condition (ST).

condition (ST) is valid for ˜H =: Pi,j

We start with the proof of the ﬁrst claim. For this we have to show that
2. The coeﬃcients ˜hij and hij are
equal except for i = r and j ≥ ℓ, where ˜hij = hij − hrℓ holds. Hence we
only have to consider declining sequences U ⊆ S such that U or D(U) intersect
Cr,ℓ := {(r, j) | j ≥ ℓ}. If Cr,ℓ intersects both U and D(U), then we have

˜hij ti

1tj

σU ( ˜H) = σU (H) − hrℓ + hrℓ = σU (H) ≥ 0

so we may assume that only U intersects with Cr,ℓ. In this case it is not clear
a priori whether the corresponding inequality still holds for ˜H, because only the
right–hand side of the original inequality is diminished. (A similar problem occurs
in [7], where the analogous inequalities are called critical.)

Let u(e) = (r, j′) denote the intersection of U and Cr,ℓ. Since we assume that
D(U) and Cr,ℓ do not intersect, the sequence U either ends in u(e) or the point
u(e) ∧ u(e+1) = (r, j′′), and hence all further points of U and D(U) lie in the half–
plane {(x, y) | y < ℓ}. Since all coeﬃcients of H and ˜H in this half–plane vanish,
we may assume that the staircase ends in u(e). We amend U by ˜u(e+1) := (p, ℓ)
to build ˜U . Note that ˜U is weakly declining, hence σ ˜U (H) ≥ 0 by Lemma 5.5.
As u(e) = (r, j′), it follows that u(e) ∧ ˜u(e+1) = (r, ℓ) and thus

σU ( ˜H) = σU (H) − hrℓ = (σ ˜U (H) + hrℓ − hpℓ) − hrℓ = σ ˜U (H) ≥ 0.

1tj

ˆhijti

ˆH =: Pi,j

Now we turn to the proof of the second claim. By the choice of µ the series
2 is nonnegative. Similar to the proof of the ﬁrst claim the
veriﬁcation of condition (ST) for ˆH reduces to an inspection of sequences U ∈ S
intersecting Bp+1,ℓ := {(i, ℓ) | i ≥ p + 1} in U, but not in D. Let u(e) = (i′, ℓ) be
this intersection; again we may assume that U ends in u(e).

Let ˜U be the new weakly declining sequence obtained from U by replacing the
last element u(e) = (i′, ℓ) by ˜u(e) := (p, ℓ). We assumed that u(e−1) ∧ u(e) /∈ Bp+1,ℓ,
hence it holds that u(e−1)
≤ p and thus u(e−1) ∧ u(e) = u(e−1) ∧ ˜u(e). It follows
that

1

σU ( ˆH) = σ ˜U ( ˆH) − hpℓ + c( ˆH, (i′, ℓ)) = σ ˜U (H) + c( ˆH, (i′, ℓ))

= σ ˜U (H) + (hi′ℓ − µ) ≥ 0,

since hi′ℓ − µ ≥ 0.

Now we are able to prove Theorem 5.3:

Proof of Theorem 5.3.

(cid:3)

WHICH SERIES ARE HILBERT SERIES?

17

(a) ⇒ (b): Let N be a ﬁnite torsionfree S-module. After shifting the degrees,
we may assume that all homogeneous components of N have non-negative degrees.
Let u ∈ Z2 be a multidegree. By Lemma 5.6 we can ﬁnd a decomposition
H = H1 + H2, such that all coeﬃcients of H2 in degrees less or equal than u
vanish. Hence

c(cid:18)H · HN

HS

, u(cid:19) = c(cid:18)H1 · HN

HS

, u(cid:19) .

But H1
is a sum of terms of the form (1 − t1)ta or (1 − t2)ta with a ∈ Z2 and
HS
nonnegative coeﬃcients. Hence it is enough to show that (1 − t1)HN ≥ 0 and
(1 − t2)HN ≥ 0. Note that because N is torsionfree, multiplication by X and Y
gives inclusions N(−(1, 0)) ֒→ N and N(−(0, 1)) ֒→ N, thus these claims follow.

(b) ⇒ (c): This is trivial.
(c) ⇒ (d): For a given declining sequence U = (u(i))p
1 Y −u

fractional ideal I generated by X −u
minimal free resolution of I over S yields that

2 , . . . , X −u

1 Y −u

(p)

(1)

(1)

i=1 ∈ S, consider the
2 . Considering the

(p)

This and (c) imply that

0 ≤

H · HI

HS

t−u(i) −

p−1

t(−u(i))∨(−u(i+1))!
Xi=1
ha−((−u(i))∨(−u(i+1)))!
h(a+u(i))∧(a+u(i+1))! .

t−u(i) −

p−1

Xi=1

t(−u(i))∨(−u(i+1)).

p

=

HI
HS

Xi=1
= Xa∈Z2
= Xa∈Z2
= Xa∈Z2

hata!  p
Xi=1
ta  p
Xi=1
ta  p
Xi=1

ha+u(i) −

ha+u(i) −

p−1

p−1

Xi=1
Xi=1

Note that the coeﬃcient of t0 equals σU (H), hence the latter is nonnegative. So
H satisﬁes (ST).

(d) ⇒ (a): First, choose a decomposition H = P + H ′, such that P is a
polynomial with non-negative coeﬃcients and H ′ has a Hilbert decomposition
with no polynomial part. Let ˜g ∈ Z2 such that all non-zero coeﬃcients of P lie
in degrees below ˜g. Again, using Lemma 5.6 there is g ≥ ˜g and a decomposition
H ′ = H1 + H2, such that H1 and H2 satisfy the conditions mentioned above.

We are going to construct a Hilbert decomposition without polynomial part of
H3 := P + H1. As H2 already has such a Hilbert decomposition, this is enough
to prove the claim. For this, we ﬁrst need to show that H3 still satisﬁes (ST).

Let U = (u(i))p

i=0 ∈ S be a declining sequence. Then U ′ := (u(i) ∧ g)p

i=0 is a

weakly declining sequence. If g ∈ U ′, then it is easy to see that

σU ′(H3) = c(H3, g) = 0.

Otherwise, our choice of g and Lemma 5.6 imply that c(H3, a ∧ g) = c(H3, a) for
all a ∈ Z2. Hence it follows that σU (H3) = σU ′(H3). Further, it holds that

σU ′(H3) = σU ′(H3 + H2) ≥ 0,

18

LUKAS KATTHÄN, JULIO JOSÉ MOYANO-FERNÁNDEZ, AND JAN ULICZKA

because the coeﬃcients of H2 vanish below g and H = H2 + H3 satisﬁes (ST).
Hence H3 satisﬁes (ST) as well. The series H3 is of the form

Q0 +

Q1

1 − t1

+

Q2

1 − t2

.

We obtain a Hilbert decomposition of H3 without polynomial part by repeatedly
applying Lemma 5.7.

(cid:3)

With a little more work, one can show directly that condition (d) implies (c).
Indeed, we already showed that every declining sequence gives rise to a fractional
ideal. On the other hand, to every fractional ideal one can associate a declining
sequence in a natural way, thus proving the equivalence directly.

6. The non-standard Z-graded case

Let R = K[X, Y ] with the grading given by deg X = α and deg Y = β for two
coprime numbers α, β ∈ N. In [7], the second and third author characterized the
Hilbert series of modules of positive depth over this ring. In this section, we give
a reformulation of this result along the lines of the previous results.

First of all, we recall the characterization of Hilbert series of ﬁnitely generated
graded modules over this ring (cf. the authors in [5, Theorem 2.6]): These are
exactly the formal Laurent series H with nonnegative integral coeﬃcients, such
that H · (1 − tα)(1 − tβ) is a Laurent polynomial, thus there is no analog of
condition (3) of Proposition 5.1 in this setting.

In order to state the characterization of Hilbert series with positive Hilbert
depth we need some more notation. Denote by hα, βi ⊆ N the numerical semi-
couple (with respect to α and β) is
group generated by α and β. A ✿✿✿✿✿✿✿✿✿✿✿✿✿
pair [I, J] of two integer sequences I = (ik)m
k=0 which are subject
to the following conditions:

k=0 and J = (jk)m

fundamental ✿✿✿✿✿✿✿

(0) i0 = 0;
(1) i1, . . . , im, j1, . . . , jm−1 ∈ N \ hα, βi and j0, jm ≤ αβ;

(2)

ik ≡ jk
jk ≡ ik+1 mod β
jm ≡ i0
mod β

mod α and
and
and

ik < jk
jk > ik+1
jm ≥ i0.

for k = 0, . . . , m;
for k = 0, . . . , m − 1;

(3) |ik − iℓ| ∈ N \ hα, βi for 1 ≤ k < ℓ ≤ m.

Denote by Fα,β the set of all fundamental couples.

The characterization of positive Hilbert depth over R can be stated as follows:

Theorem 6.1. Let H ∈ Z((t)) be a formal Laurent series, which is the Hilbert
series of some ﬁnitely generated graded R-module. Let further S := R/(X β −Y α).
Then the following statements are equivalent:
(a) H hat positive Hilbert depth.
(b) For any ﬁnitely generated torsionfree S-module N, it holds that

(c) Condition (b) holds for any ﬁnitely generated torsionfree S module of rank 1.

H · HN

HR

≥ 0.

(6.1)

WHICH SERIES ARE HILBERT SERIES?

(d) H =Pi hiti satisﬁes the condition

Xi∈I

hi+n ≤Xj∈J

hj+n for all n ∈ N, [I, J] ∈ Fα,β.

19

(⋆)

Remark 6.2.
This is also the most diﬃcult part of the result.

(1) The equivalence of (a) and (d) is the main theorem of [7].

(2) Note that the denominator of Equation (6.1) is HR, in contrast to the HS in
≥ 0
≥ 0. We present two examples to show that this implication

the denominator of Equation (5.1). In both cases, it is easy to see that HM HN
implies that HM HN
is strict in both cases:
(a) In the setting of Theorem 5.3, let R = K[X1, X2, Y1, Y2], N = S and HM =

HR

HS

1/(1 − t1). Then M clearly has Hilbert depth 1, but

HM HN

HR

=

1

1 − t1

·

1

(1 − t1)(1 − t2)

· (1 − t1)2(1 − t2)2 = 1 − t2 (cid:3) 0.

(b) In the setting of Theorem 6.1, let α = 2, β = 3 and consider the Hilbert
series HM = 1 + t3. The module M has ﬁnite length and therefore Hilbert
depth 0, but for any torsionfree S-module N it holds that

HM HN

HS

= (1 + t3) ·

(1 − t3)(1 − t3)

1 − t6

HN = (1 − t2)HN ≥ 0,

where for the last inequality, we use that multiplication by X gives an injec-
tion N(−2) ֒→ N.

We need the following result about the structure of fundamental couples.

Lemma 6.3. Let [I, J] be a fundamental couple of length m. Then there exist
two integer sequences

β > a0 > a1 > · · · > am = 0 and
0 = b0 < b1 < · · · < bm < α

such that

ik = αβ − ak−1α − bkβ for 1 ≤ k ≤ m and
jk = αβ − akα − bkβ

for 0 ≤ k ≤ m

(6.2)

Proof. Recall from Rosales, García-Sánchez, García-García and Jiménez-Madrid
[9, Lemma 1] that an integer e ∈ Z is not contained in hα, βi if and only if there
are a, b ∈ N with a, b ≥ 1 such that e = αβ − aα − bβ. In this case, a and b are
uniquely determined and we denote them by a(e) and b(e), respectively.

Now consider a fundamental couple [I, J]. We deﬁne ak := a(jk) and bk := b(jk)
for 1 ≤ k ≤ m − 1. Further, j0 ≡ 0 mod α so it can be written as j0 = αβ − αa0
for some 0 ≤ a0 < β. We set b0 = 0, so j0 = αβ −a0α−b0β as required. Similarly,
jm ≡ 0 mod β, so there exists 0 ≤ bm < α such that jm = αβ − amα − bmβ with
am = 0.

Next, set ˜ık := αβ − ak−1α − bkβ for 1 ≤ k ≤ m. We need to show that ik = ˜ık.
For this, note that ik ≡ jk ≡ ˜ık mod α and similarly ik ≡ ˜ık mod β. Hence
ik = ˜ık + rαβ for some r ∈ Z. As ˜ık < αβ, it follows that ˜ık + rαβ < 0 for r < 0,

20

LUKAS KATTHÄN, JULIO JOSÉ MOYANO-FERNÁNDEZ, AND JAN ULICZKA

so we may assume that r ≥ 0. On the other hand, it r > 0, then

ik = ˜ık + rαβ = αβ − ak−1α − bkβ + rαβ

= αβ − akα − bkβ + α(rβ − ak−1 + ak) > jk,

which is a contradiction. Thus r = 0 and so ik = ˜ık for 1 ≤ k ≤ m.

Finally, ik < jk, jk−1 implies that ak < ak−1 and bk > bk−1 for 1 ≤ k ≤ m. (cid:3)

Proof of Theorem 6.1.
be written as

(a) ⇒ (b): If H has positive Hilbert depth, then it can

H =

Q1
1 − tα +

Q2
1 − tβ +

Q1,2

(1 − tα)(1 − tβ)

.

with Q1, Q2, Q1,2 ∈ N[t±1]. Using that N is torsionfree, it easily follows that
Equation (6.1) holds for each summand and therefore for H.

(b) ⇒ (c): This is trivial.
(c) ⇒ (d): Let [I, J] be a fundamental couple. Recall that S = K[tα, tβ]
is the monoid algebra of hα, βi. Let N ⊆ K[t] be the S-module generated by
tαβ−j0, . . . , tαβ−jm. This module is torsionfree, hence HM HN
≥ 0 by assumption.
To see that this inequality implies Equation (⋆), we need to compute the Hilbert
series of N.
Let (ak)m

k=0 be the sequences as in Lemma 6.3 and let

k=0, (bk)m

HR

˜N := (X a0Y b0, . . . , X amY bm).

It is easy to see that ˜N is the preimage of N under the projection R → S.
In particular, note that X β − Y α ∈ ˜N, because X a0, Y bm ∈ ˜N. Hence N ∼=
˜N/(X β − Y α) and thus HN = H ˜N − tαβHR.

By considering the minimal free resolution of ˜N , one sees that its syzygies are
generated in the degrees ak−1α + bkβ for 1 ≤ k ≤ m. So we can compute the
Hilbert series of N as follows:

m

m

tak−1α+bk β − tαβ

HN
HR

=

=

H ˜N − tαβHR

HR

=

tαβ−jk −

m

Xk=0

m

Xk=1

Xk=1

tak α+bk β −

Xk=0
tαβ−ik − tαβ−i0 = tαβ Xj∈J

t−i!

t−j −Xi∈I

Together with Equation (6.1), we obtain the following:

0 ≤

H · HN

HR

= (Xn∈Z
= tαβXn∈Z

hntn)tαβ Xj∈J
tn Xj∈J

t−j −Xi∈I
hn+j −Xi∈I

t−i!
hn+i!

So Equation (⋆) is satisﬁed for [I, J].

(d) ⇒ (a): This is Theorem 3.13 of [7].

(cid:3)

WHICH SERIES ARE HILBERT SERIES?

21

Acknowledgments

The second author wishes to express his gratitude to the Institute of Mathe-

matics at the University of Osnabrück for kind hospitality.

References

1. M. Boij and G.G. Smith, Cones of Hilbert functions, Int. Math. Res. Notices 2015 (2015),

no. 20, 10314–10338.

2. W. Bruns, “Jede” endliche freie Auﬂösung ist freie Auﬂösung eines von drei Elementen

erzeugten Ideals, Journal of Algebra 39 (1976), no. 2, 429–439.

3. W. Bruns, Chr. Krattenthaler, and J. Uliczka, Stanley decompositions and Hilbert depth in

the Koszul complex, J. Commut. Algebra 2 (2010), no. 3, 327–357.

4. P.-J. Cahen and J.-L. Chabert, Integer-valued polynomials, Mathematical Surves and Mono-

graphs, vol. 48, American Mathematical Soc., 1997.

5. L. Katthän, J.J. Moyano-Fernández, and J. Uliczka, Hilbert series of modules over positively

graded polynomial rings, ArXiv, 1402.2588 Preprint (2014).

6. F.S. Macaulay, Some properties of enumeration in the theory of modular systems, Proc.

London Math. Soc. 26 (1927), 531–555.

7. J.J. Moyano-Fernández and J. Uliczka, Hilbert depth of graded modules over polynomial

rings in two variables, Journal of Algebra 373 (2013), 130–152.

8. A. Ostrowski, Über ganzwertige Polynome in algebraischen Zahlkörpern, Journal für die

reine und angewandte Mathematik 149 (1919), 117–124.

9. J.C. Rosales, P.A. García-Sánchez, J.I. García-García, and J.A. Jiménez-Madrid, Funda-
mental gaps in numerical semigroups, Journal of Pure and Applied Algebra 189 (2004),
no. 1, 301–313.

10. J. Uliczka, Remarks on Hilbert series of graded modules over polynomial rings, Manuscripta

mathematica 132 (2010), no. 1-2, 159–168.

Goethe-Universität Frankfurt, FB Informatik und Mathematik, 60054 Frank-

furt am Main, Germany

E-mail address: katthaen@math.uni-frankfurt.de

Universitat Jaume I, Campus de Riu Sec, Departamento de Matemáticas & In-
stitut Universitari de Matemàtiques i Aplicacions de Castelló, 12071 Castellón
de la Plana, Spain

E-mail address: moyano@uji.es

Universität Osnabrück, FB Mathematik/Informatik, 49069 Osnabrück, Ger-

many

E-mail address: juliczka@uos.de

