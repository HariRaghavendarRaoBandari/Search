6
1
0
2

 
r
a

M
2

 

 
 
]

.

G
A
h
t
a
m

[
 
 

1
v
6
6
5
0
0

.

3
0
6
1
:
v
i
X
r
a

Point Counting on Non-Hyperelliptic Genus 3 Curves with

Automorphism Group Z/2Z using Monsky-Washnitzer

Cohomology

Yih-Dar SHIEH

Abstract. We describe an algorithm to compute the zeta function of any non-
hyperelliptic genus 3 plane curve C over a ﬁnite ﬁeld with automorphism group
G = Z/2Z. This algorithm computes in the Monsky-Washnitzer cohomology
of the curve. Using the relation between the Monsky-Washnitzer cohomology
of C and its quotient E := C/G, the computation splits into 2 parts: one in a
subspace of the Monsky-Washnitzer cohomology and a second which reduces
to the point counting on an elliptic curve E. The former corresponds to the
dimension 2 abelian surface ker(Jac(C) → E), on which we can compute with
lower precision and with matrices of smaller dimension. Hence we obtain a
faster algorithm than working directly on the curve C.

1. Introduction

Henn gave the table of the possible non-trivial groups which appear as auto-
morphism groups of a non-hyperelliptic genus 3 curves, which can be found in Ver-
meulen’s thesis [11]. The dimension of the set of moduli points of non-hyperelliptic
genus 3 curves whose automorphism group contain Z/2Z is 4 inside the moduli of
genus 3 curves M3 of dimension 6. We thus obtain an algorithm to compute the
zeta function of a large family of genus 3 curves.
In [5], Kedlaya used Monsky-Washnitzer cohomology to compute the zeta func-
tions of hyperelliptic curves over ﬁnite ﬁelds. This method could be applied to
general varieties, and there are already generalizations to superelliptic curves, Ca,b
curves and non-degenerate curves, see [1], [2] and [4]. This work also uses Monsky-
Washnitzer cohomology but focuses on a smaller dimensional space associated to
an abelian surface in the jacobian of C.

The remainder of this paper is organized as follows: Section 2 recalls the deﬁ-
nition of Monsky-Washnitzer cohomology and results in this theory. In Section 3,
we compute a basis of the cohomology and describe a way to do the reduction of
a diﬀerential form. Reduction means to write a diﬀerential form as a linear com-
bination of the basis. In particular, we give an upper bound of the denominator
after a diﬀerential form is reduced. This bound makes the algorithm practical since
it establishes a ﬁnite precision bound for the computation. Section 4 describes a

This work was supported by a project of the Agence Nationale de la Recherche, reference

ANR-12-BS01-0010-01.

1

2

YIH-DAR SHIEH

way to compute a lift of Frobenius and Section 5 explains why the computation
splits into 2 eigenspaces. Finally, Section 6 gives the algorithm and an analysis of
its complexity.

2. Monsky-Washnitzer Cohomology

In this section, we recall the deﬁnition of Monsky-Washnitzer cohomology which

is introduced by Monsky and Washnitzer in [7][8][9].

Monsky-Washnitzer cohomology is a p-adic cohomology theory deﬁned for smooth

aﬃne varieties over ﬁnite ﬁelds. Let X be a smooth aﬃne variety deﬁned over a
ﬁnite ﬁeld k := Fq of characteristic p with coordinate ring A which is a ﬁnitely gen-
erated k-algebra. In [3], Elkik showed that there exists a ﬁnitely generated smooth
Zq-algebra A such that A/pA ∼= A, here Zq is the valuation ring of Qq, the degree
n := logpq unramiﬁed extension of Qp.

In general, A does not admit a lift of the Frobenius endomorphism F on A , but
its p-adic completion A∞ does. However, the dimension of the de Rham cohomology
n=0 pnxpn−1dx is not an
is not in A∞, but each term of this sum is
exact. The problem is that this diﬀerential form does not converge fast enough for
its integral to converge as well.

of A∞ may be too big. For example, if A = Zp[x], then P∞
exact diﬀerential form since P∞

n=0 xpn

Monsky and Washnitzer work with a subalgebra A† of A∞ consisting of series

which converge fast enough to solve the above problem. For
A = Zq[x1, x2,··· , xd]/(f1, f2,··· , fr),

the weak completion or dagger ring of A is

A† := Zqhx1, x2,··· , xdi/(f1, f2,··· , fr)

where Zqhx1, x2,··· , xdi is the subring of A∞ which consists of overconvergent
power series

(Xα

with α := (α1,··· , αd), xα := xα1
valuation on Zq.

aαxα ∈ Zq[[x1, x2,··· , xd]] (cid:12)(cid:12)(cid:12)
d , |α| =Pd

1 ··· xαd

lim inf
|α|→∞

vp(aα)
|α|

> 0)

i=1 αi and vp is the usual p-adic

Definition 2.1. The Monsky-Washnitizer cohomology of X/Fq is the de Rham
cohomology of A†⊗Zq Qq. More precisely, let D0(A†) := A†, D1(A†) be its universal
module of diﬀerentials
dxd(cid:19)


D1(A†) :=(cid:0)A† dx1 + ··· + A† dxd(cid:1) /
Xj=1


and Di(A†) be the i-th exterior product of D1(A†). Let H i(A, Zq) be the i-th
cohomology group of the complex

A†(cid:18) ∂fi

dx1 + ··· +

∂fi
∂xd

∂x1

r

0 −→ D0(A†)

d3−→ ···
where di is the usual diﬀerentiation. Then the i-th Monsky-Washnitzer cohomology
group of X (or of A) is H i(A, Zq) ⊗Zq Qq, which is denoted by H i
MW (X/Fq) (or
H i(A, Qq)).

d0−→ D1(A†)

d1−→ D2(A†)

d2−→ D3(A†)

The Monsky-Washnitzer cohomology has the following properties, see [10].

POINT COUNTING ON GENUS 3 CURVES WITH AUTOMORPHISM GROUP Z/2Z

3

Theorem 2.2. For a smooth ﬁnitely generated Fq-algebra A, we have
(a) The map A 7→ H i(A, Qq) is well deﬁned and functorial.
(b) There exists a Zq-algebra homomorphism Fq : A† → A† which lifts the
Frobenius endomorphism of A. Furthermore, any two lifts induce homo-
topic maps on the complex Di(A†). Hence they induce the same map
Fq,∗ : H i(A, Qq) → H i(A, Qq) on the Monsky-Washnitzer cohomology.

The following Lefschetz ﬁxed point formula allows us to compute the zeta

function of X = Spec(A) using Monsky-Washnitzer cohomology.

Theorem 2.3 (Lefschetz ﬁxed point formula). Let X/Fq be a smooth aﬃne

variety of dimension d. Then we have

X(Fq) =

d

Xi=0

q,∗(cid:12)(cid:12)(cid:12)
(−1)iTr(cid:16)qdF −1

H i

MW (X/Fq)(cid:17) .

3. Cohomology of Non-Hyperelliptic Genus 3 Plane Curves with

Automorphism Group Z/2Z

In this article, we consider non-hyperelliptic smooth projective plane curves
C of genus 3 whose automorphism group contains Z/2Z over a ﬁnite ﬁeld Fq of
characteristic p 6= 2. Such curves can be written (up to isomorphism) as

C : F := Y 4 + G(X, Z)X 2 + H(X, Z) = 0,

with G(X, Z) and H(X, Z) ∈ Fq[X, Z] which are homogeneous of degree 2 and 4
respectly. We assume that C is smooth. Since the Monsky-Washnitzer cohomology
is deﬁned for smooth aﬃne varieties, we also consider the aﬃne part of C

Caﬀ : f := y4 + g(x)y2 + h(x) = 0,

where g(x) = G(x, 1) and h(x) = H(x, 1) are the dehomogenizations of G(X, Z) and
H(X, Z) with respect to Z. In this section, we compute the Monsky-Washnitzer
cohomology H i
MW (Caﬀ /Fq) of Caﬀ and relate the zeta function of C/Fq to the
characteristic polynomial of the Frobenius action Fq,∗ on H i

MW (Caﬀ /Fq).

Choose arbitrary lifts G(X, Z) and H(X, Z) ∈ Zq[X, Z] of G(X, Z) and H(X, Z)
such that degX G = degX G and degX H = degX H. Let g(x) := G(x, 1) and
h(x) := H(X, 1) be the dehomogenizations. Consider the following two curves

˜C : F := Y 4 + G(X, Z)Y 2 + H(X, Z) = 0,

and

(3.1)

˜Caﬀ : f := y4 + g(x)y2 + h(x) = 0

Since the reduction of F modulo the maximal ideal (p) of Zq is F which deﬁnes a
smooth projective curve C, the generic ﬁber ˜Cξ := ˜C ×Zq Qq of ˜C is also smooth.
Using the three facts that the reduction of f modulo the maximal ideal (p) of Zq
equals to f which is not zero in Fq[x, y], that A := Fq[x, y]/(f (x, y)) is an integral
domain and that p is a prime element in the unique factorization domain Zq[x, y],
one sees that A is an integral domain and hence it is ﬂat over Zq. This shows that
A is a ﬁnitely generated smooth Zq-algebra, so we can work with A to apply the
theory of Monsky-Washnitzer cohomology. The above arguments also show that
the generic ﬁber ˜Cξ of ˜C is a geometrically integral smooth projective curve over
Qq.

4

YIH-DAR SHIEH

Although we can compute the Monsky-Washnitzer cohomology of the aﬃne
curve Caﬀ /Fq by explicit reduction algorithms and the control of denominators,
we use the following theorem instead, see [6], and compute the algebraic de Rham
dR( ˜Cξ,aﬀ /Qq) of the curve ˜Cξ,aﬀ /Qq, the aﬃne part of the generical
cohomology H i
ﬁber ˜Cξ. Note that we are concerned with curves, hence the divisors are always
normal crossings.

Theorem 3.1. Let Y /Zq be a smooth proper scheme, Z be a relative normal
crossings divisor and X := Y \Z is aﬃne. Then there is a canonical isomorphism

H i
dR(Xξ/Qq) → H i

MW (Xp/Fq),

where Xξ is the generic ﬁber and Xp is the special ﬁber of X/Zq, namely, the ﬁbers
of X at the closed point (p) of Spec(Zq).

3.1. Geometry. Before we compute the algebraic de Rham cohomology of the
aﬃne curve ˜Cξ,aﬀ , we need to study its geometry. The coordinate ring of ˜Cξ,aﬀ is
A := Qq[x, y]/(f (x, y)), here f (x, y) = y4 + g(x)y2 + h(x) ∈ Zq[x, y] with deg(g) ≤ 2
and deg(h) ≤ 4. We write g(x) and h(x) as following

(3.2)

g(x) = a2x2 + a1x + a0, ai ∈ Zq
h(x) = b4x4 + b3x3 + b2x2 + b1x + b0, bi ∈ Zq

There are four cases to consider:
Case 1. b4 = 0 and a2 = 0
There is only one point at inﬁnity which is P∞ := (1 : 0 : 0). Using the fact that
˜Cξ is smooth at P∞, one shows that b3 6= 0. The dimension of the ﬁrst algebraic
de Rham cohomology of ˜Cξ,aﬀ /Qq is 2g + N∞ − 1 = 2 · 3 + 1 − 1 = 6, here g is the
genus of ˜Cξ, which equals to the genus of C, and N∞ is the number of points at
inﬁnity. We have υP∞ (x) = −4 and υP∞ (y) = −3. The local parameter at P∞ is
t := b3x2/y3. The expansions of x and y as Laurent series of the local parameter t
are x = −b3/t4 + ··· and y = b3/t3 + ··· .
Case 2. b4 = 0 and a2 6= 0
There are 3 points at inﬁnity: P∞ := (1 : 0 : 0) and P∞,± := (1 : ±α : 0) with
α2 = −a2. Using the fact that ˜Cξ is smooth at P∞, one shows that b3 6= 0.
(The condition a2 6= 0 implies the smoothness at P∞,+ and P∞,−.) We have
dR( ˜Cξ,aﬀ /Qq) = 2 · 3 + 3 − 1 = 8, υP∞,±(x) = υP∞,±(y) = −1, υP∞ (x) = −2
dimQq H 1
and υP∞ (y) = −1. The local parameters at P∞ and P∞,± are t := 1/y and
t± := 1/x. The expansions of x and y at P∞ and P∞,± as Laurent series of the
local parameters are x = β/t2 + γ + δt2 + ··· with β = −a2/b3, y = 1/t, and
x = 1/t±, y = ±α/t + ··· .
Case 3. b4 6= 0 and a2
There are 2 points at inﬁnity: P∞,± := (1 : ±α : 0) with α = (−a2/2)1/2. Using
the fact that ˜Cξ is smooth at P∞,+, one shows that a1a2 − 2b3 6= 0. We have
dR( ˜Cξ,aﬀ /Qq) = 2· 3 + 2− 1 = 7 and υP∞,±(x) = υP∞,±(y) = −2. The local
dimQq H 1
parameters are t± := y/x ∓ α. The expansions of x and y as Laurent series of the
local parameters are x = β/t2
± + (β ± αγ)/t± + ···
with β = −(a1a2 − 2b3)/4a2 and γ = α(a1a2 + 2b3)/2a2
2.
Case 4. b4 6= 0 and a2
There are 4 points at inﬁnity which are P∞,i,± := (1 : ±αi : 0) with ±α1 and

± + γ/t± + ··· and y = ±αβ/t2

2 − 4b4 6= 0

2 − 4b4 = 0

POINT COUNTING ON GENUS 3 CURVES WITH AUTOMORPHISM GROUP Z/2Z

5

dR( ˜Cξ,aﬀ /Qq) =
±α2 are the four roots of y4 + a2y2 + b4 = 0. We have dimQq H 1
2·3+4−1 = 9 and υP∞,i,±(x) = υP∞,i,±(y) = −1. The local parameters are t := 1/x.
The expansions of x and y as Laurent series of t are x = 1/t and y = ±αi/t + ··· .
In order to analyze the control of denominators later, we need to impose further

assumptions on the choice of the lift F (X, Y, Z).

Assumption 3.2. The coeﬃcients ai and bj of g(x) and h(x) in (3.2) are either

0 or units in Zq. Furthermore, a2

2 − 4b4 is either 0 or a unit in Zq.

Remark 3.3. A lift which satisﬁes the above assumptions could be constructed
by using Teichm¨uller lift. The choice of such a lift is to preserve the geometric
structure. Under these assumptions, we introduce some facts which will be used
later. The expansions of x and y as Laurent series of the local parameters have
integral coeﬃcients.1 This means that x and y are in O((t)), here O is the integral
closure of Zq in a ﬁnite extension Qq(α) (Qq(α1, α2) in Case 4) of Qq and α is the
Y -coordinate of the points at inﬁnity discussed above. Furthermore, the coeﬃcients
of the lowest terms 2 in these Laurent series are units in O. (In Case 3, one shows
that a1a2 − 2b3 is a unit in Zq by using C is smooth.) ˜Cξ and C have the same
geometry. In Case 4, pa2
3.2. The Reduction Algorithm and Algebraic de Rham Cohomol-
ogy. In this subsection, we present the reduction algorithm and use it to compute
dR( ˜Cξ,aﬀ /Qq). First of all, since (i + 1)xjyidy = d(xj yi+1) − jxj−1yi+1dx for
H 1
all i ≥ 0, the universal module of diﬀerential Ω1 of ˜Cξ,aﬀ /Qq is generated by
{xjyidx | i ≥ 0, j ≥ 0}. From the deﬁning equation (3.1), Ω1 is generated by
{xjyidx | 1 ≤ i ≤ 3, j ≥ 0}. Since
0 = df = d(cid:0)y4 + g(x)y2 + h(x)(cid:1) =(cid:0)g′(x)y2 + h′(x)(cid:1) dx +(cid:0)4y3 + 2g(x)y(cid:1) dy,

2 − 4b4 is a unit in O.

we have

Combine with the following equation

2

2

l + 4

l + 2

yl+4 +

kxk−1yl+4 +

g(x)yl+2(cid:19)(cid:19) − xk(cid:0)4y3 + 2g(x)y(cid:1) yldy

xk(cid:0)g′(x)y2 + h′(x)(cid:1) yldx + xk(cid:0)4y3 + 2g(x)y(cid:1) yldy = 0.
d(cid:18)xk(cid:18) 4
=(cid:18) 4
xk(cid:18) l
= d(Sl,k), where Sl,k := −xk(cid:18) 4

l + 2(cid:0)kxk−1g(x) + xkg′(x)(cid:1) yl+2(cid:19) dx,

g′(x)y2 + h′(x)(cid:19) yldx − kxk−1(cid:18) 4

g(x)yl+2(cid:19)

l + 4
2

y4 +

yl+4 +

l + 4

l + 2

l + 4

l + 2

2

l + 2

g(x)y2(cid:19) yldx

one gets

Using y4 = −(g(x)y2 + h(x)) and the explicit description of g(x) and h(x) in (3.2),
the above equation becomes

(3.3)

Γk,l,0,j xk+j yl +

3

Xj=−1

1

Xj=−1




Γk,l,2,j xk+j yl+2

 dx = d(Sl,k),

1Use Hensel’s lemma. For Case 1, one needs a 2-variable version of Hensel’s lemma.
2 In particular, α, β ∈ O∗ if we use the notations in the above classiﬁcation.

0
·
·
0

0
·
·
0

0
·
·
0
0 Γl,k,0,−1 Γl,k,0,0 Γl,k,0,1 Γl,k,0,2 Γl,k,0,3
0
0 Γl,k,2,−1 Γl,k,2,0 Γl,k,2,1

0
·
·
0

0
·
·
0

0
·
·
0

0
0

0
0

0

0

0









6

YIH-DAR SHIEH

here the coeﬃcients Γk,l,0,j and Γk,l,2,j are deﬁned as following

Γk,l,0,j := (j + 1 +

4k
l + 4

) bj+1, Γk,l,2,j :=

l

l + 2

(j + 1 +

2k
l + 4

)aj+1.

In order to make things more clear, we use the following notation:

Definition 3.4. A family of matrices Mk of size m× n with entries (Mk)i,j =

mk,i,j ∈ Qq is called a family of reduction matrices if

mk,i,j xk+j−3yi−1

m

n

Xi=1

Xj=1




 dx ≡ 0 in Ω1, for all k.

For reduction matrices Mk, we deﬁne Mk dx to be

m

n

Xi=1

Xj=1




mk,i,j xk+j−3yi−1
 dx.

For example, from (3.3), we have reduction matrices of size (l + 3) × 6 which

has non-zero entries only at the (l + 1)-th and (l + 3)-th rows

M 0

l,k :=

l,kdx = d(Sl,k). The superscript 0 that appears in M 0

and M 0
obtained from (3.3), without further reduction.

l,k means that it is

We have to consider l = 1, 2 and 3, which give the reductions of xk+3y2dx or

xk+2y2dx:
l = 1.
As mentioned above, we have reduction matrices of size 4 × 6

0

0

0

0

0

0

0

0

1

2ka0

M1,k =

(2k + 5)a1

(12k + 60)b4

(12k + 45)b3

(12k + 30)b2

(12k + 15)b1

0
0 12kb0
0
0

15 ·




From 3.1, we know that one of b4 and b3 is non-zero. Hence xk+3ydx or xk+2ydx
can be reduced to a linear combination of {xjyidx} with i = 1 or 3 and j ≤ k + 2
(if b4 6= 0) or j ≤ k + 1 (if b4 = 0), which have smaller degree in x.
l = 2.
From (3.2), we have reduction matrices of size 5 × 6, so y4 is involved. Using the
deﬁning equation (3.1) to reduce the degree in y, one gets a reduction matrix M2,k
whose transpose is

(2k + 10)a2

0
0

0
0

M t

2,k = −

1
6 ·

0 0
0 0
0 0
0 0
0 0
0 0





(k + 3)(a2

k(a2

0
0
0 − 4b0)
0
0
1 + 2a0a2 − 4b2) 0
0
0

(2k + 3)(a0a1 − 2b1)
(2k + 9)(a1a2 − 2b3)
(k + 6)(a2
2 − 4b4)





POINT COUNTING ON GENUS 3 CURVES WITH AUTOMORPHISM GROUP Z/2Z

7

This gives us the reductions of xk+3y2dx or xk+2y2dx depending on the nullity of
a2
2 − 4b4.
l = 3.
As at the start of l = 2 (dealing with y5), one gets M 1

3,k whose transpose is

1
35 ·

−





0

6ka0b0

6k(a1b0 + a0b1) + 21a1b0

0
0
0
0 6k(a2b0 + a1b1 + a0b2) + 21a1b1 + 42a2b0
0 6k(a2b1 + a1b2 + a0b3) + 21a1b2 + 42a2b1
0 6k(a2b2 + a1b3 + a0b4) + 21a1b3 + 42a2b2
0
0

(6k + 21)(a2b3 + a1b4) + 21a2b3

(6k + 42)a2b4

0
0
0
0
0
0
0
0

(2k + 7)(3a2

k(6a2

0
0 − 20b0)
1 + 6a0a2 − 10b2)

(4k + 7)(3a0a1 − 5b1)
(4k + 21)(3a1a2 − 5b3)
(2k + 14)(3a2
2 − 10b4)

0
0





Since we want to reduce xj y3dx to those with smaller degree in x, M 1
3,k is not
suitable since it has (possible) non-zero entries which correspond to xk+5y1, xk+4y1
and xk+3y1. We use l = 1 to reduce xk+3ydx to {xj1 ydx, xj2 y3dx| j1 ≤ k + 2, j2 ≤
k + 1} if b4 6= 0, or reduce xk+2ydx to {xj1 ydx, xj2 y3dx| j1 ≤ k + 1, j2 ≤ k + 1} ) if
b4 = 0. Then use this result to reduce xk+3ydx (if b4 = 0), xk+4ydx and xk+5ydx
(if b4 6= 0) iteratively to {xj1 ydx, xj2 y3dx| j1 ≤ k + 2, j2 ≤ k + 3}, depending the
nullity of b4. Finally, use these reductions in M 1
Case 3 and Case 4: b4 6= 0

3,k, we get reduction matrices in

′

M

0
0
0
0

0 0
∗ ∗
0 0
∗ ∗

0
0
∗ ∗2,5
0
0
∗ ∗4,5

3,k = c ·

4(k + 4)(k + 5)(k + 6)(cid:0)(8k + 44)a1a2b4 − a2

with c = −1/(cid:0)2688(k + 4)(k + 5)(k + 6)b3

∗4,5 = 96b2

which equals to 384b3

4(cid:1) and

2 − 4b4)



2b3 − (16k + 84)b3b4(cid:1)

4(k + 4)(k + 5)(k + 6)(2k + 11)(a1a2 − 2b3) if a2

384(k + 4)(k + 5)(k + 6)(k + 7)b3

4(a2

0
0
0

2 − 4b4 = 0, and

∗2,5 = 36(k + 4)b4 (cid:18)(6k2 + 136k + 285)a2b3

3 − 8(6k2 + 56k + 125)a2b2b3

+ 48(k2 + 11k + 30)a2b1b2

4 + 16(k2 + 6k)a0b3b2
4

− 2(8k2 + 58k + 105)a1b2

4(cid:19)
Notice that ∗2,5 may be non-zero, but it corresponds to xk+2y and since b4 6= 0,
one can use M1,k−1 in the case l = 1 to reduce xk+2ydx and get a new reduction
matrices

3b4 + 16(2k2 + 17k + 35)a1b2b2

M3,k = c ·


0
∗
0
∗

0 0
∗ ∗
0 0
∗ ∗

0
0
∗
0
0
0
∗ ∗4,5

0
0
0

384(k + 4)(k + 5)(k + 6)(k + 7)b3

4(a2

2 − 4b4)




Notice that the reduction of xk+2ydx using M1,k−1 only involve xjydx with k− 2 ≤
j ≤ k+1 and xj y3 with k−2 ≤ j ≤ k, the last two columns of M3,k and M 2
3,k are the
same except the (2, 5)-entry, and M3,k satisﬁes the condition in Deﬁnition 3.4, so
they are indeed reduction matrices. The reduction involves division by 12(k + 4)b4,
hence c−1M3,k has integral coeﬃcients.

8

YIH-DAR SHIEH

Case 1 and Case 2: b4 = 0

M3,k = c ·


0
0
0
0

0
∗
0
∗

0 0
∗ ∗
0 0
∗ ∗

0
0
0
∗4,5

0
0
0

2(k + 7)(2k + 11)(4k + 15)(4k + 19)b2

3a2
2




with c = −1/(cid:0)7(4k + 15)(4k + 19)(4k + 23)b2
∗4,5 = (4k + 15)b3 (cid:18)(32k3 + 504k2 + 2648k + 4641)a1a2b3 − (4k2 + 52k + 168)a2

3(cid:1) and

2b2

3(cid:19)
− (64k3 + 1008k2 + 5276k + 9177)b2
which equals to −(4k + 15)(4k + 19)(4k + 21)(4k + 23)b3
˜Cξ,aﬀ /Qq.

3 if a2 = 0.
Now we can compute the algebraic de Rham cohomology H 1

dR( ˜Cξ,aﬀ /Qq) of

Proposition 3.5. The algebraic de Rham cohomology H 1

dR( ˜Cξ,aﬀ /Qq) has a

basis

(1) {ydx, y2dx, y3dx, xydx, xy2dx, xy3dx}, if b4 = 0 and a2 = 0.
(2) {ydx, y2dx, y3dx, xydx, xy2dx, xy3dx, x2y2dx, x2y3dx}, if b4 = 0 and
(3) {ydx, y2dx, y3dx, xydx, xy2dx, xy3dx, x2ydx}, if b4 6= 0 and a2
2 − 4b4 = 0.
(4) {ydx, y2dx, y3dx, xydx, xy2dx, xy3dx, x2ydx, x2y2dx, x2y3dx}, if b4 6= 0 and

a2 6= 0.

a2
2 − 4b4 6= 0.

Proof. We give the proof for (c). For other parts, the proofs are all similar.
Suppose b4 6= 0 and a2
2− 4b4 = 0. The reduction matrices M1,k shows that xk+3ydx
is a linear combination of {xj1 ydx, xj2 y3dx | k − 1 ≤ j1 ≤ k + 2, k − 1 ≤ j2 ≤
k + 1}, since b4 6= 0. So each xj ydx with j ≥ 3 can be reduced. The (3, 6)-
entry of the reduction matrix M2,k is (k + 6)(a2
2 − 4b4) = 0, but its (3, 5)-entry is
(2k + 9)(a1a2 − 2b3) which is non-zero by Case 3 in Section 3.1. So xk+2y2dx is a
linear combination of {xjy2 | k − 1 ≤ j ≤ k + 1} and hence each xjy2dx with j ≥ 2
can be reduced. The reduction matrix M3,k in Case 3 has (k + 7)(a2
2 − 4b4) = 0 at
the (4, 6)-entry, but its (4, 5)-entry is ∗4,5 = (2k + 11)(a1a2− 2b3) 6= 0. So xk+2y3dx
is a linear combination of {xj1 ydx, xj2 y3dx | k − 2 ≤ j1 ≤ k + 1, k− 2 ≤ j2 ≤ k + 1}
and hence each xjy3 with j ≥ 2 can be reduced. This completes the proof for
(c).

(cid:3)

The following table give a more clear description of these basis.

y

y2

dx 1 x x2
• ×
• ×
• ×
(1.a) Case 1

•
•
•

y3

y

y3

y2

dx 1 x x2
• ×
•
•
•
•
(1.b) Case 2

•
•
•

y

y2

dx 1 x x2
•
•
• ×
• ×
(1.c) Case 3

•
•
•

y3

y

y2

dx 1 x x2
•
•
•
(1.d) Case 4

•
•
•

•
•
•

y3

Table 1. basis of H 1

dR( ˜Cξ,aﬀ /Qq)

POINT COUNTING ON GENUS 3 CURVES WITH AUTOMORPHISM GROUP Z/2Z

9

3.3. Control of the denominators in the reduction algorithm and
Monsky-Washnitzer cohomology. The reduction algorithm in subsection 3.2
dR( ˜Cξ,aﬀ /Qq). By Theorem 3.1, this basis also
allows us to obtain a basis of H 1
forms a basis of the Monsky-Washnitzer cohomology H 1
MW (Caﬀ /Fq). One can also
prove this by the following upper bound on the denominators that appear during the
reduction process. This bound provides the precision necessary for our algorithm.
Before stating the main result of this subsection, we ﬁx some notations. For a
local parameter t at a point at inﬁnity P∞, we write the Laurent series expansion
of x, y and xj yi with respect to t as following:

(3.4)

x =

∞

Xs=υp(x)

δ0,1
s

ts, y =

∞

Xs=υp(y)

δ1,0
s

ts and xjyi =

∞

Xs=υp(xj yi)

δi,j
s

ts.

If a subscript is used to denote a local parameter at some point, we use this subscript
in the coeﬃcients of the above expansion. For example, in Case 3, we write xjyi =
− at P∞,−. Recall that all the coeﬃcents

s,− ts

s,+ ts

P∞
s δi,j
δi,j
s are in O in all cases that we are concerned, see Remark 3.3.

+ at P∞,+ and xjyi =P∞

s δi,j

Proposition 3.6. Write

(3.5)

xkyldx =

3

2

Xi=1

Xj=0

ai,jxjyidx + dS, where S =

3

Xi=0Xj≥0

bi,jxjyi

with ai,j and bi,j ∈ Qq, ai,j = 0 if xjyi is not in the basis in Proposition 3.5,
1 ≤ l ≤ 3 and k ∈ N. Then

(a) One can choose S with the property that bi,j = 0 if i − l 6= 0 (mod 2).
(b) For any S in (3.5) which satisﬁes the property in (a), we have bi,j−i = 0
for all 0 ≤ i ≤ 3 and j ≥ k +5. Furthermore pmbi,j−i ∈ O for all 0 ≤ i ≤ 3
and j ≥ 7, where m = ⌊logp(4k + 8)⌋.
(c) pm+∆+1ai,j ∈ Zq, where ∆ := 11(cid:0)⌊logp(63)⌋ + τ (p)(cid:1) with τ (3) = 5, τ (5) =
3, τ (p) = 1 for p = 7, 11, 13 and τ (p) = 0 if p > 13.
Proof. (a) Using the automorphism y → −y, or by a direct analysis on the
reduction process discussed in the previous subsection. (b) We prove this for Case 4,
proofs for other cases are all similar. From the expansions in Case 4, one obtains

(3.6)

xj yi =

∞

Xs=−(i+j)

δi,j
s,µ,±ts

µ,±

with δi,j
bi,j = 0 for all j > M . Hence

−(i+j),µ,± = (±αµ)i and µ = 1, 2. There is an integer M > 0 such that

bi,jxjyi =

3

M

Xi=0

Xj≥0

bi,j−iδi,j−i

−j,µ,± +

S =

=

3

M

M+3

Xj≥0
Xi=0

Xi=0
Xj=0


3

∞

bi,j

Xs=−(i+j)
Xj′>j   3
Xi=0

M+3

δi,j
s,µ,±ts

µ,±

bi,j′−iδi,j′−i

−j,µ,±!
 t−j

µ,±

10

YIH-DAR SHIEH

Since υp∞,µ,±(ai,j xjyidx) ≥ 7 and υp∞,µ,±(xkyldx) ≥ −(k + 5) and the expansions
of xkyldx have integral coeﬃcients, we have

(3.7)

3

j ·
Xi=0


bi,j−iδi,j−i

−j,µ,± +

M+3

Xj′>j   3
Xi=0

bi,j′−iδi,j′−i

−j,µ,±!

 ∈ O

for all j ≥ 7 and it is zero if j ≥ k + 5. Combine (3.7) with the property in (a) and
the fact that α1 and α2 are units in O (Fact 3.3), we get
Xi=0

∗
 ∈ O
for i = 0, 1, j ≥ 7 and µ = 1, 2, and it is zero if j ≥ k + 5. Since α2
here D = a2

j ·
1 · bi,j−i + α2

µ · bi+2,j−i−2 +

2 = √D,

1 − α2

Xj′>j

M+3

3

2 − 4b4 6= 0, one obtains

(3.8)

j ·
1 · bi,j−i + √D · bi+2,j−i−2 +

M+3

3

Xj′>j

Xi=0

∗
 ∈ O

for i = 0, 1, j ≥ 7, and it is zero if j ≥ k + 5, here ∗ involves only bi,j′−i with j′ > j
and elements in O. Remember that √D ∈ O∗. Apply j = M + 3 to (3.8), we
know that bi,M+3−i = 0 for all 0 ≤ i ≤ 3. Repeat the same argument, one shows
that bi,j−i = 0 for all 0 ≤ i ≤ 3 and j ≥ k + 5. Now apply j = k + 4 to (3.8),
we get pmbi,k+4−i ∈ O for all 0 ≤ i ≤ 3. Repeat the same argument and notice
that the terms ∗ in (3.8) are in O in each step (since all the δ•,•
and bi,j′−i ∈ O if
j′ > j in each step),one proves that pmbi,j−i ∈ O for all 0 ≤ i ≤ 3 and j ≥ 7. So
pmbi,j−i ∈ O ∩ Qq = Zq for all 0 ≤ i ≤ 3 and j ≥ 7.
(c) Consider

s

(3.9a)

(3.9b)

3

k+5

ω := pm
xkyldx − d
Xi=0

= pm
Xi=1


Xj≥7−i
ai,jxjyidx + d
Xi=0


bi,jxjyi



bi,jxjyi
Xj=0


Xj=0

6−i

3

2

3




From (b) and (3.9a), one knows that ω has integral coeﬃcients, so we can choose
ϕ1(x, y) and ψ1(x, y) in Zq[x, y] such that ω = ψ1 dx + ϕ1 dy. On the other hand,
from (3.9b), one know that ω = ψ2 dx + ϕ2 dy for some ϕ2 and ψ2 in Qq[x, y] with
deg(ϕ2) ≤ 5, deg(ψ2) ≤ 5. Consider
(3.10)

fy ω = fy (ψi dx + ϕi dy) = (ψify − ϕifx) dx
fx ω = fx (ψi dx + ϕi dy) = (ϕifx − ψify) dy
(using fx dx + fy dy = df = 0). Let λi(x, y) := ψify − ϕifx.
It is clear that
λ1 ∈ Zq[x, y] and λ2 ∈ Qq[x, y] with deg(λ2) ≤ 8. Using the deﬁning equation
f to reduce the degree of y in λi, we get fy ω = ˜λi dx and fx ω = −˜λi dy with
˜λ1 ∈ Zq[x, y], degy( ˜λ1) ≤ 3, ˜λ2 ∈ Qq[x, y], deg( ˜λ2) ≤ 8 and degy( ˜λ2) ≤ 3. Since
( ˜λ1 − ˜λ2)dx = fy ω − fy ω = 0 and degy( ˜λ1 − ˜λ2) ≤ 3, we have ˜λ1 = ˜λ2. This
means that fy ω = ˜λ dx and fx ω = −˜λ dy with ˜λ := ˜λ1 = ˜λ2 which is in Zq[x, y] of
deg(˜λ) ≤ 8. By Corollary 3.9, there exist α and β in Zq[x, y] with deg(α) ≤ 5 and

POINT COUNTING ON GENUS 3 CURVES WITH AUTOMORPHISM GROUP Z/2Z

11

i=1P2

deg(β) ≤ 5 such that αfy + βfx = 1 in A. So ω = (αfy + βfx) ω = (α˜λ)dx− (β˜λ)dy.
Notice that ω ≡ P3
j=0 pmai,j xjyidx, we can use the reduction of (α˜λ)dx −
(β˜λ)dy to get the denominators of pmai,j. Since deg(α˜λ) ≤ 13 and deg(β˜λ) ≤ 13,
we need only to know the denominators of the ﬁnal reductions of xjyidx and xjyidy
with 0 ≤ i + j ≤ 13. Using xjyidy ≡ −j/(i + 1)xj−1yi+1dx, the deﬁning equation
f , and xjdx ≡ 0, we only need to consider the reductions of xj yidx with 1 ≤ i ≤ 3
and i + j ≤ 13, but if p = 3, the extra denominator 3 should be counted.
The reduction of xkyldx (1 ≤ l ≤ 3) using the reduction matrices Mi,j in
subsection 3.2 involve divisions by some of the following: 12(k + 2)b4, (12k + 21)b3,
(k + 3)(a2
2 − 4b4),
384(k + 2)(k + 3)(k + 4)(2k + 7)b3
3a2
2,
−(4k + 7)(4k + 11)(4k + 13)(4k + 15)b3
3, depending on each case, and the numbers
2, a2, b4, b3, a2
2 − 4b4 and a1a2 − 2b3 that we need to consider (depending on each
case) are units of Zq. So in each step, we get extra denominators which are at most

2 − 4b4), (2k + 5)(a1a2 − 2b3), 384(k + 1)(k + 2)(k + 3)(k + 4)b3

4(a1a2 − 2b3), 2(k + 4)(2k + 5)(4k + 3)(4k + 7)b2

4(a2

p⌊logp(4j+15)⌋+τ (p),

here τ (3) = 5, τ (5) = 3, τ (p) = 1 for p = 7, 1, 13 and τ (p) = 0 if p > 13. Since
we are concerned with 2 ≤ j ≤ 12, we need at most 11 reduction steps, so the
denominators of the reductions of xjyidx with 1 ≤ i ≤ 3 and i + j ≤ 13 are at most

p11·(⌊logp(63)⌋+τ (p)).

Hence pm+∆+1ai,j ∈ Zq.

(cid:3)

Remark 3.7. Proposition 3.6 gives an upper bound for the denominators after
a diﬀerential form (with integral coeﬃcients) is reduced to the linear combination
of the basis we found in Propsition 3.5. Along with the rate of convergence of
the Frobenius Fp (see Corollary 4.3), one can determine how much p-adic precision
we need to work with (and determine an integer N3 such that one can work with
modulo xN3), see Section 6. But one needs an upper bound for all the denominators
that will appear during the computation (in the reduction step) in order to know
how much precision of the reduction matrices Mi,j are required and to have an
analysis of the bit complexity.
It turns out that one has a similar bound as in
Proposition 3.6. The proof is completely similar.

Theorem 3.8. Let R be a ﬁeld or a discrete valuation ring and m be the

maximal ideal of R. Let f0, . . . , fn ∈ R[x1, . . . , xn] with degfi = di and deﬁne

ρ = d0 + . . . + dn − n − 1.

Denote the homogenization of fi by f h
i
point in Pn(R/m) satisﬁes f h
g0, . . . , gn ∈ R[x1, . . . , xn] with deg gi ≤ ρ + 1 − di for i = 0, . . . , n such that

for i = 0, . . . , n. Assume that there is no
n = 0. Then there exist polynomials

1 = . . . = f h

0 = f h

n

gifi = 1.

Xi=0

Proof. This appears as Theorem 2 in Denef-Vercauteren [2].

(cid:3)

Corollary 3.9. There exist α and β in Zq[x, y] with deg(α) ≤ 5 and deg(β) ≤
5 such that αfy + βfx = 1 in A. Furthermore, one can ﬁnd such α and β such that
α has only odd degrees in y and β has only even degrees in y.

12

YIH-DAR SHIEH

Proof. Apply 3.8 to R = Zq, f0 = f , f1 = fy and f2 = fx.
Apply 3.8 to R = Zq, f0 = f , f1 = fy and f2 = fx. If α and β don’t satisfy
the last property, consider the equality α(x,−y)fy(x,−y) + β(x,−y)fx(x,−y) = 1
in A. From (3.1), it is clear that fy(x,−y) = −fy(x, y) and fx(x,−y) = fx(x, y).
We thus have

(cid:18) α(x, y) − α(x,−y)

2

(cid:19) fy +(cid:18) β(x, y) + β(x,−y)

2

(cid:19) fx = 1,

which completes the proof.

(cid:3)

4. Lift of Frobenius

In this section, we describe a lift Fp of the absolute Frobeninus endomorphism
F p : a → ap on the coordinate ring A of C aﬀ to A†. This means that Fp is a Zp-
algebra endomorphism on A† such that π ◦ Fp = F p ◦ π, where π is the reduction
modulo p. The lift Fq of the q-th Frobenius endomorphism of A is F n
p , hence one
can work with Fp for the purpose of computation.

Denote by σ the p-th power Frobenius endomorphism on Fp and also its lift on

Zp. Any lift Fp satisﬁes

Fp(x) ≡ xp mod p, Fp(y) ≡ yp mod p, Fp(f (x, y)) = 0.

From Corollary 3.9, we know that there exist α and β in Zq[x, y] such that αfy+ βfx =
1. Deﬁne δy := αp, δx := βp and consider the equation

G(Z) := Fp(f (x, y)) = f σ(xp + δxZ, yp + δyZ) = 0

(4.1)
in A†[Z]. Then G(0) = f σ(xp, yp) ≡ f σ(xσ, yσ) = 0 mod p. Also G′(0) =
f σ
y (xp, yp)δy + f σ
y αp +
x βp = (fyα + fxβ)p = 1 mod p. Hence by Hensel’s lemma, there is a unique so-
f p
lution of (4.1) in A∞. Use the following proposition and its corollary, this solution
is in fact in A†. In fact, Corollary 4.3 below gives an explicit lower bound on the
rate of convergence, which allows us (together with Proposition 3.5) to work with
a ﬁnite and explicit p-adic precision.

x (xσ, yσ)δx ≡ f p

y δy + f p

x δx = f p

x (xp, yp)δx ≡ f σ

y (xσ, yσ)δy + f σ

Lemma 4.1. Let H(Z) = P hk(x)Z k ∈ Zq[x][Z] and ∆1,k = dk := deg(hk).
Assume h0(x) ≡ 0 mod p and h1(x) ≡ 1 mod p. Let 0 ≤ ∆n,0 ≤ ∆n,1 ≤ ··· ≤
∆n,j ≤ ··· (n ≥ 1, j ≥ 0) with δj = ∆1,j be integers stastiﬁes the following
conditions:

1. ∆n+1,j ≥ max{∆n,j−l + δl | 0 ≤ l ≤ j} for all n ≥ 0, j ≥ 0.
2. δ0 ≥ d0.
3. δj − δj−1 ≥ d1 for all j ≥ 1.
4. δk−1+j ≥ ∆k,j + dk for all k ≥ 2, j ≥ 0.
Then the unique solution α = P∞
2 if i ≥ δj + 1. One can always ﬁnd such ∆n,j.
Proof. Let T := {P∞
i=0 aixi ∈ Zqhxi | vp(ai) ≥ j + 2 if i ≥ δj + 1} be a subset
of Zqhxi, here −1 = δ−1 < 0 ≤ δ0 ≤ δ1 ≤ ··· ≤ δj ≤ ··· are integers which we will
determine for which T satisﬁes some properties that are used in the proof. For each
n, one can write T n = {P∞
i=0 aixi ∈ Zqhxi | vp(ai) ≥ n + j + 1 if i ≥ ∆n,j + 1} for
some −1 = ∆n,−1 < 0 ≤ ∆n,0 ≤ ∆n,1 ≤ ··· ≤ ∆n,j ≤ ··· . A suﬃcient condition

i=0 aixi ∈ Zqhxi has the property: vp(ai) ≥ j +

POINT COUNTING ON GENUS 3 CURVES WITH AUTOMORPHISM GROUP Z/2Z

13

for T n ⊂ T is ∆n+1,j ≥ max{∆n,j−l + δl | 0 ≤ l ≤ j} for all n. Notice that T is
closed under addition. In Zqhxi, we can use Newton method:

αi+1 = αi −

H(αi)
H ′(αi)

= αi − H(αi) 1 +

(1 − H ′(αi))k! .

∞

Xk=1

k=2 hk(x)αk

Our goal is to determine a condition on δj for which the result in each iteration
above is in T . We use induction: assume αi ∈ T and to prove αi+1 ∈ T . It is
suﬃcient to show: H(αi) ∈ T and (1 − H ′(αi)) T ⊂ T . H(αi) = h0(x) + h1(x)αi +
P∞
i . Since vp(h0(x)) ≥ 1, h0(x) ∈ T if d0 ≤ δ0. Since h1(x)αi =
αi− (1 − h1(x)) αi, αi ∈ T and vp (1 − h1(x)) ≥ 1, h1(x)αi ∈ T if δj − δj−1 ≥ d1 for
all j ≥ 1. Similarly for k ≥ 2, since αk
i ∈ T k, hk(x)αk
i ∈ T if ∆k,j + dk ≤ δk−1+j.
In fact, the above conditions imply (1 − h1(x)) T ⊂ T and hk(x)T k ⊂ T . Using
this fact with (1 − H ′(αi)) T = (cid:0)(1 − h1(x)) +P∞
(cid:1) T and αk−1
∈
T k−1, we know (1 − H ′(αi)) T ⊂ T . Hence αi+1 ∈ T and this implies the solution
α ∈ T .
For the existence ∆n,j, notice that the conditions 2, 3 and 4 are equivalent
to: ∆1,n+1 ≥ max{∆1,n + d1, ∆k,n+2−k + dk | 2 ≤ k ≤ n + 2} for all n ≥ 0.
Suppose one has determined ∆n′,j′ for all n′ + j′ ≤ n + 1. Use condition 1, one can
determine ∆k,n+2−k for all 2 ≤ k ≤ n + 2 (i.e for ∆n′,j′ with n′ + j′ ≤ n + 2 and
n′ ≥ 2). Finally, one determines ∆1,n+1. Therefore, one determines all the ∆n′,j′
with n′ + j′ ≤ n + 2. This shows that one can ﬁnd ∆n,j recursively.

k=2 −khk(x)αk−1

(cid:3)

i

i

Lemma 4.2. Suppose deg(hk(x)) ≤ (k + 1) d in Lemma 4.1. Then ∆i,j :=
(i + 4j) d satisfy the conditions in Lemma 4.1 and all the inequalities are equalities.
In particular, δj = (4j + 1) d.

Proof. This follows by induction in i and j.

(cid:3)

Corollary 4.3. There exists a lift Fp of the absolute Frobeninus endomor-
phism a → ap on the coordinate ring A of Caﬀ to A† such that Fp(x) = xp + δxZ0
and Fp(y) = yp + δyZ0 with Z0 = Pi,j ai,jxjyi, ai,j ∈ Zq and ordp(ai,j) > i+j
16p .
Also the coeﬃcient of xjyi in Fp(y) and Fp(x) has p-adic order > i+j
16p if i + j 6= p.
Finally, Fp(xkyldx) =P3
16p − 4.

i=1Pj bi,jxj yidx with ordp(bi,j) > i+j

Proof. Using Corollary 3.9 and equation (4.1), one can apply d = 4p to
(cid:3)

Lemma 4.2.

Theorem 4.4. There exists a lift of Frobenius Fp on A† which commutes with

the involution τ : y → −y and has the rate of convergence in Corollary 4.3.

Proof. We choose α and β such that α has only odd degrees in y and β has
only even degrees in y as in Corollary 3.9. Since δy = αp and δx = βp, they have
the same property as α and β. For solving G(Z) = 0 by Newton’s method, we use
Lemma 4.1 with H = G = f σ(xp + δxZ, yp + δyZ). It is clear that G has only even
degrees in y, hence so does the solution Z0. From this, it is clear that the lift of
Frobenius Fp : A† → A† commutes with the involution τ .
(cid:3)

5. Quotient by Automorphism

We have study H 1

MW (Caﬀ /Fq). In this section, we consider the quotient of C
by the automorphism τ : Y → −Y . We denote the quotient map by π : C → E :=

14

YIH-DAR SHIEH

˜π

C/hτi. One can show that C/hτi has genus 1 either by Riemann-Hurwitz genus
formula or from the aﬃne equation directly, using the fact that Caﬀ is stable under
τ and Caﬀ /hτi is smooth, hence the notation E is justiﬁed. The aﬃne part Eaﬀ of
E is Caﬀ /hτi, which has the deﬁning equation: v2 + g(u)v + h(u) = 0. We have
π−→ Eaﬀ , (x, y) → (x, y2), and the corresponding map on the coordinate ring is
Caﬀ
π∗ : u → x, v → y2.
MW (Eaﬀ /Fq), the induced map π∗ :
Our goal is to study the followings: H 1
H i
MW (Eaﬀ /Fq) → H i
MW (Caﬀ /Fq) and its interplay with Frobenius endomorphism.
−→ ˜Eaﬀ , (x, y) → (x, y2) lifts π, here ˜Eaﬀ is the lift of Eaﬀ , whose deﬁning
Since ˜Caﬀ
equation is v2 + g(u)v + h(u) = 0, we can study H i
MW (Caﬀ /Fq)
dR( ˜Caﬀ,ξ/Qq). For i 6= 1, these are isomorphisms. For
by H i
i = 1, since {˜π∗(ujvdu) = xj y2dx} | 0 ≤ j ≤ 1 (resp. 0 ≤ j ≤ 2)} are linear
in Case 2 and Case 4), one sees that
independent in Case 1 and Case 3 (resp.
{ujvdu | 0 ≤ j ≤ 1 (resp. 0 ≤ j ≤ 2)} are linear independent. Let δE be the
number of points at inﬁnity of E. We have δE = 1, 2, 1, 2 in each case, hence
dR( ˜Eaﬀ,ξ/Qq) = 2·gE − 1 + δE = 2, 3, 2, 3. This shows that {ujvdu | 0 ≤ j ≤
dimZq H 1
dR( ˜Eaﬀ,ξ/Qq) which is isomorphic via ˜π∗ to the
1 (resp. 0 ≤ j ≤ 2)} is the basis of H 1
dR( ˜Caﬀ,ξ/Qq) generated by {xjy2dx | 0 ≤ j ≤ 1 (resp. 0 ≤ j ≤ 2)}.
subsapce V of H 1
E of the Frobenius endomorphism
F q,E on the coordinate ring AE of E. The left diagram below is not necessary
commutative, but its reduction mod p is commutative

As in Section 4, there is a lift Fq,E : A†

dR( ˜Eaﬀ,ξ/Qq) ˜π∗

MW (Eaﬀ /Fq) π∗

E → A†

−→ H i

−→ H i

˜π∗

A†

A†
E

A

π∗

AE

Fq

Fq,E

F q

F q,E

A†

A†
E

˜π∗

A

AE

π∗

˜π∗

E is the natural lift of homomorphism A ˜π∗

Here A†
←−− AE on the coordinate
rings which corresponds to the morphism ˜π : ˜Caﬀ,ξ/Qq → ˜Eaﬀ,ξ/Qq, so the reduc-
tion of A†
E modulo p is just the natural homomorphism on the coordinate
rings of Caﬀ

←−− A†
←−− A†
π−→ Eaﬀ . Since F q ◦ π∗ = π∗ ◦ F q,E, we know that
MW (Eaﬀ /Fq)

MW (Caﬀ /Fq)

H i

H i

˜π∗

π∗

Fq,∗

Fq,E,∗

H i

MW (Caﬀ /Fq)

π∗

H i

MW (Eaﬀ /Fq)

So the point counting on Eaﬀ is the same as computing on the subsapce of H 1
generated by {xjy2dx | 0 ≤ j ≤ 1 (resp. 0 ≤ j ≤ 2)}.

From Lefschetz ﬁxed point formula (Theorem 2.3), we have
q,∗ )r|H 1
q,∗ )r|H 1

#Caﬀ (Fqr ) = Tr(cid:0)(qF −1
#Eaﬀ (Fqr ) = Tr(cid:0)(qF −1

MW (Caﬀ )(cid:1) − Tr(cid:0)(qF −1
MW (Eaﬀ )(cid:1) − Tr(cid:0)(qF −1

q,∗ )r|H 0
q,∗ )r|H 0

MW (Caﬀ )(cid:1)
MW (Eaﬀ )(cid:1)

MW (Caﬀ /Fq)





o
o
o
o




o
o
o
o




o
o
o
o
POINT COUNTING ON GENUS 3 CURVES WITH AUTOMORPHISM GROUP Z/2Z

15

1 + βr
Let PE(X) = (X − β1)(X − β2) be the Weil polynomial of E and Sr(E) := βr
2.
Then #Eaﬀ (Fqr ) = qr + 1− Sr(E)− δE, here δE is the number of points at inﬁnity
of E. Use #Caﬀ (Fqr ) = #C(Fqr ) − δC , we get

#C(Fqr ) = qr + 1 − Sr(E) − Tr(cid:0)(qF −1

q,∗ )r|V(cid:1) + (δC − δE),

MW (Caﬀ /Fq) generated by {xjy2dx | 0 ≤ j ≤ 1 (resp. 0 ≤
here V is the subsapce of H 1
j ≤ 2)}, whose dimension is 4+δC−δE. This implies that the Weil polynomial P (X)
of C/Fq equals to PE(X)QV (X)(X − 1)−(δC −δE ), here QV (X) is the characteristic
polynomial of qF −1
q,∗ acts on V . The characteristic polynomial PV (X) of Fq,∗ =
q · (qF −1

q,∗ )−1 is QV (X)(X − q)δC −δE (X − 1)−(δC −δE ), so

P (X) = PE(X)PV (X)(X − q)−(δC −δE ).

Summary 5.1. The Weil polynomial P (X) of C/Fq is equal to

PE(X)PV (X)(X − q)−(δC −δE ),

where PE(X) is the Weil polynomial of E/Fq and PV (X) is the characteristic
polynomial of Fq,∗ on V .

6. The Algorithm

In order to compute PV (X), one needs to compute PV (X) with a precision
N1 = ⌊logp30+2n⌋+1 with n = logpq, which is determined by the Weil bound. Due
to the fact that the matrix Mp of the Frobenius action Fp,∗ may have denominators,
we need Mp with a precision N2 := N1 + (6n − 1)c with c = ⌊c1 + logp(c1 +
logp(2c1))⌋ + 1 and c1 = 6 + logp80 + ∆. From this, we only need to compute (for
1 ≤ l ≤ 3 and 0 ≤ k ≤ 2) Z0, Fp(x), Fp(y) and Fp(ylxkdx) modulo (xN3 , pN4)
with N3 = ⌊16p(c2 + logp(2c2))⌋ + 1, N4 = ⌊N2 + c1 + logp(c2 + logp(2c2))⌋ + 1
and c2 = 6 + logp80 + ∆ + N2. Finally, the above discussion is based on the
reduction matrices Mi,k (1 ≤ i ≤ 3) introduced in 3.2. But since one can only
work with an approximation of Mi,k, one need Mi,k modulo pN5 with a slightly
higher precision N5 = N4 + 8⌊logpN3⌋ + 14 . We have N3 = O(pn), N4 = O(n) and
N5 = O(n). We work in Zq/pN5 3, whose elements can be stored in O(n2logp) space
and the arithmetic on it could be done in ˜O(n2logp) bit operations. This gives the
algorithm:

Algorithm

Step 1. Compute α and β in Corollary 3.9 modulo p.4
Step 2. Compute Z0 in Corollary 4.3 using Newton’s method, then Fp(xkyldx)

for l = 1, 3 and 0 ≤ k ≤ 2, all of them are modulo (xN3 , pN4).5
Step 3. Use reduction matrices Mi,j (1 ≤ i ≤ 3, 2 ≤ j ≤ N3) to reduce
Fp(xkyldx) and get Mp.
Step 4. Compute Mq = MpM σ
Step 5. Finally, compute the characteristic polynomial PV (X) modulo P N1.

p ··· M σn−1

by repeated squaring.

p

3More precisely, with p-adic precsion N4 but with denominators at most p(N5−N4).
4In Corollary 3.9, we only need αfy + βfx ≡ 1 modulo p in order to compute the lift of

Frobenius.

5In the proof of Lemma 4.1, we showed that the results during the Newton’s iteration all
have the same rate of convergence as in Corollary 4.3, so we can work modulo xN3 during the
Newton’s iteration.

16

YIH-DAR SHIEH

Theorem 6.1. The above algorithm requires ˜O(n3p) bit operations.

Proof. Step 1 consists of solving a system of linear equations over Fq of size
at most 16. Hence it requires ˜O(n2 log p) bit operations. Step 2 requires O(log N4)
Newton’s iterations, and each iteration requires ˜O(N3n2log p) bit operations. Hence
this step requires ˜O(pn3) bit operations. Step 3 requires O(N3) operations in
Zq/pN5, hence ˜O(pn3) bit operations. Step 4 requires O(log n) squarings and the
application of the lift of the p-th power Frobenius σ : Zq → Zq modulo pN4 on
matrices of size 6 × 6. Squaring requires ˜O(n2log p) bit operations. For σ, we use
Newton’s method which needs to evaluate a polynomial of degree n with coeﬃ-
cients in Zq/pN4, which requires O(n) ˜O(n2 log p) bit operations. Hence we need
˜O(n3 log p) bit operations in this step. Step 5 requires ˜O(n2 log p) bit operations.
Hence the algorithm requires ˜O(n3p) bit operations.
(cid:3)

If one works directly on H 1

MW (Caﬀ ) and denote the precision needed by N ′

3 N ′

5 . (It is 4

5 instead of 2

i . Also the matrix Mp is of size 6×6 and M ′

i , then
Ni ≈ 2
p is of size 9×9. From these, we
give a comparison of speed. Step 2 is reduced by a factor of ( 2
3 )2 ≈ 0.45. In Step 3,
we have 6 diﬀerential forms Fp(xkyldx), l = 1, 3 and 0 ≤ k ≤ 2, to reduce. This
contributes a factor of 4
3 because the reductions of Fp(xky2dx)
involve fewer operations than the reductions of Fp(xky1dx) and Fp(xky3dx). See
the reduction matrices in 3.2.) Since each of these Fp(xkyldx) is computed modulo
(xN3, pN4) in Step 2, we work with smaller powers on x and fewer p-adic precision
in Step 3. This means that we have fewer reduction steps and the basic arithmetic
operations are faster, which contribute a factor of ( 2
3 )2. So Step 3 is reduced by a
factor of 4
3 )3 ≈ 0.3, due
to the smaller size of Mp and fewer precision.

3 )2 ≈ 0.36. Step 4 is reduced by a factor at least of ( 2

5 · ( 2

References

[1] Castryck, W., Point counting on nondegenerate curves. Katholieke Universiteit Leuven, The-

sis, 135 pp. (2006). Avaiable at: http://wis.kuleuven.be/algebra/castryck/thesis.pdf

[2] Denef, J.; Vercauteren, F., Counting Points on Cab Curves using Monsky-Washnitzer Coho-

mology. Finite Fields and Their Applications, Volume 12, Issue 1, pp. 78-102 (2006)

[3] Elkik, R., Solutions d’´equations `a coeﬃcients dans un anneau hens´elien. Ann. Sci. ´Ecole

Norm. Sup. (4), 6:553-603 (1973)

[4] Gaudry, P.; G¨urel, N., An extension of Kedlaya’s algorithm to superelliptic curves. Proc.

Asiacrypt 2001, Springer, Berlin, Lecture Notes in Comput. Sic., 2248: 480-494 (2001)

[5] Kedlaya, K., Counting Points on Hyperelliptic Curves using Monsky-Washnitzer Cohomol-

ogy. J. Ramanujan Math. Soc. (4), 16: 323-338 (2001)

[6] Kedlaya, K., Computing zeta functions via p-adic cohomology. Proc. ANTS-VI, Springer

LNCS, 3076: 1-17 (2004)

[7] Monsky, P.; Washnitzer, G., Formal cohomology I. Ann. Math. (2), 88: 181-217 (1968)
[8] Monsky, P., Formal cohomology II: The cohomology sequence of a pair. Ann. Math. (2), 88:

218-238 (1968)

[9] Monsky, P., Formal cohomology III: Fixed point theorems. Ann. Math. (2), 93: 315-343 (1971)
[10] van Der Put, M., The cohomology of Monsky and Washnitzer. M´em. Soc. Math. France

(N.S.) (4): 23:33-59 (1986)

[11] Vermeulen, A.M., Weierstrass pointss of weight two on curves of genus three. Amsterdam

University Thesis, 1983.

POINT COUNTING ON GENUS 3 CURVES WITH AUTOMORPHISM GROUP Z/2Z

17

Aix Marseille Universit´e, CNRS, Centrale Marseille, I2M, UMR 7373, 13453 Mar-

seille, France

Current address:

Institut de Math´ematiques de Marseille (I2M)
163 avenue de Luminy, Case 907
13288 Marseille, cedex 9
France

E-mail address: chiapas@gmail.com

