AN INTEGRATED MODEL FOR THE PRODUCTION OF

X-RAY TIME LAGS AND QUIESCENT SPECTRA FROM

HOMOGENEOUS AND INHOMOGENEOUS BLACK HOLE

ACCRETION CORONAE

John J. Kroon

School of Physics, Astronomy, and Computational Sciences, George Mason University,

Fairfax, VA 22030-4444, USA; jkroon@gmu.edu

Peter A. Becker

School of Physics, Astronomy, and Computational Sciences, George Mason University,

Fairfax, VA 22030-4444, USA; pbecker@gmu.edu

Received

;

accepted

submitted to ApJ

6
1
0
2

 
r
a

M
5

 

.

 
 
]
E
H
h
p
-
o
r
t
s
a
[
 
 

1
v
8
2
7
1
0

.

3
0
6
1
:
v
i
X
r
a

– 2 –

ABSTRACT

Many accreting black holes manifest time lags during outbursts, in which

the hard Fourier component typically lags behind the soft component. Despite

decades of observations of this phenomenon, the underlying physical explana-

tion for the time lags has remained elusive, although there are suggestions that

Compton reverberation plays an important role. However, the lack of analytical

solutions has hindered the interpretation of the available data.

In this paper,

we investigate the generation of X-ray time lags in Compton scattering coronae

using a new mathematical approach based on analysis of the Fourier-transformed

transport equation. By solving this equation, we obtain the Fourier transform of

the radiation Green’s function, which allows us to calculate the exact dependence

of the time lags on the Fourier frequency, for both homogeneous and inhomoge-

neous coronal clouds. We use the new formalism to explore a variety of injection

scenarios, including both monochromatic and broadband (bremsstrahlung) seed

photon injection. We show that our model can successfully reproduce both the

observed time lags and the time-averaged (quiescent) X-ray spectra for Cyg X-1

and GX 339-04, using a single set of coronal parameters for each source. The time

lags are the result of impulsive bremsstrahlung injection occurring near the outer

edge of the corona, while the time-averaged spectra are the result of continual

distributed injection of soft photons throughout the cloud.

Subject headings: X-ray time lags — accretion, accretion disks — black hole

physics — black hole binaries: coronae

– 3 –

1.

INTRODUCTION

Many accretion-powered X-ray sources display rapid variability, coupled with a

time-averaged spectrum consisting of a power law terminating in an exponential cutoﬀ at

high energies. The ubiquitous nature of the observations suggests a common mechanism

for the spectral formation process, regardless of the type of central object (e.g. black hole,

neutron star, AGN, etc.). Over the past few decades, the interpretation of the spectral data

using steady-state models has demonstrated that the power-law component is most likely
due to the thermal Comptonization of soft seed photons in a hot (∼ 108 K) coronal cloud
(Sunyaev & Titarchuk 1980). While the spectral models yield estimates for the coronal

temperature and optical depth, they do not provide much detailed information about the

geometry and morphology of the plasma. On the other hand, observations of variability,

characterized by time lags and power spectral densities (PSDs), can supplement the spectral

analysis, yielding crucial additional information about the structure of the inner region in

the accretion ﬂow, where the most rapid variability is generated.

In particular, the study of X-ray time lags, in which the hard photons associated with

a given Fourier component arrive at the detector before or after the soft photons, provides a

unique glimpse into the nature of the high-frequency variability in the inner region. Fourier

time lags oﬀer an ideal tool for studying rapid variability because, unlike short-timescale

spectral snapshots, which become noisy due to the shortage of photons in small time bins,

the Fourier technique utilizes all of the data in the entire observational time window,

which could extend over hundreds or thousands of seconds. Hence the resulting time lag

information usually has much higher signiﬁcance than can be achieved using conventional

spectral analysis.

– 4 –

1.1. Fourier Time Lags

The Fourier method for computing time lags from observational data streams in

two energy channels was pioneered by van der Klis et al. (1987), who proposed a novel

mathematical technique for extracting time lags by creating a suitable combination of the

hard and soft Fourier transforms for a given value of the circular Fourier frequency, ω. The

method utilizes the Complex Cross-Spectrum, denoted by C(ω), deﬁned by

C(ω) ≡ S ∗(ω) H(ω) ,

(1)

where S and H are the Fourier transforms of the soft and hard channel time series, s(t)

and h(t), respectively, and S ∗ denotes the complex conjugate. The Fourier transforms are

calculated using

and likewise for the hard channel,

S(ω) =Z ∞

−∞

eiωts(t)dt ,

H(ω) =Z ∞

−∞

eiωth(t)dt .

(2)

(3)

The phase lag between the two data streams is computed by taking the argument of C(ω),

which is the argument angle in the complex plane, and the associated time lag, δt, is

obtained by dividing the phase lag by the Fourier frequency. Hence we have the relations

δt =

arg(C)
2πνf

=

arg(S ∗H)

2πνf

,

where the Fourier frequency, νf , is related to the circular frequency ω via

νf =

ω
2π

.

(4)

(5)

As a simple demonstration of the time lag concept, it is instructive to consider the case

where the hard and soft channels, h(t) and s(t), are shifted in time by a precise interval ∆t,

so that the two signals are related to each via

h(t) = s(t − ∆t) ,

(6)

– 5 –

where ∆t > 0 would indicate a hard time lag. Next we take the Fourier transform of the

hard channel time series to obtain

H(ω) =Z ∞

−∞

eiωth(t)dt =Z ∞

−∞

eiωts(t − ∆t)dt .

Introducing a new time variable, t′ = t − ∆t with dt′ = dt, allows us to transform the
integral in Equation (7) to obtain

H(ω) =Z ∞

−∞

eiω(t′+∆t)s(t′)dt′ = eiω∆tS(ω) .

It follows from Equation (1) that the resulting complex cross-spectrum is given by

C(ω) = S ∗(ω)eiω∆tS(ω) = eiω∆t|S(ω)|2 ,

and hence the resulting time lag is (cf. Equation (4))

(7)

(8)

(9)

δt =

ω∆t

ω

= ∆t .

(10)

This simple calculation conﬁrms that the time lag computed using the Fourier method

gives the correct answer when a perfect delay is introduced between the two channels, as

expected. It is also important to note that time lags are only produced during a transient.

We can see this by setting the hard and soft signals equal to the constants h0 and s0,

respectively, so that h(t) = h0 and s(t) = s0. In this case, the resulting Fourier transforms

H and S have the same phase, and consequently there is no phase lag or time lag. Hence

observations of time lags necessarily imply the presence of variability in the observed signal.

1.2. X-Ray Time Lag Phenomenology

The fundamental physical mechanism underlying the X-ray time lag phenomenon

has been debated for decades, but it is generally accepted that the time lags reﬂect the

time-dependent scattering of a population of seed photons that are impulsively injected

– 6 –

into an extended corona of hot electrons (e.g., van der Klis et al. 1987; Miyamoto et al.

1988). This initial population of photons gain energy as they Comptonize in the cloud, and

the hard time lags are a natural consequence of the extra time that the hard photons spend

in the cloud gaining energy via electron scattering before escaping. In contrast with the

time lags, the time-averaged (quiescent) spectra are thought to be created as a result of the

Compton scattering of continually injected seed photons. The time-dependent upscattering

of soft input photons is discussed in detail by Payne (1980) and Sunyaev & Titarchuk

(1980), who present fundamental formulas for the resulting X-ray spectrum. Since that

time, many detailed models have been proposed, most of which focus on a single aspect

of radiative transfer, usually by making assumptions about the physical conditions in the

disk/corona system regarding the electron temperature, the input photon spectrum, and

the size and optical depth of the scattering corona.

The Fourier time lags observed from accreting black-hole sources generally decrease

with increasing Fourier frequency, νf . In the case of Cyg X-1, for example, the time lags
decrease from ∼ 0.1 − 10−3 sec as νf increases from ∼ 0.1 Hz - 102 Hz . Early attempts
to interpret this data using simple Compton scattering models resulted in very large, hot
scattering clouds, which required very eﬃcient heating at large distances (∼ 105−6 GM/c2)
from the central mass (Poutanen & Fabian 1999, Hua et al. 1999, hereafter HKC).

Furthermore, the observed dependence of the time lags on the Fourier frequency was

diﬃcult to explain using a homogeneous Compton scattering model. For example, van der

Klis et al. (1987) and Miyamoto et al. (1988) found that a homogeneous corona combined

with monochromatic soft photon injection resulted in time lags that are independent of the

Fourier frequency, νf , in contradiction to the observations. This led Miyamoto et al. (1988)

to conclude, somewhat prematurely, that thermal Comptonization could not be producing

the lags. However, in the next decade, HKC and Nowak et al. (1999) developed more

robust Compton simulations that successfully reproduced the observed time lags, although

– 7 –

the large coronal radii ∼ 104.5−5.5 GM/c2 continued to raise concerns regarding energy
conservation and heating.

HKC computed the time lags and the time-averaged spectra for a variety of electron

number density proﬁles, based on the injection of low-temperature blackbody seed photons

at the center of the coronal cloud. They employed a two-region structure, comprising a

central homogeneous zone, connected to a homogeneous or inhomogeneous outer region

that extends out to several light-seconds from the central mass. In the inhomogeneous
case, the electron number density, ne(r), in the outer region varied as ne(r) ∝ r−1 or
ne(r) ∝ r−3/2. In the HKC model, the injection spectrum and the injection location were
both held constant, and a zero-ﬂux boundary condition was adopted at the center of the
cloud. HKC found that only the model with ne(r) ∝ r−1 in the outer region was able to
successfully reproduce the observed dependence of the time lags on the Fourier frequency.

On the other hand, in the homogeneous case, HKC conﬁrmed the Miyamoto et al. (1988)

result that the time lags are independent of the Fourier frequency, in contradiction to the

observational data. This result was also veriﬁed later by Kroon & Becker (2014, hereafter

KB) for the case of monochromatic photon injection into a homogenous corona.

1.3. Dependence on Injection Model

Despite the progress made by HKC and other authors, no successful ﬁrst-principles

theoretical model for the production of the observed X-ray time lags has yet emerged. In the

absence of such a model, one is completely dependent on Monte Carlo simulations, which

are somewhat inconvenient since the resulting time lags are not analytically connected

with the parameters describing the scattering cloud. Monte Carlo simulations are also

noisy at high Fourier frequency, which is the main region of interest in many applications,

although this can be dealt with by adding more test particles. Compared with an analytical

– 8 –

calculation, the utilization of Monte Carlo simulations makes it more challenging to explore

diﬀerent injection scenarios, such as the variation of the injection location and the seed

photon spectrum.

The situation changed recently with the work of KB, who presented a detailed

analytical solution to the problem of time-dependent thermal Comptonization in spherical,

homogeneous scattering clouds. By obtaining the fundamental photon Green’s function

solution to the problem, they were able to explore a wide variety of injection scenarios,

leading to a better understanding of the relationship between the observed time lags

and the underlying physical parameters. KB veriﬁed the Miyamoto result, namely that

monochromatic injection in a homogeneous cloud produces time lags that are independent

of Fourier period. The magnitude of this (constant) lag depends primarily on the radius

of the cloud, R, its optical thickness, τ∗, and the electron temperature, Te. Following

HKC, they employed a zero-net ﬂux boundary condition at the center of the corona

(essentially a mirror condition), so that injection could occur at any radius inside the cloud.

The photon transport at the outer edge of the cloud was treated using a free-streaming

boundary condition in order to properly account for photon escape. KB demonstrated

that the injection radius and the shape of the injected photon spectrum play a crucial

role in determining the dependence of the resulting time lags on the Fourier frequency. In

particular, they established for the ﬁrst time that the reprocessing of a broadband injection

spectrum (e.g., thermal bremsstrahlung) can successfully reproduce most of the time lag

data for Cyg X-1 and other sources.

In the study presented here, we expand on the work of KB to obtain the radiation

Green’s function for inhomogeneous scattering clouds. We also present a more detailed

derivation of the homogeneous Green’s function discussed by KB. The analytical solutions

for the Fourier transform of the time-dependent Green’s function in the homogeneous and

– 9 –

inhomogeneous cases are then used to treat localized bremsstrahlung injection via integral

convolution, as an alternative to the essentially monochromatic injection scenario studied

by HKC. In addition to modeling the transient time lags as a result of impulsive soft photon

injection, we also compute the time-independent X-ray spectrum radiated form the surface

of the cloud as a result of continual soft photon injection. We show that acceptable ﬁts

to both the time-lag data and the X-ray spectral data can be obtained using a single set

of cloud parameters (temperature, density, cloud radius) via application of our integrated

model.

The remainder of the paper is organized as follows. In Section 2 we introduce the

time-dependent and steady-state transport equations in spherical geometry, and we map

out the general solution methods to be applied in the subsequent sections. In Section 3 we

obtain the solution for the Fourier transform of the time-dependent photon Green’s function

and also the solution for the time-averaged Green’s function in a homogeneous corona. In

Section 4, we repeat the same steps for the case of an inhomogeneous corona with electron

number density proﬁle ne(r) ∝ 1/r. We discuss the reprocessing of thermal bremsstrahlung
radiation in Section 5, and we apply the integrated model to Cyg X-1 and GX 339-04 in

Section 6. Our main conclusions are reviewed and further discussed in Section 7.

2. Fundamental Equations

Our focus here is on understanding how time-dependent Compton scattering aﬀects a

population of seed photons as they propagate through a spherical corona of hot electrons

overlying a geometrically thin, standard accretion disk. This problem was ﬁrst explored

using an exact mathematical approach by KB, who studied the radiative transfer occurring

in a homogeneous corona. We provide further details of that work here, and we also extend

the model to treat inhomogeneous spherical scattering clouds.

– 10 –

2.1. Time-Dependent Transport Equation

The time-dependent transport equation describing the diﬀusion and Comptonization of

an instantaneous ﬂash of N0 monochromatic seed photons injected with energy ǫ0 at radius

r0 and at time t0 as they propagate through a spherical scattering corona is given by (e.g.,

Becker 2003),

∂fG
∂t

=

1
r2

∂

∂r (cid:20)κ(r) r2 ∂fG

∂r (cid:21) +

ne(r)σTc

mec2

1
ǫ2

∂

∂ǫ(cid:20)ǫ4(cid:18)fG + kTe

∂fG

∂ǫ (cid:19)(cid:21)

4πr2

0ǫ2
0

N0δ(t − t0)δ(r − r0)δ(ǫ − ǫ0)

+

,

(11)

where me, ne, Te, k, σT, c, and κ denote the electron mass, the electron number density,

the electron temperature, Boltzmann’s constant, the Thomson cross section, the speed

of light, and the spatial diﬀusion coeﬃcient, respectively, and fG(ǫ, r, t) is the radiation

Green’s function, describing the distribution of photons inside the cloud. The ﬁrst term

on the right-hand side of Equation (11) represents the spatial diﬀusion of photons through

the corona, and the second term describes the redistribution in energy due to Compton

scattering. The Green’s function is related to the photon number density, nr, via

nr(r, t) =Z ∞

0

ǫ2 fG(ǫ, r, t) dǫ ,

(12)

and the spatial diﬀusion coeﬃcient κ(r) is related to the electron number density ne(r) and

the scattering mean free path ℓ(r) via

κ(r) =

c

3ne(r)σT

=

c ℓ(r)

3

.

(13)

Klein-Nishina corrections are important when the incident photon energy in the electron’s

rest frame approaches ∼ 500 keV. In our model, the electrons are essentially non-relativistic,
with temperature Te ∼ 4− 7× 108 K, and therefore the 0.1− 10 keV photons of interest here
will not be boosted into the Klein-Nishina energy range in the typical electron’s rest frame.

We will therefore treat the electron scattering process using the Thomson cross section

– 11 –

throughout this study. However, we revisit this issue is Section 7.1 where we compare our

results with previous studies that utilized the full Klein-Nishina cross section to treat the

electron scattering.

2.2. Density Variation

In many cases of interest, the electron number density ne(r) has a power-law

dependence on the radius r, which can be written as

ne(r) = n∗(cid:16) r

R(cid:17)−α

,

(14)

where R is the outer radius of the cloud, α is a constant, and n∗ ≡ ne(R) is the number
density at the outer edge of the cloud. The two cases we focus on here are

0, homogeneous ,

1,

inhomogeneous .

(15)

α =


The homogeneous case was treated by Miyamoto (1988) and the inhomogeneous case by

HKC. By combining Equations (13) and (14), we can rewrite the electron number density

and the spatial diﬀusion coeﬃcient as

ne(r) =

where

1

σTℓ∗(cid:16) r

R(cid:17)−α

,

κ(r) =

c ℓ∗

3 (cid:16) r
R(cid:17)α

,

ℓ∗ ≡ ℓ(R) =

1

ne(R)σT

denotes the scattering mean free path at the outer edge of the corona. Substituting

Equations (16) into Equation (11) yields

(16)

(17)

∂fG
∂t

=

cℓ∗
3r2

∂

∂r (cid:20)(cid:16) r
R(cid:17)α

∂r (cid:21) +
r2 ∂fG

1

ℓ∗mec(cid:16) r

R(cid:17)−α 1

ǫ2

∂

∂ǫ(cid:20)ǫ4(cid:18)fG + kTe

∂fG

∂ǫ (cid:19)(cid:21)

N0δ(t − t0)δ(r − r0)δ(ǫ − ǫ0)

+

.

(18)

4πr2

0ǫ2
0

– 12 –

The electron temperature Te is determined by a balance between gravitational heating

and Compton cooling, and one typically ﬁnds that Te does not vary signiﬁcantly in the

region where most of the X-rays are produced (You et al. 2012; Schnittman et al. 2013).

We therefore assume that the cloud is isothermal with Te = constant. In this case, it is

convenient to rewrite the transport equation in terms of the dimensionless energy

x ≡

ǫ
kTe

.

We also introduce the dimensionless radius z, time p, and temperature Θ, deﬁned,

respectively, by

r
R

,

z ≡

c t
ℓ∗

,

p ≡

Θ ≡

kTe
mec2 .

(19)

(20)

The various functions involved in the derivation can be written in terms of either the

dimensional energy and radius, (ǫ, r), or the corresponding dimensionless variables (x, z),

and therefore we will use these two notations interchangeably throughout the remainder of

the paper. Incorporating Equations (19) and (20) into the transport equation (18) yields,

after some algebra,

∂fG
∂p

=

1

3η2z2

∂

∂z (cid:18)z2+α ∂fG

∂z (cid:19) +

Θ

zαx2

∂

∂x(cid:20)x4(cid:18)fG +

∂fG

∂x (cid:19)(cid:21) +

where we have introduced the dimensionless “scattering parameter,”

R
ℓ∗

η ≡

= ne(R)σTR .

N0δ(x − x0)δ(p − p0)δ(z − z0)

,

4πz2

0R3x2

0Θ3(mec2)3

(21)

(22)

Equation (21) is the fundamental partial diﬀerential equation that we will use to treat

time-dependent scattering in a homogeneous spherical corona with α = 0 in Section 3, and

time-dependent scattering in an inhomogeneous spherical corona with α = 1 in Section 4.

– 13 –

2.3. Optical Depth

The scattering optical depth τ measured from the inner edge of the coronal cloud at

radius r = rin out to some arbitrary local radius r is computed using

τ (r) =Z r

rin

ne(r′)σTdr′ =Z r

rin

dr′
ℓ(r′)

,

where the variation of the mean-free path is given by (see Equations (13) and (14))

ℓ(r) = ℓ∗(cid:16) r
R(cid:17)α

.

(23)

(24)

Combining relations, and transforming the variable of integration from r to z = r/R, we

obtain

where

τ (z) = ηZ z

zin

dz′
z′α ,

zin ≡

rin
R

denotes the dimensionless inner radius of the cloud.

There are three cases of interest here,

The overall optical thickness of the scattering cloud, denoted by τ∗, as measured from the

inner radius r = rin (z = zin) to the outer radius r = R (z = 1), is therefore given by

(25)

(26)

(27)

(28)

τ (z) =

in

η (z1−α − z1−α
η (z − zin) ,
η ln(z/zin) ,

)/(1 − α) , α 6= 1 ,
α = 0 ,

α = 1 .

τ∗ =

in

η (1 − z1−α
η (1 − zin) ,
η ln(1/zin) ,

)/(1 − α) , α 6= 1 ,
α = 0 ,

α = 1 .







– 14 –

2.4. Steady-State Transport Equation

The time-averaged (quiescent) X-ray spectra produced in accretion ﬂows around black

holes are generally interpreted as the result of the thermal Comptonization of soft seed

photons continually injected into a hot electron corona from a cool underlying disk (see

e.g. Sunyaev & Titarchuk 1980 for a review). In our interpretation, the associated X-ray

time lags are the result of the time-dependent Comptonization of seed photons impulsively

injected during a brief transient. Our goal in this paper is to develop an integrated model

that accounts for the formation of both the time-averaged spectrum and the time lags using

a single set of cloud parameters (temperature, density, radius). In our calculation of the

time-averaged spectrum, we assume that ˙N0 seed photons with energy ǫ0 are injected per

unit time into the hot corona between the inner cloud radius rin and the outer cloud radius

r = R with a rate that is proportional to the local electron number density ne(r). The

radial variation of the number density depends on whether the cloud is homogeneous, with
ne =constant, or inhomogeneous, with ne(r) ∝ r−1.

In this scenario, the fundamental time-independent transport equation can be written

as

G

∂f S
∂t

= 0 =

1
r2

∂

∂r (cid:20)κ(r)r2 ∂f S

∂r (cid:21) +

G

ne(r)σTc

mec2

1
ǫ2

∂

∂ǫ(cid:20)ǫ4(cid:18)f S

G + kTe

∂f S

G

∂ǫ (cid:19)(cid:21) +

˙N0 δ(ǫ − ǫ0)ne(r)

ǫ2
0Ne

,

where f S

G(ǫ, r) denotes the steady-state (quiescent) photon Green’s function, and

Ne =Z R

rin

4πr2ne(r) dr

represents the total number of electrons in the region rin ≤ r ≤ R. Substituting for ne(r)
and κ(r) in Equation (29) using Equations (16) yields

0 =

cℓ∗
3r2

∂

∂r (cid:20)(cid:16) r
R(cid:17)α

G

r2 ∂f S
∂r (cid:21)+

1

ℓ∗mec(cid:16) r

R(cid:17)−α 1

ǫ2

∂

∂ǫ(cid:20)ǫ4(cid:18)f S

G + kTe

∂f S

G

∂ǫ (cid:19)(cid:21) +

˙N0 δ(ǫ − ǫ0)(r/R)−α
(31)

σTℓ∗ǫ2

0Ne

.

(29)

(30)

– 15 –

This expression can be rewritten in terms of the dimensionless parameters x, z, Θ, and η to

obtain

0 =

1

3η2z2−α

∂

∂z (cid:18)z2+α ∂f S

∂z (cid:19) +

G

Θ
x2

∂

∂x(cid:20)x4(cid:18)f S

G +

G

∂f S

∂x (cid:19)(cid:21) +

˙N0 δ(x − x0)(3 − α)

4πR2ηc Θ3(mec)3x2

0(1 − z3−α

in

,

)
(32)

where we have also substituted for Ne using

Ne =

4πR3
σTℓ∗

in

1 − z3−α
3 − α

,

(33)

which follows from Equations (16) and (30). We assume here that α = 0 or α = 1.

The derivative ∂f S

G/∂x exhibits a step-function discontinuity at the injection energy,
x = x0, due to the appearance of the function δ(x − x0) in Equation (32). By integrating
Equation (32) with respect to x over a small region surrounding the injection energy, we

conclude that the derivative jump is given by

x0+δ

x0−δ

G

lim

dx(cid:21)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)
δ→0(cid:20) df S

= −

˙N0(3 − α)
4πR2ηc Θ4(mec)3x4

0(1 − z3−α

in

.

)

(34)

We will utilize Equations (32) and (34) in Sections 3 and 4 when we compute the time-

averaged X-ray spectra produced via electron scattering in homogeneous and inhomogeneous

scattering coronae, respectively.

2.5. Fourier Transformation

In principle, all of the detailed spectral variability due to time-dependent Comp-

tonization in the scattering corona can be computed by solving the fundamental transport

equation (21) for a given initial photon energy/space distribution (Becker 2003). However,

complete information about the variability of the spectrum is not required, or even desired,

if the goal it to compare the theoretically predicted time lags δt with the observational

data. Computation of the predicted time lags using Equation (4) requires as input the

– 16 –

Fourier transforms of the soft and hard data streams. It is therefore convenient to analyze

the time-dependent transport Equation (21) directly in the Fourier domain, rather than

in the time domain. Hence one of our goals is to derive the exact solution for the Fourier

transform, FG, of the time-dependent radiation Green’s function, fG. We deﬁne the Fourier

transform pair, (fG, FG), using

FG(x, z, ˜ω) ≡Z ∞
2πZ ∞
fG(x, z, p) ≡

1

−∞

−∞

ei˜ωpfG(x, z, p) dp ,

e−i˜ωpFG(x, z, ˜ω) d˜ω ,

where the dimensionless Fourier frequency is deﬁned by

˜ω = ω(cid:18)ℓ∗

c(cid:19) = ωt∗ .

(35)

(36)

(37)

Here, t∗ = ℓ∗/c is the “scattering time,” which equals the mean-free time at the outer edge

of the corona, at radius r = R.

We can obtain an ordinary diﬀerential equation satisﬁed by the Fourier transform, FG,

by operating on Equation (21) with R ∞
∂z (cid:19) +
∂z (cid:18)z2+α ∂FG
− i˜ωzαFG =

3η2z2−α

∂

1

−∞ ei˜ωpdp, to obtain

Θ
x2

∂

∂x(cid:20)x4(cid:18)FG +

∂FG

∂x (cid:19)(cid:21)
N0δ(x − x0)δ(z − z0)ei˜ωp0
4πx2
0z−αΘ3(mec2)3R3

0z2

+

,

(38)

where i2 = −1. Further progress can be made by noting that Equation (38) is separable
in the energy and spatial coordinates (x, z). The technical details depend on the value

of α, which determines the spatial variation of the electron number density ne(r). We

therefore treat the homogeneous and inhomogeneous cases separately in Sections 3 and 4,

respectively.

Due to the function δ(x − x0) appearing in the source term in Equation (38), the

energy derivative ∂FG /∂x displays a jump at the injection energy x = x0, with a magnitude

– 17 –

determined by integrating Equation (38) with respect to x in a small region around the

injection energy. The result obtained is

x0+δ

x0−δ

lim

dx (cid:21)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)
δ→0(cid:20)dFG

N0 δ(z − z0)ei˜ωp0
0 z2

0z−α Θ4(mec2)3R3 .

4πx4

= −

(39)

This expression will be used later in the computation of the expansion coeﬃcients for

the Fourier transform of the radiation Green’s function resulting from time-dependent

Comptonization in Sections 3.2 and 4.2.

2.6. Boundary Conditions

In order to obtain solutions for f S

G(ǫ, r) and FG(ǫ, r, ˜ω), we must impose suitable spatial

boundary conditions at the inner edge of the cloud, r = rin, and at the outer edge, r = R,

which correspond to the dimensionless radii z = zin and z = 1, respectively. The boundary

conditions we discuss below are stated in terms of the fundamental time-dependent photon

Green’s function, fG(ǫ, r, t), but they also apply to the time-averaged spectrum f S

G(ǫ, r).

Furthermore, we can show via Fourier transformation that the same boundary conditions

also apply to the Fourier transform FG(ǫ, r, ˜ω). Note that we can write the time-averaged

X-ray spectrum f S

G and the Fourier transform FG as functions of either the dimensional

energy and radius, (ǫ, r), or in terms of the dimensionless variables (x, z), and therefore we

will use the appropriate set of variables depending on the context.

In the Monte Carlo simulations performed by HKC, the time lags result from

the reprocessing of blackbody seed photons impulsively injected at the center of the

Comptonizing corona. In order to avoid unphysical sources or sinks of radiation at the

center of the cloud, r = 0, they employed a zero-ﬂux “mirror” inner boundary condition,

which can be expressed as

r→0 −4πr2κ(r)
lim

∂fG(ǫ, r, t)

∂r

= 0 .

(40)

– 18 –

This condition simply reﬂects the fact that no photons are created or destroyed at the center

of the cloud after the initial ﬂash. Following HKC, we will employ the mirror boundary

condition at the center of the corona (r = 0) in our calculations involving a homogeneous

cloud.

The scattering corona has a ﬁnite extent, and therefore we must impose a free-streaming

boundary condition at the outer surface (r = R). Hence the distribution function fG must

satisfy the outer boundary condition

− κ(r)

∂fG(ǫ, r, t)

∂r

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)r=R

= c fG(ǫ, r, t)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)r=R

,

(41)

which implies that the diﬀusion ﬂux at the surface is equivalent to the outward propagation

of radiation at the speed of light.

When the electron distribution is inhomogeneous (ne(r) ∝ r−1), the mirror condition
cannot be applied at the center of the cloud due to the divergence of the electron number

density ne(r) as r → 0. In this case, we must truncate the scattering corona at a non-zero
inner radius, r = rin, where we impose a free-streaming boundary condition. Physically, the

inner edge of the cloud may correspond to the edge of a centrifugal funnel, or the cusp of a

thermal condensation feature (Meyer & Meyer-Hofmeister 2007). The inner free-streaming

boundary condition can be written as

− κ(r)

∂fG(ǫ, r, t)

∂r

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)r=rin

= −c fG(ǫ, r, t)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)r=rin

,

(42)

which is only applied in the inhomogeneous case. All of the boundary conditions considered

here are satisﬁed by the fundamental time-dependent photon Green’s function fG(ǫ, r, t),

and also by the time-averaged spectrum f S

G(ǫ, r), and the Fourier transform FG(ǫ, r, ˜ω).

We will apply these results in Sections 3 and 4 where we consider homogeneous and

inhomogeneous cloud conﬁgurations, respectively.

– 19 –

3. Homogeneous Model

The simplest electron number density distribution of interest here is ne =constant

(α = 0), which was ﬁrst studied by Miyamoto et al. (1988). In this case we apply the

mirror inner boundary condition at the center of the cloud, and hence we set zin = 0. We

consider the homogeneous case in detail in this section, and obtain the exact solutions for

the Fourier transform of the time-dependent photon Green’s function, FG(ǫ, r, ˜ω), and also

for the associated time-averaged radiation spectrum, f S

G(ǫ, r). These results were originally

presented by KB in an abbreviated form. Note that KB utilized the scattering optical

depth τ measured from the center of the cloud as the fundamental spatial variable, whereas

we use the dimensionless radius z. However, the two quantities are simply related via

Equations (27) and (28), which yield, for α = 0 and zin = 0,

τ (z) = η z ,

τ∗ = η ,

(43)

where τ∗ is the optical thickness measured from the center of the cloud to the outer edge at

z = 1.

3.1. Quiescent Spectrum for α = 0

In the homogeneous case (α = 0), the time-independent transport equation (32)

representing the thermal Comptonization of seed photons continually injected throughout

the scattering corona can be simpliﬁed by substituting the separation functions

fλ = K(λ, x) Y (λ, z) ,

which yields, for x 6= x0,
−1
Y η2z2

d

dz (cid:18)z2 dY

dz (cid:19) =

3 Θ
K x2

d

dx(cid:20)x4(cid:18)K +

dK

dx(cid:19)(cid:21) = λ ,

(44)

(45)

– 20 –

where λ is the separation constant. The corresponding ordinary diﬀerential equations

satisﬁed by the spatial and energy functions Y and K are, respectively,

d

1
z2

dz (cid:18)z2 dY
dx(cid:20)x4(cid:18)K +

dz (cid:19) + λ η2Y = 0 ,
dx(cid:19)(cid:21) −

λ
3Θ

d

1
x2

dK

K = 0 ,

(46)

(47)

which has been considered previously by such authors as Payne (1980), Shapiro, Lightman,

and Eardley (1976), Sunyaev & Titarchuk (1980), etc.

The fundamental solution for the energy function K is given by (see Becker 2003)

K(λ, x) = (xx0)−2e−(x+x0)/2M2,σ(xmin)W2,σ(xmax) ,

where M2,σ and W2,σ are Whittaker functions,

xmax ≡ max(x, x0) ,

xmin ≡ min(x, x0) ,

and

σ ≡r9

4

+

λ
3Θ

.

(48)

(49)

(50)

The speciﬁc form in Equation (48) represents the solution satisfying appropriate boundary

conditions at high and low energies, and it is also continuous at the injection energy, x = x0,

as required.

In the homogeneous conﬁguration under consideration here, the spatial function Y

must satisfy the inner “mirror” boundary condition at the origin (cf. Equation (40)), which

can be written in terms of z as

lim
z→0

z2 dY (λ, z)

dz

= 0 .

The fundamental solution for Y satisfying this condition is given by

Y (λ, z) =

sin(ηz√λ)

ηz

.

(51)

(52)

– 21 –

By virtue of Equation (41), the spatial function Y must also satisfy the outer free-streaming

boundary condition, written in terms of the z coordinate as

lim

z→1(cid:20) 1

3η

dY (λ, z)

dz

+ Y (λ, z)(cid:21) = 0 .

(53)

Substituting the form for Y given by Equation (52) into Equation (53) yields a

transcendental equation for the eigenvalues λn that can be solved using a numerical

root-ﬁnding procedure. The resulting eigenvalues λn are all real and positive, and the

corresponding values of σ are computed by setting λ = λn in Equation (50). The associated

eigenfunctions, Yn and Kn, are deﬁned by

Yn(z) ≡ Y (λn, z) , Kn(x) ≡ K(λn, x) .

(54)

According to the Sturm-Liouville theorem, the eigenfunctions Yn form an orthogonal

basis with respect to the weight function z2, so that (see Appendix A)

Z 1

0

z2 Yn(z) Ym(z) dz = 0 ,

n 6= m .

The related quadratic normalization integrals, In, are deﬁned by
sin(2η√λn)

η
2 −

4√λn

In ≡ η3Z 1

0

z2Y 2

n (z)dz =

(55)

(56)

,

where the ﬁnal result follows from Equation (52).

Based on the orthogonality of the Yn functions, we can express the time-averaged

photon Green’s function using the expansion

f S
G(x, x0, z) =

∞

Xn=0

bn Kn(x) Yn(z) ,

(57)

where the expansion coeﬃcients bn are computed using the derivative jump condition in

Equation (34). In the case of interest here, we set α = 0 and zin = 0 to obtain

x0+δ

x0−δ

G

lim

dx(cid:21)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)
δ→0(cid:20) df S

3 ˙N0

4πR2ηc Θ4(mec)3x4
0

= −

.

(58)

– 22 –

Substituting the series expansion for the steady-state Green’s function (Equation (57)) into

Equation (58) yields

lim
δ→0

∞

Xn=0

bnYn(z)[K ′

n(x0 + δ) − K ′

n(x0 − δ)] = −

3 ˙N0

4πR2ηc Θ4(mec)3x4
0

.

(59)

We can make further progress by eliminating K using Equation (48) to obtain, after

some algebra,

∞

bn Yn(z) W2,σ(x0) = −

3 ˙N0ex0

4πR2ηc Θ4(mec)3 ,

Xn=0

where we have deﬁned the Wronskian of the Whittaker functions using

(60)

(61)

(62)

(63)

W2,σ(x0) ≡ M2,σ(x0)W ′

2,σ(x0) − W2,σ(x0)M ′

2,σ(x0) .

The Wronskian can be evaluated analytically to obtain (Abramowitz & Stegun 1970)

W2,σ(x0) = −

Γ(1 + 2σ)
Γ(σ − 3/2)

.

Combining Equations (60) and (62), we obtain

∞

Xn=0

bnYn(z)

Γ(1 + 2σ)
Γ(σ − 3/2)

=

3 ˙N0ex0

4πR2ηc Θ4(mec2)3 .

Next we exploit the orthogonality of the Yn functions with respect to the weight function

z2 by applying the operator R 1

0 η3z2Ym(z)dz to both sides of Equation (63). According to
Equation (55), all of the terms on the left-hand side vanish except the term with m = n.

The result obtained for the expansion coeﬃcient bn is therefore

bn =

3 ˙N0ex0Γ(σ − 3/2)Pn

4πR2ηc Θ4(mec2)3Γ(1 + 2σ)In

,

(64)

where the integrals In are computed using Equation (56) and the integrals Pn are deﬁned

by

Pn ≡Z 1

0

η3z2Yn(z)dz =

3η sin(η√λn)

λn

,

(65)

– 23 –

and the ﬁnal result follows from application of Equation (53).

Combining Equations (57) and (64) yields the exact analytical solution for the

time-independent photon Green’s function evaluated at dimensionless energy x and

dimensionless radius z resulting from the continual injection of seed photons throughout

the cloud. We obtain

f S
G(x, x0, z) =

9 ˙N0ex0

4πR2c Θ4(mec2)3

∞

Xn=0

Γ(σ − 3/2) sin(η√λn)

λnΓ(1 + 2σ)In

Kn(x) Yn(z) ,

(66)

where σ is computed using Equation (50), and Yn and Kn are deﬁned in Equation (54).

This is the same result as Equation (27) from KB, once we make the identiﬁcations

τ∗ = η and Gn(τ ) = Yn(z), which arise due to the change in the spatial variable from

the dimensionless radius z used here, to the scattering optical depth τ = ηz used by KB.

The time-averaged X-ray spectrum computed using Equation (66) is compared with the

observational data for Cyg X-1 and GX 339-04 in Section 6.1. In Section 6.1.2, we use

asymptotic analysis to derive a power-law approximation to the exact radiation distribution

given by Equation (66), and we show that the resulting approximate X-ray spectrum agrees

closely with that obtained using the exact solution.

3.2. Fourier Transform for α = 0

In the homogeneous case (α = 0), we can substitute for the Fourier transform FG in

Equation (38) using the separation functions

Fλ ≡ H(λ, x) Y (λ, z) ,

to obtain, for x 6= x0,

1
Y

−

1

η2z2

d

dz (cid:18)z2 dY

dz (cid:19) =

3Θ
Hx2

d

dx(cid:20)x4(cid:18)H +

dH

dx(cid:19)(cid:21) + 3i˜ω = λ ,

(67)

(68)

– 24 –

where λ =constant. This relation can be broken into two ordinary diﬀerential equations

satisﬁed by the spatial and energy functions Y and H. We obtain

d

1
z2

dz (cid:18)z2 dY
dx(cid:20)x4(cid:18)H +

dz (cid:19) + λ η2Y = 0 ,
dx(cid:19)(cid:21) −

s
3Θ

dH

1
x2

where

d

H = 0 ,

s ≡ λ − 3i˜ω .

(69)

(70)

(71)

In the Fourier transform case under consideration here, the spatial function Y must

satisfy the mirror condition at the origin (cf. Equation (51)),

lim
z→0

z2 dY (λ, z)

dz

= 0 .

(72)

Since Equation (69) is identical to Equation (46), which we previously encountered in

Section 3.1 in our consideration of the time-averaged spectrum produced in a homogeneous

spherical corona, we conclude that the fundamental solution for Y is likewise given by (cf.

Equation (52))

Y (λ, z) =

sin(ηz√λ)

ηz

.

(73)

Furthermore, Y must also satisfy the outer free-streaming boundary condition, and therefore

the eigenvalues λn are the roots of the equation (cf. Equation (53))

lim

z→1(cid:20) 1

3η

dY (λ, z)

dz

+ Y (λ, z)(cid:21) = 0 .

(74)

It follows that in a homogeneous corona, the Fourier eigenvalues λn and spatial

eigenfunctions Yn are exactly the same as those obtained in the treatment of the time-

averaged spectrum. Hence we can also conclude that the spatial eigenfunctions Yn form

an orthogonal set, which motivates the development of a series expansion for the Fourier

transformed radiation Green’s function, FG.

– 25 –

Comparison of Equations (70) and (47) allows us to immediately obtain the solution

for the energy function H as (cf. Equation (48))

H(λ, x) = (xx0)−2e−(x+x0)/2 M2,µ(xmin) W2,µ(xmax) ,

where xmax and xmin are deﬁned in Equations (49), and

µ ≡r 9

4

+

s
3Θ

=r 9

4

+

λ − 3i˜ω

3Θ

.

(75)

(76)

Following the same steps used in Section 3.1 for the development of the solution for the

time-averaged radiation Green’s function f S

G, we can construct a series representation for

the Fourier transform FG by writing

∞

where the eigenfunctions Yn and Hn are deﬁned by

FG(x, z, ˜ω) =

an Hn(x) Yn(z) ,

Xn=0

Yn(z) ≡ Y (λn, z) , Hn(x) ≡ H(λn, x) .

To solve for the expansion coeﬃcients, an, we substitute Equation (77) into Equation (39)

(77)

(78)

(79)

(80)

(81)

with α = 0 to obtain

lim
δ→0

or, equivalently,

∞

Xn=0

anYn(z)[H ′(x0 + δ) − H ′(x0 − δ)] = −

N0 δ(z − z0)ei˜ωp0
0x4
4πz2

0Θ4(mec2)3R3 ,

an Yn(z) W2,µ(x0) = −

N0 δ(z − z0)ei˜ωp0ex0
4πz2
0Θ4(mec2)3R3

,

∞

Xn=0

where the Wronskian is given by

W2,µ(x0) ≡ M2,µ(x0)W ′

2,µ(x0) − W2,µ(x0)M ′

2,µ(x0) = −

Γ(1 + 2µ)
Γ(µ − 3/2)

.

Substituting for the Wronskian in Equation (80) using Equation (81) and applying the

operator R 1

0 η3z2Ym(z)dz to both sides of the equation, we can utilize the orthogonality of

the spatial eigenfunctions Yn to obtain for the expansion coeﬃcients an the result

an =

N0 ei˜ωp0ex0η3Γ(µ − 3/2)Yn(z0)
4πΘ4(mec2)3R3Γ(1 + 2µ)In

,

(82)

– 26 –

where the quadratic normalization integrals In are deﬁned in Equation (56).

By combining Equations (77) and (82), we ﬁnd that the exact solution for the Fourier

transformed radiation Green’s function, FG, is given by the expansion

FG(x, z, ˜ω) =

N0 ei˜ωp0ex0η3
4πR3Θ4(mec2)3

Γ(µ − 3/2)
Γ(1 + 2µ)In

∞

Xn=0

Yn(z0)Yn(z)Hn(x) ,

(83)

with µ computed using Equation (76), and Yn and Hn given by Equations (78). This result

agrees with Equation (16) from KB once we note the change in the spatial variable from z

to τ = ηz, with Gn(τ ) = Yn(z), τ∗ = η, and ℓ0 = R/η. In the case of the exact solution

for the time-averaged electron distribution derived in Section 3.1, we are able to derive an

accurate approximation using asymptotic analysis (see Section 6.1.2). However, due to the

complex nature of the series in Equation (83), it is not possible to extract useful asymptotic

representations for the Fourier transform. Hence Equation (83) is the key result that will

be utilized to compute the Fourier transform and the associated time lags for a spherical

homogeneous cloud in Section 6.

4.

Inhomogeneous Model

In the previous section, we have presented detailed solutions for the time-averaged

spectrum and for the Fourier transform of the time-dependent photon Green’s function

describing the diﬀusion and Comptonization of photons in a spherical, homogeneous

scattering cloud. Another interesting possibility is a coronal cloud with an electron
number density distribution that varies as ne(r) ∝ r−1, which was considered by HKC, and
corresponds to α = 1 in Equations (16). In this case, the dimensionless radius z is related

to the scattering optical depth τ via (see Equations (27) and (28))

τ (z) = η ln(z/zin) ,

τ∗ = η ln(1/zin) ,

(84)

– 27 –

where τ∗ is the optical thickness measured from the inner radius r = rin (z = zin) to the

outer radius r = R (z = 1). In this section, we obtain the analytical solutions for the

time-averaged spectrum f S

G and for the Fourier transform FG for the case with ne(r) ∝ r−1.

4.1. Quiescent Spectrum for α = 1

The steady-state transport equation (32) describes the formation of the time-averaged

X-ray spectrum via the thermal Comptonization of seed photons continually injected
throughout a scattering corona with an electron number density proﬁle given by ne(r) ∝ r−α.
In the inhomogeneous case with α = 1, this equation can be solved using the separation

form

to obtain, for x 6= x0,

−1
yη2z

fλ = K(λ, x) y(λ, z) ,

d

dz (cid:18)z3 dy

dz(cid:19) =

3 Θ
K x2

d

dx(cid:20)x4(cid:18)K +

dK

dx(cid:19)(cid:21) = λ ,

(85)

(86)

where λ =constant. The associated ordinary diﬀerential equations in the spatial and energy

coordinates are, respectively,

d

1
z

dz (cid:18)z3 dy
dx(cid:20)x4(cid:18)K +

dz(cid:19) + λ η2y = 0 ,
dx(cid:19)(cid:21) −

λ
3Θ

dK

d

1
x2

K = 0 .

(87)

(88)

Since Equation (88) is identical to Equation (47), it follows that the solution for the energy

function K is given by (cf. Equation (48))

K(λ, x) = (xx0)−2e−(x+x0)/2M2,σ(xmin)W2,σ(xmax) ,

where

σ ≡r9

4

+

λ
3Θ

.

(89)

(90)

– 28 –

The fundamental solutions for the spatial functions, y, are given by the power-law

forms

y(λ, z) = C1z−1−√1−η2λ + z−1+√1−η2λ ,

(91)

where C1 is a superposition constant determined by applying the outer free-streaming

boundary condition given by Equation (41). For the inhomogeneous case with α = 1, the

outer boundary condition implies that y must satisfy the equation

lim

z→1(cid:20) z

3η

dy(λ, z)

dz

+ y(λ, z)(cid:21) = 0 .

The corresponding result obtained for C1 is

C1 =

3η − 1 +p1 − η2λ
1 − 3η +p1 − η2λ

.

The next step is to apply the inner free-streaming boundary condition, given by

(92)

(93)

(94)

Equation (42). Stated in terms of z, we obtain for α = 1 the condition

lim

z→zin(cid:20) z

3η

dy(λ, z)

dz − y(λ, z)(cid:21) = 0 ,

where zin = rin/R is the dimensionless inner radius of the cloud. Equation (94) is satisﬁed

only for certain discrete values of λ, which are the eigenvalues λn. The eigenvalues obtained

are all positive real numbers. The resulting global functions y therefore satisfy both

the inner and outer free-streaming boundary conditions. Once the eigenvalues λn are

determined, the corresponding spatial and energy eigenfunctions are deﬁned by

yn(z) ≡ y(λn, z) , Kn(x) ≡ K(λn, x) .

(95)

We show in Appendix A that the spatial eigenfunctions yn form an orthogonal set with

respect to the weight function z, so that

Z 1

zin

z yn(z) ym(z) dz = 0 ,

n 6= m .

(96)

– 29 –

We can therefore express the steady-state photon Green’s function f S

G using the expansion

f S
G(x, x0, z) =

∞

Xn=0

cn Kn(x) yn(z) .

(97)

To solve for the expansion coeﬃcients, cn, we substitute Equation (97) into Equation (34),

with α = 1, to obtain

lim
δ→0

∞

Xn=0

cnyn(z)[K ′

n(x0 + δ) − K ′

n(x0 − δ)] = −

˙N0

2πR2ηc Θ4(mec)3x4

0(1 − z2
in)

.

(98)

Eliminating K using Equation (48) yields

∞

Xn=0

cnyn(z) W2,σ(x0) = −

˙N0ex0

2πR2ηc Θ4(mec)3(1 − z2
in)

,

(99)

where the Wronskian W2,σ(x0) is deﬁned in Equation (61). By combining Equations (99)

and (62) we obtain

∞

Xn=0

cnyn(z)

Γ(1 + 2σ)
Γ(σ − 3/2)

=

˙N0ex0

2πR2ηc Θ4(mec)3(1 − z2
in)

.

(100)

We can exploit the orthogonality of the spatial basis functions yn(z) with respect to

the weight function z by operating on Equation (100) with R 1

zin

z ym(z)dz to obtain

cn =

˙N0ex0Γ(σ − 3/2)Ln

2πR2ηc Θ4(mec2)3JnΓ(1 + 2σ)(1 − z2
in)

,

(101)

where we have made the deﬁnitions

Jn ≡Z 1

zin

z y2

n(z)dz ,

Ln ≡Z 1

zin

z yn(z)dz .

(102)

The ﬁnal result for the steady-state (quiescent) photon Green’s function in the

inhomogeneous case with α = 1 is obtained by combining Equations (97) and (101), which

yields

f S
G(x, x0, z) =

˙N0ex0

2πR2ηc Θ4(mec2)3

∞

Xn=0

Γ(σ − 3/2)Ln

JnΓ(1 + 2σ)(1 − z2
in)

Kn(x) yn(z) ,

(103)

– 30 –

with σ computed using Equation (90), and yn and Kn given by Equations (95). The time-

averaged X-ray spectrum computed using Equation (103) is compared with observational

data for two speciﬁc sources in Section 6.1, and an accurate asymptotic approximation is

derived in Section 6.1.2.

4.2. Fourier Transform for α = 1

In the inhomogeneous case with α = 1, we can substitute for the Fourier transform in

Equation (38) using the separation functions

to obtain, for x 6= x0,
1
η2z

1
g

−

Fλ ≡ K(λ, x) g(λ, z) ,

d

dz (cid:18)z3 dg

dz(cid:19) − 3i˜ωz =

3Θ
Kx2

d

dx(cid:20)x4(cid:18)K +

dK

dx(cid:19)(cid:21) = λ ,

(104)

(105)

where λ is the separation constant. This relation yields two ordinary diﬀerential equations

satisﬁed by the spatial and energy functions g and K, given by

1
z

d

dz (cid:18)z3 dg
dx(cid:20)x4(cid:18)K +

d

1
x2

dz(cid:19) + η2(cid:16)λ + 3i˜ωz(cid:17)g = 0 ,

dK

dx(cid:19)(cid:21) −

λ
3Θ

K = 0 .

(106)

(107)

Equation (107) is identical to Equation (47), and therefore we can immediately conclude

that the solution for the energy function K is given by

K(λ, x) = (xx0)−2e−(x+x0)/2M2,σ(xmin)W2,σ(xmax) ,

(108)

where

σ ≡r9

4

+

λ
3Θ

.

(109)

– 31 –

One signiﬁcant new feature in the inhomogeneous case with α = 1 under consideration

here is that the eigenvalues λn are now functions of the Fourier frequency ˜ω, which stems

from the appearance of ˜ω in Equation (106). It follows that σ is also a function of ˜ω through

its dependence on λ (see Equation (50)). This inconvenient mixing of variables forces us

to generate a separate list of eigenvalues for each sampled frequency. The fundamental

solution for the spatial function g is given by the superposition

g(λ, z) =

1

z hC2J−ν(2η√3i˜ωz) + Jν(2η√3i˜ωz)i ,

(110)

where Jν(z) denotes the Bessel function of the ﬁrst kind, and we have made the deﬁnition

ν ≡ 2p1 − η2λ .

(111)

The superposition constant C2 is computed by applying the outer free-streaming boundary

condition, which can be written as (cf. Equation (92))

lim

z→1(cid:20) z

3η

dg(λ, z)

dz

+ g(λ, z)(cid:21) = 0 .

The result obtained for C2 is

C2 =

(2 − 6η + ν)Jν(2η√3i˜ω) − 2η√3i˜ωJν−1(2η√3i˜ω)
(6η − 2 + ν)J−ν(2η√3i˜ω) + 2η√3i˜ωJ−ν−1(2η√3i˜ω)

.

Next we must apply the inner free-streaming boundary condition given by (cf.

Equation (94))

lim

z→zin(cid:20) z

3η

dg(λ, z)

dz − g(λ, z)(cid:21) = 0 ,

(112)

(113)

(114)

where zin = rin/R. The roots of Equation (114) are the eigenvalues λn, and the associated

global functions g satisfy both the inner and outer free-streaming boundary conditions. The

corresponding spatial and energy eigenfunctions are given by

gn(z) ≡ g(λn, z) , Kn(x) ≡ K(λn, x) .

(115)

– 32 –

As demonstrated in Appendix A, the spatial eigenfunctions gn are orthogonal with

respect to the weight function z, and therefore

Z 1

zin

z gn(z) gm(z) dz = 0 ,

n 6= m .

(116)

It follows that we can express the Fourier transformed radiation Green’s function, FG, using

the expansion (cf. Equation (77))

FG(x, z, ω) =

∞

Xn=0

dn Kn(x) gn(z) .

(117)

The expansion coeﬃcients dn can be computed by applying the derivative jump condition

given by Equation (39), which yields for α = 1

x0+δ

x0−δ

lim

dx (cid:21)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)
δ→0(cid:20)dFG

N0 δ(z − z0)ei˜ωp0
0 z2

0z−1 Θ4(mec2)3R3 .

4πx4

= −

(118)

(119)

Combining Equations (117) and (118) gives the result

lim
δ→0

∞

Xn=0

dngn(z)[K ′(x0 + δ) − K ′(x0 − δ)] = −

or, equivalently,

N0 δ(z − z0)ei˜ωp0
0 z2

0z−1 Θ4(mec2)3R3 ,

4πx4

dngn(z) W2,σ(x0) =

∞

Xn=0

∞

Xn=0

−dngn(z)

Γ(1 + 2σ)
Γ(σ − 3/2)

N0 δ(z − z0)ei˜ωp0ex0
4πz2

0z−1 Θ4(mec2)3R3 ,

= −

(120)

where we have utilized Equations (61) and (62) for the Wronskian W2,σ(x0).

We can solve for the expansion coeﬃcients dn by utilizing the orthogonality of the

spatial eigenfunctions gn with respect to the weight function z. Applying R 1

both sides of Equation (120), we obtain, after some algebra,

zin

dn =

N0ei˜ωp0ex0Γ(σ − 3/2)gn(z0)
4πΘ4(mec2)3R3Γ(1 + 2σ)Kn

,

where the quadratic normalization integrals, Kn, are deﬁned by

Kn ≡Z 1

zin

zg2

n(z)dz .

zgm(z)dz to

(121)

(122)

– 33 –

The ﬁnal result for the Fourier transform FG of the photon Green’s function fG obtained by

combining Equations (117) and (121) is

FG(x, z, ˜ω) =

N0 ei˜ωp0ex0

4πR3Θ4(mec2)3

∞

Xn=0

Γ(σ − 3/2)
Γ(1 + 2σ)Kn

gn(z0) gn(z) Kn(x) ,

(123)

with σ evaluated using Equation (109), and gn and Kn given by Equations (115). This exact

analytical solution can be used to generate theoretical predictions of the Fourier transformed

data streams in two diﬀerent energy channels in order to simulate the time lags created

in a spherical scattering corona with an electron number density proﬁle that varies as
ne(r) ∝ r−1. As in the case of the homogeneous Fourier transform discussed in Section 3.2,
it is not possible to extract useful asymptotic representations for the inhomogeneous Fourier

transform due to the complex nature of the sum appearing in Equation (123).

5. Bremsstrahlung Injection

The investigations carried out by Miyamoto (1988), HKC, and KB show that the

impulsive injection of monochromatic seed photons into a homogeneous Comptonizing

corona cannot produce the observed dependence of the X-ray time lags on the Fourier

frequency. A major advantage of the analytical method we employ here is that the radiation

Green’s function we obtain can be convolved with any desired seed photon distribution as

a function of radius r, energy ǫ, and time t. This ﬂexibility stems from the fact that the

transport equation is a linear partial diﬀerential equation. A source spectrum of particular

interest is a ﬂash of bremsstrahlung seed photons injected on a spherical shell at radius

r = r0. We may expect the observed variability in this case to be qualitatively diﬀerent

from the behavior associated with a monochromatic ﬂash of seed photons, because the

bremsstrahlung ﬂash represents broadband radiation. We anticipate that the prompt escape

of high-energy photons from the bremsstrahlung seed distribution may cause a profound

shift in the dependence of the observed X-ray time lags on the Fourier period.

– 34 –

Since the fundamental transport equation governing the radiation ﬁeld is linear, it

follows that we can compute the time-dependent spectrum f resulting from any seed photon

distribution Q that is an arbitrary function of time, energy, and radius using the integral

convolution

f (ǫ, r, t) =Z ∞

0 Z R

rin Z ∞

0

4πr2

0ǫ2

0fG(ǫ, ǫ0, r, r0, t, t0) Q(ǫ0, r0, t0)N −1

0 dǫ0 dr0 dt0 ,

(124)

where 4πr2

0ǫ2

0Q(ǫ0, r0, t0) dr0 dt0 dǫ0 gives the number of photons injected in the energy range

dǫ0, radius range dr0, and time range dt0 around the coordinates (ǫ0, r0, t0). In the case of

optically thin bremsstrahlung injection, the seed photons are created as a result of a local

instability in the coronal plasma, due to, for example, a magnetic reconnection event, or

the passage of a shock. It follows that the photon distribution resulting from localized,

impulsive injection of bremsstrahlung radiation at radius r = r0 can be written as

fbrem(ǫ, r, t) =Z ∞

ǫabs

fG(ǫ, ǫ0, r, r0, t, t0) Qbrem(ǫ0)N −1

0 dǫ0 ,

(125)

where ǫabs denotes the low-energy cutoﬀ due to free-free self-absorption in the source

plasma, and the bremsstrahlung source function, Qbrem, for fully-ionized hydrogen is given

by (Rybicki & Lightman 1979)

Qbrem(ǫ0) =

A0
ǫ0

e−ǫ0/kTe ,

where

A0 =

25πq6

3hmec3 (cid:18) 2π

3kme(cid:19)1/2

V0 trad T −1/2

e

n2
e(r0) .

(126)

(127)

Here, V0 denotes the radiating volume, trad is the radiating time interval, and q is the

electron charge. The bremsstrahlung source function is normalized so that Qbrem(ǫ0) dǫ0

gives the number of photons injected in the energy range between ǫ0 and ǫ0 + dǫ0.

The low-energy self-absorption cutoﬀ, ǫabs, appearing in Equation (125), depends on

the temperature and density of the plasma experiencing the transient that produces the

– 35 –

ﬂash of bremsstrahlung seed photons. The density of the unstable plasma is expected to be

higher than that in the surrounding corona, due to either shock compression or a thermal

instability. We do not analyze this physical process in detail here, and instead we treat

ǫabs as a free parameter in our model, although a more detailed physical picture could be

developed in future work.

Changing variables from (ǫ, r, t) to (x, z, p) and applying Fourier transformation to

both sides of Equation (125), we obtain

Fbrem(x, z, z0, ˜ω) = A0 N −1

0 Z ∞

xabs

FG(x, x0, z, z0, ˜ω) x−1

0 e−x0 dx0 ,

(128)

where xabs = ǫabs/(kTe) is the dimensionless self-absorption energy. The function FG

in Equation (128) represents the Fourier transformation of the time-dependent photon

Green’s function for either the homogeneous or inhomogeneous cases, given by either

Equation (83) or Equation (123), respectively. The integral with respect to x0 can be

carried out analytically, and the exact solutions are given by

Fbrem(x, z, z0, ˜ω) =

ei˜ωp0η3A0 e−x/2

4πR3Θ4(mec2)3x2

∞

Xn=0




Γ(µ − 3/2)Yn(z0)Yn(z)
Γ(σ − 3/2)gn(z0)gn(z)

Γ(1 + 2µ)In

Γ(1 + 2σ) η3Kn

B(µ, x) , homogeneous ,

B(σ, x) ,

inhomogeneous ,

(129)

where σ and µ are given by Equations (50) and (76), respectively, and the integral function

B(λ, x) is deﬁned by

B(λ, x) ≡Z ∞

xabs

e−x0/2x−3

0 M2,λ(xmin)W2,λ(xmax) dx0 .

(130)

We show in Appendix B that B(λ, x) can be evaluated analytically to obtain the closed-form

result

B(λ, x) =


W2,λ(x)[IM (λ, x) − IM (λ, xabs)] − M2,λ(x)IW (λ, x) , x ≥ xabs ,
−M2,λ(x)IW (λ, xabs) ,
x ≤ xabs ,

(131)

– 36 –

where the functions IM and IW are deﬁned by

x−2e−x/2

λ + 3

2 (cid:18)M1,λ(x) +

3

λ + 1

2(cid:26)M0,λ(x) +

2
λ − 1

2(cid:20)M−1,λ(x) +

1
λ − 3

2

M−2,λ(x)(cid:21)(cid:27)(cid:19) ,

(132)

IM (λ, x) ≡

and

IW (λ, x) ≡ x−2e−x/2(cid:20) − W1,λ(x) + 3W0,λ(x) − 6W−1,λ(x) + 6W−2,λ(x)(cid:21) .

(133)

Section 6, we will use this result to study the implications of broadband (bremsstrahlung)

seed photon injection as an alternative to monochromatic injection for the production of

the observed X-ray time lags in homogeneous and inhomogeneous scattering coronae.

6. Astrophysical Applications

In the previous sections, we have obtained the exact mathematical solution for the

steady-state photon Green’s function, f S

G, describing the X-ray emission emerging from a

scattering corona as a result of the continual distributed injection of monochromatic seed

photons. We have also obtained the exact solution for the Green’s function, FG, describing

the Fourier transform of the X-ray spectrum resulting from the impulsive localized injection

of monochromatic seed photons into the corona. By convolving the solution for FG with

the bremsstrahlung source term, we were also able to derive the exact solution for the

bremsstrahlung Fourier transform, Fbrem.

The availability of these various solutions for the steady-state X-ray spectrum and for

the Fourier transform resulting from impulsive injection allows us to explore a wide variety

of injection scenarios, while maintaining explicit control over the physical parameters

describing the astrophysical objects of interest, such as the temperature, the electron

number density, and the cloud radius. Our goal here is to develop “integrated models,”

in which the coupled calculations of the time-averaged X-ray spectrum and the transient

– 37 –

Fourier X-ray time lags are based on the same set of physical parameters (temperature,

density, radius) for the scattering corona. We believe that this integrated approach

represents a signiﬁcant step forward by facilitating the study of a broad range of parameter

space using an analytical model.

6.1. Comparison with Observed Time-Averaged Spectra

The time-averaged X-ray spectrum emanating from the outer surface of the cloud

results from the continual distributed injection of soft photons from a source with a rate

that is proportional to the local electron number density. Thus, there is no speciﬁc injection

radius for the time-averaged model. The detailed solutions we have obtained describe the

radiative transfer occurring in either a homogeneous cloud, or in an inhomogeneous cloud
in which the electron number density varies with radius as ne(r) ∝ r−1.

Application of the integrated model begins with a comparison of the observed

time-averaged X-ray spectrum with the theoretical steady-state photon ﬂux measured at

,

(134)

, x0, z(cid:19)(cid:12)(cid:12)(cid:12)(cid:12)z=1

the detector, Fǫ(ǫ), computed using the relation
G(cid:18) ǫ

D(cid:19)2
Fǫ(ǫ) =(cid:18) R

c ǫ2f S

kTe

where D is the distance to the source, R is the radius of the corona, c is the speed of light,

and the solution for the steady-state spectrum, f S

G(x, x0, 1), at the surface of the cloud is

evaluated using either Equation (66) for the homogeneous case or Equation (103) for the

inhomogeneous case. In our computations of the time-averaged X-ray spectra, the seed

photon energy is frozen at ǫ0 = 0.1 keV in order to approximate the eﬀect of the continual
injection of blackbody photons from a “cool” accretion disk with temperature T ∼ 106 K.

The temperature parameter Θ = kTe/mec2 (Equation (20)) and the scattering

parameter η = R/ℓ∗ (Equation (22)) determine the slope of the power-law component

– 38 –

of the time-averaged spectrum, and also the frequency of the high-energy exponential

cutoﬀ created by recoil losses. In the inhomogeneous case, the shape of the time-averaged

spectrum also depends on the dimensionless inner radius, zin = rin/R, at which the inner

free-streaming boundary condition is imposed. We vary the values of Θ, η, and zin until

good qualitative agreement with the shape of the observed steady-state X-ray spectrum is

achieved. Once the values of Θ, η, and zin are determined, the photon injection rate,

˙N0,

is then computed by matching the theoretical ﬂux level with the observed time-averaged

spectrum.

6.1.1. Exact Time-Averaged X-ray Spectra

In Figure 1, we plot the theoretical time-averaged (quiescent) X-ray spectra measured

at the detector, Fǫ(ǫ), computed using the homogenous corona model, with distributed
seed photon injection, evaluated by combining Equations (66) and (134). The plots also

include a comparison with the observed X-ray spectra for Cyg X-1 and GX 339-04. The

data for Cyg X-1 were reported by Cadolle Bel et al. (2006) and cover the observation

period MJD 52617-52620, and the data for GX 339-04 were reported by Cadolle Bel et

al. (2011) and cover the observation period MJD 55259.9-55261.1. Both sources were

observed by INTEGRAL in the low/hard state. The model parameters are summarized

in Table 1, and the corresponding homogeneous eigenvalues are plotted in Figure 3. The

time-averaged X-ray spectra obtained for the inhomogeneous corona model, computed by

combining Equations (103) and (134), are plotted and compared with the observational

data in Figure 2, and the corresponding inhomogeneous eigenvalues are depicted in Figure

3.

We ﬁnd that the observed time-averaged spectra can be ﬁt equally well using either

the homogeneous or inhomogeneous cloud models. Furthermore, the homogeneous and

– 39 –

inhomogeneous models have similar temperatures and cloud radii. This behavior illustrates

the fact that the time-averaged spectrum mainly depends on the cloud temperature and

the Compton y-parameter, and is not directly dependent on the accretion geometry, as

discussed in detail by Sunyaev & Titarchuk (1980).

Fig. 1.—: Theoretical time-averaged (quiescent) X-ray spectra, Fǫ(ǫ), observed at the de-
tector, for a homogeneous corona, with constant electron number density, ne, computed by

combining Equations (66) and (134). Results are presented for Cyg X-1 (left panel) and

GX 339-04 (right panel), along with observational data taken from Cadolle Bel et al. (2006)

and Cadolle Bel et al. (2011), respectively. Both sources were observed in the low/hard

state using INTEGRAL. To analyze the convergence of the series, we plot the results ob-

tained using only the ﬁrst term in the series, or using the ﬁrst 7 terms. The convergence is

extremely rapid for both sources.

It is interesting to compare our model parameters with those used by HKC, who

computed the time-averaged spectra of Cyg X-1 for a variety of electron density proﬁles,

similar to the homogeneous and inhomogeneous cloud conﬁgurations studied here. They

employed a scattering cloud with a homogeneous central region, coupled with either a

– 40 –

Fig. 2.—: Same as Figure 1, except we plot the time-averaged X-ray spectra emanating
from an inhomogeneous corona, with electron density proﬁle ne(r) ∝ r−1. The results were
obtained by combining Equations (103) and (134). The convergence is very rapid.

Fig. 3.—: Real eigenvalues, λn, for the time-averaged (quiescent) spectrum radiated by a

homogeneous corona (left panel), and an inhomogeneous corona (right panel). All of the

eigenvalues are positive.

– 41 –

homogeneous or inhomogeneous outer region. The HKC cloud has a scattering optical

thickness τ∗ = 1 and an electron temperature of kTe = 100 keV, whereas we obtain

τ∗ ∼ 2 − 3 and kTe ∼ 60 keV (see Table 1). The diﬀerences between our model parameters
and theirs could be due to the fact that the observational data analyzed here corresponds

to the low/hard state of Cyg X-1, whereas HKC compared their model with spectral data

from Ling et al. (1997), acquired while Cyg X-1 was in its high/soft state, when the source

is known to have a lower optical depth (e.g., Frontera et al. 2001; Malzac 2012; Del Santo

et al. 2013). Furthermore, the values of τ∗ and Te that we obtain are very close to those

found by Malzac et al. (2008), who also considered the low/hard state of Cyg X-1.

In Table 2 we compare the energy injection rate for the seed photons in our model,

Linj, with the time-averaged X-ray luminosity, LX, observed in the low/hard state for the

two sources studied here, Cyg X-1 and GX 339-04. The injection luminosity is computed

using Linj = ǫ0 ˙N0, where ˙N0 is the photon injection rate and the seed photon energy is

ǫ0 = 0.1 keV. The values for LX were taken from Cadolle Bel et al. (2006) for Cyg X-1,

and from Cadolle Bel et al. (2011) for GX 339-04. We see that the injection luminosity

is ∼ 10% of the observed X-ray luminosity, which is consistent with the values we have
obtained for the eﬀective Compton y-parameter.

Table 1.

Input Model Parameters

Source

Model

η

Θ

kTe (keV)

ǫabs (keV)

zin

z0

t∗ (s)

τ∗

Cyg X-1

Homogeneous

2.50

0.120

Cyg X-1

Inhomogeneous

1.40

0.122

GX 339-04 Homogeneous

4.00

0.064

GX 339-04

Inhomogeneous

2.20

0.064

61.3

62.4

32.7

32.7

1.60

1.60

0.01

0.01

0.00

1.00

0.040

2.50

0.12

0.91

0.065

2.97

0.00

0.78

0.038

4.00

0.10

0.60

0.090

5.07

– 42 –

6.1.2. Approximate Power-Law X-ray Spectra

The X-ray spectra plotted in Figures 1 and 2 have a power-law form that extends up

to the exponential cutoﬀ, where electron recoil losses become signiﬁcant. This suggests the

existence of an approximate, asymptotic power-law solution, valid in the domain x . 1

(Rybicki & Lightman 1979). Figures 1 and 2 also include a convergence study, where we

compare the results obtained for the steady-state spectra, f S

G, using only the ﬁrst (n = 0)

term in the series with the fully-converged result obtained using the ﬁrst 7 terms in the

series. The results are essentially indistinguishable, which establishes that the convergence

of the series is extremely rapid. The power-law shape observed for x . 1, combined with

the rapid convergence, suggest that we can derive an asymptotic power-law solution by

analyzing the ﬁrst term in the expansion for the observed ﬂux. By analogy with previous

work on thermal Comptonization, we expect that the properties of the approximate

analytical solution will shed light on the relationship between the ﬁrst eigenvalue, λ0, which

determines the spectral slope, and the eﬀective Compton y-parameter for the model. We

derive the approximate asymptotic power-law solution below, for both the homogeneous

and inhomogeneous cloud conﬁgurations.

We are interested in photon energies well above the injection energy, ǫ0 = 0.1 keV, and

therefore it follows that x > x0. In this case, we can combine Equations (48) and (66) to

Table 2. Auxiliary Model Parameters

Source

Model

˙N0 (s−1)

Linj (ergs s−1)

LX (ergs s−1)

yeﬀ

τeﬀ

λ0

R (cm)

D (kpc)

Cyg X-1

Homogeneous

2.00 × 1046

3.20 × 1036

2.20 × 1037

1.20

1.58

1.20

3.00 × 109

Cyg X-1

Inhomogeneous

2.70 × 1046

4.33 × 1036

2.20 × 1037

1.17

1.55

1.25

2.73 × 109

GX 339-04 Homogeneous

5.75 × 1046

9.21 × 1036

6.28 × 1037

1.48

2.40

0.52

4.56 × 109

GX 339-04

Inhomogeneous

7.00 × 1046

1.12 × 1037

6.28 × 1037

1.51

2.43

0.51

5.94 × 109

2.4

2.4

8.0

8.0

– 43 –

express the time-averaged X-ray spectrum in the homogeneous corona as

f S
G(x, x0, z) =

9 ˙N0e(x0−x)/2(xx0)−2
4πR2c Θ4(mec2)3

Γ(σ − 3/2) sin(η√λn)

λnΓ(1 + 2σ)In

∞

Xn=0

Yn(z)M2,σ(x0)W2,σ(x) . (135)

The corresponding result obtained by combining Equations (89) and (103) in the

inhomogenous case is

f S
G(x, x0, z) =

˙N0e(x0−x)/2(xx0)−2
2πR2ηc Θ4(mec2)3

∞

Xn=0

Γ(σ − 3/2)Ln

JnΓ(1 + 2σ)(1 − z2
in)

yn(z)M2,σ(x0)W2,σ(x) .

(136)

Based on Figure 1, we observe that the domain of the power-law shape is x0 < x . 1. This

suggests that we can employ Equations (13.1.32), (13.1.33), (13.5.5), and (13.5.6) from

Abramowitz & Stegun (1970) to implement the small-argument asymptotic form for the

Whittaker functions M and W .

We will only evaluate the n = 0 term in the sum, since it represents a converged result,

according to the results plotted in Figure 1. After some algebra, the approximate solution

obtained in the homogeneous case is

f S
G(x, x0, z) ≈

9 ˙N0 xσ0−3/2

0

8πR2c Θ4(mec2)3

sin(η√λ0)
λ0σ0I0

sin(ηz√λ0)

ηz

x−σ0 −3/2 ,

(137)

where (see Equation (50))

σ0 ≡r9

4

+

λ0
3Θ

.

(138)

Likewise, in the inhomogeneous case, we obtain

f S
G(x, x0, z) ≈

˙N0 xσ0 −3/2

0

4πR2ηc Θ4(mec2)3

L0 y0(z)
J0σ0(1 − z2
in)

x−σ0 −3/2 .

(139)

By substituting either Equation (137) or (139) into Equation (134), and setting z = 1,

we can compute the corresponding approximate X-ray spectrum, Fǫ(ǫ), observed at the
detector. These results are plotted and compared with the exact solutions in Figure 4, and

it is clear that the power-law approximation is extremely accurate below the exponential

cutoﬀ energy, as expected.

– 44 –

We can obtain further insight into the physical signiﬁcance of our approximate

power-law solutions by comparing our work with previous results. First, we note that

within the regime of interest here, x . 1, and therefore electron recoil losses are negligible.

This suggests that we can deﬁne an eﬀective y-parameter by comparing our work with the

corresponding analytical solutions that neglect recoil losses. This situation was treated

by Rybicki & Lightman (1979), who obtained power-law solutions to the Kompaneets

equation by utilizing an escape-probability formalism for the spatial photon transport, as

an alternative to the spatial diﬀusion operator employed here. In our solutions, given by

Equations (137) and (139), the power-law index is equal to −σ0 − 3/2. Setting our result
equal to the index m given by Equation (7.76) from Rybicki & Lightman (1979) yields

− σ0 −

3
2

= −

3

2 −r 9

4

+

4
yeﬀ

,

(140)

where yeﬀ is the eﬀective Compton y-parameter and Θ is the dimensionless temperature

ratio. Using Equation (138) to substitute for σ0 and solving for yeﬀ, we ﬁnd that

yeﬀ =

12 Θ
λ0

.

(141)

The values obtained for yeﬀ and λ0 in our calculations of the time-averaged X-ray spectra

resulting from distributed (density-weighted) seed photon injection are reported in Table 2.

We generally ﬁnd that yeﬀ ∼ 1, corresponding to unsaturated Comptonization, which is
consistent with the power-law spectra plotted in Figures 1 and 2 (e.g., Sunyaev & Titarchuk

1980).

It is also interesting to relate the ﬁrst eigenvalue, λ0, to the eﬀective optical depth, τeﬀ,

traversed by the photons as they propagate through the scattering corona, and ultimately

escape. Referring to the simpliﬁed escape-probability model analyzed by Rybicki &

Lightman (1979), we can apply their Equation (7.41) to write, in the optically thick case,

y = 4 Θ τ 2

eﬀ .

(142)

– 45 –

Setting y = yeﬀ and combining Equations (141) and (142), we ﬁnd that τeﬀ and λ0 are

related via

τeﬀ =r 3

λ0

.

(143)

The results obtained for τeﬀ are listed in Table 2. Comparing the values of τeﬀ with the

values for τ∗ in Table 1, we conclude that τeﬀ ∼ 0.5 τ∗, which reﬂects the fact that the
seed photon injection is density weighted, rather than being localized at the center of the

cloud. Hence, on average, photons traverse less optical depth than is given by τ∗, which is

measured from the cloud center.

Fig. 4.—: Approximate power-law X-ray spectra, Fǫ(ǫ), computed using Equation (134)
combined with Equation (137) for the homogeneous corona (blue ﬁlled circles) or Equa-

tion (139) for the inhomogeneous corona (red solid lines). The results are compared with the

observational data for Cyg X-1 (left panel) and GX 339-04 (right panel). See the discussion

in the text.

– 46 –

6.2. Comparison with Time Lag Data

In the time-dependent case, the time lags are computed using the Fourier transforms

evaluated at the surface of the cloud, after an impulsive localized transient injects

seed photons with a speciﬁed spectrum at a speciﬁc radius. This represents a sudden,

low-luminosity ﬂash of radiation that subsequently scatters and Comptonizes throughout

the cloud before the ﬁnal signal escapes to the observer.

The theoretical prediction for the time lag observed between hard channel energy ǫhard

and soft channel energy ǫsoft at Fourier frequency νf is computed using the van der Klis et

al. (1987) formula (cf. Equation (4)),

δt =

arg[S ∗(xsoft, ˜ω)H(xhard, ˜ω)]

2πνf

,

where the dimensionless energies xsoft and xhard are deﬁned by

xsoft ≡

ǫsoft
kTe

,

xhard ≡

ǫhard
kTe

.

(144)

(145)

The Fourier transforms of the soft and hard channel time series are computed using

S(xsoft, ˜ω) = F (xsoft, ˜ω) ,

H(xhard, ˜ω) = F (xhard, ˜ω) ,

(146)

where F represents the Fourier transform radiated at the surface of the coronal cloud,

at radius r = R (z = 1). We assume that the observed time lags are the result of the

time-dependent Comptonization of seed photons injected with either a monochromatic

or bremsstrahlung initial energy distribution. Our results for the homogeneous and

inhomogeneous Fourier transforms in the case of monochromatic photon injection are

given by Equations (83) and (123), respectively, and our results for the homogeneous

and inhomogeneous Fourier transforms in the case of bremsstrahlung injection are both

covered by Equation (129). In the case of bremsstrahlung injection, we must also impose a

low-energy self-absorption cutoﬀ at energy ǫ = ǫabs in order to avoid producing an inﬁnite

number of seed photons.

– 47 –

All of our analytical formulas for the Fourier transform are expressed in terms of the

dimensionless Fourier frequency, ˜ω, which is related to the dimensional Fourier frequency,

νf , measured in Hz, via (see Equation (37))

˜ω = 2πνf t∗ ,

(147)

where the scattering time, t∗ = ℓ∗/c, is equal to the mean-free time at the outer edge of

the cloud. The value of t∗ is related to the cloud radius R and the value of η via (see

Equation (22))

t∗ =

ℓ∗
c

=

R
η c

.

(148)

Once the values for the temperature parameter Θ, the scattering parameter η, and

the inner radius zin have been tied down via comparison of the observed time-averaged

spectrum with the theoretical steady-state spectrum for a given source, the next step is

to vary the values of the cloud radius, R, and the bremsstrahlung self-absorption energy,

ǫabs, until we achieve reasonable qualitative agreement between the theoretical time lags

and the observed time lags. This allows us to translate between the dimensionless Fourier

frequency ˜ω and the dimensional frequency νf using Equation (147), with the scattering

time t∗ computed using Equation (148). We consider several diﬀerent scenarios for the

calculation of the X-ray time lags below and compare the results with the observational

data for Cyg X-1 and GX 339-04.

6.2.1. Monochromatic Injection in Inhomogeneous Corona

When the injected spectrum is monochromatic, or nearly so, and the injection takes

place in a homogeneous cloud, all of the authors who have examined the problem agree

that the resulting time lags are independent of Fourier frequency, in contradiction to

the observations (e.g. Miyamoto 1988, HKC, KB). Hence it is interesting to explore the

– 48 –

consequences of altering the cloud conﬁguration in our model to treat monochromatic seed

photon injection in an inhomogeneous corona, with electron number density distribution
ne(r) ∝ r−1, which was also considered by HKC. Since the injected seed photons are
monochromatic, with energy ǫ0 = 0.1 keV, we must use the Fourier transform Green’s

function, FG, to compute the time lags by combining Equations (123), (144), and (146).

The time lags resulting from monochromatic injection in an inhomogeneous cloud are

plotted as a function of the Fourier frequency νf and compared with the Cyg X-1 data from

Nowak et al. (1999) in Figure 5 for both large and small cloud radii. The channel energy

values used are ǫsoft = 2 keV and ǫhard = 11 keV, which correspond to the channel-center

energies used in the analysis of the observational data. It is clear that the model results do

not ﬁt the data very well for either value of the cloud radius. Note that the shape of the

time lag curves exhibits the same trend as the data, but the magnitude is too large. This is

a result of the long upscattering time required for the soft disk seed photons to reach the

soft and hard channel energies.

HKC also computed time lags for monochromatic injection in an inhomogeneous cloud,

but they were able to ﬁt the observational data, in contrast to our results. However, in order

to qualitatively match the observed time lags, HKC had to adopt an outer cloud radius of
∼ 1 light-second (3 × 1010 cm), which is an order of magnitude larger than the cloud radii
implied by our model. The discrepancy between the model results may be due to the fact

that their cloud is optically thin, whereas our cloud is optically thick. The values for the

optical depth derived here are consistent with those obtained during the low/hard state of

Cyg X-1 by Malzac et al. (2008), Malzac (2012), Del Santo et al. (2013), and Frontera et

al. (2001). Unfortunately, we can’t use our model to explore the region of parameter space

studied by HKC because the corona must be optically thick in order to justify the diﬀusion

approximation employed in our approach.

– 49 –

Fig. 5.—: Theoretical time lag proﬁles resulting from monochromatic injection in an in-
homogeneous cloud, with electron number density proﬁle ne(r) ∝ r−1, compared with the
Cyg X-1 time lag data from Nowak et al. (1999). The source was in the low/hard state

during the observation. The time lags are computed by combining Equations (123), (144),

and (146), and the channel energies used in the theoretical calculations are ǫsoft = 2 keV and

ǫhard = 11 keV. The photon injection energy is ǫ0 = 0.1 keV.

6.2.2. Variation of Seed Photon Distribution

It is apparent from Figure 5 that monochromatic injection into an inhomogeneous

corona is unable to generate good agreement with the time lag data. Furthermore, it

has been previously established by Miyamoto (1988), HKC, and KB that monochromatic

injection into a homogeneous cloud also fails to agree with the data. Hence, it is

interesting to use our new formalism to explore the alternative hypothesis of broadband

(bremsstrahlung) seed photon injection, rather than monochromatic injection.

The bremsstrahlung-injection time lags are computed by combining Equations (129),

– 50 –

(144), and (146), and the model parameters are varied until reasonable qualitative agreement

with the observational data is achieved. We plot the theoretical bremsstrahlung-injection

time lags as a function of the Fourier frequency νf in Figure 6, using both the homogeneous

and inhomogeneous coronal cloud models. The results are compared with the observational

data for Cyg X-1 and GX 339-04 taken from Nowak et al. (1999) and Cassatella et al.

(2012), respectively. The corresponding physical parameters are listed in Table 1, and the

channel energies used in the theoretical calculations are ǫsoft = 2 keV and ǫhard = 11 keV

for Cyg X-1, and ǫsoft = 2 keV and ǫhard = 10 keV for GX 339-04, which correspond to

the channel-center energies used in the observational calculations of the time lags. The

low-energy self-absorption cutoﬀ is set at ǫabs = 1.6 keV for Cyg X-1 and at ǫabs = 0.01 keV

for GX 339-04. In the case of the homogeneous corona, the eigenvalues λn for the Fourier

transform solution are the same real values obtained in the analysis of the time-averaged

(quiescent) spectrum, which are plotted in the left-hand panel in Figure 3. In the case of

the inhomogeneous corona, the eigenvalues λn are complex, and are plotted in Figure 7.

We ﬁnd that in order to match the observational time lag data, the impulsive injection

of the bremsstrahlung photons must occur near the outer edge of the cloud, with z0 . 1.

The transient that produces the soft seed photons is not treated in detail here, but we note

that the outer edge of the corona is a region which the disk suddenly expands in the vertical

direction, possibly leading to various types of plasma instabilities. In particular, the abrupt

change in magnetic topology may generate rapid reconnection events that can result in the

injection of a signiﬁcant population of soft seed photons via bremsstrahlung emission (e.g.,

Poutanen & Fabian 1999).

In contrast with the behavior of the monochromatic injection scenario studied by

Miyamoto (1988), the results depicted in Figure 6 show that in the case of broadband

(bremsstrahlung) seed photon injection into either a homogeneous or inhomogeneous cloud,

– 51 –

Comptonization can produce Fourier frequency-dependent time lags that agree with the

observational data for both Cyg X-1 and GX 339-04. The diminishing time lags at high

Fourier frequency are explained as a natural results of the prompt escape of broadband

seed photons, combined with the delayed escape of upscattered Comptonized photons over

longer timescales.

Fig. 6.—: Theoretical time lag proﬁles for bremsstrahlung seed photon injection in a ho-

mogeneous corona (red) and an inhomogeneous corona (blue), compared with the data for

Cyg X-1 (left panel) from Nowak et al. (1999), and the data for GX 339-04 (right panel) from

Cassatella et al. (2012). Each source was observed in the low/hard state. See Section 6.2.3

and Figure 8 for a discussion of the convergence properties.

This indicates that the critical quantities for determining the shape of the time-lag

proﬁle are the overall optical thickness of the cloud and its temperature, which have nearly

the same values in the homogeneous and inhomogeneous corona models. We therefore

conclude that the actual conﬁguration of the cloud (i.e. the detailed radial variation of

the electron number density) is not well constrained by either the observations of the time

lags or the observations of the time-averaged X-ray spectrum, and indeed, either cloud

conﬁguration works equally well, although there is a slight diﬀerence in the resulting cloud

– 52 –

Fig. 7.—: Complex eigenvalues, λn, for the Fourier transform in the inhomogeneous case.

Left panel is for Cyg X-1 and right panel is for GX 339-04. Note that the imaginary part

of λn is always negative, and therefore we change the sign before taking the log. The colors

refer to the indicated values of the dimensionless Fourier frequency ˜ω, and the sequences

running from left to right represent the values of λ0 through λ10.

radius R, as indicated in Table 2.

6.2.3. Convergence of Time Lags

In our model, the time lags are computed based on analytical expressions for the

Fourier transform of the emitted radiation spectrum. Since these expressions are stated

in terms of series expansions, it is important to examine the convergence of the results

obtained for the time lags as one increases the truncation level of the series. Obviously,

rapid smooth convergence is desirable.

In Figure 8, we present a convergence study of the theoretical time lags computed

using the models for Cyg X-1 and GX 339-04, based on both the homogeneous and

– 53 –

inhomogeneous cloud conﬁgurations. In each panel, the black curves represent the time lags

evaluated using only the ﬁrst term in the expansions, and the red and blue curves represent

fully converged results, where no signiﬁcant change will occur upon the addition of another

term. The red and blue curves are the same as the ﬁnal results for the time lags plotted in

Figure 6. The time lags generally require about 20 terms to fully converge, whereas the

expansions for the time-averaged spectra converge immediately (see Figures 1 and 2).

Fig. 8.—: Convergence study of the theoretical time lags for Cyg X-1 and GX 339-04

computed using either the homogeneous or the inhomogeneous cloud model. The number

of terms used in the series expansions for the Fourier transforms is indicated for each curve.

The red and blue curves correspond to the ﬁnal results plotted in Figure 6.

– 54 –

7. Discussion and Conclusion

We have obtained the exact analytical solution for the problem of time-dependent

thermal Comptonization in a spherical scattering corona, based on two diﬀerent electron

density proﬁles. By working in the Fourier domain, we have obtained a closed-form

expression for the Green’s function corresponding to the injection of monochromatic seed

photons into a cloud at a single radius and time. The radiated Fourier transform, evaluated

at the surface of the cloud, can be directly substituted into the time lag formula introduced

by van der Klis et al. (1987) in order to compute the predicted dependence of the lags

on the Fourier frequency for any selected X-ray channel energies. In our approach, the

time-averaged X-ray spectrum and the time lags are both computed using the same set of

physical parameters to describe the properties of the scattering cloud, and therefore our

formalism represents an integrated model that fully describes the high-energy spectral and

timing properties of the source.

7.1. Relation to Previous Work

The study presented by HKC is similar to ours, although their methodology and input

assumptions are somewhat diﬀerent. HKC focused exclusively on a single injection scenario,

namely the injection of essentially monoenergetic, low-temperature blackbody seed photons

at the center of the scattering cloud. Based on this injection spectrum, they concluded that

the observed time lag behavior in Cyg X-1 could not be reproduced unless the electron
number density proﬁle was inhomogeneous, with ne(r) ∝ r−1 for example. In this case,
although the predicted time lags ﬁt the observed dependence on the Fourier period, the

resulting dimensions of the cloud are so large that the requisite heating is diﬃcult to

accomplish based on any of the standard dissipation models.

– 55 –

Another notable diﬀerence between the work of HKC and the results developed here

is that we have obtained a set of exact mathematical solutions, whereas HKC utilized

a numerical Monte Carlo simulation method. This distinction is important, because by

exploiting the exact solution for the Fourier transform of the Green’s function, we are

able to explore a much wider range of injection scenarios, in which we can vary both the

location of the initial ﬂash of seed photons, and its spectral distribution. Based on our

analytical formalism, we are able to conﬁrm the results of HKC regarding monochromatic

injection, but we have also generalized those results by exploring the implications of

varying the seed photon injection radius and spectrum. We ﬁnd that the injection of

broadband (bremsstrahlung) seed photons relatively close to the surface of a homogeneous

or inhomogeneous cloud can ﬁt the observed time lag proﬁles at least as well as the HKC

model does, but with a cloud size an order of magnitude smaller. In Section 7.2 we discuss

the physical reasons underlying the success of the bremsstrahlung injection scenario.

The treatment of electron scattering in our work diﬀers from that utilized by HKC,

since we have adopted the Thomson cross section, whereas HKC implemented the full

expression for the Klein-Nishina cross section. In principle, utilization of the Klein-Nishina

cross section would be expected to aﬀect the hard time lags, due to the quantum reduction in

the scattering probability at high energies. However, for the photon energy range of interest

here, ∼ 0.1 − 10 keV, combined with our maximum electron temperature, kTe = 62.4 keV,
not many photons are likely to sample the reduced cross section, which requires an incident

photon energy exceeding 500 keV as seen in the rest frame of the electron. Hence it seems

surprising that HKC observed a signiﬁcant change in the normalization of their computed

time lags when they adopted the Klein-Nishina cross section instead of the Thomson value.

We suspect that this may be due to the somewhat higher electron temperature they used,

kTe = 100 keV.

– 56 –

To explore this question quantitatively, we can compute the fraction of electrons such

that an incident photon of a given energy in the lab frame exceeds 500 keV in the electron’s

rest frame. The relevant thermal distribution function for the calculation is the relativistic

Maxwell-J¨uttner distribution, given by (e.g., Ter Haar & Wergeland 1971; Hua 1997)

fMJ(γ) ≡

γpγ2 − 1

ΘK2(1/Θ)

exp(cid:16)−

γ

Θ(cid:17)

(149)

where Θ ≡ kTe/(mec2) and K2 denotes the modiﬁed Bessel function of the second kind.
The probability that a randomly-selected electron has a Lorentz factor in the range between

γ and γ + dγ is equal to fMJ(γ)dγ.

In order to compute an upper bound on the probability of generating a scattering in

the Klein-Nishina regime, we shall focus on the most energetic possible collision scenario,

which is a head-on collision between the electron and the photon. In this case, the incident

photon energy in the electron’s rest frame, E ′

0, is given by

E ′

0 = E0(cid:18) 1 + β

1 − β(cid:19)1/2

,

β2 = 1 −

1
γ2 ,

(150)

where E0 is the incident photon energy in the lab frame. By integrating the Maxwell-J¨uttner

distribution, we can compute the probability, P , that a randomly-selected electron has

suﬃcient energy to create the required incident photon energy of at least 500 keV in the

rest frame. The probability is given by

P =Z ∞

γ0

fMJ(γ) dγ ,

(151)

where the lower bound γ0 is the root of the equation

500 keV = E0(cid:18)2γ2

0 − 1 + 2γ0qγ2

0 − 1(cid:19)1/2

.

(152)

Setting the incident photon energy E0 = 100 keV as an extreme example, we ﬁnd that

the lower bound is γ0 = 2.6. Adopting the HKC temperature value, kTe = 100 keV, we

– 57 –

obtain Θ = 0.2, in which case the probability given by Equation (151) is P = 3.1 × 10−3.
This probability may be large enough to explain the variation of the HKC time lag results

observed when they switched between the Thomson cross section and the Klein-Nishina

cross section, if some of the photons inverse-Compton scatter up to high enough energies

to sample the Klein-Nishina regime, before returning to lower energies via Compton

scattering. We can also compute the scattering probability P based on the maximum

electron temperature that we have adopted in our applications, kTe = 62.4 keV, which

yields Θ = 0.122. In this case, one ﬁnds that the Maxwell-J¨uttner integration gives
P = 2.6 × 10−5, which is much smaller than the HKC result. Hence we conclude that
utilization of the Klein-Nishina cross section would probably not make a signiﬁcant

diﬀerence in our applications. However, we can’t reach any deﬁnitive conclusions about this

question using the model developed here since it is based on the assumption of Thomson

scattering in the electron’s rest frame.

7.2. Formation of the Light Curves

The somewhat surprising diﬀerence between the time lag proﬁles produced when the

injection spectrum has a monoenergetic shape versus a broadband shape can be explored

by using the inverse Fourier transform to compute the time-dependent light curves for the

hard and soft energy channels in the two cases. To accomplish this, we must make use of

the inversion integral (cf. Equation (36))

f (x, z, p) =

1

2π Z ∞

−∞

e−i˜ωpF (x, z, ˜ω) d˜ω ,

(153)

where F is the Fourier transform computed using either the monochromatic injection

Green’s function solution (Equation (83) for the homogeneous cloud, or Equation (123)

for the inhomogeneous cloud), or the bremsstrahlung injection solution (the homogeneous

and inhomogeneous cases are both computed using Equation (129)). Evaluation of

– 58 –

Equation (153) requires numerical integration since the inversion integral cannot be

performed analytically. We therefore focus on a few simple examples in order to illustrate

the dependence of the light curves on the injection model.

In Figure 9, we plot the hard and soft channel light curves computed using

Equation (153) for the case of a homogeneous cloud experiencing impulsive injection

of either low-energy monochromatic seed photons or broadband (bremsstrahlung) seed

photons. The parameters describing the monochromatic injection scenario are temperature

Θ = 0.12, injection location z0 = 1, injection energy ǫ0 = 0.1 keV, soft channel energy

ǫsoft = 2 keV, and hard channel energy ǫhard = 10 keV. In the case of bremsstrahlung

injection, we set Θ = 0.12, z0 = 1, ǫabs = 0.1 keV, ǫsoft = 2 keV, and ǫsoft = 10 keV. One can

immediately identify the characteristic Fast Rise Exponential Decay (FRED) shape (e.g.,

Sunyaev & Titarchuk 1980) for each channel signal. As expected, the hard channel curve

is delayed in time relative to the soft channel curve due to upscattering, but the detailed

relationship between the two light curves depends qualitatively on whether the injection

spectrum is monochromatic or broadband.

One clearly observes that the two FRED curves resulting from monochromatic injection

in a homogeneous cloud are of the same shape, and are simply shifted by a perfect delay

with respect to one another on all timescales (see Figure 9). This yields a constant time

lag across all Fourier frequencies (or periods), in agreement with the Miyamoto result that

HKC and KB have conﬁrmed. Our physical understanding of this behavior is as follows.

Since all of the initial photons start with the same energy in the monochromatic case, the

time lag is purely a result of Compton reverberation, where the upscattering timescale

is proportional to the logarithm of the ratio of the hard to soft energies (Payne 1980).

Based on this simple example, we conclude that monochromatic injection anywhere in a

homogeneous cloud cannot produce Fourier frequency-dependent time lags, in contradiction

with the observational data.

FRED clight curves (monochromatic)

2 keV

10 keV

y
t
i
s
n
e

t

n

i

d
e
z

i
l

a
m
r
o
n

1.0

0.8

0.6

0.4

0.2

0.0

– 59 –

y
t
i
s
n
e

t

n

i

d
e
z

i
l

a
m
r
o
n

1.0

0.8

0.6

0.4

0.2

0.0

FRED clight curves (bremsstrahlung)

2 keV

10 keV

0

5

10

15

20

0

2

4

6

8

10

dimensionless time p

dimensionless time p

Fig. 9.—: FRED curves from monochromatic and bremsstrahlung injection in a homoge-

neous cloud. In each case, the red curve represents the soft energy channel, set at 2 keV,

and the blue curve denotes the hard channel, set at 10 keV. The normalized intensity in each

channel shows the relative lag.

The relationship between the two FRED light curves plotted in Figure 9 for the case

of bremsstrahlung injection is qualitatively diﬀerent from the monochromatic example. In

this case, the initial fast rise in both channels is coherent, meaning that the hard and soft

channel signals track each other relatively closely. This results in a small time lag at high

Fourier frequencies, because the fast rise portion of each curve represents the most rapid

variation in the system. Physically, this part of the process corresponds to the prompt

escape of “pristine” bremsstrahlung seed photons that are almost unaﬀected by scattering.

Because bremsstrahlung is a broadband emission mechanism, both hard and soft photons

exist in the initial distribution, and the prompt escape is therefore coherent across the

energy channels. This is, of course, not true in the case of low-energy monochromatic

injection, because in that scenario, photons require suﬃcient time to upscatter into both

the soft and hard energy channels.

– 60 –

At longer timescales (smaller Fourier frequencies) in the bremsstrahlung case, the hard

light curve approaches a delayed version of the soft light curve, reﬂecting the time it takes

for the photons to Compton upscatter to the hard channel energy. This part of the process

is similar to the monochromatic case, and indeed, we see that the time lags level oﬀ to a

plateau at small Fourier frequencies, just as in the monochromatic example. To summarize,

the overall behavior of the bremsstrahlung injection model matches the observational

data much more closely then does the monochromatic injection scenario because of the

combination of prompt escape (the fast rise part of the light curves) along with Compton

reverberation (exponential decay) on longer timescales. This explains the origin of the

qualitative diﬀerence in the behavior of the time lags at high Fourier frequencies exhibited

in the monochromatic and bremsstrahlung injection scenarios, depicted in Figures 5 and 6,

respectively.

7.3. Coronal Temperature

Both our model and that analyzed by HKC require the presence of hot electrons
with temperature Te ∼ 108 K at distances r ∼ 103 GM/c2 from the black hole. This
temperature distribution is consistent with a substantial number of studies that focus on

energy transport in ineﬃcient accretion ﬂows, with accretion rates that are signiﬁcantly

sub-Eddington, as ﬁrst established by Nayaran & Yi (1995) in the context of the original,

self-similar Advection Dominated Accretion Flow (ADAF) model. Similar results for the

temperature distribution were later obtained using more complex numerical simulations

by Oda et al. (2012), Rajesh & Mukhopadhyay (2010), Yuan et al. (2006), Mandal &

Chakrabarti (2005), Liu et al. (2002), R´o˙za´nska & Czerny (2000), and You et al. (2012).

In these hot ADAF ﬂows, the density in the outer region is so low that bremsstrahlung

and inverse-Compton cooling are very ineﬃcient. The lack of eﬃcient cooling drives the

– 61 –

electron temperature in the corona close to the virial value, out to distances of hundreds or

thousands of gravitational radii from the black hole, in agreement with the temperature

proﬁles assumed here.

In the study presented here, we have assumed that the electron scattering corona is

isothermal in order to accomplish the separation of variables that is required to obtain

analytical solutions to the radiation transport equation. The resulting analytical solutions

allow us to determine the physical properties of the scattering corona in a given source by

computing the time-averaged X-ray spectrum and the time-lag proﬁle and comparing the

theoretical results with the observational data. The assumption of an isothermal corona

is roughly justiﬁed by studies indicating that the temperature does not vary by more

than a factor of a few across the corona (e.g., You et al. 2012; Schnittman et al. 2013).

Nonetheless, it is worth asking whether our results would be signiﬁcantly modiﬁed in the

presence of a coronal temperature gradient.

If the electron temperature varied across the corona, then in general one would expect

the plasma to be hotter in the inner region, where the density is likely to be higher as

well. In this scenario, the photons in the hot inner region would Compton upscatter

faster than those in the cooler outer region, but they would spend more time (on average)

scattering through the cloud before escaping due to the greater optical depth in the inner

region. We estimate that these two eﬀects would roughly oﬀset each other, leaving the

time lag proﬁle close to the isothermal result derived here, if the temperature were set

equal to the average value in the corona. Hence we predict that the results obtained for

the time lags in the presence of a temperature gradient would be qualitatively similar to

those obtained here using the isothermal assumption. Moreover, while the electrons may

approach the virial temperature in the outer region, it is likely that in the inner region, the

electron temperature is thermostatically controlled by Compton scattering (e.g., Sunyaev &

– 62 –

Titarchuk 1980; Shapiro, Lightman & Eardley 1976). The combination of these two eﬀects

will tend to produce a relatively high, but uniform, electron temperature distribution, as we

have assumed here.

7.4. Time Varying Coronal Parameters

If the transients responsible for producing the observed X-ray time lags in accreting

black hole sources are driven by the deposition of a large amount of energy, then the

properties of the corona (temperature, density) would be expected to respond. If this

response occurs on time scales comparable to the diﬀusion time for photons to escape

from the corona, then the resulting time lag proﬁles would be modiﬁed compared with the

results obtained here, since we assume that the properties of the corona remain constant.

Malzac & Jourdain (2000) have considered the possible variation of the coronal properties

during X-ray ﬂares using a non-linear Monte Carlo simulation to study the ﬂare evolution

as a function of time, along with the associated variation of the temperature and optical

depth in the corona. They do not compute Fourier time lags, but they do present simulated

light curves in the soft and hard energy channels. In their model, the ﬂares are driven by

a sudden increase in the disk’s internal dissipation, which produces a large quantity of soft

photons. The temperature and optical depth of the corona change self-consistently during

the transient, and then return to the equilibrium state. They ﬁnd that hard time lags are

produced during the ﬂare if the energy deposition is substantial.

The approach taken by Malzac & Jourdain (2000) is based on the pulse-avalanche

model of Poutanen & Fabian (1999). The model does not explicitly include Compton

upscattering as a contributor to the time-lag phenomenon, nor was the signiﬁcance of the

injection spectrum considered. The simulated light curves generated by Malzac & Jourdain

(2000) sometimes display temporal dips, but the time dependence doesn’t seem to resemble

– 63 –

that observed during the transients in Cyg X-1. Since these authors do not compute Fourier

time lags, it is diﬃcult to directly compare their results with ours. However, we note that

the transients under study here represent relatively small variations in the X-ray luminosity,

which suggests that the energy deposition may not be large enough to signiﬁcantly alter

the large-scale properties of the scattering corona during the time it takes the photons to

diﬀuse out of the cloud (Nowak et a. 1999; Cassatella et al. 2012). This supports our

assumption that the temperature and density of the corona remain essentially constant

during the formation of the observed time lags.

7.5. Conclusion

Our goal in this paper is to develop an integrated model, based on the diﬀusion

and thermal Comptonization of seed photons in an optically-thick scattering cloud, that

can naturally reproduce both the observed X-ray spectra and the time lags for Cyg X-1

and GX 339-04 using a single set of cloud parameters (density, radius, temperature).

We have derived and presented a new set of exact mathematical solutions describing

the Comptonization of seed photons injected into a scattering cloud of ﬁnite size that is

either homogeneous, or possesses an electron number density that varies with radius as
ne(r) ∝ r−1. The results developed here include new expressions for (a) the Green’s function
describing the radiated time-averaged X-ray ﬂux (corresponding to the reprocessing of

continually injected monochromatic seed photons), (b) the Green’s function for the Fourier

transform of the time-dependent radiation spectrum resulting from the impulsive injection

of monochromatic seed photons, and (c) the associated X-ray Fourier time lags.

By exploiting the linearity of the fundamental transport equation, we used our results

for the Green’s function to explore a variety of seed photon injection scenarios. One of our

main conclusions is that the integrated model can successfully explain the data regardless

– 64 –

of the cloud conﬁguration (homogeneous or inhomogeneous), provided the optical thickness

and the temperature are comparable in the two models, as expected based on the Compton

reverberation scenario (Payne 1980). Our results demonstrate that the bremsstrahlung

injection model ﬁts the observational time-lag data reasonably well for both Cyg X-1 and

GX 339-04, whether the scattering corona is homogeneous or inhomogeneous. We therefore

conclude that the constant time lags found by HKC in the homogeneous cloud conﬁguration

were the result of their utilization of a quasi-monochromatic (low-temperature blackbody)

injection spectrum for the seed photon distribution.

The injection location in our model is diﬀerent from that considerd by HKC, who

assumed that the seed photons were always injected at the center of the spherical cloud.

In our model, the injection location is arbitrary, and we ﬁnd that the best agreement with

the time lag data is obtained when the injection is relatively close to the surface of the

cloud, so that the prompt escape of some of the unprocessed bremsstrahlung seed photons

is able to explain the diminishing time lags observed at high Fourier frequencies. At longer

timescales, the standard thermal Comptonization process sets the delay between the soft

and hard channels, and this naturally leads to the observed plateau in the time lags at low

Fourier frequencies.

In future work, we plan to develop a more general Green’s function in which the

injection occurs on a ring or a point, rather than on a spherical shell as in the model

considered here. As in the present paper, the resulting Fourier transform of the time-

dependent Green’s function in the general case will allow us to investigate a variety of seed

photon energy distributions (e.g., blackbody or bremsstrahlung). The additional geometric

ﬂexibility in the general model should allow us to further improve the agreement between

the model predictions and the data, hence providing new insights into the structure of the

scattering corona and the underlying accretion disk. We also plan to examine scenarios in

– 65 –

which the electrons cool during the transient in response to the upscattering of the injected

photons. This may help to explain the soft time lags observed in some accreting black-hole

sources (e.g., Fabian et al. 2009).

The authors are grateful to the anonymous referee who provided a variety of insightful

comments that helped to strengthen and clarify the results presented here.

8. Appendix A

In order to use the series expansions developed in Sections 3 and 4 to represent the

Green’s functions for the time-averaged (quiescent) spectrum and for the Fourier transform

of the time-dependent spectrum, it is necessary to establish the orthogonality of the various

spatial eigenfunctions. In this section, we present a global proof of orthogonality of the

spatial eigenfunctions for both the homogeneous case (utilizing the mirror inner boundary

condition) and for the inhomogeneous case (utilizing the dual free-streaming boundary

condition). First we deﬁne the generic spatial ODE, encompassing Equations (46), (69),

(87), and (106), by writing

1

z2−α

d

dz (cid:18)z2+α dΓn

dz (cid:19) + η2ξnΓn(z) = 0 ,

such that,

(154)

(155)

(156)

α =




Γn(z) =

0, homogeneous (quiescent & Fourier transform) ,

1,

inhomogeneous (quiescent & Fourier transform) ,

Yn(z), homogeneous (quiescent & Fourier transform) ,

yn(z),

inhomogeneous (quiescent) ,

gn(z),

inhomogeneous (Fourier transform) ,

and

ξn =

λn,

λn,




λn + 3i˜ωz,

– 66 –

homogeneous (quiescent & Fourier transform) ,

inhomogeneous (quiescent) ,

(157)

inhomogeneous (Fourier transform) .

To establish orthogonality, we multiply Equation (154) by Γm(z) and then duplicate

it with the indices exchanged, after which we subtract the second equation from the ﬁrst,

yielding

Γm

d

dz (cid:18)z2+α dΓn

dz (cid:19) − Γn

d

dz (cid:18)z2+α dΓm

dz (cid:19) = −η2z2−α(ξn − ξm)Γn(z)Γm(z) .

(158)

Next, we integrate by parts with respect to z over the computational domain zin ≤ z ≤ 1 to
obtain, after simpliﬁcation,

(cid:18)z2+αΓm

dΓn
dz − z2+αΓn

1

zin

= −η2(ξn − ξm)Z 1

zin

z2−αΓn(z)Γm(z) dz .

(159)

The left-hand side of Equation (159) needs to be evaluated separately for the homogeneous

dΓm

dz (cid:19)(cid:12)(cid:12)(cid:12)(cid:12)

and inhomogeneous cases, since the spatial boundary conditions are diﬀerent in the two

situations. We consider each of these cases in turn below.

For the homogeneous cloud conﬁguration, with α = 0 and zin = 0, the inner and outer

spatial boundary conditions can be written as (cf. Equations (51) and (53))

lim
z→0

z2 dΓn
dz

= 0 ,

lim

z→1(cid:20) 1

3η

dΓn
dz

+ Γn(cid:21) = 0 .

(160)

Likewise, in the inhomogeneous case, with α = 1, we can express the inner and outer

boundary conditions as (cf. Equations (92) and (94))

lim

z→zin(cid:20) z

3η

dΓn

dz − Γn(cid:21) = 0 ,

lim

z→1(cid:20) z

3η

dΓn
dz

+ Γn(cid:21) = 0 .

(161)

Using either the homogeneous or inhomogeneous boundary conditions given by

Equations (160) and (161), respectively, we ﬁnd that the left-hand side of Equation (159)

– 67 –

vanishes, which establishes the required orthogonality of the spatial eigenfunctions. The

orthogonality condition can be written in general as

Z 1

zin

z2−α Γn(z) Γm(z) dz = 0 ,

n 6= m .

(162)

9. Appendix B

As shown in Section 5, the particular solution for the Fourier transform in the case of

bremsstrahlung, Fbrem, injection is given by the convolution (see Equation (128))

Fbrem(x, z, z0, ˜ω) =Z ∞

xabs

FG(x, x0, z, z0, ˜ω) A0 x−1

0 e−x0N −1

0 dx0 ,

(163)

where xabs is the dimensionless self-absorption cutoﬀ energy, the constant A0 is given by

Equation (127), and the Fourier transform Green’s function, FG, is given by Equations (83)

and (123) in the homogeneous and inhomogeneous cases, respectively. In general, we can

write FG in the generic form

FG(x, x0, z, z0, ˜ω) = N0 e(x0−x)/2(xx0)−2

∞

Xn=0

M2,λ(xmin)W2,λ(xmax) An(z, z0, ˜ω) ,

(164)

where xmin = min(x, x0), xmax = max(x, x0), and An is a composite function containing the

expansion coeﬃcients and the spatial eigenfunctions, given by

An(z, z0, ˜ω) =

ei˜ωp0η3

4πR3Θ4(mec2)3 


Γ(µ − 3/2)Yn(z0)Yn(z)
Γ(σ − 3/2)gn(z0)gn(z)

Γ(1 + 2µ)In

Γ(1 + 2σ) η3Kn

, homogeneous ,

,

inhomogeneous .

(165)

In the homogeneous case, µ is computed using Equation (76), and in the inhomogeneous

case, σ is computed using Equation (109). Combining Equations (163) and (164), and

reversing the order of summation and integration, we obtain

Fbrem(x, z, z0, ˜ω) = A0 e−x/2x−2

∞

Xn=0

An(z, z0, ˜ω)B(λ, x) ,

(166)

– 68 –

where

B(λ, x) ≡Z ∞

xabs

e−x0/2x−3

0 M2,λ(xmin)W2,λ(xmax) dx0 ,

(167)

and we set λ = µ to treat the homogeneous case, and we set λ = σ to treat the

inhomogeneous case.

Our remaining task is to evaluate the integral function B analytically, if possible. The

expression for B can be broken into two integrals by writing, for x ≥ xabs,

B(λ, x) = IM (λ, x0)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

x

xabs

W2,λ(x) + IW (λ, x0)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

∞

∞

x

and, for x ≤ xabs,

M2,λ(x) ,

(168)

B(λ, x) = IW (λ, x0)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

xabs

M2,λ(x) ,

(169)

where we have deﬁned the indeﬁnite integrals IM (λ, x0) and IW (λ, x0) using

IM (λ, x0) ≡Z e−x0/2x−3

0 M2,λ(x0)dx0 ,

IW (λ, x0) ≡Z e−x0/2x−3

0 W2,λ(x0)dx0 .

(170)

It is convenient to rewrite the Whittaker functions in the integrands for IM and IW using

the Kummer function identities (Abramowitz & Stegun 1970),

Mα,β(z) = e−z/2z

Wα,β(z) = e−z/2z

which yield

1

1

2

2 +βM(cid:16) 1
2 +βU(cid:16) 1

2

+ β − α, 1 + 2β, z(cid:17) ,
+ β − α, 1 + 2β, z(cid:17) ,

IM (λ, x) =Z e−xxb−a−5M(a, b, x)dx ,

IW (λ, x) =Z e−xxb−a−5U(a, b, x)dx ,

where

a = λ −

3
2

,

b = 2 λ + 1 .

(171)

(172)

(173)

(174)

The integral IW (λ, x) can be carried out analytically using Slater’s (1960) identity,

Z e−xxb−a−2U(a, b, x)dx = −e−xxb−a−1U(a + 1, b, x) .

(175)

– 69 –

Integrating Equation (173) by parts once yields

Z x−3e−xxb−a−2U(a, b, x)dx = −x−3e−xxb−a−1U(a+1, b, x)−3Z x−4e−xxb−a−1U(a+1, b, x)dx .

(176)

Integrating by parts again gives

Z x−3e−xxb−a−2U(a, b, x)dx = −x−3e−xxb−a−1U(a+1, b, x)−3h−x−2e−xxb−a′

−1U(a′+1, b, x)

− 2Z x−3e−xxb−a′−1U(a′ + 1, b, x)dxi ,

(177)

where a′ = a + 1. Integrating by parts a third time yields

Z x−3e−xxb−a−2U(a, b, x)dx = −x−3e−xxb−a−1U(a+1, b, x)−3n−x−2e−xxb−a′

− 2h − x−1e−xxb−a′′ −1U(a′′ + 1, b, x) −Z x−2e−xxb−a′′ −1U(a′′ + 1, b, x)dxio ,

−1U(a′+1, b, x)

(178)

where a′′ = a′ + 1. The remaining integral can be evaluated directly using Equation (175)

to obtain, after some algebra,

Z x−3e−xxb−a−2U(a, b, x)dx = e−xxb−a−4h − U(a + 1, b, x) + 3U(a + 2, b, x)

− 6U(a + 3, b, x) + 6U(a + 4, b, x)i .

(179)

By converting the Kummer functions to Whittaker functions, we obtain the ﬁnal expression

IW (λ, x) = e−x/2x−2h − W1,λ(x) + 3W0,λ(x) − 6W−1,λ(x) + 6W−2,λ(x)i .

(180)

Likewise, the integral IM (λ, x) in Equation (173) can be evaluated using Slater’s (1960)

identity

Z e−xxb−a−2M(a, b, x)dx =

e−xxb−a−1
b − a − 1

M(a + 1, b, x) .

(181)

Following the same iterative procedure used to evaluate IW (λ, x), we eventually arrive at

– 70 –

the result

IM (λ, x) =

e−xxb−a−4

b − a − 1 M(a + 1, b, x) +

3

b − a − 2(cid:26)M(a + 2, b, x)

+

2

b − a − 3hM(a + 3, b, x) +

1

b − a − 4

which can be rewritten in terms of the Whittaker functions as

M(a + 4, b, x)i(cid:27)! ,

(182)

IM (λ, x) =

x−2e−x/2

λ + 3

2  M1,λ(x) +

3

λ + 1

2(cid:26)M0,λ(x) +

2
λ − 1

2hM−1,λ(x) +

1
λ − 3

2

M−2,λ(x)i(cid:27)! .

(183)

Our ﬁnal expression for the integral function B(λ, x) is obtained by rewriting

Equations (168) and (169) as

B(λ, x) =


W2,λ(x)[IM (λ, x) − IM (λ, xabs)] − M2,λ(x)IW (λ, x) , x ≥ xabs ,
−M2,λ(x)IW (λ, xabs) ,
x ≤ xabs ,

(184)

where IW (λ, x) and IM (λ, x) are evaluated using Equations (180) and (183), respectively.

We can now combine Equations (165) and (166) to express the bremsstrahlung injection

Fourier transform Fbrem as

Fbrem(x, z, z0, ˜ω) =

ei˜ωp0η3A0 e−x/2

4πR3Θ4(mec2)3x2

∞

Xn=0




Γ(µ − 3/2)Yn(z0)Yn(z)
Γ(σ − 3/2)gn(z0)gn(z)

Γ(1 + 2µ)In

Γ(1 + 2σ) η3Kn

B(µ, x) , homogeneous ,

B(σ, x) ,

inhomogeneous ,

(185)

where B(µ, x) and B(σ, x) are evaluated using Equation (184).

– 71 –

REFERENCES

Abramowitz, M., & Stegun, I. A. 1970, Handbook of Mathematical Functions, (New York:

Dover)

Becker, P. A., 2003, MNRAS, 343, 215

Cadolle Bel, M., Rodriguez, J., D’Avanzo, P., et al. 2011, A&A, 534, 119

Cadolle Bel, M., Sizun, P., Goldwurm, A., et al. 2006, A&A, 446, 591

Cassatella. P., Uttley, P., Wilms, J., & Poutanen, J. 2012, MNRAS, 422, 2407

Del Santo, M., Malzac, J., et al. 2013, MNRAS, 430, 209

Fabian, A. C., Zoghbi, A., Ross, R. R., et al. 2009, Nature, 459, 540

Frontera, F., Palazzi, E., Zdziarski, A. A. et al. 2001, ApJ, 546, 1027

Ter Haar, D., & Wergeland, H. 1971, PhysRep, 1, 31

Hua, X.-M. 1997, CompPh, 11, 660

Hua, X.-M., Kazanas, D., & Cui, W. 1999, ApJ, 512, 793

Kroon, J. J., & Becker, P. A. 2014, ApJL, 785, L34

Ling, J. C., Wheaton, W. A., Wallyn, P., et al. 1997, ApJ, 484, 375

Liu, B. F., Mineshige, S., et al. 2002, ApJ, 575, 117

Malzac, J. 2012, IJMP, 8, 73

Malzac, J., & Jourdain, E. 2000, A&A, 359, 843

Malzac, J., Lubi´nski, P., et al. 2008, A&A, 492, 527

– 72 –

Mandal, S., & Chakrabarti, S. K. 2005, A&A, 434, 839

Meyer, F., Liu, B. F., & Meyer-Hofmeister, E. 2007, A&A, 463, 1

Miyamoto, S., Kitamoto, S., Mitsuda, K., & Dotani, T. 1988, Nature, 336, 450

Nayaran, R., & Yi, I. 1995, ApJ, 452, 710

Nowak, M. A., Vaughan, B. A., Wilms, J., Dove, J. B., & Begelman, M. C. 1999, ApJ, 510,

874

Oda, H., Machida, M., et al. 2012, PASJ, 64, 15

Payne, D.G. 1980, ApJ, 237, 951

Poutanen, J., & Fabian, A. C. 1999, MNRAS, 306, L31

Rajesh, S. R., & Mukhopadhyay, B. 2010, MNRAS, 402, 961

R´o˙za´nska, A., & Czerny, B. 2000, A&A, 360, 1170

Rybicki, G. B., & Lightman, A. P. 1979, Radiative Processes in Astrophysics (New York:

Wiley)

Schnittman, J. D., Krolik, J. H., & Noble, S. C. 2013, ApJ, 769, 156

Shapiro, S. L., Lightman, A. P., & Eardley 1976, ApJ, 204, 187

Slater L. J. 1960, Conﬂuent Hypergeometric Functions. (Cambridge: Cambridge Univ.

Press)

Sunyaev, R. A., & Titarchuk, L. G. 1980, A&A, 86, 121

van der Klis, M., Hasinger, G., Stella, L., et al. 1987, ApJL, 319, L13

You, B., Cao, X., & Yuan, Y.-F. 2012, ApJL, 761, 109

– 73 –

Yuan, F., Taam, R. E., et al. 2006, ApJ, 636, 46

This manuscript was prepared with the AAS LATEX macros v5.0.

