6
1
0
2

 
r
a

 

M
4
1

 
 
]

.

G
A
h
t
a
m

[
 
 

1
v
3
9
1
4
0

.

3
0
6
1
:
v
i
X
r
a

SEMI-ALGEBRAIC GEOMETRY WITH RATIONAL CONTINUOUS FUNCTIONS

JEAN-PHILIPPE MONNIER

MSC 2000: 14P99, 11E25, 26C15
Keywords: regular function, regulous function, rational function, real algebraic variety, alge-
braically constructible function, semi-algebraic set.

Abstract. Let X be a real algebraic subset of Rn. We investigate on the theory of algebraically
constructible functions on X and the description of the semi-algebraic subsets of X when we replace
the polynomial functions on X by some rational continuous functions on X. We also study the integral
closure of some rings of rational continuous functions on X.

1. Introduction

The concept of rational continuous maps between smooth real algebraic sets was used the ﬁrst time
by W. Kucharz [8] in order to approximate continuous maps into spheres. In [12], rational continuous
functions on smooth real algebraic sets are renamed by “regulous functions” and their systematic study
is performed. A theory of vector bundles using these functions is done in [9].

J. Kollár and K. Nowak proved in [7] that the restriction of a regulous function to a real algebraic
subset is still rational. It allows us to deﬁne the concept of regulous function on a possibly singular
aﬃne real algebraic set X by restriction from the ambiant space. On X, we have two classes of
functions: rational continuous functions and regulous functions.
In cite [7] and [10], they give a
condition for a rational continuous function to be regulous. In the ﬁrst section of the present paper
we continue the study of diﬀerences between these two classes of functions.

The second section is devoted to the study of the integral closure of the ring of regulous functions.
In particular, we establish that the ring of regulous functions on an irreducible smooth real algebraic
set is integrally closed.

The third section deals with the theory of algebraically constructible functions, due to C. McCrory
and A. Parusiński [14]. This theory has been developed to study singular real algebraic sets. We
prove that the theory of algebraically constructible functions can be done using only regulous objects
(functions, maps, sets). In particular, we show that the sign of a regulous function is a sum of signs
of polynomial functions and we investigate on the number of polynomial functions needed in such
representation.

In the last section, we focus on the description of semi-algebraic sets when we replace polynomial

functions by regulous functions.

Acknowledgements

I want to thank G. Fichou and R. Quarez for stimulating conversations concerning regulous func-
tions. I thank also F. Mangolte and D. Naie for interesting and helpful discussions. In memory of
J.-J. Risler.

2. Regulous functions versus rational continuous functions

2.1. Regulous functions. Let n ∈ N and k ∈ N ∪{∞}, we recall the deﬁnition of k-regulous functions
on Rn (see [12]).

Date: March 15, 2016.

1

2

J.-P. MONNIER

Deﬁnition 2.1. We say that a function f : Rn → R is k-regulous on Rn if f is C k on Rn and f is a
rational function on Rn, i.e. there exists a non-empty Zariski open subset U ⊆ Rn such that f |U is
regular (or f is the C k-extension to Rn of a rational function on Rn).

A 0-regulous function on Rn is simply called a regulous function on Rn.

An equivalent deﬁnition of a k-regulous function on Rn is given in [13, Thm. 2.15].
We denote by Rk(Rn) the ring of k-regulous functions on Rn. By Theorem 3.3 of [12] we know that

R∞(Rn) coincides with the ring O(Rn) of regular functions on Rn.

Denote by Z(f ) the zero set of the real function f . For an integer k, the k-regulous topology of Rn
is deﬁned to be the topology whose closed subsets are generated by the zero sets of regulous functions
in Rk(Rn). Although the k′-regulous topology is a priori ﬁner than the k-regulous topology when
k′ < k, it has been proved in [12] that in fact they are the same. Hence, it is not necessary to specify
the integer k to deﬁne the regulous topology on Rn. By [12, Thm. 6.4], the regulous topology on
Rn is the algebraically constructible topology on Rn (denoted by C-topology). On Rn, the euclidean
topology is ﬁner than the AR-topology (the arc-symetrical topology (see [12])) which is ﬁner than the
regulous topology which is the C-topology which is ﬁner than the Zariski topology.

We give now the deﬁnition of a regulous function on an aﬃne algebraic variety [12, Cor. 5.38].

Deﬁnition 2.2. Let X be a real algebraic subset of Rn. A k-regulous function on X is the restriction
to X of a k-regulous function on Rn. The ring of k-regulous functions on X, denoted by Rk(X),
corresponds to

Rk(X) = Rk(Rn)/ I k(X)

where I k(X) is the ideal of Rk(Rn) of k-regulous functions on Rn that vanish identically on X.

Remark 2.3. The previous deﬁnition can be extended to the case X is a closed regulous subset of
Rn [12].

Let X ⊂ Rn be a real algebraic set, we will denote by O(X) the ring of regular functions on X, by
P(X) the ring of polynomial functions on X and by K(X) the ring of rational functions on X. By
[7], a regulous function on X is always rational on X (coincides with a regular function on a dense
Zariski open subset of X). Since the regulous topology on X is sometimes strictly ﬁner than the
Zariski topology on X, the ring R0(X) is not always a subring of K(X) even if X is irreducible.

Example 2.4. Let X be the plane cubic with an isolated point X = Z(x2 + y2 − x3). The curve X is
irreducible in the Zariski topology but reducible in the C-topology. The C-irreducible components of
x2 + y2 , is the smooth branch of X. The

X are F and {(0, 0)} where F = Z(f ) ⊂ R2, with f = 1 −

x3

Figure 1. Cubic curve with an isolated point.

ring R0(X) is the cartesian product R0(F ) × R and the class of f in R0(X) is (0, 1). Remark that
the ring R0(X) is not an integral domain and consequently it is not a subring of K(X).

SEMI-ALGEBRAIC GEOMETRY WITH RATIONAL CONTINUOUS FUNCTIONS

3

τ

Let X be a real algebraic subset of Rn. We have a natural ring morphism φ0 : R0(X) → K(X)
which send f ∈ R0(X) to the class (U, f |U ) in K(X), where U is a dense Zariski open subset of X
and f |U is regular. We have seen that φ0 is not always injective. In the following, we will denote by
the closure of the subset E of Rn for the topology τ on Rn. We prove now that φ0 is injective
E
when Xreg
= X, Xreg denoting the closure of the smooth locus of X. This condition means that the
Zariski irreducible components of X are also irreducible for the C-topology.
Proposition 2.5. Let X be a real algebraic subset of Rn. The map φ0 : R0(X) → K(X) is injective
if and only if Xreg

= X.

C

C

C

= X. Let f1, f2 ∈ R0(X) be such that φ0(f1) = φ0(f2). Let ˆfi ∈ R0(Rn),
Proof. Assume Xreg
i = 1, 2, be such that ˆfi|F = fi. Since f1 and f2 are two continuous extensions to X of the same
rational function on X, they coincide on Xreg. Hence ˆf1 − ˆf2 vanishes on X since X is the regulous
closure of Xreg. It implies that f1 = f2.

C

C

Assume Xreg

6= X. By [12, Thm. 6.13], we may write X = Xreg

∪F with F a non-empty regulous
closed subset of Rn such that dim F < dim X. Let ˆf ∈ R0(Rn) be such that Z( ˆf ) = Xreg
and let
f denote the restriction of ˆf to X. We have f 6= 0 in R0(X), φ0(f ) = 0 in K(X) and thus φ0 is non
injective.
(cid:3)

C

2.2. Rational continuous functions on central algebraic varieties. Let n be a positive integer
and let X ⊂ Rn be a real algebraic set. Let f ∈ K(X) be a rational function on X. The domain of
f , denoted by dom(f ), is the biggest dense Zariski open subset of X on which f is regular, namely
where p and q are polynomial functions on Rn such that q does not vanish on dom(f ). The
f =

p
q

indeterminacy locus of f is deﬁned to be the Zariski closed set indet(f ) = X \ dom(f ).

Deﬁnition 2.6. Let f be a real continuous function on X. We say that f is a rational continuous
function on X if f is rational on X i.e there exists a dense Zariski open subset U ⊆ X such that f |U
is regular.

Let R0(X) denote the ring of rational continuous functions on X. We have a natural ring morphism
φ0 : R0(X) → K(X) which send f ∈ R0(X) to the class (U, f |U ) in K(X), where U is a dense Zariski
open subset of X and f |U is regular.
Remark 2.7. We have R0(Rn) = R0(Rn).

Deﬁnition 2.8. We say that X is “central” if Xreg

eucl

= X.

Remark 2.9. The previous deﬁnition comes from the introduction of the the central locus of a real
algebraic set made in [4, Def. 7.6.3].

The property to be central is the property of an algebraic set that ensures a rational continuous
function on it to be the unique possible continuous extension of its associated rational function. The
following example illustrates this fact.
Example 2.10. Let X = Z(zx2 − y2) ⊂ R3 be the Whitney umbrella. By [12], X is irreducible in
the C-topology and we have

Xreg

AR

C

= Xreg

= Xreg

Zar

= X.

eucl

is the half of the stick. The class of the rational fraction

y2
x2 |X in K(X) (which is
The set X \ Xreg
rational) has polar locus equal to the stick. It is also the class of the regular function z. This rational
function can be extended continuously to X by z but also if we set it to be equal to z on Xreg
and
0 on X \ Xreg

. Consequently, the map φ0 : R0(X) → K(X) is not injective.

eucl

eucl

4

J.-P. MONNIER

Proposition 2.11. The map φ0 : R0(X) → K(X) is injective if and only if X is central.

Figure 2. Whitney umbrella.

Proof. With the hypothesis X = Xreg
extension to X then this extension is the unique possible extension.

, in case a rational function of K(X) has a continuous

eucl

Assume X is not central. It is always possible to extend the null function on Xreg

to a continuous
function f on X such that f is not the null function on X. The function f is rational on X since it
is a regular function on Xreg. Obviously, f is a non-trivial element of the kernel of φ0 and the proof
is done.
(cid:3)

eucl

Obviously, any f ∈ R0(X) can be identiﬁed with a unique function in R0(X). Hence we get:

Proposition 2.12. We have the following ring inclusion φ0

0 : R0(X) ֒→ R0(X) and moreover

φ0 = φ0 ◦ φ0
0.

Remark 2.13. Let X be a real algebraic subset of Rn such that Xreg
(e.g the Whitney umbrella). By Propositions 2.12 and 2.11, we see that in this case the map φ0
surjective i.e there is a rational continuous function on X which is not regulous.

= X and X is not central
0 is not

C

In the following example, due to Kollár and Nowak [7, Ex. 2], we will see that, even if X is central,
φ0
0 may be not surjective.
Example 2.14. Let X = Z(x3 − (1 + z2)y3) ⊂ R3. Then X is a central singular surface with singular
|X in K(X) can be extended
locus the z-axis. By [7, Ex. 2], the class of the rational function

x
y

continuously to X (in a unique way) by the function (1 + z2)
3 on the z-axis and gives an element
f ∈ R0(X). Moreover, f cannot be extended to an element of R0(R3) = R0(R3) (the reason is that
3 is not rational) and thus f is not in R0(X). Here the map
the restriction of f to the z-axis (1 + z2)
0 : R0(X) ֒→ R0(X) is not surjective and the map φ0 : R0(X) → K(X) is injective.
φ0
One of the goal of the paper [7] was to study the surjectivity of the map φ0

0 when X is a central real
algebraic set. Notice that “regulous functions” are named “hereditarily rational continuous functions”
in [7].

1

1

We reformulate with our notation the three principal results of [7] with an improvement of the ﬁrst

one.

Lemma 2.15. ([7, Prop. 11])
Let X ⊂ Rn be a real algebraic set and let f ∈ R0(X). Let W = indet(f ) be the polar locus of f in

SEMI-ALGEBRAIC GEOMETRY WITH RATIONAL CONTINUOUS FUNCTIONS

5

X. If f |W ∈ R0(W ) has the additional property that f |W is the restriction to W of g ∈ R0(Rn) such
that g is regular on Rn \W then

f ∈ R0(X).

Moreover, f has also the additional property that there exists ˆf ∈ R0(Rn) such that ˆf is regular on
Rn \W and ˆf |X = f .

We improve Lemma 2.15 by removing the additional property from the hypotheses.

Lemma 2.16. Let X ⊂ Rn be a real algebraic set and let f ∈ R0(X). Let W = indet(f ) be the polar
locus of f in X. If f |W ∈ R0(W ) then

f ∈ R0(X).

Proof. Assume f |W ∈ R0(W ). By deﬁnition, there exists g ∈ R0(Rn) such that g|W = f |W . We
denote by g0 the regulous function g|W . We consider the following sequence of regulous functions

(g0, g1 = (g0)|indet(g0), g2 = (g1)|indet(g1), . . .)

on a sequence of Zariski closed subsets (Wi = indet(gi−1)) of W of dimension strictly decreasing and
included one in another. The functions gi are regulous since they are also a restriction of a regulous
function on Rn. We claim that there exists an integer m such that gm is a regular function on Wm.
Indeed, gm is automatically regular if dim Wm = 0 and we get the claim since dim Wi+1 < dim Wi.
By [4, Prop. 3.2.3], gm is the restriction to Wm = indet(gm−1) of regular function ˆgm on Rn. By
Lemma 2.15 for f = gm−1, X = Wm−1 and W = Wm, we get that gm−1 is the restriction to Wm−1
of a regulous function ˆgm−1 on Rn regular on Rn \ indet(gm−1). Using Lemma 2.15 several times, we
get that g0 = f |W is the restriction to W of a regulous function ˆg0 on Rn regular on Rn \ indet(f |W ).
Since indet(f |W ) ⊂ indet(f ) = W , using one last time Lemma 2.15, we get the proof.
(cid:3)

Proposition 2.17. ([7, Prop. 8])
Let X ⊂ Rn be a real algebraic set and let f ∈ R0(X). For any irreducible real algebraic subset
W ⊂ X not contained in the singular locus of X, we have

f |W ∈ R0(W ).

Theorem 2.18. ([7, Prop. 8, Thm. 10])
Let X ⊂ Rn be a smooth real algebraic set. Then the map φ0

0 : R0(X) ֒→ R0(X) is a ring isomorphism.
Proof. By [7, Prop. 8], a rational continuous function on a smooth real algebraic set is hereditarily
rational. By [7, Thm. 10], a continuous hereditarily rational function on a non necessary smooth real
algebraic set X ⊂ Rn is the restriction of rational continuous function on Rn and thus “continuous
hereditarily rational” means “regulous”.
(cid:3)

We extend the result of Theorem 2.18 to real algebraic sets with isolated singularities using Lemma

2.16.

Theorem 2.19. Let X ⊂ Rn be a real algebraic set with only isolated singularities. Then

R0(X) = R0(X).

Proof. Let f ∈ R0(X). Let W ⊂ X be a real algebraic subset. If dim W = 0 then f |W is regular
and thus f |W ∈ R0(W ).
If W is irreducible and dim W ≥ 1 then f |W ∈ R0(W ) by Proposition
2.17. It follows that f |W ∈ R0(W ) without hypothesis on W . We consider the following sequence of
continuous rational functions

(f0 = f, f1 = f |indet(f ), f2 = (f1)|indet(f1), . . .)

on a sequence of real algebraic subsets (Wi = indet(fi−1)) of X of dimension strictly decreasing and
included one in another. There exists an integer m such that fm is regular on Wm. Using several
times Lemma 2.16, we get that f ∈ R0(X).
(cid:3)

6

J.-P. MONNIER

Corollary 2.20. Let X ⊂ Rn be a real algebraic curve. Then

R0(X) = R0(X).

3. Integral closure of the ring of rational continuous functions

3.1. Blow-regular functions on central real algebraic sets. By [12, thm. 3.11], regulous func-
tions on a smooth real algebraic set X ⊂ Rn coincide with blow-regular functions on X, it gives
another equivalent deﬁnition for regulous functions on X.
Deﬁnition 3.1. Let X ⊂ Rn be a smooth real algebraic set. Let f : X → R be a real function. We
say that f is regular after blowings-up on X if there exists a composition π : M → X of successive
blowings-up along smooth centers such that f ◦ π is regular on M . We denote by B(X) the ring of
blow-regular functions of X.

Theorem 3.2. [12, thm. 3.11]
Let X ⊂ Rn be a smooth real algebraic set. We have R0(X) = B(X).

Now we will give a deﬁnition of blow-regular function for a non-necessarily smooth real algebraic

set.
Deﬁnition 3.3. Let X ⊂ Rn be a central real algebraic set. Let B(X) denote the ring of real functions
f deﬁned on X such that, there exists a resolution of singularities π : ˜X → X such that the composite
f ◦ π is in B( ˜X) = R0( ˜X) = R0( ˜X). A f ∈ B(X) is called a “blow-regular function” on X.
Remark 3.4. Using the deﬁnition of blow-regular function on a smooth variety we get: f ∈ B(X)
if and only if f is a real function deﬁned on X such that there exists a resolution of singularities
π : ˜X → X such that f ◦ π is regular. This justiﬁes the notation “blow-regular”.

Remark 3.5. In the deﬁnition 3.3 we can change ∃ by ∀. It is not true in the equivalent deﬁnition of
the remark 3.4.

We prove in the following that, even in the singular case, blow-regular functions and rational

continuous functions coincide.
Proposition 3.6. Let X ⊂ Rn be a central real algebraic set. We have

B(X) = R0(X).

Proof. Assume f ∈ R0(X) and let π : ˜X → X be a resolution of singularities. Then clearly f ◦ π is
rational on ˜X. Moreover, we have π−1(X) = ˜X since π−1(X) is a closed set for the strong topology
and contains the Zariski open subset π−1(Xreg). We can conclude that f ◦ π is continuous on ˜X and
thus f ◦ π ∈ R0( ˜X).

Assume f ∈ B(X) and let π : ˜X → X be a resolution of singularities. Then f ◦ π ∈ R0( ˜X) and
thus f is rational on X. Moreover, f is continous on X since f ◦ π is continuous on ˜X and since the
strong topology on X is the quotient topology induced by the strong topology on ˜X (the function
f ◦ π is constant on the ﬁbers of π and thus gives rise of a rational continuous function on X and this
function is obviously f ).
(cid:3)

3.2. Integral closure. We begin by recalling some classical results on the integral closure of some
ring of polynomial functions and regular functions on real algebraic sets.

In the following, we will denote by A the integral closure of an integral domain A in its ﬁeld of

fractions.

Let X ⊂ Rn be a real algebraic set. We say that X is “geometrically smooth” if the associated

complex algebraic set XC = X ×Spec R Spec C is smooth.
Proposition 3.7. Let X ⊂ Rn be a geometrically smooth irreducible real algebraic set. Then P(X)
is integrally closed in K(X).

SEMI-ALGEBRAIC GEOMETRY WITH RATIONAL CONTINUOUS FUNCTIONS

7

Proof. It is well-known that if XC is smooth then P(XC) is integrally closed in K(XC) (see [17, thm.
1 Ch. 2 Sect. 5] for example). Hence P(X) is also integrally closed in K(X).
(cid:3)

Example 3.8. The following real algebraic curve X = Z(y2 − (x2 + 1)2(x − 1)) is smooth but not
geometrically smooth. The ring P(X) (instead of O(X)) is not integrally closed in K(X) since the
non-polynomial but regular function f =

is integral on P(X) since f 2 − (x − 1) = 0.

y

x2 + 1

Proposition 3.9. Let X ⊂ Rn be a smooth irreducible real algebraic set. Then O(X) is integrally
closed in K(X).

Proof. By [4, 3.3.6, 3.3.7], for any x ∈ X the local ring OX,x of germs of regular functions at x is
integrally closed in K(X). Therefore

O(X) = \x∈X

OX,x ⊂ \x∈X

OX,x = \x∈X

OX,x = O(X).

(cid:3)

Proposition 3.10. Let X ⊂ Rn be an irreducible real algebraic set. If P(X) is integrally closed in
K(X) then O(X) is also integrally closed in K(X).

Proof. By [4, prop. 3.2.3], O(X) = S−1 P(X) where S is the multiplicative part of P(X) of polynomial
functions that do not vanish on X. We get the proof using [2, prop. 5.12].
(cid:3)
Theorem 3.11. Let X ⊂ Rn be a smooth irreducible real algebraic set. Then R0(X) = R0(X) is
integrally closed in K(X).
Proof. Assume f ∈ K(X)∗ and there exist d ∈ N∗ and ai ∈ R0(X), i = 0, . . . , d − 1 such that

f d + ad−1f d−1 + · · · + a0 = 0

in K(X). It means that there exists a non-empty Zariski open subset U of X such that ∀x ∈ U we
have f d(x) + ad−1(x)f d−1(x) + · · · + a0(x) = 0. By Proposition 3.6, there exists a composition of
blowings-up with smooth centers π : Y → X such that ˜ai = ai ◦ π is regular on Y for i = 0, . . . , d − 1.
Then f ◦ π is a rational function on Y which is integral on O(Y ). Since Y is smooth then O(Y ) is
integrally closed in K(Y ) (Proposition 3.9) and thus f ◦ π can be extended to a regular function ˜f on
Y . Obviously, we have ∀y ∈ Y ˜f d(y) + ˜ad−1(y) ˜f d−1(y) + · · · + ˜a0(y) = 0. Let x ∈ X. Since each ˜ai
is constant on π−1(x) and π−1(x) is connected then ˜f is constant on π−1(x) using the continuity of
˜f d + ˜ad−1 ˜f d−1 + · · · + ˜a0. Hence it gives a real continuous function g on X such that ˜f = g ◦ π and g
is a continuous extension to X of f .
(cid:3)

We can extend the previous result to some singular cases.

Theorem 3.12. Let X ⊂ Rn be a central irreducible real algebraic set such that there exists a resolution
of singularities π : ˜X → X such that ∀x ∈ X the ﬁber π−1(x) is connected. Then R0(X) is integrally
closed in K(X).
Proof. Assume f ∈ K(X)∗ there exist d ∈ N∗ and ai ∈ R0(X), i = 0, . . . , d − 1 such that

f d + ad−1f d−1 + · · · + a0 = 0

in K(X). Let π : ˜X → X a resolution of singularities such that ∀x ∈ X the ﬁber π−1(x) is connected.
By the previous theorem, f ◦ π can be extended continuously to ˜X as a regulous function ˜f ∈ R0( ˜X).
We get the proof since ˜f will be constant on each ﬁber of π (the ﬁbers are connected and ∀i the
regulous function ai ◦ π is constant on each ﬁber).
(cid:3)
Example 3.13. Let X be the cuspidal plane curve given by y2 − x3 = 0. By Theorem 3.12 we know
that R0(X) = R0(X) is integrally closed.

8

J.-P. MONNIER

y
x

Example 3.14. Let X be the nodal plane curve given by y2 − (x + 1)x2 = 0. The rational function
is integral on O(X) (and also on R0(X)) since f 2 − (x + 1) = 0 on X \ {(0, 0)}. It is easy
f =
to see that f cannot be extended continuously to whole X. Hence R0(X) = R0(X) is not integrally
closed. Of course the ﬁber over the node is never connected when we solve the node.

Looking at the previous examples, we want to prove that for singular curves, the hypothesis on the
ﬁbers made in the statement of Theorem 3.12 is a necessary hypothesis to get that the ring of rational
continuous functions is integrally closed.

Let X ⊂ Rn be an irreducible real algebraic set. Let P( ˜X) be the integral closure of the coordinate
ring P(X) in K(X). So P( ˜X) is the coordinate ring of an irreducible normal real algebraic set ˜X
called the normalisation of X (we say that an irreducible real algebraic set Y ⊂ Rn is normal if P(Y )
is integrally closed in K(Y )). Obviously X and ˜X are birationally equivalent real algebraic sets and
we have a (regular) “normalization” map π : ˜X → X induced by the injection P(X) ֒→ P( ˜X). Assume
now X is central, the normalisation map induces an injective ring morphism

π0 : R0(X) ֒→ R0( ˜X), f 7→ f ◦ π.

The hypothesis that X is central is necessary because it ensures that R0(X) injects into K(X) (Propo-
sition 2.5). Remark that, if in addition X is a curve, then the situation is simpler because then
R0(X) = R0(X) and R0( ˜X) = R0( ˜X) = O(X) since ˜X is smooth.

If a ﬁber of the normalisation map is not connected then we prove that the ring of rational continuous

functions is not integrally closed.
Proposition 3.15. Let X ⊂ Rn be a central irreducible real algebraic set. Let π : ˜X → X be the
normalization map. If there exists x ∈ X such that the ﬁber π−1(x) is not connected then R0(X) is
not integrally closed in K(X) and moreover the injective map π0 : R0(X) ֒→ R0( ˜X) is not surjective.

Proof. We know that the ﬁbers of π are ﬁnite since π is a ﬁnite map. Assume there exists x ∈ X
such that we have {y1, y2} ⊂ π−1(x) and y1 6= y2. There exists p ∈ P( ˜X) such that p(y1) 6= p(y2).
Obviously p is integral on R0(X) and moreover p 6∈ π0(R0(X)) since p is not constant on the ﬁbers
of π.
(cid:3)
Theorem 3.16. Let X ⊂ Rn be a central irreducible real algebraic set. Let π : ˜X → X be the
normalization map. The map π0 : R0(X) ֒→ R0( ˜X) is an isomorphism if and only if ∀x ∈ X the ﬁber
π−1(x) is a point.
Proof. Assume that ∀x ∈ X the ﬁber π−1(x) is a point. Then any element of R0( ˜X) is rational on
X, continuous on ˜X and constant on the ﬁbers of π and so it gives a rational function on X that can
be extended continuously to X. Thus π0 is surjective. Using Proposition 3.15, the proof is done. (cid:3)

For curves, we know exactly when the ring of rational continuous functions is integrally closed (use

Theorem 3.12 and Theorem 3.16).
Theorem 3.17. Let X ⊂ Rn be a central irreducible real algebraic curve. Let π : ˜X → X be the
normalization map. The ring R0(X) is integrally closed in K(X) if and only if ∀x ∈ X the ﬁber
π−1(x) is a point.
Proposition 3.18. Let X ⊂ Rn be a central irreducible real algebraic curve. Let π : ˜X → X be the
normalization map. The integral closure of R0(X) in K(X) is R0( ˜X) = O( ˜X).
Proof. If f ∈ O( ˜X) then f is integral over O(X) [2, prop. 5.12] and thus over R0(X). The proof
follows from the fact that O( ˜X) is integrally closed in K(X) (Proposition 3.9).
(cid:3)

To end the section, we ask some questions:

Q1 : Let X ⊂ Rn be a central irreducible real algebraic set. Is the injective map φ0

0 : R0(X) → R0(X)

SEMI-ALGEBRAIC GEOMETRY WITH RATIONAL CONTINUOUS FUNCTIONS

9

integral?

Q2 : Let X ⊂ Rn be a central normal irreducible real algebraic set.
closed?

Is the ring R0(X) integrally

Concerning the question Q2 in the two-dimensional case, we know by Theorem 3.12 that the ring of
rational continuous functions is integrally closed if the ﬁbers over the singular points of a resolution of
singularities are connected. However, as we shall see in the following example, it may happen that the
exceptional set is not connected (for the strong topology) when we solve a singular point of a normal
surface.

Example 3.19. Let X be the real algebraic surface in R3 deﬁned by X = Z(z2 − xy(x2 − y2)). The
surface X is the double cover of the plane ramiﬁed along the union of four lines passing throught the
origin. The point (0, 0, 0) is the only singular point of XC and thus X is normal. Let ϕ : W → R3 be
the blowing-up of R3 at the origin. We have

W = {((x, y, z)(u : v : w) ∈ R3 × P2(R)| xv = yu, xw = zu, yw = zv}.

Let Y denote the strict transform of X by ϕ and E = ϕ−1((0, 0, 0)) ∩ Y . In the chart u 6= 0 i.e u = 1,

Y is given by 


y = xv
z = xw
w2 − vx2(1 − v2) = 0

and E is the line w = x = y = z = 0. Jacobi criterium gives

that E is the singular locus of Y . Let ψ : V → W be the blowing-up of W at E. The strict transform
˜X of Y by ψ is a resolution of X. Let F denote the exceptional curve ψ−1 ◦ ϕ−1((0, 0, 0)) ∩ ˜X . We can
also see ˜X as the double cover of the blowing-up of the plane at the origin ramiﬁed along the strict
transorms of the four lines. Hence FC (or its smooth completion) is an elliptic curve as the double
cover of P1 at four points and it is easy to see that F has two connected components.

4. Algebraically constructible functions

We make reminders on the theory of constructible and algebraically constructible functions due to
C. McCrory and A. Parusiński (see [14], [15]). This theory was used to study singular real algebraic
sets. We follow the deﬁnitions and the results given in [6].

Let S be a semi-algebraic set. A constructible function on S is a function f : S → Z that can be

written as a ﬁnite sum

ϕ = Xi∈I

mi 1Si

where for each i ∈ I, mi is an integer and 1Si is the characteristic function of a semi-algebraic subset
Si of S. The set of constructible functions on S provided with the sum and the product form a

commutative ring denoted by F (S). If ϕ = Pi∈I mi 1Si is a constructible function then the Euler

integral of ϕ on S is

ZS

ϕ dχ = Xi∈I

miχ(1Si)

where χ is the Euler characteristic with compact support. Let f : S → T be a continuous semi-
algebraic map and ϕ ∈ F (S). The pushforward f∗ϕ of ϕ along f is the function from T to Z deﬁned
by

It is known that f∗ϕ ∈ F (T ) and that f∗ : F (S) → F (T ) is a morphism of additive groups.

f∗ϕ(y) = Zf −1(y)

ϕ dχ.

10

J.-P. MONNIER

Let X ⊂ Rn be a real algebraic set. We say that a constructible function ϕ on X is algebraically

constructible if it can be written as a ﬁnite sum

ϕ = Xi∈I

mifi∗(1Xi)

where fi are regular maps from real algebraic sets Xi to X. Algebraically constructible functions on
X form a ring denoted by A(X). We say that a constructible function ϕ on X is strongly algebraically
constructible if it can be written as a ﬁnite sum

ϕ = Xi∈I

mi 1Xi

where Xi are real algebraic subsets of X. Strongly algebraically constructible functions on X form a
subring of A(X) denoted by AS(X). Let A be a ring of semi-algebraic functions on X. A (quadratic)
form on A is a ﬁnite family of elements of A denoted by < f1, . . . , fn > with fi ∈ A. We denote by
F Q(A) the ring of forms on A provided with the two operations ⊥ and ⊗:

< f1, . . . , fn >⊥< g1, . . . , gm >=< f1, . . . , fn, g1, . . . , gm >,

< f1, . . . , fn > ⊗ < g1, . . . , gm >=< f1g1, . . . , fng1, f1g2, . . . , fng2, . . . , fngm > .

Since A is a ring of semi-algebraic functions on X, we have a signature map

Λ : F Q(A) → F (X)

< f1, . . . , fn >7→ (x 7→ sign(f1(x)) + · · · + sign(fn(x))

which is a morphism of rings.

Parusiński and Szafraniec haved proved that algebraically constructible functions correspond to

sums of signs of polynomial functions.

Theorem 4.1. [16, Thm. 6.1]
Let X ⊂ Rn be a real algebraic set. Then

A(X) = Λ(F Q(P(X))) = Λ(F Q(O(X))).

We prove now that algebraically constructible functions correspond to sums of signs of regulous
functions. it is a very natural result since the topology generated by zero sets of regulous functions is
the algebraically constructible topology.

Theorem 4.2. Let X ⊂ Rn be a real algebraic set. Then

A(X) = Λ(F Q(R0(X))).

Proof. We make an induction on the dimension of X. If dim(X) = 0 then there is nothing to do since
regulous means regular.

Assume dim(X) > 0 and let f ∈ R0(X). Let W denote indet(f ). There exist p, q ∈ P(X) such
on dom(f ) and Z(q) = W . We have f |W ∈ R0(W ) and by induction there exists

that f =

p
q

h1, . . . , hn ∈ P(W ) such that Λ(< f |W >) = Λ(< h1, . . . , hn >). The polynomial functions hi are
restrictions of polynomial functions on X again denoted by hi. The proof is done since

Λ(< f >) = Λ(< pq >⊥< 1, −q2 > ⊗ < h1, . . . , hn >).

(cid:3)

In the next section, we will count the number of signs of polynomial functions we need in the sum

to be the sign of a regulous function.

We prove now that strongly algebraically constructible functions are exactly ﬁnite sums of charac-

teristic functions of regulous closed sets.

SEMI-ALGEBRAIC GEOMETRY WITH RATIONAL CONTINUOUS FUNCTIONS

11

Proposition 4.3. Let X ⊂ Rn be a real algebraic set. Then

AS(X) = { Xi∈I

mi 1Wi , I ﬁnite, mi ∈ Z, Wi ⊂ X regulous closed}.

Proof. Let W be a closed regulous subset of X. By [12, Thm. 4.1], there exist a ﬁnite stratiﬁcation
i) where Zi

W = `i∈I Si with Si Zariski locally closed subsets of X. It means that Si = Zi ∩ (X \ Z ′

i are real algebraic subsets of X. Then

and Z ′

1W = Xi∈I

1Si = Xi∈I

(1Zi(1X − 1

Z ′
i

)) = Xi∈I

(1Zi − 1

Zi∩Z ′
i

) ∈ AS(X).

(cid:3)

We characterize algebraically constructible functions using regulous closed sets and regulous maps.

Theorem 4.4. Let X ⊂ Rn be a real algebraic set. Then

A(X) = { Xi∈I

mifi∗(1Wi) , I ﬁnite, mi ∈ Z, Wi regulous closed, fi : Wi → X regulous map}.

Proof. By Proposition 4.3 and since f∗ is additive, it is suﬃcient to prove that f∗(1Y ) ∈ A(X) when
f : Y → X is a regulous map between two real algebraic sets. We make an induction on the dimension
of Y . If dim(Y ) = 0 then f is regular and there is nothing to prove. Assume dim(Y ) > 0. We may
also assume that Y is irreducible. By [12, Thm. 3.11], there exists a regular birational map π : ˜Y → Y
such that f ◦ π is a regular map (we solve the singularities of Y and then we use [12, Thm. 3.11]).
The birational map π is biregular from ˜Y \ π−1(Z) to Y \ Z with Z a real algebraic subset of Y of
positive codimension. Then

and f∗(1Z ) ∈ A(X) by the induction hypothesis.

(cid:3)

f∗(1Y ) = (f ◦ π)∗(1 ˜Y ) − (f ◦ π)∗(1

π−1(Z)) + f∗(1Z)

Now we look at sum of signs of rational continuous functions.
The proof of the next result is due to G. Fichou.

Proposition 4.5. Let X ⊂ Rn be a central real algebraic set. Let f ∈ R0(X) be a rational continuous
function on X. Then Z(f ) ∈ C.

Proof. Remark that Z(f ) is clearly a semi-algebraic set. Denote by A the C-closure of Z(f ) in X. We
want to show that A = Z(f ).

Let B be an irreducible C-component of A of maximal dimension, i.e of the same dimension d
⊂ Z(f ) where Reg B = {x ∈ B : dimx B =

as Z(f ). We are going to show that Reg B
d and B is smooth at x}. First, note that the dimension of Z(f ) ∩ B is also d. Actually

eucl

Z(f ) ∩ B

C

∪ Z(f ) \ B

C

C
= Z(f )

,

C

C

C

, so that B is included in Z(f ) ∩ B

and B is not included in Z(f ) \ B
dimension of Z(f ) ∩ B

. As a consequence the
is also d, and therefore the same holds for Z(f ) ∩ B (cf. [11], Remark 2.4).
Now let σ : ˜X → X be a resolution of the singularities of X such that f ◦ σ is regular on ˜X, as in
Proposition 3.6. We can assume moreover, performing more blowings-up if necessary, that σ restricts
to a resolution of the singularities of the Zariski closure of B in X. This is possible because B is
included in X, meaning that σ is surjective on X. By [11], there exists a connected component ˜B
of ˜X such that σ( ˜B) is equal to the Euclidean closure of Reg B. Note moreover that f vanishes on
a semi-algebraic subset of B of maximal dimension, so the same is true for f ◦ σ on ˜B. Since f ◦ σ
is regular and ˜B is irreducible (smooth and connected), then f ◦ σ vanishes on ˜B. As a consequence
Reg B

⊂ Z(f ).

eucl

12

J.-P. MONNIER

So the diﬀerence between Z(f ) and its C-closure A is of dimension strictly less than the dimension
d of Z(f ). Denote by C the C-closure of that diﬀerence, so that A = Z(f ) ∪ C, where C is a C-set of
dimension strictly less than d. Now, let D be one of the irreducible C-components of C of maximal
dimension (i.e. of dimension dim C).

Note that dim D ∩Z(f ) = dim D. Otherwise (as previously) one may replace in C the component D
by the C-closure of D ∩ Z(f ) which would be strictly smaller (notably in dimension), in contradiction
with the fact that dim D is maximal. Let us play the same game as previously: since D ⊂ X, there
exists a resolution of the singularities σ : ˜X → X of X such that f ◦ σ is regular on ˜X, and σ restricts
to a resolution of the singularities of the Zariski closure of D in X. By [11], there exists a smooth
connected real algebraic subset ˜D in ˜X such that σ( ˜D) = Reg D

eucl

.

For the same reason as before, f ◦ σ vanishes on ˜D so f vanishes on Reg D

, in contradiction with
the fact that D is an irreducible C-component of maximal dimension not included in Z(f ). Therefore
C = ∅ and the proof is achieved.
(cid:3)

eucl

Theorem 4.6. Let X ⊂ Rn be a central real algebraic set. Then

A(X) = Λ(F Q(R0(X))).

Proof. Let f ∈ R0(X), we have to prove Λ(< f >) ∈ A(X). Let Y = {(x, t) ∈ X × R | f (x) = t2}. By
Proposition 4.5, Y ∈ C i.e Y is a closed regulous subset of the central real algebraic set X × R. By
Proposition 4.3, 1Y ∈ AS(X × R). We get

Λ(< f >) = π∗(1Y ) − 1X ∈ A(X)

where π : X × R → X is the projection.

Example 4.7. We go back to Example 2.14. We have f =

have Λ(< f >) = Λ(< f 3 >) ∈ A(X).

x
y

∈ R0(X) \ R0(X) but f 3 ∈ R0(X). We

(cid:3)

5. Signs of regulous functions

Throughout this section X will denote a real algebraic subset of dimension d of Rn. By Theorem
4.4, the sign of a regulous function on X can be written as a sum of signs of polynomial functions on
X. The goal of this section is to give an upper bound depending on d, on the number of polynomial
functions needed in such representation.

Let f1, . . . , fm be semi-algebraic functions on X. In the rest of the paper, we will use the following

notation:

S(f1, . . . , fm) = {x ∈ X| f1(x) > 0, . . . , fm(x) > 0}
¯S(f1, . . . , fm) = {x ∈ X| f1(x) ≥ 0, . . . , fm(x) ≥ 0}.

If all the functions fi lie in a ring A of semi-algebraic functions, the set S(f1, . . . , fm) (resp. ¯S(f1, . . . , fm))
is called A-open basic (resp. A-closed basic). If m = 1, we replace “basic” by “principal”. If A = P(X)
then we omet A.

The zero-dimensional case is trivial since regulous means regular.

In the following example, we
prove that for curves the sign of a regulous function is not always the sign of a polynomial function.

Example 5.1. (Example 2.4)

Let X = Z(y2 − x2(x − 1)) and let f be the restriction to X of the plane regulous function 1 −

x2 + y2 .
The function f is zero on the one-dimensional connected component of X and has value 1 on the
isolated point of X. Clearly if a polynomial function g has the sign of f on the one-dimensional
connected component of X then g vanishes on whole X since X is Zariski irreducible. However the
sign of f is the sum of signs of two polynomial functions on X, more precisely we have Λ(< f >) =
Λ(< 1, −(x2 + y2) >) on X.

x3

SEMI-ALGEBRAIC GEOMETRY WITH RATIONAL CONTINUOUS FUNCTIONS

13

The pathology of the previous example is the fact that the curve is Zariski irreducible but C-
reducible i.e the fact that X is not central since dim(X) = 1 (see [12]). We will prove now that, under
the hypothesis that the curve is central, the sign of a regulous function coincide with the sign of a
polynomial function.

We will use several times the following lemma which is a consequence of Łojasiewicz inequality.

Lemma 5.2. [3, Lem. 7.7.10]
Let S be a closed semi-algebraic subset of X. Let f, g ∈ P(X). There exist p, q ∈ P(X) such that
p > 0 on X, q ≥ 0 on X, Λ(< pf + qg >) = Λ(< f >) on S and Z(q) = Z(f ) ∩ S

Zar

.

Proposition 5.3. Assume dim(X) = 1 and X is central. Let f ∈ R0(X). There exists h ∈ P(X)
such that Λ(< h >) = Λ(< f >) on X.

Proof. By [5], any open semi-algebraic subset of X is principal and thus there exists p1 ∈ P(X)
such that S(f ) = S(p1). Since X is central then the Zariski irreducible components of X correspond
exactly to the C-irreducible components of X and thus Z(f ) is Zariski closed (see [12], a C-irreducible
component of dimension 1 of Z(f ) is necessarily Zariski irreducible). So we can multiply p1 by the
square of a polynomial equation of Z(f ) and we get:

S(f ) = S(p1) and Z(f ) ⊂ Z(p1).

Zar

Similarly there exists p2 ∈ P(X) such that S(−f ) = S(−p2). Let S denote the closed semi-algebraic
set ¯S(f ). By Lemma 5.2, there exist p, q ∈ P(X) such that p > 0 on X, q ≥ 0 on X, Λ(< pp1+qp2 >) =
Λ(< p1 >) on S and Z(q) = Z(p1) ∩ S
. Let h denote the polynomial function pp1 + qp2. We want
to prove that Λ(< h >) = Λ(< f >) on X. We have Λ(< h >) = Λ(< p1 >) = Λ(< f >) on S since
S(f ) = S(p1) and since Z(f ) ⊂ Z(p1). Assume now x 6∈ S. So f (x) < 0 and thus p2(x) < 0 (since
S(−f ) = S(−p2)), p1(x) ≤ 0 (since ¯S(−f ) = ¯S(−p1)). The proof is done if we prove that q(x) > 0
since in that case we would have h(x) < 0. We have S ∩ Z(p1) = ¯S(f ) ∩ Z(p1) ⊂ Z(f ) ∩ Z(p1) = Z(f )
since S(f ) = S(p1) (you can not have simultaneously f (y) > 0 and p1(y) = 0). We have already
noticed that Z(f ) is Zariski closed, hence

Z(q) = Z(p1) ∩ S

Zar

Zar

⊂ Z(f )

= Z(f )

and it follows that x 6∈ Z(q).

(cid:3)

Remark 5.4. We have the same result if we replace “X is central” by “Z(f ) is Zariski closed” in the
hypotheses of Proposition 5.3. Look at Theorem 6.8 for a generalization of Proposition 5.3 in any
dimension and in the case Z(f ) is Zariski closed.

Example 5.5. Let X = Z(x2 − y3) ⊂ R2 be the cuspidal curve and let f =
f ∈ R0(X) \ P(X) but Λ(< f >) = Λ(< x >) on X.

y2
x

|X. We have

Proposition 5.6. Assume dim(X) = 1 and let f ∈ R0(X). There exist h1, h2 ∈ P(X) such that
Λ(< h1, h2 >) = Λ(< f >) on X.

Proof. By the previous results we may assume X is not central and Z(f ) is not Zariski closed. We also
eucl

assume that X is irreducible to simplify the proof. By [12], X = F `{x1, . . . , xm} where F = Xreg

is the one-dimensional irreducible regulous component of X and x1, . . . , xm are the isolated points of
X. Since Z(f ) is not Zariski closed, we must have dim Z(f ) = 1 and thus F ⊂ Z(f ) (see [12]). For
each xi let pi ∈ P(X) such that pi ≥ 0 on X and Z(pi) = {xi}. We set h1 to be the product of the
pi such that f (xi) ≤ 0 and h2 to be the (−1)× the product of the pi such that f (xi) ≥ 0. For this
choice of h1 and h2, we get the proof.
(cid:3)

14

J.-P. MONNIER

Deﬁnition 5.7. Let f ∈ R0(X).
We set f0 = f , X0 = X and X1 = indet(f0).
If X1 6= ∅ i.e if f0 is not regular on X0 then we set f1 = f0|X1 ∈ R0(X1) and X2 = indet(f1).
Repeating the process it will stop after at most d steps since dim(Xi+1) < dim(Xi) and Xi+1 = ∅ if
dim Xi = 0.
At the step of index i we associate to the regulous function fi on Xi a rational representation (pi, qi) ∈
P(X) × P(X) such that fi =

on Xi \ Xi+1.

pi
qi

The following sequence

((f0, X0, p0, q0), . . . , (fk, Xk, pk, qk))

is called a “polar sequence” associated to f . We have Xi 6= ∅ for i = 1, . . . , k and Xk+1 = ∅ i.e fk is
regular on Xk.
The number k of the previous sequence is called the “polar depth” of f and denoted by poldepth(f ).
Remark 5.8. If f ∈ R0(X) then obviously poldepth(f ) ≤ d.
Proposition 5.9. If f ∈ R0(X) then codim(indet(f ) \ Sing(X)) ≥ 2.

Proof. We may assume X is irreducible and suppose dim((indet(f ) \ Sing(X)) = d − 1. Under this
hypothesis there exists a resolution of singularities π : ˜X → X of X and also of indet(f ) such that
˜f = f ◦π ∈ R0( ˜X), indet( ˜f ) = Z where Z is the strict transform of indet(f ) and dim Z = d−1. Let W
be an irreducible component of Z of dimension d − 1. Since the local ring O ˜X,W is a discrete valuation
ring, we may write the rational function ˜f = tmu with t an uniformizing parameter of O ˜X,W , m < 0
and u a unit of O ˜X,W . There exists a Zariski open subset U of W where u doesn’t vanish and thus it
is impossible to extend continuously the rational function tmu to W , it gives a contradiction.
(cid:3)
Proposition 5.10. Let X ⊂ Rn be a real algebraic set of dimension d. Let f ∈ R0(X), k =
poldepth(f ) and ((f0, X0, p0, q0), . . . , (fk, Xk, pk, qk)) a “polar sequence” associated to f . Then

Λ(< f >) = Λ(< p0q0 >⊥k

i=1 (< 1, −q2

i−1 > ⊗ < piqi >)).

Therefore, we may write the sign of f on X as the sum of l signs of polynomial functions on X with

l ≤ 1 + 2 poldepth(f ).

Proof. The proof is straightforward since we have
Λ(< f >) = Λ(< p0q0 >⊥j

i=1 (< 1, −q2

i−1 > ⊗ < piqi >))

on X \ Xj+1 for j = 1, . . . , k and Xk+1 = ∅.

It follows from Proposition 5.10 and Proposition 5.6:

(cid:3)

Theorem 5.11. Let X ⊂ Rn be a real algebraic set of dimension d. Let f ∈ R0(X). We may write
the sign of f on X as the sum of l signs of polynomial functions on X with

l = 1 if d = 0,

l ≤ 2 if d = 1,
l ≤ 2d + 1 else.

In the next section, we will improve the result of Theorem 5.11 in the two dimensional case.
It follows from Proposition 5.10, Proposition 5.3 and Proposition 5.9:

Theorem 5.12. Let X ⊂ Rn be a real algebraic set of dimension d such that codim(Sing(X)) > 1.
Let f ∈ R0(X). We may write the sign of f on X as the sum of l signs of polynomial functions on X
with

l = 1 if d = 0 or 1,

l ≤ 2d − 1 else.

SEMI-ALGEBRAIC GEOMETRY WITH RATIONAL CONTINUOUS FUNCTIONS

15

In the next section, we will improve the result of Theorem 5.12 in the three dimensional case.

Example 5.13. We prove the optimality of the bound given in Theorem 5.12 for X = R2. Consider

x3

the regulous function f = −1 +

x2 + y2 . We have a partition R2 = E−1` E0` E1 of R2 where Ei is

the semi-algebraic subset of R2 where Λ(< f >) = i. We can not write Λ(< f >) = Λ(< h >) with
h ∈ R[x, y] since E0 is not Zariski closed.
We can not write Λ(< f >) = Λ(< h1, h2 >) with h1, h2 ∈ R[x, y] since it would imply that h1h2
vanishes on E−1 ∪ E1 and thus vanishes on whole R2.
Following the statement of Proposition 5.10, we get

Λ(< f >) = Λ(< −x2 − y2 + x3, −1, x2 + y2 >).

6. Regulous principal semi-algebraic sets

Let X ⊂ Rn be a real algebraic set of dimension d. In this section we study the following question:
Is a regulous principal open semi-algebraic subset of X a principal open semi-algebraic subset of X?
Remark ﬁrst that it is equivalent to same question but for a closed subset by taking the complementary
set. If d = 0 the answer is trivially “yes”. For d = 1 the answer is also “yes” by [5] since in this case
any open (resp. closed) semi-algebraic subset of X is principal.

For d = 2 the answer can be negative:

Example 6.1. As usual consider X = R2 and f = 1 −

x3

x2 + y2 . Let S = S(f ). Since S ∩ Bd(S)

Zar

=

{(0, 0)} 6= ∅ then S cannot be basic [5, Prop. 2.2] (Bd(S) = S

eucl

\ S).

In the following we will prove that under the topological condition “S ∩ Bd(S)

Zar

= ∅”, the answer

to the previous question, for the regulous principal open semi-algebraic set S, is “yes”.

Remark 6.2. Let f ∈ R0(X). Set S = S(f ) and assume f =

p
q
= ∅, we will prove in the following
Z(q) = indet(f ). If we assume in addition that S ∩ Bd(S)
that there exists r ∈ P(X) such that S = S(r) but it may happen that we can not choose r to

on dom(f ) with p, q ∈ P(X) and

Zar

be equal to pq. Consider X = R2, f =

y2 + x2(1 − x)2

x2 + y2

=

p
q

. We have S = S(f ) = R2 \{(1, 0)},

Zar

Bd(S)

= {(1, 0)} and S(pq) = R2 \{(1, 0), (0, 0)}.

We will use several times the following consequence of Hörmander-Łojasiewicz inequality.

Lemma 6.3. [1, Prop. 1.16, Chap. 2]
Let C be a closed semi-algebraic subset of X and let f, g ∈ P(X) such that Z(f ) ∩ C ⊂ Z(g). There
exist h ∈ P(X) and l ∈ N odd such that

Λ(< (1 + h2)f + gl >) = Λ(< f >)

on C.

Theorem 6.4. Let f ∈ R0(X) and S = S(f ). There exists r ∈ P(X) such that

S(r) ⊂ S and S \ S(r) ⊂ Bd(S)

Zar

∩ indet(f ).

More precisely, if ((f0, X0, p0, q0), . . . , (fk, Xk, pk, qk)) is a polar sequence associated to f then, for
i = 0, . . . , k, there exists ri ∈ P(X) such that

S(ri) ∩ Xi ⊂ S ∩ Xi and (S \ S(ri)) ∩ Xi ⊂ Bd(S)

Zar

∩ Xi+1.

16

J.-P. MONNIER

Proof. We set Si = S ∩ Xi for i = 0, . . . , k. We make the proof by decreasing induction on i = k, . . . , 0.
• For i = k there is nothing to do since fk is regular on Xk.
• Assume i ∈ {0, . . . , k − 1} and there exists ri+1 ∈ P(X) such that

S(ri+1) ∩ Xi+1 ⊂ S ∩ Xi+1 and (S \ S(ri+1)) ∩ Xi+1 ⊂ Bd(S)

Zar

∩ Xi+2.

Let F denote the closed semi-algebraic subset of Xi deﬁned by F = S(ri+1) ∩ Xi

eucl

∩ (Xi \ Si).

We have

(1)

Xi+1 ∩ F ⊂ Z(ri+1) ∩ Xi.

If x ∈ Xi+1 ∩ F then x ∈ Xi+1 and x 6∈ Si ∩ Xi+1 = Si+1. By induction hypothesis we have
S(ri+1) ∩ Xi+1 ⊂ Si+1 and thus ri+1(x) ≤ 0. Since x ∈ S(ri+1) ∩ Xi
\
(S(ri+1) ∩ Xi) = Bd(S(ri+1) ∩ Xi) i.e ri+1(x) = 0 and it proves (1).

then x ∈ S(ri+1) ∩ Xi

eucl

eucl

Since Xi+1 = Z(−q2
i+1 = (1 + h′2)(−q2
r′
then r′

i ) then Lemma 6.3 provides us h′ ∈ P(X), l′ an odd positive integer such that
i ) + rl′
i+1 = ri+1 on Xi+1

i >) on F . Since r′

i+1 >) = Λ(< −q2

i+1 veriﬁes Λ(< r′

i+1 satisﬁes the same induction hypotheses than ri+1 namely

(2)

and

(3)

S(r′

i+1) ∩ Xi+1 ⊂ Si+1

(Si+1 \ S(r′

i+1)) ⊂ Bd(S)

Zar

∩ Xi+2.

We claim that r′

(4)

i+1 satisﬁes the third property
S(r′

i+1) ∩ Xi ⊂ Si.

If x ∈ S(r′
sign of −q2

i+1) ∩ Xi then ri+1(x) must be > 0 and if x 6∈ Si then x ∈ F and the sign of r′
i (x), which is impossible. We have proved (4).

i+1(x) is the

Zar

. Since fi ∈ R0(Xi)
i+1). By
i+1

We set C = Si

i+1) ∩ Xi). Let t ∈ P(X) such that Z(t) = Z(pi) ∩ C

eucl

\ (S(r′

then Z(qi) ∩ Xi ⊂ Z(pi) ∩ Xi [12, Prop. 3.5] and thus we get Z(piqi) ∩ C ⊂ Z(t) ⊂ Z(t2r′
Lemma 6.3, there exist h ∈ P(X) and l an odd positive integer such that ri = (1 + h2)piqi + t2lr′l
veriﬁes Λ(< ri >) = Λ(< piqi >) on C. We prove now that ri is the function we are looking for.

Assume x ∈ Xi \ Si. If x ∈ Xi+1 then pi(x)qi(x) = 0, else x ∈ Xi \ (Si ∪ Xi+1) and the sign of
i+1(x) ≤ 0 and thus ri(x) ≤ 0. We

pi(x)qi(x) is the sign of fi(x); thus pi(x)qi(x) ≤ 0. By (4) we get r′
have proved that

(5)

We have to prove

(6)

S(ri) ∩ Xi ⊂ Si.

(Si \ S(ri)) ∩ Xi ⊂ Bd(S)

Zar

∩ Xi+1.

i+1(x) ≥ 0 then ri(x) > 0.
Assume x ∈ Si \ Xi+1. We have fi(x) =
If r′
i+1(x) < 0 then x ∈ C and we know that the sign of ri(x) is the sign of pi(x)qi(x). We have proved
that Si \ Xi+1 ⊂ S(ri) ∩ (Xi \ Xi+1) and by (5) then Si \ (S(ri) ∩ Xi) ⊂ Xi+1. So in order to prove
(6) we are left to prove

and thus pi(x)qi(x) > 0. If r′

pi(x)
qi(x)

(7)

We ﬁrst establish

(8)

Si+1 \ (S(ri) ∩ Xi+1) ⊂ Bd(S)

Zar

∩ Xi+1.

Z(pi) ∩ C ∩ Xi+1 ⊂ Bd(S)

Zar

∩ Xi+1.

SEMI-ALGEBRAIC GEOMETRY WITH RATIONAL CONTINUOUS FUNCTIONS

17

Assume y ∈ Z(pi) ∩ C ∩ Xi+1. Then pi(x)qi(x) = 0, y ∈ Si
y ∈ Si+1 then y ∈ Si+1 \ (S(r′
y ∈ (Si

i+1) ∩ Xi+1) ⊂ Bd(S)
Zar

\ Si) ∩ Xi+1 ⊂ Bd(Si) ∩ Xi+1 ⊂ Bd(S)

eucl

Zar

∩ Xi+1. We get (8).

eucl

∩ Xi+1 and r′

i+1(y) ≤ 0. Hence if
∩ Xi+2. If y 6∈ Si+1 then y 6∈ Si and thus

Finally we prove (7). Assume x ∈ Si+1 \ (S(ri) ∩ Xi+1). On Xi+1 we have ri = t2lr′l
Zar

then x ∈ Si+1 \ (S(r′
(3). So we assume x ∈ Z(t). By (8) it follows that Z(t) ∩ Xi+1 ⊂ Bd(S)
x ∈ Bd(S)

i+1) ∩ Xi+1) and thus we get x ∈ Bd(S)

∩ Xi+2 ⊂ Bd(S)
Zar

i+1. If x 6∈ Z(t)
∩ Xi+1 using
∩ Xi+1 and thus
(cid:3)

Zar

Zar

∩ Xi+1.

Remark 6.5. In the previous theorem, it is not diﬃcult to see that we also have

and

S(f ) \ S(r) ⊂ Bd(S(r)) ⊂ Z(r)

eucl

S(f )

eucl

= S(r)

.

It follows from Theorem 6.4 that:

Theorem 6.6. Let f ∈ R0(X) and S = S(f ). Then S is a principal open semi-algebraic set if and
only if S ∩ Bd(S)

= ∅.

Zar

Corollary 6.7. Let f ∈ R0(X) such that Z(f ) is Zariski closed. Then S(f ) is a principal semi-
algebraic set.

Proof. Assume Z(f ) is Zariski closed. Since Bd(S(f )) ⊂ Z(f ), we get S(f ) ∩ Bd(S(f ))
Z(f )

= S(f ) ∩ Z(f ) = ∅. We get the conclusion using Theorem 6.6.

Zar

Zar

⊂ S(f ) ∩

(cid:3)

We can use Corollary 6.15 to improve some of the results of the previous section concerning the

sum of signs of regulous functions.

We extend the result of Proposition 5.3 (see Remark 5.4), which concerns curves, to any real

algebraic set of any dimension.

Theorem 6.8. Let f ∈ R0(X). Then Z(f ) is Zariski closed if and only if there exists p ∈ P(X) such
that Λ(< f >) = Λ(< p >) on X.

Proof. The proof of the “if” is trivial.

Assume Z(f ) is Zariski closed. By Corollary 6.15, there exist p1, p2 in P(X) such that S(f ) = S(p1)
(cid:3)

and S(−f ) = S(p2). Copy now the end of the proof of Proposition 5.3 to conclude.
Corollary 6.9. Let f ∈ R0(X), k = poldepth(f ) and ((f0, X0, p0, q0), . . . , (fk, Xk, pk, qk)) a “polar
sequence” associated to f . Let

Therefore, we may write the sign of f on X as the sum of l signs of polynomial functions on X with

t = min{i ∈ {0, . . . , k}| Z(f ) ∩ Xi is Zariski closed}.

l ≤ 1 + 2t.

Proof. The proof is straightforward using Proposition 5.10 and Theorem 6.8.

(cid:3)

its intersection with the polar locus is Zariski closed. Consider f = z −

Example 6.10. It may happen that the zero set of a regulous function is not Zariski closed but
x2 + y2 ∈ R0(R3). So
x2 + y2 ) ⊂ R3 is the “canopy” of the Cartan umbrella V = Z(z(x2 + y2) − x3) ⊂ R3. Moreover,

Z(z −

x3

x3

indet(f ) is the stick of the umbrella and Z(f ) ∩ indet(f ) = {(0, 0, 0)}.

18

J.-P. MONNIER

Figure 3. Cartan umbrella.

In the following proposition, we improve the result of Theorem 5.11 in the two dimensional case

and the result of Theorem 5.12 in the three dimensional case.

Proposition 6.11. Assume d = dim(X) ≤ 3 and moreover that codim(Sing(X)) > 1 in the case
d = 3. Let f ∈ R0(X). We may write the sign of f on X as the sum of at most 3 signs of polynomial
functions on X.

Proof. By Theorems 5.11 and 5.12, we may assume that d = 2 or d = 3 and also that codim(Sing(X)) >
1 in the case d = 3. By Proposition 5.9, we have dim(indet(f )) ≤ 1. We get the proof, using Corollary
6.9, if dim(indet(f )) < 1 or if Z(f ) ∩ indet(f ) is Zariski closed. So we assume dim(indet(f )) = 1 and
on dom(f ) with p, q ∈ P(X) and Z(q) = indet(f ).
Z(f )∩indet(f ) is not Zariski closed. We write f =

p
q

We decompose Z(q) = indet(f ) as a union C1 ∪ · · · ∪ Ct ∪ W where the Ci are irreducible real alge-
C
braic curves and dim(W ) = 0. For each curve Ci, we denote by Fi the regulous closed set (Ci)reg
.
By [12, Thm. 6.7], the sets Fi are C-irreducible and Ci \ Fi is empty or a ﬁnite set of points. Since
Z(f )∩indet(f ) is not Zariski closed, we have dim(Z(f )∩indet(f )) = 1. Since the Fi are C-irreducible,
we get that Fi ⊂ Z(f ) if and only if dim(Z(f ) ∩ Ci) = 1. Remark that there exists at least one Fi
such that Fi ⊂ Z(f ) but Ci 6⊂ Z(f ) since Z(f ) ∩ indet(f ) is not Zariski closed. If Fi ⊂ Z(f ) then
Λ(< f >) = Λ(< pq >) on Ci outside a ﬁnite number of points. If Fi 6⊂ Z(f ) then Z(f ) ∩ Ci is Zariski
closed. It follows that there exists a real algebraic subset Y of indet(f ) such that Z(f ) ∩ Y is Zariski
closed and such that Λ(< f >) = Λ(< pq >) on X \ Y . By Theorem 6.8, there exists h ∈ P(X) such
that Λ(< f >) = Λ(< h >) on Y . Let r ∈ P(X) be such that Z(r) = Y . The proof is done since

Λ(< f >) = Λ(< pq >⊥< 1, −r2 > ⊗ < h >) on X.

(cid:3)

To end this section, we will give an answer to the following question: Under which conditions an

open semi-algebraic set is regulous principal?

Deﬁnition 6.12. A semi-algebraic subset S of X is said to be generically principal on X if S coincides
with a principal open semi-algebraic subset of X outside a real algebraic subset of X of positive
codimension.

The next result is a regulous version of Lemma 6.3.

SEMI-ALGEBRAIC GEOMETRY WITH RATIONAL CONTINUOUS FUNCTIONS

19

Lemma 6.13. Let C be a closed semi-algebraic subset of X and let f, g ∈ R0(X) such that Z(f )∩C ⊂
Z(g). There exist h ∈ P(X) and l ∈ N odd such that h > 0 on X and

Λ(< hf + gl >) = Λ(< f >)

on C.

Proof. We can see C as a closed semi-algebraic subset of Rn and f, g ∈ R0(Rn) by deﬁnition of
regulous functions on X. By [4, Thm. 2.6.6], for a suﬃciently big positive odd integer l the function
gl
| is bounded on C by a polynomial
f
function h which is positive deﬁnite on Rn. The proof is done by restricting these functions to X. (cid:3)

is semi-algebraic and continuous on C. By [4, Thm. 2.6.2], |

gl
f

= ∅,

Proposition 6.14. Let S be a semi-algebraic subset of X such that:
C
1) S ∩ Bd(S)
and there exists an algebraic subset W of X of positive codimension such that:
2) there exists p ∈ P(X) such that S \ W = S(p) \ W ,
3) there exists g ∈ R0(X) such that S ∩ W = S(g) ∩ W .
Then there exists f ∈ R0(X) such that S = S(f ).

Proof. We may assume W ⊂ Z(p) changing p by q2p where q ∈ P(X) satisﬁes W = Z(q).

eucl

Set F = S(g)

\ S. Assume x ∈ W ∩ F then x ∈ W \ (S ∩ W ) and thus g(x) ≤ 0. Then
x ∈ Bd(S(g)) ⊂ Z(g). We have proved that Z(−q2)∩F ⊂ Z(g). By Lemma 6.13 there exist h ∈ P(X),
l ∈ N odd and g′ ∈ R0(X) such that h > 0 on X, g′ = −hq2 + gl and Λ(< g′ >) = Λ(< −q2 >) on F .
Clearly, the function g′ satisﬁes again the property 3) of the proposition, namely

(9)
The function g′ satisﬁes in addition the following property

S ∩ W = S(g′) ∩ W.

(10)
Assume g′(x) > 0 then g(x) > 0 and moreover if x 6∈ S then x ∈ F and we get a contradiction since
then the sign of g′(x) would be the sign of −q2(x). We have proved (10).

S(g′) ⊂ S.

eucl

C

Set C = S

\ S(g′). Let t ∈ R0(X) be such that Z(t) = Z(p) ∩ C

. We clearly have Z(p) ∩ C ⊂
Z(t2g′). By Lemma 6.13, there exist p′ ∈ P(X) positive deﬁnite on X and a positive odd integer l′
such that f = p′p + t2l′

satisﬁes Λ(< f >) = Λ(< p >) on C.

g′l′

Assume x 6∈ S. We have p(x) ≤ 0 since W ⊂ Z(p). We have g′(x) ≤ 0 by (10). Hence f (x) ≤ 0

and we have proved that

(11)

S(f ) ⊂ S.

Assume x ∈ S \ W . If g′(x) > 0 then clearly f (x) > 0. If g′(x) ≤ 0 then x ∈ C and f (x) > 0 since

Λ(< f >) = Λ(< p >) on C. We have proved that

(12)

S \ W ⊂ S(f ) \ W.

Since W ⊂ Z(p) and using (9) it follows that

(13)

We prove now that

(14)

(S ∩ W ) \ (S(f ) ∩ W ) ⊂ Z(t) = Z(p) ∩ C

C

.

Z(p) ∩ C ⊂ Bd(S).

∩ W and g′(y) ≤ 0. We have
Assume y ∈ Z(p) ∩ C ∩ W = W ∩ C. We have p(y) = 0, y ∈ S
y 6∈ S ∩ W by (9). Hence y ∈ Bd(S) ∩ W . Assume y ∈ Z(p) ∩ C and y 6∈ W . Since p(y) = 0 and
y 6∈ W then y 6∈ S. We get y ∈ S

since y ∈ C and it proves (14).

eucl

eucl

20

J.-P. MONNIER

From (12), (13) and (14) it follows that

S \ S(f ) ⊂ Z(p) ∩ C

C

C
∩ W ⊂ Bd(S)

∩ W.

Since S ∩ Bd(S)

C

= ∅ we ﬁnally get

S = S(f ).

(cid:3)

Theorem 6.15. Let X ⊂ Rn be a real algebraic set and let S be a semi-algebraic subset of X. Then
S is regulous open principal i.e there exists f ∈ R0(X) such that S = S(f ) if and only if we have:
1) for any real algebraic subset V of X then S ∩ V is generically principal,
and
2) S ∩ Bd(S)

= ∅.

C

Proof. If S = S(f ) with f ∈ R0(X) then S ∩ Bd(S)

C

C
= ∅ since Bd(S)

⊂ Z(f ).

Assume now the set S satisﬁes the conditions 1) and 2) of the theorem. We denote the set X by
X0 and S by S0. Since S0 is generically principal there exist p0 ∈ P(X0) and an algebraic subset X1
of X0 of positive codimension such that S0 \ X1 = S(p0) \ X1. If X1 = ∅ then we are done since S
is even algebraic open principal. If X1 6= ∅ then we denote by S1 the set S0 ∩ X1. Remark that S1
satisﬁes the conditions 1) and 2) of the theorem as an open semi-algebraic subset of X1 and we can
repeat the process used for S0 but here for the set S1. So we build a ﬁnite sequence

((X0, S0, p0), . . . , (Xk, Sk, pk))

such that for i = 0, . . . , k − 1, Xi+1 is an algebraic subset of Xi of positive codimension, Si = S ∩ Xi
satisﬁes the conditions 1) and 2), pi ∈ P(X), Si \Xi+1 = (S(pi)∩Xi)\Xi+1 and Sk = S ∩Xk = S(pk)∩
Xk with pk ∈ P(Xk). By Lemma 6.14, there exists gk−1 ∈ R0(X) such that Sk−1 = S(gk−1) ∩ Xk−1.
By successive application of Lemma 6.14, there exists gi ∈ R0(X) such that Si = S(gi) ∩ Xi for
i = k − 2, . . . , 0 i.e S is in particular regulous open principal.
(cid:3)

References

[1] C. Andradas, L. Bröcker, J.M. Ruiz, Constructible sets in real geometry, Springer, (1996)
[2] M. F. Atiyah, I. G. Macdonald, Introduction to commutative algebra, Reading: Addison-Wesley, (1969)
[3] J. Bochnak, M. Coste, M.-F. Roy, Géométrie algébrique réelle, Springer, (1987)
[4] J. Bochnak, M. Coste, M.-F. Roy, Real algebraic geometry, Springer, (1998)
[5] L. Bröcker, On basic semialgebraic sets, Exposition. Math. 9 (4), 289-334 (1991)
[6] M. Coste, Real algebraic sets in Arc spaces and additive invariants in real algebraic and analytic geometry,

Panor. Synthèses. Soc. Math. France 24, 1-32 (2007)

[7] J. Kollár, K. Nowak, Continuous rational functions on real and p-adic varieties, Math. Z. 279, 1-2, 85-97 (2015).
[8] W. Kucharz, Rational maps in real algebraic geometry, Adv. Geom. 9 (4), 517–539, (2009)
[9] W. Kucharz, K. Kurdyka, Stratiﬁed-algebraic vector bundles, arXiv:1308.4376v1 [math.AG]

[10] W. Kucharz, K. Kurdyka, Curve-rational functions, arXiv:1509.05905v1 [math.AG]
[11] K. Kurdyka, Ensembles semialgébriques symétriques par arcs, Math. Ann. 282, 445-462 (1988)
[12] G. Fichou, J. Huisman, F. Mangolte, J.-P. Monnier, Fonctions régulues, J. Reine angew. Math., DOI

10.1515/crelle-2014-0034, to appear.

[13] G. Fichou, J.-P. Monnier, R. Quarez Continuous functions on the plane regular after one blowing-up,

arXiv:1409.8223v1 [math.AG].

[14] C. McCrory, A. Parusiński, Algebraically constructible functions, Ann. Sci. Ecole Norm. Sup. 4e série 30, 527-552

(1997)

[15] C. McCrory, A. Parusiński, Topology of real algebraic sets of dimension 4: necessary conditions, Topology 39,

495-523 (2000)

[16] A. Parusiński, Z. Szafraniec, Algebraically constructible functions and signs of polynomials, Manuscripta Math.

93, 443-456 (1997)

[17] I R. Shafarevich, Basic algebraic geometry, Berlin: Springer-Verlag, (1974)

SEMI-ALGEBRAIC GEOMETRY WITH RATIONAL CONTINUOUS FUNCTIONS

21

Jean-Philippe Monnier, LUNAM Université, LAREMA, Université d’Angers
E-mail address: jean-philippe.monnier@univ-angers.fr

