Method for fast computation of angular light scattering

spectra from 2D periodic arrays

Jan Pomplun, a Sven Burger, ab Lin Zschiedrich, a Philipp Gutsche, ab Frank Schmidt ab

a JCMwave GmbH, Bolivarallee 22, D – 14 050 Berlin, Germany

b Zuse Institute Berlin (ZIB), Takustraße 7, D – 14 195 Berlin, Germany

6
1
0
2

 
r
a

 

M
4
1

 
 
]
s
c
i
t
p
o

.
s
c
i
s
y
h
p
[
 
 

1
v
9
6
1
4
0

.

3
0
6
1
:
v
i
X
r
a

This paper will be published in Proc. SPIE Vol. 9778 (2016) 977839 (Metrology, Inspection, and Process Con-
trol for Microlithography XXX, DOI: 10.1117/12.2219666) and is made available as an electronic preprint with
permission of SPIE. One print or electronic copy may be made for personal use only. Systematic or multiple
reproduction, distribution to multiple locations via electronic or other means, duplication of any material in this
paper for a fee or for commercial purposes, or modiﬁcation of the content of the paper are prohibited. Please
see original paper for images at higher resolution.

ABSTRACT

An eﬃcient numerical method for computing angle-resolved light scattering oﬀ periodic arrays is presented. The
method combines ﬁnite-element discretization with a Schur complement solver. A signiﬁcant speed-up of the
computations in comparison to standard ﬁnite-element method computations is observed.

Keywords: 3D electromagnetic ﬁeld simulations, ﬁnite-element method, Schur-complement, scatterometry,
optical metrology, computational lithography

1. INTRODUCTION

Optical metrology is used in semiconductor and photomask manufacturing processes to determine a variety
of characteristics of patterned wafers or photomasks such as layer thicknesses, width and shape of patterned
structures, material properties and distribution, or overlay between diﬀerent layers or structures. State-of-
the-art methods determining these features include spectroscopic or angle-resolved scatterometry, ellipsometry,
reﬂectometry or imaging based methods.1 These methods consist of an optical system which illuminates the
measured sample and a detector system which measures properties of the light after interaction with the sample,
e.g., the intensity, phase and/or polarization state of reﬂected and/or transmitted, resp. of scattered light.
For interpretation of the measurement, the measurement data are related to results obtained from modeling
and simulation of the measurement setup for diﬀerent values of the sample characteristics. These modeled
distributions can be computed during the measurement process or can be precomputed in advance and stored
in libraries. For a large number of free parameters, computation of these modeled light distributions can be
very demanding. Free parameters are physical characteristics of the modeled sample, such as geometrical or
material properties. Further, a number of parameters is needed to describe the illumination system, e.g., multiple
wavelengths and incidence directions or shape and polarization of the light beam. The incident light ﬁeld
generated by the illumination system is typically a beam with a ﬁnite numerical aperture, incident from a speciﬁc
direction, or it has a complex shape, e.g., in quadrupole or freeform illumination. Such light distributions are
typically modeled by a superposition of a number of ﬁelds, e.g., plane waves, with diﬀerent incident directions,
phases, and intensities.2 The number of these ﬁelds needed for accurate modeling can be rather large (e.g.,
hundreds of ﬁelds).

If the measured sample is modeled as a periodic pattern, rigorous computation methods like the Finite Ele-
ment Method3 (FEM), Rigorously Coupled Wave Analysis (RCWA) or Finite Diﬀerence Time Domain Method

Corresponding author: S. Burger

URL: http://www.jcmwave.com
URL: http://www.zib.de

(FDTD) generally have to compute a solution separately for each incident direction. In addition to the vari-
able physical characteristics, this signiﬁcantly increases time and eﬀort to generate the necessary modeled light
distributions. The case of periodic patterns is highly important in semiconductor manufacturing and other tech-
nologies since many fabricated structures exhibit periodicity. Similar requirements for computations of solutions
to Maxwell’s equations as in the above described ﬁeld of computational metrology are present, e.g., in the ﬁeld
of computational lithography.4

A need therefore exists for a method to speed-up computation of such light distributions incident from a
number of diﬀerent directions on periodic samples. In this contribution we present results from an implementation
of a Schur complement based method5 allowing for such speed-ups. We demonstrate results that are based on
JCMsuite, a FEM solver for the linear Maxwell’s equations in frequency domain. The implementation contains
features like higher-order edge-elements,6 domain-decomposition,7 hp-adaptivity,8 and model order reduction.9
It is applied to tasks in computational lithography and metrology10–13 as well as to further ﬁelds in technology
and research, see, e.g., for an overview.14

This paper is structured as follows: The background of the numerical method is presented in Section 2.
Section 3 presents simulation results on computation of angle resolved reﬂection spectra from 2D-periodic arrays
of silicon nano-posts.

2. SCHUR COMPLEMENT METHOD

In this contribution we present a method to eﬃciently perform computation of scattered light ﬁelds from a
periodic sample for a number of incident directions. The computational eﬀort scales only very slowly with the
number of incident directions. This can lead to substantial savings up to orders of magnitude in time and
hardware costs for the computer system of a metrology or computational lithography system.

The general idea of the presented method is the decomposition of the light scattering model into a part
which is independent on the direction of the incident ﬁeld and a part which depends on the direction of the
incident ﬁeld. The part which is independent on the incident direction is solved once for all directions. The part
dependent on the incident direction is solved for each incident direction individually. The individual and the
common solutions are combined to give the total solution.

As a prerequisite let us look at a linear system of equations (as resulting, e.g., from FEM discretization of

Maxwell’s equations6):

where A is a matrix, f is the right hand side, and x is the sought solution.

Now we split the matrix into following blocks:

Ax = f,

A = (cid:18) A11 A12

A21 A22 (cid:19) ,

(1)

(2)

where A11 and A22 are square matrices of generally diﬀerent dimensions. Further, we split the solution and right
hand side into corresponding blocks:

x = (cid:18) x1
f = (cid:18) f1

x2 (cid:19) ,
f2 (cid:19) .

Using this decomposition, Eq. (1) can be written as follows:

A11x1 + A12x2 = f1

A21x1 + A22x2 = f2.

(3)

(4)

(5)

(6)

Equation (5) can be solved with respect to x1:

x1 = A−1

11 (f1 − A12x2)

and used in (6), giving:

(7)

(8)

Matrix (cid:0)A22 − A21A−1

(cid:0)A22 − A21A−1

11 A12(cid:1) x2 = f2 − A21A−1
11 A12(cid:1) is the so-called Schur complement5 of A.

11 f1.

Now let us consider typical light scattering models, arising from discretization of Maxwell’s equations, using
e.g., FEM, FDTD, Discontinuous Galerkin, Finite Volume Method, or Volume Integral Method. The scattering
model from a periodic structure is thereby formulated on a single unit cell and periodic boundary conditions are
applied. These periodic boundary conditions depend on the grid vectors of the periodic domain and the incidence
direction of the incoming light ﬁeld, i.e., the phase diﬀerence from opposite periodic boundaries. This means that
a number of entries in matrix A depend on the incident direction and hence have to be solved independently.

In order to use above Schur splitting we reorder the linear system, such that all entries independent on the

incident direction θ are in block A11:

A11x1 + A12(θ)x2 = f1(θ)
A21(θ)x1 + A22(θ)x2 = f2(θ).

(9)
(10)

Hence, looking at (7) and (8) we observe that inversion of block A11 has to be performed only once, independent
on the incidence direction. Only the solution of (8) is needed for each incidence direction.

Typically the size of A11 is much larger than the size of A22 since the size of block A22 only corresponds to
the degrees of freedom on the boundary of the periodic computational domain. These are much less than the
number of degrees of freedom in the volume in block A11.

In order to arrive at the Schur system (8) the inverted (i.e., LU-decomposed) matrix is used for solving

following systems:

A−1
11 A12 (θ)
A−1
11 f1 (θ) ,

and the solutions are used in (8) to assemble the θ dependent Schur complement:

A22 (θ) − A21 (θ) A−1

11 A12 (θ)

(11)

(12)

(13)

CD3

CD2

CD1

          

          

          

          

          

          

          

          

          

          


              

              

              


air
silicon

              

              

              

              

              

              

              

              

              

              

              

              

              


          

          

          

          

          

          

          

          

          

          

          

          

          

          

          

          

          

          

          

          


        

        

        

        

        

        

        

        

        

        

        

        

        

        

        

        

        


     

     

     

     

     

     

     

     


h1

h2

py

px

Figure 1. Left: Schematics of the geometry of the investigated scattering geometry (unit cell of a 2D-periodic grating of
nano-rods with circular cross section. Parameters of the model are indicated (critical dimension, CD, at diﬀerent heights,
h1, h2, pitches px, py), cf., Table 1. Right: Visualization of the mesh discretizing the geometry (only silicon parts shown).

Once this dense Schur system is solved for x2, the inner solution x1 can be obtained from (7). Also here,
the decomposition of A11 can be used for all incidence directions. An increasing number of incidence directions
only leads to an increasing number of right hand sides. Especially for discretization of 3D scattering problems,
however the LU-decomposition of the system takes much more eﬀort than solving for a large number of right
hand sides.

In the following example we will show that the Schur splitting can lead to substantial savings in computation
time when scattering problems with a large number of right hand sides (i.e., sources with various incidence
directions) are solved.

3. APPLICATION EXAMPLE:

LIGHT SCATTERING OFF AN ARRAY OF NANO-POSTS

In this section, the computation of angle-resolved scattering spectra is analyzed as an example of the described
Schur complement technique. Corresponding setups are relevant for applications like, e.g., Fourier ellipsome-
try.13 The following model is investigated: Light with a vacuum wavelength of λ0 = 300 nm and well-deﬁned
polarizations (S- and P-polarized) illuminates a 3D structure. The source is modeled as a series of independent,
coherent plane waves with well deﬁned wave-vectors ~k = (kx, ky, kz). For normal incidence, the sample is ar-
ranged such that ~k = (0, 0, kz), kz = 2π/λ0. The geometry of the illuminated structure is a 2D-periodic array
of nano-rods. The material corresponds to silicon, with a complex refractive index n = 5.0 + 4.16i at the given
wavelength obtained from tabulated data.15 The superspace is modeled as air, with refractive index n = 1.0.
The parameterized geometry is schematically shown in Fig. 1, and the chosen geometrical parameter set is as
deﬁned in Table 1.

px = py
CD1 / CD2 / CD3
h1 /h2

100 nm
50 nm / 55 nm / 60 nm
40 nm / 20 nm

Table 1. Parameter settings for the Si nano-post array (compare Fig. 1).

 

RS (Schur)
RP (Schur)
RS (standard FEM)
RP (standard FEM)

P
R

,
S
R

0.3

0.25

0.2
 
0

0.2

0.4
kx/ktot

0.6

0.8

Figure 2. Validation of the Schur complement method by comparison to standard FEM. Angular reﬂection spectra
for S- and P-polarized light incident on the nanorod array, RS, RP. The solid lines show results computed with the
Schur complement method (for 322 sources). The open circles show results computed with standard FEM for a subset of
sources.

(a)

 

(b)

 

t
o
t
k
/
y
k

0.6

0.5

0.4

0.3

0.2

0.1

0
 
0

0.2

0.4

kx/ktot

0.6

0.29

0.27

0.25

0.23

0.21

t
o
t
k
/
y
k

0.6

0.5

0.4

0.3

0.2

0.1

0
 
0

0.2

0.4

kx/ktot

0.6

0.29

0.27

0.25

0.23

0.21

Figure 3. Angle-resolved reﬂection spectra for S-polarized illumination (a) and P-polarized illumination (b). Both spectra
have been obtained in a single simulation run using the Schur complement method for a total of 848 incident source ﬁelds.

First, the Schur complement method is validated: Angular reﬂection spectra of S- and P-polarized light are
computed using the Schur complement method, using 161 directions of incidence. Figure 2 shows the obtained
spectra. We validate the results by computing the same spectra using standard FEM, i.e., using separate
computations for each angle of incidence and not decomposing the matrix A into θ-dependent and θ-independent
parts (see Eq. 10). These spectra are also plotted in Figure 2. The corresponding results agree quantitatively to
a level of a relative error below 0.2% at the chosen accuracy setting. Here, the precision parameter for the hp
reﬁnement of the ﬁnite element discretization was chosen as pPrec = 4 × 10−3, yielding a discrete problem with
around 105 unknowns. Please see a previous publication for details on the numerical settings for hp-reﬁnement.8
Agreement of results obtained with the Schur complement method and with standard FEM is expected, however,
small deviations of the numerical results within the ranges of numerical discretization errors are due to diﬀerences
in numerical treatment of transparent boundaries in the Schur complement and in the standard FEM case.

Next, usability of the method is demonstrated by computing two angle-resolved reﬂection spectra for the
array, where both, the inclination angle and the rotation angle are varied. Figure 3 visualizes the resulting
spectra. In the ﬁgure, the absolute values of the reﬂection coeﬃcients for S and P polarized light are plotted as
function of kx and ky, which are the transversal components of the incident wave vector ~k = (kx, ky, kz). These
results have been obtained in a single computation using the Schur complement method, where 848 plane waves
with diﬀerent wave vectors and polarizations have been used. This results demonstrates practicability of the
method for simulation projects with many independent source terms.

As commented above, the computational costs of a Schur method simulation run with N sources can be signif-
icantly smaller than the total computational cost of N independent simulation runs. To demonstrate this for the
given example, the CPU times for computations with both approaches are compared (Schur method CPU times
and standard FEM CPU times are normalized with the same constant). Figure 4 shows how the computation
times scale with the number of sources. A speed-up by a factor of > 5 is observed for this speciﬁc example. Both
simulation runs have been performed with the same numerical accuracy settings (meshing parameters, hp-FEM
discretization parameters), and on the same hardware (using a single thread of a standard computer). Please
note that for the standard FEM computations we have also “re-used” the inverted system matrix A−1 for the
second source polarization setting (for each given wave vector). Accordingly, without this improved standard
FEM, the speed-up factor would be > 10 instead of > 5. For a comparison of standard FEM performance in
comparison to other methods for solving Maxwell’s equations we refer to previous benchmarks.16–18

In general, the Schur method speed-up factor obtained for a speciﬁc setup is expected to increase with the
ratio of the sizes of the matrix blocks A11 and A22 (Eq. (2)). However, inverting the Schur complement requires

]
.

u
.
a
[

U
P
C
t

120

100

80

60

40

20

0
 
0

Schur

standard FEM

 

50

100

150

200

Nsrc

Figure 4. Comparison of computation times for simulations of the same setup using the Schur complement method (red
circles, linear interpolation: red line) and using standard FEM (blue squares, linear interpolation: blue line): Computation
time tCP U as function of number of sources Nsrc.

inversion of a full matrix, such that the speed-up factor can be worsened for large problem sizes. Clearly, the
N computations for the standard (“no Schur”) simulations can also be performed in parallel on a multi-core
processor, thus decreasing computation time by a factor of 1/N . However, in typical applications where many
spectra have to be computed, the computations using Schur complements can be parallelized in the same manner.

4. CONCLUSION

A ﬁnite-element method for computing solutions to the Maxwell 3D scattering problem has been presented,
which makes use of a Schur complement solver for eﬃciently handling setups with many independent source
terms for the same geometrical setup. A speed-up factor of greater than ﬁve has been observed for a speciﬁc
application example in which angle-resolved reﬂection spectra from an array of silicon nano-posts are computed.
We expect that this method can be used eﬀectively for a variety of applications including computational metrol-
ogy, computational lithography, nano-optics design in integrated optoelectronics, photovoltaics, light-emitters,
and other ﬁelds.

We acknowledge support of BMBF through projects 13N13164 (SolarNano) and 13N12438 (MOSAIC).

Acknowledgments

REFERENCES

1. L. Pang, D. Peng, P. Hu, D. Chen, L. He, Y. Li, M. Satake, and V. Tolani, “Computational metrology and

inspection (CMI) in mask inspection, metrology, review, and repair,” Adv. Opt. Techn. 1, p. 299, 2012.

2. A. K. Wong, Optical Imaging in Projection Microlithography, SPIE Press, Bellingham, 2005.
3. P. Monk, Finite Element Methods for Maxwell’s Equations, Oxford University Press, 2003.
4. K. Lai, “Review of computational lithography modeling:

focusing on extending optical lithography and

design-technology co-optimization,” Adv. Opt. Techn. 1, p. 249, 2012.

5. G. Golub and C. Van Loan, Matrix Computations, Johns Hopkins University Press, 2012.

6. J. Pomplun, S. Burger, L. Zschiedrich, and F. Schmidt, “Adaptive ﬁnite element method for simulation of

optical nano structures,” phys. stat. sol. (b) 244, p. 3419, 2007.

7. A. Sch¨adle, L. Zschiedrich, S. Burger, R. Klose, and F. Schmidt, “Domain decomposition method for

Maxwell’s equations: Scattering oﬀ periodic structures,” J. Comp. Phys. 226, p. 447, 2007.

8. S. Burger, L. Zschiedrich, J. Pomplun, S. Herrmann, and F. Schmidt, “Hp-ﬁnite element method for simu-

lating light scattering from complex 3D structures,” Proc. SPIE 9424, p. 94240Z, 2015.

9. J. Pomplun and F. Schmidt, “Accelerated a posteriori error estimation for the reduced basis method with
application to 3D electromagnetic scattering problems,” SIAM Journal on Scientiﬁc Computing 32, p. 498,
2010.

10. F. Scholze, C. Laubis, G. Ulm, U. Dersch, J. Pomplun, S. Burger, and F. Schmidt, “Evaluation of EUV
scatterometry for CD characterization of EUV masks using rigorous FEM-simulation,” Proc. SPIE 6921,
p. 69213R, 2008.

11. J. Pomplun, L. Zschiedrich, S. Burger, F. Schmidt, J. Tyminski, D. Flagello, and N. Toshiharu, “Reduced

basis method for source mask optimization,” Proc. SPIE 7823, p. 78230E, 2010.

12. B. H. Kleemann, J. Kurz, J. Hetzler, J. Pomplun, S. Burger, L. Zschiedrich, and F. Schmidt, “Fast online
inverse scattering with Reduced Basis Method (RBM) for a 3D phase grating with speciﬁc line roughness,”
Proc. SPIE 8083, p. 808309, 2011.

13. P. Petrik, N. Kumar, M. Fried, B. Fodor, G. Juhasz, S. Pereira, S. Burger, and H. P. Urbach, “Fourier
ellipsometry, an ellipsometric approach to fourier scatterometry,” J. Europ. Opt. Soc. - Rap. 10, p. 15002,
2015.

14. S. Burger, L. Zschiedrich, J. Pomplun, M. Blome, and F. Schmidt, “Advanced ﬁnite-element methods for

design and analysis of nano-optical structures: Applications,” Proc. SPIE 8642, p. 864205, 2013.

15. E. D. Palik, Handbook of optical constants of solids, Academic press, 1985.
16. B. Maes, J. Petr´aˇcek, S. Burger, P. Kwiecien, J. Luksch, and I. Richter, “Simulations of high-Q optical

nanocavities with a gradual 1D bandgap,” Opt. Express 21, p. 6794, 2013.

17. J. Hoﬀmann, C. Hafner, P. Leidenberger, J. Hesselbarth, and S. Burger, “Comparison of electromagnetic

ﬁeld solvers for the 3D analysis of plasmonic nano antennas,” Proc. SPIE 7390, p. 73900J, 2009.

18. S. Burger, R. K¨ohle, L. Zschiedrich, W. Gao, F. Schmidt, R. M¨arz, and C. N¨olscher, “Benchmark of FEM,

waveguide and FDTD algorithms for rigorous mask simulation,” Proc. SPIE 5992, p. 599216, 2005.

