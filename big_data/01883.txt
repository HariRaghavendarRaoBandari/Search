Isomorphisms of Cayley graphs on

nilpotent groups

Dave Witte Morris, Joy Morris and Gabriel Verret

6
1
0
2

 
r
a

 

M
1
1
 
 
]

.

O
C
h
t
a
m

[
 
 

2
v
3
8
8
1
0

.

3
0
6
1
:
v
i
X
r
a

Abstract. Let S be a ﬁnite generating set of a torsion-free, nilpo-
tent group G. We show that every automorphism of the Cayley graph
Cay(G; S) is aﬃne. (That is, every automorphism of the graph is ob-
tained by composing a group automorphism with multiplication by an
element of the group.) More generally, we show that if Cay(G1; S1) and
Cay(G2; S2) are connected Cayley graphs of ﬁnite valency on two nilpo-
tent groups G1 and G2, then every isomorphism from Cay(G1; S1) to
Cay(G2; S2) factors through to a well-deﬁned aﬃne map from G1/N1
to G2/N2, where Ni is the torsion subgroup of Gi. For the special case
where the groups are abelian, these results were previously proved by
A. A. Ryabchenko and C. L¨oh, respectively.

Contents

1.
Introduction
2. Preliminaries
3. Torsion-free nilpotent groups
4. Nilpotent groups that may have torsion
5. Other groups that have torsion
References
Appendix A. Notes to aid the referee

1. Introduction

1
4
7
9
11
12
13

It is easy to construct examples of non-isomorphic groups that have iso-

morphic Cayley graphs, even if the Cayley graphs are required to be con-   see
A.1!

nected and have ﬁnite valency. We show that this is not possible when the
groups are torsion-free and nilpotent:

note

Theorem 1.1. Suppose G1 and G2 are torsion-free, nilpotent groups. If
G1 has a connected Cayley graph of ﬁnite valency that is isomorphic to a
Cayley graph on G2, then G1 ∼= G2.

In fact, the next theorem establishes the stronger conclusion that every   see
A.2!

note

2010 Mathematics Subject Classiﬁcation. 05C25, 20F18, 05C63, 20F65.
Key words and phrases. Cayley graph, nilpotent group, isomorphism, Cayley isomor-

phism property.

1

2

DAVE WITTE MORRIS, JOY MORRIS AND GABRIEL VERRET

isomorphism of the Cayley graphs is obtained from an isomorphism of the
groups.
Deﬁnition 1.2. Suppose ϕ : G1 → G2, where G1 and G2 are groups. We say
that ϕ is an aﬃne bijection if it is the composition of a group isomorphism
and a translation. That is, there exist a group isomorphism α : G1 → G2
and h ∈ G2, such that ϕ(x) = h · α(x), for all x ∈ G1.
Theorem 1.3. Assume

• G1 and G2 are torsion-free, nilpotent groups, and
• Si is a ﬁnite, symmetric generating set of Gi, for i = 1, 2.

Then every isomorphism from Cay(G1; S1) to Cay(G2; S2) is an aﬃne bi-
jection.

Remark 1.4. In the special case where G1 and G2 are abelian, Theorem 1.3
was proved by A. A. Ryabchenko [12].
Deﬁnition 1.5. [7, §6.4] Let G be a group. A Cayley graph Cay(G; S) is
said to be normal if the left-regular representation of G is a normal subgroup

  see
A.3! of Aut(cid:0)Cay(G; S)(cid:1) or, equivalently [2, Lem. 2.2(b)], if every automorphism

of Cay(G; S) is an aﬃne bijection.

note

Remark 1.6. It is easy to see that the left-regular representation of G is
1.5
a subgroup of the automorphism group of every Cayley graph on G.
requires this subgroup to be normal.

With this terminology, the special case of Theorem 1.3 in which G1 = G2

has the following known result as an immediate consequence.

Corollary 1.7 (M¨oller-Seifter [9, Thm. 4.1(1)]). If G is a torsion-free, nilpo-
tent group, then every connected Cayley graph of ﬁnite valency on G is nor-
mal.

In the statement of Theorem 1.3, the word “nilpotent” cannot be replaced

with “solvable” (or even “polycyclic”):

Example 1.8. Let G be the unique nonabelian semidirect product of the
form Z ⋊ Z. More precisely,

A.4!
  see

note

G = h a, b | b−1ab = a−1 i = hai ⋊ hbi.

(In other words, G is the fundamental group of the Klein bottle.) Then
G is obviously polycyclic (so it is solvable), but it is not diﬃcult to see that

Cay(cid:0)G;{a±1, b±1}(cid:1) is not normal. (Namely, the map ϕ(aibj) = biaj is a

graph automorphism that is not an aﬃne bijection.)

If G is not torsion-free, then the conclusion of Corollary 1.7 fails:

Proposition 1.9. Let G be a ﬁnitely generated, inﬁnite group. If G is not
torsion-free, then G has a connected Cayley graph of ﬁnite valency that is
not normal.

ISOMORPHISMS OF CAYLEY GRAPHS ON NILPOTENT GROUPS

3

However, the next theorem shows that if the torsion-free hypothesis is
removed from Theorem 1.3, then the conclusion still holds modulo the ele-
ments of ﬁnite order.

Deﬁnition 1.10 ([6, 1.2.13, p. 11]). Suppose G is a ﬁnitely generated,
nilpotent group. The set of all elements of ﬁnite order in G is called the
torsion subgroup of G. (This is a ﬁnite, normal subgroup of G.)

Theorem 1.11. Assume

i = 1, 2,

• Si is a symmetric, ﬁnite generating set of the nilpotent group Gi, for
• ϕ is an isomorphism from Cay(G1; S1) to Cay(G2; S2), and
• Ni is the torsion subgroup of Gi, for i = 1, 2.

Then ϕ induces a well-deﬁned aﬃne bijection ϕ : G1/N1 → G2/N2.
Corollary 1.12. For i = 1, 2, assume Ni is the torsion subgroup of the
ﬁnitely generated, nilpotent group Gi. Then there is a connected Cayley
graph of ﬁnite valency on G1 that is isomorphic to a Cayley graph on G2 if
and only if G1/N1 ∼= G2/N2 and |N1| = |N2|.
Corollary 1.13. If Cay(G; S) is any Cayley graph of ﬁnite valency on a
torsion-free, nilpotent group G, then the left-regular representation of G is
the only nilpotent subgroup of Aut(cid:0)Cay(G; S)(cid:1) that acts sharply transitively

on the vertices of the Cayley graph.

Remarks 1.14.

(1) In the special case where G1 and G2 are abelian, Theorem 1.11

and Corollary 1.12 were proved by C. L¨oh [8].

(2) Theorem 1.3 is the special case of Theorem 1.11 in which the torsion

subgroups N1 and N2 are trivial.

(3) Although Theorems 1.3 and 1.11 are stated only for graphs, they
obviously remain true in the setting of Cayley digraphs. This is
because any isomorphism of digraphs is also an isomorphism of the
underlying graphs.

(4) Some non-nilpotent groups have some Cayley graphs that are isomor-
phic to Cayley graphs on nilpotent groups—or even abelian groups.
(For example, the Cayley graph in Example 1.8 is isomorphic to

Cay(cid:0)Z× Z,{(±1, 0), (0,±1)}(cid:1).) Theorem 1.11 implies that any such

group must have a subgroup of ﬁnite index that is nilpotent, but
this fact is well known to be a consequence of Gromov’s famous the-
orem that groups of polynomial growth are virtually nilpotent [3].
Indeed, in order to conclude from Gromov’s Theorem that G has a
nilpotent subgroup of ﬁnite index, it suﬃces to know that G has a
connected Cayley graph of ﬁnite valency that is quasi-isometric (not
necessarily isomorphic) to a Cayley graph on a nilpotent group.

Theorem 1.3 is proved in Section 3, and this result is used to prove The-
(The arguments are based

orem 1.11 (and its corollaries) in Section 4.

4

DAVE WITTE MORRIS, JOY MORRIS AND GABRIEL VERRET

on techniques of A. A. Ryabchenko [12] and C. L¨oh [8].) Proposition 1.9 is
proved in Section 5.

Acknowledgments. This work was partially supported by Australian Re-
search Council grant DE130101001 and a research grant from the Natural
Sciences and Engineering Research Council of Canada.

2. Preliminaries

The following result is the special case of Theorem 1.3 in which G1 and G2
are abelian. (Although not stated in exactly this form in [12], the result fol-
lows from the proof that is given there and is reproduced in [10, Thm. 5.3]).
This case is not covered by the proof in Section 3.

Proposition 2.1 (Ryabchenko [12, Thm. 2]). Assume

• G1 and G2 are torsion-free, abelian groups,
• Si is a symmetric, ﬁnite generating set of Gi, for i = 1, 2, and
• ϕ is an isomorphism from Cay(G1; S1) to Cay(G2; S2).

Then ϕ is an aﬃne bijection.

As in [8], we use geometric terminology, such as geodesics and convexity,

instead of presenting our arguments in group-theoretic language.

  see
A.5!

note

Deﬁnition 2.2. Let S be a symmetric, ﬁnite generating set of a group G.
• For g, h ∈ G, the distance from g to h in the Cayley graph Cay(G; S)
is denoted distS(g, h).
• A ﬁnite sequence [gi]n
i=m of elements of G is a geodesic segment
from gm to gn in Cay(G; S) if distS(gi, gj) = |i − j| for m ≤ i, j ≤ n.
• A bi-inﬁnite sequence [gi]∞
i=−∞ of elements of G is a geodesic line in
Cay(G; S) if distS(gi, gj) = |i − j| for all i, j ∈ Z.
• A geodesic line [gi]∞
i=−∞ in Cay(G; S) is convex if [gi, gi+1, . . . , gj]
is the only path of length j − i from gi to gj, for all i, j ∈ Z (with
i < j).
i=−∞ in Cay(G; S) is homogeneous if there exists

• A geodesic line [gi]∞

ϕ ∈ Aut(cid:0)Cay(G; S)(cid:1), such that ϕ(gi) = gi+1 for all i.
• Aute(cid:0)Cay(G; S)(cid:1) =(cid:8) ϕ ∈ Aut(cid:0)Cay(G; S)(cid:1)(cid:12)(cid:12) ϕ(e) = e(cid:9).

• Each oriented edge of Cay(G; S) has a natural label, which is an ele-
gs is labelled s. (Note
ment of S. Namely, each edge of the form g
that the same edge with the opposite orientation is labelled s−1.)
Each edge in a geodesic segment (or geodesic line) comes with a
natural orientation, and therefore has a label.

Lemma 2.3. For i = 1, 2, assume

• Si is a symmetric, ﬁnite generating set of a group Gi,
• ϕi is an isomorphism from Cay(G1; S1) to Cay(G2; S2), such that
• gi ∈ Gi,

ϕi(e) = e,

ISOMORPHISMS OF CAYLEY GRAPHS ON NILPOTENT GROUPS

5

2; S∗

1 is an isomorphism from

• S∗
• G∗
1; S∗

i = hS∗
i i.
1 ∪ (S∗

If ϕ1(g1) = g2, then the restriction of ϕ2 to G∗

i =(cid:8) ρ(gi)(cid:12)(cid:12) ρ ∈ Aute(cid:0)Cay(Gi; Si)(cid:1)(cid:9), and
2 )−1(cid:1).
Cay(cid:0)G∗
Proof. For convenience, let Ai = Aut(cid:0)Cay(Gi; Si)(cid:1), Ae
and Γi = Cay(cid:0)Gi; S∗

1 )−1(cid:1) to Cay(cid:0)G∗

2 ∪ (S∗

i ∪ (S∗

i )−1(cid:1). For ρ ∈ Ai and g ∈ Gi, deﬁne ρg ∈ Ae

ρg(x) = ρ(g)−1 ρ(gx). Then, since S∗

i is Ae
i ) = ρ(g) ρg(S∗
so ρ is an automorphism of Γi. Since Ae
i , and the left-
regular representation of Gi is transitive on Gi, this implies that the set of
edges of Γi is the Ai-orbit of the edge e

i -invariant, we have
i ) = ρ(g)S∗
i ,
i is transitive on S∗

ρ(gS∗

i = Aute(cid:0)Cay(Gi; Si)(cid:1),

i by

gi.

1

Since ϕ1 is a graph isomorphism, it maps the A1-orbit of g1 to the A2-
orbit of ϕ1(g1) = g2. So ϕ1 is an isomorphism from Γ1 to Γ2. Since the
composition ϕ2 ◦ ϕ−1
is in A2, and is therefore an automorphism of Γ2, we
conclude that ϕ2 is an isomorphism from Γ1 to Γ2. Since Cay(cid:0)G∗
i ∪
i )−1(cid:1) is the component of Γi that contains e, and ϕ2(e) = e, the desired
(S∗
conclusion follows.
Lemma 2.4 ([8, Prop. 2.5(3)]). Let s ∈ S be the label of some edge of
a convex geodesic line in Cay(G; S). If s ∈ Z(G), then every edge of the
geodesic line is labelled s.

i ; S∗

(cid:3)

gi+1 is labelled s. Let t be the label of gi+1

gi+2.
Proof. Suppose gi
Then gi+2 = gist = (git)s, so [gi, git, gi+2] is a path of length 2 from gi
to gi+2. Therefore, convexity implies [gi, git, gi+2] = [gi, gi+1, gi+2], so git =
gi+1 = gis, so t = s. This means the label of gi+1
gi+2 is s. By induction,
we see that every edge is labelled s.
(cid:3)

In the remainder of this section, we recall some basic facts about nilpotent

groups.

Deﬁnition 2.5 ([6, p. 38] or [1, Notn. 3.4]). For a subgroup H of a group G,
we let

√H = { g ∈ G | gk ∈ H for some k ∈ Z+ }.

This is called the isolator of H in G.

Any ﬁnitely generated, abelian group A is isomorphic to Zr × F , for some
r ∈ Z≥0 and ﬁnite, abelian group F . The number r is called the rank of A,
and is denoted rank A. The following deﬁnition generalizes this notion from
abelian groups to nilpotent groups.

Deﬁnition 2.6 ([6, 1.3.3 and p. 85 (1)]). Assume G is a nilpotent group.
Then G is solvable, which means there is a series

{e} = G0 ⊳ G1 ⊳ ··· ⊳ Gr−1 ⊳ Gr = G,

6

DAVE WITTE MORRIS, JOY MORRIS AND GABRIEL VERRET

If G is
of subgroups of G, such that each quotient Gi/Gi−1 is abelian.
ﬁnitely generated, then the Hirsch rank of G is the sum of the ranks of
these (ﬁnitely generated) abelian groups. That is,

rank G =

rank(Gi/Gi−1).

rXi=1

It is not diﬃcult to see that this is independent of the choice of the subgroups
G1, . . . , Gr−1.

Lemma 2.7. Assume G is a ﬁnitely generated, nilpotent group, H is a
subgroup of G, and S is a symmetric, ﬁnite generating set of G. Then:

(1) [6, 1.2.16, p. 11] H is ﬁnitely generated.
(2) [6, 2.3.1(ii), p. 39] √H is a subgroup of G that contains H, and
(3) If N E G, then √N E G and G/√N is torsion-free.

(cid:12)(cid:12)√H : H(cid:12)(cid:12) < ∞.
(4) [6, 2.3.8(ii), p. 42] If G is torsion-free, thenpZ(G) = Z(G).
(5) [6, 2.3.9(iv), p. 43](cid:2)√H,√H(cid:3) ⊆p[H, H].

(6) If N is a normal subgroup of G, then rank G = rank N +rank(G/N ).
Therefore, rank(G/N ) ≤ rank G, with equality if and only if N is
ﬁnite.
(7) (cf. [4, Lem. 2.6, p. 9]) We have rank H ≤ rank G, with equality if
(8) [11, 5.2.1, p. 129] If N is a nontrivial normal subgroup of G, then

and only if |G : H| < ∞.
N ∩ Z(G) is nontrivial.
(9) (cf. [6, 2.3.8(i), p. 42]) If G is torsion-free, then the elements of Z(G)
are the only elements of G that have only ﬁnitely many conjugates.

  see
A.6!

note

note

A.7!
  see
  see
A.8!

note

note

  see
A.9!
  see
A.10!

note

(10) (cf. [6, 2.1.2, p. 30]) Assume G is torsion-free, and a, b, g ∈ G. If

sup
k∈Z+

distS(ak, gbk) < ∞,

then b = g−1ag.

(11) [1, Lem. 3.5(i,iii)] For g ∈ G, we have g ∈ p[G, G] if and only if

distS(e, gk)/k → 0 as k → ∞.

Remark 2.8. Lemma 2.7(5) corrects a typographical error.
It is stated
in [6, 2.3.9(iv), p. 43] that equality holds, but a counterexample to this is
provided by any ﬁnite-index subgroup G of the discrete Heisenberg group,
such that [G, G] is a proper subgroup of Z(G): letting H = G, we have

(cid:2)√G,√G(cid:3) = [G, G] 6= Z(G) =p[G, G].

Deﬁnition 2.9. A group G is bi-orderable if it is has a total order ≺ that
(That is,
is invariant under both left-translations and right-translations.
x ≺ y ⇒ axb ≺ ayb for all x, y, a, b ∈ G.)
Lemma 2.10 ([5, Cor. 3.3.2, p. 57]). Every torsion-free, nilpotent group is
bi-orderable.

ISOMORPHISMS OF CAYLEY GRAPHS ON NILPOTENT GROUPS

7

i=−∞ is a convex geodesic line in Cay(G; S ∪ S−1).

Lemma 2.11 (cf. [12, 1st paragraph of §4] or [8, Prop. 2.9(1)]). If S is a
ﬁnite generating set of a nontrivial, bi-orderable group G, then there exists
s ∈ S, such that [si]∞
Proof. Let ≺ be a total order on G that is invariant under both left-
translations and right-translations. Since the set S ∪ S−1 is ﬁnite, it has
≺ with the order ≺′ deﬁned by x ≺′ y ⇔ x−1 ≺ y−1, if necessary.

a maximal element s under this order. We may assume s ∈ S, by replacing   see
A.11!
implies that ac (cid:22) bd (and equality holds iﬀ a = b and c = d). By induction   see
A.12!

For a, b, c, d ∈ G with a (cid:22) b and c (cid:22) d, the invariance under translations
on k, we conclude that s1s2 ··· sk (cid:22) sk for all s1, s2, . . . , sk ∈ S ∪ S−1, and
that equality holds iﬀ s1 = s2 = ··· = sk = s. This implies that [si]∞
i=−∞ is
a convex geodesic line.
(cid:3)

note

note

3. Torsion-free nilpotent groups

In this section, we prove Theorem 1.3. Let ϕ be an isomorphism from
Cay(G1; S1) to Cay(G2; S2). By composing with a left translation, we may

assume ϕ(e) = e. (Under this assumption, we will show that ϕ is a group   see
A.13!

i = Z(Gi) ∩p[Gi, Gi] for i = 1, 2.

homomorphism. Since ϕ is bijective, it must then be a group isomorphism.)
The proof is by induction on rank G1 + rank G2.
Notation. Let Z †
Step 1. For every g ∈ G1 and z ∈ Z †
ϕ(gzk) = ϕ(g) σg(z)k for all k ∈ Z.
Proof. By composing with left translations in G1 and G2, we may assume
g = e. Deﬁne S∗
g2 = ϕ(z). Combining Lemmas 2.10 and 2.11 yields s ∈ S∗

1, there exists σg(z) ∈ G2, such that

2 as in Lemma 2.3, with g1 = z and   see
A.14!

2 , such that

1, and G∗

2, G∗

1, S∗

note

note

1 ∪ (S∗

2 )−1(cid:1).

The deﬁnition of S∗

2 implies there is an isomorphism ψ from Cay(G1; S1)

2 ∪ (S∗
1; S∗
tains the edge e
[zi]∞

i=−∞ is a convex geodesic line in Cay(cid:0)G∗
2)−1(cid:1), we know that ψ−1(cid:0)[si]∞

to Cay(G2; S2) with ψ(e) = e and ψ(z) = s. Since Lemma 2.3 tells   see
A.15!
us that ψ restricts to an isomorphism from Cay(cid:0)G∗
Cay(cid:0)G∗
line in Cay(cid:0)G∗
from Lemma 2.7(11) that z /∈p[G∗
On the other hand, since z ∈ Z †
fore p[G∗

1 )−1(cid:1) to
i=−∞(cid:1) is a convex geodesic
1)−1(cid:1). From the choice of ψ, this geodesic line con-
1, we know that z ∈p[G1, G1]. There-

1 ∪ (S∗
z, so Lemma 2.4 tells us that this geodesic line must be
(zi, zj) = |i − j| for all i, j ∈ Z. We conclude

1] 6= p[G1, G1]. This implies that [G∗

in [G1, G1] (cf. Lemma 2.7(2)), so G∗
Lemma 2.7(5)). Therefore, rank G∗
Lemma 2.7(7)), so our induction hypothesis tells us that the restriction of ϕ
2. Hence, ϕ(zk) = ϕ(z)k for all k, so
to G∗
we may let σg(z) = ϕ(z).
(cid:3)

2 < rank G1 + rank G2 (see   see
A.16!

1] has inﬁnite index
1 must have inﬁnite index in G1 (cf.

1 is a group isomorphism onto G∗

i=−∞. This means distS ∗

1 + rank G∗

2; S∗

2 ∪ (S∗

1

1, G∗
1].

[si]∞

2; S∗

1, G∗

1, G∗

1; S∗

note

note

8

DAVE WITTE MORRIS, JOY MORRIS AND GABRIEL VERRET

Step 2. We have ϕ(xZ †

1) = ϕ(x)Z †

2, for all x ∈ G1.

Proof. By composing with left translations in G1 and G2, we may as-
sume x = e. Then, since ϕ−1 is also an isomorphism, it suﬃces to show
ϕ(Z †
2. Fix z ∈ Z †
1. For all k ∈ Z, we have distS1(zk, gzk) = distS1(e, g)
Since ϕ is a graph isomorphism, this implies
(because z ∈ Z(G1)).
us that ϕ(g)−1ϕ(z)ϕ(g) = σg(z). From the deﬁnition of σg(z), we see that

1(cid:1) ⊆ Z †
distS2(cid:0)ϕ(z)k, ϕ(g) σg(z)k(cid:1) does not depend on k. So Lemma 2.7(10) tells
distS(cid:0)e, σg(z)(cid:1) = distS(e, z), so this implies that ϕ(g)−1ϕ(z)ϕ(g) is in a
Also, we see from Lemma 2.7(11) that ϕ(cid:0)p[G1, G1](cid:1) =p[G2, G2] (since
ϕ is a graph isomorphism). Therefore ϕ(z) ∈p[G2, G2]. So ϕ(z) ∈ Z †

ball of ﬁxed radius, independent of g. Since ϕ(g) is an arbitrary element
of G2, we conclude that ϕ(z) has only ﬁnitely many conjugates. Since G2 is
torsion-free nilpotent, this implies ϕ(z) ∈ Z(G2) (see Lemma 2.7(9)).

2. (cid:3)

Step 3. Completion of the proof of Theorem 1.3.
i for i = 1, 2. Note that Z †

Proof. Let Gi = Gi/Z †
1 is ﬁnitely generated (see
Lemma 2.7(1)). Therefore, by passing to a power of the graphs Cay(G1; S1)
and Cay(G2; S2) (or, in other words, by replacing Si with an appropriate
product (Si∪{e})(Si∪{e})··· (Si∪{e})), we may assume that Cay(Z †
1; S1∩
Z †
1) is connected. From Step 2, we know that ϕ induces a well-deﬁned

A.17! isomorphism ϕ from Cay(G1; S1) to Cay(G2; S2).
  see

note

A.18!
  see

note

We may assume that G1 and G2 are not both abelian (otherwise,
Ryabchenko’s Theorem (2.1) applies), so either [G1, G1] or [G2, G2] is non-
trivial. This implies that either Z †
2 is nontrivial (see Lemma 2.7(8)),
and therefore inﬁnite (since G1 and G2 are torsion-free). Hence, we have
rank G1 + rank G2 < rank G1 + rank G2 (see Lemma 2.7(6)), so, by induc-
tion on rank G1 + rank G2, we may assume that ϕ is a group isomorphism
from G1 to G2 (since Lemma 2.7(4) implies that G1 and G2 are torsion free).

1 or Z †

For each g ∈ G1 and z ∈ Z †

1, we have

distS2(cid:0)σe(z)k, ϕ(g) σg (z)k(cid:1) = distS2(cid:0)ϕ(zk), ϕ(gzk)(cid:1)

= distS1(zk, gzk)
= distS1(e, g),

since z ∈ Z(G1). Then, from Lemma 2.7(10) (and the fact that Step 2
tells us that σe(z) is in Z †
2 and therefore commutes with ϕ(g)), we see that
σg(z) = σe(z). This means σg(z) is independent of g (so we may drop the
subscript).

z ∈ Z †
us σ(Z †

Fix some g ∈ G1 and s ∈ S1. We have ϕ(gs) = ϕ(g) ϕ(s) σ(z), for some
1 (because ϕ is a homomorphism and the surjectivity in Step 2 tells
1) = Z †
ϕ(gszk) = ϕ(gs) σ(z)k = ϕ(g) ϕ(s) σ(z) σ(z)k = ϕ(g) ϕ(szk+1).

2). Consider any k ≥ 0 with szk ∈ S1. Then

ISOMORPHISMS OF CAYLEY GRAPHS ON NILPOTENT GROUPS

9

Since ϕ is a graph homomorphism and, by assumption, szk ∈ S1, we must
have ϕ(szk+1) ∈ S2. So szk+1 ∈ S1. By induction (with k = 0 as the base
case), we conclude that szk ∈ S1 for all k ∈ Z+. Since S1 is ﬁnite (and
G1 is torsion-free), this implies z = e. So ϕ(gs) = ϕ(g) ϕ(s). Since g is
an arbitrary element of G1 and s is an arbitrary element of the generating
set S1, this implies that ϕ is a group homomorphism.
(cid:3)

4. Nilpotent groups that may have torsion

Proposition 4.1. Assume

• S is a ﬁnite generating set of the group G, and
• N is a ﬁnite, normal subgroup of G, such that G/N is bi-orderable.
Then every automorphism of Cay(G; S) induces a well-deﬁned automor-
phism of Cay(G/N ; S).

Proof. Let

N ∗ = { ϕ(n) | ϕ ∈ Aute(cid:0)Cay(G; S)(cid:1), n ∈ N }.

It is important to note that, since N is contained in a ball of ﬁnite radius
centred at e, and N ∗ must be contained in that same ball, the set N ∗ is
ﬁnite. We wish to show N ∗ ⊆ N .

Assume, without loss of generality, that N ⊆ S (by passing to a power of

Cay(G; S)). Since hN ∗i is obviously invariant under Aute(cid:0)Cay(G; S)(cid:1), there

i=−∞

n for some n ∈ N .

is no harm in assuming hN ∗i = G.
Let G = G/N , and let N ∗ = {gN | g ∈ N ∗}. We wish to show G
(This will lead to a contradiction.) Since, by
is trivial. Suppose not.
assumption, G is bi-orderable, Lemma 2.11 provides g ∈ N ∗, such that
[gi]∞
i=−∞ is a geodesic line in Cay(G; N ∗). Then, since the natural map
Cay(G; N ∗) → Cay(G; N ∗) decreases distances, it is clear that γ = [gi]∞
is a geodesic line in Cay(G; N ∗). By the deﬁnition of N ∗, there exists ϕ ∈
contains the edge e

Aute(cid:0)Cay(G; S)(cid:1), such that ϕ(g) ∈ N . Then ϕ(γ) is a geodesic line that

To obtain the contradiction that completes the proof, we use an argument
of C. L¨oh [8, ﬁrst paragraph of page 105]. Write ϕ(γ) = [hi]∞
i=−∞. For
each k ∈ N, let #(k) be the number of geodesic segments from hi to hi+k.
(Since γ = [gi]∞
i=−∞ is obviously homogeneous, we know that ϕ(γ) is also
homogeneous, so #(k) is independent of the choice of i.) We may assume
h0 = e (so h1 = n). Since N is a ﬁnite normal subgroup of G, it is easy
to see that no geodesic segment can contain two edges that are labelled by
elements of N . (Namely, if (n, s1, . . . , sk, n′) is a path in Cay(G; N ), then
there exists n′′ ∈ N1, such that n′′s1 ··· sk = ns1 ··· skn′, so (n′′, s1, . . . , sk)
is a shorter path with the same endpoints.) Hence, for all k > 1, no geodesic
segment from h1 to hk has any edges that are labelled by elements of N .
(Otherwise, concatenating (n) at the start would yield a geodesic segment
from h0 to hk with more than one edge labelled by elements of N .)

  see
A.19!

note

10

DAVE WITTE MORRIS, JOY MORRIS AND GABRIEL VERRET

For any geodesic segment γ′ = (s1, . . . , sk) from h1 to hk+1, we can con-
struct k + 1 diﬀerent geodesic segments γ1, . . . , γk+1 from h0 to hk+1, by
inserting a single edge labelled by an element of N , as follows:

γi = (s1, s2, . . . , si−1, ni, si, . . . , sk),

where ni ∈ N is chosen so that ns1s2 ··· si−1 = s1s2 ··· si−1ni.
(This is
possible because the subgroup N is normal.) This implies #(k + 1) ≥
(k + 1) · #(k), for all k. Therefore #(k) ≥ k! . However, it is clear that
#(k) ≤ |S|k, so this contradicts the fact that factorials grow faster than
exponentials.

(cid:3)

Combining this proposition with Theorem 1.3 yields the following slight
generalization of Theorem 1.11 that allows G1 and G2 to be slightly non-
nilpotent:

Theorem 4.2. Assume

• Si is a symmetric, ﬁnite generating set of the group Gi, for i = 1, 2,
• Ni is a ﬁnite, normal subgroup of Gi, such that Gi/Ni is torsion-free
• ϕ is an isomorphism from Cay(G1; S1) to Cay(G2; S2).

nilpotent, for i = 1, 2, and

Then ϕ induces a well-deﬁned aﬃne bijection ϕ : G1/N1 → G2/N2.
Proof. By using ϕ to identify Cay(G1; S1) with Cay(G2; S2), we can realize
G2 as a sharply transitive subgroup G′

2 of Aut(cid:0)Cay(G1; S1)(cid:1). (Namely, for

h ∈ G2, deﬁne h′(x) = ϕ−1(cid:0)h ϕ(x)(cid:1).)

For any g ∈ G1 and n ∈ N1, there exists h ∈ G2, such that ϕ(gn) = h ϕ(g).
This means h′g = gn ∈ gN1. From Proposition 4.1 (and Lemma 2.10),
we know that G′
2 factors through to a well-deﬁned group of permutations
on G1/N1, so this implies h′(gN1) = gN1. Since gN1 is ﬁnite (and G′
2
is sharply transitive), we conclude that h′ has ﬁnite order, so h′ is in the
torsion subgroup N ′
2. This means h ∈ N2, so ϕ(gn) = h ϕ(g) ∈
N2 ϕ(g). Therefore ϕ(gN1) ⊆ N2 ϕ(g). So ϕ induces a well-deﬁned function
ϕ : G1/N1 → G2/N2.
Deﬁnition 4.3 ([7, p. 305]). The wreath product (or lexicographic product)
of two graphs X1 = (V1, E1) and X2 = (V2, E2) is the graph X1[X2] with
vertex set V1 × V2, such that (v1, v2) is adjacent to (v′
2) if and only if
either

2 of G′

1, v′

(cid:3)

• v1 is adjacent to v′
• v1 = v′

1 in X1, or

1 and v2 is adjacent to v′

2 in X2.

Proof of Corollary 1.12. (⇒) Let S1 and S2 be ﬁnite, symmetric gener-
ating sets of G1 and G2, respectively, such that there is an isomorphism ϕ
from Cay(G1; S1) to Cay(G2; S2). From Theorem 1.11, we know that ϕ
induces a well-deﬁned aﬃne bijection ϕ : G1/N1 → G2/N2. By composing

ISOMORPHISMS OF CAYLEY GRAPHS ON NILPOTENT GROUPS

11

with a left-translation, we may assume ϕ is a group isomorphism. Obvi-
ously, this implies G1/N1 ∼= G2/N2. Also, since ϕ is a well-deﬁned bijection,
we must have ϕ(N1) = N2. Since ϕ is a bijection, this implies |N1| = |N2|.

(⇐) Let

• ϕ be an isomorphism from G1/N1 to G2/N2,
• S1 be a ﬁnite generating set of G1/N1, with e /∈ S1,
• S2 = ϕ(S1) be the corresponding generating set of G2/N2, and
• Si = { s ∈ Gi | sNi ∈ Si }, for i = 1, 2.

(cid:3)

Cay(G2; S2).

Let n = |N1| = |N2|, and let En be the edgeless graph on n vertices.
Then, for i = 1, 2, it is easy to see that Cay(Gi; Si) is isomorphic to the

Proof of Corollary 1.13. Let H be a sharply transitive, nilpotent sub-

wreath product Cay(cid:0)Gi/Ni; Si(cid:1)[En]. Since it is obvious that ϕ is an isomor-
phism from Cay(cid:0)G1/N1; S1(cid:1) to Cay(cid:0)G1/N2; S2(cid:1), we have Cay(G1; S1) ∼=
group of Aut(cid:0)Cay(G; S)(cid:1). Then a well-known result of G. Sabidussi tells
A.20!
us that Cay(G; S) is isomorphic to a Cayley graph on H [7, Prop. 1.1], so   see
of G with α(S) = S′. Therefore, since H is a sharply transitive subgroup of   see
A.21!
Aut(cid:0)Cay(G; S)(cid:1) that is isomorphic to G, a well-known theorem of L. Babai
tells us that H is conjugate in Aut(cid:0)Cay(G; S)(cid:1) to the left-regular represen-
tation of G [7, Thm. 4.1]. However, Corollary 1.7 states that the left-regular   see
A.22!
representation has no other conjugates in Aut(cid:0)Cay(G; S)(cid:1), so we conclude

Corollary 1.12 implies G ∼= H.
From Theorem 1.3, we see that if S′ is any symmetric, ﬁnite subset of G,
such that Cay(G; S′) ∼= Cay(G; S), then there is a group automorphism α

that H is equal to the left-regular representation of G.

note

note

note

(cid:3)

5. Other groups that have torsion

In this section, we prove Proposition 1.9. In fact, we prove a more speciﬁc

version of Proposition 1.9:

Proposition 5.1. Suppose F is a nontrivial, ﬁnite subgroup of a group G,
and S is any ﬁnite, symmetric generating set for G. Then Cay(G; F SF ) is
a connected Cayley graph of ﬁnite valency that is not normal.

Proof. It is straightforward to verify that F SF is a symmetric, ﬁnite gener-

A.23!
ating set of G, so Cay(G; F SF ) is a connected Cayley graph of ﬁnite valency.   see
in the coset gF have the same neighbours. Therefore, if we choose some   see
A.24!

Furthermore, for all g ∈ G, it is straightforward to check that all vertices
h ∈ gF (with h 6= g), then there is an automorphism ϕ of Cay(G; F SF )
that interchanges g and h, but ﬁxes all other vertices of the Cayley graph.
Since G is inﬁnite, but F SF is ﬁnite, we may assume g has been chosen so
that gF is disjoint from F SF ∪ {e}. Then ϕ ﬁxes e, but is obviously not a
group automorphism, since it ﬁxes every element of the generating set F SF ,

note

note

12

DAVE WITTE MORRIS, JOY MORRIS AND GABRIEL VERRET

and is not the identity map (since it moves g to h). So ϕ is not an aﬃne
bijection.
(cid:3)

References

[1] Conner, G.R. Properties of translation numbers in nilpotent groups. Comm. Algebra

26 (1998) 1069–1080. MR1612184 (99d:20051), Zbl 0902.20015

[2] Godsil, C.D. On the full automorphism group of a graph. Combinatorica 1 (1981)

243–256. MR0637829 (83a:05066), Zbl 0489.05028

[3] Gromov, M. Groups of polynomial growth and expanding maps. Inst. Hautes ´Etudes

Sci. Publ. Math. 53 (1981) 53–73. MR0623534 (83b:53041), Zbl 0474.20018

[4] Hall, P. The Edmonton notes on nilpotent groups. Queen Mary College Mathematics
Notes. Mathematics Department, Queen Mary College, London, 1969. MR0283083
(44 #316), Zbl 0211.34201

[5] Kopytov, V.M.; Medvedev, N.Ya. Right-ordered groups. Consultants Bureau,

New York, 1996. MR1393199 (97h:06024b), Zbl 0896.06017

[6] Lennox, J.C.; Robinson, D.J.S. The theory of inﬁnite soluble groups. Oxford Uni-

versity Press, Oxford, 2004. MR2093872 (2006b:20047), Zbl 1059.20001

[7] Li, C.H. On isomorphisms of ﬁnite Cayley graphs—a survey. Discrete Math. 256

(2002) 301–334. MR1927074 (2003i:05067), Zbl 1018.05044

[8] L¨oh, C. Which ﬁnitely generated Abelian groups admit isomorphic Cayley graphs?

Geom. Dedicata 164 (2013) 97–111. MR3054618, Zbl 1266.05059

[9] M¨oller, R.G.; Seifter, N. Digraphical regular representations of inﬁnite ﬁnitely
generated groups. European J. Combin. 19 (1998) 597–602. MR1637768 (99i:20007),
Zbl 0905.05036
J.

Preprint.

problem

The

CI

[10] Morris,

for

inﬁnite

groups.

http://arxiv.org/abs/1502.06114

[11] Robinson, D.J.S. A course in the theory of groups, 2nd ed. Springer-Verlag, New

York, 1996. MR1357169 (96f:20001), Zbl 0836.20001

[12] Ryabchenko, A.A. Isomorphisms of Cayley graphs of a free abelian group (Russian).
Sibirsk. Mat. Zh. 48 (2007) 1142–1146; English translation in Siberian Math. J. 48
(2007) 919–922. MR2364633 (2008i:05085), Zbl 1164.05382

[13] Sharf, M. Isometries of some simple Cayley graphs. MathOverﬂow #200836,

http://mathoverflow.net/q/200836.

Department of Mathematics and Computer Science, University of Lethbridge,
Lethbridge, Alberta, T1K 3M4, Canada
dave.morris@uleth.ca

Department of Mathematics and Computer Science, University of Lethbridge,
Lethbridge, Alberta, T1K 3M4, Canada
joy.morris@uleth.ca

Centre for the Mathematics of Symmetry and Computation, The University
of Western Australia, 35 Stirling Highway, Crawley, Western Australia,
6009, Australia
Also affiliated with FAMNIT, University of Primorska, Glagoljaˇska 8, SI-
6000 Koper, Slovenia.
gabriel.verret@uwa.edu.au

Notes to aid the referee

13

Appendix A. Notes to aid the referee

A.1. See Remark 1.14(4) for an example of isomorphic Cayley graphs on
non-isomorphic groups.

Deﬁnition A.1.1. Let S be a subset of a group G.

• S is symmetric if it is closed under inverses; that is, s−1 ∈ S for all
s ∈ S.
• If S is symmetric, then the corresponding Cayley graph on G is the
graph Cay(G; S) whose vertices are the elements of G, and with an
edge g

gs, for all g ∈ g and s ∈ S.

Remark A.1.2. It is easy to see that Cay(G; S) is connected if and only if
S generates G.

A.2. We show that Theorem 1.3 implies Theorem 1.1. Let ϕ be an iso-
morphism from Cay(G1; S1) to Cay(G2; S2). From Theorem 1.3, we know
there exist a group isomorphism α : G1 → G2 and h ∈ G2, such that
ϕ(x) = h · α(x), for all x ∈ G1. Since α is a group isomorphism, we have
G1 ∼= G2.

A.3. The left-regular representation of G is the set { ˆg | g ∈ G} of permu-
tations of G, where ˆg : G → G is deﬁned by ˆg(x) = gx for x ∈ G. Since

cgh = ˆg ˆh, this is a subgroup of the symmetric group on the set G.

A.4. It is clear that ϕ is a bijection. The neighbours of aibj are ai±1bj and
aibj±1. These neighbours are mapped by ϕ to

and

bi±1aj = biaj · b±1 = ϕ(aibj)b±1
biaj±1 = biaj · a±1 = ϕ(aibj)a±1,

which are neighbours of ϕ(aibj). So ϕ is a graph automorphism.

Suppose ϕ is an aﬃne bijection. Since ϕ(e) = e (and ϕ is a bijection),
this implies that ϕ is an automorphism of the group G. However, we have
ϕ(a) = b, and no automorphism of G can map a to b, since hai ⊳ G, but
hbi 6 ⊳ G. This is a contradiction.

14

Notes to aid the referee

A.5. Proposition 2.1 follows from the following weaker conclusion that does
not require the assumption that Si generates Gi.

Lemma A.5.1. Assume

• G1 and G2 are torsion-free, abelian groups,
• Si is a symmetric, ﬁnite subset of Gi, for i = 1, 2, and
• ϕ is an isomorphism from Cay(G1; S1) to Cay(G2; S2).

(This

causes no loss of generality, since ϕ(cid:0)ghS1i(cid:1) = ϕ(g)hS2i for all g ∈ G, but

Then, for each g ∈ G1 and s ∈ S1, there exists σg(s) ∈ S2, such that
ϕ(gsk) = ϕ(g) σg(s)k for all k ∈ Z.
Proof. To simplify the notation, assume hSii = Gi for i = 1, 2.
a detailed proof works with cosets of hSii, instead of the subgroup hSii
itself.) Lemma 2.11 provides s1 ∈ S1, such that [sk
k=−∞ is a convex geo-
desic line in Cay(G1; S1). Then [gsk
k=−∞ is also a convex geodesic line in
Cay(G1; S1) (since left-translation is an automorphism of the Cayley graph).
Applying the isomorphism ϕ yields the convex geodesic line [ϕ(gsk
k=−∞ in
Cay(G2; S2). Now Lemma 2.4 implies that all edges in this geodesic line have
the same label (since G2 is abelian). This means there is some σg(s1) ∈ S2,
1) = ϕ(g) σg(s1)k for all k ∈ Z. This is the desired conclusion
such that ϕ(gsk
for s = s1.
Now, we make the important observation that if σg(s) exists, for some
s ∈ S1, then σg(s) = σh(s) for all g, h ∈ hS1i. Namely, for all k ∈ Z, we have

1)]∞

1]∞

1]∞

distS1(g, h) = distS1(gsk, hsk)

= distS2(cid:0)ϕ(gsk), ϕ(hsk)(cid:1)
= distS2(cid:0)ϕ(g) σg(s)k, ϕ(h) σh(s)k(cid:1),

so Lemma 2.7(10) tells us that σg(s) = σh(s).

(G1 is abelian)

(ϕ is an isomorphism)

1) to Cay(G2; S′

i = Si r {s±1

Therefore, σg(s1) is a constant (since we assumed at the start of the
proof that hS1i = G1; without this assumption, it would only be constant
on cosets of hS1i). Calling this constant s2 yields ϕ(gs1) = ϕ(g) s2 for
all g ∈ G1. Letting S′
i } for i = 1, 2, this implies that ϕ is an
isomorphism from Cay(G1; S′
2). By induction on the valency,
we conclude that the desired σg(s) exists for all s ∈ S1 r {s±1
1 }. Since the
ﬁrst paragraph provides σg(s1), this completes the proof.
Proof of Proposition 2.1. Since hS1i = G1, the second paragraph of the
proof of the lemma tells us that σg(s) = σh(s) for all g, h ∈ G1, so we
may drop the subscript: ϕ(gs) = ϕ(g) σ(s) for all g ∈ G1 and s ∈ S1.
Since S1 generates G1, and ϕ is a bijection, this implies that ϕ is an aﬃne
bijection.
(cid:3)

(cid:3)

Notes to aid the referee

15

A.6. Let g ∈ G and x ∈ √N . There is some k > 0 with xk ∈ N . Since

N E G, we have

(g−1xg)k = g−1xkg ∈ g−1N g = N,

so g−1xg ∈ √N . Therefore √N E G.
Suppose g√N is a torsion element of G/√N . This means there is some
k 6= 0 with(cid:16)g√N(cid:17)k
= √N , so gk ∈ √N . This means there is some ℓ 6= 0
with (gk)ℓ ∈ N . Therefore gkℓ ∈ N (and kℓ 6= 0), so g ∈ √N . Therefore
g√N is trivial. So G/√N is torsion-free.

A.7.

Lemma A.7.1 ([4, Lem. 2.6, p. 9]). Let G be nilpotent of class c and let H
be a proper subgroup of G. Deﬁne H0 = H and, inductively, Hi+1 to be the
normalizer of Hi in G. Then

H = H0 < H1 < ··· < Hr = G

for some r ≤ c.
Proof of Lemma 2.7(7)). Let Hi be as in Lemma A.7.1. Since Hi+1 is
the normalizer of Hi, we may write

From Lemma 2.7(6) and induction, we have

H = H0 ⊳ H1 ⊳ ··· ⊳ Hr = G.

rank G = rank H +

rank(Hi/Hi−1).

rXi=1

So rank H ≤ rank G, with equality if and only if rank(Hi/Hi−1) = 0 for all i.
Since it is clear that rank F = 0 if and only if F is ﬁnite, this means that
rank H = rank G if and only if Hi/Hi−1 is ﬁnite for all i. This is the case if
and only if G/H is ﬁnite.
(cid:3)

16

Notes to aid the referee

A.8. If we take the special case of π-isolated where π is the set of all prime
numbers, [6, 2.3.8(i), p. 42] says:

Suppose H is a subgroup of a torsion-free, nilpotent group G.
Then CG(H) is isolated for every subgroup H.

To say that CG(H) is “isolated” means that if gk ∈ CG(H) for some nonzero
k ∈ Z, then g ∈ CG(H) [6, ﬁrst paragraph of §2.3, p. 38].
Now, suppose h has only ﬁnitely many conjugates. This means CG(h)
is a ﬁnite-index subgroup of G, so there is some nonzero k ∈ Z, such that
gk ∈ CG(h) for all g ∈ G. From the preceding paragraph, we conclude that
g ∈ CG(h). Since g is an arbitrary element of G, this means h ∈ Z(G).

A.9. Since distS(ak, gbk) is bounded as a function of k, we know that

{ a−kgbk | k ∈ Z} is ﬁnite.

Hence, there exist k 6= ℓ, such that a−kgbk = a−ℓg bℓ, so, letting m =
ℓ − k 6= 0, we have g−1amg = bm. In other words, (g−1ag)m = bm. Since G
is torsion-free nilpotent, this implies g−1ag = b [6, 2.1.2, p. 30].

A.10. The paper [1] uses the following notation:

ric”)

• [1, Defns. 2.2 and 2.3] kxk = distS(e, x) (this is called a “word met-
• [1, Lem. 2.43(i)] τ (x) = limn→∞ kxnk/n
• [1, Defn. 2.5] I(G) = { g ∈ G | τ (g) = 0}
• [1, Defn. 3.1] B(G) = { g ∈ G | τ (gx) = τ (x), ∀x ∈ G}.
• [1, Notn. 3.2(ii)] G′ = [G, G]

Lemma A.10.1 ([1, Lem. 3.5(i,iii)]). Let G be a nilpotent group. Then

(iii) If G is ﬁnitely generated and equipped with a word metric then

(i) B(G) = I(G)
B(G) = √G′.

Proof of Lemma 2.7(11). Translating to the notation of [1], we have

distS(e, gk)/k → 0 ⇔ kgkk/k → 0 ⇔ τ (g) = 0 ⇔ g ∈ I(G).
From Lemma A.10.1, we have I(G) = B(G) = √G′ =p[G, G].

(cid:3)

Notes to aid the referee

17

A.11. We have

x ≺′ y ⇒ x−1 ≺ y−1 ⇒ b−1x−1a−1 ≺ b−1y−1a−1 ⇒ axb ≺′ ayb,
so ≺′ is invariant under both left-translations and right-translations.

Also, from the deﬁnition of ≺′, we have s (cid:23) (S∪S−1) ⇔ s−1 (cid:23)′ (S∪S−1).

A.12. Since a (cid:22) b, invariance under right-translations implies ac (cid:22) bc (with
equality iﬀ a = b). Since c (cid:22) d, invariance under left-translations implies
bc (cid:22) bd (with equality iﬀ c = d). Now transitivity implies ac (cid:22) bd (with
equality iﬀ a = b and c = d).
For the base case of a proof by induction, note that the maximality of s
implies s1 (cid:22) s (with equality iﬀ s1 = s). Now suppose s1s2 ··· sk (cid:22) sk (with
equality iﬀ s1 = s2 = ··· = sk = s). Since s1s2 ··· sk (cid:22) sk and sk+1 (cid:22) s, we
have

s1s2 ··· sk+1 = s1s2 ··· sk · sk+1 (cid:22) sk · s = sk+1,

with equality iﬀ s1s2 ··· sk = sk and sk+1 = s. However, we have already
noted that s1s2 ··· sk = sk implies s1 = s2 = ··· = sk = s.

A.13. Let h = ϕ(e), and deﬁne ϕ′(x) = h−1 · ϕ(x). Then ϕ′ is an isomor-
phism from Cay(G1; S1) to Cay(G2; S2) with ϕ′(e) = e. If ϕ′ is an aﬃne
bijection, then ϕ is also an aﬃne bijection.

A.14. Let h = ϕ(g), and deﬁne ϕ′(x) = h−1 · ϕ(gx). Then ϕ′ is an iso-
morphism from Cay(G1; S1) to Cay(G2; S2) with ϕ′(e) = e. If there is some
g′ ∈ G2, such that ϕ′(zk) = ϕ′(e) (g′)k, for all k ∈ Z, then

ϕ(gzk) = h · ϕ′(zk) = ϕ(g) · ϕ′(e) (g′)k = ϕ(g) (g′)k,

so we may let σg(z) = g′.

A.15. The deﬁnition of S∗
Since g2 = ϕ(z), we may let ψ be the composition ρ ◦ ϕ.

2 provides ρ ∈ Aute(cid:0)Cay(G2; S2)(cid:1) with ρ(g2) = s.

18

Notes to aid the referee

1 = G1, so Lemma 2.7(5)

1] has ﬁnite index in [G1, G1] (see Lemma 2.7(2)). This is a con-

A.16. Suppose G∗
implies

1, G∗
so [G∗
tradiction.

1 has ﬁnite index in G1. ThenpG∗
1] ⊆q[G∗
[G1, G1] = [pG∗

1,pG∗

1, G∗

1],

to Γr
2.

A.17. For a graph Γ and r ∈ Z+, the rth power of Γ is the graph Γr with
the same vertex set as Γ, and with an edge from u to v iﬀ distΓ(u, v) ≤ r.
It is clear that:
• Any isomorphism from Γ1 to Γ2 is also an isomorphism from Γr
• Cay(G; S)r = Cay(G; Sr), where Sr is the set of all elements of G

that can be written as a product of ≤ r elements of S.
1 is ﬁnitely generated, it has a ﬁnite generating set. For any suﬃ-
1. Since ϕ is an isomorphism
2), there is no harm in replacing S1 and S2

Since Z †
ciently large r, this ﬁnite set is contained in Sr
from Cay(G1; Sr
1) to Cay(G2; Sr
with Sr
1 and Sr
2.

1

A.18. We have

i =qZ(Gi) ∩p[Gi, Gi]
qZ †
=pZ(Gi) ∩qp[Gi, Gi]
= Z(Gi) ∩p[Gi, Gi]

= Z †
i

(deﬁnition of Z †
i )

√K)

(√H ∩ K = √H ∩
(Lemma 2.7(4) andq√H = √H)

(deﬁnition of Z †

i ),

so G/Z †

i is torsion-free.

A.19. Suppose we can show that the result is true for hN ∗i. Let f be an
automorphism of Cay(G; S) that ﬁxes e, and let f ∗ be the restriction of
f to hN ∗i. Since N ∗ is invariant, we know that f ∗ is an automorphism
of Cay(hN ∗i; N ∗). Also, it is clear from the deﬁnition of N ∗ that N is
contained in N ∗. (Also, hN ∗i/N is bi-orderable, because it is a subgroup of
G/N .) Therefore, if we know the theorem is true for hN ∗i, then f ∗(N ) is
contained in N . Since f ∗(N ) = f (N ), this means that f (N ) is contained in
N , as desired.

Notes to aid the referee

19

A.20.

Proposition A.20.1 (Sabidussi, 1964). A graph Γ is isomorphic to a Cay-
ley graph on a group G if and only if Aut Γ contains a sharply transitive
subgroup that is isomorphic to G.

Now, let N be the torsion subgroup of H. Since G and H both have a
Cayley graph isomorphic to Cay(G; S) (and the torsion subgroup of G is
trivial), Corollary 1.12 tells us that G/{e} ∼= H/N and |{e}| = |N|. So
G ∼= H.

A.21. Let ϕ be an isomorphism from Cay(G; S) to Cay(G; S′). From The-
orem 1.3, we know that ϕ is an aﬃne bijection, so there exist a group
automorphism α of G and h ∈ G, such that ϕ(x) = h · α(x) for all x ∈ G.
Since ϕ is a graph isomorphism, we have ϕ(xS) = ϕ(x)S′ for all x ∈ S.
Taking x = e, this yields

h · α(S) = ϕ(eS) = ϕ(e)S′ = h · α(e)S′ = h · S′,

so α(S) = S′.

A.22. The following result is traditionally stated only for ﬁnite groups, but
the same proof works in general.

Proposition A.22.1 (Babai, 1977). For a group G, the following two con-
ditions are equivalent:

• whenever S and S′ are ﬁnite, symmetric generating sets of G and
Cay(G; S) ∼= Cay(G; S′), there is an automorphism α of G with
α(S) = S′;

• for every ﬁnite, symmetric generating set S of G, the left-regular rep-
that is isomorphic to G and acts sharply transitively on the vertices
of Cay(G; S).

resentation of G is conjugate to every subgroup of Aut(cid:0)Cay(G; S)(cid:1)

A.23. We have (F SF )−1 = F −1S−1F −1 = F SF (since F and S are sym-
metric), so F SF is symmetric. Also, it is clear that F SF is ﬁnite, since F
and S are both ﬁnite. Finally, since e ∈ F (because F is a subgroup), we
have S = e · S · e ⊆ F SF , so F SF generates G.

A.24. For f ∈ F , the set of neighbours of gf is gf · F SF = g · (f F ) · SF =
gF SF , which is the set of neighbours of g.

