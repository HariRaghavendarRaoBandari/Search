6
1
0
2

 
r
a

M
 
0
2

 
 
]
T
N
h
t
a
m

.

[
 
 

1
v
7
6
2
6
0

.

3
0
6
1
:
v
i
X
r
a

An asymptotic for Markoﬀ-Hurwitz tuples

Alex Gamburd, Michael Magee and Ryan Ronan

March 22, 2016

Abstract

We establish an asymptotic formula for the number of integer solutions to the Markoﬀ-

Hurwitz equation

x2
1 + x2

2 + . . . + x2

n = ax1x2 . . . xn + k.

When n ≥ 4 the previous best result is by Baragar (1998) [2, 4] that gives an exponential
rate of growth with exponent β that is not in general an integer when n ≥ 4. We give a
new interpretation of this exponent of growth in terms of the unique parameter for which
there exists a certain conformal measure on projective space. In a special case, in light
of the results in [15] our counting result can be rephrased in terms of the simple closed
curves on a special arithmetic 3 times punctured projective plane.

Contents

1 Introduction

1.1 Paper organization . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
1.2 Notation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

2
9
9

2 Markoﬀ-Hurwitz tuples and moves

10
2.1 Basic properties of the Markoﬀ-Hurwitz equation . . . . . . . . . . . . . . . . . 10
2.2 The polynomial semigroup . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 13
2.3 Multiplicities
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 14
Increasing the size of K . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 16
2.4

3 Converting the linear count to the nonlinear count

17
3.1 Acceleration
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 17
3.2 The renewal equation for M . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 20
3.3
Iteration . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 20
3.4 Comparison to the linear count . . . . . . . . . . . . . . . . . . . . . . . . . . . 24
3.5 Using the linear semigroup count to prove Proposition 21 . . . . . . . . . . . . 27

4 The linear semigroup count

31
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 31
4.1 Renewal (again)
4.2 Spectral theory of the transfer operator
. . . . . . . . . . . . . . . . . . . . . . 33
4.3 Proofs of Theorem 9 and 11 given the spectral theorems . . . . . . . . . . . . . 36
4.4 Consequences of uniformly contracting dynamics . . . . . . . . . . . . . . . . . 38
4.5 Behavior of the eigenvalue . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 39

1

5 Dynamics

40
5.1 Setup . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 40
5.2 Overview of the proof of Proposition 43 . . . . . . . . . . . . . . . . . . . . . . 41
5.3 Proof of equations (5.1)-(5.10) . . . . . . . . . . . . . . . . . . . . . . . . . . . . 43

Introduction

1
For integer parameters n ≥ 3, a ≥ 1, and k ≥ 0 consider the Diophantine equation

x2
1 + x2

2 + . . . + x2

n = ax1x2 . . . xn + k.

(1.1)

We call this the generalized1 Markoﬀ-Hurwitz equation. In this paper we count solutions to
(1.1) in positive integers, which we we call Markoﬀ-Hurwitz tuples. More precisely, let V be
the aﬃne subvariety of Cn cut out by (1.1). Writing Z+ for positive integers we are interested
in the size of the set

V (Z+) ∩ B(R)

where B(R) is the ball of radius R in the (cid:96)∞ norm on Rn ⊂ Cn.

When n = 3, a = 3 and k = 0 solutions to (1.1) are called Markoﬀ triples, and the num-
bers that appear therein are called Markoﬀ numbers2. The Markoﬀ numbers are intimately
connected with Diophantine properties of the rationals via the Markoﬀ spectrum [6], and also
with hyperbolic geometry and free groups [1].
The question of counting |V (Z+)∩B(R)| for Markoﬀ triples was ﬁrst investigated by Cohn

[11] in connection with the modular torus, where he proved

C1(log R)2 ≤ |V (Z+) ∩ B(R)| ≤ C2(log R)2

for some positive C1, C2. This was ﬁrst extended to an asymptotic formula in the thesis of
Gurwood [13]. An improved error term was obtained by Zagier in [36, pg. 711], and a very
clean proof of a slightly weaker result can be found in Belyi [5]. The current best result is
due to McShane and Rivin [26]:
Theorem 1 (McShane-Rivin). The number of Markoﬀ triples (x, y, z) with x ≤ y ≤ z ≤ R
is given by

as R → ∞, with C > 0.

M (R) = C(log R)2 + O(log R log log R)

Perhaps somewhat surprisingly, the asymptotic growth for n ≥ 4 is not of the order

(log R)n−1, as was ﬁrst noticed by Baragar [2], who obtained the following result

1Normally k = 0 is considered.
2A long standing conjecture of Frobenius asserts that each Markoﬀ number appears as the maximal entry
of only one triple, up to reordering. If one assumes this conjecture, then the problems of counting Markoﬀ
triples and numbers are the same.

2

Theorem 2 (Baragar). There is a number β = β(n) such that when k = 0, if V (Z+) is
nonempty then for every ε > 0

Ω((log R)β(n)−ε) ≤ |V (Z+) ∩ B(R)| ≤ O((log R)β(n)+ε).

This was strengthened by Baragar in [4] under the same hypotheses to

|V (Z+) ∩ B(R)| = (log R)β+o(1).

(1.2)

(1.3)

In [4] the following bounds for the exponents β(n) were also obtained

β(3) = 2,
β(4) ∈ (2.430, 2.477),
β(5) ∈ (2.730, 2.798),
β(6) ∈ (2.963, 3.048),

and in general

log(n − 1)

log 2

< β(n) <

log(n − 1)

log 2

+ o(n−0.58).

It was suggested by Silverman [34] that β(n) is irrational; in fact, one may wonder whether

this exponent is even algebraic.

The main goal of this paper is to extend Baragar’s exponential rate of growth estimate to

a true asymptotic formula3.
When k > 0 there are certain exceptional families of solutions to (1.1) that have a diﬀerent
quality of growth. We describe these families in Deﬁnition 13 and for ﬁxed k, a, n we write E
for the set of exceptional tuples. We obtain the following Theorem for the asymptotic number
of Markoﬀ-Hurwitz tuples.
Theorem 3. For each (n, a, k) with V (Z+) − E inﬁnite, there is a positive constant c =
c(n, a, k) such that

|(V (Z+) − E) ∩ B(R)| = c(log R)β + o((log R)β).

Here β is the same constant as Theorem 2.
Remark 4. We explain in Section 2.1 that removing E is necessary in Theorem 3 since the
exceptional families have |E ∩ B(R)| = cR + O(1), c > 0 when they are non-empty. On the
other hand, E is non-empty only when k − n + 2 or k − n − 1 is a square.
Remark 5. The issue of the existence and inﬁnitude of integral solutions for general a, k, even
for n = 3, is quite subtle: see [33].

Remark 6. In Theorem 9 we give a new characterization of β as the unique parameter for
which there exists a conformal measure for the action of a linear semigroup on projective
space.

3The techniques in [4] “were inspired in part by Boyd’s work on the Apollonian packing problem [7, 8, 9].”

Boyd’s result was extended to a true asymptotic formula in the work of Kontorovich and Oh [19].

3

Our counting arguments, as in [36] and [2, 4], depend on an inﬁnite descent for solutions
to (1.1) that goes back to Markoﬀ [23] in the case of Markoﬀ triples and Hurwitz [16] in the
higher dimensional setting of n > 3, k = 0. Given x ∈ V (Z+), ﬁxing all of the coordinates of
x except xj and viewing (1.1) as a quadratic polynomial in xj, the other root is given by

(cid:89)

i(cid:54)=j

x(cid:48)
j = a

xi − xj.

Therefore for each j one has the Markoﬀ-Hurwitz move

mj(x1, x2, . . . , xn) = (x1, x2, . . . , a

(cid:124)

xi − xj

, . . . , xn)

(cid:125)

(cid:89)

i(cid:54)=j

(cid:123)(cid:122)

j

that yields a new solution to (1.1). Inﬁnite descent for the Markoﬀ-Hurwitz equation says
that any unexceptional tuple can be reduced to one in a compact set K0 = K0(n, a, k) by a
series of Markoﬀ-Hurwitz moves (cf. Corollary 15).

After renormalizing (1.1), the Markoﬀ-Hurwitz moves {mj} induce the moves

λj(z1, . . . , zn) =

on ordered tuples, where(cid:98)• denotes omission. If all the zi are large, or at least enough of them,

i(cid:54)=j

1 ≤ j ≤ n − 1,

the move λj can be approximated by

z (cid:55)→

(cid:89)

zi − zj

 ,


z1, . . . ,(cid:98)zj, . . . , zn,
(cid:89)
z1, . . . ,(cid:98)zj, . . . , zn,
log z1, . . . , (cid:91)log zj, . . . , log zn,
(cid:88)
 .
y1, . . . ,(cid:98)yj, . . . , yn,
(cid:88)

i(cid:54)=j

i(cid:54)=j

zi

yi

i(cid:54)=j

 .

log zi

γj(y1, y2, . . . , yn) =

(1.4)

Indeed, this is the approach of Zagier [36] in the setting of Markoﬀ triples and Baragar [2] for
general n, a with k = 0. Let

Γ = (cid:104)γ1, . . . , γn−1(cid:105)+

where we have written a ‘+’ to indicate we are generating a semigroup, not a group.

4

to high accuracy relative to the largest entries of z. At the level of logarithms this corresponds
to

(log z1, log z2, . . . , log zn) (cid:55)→

Thus one is naturally led to study the linear semigroup generated by linear maps

The crucial new idea in this work that explains why we are able to make progress on the
counting problem is that we replace4 the generators of Γ with the countably inﬁnite generating
set

TΓ =(cid:8) γA

n−1γj : A ∈ Z≥0, 1 ≤ j ≤ n − 2(cid:9)

and then consider the semigroup

Γ(cid:48) = (cid:104) TΓ (cid:105)+.

Both Γ and Γ(cid:48) are freely generated by their respective generating sets5. Notice that Γ and Γ(cid:48)
preserve the nonnegative ordered hyperplane

 (y1, . . . , yn) ∈ Rn≥0 : y1 ≤ y2 ≤ . . . ≤ yn,

n−1(cid:88)

j=1

H ≡

 ⊂ Rn≥0

yj = yn

(1.5)

and that any element of Γ maps ordered tuples in Rn≥0 into H. Therefore the study of orbits
of Γ and Γ(cid:48) on ordered tuples boils down to the study of orbits in H.
Example 7. When n = 3, the linear map σ : H → H deﬁned by

σ(a, b, a + b) = order (b − a, a, b) ,

(1.6)

where order puts a tuple in ascending order from left to right, is such that for j = 1, 2 we have

σγj.y = y

for all y ∈ H. Repeatedly applying the map σ to a triple (a, b, a + b) with a ≤ b ∈ Z performs
the Euclidean algorithm on a, b. However, one application of σ corresponds in general to less
than one step of the algorithm. Replacing Γ with Γ(cid:48) corresponds to speeding this up so
one whole step of the Euclidean algorithm corresponds to one semigroup generator. As for
counting, the orbit of (0, 1, 1) under Γ is precisely those (a, b, a + b) with (a, b) = 1 and thus
can be counted by elementary methods. This is exploited in Zagier’s paper [36].

We can use the basis

ej = (0, . . . , 0, 1(cid:124)(cid:123)(cid:122)(cid:125)

j

, 0, . . . , 0, 1)

for the subspace spanned by H. This basis clariﬁes the action of Γ(cid:48).
Example 8. When n = 3 the semigroup Γ(cid:48) is generated by the

(cid:18) 0

(cid:19)

gA ≡ γA

2 γ1 =

1

1 A + 1

with respect to the basis {e1, e2}. These generators are classically connected with continued
fractions by the formulae

4See our discussion in Section 3.1 about the beneﬁts of this replacement.

It is inspired by the ‘Time

Acceleration Machine’ described by Zorich in [37, Section 5.3].

5This follows from a similar argument to the proof of Lemma 16 we give below.

5

Figure 1: When n = 4, the semigroup elements map ∆ = H/R+ into a strictly smaller subset.
After iteration this leads to more and more empty space (see also Figure 2). This doesn’t
occur when n = 3, as one can also see from the picture: the action of the group elements γ2
and γ3 on the vertical coordinate axis is a copy of the n = 3 dynamics.

(cid:18) 0

1
1 A1

(cid:19)(cid:18) 0

1
1 A2

(cid:19)

. . .

(cid:18) 0

1
1 Ak

(cid:19)

(cid:18) (cid:63) b

(cid:63) d

(cid:19)

,

=

b
d

=

1

A1 +

A2 +

1
. . .

.

1
Ak

So our semigroups Γ and Γ(cid:48) are natural extensions of the Euclidean algorithm and con-
tinued fractions semigroup to higher dimensions6. We write ∆ = H/R+ and we can view ∆
as a subset of Rn−2 (see Section 5 for details). The key distinction that appears when n ≥ 4
is that

n−1(cid:91)

j=1

∆ (cid:54)=

γj(∆)

ˆ

(cid:88)

γ∈TΓ

and so the induced dynamics on H/R+ has ‘holes’ as we illustrate in Figure 1.

We get a new characterization of the parameter β in terms of the action of Γ(cid:48) on H/R+.
Theorem 9. The β from Theorem 2 is the unique parameter in (1,∞) such that there exists
a probability measure νβ on ∆ = H/R+ with the property

ˆ

f (w) dνβ(w) =

w∈∆

w∈∆

f (γ.w)|Jacw(γ)| β

n−1 dνβ(w)

for all f ∈ C0(∆). We call νβ a conformal measure.

6See [37] for the discussion of such an extension in the context of translation surfaces.

6

Remark 10. Theorem 9 can be viewed as a partial analog of the connection between the
exponent of growth of a ﬁnitely generated Fuchsian group and the Hausdorﬀ dimension of its
limit set as a result of Patterson-Sullivan theory [30]. In our setting, the lack of any symmetric
space means the parameter β is not in any obvious way connected to the Hausdorﬀ dimension
of the compact Γ(cid:48)-invariant subset of ∆.

In Section 3.4 we reduce Theorem 3 to a counting Theorem for orbits of the semigroup

Γ(cid:48). The counting quantity that is relevant is

1{log(γ.y)n − log(y)n ≤ a}

(1.7)

N (y, a) ≡ (cid:88)

γ∈Γ(cid:48)∪{e}

(cid:88)

(cid:18) (γ.y)n

(cid:19)−β

γ∈TΓ

yn

for y ∈ H − 0 and a ≥ 0. We prove
Theorem 11. There is a positive bounded C1 function h on H that is invariant under the
action of R+ and such that

for all y ∈ H − 0, where the implied function in the small o does not depend on y. Moreover,
h satisﬁes the recursion

N (y, a) = h(y)eβa(1 + oa→∞(1)).

h(γ.y) = h(y).

(1.8)

The constant β is the same as in Theorem 2.
Remark 12. The embedding of the (n − 1)-dimensional version of H inside the n-dimensional
version implies by Theorem 11 that β(n) ≥ β(n − 1) and in particular that β(n) ≥ 2 for all
n ≥ 3.

Theorem 1 can be rephrased7 as a counting result for the number of simple8 closed curves
of length ≤ log R on the modular torus. This is the topological once-punctured torus that is
uniformized by the quotient of the hyperbolic plane by the group

(cid:68)(cid:18) 1 1

(cid:19)

(cid:18) 1 −1

(cid:19)(cid:69)

1 2

,

−1

.

2

McShane and Rivin [26] actually obtain the analogous counting result to 1 for simple closed
geodesics on arbitrary hyperbolic once punctured tori, by use of a special norm on the ﬁrst
homology of the surface. Mirzakhani proved in [28] an asymptotic counting result, without
explicit error term, for simple closed geodesics on any ﬁnite area complete Riemann surface.
These asymptotics have recently been extended by Mirzakhani [27] to more general orbits of
the mapping class group. In Mirzakhani’s results the exponents of growth are dimensions of
Teichm¨uller spaces. It is interesting to compare this to our characterization of Theorem 9.

In [15], Huang and Norbury show that when n = a = 4 and k = 0, solutions to (1.1)

parameterize ‘Markoﬀ quads’ under

7Modulo the uniqueness conjecture for Markoﬀ numbers.
8This means there are no self crossings.

7

Figure 2: In the same setting (n = 4) of Figure 1, we show in black the images of ∆ under
the action of all words of length 10 in the generators {γ1, γ2, γ3}.

8

(x1, x2, x3, x4) (cid:55)→ (x2

1, x2

2, x2

3, x2

4).

[15, Remark 1]) the orbit of the solution (2, 2, 2, 2) to (1.1) contains tuples
In this case (cf.
whose squares are precisely the lengths of one sided simple closed curves in the quasi-Fuchsian
three cusped projective plane with the largest isometry group9. This is the unique systolic
maximum in the relevant moduli space, just like the modular torus. Our Theorem 3 therefore
provides an asymptotic count for one sided simple curves on this nonorientable arithmetic
surface.

We also mention the recent work of Hu, Tan and Zhang [14] that describes some regions
in Cn where the semigroup of automorphisms of (1.1) acts properly discontinuously. This
extends previous work of Goldman [12] that describes ranges of k in the case of n = 3
where the semigroup of Markoﬀ moves act ergodically or properly discontinuously (or some
combination thereof, on diﬀerent components of the variety). Quite strikingly, for certain
ranges of k the action of Markoﬀ moves is ergodic on V (C), yet there is still an inﬁnite
discrete invariant subset of V (Z). In [14] the authors also prove a ‘McShane identity’ that
gives a closed form expression for 1 in terms of an inﬁnite sum over an orbit of the semigroup;
see [24, 25] for McShane’s original identity.

1.1 Paper organization

We prove our Theorems in the order we have stated them with earlier parts of the paper
depending on later parts. In Section 2 we describe in full the action of the Markoﬀ-Hurwitz
moves on V (Z+). At the end of Section 2 we have ﬁxed a large compact region of V (Z+)
outside of which the orbits of the action of Markoﬀ-Hurwitz generators are a disjoint union
of a ﬁnite number of orbits that we understand well.
In Section 3 we ﬁt the counting of
these orbits to certain counts for the linear semigroup Γ(cid:48). Using Theorem 11 as a black box,
we prove Theorem 3. In Section 4, we prove Theorems 11 and 9 given Proposition 43 that
says the action of Γ(cid:48) on projective space is contracting. It is at this point we establish the
connection with Baragar’s exponent of growth that we call β. Finally, in Section 5 we prove
Proposition 43.

1.2 Notation

For the reader’s convenience we describe the notation we use in this paper. We will use 1
for an indicator function. A vector with an entry ˆ• with a hat means that that entry is
omitted. We use Vinogradov notation O, o,(cid:28),(cid:29) in the standard way. Any implied constants
may depend on n, a, k that we view as ﬁxed throughout much of the paper. If there is any
dependence of an implied constant on a variable we denote this as a subscript e.g. (cid:28), and
we also use subscripts to indicate which variable is tending to a limit, e.g. oa→∞(1). For the
sake of convenience, we take the liberty of applying functions to vectors, which means we
apply the function component-wise, and we write inequalities between vectors to mean that
the inequality holds at every component. For a set S in a semigroup we may write S(k) for
the k-fold product of the set with itself. We also write R+, R≥0 for the sets of positive (resp.

9As explained in [15], this surface is double covered by a negatively curved surface conformally equivalent

to the sphere minus its 6 intersections with the three coordinate axes.

9

nonnegative) real numbers, and similar for integers. We write {x} for the fractional part of a
real number x, that is, x = n + {x} for n ∈ Z and {x} ≥ 0.

Acknowledgements

We would like to thank Peter Sarnak and Giulio Tiozzo for helpful conversations about this
work.

2 Markoﬀ-Hurwitz tuples and moves

2.1 Basic properties of the Markoﬀ-Hurwitz equation

There are certain exceptional families of solutions that while easily counted, behave slightly
diﬀerently to the ‘generic’ solutions.
Deﬁnition 13. We say that x ∈ V (Z+) is an exceptional solution if it belongs to one of the
following two families

1. One has a = 1 and after reordering the coeﬃcients of x so that x1 ≤ x2 ≤ . . . ≤ xn

x1 = x2 = . . . = xn−3 = 1,

xn−2 = 2.

In this case x is a Markoﬀ-Hurwitz tuple if and only if
(xn−1 − xn)2 = k − n − 1.

(2.1)

2. One has a = 2 and after reordering the coeﬃcients of x so that x1 ≤ x2 ≤ . . . ≤ xn

x1 = x2 = . . . = xn−2 = 1.

In this case x is a Markoﬀ-Hurwitz tuple if and only if
(xn−1 − xn)2 = k − n + 2.

(2.2)

If neither of these cases occur we say x is an unexceptional solution.

Note that if (2.1) or (2.2) occur then they occur in an inﬁnite family for that given n, a, k.
In either case, all suﬃciently large integers appear as the maximal entry of some tuple and
this maximal entry determines the tuple up to reordering. Therefore for some c > 0 there are
cR + O(1) tuples with maximal entry ≤ R. This is not the type of growth we want to study
(cf. Theorem 3).

The following Proposition says that outside of a compact set, the eﬀects of the moves
mi on the maximal entries of unexceptional Markoﬀ-Hurwitz tuples are at least somewhat
predictable. This is a very special feature of the Diophantine equation (1.1) that will allow
us to count solutions.
Proposition 14. Suppose k ≥ 0. There is a compact set K0 = K0(n, a, k) such that for
unexceptional x ∈ V (Z+) − K0 the following hold:

10

1. If xj is the largest coordinate of x then the largest entry of mj(x) is smaller than xj,

that is, (mj(x))i < xj for all i.

2. The largest entry of x appears in exactly one coordinate.

3. If xj is not the largest coordinate of x then it becomes the largest after the move mj,

that is, (mj(x))j > (mj(x))i for all i (cid:54)= j. (This property holds for all x ∈ V (Z+).)

4. If xj is not the largest coordinate of x, then the number of distinct entries of mj(x) is
at least the number of distinct entries of x. In particular, if x has distinct entries then
mj(x) has distinct entries.

The compact K0 can be taken to be a closed ball about the origin in the (cid:96)∞ norm on Rn, and
the result still holds after increasing the radius of K0.
Proof of Proposition 14. Part 1. Suppose without loss of generality that x1 ≤ x2 ≤ . . . ≤
xn−1 ≤ xn. Adapting a proof of Cassels from [10, pg. 27], consider the quadratic polynomial
in xn given by

f (T ) = T 2 − ax1x2 . . . xn−1T + x2

1 + x2

2 + . . . + x2

n−1 − k.

n is the last entry of mn(x). The conclusion of Part 1

Then f has roots at xn and x(cid:48)
holds unless

n where x(cid:48)

xn−1 ≤ xn ≤ x(cid:48)

n

or

In either case, since the coeﬃcient of T 2 is positive it follows that f (xn−1) ≥ 0. Then

x(cid:48)
n < xn−1 = xn.

0 ≤ f (xn−1) = −ax1x2 . . . x2
≤ (n − ax1x2 . . . xn−2)x2

n−1 + x2
n−1 − k.

1 + x2

2 + . . . + 2x2

n−1 − k.

Since k ≥ 0 this implies ax1x2 . . . xn−2 ≤ n. This means there are a ﬁnite number of possibil-
ities for x1, x2, . . . , xn−2.

In the case x(cid:48)

n ≥ xn this directly implies

so

Then from (1.1)

and it follows that

ax1x2 . . . xn−2xn−1 − xn ≥ xn

ax1x2 . . . xn−2xn−1xn ≥ 2x2
n.

n ≤ x2
x2

1 + . . . + x2

n−2 + x2

n−1 − k

(xn + xn−1)(xn − xn−1) ≤ x2

1 + . . . + x2

n−2 − k.

11

If xn − xn−1 > 0 then the ﬁnite number of possibilities for x1, x2, . . . , xn−2 yield a ﬁnite
The alternative is that xn = xn−1, and the following logic also applies to the case x(cid:48)

number of possible x.

n <

xn−1 = xn. Then xn is a root of one of ﬁnitely many quadratic polynomials

(2 − ax1 . . . xn−2)x2

n + x2

1 + . . . + x2

n−2 − k = 0.

Again, this yields ﬁnitely many possibilities for x aside from those having x1, . . . , xn−2 such
that 2 − ax1 . . . xn−2 = 0 and x2
n−2 − k = 0. Note that if k = 0 we have exhausted
the possibilities. Otherwise we must have either a = 1 and k = (n − 3)1 + 4 in which case

1 + . . . + x2

or a = 2 and k = n − 2, in which case

x1 = x2 = . . . = xn−3 = 1,

xn−2 = 2,

x1 = x2 = . . . = xn−2 = 1.

These are precisely the exceptional solutions that are ruled out by hypothesis. Therefore for
any given n, a, k only ﬁnitely many unexceptional x do not satisfy Part 1 of the Proposition.
Part 2. If the largest entry of x is not unique then performing the move at one of the
Part 3. Suppose x1 ≤ x2 ≤ . . . < xn and let x(cid:48) = (x(cid:48)

largest entries does not decrease the largest entry, contradicting Part 1.
coeﬃcient x(cid:48)

n) = mj(x) with j < n. The

j is given by

1, . . . , x(cid:48)
(cid:89)

xi − 1

 − xj.

a

i(cid:54)=j,n

j − xn = a
x(cid:48)

xi − xj − xn = xn

(cid:89)

i(cid:54)=j

If a ≥ 2 then the right hand side is ≥ xn − xj > 0 so we are done. If a = 1 and xn−2 ≥ 2 then
we are also done by a similar argument.

The remaining scenario is a = 1 and x1 = x2 = . . . = xn−2 = 1. In this case x satisﬁes the

equation

x2
n−1 + x2

n − xn−1xn = k − n + 2.

The form on the left hand side is positive deﬁnite so only ﬁnitely many possible solutions
exist for (xn−1, xn) given n and k. Add these to the compact set of Part 1.
Part 4. This follows from Part 3 since if x(cid:48) = mj(x) as in the Proposition, then all the
entries of x(cid:48)

i with i (cid:54)= j are distinct, but x(cid:48)

j is larger than all of these.

Corollary 15 (Inﬁnite descent). Any unexceptional Markoﬀ-Hurwitz tuple can be algorith-
mically reduced to one in the compact K0 by a series of Markoﬀ-Hurwitz moves that strictly
decrease maximal entries.

Corollary 15 was established by Markoﬀ [23] in the case n = a = 3 and k = 0. In that case,
every Markoﬀ triple can be reduced to (1, 1, 1) by a series of Markoﬀ moves. Hurwitz [16]
showed the analogous result for n = a > 3 and k = 0 and showed more generally that when
k = 0, the Markoﬀ-Hurwitz tuples can be reduced to a ﬁnite set of fundamental solutions.
These fundamental solutions were characterized by Baragar in [3] whenever a ≥ 2(n − 1)1/2.

12

2.2 The polynomial semigroup

We now perform a normalization that allows us to treat all parameters a, k with a semigroup
action that only depends on n. For x ∈ V (Z+) let

1

n−2 ≥ 1 with equality if and only if a = 1. Then z = (z1, . . . , zn) satisﬁes the

z = a

1

n−2 x.

z2
1 + z2

2 + . . . + z2

n = z1z2 . . . zn + k(cid:48)

(2.3)

Note that a
equation

where

Say that z is exceptional/unexceptional if x has the corresponding property. We will also
work with ordered tuples z so that

k(cid:48) = ka

2

n−2 .

Write M for the set of all such ordered z ∈ a

+ satisfying (2.3). Counting

z1 ≤ z2 ≤ . . . ≤ zn.

1

n−2 Zn
M ∩ B(R)

is not equivalent to counting V (Z+) ∩ B(a
plicate entries. We will return to treat this point in Section 2.3. Let

− 1

n−2 R) due to the presence of elements with du-

K = a

1

n−2 K0

(2.4)

where K0 is the compact set from Proposition 14.

The Markoﬀ-Hurwitz moves {mj} induce the moves

z1, . . . ,(cid:98)zj, . . . , zn,

(cid:89)

 ,

λj(z1, . . . , zn) =

where (cid:98)• denotes omission10. Since K is a closed ball about 0 in the (cid:96)∞ norm, Part 3 of

Proposition 14 implies that the {λj} preserve M − K. Let Λ = Λ(n) denote the semigroup
of piecewise polynomial self-maps of Cn generated by the λj. In Section 2.3 we will reduce
Theorem 3 to an orbital counting estimate. For z0 ∈ M − K let

i(cid:54)=j

zi − zj

1 ≤ j ≤ n − 1,

(2.5)

Λ.z0 ⊂ M − K

denote the orbit of z0 under Λ.
Lemma 16. If z0 ∈ M − K has distinct entries then the map Λ → M − K given by

is injective. It follows that the semigroup Λ is free on the generators {λj}.
10The reason we now have n − 1 moves instead of n is that we never perform the move that will decrease

λ (cid:55)→ λ(z0)

the maximal entry, therefore moving us towards K. This eliminates backtracking from our ‘random walk’.

13

Proof. For the ﬁrst part, if the map is not injective then at some point there must be λ1 ∈ Λ
and some j1 (cid:54)= j2 such that

λj1λ1(z0) = λj2λ1(z0).

(2.6)

Since by Proposition 14, Part 4 the entries of λ1(z0) are distinct we ﬁnd z = λ1(z0) with dis-

tinct entries so that λj1z = λj2z. But this cannot be the case since e.g. the sets {z1, . . . ,(cid:99)zj1, . . . , zn}
and {z1, . . . ,(cid:99)zj2, . . . , zn} are not the same.

For the second part it is enough to ﬁnd some a and k so that there is a point in V (Z+)−K

with all entries distinct. Then freeness of Λ follows from the ﬁrst part of the proof.

Given n we ﬁrst choose some a and k so that V (Z+) contains an inﬁnite orbit. For
example, the orbit of (1, 1, . . . , 1) in the case a = n and k = 0 is inﬁnite and contains no
exceptional points. Then we may ﬁnd z0 outside K with distinct entries, since it is possible
to reduce the number of distinct entries by application of µi.
Speciﬁcally, if z ∈ M − K is such that zj is a duplicate of another entry and is not the
largest entry, then λj reduces the total number of duplicate entries since it removes zj and
creates a distinct new entry by Proposition 14, Part 3.
Lemma 17. If z0 ∈ M − K is unexceptional then all the points in Λ.z0 are unexceptional.
Proof. Consider the case of k = n+1, a = 1. It is enough to show for x = (1, 1, . . . , 1, 2, xn−1, xn) ∈
V (Z+) − K0 with 2 ≤ xn−1 ≤ xn, and mj(x(cid:48)) = x with x(cid:48) in V (Z+) − K0 then x(cid:48) must also
be exceptional. We also assume that x(cid:48)

n ≤ xn. This implies j ≥ n − 2. So we can write

If j = n then

x(cid:48) = (1, 1, . . . , 1, x(cid:48)

n−2, x(cid:48)

n−1, x(cid:48)

n).

x(cid:48) = (1, 1, . . . , 1, 2, xn−1, x(cid:48)

n).

This implies x(cid:48) is exceptional. Otherwise we must have xn = xn−1 and either xn = 2 and
j = n − 2 or j is one of n − 1, n. But in these cases mj(x) = x, so again x(cid:48) is exceptional. as
desired. The case of k = n − 1 and a = 2 is similar.

2.3 Multiplicities

In the rest of the paper we will count in orbits of the free semigroup Λ. It is extremely useful
to be able to work with a ﬁxed free semigroup for each n. The cost of this, however, is that Λ
acts on ordered tuples. Since the original problem was to count points in V (Z+) we therefore
need to take into account the multiplicity of the order map V (Z+) → M.
This is best done in relation to the moves mj. Given x ∈ V (Z≥0) − K0, we say that a

sequence

j1, j2, j3, . . . , jl, . . .

is admissible for x if for all l, jl is not the largest coordinate of
x(l−1) = mjl−1mjl−2 . . . mj2mj1x.

14

Notice then that the largest entries of x(l) are increasing in l and therefore x(l) ∈ V (Z+)− K0
for all l ≥ 1. Also, a sequence is admissible if and only if j1 is not the largest coordinate and
jl (cid:54)= jl−1 for any l ≤ 2. Write Σ∗(x) for the set of all ﬁnite admissible sequences for x.
Lemma 18. Given x ∈ V (Z+) − K0 the map φx : Σ∗(x) → V (Z+) given by

φx(j1, j2, j3, . . . , jl) = mjlmjl−1mjl−2 . . . mj2mj1x

is injective. Note this is regardless of whether x has duplicate entries. Moreover, for any
x, x(cid:48) ∈ V (Z+) − K0, the images of φx and φx(cid:48) are disjoint unless either x(cid:48) ∈ image(φx) or
x ∈ image(φx(cid:48)).
Proof. It is clear from Proposition 14 Part 3 that the mj1x with j1 admissible are distinct. It
is then enough to show φx is injective to show that there are no x (cid:54)= x(cid:48) ∈ V (Z+) − K0 and
j, j(cid:48) admissible for the respective x, x(cid:48) so that mj(x) = mj(cid:48)(x(cid:48)). But since mj(x) has a distinct
largest entry by Proposition 14 Part 2, it has to be the case that j = j(cid:48). Then applying mj
gives x = x(cid:48).
Now suppose x(cid:48) /∈ image(φx) and x /∈ image(φx(cid:48)). If image(φx) ∩ image(φx(cid:48)) (cid:54)= ∅ then
at some point there must have been x(3) (cid:54)= x(4) ∈ V (Z+) − K0 and j, j(cid:48) admissible for
x(3), x(4) respectively so that mj(x(3)) = mj(cid:48)(x(4)). But we have already established this
cannot happen.
Lemma 19. Let x ∈ V (Z+)− K0 and z = order(a
There exists a bijection

n−2 x) the corresponding element of M− K.

1

Θx : Σ∗(x) → Λ
that is an intertwiner for the map x(cid:48) (cid:55)→ z(x(cid:48)) = order(a

1

n−2 x(cid:48)) in the sense that

Θx(j1, j2, . . . , jl).z(x) = z(φx(j1, j2, j3, . . . , jl))

for all (j1, . . . , jl) ∈ Σ∗(x).
Proof. We’ll show for all x(cid:48) there is a one to one correspondence between the admissible
sequences (j) of length 1 and {λj : 1 ≤ j ≤ n − 2} so that Θx(j).z(x) = z(φx(cid:48)(j)). This is
n is ordered (send j (cid:55)→ λj). Otherwise pick an ordering of x(cid:48). The
clear if x(cid:48)
general result follows by repeating this process.
Lemma 20. Let z(1) ∈ M − K and z(2) = λ(z(1)) for some λ ∈ Λ. We have the formula

2 ≤ . . . < x(cid:48)

1 ≤ x(cid:48)

(cid:12)(cid:12)(cid:12)(cid:110)
λ ∈ Λ : λ(z(1)) = z(2)(cid:111)(cid:12)(cid:12)(cid:12) =

|z−1(z(2))|
|z−1(z(1))| ,

(2.7)

in other words, the ratio of the number of lifts of z(2) to V (Z+) to the number of lifts of z(1).
Proof. Let x(1) ∈ V (Z+) − K0 be any element of z−1(z(1)). By Lemmas 18 and 19 the map

(cid:110)
λ ∈ Λ : λ(z(1)) = z(2)(cid:111) → z−1(z(2))

λ (cid:55)→ φx(1)(Θ−1

x(1)(λ)),

is injective. Moreover every x(2) in z−1(z(2)) is in the image of some such map. So the result
will follow from

15

Claim. F or distinct x(1) ∈ z−1(z(1)), the images of the maps above are disjoint.
Proof of Claim. This follows from Lemma 18 if we can show that x(1) /∈ image(φx(1)(cid:48) ) for
all x(1), x(1)(cid:48) ∈ z−1(z(1)). This is true because everything in the image of φx(1)(cid:48) has a strictly
larger maximal entry than x(1)(cid:48)

are permutations of one another.

and x(1), x(1)(cid:48)

Lemma 18 implies that the set V (Z+) decomposes into the ﬁnite set K0 and a ﬁnite

number of orbits of the form

φx(0)(Σ∗(x(0))).

Given x(0), letting z(0) = z(x(0)), one has

(cid:12)(cid:12)(cid:12)φx(0)(Σ∗(x(0))) ∩ B(R)
(cid:12)(cid:12)(cid:12) =

(cid:88)

λ∈Λ

|z−1(λ.z(0))|

(cid:12)(cid:12)(cid:8)λ(cid:48) ∈ Λ : λ(cid:48)(z(0)) = λ(z(0))(cid:9)(cid:12)(cid:12) 1
(cid:111)(cid:33)

(cid:32)(cid:88)

(cid:110)

(λ.z(0))n ≤ R

1

,

= |z−1(z(0))|

λ∈Λ

(cid:110)

(λ.z(0))n ≤ R

(cid:111)

by using the formula (2.7). Therefore, Theorem 3 will follow from asymptotic estimates for
the quantity

(cid:110)

(cid:88)

λ∈Λ

(λ.z(0))n ≤ R

1

(cid:111)

where z(0) ∈ M − K. These estimates are taken up in the next section. We draw the readers
attention to the fact that the count is over Λ and not over M.

2.4 Increasing the size of K

Before we begin the count we increase the size of K. Recall that K and K0 are balls with
center 0 in the (cid:96)∞ norm with radii coupled by (2.4) and that we are free to increase their
radii (maintaining the relationship (2.4)). The following can be thought of as regularizing the
dynamics of M at a ﬁxed scale depending on n, a, k. We state our requirements in terms of
z = (z1, . . . , zn).

First we make sure zn−1 is reasonably large compared to zn. Suppose zn−1 ≤ cz

1
n−1
n

. Then

z1 ≤ z2 ≤ . . . ≤ zn−1 ≤ cz

1
n−1
n

which is a contradiction for c < 1 and zn large enough depending on k(cid:48). We increase the
radius of K so that

(2.8)

(2.9)

(2.10)

. Then (2.3) gives
n ≤ cz2
z2

n + k(cid:48)

zn−1 ≥ 1
2

1
n−1
z
n

for all z ∈ M − K.

Now we make sure zn is large enough so certain inequalities hold. Note that

(n − 1) log(1 − 2z

) − (n − 1) log 2

−1/(n−1)
n
log zn

16

(cid:110)

(cid:88)

λ∈Λ

(λ.z(0))n ≤ R

1

(cid:111)

(3.1)

tends to 0 as zn → ∞. So we increase the radius of K so that

(2.11)
for all z ∈ M − K. It will also be convenient for the sake of simplifying arguments to assume
that

(2.10) ≥ −1/2

for all z ∈ M − K.

zn ≥ 10

We may also increase the radius of K so that

z2
1 + . . . + z2
for all z ∈ M − K, for example by using (2.9).

n−1 − k(cid:48) ≥ 0

(2.12)

(2.13)

3 Converting the linear count to the nonlinear count

3.1 Acceleration

In the last Section 2 we reduced our Main Theorem 3 to obtaining an asymptotic for the
count

where z(0) is one of a ﬁnite set of unexceptional points in M − K. For the rest of the paper
we view z(0) as ﬁxed.

There is a general framework in which to count over the tree-like Λ, called the renewal
method. This was ﬁrst used in counting by Lalley [21] in the setting of Schottky groups. The
essence of the method is a recursion over Λ. Our departure from other uses of renewal in
counting problems is that we perform what we call acceleration. Concretely, we replace the
generators {λj : 1 ≤ j ≤ n} of Λ with the countably inﬁnite set of generators

S = SΛ =(cid:8)λA

n−1λj : A ∈ Z≥0, 1 ≤ j ≤ n − 2(cid:9) .

It is easy to see that SΛ are free generators for the subsemigroup

that contains the words beginning with λj, 1 ≤ j ≤ n − 2. This acceleration is crucial for our
method and has two advantages:

Λ(cid:48) = ∪n−2

j=1 Λ.λj ⊂ Λ

1. The quality of our ﬁtting the nonlinear count for Λ to a linear count to Γ depends on

the size of the quantity

α(z) =

n−2(cid:89)

zj,

j=1

cf. Lemma 25 below. This quantity can be small for long words with respect to the
generators {λj}, because λn−1 does not alter α(z). On the other hand, we prove in
Lemma 24 that α(z) grows doubly exponentially in the word length with respect to the
generators SΛ.

17

2. When we eventually arrive at the dynamics of Γ(cid:48) on P (Rn≥0), the unaccelerated system
would be non-uniformly contracting and therefore we could not expect there to be
a ﬁnite invariant measure for this system. On the other hand, the acceleration we
perform leads to uniformly contracting dynamics (cf. Proposition 43) and in turn to
a nice description of the invariant measure and leading eigenfunction for the transfer
operator in the Ruelle-Perron-Frobenius Theorem (Theorem 37).

Now, the orbit Λ.z(0) breaks up into the countable union of orbits

Λ.z(0) =

Λ(cid:48).λA0

n−1z(0).

(3.2)

∞(cid:91)

A0=0

M0(z, a) ≡ (cid:88)

λ∈Λ∪{e}

(cid:88)

λ∈Λ(cid:48)∪{e}

It is clear that an asymptotic formula for (3.1) is equivalent to an asymptotic formula for

1{log log(λ.z)n − log log zn ≤ a}

(3.3)

when z = z(0). On the other hand, our methods can prove an asymptotic formula for the
following quantity

M (z, a) =

1{log log(λ.z)n − log log zn ≤ a}

(3.4)

for arbitrary unexceptional z ∈ M − K. Precisely, we will obtain the following Proposition.
Proposition 21. For all unexceptional z ∈ M − K there is a positive constant c(cid:63) such that
as a → ∞,

M (z, a) = eβa(c(cid:63)(z) + o(1)),

where β > 1 is the constant from Theorem 2 and the rate of decay in the small o does not
depend on z. Moreover, the c(cid:63)(z) have a uniform bound depending only on n.

The proof of Proposition 21 will occupy the rest of this Section. Before beginning, we
show how Proposition 21 implies our main Theorem 3. This passage relies on the following
elementary Lemma.
Lemma 22. For unexceptional z ∈ M − K we have

n−1z)n ≥ 2Azn.

(λA

Proof. One can calculate easily that for z = (z1, . . . , zn), λA
of the matrix

(cid:18) 0
to the last two entries of z, where α(z) =(cid:81)

gα(z) =

(cid:19)

the rest of the paper. If z = z(x) with x1 ≤ x2 ≤ . . . ≤ xn then

1
−1 α(z)
j≤n−2 zj. This quantity will appear repeatedly in

n−1z is obtained by A applications

α(z) = ax1x2 . . . xn−2 ∈ Z+.

18

If α(z) = 1 then this matrix is torsion and this contradicts the maximal entries of λA
n−1z
growing with A (since z ∈ M − K). If α(z) = 2 then z must be an exceptional solution.
Otherwise α(z) ≥ 3 and if we let ZA = (λA

n−1z) then the ZA satisfy the recurrence

ZA+1 = α(z)ZA − ZA−1 ≥ 2ZA.

Therefore (λA

n−1z)n ≥ 2Azn.
∞(cid:88)

M0(z(0), a) =

Proof of Theorem 3 given Proposition 21. By our previous discussion it suﬃces to prove an
asymptotic formula for M0(z(0), a) for a ﬁxed z(0). But using (3.2) gives

M (λA0

n−1z(0), a − log log(λA0

n−1z(0))n + log log z(0)
n ).

(3.5)

A0=1

By using Lemma 22, the value A0 = Amax where a − log log(λA0
becomes negative is bounded by

n−1z(0))n + log log z(0)

n ﬁrst

Amax ≤ log z(0)
n ea

log 2

.

Let the small o term in Proposition 21 be bounded in absolute value by a positive function
F (a) that → 0 as a → ∞. Let κ be a very small positive constant to be chosen. The A0 such
that a − log log(λA0

n ≥ κa contribute

n−1z(0))n + log log z(0)

(cid:88)

(cid:88)

log z(0)

n eβa

A0:a−log log(λA0

n−1z(0))n+log log z(0)

n )≥κa

c(cid:63)(λA0
(log(λA0

n−1z(0))
n−1z(0))n)β

(1 + O( sup
a(cid:48)≥κa

F (a)).

to (3.5) by Proposition 21. Furthermore, by Lemma 22,

c(cid:63)(λA0
(log(λA0

n−1z(0))
n−1z(0))n)β

≤(cid:88)

A0

c(cid:63)(λA0
n−1z(0))
(A0 log 2)β

A0:a−log log(λA0

n−1z(0))n+log log z(0)

n )≥κa

converges to some limit c∞(z(0)) as a → ∞, using β > 1. Therefore the terms we have
discussed so far give a contribution of

log z(0)

n c∞(z(0))eβa(1 + o(1))

For the remaining A0 such that a−log log(λA0

to M0(z(0), a) via (3.5).
n < κa we use Proposition
21 in a coarser way to get M (z, a) ≤ Ceβa for some constant C, uniformly over unexceptional
z ∈ M − K. Then any remaining A0 contributes at most Ceβκa to (3.5). Therefore the
remaining contributions are in total at most

n−1z(0))n +log log z(0)

AmaxCeβκa ≤ log z(0)

n Ce(1+βκ)a

log 2

which is negligible when 1 + βκ < β, and we can ﬁnd such a κ since β > 1.

19

3.2 The renewal equation for M

We now take up the proof of Proposition 21. Let z(0) be the ﬁxed base point from before. We
will prove Proposition 21 for z = λ0z(0) where λ0 is an arbitrary element of Λ.
shift s : Λ(cid:48) → Λ(cid:48) ∪ {e} by

We now describe the renewal equation, for which we need some new concepts. Deﬁne the

s(λAl

n−1λjlλAl−1

n−1 λjl−1 . . . λA2

n−1λj2λA1

n−1λj1) ≡ λAl−1

n−1 λjl−1 . . . λA2

n−1λj2λA1

n−1λj1.

Now extend this deﬁnition so that s(λλ0) = s(λ)λ0 for all λ ∈ Λ(cid:48) and λ0 ∈ Λ∪{e}. We deﬁne
the distortion function τ(cid:63) : Λ(cid:48).(Λ ∪ {e}) → R≥0 by

τ(cid:63)(λ) ≡ log log(λ.z(0))n − log log(s(λ).z(0))n.

This depends on the constant z(0). One also has the iterated version of distortion

N−1(cid:88)

p=0

(cid:88)

λ(cid:48)∈SΛ

τ N
(cid:63) (λ) =

τ(cid:63)(sp(λ)) = log log(λ.z(0))n − log log(sN (λ).z(0))n.

for any λ ∈ s−N (Λ). The renewal equation for M is then

M (λz(0), a) =

M (λ(cid:48)λz(0), a − τ(cid:63)(λ(cid:48)λ)) + 1{0 ≤ a}

(3.6)

(3.7)

for all λ ∈ Λ. Note that the summation above is ﬁnite since the λ(cid:48) act to strictly increase
maximal entries in M.

3.3

Iteration

The eventual goal is to compare the asymptotics of M (λz(0), a) to those of an analogous
quantity for the linear semigroup Γ introduced in the Introduction. Before this happens, a
In our approach11, the quality of the comparison to the linear
regularization must occur.
semigroup depends on the size of

α(z1, . . . , zn) =

zj.

(cid:89)

j≤n−2

It is clear that no λ ∈ Λ decreases α(z). To pass to the case that α(λ(cid:48).z(0)) is large, we iterate
the renewal equation (3.7) L times. This yields

M (λz(0), a) =

M (λ(cid:48)z(0), a − τ L

(cid:63) (λ(cid:48))) +

(cid:88)

λ(cid:48):sL(λ(cid:48))=λ

L−1(cid:88)

(cid:88)

l=1

λ(cid:48):sl(λ(cid:48))=λ

(cid:110)

(cid:111)
(cid:63)(λ(cid:48)) ≤ a
τ l

1

+ 1{0 ≤ a} ,

(3.8)
recalling the deﬁnition of τ L∗
from (3.6). We now show that for suitable L the last two
summations in (3.8) are negligible. The following Lemma is used at several points in the rest
of the paper.

11In Zagier’s approach in [36] for the case n = a = 3, there is a special mapping arising from the close
connection between the Markoﬀ equation and hyperbolic geometry. This mapping oﬀers a much better ﬁt to
the linear semigroup count than is available in general. See footnote 15 for more on this.

20

As a consequence, for any δ > 0, there is c = c(δ) > 0 such that when L =

Lemma 23. There are constants c0 and c1 depending only on n such that for all L ∈ N,
x ≥ 0

(cid:88)

λ(cid:48):sL(λ(cid:48))=λ

L−1(cid:88)

1(cid:8) τ L
(cid:63) (λ(cid:48)) ≤ x(cid:9) ≤ cL
(cid:111)
(cid:110)
(cid:63)(λ(cid:48)) ≤ a
τ l

1

(cid:88)

λ(cid:48):sl(λ(cid:48))=λ

1 (c0 + x)L ≤ eδx
cL

1 (c0 + x)Lex.

= O(e(1+δ)a)

(cid:109)

(cid:108) ca

log a

(3.9)

one has

(3.10)

(3.11)

l=1

and

for all x ≥ a/2.

Proof. The proof of Lemma 22 can be easily adapted to show that

n−1z)n ≥ (α(z) − 1)Azn.

(λA

This gives

Now,

τ(cid:63)(λA

n−1λjz) = log log(λA

≥ log log((α(λj(z)) − 1)A(λjz)n) − log log zn.

n−1λjz)n − log log zn
(cid:89)
(cid:89)

zi = a

α(λj(z)) =

1≤i≤n−1,i(cid:54)=j

1≤i≤n−1,i(cid:54)=j

xi

1
n−1
n

and hence using (λjz)n ≥ zn,

where x is an integer solution to (1.1) corresponding to z. By using (2.9) we get α(λj(z)) ≥
zn−1 ≥ 1
2 z
(cid:32)
n−1λjz) ≥ log log(
(cid:18)

(cid:32)
2A zA/(n−1)
A
(cid:19)
n − 1
A

)Azn) − log log zn

(n − 1) log(1 − 2z

) − (n − 1) log 2

−1/(n−1)
n
log zn

(1 − 2z−1/(n−1)

n

(cid:33)(cid:33)

≥ log

τ(cid:63)(λA

1 +

1

n

1 +

.

(3.12)

≥ log

1 +

2(n − 1)

where the last inequality is by the previously prepared (2.11).

Now, if λ = λAl

n−1λjlλAl−1

n−1 λjl−1 . . . λA2

n−1λj1 then by l applications of (3.12) we get

l−1(cid:88)

n−1λj2λA1

τ(cid:63)(sp(λ)) ≥ l(cid:88)

p=0

q=1

(cid:18)

log

1 +

Aq

2(n − 1)

(cid:19)

.

τ l
(cid:63)(λ) =

Therefore the number of λ(cid:48) that can contribute to (3.9) is bounded by the size of the set

21

(A1, A2, A3, . . . , AL) ∈ ZL≥0 :

L(cid:88)

q=1

(cid:18)

log

1 +

(cid:19)

≤ x

 .

Aq

2(n − 1)

(3.13)

times the number of possible choices for j1, . . . jL. The latter can be crudely bounded by
(n − 2)L.
Claim. The size of the set in (3.13) is bounded by (2(n − 1)(c0 + x))Lex for some positive

constant c0.

Proof of Claim. We prove this by induction on L. The base case (L = 1) is clear. For the

induction, after choosing the ﬁrst A1 the remaining A2, . . . , AL must have

(cid:18)

log

1 +

L(cid:88)

q=2

(cid:19)

(cid:18)

≤ x − log

1 +

A1

2(n − 1)

(cid:19)

.

So the size of the set in (3.13) is bounded by

(cid:98)2(n−1)ex(cid:99)(cid:88)

A1=1

≤(2(n − 1))L(c0 + x)ex

(2(n − 1))L−1

c0 + x − log

Aq

2(n − 1)

(cid:18)
(cid:98)2(n−1)ex(cid:99)(cid:88)

A1=1

(cid:18)

1 +

A1

2(n − 1)

(cid:19)(cid:19)L−1

ex

1
2(n−1)

1 + A1

1

2(n − 1) + A1

.

The ﬁnal sum is within a constant c0 of x. This completes the proof of the Claim.
2(n − 2)(n − 1). As for the stated consequence, we get

So in total we obtain that the sum in (3.9) is bounded by cL

1 (c0 + x)Lex with c1 =

L−1(cid:88)

(cid:88)

l=1

λ(cid:48):sl(λ(cid:48))=λ

(cid:110)

(cid:111) (cid:28) cL

(cid:63)(λ(cid:48)) ≤ a
τ l

1

1 (c0 + a)Lea.

If we choose L ≈ ca/ log(1 + a) with c small enough depending on δ we obtain our result.

Since we expect M (λz(0), a) ≈ eβa with β = β(n) > 1, choosing parameters as in Lemma

23 gives

M (λz(0), a) =

(cid:88)

λ(cid:48):sL(λ(cid:48))=λ

M (λ(cid:48)z(0), a − τ L

(cid:63) (λ(cid:48))) + O(e(1+δ)a)

(3.14)

and the big O term is truly an error term when δ is small. The beneﬁts to our iteration in
(3.14) can be quantiﬁed in the following.
Lemma 24. There is some C > 0 such that for all λ ∈ Λ ∪ {e} and λ(cid:48) such that sL(λ(cid:48)) = λ,
we have both

and

where φ = 1+

√
2 > 1 is the golden ratio.

5

α(λ(cid:48).z(0)) ≥ 1
2

exp(CφL)

(λ(cid:48).z(0))n ≥ exp(CφL)

22

(3.15)

(3.16)

Proof. For 1 ≤ j ≤ n − 2

(λjz)n =

(cid:89)

i(cid:54)=j

(cid:89)

i(cid:54)=j,n−1,n

since zi ≥ 1 for all i and zn−1 ≥ zj. So then for any A ≥ 0

zi − zj = znzn−1

zi − zj ≥ (zn − 1)zn−1

n−1λjz)n ≥ (λjz)n ≥ (zn − 1)zn−1.

(λA

Then

(λA2

n−1λj2λA1

n−1λj1z)n ≥ ((λA1
≥ ((λA1

n−1λj1z)n − 1)(λA1
n−1λj1z)n − 1)zn

n−1λj1z)n−1

using the inequality (λz)n−1 ≥ zn for any λ ∈ Λ. Therefore the numbers

Zp = (λAp

n−1λjp . . . λA2

n−1λj2λA1

n−1λj1z)n ≥ 10

(cf. (2.12)) satisfy the two stage recursive estimate Zp ≥ (Zp−1 − 1)Zp−2 for p ≥ 2. Then an
elementary argument gives the existence of C such that
Zp ≥ exp(Cφp).

This gives the required (3.16).

On the other hand

α(λA

n−1λjz) ≥ α(λjz) ≥ zn−1 ≥ 1
2

1
n−1
z
n

where the last inequality is by (2.9). The result (3.15) now follows after replacing C with a
suitable smaller constant.

In the sequel we choose

so that (3.14) and 3.11 holds with12

L =

(cid:109)

a

log a

c

(cid:108)
(cid:18) 1

(cid:19)

.

β − 1

2

,

10
Then for all λ(cid:48).z(0) appearing in (3.14) we have

δ = min

α(λ(cid:48).z(0)) ≥ 1
2

exp(Cφca/ log a)

by Lemma 24.

12We know by Remark 12 that β ≥ 2.

23

(3.17)

(3.18)

3.4 Comparison to the linear count
Now we relate the terms M (λ(cid:48)z(0), a) appearing in (3.14) to orbital counting for Γ, the linear
semigroup deﬁned in the Introduction. Begin with the expression for M (λ(cid:48)z(0), a) in (3.4). If
we write S(N ) for the N -fold product13 of the countable generating set S for Λ(cid:48), then we can
write

M (λ(cid:48)z(0), a) =

1{τ N

(cid:63) (λ(2)λ(cid:48)) ≤ a}.

(3.19)

∞(cid:88)

(cid:88)

N =0

λ(2)∈S(N )

We will proceed by

1. Matching λ(cid:48)z(0) with some element of H ⊂ Rn

+ that is very close to14 log(λ(cid:48)z(0)).

2. Matching each λ(2) with an element γ(2) of Γ in the obvious way.
With Part 1 in mind, we deﬁne for z ∈ M

f (z) ≡ (log z1, log z2, . . . , log zn−1,

log zi).

n−1(cid:88)

j=1

The reason to use this map over just taking log of coordinates is that we expect log(z) to
be very close to the hyperplane H deﬁned in (1.5), so we just go ahead and ﬁt log(z) to this
plane. The following Lemma says that when α(z) is big, f (z) is a good15 ﬁt to log(z). In this
paper, we write inequalities between vectors to mean they hold at every coordinate.
Lemma 25. There are C1 and C2 depending only on n such that when z ∈ M − K with
α(z) > C1

log(z) ≤ f (z) ≤ log(z) + C2α(z)−2(0, 0, 0, . . . , 0, 1).

(3.20)

Proof. Since z satisﬁes the equation (2.3), and zn is always the larger of the two quadratic
roots of the resulting quadratic in zn, we have

where

zn =

A(z)

2

A(z) =

(cid:33)

1 +

1 − 4

C(z) − k(cid:48)
A(z)2

(cid:115)

(cid:32)
n−1(cid:89)

i=1

n−1(cid:88)

i=1

zi, C(z) =

z2
i

and k(cid:48) ≥ 0 is the constant from (2.3). Now the ﬁrst inequality of (3.20) follows from (2.13).
13That is, S(N ) is the elements of Λ(cid:48) that are a product of N generators. We extend this deﬁnition to

S(0) = {e}.

14When we write log of a vector we always mean take log of each coordinate.
15Although our f is not even close to being as good as Zagier’s function f from [36]: the quality of ﬁt
of Zagier’s f improves with the size of zn−1 whereas we need zn−2 to be big. This is one reason we must
accelerate.

24

For the second inequality we estimate

A(z)2 ≤ n−1(cid:88)

C(z) − k(cid:48)

i=1

n−1(cid:81)

z2
j(cid:54)=n z2
i

≤ (n − 1)

1(cid:81)

j≤n−2 z2
j

= (n − 1)α(z)−2.

We can then choose C1 large enough so that when α(z) > C1 we have

by increasing C1 again if necessary we obtain

zn = A(z)(1 + On(α(z)−2)),

log(zn) = log(A(z)) + On(α(z)−2) = f (z)n + On(α(z)−2).

The following adapts an idea of Zagier from [36, Proof of Lemma 3] to our setting. While
the strength of approximation is diﬀerent, we take the same approach in noting that if f (z)
is close to y then f (λjz) will be close to γjy. Of course this is designed to be iterated.
Lemma 26. There are C1, C2 depending only on n such that for all  > 0, for z ∈ M − K,
α(z) > min(C1, 2C1/2

−1/2), and for y(1), y(2) ∈ H, if

2

y(1) + (0, 0, . . . 0,

, 1) < f (z) ≤ y(2)

1
2

,

1
2

(3.21)

(3.22)

then

γjy(1) + (0, 0, . . . 0,

, 1) < f (λjz) ≤ γjy(2)

1
2

,

1
2

for all 1 ≤ j ≤ n − 1.
Proof. We ﬁrst prove the upper bound for f (λjz) from (3.22). The inequality f (z) ≤ y(2)
implies that log(zi) ≤ y(2)
for i ≤ n − 1. By Lemma 25 we get log(zn) ≤ f (z)n ≤ yn as well.
Then f (λjz) ≤ γjy(2) follows.

i

For the other inequality, f (z) > y(1) + (0, 0, . . . 0, 1/2, 1/2, 1) implies log(zi) > y(1)

for
i + /2 for i = n − 2, n − 1. By Lemma 25, log(zn) ≥

i

all i ≤ n − 3 and log(zi) > y(1)
f (z)n − C2α(z)−2 ≥ y(1)

n +  − C2α(z)−2. Since α(z) > 2C1/2

−1/2 we get

2

log(zn) ≥ y(1)

n + 3/4.

When i ≤ n − 3 we have f (λjz)i ≥ (γjy(1))i quite clearly. If j ≤ n − 2 we have f (λjz)n−2 =
log zn−1 ≥ y(1)
n−1 + /2 = (γjy(1))n−2 + /2 and if j = n − 1 then f (λjz)n−2 = log zn−2 ≥
n−2 + /2 = (γjy(1))n−2 + /2. At the (n − 1)st coordinate we have f (λjz)n−1 = log zn ≥
y(1)
y(1)
n + 3/4 = (γjy(1))n−1 + 3/4 which is suﬃcient. It remains to check the last coordinate.
Here,

(cid:88)

i(cid:54)=j

log zi ≥(cid:88)

i(cid:54)=j

f (λjz)n =

y(1)
i + 5/4 = (γjy(1))n + 5/4.

The inequality above is due to the fact that at least one of log zn−2, log zn−1 appear on the
left hand side (giving /2) and log zn also appears (giving 3/4).

25

We can now accomplish Parts 1 and 2 of our plan above. Recall we have some ﬁxed

z(0) ∈ M − K. For each given λ(cid:48) ∈ Λ (in particular, those that occur in (3.14)) we deﬁne

y(λ(cid:48)) = f (λ(cid:48)z(0)).

We choose our parameters as follows: let C2 be the constant from Lemma 26 and set

 = (a) = 16C2 exp(−2Cφca/ log a).

(3.23)

so that by (3.18)

for all λ(cid:48) appearing in (3.14).

4C2α(λ(cid:48)z(0))−2 ≤ 

Lemma 27 (Completing Part 1). We have

(1 − )y(λ(cid:48)) + (0, 0, . . . 0,

, 1) < f (λ(cid:48)z(0)) = y(λ(cid:48)).

1
2

,

1
2

Proof. This follows from

f (λ(cid:48)z(0)) ≥ (0, 0, . . . 0,

1
2

,

1
2

, 1).

Now for each

λ(2) = λAN

n−1λjN λAN−1

n−1 λjN−1 . . . λA2

n−1λj2λA1

n−1λj1 ∈ S(N ),

1 ≤ ji ≤ n − 2 ∀i

appearing in (3.19), we set

γ(2) = γ(2)(λ(2)) = γAN

(3.24)
This is the matching of Part 2. Since Λ(cid:48) and Γ(cid:48) are free, this gives a bijective correspondence.

n−1γj2γA1

n−1γjN γAN−1

n−1 γjN−1 . . . γA2

n−1γj1 ∈ Γ(cid:48) ∪ {e}.

The key point now is that by iterating Lemma 26 we obtain for all coupled λ(2), γ(2),

(1 − )γ(2).y(λ(cid:48)) + (0, 0, . . . 0,

, 1) < f (λ(2)λ(cid:48)z(0)) ≤ γ(2).y(λ(cid:48))

1
2

,

1
2

where we have used the linearity of the action of Γ to pull out the factor of (1 − ). Using
Lemma 25 we get

log(λ(2)λ(cid:48)z(0))n ≤ f (λ(2)λ(cid:48)z(0))n ≤ (γ(2).y(λ(cid:48)))n

and

log(λ(2)λ(cid:48)z(0))n ≥ f (λ(2)λ(cid:48)z(0))n − 
4

≥ (1 − )(γ(2).y(λ(cid:48)))n.

Then taking logarithms gives

log log(λ(2)λ(cid:48)z(0))n ≤ log(γ(2).y(λ(cid:48)))n ≤ log log(λ(2)λ(cid:48)z(0))n + 

(3.25)
using  + log(1 − ) ≤ 0 for  < 1. Note (3.25) also holds when γ(2) = e, λ(2) = e. Now we
claim we can reasonably compare each of the M (λ(cid:48)z(0), a− τ L
(cid:63) (λ(cid:48))) from (3.14) to N (y(λ(cid:48)), a(cid:48))
deﬁned in (1.7) with a(cid:48) very close to a − τ L

(cid:63) (λ(cid:48)).

26

Lemma 28. We have
N (y(λ(cid:48)), a − τ L

(cid:63) (λ(cid:48)) − ) ≤ M (λ(cid:48)z(0), a − τ L

(cid:63) (λ(cid:48))) ≤ N (y(λ(cid:48)), a − τ L

(cid:63) (λ(cid:48)) + ).

Proof. We write out

N (y, a(cid:48)) =

(cid:88)

γ(2)∈Γ(cid:48)∪{e}

1{log(γ(2).y(λ(cid:48)))n − log y(λ(cid:48))n ≤ a(cid:48)}

and compare to

M (λ(cid:48)z(0), a − τ L

(cid:63) (λ(cid:48))) =

(cid:88)

1

λ(2)∈Λ(cid:48)∪{e}

(cid:110)

log log(λ(2)λ(cid:48)z(0))n) − log log(λ(cid:48)z(0))n ≤ a − τ L

(cid:63) (λ(cid:48))

(cid:111)

term by term, matching γ(2) with λ(2) as in (3.24). By (3.25) we have

log(γ(2).y(λ(cid:48)))n − log y(λ(cid:48))n ≤ log log(λ(2)λ(cid:48)z(0))n − log log(λ(cid:48)z(0))n + 

and

log log(λ(2)λ(cid:48)z(0))n) − log log(λ(cid:48)z(0))n −  ≤ log(γ(2).y(λ(cid:48)))n − log y(λ(cid:48))n

from which the result follows.

3.5 Using the linear semigroup count to prove Proposition 21
We now use Theorem 11, whose proof will be deferred to Section 4. Let y(cid:48) = y(λ(cid:48)) = f (λ(cid:48)z(0)).

Lemma 29. Let δ be the small constant from (3.17). We have

M (λz(0), a) = (1 + o(1)) eβa (cid:88)

e−βτ L

(cid:63) (λ(cid:48))h(y(cid:48))

(cid:16)

λ(cid:48):sL(λ(cid:48))=λ

(cid:17)

+ O

exp(βaδ + (1 + δ)a)

.

The big and small o terms have implied constant and decay rates that are independent of λz(0).

Proof. Using Lemma 28 in the expression (3.14) gives that up to a negligible O(e(1+δ)a),

(cid:88)

N (y(λ(cid:48)), a −  − τ(cid:63)(λ(cid:48))) ≤ M (λz(0), a) ≤ (cid:88)

N (y(λ(cid:48)), a +  − τ(cid:63)(λ(cid:48))) (3.26)

λ(cid:48):sL(λ(cid:48))=λ

λ(cid:48):sL(λ(cid:48))=λ
where y(λ(cid:48)) = f (λ(cid:48)z(0).

We want to carefully use Theorem 11 that says that along with h, β there is some function

F (a) such that

|N (y, a) − eβah(y)| ≤ F (a)eβah(y)

27

and F (a) → 0 as a → ∞. The minor problem with using this in (3.26) is that there may be
terms with a(cid:48) = a ±  − τ(cid:63)(λ(cid:48)) close to zero, or less than zero. Letting δ be the same small
parameter as before, we note that if a(cid:48) ≤ aδ then there is some constant C3 ≥ 1 such that

|N (y, a(cid:48)) − eβa(cid:48)

h(y)| ≤ C3eβa(cid:48)

which follows from Theorem 11 when 0 ≤ a(cid:48) ≤ aδ and is trivial when a(cid:48) < 0 since then
N (y, a(cid:48)) = 0.

Therefore, working with the right hand inequality of (3.26) we get

M (λz(0), a) ≤ (cid:88)

(cid:16)

λ(cid:48):sL(λ(cid:48))=λ

eβa(cid:48)

h(y(cid:48)) + 1{a(cid:48) ≤ aδ}C3eβa(cid:48)

+ 1{a(cid:48) > aδ}F (a(cid:48))eβa(cid:48)

h(y(cid:48))

(cid:17)

where we write a(cid:48) = a(cid:48)(λ(cid:48)) = a +  − τ L

(cid:63) (λ(cid:48)) and y(cid:48) = y(λ(cid:48)). Therefore

(cid:32)

(cid:33) (cid:88)

M (λz(0), a) ≤

1 + sup
b≥aδ

F (b)

λ(cid:48):sL(λ(cid:48))=λ

eβa(cid:48)

h(y(cid:48)) + C3

(cid:88)

eβa(cid:48)

.

(3.27)

For the ﬁrst term in (3.27) note that

(cid:88)

h(y(cid:48)) = eβa (cid:88)

eβa(cid:48)

λ(cid:48):sL(λ(cid:48))=λ

λ(cid:48):sL(λ(cid:48))=λ

= (1 + O(exp(−2Cφ

eβe−βτ L

(cid:63) (λ(cid:48))h(y(cid:48))

log a )))eβa (cid:88)

ca

The last term in (3.27) can be bounded by

(cid:28) eβa (cid:88)

λ(cid:48):sL(λ(cid:48))=λ

e−βτ L

(cid:63) (λ(cid:48)).

λ(cid:48):sL(λ(cid:48))=λ

a(cid:48)≤aδ

e−βτ L

(cid:63) (λ(cid:48))h(y(cid:48)).

λ(cid:48):sL(λ(cid:48))=λ
(cid:63) (λ(cid:48))≥a+−aδ
τ L

The contributions to the sum above from M − 1 ≤ τ L

1{M ≥ τ L

(cid:63) (λ(cid:48)) ≥ M − 1}e−βτ L

(cid:63) (λ(cid:48)) ≤ M are bounded by
1 (c0 + M )LeM e−β(M−1)

(cid:63) (λ(cid:48)) ≤ cL

(cid:88)

λ:sL(λ(cid:48))=λ

by Lemma 23, equation (3.9). Summing this quantity over natural numbers from M0 =
(cid:98)a − aδ − 1(cid:99) to inﬁnity using the bound (3.11) to replace cL

1 (c0 + M )L by eδM gives

(cid:88)

e−βτ L

(cid:63) (λ(cid:48)) (cid:28) e−(β−1−δ)(a−aδ)

λ(cid:48):sL(λ(cid:48))=λ
(cid:63) (λ(cid:48))≥a+−aδ
τ L

so we get for the last term in (3.27)

28

(cid:88)

λ(cid:48):sL(λ(cid:48))=λ

a(cid:48)≤aδ

eβa(cid:48) (cid:28) exp((β − 1 − δ)aδ + (1 + δ)a).

Therefore it can be absorbed into the error stated in the Lemma. The lower bound for
M (λz(0), a) is similar. Notice that our constants and rates of decay do not depend on λz(0).

Proposition 21 will now follow from Lemma 29 and the following Proposition.

Proposition 30. For ﬁxed λ and z(0) there is a constant c(cid:63)(λz(0)) such that
(cid:63) (λ(cid:48)) = c(cid:63)(λz(0)) + o(1)

h(y(λ(cid:48)))e−βτ L

aL(λz(0)) =

(cid:88)

λ(cid:48):sL(λ(cid:48))=λ

as L → ∞, with a rate of decay that is independent of λ. The values c(cid:63)(λz(0)) are bounded by
some constant independent of λ.

Proof. We are going to prove the sequence is Cauchy with a very fast rate. Consider the
diﬀerence of consecutive terms. Again we write y(cid:48) = y(λ(cid:48)). For λ(cid:48)(cid:48) ∈ SΛ we write y(cid:48)(cid:48) =
y(cid:48)(cid:48)(λ(cid:48)(cid:48), λ(cid:48)) = f (λ(cid:48)(cid:48)λ(cid:48)z(0)). We suppress the dependence of these variables on others to improve
readability.

λ(2):sL+1(λ(2))=λ

We obtain

aL+1 − aL =

=

=

=

(cid:88)
(cid:88)
(cid:88)
(cid:88)

λ(cid:48):sL(λ(cid:48))=λ

λ(cid:48):sL(λ(cid:48))=λ

h(y(cid:48)(cid:48))e−βτ L+1

(cid:63)

λ(cid:48)(cid:48)∈SΛ

 (cid:88)
 (cid:88)
 (cid:88)

λ(cid:48)(cid:48)∈SΛ

e−βτ L

(cid:63) (λ(cid:48))

e−βτ L

(cid:63) (λ(cid:48))

e−βτ L

(cid:63) (λ(cid:48))

λ(cid:48):sL(λ(cid:48))=λ

λ(cid:48)(cid:48)∈SΛ

(λ(2)) − (cid:88)

λ(cid:48):sL(λ(cid:48))=λ

h(y(cid:48))e−βτ L

(cid:63) (λ(cid:48))

(cid:63) (λ(cid:48)))

 − h(y(cid:48))

 − h(y(cid:48))
(cid:33)β − h(y(cid:48))


 .(3.28)

h(y(cid:48)(cid:48))e−β(τ L+1

(cid:63)

(λ(cid:48)(cid:48)λ(cid:48))−τ L

h(y(cid:48)(cid:48))e−βτ(cid:63)(λ(cid:48)(cid:48)λ(cid:48))

(cid:32)

h(y(cid:48)(cid:48))

log(λ(cid:48)z(0))n
log(λ(cid:48)(cid:48)λ(cid:48)z(0))n

The point is that the terms in parentheses should be close to zero by the recursion (1.8)
satisﬁed by h over Γ(cid:48). We will use Lemma 25 which gives a bound when α(λ(cid:48)z(0)) > C1. On
the other hand by Lemma 24 there is some L0 such that when L ≥ L0 and sL(λ(cid:48)) = λ then
α(λ(cid:48)z(0)) > C1.

We use the natural bijection

SΛ → TΓ,

λ(cid:48)(cid:48) (cid:55)→ γ(λ(cid:48)(cid:48)).

When L > L0, repeating the arguments of the previous section leading up to (3.25) gives the
bounds

log(λ(cid:48)z(0))n ≤ y(cid:48)

n ≤ (1 + O(α(λ(cid:48)z(0))−2)) log(λ(cid:48)z(0))n

(3.29)

29

log(λ(cid:48)(cid:48)λ(cid:48)z(0))n ≤ (γ(λ(cid:48)(cid:48)).y(cid:48))n ≤ (1 + O(α(λ(cid:48)z(0))−2)) log(λ(cid:48)(cid:48)λ(cid:48)z(0))n
where the implied constant depends only on n. Moreover, using Lemma 25 gives

(3.30)

log(λ(cid:48)(cid:48)λ(cid:48)z(0)) ≤ y(cid:48)(cid:48) ≤ log(λ(cid:48)(cid:48)λ(cid:48)z(0)) + C2α(λ(cid:48)z(0))−2(0, 0, . . . , 0, 1)

whenever L > L0.

(cid:16)

Suppose L > L0. We must estimate the cost of replacing y(cid:48)(cid:48) by γ(λ(cid:48)(cid:48))y(cid:48) and

y(cid:48)

n

(γ(λ(cid:48)(cid:48))y(cid:48))n

by
O(α(λ(cid:48)z(0))−2 log(λ(cid:48)(cid:48)λ(cid:48)z(0))n) of γ(λ(cid:48)(cid:48)).y(cid:48) and h is C1, we get

in (3.28). Since using (3.30) and (3.31) gives that y(cid:48)(cid:48) is within

(3.31)

(cid:16) log(λ(cid:48)z(0))n

log(λ(cid:48)(cid:48)λ(cid:48)z(0))n

(cid:17)β

h(y(cid:48)(cid:48)) = h(γ(λ(cid:48)(cid:48))y(cid:48)) + O(α(λ(cid:48)z(0))−2 log(λ(cid:48)(cid:48)λ(cid:48)z(0))n).

(cid:17)β

(cid:19)β

(cid:33)β

(cid:18)

≤

y(cid:48)

n

(γ(λ(cid:48)(cid:48))y(cid:48))n

(cid:19)β

(1+O(α(λ(cid:48)z(0))−2))β.

are bounded we get

(cid:18)

h(γ(λ(cid:48)(cid:48))y(cid:48))

y(cid:48)

n

(γ(λ(cid:48)(cid:48))y(cid:48))n

(cid:19)β

+ O(α(λ(cid:48)z(0))−2)

(cid:32)

log(λ(cid:48)z(0))n
log(λ(cid:48)(cid:48)λ(cid:48)z(0))n

(cid:17)β

Using (3.29) and (3.30) gives

(cid:18)

y(cid:48)

n

(γ(λ(cid:48)(cid:48))y(cid:48))n

(1+O(α(λ(cid:48)z(0))−2))−β ≤

(cid:16) log(λ(cid:48)z(0))n

log(λ(cid:48)(cid:48)λ(cid:48)z(0))n

log(λ(cid:48)z(0))n
log(λ(cid:48)(cid:48)λ(cid:48)z(0))n

(cid:17)β
(cid:33)β

(cid:16)

=

y(cid:48)

,

n

(γ(λ(cid:48)(cid:48))y(cid:48))n

(cid:88)

γ(cid:48)(cid:48)∈TΓ

Using that h and

(cid:32)

(cid:88)

λ(cid:48)(cid:48)∈SΛ

h(y(cid:48)(cid:48))

= h(y(cid:48)) + O(α(λ(cid:48)z(0))−2)

where the last equality uses the recursion (1.8). Therefore for L ≥ L0
(cid:63) (λ(cid:48)).

|aL+1 − aL| (cid:28) α(λ(cid:48)z(0))−2 (cid:88)

e−βτ L

λ(cid:48):sL(λ(cid:48))=λ

It is possible to use a fortiori estimates to prove the sum above is universally bounded, for
example by using the work of Baragar [2] in the case of k = 0. To keep things self contained,
since we only need a coarse bound we instead use Lemma 23 to prove

e−βτ L

(cid:63) (λ(cid:48)) (cid:28) exp(C4L1+η)

(3.32)

(cid:88)

λ(cid:48):sL(λ(cid:48))=λ

for some constant C4 and small η. However, α(λ(cid:48)z(0))−2 is much smaller than this: by Lemma
24 we have α(λ(cid:48)z(0))−2 (cid:28) exp(−2CφL) where φ > 1 so not only is
|aL+1 − aL| (cid:28) exp(C4L1+η − 2CφL)

very small but we can sum the diﬀerences to get a Cauchy sequence. Indeed C4L1+η−2CφL ≤
C5 − C6φL for some C5, C6 > 0. Therefore for L1 ≥ L0

30

∞(cid:88)

L=L1

|aL+1 − aL| (cid:28)

∞(cid:88)

L=L1

exp(−C6φL) = oL1→∞(1)

(3.33)

so the sequence converges at a uniform rate to its limit c(cid:63)(λz(0)). The uniform boundedness of
c(cid:63)(λz(0)) will follow from the uniform boundedness of aL0(λz(0)) given (3.33), and aL0(λz(0))
is uniformly bounded by using that h is bounded and the already established (3.32). This
ﬁnishes the proof.

Putting Proposition 30 and Lemma 29 together proves Proposition 21 given Theorem 11.

In the rest of the paper we prove Theorem 11.

4 The linear semigroup count

4.1 Renewal (again)

Now we discuss renewal for the quantity N (y, a) that appears in Theorem 11. The renewal
equation for N (y, a) says

N (y, a) =

N (γ.y, a − log(γ.y)n + log yn) + 1{0 ≤ a}.

(4.1)

(cid:88)

γ∈TΓ

Notice from its Deﬁnition in (1.7) that the function N (y, a) is invariant under multiplica-

tion of the y variable by R+. With this in mind, we are going to consider

the quotient of Rn≥0 by the multiplicative action of positive real numbers. Let ∆ ⊂ P (Rn≥0)
denote the projection of H. We will from now on use a coordinate

P (Rn≥0) = Rn≥0/R+,

with w1 ≤ w2 ≤ . . . ≤ wn−1 and (cid:80)n−1

w = (w1, w2, . . . , wn−1, 1)

j=1 wj = 1 to uniquely represent a point in ∆. We now
view N (w, a) as a function on ∆×R≥0. Note that equation (4.1) descends to (w, a) ∈ ∆×R≥0.
Now, for the ﬁrst time in the paper, we start the full argument of the renewal method16.
This begins with taking a Laplace transform which we deﬁne for general f of suitable decay
by

ˆ ∞

−∞

ˆf (s) =

e−sxf (x)dx.

The outcome of taking a Laplace transform of the renewal equation (4.1) in the a variable,
ignoring issues of convergence17, is that

(cid:88)

(cid:18) wn

(cid:19)s

γ∈TΓ

(γ.w)n

ˆN (w, s) =

ˆN (γ.w, s) +

1
s

(4.2)

16Previously we just used an iteration of a renewal equation to perform a linearization.
17These issues are worked out in Lemma 33.

31

for all w ∈ ∆, where ˆN (w, s) is the Laplace transform (cid:92)N (w,•) in the a variable. Thus s is a
frequency parameter dual to the counting parameter a. Notice that the function

descends from TΓ × H to a well deﬁned real valued function on TΓ × ∆.

(γ, w) (cid:55)→ wn
(γ.w)n

Now enters the transfer operator that will be the subject of much of this Section 4. For a

function f on ∆ we deﬁne

Ls[f ](w) =

(cid:88)

(cid:18) wn

(cid:19)s

γ∈TΓ

(γ.w)n

f (γ.w)

(4.3)

whenever the sum is pointwise absolutely convergent on ∆. Then (4.2) can be rephrased as

ˆN (•, s) = s−1(1 − Ls)−11,

(4.4)
whenever the resolvent operator (1 − Ls)−1 exists in such a way it can act on the constant
function 1.
There is a procedure due to Lalley to convert (4.4) together with a suﬃciently complete
description of the spectrum of Ls on a suitable Banach space into Theorem 11. More speciﬁ-
cally we will appeal to the perturbation theory and Fourier analysis developed in [21, Sections
7 and 8]. In the next Section we will lay out the necessary spectral theory of Ls. Before that,
let us calculate explicitly the sum in (4.3).

Lemma 31. An element γA

n−1γj of TΓ acts on ∆ by

γA
n−1γj.[w1, . . . , wn−1, 1]

= [w1, . . . ,(cid:99)wj, . . . , wn−1, 1 + A(1 − wj), 1 + (A + 1)(1 − wj)] (4.5)

By the same calculation

n−1γj.(w1, . . . wn−1, 1))n = 1 + (A + 1)(1 − wj).
(γA

(4.6)

Proof. This is a direct calculation.

Example 32 (Gauss map). When n = 3, the only inverse branches are of the form

2 γ1(w1, w2) = (1 + (A + 1)w2)−1(w2, 1 + Aw2).
γA

With the change of variables x = w1/w2, these are precisely the inverse branches of the Gauss
x}:
map x (cid:55)→ { 1

2 γ1 : x (cid:55)→
γA

1

x + A + 1

, A ∈ Z≥0.

32

(cid:88)

(cid:88)

j∈[n−2]

A∈N

4.2 Spectral theory of the transfer operator
In this Section, we give a full account of the spectral theory of Ls. We begin with the following.
Lemma 33. When (cid:60)(s) > 1 the summation in the deﬁning equation (4.3) of Ls is absolutely
and uniformly convergent on ∆ and so gives a well deﬁned continuous map of Banach spaces18

Ls : C0(∆) → C0(∆).

Proof. Using Lemma 31, equation (4.6) in the Deﬁnition (4.3), the summation amounts to

Ls[f ](w) =

1

(1 + (A + 1)(1 − wj))s f (γA

n−1γj.w).

(4.7)

Since wj ≤ 1/2 and f is bounded, each sum in L converges uniformly absolutely on ∆ for
(cid:60)(s) > 1. The limit is then continuous and bounded by a constant multiple, depending on s,
of (cid:107)f(cid:107)∞.

We obtain the following consequence of Lemma 33 by a standard application of the

Schauder-Tychonoﬀ Theorem.
Corollary 34 (Existence of eigenmeasures). Let L∗
there is a number λs > 0 and a probability measure νs such that L∗

s denote the dual of Ls. For each real s > 1

sνs = λsνs.

Example 35 (Transfer operator for the Gauss map). Let n = 3. Carrying on from Example
32, we have in the coordinate x = w1/w2

Ls[f ](x) =

(x + 1)s

(x + A + 2)s f

1

x + 1 + A

This is not the usual transfer operator for the Gauss map. However, letting M(x+1)s denote
the operator of multiplication by (x + 1)s, we get

M−1
(x+1)sLsM(x+1)s[f ](x) =

1

(x + A + 1)s f

1

x + 1 + A

= LGauss

s

[f ](x),

the classical transfer operator for the Gauss map. This coincides with the Perron-Frobenius
operator for the Gauss map whenever s = 2. The leading eigenfunction of LGauss
corresponds
to a multiplicity 1 eigenvalue 1 and eigenfunction

2

h(x) =

1

1 + x

.

This eigenfunction was known to Gauss, and its invariance property was formally proved by
Kuzmin [20]. Correspondingly, the leading eigenfunction of L2 is [M(x+1)2h](x) = (x+1) = 1
with eigenvalue 1.

w2

18C 0 is the Banach space of continuous functions with the supremum norm.

33

(cid:88)

A∈N

(cid:88)

A∈N

(cid:18)

(cid:18)

(cid:19)

.

(cid:19)

Our functional analysis takes place on the Banach space C1(∆) which consists of contin-

uously diﬀerentiable functions on ∆ with the norm

(cid:107)f(cid:107)C1 = (cid:107)f(cid:107)∞ + (cid:107)∇f(cid:107)∞.

We use the standard Euclidean metric on ∆ given by the coordinates w1, . . . , wn−1.
Lemma 36. In the region (cid:60)(s) > 1, the mapping s (cid:55)→ Ls gives a holomorphic family of
bounded operators on the Banach space C1(∆). In particular, for (cid:60)(s) > 1, Ls is bounded on
C1(∆).

We will prove the following version of the Ruelle-Perron-Frobenius Theorem.

Theorem 37 (Ruelle-Perron-Frobenius). Let s ∈ (1,∞) be a real parameter for the transfer
operator Ls : C1(∆) → C1(∆).

1. The eigenvalue λs is multiplicity one and the rest of the spectrum of Ls in contained in
a ball of radius R(s) strictly less than λs. For any compact interval I ⊂ (1,∞) there is
an (I) > 0 such that λs − R(s) ≥  for s ∈ I.

2. There is a unique probability measure νs such that L∗
3. The unique eigenfunction hs ∈ C1(∆) for the eigenvalue λs with νs(hs) = 1 is positive.

sνs = λsνs.

In the case of the Gauss map, a version of Theorem 37 was ﬁrst proved by Wirsing [35].
It is well-known that Theorem 37 follows from eventually contracting dynamics for ex-
ample, by the use of Birkhoﬀ cones and contraction of a Hilbert projective metric as in the
paper of Liverani [22]. The only thing that is possibly nonstandard about our setting is the
presence of both countably many branches and a semigroup action for which we expect the
invariant set to have non full Hausdorﬀ dimension (cf. Figures 1 and 2). We explain the proof
of Lemma 36 and Theorem 37 in Section 4.4.

These proofs depend crucially on our dynamics being uniformly contracting, which we

make precise in Proposition 43.
The Ruelle-Perron-Frobenius Theorem is not enough for input to Lalley’s framework of
complex analysis. One must also know that there is some non trivial spectral bound for Ls
on the vertical line s = β + it, the trivial bound being that the spectral radius is ≤ λβ. In
the context of subshifts of ﬁnite type, this was investigated by Pollicott in [32] who found a
cohomological criterion for a nontrivial spectral bound. We make the following Deﬁnition as
in Pollicott [32, pg. 139], adapted to the current setting.

Deﬁnition 38. We say that a function f = u + iv with
u, v : TΓ × ∆ → R

is regular if there is no r ∈ R and G ∈ C1(∆; R) such that

v(γ, w) − G(γ.w) + G(w) − r ∈ 2πZ

for all γ ∈ TΓ and w ∈ ∆. In other words, there is no r ∈ R so that v − r is cohomologous on
∆ to a 2πZ valued function.

34

The following Theorem can be viewed as an an extension of a result of Wielandt on the
spectrum of ﬁnite dimensional complex matrices. It was proved by Pollicott [32, Theorem 2]
in the context of shifts of ﬁnite type in symbolic dynamics. The proof goes through perfectly
well in our context19 to give

Theorem 39 (Wielandt’s Theorem, after Pollicott). If

Fs(γ, w) ≡ −s log

∈ C1(∆; C)

(4.8)

(cid:18) (γ.w)n

(cid:19)

wn

is regular and (cid:60)(s) > 1 then the spectral radius of the operator Ls : C1(∆) → C1(∆) is strictly
less than λ(cid:60)(s).

This is applicable in the present setting:

Proposition 40. For all s ∈ C − R, the function in (4.8) is regular.

Proof. It is enough to show that for

τ (γ, w) = log

(cid:18) (γ.w)n

(cid:19)

wn

there is no G ∈ C1(∆; R) such that the values of

= log(γ.w)n − log wn

τ(cid:48)(γ, w) = τ (γ, w) − G(γ.w) + G(w)

for (γ, w) ∈ TΓ × ∆ are contained in a translate of a discrete subgroup of R. So it is also
enough to show that for any such τ(cid:48), the gaps between distinct values of τ(cid:48) are not bounded
below.

The fundamental simple fact we use is that for γ ∈ TΓ and γ.w = w
τ(cid:48)(γ, w) = τ (γ, w) + G(γ.w) − G(w) = τ (γ, w).

Then it remains to show that gaps between distinct values of τ on the ﬁxed points of γ ∈ TΓ
are not bounded below. We compute that



γA
n−1γn−2 =

1

0
...
0
0
0
A
1
A + 1 ··· A + 1 0 A + 1 1

. . .
···
···

1
0
A

0
1
A

0
0
0

 ,

so (using the block lower triangular structure)

det(γA

n−1γn−2 − T In) == (1 − T )n−3(−T )(T 2 − (A + 1)T − 1).

So the eigenvalues aside from 0 and 1 are

A + 1 ±(cid:112)(A + 1)2 + 4

.

T =

2

19It relies on the Ionescu Tulcea-Marinescu type inequality that we establish in Lemma 44.

35

Let T+be the largest, that is, T+ = A+1+
for T+ where

√

(A+1)2+4
2

> A + 1. One can ﬁnd an eigenvector v+

v+ = (0, 0, . . . , 0, 1, T+, T+(T+ − A)) > 0,

moreover, v+ ∈ H. Now, (γ.v+)n/(v+)n = T+ and so τ (γA
T+ = T+(A), we have

n−1γn−2, [v+]) = log T+. Writing

(cid:32)
A + 2 +(cid:112)(A + 2)2 + 4
A + 1 ±(cid:112)(A + 1)2 + 4
(cid:18)
(cid:19) 1 + 1

1 +

1

A+2 +

(cid:33)
(cid:113)
(cid:113)

A + 1

1 + 1

A+1 +

 → 0

1 + 4

(A+2)2

1 + 4

(A+1)2

log T+(A + 1) − log T+(A) = log

= log

as A → ∞. As the terms are easily seen to be non-zero, this completes the proof.

The contour shifting argument of Lalley revolves around the behavior of the eigenvalue
λs and in particular, the location of the possible real value β such that λβ = 1. Since our
dynamics is suitably uniformly contracting, if such a value exists it is unique:

Proposition 41. The eigenvalue λs is a real analytic function of s that is strictly decreasing
on (1,∞). We have λs < 1 for suﬃciently large s. As such, any value β0 ∈ (1,∞) such that
λβ0 = 1 is unique, and if no such β0 exists then λs < 1 for all s ∈ (1,∞).

As we will discuss momentarily, such a β0 does exist, and it coincides with Baragar’s β
from Theorem 2. Note that when s = β we obtain from Theorem 37 a unique measure such
that L∗
βνβ = νβ. Then we will show νβ is the conformal measure of Theorem 9. Proposition
41 will be proved in Section 4.5.

4.3 Proofs of Theorem 9 and 11 given the spectral theorems

Here we make a sketch of the passage from the spectral theory outlined in Section 4.2 to
Theorems 9 and 11 via (4.4) and the techniques of Lalley from [21]. Firstly, if there is no
value β0 such that λβ0 = 1 then Proposition 41 together with Lemma 36 imply that the
resolvent (1 − Ls)−1 exists as a holomorphic family of bounded operators on C1(∆) in the
region (cid:60)(s) > 1. This would imply by standard contour shifting arguments in combination
with (4.4) that for any η > 0

N (w, a) = O(e(1+η)a).

(4.9)

But this can be used along with the arguments of Section 3 to show for some z in an inﬁnite
orbit of Λ that M (z, a) = O(e(1+η)a) in contradiction to Baragar’s result Theorem 2 when η is
small. Here we use the fact that for any n, there is an inﬁnite orbit in V (Z+) when n = a and
k = 0 coming from the tuple (1, 1, . . . , 1). In fact, for small η, (4.9) is already in contradiction
to some of Baragar’s results from [2] on orbits of the linear semigroup Γ.

Now suppose there is such a β0 > 1 as in Proposition 41. Then Lalleys method of proof of
his analog of Theorem 11 is by a contour shifting argument involving control on meromorphic
behavior of (1 − Ls)−1 in the following two ways:

36

1. By standard results in Linear Perturbation Theory [18, Sections 4.3 and 7.1], Lemma

36 and Theorem 37 Part 1 imply that the functions

s (cid:55)→ λs, s (cid:55)→ hs, s (cid:55)→ νs

extend to holomorphic functions on a neighborhood of the real line segment (1,∞) in
(cid:60)(s) > 1 such that

λs (cid:54)= 0, Lshs = λshs, L∗

sνs = λsνs, νs(hs) = 1.

By suitable spectral decomposition of Ls, one ﬁnds a neighborhood U of s = β0 and
an operator L(cid:48)
s)−1 is a holomorphic family of bounded operators on
C1(∆) for s ∈ U and moreover

s such that (1 − L(cid:48)

(1 − Ls)−1g = (1 − λs)−1νs(g)hs + (1 − L(cid:48)
for s ∈ U − {β0}. This is the analog of [21, Proposition 7.2].

s)−1g

2. By use of Theorem 39 along with its supplement Proposition 40, we obtain that

s (cid:55)→ (1 − Ls)−1

is holomorphic in a neighborhood of every s with (cid:60)(s) = β0, with the exception of
s = β0.

The outcome of Lalley’s argument is that

N (w, a) = hβ0(w)eβ0a + o(eβ0a)

where the decay in the small o does not depend on w. Our argument of Section 3.4 converts
this into a version of Theorem 3 with β replaced by β0. Finally, this contradicts Baragar’s
Theorem 2 unless β = β0. Then Theorem 11 is proved, assuming the Theorems of Section 4.2.

Theorem 9 is now a direct consequence of the following fact:

Lemma 42. For all γ ∈ Γ we have

(γ.w)n

= |Jacw(γ)|− 1
n−1

wn

where |Jacw(γ)| is the absolute value of the Jacobian determinant of γ acting on ∆ = H/R+
at the point w.

This can be checked by a direct calculation on general grounds as in [31, Lemma 2.1], or
by using explicit formulae that appear later in this paper, e.g. by calculating the determinants
of total derivatives we calculate in Section 5.

37

4.4 Consequences of uniformly contracting dynamics
The spectral theorems of the previous section all rely on the action of Γ(cid:48) on ∆ being by
contractions. That can be summarized in the following Proposition.
Proposition 43. There are constants D > 0 and ρ < 1 such that for all γ(1), γ(2), . . . , γ(N ) ∈
TΓ we have

(cid:107)dw[γ(1)γ(2) . . . γ(N )](cid:107)op ≤ DρN

where we view γ(1)γ(2) . . . γ(N ) as a self-map of ∆, using the ﬁxed Euclidean metric on ∆,
dw is the total derivative of the map at w ∈ ∆, and (cid:107) • (cid:107)op is the operator norm of the map
between tangent spaces (using the (cid:96)2 norms coming from the metric).

We will prove Proposition 43 in Section 5. The dynamical Proposition 43 gets brought
into play by the following two-norm inequality with origins in the work of Ionescu Tulcea and
Marinescu [17].
Lemma 44. There is C > 0 so that for any Q ∈ N and (cid:60)(s) > 1

(cid:107)∇LQ

s [f ](w)(cid:107)2 ≤ C|s|LQ

s [|f|](w) + DρQLQ

s [(cid:107)∇f(cid:107)2](w)

for all w ∈ ∆. We write (cid:107) • (cid:107)2 for the pointwise (cid:96)2 norm in an individual tangent space ﬁber.
Proof. This is standard given Proposition 43, it essentially boils down to the chain rule. The
only thing to take care with are the inﬁnite sums that arise, but these are all absolutely
convergent when (cid:60)(s) > 1.

We can now prove Lemma 36.

Proof of Lemma 36. We are proving s (cid:55)→ Ls is a holomorphic mapping to bounded operators
on C1(∆). If we truncate the summation going into the expression (4.7) for Ls at some ﬁxed
L to form

(cid:88)

(cid:88)

j∈[n−2]

A≤L

L(L)
s =

1

(1 + (A + 1)(1 − wj))s f (γA

n−1γj.w),

the resulting L(L)
to show LL
of a n − 2 terms of the form

s

is easily seen to be holomorphic (take a complex derivative). So it remains
s → Ls uniformly on compact sets, say in the norm topology. But the tail consists

(cid:88)

A>L

(Ls − L(L)

s

)[f ](w) =

1

(1 + (A + 1)(1 − wj))s f (γA

n−1γj.w).

Then (cid:107)Ls − L(L)
(cid:60)(s) > 1. On the other hand, the proof of Lemma 44 also applies to Ls − L(L)
when Q = 1 gives

s (cid:107)C0 → 0 as L → ∞ and this is uniform for s in W a compact subset of
, so applying it

s

(cid:107)∇(Ls − L(L)

s

)[f ](cid:107)∞ ≤ C|s|(cid:107)(Ls − L(L)

s

)[|f|](cid:107)∞ + Dρ(cid:107)(Ls − L(L)

s

)[(cid:107)∇f(cid:107)2](cid:107)∞.

This implies

38

(cid:107)Ls − L(L)

s (cid:107)C1(∆) (cid:28)W (cid:107)Ls − L(L)

s (cid:107)C0(∆)

which we’ve established goes to zero uniformly on W.

The proof of the Ruelle-Perron-Frobenius Theorem 37 now proceeds either via use of
Birkhoﬀ cones as in Liverani’s paper [22] or by a more direct approach as in Pollicott [31,
Lemma 2.3]. The classical proof of this Theorem for subshifts of ﬁnite type can be found in
[29, Theorem 2.2]. In any approach Lemma 44 is the key input. The uniform spectral gap
stated in Part 1 of Theorem 37 is a consequence of the uniformity of Lemma 44 for s in a
ﬁxed compact subinterval of (1,∞).

4.5 Behavior of the eigenvalue
In this section we prove Proposition 41. The statement that λs is real analytic on (1,∞)
follows from the fact we noted in the previous Section 4.2 that by perturbation theory in
combination with Theorem 37 Part 1

s (cid:55)→ λs

is holomorphic in a neighborhood of (1,∞) in (cid:60)(s) > 1. Notice we have the bound

(cid:88)

(cid:88)

Ls[f ](w) =

j∈[n−2]

A∈N
≤ (n − 2)(cid:107)f(cid:107)∞

1

(1 + (A + 1)(1 − wj))s f (γA
(cid:88)

1

n−1γj.w)

≤ 2(n − 2)(cid:107)f(cid:107)∞

2 (A + 1))s
Letting f = hs and w such that hs(w) = (cid:107)hs(cid:107)∞ gives

A∈N

(1 + 1

(cid:88)

A∈N

1

(3 + A)s .

(cid:88)

λs ≤ 2(n − 2)

1

(3 + A)s

A∈N

log(cid:0)LN

s [1](w)(cid:1)

so λs → 0 as s → ∞.
of (1,∞). By Theorem 37 λ−N
uniform for s ∈ I. This implies

It remains to show that λs is strictly decreasing in s. Let I be a ﬁxed compact subinterval
s 1 converges in C1 norm to hs and this convergence is

s LN

+ o(1)
where the error is uniform in s ∈ I and w ∈ ∆. We calculate

log λs =

N

(cid:88)

(cid:18) (γ.w)n

(cid:19)−s

γ∈(TΓ)N

wn

LN
s [1](w) =

,

LN
s [1](w) =

d
ds

− log

(cid:88)

γ∈(TΓ)N

(4.10)

(cid:18) (γ.w)n

(cid:19)(cid:18) (γ.w)n

(cid:19)−s

wn

wn

.

Now we make the Claim: There is some c > 0 such that

(cid:18) (γ.w)n

(cid:19)

log

≥ cN.

wn

39

for all γ ∈ (TΓ)N . Assuming the Claim we get

and hence

LN
s [1](w) ≤ −cN LN

s [1](w)

d
ds

log LN

s [1](w) ≤ −cN.

d
ds

This means log λs is a uniform limit of functions with derivatives bounded above by a negative
constant, so λs must be strictly decreasing as required.
To prove the Claim it is enough to show (by expanding log(γ.w)n− log wn as a telescoping
sum) that for all w ∈ W and γ(cid:48) = γA
(γ(cid:48).w)n

n−1γj ∈ TΓ
= 1 + (A + 1)(1 − wj) ≥ c.

This is true with c = 3/2 since wj ≤ 1/2. This completes the proof of Proposition 41.

wn

5 Dynamics

In this Section we provide the proof of Proposition 43 that says the elements of TΓ eventually
uniformly contract ∆.

5.1 Setup

We deﬁne the sets

(cid:88)

i∈[n−1]

wi = 1},

wj ≤ wn−2},

∆ ≡ {(w1, w2, . . . , wn−2, wn−1) : 0 ≤ w1 ≤ w2 ≤ wn−2 ≤ wn−1 ≤ 1,

∆core ≡ {(w1, w2, . . . , wn−2, wn−1) ∈ ∆ : 0 ≤ wn−1 − (cid:88)
∆cusp ≡ {(w1, w2, . . . , wn−2, wn−1) ∈ ∆ : wn−1 − (cid:88)

j∈[n−2]

and

where we use the notation [N ] = {1, 2, . . . , N}. We also deﬁne the set

∆0 ≡ ∆core ∪ ∆cusp.

wj ≥ wn−2}

j∈[n−2]

Recall that the elements of TΓ are all of the form γ = γL

n−1γi where L ∈ N and i =
1, 2, . . . , n − 2. Note that for each w ∈ ∆, we have γi(w) ∈ ∆core for i = 1, 2, . . . , n − 2 and
γn−1(w) ∈ ∆cusp. In particular, γ(w) ∈ ∆0 for all γ ∈ TΓ and w ∈ ∆.
From now on, we choose to use n−2 coordinates in ∆ instead of n−1, using the relationship

wn−1 = 1 − (cid:88)

i∈[n−2]

wi.

40

Note that on ∆0 we have

(cid:88)

j∈[n−2]

and

by combining the conditions that

wj ≤ 1
2

wn−1 ≥ (cid:88)
(cid:88)

j∈[n−2]

1 − wn−1 =

wj

wj.

j∈[n−2]

3 and wn−3 ≤ 1
5 .

Similarly, it is easy to show that on ∆core we have wn−2 ≤ 1
we have wn−2 ≤ 1
Remark 45. It is clear that Proposition 43 can be proved with the local (cid:96)2 operator norms
replaced by local (cid:96)1 norms, since the norms are equivalent, possibly at the expense of a larger
N.

2 and wn−3 ≤ 1

4 , while on ∆cusp

5.2 Overview of the proof of Proposition 43

We will now prove Proposition 43 (the (cid:96)1 norm variant). We will appeal to the following
bounds.

(cid:40) 6

(cid:107)dγi(cid:107)1 ≤ 2

≤

2 − wi
1 + 2(w1 + w2 + . . . wn−2) − 2w1

on ∆cusp
on ∆core

5
4
3

, 1 ≤ i ≤ n − 3

(cid:107)dγn−1(cid:107)1 =
(cid:107)d(γi ◦ γj)(cid:107)1 ≤
(cid:107)d(γi ◦ γj)(cid:107)1 ≤

2

(1 + w1 + w2 + . . . wn−2)2
4 − 2wj − wi
4 − 2wj − wi+1

≤ 4
5
≤ 4
5

≤ 1 on ∆0
on ∆0, 1 ≤ i < j ≤ n − 2
on ∆0, 1 ≤ j ≤ i < n − 2

2

(5.1)

(5.2)

(5.3)

(5.4)

(5.5)

(5.6)

(5.7)

(5.8)

(cid:107)d(γn−2 ◦ γj)(cid:107)1 ≤ 4 + 2(w1 + . . . + wn−2) − 2w1 − 3wj
(cid:40) 6

3 + (w1 + . . . + wn−2) − 2wj

(cid:107)d(γn−1 ◦ γi)(cid:107)1 ≤

3 − 2wi
(cid:107)d(γn−1 ◦ γn−2)(cid:107)1 ≤

on ∆cusp
on ∆core
≤

(cid:40) 10

13
4
5

≤

2

2

3 − 2wn−2

on ∆0, 1 ≤ j ≤ n − 2

≤ 4
5
, 1 ≤ i ≤ n − 3

(cid:107)d(γi ◦ γn−1 ◦ γn−2)(cid:107)1 ≤

(cid:107)d(γn−2 ◦ γn−1 ◦ γn−2)(cid:107)1 ≤ 7 + 2(w1 + . . . + wn−2) − 2w1 − 6wn−2

6 − 4wn−2 − wi
5 + (w1 + . . . + wn−2) − 4wn−2

2

on ∆0, 1 ≤ i ≤ n − 3

≤ 32
49

on ∆0

(5.9)

(cid:107)d(γn−1 ◦ γn−1 ◦ γn−2)(cid:107)1 ≤

2

4 − 3wn−2

≤

on ∆cusp
on ∆core

(5.10)

on ∆cusp
on ∆core

7
1
≤ 4
7

(cid:40) 2

3
4
5

We will prove these bounds below by direct calculation. Using these bounds we can prove

the following result for any n ≥ 3 which implies Proposition 43 via Remark 45.

41

(cid:13)(cid:13)(cid:13)d(γL

n−1 ◦ γi ◦ γK

n−1 ◦ γj)(cid:12)(cid:12)∆0

(cid:13)(cid:13)(cid:13)1

≤ 24

Lemma 46. Given the bounds (5.1)-(5.10),
L, K ∈ N, and each i, j = 1, 2, . . . , n − 2.
Proof. T hroughout this proof, we repeatedly use the fact that γk(w) ∈ ∆core for k = 1, 2, . . . , n−
2 and γn−1(w) ∈ ∆cusp. We distinguish 3 cases.
Case I: L ≥ 1, K ≥ 1:
Using equations (5.2), (5.6) and (5.7), we have

25 for each

n−1

n−1

(cid:12)(cid:12)∆core

(cid:12)(cid:12)∆cusp

n−1 ◦ γi ◦ γK

(cid:12)(cid:12)∆cusp
(cid:13)(cid:13)(cid:13)1

(cid:13)(cid:13)(cid:13)d(γL
≤(cid:13)(cid:13)(cid:13)dγL−1

Case II: L ≥ 0, K = 0:
Using equations (5.2), (5.3), (5.4), (5.5), we have

(cid:13)(cid:13)(cid:13)1
n−1 ◦ γj)(cid:12)(cid:12)∆0
(cid:13)(cid:13)(cid:13)1
(cid:13)(cid:13)(cid:13)1
(cid:13)(cid:13)(cid:13)d(γn−1 ◦ γi)(cid:12)(cid:12)∆cusp
(cid:13)(cid:13)(cid:13)dγK−1
≤(cid:13)(cid:13)(cid:13)dγL
(cid:13)(cid:13)(cid:13)1
(cid:13)(cid:13)(cid:13)d(γL
n−1 ◦ γi ◦ γj)(cid:12)(cid:12)∆0
(cid:13)(cid:13)(cid:13)d(γi ◦ γK
≤(cid:13)(cid:13)(cid:13)dγi
(cid:13)(cid:13)(cid:13)dγK−1
(cid:13)(cid:13)(cid:13)1
(cid:12)(cid:12)∆cusp
(cid:12)(cid:12)∆cusp
(cid:13)(cid:13)(cid:13)1
(cid:13)(cid:13)(cid:13)d(γi ◦ γn−1 ◦ γn−2)(cid:12)(cid:12)∆0
≤ (cid:13)(cid:13)(cid:13)dγi
(cid:13)(cid:13)(cid:13)dγK−2
(cid:13)(cid:13)(cid:13)1

(cid:13)(cid:13)(cid:13)d(γi ◦ γK

n−1 ◦ γn−2)(cid:12)(cid:12)∆0

n−1 ◦ γj)(cid:12)(cid:12)∆0

(cid:12)(cid:12)∆cusp

(cid:13)(cid:13)(cid:13)1

(cid:13)(cid:13)(cid:13)1

n−1

n−1

≤ 6
5

· 1 · 4
5

=

24
25

.

(cid:13)(cid:13)(cid:13)1

≤ 1· 6
7

·1·1 <

24
25

.

(cid:13)(cid:13)(cid:13)1
(cid:13)(cid:13)(cid:13)d(γn−1 ◦ γj)(cid:12)(cid:12)∆0
(cid:13)(cid:13)(cid:13)d(γi ◦ γj)(cid:12)(cid:12)∆0
(cid:13)(cid:13)(cid:13)1
(cid:13)(cid:13)(cid:13)d(γn−1 ◦ γj)(cid:12)(cid:12)∆0
(cid:13)(cid:13)(cid:13)1

(cid:13)(cid:13)(cid:13)1

≤ 1 · 4
5

<

24
25

.

24
25

.

≤ 32
49

(cid:12)(cid:12)∆cusp

<

(cid:13)(cid:13)(cid:13)1

(cid:13)(cid:13)(cid:13)d(γn−1 ◦ γn−1 ◦ γn−2)(cid:12)(cid:12)∆0

(cid:13)(cid:13)(cid:13)1

Case III: L = 0, K ≥ 1:
We ﬁrst suppose that j ≤ n − 3. Then by equations (5.1), (5.2), (5.6) we have

.
Finally, if j = n − 2 we are left with two subcases. If K = 1, then by equations (5.8) and
(5.9) we have

=

n−1

≤ 6
5

· 1 · 4
5

24
25

Otherwise, we have K ≥ 2 and by equations (5.1), (5.2), (5.10) we have

In the remainder of these notes we prove equations (5.1)-(5.10) by direct calculation. In all
following sections, we deﬁne

β(w) ≡ n−2(cid:88)

wk, w ≡ (w1, w2, . . . , wn−2, 1 − β(w), 1).

k=1

Also recall that the (cid:107)·(cid:107)1 of a matrix is equal to the maximum over columns of the matrix of
the sum of the absolute values of the column. From now on, we call such a sum an absolute
column sum.

42

5.3 Proof of equations (5.1)-(5.10)

Proof of equation (5.1)
For i = 1, 2, . . . , n − 2 we have

γi(w) = (w1, w2, . . . ,(cid:99)wi, . . . , wn−2, 1 − β(w), 1, 2 − wi),

which, after projectivizing and removing the placeholder components, gives
1 − β(w)
2 − wi

(cid:92)wi
2 − wi

wn−2
2 − wi

w2
2 − wi

2 − wi

γi(w) =

, . . . ,

, . . . ,

,

,

(cid:18) w1

(cid:19)

which is a function in (n − 2) variables with (n − 2) components. The (n − 2) × (n − 2) total
derivative dγi is given by the following matrix



1

2

3

...
i−1

i

...
n−3

n−2

1
1

2 − wi

0

0
...
0

2

0

1

2 − wi

0
...
0

3

0

0

1

...
0

2 − wi

0
...
0
−1
2 − wi

0
...
0
−1
2 − wi

0
...
0
−1
2 − wi

...

. . .

. . .

. . .
. . .
. . .

. . .
. . .
. . .

. . .

i−1

0

0

0
...
1

2 − wi

0
...
0
−1
2 − wi

i
w1

w2

(2 − wi)2
(2 − wi)2
(2 − wi)2

w2

...
wi−1

(2 − wi)2
(2 − wi)2

wi+1

...

−1 + wi − β(w)

wn−2
(2 − wi)2
(2 − wi)2



n−3

n−2

0

0

0
...
0

0

0

0
...
0

0
...
0
−1
2 − wi

0
...
1
2 − wi
−1
2 − wi

...

. . .

. . .

. . .
. . .
. . .

. . .
. . .
. . .

. . .

i+1

0

0

0
...
0

1

2 − wi

...
0
−1
2 − wi

where the row and column indices are indicated to the left and above respectively. Each of
these partial derivatives is immediate, except for the (n − 2, i) entry which follows from an
application of the quotient rule. Note that the sign of entry (n − 2, i) is negative on ∆0. The
signs of the other entries are self-evident.

The absolute column sum for each column k with k (cid:54)= i is

Ck =

2

2 − wi

.

For column k = i the absolute column sum is

Ci =

1 + 2β(w) − 2wi

(2 − wi)2

.

We must compute which absolute column sum is maximal on ∆0. Note that on ∆0 we have
β(w) ≤ 1

2 . Furthermore, we have the following equivalences:
1 + 2β(w) − 2wi < 4 − 2wi
Ci ≤ Ck, k (cid:54)= i

⇔

⇔

β(w) <

2
3

.

43

Any column k (cid:54)= i is maximal and (cid:107)dγi(cid:107)1 ≤
∆cusp, and wi ≤ 1
∆core, proving equation (5.1).

2 on ∆core. This gives the bound that (cid:107)dγi(cid:107)1 ≤ 6

2

2 − wi

on ∆0. For each i, we have wi ≤ 1
5 on ∆cusp and ≤ 4

3 on
3 on

Proof of equation (5.2)

We have

γn−1(w) = (w1, w2, . . . , wn−2, 1, 1 + β(w))

which after projectivizing and removing placeholder components becomes

(cid:18) w1

γn−1(w) =

,

w2

1 + β(w)

, . . . ,

wn−2

1 + β(w)

1 + β(w)

(cid:19)

.

The (n − 2) × (n − 2) total derivative dγn−1 is given by the following matrix



1

2

...
n−2

1

1 + β(w) − w1
(1 + β(w))2

−w2

(1 + β(w))2

...

−wn−2

2

−w1

(1 + β(w))2
1 + β(w) − w2
(1 + β(w))2

...

−wn−2

3

−w1
−w2

(1 + β(w))2

(1 + β(w))2

...

−wn−2

(1 + β(w))2

(1 + β(w))2

(1 + β(w))2

...

. . .

. . .
. . .

. . .

n−2
−w1
−w2

(1 + β(w))2

(1 + β(w))2

...

1 + β(w) − wn−2

(1 + β(w))2

.

For each column k = 1, 2, . . . , n − 2 we have the absolute column sum

Ck =

1 + 2β(w) − 2wk

(1 + β(w))2

.

Since w1 ≤ w2 ≤ . . . ≤ wn−2 on ∆0, we have column C1 is maximal. Hence, (cid:107)dγn−1(cid:107)1 =
1 + 2β(w) − 2w1

on ∆0.

(1 + β(w))2
To bound this norm, observe
1 + 2β(w) − 2w1

(1 + β(w))2 =

1 + 2β(w) + β(w)2 ≤ 1 + 2β(w) − 2w1
1 + 2β(w) − 2w1
1 + 2β(w) − 2w1

= 1.

Hence (cid:107)dγn−1(cid:107)1 ≤ 1 on ∆0, proving equation (5.2).

Proof of equations (5.3) and (5.4)
We ﬁrst prove equation (5.3). Assume ﬁrst that 1 ≤ i < j ≤ n − 2. We have

γi ◦ γj(w) = (w1, w2, . . . ,(cid:99)wi, . . . ,(cid:99)wj, . . . , wn−2, 1 − β(w), 1, 2 − wj, 4 − 2wj − wi).
(cid:19)

Deﬁne ψ(w) ≡ 4− 2wj − wi. Then, after projectivizing and removing placeholder components
we have

(cid:18) w1

, . . . , (cid:100)wi

, . . . , (cid:100)wj

ψ(w)

ψ(w)

, . . . ,

wn−2
ψ(w)

,

1 − β(w)
ψ(w)

,

1

ψ(w)

.

γi ◦ γj(w) =

,

w2
ψ(w)

ψ(w)

44

The (n − 2) × (n − 2) total derivative d(γi ◦ γj) is given by the matrix



1

2

...
i−1

i

...
j−2

j−1
...
n−4

n−3

n−2

1
1

ψ(w)

0
...
0

0
...
0

2

0

1

ψ(w)

...
0

0
...
0

0
...
0
−1
ψ(w)

0

0
...
0
−1
ψ(w)

0

...

. . .

. . .
. . .
. . .

. . .
. . .
. . .

. . .
. . .
. . .

. . .

. . .

i−1

0

0
...
1

ψ(w)

0
...
0

0
...
0
−1
ψ(w)

0

i
w1

(ψ(w))2

w2

(ψ(w))2

...
wi−1

(ψ(w))2

wi+1

(ψ(w))2

...
wj−1

(ψ(w))2

wj+1

(ψ(w))2

...

wn−2

(ψ(w))2

−3−β(w)+2wj +wi

(ψ(w))2

1

(ψ(w))2

i+1

0

0
...
0

1

ψ(w)

...
0

0
...
0
−1
ψ(w)

0

...

. . .

. . .
. . .
. . .

. . .
. . .
. . .

. . .
. . .
. . .

. . .

. . .

j−1

0

0
...
0

0
...
1

ψ(w)

0
...
0
−1
ψ(w)

0

j

2w1

(ψ(w))2

2w2

(ψ(w))2

...

2wi−1
(ψ(w))2
2wi+1
(ψ(w))2

...

2wj−1
(ψ(w))2
2wj+1
(ψ(w))2

−2−2β(w)+2wj +wi

...

2wn−2
(ψ(w))2

(ψ(w))2

2

(ψ(w))2

j+1

...

n−2

0

0
...
0

0
...
0

1

ψ(w)

...
0
−1
ψ(w)

0

. . .

. . .
. . .
. . .

. . .
. . .
. . .

. . .
. . .
. . .

. . .

. . .

0

0
...
0

0
...
0

0
...
1
ψ(w)
−1
ψ(w)

0



.

The absolute column sum of each column k (cid:54)= i, j is

Subtracting Ci from Cj we obtain

(ψ(w))2
Cj ≥ Ci. Furthermore Ck ≥ Cj for each k (cid:54)= i, j since
4 + 4β(w) − 4wj − 3wi ≤ 2(4 − 2wj − wi)

which is nonnegative on ∆0. Thus

⇔

4β(w) − wi ≤ 4

2 and wi ≥ 0 on ∆0.

and the latter inequality holds since β(w) ≤ 1
4 − 2wj − wi

ψ(w)

=

2

Thus (cid:107)d(γi ◦ γj)(cid:107)1 ≤ 2
∆0 we have (cid:107)d(γi ◦ γj)(cid:107)1 ≤ 4
γi ◦ γj(w) = (w1, w2, . . . ,(cid:99)wj, . . . , (cid:91)wi+1, . . . , wn−2, 1 − β(w), 1, 2 − wj, 4 − 2wj − wi+1).

To prove equation (5.4), we now consider γi ◦ γj for 1 ≤ j ≤ i < n − 2. We have

on ∆0. Using the bound that each wk ≤ 1

5 , proving equation (5.3).

2 on

The remainder of the proof for equation (5.4) is nearly identical after careful bookkeeping of
indices (for example, column Ci+1 for 1 ≤ j ≤ i < n − 2 plays the role of Ci for 1 ≤ i < j ≤
n − 2).

45

The absolute column sum of column i is

and the absolute column sum of row j is

Ck =

2

ψ(w)

=

2(4 − 2wj − wi)

(ψ(w))2

Ci =

Cj =

4 + 2β(w) − 3wj − 2wi

(ψ(w))2

4 + 4β(w) − 4wj − 3wi

.

(ψ(w))2

2β(w) − wj − wi

Proof of equation (5.5)

We have

γn−2 ◦ γj(w) = (w1, w2, . . . ,(cid:99)wj, . . . , wn−2, 1, 2 − wj, 3 + β(w) − 2wj).

We deﬁne κ(w) ≡ 3 + β(w) − 2wj. Then, after projectivizing and removing placeholder
components, we have

wn−2
κ(w)
The (n − 2) × (n − 2) total derivative, d(γn−2 ◦ γj) is the matrix

γn−2 ◦ γj(w) =

w2
κ(w)

κ(w)

, . . . ,

, . . . ,

,

(cid:91)wj
κ(w)

,

1

κ(w)

(cid:18) w1

(cid:19)

.



1

2

...
j−1

j

.
..
n−3

n−2

1

3+β(w)−2wj−w1

(κ(w))2

−w2
(κ(w))2

...

−wj−1
(κ(w))2
−wj+1
(κ(w))2

2

−w1
(κ(w))2

3+β(w)−2wj−w2

(κ(w))2

...

−wj−1
(κ(w))2
−wj+1
(κ(w))2

.
..

−wn−2
(κ(w))2

−1

.
..

−wn−2
(κ(w))2

−1

(κ(w))2

(κ(w))2

...

. . .

. . .

. . .
. . .

. . .

. . .
. . .

. . .

j−1
−w1
(κ(w))2
−w2
(κ(w))2

...

3+β(w)−2wj−wj−1

(κ(w))2

−wj+1
(κ(w))2

.
..

−wn−2
(κ(w))2

−1

(κ(w))2

The absolute column sum for column k (cid:54)= j is

j
w1

(κ(w))2

w2

(κ(w))2

j+1

−w1
(κ(w))2
−w2
(κ(w))2

...

wj−1
(κ(w))2

wj+1

(κ(w))2

.
..

1

wn−2
(κ(w))2

...

−wj−1
(κ(w))2

3+β(w)−2wj−wj+1

(κ(w))2

.
..

wn−2
(κ(w))2
−1

(κ(w))2

(κ(w))2

...

. . .

. . .

. . .
. . .

. . .

. . .
. . .

. . .

n−2
−w1
(κ(w))2
−w2
(κ(w))2

...

−wj−1
(κ(w))2
−wj+1
(κ(w))2

.
..

3+β(w)−2wj−wn−2

(κ(w))2

−1

(κ(w))2



.

and the absolute column sum for column j is

Ck =

4 + 2β(w) − 3wj − 2wk

(κ(w))2

Cj =

1 + β(w) − wj

(κ(w))2

.

Note that w1 ≤ wk for all k, so C1 ≤ Ck for each k (cid:54)= j. Furthermore, subtracting column
sum Cj from C1 and using the trivial bound wk ≤ 1

Hence, C1 ≥ Cj, and C1 is maximal. We have (cid:107)d(γn−2 ◦ γj)(cid:107)1 ≤ 4 + 2β(w) − 3wj − 2w1

on

∆0. Separately bounding the numerator and denominator on ∆0 we have

3 + β(w) − 2wj − 2w1

(κ(w))2

2 on ∆0 for all k we obtain
(κ(w))2 ≥ 0.
≥ 1 + β(w)
(cid:19)
(cid:18) 1

(κ(w))2

4 + 2β(w) − 3wj − 2wi ≤ 4 + 2

= 5,

2

κ(w) = 3 + β(w) − 2wj ≥ 3 + (β(w) − wj) − wj ≥ 3 − 1
2

=

5
2

.

Thus (cid:107)d(γn−2 ◦ γj)(cid:107)1 ≤ 5
( 5
2 )2

= 4

5 on ∆0. This proves equation (5.5).

46

Proof of equation (5.6) and (5.7)
For i = 1, 2, . . . , n − 2 we have

γn−1 ◦ γi(w) = (w1, w2, . . . ,(cid:99)wi, . . . , wn−2, 1 − β(w), 2 − wi, 3 − 2wi)

which, after projectivizing and removing placeholder components, becomes

γn−1 ◦ γi(w) =

,

w2

3 − 2wi

, . . . ,

(cid:92)wi
3 − 2wi

, . . . ,

wn−2
3 − 2wi

,

1 − β(w)
3 − 2wi

(cid:18) w1

3 − 2wi

(cid:19)

.

The (n − 2) × (n − 2) total derivative d(γn−1 ◦ γi) is given by



1

2

...
i−1

i

...
n−3

n−2

1
1

3 − 2wi

0
...
0

2

0

1

...
0

3 − 2wi

0
...
0
−1

3 − 2wi

0
...
0
−1

3 − 2wi

...

. . .

. . .
. . .

. . .

. . .
. . .

. . .

. . .

i−1

0

0
...
1

3 − 2wi

0
...
0
−1

3 − 2wi

i

i+1

2w1

(3 − 2wi)2
(3 − 2wi)2

2w2

2wi−1

(3 − 2wi)2
(3 − 2wi)2

2wi+1

...

...

−1 − 2β(w) + 2wi

2wn−2
(3 − 2wi)2
(3 − 2wi)2

0

0
...
0

1

...
0
−1

3 − 2wi

3 − 2wi



.

n−2

0

0
...
0

0
...
1
−1

3 − 2wi
3 − 2wi

...

. . .

. . .
. . .

. . .

. . .
. . .

. . .

. . .

The absolute column sum for column k (cid:54)= i is

Ck =

2

3 − 2wi

and the absolute column sum for column i is

Ci =

1 + 4β(w) − 4wi

(3 − 2wi)2

.

Each column Ck with k (cid:54)= i is maximal since

Ck ≥ Ci

⇔

2(3 − 2wi) ≥ 1 + 4β(w) − 4wi

⇔

5 ≥ 4β(w)

and β(w) ≤ 1

2 on ∆0. Thus (cid:107)d(γn−1 ◦ γi)(cid:107)1 ≤

2

When i = n−2, we have wn−2 ≤ 1

on ∆0.
2 on ∆core and wn−2 ≤ 1
on ∆cusp. This proves equation (5.7).

3 − 2wi

1 on ∆core and ≤ 6
7

For i ≤ n − 3, we have the stronger bound wi ≤ 1

gives (cid:107)d(γn−1 ◦ γi)(cid:107)1 ≤ 4

5 on ∆core and ≤ 10

13 . This proves equation (5.6).

4 on ∆core and wi ≤ 1

5 on ∆cusp. This

3 on ∆cusp. Thus (cid:107)d(γn−1 ◦ γn−2)(cid:107)1 ≤

47

Proof of equation (5.8)
For each i ≤ n − 3 we have

γi ◦ γn−1 ◦ γn−2(w) = (w1, w2, . . . ,(cid:99)wi, . . . , wn−3, 1− β(w), 2− wn−2, 3− 2wn−2, 6− 4wn−2 − wi)

(cid:18) w1

µ(w)

(cid:19)

which, after projectivizing and removing placeholder components, becomes

γi ◦ γn−1 ◦ γn−2(w) =

, . . . ,

(cid:92)wi
µ(w)

. . .

wn−3
µ(w)

,

1 − β(w)

µ(w)

2 − wn−2
µ(w)

,

where µ(w) ≡ 6− 4wn−2 − wi. Then the (n− 2)× (n− 2) total derivative d(γi ◦ γn−1 ◦ γn−2) is

n−2
4w1

(µ(w))2

...

...

4wi−1
(µ(w))2
4wi+1
(µ(w))2

4wn−3
(µ(w))2

(µ(w))2
2 + wi
(µ(w))2

−2−4β(w)+4wn−2+wi



.



1

...
i−1

i

...
n−4

n−3

n−2

1
1

µ(w)

...
0

0
...
0
−1
µ(w)

0

...

. . .
. . .

. . .

. . .
. . .

. . .

. . .

. . .

i−1

0
...
1

µ(w)

0
...
0
−1
µ(w)

0

i
w1

(µ(w))2

...
wi−1

(µ(w))2

wi+1

(µ(w))2

...

wn−3
(µ(w))2

−5−β(w)+4wn−2+wi

(µ(w))2

2 − wn−2
(µ(w))2

i+1

...

n−3

0
...
0

1

µ(w)

...
0
−1
µ(w)

0

. . .
. . .

. . .

. . .
. . .

. . .

. . .

. . .

0
...
0

0
...
1
µ(w)
−1
µ(w)

0

The absolute column sum of column k (cid:54)= i, n − 2 is

Ck =

2

µ(w)

=

2(6 − 4wn−2 − wi)

(µ(w))2

,

whereas the absolute column sum of column i is

7 + 2β(w) − 2wi − 6wn−2

(µ(w))2

Ci =

and the absolute column sum of column n − 2 is

Cn−2 =

4 + 8β(w) − 8wn−2 − 4wi

(µ(w))2

.

Subtracting Cn−2 from Ci we obtain

3 − 6β(w) + 2wn−2 + 2wi

(µ(w))2

≥ 3 − 6( 1
2 )

(µ(w))2 ≥ 0

on ∆0. This shows Ci ≥ Cn−2.

48

In fact, each column Ck with k (cid:54)= i, n − 2 is maximal since

Ck ≥ Ci, k (cid:54)= i, n−2 ⇔ 2(6−4wn−2−wi) ≥ 7+2β(w)−2wi−6wn−2 ⇔ 5 ≥ 2β(w)+2wn−2
and β(w), wn−2 ≤ 1
denominator is bounded by

2 on ∆0. Hence (cid:107)d(γi ◦ γn−1 ◦ γn−2)(cid:107)1 ≤
(cid:19)

6 − 4wn−2 − wi

on ∆0. The

2

6 − 4wn−2 − wi ≥ 6 − 5

(cid:18) 1

2

=

7
2

so (cid:107)d(γi ◦ γn−1 ◦ γn−2)(cid:107)1 ≤ 4

7 on ∆0. This proves equation (5.8).

Proof of equation (5.9)

We have

γn−2 ◦ γn−1 ◦ γn−2(w) = (w1, w2, . . . , wn−3, 2 − wn−2, 3 − 2wn−2, 5 + β(w) − 4wn−2)

which, after projectivizing and removing placeholder components, becomes
2 − wn−2

γn−2 ◦ γn−1 ◦ γn−2(w) =

, . . . ,

wn−3
θ(w)

,

θ(w)

(cid:18) w1

,

w2
θ(w)

θ(w)

(cid:19)

where θ(w) ≡ 5+β(w)−4wn−2. Then the (n−2)×(n−2) total derivative d(γn−2◦γn−1◦γn−2)
is

1

5+β(w)−4wn−2−w1

2

−w1
(θ(w))2

5+β(w)−4wn−2−w2



1

2

3

...
n−3

n−2

(θ(w))2

−w2
(θ(w))2
−w3
(θ(w))2
−wn−3
(θ(w))2
−2 + wn−2
(θ(w))2

...

3

−w1
(θ(w))2
−w2
(θ(w))2

5+β(w)−4wn−2−w3

(θ(w))2

...

...

. . .

. . .

. . .
. . .

. . .

. . .

n−3
−w1
(θ(w))2
−w2
(θ(w))2
−w3
(θ(w))2

...

5+β(w)−4wn−2−wn−3

(θ(w))2

−2 + wn−2
(θ(w))2



.

n−2
3w1

(θ(w))2

3w2

(θ(w))2

3w3

(θ(w))2

...

3wn−3
(θ(w))2

1−β(w)+wn−2

(θ(w))2

...

(θ(w))2

−w3
(θ(w))2
−wn−3
(θ(w))2
−2 + wn−2
(θ(w))2

−wn−3
(θ(w))2
−2 + wn−2
(θ(w))2
The absolute column sum for each column k ≤ n − 3 is

Ck =

7 + 2β(w) − 2wk − 6wn−2

(θ(w))2

and the absolute column sum for column n − 2 is

Cn−2 =

1 + 2β(w) − 2wn−2

(θ(w))2

.

49

Subtracting Cn−2 from Ck we obtain

6 − 2wk − 4wn−2

(θ(w))2

≥ 0

on ∆0 (using the bound wk ≤ 1
2 for all k). Hence, Cj ≤ Ck for each k (cid:54)= j. Of the remaining
column sums, C1 is maximal since w1 ≤ wk for each k on ∆0. Thus, (cid:107)d(γn−2 ◦ γn−1 ◦ γn−2)(cid:107)1 ≤
7+2β(w)−2w1−6wn−2
(5+β(w)−4wn−2)2

.

Separately bounding the numerator and the denominator we have

7 + 2β(w) − 2w1 − 6wn−2 ≤ 7 + 1 ≤ 8

5 + β(w) − 4wn−2 ≥ 5 + (β(w) − wn−2) − 3wn−2 ≥ 5 − 3

so (cid:107)d(γn−2 ◦ γn−1 ◦ γn−2)(cid:107)1 ≤ 32

49 on ∆0, proving equation (5.9).

Proof of equation (5.10)

We have

(cid:18) 1

(cid:19)

2

=

7
2

γn−1 ◦ γn−1 ◦ γn−2(w) = (w1, w2, . . . , wn−3, 1 − β(w), 3 − 2wn−2, 4 − 3wn−2)

which, after projectivizing and removing placeholder components, becomes

γn−1 ◦ γn−1 ◦ γn−2(w) =

w1

w2

4 − 3wn−2

,

4 − 3wn−2

, . . . ,

wn−3

4 − 3wn−2

,

1 − β(w)
4 − 3wn−2

The (n − 2) × (n − 2) total derivative d(γn−1 ◦ γn−1 ◦ γn−2) is

(cid:18)

2

0

1

...
0
−1

...

. . .

. . .
. . .

4 − 3wn−2



1

2

...
n−3

1
1

4 − 3wn−2

0
...
0
−1

(cid:19)

.



.

n−3

0

0
...
1
−1

n−2
3w1

(4 − 3wn−2)2
(4 − 3wn−2)2

3w2

...

3wn−3

−1 − 3β(w) + 3wn−2

(4 − 3wn−2)2
(4 − 3wn−2)2

4 − 3wn−2
4 − 3wn−2
The absolute column sum for each column k ≤ n − 3 is

4 − 3wn−2

4 − 3wn−2

n−2

. . .

. . .

and the absolute column sum for column n − 2 is

Ck =

2

4 − 3wn−2

Cn−2 =

1 + 6β(w) − 6wn−2

(4 − 3wn−2)2

.

Each column Ck for k (cid:54)= n − 2 is maximal because

Ck ≥ Cn−2, k (cid:54)= n − 2

⇔

Thus, (cid:107)d(γn−1 ◦ γn−1 ◦ γn−2)(cid:107)1 ≤

(cid:107)d(γn−1 ◦ γn−1 ◦ γn−2)(cid:107)1 = 4

5 , proving equation (5.10).

2(4 − 3wn−2) ≥ 1 + 6β(w) − 6wn−2

7 ≥ 6β(w).
⇔
on ∆0. Since wn−2 ≤ 1
2 on ∆0 we have

2

4−3wn−2

50

References

[1] Martin Aigner. Markov’s theorem and 100 years of the uniqueness conjecture. Springer,

Cham, 2013. A mathematical journey from irrational numbers to perfect matchings.

[2] Arthur Baragar. Asymptotic growth of Markoﬀ-Hurwitz numbers. Compositio Math.,

94(1):1–18, 1994.

[3] Arthur Baragar. Integral solutions of Markoﬀ-Hurwitz equations. J. Number Theory,

49(1):27–44, 1994.

[4] Arthur Baragar. The exponent for the Markoﬀ-Hurwitz equations. Paciﬁc J. Math.,

182(1):1–21, 1998.

[5] G.V. Belyi˘ı. Markov’s numbers and quadratic forms.

J. Math. Sci., New York,

106(4):3087–3097, 2001.

[6] Enrico Bombieri. Continued fractions and the Markoﬀ tree. Expo. Math., 25(3):187–213,

2007.

[7] David W. Boyd. The disk-packing constant. Aequationes Math., 7:182–193, 1971.

[8] David W. Boyd. Improved bounds for the disk-packing constant. Aequationes Math.,

9:99–106, 1973.

[9] David W. Boyd. The sequence of radii of the Apollonian packing. Math. Comp.,

39(159):249–254, 1982.

[10] J. W. S. Cassels. An introduction to Diophantine approximation. Cambridge Tracts in
Mathematics and Mathematical Physics, No. 45. Cambridge University Press, New York,
1957.

[11] Harvey Cohn. Minimal geodesics on Fricke’s torus-covering. In Riemann surfaces and
related topics: Proceedings of the 1978 Stony Brook Conference (State Univ. New York,
Stony Brook, N.Y., 1978), volume 97 of Ann. of Math. Stud., pages 73–85. Princeton
Univ. Press, Princeton, N.J., 1981.

[12] William M. Goldman. The modular group action on real SL(2)-characters of a one-holed

torus. Geom. Topol., 7:443–486, 2003.

[13] Christopher Gurwood. Diophantine approximation and the Markov chain. PhD thesis,

New York University, 1976.

[14] H. Hu, S. Peow Tan, and Y. Zhang. Polynomial automorphisms of Cn preserving the

Markoﬀ-Hurwitz polynomial. arXiv://1501.06955, January 2015.

[15] Y. Huang and P. Norbury. Simple geodesics and Markoﬀ quads. arXiv:1312.7089, De-

cember 2013.

[16] A. Hurwitz. ¨Uber eine Aufgabe der unbestimmten Analysis. Archiv. Math. Phys., 3:185–

196, 1907. Also: Mathematisch Werke, Vol. 2, Chapt. LXX (1933 and 1962), 410–421.

51

[17] C. T. Ionescu Tulcea and G. Marinescu. Th´eorie ergodique pour des classes d’op´erations

non compl`etement continues. Ann. of Math. (2), 52:140–147, 1950.

[18] Tosio Kato. Perturbation theory for linear operators. Springer-Verlag, Berlin-New York,

second edition, 1976. Grundlehren der Mathematischen Wissenschaften, Band 132.

[19] Alex Kontorovich and Hee Oh. Apollonian circle packings and closed horospheres on
hyperbolic 3-manifolds. J. Amer. Math. Soc., 24(3):603–648, 2011. With an appendix
by Oh and Nimish Shah.

[20] R.O. Kuzmin. On a problem of Gauss. Atti del Congresso Internazionale dei Matematici,

Bologna, 6:83–89, 1932.

[21] Steven P. Lalley. Renewal theorems in symbolic dynamics, with applications to geodesic
ﬂows, non-Euclidean tessellations and their fractal limits. Acta Math., 163(1-2):1–55,
1989.

[22] Carlangelo Liverani. Decay of correlations. Ann. of Math. (2), 142(2):239–301, 1995.

[23] A. Markoﬀ. Sur les formes quadratiques binaires ind´eﬁnies. Math. Ann., 17(3):379–399,

1880.

[24] Greg McShane. A remarkable identity for lengths of curves. ProQuest LLC, Ann Arbor,

MI, 1991. Thesis (Ph.D.)–University of Warwick (United Kingdom).

[25] Greg McShane. Simple geodesics and a series constant over Teichmuller space. Invent.

Math., 132(3):607–632, 1998.

[26] Greg McShane and Igor Rivin. A norm on homology of surfaces and counting simple

geodesics. Internat. Math. Res. Notices, (2):61–69 (electronic), 1995.

[27] M. Mirzakhani.

Counting Mapping Class group orbits on hyperbolic surfaces.

arXiv:1601.03342, January 2016.

[28] Maryam Mirzakhani. Growth of the number of simple closed geodesics on hyperbolic

surfaces. Ann. of Math. (2), 168(1):97–125, 2008.

[29] William Parry and Mark Pollicott. Zeta functions and the periodic orbit structure of

hyperbolic dynamics. Ast´erisque, (187-188):268, 1990.

[30] S. J. Patterson. The limit set of a Fuchsian group. Acta Math., 136(3-4):241–273, 1976.

[31] Mark Pollicott. Statistical properties of the Rauzy-Veech-Zorich map. Available at

http://homepages.warwick.ac.uk/~masdbl/teichmuller-asip.pdf.

[32] Mark Pollicott. A complex Ruelle-Perron-Frobenius theorem and two counterexamples.

Ergodic Theory Dynam. Systems, 4(1):135–146, 1984.

[33] H. Schwartz and H. T. Muhly. On a class of cubic Diophantine equations. J. London

Math. Soc., 32:379–382, 1957.

52

[34] Joseph H. Silverman. Counting integer and rational points on varieties. Ast´erisque,
(228):4, 223–236, 1995. Columbia University Number Theory Seminar (New York, 1992).

[35] Eduard Wirsing. On the theorem of Gauss-Kusmin-L´evy and a Frobenius-type theorem
for function spaces. Acta Arith., 24:507–528, 1973/74. Collection of articles dedicated to
Carl Ludwig Siegel on the occasion of his seventy-ﬁfth birthday, V.

[36] Don Zagier. On the number of Markoﬀ numbers below a given bound. Math. Comp.,

39(160):709–723, 1982.

[37] Anton Zorich. Flat surfaces. In Frontiers in number theory, physics, and geometry. I,

pages 437–583. Springer, Berlin, 2006.

Alex Gamburd,
CUNY Graduate Center,
New York, NY
agamburd@gc.cuny.edu

Michael Magee,
Yale University,
New Haven, CT
michael.magee@yale.edu

Ryan Ronan,
CUNY Graduate Center,
New York, NY
rronan@gradcenter.cuny.edu

53

