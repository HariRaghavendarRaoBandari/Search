6
1
0
2

 
r
a

M
9

 

 
 
]

.

R
S
h
p
-
o
r
t
s
a
[
 
 

1
v
9
9
8
2
0

.

3
0
6
1
:
v
i
X
r
a

MNRAS 000, 1–19 (2016)

Preprint 10 March 2016

Compiled using MNRAS LATEX style ﬁle v3.0

How dusty are photoevaporative winds?

Mark A. Hutchison,1(cid:63) Daniel J. Price2 Guillaume Laibe3 and Sarah T. Maddison,1
1Centre for Astrophysics & Supercomputing, Swinburne University of Technology, Hawthorn, VIC 3122, Australia
2Monash Centre for Astrophysics and School of Physics & Astronomy, Monash University, Clayton, VIC 3800, Australia
3School of Physics and Astronomy, University of St. Andrews, North Haugh, St. Andrews, Fife KY16 9SS, UK

Accepted XXX. Received YYY; in original form ZZZ

ABSTRACT
Not very. We perform dusty smoothed particle hydrodrodynamic (SPH) calculations
of photoevaporation in protoplanetary discs. We use unequal-mass particles to resolve
more than ﬁve orders of magnitude in disc/outﬂow density and a one-ﬂuid formulation
to eﬃciently simulate an equivalent magnitude range in drag stopping time. We ﬁnd
that only micron sized dust grains and smaller can be entrained in photoevaporative
winds. This makes it diﬃcult to explain the dust holes seen in transition discs using
photoevaporation and implies that only small grains can be transported to the outer
disc by this mechanism. A pileup of micron sized dust grains can occur in the upper
atmosphere at critical radii in the disc as grains decouple from the low-density wind.
Entrainment is a strong function of location in the disc, resulting in a size sorting
of grains in the outﬂow—the largest grain being carried out between 10–20 AU. The
peak dust density for each grain occurs at the inner edge of its entrainment region.

Key words: protoplanetary discs — planets and satellites: atmospheres — circum-
stellar matter — stars: pre-main-sequence

1 INTRODUCTION

Small dust grains set the energy balance in the surface lay-
ers of protoplanetary discs. As a result, they determine the
eﬃciency of photoevaporation (Hollenbach et al. 1994), a
pressure driven wind produced by high energy stellar radi-
ation that heats and/or ionises gas located in the incident
surface layers of the disc. Dust is a major source of opacity
for impinging stellar radiation, but also an important link in
collisional/chemical heating channels through which ultra-
violet and X-ray radiation heat gas to escape velocities (see
Tielens & Hollenbach 1985; Glassgold et al. 1997; Alexander
et al. 2004). The role of dust in energy balance and photo-
evaporation is complicated by the aerodynamic drag that
small dust grains feel in the presence of outﬂowing gas. Disc
winds selectively entrain grains of diﬀerent sizes at diﬀer-
ent radii resulting in dust populations that vary spatially
(Owen et al. 2011) and temporally. The opacity and heating
from entrained and semi-entrained dust grains create a com-
plicated feedback mechanism that can only be resolved by
combining radiative transfer and two-phase hydrodynamic
simulations. Although Owen et al. (2010) found a method to
couple the X-ray radiative transfer model of Ercolano et al.
(2009) to gas hydrodynamics, a self-consistent treatment of
dust in hydrodynamic simulations of photoevaporation has
not yet been attempted. Thus, the eﬀect of an evolving dust

(cid:63) E-mail: mhutchison@swin.edu.au

© 2016 The Authors

phase in the disc and outﬂow remains a source of uncertainty
in all photoevaporation models to date.

The reason for this global oversight is that incorporat-
ing small dust grain dynamics into photoevaporation simu-
lations is not trivial. Correctly accounting for aerodynamic
drag in two-phase hydrodynamic simulations involving small
dust grains has proven to be numerically diﬃcult even for
simple test cases, let alone disc atmospheres undergoing pho-
toevaporation (Laibe & Price 2012a,b). Disc atmospheres
cover a huge range in density and temperature—two quan-
tities that strongly aﬀect the drag timescale—and they vary
in both the vertical and the radial directions. To illustrate
the physical scales that need to be resolved, Figure 1 shows
the gas density (top panel) and the drag stopping times for
various sized dust grains (bottom panel) in a representa-
tive slice through a protoplanetary disc. What is numeri-
cally straightforward in one area of the disc may be very
diﬃcult in another. Furthermore, a single grain size initially
distributed evenly throughout the disc will experience a mix
of strong, intermediate, and weak drag regimes depending
on local disc conditions, making it diﬃcult to predict how a
particular grain size should behave globally in the disc.

Fortunately, new techniques exist that allow us to model
small dust grains much more eﬃciently and accurately than
in the past (Laibe & Price 2014a,b,c; Price & Laibe 2015;
Lor´en-Aguilar & Bate 2014). However, there are a few obsta-
cles to overcome before we can directly apply these methods
to photoevaporation. Foremost is the fact that these tech-

2

Hutchison, Price, Laibe, & Maddison

niques have been developed using SPH (Lucy 1977; Gin-
gold & Monaghan 1977). SPH concentrates resolution to-
wards regions of high density, making it diﬃcult to resolve
a low-density outﬂow in the presence of a high-density disc
midplane. Theoretically, this issue can be solved by using
unequal-mass particles, but in practice there are a num-
ber of numerical complications that have prevented unequal
masses from gaining much traction in the SPH community
(e.g. see Rasio & Lombardi 1999; Monaghan & Price 2006).
Successfully circumventing these numerical obstacles is not
straightforward; however, once achieved, the return is large.
Not only do we gain access to small grain physics, but we
also inherit SPH’s intrinsic ability to handle free boundary
conditions, making it perfect for next generation photoevap-
oration models simulating asymmetric features like planet-
induced spiral density waves and/or warps.

We propose that self-consistent, two-phase hydrody-
namic simulations of dusty photoevaporation will reveal new
insights into how dust behaves in the upper atmospheres of
photoevaporating discs. This added insight could have a sig-
niﬁcant impact on future radiative transfer calculations of
dusty protoplanetary discs. In order to test this hypothesis,
we set out to accomplish the following three tasks in this
paper: (i) we address the issues above that have hitherto
prevented the use of SPH as a viable tool for modelling pho-
toevaporation, (ii) we incorporate the techniques of Laibe &
Price (2014a,b) to accurately model small dust grains, and
(iii) we develop a simple photoevaporation model in which
we can self-consistently evolve the gas/dust phases in the
presence of photoevaporating ﬂows. By implementing and
benchmarking these techniques, this study paves the way
for more quantitative photoevaporation simulations that in-
clude the full eﬀect of dust dynamics and non-axisymmetric
features that occur in real discs. Moreover, the techniques
used here are transferable to any ﬁeld involving particulates
in stratiﬁed atmospheres, such as planetary science.

The paper is organised as follows: Section 2 gives a
brief overview of the diﬀerent heating mechanisms responsi-
ble for photoevaporation; Section 3 summarises the implicit,
unequal-mass, one-ﬂuid SPH formalism necessary to simu-
late both small dust grain physics and photoevaporation;
Section 4 introduces our disc model, explains why our SPH
formalism is necessary, and demonstrates that it works; Sec-
tion 5 benchmarks our code against a semi-analytic solu-
tion of dusty photoevaporation; and ﬁnally, Section 6 col-
lates a suite of photoevaporation simulations using our new
model that explore the behaviour of dust in various physi-
cal regimes. In a forthcoming paper, (Hutchison et al. 2016,
hereafter, HLPM16), we have developed a simpler, semi-
analytic model that is able to recover many of the results
found in this numerical study.

2 PHOTOEVAPORATION HEATING

Photoevaporation comes in three ﬂavours, generally clas-
siﬁed by the wavelength or energy of the incident stellar
ﬂux on the disc: (i) ionising extreme-UV radiation (EUV;
13.6–100 eV), (ii) photodissociating far-UV radiation (FUV;
6–13.6 eV), and (iii) X-ray radiation (0.1–10 keV). Under-
standing which energy regime (or combination thereof) is
predominately responsible for photoevaporation in proto-

Figure 1. Gas density (top) and drag stopping time (bottom)
for diﬀerent grain sizes, s, in a representative slice through a typ-
ical protoplanetary disc. The thermo-chemical models of Woitke
et al. (2016) show that photoevaporation occurs high in the disc
atmosphere at densities ∼ 4–5 orders of magnitude below the local
midplane density of the disc (shaded region). Dust entrainment
during photoevaporation is numerically challenging due to the 5
orders of magnitude change in density (top) and 7 orders of mag-
nitude change in stopping time (bottom) from disc midplane to
atmosphere.

planetary discs is still an open question (for a recent review,
see Alexander et al. 2014). We brieﬂy present an overview
of the heating mechanisms for each type.

2.1 EUV photoevaporation

The sharp cutoﬀ between EUV and FUV radiation is marked
by the ionisation of hydrogen—the most common element
in protoplanetary discs. Consequently, EUV radiation has
a particularly high absorption cross-section. This peaks at
13.6 eV and drops precipitously due to a rough ν−3 depen-
dence, making it relatively independent of stellar spectrum
(Osterbrock & Ferland 2006). The transition between neu-
tral and ionised gas is abrupt and provides, to zeroth or-
der, negligible heating to the bulk of the disc. As a result,
gas and dust temperatures are coupled approximately up
to the ionisation front. Beyond the ionisation front the gas

MNRAS 000, 1–19 (2016)

-101z[AU]-15-13-11log(;)[g=cm3]Photoevaporation Region-10 1 z[AU]-6-30 log(ts)[yr] s = 0.17m s = 0.57m s = 17m s = 57m s = 107mis near isothermal (T (cid:39) 104 K) with constant sound speed,
cs (cid:39) 10 km/s. Taken together, these properties simplify EUV
photoevaporation tremendously, allowing the ﬂow to be de-
termined by knowing only the EUV ﬂux and base ﬂow den-
sity (Alexander et al. 2006).

2.2 FUV photoevaporation

Although FUV radiation is below the ionisation threshold
for hydrogen, it is still energetic enough to drive signiﬁcant
heating in discs (as evidenced by FUV photodissociation
regions in giant molecular clouds). However, FUV heating
is considerably more complicated than EUV. For example,
Tielens & Hollenbach (1985) summarise at least 8 mecha-
nisms by which FUV radiation is converted into gas heating.
There are three crucial diﬀerences between EUV and FUV
radiation: (i) attenuation of FUV ﬂux in photoevaporating
discs is dominated by dust and polycyclic aromatic hydro-
carbon absorption (Alexander et al. 2014), thereby coupling
FUV photoevaporation to the dust evolution in the disc and
decoupling the dust temperature from that of the gas (at
low column density; see Adams et al. 2004); (ii) the launch
point for the FUV ﬂow is located in the atomic layer of
the disc, well below the EUV ionisation front (Gorti & Hol-
lenbach 2009); and (iii) the FUV mass-loss rate peaks at
∼ 5–10 AU, but the radially extended heating from FUV
radiation actually makes it the dominant wind mechanism
beyond ∼ 100 AU (see Armitage 2011).

2.3 X-ray photoevaporation

Like FUV radiation, X-rays have a complicated network
of chemically dependent channels through which they can
heat the disc. The relatively large spectral range and high
energies cause X-ray absorption to preferentially occur in
heavier elements via ionisation of inner (K-shell) electrons
(Glassgold et al. 1997). However, hard X-rays ((cid:38) 3 keV) are
probably too penetrating and the energies that are crucially
important for atmospheric heating are the soft X-rays (0.3–
1 keV; see Owen et al. 2012). The primary heating agent for
the gas is not the ionisation of heavy elements themselves,
but the subsequent release of photo/Auger electrons that
collisionally ionise and/or heat the lighter atoms/molecules
in the disc (Alexander et al. 2004). Like FUV radiation,
X-rays decouple the gas and dust temperatures in the disc’s
atmosphere. Furthermore, as much of the heavy elements
are tied up in dust grains, X-ray heating is also sensitive to
the location of the dust in the disc.

While the heating mechanism creating photoevapora-
tion is diﬀerent from one case to the other, the resultant
outﬂow is hydrodynamically similar. This is critical because
our goal in this paper is to develop the SPH techniques nec-
essary to be able to simulate photoevaporative outﬂows and
probe how they aﬀect small grains in the disc, not to de-
termine which ﬂavour of photoevaporation is dominant in
nature. Thus, as long as we can produce an outﬂow using
just one of the methods, the techniques can be applied to
others. Since EUV photoevaporation has the simplest heat-
ing mechanism and the fewest dust dependencies, we focus
exclusively on EUV driven winds in this paper.

MNRAS 000, 1–19 (2016)

How dusty are photoevaporative winds?

3

3 NUMERICAL METHOD

Simulating small dust grains in a two-ﬂuid code can be
computationally challenging for four reasons (see Laibe &
Price 2012a). First, the explicit integration of the ﬂuid equa-
tions requires an additional timestep restriction resulting in
a timestep smaller than the minimum drag stopping time,
i.e. ∆t < ts, in order to resolve the aerodynamic coupling
between the gas and dust. Second, overdamping occurs be-
tween phases whenever the spatial criterion h (cid:46) csts is not
met. Here h is the resolution length of the simulation (par-
ticle smoothing length for SPH) and cs is the local sound
speed of the gas. Third, each phase requires its own set
of particles which approximately doubles memory require-
ments and simulation times. Fourth, two-ﬂuid codes suﬀer
from artiﬁcial clumping of dust below the resolution scale of
the gas.

The multi-phase, one-ﬂuid formalism developed by
Laibe & Price (2014a,b) overcomes all four of these issues,
therefore we use this method to simulate photoevaporation
in SPH.

3.1 One-ﬂuid gas and dust mixture in SPH

3.1.1 Continuum equations

Laibe & Price (2014a) showed that the ﬂuid equations for
a two-phase ﬂuid of gas and dust can be re-formulated to
describe a single ﬂuid moving at the barycentric velocity of
the mixture,
v ≡ ρgvg + ρdvd

(1)

.

ρ

Here, and throughout the rest of the paper, the subscripts
g and d refer to gas and dust quantities, respectively. The
total density ρ = ρg + ρd can be rewritten in terms of the
dust fraction  ≡ ρd/ρ and the diﬀerential velocity between
the two phases, ∆v ≡ vd − vg. Substituting these quantities
into the ﬂuid equations to remove any explicit dependance
on individual phases, we are left with the following set of
equations describing a single ﬂuid

dρ
dt
d
dt
dv
dt
d∆v

dt

= −ρ(∇ · v),
= − 1
ρ

∇ · [(1 − )ρ∆v] ,

= (1 − )fg + fd − 1
ρ
=− ∆v
ts

+ (fd−fg) − (∆v·∇)v +

∇ · [(1 − )ρ∆v∆v] + f ,

∇(cid:2)(2−1)∆v2(cid:3) ,

1
2

(2)

(3)

(4)

(5)

∆v2
ts

,

(1 − )ρ

= − Pg

∇ · (v − ∆v) + (∆v · ∇)u + 

du
(6)
dt
where the convective derivative (d/dt ≡ ∂/∂t + v · ∇) now
refers to a single ﬂuid moving at the barycentric velocity.
External forces exerted on the ﬂuid are represented by f ,
while the subscripts denote any force that applies to only a
single phase, e.g. fg = −∇Pg/ρg. The gas pressure is repre-
sented by Pg and u is the internal energy. The stopping time
is deﬁned as

,

(7)

ts ≡ (1 − )ρ

K

4

Hutchison, Price, Laibe, & Maddison

where K is the drag coeﬃcient which in general depends
on the local gas and dust parameters. In this paper we will
assume that K is either constant or in the linear Epstein
regime, suitable for small dust grains with low Mach num-
bers (Epstein 1924, also e.g. Laibe & Price 2012b). In the
latter case, assuming spherical dust grains,

K = ρgρd

4π
3

s2

mgrain

πγ

cs,

(8)

3 ρgrains3 is the mass of
where s is the grain size, mgrain = 4π
each grain, and ρgrain is the intrinsic dust density. Thus the
stopping time in the Epstein regime is equivalent to

(cid:114) 8

(cid:114) πγ

8

ts =

ρgrains

ρcs

.

(9)

3.1.2 Discretised SPH equations

Laibe & Price (2014b, hereafter referred to as LP14b)
transcribed Equations (2)–(6) into a fully conservative set
of SPH equations—including conservative shock-capturing
terms. The discretised equations for a single set of particles
(indexed hereafter using subscripts a, b, and c) that repre-
sent a mixture of both gas and dust are as follows:

ρa =

mbWab(ha),

(cid:20) a(1 − a)

mb

b

+

b ρa

χa
b(1 − b)

χb

aρb

∆va · ∇aWab(ha)

∆vb · ∇aWab(hb)

(10)

,

(11)

(cid:21)

(cid:88)
= −(cid:88)

b

da
dt

dva
dt

+

1

a(1 − a)

mb

qAV
∆v,a
χa
b ρ2
a

(cid:88)

b

+

mb

∇aWab(hb)

qAV
∆v,b
aρ2
χb
b
ab · ∇aWab(ha)
vg

Pa + qAV
ab,a
b ρaρg
χa
∆va · ∇aWab(ha)

a

dua
dt

= a

∆v2
a
ts,a

−(cid:88)

,

(13)

mbuab

a
χa
b ρa

(cid:20) Qab,a

(cid:88)

mb

b

+

1

1 − a

b

Fab(ha) +

Fab(hb)

Qab,b
aρ2
χb
b

(cid:35)

∆vab · ˆrabFab(ha)

,

(14)

χa
b ρ2
a
− qAV
∆v,a
χa
b ρ2
a

= (1 − a)fg + fa

−(cid:88)

mb

b

+

(cid:20) a(1 − a)∆va

χa

b ρa

b(1 − b)∆vb

d∆va

dt

= − ∆va
ts,a

− fg +

(cid:88)

b

+

1
2

mb
χa
b ρa

∆va · ∇aWab(ha)

∆vb · ∇aWab(hb)

(cid:21)

,

(12)

∆va · ∇aWab(ha)

χb

aρb

(cid:88)
(cid:2)(1 − 2a)∆v2

vab
χa
b ρa

mb

b

a

− (1 − 2b)∆v2

b

(cid:88)

b

(cid:34)

+

(cid:3)∇aWab(ha)
(cid:35)

∇aWab(ha)

where,

(1 − a)fg = −(cid:88)

mb

(cid:34)

b

Pa + qAV
ab,a

χa

b ρ2
a

∇aWab(ha)

+

Pb + qAV
ab,b

χb

aρ2
b

∇aWab(hb)

(cid:35)

.

(15)

The artiﬁcial viscosity, diﬀerential velocity dissipation, and
conductivity parameters are given by:
ab· ˆrab,

2 (1 − a)ρavsig,avg

(cid:40)− 1

if vg
if vg

ab· ˆrab < 0
ab· ˆrab≥ 0,

0,
a(1 − a)ρavsig,∆v∆vab · ˆrab,

ab,a ≡
qAV

∆v,a ≡ 1
qAV
2
Qab,a ≡ 1
2

αuρavsig,uuab,

with their corresponding signal speeds deﬁned as:
vsig,a ≡ αcs,a + β|vg
ab · ˆrab < 0,
vsig,∆v ≡ α∆vcs,a,

ab · ˆrab|,

if vg



(cid:113) |Pa−Pb|

,
|vab · ˆrab| ,

ρab

vsig,u ≡ αu

if g = 0

otherwise.

(16)

(17)

(18)

(19)

(20)

(21)

Here α and β are the usual linear and quadratic SPH vis-
cosity parameters, respectively, while α∆v and αu are both
dimensionless coeﬃcients of order unity. We use g to repre-
sent the force of gravity. The choice of smoothing length, h,
along with the associated ∇h correction terms, χa
b , will be
discussed in Section 3.3.1. Likewise the choice and functional
form of the smoothing kernel, Wab(h) ≡ W (|ra − rb|, h), will
be discussed in Section 3.3.2. Note that we use the conven-
tion that double indices on unbarred quantities indicate a
diﬀerence term (e.g. vab ≡ va− vb and uab ≡ ua− ub), while
barred quantities represent averages, e.g. ρab ≡ 1
2 (ρa + ρb).
Finally, Fab is deﬁned such that ∇aWab ≡ Fabˆrab.

The astute reader will notice that we have altered the
equations from their original form in LP14b. First, we use
an equivalent but alternate formalism for the artiﬁcial vis-
cosity and thermal conduction terms following the method
used in the phantom code (Lodato & Price 2010; Price &
Federrath 2010), thereby avoiding the use of averaged quan-
tities. Second, we dispense with the ∆v dissipation switch in
Equation (17) and set the corresponding signal speed equal
to the sound speed, following the alternative dissipation for-
mulation mentioned in LP14b which we found to produce
better results. Third, we use a non-standard notation for
the ∇h correction terms—including an additional index—in
anticipation of employing unequal-mass particles.

3.2 Time-stepping

A key feature of using the one-ﬂuid formalism is that each
particle inherently contains the local information about both
phases so there is no need to interpolate between them. This,
coupled with the fact that the gas/dust drag equations can
be solved exactly for simple drag coeﬃcients (Laibe & Price
2011), means that implicit integration can be implemented
in a straightforward manner. LP14b propose doing this in
three steps via operator splitting: (i) rates for all particle
quantities are computed explicitly without the drag terms,

MNRAS 000, 1–19 (2016)

(ii) diﬀerential velocity and drag-induced heating are com-
puted using semi-analytic solutions and used to reconstruct
explicit-like derivatives, and (iii) the particles’ diﬀerential
velocity and energy are updated in an explicit fashion using
these derivatives. We adopt the explicit integration tech-
nique used by LP14b as well as their implicit integration
method for the internal energy, but note that their integra-
tion technique for the diﬀerential velocity does not work as
written in their paper. We therefore propose an alternative
method for integrating ∆v forward in time.

3.2.1 Semi-analytic solutions for drag

(cid:104)

Following LP14b, the change in internal energy due to drag
over ∆t is calculated by integrating the ﬁnal term in Equa-
tion (6),

(cid:90) ∆t
(cid:110)
·(cid:104)


ts

2

(cid:16)
1−e∆t/ts(cid:17)

1 − e

(cid:48)

−t(cid:48)/ts(cid:17)(cid:105)2
(cid:105)(cid:111)

dt
(∆vn−a0ts)

−t(cid:48)/ts + a0ts

−2∆t/ts(cid:16)

∆vne
0ts∆t − e

0
2a2
∆vn − a0ts + e∆t/ts (∆vn + 3a0ts)

∆udrag =

=

.

(22)

We obtain an analytic equation for the diﬀerential velocity
by assuming that the acceleration of ∆v in a barycentric
ﬂuid due to all non-drag forces is independent of ts and ap-
proximately constant over each timestep. Then the relevant
diﬀerential equation reduces to

(23)

d∆v

= − ∆v
ts

+ a0,

dt
where a0 ≡ (d∆v/dt)n
0 and the subscript 0 represents the
contribution from all terms on the right-hand side of Equa-
tion (13) that do not involve ts. In this paper we are only
interested in linear drag regimes, where ts is independent of
∆v, so the exact solution to Equation (23) is

∆v(t) = ∆v(t0)e

−t/ts + a0ts

1 − e

,

(24)

−t/ts(cid:17)

where t0 is the time at the beginning of the timestep. Be-
cause this equation is only valid while a0 ≈ constant (i.e.
over a single timestep), we ﬁnd

−∆t/ts(cid:17)

1 − e

.

(25)

(cid:16)

(cid:16)

∆vn+1 = ∆vne

−∆t/ts + a0ts

3.2.2 Implicit integration

There is an important diﬀerence between Equation (22) and
Equation (25) which ultimately aﬀects how we are able to
update u and ∆v. Because ∆udrag exclusively accounts for
all drag heating and can be clearly separated from all other
heating processes, we are free to update u using the operator
splitting techniques described in LP14b, modulo a missing
factor of 1/2 in equation (97) of their paper. However, the
drag contribution to ∆vn+1 is inseparably dependent on its
non-drag constituents and must be treated diﬀerently so as
to not double count the contribution from a0.

The key point in updating ∆v is that we already have
the semi-analytic solution in Equation (25) determining
what ∆vn+1 should be at the end of the timestep. The only
real source of error in using this equation comes from assum-
ing a0 is constant over ∆t—an assumption we already make
when using our explicit timestep. Thus we propose initially

MNRAS 000, 1–19 (2016)

How dusty are photoevaporative winds?

5

calculating ∆v directly using Equation (25) in the predictor
step, then re-calculating ∆v using updated values for ts and
a0, and averaging the two results in the corrector step. In
equation form, this procedure can be written as follows:

∗∗

∆v

= ∆vne

1 − e

−∆t/ts + a0ts

(cid:16)
(cid:16)
s + a∗
0t∗
2 (∆v∗∗ + ∆v∗) .

s

−∆t/ts(cid:17)
(cid:17)

1 − e−∆t/t∗

s

∆v∗ = ∆vne−∆t/t∗
∆vn+1 = 1

,

(predictor)

(26)

 (corrector)

,

(27)

As a ﬁnal note, evolving ∆v only makes sense while  > 0.
Since it is perfectly acceptable to have particles with zero
dust fraction, we forcibly set d∆v
dt = 0 whenever  = 0.
Failing to do so often results in unbounded growth in ∆v.

3.3 Unequal-mass particles

Equal-mass particles in SPH naturally concentrate in regions
of high density, making it diﬃcult to resolve low-density phe-
nomena surrounding high-density structures. In principle,
concentrating particles in the densest objects automatically
fulﬁls the role that complicated adaptive mesh reﬁnement
schemes play in grid-based codes which adjust resolution on
the ﬂy. The caveat is that SPH almost always has a ﬁxed
number of particles so resolving high density regions comes
at the expense of poorly resolving low density regions. Hence
the only way to increase resolution in low density regions is
to add more particles. This, however, is ineﬃcient and results
in severely curtailed timesteps due to over-resolved struc-
tures. Therefore, SPH with equal-mass particles can only be
applied to photoevaporation problems where the relevant
density range is (cid:46) 3 orders of magnitude.

Allowing unequal masses provides a potential ﬁx to this
problem by adding another degree of freedom to the density.
The result is that the same density proﬁle can be represented
by multiple particle conﬁgurations by adjusting the mass
of the particles. This degeneracy allows us to redistribute
the particles in a more convenient fashion and, ultimately,
extend the proﬁle to lower densities. Furthermore, it conve-
niently allows us to sidestep the issue of very small timesteps.
The diﬃculty in using unequal masses is that it falls on us
to tailor the particle-mass conﬁguration for every simulation
in order to ensure that the physically relevant processes are
adequately resolved. At the moment, this is more of an art
than a science and may not be straightforward, or even pos-
sible, in all cases.

3.3.1 Setting h

Traditionally, the smoothing length for equal-mass particles
is set using:

(cid:18) ma

(cid:19)1/ν

ρa

ha = η

,

(28)

where ν is the number of spatial dimensions and η is a di-
mensionless factor of order unity that controls the number of
neighbours per particle. Equations (10) and (28) form a set
of non-linear equations that must be solved at each timestep

6

Hutchison, Price, Laibe, & Maddison

to ensure self-consistency (Monaghan 2002; Price & Mon-
aghan 2007). For equal-mass particles, the above method
produces a smoothing length that is a function of the parti-
cle coordinates, i.e. hν ρ ∼ constant. However, the mass de-
pendence in Equation (28) destroys this coordinate relation
when using unequal-mass particles. To remove the mass de-
pendence and regain this relationship, we express h in terms
of number density, n, as deﬁned by Koshizuka et al. (1998)
and later adapted for SPH by Hu & Adams (2006). Then
the set of equations governing h for unequal-mass particles
is (Price 2012)

na =

Wab(ha),

(cid:88)
(cid:18) 1

b

na

(cid:19)1/ν

.

ha = η

Of course the density is still required by the hydrodynamic
equations and is computed via Equation (10), so n can be
computed alongside ρ at no extra computational cost.
Changing the functional form of h, on the other hand,
requires a diﬀerent formulation for the ∇h correction terms
that usually appear in Equations (11)–(14). These terms can
be obtained by re-deriving the ﬂuid equations from the La-
grangian and carefully accounting for the new deﬁnition of
h in Equations (29) and (30). These terms were ﬁrst derived
by D.J. Price and later reported by Merlin et al. (2010):

(cid:20)

(cid:21)−1

,

(31)

b ≡
χa

1 +

ζa/mb

Ω∗

a

where
ζa ≡ ∂ha
∂na

(cid:88)

c

and
a ≡ 1 − ∂ha
∗
∂na

Ω

(cid:88)

c

∂Wac(ha)

∂ha

.

(33)

We use the notation Ω∗ to avoid confusion with the usual
equal-mass ∇h correction term and the summation index c
to emphasis that ζ and Ω∗ require their own summation over
the particles (again performed alongside ρ). It is straight-
forward to show that, apart from the alternate correction
terms, the form of the one-ﬂuid equations remain unchanged
when evolving h using a number density formulation.

3.3.2 Kernel choice

All equal-mass tests performed in this paper use the M6 and
double-hump M6 quintic spline kernel as prescribed by Laibe
& Price (2012a). We found out that the M6 kernel is unsuit-
able for use with unequal-mass particles because it is suscep-
tible to the pairing instability. The necessary condition that
prevents particle pairing from occurring is a kernel with a
non-negative Fourier transform (Dehnen & Aly 2012). The
Wendland kernels have this as one of their deﬁning prop-
erties (Wendland 1995), making them ideal candidates for
unequal-mass simulations. We use the Wendland C 2 kernel
for all unequal-mass simulations. This decision was purely
based on computational cost (proper analysis of the perfor-
mance and accuracy of the diﬀerent kernels using unequal
masses is beyond the scope of this paper).

∂Wac(ha)

,

(32)

g =

mc

∂ha

GM z

(R2 + z2)3/2 ˆz,

Kernels are usually expressed as a generic function of
the smoothing length h and a dimensionless distance q be-
tween particle pairs,
W (r, h) ≡ σ

(34)

.

The particular form of f (q) for the Wendland C 2 is

where q ≡ |rab|
(cid:1) ,

ha

if ν = 1

hν f (q),

f (q) =

(cid:1)3
(cid:1)4


(cid:0)1 − q
(cid:0)1 − q

(cid:0)1 + 3q
tion factors are σ =(cid:2) 5

+

+

2

2

2

(1 + 2q),

8 , 7

4π , 21

16π

(35)

if ν = 2, 3,

(cid:3) in [1, 2, 3] dimensions and

where we deﬁne (·)+ ≡ max{0,·}. The relevant normalisa-

the resolution length factor we use throughout is η = 1.3.
Note the value of η can dramatically aﬀect stability when
using the Wendland kernels (for a discussion about choosing
an appropriate η, see Dehnen & Aly 2012).

(29)

(30)

4 PLANE-PARALLEL ATMOSPHERE

Before proceeding further, we wish to demonstrate that the
algorithms above are not only necessary, but suﬃcient for
SPH to be used as a viable tool for simulating the range
of densities and stopping times shown in Figure 1. Con-
sider a thin, plane-parallel slab of gas and dust placed in
non-rotating, vertical, hydrostatic equilibrium created from
pressure-gravity balance. Using the vertical component of
gravity from a central star with mass M and located a dis-
tance R from the midplane of the slab, i.e.,

(36)

(cid:21)

(cid:20)

− z2
2H 2

we obtain a disc-like atmosphere with physical densities
and temperatures. In particular, for an isothermal disc in
near vertical hydrostatic equilibrium, the density can be ex-
pressed as,

ρ(z) = ρg,0 exp

,

(37)

where ρg,0 is the midplane density and H is the scale height
of the disc (e.g. Laibe et al. 2012).

This plane-parallel atmosphere contains all of the
physics needed to calculate the drag properties shown in
Figure 1. The density proﬁle from the top panel can be repro-
duced by choosing the following physical parameters: M =
1 M(cid:12), ρg,0 = 10−11 g/cm3, R = 5 AU and H = 0.25 AU. Us-
ing these parameters, Figure 2 contrasts two identical discs
in hydrostatic equilibrium created from equal-mass particles
(brown) and unequal-mass particles (grey). To aid visuali-
sation, only 5050 particles are used in each case. The top
panel overlays the density proﬁles for both discs along with
the shaded photoevaporation region from Figure 1. Impor-
tantly, equal-mass particles cannot resolve the photoevap-
oration region simultaneously with the disc midplane. Fur-
thermore, the lack of resolution at low densities causes in-
accuracies, namely the ﬂared edges in the density proﬁle.
Increasing the number of particles is not a solution; even
with over a million particles, we only secure ∼ 10 particles
to resolve the photoevaporation region.

Even if it were possible to resolve the density with equal-
mass particles, the resulting restriction on the timestep from

MNRAS 000, 1–19 (2016)

using equal-mass particles would be prohibitively small. The
dashed lines in the bottom panel of Figure 2 show that the
Courant timestep for equal-mass particles is already a fac-
tor of ∼ 2 smaller than the unequal-mass particles. By the
time one did add enough equal-mass particles to minimally
resolve the photoevaporation region, the Courant timestep
would be smaller than the drag stopping time. Thus, using
equal-mass particles to achieve high resolutions in the photo-
evaporation region while maintaining a reasonable timestep
is impractical.

However, using unequal-mass particles does not solve
everything. In addition to the Courant timestep, the bot-
tom panel also shows the drag stopping time for s = 0.1 µm
dust grains, our smallest and most restrictive grain size in
this study. The ∼ 5 orders of magnitude diﬀerence between
the Courant and drag limited timesteps shows how diﬃcult
it is to simulate small dust grains in discs explicitly. Our
implicit scheme—made possible by the one-ﬂuid approach—
overcomes this issue and allows us to default to the Courant
timestep. Furthermore, the one-ﬂuid formalism allows us to
accurately simulate the entire range of drag regimes exhib-
ited by 0.1 µm grains or any other grain size. The accuracy
of our implicit timestepping scheme and one-ﬂuid formal-
ism is tested hereafter; nevertheless, Figure 2 demonstrably
shows that unequal-mass particles, working in tandem with
the one-ﬂuid formalism and implicit timestepping, are capa-
ble of simulating the physical conditions required by dusty
photoevaporative winds. To our knowledge, it is currently
the only numerical method capable of doing so.

5 NUMERICAL TESTS

We have extensively benchmarked our code gdphoto on
standard dust/gas test problems from the literature: dusty-
box, dustywave, dustyshock, and dustydisc (Laibe &
Price 2011, 2012a; Price & Laibe 2015). We catalogue a sub-
set of these results—particularly those involving unequal-
mass particles and implicit timestepping—in Appendix A.
The only remaining segment of code to benchmark is our
thermal energy switch used to create photoevaporation. We
do this using the analytic plane-parallel wind solution and
associated test problem proposed by Hutchison & Laibe
(2016), enhanced with a semi-analytic dust phase from
HLPM16 (in order to better suit the needs of our two-phase
code). Following the dusty- naming convention from Laibe
& Price (2012a), we name this test dustyphoto.

5.1 dustyphoto

The dustyphoto test uses the plane-parallel atmosphere
outlined in Section 4 because its simpliﬁed geometry allows
an analytic treatment of photoevaporation while still accu-
rately describing the ﬂow from real discs on a local scale. Be-
cause the two-phase disc dynamics are veriﬁed in the dusty-
disc test in Appendix A4, the dustyphoto test speciﬁcally
measures the accuracy of the thermal energy switch respon-
sible for photoevaporation (described below).

MNRAS 000, 1–19 (2016)

How dusty are photoevaporative winds?

7

Figure 2. Gas density (top) and stopping time (bottom) in
two numerical simulations using equal-mass particles (brown)
and unequal-mass particles (grey). The solid (dashed) brown and
black lines in the top (bottom) panel indicate the smoothing
length (Courant timestep) for each mass type. Equal-mass parti-
cles are unsuitable for simulating photoevaporation in SPH due to
poor resolution in the surface layers of the disc (top), the inabil-
ity to reach suﬃciently low densities (top), and timestep restric-
tions from a crowded midplane (bottom). Having the minimum
stopping time so much smaller than the Courant timestep sug-
gests the need for an implicit timestepping algorithm. Our use of
unequal-mass particles resolves the density range (top) while the
one-ﬂuid formalism with implicit timestepping handles the range
in stopping time (bottom).

5.1.1 Setup

The physical parameters for the disc are M = 1 M(cid:12), ρg,0 =
10−11 g/cm3, R = 5 AU and H = 0.25 AU. We create the
disc by placing 200 028 particles on a uniform (staggered)
lattice inside a Cartesian box, (x, z) ∈ [−6H, 6H], with pe-
riodic horizontal boundary conditions and dynamic verti-
cal boundaries, as proposed by Hutchison & Laibe (2016).
The dynamic boundaries are created by converting the ﬁrst
ionised particles at t = 0 into boundary particles and con-
straining them to move strictly in the vertical direction at

8

Hutchison, Price, Laibe, & Maddison

(cid:115)

(cid:20)

(cid:18)

(cid:19)(cid:21)

the local wind speed prescribed by the analytic solution:

vg = cs

−W0

− exp

2GM
√
R2 + z2

−

c2
s

− 1

,

(38)

where W0 is the main branch of the Lambert W func-
tion (Corless et al. 1996). Because the velocities are z
dependent, the boundary particles will slowly drift apart
over time. Thus, it is important to initialise the run with
enough boundary particles to prevent simulation particles
from squeezing through into empty space. To be safe we
employ ∼ 20 000 boundary particles on each side of the disc.
The dust phase is comprised of a single grain size
s = 2 µm, chosen to be near the maximum entrainable grain
size, as this will provide the most stringent test of our drag
coupling in the ﬂow. In order to be consistent with the as-
sumptions of the semi-analytic model from HLPM16, we en-
force  = 0.01 for all neutral particles during the simulation,
i.e. disc settling is not allowed to take place. We assume
each grain has an intrinsic dust density ρgrain = 3 g/cm3,
while the SPH particle mass is set using the iterative method
described in Appendix A4. The solution for the dust is ob-
tained by numerically integrating the following ordinary dif-
ferential equation,

vd

dvd
dz

=

K
ρd

(vg − vd) −

GM z

(R2 + z2)3/2 ,

(39)

with the initial condition vd,i = 0. The gas and dust densities
are obtained from the relation ˙m = ρv = ρivi where ˙m is a
constant and the subscript i on ρ and v denotes initial wind
values at the ionisation front.

5.1.2 Thermal energy switch

Photoevaporation is created using an EUV thermal energy
switch similar to Alexander et al. (2006). We instantaneously
heat any ﬂuid that falls below the ionisation front density
ρi, empirically selected from the photoevaporation region
identiﬁed in Figure 1. This empirical condition is necessary
because we cannot integrate column densities along lines of
sight in a plane-parallel atmosphere. For convenience, we pa-
rameterise ρi using its own relative fraction to the midplane
density, ξ ≡ ρi
. Eﬀectively, this parameterisation allows us
to separately adjust the strength of the two physical quan-
tities primarily responsible for the location of the ionisation
front in the disc—the radial density proﬁle (via ρg,0) and
the EUV ionisation ﬂux (via ξ).

perature of T = 104 K and a sound speed cs = (cid:112)kBT /µ.

The ionised gas is assumed to be isothermal with a tem-

ρg,0

Here kB is Boltzmann’s constant and µ is the mean molec-
ular weight—taken to be 0.88 u for ionised gas. The beneﬁt
of setting the ionisation front using the density is that it
self adjusts the physical location according to the dynamics
within the disc. This attribute is important for two reasons:
First, the onset of photoevaporation creates large pertur-
bations in the disc, particularly compression and expansion
oscillations at the surface. Second, without accretion to re-
supply our disc with material, we never reach a true dynamic
equilibrium in our disc. In either case, we need to be able to
determine the location of the ionisation front without adding
artefacts.

Although not strictly necessary, we ﬁnd that we can con-
verge to the analytic solution more quickly if we gradually

raise the ionisation temperature from the isothermal disc
temperature at t = 0 to 104 K over a period of ∼ 1.5 years.
Unlike the dustydisc test, there is no need to relax the disc
prior to starting simulations. We start our disc in isother-
mal equilibrium, consistent with the initial density proﬁle
in Equation (37), but immediately default to an adiabatic
equation of state whenever the gas particles are neutral, i.e.
P = (γ − 1)ρu where γ = 5/3. This allows us to capture
the compressional heating caused by the ionised wind and
to resolve the otherwise discontinuous temperature diﬀer-
ence between the neutral disc and the ionised wind. The
sound speed for neutral particles is calculated according to

cs =(cid:112)γkBT /µ, where µ = 2.34 u.

5.1.3 Solution

Figure 3 shows the velocity and density proﬁles of the gas
and dust after 111 years (≈ 10 orbits) plotted against their
analytic and semi-analytic solutions, respectively. The sta-
tionary shock created by the ionisation front causes nearly
discontinuous jumps/drops in the density, velocity, pressure,
and internal energy (cf. Figure A2). In order to match the
semi-analytic model to our numerical solution, we visually
ﬁt the initial gas and dust density in the wind using ˙m. The
values used in Figure 3 are ˙mg ≈ 3.6× 10−12 g cm−2s−1 and
˙md ≈ 5.8 × 10−15 g cm−2s−1. The L2 errors computed by
splash (Price 2007) are in every case less than 1%, sug-
gesting that our photoevaporation mechanism is robust and
working as expected.

Note while running this test, we observe a numerical
instability in the one-ﬂuid SPH equations that causes  and
∆v to diverge at the base of the outﬂowing wind. We ob-
serve a similar phenomenon while running the dustydisc
test in Appendix A4. We circumvent this instability by us-
ing the non-conservative SPH formulation prescribed in Ap-
pendix B1.

6 DUSTY PHOTOEVAPORATION

Having shown that gdphoto can accurately simulate the
gas and dust dynamics in photoevaporating discs, we are
now ready to allow dust settling within the disc during pho-
toevaporation. At the same time, we examine how grain size,
base ﬂow density, and radius aﬀect dust entrainment in the
wind. Finally, we look for any residual eﬀects in the gas pro-
duced by the back reaction of entrained dust grains. Except
where otherwise indicated, we continue using the setup from
Section 5.1.

6.1 Dust entrainment properties

6.1.1 Grain size

Given the assumption that ρgrain is the same for all grain
sizes, Equation (8) shows that drag, and therefore dust en-
trainment, is inversely proportional to s. However, the tran-
sition from perfect entrainment in winds to perfect settling
in discs is not well understood. To understand this better, we
select ﬁve grain sizes, s = [0.1, 0.5, 1, 5, 10] µm, that bridge
this transition. Because 0.1 µm grains are nearly perfectly
coupled to the gas, we use their velocity and density to gauge

MNRAS 000, 1–19 (2016)

How dusty are photoevaporative winds?

9

Figure 3. Velocity (top) and density (bottom) proﬁles in the dustyphoto test after 111 yr ≈ 10 orbits using 200 028 SPH particles. The
numerical solution for the gas (solid blue dots) and dust (open brown circles) phases are plotted together with the semi-analytic model
(black solid, dashed, and dotted lines) from HLPM16. Using the dynamic boundary conditions proposed by Hutchison & Laibe (2016),
the gas converges to the analytic solution almost immediately. The dust velocity also converges very quickly to its semi-analytic solution,
but the dust density takes much longer to reach its steady state, which lags behind the moving boundary by ∼ 50 AU.

Figure 4. Dust densities for ﬁve diﬀerent grain sizes in a photoevaporating vertical disc slab using 200 028 particles. For comparison, each
grain size is identically distributed through the disc with a dust-to-gas ratio of 0.01. Only grains (cid:46) 1 µm are entrained in the outﬂowing
winds. The decaying density oscillations the appear in the 5 µm panel are numerical artefacts similar to the post-shock oscillations
observed in the dustyshock problem in Appendix A3.

MNRAS 000, 1–19 (2016)

vz [km/s]-505t=111 [yr]log  [g/cm3]z [AU]-50050-25-20-15z [AU]x [AU]-101-5050.1 mx [AU]-1010.5 mx [AU]-1011 mx [AU]-1015 mx [AU]-101-30-25-20-15log  [g/cm3]t=108 [yr]10 m10

Hutchison, Price, Laibe, & Maddison

the entrainment experienced by other grain sizes. Figure 4
compares the dust densities for these grains after ∼ 10 orbits
at 5 AU. As expected, we see a steady decline in entrainment
with increasing grain size, with a sharp change near 1 µm.
By 5 µm, entrainment has ceased altogether. In fact, settling
is eﬃcient enough by this point to have completely removed
these grains from the photoevaporation region. Although the
5 µm panel shows a small amount of dust in the outﬂow re-
gion, this dust results from numerical oscillations—the same
post-shock oscillations we see in the zero drag dustyshock
test (for a discussion on these oscillations, see Appendix B).

Figure 5 shows the dust velocities as a function of posi-
tion for the three entrained grain sizes. We see a small, but
deﬁnite layering in the dust velocities in the outﬂow. The
layering is most pronounced initially when the gas velocities
are high. Over time, the eﬀect decreases as the outﬂow ve-
locities settle into a steady state. In a vertical wind, grains
with diﬀerent outﬂow velocities are almost indistinguishable
from one another, but in a rotating disc, the trajectories will
separate due to conservation of angular momentum. Thus,
any layering in phase space translates into stratiﬁcation in
altitude in position space, similar to projectile motion from
a rotating object in a gravitational ﬁeld. In extreme cases,
the shallow trajectories from very slow grains could lead to
recapture at large disc radii. However, we do not see a lot of
evidence for such a transport mechanism due to such incre-
mental changes in velocity and the sharp cutoﬀ in entrained
grain size.

These observations depend in part on the velocity pro-
ﬁle of the gas wind. The lack of a sonic point in steady state
plane-parallel winds (see Figure 3) means that we underes-
timate wind speeds in discs, particularly at large z (note our
model is only designed to apply close to the disc surface).
We overcome this in part by allowing our ﬂow to expand into
empty space, but the photoevaporation rate slows as the at-
mosphere above the disc ﬁlls with gas and pressure pushes
back on the ﬂow. These lower velocities reduce entrainment
by decreasing the diﬀerential velocity between gas and dust.

We can artiﬁcially increase the wind speed by adjusting
the vertical boundary conditions to measure how strongly
our underestimated wind speed aﬀects the types of grains
we can entrain in our outﬂow. Introducing an open bound-
ary condition creates an inﬁnite vacuum into which the ﬂuid
near the edge can continuously accelerate, but never ﬁll up.
The constant acceleration of ﬂuid near the boundary forces
the system into a new steady state with a higher outﬂow ve-
locity. The position of the boundary determines the steady
state velocity proﬁle. We trial two boundary positions at
±10 and ±5 AU which double and quadruple the outﬂow
velocity, respectively. As expected, the higher velocities im-
prove entrainment, but the eﬀect is somewhat underwhelm-
ing. The 1 µm dust density moves from being weakly en-
trained to well entrained, but there are no other visible ef-
fects to the other grain sizes. Therefore, even though our
model underestimates the outﬂow velocity in discs, we can
be conﬁdent that our large/small dust grain dynamics pro-
vide a good representation of reality while our intermediate
grains set close lower bounds on the physical properties of
maximally entrained grains.

Figure 5. Layering of dust velocities in phase space suggests that
each grain size in Figure 4 will follow a unique trajectory when
pulled into the wind. Initially, when the gas outﬂow is very fast,
the diﬀerent grain sizes experience signiﬁcantly diﬀerent outﬂow
speeds. As time goes on and gas speeds drop, this layering of dust
velocities—although still visible—becomes less distinct.

6.1.2 Base ﬂow density

We study the dust’s sensitivity to the base ﬂow density at the
disc/wind interface because this is the only location in which
photoevaporation can extract dust from the disc. Physically,
the base ﬂow density is determined by the density structure
of the disc and the optical depth of ionising radiation. In
our model, these properties are controlled by the midplane
density, ρg,0, and the relative penetration depth, ξ.
Our ﬁducial value of ξ = 10−5 is a conservative esti-
mate marking the lower boundary of where we expect pho-
toevaporation to take place (see Figure 1). The diversity in
young stars, along with their inherent variability in UV and
X-ray radiation, make it possible that photoevaporation can
be extended to much higher densities. The recently proposed
‘thermal sweeping’ mechanism even suggests that gas all the
way down to the midplane can be disrupted and evacuated
on very short timescales (Owen et al. 2012, 2013). We per-
form simulations using the following (somewhat extreme)
four penetration depths, ξ = [10−4, 10−3, 10−2, 10−1], with
grain sizes ranging from 0.1 µm to 1 m.

For each diﬀerent penetration depth, we observe the
same general dependence on grain size we saw above, but
the maximally entrained grain size increases linearly with ξ.
This linear relationship can be seen in Figure 6, which shows
the density proﬁle for the largest well entrained grain size at
each value of ξ. Note the prominent dip in the density of the
mm grains near 1.5 AU has nothing to do with entrainment,
but rather shockwaves ringing through the disc. Photoevap-
oration occurring at one or two orders of magnitude below
the midplane density signiﬁcantly disrupts the hydrostatic
equilibrium of the disc. The combination of shock waves and

MNRAS 000, 1–19 (2016)

vz [km/s]-10-50510t=1.43 [yr]vz [km/s]-10-50510t=10.2 [yr]vz [km/s]z [AU]-505-10-50510t=109 [yr]s = 0.1 ms = 0.5 ms = 1 mvz [km/s]-505t=1.43 [yr]vz [km/s]-505t=10.2 [yr]vz [km/s]z [AU]-505-505t=109 [yr]s = 0.1 ms = 0.5 ms = 1 mvz [km/s]-202t=1.43 [yr]vz [km/s]-202t=10.2 [yr]vz [km/s]z [AU]-505-202t=109 [yr]s = 0.1 ms = 0.5 ms = 1 mHow dusty are photoevaporative winds?

11

Figure 7. Velocity (top) and density (bottom) proﬁles for gas
(solid dots) and 0.1 µm dust grains (open circles) at ﬁve diﬀer-
ent stellar masses. The gas velocity is reduces as stellar mass
increases, thus reducing the eﬃciency of dust entrainment.

single-phase photoevaporative winds without requiring the
complex two-phase hydrodynamic simulations we do here.

6.1.3 Stellar mass

As mentioned above, the stellar mass is not independent of
disc mass or radiation luminosity. In the treatment above, we
isolate and vary ρg,0 and ξ individually while the stellar mass
is ﬁxed. We now reverse their roles and vary stellar mass
while ρg,0 = 10−11 g/cm3 and ξ = 10−5 remain ﬁxed. Using
ﬁve diﬀerent stellar masses, M = [0.5, 0.75, 1, 1.25, 1.5] M(cid:12),
Figure 7 shows the resulting velocity (top panel) and den-
sity (bottom panel) proﬁles for both gas and s = 0.1 µm dust
grains. This time the gas velocity proﬁle is altered in addi-
tion to its density because the escape speed is proportional
to

√

M ,

(cid:114)

vesc ≈

2GM
R

.

(40)

This square-root dependence on mass can be observed in the
relative spacing between wind velocities in the top panel.

Lower outﬂow velocities translate into steeper gradients
in the gas density. The combination of low outﬂow velocities

Figure 6. Dust density of the largest well entrained grain size for
each of ﬁve diﬀerent penetration depths as a function of z. There
is a linear correlation between the penetration depth ξ and the
maximally entrained grain size.

high mass loss rates destroy the disc in a matter of years;
hence the short timescale on our plot.

The violent manner in which thermal sweeping rips
discs apart has important implications for observations of
transition discs. Not only does it remove the gas on short
timescales, but can evacuate up to ∼ cm sized dust grains
all the way down to the midplane. However, we must be
careful in making these claims since simultaneously entrain-
ing all grains smaller than 1 cm would signiﬁcantly alter the
optical properties of the disc and its atmosphere. The feed-
back caused by having such large amounts of dust entrained
in the outﬂow can only be modelled by coupling the ﬂuid
dynamics with radiative transfer calculations.

These simulations represent some of the most extreme
scenarios that photoevaporation can produce. Usually pho-
toevaporation is much more quiescent. Furthermore, ra-
diation ﬂux and disc mass are not independent quanti-
ties because massive stars tend to have higher disc masses
and luminosities than low-mass stars. Therefore, we also
explore what happens when we increase ρg,0 while keep-
ing ξ constant. In eﬀect we are still increasing/decreasing
the base ﬂow density for our wind, but now the disc al-
ways maintains a near hydrostatic equilibrium. Return-
ing to our ﬁducial penetration depth, ξ = 10−5, we test
ρg,0 = [10−12, 10−11, 10−10, 10−9] g/cm3. Because we want
to isolate the coupling between base ﬂow density and dust
entrainment, we do not alter the mass of the central star
just yet (see Section 6.1.3).

When we compare the results we obtain from varying
ρg,0 to those obtained from varying ξ above, we observe no
perceptible diﬀerences in dust entrainment. This is surpris-
ing because the disc equilibrium is signiﬁcantly diﬀerent in
both tests. The fact that the maximum entrained grain size
is so simply related to the base ﬂow density is fortunate
for modellers. To illustrate, radiative transfer models that
calculate the base ﬂow gas density as a matter of course
could use this relation to approximate the dust content in

MNRAS 000, 1–19 (2016)

z [AU]log  [g/cm3]-202-18-16-14-12t=3.02 [yr]s = 0.0001 mms = 0.001 mms = 0.01 mms = 0.1 mms = 1 mm = 10-5 = 10-4 = 10-3 = 10-2 = 10-1vz [km/s]-10-50510log  [g/cm3]z [AU]-20020-19-18-17t = 23.6 [yr]M = 0.5 MࣻM = 0.75 MࣻM = 1 MࣻM = 1.25 MࣻM = 1.5 Mࣻ12

Hutchison, Price, Laibe, & Maddison

Table 1. Initial disc parameters at select radii are taken from
the standard model of Woitke et al. (2016) in order to ensure we
have a consistent disc structure from one simulation to the next.
Relevant quantities at each radius are (from left to right) scale
height H0, midplane gas density ρg,0, ionisation front location zi,
and penetration depth ξ.

R (AU)

H0 (AU)

1
2
5
10
20
50
100
200

0.05
0.11
0.32
0.71
1.60
4.70
11.00
25.00

ρg,0 (g/cm3)
2.0 × 10−10
4.0 × 10−11
4.0 × 10−12
1.5 × 10−12
2.5 × 10−13
2.5 × 10−14
3.0 × 10−15
2.5 × 10−16

zi (AU)

0.2
0.5
1.4
3.0
7.2
21.0
46.0
98.0

ξ

5 × 10−4
1 × 10−4
1 × 10−4
1 × 10−4
5 × 10−4
5 × 10−4
5 × 10−4
1 × 10−4

and low wind densities leads to a signiﬁcant reduction in dust
entrainment as M increases. Even our “perfectly” entrained
0.1 µm grains show signs of waning entrainment by the way
the base ﬂow density for the dust is shifted successively lower
with increasing M . Ultimately, this means that stellar mass
competes with the synergistic eﬀects of disc mass and lumi-
nosity to determine the entrainment properties of the ﬂow.

6.1.4 Distance to the central star

We use our thin disc model to analyse how dust entrainment
varies as a function of distance to the central star by obtain-
ing the complete 2D density and thermal structure for our
disc from an external model. Using the standard model from
Woitke et al. (2016), we select disc parameters from eight
radii and insert these into our model. Because our thermal
energy switch is comparatively simpler, we approximate the
location of the ionisation front from their model. We also
keep our ionisation temperature ﬁxed at 104 K regardless of
radius. The initial disc parameters we use for each radius
are listed in Table 1.

Figure 8 compares the 0.1 µm dust density as a func-
tion of radius. Immediately obvious is the complete ab-
sence of dust grains in the outﬂow region at R (cid:46) 2 AU and
R (cid:38) 100 AU. The inner cutoﬀ is due to photoevaporation’s
local inability to provide enough energy for gas to reach es-
cape velocities. At large radii, dusty outﬂows are quenched
by the diminished base ﬂow densities brought about by the
radial attenuation in gas density. More subtly, comparing
these results to simulations of larger grain sizes shows that
these inner/outer critical radii are diﬀerent for each grain
size. As s increases, the dust entrainment region shrinks to
a point located between 10–20 AU, or in terms of the gravi-
tational radius (rg ≡ GM(cid:63)/c2
s ≈ 9 AU), between rg and 2 rg.
This is the location where the largest possible grain size
can be entrained in the ﬂow. This should not be confused
with the peak dust density in the ﬂow, which always occurs
close to the disc surface at the inner cutoﬀ radius. Careful
study of Figure 8 conﬁrms that the peak dust density in the
wind occurs near the surface of the disc at R = 2 AU. Close
inspection also reveals that the subsequent dust density is
lower than the relatively constant neighbouring densities at
R = 5–10 AU by a factor of ∼ 1.5. This trend of initially high
densities having a steeper gradient in the wind is observed
in all of our dust grains.

These ﬁndings are in agreement with Owen et al. (2011)
who perform a similar study looking at maximally entrained
grain sizes as a function of distance from the central star.
An important diﬀerence between our studies, however, is
that we are not restricted to simulating maximally entrained
grains. It is easy to imagine a case where the grains are only
marginally entrained and become decoupled from the gas in
the low density outﬂow—we observe just such a scenario for
0.5 µm and 1 µm grains at R = 2 AU. The competition be-
tween gravitational settling and aerodynamic drag can trap
intermediate sized grains in a quasi-steady dust cloud that
hovers above the surface of the disc. Meanwhile grains in the
disc continue to settle and evacuate the wind’s launch region,
creating a marked depletion of dust in the region above and
below the ionisation front. As can be seen in Figure 9, the
depth, and width of this depleted region will depend strongly
on grain size and probably radial location. We expect the
same phenomenon to occur at outer cutoﬀ radii, but we do
not observe any more of these dips—likely due to our sparse
sampling in radius. The fact that we observe levitating dust
grains in our outﬂows is interesting, but it is important to
remember that these static concentrations of dust only oc-
cur in narrow regions around the cutoﬀ radius for each grain
size. It is uncertain whether these dust traps would persist
in simulations of full discs. Mathematically, however, this
is exactly the behaviour we would expect to see at critical
points where the forces are balanced (cf. the hover particles
from Liﬀman & Toscano 2000) and it shows that our algo-
rithm can properly resolve the intermediate drag regime in
photoevaporative outﬂows. Furthermore, it shows there is a
richness in the dust dynamics that is only captured by fully
modelling the coupled two-phase ﬂuid equations for gas and
dust.

6.2 Back-reaction on the gas

Given the small dust fraction in the wind, the back reac-
tion on the gas is small, insomuch that the velocity pro-
ﬁle appears to be oblivious to the presence of the dust. We
do, however, ﬁnd there is a small decline in gas density as
the entrained dust mass increases—approximately a 5% de-
crease from 10 µm to 0.1 µm grains. This vertical oﬀset in
density has almost no z dependence. Therefore, studies fol-
lowing the common practice of retroactively adding small,
well-entrained dust grains to single-phase photoevaporative
ﬂows in order to do radiative transfer calculations should
easily be able to account for this eﬀect. Mass-loss calcula-
tions including dust should likewise be adjusted. We do not
expect these changes will drastically change the outcomes
of any study, nevertheless researchers should be aware that
they occur.

The fact that we see a change in the gas density, but
not the velocity raises an interesting question: how much
dust would it take to eﬀect an observable change to the
velocity proﬁle? Understanding the eﬀect of diﬀerent dust-
to-gas ratios is important because we have no deﬁnitive ev-
idence that the canonical value of 0.01 is physically cor-
rect in discs. In fact, photoevaporation is almost guaranteed
to experience a range of dust-to-gas ratios as it clears gas
from discs. To better understand how strongly photoevap-
oration may depend on the local dust fraction in the disc,
we compare gas ﬂow properties in discs with dust-to-gas ra-

MNRAS 000, 1–19 (2016)

How dusty are photoevaporative winds?

13

Figure 8. Dust densities for 0.1 µm grains at eight radii in the disc spanning 1–200 AU. Photoevaporation and dust entrainment are most
eﬀective in the inner disc, but cannot operate at R (cid:46) 2 AU due to the strength of gravity. At large radii, photoevaporation continues to
function, but the gas densities are too low to entrain even very small grains. We ﬁnd there are three maxima of interest in the entrained
dust phase: (i) the global density peak that occurs near the disc surface at the inner cutoﬀ radius, (ii) the peak mass loss that occurs
near rg ≈ 9 AU, and (iii) the peak grain size entrained in the ﬂow that occurs between rg and 2 rg.

couple our dust dynamics to the radiation from the central
star. There are two main points to consider. The most im-
portant is that the opacity from entrained dust grains will
reduce the radiation that would otherwise be captured by
the disc, thereby altering the location of the ionisation front.
As shown previously by varying ρi, this can have a profound
eﬀect upon both gas and dust properties in the wind. The
other point to consider is that entrained dust grains will be
exposed to radiation pressure from the central star. We do
not expect radiation forces to be as important to photoe-
vaporation as they are to Wolf-Rayet stars (see Pistinner &
Eichler 1995); nevertheless it could enhance dynamical feed-
back on the gas. Both of these points are beyond the scope
of this study.

Figure 9. Dust densities for three grain sizes are plotted as a
function of z at R = 2 AU. Compared to the well entrained 0.1 µm
grains, the weakly entrained 0.5 µm and 1 µm grains show progres-
sive decoupling between dust in the disc and outﬂow. The static
density peak in the outﬂow is created by dust that is trapped by
the balance of (inward) gravitational settling and (outward) aero-
dynamic drag. The density trough, on the other hand, is created
by quenching of dusty outﬂows through settling.

tios of 0.05, 0.1, and 0.2. Even at unreasonably high values
like 0.2, the reduction in outﬂow speed caused by dust en-
trainment is marginal, of order a few percent. At this point,
however, the very structure of the gas disc is compromised by
having to support so much additional mass against gravita-
tional collapse. Therefore, we may safely assume that density
is the only gas quantity signiﬁcantly aﬀected by the presence
of dust in the ﬂow.

7 CONCLUSIONS

We show that by using unequal-mass, one-ﬂuid SPH we
can accurately simulate two-phase ﬂuid dynamics in highly
stratiﬁed atmospheres. In particular, we focus on simulating
small dust grains entrained by photoevaporative winds in
protoplanetary discs. We pioneer this method using a thin,
non-rotating, plane-parallel atmosphere undergoing photoe-
vaporation to build an understanding of dust dynamics in
photoevaporative ﬂows.

We run a suite of simulations varying grain size, base
ﬂow density, radius, and dust-to-gas ratio. From these tests
we recover some important results from the literature and
obtain new insights. Our main conclusions from these tests
are:

(i) Dust entrainment in typical photoevaporative winds
is limited to micron sized grains and smaller. As a result,
traditional photoevaporation cannot account for large dust
gaps in transition discs.

A caveat to all of our simulations is that we do not

(ii) The velocities of entrained dust grains are weakly

MNRAS 000, 1–19 (2016)

N)7)7  ##! # #CC?!"!OH)7N)7)7  ##! # #CC?! OH )7N)7)7##! # #CC?! $OH#)7N)7)7  ##! # #CC?!#'#OH)7N)7)7####! # #CC?!$!%OH )7N)7)7##! # #CC?!$$"OH#)7N)7)7  ##! # #CC?!$'!OH)7N)7)7####! # #CC?!&"OH )7z [AU]log  [g/cm3]-505-20-18-16-14-12t=85.3 [yr]s = 0.1 ms = 0.5 ms = 1 m14

Hutchison, Price, Laibe, & Maddison

dependent on grain size. This could result in layering of
diﬀerent sized dust grains in the wind, but provides little
evidence that this can be used as a transport mechanism
whereby weakly entrained dust particles are recaptured in
the outer regions of the disc.

(iii) There is approximately a one-to-one relation be-
tween the maximally entrained grain size and the base ﬂow
density of the gas. This has important observational ramiﬁ-
cations for discs undergoing thermal sweeping, as it suggests
that (cid:46)cm-sized grains can be evacuated when the disc is dis-
rupted, leaving large dust gaps in its wake.

(iv) The maximum entrainable grain size is carried out
at a critical radius between rg and 2 rg. All smaller grains
have an inner (outer) cutoﬀ radius that is smaller (larger)
than this critical radius. This means that photoevaporation
cannot entrain dust grains in the very inner/outer regions
of the disc.

(v) The peak dust density in the ﬂow occurs close to the
disc surface, near the inner cutoﬀ radius. Flows with higher
dust densities tend to have steeper gradients than those with
lower dust densities.

(vi) In narrow regions surrounding each grain’s cutoﬀ
radius, hovering dust grains concentrate and break away
from similar sized grains in the disc that settle towards the
midplane.

(vii) The back-reaction of the dust on the gas only has
a measurable eﬀect on the gas density. The gas velocity is
only aﬀected at extremely high dust-to-gas ratios.

Now that we have successfully developed a numerical
method capable of simulating small dust grains in photoe-
vaporative winds, the next step is to apply these methods
to a full disc. This process is not straight forward because
mixing of unequal-mass particles due to diﬀerential rotation
and accretion may cause numerical issues. Additionally, this
requires the development of an SPH energy switch capable
of approximating the radiative transfer in 3D. However, 3D
simulations would allow us to explore photoevaporation in
discs with non-axisymmetric features like spirals and warps.
Finally, we suggest further work needs to be done in the
following two areas: ﬁrst, the coupled feedback between disc
heating and opacity from entrained dust grains in disc winds,
and second, the eﬀect of adding radiation pressure to en-
trained dust grains.

ACKNOWLEDGEMENTS

We would like to acknowledge Peter Woitke for meaning-
ful discussions which resulted in an algorithm that was
substantially more realistic. Visualisations were performed
using SPLASH (Price 2007). M.H. acknowledges fund-
ing from a Swinburne University Postgraduate Research
Award (SUPRA). D.P. is supported by a Future Fellowship
(FT130100034) from the Australian Research Council. G.L.
acknowledges funding from the European Research Council
for the FP7 ERC advanced grant project ECOGAL. This
work was performed on the swinSTAR supercomputer at
Swinburne University of Technology.

REFERENCES

Adams F. C., Hollenbach D., Laughlin G., Gorti U., 2004, ApJ,

611, 360

Alexander R. D., Clarke C. J., Pringle J. E., 2004, MNRAS, 354,

71

Alexander R. D., Clarke C. J., Pringle J. E., 2006, MNRAS, 369,

216

Alexander R., Pascucci I., Andrews S., Armitage P., Cieza L.,

2014, Protostars and Planets VI, pp 475–496

Armitage P. J., 2011, ARA&A, 49, 195
Corless R., Gonnet G., Hare D., Jeﬀrey D., Knuth D., 1996, Ad-

vances in Computational Mathematics, 5, 329

Dehnen W., Aly H., 2012, MNRAS, 425, 1068
Epstein P. S., 1924, Physical Review, 23, 710
Ercolano B., Clarke C. J., Drake J. J., 2009, ApJ, 699, 1639
Gingold R. A., Monaghan J. J., 1977, MNRAS, 181, 375
Glassgold A. E., Najita J., Igea J., 1997, ApJ, 480, 344
Gorti U., Hollenbach D., 2009, ApJ, 690, 1539
Hollenbach D., Johnstone D., Lizano S., Shu F., 1994, ApJ, 428,

654

Hu X. Y., Adams N. A., 2006, Journal of Computational Physics,

213, 844

Hutchison M. A., Laibe G., 2016, A Plane-Parallel Wind Solu-
tion For Testing Numerical Simulations of Photoevaporation,
submitted to PASA

Hutchison M. A., Price D. J., Laibe G., Maddison S. T., 2016,
Dusty photoevaporation - I. A semi-analytic model, submitted
to MNRAS

Koshizuka S., Nobe A., Oka Y., 1998, International Journal for

Numerical Methods in Fluids, 26, 751

Laibe G., Price D. J., 2011, MNRAS, 418, 1491
Laibe G., Price D. J., 2012a, MNRAS, 420, 2345
Laibe G., Price D. J., 2012b, MNRAS, 420, 2365
Laibe G., Price D. J., 2014a, MNRAS, 440, 2136
Laibe G., Price D. J., 2014b, MNRAS, 440, 2147
Laibe G., Price D. J., 2014c, MNRAS, 444, 1940
Laibe G., Gonzalez J.-F., Maddison S. T., 2012, A&A, 537, A61
Liﬀman K., Toscano M., 2000, in Lunar and Planetary Institute

Science Conference Abstracts. p. 1108

Lodato G., Price D. J., 2010, MNRAS, 405, 1212
Lor´en-Aguilar P., Bate M. R., 2014, MNRAS, 443, 927
Lucy L. B., 1977, AJ, 82, 1013
Merlin E., Buonomo U., Grassi T., Piovan L., Chiosi C., 2010,

A&A, 513, A36

Miura H., Glass I. I., 1982, Royal Society of London Proceedings

Series A, 382, 373

Monaghan J. J., 2002, MNRAS, 335, 843
Monaghan J. J., Price D. J., 2006, MNRAS, 365, 991
Osterbrock D. E., Ferland G. J., 2006, Astrophysics of gaseous
nebulae and active galactic nuclei. University Science Books
Owen J. E., Ercolano B., Clarke C. J., Alexander R. D., 2010,

MNRAS, 401, 1415

Owen J. E., Ercolano B., Clarke C. J., 2011, MNRAS, 411, 1104
Owen J. E., Clarke C. J., Ercolano B., 2012, MNRAS, 422, 1880
Owen J. E., Hudoba de Badyn M., Clarke C. J., Robins L., 2013,

MNRAS, 436, 1430

Pistinner S., Eichler D., 1995, ApJ, 454, 404
Price D.

Institute
omy, Madingley Rd, Cambridge, CB2
<EMAIL>dprice@cantab.net</EMAIL>

J.,

2004, PhD thesis,

of Astron-
0HA, UK

Price D. J., 2007, Publ. Astron. Soc. Australia, 24, 159
Price D. J., 2012, Journal of Computational Physics, 231, 759
Price D. J., Federrath C., 2010, MNRAS, 406, 1659
Price D. J., Laibe G., 2015, MNRAS, 451, 813
Price D. J., Monaghan J. J., 2007, MNRAS, 374, 1347
Rasio F. A., Lombardi Jr. J. C., 1999, Journal of Computational

and Applied Mathematics, 109, 213

MNRAS 000, 1–19 (2016)

Sod G. A., 1978, Journal of Computational Physics, 27, 1
Tielens A. G. G. M., Hollenbach D., 1985, ApJ, 291, 722
Wendland H., 1995, Advances in Computational Mathematics, 4,

389

Woitke P., et al., 2016, A&A, 586, A103

APPENDIX A: NUMERICAL TESTS OF
DUST-GAS NUMERICAL METHOD

Incorporating all of the numerical algorithms needed to sim-
ulate photoevaporation and small dust grains together in a
single code involved signiﬁcant changes to our standard SPH
code: (i) the one-ﬂuid formalism, (ii) the variable smoothing
length and number density formulation for unequal masses,
(iii) the Wendland kernels, and (iv) the implicit timestep-
ping. We also parallelised the code using OpenMP to im-
prove speed. In order to ensure the code is working prop-
erly, we have benchmarked it using some canonical gas/dust
test problems: dustybox and dustywave (Laibe & Price
2011), dustyshock (Sod 1978; Miura & Glass 1982; Laibe
& Price 2012a), and the settling test (hereafter dustydisc;
Price & Laibe 2015). These tests ensure that our numerical
implementation of the equations in Section 3 are correct and
show that we are able to accurately track the aerodynamic
coupling between gas and dust in very high drag regimes.

A1 dustybox

The dustybox problem is a simple drag test using a two-
phase ﬂuid of gas and dust at rest in their barycentric frame
of reference, i.e. v = 0, but where ∆v (cid:54)= 0. This test isolates
and checks the drag terms since all other terms are zero.
More importantly, it veriﬁes our implicit time-stepping al-
gorithm in Section 3.2 because it uses the same analytic
solution. If done correctly, the solutions should match ex-
actly.
We set 100 equally spaced particles in a periodic 1D
box, x ∈ [−0.5, 0.5]. The total density and sound speed of
the gas are ρ = cs = 1, the dust fraction is  = 0.5, and
the dust velocity vd = 0.01, all in code units. No dissipation
or viscosity is applied in this problem. We performed tests
at ﬁve diﬀerent drag regimes (K = [0.01, 0.1, 1, 10, 100]) and
found that the implicit scheme reproduces the analytic ve-
locity curves for the dust to machine precision. This shows
that our proposed implicit evolution equations for ∆v are
valid. Furthermore, we conﬁrmed that the energy for the
system is exactly conserved (along with mass and momen-
tum), implying that our evolution equations for u are also
sound.

A2 dustywave

The dustywave problem (Laibe & Price 2011) probes the
pressure force in the gas using the propagation of linear
sound waves caused by small sinusoidal perturbations in the
velocity, density, and energy. Instead of stretching equal-
mass particles to produce the desired density perturbation,
we simply build the perturbation directly into the particle
masses and leave the particle spacing uniform. The equilib-
rium values describing the ﬂuid are as follows: v0 = 0, ρg,0 =
1, and u0 = P0/[(γ − 1)ρg,0] with γ = 5/3 and P0 = 3/5,

MNRAS 000, 1–19 (2016)

How dusty are photoevaporative winds?

15

Figure A1. Gas (blue ﬁlled circles) and dust (brown open circles)
velocities are plotted after 4.5 periods in the dustywave problem
using 100 unequal-mass particles and the drag coeﬃcient listed
in each panel. The black curves are the exact solutions for the
gas (solid) and dust (dashed). There are no adverse eﬀects from
using unequal masses in this test.

such that cs,0 = 1. The perturbation about each equilibrium,
on the other hand, is uniform: δm = δρ = δv = δu = 10−4.
Just as in dustybox, all quantities are in code units and
there is no dissipation or viscosity applied to the system.
Again we use 100 particles, but this time we test a broader
range in the drag coeﬃcient (K = [0.001, 0.01, 1, 100, 1000]),
the results of which are shown in Figure A1. The L2 errors
as computed by splash (Price 2007) are in every case less
than 2%, consistent with a second-order integration scheme
(cf. Laibe & Price 2014b). These results are indistinguish-
able from those obtained using an equal-mass setup, imply-
ing that small mass diﬀerences are handled properly by our
algorithm in Section 3.3

A3 dustyshock

The dustyshock problem tracks a shock wave propagating
through a dust/gas mixture initially created by discontinu-
ities in the density and pressure. dustyshock is an impor-
tant test, not because we expect to see strong shocks in our
system, but because photoevaporation and/or dust settling
can create steep gradients in the ﬂuid variables, similar to a
discontinuity in a shock front. Moreover, it is the ﬁrst test
problem in which we use the full set of SPH ﬂuid equa-
tions, including viscosity, dissipation, conduction, and un-
equal masses. In other words, it tests our entire code except
our thermal energy switch for photoevaporation.

vx-1×10-401×10-4t=4.5K = 0.001vx-1×10-401×10-4K = 0.01vx-1×10-401×10-4K = 1.0vx-1×10-401×10-4K = 100vxx-0.500.5-1×10-401×10-4K = 1000vx-1×10-401×10-4t=4.5K = 0.001vx-1×10-401×10-4K = 0.01vx-1×10-401×10-4K = 1.0vx-1×10-401×10-4K = 100vxx-0.500.5-1×10-401×10-4K = 1000vx-1×10-401×10-4t=4.5K = 0.001vx-1×10-401×10-4K = 0.01vx-1×10-401×10-4K = 1.0vx-1×10-401×10-4K = 100vxx-0.500.5-1×10-401×10-4K = 1000vx-1×10-401×10-4t=4.5K = 0.001vx-1×10-401×10-4K = 0.01vx-1×10-401×10-4K = 1.0vx-1×10-401×10-4K = 100vxx-0.500.5-1×10-401×10-4K = 1000vx-1×10-401×10-4t=4.5K = 0.001vx-1×10-401×10-4K = 0.01vx-1×10-401×10-4K = 1.0vx-1×10-401×10-4K = 100vxx-0.500.5-1×10-401×10-4K = 100016

Hutchison, Price, Laibe, & Maddison

A3.1 Setups

The initial discontinuities are created by placing two ﬂuids
in a 1D box, x ∈ [−0.5, 0.5], separated by a membrane at
x = 0 (all quantities in code units). We use reﬂective bound-
ary conditions to simulate ﬂuids that extend to ±∞; this re-
quires both ﬂuids to start from rest and care must be taken
to ensure the shock does not interact with the boundaries.
The density and pressure of the gas on the “left” (x < 0) and
“right” (x ≥ 0) are ρL = PL = 1 and ρR = PR = 0.125, re-
spectively. Finally, dustyshock requires an adiabatic equa-
tion of state; we use P = (γ − 1)ρu with γ = 5/3. At t = 0,
the membrane is removed and the ﬂuids are allowed to move
freely. The interacting ﬂuids will pass through a non-linear
transient phase, the duration of which will depend on the
drag regime, and will eventually arrive at a stationary phase
where the solution is the same as that of a pure gas ﬂuid
moving at a modiﬁed γ and sound speed (Miura & Glass
1982; Laibe & Price 2012a). Unlike the previous tests, we are
only interested in testing the very high and low (i.e. zero)
drag regimes because there is no analytic solution for the
transient phase. For the high drag regime we use a drag co-
eﬃcient K = 1000 and a constant dust fraction  = 0.5. We
test the zero-drag case using two diﬀerent setups. The ﬁrst
setup is exactly the same as the high-drag case, while the sec-
ond diﬀers by having a constant dust density of ρd = 0.125
across both ﬂuids. This latter scenario requires a discontin-
uous jump in the dust fraction: L = 1/9 and R = 0.5.

A3.2 dustyshock with unequal-mass ﬂuids

When using equal-mass particles, the density diﬀerence be-
tween the two ﬂuids is created by using 8× more particles
on the left than on the right. Because we need a minimum
of about 150 particles in order to resolve the discontinuity
of the forward (x ≥ 0) propagating shock wave, we are re-
quired to use at least 1200 particles for x < 0—much greater
than is required to suﬃciently resolve the shock. This pro-
hibitive condition can be relaxed completely if instead we
create the density jump using unequal-mass particles. Then
we can minimally resolve the entire shock using a total of
only 300 particles. Alternatively, running with 1350 particles
results in signiﬁcantly improved resolution of the low-density
ﬂuid and even slightly faster execution times because the
Courant condition is no longer being controlled by tightly
spaced particles. However, a glitch in several ﬂuid quantities
occurs at the interface between the diﬀerent mass particles,
regardless of the drag regime. A similar feature—albeit much
reduced—also appears in equal-mass tests, but is caused by
the sudden change in particle spacing. Because our unequal-
mass tests use equal/smoothly varying particle spacings, this
may indicate that large mass diﬀerences between interacting
particles can cause numerical irregularities.

To test our algorithm’s sensitivity to jumps in the par-
ticle mass we decrease (increase) the density jump between
ﬂuids by progressively increasing (decreasing) the mass of
the particles for x ≥ 0. The width and amplitude of the
aforementioned glitch steadily shrinks (grows) as the mass
diﬀerence becomes less (more) pronounced. For example, a
mass ratio of 2 reduces the size of the glitch to that of the
equal-mass case while mass ratios (cid:38) 120 begin to exhibit
severe departures from the analytic solution. By 128 the so-

lution becomes unstable. We found this is because the recoil
of lower mass particles cannot properly be resolved within
a Courant-limited timestep. Forcing a smaller timestep ﬁxes
the issue (e.g. one tenth the Courant timestep allows us to
extend stability up to mass ratios of ∼ 180) which suggests
there may be a mass-timestep criterion that must be met to
ensure accuracy and stability in extreme cases where large
mass diﬀerences between interacting particles are required.
As we do not anticipate such extreme interactions in our
simulations, we leave this as a topic for future studies.

It is worth pointing out that the above dustyshock
tests involve a very limited number of unequal-mass interac-
tions. Although useful for probing our number density for-
mulation, they are actually poor tests of how unequal-mass
particles behave in simulations. Furthermore, because all of
the unequal-mass encounters take place in the vicinity of
the glitch at the contact discontinuity, there is a danger in
misconstruing these tests as evidence that unequal-mass en-
counters produce universally worse results than their equal-
mass counterparts. A better test of the behaviour of unequal-
mass particles would be to give each particle a unique mass
in a smoothly varying mass distribution.

A3.3 dustyshock with unequal-mass particles

Because the ﬂuid density is degenerately deﬁned by both
mass and particle spacing, there is nothing preventing us
from building a constant density out of a smoothly vary-
ing mass distribution. In practice, this can be achieved by
adapting the stretching technique often used to make the
density perturbation in the dustywave problem (see Price
2004). In this case, however, we cancel out the spatial pertur-
bation by carefully assigning masses that keep the density
constant. First, we note that the cumulative mass of the
system is given by M (xa) = ρ0xa and the individual masses
by ma = δM (xa) = ρ0δxa. Thus, the mass of each parti-
cle simply depends on the gradient of the number density.
If we deﬁne xa ≡ f (xa,0), where f is a stretching function
of our choice acting on a set of uniformly-spaced particle
coordinates xa,0, then the mass of each particle is directly
proportional to f(cid:48)(xa,0).

An additional complication arises because our reﬂective
boundary conditions are inconsistent with a non-uniform
mass distribution. We avoid this complication by converting
a portion of the simulation particles near the boundaries of
the computational domain into ghost particles, thereby re-
deﬁning where our boundaries occur. Although this method
can carve out a considerable portion of the computational
domain at low resolution, the eﬀect is minimal with 1350
particles—the resolution we use to compare with the equal-
mass case.

Figure A2 shows a side-by-side comparison of the three
√
diﬀerent dustyshock setups using equal masses (left) and
a mass distribution with stretch function f (x) =
x (right).
Our only criteria for choosing f was that it should exhibit a
large range in relative masses between particle neighbours.
These tests show that unequal-mass particles behave just as
well as equal-mass particles as long as the mass distribution
is smooth and the relative mass diﬀerence between particle
pairs is less than ∼ 1–2 orders of magnitude.

MNRAS 000, 1–19 (2016)

How dusty are photoevaporative winds?

17

Figure A2. Comparison of the dustyshock test with 1350 particles using equal-mass particles (left) and unequal-mass particles (right).
Rows (from top to bottom) show velocity, density, internal energy, and pressure. Columns separate diﬀerent dustyshock setups (from
left to right): K = 1000, K = 0 retaining the discontinuity in the dust density, and K = 0 with a uniform dust density throughout.
Gas quantities are represented by the solid (blue) dots, dust quantities use the open (brown) circles, and the black lines are the analytic
solution for the gas (solid) and dust (dashed) in each of the respective plots. The tests run with unequal-mass particles have a notable
irregularity at the contact discontinuity, but otherwise reproduce the solutions just as well or better than the equal-mass case due to
increased resolution at the discontinuities.

A4 dustydisc

The dustydisc problem (Price & Laibe 2015) is similar to
the plane-parallel atmosphere described in Section 4. Its
value lies in the fact that it tests the performance of our
algorithms under physically relevant conditions. It probes
how our unequal-mass, one-ﬂuid formulation handles evolv-
ing a dust distribution concurrently in a wide spectrum of
stopping times. This is diﬀerent from previous tests which
analysed each drag regime separately.

Anticipating the fact that we are forced to use unequal
masses to reach photoevaporation densities, we restrict our-
selves wholly to using unequal-mass particles from this point
onwards. The particle masses for this test are initially as-
signed using the exponential distribution in Equation (37)
such that the initial density proﬁle can be built entirely
from uniformly spaced particles. Then, to obtain the cor-
rect density scaling, the masses are iteratively scaled until
|ρ0 − ρmax|/ρ0 falls below a given tolerance.

Because we have no analytic solution for this test,
we compare our results against Price & Laibe (2015). We
replicate their physical parameters by choosing ρg,0 = 6 ×
10−13 g cm−3, R = 50 AU (where again R is a ﬁxed param-
eter for all particles), and an aspect ratio H/R = 0.05.
The scale height H = 2.5 AU is then used to calculate
the initial sound speed according to cs = HΩK, where
torb ≡ 2πΩK ≈ 353 years. We begin our simulation by plac-
ing 20 100 particles in a uniform (staggered) lattice inside

ΩK =(cid:112)GM/R3. For a solar mass star, the orbital period is

MNRAS 000, 1–19 (2016)

a Cartesian box, (x, z) ∈ [−3H, 3H], with periodic bound-
ary conditions in x and open boundaries in z. We relax the
system for ∼ 14 orbital periods using artiﬁcial viscosity and
a damping factor on the velocity as prescribed in Price &
Laibe (2015). The simulation is then restarted with mm-
sized grains added to the disc with the same initial density
proﬁle as the gas, but scaled by a gas-to-dust ratio of 100.
The dust is then allowed to evolve for 70 orbital periods.

In performing this test, we found that the physical con-
ditions in atmospheres of settled discs—in particular, tiny
dust fractions and large diﬀerential velocities—give rise to
a numerical instability in the one-ﬂuid SPH equations. Two
methods for dealing with this instability are described in Ap-
pendix B. Following the ﬁrst of these methods, Figure A3
shows the temporal evolution of the dust density for 20 100
settling dust grains. Our results match those from Price &
Laibe (2015), thus validating the modiﬁcations contained in
Appendix B1. Further comparison with their work shows
that using unequal masses eﬀectively extends our density
range to much lower values than were previously possible.

APPENDIX B: NUMERICAL INSTABILITY

We found that using the conservative one-ﬂuid SPH equa-
tions results in a numerical instability that causes  and ∆v
to diverge. The instability only occurs where  is small and
∆v is large (e.g. the upper atmosphere of settled discs or
photoevaporative winds with large dust grains). It cannot

vx00.20.40.60.8t=0.250.51u11.522.5Px-0.4-0.200.20.40.51vx00.20.40.60.8t=0.250.51u11.522.5Px-0.4-0.200.20.40.51vx00.20.40.60.8t=0.20.51u11.522.5Px-0.4-0.200.20.40.51vx00.20.40.60.8t=0.20.51u11.522.5Px-0.4-0.200.20.40.51Equal-mass particlesvx00.20.40.60.8t=0.250.51u11.522.5Px-0.4-0.200.20.40.51vx00.20.40.60.8t=0.250.51u11.522.5Px-0.4-0.200.20.40.51vx00.20.40.60.8t=0.20.51u11.522.5Px-0.4-0.200.20.40.51vx00.20.40.60.8t=0.20.51u11.522.5Px-0.4-0.200.20.40.51Unequal-mass particles18

Hutchison, Price, Laibe, & Maddison

Figure A3. Dust densities at 10 orbit intervals for mm-sized dust grains in the dustydisc problem using 20 100 particles. Gravitationally,
all particles are assumed to be located at R = 50 AU with a disc aspect ratio of H/R = 0.05 and H0 = 2.5 AU.

always be mitigated by using the non-conservative dissipa-
tion terms from LP14b. The same problem occurs when us-
ing equal-mass particles, but to a lesser degree because the
resolution is much lower in the malignant areas of the disc
where the instability occurs. Thus far, we have only found
two ways to circumvent the instability.

B1 Method 1

In the ﬁrst method, we make three modiﬁcations to Equa-
tions (2)–(6) that prevent the instability from occurring: (i)
we use the additive form of the SPH gradient for the ∆v2
term in Equation (13), (ii) we use the non-conservative form
of the ∆v dissipation term, and (iii) we use the positive-
deﬁnite formulation for the evolution of . We discuss the
reasons for each of these changes below:

(i) The term responsible for for the instability appears
to be the penultimate term in Equation (13). Thus far, we
have been unable to develop a dissipation term that is uni-
versally capable of controlling the growth of the instability.
Using the additive form of the SPH gradient for this term is
signiﬁcantly more stable:

(cid:18) d∆v

(cid:19)

(cid:88)

b

(cid:20) (1 − 2a)∆v2

a

χa

b ρ2
a

=

ρa
2

mb

dt

term

∇aWab(ha)

(1 − 2b)∆v2

b

χb

aρ2
b

+

∇aWab(hb)

(cid:35)

.

(B1)

(ii) We single out the dissipation term for ∆v because
it is the only term to contain the factor b/a. In most of
the tests, this factor is approximately unity. However, as
dust settles to the midplane in the dustydisc problem a
large dispersion in  develops in the atmosphere of the disc
where the dust fraction becomes very small. If a (cid:28) b this
term diverges and causes the code to fail. Removing this
factor keeps this term from diverging, but again violates
conservation properties.
(iii) We ﬁnd that d

dt is very sensitive to small changes
when  is small. As a result, a large dispersion in  develops
with dust fractions oscillating wildly between positive and
negative values. These oscillations are somewhat mitigated
by using the positive-deﬁnite formulation for the dust frac-
ρ

tion presented in Price & Laibe (2015) that evolves S ≡ √

(not to be confused with grain size) instead of :

(cid:88)

(cid:18) 1 − S2

mbSb

b

+

a/ρa
χa
b ρ2
a
1 − S2
aρ2
χb
b

b /ρb

∆va · ∇aWab(ha)

∆vb · ∇aWab(hb)

(cid:19)

dS
dt

= − ρa
2

(cid:88)

b

+

mb

Sa
2χa
b ρa

vab · ∇aWab(ha),

(B2)

Thus, despite giving slightly poorer results in other tests,
using S seems to give better results in regions where the
dust fraction is small.

There is nothing inherently wrong about using this form of
the SPH gradient; in fact, this same form is used for the pres-
sure gradient in Equation (12) and is second-order accurate.
However, conservation laws provide constraints on the form
of the SPH equations. Violating these rules results in a code
that no longer conserves one or more of these properties.

B2 Method 2

The second method is much less involved. We ﬁnd that
the oscillations created by the instability can eﬀectively
be controlled by performing an artiﬁcial cut in the dust
fraction at  ∼ 10−5. There is some risk of tainting the

MNRAS 000, 1–19 (2016)

z [AU]x [AU]-202-5050 orbitsx [AU]-20210 orbitsx [AU]-20220 orbitsx [AU]-20230 orbitsx [AU]-20240 orbitsx [AU]-20250 orbitsx [AU]-20260 orbitsx [AU]-202-20-18-16-14log ρ [g/cm3]70 orbitsHow dusty are photoevaporative winds?

19

results when using this method, but the risk can be made
very low by only employing the cut when the instability be-
comes unbounded. Small oscillations develop in  whenever
dust grains decouple from the gas and ρd → 0; however,
the majority of these cases are benign and can easily be
distinguished from physical dust by their low density,
periodic structure, and physical context. When unbounded
growth in  does occur, it is always in regions where dust
has clearly been evacuated, suggesting that there is little
danger in performing the cut.

Neither method is inherently more accurate than the
other. Thus, when forced to deal with the instability, we
adopt Method 1 for stand-alone simulations—such as the
dustydisc and dustyphoto tests—and adopt Method 2
when one or more simulations from a larger set goes un-
stable, to ensure that the ﬂuid dynamics are consistently
calculated across the entire set (like in Section 6).

This paper has been typeset from a TEX/LATEX ﬁle prepared by
the author.

MNRAS 000, 1–19 (2016)

