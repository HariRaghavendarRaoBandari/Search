6
1
0
2

 
r
a

 

M
7
1

 
 
]

.

A
N
h
t
a
m

[
 
 

1
v
2
7
3
5
0

.

3
0
6
1
:
v
i
X
r
a

Numerical Approximation of Hyperbolic Systems

Containing an Interface

Nina Aguillon ∗

Raul Borsche †

March 18, 2016

Abstract

In this paper we present an approach to approximate numerically the solution of coupled
hyperbolic conservation laws. The coupling is achieved through a ﬁxed interface, in which
interface conditions are linking the traces of both sides. The numerical solver is based on
central methods, like the Rusanov scheme, and does not use the structure of the Riemann
Problem. It consists in balancing the eﬀects of the waves that enter the interface. The scheme
is well balanced with respect to all the piecewise constant equilibria associated with the interface
condition and is able to maintain exactly conservation properties of the interface conditions.
A detailed analysis and several numerical tests show the quality of the method. Diﬀerent
applications, including sonic and transsonic ﬂows and a multiphysic model are studied.

In this paper we propose a simple numerical scheme to approximate the solution of the Cauchy

problem

∂tU (t, x) + ∂xf (U (t, x)) = 0,

(cid:0)U (t, 0−), U (t, 0+)(cid:1) ∈ G,

U (0, x) = U 0(x).

for x ∈ R \ {0},
a.e. t > 0,

(1)




Special attention is drawn to the point x = 0, where the interface conditions G link the traces of
the states on the left and right hand side.

This system can be used to describe e.g.

the ﬂow in pipes or channels with varying cross
section [18, 21]. It can also be viewed as a particular coupling in networks of conservation laws
[10, 16, 29]. In the case where the equation (1) is scalar, the theories of L1-dissipative germ [7] and
of transmission maps [6] explore the links between the shape of G and the well-posedness of (1-3).
Numerically speaking, a large class of eﬃcient numerical schemes is available to solve (1) away
from the interface. However, the development of general numerical methods for the junction at x = 0
remains an open challenge. Most of the present solvers rely on solving Riemann problems (16)
associated to (1), i.e. constant initial data on each side of the interface [29, 30, 11, 10, 25, 23].
Extensions of such schemes to higher order have been studied in [13, 14]. Recently, relaxation
procedures adapted to handle coupling conditions have been proposed for diﬀerent models, see [20,
19, 4, 5, 3].

Solving such Riemann problems exactly requires a detailed knowledge of the structure of the
solution to (1). For complicated coupling scenarios these informations might be not accessible or
only computable with high numerical costs. Thus it seems essential to seek for numerical methods
that do not require any information on the structure of the Riemann problem for (1).
In that
direction, the scalar case is particularly well studied. Examples of such couplings are the ﬂuid-
particle toy-model of [8] or the general setting of scalar conservation laws with discontinuous ﬂux,
see [7].

1Centre de Mathématiques et Informatique, 39 rue Joliot-Curie, 13453 Marseille Cedex 13, France
2Technische Universität Kaiserslautern, Department of Mathematics, Erwin-Schrödinger-Straße, 67663 Kaiser-

slautern, Germany borsche@mathematik.uni-kl.de

1

Recently, in [12] a systematic way to approximate the solution near the interface has been
proposed. The idea is to mimic numerically as close as possible the structure of the underlying
Riemann problem. This includes a numerical minimization of all waves which do not occur in the
exact solution of the Riemann problem.

The approach in the present paper is to allow unphysical waves inside the node, but we re-
quire that their contributions cancel in the node. Due to this modiﬁcation the scheme simpliﬁes
signiﬁcantly and the exact conservation property of the exact solution is restored.

The paper is organized as follows.

In the ﬁrst section, we present several sets of interface
conditions for models of ﬂuids dynamics, which illustrates the variety of situation described by
system (1). In the second section, we give the mathematical framework in which (1) is solved. We
recall some results concerning the Riemann problem and explain the derivation of the new scheme.
In the third section, we investigate the numerical equilibrium states associated to the proposed
method, both for the Godunov and the Rusanov ﬂuxes. Section 4 contains a complete study of the
scheme in the context of the Rusanov ﬂux for a 2 × 2 model of ﬂuid / particle interaction introduced
in [2]. In the last Section, we apply this method to several examples, including a new ﬂuid / particle
problem with heat exchange. This illustrates the interest of using a Riemann-problem free method,
as no details of the Riemann problem for this model are available at the moment. Furthermore test
cases with diﬀerent pressure laws or varying cross section are considered.

1

Interface conditions

In the sequel of this paper we will consider ﬁve representatives of the coupling conditions G.

Let us ﬁrst consider the Cauchy problem

(∂tU (t, x) + ∂xf (U (t, x)) = 0

U (0, x) = U 0(x).

for x ∈ R,

(2)

The solution U takes its values in an open convex subset Ω of Rn and the ﬂux f : Ω ⊂ Rn → Rn
is regular. The system is assumed to be strictly hyperbolic, i.e.
the Jacobian matrix of f is
diagonalizable with n distinct eigenvalues. Recall that the solution is not unique in the class of
weak functions, but the well-posedness for (2) is typically recovered by additionally enforcing an
entropy inequality

∂tE(U (t, x)) + ∂x(F (U (t, x))) ≤ 0,

(3)

where the entropy E is supposed to be regular and strictly convex. Therefore in the sequel we
consider solutions of (1) that verify (3) on the sets {t > 0, x < 0} and {t > 0, x > 0}. A natural
extension of such a constraint to the coupling point is given by

which guarantees that the entropy is non-increasing in the coupled system.

F (U−) − F (U+) ≤ 0 ,

1.1 Classical coupling

The ﬁrst choice models the classical solutions on a continuous line, which enters the larger framework
of (1) as

G0 = {(U−, U+) ∈ Ω2, f (U−) = f (U+) and F (U+) − F (U−) ≤ 0}.

(4)

The solution of (1) with the above coupling coincides with the solution of (2). Thus, this example
provides a natural way to compare the coupling procedure to standard schemes for classical Riemann
problems.

2

1.2 Fluid/particle coupling

The second set of coupling conditions arises from the modeling of a particle in a surrounding ﬂuid [2].
The motion of the ﬂuid is described by the isothermal Euler equations

U = (ρ, q), Ω = R+

⋆ × R,

f (U ) =(cid:18)q,

q2
ρ

+ c2ρ(cid:19) ,

⋆ = (0, +∞). The corresponding entropy/entropy-ﬂux pair is given by E(U ) = q2

2ρ +

where R+
c2ρ log(ρ) and F (U ) = q

ρ(cid:0)E(ρ, q) + c2ρ(cid:1).

At x = 0 a ﬁxed obstacle is located in the ﬂuid. The ﬂuid can pass with a certain resistance
through the obstacle. As no ﬂuid disappears, the total mass is conserved across the interface,
whereas the momentum decreases. This can be described by the following coupling conditions

Gλ =
(cid:16) q2


q− = q+ =: q

+ c2ρ−(cid:17) −(cid:16) q2

ρ−
0 ≤ q ≤ cρ− =⇒ 0 ≤ q ≤ cρ+

+ c2ρ+(cid:17) = λq

ρ+

−cρ+ ≤ q ≤ 0 =⇒ −cρ− ≤ q ≤ 0




,

(5)

where λ is a positive friction parameter representing the resistance of the obstacle. The last two
conditions can be understood as entropy conditions. The Riemann problem for this interface con-
ditions have been studied intensively in [2]. Its solution and a variety of test cases are available, as
well as numerical methods based on the solution of the Riemann problem, see [1]. A simpliﬁcation
of this model is described in [28].

1.3 Fluid/particle coupling with heat exchange

We now propose an extension of the above model to the case where the ﬂuid has a varying temper-
ature and can exchange heat with the obstacle. The motion of the ﬂuid is described by the Euler
equations

U = (ρ, q, E), Ω = R+

⋆ × R × R+
⋆ ,

f (U ) =(cid:18)q,

q2
ρ

+ p,

q
ρ

(E + p)(cid:19) .

The system is closed with the ideal gas law p = eρ(γ − 1) with the adiabatic exponent γ > 1. Here
ρ denotes the density, u velocity, p pressure, e internal energy and E = 1
2 ρu2 + ρe the total energy.
For smooth solutions we can describe the inﬂuence of the particle on the ﬂuid as source terms.
These can be derived by considering the balance of forces and the total energy in the coupled system

∂tρ + ∂x(ρu) = 0,
∂t(ρu) + ∂x(ρu2 + p) = −λρuδ0,

∂tE + ∂x(u(E + p)) = −λρu2δ0 − µ(cid:18)e − sP(cid:16) ρ

ρ0(cid:17)γ−1(cid:19) δ0.

(6)




The force acting on the particle, D = λρu, is proportional to the friction parameter λ ≥ 0. It is
located only at x = 0, which is described by the Dirac measure δ0(x).

The work applied by this force, λρu2, also appears in the energy balance. The term µ(cid:18)e − sP(cid:16) ρ

represents the heat exchange with the particle. It is described by a heat exchange parameter µ ≥ 0,
a reference density ρ0 and sP ≥ 0 has the dimension of an entropy.

Since the solutions of the Euler equations can not be expected to be continuous, the deﬁnition of
the above source terms is complicated. Therefore we study a regularization of (6) where the Dirac
measure is replaced by one of its regularization.
It appears that the properties of a continuous
and stationary ﬂuid on the left and on the right of the particle are linked by universal relations,
independent of the regularization of the Dirac mass.

3

ρ0(cid:17)γ−1(cid:19)

Proposition 1.1. Let ǫ be a positive real and Hǫ be a C 1-regular function, increasing monotone from
0 to 1 on the interval [−ǫ, ǫ]. Consider x 7→ (ρǫ(x), uǫ(x), pǫ(x)) a C 1-regular stationary solution
of (6) where the Dirac mass is replaced by H ′
ǫ

(ρǫuǫ)′ = 0,
(ρǫu2

ǫ + pǫ)′ = −λρǫuǫH ′
ǫ,
(uǫ(Eǫ + pǫ))′ = −λρǫu2
ǫ H ′




ǫ − µ(cid:18)eǫ − sP(cid:16) ρǫ

ρ0(cid:17)γ−1(cid:19) H ′

ǫ.

(7)

Then the states U− = Uǫ(−ǫ) and U+ = Uǫ(ǫ) verify the following relations, independent of ǫ and
Hǫ:

and

ρ−u− = ρ+u+ := q,

(cid:18) q2

ρ−

+ p−(cid:19) −(cid:18) q2

ρ+

+ p+(cid:19) = λq,

(s+ − sP ) = exp(cid:18)−

µ

q(cid:19) (s− − sP ), where s = eρ1−γ.

Proof. The ﬁrst line of (7) exactly says that the momentum qǫ = ρǫuǫ is constant across the particle.
The second line of (7) reads

(cid:18) q2

ǫ
ρǫ

+ pǫ(cid:19)′

= −λqǫH ′
ǫ,

(8)

which yields the second relation by integrating on [−ǫ, ǫ].

Let us now focus on the last line of (7). Replacing Eǫ by 1

2 qǫuǫ + ρǫeǫ and using the fact that

qǫ is constant, we obtain

u′

ǫ(cid:18) 1

2

qǫuǫ + ρǫeǫ + pǫ(cid:19) + uǫ(cid:18) 1
ǫ − µ eǫ − sP(cid:18) ρǫ

2

= −λqǫuǫH ′

ρ0(cid:19)γ−1! H ′

ǫ.

qǫu′

ǫ + ρ′

ǫeǫ + ρǫe′

ǫ + p′

ǫ(cid:19)

Inserting the ﬁrst two relations (qǫu′

ǫ + p′

ǫ) = −λuǫH ′

ǫ and q′

ǫ = 0 into ρǫu′

ǫ + ρ′

ǫuǫ = 0 we obtain

qǫe′

ǫ + u′

ǫpǫ = qǫe′

ǫ −

qǫ
ρǫ

ρ′

ǫ(γ − 1)eǫ = −µ eǫ − sP(cid:18) ρǫ

ρ0(cid:19)γ−1! H ′

ǫ .

(9)

and computing its derivative gives

Introducing the quantity sǫ = eǫ(cid:16) ρǫ
ǫ(cid:18) ρǫ
ρ0(cid:19)1−γ

s′
ǫ = e′

ρ0(cid:17)1−γ

+ (1 − γ)eǫ

Thus (9) can be written as

qǫ(cid:18) ρǫ

ρ0(cid:19)γ−1

ρ′
ǫ
ρǫ

eǫ(cid:19) .

ǫ − (γ − 1)

0

ρ′
ǫ =

ρ−γ
ǫ
ρ1−γ

ρ1−γ
ǫ
ρ1−γ

0 (cid:18)e′
ρ0(cid:19)γ−1! H ′
ǫ = −µ eǫ − sP(cid:18) ρǫ

ǫ,

s′

and simpliﬁed to

qǫ(sǫ − sP )′ = −µ(sǫ − sP )H ′
ǫ.

If qǫ = 0, the only solution is s = sP . Moreover due to the Cauchy–Lipschitz theorem, sǫ − sP does
not change sign, and if it is not null we have

and we can conclude the desired statement by integration.

log(|sǫ − sP |)′ = −

µ
qǫ

H ′
ǫ,

4

q− = q+,




ρ+

+ p+(cid:17) −(cid:16) q2
(cid:16) q2
(s+ − sP ) = exp(cid:16) µ

+ p−(cid:17) = −λq,
q(cid:17) (s− − sP ),

ρ−

(10)

Remark 1.2. In Proposition 1.1, the stationary solution is assumed to be C 1-regular. In particular,
it excludes the case where a stationary entropy satisfying shock lies somewhere inside the thickened
particle. This can occur only when the ﬂow is supersonic at the entrance of the particle. Thus
the interface conditions derived in Proposition 1.1 are valid for subsonic ﬂows only. Allowing a
stationary shock inside the particle (or in other words, looking for a piecewise C 1-regular stationary
solution of (6)) yields to more complicated computations, because of a lack of compatibility between
the regular part of the solution and the shocks. In the case of an isothermal ﬂow, a complete study
has been done in [1].

Following the above proposition we consider for the particle with heat exchange the coupling

conditions

with s = e(cid:16) ρ

ρ0(cid:17)1−γ

. Note that balancing the jump in the ﬂux with the right hand side of (6) yields

the problem of deﬁning ρ and e inside of the jump. This is avoided by using (10).

1.4 Gas dynamics with diﬀerent pressure laws

We also consider a case where the conservation law is diﬀerent on each side of the interface

(∂tU + ∂xfL(U ) = 0

∂tU + ∂xfR(U ) = 0

on x < 0,
on x > 0,

(11)

where the ﬂux function fL and fR are diﬀerent, but the system is strictly hyperbolic for those two
ﬂuxes. We chose the model presented in [20], where the equation of gas dynamics is used on both
side of the interface

U = (ρ, q, E), Ω = R+

⋆ × R × R+
⋆ ,

fL/R(U ) =(cid:18)q,

q2
ρ

+ p,

q
ρ

(E + pL/R)(cid:19) ,

but with a discontinuous pressure law pL/R = eρ(γL/R − 1) on x < 0 and x > 0. Following [20], we
consider two diﬀerent interface conditions. The ﬁrst one is associated to the so-called “ﬂux coupling”

Gﬂux = {(U−, U+) ∈ Ω2 : fL(U−) = fR(U+)},

(12)

which yields the conservation of the density ρ, the momentum q and the total energy E. The second
one is the so-called “state coupling”

Gstate = {(U−, U+) ∈ Ω2 : (ρ−, u−, pL,−) = (ρ+, u+, pR,+)},

(13)

which ensures the continuity of the density ρ, the velocity u and the pressure p. For the latter, the
subscript L and R recall that the pressure law is diﬀerent on each side of the interface, i.e the last
equation of the coupling conditions reads

e−ρ−(γL − 1) = e+ρ+(γR − 1),

where e = E

ρ − 1

2 u2 is the internal energy.

1.5 Barotropic ﬂows in a nozzle with piecewise constant cross-section

As last example we consider the following model [19]:

(∂tαρ + ∂xαρw = 0,

∂tαρw + ∂x(αρw2 + αp(τ )) = p(τ )∂xα,

(14)

5

where α is the cross section of the nozzle, ρ is the density of the ﬂuid, τ = 1
ρ is the speciﬁc volume
and u is its velocity. The pressure law is classically supposed to be positive, decreasing and convex.
As outlined in [19], system (14) also describes the dynamics of ﬂows in porous media.
In that
case α is the void fraction of the respective medium. In this application it is natural to consider a
piecewise constant cross section

α = αL1x<0 + αR1x>0, αL > 0, αR > 0,

while the derivation of (14) for ﬂows in a nozzle requires some smoothness on α.

The diﬃculty is to deﬁne the left hand side p(τ )∂xα = p(τ )(αR − αL)δx=0 at point x = 0. It is
well known ([27], [22] and [25]) that system (14) is not hyperbolic when one of the acoustic waves
has speed 0. The system is said to be resonant and uniqueness is lost. We will not tackle this
problem here and restrict our attention for this particular example on subsonic ﬂows.

For subsonic ﬂows system (14), supplemented with the equation ∂tα = 0, is strictly hyperbolic,

and it is possible to show that

αρw and

w2
2

+ e(τ ) + τ p(τ ) are continous at x = 0,

(15)

where τ 7→ e(τ ) is an antiderivative of −p. This is the set of interface conditions used at x = 0 in
model (14).

2 Numerical method

In the development of a numerical method the Riemann problem at the interface plays an important
role. Therefore we study the model (1) with the initial conditions

U 0(x) = UL1x<0 + UR1x≥0, (UL, UR) ∈ Ω2

(16)

and recall the strategy to prove existence and uniqueness in case of (5). First, we look for a

selfsimilar solution, i.e. a solution that can be written as U (t, x) = W(cid:0) x

of the solution U− and U+ on the lines x = 0− and x = 0+ are constant in time. Moreover,
once these traces are determined, the whole solution is easily constructed by solving the Riemann
problem without interface between UL and U− on the left half plane x < 0, and between U+ and
UR on the right half plane x > 0. For these states the following three conditions hold:

t ; UL, UR(cid:1). Thus the traces

• On x < 0, the solution coincides with the restriction of the solution of the Riemann problem
between the left state UL and the right state U− for (2), and U− is the value of the solution
on the line x = 0−, i.e.

• On x > 0, the solution coincides with the restriction of the solution of the Riemann problem
between the left state U+ and the right state UR for (2), and U+ is the value of the solution
on the line x = 0+, i.e.

• U− and U+ verify the interface conditions:

U− = W(cid:0)0−; UL, U−(cid:1) .

U+ = W(cid:0)0+; U+, UR(cid:1) .

(U−, U+) ∈ G.

(17)

(18)

(19)

Analytical results on the existence and uniqueness of a solution can be derived by assuming that
(UL, UR) is close enough from a stationary state for (1). Then, it is typically proved that the
Riemann problem has a unique self-similar solution in the vicinity of this stationary solution. We
refer the reader to [15] for the case n = 1 and to [16] for n = 2. See also [17] for the slightly
In some particular cases, it is
diﬀerent case where boundary conditions are imposed on x = 0.

6

possible drop the smallness assumption on the initial data, as in [2] for the model (4) and in [28]
for the Burgers-particle model.

This procedure can be used directly for the construction of a numerical scheme. But the re-
sulting Godunov method requires many details of the solution at the interface. Therefore it is
only applicable for systems where the structure of the solution is known and it is not ﬂexible for
modiﬁcations of the considered equations.

In the following we describe a simple approach to approximate the solution at the interface,

which does not require detailed information of the underlying Riemann problem.

2.1 General setting

Consider an equidistant spacial discretization of width ∆x and denote by xj = j∆x− ∆x
2 the centers
of the cells. The point x = 0 is located at the interface between the cells labelled with 0 and 1. In
time we consider the n-th time step ∆tn = tn+1 − tn.

Away from this interface at x = 0 any ﬁnite volume scheme based on the update formula

U n+1

j

= U n

j −

∆t
∆x

(f n

j+1/2 − f n

j−1/2)

(20)

k used to computed f n

can be used. The classical method can be applied as long as the stencil of the ﬁnite volume scheme
(i.e. the cells U n
j−1/2) stays on one side of the interface at x = 0.
In the sequel we focus on 2-point ﬂuxes f n
j+1). Thus we can use (20) in all cells but
have to deﬁne f n,−
1/2 , the ﬂuxes on the right and on the left of the interface at x = 0. Note
that these ﬂuxes do not coincide for a general choice of G.

1/2 and f n,+

j+1/2 = g(U n

j+1/2 and f n

j , U n

We follow a ghost cells approach and introduce at each time step n the states U n

− and U n
+
representing the ﬂuid’s properties at x = 0− and x = 0+. These can be inserted into the numerical
ﬂux function such that the ﬁnal numerical method is given by

U n+1
U n+1
U n+1
U n+1

= U n
j
0 = U n
1 = U n
= U n

j − ∆t
0 − ∆t
1 − ∆t
j − ∆t

∆x (g(U n
∆x (g(U n
∆x (g(U n
∆x (g(U n

j , U n
0 , U n
1 , U n
j , U n

j+1) − g(U n
−) − g(U n
2 ) − g(U n
j+1) − g(U n

−1, U n
+, U n

j−1, U n
0 )),
1 )),
j , U n

j

j−1))

j ))

for j ≤ −1,

for j ≥ 2.

(21)




2.2 Choice of U n

− and U n

+

The key part of the numerical method is the choice of the values U n
+. Their construction
will depend on the numerical ﬂux function g used in (21) since waves going to the left or right are
incorporated diﬀerently. As example consider the conservation of mass which is part of the coupling
conditions (5). If the approximation of q∓ at the interface does not imply that the ﬁrst component
of the numerical ﬂuxes g(U n
1 ) coincide, mass will be lost or generated at the
coupling point.

−) and g(U n

− and U n

+, U n

0 , U n

If for g the Godunov ﬂux gGod(UL, UR) = f (W (0; UL, UR)) is used, we can pick U− and U+ as
the traces of the exact solution of the Riemann problem such that (17), (18) and (19) hold. Note
that (17) and (18) imply

gGod(UL, U−) = f (U−)

and

gGod(U+, UR) = f (U+).

(22)

The aim of the present paper is to generalize the above procedure to cases when g is an arbitrary
numerical ﬂux. Unfortunately for many choices of g the system (19) and (22) is over constrained
and does not admit any solution. In [12] this problem was relaxed by replacing (22) with

(U n

−, U n

+) = argmin(cid:16)( ˜U−, ˜U+) ∈ G,

|g(U n

0 , ˜U−) − f ( ˜U−)| + |g( ˜U+, U n

1 ) − f ( ˜U+)|(cid:17).

7

(23)

In other words, the scheme tries to minimize the strength of the waves entering the junction. Indeed,
we can rewrite Scheme (20) in the ﬂuctuation form

U n+1

j

= U n

j −

j+1/2 − f (U n

j )) + (f (U n

j ) − f n

∆t

∆x(cid:0)(f n

j−1/2)(cid:1).

j+1/2 − f (U n

j ) as the overall contribution on the waves created at interface

We interpret quantity f n
x = xj+1/2 and entering the j-th cell (thus travelling to the left). Similarly, f (U n
j−1/2
represents the contribution of the waves created at the left interface x = xj−1/2 and going to the
right. In (23), the numerical traces ( ˜U−, ˜U+) are chosen such that the total strength of the waves
entering the interface on its left (ﬁrst term) and entering on its right (second term) is as small as
possible.

j ) − f n

In the present paper we explore a diﬀerent strategy. Although the exact solution only contains
waves entering the domain, we allow waves inside the interface. In the following we require that
the numerical waves entering the coupling point cancel out at the interface. Thus we look for
(U n

+) ∈ G such that

−, U n

g(U n

0 , U n

−) − f (U n
−)

+ f (U n

+) − g(U n

+, U n
1 )

= 0

(24)

left entering waves

right entering waves

|

{z

}

|

{z

}

holds. Once system (19-24) is solved, the ﬂuid is updated with (21), with the chosen numerical ﬂux
g.

One main advantage of the choice (24), is that all quantities which are conserved by the coupling
conditions, will be conserved exactly by the numerical method. Note that this is not true neither
with (U n
+) being the exact traces around the interface and g another ﬂux than the Godunov
ﬂux, nor with Choice (23).

−, U n

3 Numerical equilibrium

One important aspect of a numerical method for coupling conditions is the ability to preserve
numerically the equilibrium states of the underlying system. Furthermore since the solution of the
Riemann problem is self similar, equilibrium states will be generated at the interface.

As long as the numerical ﬂux is consistent, i.e. g(U, U ) = f (U ) ∀U ∈ Ω, any two states U0 and
U1 satisfying the coupling conditions admit U− = U0 and U+ = U1 as solution when solving (19-24).
Thus equilibrium states of the system (1) can be preserved by the numerical method.

More delicate is the reverse question, does the numerical method allow only equilibrium states
of the system (1) as stationary solutions. Unfortunately the answer to this question is negative if
the Godunov ﬂux in combination with (24) is used. This is new compared to the scalar case, see [6].
A detailed analysis of this case and a possible ﬁx is presented in the section below. In case of g
being the Rusanov ﬂux the situation is simpler and no false equilibrium states can be obtained.

3.1 The Godunov ﬂux with Gλ

If g is the Godunov ﬂux gGod, than there exists a pair of constant states (U0, U1) which does not
satisfy the coupling conditions but is numerically a stationary solution.

Proposition 3.1. There exist (U0, U1) that do not belong to Gλ, for which there exists at least one
couple of states (U−, U+) such that

• (U−, U+) veriﬁes the interface conditions (19).

• Equation (24) is fulﬁlled.

• In the solution of the Riemann problem between U0 and U−, all the waves are going to the

right, i.e. gGod(U0, U−) = f (U0).

8

• In the solution of the Riemann problem between U+ and U1, all the waves are going to the

left, i.e. gGod(U+, U1) = f (U1).

Proof. Let us ﬁx U− = (ρ−, q−) and U+ = (ρ+, q+) such that (U−, U+) belongs to Gλ. We have
qI := q− = q+ and

(cid:18) q2

I
ρ−

+ c2ρ−(cid:19) −(cid:18) q2

I
ρ+

+ c2ρ+(cid:19) = λqI .

We look for U0 and U1 verifying the last three conditions of the proposition, but not (U0, U1) ∈

Gλ. By (24), we have f (U0) − f (U1) = f (U−) − f (U+), thus q0 = q1 := qF and

(cid:18) q2

F
ρ0

+ c2ρ0(cid:19) −(cid:18) q2

F
ρ1

+ c2ρ1(cid:19) = λqI .

(25)

The fact that (U0, U1) does not necessarily belong to Gλ follows from the fact that qI and qF can
be diﬀerent.

Let us now focus on the condition gGod(U0, U−) = f (U0). We recall that this condition exactly
states that in the Riemann problem between U0 and U− the waves only go to the right. In the case of
the isothermal Euler equations and for a ﬁxed U−, it is possible to describe the set of such U0, see [1]
for details. In the (ρ, q)-plane, it consists of the union of an increasing curve Γsub
→ (U−) included
in the subsonic triangle {(ρ, q) : |q| < cρ} and an open set Ωsup
→ (U−) included in {(ρ, q), q > cρ}.
These sets are shown with blue colour in Figure 1. The important points are that the states in
→ (U−) are linked to U− by only a 2-wave and that Ωsub
Γsub
→ (U−) is delimited by a curve which is the
image of Γsub
→ (U−) under the operation “stationary shock”

→ (U−) ∩ {q > 0} −→ ∂Ωsup
Γsub

→ (U−)

(ρ, q)

7→ (cid:16) q2

c2ρ , q(cid:17) .

Similarly, the set of all U1 such that gGod(U+, U1) = f (U1) is the union of a decreasing curve
Γsub
← (U+) included in the subsonic triangle and of an open set Ωsup
← (U+) included in {(ρ, q), q < −cρ}.
These sets are depicted in red in Figure 1.

We are now in position to ﬁnd all couples (U0, U1) verifying the last three conditions of the
proposition , in the case where both U− and U+ are subsonic. Without loss of generality we suppose
that qI is non negative. Then, we ﬁx qF in the interval (0, qI ), and we denote by U1 = (ρ1, qF ) the
state at the intersection of Γsub
← (U+) and q = qF . Similarly is V0 = (r0, qF ) at the intersection of
Γsub
→ (U−) and q = qF . As r0 < ρ−, V0 is linked to U− by a 2-rarefaction wave with positive speed
and we have

q2
F
r0

+ c2r0 <

+ c2ρ− .

q2
I
ρ−

On the right hand side is ρ+ < ρ1, thus U+ is linked to U1 by a 1-shock with negative speed and

It follows that

q2
F
ρ1

+ c2ρ1 >

q2
I
ρ+

+ c2ρ+.

F
ρ1

(cid:18) q2

F
r0

+ c2r0(cid:19) −(cid:18) q2
Now, denote by ˜V0 = (cid:16) ˜r0 = q2
decreasing on (cid:0)0, qF

+ c2ρ1(cid:19) <(cid:18) q2
, qF(cid:17) the states linked to V0 by a stationary shock. A simple
c (cid:1), and tends to +∞ when ρ tends to 0. Thus, there exists a unique ρ0 smaller

c . Moreover, the function ρ 7→ q2

+ c2ρ+(cid:19) = λqI .

computation yields q2
F
˜r0

+ c2ρ−(cid:19) −(cid:18) q2

I
ρ+

c2r0
+ c2 ˜r0 = q2
F
r0

+ c2r0 and ˜r0 ≤ qF

than ˜r0 such that

ρ + c2ρ is

I
ρ−

F

F

(cid:18) q2

F
ρ0

+ c2ρ0(cid:19) −(cid:18) q2

F
ρ1

+ c2ρ1(cid:19) = λqI

9

q

Ωsup

→ (U−)

qI

qF

U0

˜V0

U+

U1

U−

V0

Γsub

→ (U−)

ρ

Γsub

← (U+)

Ωsup

← (U+)

Figure 1: How to ﬁnd U0 and U1 verifying the conditions of Proposition 3.1 from U− and U+

and the state U0 = (ρ0, qF ) belongs to Ωsup
→ (U−) and veriﬁes (25). Summarizing the above con-
struction, the two pairs (U0, U1) and (U−, U+) verify the four points of the proposition , and since
qI 6= qF , (U0, U1) does not belong to Gλ.

Example 3.2. Take c = 1, λ = 1,

UL = (ρL = 0.109272, qF = 0.618826), UR = (ρR = 3.024454, qF )

and

U− = (ρ− = 3.31851, qI = 0.771179) and U+ = (ρ+ = 2.824455, qI).

Then the pair of states (UL, UR) does not belong to Gλ, i.e.

(cid:18) q2

F
ρL

+ c2ρL(cid:19) −(cid:18) q2

F
ρR

+ c2ρR(cid:19) 6= λqF

but (U−, U+) does. Moreover, it holds

gGod(U0, U−) = f (U0) and gGod(U+, U1) = f (U1).

10

This is an example of a numerical equilibrium state which is not related to an exact stationary state
as shown in Proposition 3.1.

Remark 3.3. Uniqueness is easily restored by replacing qI by qF in (25), i.e. by imposing

(cid:18) q2

F
ρ0

+ c2ρ0(cid:19) −(cid:18) q2

F
ρ1

+ c2ρ1(cid:19) = λqF

instead of (25). Numerically, and denoting by (gρ, gq) the two components of the numerical ﬂux, it
boils down to search U− = (ρ−, qI ) and U+ = (ρ+, qI ) such that

instead of

(gρ(U0, U−) = gρ(U+, U1),

gq(U0, U−) − gq(U+, U1) = λgρ(U0, U−),

(gρ(U0, U−) = gρ(U+, U1),

gq(U0, U−) − gq(U+, U1) = λqI .

This ﬁx reﬂects the fact that we actually want to impose is (22) and not just (24).

3.2 The Godunov ﬂux with G0

In the classical case, i.e. the case λ = 0, the above construction gives a number of couples of states
(U0, U1) satisfying the conditions of Proposition 3.1. However this time, Equation (25) reduces to
the equality of the mass ﬂux q2
ρ + c2ρ through the interface, thus (U0, U1) veriﬁes automatically the
interface conditions.

3.3 The Rusanov ﬂux with any interface conditions

As alternative to the Godunov ﬂux we consider the Rusanov ﬂux gRus given by

gRus(UL, UR) =

f (UL) + f (UR)

2

−

A
2

(UR − UL),

where A veriﬁes the subcharacteristic condition

and

A ≥ max(cid:18) |qR|

ρR

,

|qL|
ρL

,

|q⋆|

ρ⋆ (cid:19) + c

U⋆ =

UL + UR

2

−

1
2A

(f (UR) − f (UL)).

(26)

(27)

(28)

The Rusanov ﬂux is one of the simplest ﬂux functions possible. Therefore we consider it as an easy
alternative to the complicated Godunov method and a representative of many central schemes.

Remark 3.4. The Rusanov ﬂux can be viewed as a HLL approximate Riemann solver with wave
speeds −A and A, see e.g. [24]. The conservation of the density and the momentum yield as
intermediate state

(ρ⋆, q⋆) =(cid:18) ρL + ρR

2

+

qL − qR

2A

,

qL + qR

2

+

ηL − ηR

2A (cid:19) ,

which is the expression of the middle state U∗ given in (28).

We check that, independently of the coupling conditions, stationary solutions are uniquely de-

termined.

11

Proposition 3.5. If the pair of state (U0, U1) is such that for some (U−, U+) in G the following
holds

(gRus(U0, U−) = f (U0) ,

gRus(U+, U1) = f (U1) .

(29)

Then U0 = U− and U1 = U+ and in particular (U0, U1) belongs to G.

Proof. Equation (29) we can rewrite as

(f (U−) − f (U0) = A(U− − U0),

f (U+) − f (U1) = A(U1 − U+).

Thus U0 is linked to U− by a shock at speed A, and U+ is linked to U1 by a shock at speed −A,
with contradicts Condition (27) on A, unless U− = U0 and U1 = U+.

4 Analysis of the Rusanov ﬂux

In this section we analyze if the coupling procedure with the Rusanov ﬂux has a unique solution, for
the interface conditions Gλ. Unfortunately this is not always the case, but we will develop criteria
to single out the correct interface values. Therefore we investigate the evolution of the entropy
when using the Rusanov ﬂux.

Proposition 4.1. If condition (27) holds, then we have the entropy inequality

with equality if and only if UR = UL.

F (UR) − F (UL) ≤ A(cid:0)E(UR) + E(UL) − 2E(U∗)(cid:1)

(30)

Proof. This is a straightforward consequence of the Jensen inequality applied on the underlying
approximate Riemann solver, see [26].

4.1 The Rusanov ﬂux with G0

Consider the classical coupling conditions given by (4) and denote the momentum ﬂux (also called
charge) q2

ρ + c2ρ by η.

Proposition 4.2. Let UL = (ρL, qL) and UR = (ρR, qR) be two elements of Ω, and consider
U∗ = (ρ∗, q∗) the state deﬁned by (28). Then system (19-24) with G = G0 and g = gRus always
admits the solution

U− = U+ = (ρ⋆, q⋆).

• This solution is unique if ρ2

⋆ − q2

⋆

c2 ≤ 0 or q⋆ = 0.

• If ρ2

⋆ − q2

⋆

c2 > 0 System (19-24) has a second solution, namely

(U− = (ρ⋆ − r, q⋆) and U+ = (ρ⋆ − r, q⋆) if q⋆ > 0,

U− = (ρ⋆ + r, q⋆) and U+ = (ρ⋆ − r, q⋆) if q⋆ < 0,

(31)

where r =qρ2

⋆ − q2
c2 .

⋆

Proof. The interface conditions (4) imply q− = q+ := q and η− = η+ := η. Using (24) yields the
equality of the numerical ﬂux on both sides of the particle, i.e.

(q + qL − A(ρ− − ρL) = qR + q − A(ρR − ρ+),

η + ηL − A(q − qL) = ηR + η − A(qR − q).

12

these we can rearrange to obtain

and

q = q⋆ =

qL + qR

2

+

ηL − ηR

2A

ρ− + ρ+

2

=

ρL + ρR

2

+

qL − qR

2A

= ρ⋆.

(32)

We express ρ− and ρ+ by ρ− = ρ⋆ − ˜r and ρ+ = ρ⋆ + ˜r, for some real ˜r in (−ρ⋆, ρ⋆). The interface
condition associated to the conservation of momentum η− = η+ gives

q2
⋆

ρ⋆ − ˜r

+ c2(ρ⋆ − ˜r) =

q2
⋆

ρ⋆ + ˜r

+ c2(ρ⋆ + ˜r) ,

which always admits the trivial solution ˜r = 0. If |q⋆| and ρ2
are two other solutions in (−ρ⋆, ρ⋆) given by

⋆ − q2

c2 are both strictly positive, there

˜r = ±rρ2

⋆ −

q2
⋆
c2 = ±r.

It remains to see which of the two solutions is selected by the entropy condition F (U−) ≤ F (U+).
On the one hand, the coupling conditions (4) are nothing but the Rankine–Hugoniot relations for
a stationary shock. This shock is entropy satisfying if and only if

(u− ≥ c and u+ ≤ c

u+ ≤ −c and u− ≥ −c

if q > 0,
if q < 0.

On the other hand, it is easy to show that

( q⋆

ρ⋆−r ≥ c and q⋆
ρ⋆−r ≤ −c and q⋆

q⋆

ρ⋆+r ≤ c

ρ⋆ +r ≥ −c

if q⋆ > 0,
if q⋆ < 0.

As a consequence, the other entropy satisfying solution is ρ− = ρ⋆ − sign(q⋆)r and ρ+ = ρ⋆ +
sign(q⋆)r.

We now investigate the existence of an entropy inequality for the scheme (21) with the Rusanov

ﬂux.

Proposition 4.3. Consider the scheme (21) with U n
with UL = U n
(UL = U n
j and UR = U n
UL = U n
1 ) .

j+1) for all j 6= 0, for (UL = U n

0 and UR = U n

+ = (ρ⋆, q⋆) deﬁned as in Proposition 4.2,
1 . Suppose that A veriﬁes the subcharacteristic condition (27) for
+ and

−), and for (UL = U n

0 and UL = U n

− = U n

Then, the scheme veriﬁes the discrete entropy inequality

E(U n+1

j

) ≤ E(U n

j ) −

∆tn
∆x

(F n

j+1/2,− − F n

j−1/2,+) ,

where

F n
j+1/2,− =
j+1/2,− = F n
F n
F (U n
F n

1/2,− =

F n

1/2,+ =

2

2




Moreover, F n

1/2,− ≥ F n

1/2,+, thus in particular

−

A
2

(E(U n

j+1) − E(U n

j−1))

if j 6= 0,

if j 6= 0,

F (U n

j ) + F (U n

j+1)

2

j+1/2,+
0 ) + F (U n
−)

F (U n

+) + F (U n
1 )

−

−

A
2
A
2

(E(U n

−) − E(U n

0 )),

(E(U n

1 ) − E(U n

+)).

E(U n+1

0

) + E(U n+1

1

) ≤ E(U n

0 ) + E(U n

1 ) −

∆tn
∆x

(F n

3/2,− − F n

−1/2,+).

13

(33)

(34)

UL = U n

0 and UR = U n
F (U n

1

0 ) − F (U n

1 ) ≤ −A(E(U n

∗ ) − E(U n

0 )) + A(E(U n

1 ) − E(U n

∗ )).

Introducing F (U n

∗ ) in the left hand side, and reorganizing the inequality, we obtain

F (U n

1 ) + F (U n
∗ )

2

−

≤

and the result.

1 ) − E(U n

0 ) + F (U n
∗ )

A

2(cid:0)E(U n

F (U n

2

∗ )(cid:1)
2(cid:0)E(U n

−

A

∗ ) − E(U n

0 )(cid:1)

We now state a similar property for the other solution in Proposition 4.2.

Proposition 4.4. Consider the scheme (21) with

U n

− = (ρ∗ − sign(q∗)r, q⋆) and U n

+ = (ρ∗ + sign(q∗)r, q⋆)

deﬁned (if possible) by the second point of Proposition 4.2 with UL = U n
1 . Suppose that
A veriﬁes the same subcharacteristic condition than in Proposition 4.3. Then (33) holds. Moreover
if the underlying approximate Riemann solver veriﬁes the entropy inequality

0 and UR = U n

F (U1) − F (U0) ≤ A(E(U0) + E(U1) − E(U−) − E(U+)),

(35)

then F n

1/2,− ≥ F n

1/2,+ and (34) holds.

Proof. The fact that (33) holds is obtained as before. Indeed, as the subcharacteristic condition (30)
with UL = U n

Proof. Let us ﬁrst recall that the result away from the particle (j 6= 0) follows from the interpretation
of the Rusanov scheme (26) as an approximate Riemann solver with wave speeds −A and A, see
Proposition 30. With that interpretation, inequality (30) yields (33), see [24]. For j = 0, we just
have to distinguish between the approximate Riemann solver used on the left of the interface, which
corresponds to UL = U n
− and yields (33) for j = 0, and the one used on the right of
the interface, for which UL = U n

1 and which yields (33) for j = 1.

0 and UR = U n

+ and UR = U n

It remains to prove that F n

1/2,− ≥ F n

1/2,+. We start with the classical entropy relation (30) with

0 and UR = U n
F (U n

−, we have
−) − F (U n

0 ) ≤ A(cid:0)E(U n

−) + E(U n

∗0) − 2E(U n

∗0)(cid:1),

U n
L

+U n
2

−

− 1

∗0 =

2A (f (U n

where U n
0 )), which yields (33) for j = 0 (see once again [24]). The
reasoning is similar on the cell 1, because the subcharacteristic condition implies that A is larger
than |u+| + c. The last part of the proposition follows from the deﬁnitions of F n
1/2,±, and the fact
that F (U n

−) − f (U n

+) ≤ F (U n

−).

We now check that the scheme is consistent, i.e. that if UL = UR, the only possible choice in

Proposition 4.2 is U− = U+ = UR = UL.

Proposition 4.5. If UL = UR, the second solution of 4.2 does not verify inequality (35).

Proof. Let us ﬁrst notice that if UL = UR, then U∗ = UL = UR. We have to eliminate the solution
U− = U∗ ± (r, 0) and U+ = U∗ ∓ (r, 0) when it exists. The intermediate state in the Rusanov
approximate Riemann solver between the left state U+ and the right state U− is

U− + U+

2

−

1
2A

(f (U−) − f (U+)) = UL .

By deﬁnition of G0 we have equality of the ﬂuxes f (U+) = f (U−) and under the subcharacteristic
condition (27), we obtain

F (U−) − F (U+) ≤ −A(E(UL) − E(U+) + A(E(U−) − E(UL))

≤ A(E(U+) + E(U−) − 2E(UL)) .

Thus, we have equality in (35), which by Proposition 4.1 only holds if U− = U+.

14

Next we prove that the scheme is exact on isolated admissible stationary shocks, which are the

piecewise constant equilibrium states associated to G0.

Proposition 4.6. Consider a Riemann problem (16), where UL and UR are such that

qL = qR 6= 0, uL > uR, ρL 6= ρR and ρLρR =

qLqR

c2

.

The exact solution of this Riemann problem is

U (x, t) = UL1x<0 + UR1x>0.

Then for all n ∈ N,

U n

j =(UL

UR

if j ≤ 0,
if j ≥ 1.

Proof. To prove that the solution remains constant we have to check that U 0
1/2,− = UL, U 0
and that (35) holds. First we note that (with the notation of Proposition 4.2) ρ⋆ = ρL+ρR

1/2,+ = UR
and q⋆ =

2

c . An elementary computation
qL = qR. Thus ρ⋆ is larger than |q⋆|/c if and only if
shows that ρ 7→ ρ + q2
c , and the result follows. Thus
the second solution of Proposition 4.2 exists, and it is easy to check that U− = UL and U+ = UR.
Furthermore, Equation (35) reduces to F (UR) ≤ F (UL), which is true for admissible shocks (it is
shown in the proof of Proposition 4.2).

c2ρ reaches its only minimum 2|q⋆|

≥ |q⋆|
for ρ = |q⋆|

c2 ρL
2

c

⋆

q2
⋆

ρL+

4.2 The Rusanov ﬂux with Gλ

Now we investigate the interface conditions (5) for the ﬂuid / particle coupling. We begin with an
observation analogue to Proposition 4.2.
Proposition 4.7. Let ˜Gλ be the set

˜Gλ = 
(cid:16) q2

ρ−

+ c2ρ+(cid:17) = λq! .

q− = q+ =: q

+ c2ρ−(cid:17) −(cid:16) q2

ρ+

Then for g = gRus and every (UL, UR) in (R+ × R)2, there exists at least one and at most three
solutions (U−, U+) of (24) in ˜Gλ.

Proof. The ﬁrst interface condition implies that the mass is conserved across the particle q− =
q+ =: q. The second equation quantiﬁes the loss of momentum η− − η+ = λq. System (24) is
designed as the numerical counterpart of those interface conditions. It says that the mass ﬂuxes
at the interface are equal (numerical conservation of the density) and quantiﬁes the jump of the
momentum ﬂux. For the Rusanov ﬂux these conditions are

1

(q + q0 − A(ρ− − ρ0) = q1 + q − A(ρ1 − ρ+),
2(cid:0)η− + η0 − A(q − q0)(cid:1) − 1

2(cid:0)η1 + η+ − A(q1 − q)(cid:1) = η− − η+.

The second line yields

and thus

η0 − η1 − 2Aq + A(q0 + q1) = η− − η+ = λq

q =

A(q0 + q1)

λ + 2A

+

η0 − η1
λ + 2A

.

Note that if λ = 0, we recover the classical case (32), while if ((ρ0, q0), (ρ1, q1)) belongs to Gλ, we
recover q = q0 = q1. Concerning the ﬁrst equation, we obtain as before

ρ− + ρ+

2

=

ρ0 + ρ1

2

+

q0 − q1

2A

=: ρ⋆.

15

Thus we can express ρ− = ρ⋆ − r and ρ+ = ρ⋆ + r for some real r in (−ρ⋆, ρ⋆). The interface
condition associated to the momentum equation η− − η+ = λq gives

(cid:18) q2

ρ⋆ − r

+ c2(ρ⋆ − r)(cid:19) −(cid:18) q2

ρ⋆ + r

+ c2(ρ⋆ + r)(cid:19) = λq.

(36)

Interpreting this as a function of r, the left hand side tends to +∞ when r tends to ρ⋆ and to −∞
when r tends to −ρ⋆. Thus, Equation (36) admits at least one solution in (−ρ⋆, ρ⋆), and at most
three as it is equivalent to ﬁnd the roots of a third degree polynomial expression.

The evolution of the roots of (36) is depicted in Figure 2 for two diﬀerent initial data. For
ρL = ρR = 5 and qL = qR = 2.5, c = 1 and λ = 0 there are three roots. As λ becomes larger, the
root becomes unique. The root is unique for every choice of λ when ρL = ρR = 1 and qL = qR = 2.5.
Note that in both cases, q⋆ tends to 0 as λ tends to +∞. This is expected, as the obstacle acts
more and more like a rigid wall. The root is unique when the initial data is supersonic.

Figure 2: When the initial data is subsonic (left), there is 3 root for small λ and only 1 for large λ.

4.3 Entropy ﬁx

It might happen that Equation (36) does not admit any solution that veriﬁes both the two last
conditions of (5) and the entropy condition (35). For example, if ρL = 4, ρR = 10, qL = 1.9 and
qR = 10, c = 1 and λ = 0.5, Equation (36) with A = 5 admits three solutions. It can be seen on top
of Figure 3. On the bottom of the ﬁgure, we see that the ﬁrst and second solutions do not satisfy
the third condition of (5). Indeed, q⋆ > 0, and the velocity u− at the entrance of the obstacle is
subsonic, while the velocity u+ at its exit is supersonic. It can be checked that the ﬁrst and third
ones do not verify (35).

Whenever the numerical scheme picks a solution that violates an inequality condition of the
interface conditions (5), we change q⋆ into c
(if q⋆ < 0). This modiﬁcation
ρ+
does not change ρ⋆, thus the conservation of mass still holds, but (36) is relaxed. This ﬁx is
mandatory to approximate correctly sonic solution, i.e. solutions in which a wave interacts with
the particle, see Figure 5 below.

(if q⋆ > 0) or q⋆ into −c
ρ−

5 Numerical tests

In this section we investigate the accuracy of the proposed numerical method for diﬀerent choices
of interface conditions. The position of the interface is always x = 0, but its relative position in the

16

Figure 3: Top: the cubic polynomial associated with (36). Bottom: velocities of u− = q⋆
u+ = q⋆

ρ⋆−r and

ρ⋆+r .

space interval is adapted to the solution of the actual problem. In all computations the Courant
number is taken as 0.95. In all computations the speed of sound is c = 1 and the considered intervals
are discretized with 200 cells, if not mentioned explicitly.

We compare the results given by the Rusanov ﬂux (26) and by the FORCE ﬂux

gFORCE(UL, UR) =

gRus(UL, UR) + f (U⋆)

2

,

(37)

where the middle state U∗ is given by (28).

5.1 Fluid/particle coupling

The ﬁrst series of tests we perform for the ﬂuid/particle model (5).
Riemann problems at the interface are considered, which should cover all relevant scenarios.

In the examples diﬀerent

Subsonic (Test case 1)

In the ﬁrst test the initial data is chosen to be subsonic, i.e. ρL = ρR = 3, qL = qR = 1 and λ = 1.
Thus, there is one wave moving to the left and one to the right. A large portion of the ﬂuid is
blocked in front of the obstacle and only a small percentage can pass. As shown in Figure 4 this
leads to a large density and small velocity in front of the obstacle, while small density and larger
velocity behind it. We observe that the scheme approximates accurately the intermediate states at
the interface. Only the shape of the waves is smeared out, as it is known from the Rusanov ﬂux.

17

Figure 4: Test case 1: subsonic initial data, subsonic solution. The obstacle partially blocks the
ﬂow.

Subsonic to sonic (Test case 2)

At a coupling point it may occur that the initial data is subsonic, but its solution contains a sonic
rarefaction wave. Such a behaviour can be observed for the initial data is ρL = 1, ρR = 20,
qL = qR = 0 and λ = 0.5, see Figure 5. This is due to the fact that the ﬂuid / particle model is
not strictly hyperbolic as shown in of [1]. It implies that the waves are not necessarily separated
by a constant state. Solutions of this kind are diﬃcult to approximate numerically. In this test the
ﬁx of Section 4.3 is active and without it the scheme converges towards an incorrect solution, see
Figure 6 where ∆x = 0.001.

Supersonic (Test case 3)

When the initial data is supersonic, the ﬂow may remain supersonic if the drag coeﬃcient λ is small
enough. For example if ρL = ρR = 1, qL = qR = 3 and λ = 1, the obstacle does not slows down the
ﬂow enough to reach the sonic point. Thus, the perturbations due to the obstacle stay behind it,
see Figure 7.

Sonic (Test case 4)

When λ increases, we ﬁrst obtain a sonic (or resonant) solution, the eﬀect of the obstacle is strong
enough to decreases the ﬂuid’s velocity below the speed of sound. The ﬂuid’s velocity is subsonic
in front of the obstacle and sonic behind it, see Figure 8. The initial data is the same as in the

18

Figure 5: Test case 2: subsonic initial data, resonant solution. The solution contains three waves.
One of them is a sonic rarefaction starting at the exit of the interface.

previous case but with λ = 10. It is a very diﬃcult test case, because the ﬂow is resonant and
the solution contains a slowly moving shock on the left side of the interface. Slowly moving shocks
are very diﬃcult to capture numerically, see [9]. A spurious peak appears in the momentum and
pollutes the rest of the solution. Note that this is due to the slowly moving shock and not to the
method used at the interface; it explains the larger errors observed here. In this particular test case
the space interval is discretized with 800 cells.

Sonic to subsonic (Test case 5)

When λ is very large, the ﬂow might become subsonic on each sides of the obstacle, see Figure 9.
For this test case, λ = 10, ρL = ρR = 2.5, qL = qR = 3. The solution is approaches the case in
which a rigid wall is placed at the interface.

5.2 Fluid/particle coupling with heat exchange

In this section we present a numerical simulation of model (6) obtained with Scheme (19-21-24)
with the Rusanov ﬂux (26) and the FORCE ﬂux (37), when the parameters λ and µ vary. The
initial data is a constant subsonic ﬂow: the ﬂuid has initially a constant density of 4, a constant
velocity of 1 and a constant pressure of 4. The adiabatic exponent is γ = 1.5 and we take sP = 2.
The ﬁnal time is T = 0.03, ρ0 is set to 1, and the space interval [−0.1, 0.1] is discretized with 500
cells. We considered the three following cases.

19

Figure 6: Test case 2: Convergence of the scheme with and without the ﬁx of Section 4.3 (∆x =
0.001)

λ = 1 and µ = 0 (Test case 6): The obstacle partially blocks, but does not exchange
heat with the ﬂow

The results are given on Figure 10. In that case, the qualitative behavior is the same than in the
subsonic case presented on Figure 4. Most of the ﬂuid is stuck in front of the particle, where the
ﬂuid’s velocity is small, and both the pressure and the internal energy are large. A small part of
the ﬂuid manages to pass through the obstacle: the air after the obstacle has high velocity, and low
pressure and internal energy.

λ = 0 and µ = 0.5 (Test case 7): The obstacle does not block, but heats the ﬂow

The results are given on Figure 11. We can think of this situation as an external heat source. In
that case, the main eﬀect is that the temperature (i.e. the internal energy) of the ﬂuid increases
after the particle. This inﬂuences the other quantities according to the ideal gas law.

λ = 1 and µ = 0.5 (Test case 8): The obstacle both slows down and heats the ﬂow

The results are given on Figure 12. The behavior is a mix between the two previous cases.
In
particular, depending on the ratio between λ and µ, the temperature after the obstacle can be
larger or smaller than in front of it.

Numerically, we observed that the scheme does not ﬁnd a solution in the ﬁrst iterations in time
with our naive starting point. In that case it picks a solution as close as possible to 0, thus it is

20

Figure 7: Test case 3: supersonic initial data, supersonic solution. The ﬂows is slowed downed by
the obstacle, but remains supersonic.

somehow close to the scheme proposed in [12]. After a few iterations, a solution is found at each
time step.

The simulations presented here corresponds to a Riemann problem. At the present time, the
solution of the Riemann problem for model (6) is not known. However, at the end of the simulation,
we can use the left and right numeric traces and check that the structure of the solution described
by (17-18-19) is respected. These are used to construct the black “Reference” curves on Figures 10,
11 and 12.

5.3 Gas dynamics with diﬀerent pressure laws

In this section we present two numerical simulations of the coupling of two ﬂuids with diﬀerent
pressure laws (11), each for the ﬂux coupling (12) and the state coupling (13). The initial data are
the same than the ones proposed in [20]:

γL
Test case 9
1.4 1.6 0.4 2.35 1.28 1.6
Test case 10 1.4 1.6 0.4 2.35 1.28 1.4

uL

ρL

pR
0.4 2.35
1.9
0.4

pL

γR

ρR uR

Scheme (21) is adapted to take into account the diﬀerent physics, i.e. we use a ﬂux gL with pressure
law pL in the ﬁrst two lines of (21), and a ﬂux gR with pressure law pR for the last two lines.

The results presented in Figure 13 and 14 are obtained with the FORCE ﬂux (results for the
Rusanov scheme are similar, but more diﬀusive). The ﬁrst test case is an equilibrium for the state

21

Figure 8: Test case 4: supersonic initial data, sonic solution. This case is somehow similar to test
case 2. M = 800

coupling, which is exactly preserved by the numerical scheme. For the ﬂux coupling, the scheme
exactly preserves the conserved variables. For both coupling conditions, the results are comparable
to those obtained in [20] with a relaxation scheme.

5.4 Barotropic ﬂows in a nozzle with piecewise constant cross-section

As last example we consider model (14) with the interface conditions (15) and the pressure law
p(τ ) = τ −3. We reproduce the two test cases proposed in [19]. The initial conditions are given by

Test case 11
Test case 12

αL
0.3
1
αR
Test case 11
0.4
Test case 12 100

ρL

wL

0.206052848877390 −0.003218270138816
0.125759712385390
0.988056834959612

ρR

0.099
1.01

wR

−0.015876669673295
0.018403108075689

The ﬁnal time is 1 for test case 11 and 0.15 for test case 12. The space interval is [−0.5, 0.5]. The
results for a discretization with ∆x = 0.01 are given on Figures 15 and 16. as the exact traces

22

Figure 9: Test case 5: supersonic initial data, subsonic solution. The qualitative allure of the
solution is similar to the one in test case 1.

around the interface are known the numerical errors for test case 11 are given in the table below.

exact

0.1440929013128 0.10409950707725

ρ−

w−

ρ+
0.15

w+
0.075

Rusanov
∆x = 10−2
Rusanov
∆x = 10−3

FORCE

∆x = 10−2

FORCE

∆x = 10−3

6.22 × 10−3

1.36 × 10−4

3.09 × 10−4

6.931 × 10−5

8.83 × 10−6

8.26 × 10−5

1.86 × 10−5

5.48 × 10−5

1.49 × 10−4

1.38 × 10−4

1.54 × 10−4

1.15 × 10−4

4.54 × 10−6

4.59 × 10−5

9.99 × 10−6

3.04 × 10−5

Both schemes produce good approximations, which converge to the exact solution when the grid is
reﬁned.

The next table regroups the exact traces and the errors around the interface for test case 12. It
clearly shows that the scheme is able to capture correctly the solution when the jump in the cross

23

0.4
−0.10 −0.05

2.5
2.4
2.3
2.2
2.1
2.0
1.9
1.8
1.7
1.6
−0.10 −0.05

7

6

5

4

3

−0.10 −0.05

0.00
X

6.0

5.5

5.0

4.5

4.0

3.5

density

velocity

1.1

Rusanov
1.0
0.9
FORCE
0.8
Reference

0.7

0.6

0.5

3.0
−0.10 −0.05

0.00

pressure

0.05

0.10

0.00

0.05
temperature

0.10

Figure 10: A subsonic constant ﬂow is modiﬁed by an heat-insulating obstacle: λ = 1, µ = 0

0.05

0.10

0.05

0.10

0.00
X

section is large. This is even true for the dissipative Rusanov scheme with a coarse discretization.

exact

0.9980372070299 0.108472909864928

ρ−

w−

ρ+
1

w+

0.0010826

Rusanov
∆x = 10−2
Rusanov
∆x = 10−3

FORCE

∆x = 10−2

FORCE

∆x = 10−3

4.96 × 10−7

2.27 × 10−5

2.45 × 10−6

2.91 × 10−7

6.35 × 10−7

6.3 × 10−7

6.63 × 10−7

7.57 × 10−9

1.68 × 10−6

1.63 × 10−7

1.69 × 10−6

3.35 × 10−8

4.82 × 10−7

3.13 × 10−8

4.83 × 10−7

1.22 × 10−9

Conclusion

We presented a numerical approach which is able to deal with interface conditions for 1-dimensional
hyperbolic systems of conservation laws. The scheme is derived in such a way that the structure
of the Riemann problem is mimicked at the numerical level “as good as possible”. The interface
conditions are exactly taken into account. In the general case, it is not possible to enforce that no
waves enter the junction. Thus we relaxed the classical coupling procedure by only requiring that

24

0.4
−0.10 −0.05

2.5
2.4
2.3
2.2
2.1
2.0
1.9
1.8
1.7
1.6
−0.10 −0.05

7

6

5

4

3

−0.10 −0.05

0.00
X

6.0

5.5

5.0

4.5

4.0

3.5

density

velocity

1.1

Rusanov
1.0
0.9
FORCE
0.8
Reference

0.7

0.6

0.5

3.0
−0.10 −0.05

0.00

pressure

0.05

0.10

0.00

0.05
temperature

0.10

Figure 11: A subsonic constant ﬂow is modiﬁed by a source that does not block the ﬂow: λ = 0,
µ = 0.5, sP = 2

0.05

0.10

0.05

0.10

0.00
X

the eﬀects of all entering waves cancel each other.

The approach is analyzed in detail for the Godunov and the Lax-Friedrichs scheme and it is
proved that the resulting approximate Riemann solver veriﬁes an entropy inequality. This scheme
was tested on four diﬀerent models. In the ﬁrst one, by introducing a small modiﬁcation, also sonic
ﬂows can be approximated. The other test cases include a model with heat exchange and a coupling
of two diﬀerent conservation laws on each side of the interface. This solver is easy to implement
and the applications illustrate its ﬂexibility.

Acknowledgment: The ﬁrst author was partially supported by the University Paris Sud and

by the Labex Archimède of Aix-Marseille Université.

References

[1] Nina Aguillon. Numerical simulations of a ﬂuid-particle coupling. In Finite volumes for complex
applications. VII. Elliptic, parabolic and hyperbolic problems, volume 78 of Springer Proc. Math.
Stat., pages 759–767. Springer, Cham, 2014.

[2] Nina Aguillon. Riemann problem for a particle–ﬂuid coupling. Math. Models Methods Appl.

Sci., 25(1):39–78, 2015.

25

0.4
−0.10 −0.05

2.5
2.4
2.3
2.2
2.1
2.0
1.9
1.8
1.7
1.6
−0.10 −0.05

7

6

5

4

3

−0.10 −0.05

0.00
X

6.0

5.5

5.0

4.5

4.0

3.5

density

velocity

1.1

Rusanov
1.0
0.9
FORCE
0.8
Reference

0.7

0.6

0.5

3.0
−0.10 −0.05

0.00

pressure

0.05

0.10

0.00

0.05
temperature

0.10

Figure 12: A subsonic constant ﬂow is modiﬁed by a heating obstacle, that both slows down and
exchange heat with the ﬂuis: λ = 1, µ = 0.5, sP = 2

0.05

0.10

0.05

0.10

0.00
X

[3] A. Ambroso, C. Chalons, F. Coquel, E. Godlewski, F. Lagoutière, P.-A. Raviart, and N. Seguin.

Coupling of general Lagrangian systems. Math. Comp., 77(262):909–941, 2008.

[4] Annalisa Ambroso, Christophe Chalons, Frédéric Coquel, and Thomas Galié. Interface model
coupling via prescribed local ﬂux balance. ESAIM Math. Model. Numer. Anal., 48(3):895–918,
2014.

[5] Annalisa Ambroso, Christophe Chalons, Frédéric Coquel, Edwige Godlewski, Frédéric
Lagoutière, Pierre-Arnaud Raviart, and Nicolas Seguin. The coupling of homogeneous models
for two-phase ﬂows. Int. J. Finite Vol., 4(1):39, 2007.

[6] Boris Andreianov and Clément Cancès. On interface transmission conditions for conservation
laws with discontinuous ﬂux of general shape. J. Hyperbolic Diﬀer. Equ., 12(2):343–384, 2015.

[7] Boris Andreianov, Kenneth Hvistendahl Karlsen, and Nils Henrik Risebro. A theory of L1-
dissipative solvers for scalar conservation laws with discontinuous ﬂux. Arch. Ration. Mech.
Anal., 201(1):27–86, 2011.

[8] Boris Andreianov and Nicolas Seguin. Analysis of a Burgers equation with singular reso-
nant source term and convergence of well-balanced schemes. Discrete Contin. Dyn. Syst.,
32(6):1939–1964, 2012.

26

2.1

2.0

1.9

1.8

1.7

1.6

density

0.50

velocity

0.48

state coupling
flux coupling

0.46

0.44

0.42

0.40

0.38

0.36

1.5

−0.6 −0.4 −0.2

0.0

0.2

0.4

0.6

0.34

−0.6 −0.4 −0.2

0.0

0.2

0.4

0.6

temperature

pressure

2.35

2.30

2.25

2.20

5.5

5.0

4.5

4.0

−0.6 −0.4 −0.2

0.0
X

0.2

0.4

0.6

3.5

−0.6 −0.4 −0.2

0.2

0.4

0.6

0.0
X

Figure 13: Test case 9: ﬂux and state couplings. The ﬁnal time is 0.12, the Courant number is set
to 0.95 and the space step is ∆x = 0.005

[9] Mohit Arora and Philip L. Roe. On postshock oscillations due to shock capturing schemes in

unsteady ﬂows. J. Comput. Phys., 130(1):25–40, 1997.

[10] Mapundi K. Banda, Michael Herty, and Axel Klar. Coupling conditions for gas networks

governed by the isothermal Euler equations. Netw. Heterog. Media, 1(2):295–314, 2006.

[11] R. Borsche and A. Klar. Flooding in urban drainage systems: coupling hyperbolic conservation
laws for sewer systems and surface ﬂow. Internat. J. Numer. Methods Fluids, 76(11):789–810,
2014.

[12] Raul Borsche. Numerical schemes for networks of hyperbolic conservation laws. Preprint, 2015.

[13] Raul Borsche and Jochen Kall. ADER schemes and high order coupling on networks of hyper-

bolic conservation laws. J. Comput. Phys., 273:658–670, 2014.

[14] Raul Borsche and Jochen Kall. High order numerical methods for networks of hyperbolic

conservation laws coupled with odes and lumped parameter models. Preprint, 2015.

27

1.9

1.8

1.7

1.6

1.5

1.4

1.3

2.4

2.3

2.2

2.1

2.0

1.9

1.8

density

0.65

velocity

state coupling
flux coupling

0.60

0.55

−0.4

−0.2

0.0

0.2

0.4

pressure

−0.4

−0.2

0.0

0.2

0.4

temperature

0.50

0.45

0.40

0.35

5.0

4.5

4.0

3.5

−0.4

−0.2

0.0
X

0.2

0.4

−0.4

−0.2

0.2

0.4

0.0
X

Figure 14: Test case 10: ﬂux and state couplings. The ﬁnal time is 0.12, the Courant number is set
to 0.95 and the space step is ∆x = 0.005

[15] Alberto Bressan. Hyperbolic systems of conservation laws, volume 20 of Oxford Lecture Series in
Mathematics and its Applications. Oxford University Press, Oxford, 2000. The one-dimensional
Cauchy problem.

[16] R. M. Colombo, M. Herty, and V. Sachers. On 2 × 2 conservation laws at a junction. SIAM J.

Math. Anal., 40(2):605–622, 2008.

[17] Rinaldo M. Colombo and Graziano Guerra. On general balance laws with boundary. J.

Diﬀerential Equations, 248(5):1017–1043, 2010.

[18] Rinaldo M. Colombo and Francesca Marcellini. Smooth and discontinuous junctions in the

p-system. J. Math. Anal. Appl., (361):440–456, 2010.

[19] Frédéric Coquel, Khaled Saleh, and Nicolas Seguin. A robust and entropy-satisfying numerical
scheme for ﬂuid ﬂows in discontinuous nozzles. Math. Models Methods Appl. Sci., 24(10):2043–
2083, 2014.

28

1.015

1.010

1.005

1.000

0.995

0.990

0.985

0.980

0.22

0.20

0.18

0.16

0.14

0.12

0.10

0.08

density

velocity

0.14

0.12

0.10

0.08

0.06

0.04

0.02

Rusanov
FORCE

0.00

−0.4

−0.2

0.0

0.2

0.4

−0.4

−0.2

0.0

0.2

0.4

Figure 15: Test case 7: a subsonic Riemann problem for model (14)

density

velocity

0.12

0.10

0.08

0.06

0.04

0.02

Rusanov
FORCE

0.00

−0.4

−0.2

0.0

0.2

0.4

−0.02

−0.4

−0.2

0.0

0.2

0.4

Figure 16: Test case 8: a subsonic Riemann problem for model (14) with a large jump in the cross
section

[20] Frédéric Coquel, Edwige Godlewski, Khalil Haddaoui, Claude Marmignon, and Florent Renac.
Choice of measure source terms in interface coupling for a model problem in gas dynamics. to
appear in Mathematics of Computations, 2015.

[21] P. Garcia-Navarro and M. E. Hubbard. Flux diﬀerence splitting and the balancing of source

terms and ﬂux gradients. J. Comput. Phys., 165:89–125, November 2000.

[22] Paola Goatin and Philippe G. LeFloch. The Riemann problem for a class of resonant hyperbolic

systems of balance laws. Ann. Inst. H. Poincaré Anal. Non Linéaire, 21(6):881–902, 2004.

[23] Edwige Godlewski, Kim-Claire Le Thanh, and Pierre-Arnaud Raviart. The numerical interface
coupling of nonlinear hyperbolic systems of conservation laws. II. The case of systems. M2AN
Math. Model. Numer. Anal., 39(4):649–692, 2005.

[24] Edwige Godlewski and Pierre-Arnaud Raviart. Numerical approximation of hyperbolic systems
of conservation laws, volume 118 of Applied Mathematical Sciences. Springer-Verlag, New
York, 1996.

29

[25] Ee Han and Gerald Warnecke. Exact Riemann solutions to shallow water equations. Quart.

Appl. Math., 72(3):407–453, 2014.

[26] Amiram Harten, Peter D. Lax, and Bram van Leer. On upstream diﬀerencing and Godunov-

type schemes for hyperbolic conservation laws. SIAM Rev., 25(1):35–61, 1983.

[27] Eli Isaacson and Blake Temple. Nonlinear resonance in systems of conservation laws. SIAM

J. Appl. Math., 52(5):1260–1278, 1992.

[28] Frédéric Lagoutière, Nicolas Seguin, and Takéo Takahashi. A simple 1D model of inviscid

ﬂuid-solid interaction. J. Diﬀerential Equations, 245(11):3503–3544, 2008.

[29] Gunhild A. Reigstad. Numerical network models and entropy principles for isothermal junction

ﬂow. Netw. Heterog. Media, 9(1):65–95, 2014.

[30] Gunhild A. Reigstad. Existence and uniqueness of solutions to the generalized Riemann prob-

lem for isentropic ﬂow. SIAM J. Appl. Math., 75(2):679–702, 2015.

30

