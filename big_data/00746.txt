6
1
0
2

 
r
a

M
2

 

 
 
]
n
a
-
a
t
a
d

.
s
c
i
s
y
h
p
[
 
 

1
v
6
4
7
0
0

.

3
0
6
1
:
v
i
X
r
a

Procedure to Approximately Estimate the
Uncertainty of Material Ratio Parameters in
Roughness Metrology

Dorothee H¨user1, Jonathan H¨user3, Sebastian Rief2, J¨org
Seewig2, Peter Thomsen-Schmidt1
1 Physikalisch-Technische Bundesanstalt, Bundesallee 100, 38116 Braunschweig,
Germany
2 Institute for Measurement and Sensor Technology, University of
Kaiserslautern, Gottlieb-Daimler-Straße, 67663 Kaiserslautern, Germany
3 Software and Tools for Computational Engineering, RWTH Aachen University,
Seﬀenter Weg 23, 52074 Aachen, Germany

E-mail: dorothee.hueser@ptb.de

Abstract. Roughness parameters to assess textures of contacting surfaces with
regard to friction and wear often are stated without uncertainties or only those
caused by the measurement process not by the stochastic characteristics of the
measurement object. Diﬀerent values of a single roughness parameter cannot
be compared in a straight forward manner, because a complex superposition of
diﬀerent random processes is involved.

Therefore statistical models to state all contributions to the uncertainty
of roughness parameters are required. Although investigations on statistical
analysis and Monte Carlo simulations of roughness as random ﬁeld have been
performed for more than fourty years, a practical recipe to use these to quantify
the contribution of the stochasticity of surface topographies to the uncertainty of
roughness parameters is still outstanding.

We propose a procedure to derive the uncertainty from a single proﬁle
employing a Monte Carlo simulation that is based on the statistical moments of
the amplitude distribution and the autocorrelation length of the proﬁle. To show
the possibilities and the limitations of this method we compare the uncertainty
derived from a single proﬁle with that derived from a high statistics experiment.

PACS numbers: 06.20.Dk,06.30.Bp

Keywords: surface roughness, bearing/material ratio, stochastic process, uncertainty
Submitted to: Meas. Sci. Technol.

Material Ratio Parameter Uncertainty

2

1. Introduction

Surface roughness is a relevant feature for contacting surfaces besides material
properties such as stiﬀness and adhesion. Whether regarding joints and bearings
in mechanical engineering, medical prostheses, or the contact between a cutting edge
and the work piece, the surfaces in contact need characterization and assessment
accordingly.

Roughness is a stochastic property that is characterized by a variety of
statistical estimators delivering measures to parameterize the height distribution,
the distributions of slopes, of vertical and lateral peak-valley sizes. Furthermore
autocorrelation length, fractal dimension, and many more quantities are used to
quantify stochastic features of a topography, hence roughness. To quantify roughness
of contacting surfaces in particular a set of parameters derived from the so-called
bearing ratio distribution is deﬁned in ISO 13565-2 and presented in detail in Bushan
[1] and in Whitehouse [2].

Rough topographies are asperities and dales of randomly distributed sizes
and shapes. Their mountainous structure shows an autocorrelation with average
autocorrelation lengths. Comparable to a regular sampling on periodic structures,
both the bandwidth and the resolution of the sampling process play a role for textures
that have similar, repetitive features. The spatial resolution of the measurement
process is the measure of how closely structures can be resolved, which includes the size
of the area of a surface over which the mapping or probing instrument integrates. This
means that a sampled height value is not the height of a point but the average height
of an area. The bandwidth of a sampling process is characterized by the distance
of neighboring sampling points and the width and shape of the impulse function
of the sampling train limiting the high frequency resolution and possibly causing
aliasing eﬀects. Additionaly, it is characterized by the total sampling area limiting
the maximum wavelength and possibly biasing the autocorrelation characteristics.

If roughness measurement instruments do not supply an uncertainty estimate
of the roughness parameters, they do not state a complete measurement result.
Uncertainties can be stated that are caused by the measurement process of the
instrument,
i.e. by the manufacturer. A
manufacturer of an instrument, however, cannot implement `a priori knowledge on the
characteristics of the measurement objects of his customer. The problem to solve is
to join the instrumental’s intrinsic stochastic processes and the measurement object’s
intrinsic stochastic characteristics contributions to the uncertainty.

if the instrument is well understood,

A standardized procedure deﬁning a method to estimate the roughness
uncertainty does not yet exist neither for a tactile proﬁler, an optical or electron-optical
instrument, nor an atomic force microscope. Roughness instruments are retraced via
calibrated test objects with deterministic topographies. Some of them are uniform
grids of deﬁned shape, such as triangular or sinusoidal, others are apparently random
proﬁles, but are manufactured as deterministic predeﬁned function that is repeated in
a systematic way.

The uncertainty of roughness parameters of deterministic topographies depends
on the measurement principle in the sense of the above mentioned sampling bandwidth
[3], the uncertainty induced by the instrument itself (noise, quantization, stability,
positioning / geometric deviations, cross talk, calibration etc.) and on the evaluation
method, i.e. the ﬁltration, the algorithm to determine the parameter and the numerical
realization of the implementation of both of them [4]. To evaluate the uncertainty

Material Ratio Parameter Uncertainty

3

Figure 1. According to the vocabulary of metrology the measurement result
requires to state an uncertainty in addition to the physical quantity itself. The
uncertainty usually is obtained from suﬃcient statistics, taken from a large
number of proﬁles on one surface. Let Rx,i be one of the roughness parameters
of proﬁle i, then the mean is given by < Rx >= 1
i=1 Rx,i and the standard
deviation by std(Rx) = q 1

n Pn
i=1(Rx,i − < Rx >)2.

n−1 Pn

contributions of the measurement instruments’ components, the stochastics of their
error inﬂuences are, for instance, Monte Carlo simulated as virtual instrument [5, 6].
For non-deterministic, i.e. stochastic topographies, a major contribution to the
uncertainty of roughness parameters besides instrumental limits is the variation of
the topography itself.
It is the interrelation between bandwidth limit of probing,
relocation of samples with size, correlation lengths, periodicities, and randomness
of the structures and features of the topography. Therefore performing a Monte
Carlo simulation of the instrumental contributions only gives a component of the error
budget that may be signiﬁcantly smaller than the topography induced contribution.
There is a strong demand for modeling the surface topography as well. A suﬃciently
representative set of proﬁle resp. areal scans of the appropriate bandwidth are required
to assess the texture characteristics of a surface. A statistical analysis belongs to a
measurement result in the sence of the international vocabulary of metrology, which
states that a measurement result is generally expressed as a measured quantity value
and a measurement uncertainty. A large number of scans provides for a greater number
of values for each of the roughness parameters. Then mean and standard deviation
of the roughness parameters can be evaluated to obtain a measurement result as
illustrated in Fig. 1. Regarding nowadays computer technology and comparing it to
instrumentation, it is often the case that simulations are faster and less expensive
than measurements.
In case of tactile instruments the measurement process may
cause wear or even damage. Therefore, Monte Carlo simulations may be preferred,
if there exists `a priori knowledge of the statistical behavior of the data for deriving
simulation results from the data with insuﬃcient empirical statistics.
In addition
to the statistical analysis of the topography inﬂuence, the uncertainties caused by
the instrumental devices as well as those caused by the choice of the algorithmic
procedures, i.e. the ﬁltration methods [7] and the way of evaluating the Abbott curve,
contribute to the ﬁnal result.

For more than fourty years a variety of models to describe and simulate the
roughness of surface topographies have already been developed employing approaches
of random ﬁeld theory, time series, and non-causal stochastic processes [8]. Wu [9]
compares the approaches to convolve white noise with appropriate weight functions
that are either obtained by autocorrelation resp. the power spectrum density [10] or
by auto regressive (AR) models [11], or the approach to use the power spectrum and

Material Ratio Parameter Uncertainty

4

Figure 2. With `a priori knowledge of the statistical behavior of the data, the
uncertainty could approximately be estimated by deriving simulation results from
the data with insuﬃcient statistics.

instead of multiplying it with the Fourier transform of white noise, to multiply it
with uniformly random distributed phases. Uchidate has investigated non-causal AR-
models for surface topographies [12], because space is not restricted to causality as
time does.

Many of the roughness models presume that surface heights are normally
distributed,
i.e. that they have a Gaussian shaped amplitude distribution. The
deviation from this presumption is quantiﬁed by the roughness parameters Rsk, which
is the skewness, i.e.
the third statistical moment, and Rku, which is the kurtosis
or excess,
i.e. the fourth statistical moment, of the probability density function
of topography height values. To parameterize non-Gaussian probability density
distributions such that the distributed quantity is transformed to a quantity that
then has a Gaussian probability density distribution, a system of functions has been
introduced by Johnson in 1949 [13]. To estimate the appropriate function of that
set with its parameters accordingly, Hill, Hill, and Holder [13] have developed an
algorithm in 1976 that we are employing for our suggested procedure. For more
than ﬁfteen years, the Johnson system has been applied to roughness analysis and
simulation [14, 15].

Stochastic data require huge samples for statistical analysis and assessment. In
quality assurance in industrial life, however, small representative samples are drawn
to spot-check a process or pieces. Therefore, we have investigated, how well the
uncertainty of material ratio parameters of roughness data can be estimated from
a single measurement, one proﬁle or a single area scan.
In the next section, the
deﬁnition according to ISO standards of material ratio parameters will be presented
and the ambiguities of the deﬁnition will be discussed. Section three deals with
the inﬂuence of sampling eﬀects on the autocorrelation function ACF and on the
probability density function PDF of a topography revealing the sampling eﬀect by
looking at synthetic, well deﬁned topographies, deﬁned by Fourier series. In section
four, we will give details on the probability density distributions that are useful to
describe amplitude distributions of roughness proﬁles. Section ﬁve is dedicated to
show a way for an approximate estimation of the uncertainty of the material ratio
parameters by deriving Monte Carlo simulated proﬁles from a small set of proﬁles
or even a single proﬁle as depicted in Fig. 2. The procedure is a coarse guess being
helpful for industrial processes, but does not preempt from taking large data samples
to obtain reliable statistical results for research purposes.

The proposed procedure is based on investigations on simulated synthetic proﬁles
of known Fourier series components as well as experimental proﬁles of a tactile areal
proﬁler, a custom built micro topography measurement system [16]. The vertical

Material Ratio Parameter Uncertainty

5

z

c

li

x

Figure 3. Deﬁnition of the material ratio.

axis of the measurement system is realized by a stylus with its vertical movement
measured interferometrically directly in line with its probe tip, i.e. without Abb´e
oﬀset and without any arc error. The stylus is guided by an air pressure bearing and
its probing force is controlled by magnetic ﬁelds.

The experimental data have been taken on diﬀerent kind of industrial surfaces.
The experiments were carried out on an area of 4 × 4 mm2 on surfaces with Ra
values lying in an interval of (0.1, 2] µm according to ISO 4288:1996/Cor 1:1998. The
ﬁltration cuts oﬀ the waviness contribution by wavelength λc and the high frequency
contribution by wavelength λs to suppress noise, to reduce apparent low frequencies
induced by the folding of frequencies around the sampling frequency [17], and to match
instrumental bandwidths [3]. ISO 4288 deﬁnes the choice of the cut oﬀ wavelengths
λs and λc according to the amplitude parameters Ra and Rz. ISO 3274 deﬁnes the
maximum allowed width of sampling intervals according to the cut oﬀ wavelengths,
for our experimental setting this is ∆x ≤ 0.5 µm and the radius of the probe tip is
R ≈ 2 µm. That means that current ISO standards deﬁne the choice of the bandwidth
according to amplitude parameters rather than correlation length and other horizontal
parameters, an issue that will also be discussed in section three.

2. Deﬁnition of Material Ratio Parameters

To clearify the relation between the statistical height distribution of a surface and
the roughness parameters that are used to characterize surface contact, this section
presents the deﬁntion of the material ratio parameters in detail. Abbott and Firestone
have proposed to describe the area of contact between surfaces by characterizing the
area of each surface as the ratio of air to material at any level c. The parameter
material ratio M r, also called bearing ratio, is a function of height level c [1]. Let L
be the length of the total proﬁle, then the sum of the length pieces li intersecting the
asperities at level c, i.e. li(c), delivers M r ≡ rM

as illustrated in Fig. 3. As a double letter identiﬁer is inappropriate for maths
formulae, we denote the material rM rather than M r. The inverse of the function
material ratio depending on height level, i.e. the distribution c vs. rM, is called Abbott-
Firestone distribution, abbreviated Abbott-curve. The algorithm to evaluate all li(c)
from intersecting asperities and subsequently calculating each intersection between

rM(c) =

li(c)

(1)

1

L Xi

Material Ratio Parameter Uncertainty

6

x
ai

z

c

aj

x

Figure 4. Material ratio with intersections between proﬁle asperities and
horizontal line at height level c.

the horizontal line at z = c and the asperities has a complexity that can be avoided if
the residual error

∆rM(c) = Xi (cid:18) 1

2

∆x − ai(cid:19)

(2)

is suﬃciently small. The statistical distribution of negative diﬀerences 0.5∆x − ai
is similar to that of positive, so that they almost cancel on average in most cases.
The distances ai are those between the intersection of an asperity surface and the
neighboring knot of the proﬁle as illustrated in Fig. 4.

A fast and eﬃcient approach is to sort all discrete height values of the

equidistantly sampled proﬁle according to their values zi

zi1 ≥ zi2 ≥ . . . ≥ zik ≥ . . . ≥ zin

(3)

(4)

such that with L = (n − 1) ∆x
rM(c = zik ) ≈

∆x
L

k

Xν=1(cid:18)1 −

1
2

δiν ,1 −

1
2

δiν ,n(cid:19)

with (x1, z1) and (xn, zn) being the border positions of the original proﬁle and δiν ,1
and δiν ,n denoting the Kronecker symbols to treat the border positions appropriately.

Furthermore we approximate this by
k − 0.5

.

rM(c = zik ) ≈

n

(5)

Avoiding the values rM = 0 and rM = 1 is required if the inverse error function erf −1 to
parameterize the relation c vs. rM of proﬁles with Gaussian distributed height values
is used, which is fulﬁlled by using k − 0.5 rather than k.
The international standard ISO 13565-2 deﬁnes a set of 5 parameters derived
from the Abbott-curve for proﬁles and ISO 25178-2 the corresponding parameters for
areal scans:

• the core height Rk, which is the distance between the highest and lowest level of

the core proﬁle resp. for areal data Sk of the core surface,

• the reduced peak height Rpk and reduced valley/dale height Rvk, which are the
height of the protruding peaks above the core proﬁle after reduction process
in case of Rpk and the height of the protruding dales below the core proﬁle
after reduction process in case of Rvk. For areal scans they are the height of
protruding peaks above resp. dales below the core surface and again the identiﬁer
R is replaced by S,

Material Ratio Parameter Uncertainty

7

• the two material ratio quantities giving once the ratio of the area of the material at
the intersection line which separates the protruding hills from the core proﬁle resp.
surface to the evaluation area, shortly named peak ratio M r1 resp. Smr1; secondly
the ratio of the area of the material at the intersection line which separates the
protruding dales from the core proﬁle resp. surface to the evaluation area, shortly
named peak ratio M r2 resp. Smr2.

The core height Rk is the negative slope of a regression line within a 40 % interval for
the core material. The 40 % interval [rM(cp), rM(cv)] with

is chosen such that the slope of the secant takes a minimum:

rM(cv) := rM(cp) + 0.4

min

cp,cv(cid:26)

cp − cv

rM(cv) − rM(cp)(cid:27)

(6)

In case of smooth Abbott-curves this interval coincides well with the interval of
minimum slope Rk, but not in any case. The search of the minimum secant rather than
slope has been chosen at times when computer time was more costly and processing
was slow. Furthermore, a discrete set of height values with cv at a position for k = v,
i.e. with ziv and cp = zip rather than a continous 40 % interval is used. Consequently
the interval is a discretization

rM(ziv ) − rM(zip) ≈ 0.4

approximating [rM(cp), rM(cv)].

If the regression line ﬁtted to the Abbott-curves within [rM(cp), rM(cv)] is given

by

z(rM) = −Rk rM + c1,

the parameter Rk is called core height.

(7)

For an amplitude distribution of sample size n → ∞ and that is a Gaussian, the
Abbott curve is the inverse error function erf −1, thus the slope at the position rM = 0.5
is √2π Rq. The slope of a regression line to erf −1 for rM ∈ [0.3, 0.7] is Rk ∼= 2.5739 Rq
[18], which is greater than the slope at the 50%-position with √2π ∼= 2.5066.
If c2 = c1 − Rk the ratio parameters M r1 ≡ r1 and M r2 ≡ r2 are obtained via

the inverse Abbott-curve

r1 = rM(c1)

and

r2 = rM(c2).

(8)

If there exists a positive integral A1 of the Abbott-curve above the height level c1
within the interval [0, r1]

and for the dales a positive integral A2

0

A1 = Z r1
A2 = Z 1

r2

(c(rM) − c1) d rM > 0

(c2 − c(rM)) d rM > 0

the parameters Rpk and Rvk are deﬁned as

Rpk =

2 A1
r1

and

Rvk =

2 A2
1 − r2

.

(9)

(10)

(11)

Material Ratio Parameter Uncertainty

8

Topographies with amplitude distributions of kurtosis values much smaller than 3,
for instance sinusoidal grids, have no values above and below the core levels, i.e. no
positive values for A1 and A2 and therefore no reduced peak and dale heights.

We illustrate the eﬀect of the choice of the Abbott-curve algorithm on the values
of the material ratio parameters using our measurements on ground steel. One of
the proﬁles of scan length L = 4 mm and of a correlation length ls = 6.1 µm being
measured with a sampling interval of ∆x = 0.1 µm is taken exemplarily. The relative
diﬀerence of the material ratio parameters whether obtained from the Abbott-curve
by sorting or by explicit material ratio evaluation lies below 10−4 if ∆x = 0.1 µm. To
reveal the eﬀect, we reduced the resolution artiﬁcially by resampling the proﬁle with an
interval of ∆x = 0.5 µm. To show the dependence on the raggedness we then evaluated
the Abbott-curve of the down sampled proﬁle once without any software cut oﬀ of high
frequencies, i.e. the lateral limitation purely arises from the ﬁnite size of the probing
sphere of a tip radius of approximately 2 µm. In order to illustrate that the diﬀerence
between the algorithms reduces the smoother the proﬁle, we simply performed some
low pass ﬁltration on the downsampled proﬁle cutting oﬀ λs = 8 µm and furthermore
cutting oﬀ at a wavelength of λs = 25 µm. Regarding the diﬀerence between the Rk-
value obtained by the sorting method Rk,srt and the Rk-value obtained by material
ratio calculation Rk,mrc interpolating linearly at the intersection between height levels
c and asperity surfaces and the mean between those two values, we evaluate the ratio
to get the relative diﬀerence.

∆rel(Rk) =

Rk,srt − Rk,mrc
1
2 (Rk,srt + Rk,mrc)

(12)

Evaluating the relative diﬀerences for all parameters delivers:

-

λs/µm
8.7 · 10−3
∆rel(Rk)
∆rel(Rpk) −7.0 · 10−3
5.6 · 10−3
∆rel(Rvk)
−8.8 · 10−3
∆rel(r1)
1.5 · 10−3
∆rel(r2)

8

1.1 · 10−3

−15.7 · 10−3

5.0 · 10−3
4.2 · 10−3
0.2 · 10−3

25

0.5 · 10−3
−6.0 · 10−3
0.4 · 10−3
−6.0 · 10−3

< 10−4

The sorting approximation according to Eqn.

(3) - (5) delivers the cumulative
height distribution of a topography. Therefore, the parameters Rk, Rpk, and Rvk are
directly related to the PDF of the height values. In the next two sections, we will
discuss the characteristics of PDFs of surface topographies in detail, ﬁrst the way
how sampling inﬂuences its appearance and then we present the classiﬁcation of PDF
types in statistics.

3. Inﬂuence of Sampling on ACF and PDF

As topographies of rough surfaces still have regular structures, in particular those
originating from machining processes with rotating bodies thus producing periodic
cutting traces, uniform sampling may cause aliasing and leakage eﬀects. Therefore,
the ratio between sampling interval ∆x and autocorrelation length lc on one side and
the ratio between sampling length L and autocorrelation length lc on the other side
are the determining quantities for the reliability of the discretization of a topography.

Material Ratio Parameter Uncertainty

9

Consequently, Bushan suggests to use the correlation length to deﬁne the sampling
length L [1]. Let C: x 7→ C(x) be the autocorrelation function

C(x) = Z ∞

−∞

z(x) z(x − ξ) dξ

(13)

and the autocorrelation length deﬁned to be the length xc where C takes a certain
value C(xc) = Cc. Bushan sets Cc = 0.1 denoting it xc =: β ∗, commonly Cc = e−1
as in [10] denoting it xc =: λ0, and in ISO 25178-2 it is Cc = 0.2. In this article, we
deﬁne xc =: lc for Cc = 0.2. Bushan’s suggestion of an appropriate proﬁle length of
random surfaces to be

L ≥ 200 β ∗

(14)

means that L should be around 300 lc. We have examined a ground steel surface with
300 lc = 1.6 . . . 2.4 mm which is about half of the sampling length according to ISO
4288 of 4 mm. We also have examined a ceramics surface of cutting tool inserts with
300 lc = 1.8 . . . 3.0 mm and a few outlying proﬁles, where 300 lc took values above the
L = 4 mm in the range of 4.3 . . . 5.7 mm.

For the sampling interval Bushan suggests ∆x < 0.25 β ∗, i.e. ∆x < 0.35 lc, at
least ∆x < 0.5 β ∗. In 1989, Ogilvy and Foster [10] have examined the inﬂuence of
the sampling interval on the shape of the resultant autocorrelation function and its
deviation from the original exponential progress. They state that a sampling interval of
∆x < 15−1 λ0 (∆x < 0.04 lc) would be adaequate to detect the exponential nature of
the autocorrelation function, which according to them is most likely for rough surface
topographies, thus for the surfaces under investigation at around ∆x = 0.2 . . . 0.3 µm.
According to ISO standard our surfaces should be sampled with at most ∆x = 0.5 µm
and we have measured with a sampling interval of ∆x = 0.1 µm. The suggestions
of Bushan originate from the late 1980s and beginning of 1990s, while nowadays
instrumental and computational technologies allow broader bandwidths.

Finite and uniform sampling causes an exponential autocorrelation of a rough
surface to show ripples like a sinc function or a Bessel function, since they are caused
by the convolution with an impulse train of Dirac or box pulses. In order to illustrate
the relation between sampling and the shape of the ACF as well as the shape of
the PDF, we have generated roughness proﬁles that we could describe analytically
choosing Fourier series of a ﬁnite set of spatial frequencies that means of reciprocal
wavelengths λ. Two types of probability density distributions of the frequency sets
are compared: a one-sided Gaussian

and a uniform distribution

1

2 (cid:16) λ − λm

λBW (cid:17)2

N (λm, λBW) ∝ e−
U(λm, λBW) ∝ (cid:26) const. λ ∈ [λm, λm + λBW]

λ ≥ λm

else

0

(15)

(16)

.

For the Gaussian wavelength distribution the maximum probability is that of the
highest allowed frequency resp. smallest wavelength.

Sets of N wavelengths {λ1, . . . , λN} are diced according to the above listed
distributions, furthermore N phases {ϕ1, . . . , ϕN} are diced according to a uniform
distribution with ϕν ∈ [−π, π], and amplitudes aν ∝ exp(−λν /(10−3 µm)) were

Material Ratio Parameter Uncertainty

10

chosen. A continuous proﬁle is synthesized for x being the continuous lateral position,
i.e. for x ∈ IR

z(x) =

aν sin(cid:18) 2 π

λν

x + ϕν(cid:19) .

For a Dirac pulse sampling the proﬁle is discretized as

z(xi) =

aν sin(cid:18) 2 π

λν

(i − 1) ∆x + ϕν(cid:19)

N

Xν=1

N

Xν=1

(17)

(18)

with i = 1, . . . , n and for a box pulse train with a pulse width w the proﬁle samples
are

with

N

z(xi) =

Xν=1

aν Z Bi
Ai = (i − 1) ∆x −

Ai

w
2

;

sin(cid:18) 2 π

λν

ξ + ϕν(cid:19) dξ
Bi = (i − 1) ∆x +

w
2

.

(19)

The origin of ripples of the autocorrelation function C may as well be the
ﬁnite sample size of contributing spatial frequencies N . Furthermore, the kind of
distribution of the frequencies contributing to the Fourier series determines whether
C is better represented by an exponential or by a Gaussian function. Fig. 5 shows
the ACFs of two diﬀerent Fourier series, both with N = 431 spatial frequencies. The
black solid curve is the one obtained from the proﬁle with uniformly distributed spatial
wavelengths with λm = 11.3 µm and λBW = 102 µm delivering a correlation length
of lc = 11.56 µm, which is to be compared to the Gaussian ACF visualized as red
dashed curve. The black dash-dotted curve is the ACF obtained from the proﬁle with
Gaussian distributed wavelengths with λm = 2.6 µm and λBW = 53 µm delivering a
correlation length of lc = 8.6 µm, to be compared to the exponential ACF visualized
as blue dotted curve and to which we will refer as proﬁle G. In Fig. 5 we can see that
signiﬁcant high frequency contributions owe the exponential behavior of the ACF. Be
it due to lower resolution as investigated by Ogilvy and Foster or due to the fact that
there exist as little high frequencies as low frequencies as we have calculated it here.
The resultant ACFs have a Gaussian behavior in both cases. To show the eﬀect of
lateral resolution, we have calculated the discretization of proﬁle G for a Dirac impulse
train, and box impulse trains with three diﬀerent widths w. Fig. 6 shows the ACF
of the data by Dirac impulse train as blue solid curve, those of box impulse trains
with w = 0.8 µm as light green dash-dotted curve, w = 2.5 µm as red dashed curve,
and w = 5.0 µm as black dotted curve. Since the Fourier series minimum value of
wavelength is λm = 2.6 µm, the diﬀerence between the box (light green dash-dotted)
and the Dirac impulse (blue solid) trains is negligible. In accordance with Ogilvy and
Foster the larger the box width, i.e. the smaller the resolution, the more the ACF
turns to a Gaussian curve shape.

As the ACF it is also the probability density distribution PDF, which is aﬀected
by the resolution issue. Fig. 7 shows the PDFs of proﬁle G for three diﬀerent sampling
intervals, with all of them sampled with Dirac pulses. The length of the proﬁle
has always been 4 mm such that the sample size (number of points) n decreases:
∆x = 0.05 µm with n = 80 000 is plotted as solid blue curve, ∆x = 0.8 µm with
n = 5000 as dotted green curve, and ∆x = 4 µm with n = 1000 as dashed red curve.
The PDF is pronged due to the smaller sample size. We have also investigated the

Material Ratio Parameter Uncertainty

11

1

0.2

0

1

C

0.8

0.6

0.4

0.2

0

-0.2

-0.4

0

10

20

30

40

0

200

400

600

800

x (µm)

Figure 5. Autocorrelation functions of two diﬀerent Fourier series: 1.
from
uniformly distributed spatial wavelengths (black solid curve) with λm = 11.3 µm
and λBW = 102 µm, correlation length of lc = 11.56 µm and Gaussian ACF
(red dashed curve); 2. from Gaussian distributed wavelengths (black dash-dotted
curve) with λm = 2.6 µm and λBW = 53 µm, correlation length of lc = 8.6 µm
and exponential ACF (blue dotted curve).

1

C

0.8

0.6

0.4

0.2

0

-0.2

-0.4

0

10

20

x (µm)

30

40

50

Figure 6. Autocorrelation functions of the Fourier series after being sampled
diﬀerently: 1. Dirac impulse train (blue solid curve), 2. box impulse train with
w = 0.8 µm (light green dash-dotted curve), 3. box impulse train with w = 2.5 µm
(red dashed curve), 4. box impulse train with w = 5.0 µm (black dotted curve).

Material Ratio Parameter Uncertainty

12

F
D
P

-1.5

-1

-0.5

0

z (µm)

0.5

1

1.5

Figure 7. Probability density distribution ∆x = 0.05 µm solid blue curve,
∆x = 0.8 µm dotted green, ∆x = 4 µm dashed red curve.

F
D
P

-1.5

-1

-0.5

0

z (µm)

0.5

1

1.5

Figure 8. Probability density distribution Dirac solid blue curve, w = 0.8 µm
dashed green curve, w = 2.5 µm dash-dotted red, w = 5 µm dotted black curve.

eﬀect of the impulse box size on the PDFs for ﬁxed sample sizes. One example for
sample size n = 1000 and diﬀernt impulse trains is shown in Fig. 8. The blue curve
shows the PDF of a proﬁle sampled by a Dirac impulse train, the dashed green curve
the PDF with box pulse sampling of width w = 0.8 µm, the red dash-dotted curve
with w = 2.5 µm, and the black dotted curve with w = 5 µm.

4. PDF Types Parameterizing Roughness Amplitude Distributions

During the past decades, a variety of investigations were made to classify surfaces
obtained from diﬀerent kind of engineering processes according to their amplitude
distributions and how they deviate from Gaussian distribution according to their
statistical moments and furthermore according to anisotropy and lay.

In 1994, Whitehouse [2] suggested to use diﬀerent classes of β-distributions. He
derived a relation between the parameters of the β-distributions and the statistical
moments. To describe data that are distributed with long tails generalized extrem
value functions are employed,
in particular in the ﬁeld of ﬁnance statistics [19].
Extreme value theory has been developed to characterize data with values that
extremely deviate from the median of probability distributions [19]. The median
is a robust statistical parameter deﬁned to be the middle value of the sorted set of
discrete observations of a quantity.

Weibull distributions, as an example of an extreme value distribution, are of

Material Ratio Parameter Uncertainty

13

particular interest for honed cylinder liner or cylinder running surfaces with oil volume
and the elastic-plastic contact of asperities [20].

Since the functions of the Johnson system deﬁne non-Gaussian probability
density functions that facilitate simulations based on white noise by explicit and
invertable transformation f : z 7→ t(z), we employ Johnson distributions for the Monte
Carlo simulation of proﬁles. They are represented by Gaussian distributions of a
transformation of the quantity to be examined, i.e. ∝ exp(−0.5 t2). Their relation
to statistical moments can be estimated by the Hill et al optimization algorithm of
1976 [13], which is available as Matlab/Gnu-octave routine as well. Johnson deﬁnes
following three types of transformation functions f :

• the lognormal system SL

• the unbounded system SU

• the bounded system SB

t = γ + δ ln (z − ξ)

ξ < z

t = γ + δ arcsin(cid:18) z − ξ
λ (cid:19)
t = γ + δ ln(cid:18) z − ξ

z + λ − ξ(cid:19) ξ < z < ξ + λ

Normally distributed random numbers of a quantity t can then be transformed by
using the inverse transformation f −1.

To use the algorithm of Hill et al, we employ the statistics deﬁnition of the
statistical moments of the PDF, i.e. those with mean subtraction, whereas roughness
standards ISO 4287 and ISO 25178-2 deﬁne these statistical moments without
mean subtraction presuming that the detrending of waviness by cutting oﬀ spatial
frequencies below λ−1
causes the mean ¯z to be very close to zero and hence negligible,
i.e.

c

(20)

(21)

(22)

(23)

(24)

(25)

¯z =

1

LZ L

0

z(x)dx ≈ 0.

The third moment in roughness metrology is

Rsk =

1

q Z L

0

L R3

(z(x))3 dx

while in statistics and as input for Hill et al we use

µ3 =

1

n σ3

(zi − ¯z)3

n

Xi=1

with ¯z being the mean of all zi, called ﬁrst moment. The fourth moment or kurtosis
is

Rku =

respectively

1

q Z L

0

L R4

(z(x))4 dx

µ4 =

1

n σ4

n

Xi=1

(zi − ¯z)4

(26)

(27)

Material Ratio Parameter Uncertainty

14

0.03

PDF

0.025

0.02

0.015

0.01

0.005

0

-2

-1

z (µm)

0

1

Figure 9. Probability density distributions of 2 scans on a ground steel surface
sanned perpendicular to the lay with ∆x = 0.1 µm and their estimates of
Johnson system’s functions: the PDF of the data plotted as black dashed curve
is parameterized with a function of the unbounded system (green dashed curve);
the PDF plotted as blue solid curve with a function of the bounded system (red
solid curve).

with the second moment being

Rq = s 1

LZ L

0

(z(x))2 dx

respectively

σ2 = µ2 =

1

n − 1

(28)

(29)

n

Xi=1

(zi − ¯z)2

and with x being the lateral position, L the length of the proﬁle, n the number
of sampling points, and z the roughness proﬁle after band limitation by detrending
ﬁltration.

Now we regard our measurement on ground steel with ∆x = 0.1 µm and
L = 4 mm,
i.e. with n = 40 000 with scanning direction orthogonal to the lay.
Estimation of a PDF of the Johnson system via statistical moments delivered functions
of the SU type for some of the proﬁles and the SB type for most of the proﬁles. Fig. 9
shows exemplarily two of 1000 parallel proﬁles. The two displayed proﬁles lie 4 mm
appart, one parameterized with a PDF of the SU the other of the SB. Using the
Johnson’s system function (green dashed curve) of the second proﬁle’s PDF plotted as
black dashed curve and simulating 20 proﬁles according to its autocorrelation length,
which has a value of lc = 6 µm, and with ∆x = 0.4 µm delivers the PDFs shown in
Fig. 10.

The ceramics sample that we have investigated shows extremely deep pores such
that the PDFs have a signiﬁcant long left tail biasing the statistical moments. To
obtain statistical moments delivering appropriate Johnson system functions, we have
eliminated the height values below −2.5 µm when evaluating the statistical moments.
Fig. 11 shows the PDFs of two of the measured proﬁles together with the estimated
SU functions for each of them. The requirement of tail elimination for the scans on

Material Ratio Parameter Uncertainty

15

0.03

PDF

0.025

0.02

0.015

0.01

0.005

0

-2

-1

z (µm)

0

1

Probability density functions (red solid curves) obtained by
Figure 10.
simulating 20 proﬁles according to its autocorrelation length, which has a value
of lc = 6 µm, and with ∆x = 0.4 µm using the Johnson’s system function (blue
dashed curve).

0.02

PDF

0.015

0.0004

0.01

0.0003

0.0002

0.0001

0.005

0

-4.5

-4

-3.5

-3

-2.5

-2

-1.5

0

-4

-3

-2

-1

z (µm)

0

1

Figure 11. Probability density distribution of 2 example scans on a ceramics
surface. The measurment plotted as solid blue curve has been parameterized
with a Johnson’s SU function, which is drawn as solid red curve; the measurment
drawn as dashed black curve estimated with that of dashed green curve.
Moment estimations required a cut oﬀ of values z ≤ −2.5 µm to deal with the
extraoridinarily long tails to reproduce the shape of the core of the PDFs.

the ceramics surface shows the limits of the procedure to employ statistical moments
for a subsequent estimation of Johnson system’s functions. For a more intricate
investigation, hence more complex Monte Carlo approaches, a mixing of more than
one stochastic process is needed. A mixing may be achieved by superimposing proﬁles
and ﬁnally PDFs. Typical examples for such superpositions are surfaces obtained by
diﬀerent steps of machining processes such as honing after grinding. The grinding
delivers deep grooves and dales, for instance as oil volume, and the honing smoothes
the upper part of the surface to decrease friction. Pawlus superimposes two Gaussian

Material Ratio Parameter Uncertainty

16

distributed surfaces to simulate this type of surfaces [21]. This approach will be
investigated more thoroughly with regard to the statistics of topographies produced
by diﬀerent machining steps. We are considering a combination of Gaussian and non-
Gaussian PDFs for future work [22]. A generalized approach of a superpositioning of
Gaussian processes is the Gaussian mixture density modeling, which has already been
investigated twenty years ago [23].

5. Approximating Material Ratio Uncertainties

In this section, we now present a procedure for estimating the uncertainty contribution
to roughness parameters caused by the stochasticty of the topography of the measured
surface.
In order to investigate its possibilities and limitations we have examined
surfaces of diﬀerent material and diﬀerent type of machining, topographies with lay
and isotropical textures. All surfaces under investigation for this article have Rk values
in the order of magnitude of 1 µm. They show standard deviations of Rk that lie in
the range of two to ﬁve percent. The standard deviation of Rpk and that of Rvk are in
the same order of magnitude than that of Rk in their absolute values, such that their
relative deviation is greater accordingly. To demonstrate our Monte Carlo approach
with its advantages and drawbacks here, we have chosen the proﬁles measured on our
ground steel sample.

The proposed procedure only provides for an approximate estimate of the
It does not replace the characterization

uncertainty of material ratio parameters.
of the texture over a macroscopic range. The method procedes as follows:
(i) numerical evaluation of ACF of the discrete proﬁle of n height values {z1, . . . , zn}
with calculation of the autocorrelation length lc by selecting the ﬁrst intersection
of the ACF curve with C = 0.2;

(ii) choose the appropriate model for ACF, either exponential or Gaussian, then
evaluate C(x, lc) and its power spectrum density for a discrete sample of sample
size n; use Fourier transform of weights {w1, . . . , wn} that are derived from
C(xi, lc) according to [10];

(iii) estimate the statistical moments of the proﬁle {z1, . . . , zn} according to Eqn. (23),

(25), (27), and (29) and estimate function of Johnson system;

(iv) perform K times (for instance K = 100), i.e. κ = 1, . . . , K the following sub-steps:
(a) generate random white noise {r1, . . . , rn}κ of sample size n and convolve
it with the weights {w1, . . . , wn} such that a correlated sequence of values
{t1, . . . , tn}κ

(30)

is obtained with wν such that

wν ri+ν

ti =Xν
C(xi, lc) =Xν

tνti+ν

(31)

by multiplication in Fourier space accordingly;

(b) transform sequence {t1, . . . , tn}κ via inverse function f −1 of Johnson system’s
(c) evaluate the set material ratio parameters Rk,κ, Rpk,κ, etc. of the simulated

function to obtain a simulated proﬁle {˜z1, . . . , ˜zn}κ
proﬁle {˜z1, . . . , ˜zn}κ

Material Ratio Parameter Uncertainty

17

(v) evaluate mean and standard deviation of each of the material parameters over K

values:

and

¯Rk =

1
K

Rk,κ

etc.

K

Xκ=1

K

Xκ=1(cid:0)Rk,κ − ¯Rk(cid:1)2

σ(Rk) = vuut

1

K − 1

etc.

On ground steel, we have measured 1000 proﬁles with a sampling interval of
∆x = 0.1 µm. The mean observed autocorrelation length is lc = 6 µm. The covered
area takes 4 × 4 mm2. We have observed signiﬁcantly varying Rq values as well as
varying skewness and kurtosis as can be seen in Fig. 12 as blue circles.

Rk
µm µm µm
0.64
1.07
0.04
0.04

Rpk Rvk Mr1 Mr2
%
86.3
0.9

%
7.2
0.8

0.27
0.05

mean
σ

The standard deviations σ of Rk, Rpk, and Rvk have values of around 50
Nanometer. To compare the experimental result with our Monte Carlo method, we
have run the Monte Carlo simulation 20 times with 100 proﬁles each, with L = 4 mm
and lc = 6 µm. To show the inﬂuence of resolution we have done this for three diﬀerent
sampling intervals ∆x = 0.1 µm, ∆x = 0.5 µm, and ∆x = 1 µm, delivering following
values for the standard deviation of each of the material ratio parameters:

∆x/µm

σ(Rk)/nm
σ(Rpk)/nm
σ(Rvk)/nm
σ(Mr1)/ %
σ(Mr2)/ %

0.1
23 ± 2
15 ± 1
30 ± 2

0.48 ± 0.03
0.69 ± 0.06

0.5
25 ± 2
16 ± 1
30 ± 2

0.53 ± 0.03
0.74 ± 0.06

1

28 ± 2
17 ± 2
32 ± 2

0.60 ± 0.05
0.78 ± 0.06

The values given in the above table show that the uncertainty of the core height
lies around three percent, the uncertainty of the reduced peak and dale heights around
six percent.

Similar to the distribution of skewness and kurtosis of the experimental data we
have randomly changed the moments for the Johnson functions within the Monte Carlo
loop (included step (iii) into step (iv)). Here, we show one example with which we
mimic the experimental relation of skewness and kurtosis of the ground surface shown
in Fig. 12 as blue circles. We have varied the skewness µ3 due to a uniform distribution
then evaluated the kurtosis µ4 to be close to following straight line segment:

µ4 (cid:19) ∈(cid:20)(cid:18) −1.0
(cid:18) µ3

5.67 (cid:19) , (cid:18) −0.58

3.25 (cid:19)(cid:21)

The kurtosis has been normally distributed around that line with σµ4 = 0.01. The
diced pairs of (µ3, µ4) are displayed in Fig. 12 as red asterixes. For the sampling
interval a value of ∆x = 0.1 µm has been chosen.

Material Ratio Parameter Uncertainty

18

6

5.5

5

4.5

4

3.5

s
i
s
o
t
r
u
K

3
-1.2

-1

-0.8

-0.6

Skewness

-0.4

-0.2

0

Figure 12. Relation between skewness and kurtosis for a ground steel surface,
the blue circles are obtained by experiment and the red asterix are values used
for Monte Carlo simulation to be passed to the Johnson system of PDFs.

48 ± 3
27 ± 2
50 ± 4

σ(Rk) / nm
σ(Rpk) / nm
σ(Rvk) / nm
σ(Mr1) / % 0.56 ± 0.04
σ(Mr2) / % 0.80 ± 0.06
With a variation of the statistical moments we could take inﬂuence on the
resulting standard deviation pushing it up to the values of the experimental result
revealing that for any engineering process a texture assessment on a prototype is
required. For ﬁxed third and fourth moment, just varying the second, the uncertainty
of Rk shows the linear relation to that of Rq, since they are directly related as the
Abbott curve is the cumulative PDF. σ(Rpk) and σ(Rvk) are strongly inﬂuenced by
the higher moments.

In contrast to experiment, the value of the σ(Rpk) remains smaller while σ(Rvk)
is reproduced well, revealing that the Johnson functions represent the left tail well
enough but not the right side of the PDF. This shows that the proposed method
gives an approximate estimate, but that a detailed analysis and a precise uncertainty
estimate requires a more complex model of the stochastic processes.

6. Conclusion

Deriving the standard deviation of material ratio parameters can be approximated
coarsely from a single scan. A Monte Carlo method that employs the autocorrelation
length of the scanned proﬁle and the ﬁrst four statistical moments of its amplitude
distribution has been proposed. It is based on a model autocorrelation function, an
exponential or Gaussian, parameterized by the experimental autocorrelation length
and on a model probability density function of the Johnson system of which the
parameterization is derived from the experimental statistical moments.

Employing only one single proﬁle has the advantage that the procedure can well

Material Ratio Parameter Uncertainty

19

be implemented into roughness analysis software without any additional statistics
information. Our investigations comparing Monte Carlo with a high statistics exper-
iment have shown that this may underestimate the value of the standard deviation.
To assess the uncertainty more precisely, more statistics is required, which can well be
obtained by scanning more proﬁles that are irregularly distributed across the surface
deliveering a greater variation of the Monte Carlo generated proﬁles. A future goal
is to develop more complex but still feasible model of surface texture statistics and a
learning system ﬁlling a data base for diﬀerent classes of topographies.

[1] Bharat Bhushan. Modern Tribology Handbook, volume 1, chapter 2 Surface Roughness Analysis

and Measurement Techniques. CRC Press, 2001. doi:10.1201/9780849377877.ch2 .

[2] David J Whitehouse. Handbook of Surface Metrolotgy, chapter 2 Surface Characterization. IOP

Publishing, 1994.

[3] R. Leach and H. Haitjema.

Bandwidth characteristics and comparisons of

texture measuring

face
doi:10.1088/0957-0233/21/3/032001.

instruments.

Meas.

Sci. Technol.,

21:9pp,

sur-
2010.

[4] H. Haitjema.

estimation
by mechanical
Int.
doi:10.1504/IJPTECH.2013.058260.

Uncertainty

probing.

of

roughness
J. Precision Technology,

2.5-d

parameters
3(4):403–412,

obtained
2013.

[5] M. Xu, T. Dziomba, and L. Koenders. Modelling and simulating scanning force microscopes
for estimating measurement uncertainty: a virtual scanning force microscope. Meas. Sci.
Technol., 22:094004 (10pp), 2011. doi:10.1088/0957-0233/22/9/094004.

[6] C.L. Giusca, R.K. Leach, and A.B. Forbes. A virtual machine-based uncertainty evaluation
for a traceable areal surface texture measuring instrument. Measurement, 44:988–993, 2011.
doi:10.1016/j.measurement.2011.02.011.

[7] D. H¨user, P. Thomsen-Schmidt, and R. Meeß. Uncertainty of cutting edge roughness estimation
In submitted to CIRP CSI, editor, 3rd CIRP Conference

depending on waviness ﬁltration.
on Surface Integrity (CIRP CSI), Procedia CIRP, page 4pp, 2016.

[8] T.H. Wu and E.M. Ali. Statistical representation of joint roughness. Int. J. Rock Mech. Min.

Sci. & Geomech. Abstr., 15(5):259–262, 1978. doi:10.1016/0148-9062(78)90958-0.

[9] J.J. Wu. Simulation of rough surfaces with ﬀt. Tribology International, 33:47–58, 2000.

[10] J.A. Ogilvy and J.R. Foster. Rough surfaces: gaussian or exponential statistics? J. Phys. D:

Appl. Phys., 22:1243–1251, 1989.

[11] J¨org Seewig.

Praxisgerechte Signalverarbeitung zur Trennung der Gestaltabweichungen

technischer Oberﬂ¨achen, chapter 5.3 Modell der Rauheit. Shaker, 2000.

[12] M. Uchidate, T. Shimizu, A. Iwabuchi, and K. Yanagi. Generation of reference data
of 3d surface texture using the non-causal 2d ar model. Wear, 257:1288–1295, 2004.
doi:10.1016/j.wear.2004.05.019.

[13] I. D. Hill, R. Hill, and R. L. Holder. Algorithm as 99: Fitting johnson curves by moments. J

R STAT SOC C-APPL, 25(2):180–189, 1976. doi:10.1007/s10614-006-9025-7 .

[14] S K Chilamakuri and B Bhushan. Contact analysis of non-gaussian random surfaces. Proc.

Instn. Mech. Engrs, Part J: J. Eng. Trib., 212:19–32, 1998.

[15] V. Bakolas. Numerical generation of arbitrarily oriented non-gaussian three-dimensional rough

surfaces. Wear, 254:546–554, 2003. doi:10.1016/S0043-1648(03)00133-9.

[16] P. Thomsen-Schmidt. Characterization of a traceable proﬁler instrument for areal roughness

measurement. Meas. Sci. Technol., 22:11pp, 2011. doi:10.1088/0957-0233/22/9/094019 .

[17] David J Whitehouse. Handbook of Surface Metrolotgy, chapter 3 Processing. IOP Publishing,

1994.

[18] J. Seewig. The uncertainty of roughness parameters. In AMA, editor, AMA Conferences 2013,

Proceedings SENSOR 2013, pages 291–296, 2013. doi:10.5162/sensor2013/B6.2.

[19] M. Killi and E. K¨ellezi. An application of extreme value theory for measuring ﬁnancial risk.

Computational Economics, 27(2):207–228, 2006. doi:10.1007/s10614-006-9025-7.

[20] N. Yu and A.A. Polycarpou. Contact of rough surfaces with asymmetric distribution of asperity

heights. J. Tribol, 124:367–376, 2002. doi:10.1115/1.1403458.

[21] P. Pawlus.

Simulation of stratiﬁed surface topographies. Wear, 264:457–463, 2008.

doi:10.1016/j.wear.2006.08.048.

[22] Sebastian Rief. Dissertation. University of Kaiserlautern, Germany, to be published.
[23] X. Zhuang and Y. Huang. Gaussian mixture density modeling, decomposition, and applications.

IEEE Trans. Image Processing, 5(9):1293–1302, 1996.

