QUANTIZATION OF HITCHIN INTEGRABLE SYSTEM VIA POSITIVE

CHARACTERISTIC

ROMAN BEZRUKAVNIKOV AND ROMAN TRAVKIN

Abstract. The main result of the seminal (unpublished) work of Beilinson-Drinfeld is the con-
struction of an automorphic sheaf corresponding to a local system which carries the additional
structure of an oper. This is achieved by quantizing the Hitchin intergrable system. In this note
we show (in the case of G = GL(n)) that this result admits a short proof based on positive
characteristic methods.

6
1
0
2

 
r
a

M
4

 

 
 
]
T
R
h
t
a
m

.

[
 
 

1
v
7
2
3
1
0

.

3
0
6
1
:
v
i
X
r
a

1. Introduction

Geometric Langlands duality predicts existence of an automorphic D-module ML on BunG
attached to a (de Rham) LG-local system L. Here G, LG are reductive groups dual in the sense
of Langlands, BunG is the moduli stack of G-bundles on a complete smooth irreducible curve C
and the local system L on C with structure group LG is assumed to be irreducible (i.e., it does not
admit a reduction to a proper parabolic subgroup).

In their celebrated unpublished work [BD] Beilinson and Drinfeld explain that geometric Lang-
lands duality can be thought of as a quantization of a natural duality for the Hitchin integrable
systems associated to two Langlands dual groups G, LG. Furthermore, they present a construction
of ML for a local system L which carries an additional structure of an oper, see [BDop] for an
introduction to this notion. Their construction uses local to global arguments, it relies heavily on
representation theory of aﬃne Lie algebras at the critical level.

In this note we describe (for G = GLn) a much shorter construction bypassing aﬃne Lie algebra

representations, relying on reduction to positive characteristic.

More precisely, we use the (easy) construction of automorphic D-modules ML for a generic
local system L on a curve over a ﬁeld of positive characteristic [BB]. We verify that under the
generic geometric Langlands equivalence in positive characteristic of [BB] the free critically twisted
D-module corresponds to (the pushforward of) the structure sheaf of opers, this is deduced from
a general observation relating the image of the free D-module under the Hecke functor to opers
presented in section 3 (this part of the argument is closely related to ideas of [BD]). This allows us to
show that global sections of the sheaf of critically twisted D-modules on Bunn is a ﬂat deformation
of the ring of functions on the Hitchin base, by ﬁrst doing it in positive characteristic and then
deducing the general case by a standard argument. The construction of automorphic D-modules
corresponding to opers follows from this in view of the observation from section 3.

Let us mention that the theme started in [BB], where geometric Langlands duality was established
for GLn local systems with a smooth spectral curve has been developed in [Gr], where the case
of not necessarily smooth spectral curves has been treated and [CZ], [CZ1] dealing with G local
systems for G 6= GLn. However, the present note is the ﬁrst work (to the authors’ knowledge)
where this type of result is connected to the original setting of a characteristic zero base ﬁeld.

1

2

ROMAN BEZRUKAVNIKOV AND ROMAN TRAVKIN

We ﬁnish the Introduction with a technical remark. Below we use a general construction, the
derived category of asymptotic D-modules on stacks. Here by an asymptotic D-module on a smooth
algebraic variety X we mean a sheaf of modules over the sheaf of rings D(X), the sheaf of Rees
algebras corresponding to the sheaf of ﬁltered algebras D(X). Thus D(X) is a ﬂat sheaf of rings
over polynomials in , such that D(X)/( − 1) = D(X), D(X)/ = O(T ∗X). We refer to
[L] for a discussion of standard functors on the derived category of D-modules. The proof of
Proposition 3 relies on an extension of this theory to smooth algebraic stacks over a ﬁeld of an
arbitrary characteristic which does not seem to be documented in the literature.

The proof of Lemma 4 uses rudimentary theory of DG-stacks (the only DG-stacks appearing

here are derived ﬁber products of ordinary stacks).

Acknowledgements. The ﬁrst author would like to thank G. Laumon who several years ago
has asked him if the result of [BB] can be applied to the characteristic zero setting. R.B. was
supported by an NSF grant and a Simons Foundation Fellowship during preparation of this article.

2. Notations and statement of the main result

We mostly work over a ﬁeld k of characteristic diﬀerent from 2, we ﬁx a complete curve C over k.
Let G = GLn, Bun will denote the moduli stack of rank n vector bundles over C; let Bund denote
the component of parametrizing bundles of degree d.

Recall the stack Bun with a map Bun → Bun which is a Gm-gerbe, [BB, §4.6]. The categories of
coherent sheaves and D-modules on Bun and Bun are closely related, while Bun has the advantage
of being good in the sense of [BD]; we let Bund ⊂ Bun be the image of Bund.

Let D-modBun be the category of twisted D-modules on Bun, where the class of the twisting
equals half of the class corresponding to the canonical line bundle on Bun and similarly for Bun.
Notice that a square root of the canonical line bundle on Bun is known to exist, thus this category
is equivalent to the category of D-modules on Bun, respectively Bun. Let DBun ∈ D-modBun denote
the sheaf of twisted diﬀerential operators with the same twisting. (Notice that DBun is not a sheaf
of rings on Bun, see [BD, Sect. 1.1.3].) Let also DBun be the derived category of D-modules on Bun.
Thus D-modBun is the heart of the natural t-structure on DBun. We also use similar notations with
Bun replaced by Bun.

Let Op denote the space of marked opers, see [BDop] for a general introduction to this notion,

see also the deﬁnition (in the version we use) below before Corollary 5.

The main result of this note is the following

Theorem 1.

(a) For every d ∈ Z we have a canonical isomorphism Γ(Bund, DBun) ∼= Γ(OOp).
(b) For a point x ∈ Op corresponding to a local system Lx the D-module DBun ⊗OOp kx is a

Hecke eigenmodule with respect to the local system Lx.

Our strategy is to ﬁrst establish the result when k has prime characteristic using the result of

[BB] and then formally deduce the characteristic zero case.

3. Hecke functor and filtrations

In this section we introduce a ﬁltration on the image of the free D-module under the Hecke
functor. This is done uniformly in all characteristics by a direct argument independent of [BB]; the
idea is close in spirit to [BD, §5.5].

We now recall the deﬁnition of the Hecke functor corresponding to the tautological representation

of GLn.

QUANTIZATION OF HITCHIN INTEGRABLE SYSTEM

3

Let H be the stack parametrizing inclusions of vector bundles of rank n, E1 ֒→ E2, whose
cokernel is of length one. We deﬁne q1, q2 : H → Bun and qC : H → C by qi : (E1 ⊂ E2) 7→ Ei and
qC : (E1 ⊂ E2) 7→ x where x is determined by the short exact sequence 0 → E1 → E2 → Ox → 0.

We also let Hx = q−1

C (x) and let qx

1 , qx

2 denote the restriction of q1, q2 to Hx. Notice that both

qx
1 and qx

2 are Pn−1 bundles.

The following statement is standard.

Lemma 2. The relative tangent bundles T1, T2 for the maps qx
T1 × T2 → TC,x = Ω∗

1 , qx

C,x.

2 admit a nondegenerate pairing

We let DC denote the sheaf of twisted diﬀerential operators on C corresponding to the line
; here for odd n we use the choice of a square root of the canonical bundle ΩC . We

bundle Ω⊗n/2
let DC , DBun×C denote the corresponding derived categories of twisted D-modules.

C

Using the Lemma it is easy to see that the sum of pull-backs under q1, q2 and qC of the above
twisting classes equals the class of a line bundle (we will use a more precise information about this
class below); thus we can deﬁne the Hecke functor H = (q2 × qC )!q∗

1 : DBun → DBun×C .

Notice that we used smoothness of the Hecke stack to deﬁne the Hecke functor uniformly in all
characteristics, a direct analogue of this deﬁnition for arbitrary reductive group G works for Hecke
functors corresponding to minuscule coweights only.

Let DC ≤n denote the term of the standard ﬁltration by the order of a diﬀerential operator.

Proposition 3. The object H(DBun) lies in the abelian category D-modBun×C. Furthermore, the
DBun×C module H(DBun) admits a canonical map c : DBun×C → H(DBun), such that the restriction
of c to DBun ⊠ (DC )<n is an isomorphism of quasicoherent sheaves.

Proof. The proof uses the category of “asymptotic” D-modules Dh (cf. [L]). Recall that for a smooth
variety X the sheaf of rings Dh(X) is obtained from the ﬁltered sheaf of rings D(X) (diﬀerential
operators on X) by the Rees construction. Thus Dh is a sheaf of graded rings on X with a central
section h, such that D/h is isomorphic to the sheaf OT ∗X , while the localization D(h) is isomorphic
to D(X)[h, h−1], one then considers the (derived) category of sheaves of graded modules. A similar
construction applies to twisted diﬀerential operators on stacks in the sense of [BD]. Notice that
the subcategory of h-torsion free coherent asymptotic D-modules is equivalent to the category of
coherent D-modules equipped with a good ﬁltration.

The push-forward and pull-back functors are deﬁned for ”asymptotic” (twisted) D-modules in
a way compatible with the natural (derived) functor from the category of Dh modules to that of
D-modules (quotient by h − 1), see [L]. Moreover, as shown in loc. cit. the pull-back functor is
compatible under the specialization at h = 0 with the functor between the derived categories of
coherent sheaves on the cotangent bundles given by the natural correspondence; while the push-
forward functor under a proper morphism f : X → Y is compatible with the functor given by the
natural correspondence up to twist by the line bundle KX ⊗ K −1
Y .

This theory can be generalized to smooth algebraic stacks. Notice that in the stack case the
cotangent bundles and/or the relevant ﬁber products may have to be taken in the category of
derived stacks.

We now proceed to spell this out in the present case. Let Hitch = T ∗(Bun). Recall that Hitch
is the stack parametrizing Higgs ﬁelds, i.e. pairs (E, φ) where E is a rank n bundle on C and
φ ∈ H 0(End(E) ⊗ ΩC).

Let HHitch denote the Hitchin Hecke stack parametrizing triples (E1 ⊂ E2, φ) where (E1 ⊂ E2) ∈ H
and φ ∈ H 0(End(E1) ⊗ ΩC ) satisﬁes φ : E2 → E2 ⊗ ΩC . We have pr1, pr2 : HHitch → Hitch,

4

ROMAN BEZRUKAVNIKOV AND ROMAN TRAVKIN

pri : (E1 ⊂ E2, φ) 7→ (Ei, φ|Ei) and prC : HHitch → T ∗(C) sending (E1 ⊂ E2, φ) to (x, ξ) where x and
ξ are determined by Ox ∼= E1/E2, φ − ξ ⊗ IdE2 : E2 → E1 ⊗ ΩC.

The free rank one DBun module equipped with the standard ﬁltration determines an object in
the category of asymptotic DBun-modules on Bun which we denote by ]DBun. Applying the Hecke
functor Hasymp = (q2 × qC )∗q∗
1 to this object (where Hasymp denotes the Hecke functor on the
category of asymptotic D-modules) we get an object ^H(DBun).

Using the above compatibility of pull-back and push-forward functors with the specialization at
k[h] k is given by:

h = 0 and Lemma 2, one checks that the corresponding coherent sheaf ^H(DBun) ⊗L

(1)

^H(DBun)

L
⊗
k[h]

k ∼= (pr2 × prC )∗pr∗

1(OHitch).

Let ˜Cuniv ⊂ Hitch × T ∗(C) be the universal spectral curve, i.e. ˜Cuniv parametrizes the data of

(E, φ; x, ξ) where x ∈ C, ξ ∈ T ∗(C)|x such that det(φ|x − ξ ⊗ Id) = 0.
Lemma 4. We have (pr2 × prC )∗pr∗
Proof. Consider subvarieties S ⊂ gln × A1 and ˜S ⊂ gln × Pn−1 × A1 given by: S = {(x, t) | det(x −
t · Id) = 0}, ˜S = {(x, l, t) | x|l = t · Id}. Let π : ˜S → gln × A1 be the natural projection. It is a
standard fact that

1(OHitch) ∼= O ˜Cuniv

.

(2)

π∗(O ˜S) ∼= OS.

We have a natural ”evaluation” map Hitch × T ∗(C) → (gln × A1)/(GLn × Gm) (where GLn acts
on gln by the adjoint action and Gm acts on A1 by dialtions) and we have natural isomorphisms:

HHitch ∼= (S/(GLn × Gm) ×(gln×A1)/(GLn×Gm) (Hitch × T ∗(C));
˜Cuniv ∼= ( ˜S/(GLn × Gm) ×(gln×A1)/(GLn×Gm) (Hitch × T ∗(C)).

Here both ﬁber products are understood in the derived stacks, thus both formulas are isomor-

phisms of DG-stacks.1

Thus base change isomorphism applies, so Lemma follows from (4).

(cid:3)

Remark 1. Using Koszul resolution one can write down an explicit sheaf of DG-algebras on the
Cartesian product of the two factors in the displayed formulas above, such that its derived category
of sheaves of modules is identiﬁed with the derived coherent sheaves category of the derived ﬁber
product. Thus one can work with these categories without invoking the general theory of DG-stacks.

We are now ready to ﬁnish the proof of the Proposition. Recall that an object M in the derived
category of asymptotic D-modules on a stack X such that the induced object M = M ⊗L
k[h] k ∈
Db(CohGm (T ∗(X)) lies in homological degree zero amounts to a D-module with a good ﬁltration
whose associated graded is isomorphic to M . Thus comparing (1) with Lemma 4 we see that
.
H(DBun) is a D-module with a good ﬁltration whose associated graded is isomorphic to O ˜Cuniv
Since the latter coherent sheaf is cyclic, we see that H(D) is a cyclic D-module with a canonical
generator. Since the sheaf of regular functions on Hitch×T ∗(C) which have degree less than n along
the ﬁbers of projection Hitch × T ∗(C) → Hitch × C maps isomorphically to O ˜Cuniv
, the Proposition
follows.
(cid:3)

1We do not know if this point is essential, i.e. if some of higher T or’s between the structure sheaves of the two
factors over the structure sheaf of the base are nonzero. If this is not the case the isomorphisms can be understood
as isomorphisms of ordinary stacks.

QUANTIZATION OF HITCHIN INTEGRABLE SYSTEM

5

Recall the ring of twisted diﬀerential operators DC introduced after Lemma 2. By an oper we
will understand an O-coherent DC module O of rank n which has a good ﬁltration whose associated
graded is isomorphic gr(DC )<n. Choosing a theta-characteristic (i.e. a square root of the cotangent
bundle) we can identify the category of DC -modules with the category of D-modules and connect
this with the standard deﬁnition of a (marked ) oper. It is standard that opers in this sense are
parametrized by a variety which we will denote Op.

Corollary 5. Assume that M ∈ Db(D-modBun) satisﬁes the Hecke eigenproperty with respect to a
local system L ∈ DC -mod. Assume2 that L has degree (1 − g)n(n − 1) and does not admit an oper
structure. Then

RHomD-modBun (DBun, M ) = 0.

Proof. The proof will proceed by contradiction. Let L be the corresponding local system and set
V := RHomD-modBun(DBun, M ), thus V 6= 0 by assumption.

Consider prC∗(H(M )), the sheaf direct image of the D-module H(M ) under the projection

prC : Bunn × C → C. Then the Hecke eigen-property of M shows that

prC∗(H(M )) ∼= V ⊗ L.

On the other hand, Proposition 3 shows that the object in the derived category of quasicoherent

sheaves oblvD

O(prC∗(H(M ))) satisﬁes:
oblvD

O(prC∗(H(M ))) ∼= V ⊗ (DC )<n.

Comparing the two displayed isomorphisms we see that oblvD

O(L) admits an injective map into
a quasicoherent sheaf with a ﬁltration whose associated graded is a sum Ω⊗i
C (i = 0, . . . , n − 1).
Since an injective map between coherent sheaves on a curve having the same degree and the same
generic rank has to be an isomorphism, we see that L has an oper structure.
(cid:3)

4. Proof of the main theorem in the case char k = p > 0

It is easy to deduce the assertion of the theorem for k from the assertion for the algebraic closure

of k, so we assume for simplicity that k is algebraically closed.

Recall that Hitch = T ∗(Bun) and ˜Cuniv is the universal spectral curve. Let h : Hitch → B be
the Hitchin map and π : ˜Cuniv → B be the projection. Let Br ⊃ Bs be the open subsets in the
Hitchin base B parametrizing the points x ∈ B such that the ﬁber π−1(x) is reduced, respectively,
smooth.

In this section we assume that the base ﬁeld k has prime characteristic p. Then DBun can be

thought of as a sheaf over Hitch(1), where the superscript denotes the Frobenius twist.

Let Loc denote the moduli stack of DC -modules which are locally free of rank n as an O-module.
Recall [BB] that we have the Frobenius-Hitchin map hp : Loc → B(1); for example, for x ∈ Bs the
ﬁber of h over x is the abelian algebraic group P ic( ˜Cx), while the ﬁber of πp over x(1) ∈ B(1)
is the torsor over the abelian algebraic group P ic( ˜Cx)(1) (here x(1) denotes the image of x under
Frobenius).

We will need the following result proven in the Appendix.

2The ﬁrst assumption holds automatically if char(k) = 0. If char(k) = p > 0, then deg(L) = (1 − g)n(n − 1)
mod p, and deg(L) is determined by the character by which Gm acts on the quasicoherent sheaf underlying M (where
we use that Bun is a Gm gerbe over Bun). It is not hard to see that RHomD-modBun (DBun, M ) = 0 automatically
unless deg(L) = (1 − g)n(n − 1).

6

ROMAN BEZRUKAVNIKOV AND ROMAN TRAVKIN

Proposition 6. The composition Op → Loc
d = dim(Bun).

πp−→ B(1) is a ﬂat ﬁnite map of degree pd, where

Set Hitchs = h−1(Bs), Locs = π−1

, where
in the last expression we use the same notation DBun for the object in DBun and the corresponding
sheaf on Hitch(1).

s , (DBun)s = DBun|Hitch(1)

p (B(1)

s ), Ops = Op ×B(1) B(1)

s

Recall that the main result of [BB] is an equivalence3

Db((DBun)s-modcoh) ∼= Db(Coh(Locs)),

where -modcoh stands for the category of coherent sheaves of modules. We let Φ denote that
equivalence.

The ﬁrst step in the proof of the Theorem is the following

Proposition 7. We have Φ((DBun)s) ∼= (Ops → Locs)∗(OOps).
Proof. It is easy to see that the tautological map from the space Op of marked opers to Loc is
a composition of the map Op → Op/Gm and a closed embedding Op/Gm → Loc, where we use
the trivial action of Gm on Op. Thus the direct image of OOp to Loc decomposes as a direct sum
indexed by characters of Gm; we claim that the summand corresponding to the character t 7→ td is
canonically isomorphic to Φ((DBund )s)).

It follows from Corollary 5 that the complex Φ((DBun)s)) is supported on Ops/Gm.
From Proposition 6 we see that its support is ﬁnite over the base B(1). Since Fourier-Mukai
transform is exact on sheaves with ﬁnite support, sending such a sheaf of length r into a vector
bundle of rank r, we see that Φ((DBund )s) is concentrated in homological degree zero; moreover, its
pull-back to Ops is ﬂat of rank pd as a module over OB(1)

We claim that Φ((DBund )s) is scheme theoretically supported on Ops/Gm.
First of all, Φ((DBund )s) is torsion free as an O(B(1)) module. Thus it suﬃces to check this claim

.

s

over the generic point of B(1).

To see this notice that a coherent sheaf on Loc which is generically set theoretically but not
scheme theoretically supported on Op/Gm would need to have length greater than one at the
generic point of Op. Then its direct image to B(1) would have generic rank greater than pd, which
contradicts the second paragraph of the proof.

Now, ﬂatness of Φ((DBund )s) over OB(1)

implies it’s a Cohen-Macaulay module over OOps. Since
equals that of OOps,
Ops is smooth, it is actually a locally free module, since its degree over OB(1)
we conclude that the pull-back of Φ((DBund )s) to Ops is a line bundle on Ops. Since Ops is an open
subvariety in Op which is isomorphic to the aﬃne space, every line bundle on Ops is trivial. Since
Gm acts by the character t 7→ td on the Φ(F ) for F supported on Bund, we get the statement. (cid:3)

s

s

The Proposition implies that for all d ∈ Z

(3)

Ad := Γ(DBund ) ⊂ Γ((DBund )s) ∼= End((DBund )s) ∼= Γ(OOps)

is a commutative algebra.

Fix some d ∈ Z. Proposition 3 allows one to construct a family of opers on C parametrized by
univ with an Ad action and a ﬁltration

Spec(Ad). The family can be described as a DC -module F d

3In fact, this is a version of the equivalence constructed in loc. cit.: there the stack Bun and ordinary D-modules
are considered instead of Bun and twisted D-modules. It is not hard to deduce that version from the result of loc.
cit.

QUANTIZATION OF HITCHIN INTEGRABLE SYSTEM

7

which is ﬂat over Ad and such that F d
univ ⊗Ad kx is an oper for every x ∈ Spec(Ad) and is con-
structed as follows. The sheaf F d
univ is the (sheaf theoretic) direct image to the second factor of the
DBund -module H(DBund−1), equipped with the natural Ad action and the ﬁltration coming from
Proposition 3. The Ad-action is deﬁned by presenting F d
univ as the pushforward to C of the local
Hom from DBund×C = DBund ⊠ DC to H(DBund−1) and using Ad-action on the ﬁrst argument.

Actually the deﬁnition of this action can be generalized to a functor Υ : D-modBund×C → (Ad ⊗
univ = Υ(H(DBund−1)). Applying the functor Υ to the
univ which restricts to
univ. From this it is straightforward to see

DC )-mod given by pushforward to C, and F d
map c from Proposition 3, we get a map Υ(c) : Υ(DBund×C) = Ad ⊗ DC → F d
an isomorphism of Ad ⊗ OC -modules Ad ⊗ (DC )<n → F d
that F d

univ deﬁnes an Ad-family of opers.

Thus we get a map Π : Spec(Ad) → Op. We will show that it is an isomorphism.
It is easy to deduce from the Hecke eigen-property for the equivalence Φ that base-change of
coincides with the (dual of) isomorphism (3). From this we see that the

Π from B(1) to B(1)
composition

s

O(Op) Π∗

−−→ Ad ⊂ Γ((DBund )s)

Prop. 7

∼= O(Ops)

is the natural inclusion. Thus Ad is isomorphic to subalgebra of O(Ops) containing O(Op). Since
Op is normal (it is isomorphic to an aﬃne space), it would suﬃce to show that Ad is ﬁnitely
generated as a module over O(Op). We will in fact prove ﬁnite generation over a smaller algebra.

Lemma 8. Ad is a ﬁnitely generated torsion free module over O(B(1)).

Proof. Consider the ﬁltration on DBun and the induced one on Ad by degree of diﬀerential operator.
Then we have gr DBund = (T ∗Bund → Bund)∗OT ∗Bund . The induced ﬁltration on O(B(1)) ֒→ Ad
coincides with the one coming from the grading on O(B(1)) multiplied by p, and the associated
graded map to this embedding is dual to FrB ◦h : Hitch → B(1). It is known that all global functions
on T ∗Bund are pullbacks from the Hitchin base, so we have Γ(gr DBund ) = O(B). On the other
hand, there is an inclusion gr A ֒→ Γ(gr DBund ) = O(B). Thus gr A identiﬁes with an O(B(1))-
submodule in O(B), therefore it is ﬁnitely generated and torsion-free over O(B(1)). But then so is
Ad, as desired.
(cid:3)

As explained above, the lemma shows that the map Π is an isomorphism, so that for any d we

have a canonical isomorphism

Ad ∼= A := O(Op).

It also follows that F d
all of them.

univ are identiﬁed for all d ∈ Z, so we write Funiv for the sheaf isomorphic to

Lemma 9. The map c : DBund×C = DBund ⊠ DC → H(DBund−1) from Proposition 3 intertwines
the two A-actions coming from the A-action on DBun.

Proof. Since both the source and the target are torsion-free as modules over O(B(1)) ⊂ Z(D-modBun)
(where Z stands for the center of a category, i.e. the ring of endomorphisms of the identity functor),
it is enough to show that the statement of the lemma holds after tensoring by O(Ops) over O(Op).
The localized map cs is a morphism in (D-modBun×C)s, and we can apply Φ in the ﬁrst factor. Then
⊠ DC )-modules
Proposition 7 and Hecke eigen-property of Φ imply that Φ(c) is a map of (OLocs
scheme-theoretically supported on Ops/Gm × C ⊂ Locs × C, and that the elements of A = O(Op)
act by multiplication by the same functions on this support.
(cid:3)

8

ROMAN BEZRUKAVNIKOV AND ROMAN TRAVKIN

4.1. End of proof of Theorem A.1 in the positive characteristic case. Thus we proved the
ﬁrst part of the theorem. The second statement of the theorem follows from the construction of
the morphism Π. Indeed, we need to construct an isomorphism
H(DBun) ∼= DBun ⊠A Funiv,

where we used the following notation: if A is a k-algebra, X, Y are k-schemes (or stacks) and F ,
respectively G, are quasi-coherent sheaves on X, resp. Y , with a right, resp. left, A-actions, then
we deﬁne a quasi-coherent sheaf on X × Y : F ⊠A G := (F ⊠ G) ⊗A⊗Aop A, where the rightmost
symbol A refers to the regular A-bimodule.

We will construct the isomorphism as above for each component Bund of Bun, so ﬁx d ∈ Z.
Consider the functor DBund ⊠A − : (A ⊗ DC )-mod → D-modBund×C, which is the left adjoint to the
“d’th component” of the functor Υ used above. So we have a counit map aM : DBund ⊠A Υ(M ) → M
for any M ∈ D-modBund×C . We need to check that it is an isomorphism for M = H(DBund−1). It
is clear that if we apply the forgetful functor D-modBun×C → D-modBund×C/C to aM then we will
get the counit morphism for the similar adjunction between D-modBund×C/C and (A ⊗ OC )-mod.
Now since locally over C, H(DBund−1) is isomorphic to (DBund ⊠ OC )⊕n as a relative D-module on
Bund × C over C, and our statement is local in C, it suﬃces to check for M = DBund ⊠ OC where
it is clear.

Now, to deduce Hecke eigen-property, we have to show that the constructed isomorphism com-
mutes with the A-action, where the action on H(DBun) comes by transport of structure from the
A-action on DBun and the action on DBun ⊠A Funiv comes from either of the A-actions contracted
by the tensor product. For this we consider the commutative diagram

DBund ⊠ DC == DBund ⊠A Υ(DBund×C )

DBund ⊠AΥ(c)

DBund ⊠A Funiv == DBund ⊠A Υ(H(DBund−1 ))

aD

Bund×C

∼

DBund×C

c

aH(D

Bund−1 )
∼

/ H(DBund−1).

By Lemma 9, the vertical arrows in this diagram commute with the A-action. The top arrow
commutes with the A-action because of the naturality of aM . Hence the bottom arrow does, too,
which is what we need.

What we just proved implies the following in-families version of Hecke eigen-property. The A-
action on the D-module DBun allows to present it as a pushforward of a (Spec A = Op)-family
M of D-modules. Applying to M the relative version of the Hecke functor H, we get a relative
(twisted) D-module on Bun × Op × C over Op which we denote by HOp(M). Then it follows from
what we proved that HOp(M) ∼= (M ⊠ OOp) ⊗ (OBun ⊠ F ′
univ is the Op-family of
opers constructed from Funiv. Taking pullback to a closed point x of Op, we see that the derived
specialization of the family M, Mx := L({x} × Bun → Op × Bun)∗M = DBun ⊗L
A kx is a Hecke
eigen-D-module.

univ) where F ′

We want to show that Mx is actually in the heart of D(Bun). In other words, we want to prove
that DBun is ﬂat over A. Since the A-module DBun is a (ﬂat) deformation of OHitch viewed as a
module over O(B), this follows from ﬂatness of the Hitchin map.
(cid:3)

5. Proof of the main theorem in the case char k = 0

Considering the deformation of OT ∗Bund to DBund we get a spectral sequence

Γ(OT ∗Bund ) = Γ(OB) ⇒ Ad.

/
/




/
QUANTIZATION OF HITCHIN INTEGRABLE SYSTEM

9

Choose a ﬁnitely generated ring R with a homomorphism R → k and a complete curve CR over
R whose base change to k is isomorphic to C. We can form a similar spectral sequence starting
from the moduli stack BunR for vector bundles over CR.
Its base change to a ﬁeld of positive
characteristic degenerates at E1 by the result of the previous section. Hence the spectral sequence
itself, as well as its base change to k, degenerates at E1.

This implies that Ad is commutative for any d, since its base change to any residue ﬁeld of R
of almost every prime characteristic is commutative. Now the construction of the previous section
yields a family of opers parametrized by Spec(Ad), given by Υ(H(DBund−1)) as before. Thus we
get a map Π : Spec(Ad) → Op as explained in the previous section.

Since the base change of Π to a ﬁeld of almost any prime characteristic is an isomorphism, we
see that Π is an isomorphism. This proves the ﬁrst part of Theorem A.1. One then proves an
analogue of Lemma 9 in characteristic 0 by observing that it is enough to prove the statement for
the reductions to ﬁnite residue ﬁelds of R. After that, the second part follows by the argument of
the previous section.

Appendix A. Hitchin map and opers in characteristic p (by Roman Bezrukavnikov,

Tsao-Hsien Chen, and Xinwen Zhu)

This appendix is devoted to the proof of the following statement (Proposition 6 of the main

text):

Theorem A.1. Let OpG be the scheme of G-opers with marking (see §A.3). Then the composition

πp : OpG → LocG

hp−→ B(1)

is ﬁnite and faithfully ﬂat of degree pdim B. Here hp is the p-Hitchin map.

Remark A.2. In the case G = P GLn, the theorem above is a strengthening of a result of C. Pauly
and K. Joshi [JP] who proved that the p-Hitchin map on the space of opers is ﬁnite.

A.1. Notations. Let k be an algebraically closed ﬁeld of characteristic p. Let C be a complete
smooth curve over k. Let G be a connected reductive algebraic group over k of rank l. We denote
by g the Lie algebras of G. We ﬁx a Borel subgroup BG ⊂ G, and let N be its unipotent radical
and T = BG/N . Let Z(G) be the center of G. We denote by Gad = G/Z(G), Bad = BG/Z(G) and
Tad = T /Z(G). We denote the corresponding Lie algebras by b, n and t. We assume that p does
not divide the order of the Weyl group W of G.

A.2. Hitchin map and p-Hitchin map. In this subsection, we recall the deﬁnition of Hitchin
and p-Hitchin map following [N, CZ1].

A.2.1. Hitchin map. Let k[g] and k[t] be the algebra of polynomial function on g and t. By Cheval-
ley’s theorem, we have an isomorphism k[g]G ≃ k[t]W. Moreover, k[t]W is isomorphic to a polyno-
mial ring of l variables u1, . . . , ul and each ui is homogeneous in degree ei. Let c = Spec(k[t]W ).
Let

χ : g → c

be the map induced by k[c] ≃ k[g]G ֒→ k[g]. This is G × Gm-equivariant map where G acts trivially
on c, and Gm acts on c through the gradings on k[t]W. Let L be an invertible sheaf on C and L×
be the corresponding Gm-torsor. Let gL = g ×Gm L× and cL = c ×Gm L× be the Gm-twist of g and
c with respect to the natural Gm-action.

10

ROMAN BEZRUKAVNIKOV AND ROMAN TRAVKIN

Let HiggsG,L = Sect(C, [gL/G]) be the stack of section of [gL/G] over C, i.e., for each k-scheme

S the groupoid HiggsG,L(S) consists of maps over C:

hE,φ : C × S → [gL/G].

Equivalently, HiggsG,L(S) consists of a pair (E, φ) (called a Higgs bundle), where E is a G-torsor
over C × S and φ is an element in Γ(C × S, ad(E) ⊗ L). If the group G is clear from the content,
we simply write HiggsL for HiggsG,L.

Let BL = Sect(C, cL) be the scheme of sections of cL over C, i.e., for each k-scheme S, BL(S) is

the set of sections over C

This is called the Hitchin base of G.

The natural G-invariant projection χ : g → c induces a map

b : C × S → cL.

[χL] : [gL/G] → cL,

which in turn induces a natural map

hL : HiggsL = Sect(C, [gL/G]) → Sect(C, cL) = BL.

We call hL : HiggsL → BL the Hitchin map associated to L.

We are mostly interested in the case L = ω. For simplicity, from now on we denote B = Bω,
Higgs = Higgsω and h = hω, etc. We sometimes also write HiggsG for Higgs to emphasize the group
G.

We ﬁx a square root κ = ω1/2 (called a theta characteristic of C). Recall that in this case,
there is a section ǫκ : B → Higgs of h : Higgs → B, induced by the Kostant section kos : c → g.
Sometimes, we also call ǫκ the Kostant section of the Hitchin ﬁbration.

A.2.2. p-Hitchin map. Let LocG be the stack of G-local system on C, i.e. for every scheme S over k,
LocG(S) is the groupoid of all G-torsors E on C × S together with a connection ∇ : TC×S/S → eTE,
here eTE is the Lie algebroid of inﬁnitesimal symmetry of E. Recall the notion of p-curvature of a
G-local system following [K, Bo]: For any (E, ∇) ∈ LocG the p-curvature of ∇ is deﬁned as

Ψ(∇) : F ∗TC ′ → ad(E),

v → ∇(v)p − ∇(vp).

We regard Ψ(∇) as an element Ψ(∇) ∈ Γ(C, ad(E) ⊗ ωp) and call such a pair an F -Higgs ﬁeld. The
assignment (E, ∇) → (E, Ψ(∇)) deﬁnes a map ΨG : LocG → HiggsG,ωp. Combining this map with
hωp , we get a morphism from LocG to Bωp :

˜hp : LocG → Bωp .

Observe that the pullback along FC : C → C(1) induces a natural map F p : B(1) → Bωp , where
the superscript denotes the Frobenius twist. By [CZ1, Theorem 3.1], the p-curvature morphism
˜hp : LocG → Bωp factors through a unique morphism

hp : LocG → B(1).

We called this map the p-Hitchin map.

The construction of p-Hitchin map can be generalized to λ-connection. Recall that for any λ ∈ k,
a λ-connection on a G-torsor E is an OC -linear map ∇λ : TC → eTE such that the composition
σ ◦ ∇λ : TC → TC is equal to λ · idTC (where σ : eTE → TC is the natural projection). We denote by
LocG,λ the stack of G-bundles on C with λ-connections. Then

LocG,1 = LocG, LocG,0 = HiggsG .

QUANTIZATION OF HITCHIN INTEGRABLE SYSTEM

11

Let (E, ∇λ) ∈ LocG,λ. The p-curvature of ∇λ is deﬁned as

Ψ(∇λ) : F ∗TC ′ → ad(E),

v → ∇λ(v)p − λp−1∇λ(vp).

The map LocG,λ → Bωp , (E, ∇λ) 7→ hωp(E, Ψ(∇λ)) factors through a unique map

hp,λ : LocG,λ → B(1),

called the p-Hitchin map for λ-connections. It is clear that hp,1 = hp and hp,0 = F ◦ h, where
h : Higgs → B is the usual Hitchin map and F : B → B(1) is the relative Frobenius of B. From
this perspective, the p-Hitchin map can be regarded as a deformation of the usual Hitchin map.

A.3. Opers with marking. In this subsection we recall the deﬁnition of opers with marking
following [B]. There is a canonical decreasing Lie algebra ﬁltration {gk} of g

· · · ⊃ g−1 ⊃ g0 ⊃ g1 ⊃ · · ·

such that g0 = b, g1 = n and for any k > 0 (resp. < 0) weights of the action of t = gr0(g) on grk(g)
are sums of k simple positive (resp. negative) roots. In particular, we have gr−1(g) = ⊕gα, where
α is a simple negative root and gα is the corresponding root space.

Let E be a BG-torsor on C and EG (resp. ET ) be the induced G-torsor (resp. T -torsor) on C.
In this subsection, we denote by bE and gEG = gE be the associated adjoint bundles (rather than
ad(E)). Let eTE and eTEG be the Lie algebroids of inﬁnitesimal symmetries of E and EG. There is
a natural embedding eTE → eTEG and we have a canonical isomorphism

For any connection ∇ on EG, we denote by ¯∇ the composition

eTEG/ eTE ≃ (g/b)E =: E ×B (g/b).

¯∇ : TC

∇→ eTEG → eTEG/ eTE ≃ (g/b)E.

Deﬁnition A.3. We ﬁx a square root κ = ω1/2 of the canonical bundle ω. A G-oper on C
with marking is triple (E, ∇, φ) where E is a BG-torsor on C, ∇ is a connection on EG, and
φ : ET ≃ ω1/2 ×Gm,2ρ T is an isomorphism of T -torsor (we call φ the marking), such that

(1) The image of ¯∇ lands in (g−1/b)E ⊂ (g/b)E.
(2) The composition

¯∇→ (g−1/b)E

prα→ (gα)E

TC

is an isomorphism for every simple negative root α. Here
prα : (g−1/b)E = ⊕(gβ)E → (gα)E

is the natural projection.

(3) The condition (2) implies ∇ induces an isomorphism

ET ×T (g1/g2) ≃ ⊕l

i=1(gαi )E

˜φ
→ ω⊕l ≃ (ω1/2 ×Gm,2 ˇρ T ) ×T (g1/g2).

We require the marking φ is compatible with ˜φ.

Notice that if we drop condition (3) in above deﬁnition, then we obtain the deﬁnition of G-opers
in [BD]. As shown in loc. cit., a G-oper has Z(G) as its automorphism group, the additional
condition (3) eliminate these automorphisms (cf.
[B, Proposition 2.1]). We denote by OpG the
scheme of G-opers with marking on C.

12

ROMAN BEZRUKAVNIKOV AND ROMAN TRAVKIN

Remark A.4. When G is of adjoint type, there exits a unique marking φ compatible with ˜φ. Thus,
in this case, the condition (3) is automatic. In general, the conditions (1) and (2) do not imply the
existence of φ, hence we are limiting our collection of opers compared to [BD].

Example A.5. Consider the case G = GLn. Then an oper with marking can be described in
terms of vector bundles as follows: it consists of the data (E, {Ei}i=1,...,n, ∇, φ) where E is a rank
n vector bundle on C, E1 ⊂ E2 ⊂ ·· ⊂ En = E is a complete ﬂag, ∇ is a connection on E, and
φ : E1 ≃ ω(n−1)/2 is an isomorphism, such that

(1) ∇(Ei) ⊂ Ei+1 ⊗ ω.

(2) For each i, the induces morphism gri(E)

gri(∇)

→ gri+1(E) ⊗ ω is an isomorphsim.

One deﬁnes a (G, λ)-oper with marking as before by replacing connection ∇ by λ-connection
∇λ. We denote by OpG,λ the scheme of (G, λ)-opers with marking. Clearly, OpG,1 = OpG and
OpG,0 = B.

All (G, λ)-opers with marking form a scheme, ﬂat over A1, ]OpG → A1, such that the ﬁber of
]OpG over λ ∈ A1(k) is OpG,λ. Moreover, there a Gm-action on ]OpG, given by (E, ∇) 7→ (E, t∇)
and the morphism ]OpG → A1 is Gm-equivariant.

We have a forgetful map OpG,λ → LocSysG,λ, (E, ∇λ, φ) → (EG, ∇λ) and one can check that

(A.1)

B = OpG,0 → LocG,0 = HggsG

is the Kostant section ǫκ induced by κ = ω1/2.
The p-Hitchin map for λ-connections gives

˜πp : ]OpG → B(1) × A1,

(E, ∇λ, φ) → (hp,λ(EG, ∇λ), λ).

The map ˜πp is Gm-equivariant where Gm acts diagonally on B(1) × A1. We denote by πp,λ :
OpG,λ → B(1) the base change of ˜πp to λ ∈ A1(k). When λ = 1, we get a map

(A.2)
and (A.1) implies πp,0 : B = OpG,0 → B(1) is the relative Frobenius morphism F : B → B(1).

πp := πp,1 : OpG → LocG

hp−→ B(1),

Using the well-known identiﬁcation of ﬁltered k-algebras with graded ﬂat k[t]-algebras (cf. [BD,

§3.1.14]), the discussion above implies the following

Lemma A.6. Let π∗
B(1). Then there are ﬁltrations on ROpG and RB(1) such that

p : RB(1) → ROpG be the map of ring of functions corresponding to πp : OpG →

(1) The associated graded gr(ROpG) ≃ RB and gr(RB(1) ) ≃ RB(1) .
(2) π∗
(3) The induced morphism

p is compatible with the ﬁltrations.

gr(π∗

p) : RB(1) → RB

is the relative Frobenius map.

A.4. Proof of Theorem A.1. Let πp : OpG → B(1) be the map in (A.2). We ﬁrst show that
πp is ﬁnite and surjective. I.e., we need to show that π∗
p : RB(1) → ROpG is injective and ROpG
is ﬁnitely generated as an RB(1) -module. Since both rings ROpG and RB(1) are ﬁltered and π∗
p
is compatible with the ﬁltrations, it is enough to show that the associated graded map gr(π∗
p ) :
gr(RB(1) ) → gr(ROpG) is injective and gr(ROpG) is a ﬁnitely generated gr(RB(1) )-module. But this
is clear since by the lemma above gr(π∗
p) is the Frobenius map. Now πp is a ﬁnite map between

QUANTIZATION OF HITCHIN INTEGRABLE SYSTEM

13

OpG and B(1), which are smooth of the same dimension, and therefore it is ﬂat. In addition, as the
relative Frobenius map B → B(1) is of degree pdim B, so is πp.

Remark A.7. Lemma A.6 shows that the map πp : OpG → B(1) is a deformation of the Frobenius
morphism F r : B → B(1).
In the special case when G = GL(1) it is not hard to see that one
can identify OpGL(1) with B = H 0(ω) so that the morphism πp is identiﬁed with F r − C where
C : H 0(ω) → H 0(ω)(1) is the map induced by Cartier isomorphism. In particular, πp is purely
inseparable if and only if C is supersingular. It would be interesting to obtain a similar explicit
description of the map πp for nonabelian G.

References

[Bo]

[B]
[BD]

J.B. Bost: Algebraic leaves of algebraic foliations over number ﬁelds, Publ. Math. Inst. Hautes ´Etud. Sci.
No. 93 (2001), 161-221.
J. Barlev: Opers, seminar note, available at http://www.math.harvard.edu/˜gaitsgde/.
A. Beilinson, V. Drinfeld Quantization of Hitchin integrable system, preprint available at:
http://www.math.uchicago.edu/˜mitya/langlands/hitchin/BD-hitchin.pdf

[BDop] A. Beilinson, V. Drinﬂed, Opers, preprint arXiv:math/0501398.
[BB]

the GL(n) case, Pure Appl. Math. Q. 3 (2007), no. 1, Special Issue:

R. Bezrukavnikov, A. Braverman, Geometric Langlands correspondence for D-modules in prime charac-
teristic:
In honor of Robert D.
MacPherson. Part 3, 153–179.
T.H. Chen, X. Zhu Geometric Langlands in prime characteristic, preprint arXiv:1403.3981, accepted to
publish in Compositio Math.
T.H. Chen, X. Zhu, Non-abelian Hodge theory for algebraic curves in characteristic p, Geometric and
Functional Analysis 25 (2015), no 6, pp 1706–1733.
K. Joshi, C. Pauly: Hitchin-Mochizuki morphism, Opers and Frobenius-destabilized vector bundles over
curves, arXiv:0912.3602.
N. Katz: Nilpotent connections and the Monodromy Theorem, Publ. Math. Inst. Hautes ´Etud. Sci. No. 39
(1970), 175-232.
M. Groechenig, Moduli of ﬂat connections in positive characteristic, preprint arXiv:1201.0741.
G. Laumon, Sur la cat´egorie d´eriv´ee des D-modules ﬁltr´es, Algebraic geometry (Tokyo/Kyoto, 1982), 151–
237, Lecture Notes in Math., 1016, Springer, Berlin, 1983.
B.C. Ngˆo: Le lemme fondamental pour les alg`ebres de Lie, Publ. Math. Inst. Hautes ´Etud. Sci. No. 111
(2010), 1-169.

[CZ]

[CZ1]

[JP]

[K]

[Gr]
[L]

[N]

R.B.: Department of Mathematics, Massachusetts Institute of Technology, Cambridge MA 02139, USA
bezrukav@math.mit.edu

R.T.: School of Mathematics, Institute for Advanced Study, 1 Einstein Dr., Princeton, NJ 08540 USA
travkin@alum.mit.edu

T.-H.C.: Department of Mathematics, Northwestern University, 2033 Sheridan Road, Evanston, 60208, USA
chenth@math.northwestern.edu

X.Z.: Department of Mathematics, California Institute of Technology, 1200 E. California Blvd., Pasadena, CA
91125, USA
xzhu@caltech.edu

