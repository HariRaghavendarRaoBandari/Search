RESTRICTION ESTIMATES USING POLYNOMIAL PARTITIONING II

LARRY GUTH

Abstract. We improve the estimates in the restriction problem in dimension n ≥ 4. To do
so, we establish a weak version of a k-linear restriction estimate for any k. This weak k-linear
estimate is essentially sharp for all k and n.

6
1
0
2

 
r
a

 

M
4
1
 
 
]

.

A
C
h
t
a
m

[
 
 

1
v
0
5
2
4
0

.

3
0
6
1
:
v
i
X
r
a

1. Introduction

Let E denote the extension operator for the paraboloid. Viewed as an oscillatory integral opera-
tor, we can write E in the following way. If Bn−1 denotes the unit ball in Rn−1 and f : Bn−1 → C
is a function, and x ∈ Rn, then we deﬁne

(1.1)

ei(x1ω1+...+xn−1ωn−1+xn|ω|2)f (ω)dω.

Ef (x) :=ZBn−1

Stein [S] conjectured that the extension operator should obey the inequality kEf kLp(Rn) .
kf kLp(Bn−1) for all p > 2 · n
n−1 . We prove new partial results towards this conjecture in dimension
n ≥ 4. The best previous estimate was proven by Bourgain and the author in [BG]. The polynomial
partitioning approach to the restriction problem was introduced in [G], which gave new bounds in
dimension n = 3. The present paper combines this idea with the multilinear approach from [BG].

Theorem 1.1. For n ≥ 2, the operator E obeys the estimate

(1.2)

if

(1.3)

(1.4)

kEf kLp(Rn) . kf kLp(Bn−1),

p > 2 ·

3n + 1
3n − 3

for n odd .

p > 2 ·

3n + 2
3n − 2

for n even .

This estimate is the best current estimate for n ≥ 4. For n = 4, Theorem 1.1 gives the range
p > 2.8. The best previous estimate was p > 3, proven by Tao in [T2] (and with a diﬀerent proof
in [BG]). For large n, our lower bound for p is 2 + 8
3 n−1 + O(n−2). The best previous estimate
([BG]) gave a lower bound of the form 2 + 3n−1 + O(n−2).

The new ingredient of our argument has to do with algebraic structure. Roughly speaking, the
argument shows that if kEf kLp is large, then the region where |Ef | is large has some algebraic
structure – it must be organized into thin neighborhoods of low degree algebraic varieties. Exploiting
this structure leads to improved bounds on kEf kLp.

1

2

LARRY GUTH

We ﬁnd this algebraic structure using the tool of polynomial partitioning, which was introduced
by Nets Katz and the author in [GK]. The paper [GK] proves that if a set of lines in R3 has many
intersection points, then the lines must be organized into a small number of low degree algebraic
surfaces. The technique builds on Dvir’s solution of the ﬁnite ﬁeld Kakeya problem [D] and on
the cutting method from combinatorial geometry, introduced by Clarkson, Edelsbrunner, Guibas,
Sharir, and Welzl [CEGSW]. The ﬁrst applications of polynomial partitioning were in combina-
torics, but Wolﬀ applied the cutting method to Fourier analysis in [W2] and [W3], suggesting the
applications we pursue here.

Theorem 1.1 follows from a weak version of a k-linear restriction estimate. To describe k-linear
estimates, we ﬁrst recall some basic facts about wave packet decompositions. Suppose we want to
study Ef on a large ball BR ⊂ Rn. We decompose the domain Bn−1 into balls θ of radius R−1/2.
Then we decompose f in the form

fθ,v,

f =Xθ,v

where fθ,v is supported in θ and has Fourier transform essentially supported in a ball around v of
radius R1/2. In the sum, θ ranges over our set of ﬁnitely overlapping balls covering Bn−1 and v
ranges over R1/2Zn−1. For each pair (θ, v), the restriction of Efθ,v to BR is essentially supported
on a tube Tθ,v with radius R1/2 and length R. The direction of this tube depends only on θ, and
we denote it by G(θ) ∈ Sn−1.

We can now describe multilinear restriction estimates. Given subsets U1, ...., Uk ⊂ Bn−1, we say
that they are transverse if, for any choice of θj ⊂ Uj, the directions G(θ1), ..., G(θk) are quantita-
tively transverse in the sense that

(1.5)

|G(θ1) ∧ ... ∧ G(θk)| & 1.

Building on important work of Wolﬀ [W1], Tao [T2] proved a sharp bilinear estimate for the

extension operator E.

Theorem 1.2. (2-linear restriction, [T2]) If U1, U2 ⊂ Bn−1 are transverse, and fj is supported in
Uj, then

(1.6)

for p ≥ 2 · n+2
n .

2

Yj=1

(cid:13)(cid:13)(cid:13)(cid:13)(cid:13)(cid:13)

|Efj|1/2(cid:13)(cid:13)(cid:13)(cid:13)(cid:13)(cid:13)Lp(BR)

. Rǫ

2

Yj=1

kfjk1/2

L2(Bn−1)

By an argument of Tao, Vargas, and Vega, [TVV], this bilinear estimate implies that kEf kLp(BR) .

Rǫkf kLp(Bn−1) in the same range p ≥ 2 · n+2
n .

(By the ǫ-removal theorem ([T1]), if E obeys the estimate kEf kLq(BR) . Rǫkf kLq , then kEf kLp(Rn) .

kf kLp for all p > q.)

A few years later, Bennett, Carbery, and Tao [BCT] proved a sharp n-linear estimate for E.

Theorem 1.3. (n-linear restriction, [BCT]) If U1, ..., Un ⊂ Bn−1 are transverse, and fj is sup-
ported in Uj, then

RESTRICTION ESTIMATES USING POLYNOMIAL PARTITIONING II

3

(1.7)

for p ≥ 2 · n

n−1 .

n

Yj=1

(cid:13)(cid:13)(cid:13)(cid:13)(cid:13)(cid:13)

|Efj|1/n(cid:13)(cid:13)(cid:13)(cid:13)(cid:13)(cid:13)Lp(BR)

. Rǫ

n

Yj=1

kfjk1/n

L2(Bn−1)

This theorem is important and remarkable in part because it involves the sharp exponent for the
restriction problem: p > 2 · n
n−1 . The paper [BG] gives a technique to exploit multilinear restric-
tion estimates in order to get improved estimates on the original restriction problem. Since then,
multilinear restriction has had many applications, including the striking recent work of Bourgain
and Demeter on decoupling (see [BD] and many followup papers).

Given this 2-linear estimate and this n-linear estimate, it is natural to try to prove a k-linear
estimate for all 2 ≤ k ≤ n which would include these two estimates as special cases. Here is what
looks to me like the natural conjecture, which I ﬁrst learned from Jonathan Bennett.

Conjecture 1.4. (k-linear restriction) If U1, ..., Uk ⊂ Bn−1 are transverse, and fj is supported in
Uj, then

(1.8)

for p ≥ ¯p(k, n) := 2 · n+k

n+k−2 .

k

Yj=1

(cid:13)(cid:13)(cid:13)(cid:13)(cid:13)(cid:13)

|Efj|1/k(cid:13)(cid:13)(cid:13)(cid:13)(cid:13)(cid:13)Lp(BR)

. Rǫ

k

Yj=1

kfjk1/k

L2(Bn−1)

For 3 ≤ k ≤ n − 1, this conjecture is open. The only progress on it is a very recent paper of
Bejenaru [Be]. In [Be], Bejenaru proves a 3-linear estimate of this form for the extension operators
of a class of curved hypersurfaces. The hypersurfaces he studies are foliated by 2-planes, which he
exploits in the proof.

The main new result of this paper is a weak version of Conjecture 1.4, which we call a k-broad
restriction inequality. To motivate this inequality, we consider the left-hand side of (1.8). Suppose
that B is a small ball in BR, and that all the wave packets that pass through B are pointing in
directions that lie in a small neighborhood of a (k − 1)-plane. These wave packets cannot come
from all k of the functions Efj: one of the functions Efj must vanish on B, and so B contributes
nothing to the left-hand side of (1.8). In a k-broad estimate, for each small ball B, we discount the
contributions of wave packets near to a few (k − 1)-planes. Here is the precise setup.

Following [BG], we decompose Bn−1 into balls τ of radius K −1, where K is a large constant.
This decomposition is much coarser than the decomposition into balls θ of radius R−1/2. We write

f =Pτ fτ where fτ is supported in τ . We will study the interaction between the diﬀerent Efτ . We

let G(τ ) = ∪θ⊂τ G(θ). The set G(τ ) ⊂ Sn−1 is a spherical cap with radius ∼ K −1, representing the
possible directions of wave packets in Efτ . If V ⊂ Rn is a subspace, then we write Angle(G(τ ), V )
for the smallest angle between any non-zero vectors v ∈ V and v′ ∈ G(τ ).

Next we decompose BR into much smaller balls. In our argument it is convenient to use balls of
radius K 2. (The paper [BG] uses balls of radius K, and that would also work here.) For each ball
|Efτ |p for every τ . We discount the contributions of fτ with G(τ )
lying near to a few (k − 1)-planes, and we record the largest remaining contribution. More formally,
for a parameter A, we deﬁne

BK 2 ⊂ BR, we consider RBK2

4

LARRY GUTH

(1.9)

µEf (BK 2) :=

V1,...,VA (k − 1)-subspaces of Rn 

min

τ :Angle(G(τ ),Va)>K−1 for all aZBK2

max

|Efτ |p! .

We can now deﬁne the k-broad part of kEf kLp(BR) by:

(1.10)

kEf kp

BLp

k,A(BR) := XBK2 ⊂BR

µEf (BK 2).

We can now state our main new result.

Theorem 1.5. For any 2 ≤ k ≤ n, and any ǫ > 0, there is a large constant A so that the following
holds (for any value of K):

(1.11)

for p ≥ ¯p(k, n) = 2 · n+k

n+k−2 .

kEf kp

k,A(BR) .K,ǫ Rǫkf kL2(Bn−1),

BLp

Theorem 1.5 is a weak version of Conjecture 1.4. In particular, when k = 2, Theorem 1.5 follows
from Theorem 1.2, and when k = n, Theorem 1.5 follows from Theorem 1.3. For 3 ≤ k ≤ n − 1,
Theorem 1.5 is new.

The paper [BG] gives a technique for converting multilinear restriction estimates into linear
restriction estimates. From the point of view of this technique, the k-broad inequality in Theorem
1.5 is just as good as the k-linear inequality in Conjecture 1.4. Using this technique, Theorem 1.5
implies the restriction estimate in Theorem 1.1.

The deﬁnition of BLp

k,A is a little complex, so we pause to emphasize its good features.

• If all the wave packets of Efθ,v that intersect a ball BK 2 have direction G(θ) near a (k − 1)-
. This is one of the main good features

plane, then BK 2 contributes nothing to kEf kBLp
of the k-linear setup and we still have it in the k-broad setup.

k,A

• While BLp

k,A is not literally a norm, it has some similar properties (which is why we use
k,A obeys the following weak version of the triangle

the norm notation). In particular, BLp
inequality: if f = g + h, then

(1.12)

kEf kBLp

k,A(BR) . kEgkBLp

k,A/2(BR) + kEhkBLp

k,A/2(BR).

The reason for introducing the parameter A is to use this version of the triangle inequality.
If we choose A(ǫ) very large, then we can eﬀectively use the triangle inequality Oǫ(1) times
during our proof, and so BLp

k,A behaves almost like a norm.

The range of exponents p in Theorem 1.5 is sharp. Next we discuss some examples.
In one example, the wave packets Efθ,v concentrate in the R1/2-neighborhood of a k-plane. We
denote this neighborhood by W . Each wave packet Efθ,v has |Efθ,v(x)| ∼ 1 on the tube Tθ,v,
and rapidly decaying outside Tθ,v.
It is not hard to arrange that each point in the slab W lies
in many wave packets Tθ,v, pointing in many directions within the k-plane. For each ball BK 2
in the slab, only a tiny fraction of the wave packets through this ball lie near to any (k − 1)-
plane. In this scenario, kEf kBLp
k,A(BR) ∼ kEf kLp(BR). Also, if we choose random phases, then

|Ef (x)|2 ∼ Pθ,v |Efθ,v(x)|2 at most points x. We can distribute the wave packets evenly so

RESTRICTION ESTIMATES USING POLYNOMIAL PARTITIONING II

5

that |Ef (x)| is roughly constant on the slab. Moreover, by a standard orthogonality argument
kEf kL2(BR) ∼ R1/2kf kL2. Therefore, we get

kEf kBLp

k,A(BR)

kf kL2

∼ R1/2 kEf kLp(BR)
kEf kL2(BR)

∼ R1/2|W |

1

p − 1
2 .

Since |W | ∼ RkR(1/2)(n−k), a short calculation shows that the ratio kEf kLp(BR)/kf kL2 is bounded
for p ≥ ¯p(k, n) and blows up for p < ¯p(k, n).

But there are also more complicated sharp examples, coming from low degree algebraic varieties.
This type of example was ﬁrst pointed out to me by Josh Zahl. For instance, consider the quadric
hypersurface Z ⊂ R4 deﬁned by

(x1/R)2 + (x2/R)2 − (x3/R)2 − (x4/R)2 = 1.

Each point of Z lies in a 1-parameter family of lines in Z, and the union of these lines form a
2-dimensional cone. For example, the point (R, 0, 0, 0) lies in the cone deﬁned by

x1 = R; (x2/R)2 − (x3/R)2 − (x4/R)2 = 0.

If we take the R1/2-neighborhoods of lines in Z, we can ﬁnd many tubes in the R1/2-neighborhood
of Z. We can now build an example like the one above using wave packets concentrated in the
R1/2-neighborhood of Z. For each ball BK 2 in this neighborhood, the wave packets through BK 2
ﬁll out a 2-dimensional cone, and very few of them lie near any 2-dimensional plane. Therefore,
kEf kBLp
3,A(BR) ∼ kEf kLp(BR). The rest of the discussion in the planar slab example applies here
also, and so we see that this example is sharp for Theorem 1.5 in dimension 4 with k = 3.

For larger n, there are more variations on this example. The variety Z may be a hypersurface
or it may have larger codimension. For each n, the degree of Z in the known examples is bounded
in terms of n, but it can be larger than 2. Similar examples apply to Conjecture 1.4.

These examples help to suggest that algebraic varieties could be relevant to Theorem 1.5. Poly-
nomial partitioning is a tool that helps us to ﬁnd and exploit the type of algebraic structure in
these examples. If we run through the proof of Theorem 1.5 on this last example, the argument
will ﬁnd the variety Z.

2. Sketch of the proof

In this section, we sketch the proof of the k-broad estimate, Theorem 1.5. We actually give two
sketches. The ﬁrst sketch aims to show the main ideas of the argument. The second sketch brings
into play more of the technical issues, and it provides a detailed outline of the argument in the
paper.

The proof begins with a wave packet decomposition. We decompose the domain Bn−1 into balls

θ of radius R1/2. We then decompose the function f : Bn−1 → C as

fθ,v,

f =Xθ,v

where fθ,v is supported on θ and the Fourier transform of fθ,v is essentially supported on a ball of
radius R1/2 around v. In the sum, v ranges over R1/2Zn−1. On BR, Efθ,v is essentially supported
on a tube Tθ,v of radius R1/2 and length R. In addition, the functions fθ,v are essentially orthogonal.
In particular, we have

6

(2.1)

Our goal is to prove that

LARRY GUTH

kf k2

L2 ∼Xθ,v

kfθ,vk2

L2.

(2.2)

kEf kBLp

k,A(BR) ≤ C(ǫ)Rǫkf kL2 for p = ¯p(k, n) :=

2(n + k)
n + k − 2

.

The proof will be by induction. So we assume that 2.2 holds for balls of smaller radii, and in

lower dimension.

Recall that

kEf kp

BLp

k,A(BR) = XBK2 ⊂BR

µEf (BK 2 ),

where µEf (BK 2) was deﬁned in (1.9). We can extend µEf to be a measure on BR, making it a
constant multiple of the Lebesgue measure on each BK 2. In particular µEf (BR) = kEf kp
k,A(BR).
We now introduce polynomial partitioning. We let D be a large constant that we can choose
later. For a polynomial P on Rn, we write Z(P ) for the zero set of P . By Theorem 1.4 in [G], there
is a (non-zero) polynomial P of degree at most D on Rn, so that Rn \ Z(P ) is a disjoint union of
∼ Dn open cells Oi, and the measures µEf (Oi) are all equal.

BLp

Next we consider how the wave packets Efθ,v interact with this partition. We note that a line
can cross Z(P ) at most D times, and so a line can enter at most D + 1 of the ∼ Dn cells Oi. The
tube Tθ,v can still enter many or all cells Oi, so we make the following modiﬁcation. We deﬁne W
to be the R1/2-neighborhood of Z(P ), and we deﬁne O′
i, then
the axis of Tθ,v must enter Oi, and so we get

i to be Oi \ W . If a tube Tθ,v enters O′

(2.3)

We now have

Each tube Tθ,v enters at most D + 1 cells O′
i.

µEf (BR) =Xi

µEf (O′

i) + µEf (W ).

We say that we are in the cellular case when the contribution of the cells dominates and in the
algebraic case when the contribution of W dominates. If we are in the cellular case, then there
must be ∼ Dn cells O′

i so that

(2.4)

Next we study Ef on each of these cells O′

kEf kp

BLp

k,A(BR) . DnµEf (O′
i).
i. We deﬁne fi by

(2.5)

fi := Xθ,v:Tθ,v ∩O′

i6=∅

fθ,v.

Since Efθ,v is essentially supported on Tθ,v, we see that Efi is almost equal to Ef on O′
µEfi (O′

i. Therefore,
i) using induction – since fi involves fewer wave

i). Now we study the µEfi(O′

i) ∼ µEf (O′

RESTRICTION ESTIMATES USING POLYNOMIAL PARTITIONING II

7

packets than f , it is a simpler object, and so it makes sense to assume by induction that our theorem
holds for fi. This leads to the following bound:

(2.6)

µEf (O′

i) ∼ µEfi(O′

i) ≤ kEfikp

k,A(BR) . [C(ǫ)Rǫ]p kfikp
L2.

BLp

Next we analyze kfikL2. By the orthogonality of the fθ,v, we have

Xi

kfik2

L2 ∼Xi Xθ,v:Tθ,v ∩O′

i6=∅

kfθ,vk2

L2 ∼Xθ,v

|# cells O′

i so that Tθ,v ∩ O′

i 6= ∅| · kfθ,vk2

L2.

By (2.3), each tube Tθ,v enters . D cells O′

i, and so we get

Since there are ∼ Dn cells O′

i that obey (2.4), we see that most of them must also obey

Xi

kfik2

L2 . DXθ,v

|kfθ,vk2

L2 ∼ Dkf k2

L2.

(2.7)

kfik2

L2 . D1−nkf k2

L2.

Combining this bound with (2.4) and our inductive assumption (2.6), we get

kEf kp

BLp

k,A(BR) ≤hCDn+(1−n) p

2i [C(ǫ)Rǫ]pkf kp

L2.

In this equation, the constant C is the implicit constant from the various .’s. It does not depend
on D. The induction closes as long as the term in brackets is ≤ 1. Since we can choose the constant
D, we can arrange that the induction closes as long as the exponent of D is negative. Given our
value of p, we can check that the exponent of D is ≤ 0, and the induction closes (with a little extra
work if the exponent is zero). In fact, the exponent works out in our favor in the whole range of
Stein’s conjecture: p > 2 · n

n−1 .

Now we turn to the algebraic case. In this case, the measure µEf is concentrated in W – the
R1/2-neighborhood of Z(P ) - a degree D algebraic variety of dimension n − 1. There are two types
of wave packets that contribute to µEf on W , which we describe roughly as follows:

• Tangential wave packets: wave packets that are essentially contained in W . For these

wave packets, the direction of the tube Tθ,v is (nearly) tangent to Z = Z(P ).

• Transverse wave packets: wave packets that cut across W .

We ﬁrst discuss the case that the tangential wave packets dominate. To simplify the exposition,
let us imagine for the moment that the variety Z is a hyperplane, so W is a planar slab of dimensions

R1/2 × R × ... × R. We can also imagine that f has the form f =P fθ,v, where all the tubes Tθ,v

are contained in W .

We study this case using induction on the dimension.

In the tangential algebraic case, the
behavior of Ef on the hyperplane Z can be controlled by applying Theorem 1.5 in dimension n − 1.
Here is one way to set this up. There is a standard L2 estimate giving

(2.8)

kEf kL2(BR) . R1/2kf kL2.

It is not hard to reduce Theorem 1.5 to the case that kEf kL2(BR) ∼ R1/2kf kL2, and so we can
think of Theorem 1.5 in the equivalent form

8

LARRY GUTH

We can apply Theorem 1.5 in dimension n − 1 to study Ef on Z, and we get the estimate

kEf kBLp

k,A(BR) . R−1/2+ǫkEf kL2(BR).

kEf kBL ¯p(k,n−1)

k,A

(Z∩BR) . R−1/2+ǫkEf kL2(Z∩BR).

Now ¯p(k, n − 1) > ¯p(k, n) = p. Interpolating between this estimate and the L2 estimate (2.8),

we get a bound of the form

kEf kBLp

k,A(Z∩BR) . R−1/2+e+ǫkEf kL2(Z∩BR),

for p = ¯p(k, n), where e is an exponent depending on k, n. The same estimate holds not just for
Z but for any translate of Z in the slab W . These estimates control the behavior of Ef in the
directions tangent to Z.

To get a good estimate in the tangential algebraic case, we also have to control the behavior
of Ef in the direction transverse to Z. We will show that there is a direction transverse to the
hyperplane Z so that |Ef (x)| is morally constant as we move x in this direction for distance . R1/2.
We call this behavior a transverse equidistribution estimate. It implies that

kEf k2

L2(BR) ∼ kEf k2

L2(W ) ∼ R1/2kEf k2

L2(Z∩BR), and

kEf kp

k,A(BR) ∼ kEf kp

BLp

k,A(W ) ∼ R1/2kEf kp

BLp

BLp

k,A(Z∩BR).

Using these estimates, we can control kEf kBLp

k,A(BR) by induction on the dimension:

kEf kp

k,A(BR) ∼ kEf kp

BLp

k,A(W ) ∼ R1/2kEf kp

BLp

BLp

k,A(Z∩BR)

L2(Z∩BR) ∼ R1/2R(−1/2+e+ǫ)p(cid:16)R−1/2kEf k2

L2(BR)(cid:17)p/2

.

. R1/2R(−1/2+e+ǫ)pkEf kp

There are a lot of messy powers of R in this computation. But plugging in p = ¯p(k, n) and
k,A(BR) . R−1/2+ǫkEf kL2(BR) . Rǫkf kL2, which closes
n+k−2 is exactly the

working out the exponent, one gets kEf kBLp
the induction in the tangential algebraic case. The exponent p = ¯p(k, n) = 2 · n+k
exponent needed to make the powers of R work out in this computation.

Next we sketch the reason for this transverse equidistribution. From the deﬁnition of E, we see

that Efθ,v has Fourier transform supported in a ball of radius R−1/2 around

ξ(θ) = (ωθ,1, ..., ωθ,n−1, |ωθ|2),

where ωθ denotes the center of θ. We know that all the wave packets Efθ,v in Ef are supported in
tubes Tθ,v ⊂ W . This situation restricts the directions G(θ), which in turn restricts the frequencies
ξ(θ), which leads to the transverse equidistribution estimate. The connection between G(θ) and
ξ(θ) is simplest for a slightly diﬀerent operator - the extension operator for the sphere. In that
case, G(θ) = ξ(θ). Since the tubes Tθ,v all lie in W , the directions G(θ) all lie in the R−1/2-
neighborhood of the subspace V ⊂ Rn parallel to Z. Therefore, the frequencies ξ(θ) all lie in
the R−1/2-neighborhood of V also. So the Fourier transform of Ef is supported in the R−1/2-
neighborhood of V . If ℓ denotes a line perpendicular to V (or to Z), then the restriction of Ef to ℓ
has Fourier transform supported in a ball of radius R−1/2. Therefore, |Ef | is morally constant as
we move along the line ℓ for distances . R−1/2.

RESTRICTION ESTIMATES USING POLYNOMIAL PARTITIONING II

9

For the extension operator for the paraboloid, the situation is similar but a touch messier. We
know that the directions G(θ) all lie in the R−1/2-neighborhood of the plane V . A short calculation
shows that the frequencies ξ(θ) all lie in the R−1/2-neighborhood of an aﬃne hyperplane V ′. The
hyperplane V ′ is not equal to V , but the angle between V and V ′ is fairly small. If ℓ is perpendicular
to the plane V ′, then it still follows that |Ef | is morally constant as we move along ℓ for distances
. R−1/2. The line ℓ is no longer exactly perpendicular to the original plane Z, but it is still
quantitatively transverse to Z, and this is good enough for our application.

In this sketch, we assumed that Z is a hyperplane. But in the real proof we cannot assume this.
We have to set up the induction on dimension in a diﬀerent way, taking into account the possibility
that Z is curved. We explain this in the next subsection.

Finally, it can happen that the transverse wave packets dominate. In this last case, µEf (W )
dominates µEf (BR), but the wave packets transverse to W make the main contribution to µEf (W ).

In this case, we can imagine that f =P fθ,v where each tube Tθ,v is transverse to W . Recall that

the number of times a line can cross the hypersurface Z is ≤ D . 1. Similarly, we will prove that
the number of times a tube Tθ,v can cross the surface W is . 1. (This is trivial in the special case
that Z is a hyperplane, but we will prove that it holds in general.)

In this case, we subdivide the ball BR into smaller balls Bj with radius ρ ≪ R. A tube Tθ,v
enters ∼ (R/ρ) ≫ 1 of these balls. But because of the discussion above, a tube Tθ,v can cross W
transversely in . 1 balls Bj. We deﬁne

Tj,trans := {(θ, v)|Tθ,v crosses W transversely in Bj},

fj,trans := X(θ,v)∈Tj,trans

fθ,v.

Since a tube Tθ,v can cross W transversely in . 1 balls Bj, each (θ, v) belongs to . 1 sets

Tj,trans. Therefore,

(2.9)

Xj

kfj,transk2

L2 . kf k2

L2.

Since we assumed that all the wave packets in f intersect W transversely, Efj,trans is essentially

equal to Ef on W ∩ Bj. Therefore,

Since we are in the algebraic case, and since we assumed that all the tubes Tθ,v intersect W

transversely, we have

µEf (W ∩ Bj) ≤ µEfj,trans (Bj).

(2.10)

µEf (BR) . µEf (W ) ∼Xj

µEf (W ∩ Bj) .Xj

µEfj,trans (Bj).

By induction on the radius, we can assume that

L2.
Plugging this bound into (2.10) and then applying (2.9), we get

µEfj (Bj) ≤ [C(ǫ)ρǫ]p kfj,transkp

10

LARRY GUTH

Since p > 2, we get Pj kfj,transkp

kEf kp

BLp

k,A(BR) . [C(ǫ)ρǫ]pXj
L2 ≤ (Pj kfj,transk2

kEf kp

k,A(BR) . [C(ǫ)ρǫ]p kf kp
L2.

BLp

kfj,transkp

L2.

L2)p/2 . kf kp

L2. Therefore, we have

Since (R/ρ) is large, Cρǫ < Rǫ, and so this closes the induction in the transverse algebraic case.

2.1. Studying wave packets tangent to a variety. In the preceding sketch, we considered the
special case that the variety Z is a hyperplane. In this special situation, the tangential algebraic
case reduces to the original theorem in dimension n− 1. In the full proof we need to consider curved
varieties Z, and so we have to do the induction on the dimension in a diﬀerent way.

If Z is an m-dimensional variety in Rn, then we say that the tube Tθ,v is α-tangent to Z in BR

if the following two conditions hold:

• Distance condition:

• Angle condition: If z ∈ Z ∩ NαR(Tθ,v), then

Tθ,v ⊂ NαR(Z) ∩ BR.

For each dimension m, we will choose an angle αm slightly larger than R−1/2, and then we deﬁne

Angle(TzZ, G(θ)) ≤ α.

Our main technical result is Proposition 8.1. It says that if Z is an m-dimensional variety of

TZ := {(θ, v) : Tθ,v is αm-tangent to Z in BR}.

fθ,v, then (for a range of exponents p ≥ 2),

controlled degree, and if f =P(θ,v)∈TZ

kEf kBLp

k,A(BR) ≤ M kf kL2,

where M is a fairly complicated expression which depends on the parameters of the setup, including
the exponent p, the radius R, the dimension m, the value of A, etc.

In this case, kEf kBLp

The proof of Proposition 8.1 is by induction on the dimension m. The base of the induction
is the case m = k − 1.
k,A(BR) is negligibly small. To see this, consider a
small ball BK 2 . The function Ef is essentially supported in NR1/2(Z) ∩ BR, so we can assume
BK 2 ⊂ NR1/2(Z) ∩ BR. Because of the angle condition, all the wave packets Tθ,v ∈ TZ that pass
through BK 2 have direction G(θ) within a small angle of an (k − 1)-plane – the plane TzZ for a
point z ∈ Z near to BK 2. But now, by the ﬁrst key point about the deﬁnition of BLp
k,A, the ball
BK 2 makes a negligible contribution to kEf kBLp

. This provides the base of the induction.

k,A

The proof of Proposition 8.1 follows the rough outline of our ﬁrst sketch. We again use polynomial
partitioning. Under the hypotheses of the proposition, we know that Ef is essentially supported in
NR1/2(Z) for a given m-dimensional variety Z. We want to ﬁnd a polynomial P so that Z(P ) cuts
NR1/2(Z) into smaller cells. To do this, we choose new orthogonal coordinates y1, ..., yn so that the
projection of Z to the (y1, ..., ym)-plane is non-degenerate on a signiﬁcant portion of Z. Then we let
P be a polynomial in y1, ..., ym. In this case, Z(P ) intersects Z transversely (at least on a signiﬁcant
portion of Z), and this makes the polynomial partitioning work. Essentially everything works as in
the ﬁrst sketch, except that because P depends on only m variables, the number of cells Oi is only
∼ Dm. This will aﬀect the ﬁnal exponents, but the method of the argument is the same. If µEf is

RESTRICTION ESTIMATES USING POLYNOMIAL PARTITIONING II

11

concentrated on the cells O′
is concentrated in the R1/2-neighborhood of a lower-dimensional variety Y = Z ∩ Z(P ).

i, then we can prove the desired bounds by induction. Otherwise, µEf

Now we turn to this algebraic case. In the algebraic case, there is a lower-dimensional variety

Y , with Deg Y . Deg Z, so that

µEf (NR1/2 (Y ) ∩ BR) & µEf (BR) ∼ µEf (NR1/2(Z) ∩ BR).

There are two types of wave packets that contribute to µEf on NR1/2 (Y ) ∩ BR: tangential wave
packets, which lie in NR1/2 (Y ) and run tangent to Y , and transverse wave packets, which cut across
NR1/2(Y ). (Recall that all the wave packets are tangent to Z by hypothesis.)

In our current setup, if all the wave packets are tangent to Y , then we get the desired estimate

just by induction on the dimension m.

However, there may be a mix of transverse and tangential wave packets. If we let ftang be the
sum of the tangential wave packets and ftrans be the sum of the transverse wave packets, then the
quasi-triangle inequality for BLp

k,A (1.12) gives

k,A/2(BR).
This is the step in the proof where we need to use the quasi-triangle inequality.

k,A/2(BR) + kEftranskBLp

k,A(BR) . kEftangkBLp

kEf kBLp

We can handle the tangential terms by induction on the dimension, and now we turn to the
transverse terms. As in the last sketch, we decompose BR = ∪jBj, where each ball Bj has radius
ρ ≪ R. We deﬁne fj,trans as above to be the sum of wave packets that intersect NR1/2(Y ) trans-
versely in Bj. As in the previous sketch, geometric arguments show that a tube Tθ,v can intersect
NR1/2(Y ) transversely in . 1 balls Bj, and so

kfj,transk2

L2 . kf k2

L2.

Xj

Next we want to study kEfj,transkBLp

k,A/2(Bj ) by using induction on the radius. This step is more
complicated than in the previous sketch. We know that f is concentrated on wave packets that are
tangent to Z on BR, and we need to use that information. We expand Efj,trans into wave packets
on the ball Bj. Since Bj has radius ρ, each wave packet is essentially supported on a tube of radius
ρ1/2 and length ρ in Bj. When we examine this wave packet decomposition, it is not exactly true
that all the wave packets are tangent to Z in Bj – in fact, something better is true. The wave
packets of fj,trans on Bj all lie in NR1/2 (Z) ∩ Bj, but they don’t necessarily lie in Nρ1/2 (Z) ∩ Bj.
We cover NR1/2(Z) ∩ Bj with disjoint translates of Nρ1/2(Z) ∩ Bj:

Now it turns out that each wave packet of fj,trans lies in one of these translates. We let fj,trans,b

NR1/2 (Z) ∩ Bj = ∪bNρ1/2(Z + b) ∩ Bj.

and

be the sum of the wave packets that lie in Nρ1/2(Z+b) ∩ Bj. Now we have fj,trans = Pb fj,trans,b,
k,A/2(Bj ).

kEfj,trans,bkp

kEfj,transkp

kEfj,transkp

BLp

k,A/2(N

BLp

BLp

k,A/2(Bj ) ∼Xb

ρ1/2 (Z+b)∩Bj ) ∼Xb

The wave packets of Efj,trans,b are tangent to the m-dimensional variety Z + b on Bj. Therefore,

we can study kEfj,trans,bkBLp

k,A/2(Bj ) by induction on the radius: we can assume that

12

LARRY GUTH

kEfj,trans,bkBLp

k,A/2(Bj ) ≤ M (ρ, A/2)kfj,trans,bkL2.

(Here we write M (ρ, A/2) because M depends on the radius (which is ρ) and because we have
A/2 in place of A.) Putting together what we have learned so far in the transverse algebraic case,
we have

kEf kp

BLp

k,A(BR) .Xj

kEfj,transkp

BLp

k,A/2(Bj )

BLp

kEfj,trans,bkp

∼Xj,b

k,A/2(Bj ) ≤ M (ρ, A/2)pXj,b
To get our ﬁnal bound, it remains to control Pj,b kfj,trans,bkp
also already know that Pj kfj,transk2

fj,trans lies in exactly one fj,trans,b, it is easy to check that kfj,transk2

L2. And so we see that

L2 . kf k2

kfj,trans,bkp

L2 .(cid:18)max

j,b

kfj,trans,bkp−2

L2 (cid:19) kf k2

L2.

Xj,b

kfj,trans,bkp

L2.

L2. Since each wave packet of
L2. We

L2 ∼ Pb kfj,trans,bk2

The last ingredient of the proof is an estimate for maxj,b kfj,trans,bkL2, which has to do with
transverse equidistribution. Recall that since f is concentrated on wave packets in TZ , Ef is
equidistributed in directions transverse to Z. Recall that NR1/2(Z) ∩ Bj is covered by thinner
.
Because of transverse equidistribution, each of these neighborhoods receives an even share of the
L2 norm of Efj,trans. In other words, for each b,

neighborhoods Nρ1/2(Z + b) ∩ Bj. The number of these thinner neighborhoods is ∼ (cid:16) R1/2

ρ1/2(cid:17)n−m

kEfj,transk2

L2(N

ρ1/2 (Z+b)∩Bj ) .(cid:18) R1/2
ρ1/2 (cid:19)

−(n−m)

kEfj,transk2

L2(N

R1/2 (Z)∩Bj ).

Using this inequality, we prove the desired estimate for kfj,trans,bkL2:

(2.11)

kfj,trans,bk2

L2 .(cid:18) R1/2
ρ1/2 (cid:19)

−(n−m)

kfj,transk2

L2 .(cid:18) R1/2
ρ1/2(cid:19)

−(n−m)

kf k2

L2.

2.2. Outline of the paper. We carry out the proof of Theorem 1.5 over Sections 3 - 8 of the paper.
Section 3 reviews some standard facts about wave packets. Section 4 proves some basic properties
of the broad “norms” BLp
k,A. Section 5 contains tools from algebraic geometry (and diﬀerential
geometry) that we will use to study the geometry of the algebraic varieties that appear in the
proofs. Section 6 proves the ﬁrst transverse equidistribution estimate. For any ball B(y, ρ) ⊂ Rn,
there is a wave packet decomposition for Ef on the ball B(y, ρ). Section 7 is about the relationship
between the original wave packet decomposition on the ball BR and the wave packet decomposition
adapted to a smaller ball B(y, ρ) ⊂ BR. This lets us state and prove a second version of the
transverse equidistribution estimate, corresponding to (2.11) above. With the background and
tools from these sections, we prove Theorem 1.5 in Section 8.

Following [BG], Section 9 explains how k-broad estimates imply regular Lp estimates of the form
kEf kLp . kf kLp. This argument ﬁnishes the proof of Theorem 1.1. Section 10 is an appendix
which helps to keep track of the parameters. Unfortunately, there are quite a few parameters in

RESTRICTION ESTIMATES USING POLYNOMIAL PARTITIONING II

13

the paper – various δ’s, R, K, A, etc. The appendix lists all the parameters and how they relate
to each other. Section 11 discusses further directions and open problems.

3. Basic setup with wave packets

Let f be a function on Bn−1. We ﬁrst break up f into pieces fθ,v that are localized in both

position and frequency.

Cover Bn−1 by ﬁnitely overlapping balls θ of radius R−1/2. Let ψθ be a smooth partition of

unity adapted to this cover, and write f =Pθ ψθf .

Next we break up ψθf according to frequency. Cover Rn−1 by ﬁnitely overlapping balls of radius
2 Zn−1. Let ηv be a smooth partition of unity adapted to this

2 , centered at vectors v ∈ R

1+δ

1+δ

∼ R
cover. We can now write

f =Xθ,v

(ηv(ψθf )∧)∨ =Xθ,v

η∨
v ∗ (ψθf ).

Note that η∨

v (x) is rapidly decaying for |x| & R

2 . Choose smooth functions ˜ψθ so that ˜ψθ is
supported on θ, but ˜ψθ is 1 on a small neighborhood of the support of ψθ. A bit more precisely, we
would like ˜ψθ = 1 on a cR−1/2 neighborhood of the support of ψθ for a small constant c > 0. Now
we deﬁne

1−δ

Because of the rapid decay of η∨
v ,

fθ,v := ˜ψθ [η∨

v ∗ (ψθf )] .

Therefore, we see that

||fθ,v − η∨

v ∗ (ψθf )kL∞ ≤ RapDec(R)kf kL2.

fθ,v + Err, where k Err kL∞ ≤ RapDec(R)kf kL2.

f =Xθ,v

Terms of the form RapDec(R)kf kL2 are negligibly small in terms of all of our estimates. These

rapidly decaying errors will occur from time to time during our arguments.

The functions fθ,v are approximately orthogonal. For any set T of pairs (θ, v), we have

(3.1)

2

L2

kfθ,vk2

L2.

∼ X(θ,v)∈T

X(θ,v)∈T

(cid:13)(cid:13)(cid:13)(cid:13)(cid:13)(cid:13)

fθ,v(cid:13)(cid:13)(cid:13)(cid:13)(cid:13)(cid:13)

The decomposition f = Pθ,v fθ,v is useful in this problem because Efθ,v is localized in space.

For each (θ, v), there is a corresponding tube Tθ,v, where Efθ,v is essentially supported. Let ωθ
denote the center of θ. We deﬁne Tθ,v by

(3.2)

Tθ,v := {(x′, xn) ∈ BR so that |x′ + 2xnωθ + v| ≤ R1/2+δ}.

Lemma 3.1. If x ∈ BR \ Tθ,v, then

|Efθ,v(x)| ≤ RapDec(R)kf kL2.

14

LARRY GUTH

We sketch the proof by stationary phase. We note that (e−ivωfθ,v) has Fourier transform essen-

tially supported in BR1/2+δ/2. Therefore, we have

Moreover, taking derivatives, we see that

|e−ivωfθ,v| . R(n−1) δ

2 Avgθ |e−ivωfθ,v|.

max

θ

max

θ

ω(cid:0)e−ivωfθ,v(cid:1)(cid:12)(cid:12) .(cid:16)R1/2+δ/2(cid:17)k
(cid:12)(cid:12)∂k

R(n−1) δ

2 Avgθ |e−ivωfθ,v|.

Let ηθ be a smooth bump which is equal to 1 on θ. Since θ has diameter R−1/2, we can estimate

the derivatives |∂kηθ| . Rk/2. Now we write Efθ,v(x) as

(3.3)

Efθ,v(x) =Z hηθei(x′ω+xn|ω|2+vω)i ·(cid:0)e−ivωfθ,v(cid:1) .

We let Ψ(ω) := x′ω + xn|ω|2 − vω. We note that

If x ∈ BR \ Tθ,v, then |x′ + 2xnωθ + v| = |∂ωΨ(ωθ)| > R1/2+δ. We know that |xn| ≤ R, and so

for any ω ∈ θ, |2xnω − 2xnωθ| . R1/2. Therefore, for any ω ∈ θ,

∂ωΨ = x′ + 2xnω + v.

|∂ωΨ(ω)| & R1/2+δ.

By applying integration by parts to (3.3) many times, we see that |Efθ,v(x)| ≤ RapDec(R)kfθ,vkL2

as desired.

The tube Tθ,v is a cylinder of length R and radius ∼ R1/2+δ. It points in the direction G(ωθ),

where G(ω) is the unit vector given by

G(ω) =

(−2ω1, ..., −2ωn−1, 1)
|(−2ω1, ..., −2ωn−1, 1)|

.

For each ω ∈ Bn−1, we also deﬁne a frequency ξ(ω). Based on the formula for Ef , the frequency

ξ(ω) is given by

We let ξ(θ) denote the image of θ under ξ:

ξ(ω) := (ω1, ..., ωn−1, |ω|2).

ξ(θ) := {(ω1, ..., ωn−1, |ω|2)|ω ∈ θ}.

In a distributional sense, the Fourier transform of Efθ,v is supported in ξ(θ). Also, if ηR denotes
a smooth bump on BR (of height 1), then the Fourier transform of ηREfθ,v is essentially supported
in NR−1(ξ(θ)).

We introduce a little notation. If Tα is any set of pairs (θ, v), then we say that f is concentrated

on wave packets from Tα if

Also, for any f , and for any set Tα, we deﬁne

f = X(θ,v)∈Tα

fθ,v + RapDec(R)kf kL2.

RESTRICTION ESTIMATES USING POLYNOMIAL PARTITIONING II

15

fα = X(θ,v)∈Tα

fθ,v.

3.1. Orthogonality. For any ﬁxed xn, Ef restricted to Rn−1 ×{xn} can be described as an inverse
Fourier transform:

Applying Plancherel, we get

Ef (x1, ..., xn−1, xn) =(cid:16)eixn|ω|2

f (ω)(cid:17)∨

(x1, ..., xn−1).

(3.4)

kEf kL2(Rn−1×{xn}) = kf kL2.

We record a couple of simple corollaries of this statement.

Lemma 3.2.

Proof.

kEf kL2(BR) . R1/2kf kL2.

ZBR

|Ef |2 ≤Z R

−R ZBn−1(R)

|Ef |2dx′! dxn ≤ 2Rkf k2

L2.

(cid:3)

Lemma 3.3. Suppose that f is concentrated on a set of wave packets T and that for every (θ, v) ∈ T,
Tθ,v ∩ (Rn−1 × {xn}) ⊂ Bn−1(z0, r) × {xn}. Then

(3.5)

kEf kL2(Bn−1(z0,r)×{xn}) = kf kL2 + RapDec(R)kf kL2.

Lemma 3.4. Suppose that f is concentrated on a set of wave packets T and that for every (θ, v) ∈ T,
Tθ,v ∩ B(z, r) 6= ∅, for some radius r ≥ R1/2+δ . Then

(3.6)

kEf k2

L2(B(z,10r)) ∼ rkf k2

L2.

Proof. For each xn in the range zn − r ≤ xn ≤ zn + r, and for each (θ, v) ∈ T, the intersection
Tθ,v ∩ Rn−1 × {xn} is contained in B(z, 5r). By the last lemma, we see that

kEf kL2(B(z,5r)∩Rn−1×{xn}) = kf kL2 + RapDec(R)kf kL2.

Applying Fubini, we get the desired bound.

(cid:3)

4. Properties of the broad “norms” BLp
k,A. Although BLp

k,A

We recall the deﬁnition of the k-broad “norm” BLp

k,A is not literally a norm, it
obeys a version of the triangle inequality and a version of Holder’s inequality. These nice algebraic
features helped to motivate this particular deﬁnition.

Let Bn−1 be a disjoint union of (approximate) balls τ of radius K −1 . For each τ , we deﬁne G(τ )
to be the image of τ under the direction map G. If ωτ is the center of τ , then G(τ ) is essentially a
ball of radius K −1 around G(ωτ ) in Sn−1. If V ⊂ Rn is a subspace, then we write Angle(G(τ ), V )
for the smallest angle between any non-zero vectors v ∈ V and v′ ∈ G(τ ).

For any ball BK 2 of radius K 2 in BR, we deﬁne µEf as in (1.9).

16

LARRY GUTH

µEf (BK 2 ) :=

V1,...,VA (k − 1)-subspaces of Rn 

min

τ :Angle(G(τ ),Va)>K−1 for all aZBK2

max

|Efτ |p! .

Because this expression is a little long, we abbreviate it as

µEf (BK 2) := min

V1,...,VA max

τ /∈VaZBK2

|Efτ |p! .

We remark that it is convenient to allow A = 0. If A = 0, then we have simply µEf (BK 2 ) =

|Efτ |p.

maxτRBK2

If U ⊂ BR is a ﬁnite union of balls BK 2 , then we deﬁne kEf kLp(U) by:

(4.1)

kEf kp

BLp

k,A(U) := XBK2 ⊂U

µEf (BK 2 ).

The k-broad “norm” obeys a weak version of the triangle inequality.

Lemma 4.1. Suppose that f = g + h and suppose that A = A1 + A2, where A, Ai are non-negative
integers. Then

kEf kBLp

k,A(U) . kEgkBLp

k,A1

(U) + kEhkBLp

k,A2

(U).

Proof. We expand

kEf kp

BLp

k,A(U) = XBK2 ⊂U

Now for each ball BK 2 ⊂ U , we have

min

V1,...,VA max

τ /∈VaZBK2

|Efτ |p! .

min

V1,...,VA max
V1,...,VA1 

τ /∈VaZBK2
τ /∈Va,1≤a≤A1ZBK2

max

|Efτ |p! . min

V1,...,VA max
|Egτ |p! + min

τ /∈Va"ZBK2
VA1+1,...,VA 

|Egτ |p +ZBK2
τ /∈Va,A1+1≤a≤AZBK2

max

≤ min

|Ehτ |p#!

|Ehτ |p! .

Summing over all BK 2 ⊂ U , we get

kEf kp

k,A(U) . kEgkp

BLp

BLp

k,A1

(U) + kEhkp

BLp

k,A2

(U).

(cid:3)

The reason that we need a large value of A in Theorem 1.5 is that we will need to use this
triangle inequality many times. If A = 1, BLp
k,1 does not obey a good triangle inequality. But if
we start with A a large constant, we can use Lemma 4.1 many times. In eﬀect, BLp
k,A behaves like
a norm as long as we only use the triangle inequality Oǫ(1) times in our argument, and as long as
we choose A = A(ǫ) large enough.

BLp

k,A also obeys a version of (a corollary of) Holder’s inequality.

RESTRICTION ESTIMATES USING POLYNOMIAL PARTITIONING II

17

Lemma 4.2. Suppose that 1 ≤ p, p1, p2 < ∞ and 0 ≤ α1, α2 ≤ 1 obey α1 + α2 = 1 and

Also suppose that A = A1 + A2. Then

1
p

= α1

1
p1

+ α2

1
p2

.

kEf kBLp

k,A(U) ≤ kEf kα1

BLp1

k,A1

(U)kEf kα2

BLp2

k,A2

(U).

Proof. The left-hand side is


 XBK2 ⊂U

min

V1,...VA

max

τ /∈VaZBK2

1
p

.

|Efτ |p


Applying the regular Holder inequality to the inner integral, this expression is

≤
 XBK2 ⊂U

≤
 XBK2 ⊂U

1
p

.

p

p2


1
p

.

p

p2


min

V1,...VA

max

τ /∈Va ZBK2

|Efτ |p1!α1

p

p1  ZBK2

|Efτ |p2!α2

We can bring the maximum over τ inside, so the last expression is

min

V1,...VA max

τ /∈VaZBK2

|Efτ |p1!α1

p

p1  max

τ /∈VaZBK2

|Efτ |p2!α2

Now we cannot bring the minimum inside the parentheses. But we can split V1, ..., VA into
V1, ..., VA1 and VA1+1, ..., VA. If we weaken the ﬁrst condition τ /∈ V1...VA to τ /∈ V1, ..., VA1 , and
if we weaken the second condition τ /∈ V1, ..., VA to τ /∈ VA1+1, ..., VA, then we see that the last
expression is bounded by

≤
 XBK2 ⊂U  min

V1,...VA1

max

τ /∈Va,1≤a≤A1ZBK2

|Efτ |p1!α1

p

p1   min

VA1 +1,...VA

τ /∈Va,A1+1≤a≤AZBK2

max

|Efτ |p2!α2

Now we apply Holder to the initial sum over BK 2 ⊂ U , and we get

1
p

.

p

p2


≤
 XBK2 ⊂U

min

V1,...VA1

max

τ /∈Va,1≤a≤A1ZBK2

|Efτ |p1


α1

p1 
 XBK2 ⊂U

min

VA1 +1,...VA

τ /∈Va,A1+1≤a≤AZBK2

max

= kEf kα1

BLp1

k,A1

(U)kEf kα2

BLp2

k,A2

(U).

α2
p2

|Efτ |p2


(cid:3)

18

LARRY GUTH

5. Tools from algebraic geometry

5.1. Transverse complete intersections. Over the course of our argument we will work not just
with algebraic hypersurfaces but algebraic varieties of all dimensions. We write Z(P1, ..., Pn−m) for
the set of common zeroes of the polynomials P1, ..., Pn−m. Throughout the paper, we will work
with a nice class of varieties called transverse complete intersections. The variety Z(P1, ..., Pn−m)
is a transverse complete intersection if

(5.1)

∇P1(x) ∧ ... ∧ ∇Pn−m(x) 6= 0 for all x ∈ Z(P1, ..., Pn−m).

By the implicit function theorem, a transverse complete intersection Z(P1, ..., Pn−m) is a smooth
m-dimensional manifold. Because of Sard’s theorem, there are lots of transverse complete intersec-
tions. Here is a lemma making this precise.

Lemma 5.1. If P is a polynomial on Rn, then for almost every c0 ∈ R, Z(P + c0) is a transverse
complete intersection.

More generally, suppose that Z(P1, ..., Pn−m) is a transverse complete intersection and that P is
another polynomial. Then for almost every c0 ∈ R, Z(P1, ..., Pn−m, P + c0) is a transverse complete
intersection.

Proof. We begin with the ﬁrst case. We know that P : Rn → R is a smooth function, and so by
Sard’s theorem, almost every y ∈ R is a regular value for P . But if −c0 is a regular value for P ,
then ∇P (x) 6= 0 whenever P (x) + c0 = 0.

The general case is similar. We know that Z = Z(P1, ..., Pn−m) is a smooth m-dimensional
manifold, and P : Z → R is a smooth function. By Sard’s theorem, almost every y ∈ R is a
regular value of the map P : Z → R. If x ∈ Z and P (x) is a regular value, then dPx 6= 0, where
dP : TxZ → TP (x)R. In terms of ∇P (x), this means that

∇P1(x) ∧ ... ∧ ∇Pn−m(x) ∧ ∇P (x) 6= 0.

So if −c0 is a regular value for P : Z → R, then Z(P1, ..., Pn−m, P + c0) is a transverse complete
intersection.
(cid:3)

5.2. Polynomial partitioning. Polynomial partitioning is a key tool in our arguments. Our
presentation here is a minor variation on the polynomial partitioning result from [GK]. We begin
by stating a partitioning result from [G]:

Theorem 5.2. (Theorem 1.4 in [G]) Suppose that W ≥ 0 is a (non-zero) L1 function on Rn. Then
for each D there a non-zero polynomial P of degree at most D so that Rn \ Z(P ) is a union of

∼ Dn disjoint open sets Oi, and the integrals ROi

W are all equal.

We want to use this result, but we need to upgrade it in a minor way. Because we want all the
varieties that appear in our argument to be transverse complete intersections, we need to be able
to perturb P a little bit. In order to understand this issue, we need to review some of the proof of
Theorem 5.2. The proof is based on the polynomial ham sandwich theorem, which is due to Stone
and Tukey [StTu]. Here is a version of the theorem which is convenient for our purposes:

Theorem 5.3. (Polynomial ham sandwich theorem, cf. Corollary 1.2 in [G]) If W1, ..., WN are
L1-functions on Rn, then there exists a non-zero polynomial P of degree ≤ CnN 1/n so that for each
Wj,

RESTRICTION ESTIMATES USING POLYNOMIAL PARTITIONING II

19

Z{P >0}

Wj =Z{P <0}

Wj .

Using the polynomial ham sandwich theorem iteratively, we get the following partitioning result.

Corollary 5.4. If W ≥ 0 is a (non-zero) L1-function on Rn, then there is a sequence of polynomials
Q1, Q2, ... with Deg Qj . 2j/n with the following equidistribution property:

If S ≥ 1, and if σ1, ..., σS ∈ {−1, +1} are any sign conditions, then

ZSign(Qs)=σs for 1≤s≤S

W = 2−SZRn

W.

We can slightly perturb each Qs by adding a small generic constant: ˜Qs = Qs + cs, where cs ∈ R.
Using this small perturbation, we will be able to arrange that all the varieties that appear in our
arguments are transverse complete intersections. As long as the constants cs are suﬃciently small,
if S ≥ 1, and if
we still have the following slightly weaker version of the equidistribution result:
σ1, ..., σS ∈ {−1, +1} are any sign conditions, then

2−S−1ZRn

W ≤ZSign( ˜Qs)=σs for 1≤s≤S

W ≤ 2−S+1ZRn

W.

This gives the following polynomial partitioning result, which is designed to allow small pertur-

bations:

Theorem 5.5. Suppose that W ≥ 0 is a (non-zero) L1 function on Rn. Then for any degree D
the following holds.

There is a sequence of polynomials Q1, ..., QS with the following properties. We haveP Deg Qs .
D and 2S ∼ Dn. Let P = QS

by the sign conditions of ˜Qs. There are 2S ∼ Dn cells Oi and Rn \ Z(P ) = ∪iOi.

s=1(Qs + cs) where cs ∈ R. Let Oi be the open sets given

˜Qs = QS

s=1

If the constants cs are suﬃciently small, then for every Oi,

ZOi

W ∼ D−nZRn

W.

For a generic choice of the constants cs, Lemma 5.1 guarantees that Z( ˜Qs) is a transverse
complete intersection for each s. This implies that Z(P ) is a ﬁnite union of transverse complete
intersections. Similarly, if Z(P1, ..., Pn−m) is a transverse complete intersection, then for a generic
choice of the constants cs, Z(P1, ..., Pn−m, ˜Qs) will also be a transverse complete intersection for
each s.

5.3. Controlling the tangent plane of a variety. Suppose that Z is an m-dimensional trans-
verse complete intersection. We know that Z is a smooth m-dimensional manifold. We will consider
some subsets of Z where the tangent plane obeys certain conditions. We will see that these subsets
are in fact subvarieties of Z, and that in generic cases, they are transverse complete intersections.
Let Z = Z(P1, ..., Pn−m) be a transverse complete intersection. Let w ∈ ΛmRn. Deﬁne Zw by

(5.2)

Zw := {x ∈ Z|∇P1(x) ∧ ... ∧ ∇Pn−m(x) ∧ w = 0}.

20

LARRY GUTH

We note that since w is an m-vector, ∇P1(x)∧...∧∇Pn−m(x)∧w ∈ ΛnRn, which we identify with
R. Let gw := ∇P1(x)∧...∧∇Pn−m(x)∧w, a polynomial with degree at most Deg P1+...+Deg Pn−m.
The set Zw is the algebraic variety Z(P1, ..., Pn−m, gw).

Lemma 5.6. For almost every w ∈ ΛmRn, Zw = Z(P1, ..., Pn−m, gw) is a smooth complete inter-
section.

The proof uses some ideas from diﬀerential topology. The book [GP] is a good reference. In
particular, the proof here is closely based on the proof of the transversality theorem in Chapter 2.3
of [GP].

Proof. Deﬁne a smooth function g : Z × ΛmRn → R by

g(x, w) := ∇P1(x) ∧ ... ∧ ∇Pn−m(x) ∧ w.

The function g is smooth, and it has no critical points, because for any x ∈ Z, ∇P1(x) ∧ ... ∧
∇Pn−m(x) 6= 0, and the restriction of g to {x} × ΛmRn is a non-zero linear function with no critical
points. Therefore g−1(0) is a smooth submanifold M in Z × ΛmRn (of codimension 1).

Consider the smooth map π : M → ΛmRn given by π(x, w) = w. Note that π−1(w) = Zw × {w}.
We will use π in order to study Zw. We claim that Zw is a transverse complete intersection whenever
w is a regular value of π. By Sard’s theorem, almost every w ∈ ΛmRn is a regular value of π, and
so this claim implies our conclusion.

To see that Zw is a transverse complete intersection, it suﬃces to check that the critical points of
the function gw : Z → R are disjoint from Zw. In other words, it suﬃces to check that for every x
with (x, w) ∈ M , x is a regular point of gw : Z → R. If w is a regular value of π, then it means that
for each x with (x, w) ∈ M , (x, w) is a regular point for π. So it suﬃces to check that whenever
(x, w) is a regular point for π, x is a regular point for gw.

Recall that (x, w) ∈ M is a regular point for π : M → ΛmRn if and only if dπ : T(x,w)M → ΛmRn
is surjective. To understand this condition better, we compute the tangent space T(x,w)M . We know
that T(x,w)M ⊂ T(x,w)(Z × ΛmRn) = TxZ × ΛmRn, and more precisely

T(x,w)M = {(v, w′) ∈ TxZ × ΛmRn|dg(x,w)(v, w′) = 0}.
But dg(x,w)(v, w′) = (dgw)x(v) + ∇P1(x) ∧ ... ∧ ∇Pn−m(x) ∧ w′. Therefore,

T(x,w)M = {(v, w′) ∈ TxZ × ΛmRn|(dgw)x(v) + ∇P1(x) ∧ ... ∧ ∇Pn−m(x) ∧ w′ = 0}.

If x is not a regular point of dgw, then (dgw)x = 0, and T(x,w)M = {(v, w′)|∇P1(x) ∧ ... ∧
∇Pn−m(x) ∧ w′ = 0}. But in this case, the projection dπ : T(x,w)M → ΛmRn is not surjective.
(The projection dπ is just dπ(v, w′) = w′.) So if (x, w) is a regular point of π, then x is a regular
point of gw as desired.
(cid:3)

If W ⊂ ΛmRn is a large ﬁnite set, then on each connected component of Z \ (∪w∈W Zw), the
tangent plane T Z is constrained in a small region of the Grassmannian. More precisely, for any
small parameter β > 0, we can choose a ﬁnite set W ⊂ ΛmRn so that, for any two points x1, x2 in
the same component of Z \ (∪w∈W Zw), Angle(Tx1Z, Tx2Z) < β. We can also choose W generically
so that each Zw is a transverse complete intersection of dimension m − 1.

RESTRICTION ESTIMATES USING POLYNOMIAL PARTITIONING II

21

5.4. Controlling transverse intersections between a tube and a variety. Suppose that T
is a cylinder of radius r with central axis ℓ. Suppose that Z m ⊂ Rn is a transverse complete
intersection. Deﬁne Z>α by

Z>α := {z ∈ Z| Angle(TzZ, ℓ) > α}.

Lemma 5.7. Suppose that Z = Z(P1, ..., Pn−m) is a transverse complete intersection and that the
polynomials Pj have degree at most D. Let T be a tube of radius r as above. Then for any α > 0,
Z>α ∩ T is contained in a union of . Dn balls of radius . rα−1.

The main tool in the proof is the following version of the Bezout theorem:

Theorem 5.8. (cf. Theorem 5.2 of [CKW] for a short proof ) Suppose that Z = Z(Q1, ..., Qn)
is a transverse complete intersection in Rn. Then Z is ﬁnite and the cardinality of Z is at most

j=1 Deg Qj.

Qn

Using this Bezout theorem, we now prove Lemma 5.7.

Proof. The proof is by induction on m. When m = 0, Theorem 5.8 guarantees that Z consists of
at most Dn points, and the conclusion follows.

Now we turn to the inductive step. Without loss of generality, we can assume that ℓ is the

xn-axis. We let Tr denote the r-neighborhood of the xn-axis.

Next we do some scaling to reduce to a special case. By rescaling, we can reduce to the case
that r = 1. Next, by scaling in the xn-coordinate only, we can reduce to the case that α = 1. So
we have to show that Z>1 ∩ T1 is contained in . Dn balls of radius . 1.

Let Zw be deﬁned as in the last subsection. We choose . 1 values of w in general position so
that on each connected component of Z \ ∪wZw, the tangent plane of Z varies by an angle at most
1
100 . Since w is generic, Zw = Z(P1, ..., Pn−m, gw) is a transverse complete intersection of dimension
m − 1. Also Deg gw . D. We can apply our inductive assumption to Zw, using radius r = 20 and
α = 1/2. We see that Zw,>1/2 ∩ T20 is covered by . Dn balls of radius . 1.

Next we claim that Z>1/2 ∩ Zw ⊂ Zw,>1/2. If x ∈ Z>1/2 ∩ Zw, then

But TxZw ⊂ TxZ. Therefore, inf v∈TxZw Angle(v, ℓ) > 1/2, and so x ∈ Zw,>1/2 as claimed.

Since the total number of w is . 1,

inf

v∈TxZ

Angle(v, ℓ) > 1/2.

∪wZ>1/2 ∩ Zw ∩ T20 is contained in . Dn balls Bi of radius . 1.

If Bi = B(xi, ri) we write 10Bi for B(xi, 10ri). The union ∪i10Bi is a set of . Dn balls of radius

. 1 which covers part of Z>1 ∩ T1. We still have to cover the remaining part

Z>1 ∩ T1 \ ∪i10Bi.

Consider a point z in this remaining part. We can assume the radius of each Bi is at least 2,
and so we know that the distance from z to ∪iBi is at least 10. Let A be the connected component
of Z ∩ B(z, 10) containing z. We claim that A is disjoint from all Zw. Indeed, suppose that γ was
a curve in A starting at z and intersecting ∪wZw for the ﬁrst time at z′ ∈ A. Along the curve γ,
the tangent plane of T Z is constant up to angle 1
100 . Since γ starts at z ∈ Z>1, γ ⊂ Z>1/2. Also,
γ ⊂ B(z, 10) ⊂ T20. We conclude that z′ ∈ Z>1/2 ∩ Zw ∩ T20, and so so z′ ∈ ∪iBi. But B(z, 10) is

22

LARRY GUTH

disjoint from ∪iBi. This contradiction proves the claim. Since A is connected and disjoint from all
Zw, the tangent plane of Z is constant on A up to angle 1

Therefore, A is a small perturbation of an m-plane that cuts across T1 in a quantitatively
transverse way. Let Π be a random (n − m)-plane containing the xn-axis. With probability & 1,
Π ∩ A ∩ T1 is non-empty. By the Bezout theorem (Theorem 5.8), |Π ∩ Z| ≤ Dn−m for generic Π.
Therefore, there can be at most . Dn−m disjoint sets A of this type. So we see that the remaining
part of Z>1 ∩ T1 is contained in . Dn−m additional balls of radius . 1.

100 .

6. Transverse equidistribution estimates

In this section we prove a transverse equidistribution estimate. To set up the statement, we ﬁrst

deﬁne what it means for a wave packet to be tangent to a transverse complete intersection Z.

Deﬁnition 6.1. Suppose that Z = Z(P1, ..., Pn−m) is a transverse complete intersection. We say
that Tθ,v is R−1/2+δm-tangent to Z in BR if:

(cid:3)

(6.1)

Tθ,v ⊂ NR1/2+δm (Z) ∩ BR,
and for any x ∈ Tθ,v and z ∈ Z ∩ BR with |x − z| . R1/2+δm,

(6.2)

We deﬁne

Angle(G(θ), TzZ) . R−1/2+δm.

TZ := {(θ, v)|Tθ,v is R−1/2+δm tangent to Z in BR}.

We say that f is concentrated in wave packets from TZ if

kfθ,vkL2 ≤ RapDec(R)kf kL2.

X(θ,v) /∈TZ

(In this deﬁnition δm > 0 is a small constant. The estimates we prove in this section hold for

any δm ≥ 0. We will choose δm in Section 8.)

Suppose that B is a ball of radius R1/2+δm in Rn. Deﬁne

(6.3)

TB,Z := {(θ, v) ∈ TZ|Tθ,v ∩ B 6= ∅}.

The main result of this section is the following transverse equidistribution estimate.

Lemma 6.2. Suppose that B is a ball of radius R1/2+δm in BR ⊂ Rn and that ρ ≤ R. Suppose

that g =P(θ,v)∈TB,Z

gθ,v. Then

ZB∩N

ρ1/2+δm (Z)

|Eg|2 . RO(δm)(cid:18) R1/2
ρ1/2 (cid:19)

−(n−m)

Z2B

|Eg|2 + RapDec(R)kgk2

L2.

We build up to the proof via several smaller lemmas. We begin with a version of the Heisenberg
uncertainty principle, saying that a function which is concentrated in a small ball in frequency space
cannot concentrate too much in physical space.

RESTRICTION ESTIMATES USING POLYNOMIAL PARTITIONING II

23

Lemma 6.3. Suppose that G : Rn → C is a function, and that ˆG is supported in a ball of radius
r, B(ξ0, r). Then for any ball B(x0, ρ) of radius ρ ≤ r−1,

ZB(x0,ρ)

|G|2 .

|Bρ|

|Br−1 |Z |G|2.

Proof. Let η be a smooth bump function with |η| ∼ 1 on B(x0, ρ) and rapidly decaying outside of
it. Then |ˆη(ξ)| ∼ |Bρ| on Bρ−1 and rapidly decaying outside of it.

For ξ . ρ−1, we bound

ZBρ

|G|2 .Z |ηG|2 =Z |ˆη ∗ ˆG|2.

For |ξ| far from Bρ−1 , the rapid decay of η takes over and gives a stronger bound. All together,

|ˆη ∗ ˆG(ξ)| ≤ kˆηkL∞k ˆGkL1 ∼ |Bρ|ZBr

| ˆG|.

we have

Z |ˆη ∗ ˆG|2 . |B−1

ρ |(cid:18)|Bρ|ZBr

| ˆG|(cid:19)2

≤ |Bρ||Br|Z | ˆG|2 =

|Bρ|

|Br−1|Z |G|2.

(cid:3)

Next we need a more local version of this lemma.

Lemma 6.4. Suppose that G : Rn → C is a function, and that ˆG is supported in a ball of radius
r, B(ξ0, r). Then for any ball B(x0, ρ) with ρ ≤ r−1, we have the inequality

ZB(x0,ρ)

|G|2 .

|Bρ|

|Br−1|Z WB(x0,r−1)|G|2,

where WB(x0,r−1) is a weight function which is equal to 1 on B(x0, r−1) and rapidly decaying

outside of it.
Proof. Let ψ be a function with the support of ˆψ ⊂ Br and with |ψ| ∼ 1 on B(x0, r−1) and rapidly
decaying outside B(x0, r−1). Our weight function will be W = |ψ|2.

Let H = ψ · G. Note that ˆH is supported in B(ξ0, 2r). Applying Lemma 6.3 to H, we see that

ZB(x0,ρ)

|G|2 .ZB(x0,ρ)

|H|2 .

|Bρ|

|Br−1|Z |H|2 =

|Bρ|

|Br−1|Z W |G|2.

(cid:3)

Suppose that B is a ball of radius R1/2+δm in Rn, and V is a subspace of Rn. Deﬁne

(6.4)

TB,V := {(θ, v)|Tθ,v ∩ B 6= ∅ and Angle(G(θ), V ) . R−1/2+δm }.

Let 2B denote the ball with the same center as B and twice the radius.

gθ,v, then we will show that Eg is equidistributed in B along directions

transverse to V . More precisely, we have the following lemma.

If g = P(θ,v)∈TB,V

24

LARRY GUTH

Lemma 6.5. If V ⊂ Rn is a subspace, then there is a subspace V ′ ⊂ Rn with the following
properties.

(1) Dim V + Dim V ′ = n.
(2) V ′ is transverse to V in the sense that for any unit vectors v ∈ V and v′ ∈ V ′,

(3) Suppose that

Angle(v, v′) & 1.

If Π is a plane parallel to V ′, and x0 ∈ Π ∩ B, then for any ρ ≤ R,

g = X(θ,v)∈TB,V

gθ,v.

(6.5)

ZΠ∩B(x0,ρ1/2+δm )

|Eg|2 . RO(δm)(cid:18) R1/2
ρ1/2 (cid:19)

− Dim V ′

ZΠ∩2B

|Eg|2 + RapDec(R)kgk2

L2.

Proof. To prove the lemma, we locate the appropriate space V ′ and then we appeal to Lemma 6.4.
The proof is about relating the direction G(θ) and the frequency ξ(θ). Whenever an object has
to do with directions, we label it with a subscript G, and whenever it has to do with frequencies,
we label it with a subscript ξ. Since V is a set of directions of tubes, we write VG for V . Consider
the set of ω ∈ Bn−1 so that Angle(G(ω), VG) . α, for some small α. What can we say about the
frequencies ξ(ω)?

Recall that G(ω) = G0(ω)

|G0(ω)| , where

G0(ω) = (−2ω1, ..., −2ωn−1, 1).

Let Rn−1 ⊂ Rn be the (x1, ..., xn−1)-plane. Examining the formula for G0 and G, we see that

for every ω ∈ Bn−1, Angle(G(ω), Rn−1) ≥ cangle > 0.

We deﬁne

Angle(VG, Rn−1) := max
v∈VG

Angle(v, Rn−1).

If Angle(VG, Rn−1) is smaller than (1/2)cangle, then G(ω) is never close to VG for any ω ∈ Bn−1.
In this case TB,V is empty and there is nothing to prove. Therefore, we can assume from now on
that

(6.6)

Angle(VG, Rn−1) & 1.

We note that G(ω) ∈ VG if and only if G0(ω) ∈ VG. We deﬁne Aω ⊂ Rn−1 by

Aω := {ω ∈ Rn−1|G0(ω) ∈ VG}.

Since G0 is an aﬃne map, Aω is an aﬃne subspace of Rn−1. Since VG is quantitatively transverse
to Rn−1, and since G0(ω) = (−2ω1, ..., −2ωn−1, 1), we see that Dim Aω = dim V − 1. We also see
that for ω ∈ Bn−1,

Dist(ω, Aω) . Angle(G(ω), VG).

RESTRICTION ESTIMATES USING POLYNOMIAL PARTITIONING II

25

Next we deﬁne Aξ to be Aω × R ⊂ Rn, an aﬃne subspace of Rn. Since ξ(ω) = (ω1, ..., ωn−1, |ω|2),

we see that

Dist(ξ(ω), Aξ) = Dist(ω, Aω).

The spaces Aω and Aξ are aﬃne spaces. We let Vω and Vξ be the subspaces parallel to Aω and
ξ ⊂ Rn is our space V ′. The dimension of Vξ = Dim Aω + 1 = Dim V , and so

Aξ. The space V ⊥
Dim V ′ + Dim V = n as desired.

We let πV ′ be the orthogonal projection from Rn to V ′ = V ⊥

ξ . Combining our estimates above,

we see that

Next we want to see that VG and V ⊥

πV ′(cid:0){ω ∈ Bn−1| Angle(G(ω), VG) ≤ α}(cid:1) ⊂ a ball of radius . α.

ξ are quantitatively transverse. We deﬁne

Angle(VG, V ⊥

ξ ) := min

v∈VG,w∈v⊥
ξ

Angle(v, w).

Sublemma 6.6.

Angle(VG, Rn−1) = Angle(VG, V ⊥

ξ ).

In particular, in the non-vacuous case that Angle(VG, Rn−1) & 1, we see that V = VG and

V ′ = V ⊥

ξ are quantitatively transverse.

Proof. The intersection VG ∩ G0(Rn−1) is an aﬃne space parallel to Vω. Let vG ∈ VG be a unit
vector perpendicular to Vω. Let v1, ..., vm−1 be an orthonormal basis of Vω. Then v1, ..., vm−1, vG
is an orthonormal basis of VG.

Let en be the nth coordinate unit vector. We see that v1, ..., vm−1, en is an orthonormal basis for

Vξ. We also see that V ⊥

ξ ⊂ Rn−1 and V ⊥

ξ = V ⊥

ω ⊂ Rn−1.

Since v1, ..., vm−1 ⊂ Vω ⊂ Rn−1,

Since vG is perpendicular to Vω, we see that the projection of vG to Rn−1 actually lies in V ⊥
ξ ,

and so

Angle(VG, Rn−1) = Angle(vG, Rn−1).

But since v1, ..., vm−1 are in Vξ, we see that vG is the vector in VG which makes the smallest

angle with V ⊥

ξ , and so

Angle(vG, Rn−1) = Angle(vG, V ⊥

ξ ).

Angle(vG, V ⊥

ξ ) = Angle(VG, V ⊥

ξ ).

Let Π be an (n−m)-plane parallel to V ′ passing through B. We know that (Egθ,v)∧ is supported
in ξ(θ). The restriction to Π of Egθ,v has Fourier transform supported in πV ′(ξ(θ)). Now for all
(θ, v) ∈ TB,V , Angle(G(θ), V ) . R−1/2+δm, and so all πV ′ (ξ(θ)) lie in a single ball of radius
. R−1/2+δm. Therefore, if we view Eg as a function G : Π → C, its Fourier transform is supported
in a ball of radius . R−1/2+δm . We apply Lemma 6.4, giving:

(cid:3)

26

(6.7)

LARRY GUTH

ZΠ∩B(x0,ρ1/2+δm )

− Dim V ′

|Eg|2 .(cid:18) R1/2−δm
ρ1/2+δm (cid:19)
. RO(δm)(cid:18) R1/2
ρ1/2 (cid:19)

− Dim V ′

WB|Eg|2.

ZΠ

WB(x0,R1/2−δm )|Eg|2

ZΠ

transverse to Π and intersects B, we see that if x ∈ Π \ 2B, |Eg(x)| ≤ RapDec(R)kgkL2. So

Egθ,v. Each Egθ,v is essentially supported on Tθ,v. Since Tθ,v is

Finally, Eg = P(θ,v)∈TB,V
ZΠ

WB|Eg|2 ≤ZΠ∩2B

|Eg|2 + RapDec(R)kgk2

L2.

(cid:3)

Now we are ready to prove Lemma 6.2.

Proof. Since (θ, v) ∈ TZ , and Tθ,v ∩ B is non-empty, we know that for any z ∈ Z ∩ 2B,

Let V be a subspace of lowest possible dimension so that, for all (θ, v) ∈ TB,Z,

Angle(TzZ, G(θ)) . R−1/2+δm .

Angle(V, G(θ)) . R−1/2+δm .

Let V ′ be the subspace given by Lemma 6.5. We know that Dim V + Dim V ′ = n, and we know
that V ′ is quantitatively transverse to V . By (6.7), we also know that for any plane Π parallel to
V ′,

(6.8)

ZΠ∩B(x0,ρ1/2+δm )

|Eg|2 . RO(δm)(cid:18) R1/2
ρ1/2 (cid:19)

− Dim V ′

ZΠ∩2B

|Eg|2 + RapDec(R)kgk2

L2.

We claim that for each z ∈ Z ∩ B, TzZ is quantitatively transverse to V ′. If this is not the case,

it means that there exists a point z ∈ Z and a subspace W ⊂ TzZ with

so that for each non-zero w ∈ W ,

Dim W > Dim Z − Dim V,

Angle(w, V ′) ≤ o(1).

Since V and V ′ are transverse, this angle condition guarantees that

Because of this angle condition, we can construct a linear map L : Rn → V so that L restricted
to V is the identity, L restricted to W is zero, and |L| . 1. Recall that for each (θ, v) ∈ TB,Z ,
Angle(G(θ), V ) . R−1/2+δm, and so

Angle(w, V ) & 1.

On the other hand, we know that G(θ) ⊂ NR−1/2+δm (TzZ) ∩ B(1), and so L(G(θ)) lies in

|L(G(θ)) − G(θ)| . R−1/2+δm.

RESTRICTION ESTIMATES USING POLYNOMIAL PARTITIONING II

27

This shows that for all (θ, v) ∈ TB,Z ,

L(NR−1/2+δm (TzZ) ∩ B(1)) ⊂ NCR−1/2+δm (L(TzZ)).

Angle(G(θ), L(TzZ)) . R−1/2+δm.

But since L vanishes on W , L(TzZ) is a subspace of dimension at most Dim Z −Dim W < Dim V .
This contradicts our hypothesis that V has minimal dimension. This ﬁnishes the proof of our claim
that for each z ∈ Z ∩ 2B, TzZ is quantitatively transverse to V ′.

Suppose that Π is a plane parallel to V ′ and intersecting B. Given the transversality we just

proved, it follows that

Π ∩ Nρ1/2+δm (Z) ∩ B ⊂ NCρ1/2+δm (Π ∩ Z) ∩ Π ∩ 2B.

Note that Π ∩ Z is itself a transverse complete intersection of dimension Dim V ′ + Dim Z − n.

Now the set, NCρ1/2+δm (Π ∩ Z) ∩ Π ∩ 2B, can be covered by RO(δm)(cid:16) R1/2

balls
in Π of radius ρ1/2+δm (cf. [Wo]). Applying (6.8) on each of these balls and summing, we get the
bound

ρ1/2(cid:17)Dim V ′+Dim Z−n

ZΠ∩N

|Eg|2 . RO(δm)(cid:18) R1/2
ρ1/2 (cid:19)

−(n−m)

ρ1/2+δm (Z)∩B

ZΠ∩2B

|Eg|2 + RapDec(R)kgk2

L2.

Finally, integrating over planes Π parallel to V ′ (using Fubini) we get the desired bound:

ZB∩N

ρ1/2+δm (Z)

|Eg|2 . RO(δm)(cid:18) R1/2
ρ1/2 (cid:19)

−(n−m)

Z2B

|Eg|2 + RapDec(R)kgk2

L2.

(cid:3)

7. Adjusting a wave packet decomposition to a smaller ball

Suppose that B(y, ρ) ⊂ BR for some radius ρ in the range R1/2 < ρ < R, and we want to
decompose f into wave packets associated to the ball B(y, ρ). How does the new wave packet
decomposition relate to the old wave packet decomposition?

If the center y is not at the origin, then we introduce new coordinates

We deﬁne

Then we write

˜x = x − y.

ψy(ω) := ei(y1ω1+...+yn−1ωn−1+yn|ω|2).

Ef (x) =Z ei(x1ω1+...+xn−1ωn−1+xn|ω|2)f (ω) =Z ei(˜x1ω1+...+˜xn−1ωn−1+˜xn|ω|2)eiψy(ω)f (ω).

For any function f , we use the notation

˜f (ω) = eiψy(ω)f (ω).

28

LARRY GUTH

In this notation, we now have

Ef (x) = E ˜f (˜x).

Next we decompose ˜f into wave packets adapted to the ball Bρ. We follow the construction of
wave packets in Section 3, except with the radius R replaced by ρ. We cover Bn−1 with caps ˜θ
of radius ρ−1/2. We cover Rn−1 by ﬁnitely overlapping balls of radius ∼ ρ
2 , centered at vectors
˜v ∈ ρ

2 Zn−1. And we decompose ˜f as

1+δ

1+δ

˜f ˜θ,˜v + RapDec(R)kf kL2,

˜f =X˜θ,˜v

where ˜f ˜θ,˜v is supported in ˜θ and its Fourier transform is essentially supported in B(˜v, ρ
2 ). For
each (˜θ, ˜v), E ˜f ˜θ,˜v is essentially supported on a tube T ˜θ,˜v of radius ρ1/2+δ and length ρ. In the ˜x
coordinates, this tube is contained in Bρ, while in the original x coordinates, this tube is contained
in B(y, ρ).

1+δ

How does the original wave packet decomposition f =Pθ,v fθ,v relate to the new one? The ﬁrst
question we study is, if we expand fθ,v in wave packets at scale Bρ, (fθ,v)∼ = P˜θ,˜v(fθ,v)∼

, then
which (˜θ, ˜v) can have a signiﬁcant contribution? We answer this question in Lemma 7.1. Before
stating the lemma, we need a couple deﬁnitions.

˜θ,˜v

For a given y and ω we deﬁne

and we compute

¯v(ω, y) := ∂ωψy(ω),

¯v(ω, y) = ∂ωψy(ω) = ∂ω(y1ω1 + ... + yn−1ωn−1 + yn|ω|2)

= (y1 + 2ω1yn, ..., yn−1 + 2ωn−1yn) = y′ + 2ynω.

(Here we use the notation y′ = (y1, ..., yn−1).) If ωθ denotes the center of a cap θ, we also write
¯v(θ, y) for ¯v(ωθ, y).

Deﬁne

(7.1)

˜Tθ,v := {(˜θ, ˜v) : Dist(θ, ˜θ) . ρ−1/2 and |v + ¯v(θ, y) − ˜v| . R1/2+δ/2}.

Lemma 7.1. The function (fθ,v)∼ is concentrated in wave packets from ˜Tθ,v. In other words,

(fθ,v)∼ = X( ˜θ,˜v)∈˜Tθ,v

(fθ,v)∼

˜θ,˜v + RapDec(R)kf kL2.

Proof. Since fθ,v is supported in θ, the support of (fθ,v)∼ is clearly contained in

∪{˜θ : Dist(˜θ, θ) . ρ−1/2}.

The main point is to check that the Fourier transform of (fθ,v)∼ is essentially supported in a
ball around v + ¯v(θ, y) of radius . R1/2+δ/2. Let ηθ be a bump function which is 1 on θ and decays
to 0 outside of 2θ. Then

RESTRICTION ESTIMATES USING POLYNOMIAL PARTITIONING II

29

(cid:16)eiψy(ω)fθ,v(cid:17)∧
argument shows that (cid:0)ηθeiψy(ω)(cid:1)∧

Now (fθ,v)∧ is rapidly decaying outside of B(v, R1/2+δ/2). On the other hand, a stationary phase
is rapidly decaying outside of B(¯v(θ, y), R1/2). (To see this, it
(cid:3)

helps to note that on the support of ηθ, ∂ωψy lies in a ball around ¯v(θ, y) of radius . R1/2.)

=(cid:16)ηθeiψy(ω) · fθ,v(cid:17)∧

=(cid:16)ηθeiψy(ω)(cid:17)∧

∗ (fθ,v)∧ .

Next we explore the geometric features of a tube T ˜θ,˜v with (˜θ, ˜v) ∈ ˜Tθ,v.

Lemma 7.2. If (˜θ, ˜v) ∈ ˜Tθ,v, then the tube T ˜θ,˜v obeys the following geometric estimates:

(7.2)

and

(7.3)

HausDist(T ˜θ,˜v, Tθ,v ∩ B(y, ρ)) . R1/2+δ.

Angle(G(θ), G(˜θ)) . ρ−1/2.

Proof. We recall the deﬁnition of Tθ,v from (3.2):

Tθ,v := {(x′, xn) ∈ BR so that |x′ + 2xnωθ + v| ≤ R1/2+δ}.

In the coordinates ˜x, since x = ˜x + y and y′ + 2ynωθ = ¯v(θ, y),

(7.4)

Tθ,v ∩ B(y, ρ) = {(˜x′, ˜xn) ∈ Bρ so that |˜x′ + 2˜xnωθ + ¯v(θ, y) + v| ≤ R1/2+δ}.

On the other hand,

(7.5)

T ˜θ,˜v := {(˜x′, ˜xn) ∈ Bρ so that |˜x′ + 2˜xnω ˜θ + ˜v| ≤ ρ1/2+δ}.

By the deﬁniton of ˜Tθ,v, Dist(˜θ, θ) ≤ ρ−1/2 and so |ωθ − ω ˜θ| . ρ−1/2. Since |˜xn| ≤ ρ, |2˜xnωθ −
2˜xnω ˜θ| . ρ1/2. By the deﬁnition of ˜Tθ,v, |v + ¯v(θ, y) − ˜v| . R1/2+δ/2. Comparing (7.4) and (7.5),
we see that HausDist(Tθ,v ∩ B(y, ρ), T ˜θ,˜v) . R1/2+δ as desired.

Since Dist(˜θ, θ) ≤ ρ−1/2 it follows that Angle(G(θ), G(˜θ)) . ρ−1/2.

(cid:3)
Many diﬀerent (θ, v) lead to essentially the same set ˜Tθ,v. If Dist(θ1, θ2) ≤ ρ−1/2, and |v1 +
¯v(θ1, y) − v2 − ¯v(θ2, y)| ≤ R1/2+δ/2, then ˜Tθ1,v1 and ˜Tθ2,v2 are essentially the same. We can organize
the possible pairs (θ, v) into equivalence classes in the following way. If ˜θ is one of our caps of radius
ρ−1/2, and w ∈ R1/2+δ/2Zn−1, then we deﬁne

T˜θ,w := {(θ, v) : Dist(θ, ˜θ) . ρ−1/2 and |v + ¯v(θ, y) − w| . R1/2+δ/2}.

(7.6)
If (θ1, v1) and (θ2, v2) lie in the same set T˜θ,w, then ˜Tθ1,v1 and ˜Tθ2,v2 are essentially the same. They
are both contained in (and essentially equal to)

(7.7)

˜T˜θ,w := {(˜θ1, ˜v) : Dist(˜θ1, ˜θ) . ρ−1/2 and |w − ˜v| . R1/2+δ/2}.

Now Lemma 7.1 gives the following corollary.

30

LARRY GUTH

Lemma 7.3. If g is concentrated in wave packets in T˜θ,w, then ˜g is concentrated in wave packets
in ˜T˜θ,w. In other words, if

then

g = X(θ,v)∈T ˜θ,w

˜g = X( ˜θ,˜v)∈˜T ˜θ,w

gθ,v + RapDec(R)kgkL2,

˜g ˜θ,˜v + RapDec(R)kgkL2.

We also note that the sets T˜θ,w are essentially disjoint, and their union contains all the possible
pairs (θ, v). Similarly, the sets ˜T˜θ,w are essentially disjoint and their union contains all possible
pairs (˜θ, ˜v). With this in mind, we deﬁne

(7.8)

(7.9)

g ˜θ,w := X(θ,v)∈T ˜θ,w
(˜g)˜θ,w := X( ˜θ,˜v)∈˜T ˜θ,w

gθ,v.

(˜g)˜θ,˜v.

For any g, we get a decomposition g =P˜θ,w g ˜θ,w obeying with

(7.10)

(7.11)

Similarly, for any ˜g, we get a decomposition ˜g =P˜θ,w ˜g ˜θ,w with

kgk2

L2 ∼ X( ˜θ,w)

kg ˜θ,wk2

L2,

k˜gk2

L2 ∼ X( ˜θ,w)

k˜g ˜θ,wk2

L2.

By Lemma 7.2, for all the pairs (θ, v) ∈ T˜θ,w, the sets Tθ,v ∩ B(y, ρ) are essentially the same. We
denote this intersection by T ˜θ,w ⊂ B(y, ρ). It is a tube of radius R1/2+δ and length ρ. The set T˜θ,w
can be described geometrically as the set of pairs (θ, v) so that Tθ,v ∩ B(y, ρ) is essentially T ˜θ,w,
and so that the direction of Tθ,v obeys the inequality Angle(G(θ), G(˜θ)) . ρ−1/2.

We will need to study the following situation. We have a function g which is concentrated on
wave packets in TZ , and we want to study Eg on a smaller ball B(y, ρ) ⊂ BR. If we decompose
g into wave packets associated to the ball B(y, ρ), what can we say about the new wave packet
decomposition?

First of all, we point out the wave decompositon of ˜g at scale ρ is not necessarily concentrated on
wave packets that are tangent to Z on B(y, ρ). By Lemma 7.1, we do know that ˜g is concentrated
˜Tθ,v. If (θ, v) ∈ TZ, then we know that Tθ,v is tangent to Z on BR,
on wave packets in ∪(θ,v)∈TZ
which implies that

and that for any x ∈ Tθ,v and z ∈ Z ∩ B(y, ρ) with |x − z| . R1/2+δm,

Tθ,v ∩ B(y, ρ) ⊂ NR1/2+δm (Z) ∩ B(y, ρ),

RESTRICTION ESTIMATES USING POLYNOMIAL PARTITIONING II

31

If now (˜θ, ˜v) ∈ ˜Tθ,v, then (7.2) and (7.3) imply that

Angle(G(θ), TzZ) . R−1/2+δm.

and that for any x ∈ T ˜θ,˜v and z ∈ Z ∩ B(y, ρ) with |x − z| . R1/2+δm,

T ˜θ,˜v ⊂ NR1/2+δm (Z) ∩ B(y, ρ),

Angle(G(θ), TzZ) . R−1/2+δm + ρ−1/2 ≤ ρ−1/2+δm.

The angle condition is more than strong enough for T ˜θ,˜v to be tangent to Z in B(y, ρ), but it is
not true that T ˜θ,˜v ⊂ Nρ1/2+δm (Z) ∩ B(y, ρ). If T ˜θ,˜v intersects Nρ1/2+δm (Z) ∩ B(y, ρ), then the angle
condition guarantees that T ˜θ,˜v is contained in N2ρ1/2+δm (Z) ∩ B(y, ρ). A bit more generally, if b is
a vector with |b| ≤ R1/2+δm, and if T ˜θ,˜v intersects Nρ1/2+δm (Z + b) ∩ B(y, ρ), then T ˜θ,˜v is contained
in N2ρ1/2+δm (Z + b) ∩ B(y, ρ), and T ˜θ,˜v is tangent to Z + b in Bj.

For any b ∈ BR1/2+δm , we deﬁne

˜TZ+b := {(˜θ, ˜v) : T ˜θ,˜v is tangent to Z + b in Bj}.

˜gb := X( ˜θ,˜v)∈˜TZ+b

˜g ˜θ,˜v.

So we see that if g is concentrated on wave packets in TZ , then ˜g is concentrated on wave packets
˜Tθ,v, we saw above that either (˜θ, ˜v) ∈ ˜TZ+b, or else

in ∪|b|.R1/2+δm
T ˜θ,˜v is disjoint from Nρ1/2+δm (Z) ∩ B(y, ρ). Therefore, for x = y + ˜x ∈ B(y, ρ),

˜TZ+b. For any (˜θ, ˜v) ∈ ∪(θ,v)∈TZ

(7.12)

|E˜gb(˜x)| ∼ χN

ρ1/2+δm (Z+b)(x)Eg(x).

To get ﬁner information, it is helpful to decompose g as above as g = P˜θ,w g ˜θ,w, and to think

about the wave packet decomposition of each piece (g ˜θ,w)∼ on B(y, ρ). For brevity, we let h = g ˜θ,w.
We choose a ball B(x0, R1/2+δm ) with x0 ∈ T ˜θ,w ⊂ B(y, ρ). For any (θ, v) ∈ T˜θ,w, Tθ,v ∩ B(y, ρ) ⊂
T ˜θ,w, and so Tθ,v intersects B(x0, R1/2+δm) in a tube segment of length R1/2+δm.

By Lemma 3.4, we have

(7.13)

khk2

L2 ∼ R−1/2−δmkEhk2

L2(B(x0,R1/2+δm )).

Now we know that E˜h(˜x) = Eh(˜x + y). Also, for x = y + ˜x ∈ B(y, ρ), we know by (7.12) that

Using Lemma 3.4 again, we have

|E˜hb(˜x)| ∼ χN

ρ1/2+δm (Z+b)(x)Eh(x).

(7.14)

k˜hbk2

L2 ∼ R−1/2−δmkEhk2

L2(B(x0,R1/2+δm )∩N

ρ1/2+δm (Z+b)).

These observations lead to a couple estimates about how k˜hbkL2 relates to khkL2.

32

LARRY GUTH

Lemma 7.4. Suppose that h is concentrated on wave packets in T˜θ,w for some (˜θ, w), and x0 is in
the tube T ˜θ,w. If we choose a set of vectors b ∈ BR1/2+δm so that the sets

are disjoint, then

B(x0, R1/2+δm ) ∩ Nρ1/2+δm (Z + b)

Finally, we come to transverse equidistribution estimates. Combining the transverse equidistri-
bution estimate in Lemma 6.2 with the considerations in this section, we get the following estimates.

k˜hbk2

L2 . khk2

L2.

Xb

Lemma 7.5. Suppose that h is concentrated on wave packets in TZ and also on wave packets in
T˜θ,w for some (˜θ, w). Then for any b ∈ BR1/2+δm , we have
L2 ≤ RO(δm)(cid:18) R1/2
ρ1/2(cid:19)

k˜hbk2

khk2

−(n−m)

L2.

Proof. We combine (7.14), Lemma 6.2, and (7.13):

k˜hbk2

L2 ∼ R−1/2−δmkEhk2

L2(B(x0,R1/2+δm )∩N

ρ1/2+δm (Z+b))

. R−1/2−δmRO(δm)(cid:18) R1/2
ρ1/2 (cid:19)
∼ RO(δm)(cid:18) R1/2
ρ1/2 (cid:19)

−(n−m)

−(n−m)

kEhk2

L2(B(x0,R1/2+δm ))

khk2

L2.

(cid:3)

We can now combine the diﬀerent (˜θ, w) in order to get estimates for g.

Lemma 7.6. If g is concentrated in wave packets in TZ , then for any b,

k˜gbk2

L2 ≤ RO(δm)(cid:18) R1/2
ρ1/2 (cid:19)

−(n−m)

kgk2

L2.

Proof. We ﬁrst expand g =P˜θ,w g ˜θ,w. The wave packets contributing signiﬁcantly to each g ˜θ,w are

a subset of those contributing to g, and so each g ˜θ,w is concentrated on wave packets in TZ . For
each ˜θ, w, Lemma 7.5 tells us that

k(g ˜θ,w)∼

b k2

L2 ≤ RO(δm)(cid:18) R1/2
ρ1/2 (cid:19)

−(n−m)

kg ˜θ,wk2

L2.

We know that the g ˜θ,w are orthogonal, and so

The operation f 7→ ˜fb is a linear map, and so

kgk2

L2 ∼X˜θ,w

kg ˜θ,wk2

L2.

RESTRICTION ESTIMATES USING POLYNOMIAL PARTITIONING II

33

(g ˜θ,w)∼
b .

˜gb =X˜θ,w

We claim that this is also an orthogonal decomposition. By Lemma 7.3, (g ˜θ,w)∼ is concentrated
is also concentrated on wave packets in ˜T˜θ,w. The
b are orthogonal, as claimed. Therefore

on wave packets in ˜T˜θ,w. But then (g ˜θ,w)∼
diﬀerent sets ˜T˜θ,w are disjoint, and so the functions (g ˜θ,w)∼

b

Combining these estimates gives the desired conclusion.

k˜gbk2

L2 ∼X˜θ,w

k(g ˜θ,w)∼

b k2

L2.

(cid:3)

We now formulate the inductive estimate that proves Theorem 1.5.

8. Proof of Theorem 1.5.

Proposition 8.1. For ǫ > 0, there are small constants 0 < δ ≪ δn−1 ≪ ... ≪ δ1 ≪ δ0 ≪ ǫ, and a
large constant ¯A so that the following holds.

Let m be a dimension in the range 1 ≤ m ≤ n. Suppose that Z = Z(P1, ..., Pn−m) is a transverse
complete intersection where Deg Pi ≤ DZ. Suppose that f is concentrated on wave packets from
TZ . Then for any 1 ≤ A ≤ ¯A, and any radius 1 ≤ R,

(8.1)

for all

(8.2)

where

(8.3)

kEf kBLp

k,A(BR) ≤ C(K, ǫ, m, DZ)RǫRδ(log ¯A−log A)R−e+ 1

2 kf kL2,

2 ≤ p ≤ ¯p(k, m) := 2 ·

m + k

m + k − 2

,

e = e(k, n, p) =

1

2(cid:18) 1

2

−

1

p(cid:19) (n + k).

When m = n, Proposition 8.1 gives Theorem 1.5. When m = n, we can take Z = Rn (and
DZ = 1). Now if we choose A = ¯A and p = ¯p(k, n), then we compute −e + 1/2 = 0, and we get the
inequality in Theorem 1.5.

We prove Proposition 8.1 by induction. We will do induction on the dimension m, the radius
R, and on A. We start by checking the base of the induction. When R is small, we choose the
constant C(K, ǫ, m, DZ) suﬃciently large and the result follows. So from now on, we can assume
that R is very large compared to K, ǫ, m, DZ. To check the case A = 1, we choose ¯A large enough
so that Rδ(log ¯A−log 1) = R10n, and the inequality follows because kEf kBLp
k,1(BR) ≤ |BR|kf kL2. The
base of the induction on m is m = k − 1. In this case, since A ≥ 1, we have

(8.4)

kEf kBLp
This follows from the deﬁnition of BLp
where

k,A(BR) ≤ RapDec(R)kf kL2.
k,A. Recall that kEf kp

BLp

k,A(BR) := PBK2 ⊂BR

µEf (BK 2 ),

34

LARRY GUTH

µEf (BK 2 ) :=

V1,...,VA (k − 1)-subspaces of Rn 

min

τ :Angle(G(τ ),Va)>K−1 for all aZBK2

max

|Efτ |p! .

Fix a ball B = BK 2 ⊂ NR1/2+δm (Z) ∩ BR, and let V be the tangent space to Z at some point z
in the R1/2+δm-neighborhood of the ball BK 2 . Notice that the dimension of V is m = k − 1. If
Tθ,v intersects BK 2 and if (θ, v) ∈ TZ , then Angle(G(θ), V ) . R−1/2+δm. So if τ contains a θ with
(θ, v) ∈ TZ for some v, then Angle(G(τ ), V ) ≤ K −1. On the other hand, if τ does not contain
such a θ, then kfτ kL2 ≤ RapDec(R)kf kL2, because f is concentrated on wave packets tangent to
Z. Therefore,

 

τ :Angle(G(τ ),V )>K−1ZBK2

max

|Efτ |p! ≤ RapDec(R)kf kp

L2.

On the other hand, if BK 2 ⊂ BR is not contained in NR1/2+δm (Z), then on BK 2, |Ef | ≤ RapDec(R)kf kL2.
This proves (8.4), establishing the base case m = k − 1.

For p = 2, Proposition 8.1 follows quickly from the basic L2 estimate in Lemma 3.2:

kEf k2

BL2

k,A(BR) ≤Xτ

kEfτ k2

L2(BR)

kfτ k2

L2 = Rkf k2

L2.

. RXτ

Next we begin the inductive step. We assume that Proposition 8.1 holds if we decrease the

dimension m, the radius R, or the value of A. We deﬁne p to be

p = ¯p(k, m) if m > k,

p = ¯p(m, m) + δ if m = k.

We will check the main estimate (8.1) for this value of p. Once we check (8.1) for this value of p,
we can get the whole range in (8.2) by interpolation between 2 and our value of p, using the Holder
inequality for BL in Lemma 4.2.

There are two cases, depending on whether or not the mass of µ is concentrated into a small
neighborhood of a lower dimensional variety. We let D(ǫ, DZ) be a function that we will deﬁne
later. We say we are in the algebraic case if there is a transverse complete intersection Y l ⊂ Z m of
dimension l < m, deﬁned using polynomials of degree ≤ D(ǫ, DZ), so that

µEf (NR1/2+δm (Y ) ∩ BR) & µEf (BR).

Otherwise, we say that we are in the non-algebraic case, or the cellular case.

We begin with the non-algebraic case. In this case, we will use polynomial partitioning. To set up
the polynomial partitioning, we ﬁrst locate a signiﬁcant piece of NR1/2+δm (Z)∩BR where the tangent
space of Z is not changing too fast. We say that a ball B(x0, R1/2+δm) ⊂ NR1/2+δm (Z) ∩ BR is
regular if, on each connected component of Z ∩ B(x0, 10R1/2+δm), the tangent space T Z is constant
up to angle 1
100 . Let w ∈ ΛmRn. Recall that Zw ⊂ Z is deﬁned in (5.2). For generic w, Zw ⊂ Y is
a transverse complete intersection of dimension m − 1, deﬁned using polynomials of degree . DZ.
We can choose a set of . 1 values of w so that on each connected component of Z \ ∪wZw, the
tangent plane T Z is constant up to angle 1

100 . Since we are in the non-algebraic case,

RESTRICTION ESTIMATES USING POLYNOMIAL PARTITIONING II

35

µEf (∪wN10R1/2+δm (Zw) ∩ BR) ≤

1

100

µEf (BR).

Each ball B(x0, R1/2+δm) ⊂ NR1/2+δm (Z) ∩ BR which does not intersect ∪wN10R1/2+δm (Zw) is a
regular ball. So the regular balls contain most of the mass of µ.

For each regular ball B = BR1/2+δm ⊂ ˜NR1/2+δm (Z) ∩ BR, we pick a point z ∈ Z ∩ BR1/2+δm and
we deﬁne VB to be the m-plane TzZ. For an m-plane V , we deﬁne BV to be the set of regular balls
so that Angle(VB, V ) ≤ 1

100 . By pigeonholing, we can choose a plane V so that

µEf (∪B∈BV B) & µEf (BR).

We deﬁne N1 ⊂ NR1/2+δm (Z)∩BR to be the union of the balls B ∈ BV . We let µ1 be the restriction
of µEf to N1, and we note that µ1(N1) ∼ µEf (BR).

Now we are ready to do polynomial partitioning. We let PV denote a polynomial deﬁned on
V : PV : V → R. We let π : Rn → V be the orthogonal projection. Now we apply polynomial
partitioning, Theorem 5.5, to the push-forward measure π∗µ1 on V , using the degree D = D(ǫ, DZ).
Theorem 5.5 gives us a non-zero polynomial PV of degree at most D so that V \ Z(PV ) = ∪iOV,i,
the number of cells OV,i is ∼ Dm, and for each cell, π∗µ1(OV,i) is ∼ D−mπ∗µ1(V ). Moreover,

transversality purposes.

PV = Qj QV,j where each QV,j has a little freedom in the constant term, which we can use for

We extend V to a polynomial P on Rn by setting P (x) := PV (π(x)). We note that Z(P ) =
π−1(Z(PV )). We deﬁne Oi := π−1OV,i, and we note that Rn \ Z(P ) = ∪iOi and that µ1(Oi) =

π∗µ1(OV,i) ∼ D−mµ1(N1). Similarly, we deﬁne Qj(x) = QV,j(π(x)) so that P = Qj Qj. Each Qj

is a polynomial of degree at most D on Rn, and we have a little freedom in the constant term of
each Qj. By Lemma 5.1, we can guarantee that for each j, Yj = Z(P1, ..., Pn−m, Qj) is a transverse
complete intersection.

We deﬁne W := NR1/2+δ Z(P ), and O′
tube Tθ,v enters at most D of the cells O′

i := Oi \ W . Since each tube Tθ,v has radius R1/2+δ, each
i. On the other hand, we claim that

W ∩ N1 ⊂[j

N20R1/2+δm (Yj).

Here is the proof of the claim. Suppose that x ∈ W ∩ N1. Since x ∈ N1, x is in a regular ball
B = B(x0, R1/2+δm) ∈ BV . There is a point zB ∈ Z ∩ B with Angle(TzB Z, V ) ≤ 1
100 . Let ZB be
the component of Z ∩ 10B containing this point zB. On ZB, the tangent plane T Z makes a small
angle with V . Let us use coordinates (v, w), where v ∈ V and w ∈ V ⊥. Since the tangent plane
of T ZB makes a small angle with V , ZB is the graph of a function, w = h(v), where h has small
Lipschitz constant ≤ 1
100 . Since x ∈ W , there must be a point (v0, w0) ∈ Z(P )∩B(x, R1/2+δ ). Since
P (v, w) = PV (v) we see that PV (v0) = 0. Now the point (v0, h(v0)) lies both in Z(P ) and in ZB,
and so it lies in Yj for some j. Since (v0, h(v0)) ∈ ZB ⊂ B(x0, 10R1/2+δm) and x ∈ B(x0, R1/2+δm ),
it follows that x ∈ N20R1/2+δm (Yj) as desired.

Since we are in the non-algebraic case, µ1(N20R1/2+δm (Yj)) is negligible for each j, and so

µ1(W ) = µ1(W ∩ N1) is negligible. Therefore, we have

(8.5)

µ1(O′

i) ∼ D−mµ1(N1) ∼ D−mkEf kp

BLp

k,A(BR) for the vast majority of i.

Now for each index i we deﬁne a function fi which only includes the wave packets that enter O′
i.

More precisely, fi =P(θ,v)∈Ti

fθ,v where

36

(8.6)

LARRY GUTH

Ti := {(θ, v) such that Tθ,v ∩ O′

i 6= ∅}.

Each function fi is also concentrated on wave packets in TZ. Moreover, there are ∼ Dm cells O′
i

for which

kEf kp

k,A(BR) . Dmµ1(O′

BLp

i) . DmµEfi (O′

i) . DmkEfikp

BLp

k,A(BR).

On the other hand, we have good control on the L2 norms of fi. Because each tube Tθ,v enters

. D cells O′

i, each pair (θ, v) belongs to Ti for . D values of i, and so

Xi

kfik2

L2 ∼Xi X(θ,v)∈Ti

kfθ,vk2

L2 . D X(θ,v)

In summary, there are ∼ Dm choices of i so that

kfθ,vk2

L2 ∼ Dkf k2

L2.

(8.7)

(8.8)

kEf kp

k,A(BR) . DmkEfikp

BLp

k,A(BR).

BLp

kfik2

L2 . D1−mkf k2

L2.

(For later reference, we also record here: for each i and each θ,

(8.9)

kfi,θk2

L2 . Xθ′∩θ6=∅

kfθ′k2

L2.

This inequality doesn’t appear in the proof of Theorem 1.5, but it could be useful in some later
reﬁnements.)

Using these estimates, we can now prove (8.1) by induction on the radius. To make the compu-

tation clearer, we abbreviate

so (8.1) reduces to

E = ¯C(K, ǫ, m, DZ)RǫRδ(log ¯A−log A)R−e+ 1
2 ,

Since we assume that (8.1) holds on balls of radius R/2, it follows that it also holds on balls of

radius R up to a constant factor loss. So we can assume that

kEf kBLp

k,A(BR) ≤ Ekf kL2.

(8.10)

kEfikBLp

k,A(BR) ≤ CEkfikL2.

Now using (8.7) and (8.8), we get

kEf kp

k,A(BR) . DmkEfikp

BLp

k,A(BR) . DmEpkfikp

BLp

L2 . Dm−(m−1) p

2 Epkf kp

L2.

By our choice of p, p > 2m

m−1 , and so the exponent of D is negative. If m > k, the exponent
is negative with pretty large absolute value; if m = k, then the exponent is −δ.
If we choose
D = D(ǫ, DZ) suﬃciently large, the power of D dominates the implicit constant, and we get
kEf kBLp

k,A(BR) ≤ Ekf kL2, which closes the induction in the non-algebraic case.

RESTRICTION ESTIMATES USING POLYNOMIAL PARTITIONING II

37

Next we turn to the algebraic case. By deﬁnition, we know that there is a transverse complete
intersection Y l of dimension l < m, deﬁned using polynomials of degree ≤ D = D(ǫ, DZ), so that

(8.11)

µEf (NR1/2+δm (Y )) & µEf (BR).

In the algebraic case, we subdivide BR into smaller balls Bj of radius ρ, chosen so that

(8.12)

For each j, we deﬁne fj =P(θ,v)∈Tj

ρ1/2+δl = R1/2+δm.

fθ,v, where

Tj := {(θ, v)|Tθ,v ∩ NR1/2+δm (Y ) ∩ Bj 6= ∅}.

On NR1/2+δm (Y ) ∩ Bj, Efj = Ef + RapDec(R)kf kL2. Therefore,

kEf kp

BLp

k,A(BR) .Xj

kEfjkp

k,A(Bj ) + RapDec(R)kf kp
L2.

BLp

We further subdivide Tj into tubes that are tangential to Y and tubes that are transverse to Y .

As in deﬁnition 6.1, we say that Tθ,v is tangent to Y in Bj if

(8.13)

Tθ,v ∩ 2Bj ⊂ NR1/2+δm (Y ) ∩ 2Bj = Nρ1/2+δl (Y ) ∩ 2Bj,

and for any x ∈ Tθ,v and y ∈ Y ∩ 2Bj with |x − y| . R1/2+δm = ρ1/2+δl,

(8.14)

Angle(G(θ), T Yy) . ρ−1/2+δl.

We deﬁne the tangential wave packets by

And we deﬁne the transverse wave packets by

Tj,tang = {(θ, v) ∈ Tj|Tθ,v is tangent to Y in Bj}.

Tj,trans := Tj \ Tj,trans.

We deﬁne fj,tang =P(θ,v)∈Tj,tang

fθ,v and fj,trans =P(θ,v)∈Tj,transfθ,v

fj = fj,tang + fj,trans.

so

Therefore we have

(8.15)

Xj

kEfjkp

BLp

k,A(Bj ) .Xj

kEfj,tangkp

BLp

k,A/2(Bj ) +Xj

kEfj,transkp

BLp

k,A/2(Bj ).

We will control the contribution of the tangential wave packets by induction on the dimension
m, and we will control the contribution of the transverse wave packets by induction on the radius
R.

Suppose ﬁrst that the tangential wave packets dominate the right-hand side. In order to apply
induction to Efj,tang on Bj, we redo the wave packet decomposition at a scale appropriate to Bj,
as in Section 7. For brevity, during this discussion, we let g = fj,tang.

38

LARRY GUTH

˜g ˜θ,˜v + RapDec(R)kf kL2.

˜g =X˜θ,˜v

Before applying induction, we need to check that this wave packet decomposition is concentrated
on pairs (˜θ, ˜v) that are tangent to Y on Bj, in the sense of Deﬁnition 6.1: in other words on pairs
(˜θ, ˜v) so that

(8.16)

T ˜θ,˜v ⊂ Nρ1/2+δl (Y ) ∩ Bj,

and for any x ∈ T ˜θ,˜v and y ∈ Y ∩ Bj with |x − y| . ρ1/2+δl,

(8.17)

Angle(G(˜θ), TyY ) . ρ−1/2+δl .

We know that g = fj,tang is concentrated on wave packets (θ, v) ∈ Tj,tang, which obey (8.13) and
(8.14). These tell us that Tθ,v ∩ Bj lies in the desired neighborhood of Y ∩ Bj and makes a good
angle with TyY . For any (θ, v), (fθ,v)∼ is concentrated on wave packets (˜θ, ˜v) ∈ ˜Tθ,v, by Lemma
7.1. For (˜θ, ˜v) ∈ ˜Tθ,v, (7.2) and (7.3) tell us that T ˜θ,˜v lies in a small neighborhood of Tθ,v ∩ Bj and
makes a small angle with Tθ,v. So if (θ, v) ∈ Tj,tang and (˜θ, ˜v) ∈ ˜Tθ,v, then T ˜θ,˜v obeys (8.16) and
(8.17). We have now checked the hypotheses of Proposition 8.1 for ˜g with the variety Y on the ball
Bj, and so we can apply induction on the dimension.

By induction on the dimension, we get the following inequality:

kEfj,tangkBLp

k,A/2(Bj ) = kE˜gkBLp

k,A/2(Bρ)

≤ C(K, ǫ/2, l, D(ǫ, DZ))ρǫ/2ρδ(log ¯A−log(A/2))ρ−e+ 1

2 kfj,tangkL2,

2 ≤ p ≤ ¯p(k, l) := 2 ·

l + k

l + k − 2

,

for

where

e = e(k, n, p) =

1

2(cid:18) 1

2

−

1

p(cid:19) (n + k).

Since l < m, ¯p(k, m) < ¯p(k, l), and so our value of p is in the range 2 ≤ p ≤ ¯p(k, l) and the bound
above applies. The number of balls Bj is . RO(δl). Summing brutally over the balls, we see that

kEf kBLp

k,A(BR) . RO(δl)C(K, ǫ/2, l, D(ǫ, DZ))ρǫ/2ρδ(log ¯A−log(A/2))ρ−e+ 1

2 kf kL2.

We note that the exponent −e+1/2 may well be negative. Nevertheless, ρ−e+1/2 ≤ RO(δl)R−e+1/2.

Also, ρδ(log ¯A−log A/2) ≤ Rδ(log ¯A−log A/2) = RδRδ(log ¯A−log A). Therefore, the last expression is

≤ RO(δl)C(K, ǫ/2, l, D(ǫ, DZ))Rǫ/2Rδ(log ¯A−log(A/2))R−e+ 1

2 kf kL2.

Since δl is much smaller than ǫ, RO(δl)Rǫ/2 is smaller than Rǫ and the induction closes. (We
have to choose C(K, ǫ, m, DZ) larger than C(K, ǫ/2, l, D(ǫ, DZ)). ) This ﬁnishes the discussion of
the tangential algebraic case.

Suppose now that the transverse wave packets dominate (8.15). First, we note that

RESTRICTION ESTIMATES USING POLYNOMIAL PARTITIONING II

39

kfj,transk2

|{j : (θ, v) ∈ Tj,trans}|kfθ,vk2

L2.

Xj

L2 =Xθ,v

Next we claim that for each (θ, v), |{j : (θ, v) ∈ Tj,trans}| .ǫ,DZ 1. In the discussion, we just
abbreviate this as . 1. This follows from Lemma 5.7, which controls the transverse intersections
between a tube and an algebraic variety. Let T be the cylinder with the same center as T ˜θ,˜v and
with radius r = R1/2+δm = ρ1/2+δl, and let α = ρ−1/2+δl. Let ℓ denote the central axis of T and
recall that Y>α is the set {y ∈ Y | Angle(TyY, ℓ) > α}. If (θ, v) ∈ Tj,trans, then T ∩ Y>α ∩ 2Bj
must be non-empty. However, Lemma 5.7 tells us that T ∩ Y>α is contained in ≤ CDn
Y balls of
radius . rα−1 ∼ ρ. Here Y is deﬁned by polynomials of degree DY ≤ D(ǫ, DZ) . 1. Therefore,
(θ, v) ∈ Tj,trans for . 1 values of j. Plugging this into the last equation, we get

(8.18)

kfj,transk2

L2 . kf k2

L2.

Xj

Next we would like to study Efj,trans on each ball Bj by doing induction on the radius. In order
to do so, we redo the wave packet decomposition at a scale appropriate to Bj, as in Section 7. For
brevity, during this discussion, we let g = fj,trans.

We recall a couple deﬁnitions from Section 7. For any b ∈ BR1/2+δm , we deﬁne

˜g ˜θ,˜v + RapDec(R)kf kL2.

˜g =X˜θ,˜v

˜TZ+b := {(˜θ, ˜v) : T ˜θ,˜v is tangent to Z + b in Bj}.

˜gb := X( ˜θ,˜v)∈˜TZ+b

˜g ˜θ,˜v.

For each b, ˜gb is concentrated in wave packets tangent to Z + b in the ball Bj, and so we will
be able to apply induction on the radius to study E˜gb. By (7.12), if yj is the center of Bj and
x = yj + ˜x ∈ Bj, then

(8.19)

|E˜gb(˜x)| ∼ χN

ρ1/2+δm (Z+b)(x)|Eg(x)|.

We deﬁne fj,trans,b so that (fj,trans,b)∼ = ˜gb (in other words, fj,trans,b = e−iψy(ω)˜gb). In this

language, the last equation becomes

(8.20)

|Efj,trans,b(x)| ∼ χN

ρ1/2+δm (Z+b)(x)|Efj,trans(x)|.

Next we choose a set of vectors b ∈ BR1/2+δm . The number of vectors b that we choose is related
to the geometry of Z. We cover NR1/2+δm (Z) ∩ Bj with disjoint balls of radius R1/2+δm, and in
each ball B we note the volume of B ∩ Nρ1/2+δm (Z). We dyadically pigeonhole this volume: for
each s we consider

Bs := {B(x0, R1/2+δm) ⊂ NR1/2+δm (Z) ∩ Bj : |B(x0, R1/2+δm) ∩ Nρ1/2+δm (Z)| ∼ 2s}.

We select a value of s so that

40

LARRY GUTH

kEfj,transkBLp

k,A/2(∪B∈Bs B) & (log R)−1kEfj,transkBLp

k,A/2(Bj ).

Next we prune Tj,trans a little: we include (θ, v) only if Tθ,v intersects one of the balls of Bs. To
avoid making the notation even heavier, we don’t make a separate notation for the pruned set. This
pruning can only decrease kfj,transkL2, and it changes kEfj,transkp
k,A/2(Bj ) by at most a factor of
log R.

BLp

Now we are ready to choose our set of translations {b}. We choose a random set of |BR1/2+δm |/2s
vectors b ∈ BR1/2+δm . For a typical ball B(x0, R1/2+δm) ∈ Bs, the union ∪bNρ1/2+δm (Z + b) covers
a deﬁnite fraction of the ball (in a random way). Therefore, with high probability, we get

(8.21)

kEfj,transkp

BLp

kEfj,trans,bkp

BLp

k,A/2(N

ρ1/2+δm (Z+b)∩Bj ).

k,A/2(Bj ) .Xb

On the other hand, a typical point of B(x0, R1/2+δm) lies in . 1 of the sets Nρ1/2+δm (Z +b). Because
of this geometric fact, we claim that

(8.22)

k˜gbk2

L2 . kgk2

L2.

Xb

To see this, we decompose g =P˜θ,w g ˜θ,w as in Section 7. If g ˜θ,w is not neglibigle, then T ˜θ,w must

intersect one of the balls B(x0, R1/2+δm ) ∈ Bs. Since the sets Nρ1/2+δm (Z + b) ∩ B(x0, R1/2+δm)
are essentially disjoint, Lemma 7.4 tells us that

But (as we saw in the proof of Lemma 7.6),

k(g ˜θ,w)∼

b k2

L2 . kg ˜θ,wk2

L2.

Xb

(g ˜θ,w)∼

b

˜gb =X˜θ,w

is an orthogonal decomposition, and g =P˜θ,w g ˜θ,w is an orthogonal decomposition, and so

k(g ˜θ,w)∼

b k2

kg ˜θ,wk2

L2 ∼ kgk2

L2.

Xb

k˜gbk2

L2 ∼ Xb, ˜θ,w

L2 .X˜θ,w

We now have all the estimates that we need in the transverse case, and we collect them here.

(8.23)

(8.24)

By Lemma 7.6,

(8.25)

max

b

kEf kp

BLp

k,A(BR) . log RXj,b

kEfj,trans,bkp

BLp

k,A/2(Bj ).

kfj,trans,bk2

L2 . kf k2

L2.

Xj,b

kfj,trans,bk2

L2 ≤ RO(δm)(cid:18) R1/2
ρ1/2 (cid:19)

−(n−m)

kfj,transk2

L2.

RESTRICTION ESTIMATES USING POLYNOMIAL PARTITIONING II

41

(For later reference, we also record here: for each j, b and each ˜θ,

(8.26)

kfj,trans,bk2

L2( ˜θ) . RO(δm)(cid:18) R1/2
ρ1/2 (cid:19)

−(n−m)

kf k2

L2(2 ˜θ).

This follows from Lemma 7.6. This inequality doesn’t appear in the proof of Theorem 1.5, but it
could be useful in some later reﬁnements.)

By induction on the radius, we know that

kEfj,trans,bkBLp

k,A/2(Bj ) ≤ C(K, ǫ, m, DZ)ρǫρδ(log ¯A−log(A/2))ρ−e+ 1

2 kfj,trans,bkL2

2 kfj,trans,bkL2.
Using these estimates, we can now prove (8.1) by induction on the radius.

≤ C(K, ǫ, m, DZ)RδρǫRδ(log ¯A−log A)ρ−e+ 1

kEf kp

BLp

k,A(BR) . (log R)Xj,b

kEfj,trans,bkp

BLp

k,A/2(Bj )

2(cid:17)p
≤ RO(δ)(cid:16)C(K, ǫ, m, DZ)ρǫRδ(log ¯A−log(A/2))ρ−e+ 1

Xj,b

kfj,trans,bkp

L2.

Using (8.25) and (8.24),

kfj,trans,bkp

L2 . RO(δm)(cid:18) R1/2
ρ1/2(cid:19)

−(n−m)( p

2 −1)

kf kp

L2.

Xj,b

Now plugging in we get

kEf kp

BLp

k,A(BR) . RO(δm)(cid:16)C(K, ǫ, m, DZ)ρǫRδ(log ¯A−log A)ρ−e+ 1

2(cid:17)p(cid:18) R1/2
ρ1/2 (cid:19)

At the exponent p = ¯p(k, m),

−(n−m)( p

2 −1)

kf kp

L2.

−(n−m)( p

2 −1)

(cid:16)ρ−e+1/2(cid:17)p(cid:18) R1/2
ρ1/2 (cid:19)

=(cid:16)R−e+1/2(cid:17)p

.

(If m = k, so that p = ¯p(k, m) + δ, then this is true up to a factor RO(δ).) So plugging in our

values of p and e, and multiplying out, we get

kEf kp

BLp

2(cid:17)p
k,A(BR) ≤ CRO(δm)(R/ρ)−ǫ(cid:16)C(K, ǫ, m, DZ)RǫRδ(log ¯A−log A)R−e+ 1

kf kp

L2.

Here the constant C coming from .’s may depend on ǫ, DZ, the dimension etc. We have to check
that CRO(δm)(R/ρ)−ǫ ≤ 1. Note that R/ρ = Rθ(δl). We choose the δ’s so that δm ≪ ǫδm−1, and
so (R/ρ)−ǫ dominates the other terms. Therefore, the induction closes in the transverse algebraic
case also.

This ﬁnishes the proof of Theorem 1.5.

42

LARRY GUTH

9. Going from k-broad estimates to regular estimates

The paper [BG] introduces a technique to go from multilinear estimates to regular Lp estimates.

In this section, we follow this technique to go from k-broad estimates to regular Lp estimates.

Proposition 9.1. Suppose that for all K, ǫ, the operator E obeys the k-broad inequality:

(9.1)

kEf kBLp

k,A(BR) .K,ǫ Rǫkf kLq.

(Here the quantities k, A, p, q, are ﬁxed, and the inequality holds for all R.)
If p ≤ q ≤ ∞ and p is in the range

(9.2)

then E obeys

(9.3)

2 ·

2n − k + 2

2n − k

≤ p ≤ 2 ·

k − 1
k − 2

,

kEf kLp(BR) .ǫ Rǫkf kLq.

Remarks. The lower bound on p is important. The upper bound is less important, and it could

probably be improved.

n+k−2 . With our choice of k, we also have ¯p(k, n) = 2 · 2n−k+2

Theorem 1.5 together with Proposition 9.1 implies Theorem 1.1. If n is even, we use k = n

2 + 1.
k,A(BR) . Rǫkf kL2 . Rǫkf kLp for p slightly bigger than ¯p(k, n) =
By Theorem 1.5, we have kEf kBLp
2 · n+k
2n−k . Applying Proposition 9.1, we get
kEf kLp(BR) . Rǫkf kLp for p slightly bigger than ¯p(k, n). Interpolating with the trivial L∞ bound
gives this estimate for all p > ¯p(k, n). Finally, applying ǫ-removal ([T1]) gives Theorem 1.1. If n is
odd, we use k = n+1

2 . The argument is the same, (but in this case, ¯p(k, n) > 2 · 2n−k+2

2n−k ).

Proof. By hypothesis, we have an inequality of the form

(9.4)

XBK2 ⊂BR

min

V1,...,VA

max

τ /∈VaZBK2

|Efτ |p ≤ C(K, ǫ)Rpǫkf kp

Lq.

Here V1, ..., VA are (k − 1)-planes, and we write τ /∈ Va as an abbreviation for Angle(G(τ ), Va) >

K −1.

For each BK 2 , we ﬁx a choice of V1, ..., VA achieving the minimum above. Then we can write

A

Xa=1ZBK2 (cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

Xτ ∈Va

p

.

Efτ(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

(9.5)

ZBK2

|Ef |p . K O(1) max

τ /∈VaZBK2

|Efτ |p +

The ﬁrst term is the “broad” part, and it can be controlled by the k-broad estimate. We handle
the second term, the “narrow” part, by a decoupling-type argument. We work with BK 2 so that
we can cleanly apply the decoupling theorem from [B4]. (The paper [BG] contains a diﬀerent but
closely related argument.)

Theorem 9.2. ([B4]) Suppose that g : Rm → C with ˆg supported in the K −2-neighborhood of the
truncated paraboloid. Divide this neighborhood into slabs τ with k − 1 long directions of length K −1

and one short direction of length K −2. Write g = Pτ gτ , where ˆgτ = χτ ˆg. Then on any ball of

radius K 2, for 2 ≤ p ≤ 2 · m

m−1 ,

RESTRICTION ESTIMATES USING POLYNOMIAL PARTITIONING II

43

(9.6)

kgkLp(BK2 ) .δ K δ Xτ

kgτ k2

Lp(WB

K2 )!1/2

,

where WBK2 is a weight measure, approximately the volume measure on BK 2 and rapidly decaying.

Applying this decoupling estimate with m = k − 1, we get the following lemma:

Lemma 9.3.

 ZBK2 (cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

Xτ ∈Va

Efτ(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

p!1/p

.δ K δ"Xτ ∈Va(cid:18)Z WBK2 |Efτ |p(cid:19)2/p#1/2

.

Proof. On BK 2 , we use coordinates (u, v) where v is parallel to Va and u is perpendicular to Va.
We write Bu,K 2 for a ball of radius K 2 in the u-coordinates and Bv,K 2 for a ball of radius K 2
in the v coordinates. If we restrict Efτ to the k − 1-plane {u} × Rk−1 (parallel to Va), then its
Fourier transform is supported in the K −2 neighborhood of a cap τ ′ in the K −2-neighborhood of a
paraboloid. By Theorem 9.2, we get

Using Fubini and Minkowski, we then get

Efτ(cid:13)(cid:13)(cid:13)(cid:13)(cid:13)Lp({u}×Bv,K2 )
(cid:13)(cid:13)(cid:13)(cid:13)(cid:13)
Xτ ∈Va
(cid:13)(cid:13)(cid:13)(cid:13)(cid:13)
Efτ(cid:13)(cid:13)(cid:13)(cid:13)(cid:13)Lp(Bu,K2 ×Bv,K2 )
Xτ ∈Va

.δ K δ Xτ ∈Va

kEfτ k2

Lp({u}×WB

v,K2 )!1/2

.

.δ K δ Xτ ∈Va

kEfτ k2

Lp(WB

K2 )!1/2

.

(cid:3)

The number of τ ∈ Va is . K k−2. Applying Holder’s inequality, we see that

At this point, we have gotten as much as we can from the knowledge that τ ∈ Va, and we relax

.δ K δK (k−2)( p

2 −1) Xτ ∈VaZ WBK2 |Efτ |p.

.δ K δK (k−2)( p

2 −1)Xτ Z WBK2 |Efτ |p.

(9.7)

this estimate to

(9.8)

WBK2 .

PBK2 ⊂BR

(9.9)

p

p

Xτ ∈Va

Efτ(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)
ZBK2 (cid:12)(cid:12)(cid:12)(cid:12)(cid:12)
ZBK2 (cid:12)(cid:12)(cid:12)(cid:12)(cid:12)
Efτ(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)
Xa=1ZBK2 (cid:12)(cid:12)(cid:12)(cid:12)(cid:12)
Xτ ∈Va

Xτ ∈Va

A

XBK2 ⊂BR

Next we sum this inequality over all a = 1, ..., A and over all BK 2 ⊂ BR. We let W =

We note that W . 1 on B2R and W ≤ RapDec(R) outside B2R. Therefore we get

p

. K δK (k−2)( p

2 −1)Xτ Z W |Efτ |p.

Efτ(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

LARRY GUTH

44

(9.10)

(9.12)

Combining this estimate for the narrow part with our estimate for the broad part, we have

. K δK (k−2)( p

|Efτ |p + RapDec(R)kf kp

Lq.

2 −1)Xτ ZB2R

Xτ ∈Va

p

Efτ(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

XBK2 ⊂BR

A

Xa=1ZBK2 (cid:12)(cid:12)(cid:12)(cid:12)(cid:12)
ZBR

(9.11)

|Ef |p ≤ C(K, ǫ)Rpǫkf kp

Lq + CK δK (k−2)( p

2 −1)Xτ ZB2R

|Efτ |p.

With this inequality in hand, we will prove (9.3) by induction on the radius, where we use the
induction assumption in order to handle the contribution of the fτ terms. The inequality we wish
to prove is

|Ef |p ≤ ¯C(ǫ)Rpǫkf kp

Lq .

ZBR

By induction on the radius we can assume that (9.12) holds for radii less than R/2. We use this

induction and parabolic rescaling to handle the contribution of each fτ .

On the ball τ we introduce new coordinates. Let ωτ be the center of τ , and recall that the radius

of τ is K −1. Then we introduce a new coordinate ˜ω ∈ Bn−1, by

(9.13)

˜ω = K(ω − ωτ ).

We rewrite the phase in these coordinates:

x1ω1 + ... + xn−1ωn−1 + xn|ωn|2 = Fcn(x) + ˜x1 ˜ω1 + ... + ˜xn−1 ˜ωn−1 + ˜xn|˜ω|2,

where Fcn(x) denotes a function of x only and

˜xj = K −1(xj + 2ωτ,jxn) for 1 ≤ j ≤ n − 1; ˜xn = K −2xn.

Here ωτ,j denotes the jth coordinate of ωτ . Note that the linear transformation x 7→ ˜x sends BR

into BCRK−1 and has Jacobian ∼ K −(n+1).

We deﬁne

so that

˜fτ (˜ω) = fτ (ω) = fτ (K −1 ˜ω + ωτ ),

|Efτ (x)| = K −(n−1)|E ˜fτ (˜x)|.

By induction on the radius, we can assume that (9.12) holds for ˜fτ on a ball of radius CRK −1:

By change of variables, we have

ZBCRK−1

|E ˜fτ |p . ¯C(ǫ)RpǫK −pǫk ˜fτ kp

Lq .

ZB2R

|Efτ |p . K (n+1)K −(n−1)pZBCRK−1

|E ˜fτ |p .

. ¯C(ǫ)(R/K)pǫK (n+1)−(n−1)pk ˜fτ kp

Lq = ¯C(ǫ)RpǫK (n+1)−(n−1)p−pǫK (n−1) p

q kfτ kp

Lq .

RESTRICTION ESTIMATES USING POLYNOMIAL PARTITIONING II

45

Plugging this bound into (9.11), we get

(9.14)

ZBR

|Ef |p ≤ C(K, ǫ)Rpǫkf kp

Lq + C ¯C(ǫ)RpǫK (k−2)( p

2 −1)+(n+1)−(n−1)p−pǫ+δK (n−1) p

kfτ kp

Lq .

q Xτ

There are K n−1 diﬀerent θ ⊂ Bn−1. Since p ≤ q, we can apply Holder to see that

kfτ kp

Lq ≤ Xτ

Xτ

kfτ kq

Lq!p/q

K (n−1)(1− p

q ) = kf kp

Lq K (n−1)(1− p
q ).

Plugging this into the last inequality, we see that the dependence on q drops out, and we are left
with:

ZBR

(9.15)

|Ef |p ≤ C(K, ǫ)Rpǫkf kp

Lq + C ¯C(ǫ)RpǫK (k−2)( p

2 −1)+(n+1)−(n−1)p+(n−1)−pǫ+δkf kp

Lq .

We can close the induction as long as the exponent of K is negative. (First we choose K large
Lp. Then we choose ¯C(ǫ) suﬃciently
Lp.) Given ǫ > 0, we can choose

enough so that the second term is bounded by (1/2) ¯C(ǫ)Rpǫkf kp
large so that the ﬁrst term is also bounded by (1/2) ¯C(ǫ)Rpǫkf kp
δ < ǫ. So the induction closes as long as

This is equivalent with the lower bound for p in our hypothesis (9.2): 2 · 2n−k+2

2n−k ≤ p.

(cid:3)

(k − 2)(cid:16) p

2

− 1(cid:17) + (n + 1) − (n − 1)p + (n − 1) ≤ 0.

10. Appendix: Keeping track of parameters

We have several small parameters. In this appendix, we try to provide a reference to help the
reader keep track of the parameters. We list all the parameters, how they compare to each other,
and where they appear in the argument.

We begin with the small parameters. For each ǫ > 0, there is a sequence of small parameters

In this sequence, each parameter is far smaller than the next. For instance, we will use that

δ ≪ δn−1 ≪ δn−2 ≪ ... ≪ δ1 ≪ δ0 ≪ ǫ.

δm < ǫδm−1.

The parameter δ appears in the wave packet decomposition. The tubes Tθ,v in the wave packet
decomposition have thickness R1/2+δ. The parameter δm appears in the m-dimensional case of
the main inductive estimate, Proposition 8.1:
concentrated on wave packets that are R−1/2+δm-tangent to Z on the ball BR.

in this estimate we suppose that f = Pθ,v fθ,v is

Another geometric parameter that appears is the radius ρ. In the transverse algebraic case, we
decompose BR into smaller balls Bj. If we are working on tubes that cluster in the neighborhood
of an m-dimensional variety Z, and are transverse to an l-dimensional variety Y , then the radius
of each Bj is ρ given by

ρ1/2+δl = R1/2+δm.
The quotient R/ρ has size Rθ(δl), which dominates RO(δm).

Then there are positive parameters K, A. We have

46

LARRY GUTH

1 ≪ A ≪ K.

We need A = A(ǫ) suﬃciently large to run the proof of Theorem 1.5, and the broad inequality

is most useful when K is much larger than A.

Given ǫ, we then ﬁx the small parameters δ and the larger parameters A, K. Then we consider
R → ∞. In the statement of Theorem 1.5, the constant depends on ǫ and on K. By choosing this
constant large enough, the theorem holds trivially unless R is very large compared to all these ﬁxed
parameters.

11. Further directions

11.1. Variable coeﬃcient operators. I believe that the results in this paper should extend to
a more general class of variable-coeﬃcient operators. For this more general class of operators, the
results would be sharp up to factors of Rǫ. To formulate this more general setup, we ﬁrst write the
extension operator E in a slightly diﬀerent form. We write y = (y′, yn), and we deﬁne the phase
function

(11.1)

Ψpar(y, ω) := y′ · ω + yn|ω|2.

We write BR or Bn
write Ef (x) in the form

R for the ball of radius R (centered at 0) in Rn. For x ∈ BR, it is convenient to

Ef (x) =ZBn−1

eiRΨpar( x

R ,ω)f (ω)dω.

We think of Ψpar as a function from Bn × Bn−1 to R. We now consider other phase functions

Ψ(y, ω), which are small real-analytic perturbations of Ψpar(y, ω) on Bn × Bn−1, and we deﬁne

(11.2)

T f (x) =ZBn−1

eiRΨ( x

R ,ω)f (ω)dω.

We call such an operator a Hormander-type operator with positive deﬁnite phase. Hormander
introduced this type of operator in [H]. Positive deﬁnite phase refers to the fact that the quadratic
form ω 7→ |ω|2 is positive deﬁnite. See also [BG] for more background on this type of operator.

Conjecture 11.1. Suppose that Ψ is a Hormander-type operator with positive deﬁnite phase. Then,
for any ǫ > 0, the operator T obeys the estimate

(11.3)

if

kT f kLp(BR) .ǫ Rǫkf kLp(Bn−1),

p ≥ 2 ·

p ≥ 2 ·

3n + 1
3n − 3

3n + 2
3n − 2

for n odd ,

for n even .

RESTRICTION ESTIMATES USING POLYNOMIAL PARTITIONING II

47

Conjecture 11.1 was proven for n = 2 by Hormander in [H] and for n = 3 by Lee in [L] (and a
diﬀerent proof was given in [BG]). It is open for n ≥ 4. (The best current estimates are given by
Theorem 3 in [BG].)

The more general operator T also has a wave packet decomposition, except that the tubes are
curved instead of straight. The function T fθ,v is essentially supported on a curved tube Tθ,v ⊂ BR,
with radius R1/2+δ and length R. After restricting to a slightly smaller ball (of radius R1−δ), we
can assume that Tθ,v is the R1/2+δ-neighborhood of an algebraic curve of degree at most C(n, δ).
The range of p in Conjecture 11.1 cannot be improved. The sharp examples happen when wave
packets Tθ,v concentrate near to a low-degree variety Z. If n is even, then the dimension of Z is
2 , and if n is odd, the dimension of Z is n+1
n+2
2 . With this choice of dimension, it can happen
that for every θ, there is some v = v(θ) so that Tθ,v(θ) ⊂ NR1/2+δ (Z). We choose fθ,v so that
In
this setup, kf kL2 ∼ kf kL∞. Also, kT f kL2 ∼ R1/2kf kL2, and T f is essentially supported in the
R1/2-neighborhood of Z. By Holder’s inequality, we see that kT f kLp(BR) ≫ kf kL2 ∼ kf kL∞ for
any p smaller than the range in the conjecture.

|T fθ,v(x)| ∼ 1 on Tθ,v (and rapidly decaying away from Tθ,v). Then we let f = Pθ fθ,v(θ).

We describe brieﬂy the history of this question. More general oscillatory integral operators of
the form (11.2) were ﬁrst considered by Hormander in [H]. He proved Theorem 11.1 for n = 2, and
raised questions about higher dimensions. In fact, he considered a somewhat more general setting.
For a non-degenerate quadratic form Q(ω1, ..., ωn−1), deﬁne ΨQ by

(11.4)

ΨQ(y, ω) := y1ω1 + ... + yn−1ωn−1 + ynQ(ω)

We deﬁne the corresponding extension operator EQ by

Then we let Ψ(y, ω) be a small C∞ perturbation of ΨQ on Bn × Bn−1 and deﬁne T f by

(11.5)

(11.6)

EQf (x) =ZBn−1

eiRΨQ(x/R,ω)f (ω)dω.

T f (x) :=ZBn−1

eiRΨ(x/R,ω)f (ω)dω.

If Q is positive deﬁnite, then this class of operators is equivalent to the operators in deﬁnition
(11.2), but Q may have a mix of positive and negative eigenvalues. We call such an operator T an
operator of Hormander type. What Lp estimates must such an operator T obey? The ﬁrst result
in higher dimensions was proven by Stein in [S2]:

Theorem 11.2. ([S2]) Suppose that T is an operator of Hormander type. Then kT f kLp(BR) .
kf kL2(Bn−1) for p ≥ 2 · n+1
n−1 .

Up to this point in the development of the theory, most people believed that the C∞- small
perturbation in the phase function Ψ should not have an eﬀect on the Lp estimates, and that T
should obey all the same Lp estimates as EQ or E. But in [B2], Bourgain proved that this is not
the case.

Theorem 11.3. ([B2]) In every odd dimension n, there is a phase function Ψ, which is a small
real-analytic perturbation of some ΨQ, so that the inequality kT f kLp(BR) . kf kL∞(Bn−1) holds only
in the range p ≥ 2 · n+1
n−1 .

48

LARRY GUTH

In Bourgain’s example, |T f | is concentrated into the 1-neighborhood of a low degree algebraic
2 . More precisely, in this example, kT f kL2(N1(Z)∩BR) ∼ kT f kL2(BR), and

variety Z of dimension n+1
also kT f kL2(BR) ∼ R1/2kf kL2 ∼ R1/2kf kL∞.

In [B3], Bourgain proved that in every even dimension, every such operator T obeys slightly
stronger estimates. More recently, the paper [BG] proved a sharp estimate for Hormander-type
operators in every even dimension.

Theorem 11.4. ([BG]) If T is a Hormander-type operator in dimension n, with n even, then
kT f kLp(BR) . kf kL∞(Bn−1) for p > 2 · n+2
n
In the sharp examples for this theorem, T f is concentrated into the 1-neighborhood of a low degree
algebraic variety Z of dimension n+2
2 . The diﬀerence between even and odd dimensions comes about
for the following reason. In the odd-dimensional examples we just discussed, all the wave packets
compress into a small neighborhood of a smooth surface of dimension n+1
2 , and this dimension is
optimal. If n is odd, then n+1
is not an integer, and there
2
is no such thing as a smooth surface of dimension n+1
2 . In this case, it turns out that wave packets
cannot compress into a rough fractal object of dimension n+1
2 , and the smallest set where they can
compress is a smooth surface of dimension n+2
2

is an integer, but if n is even, then n+1
2

- see Section 6 of [BG].

Meanwhile, in [L], Lee showed that Theorem 11.2 can be improved in the case that Q is positive
deﬁnite - the case of operators of the form (11.2). He extended the bilinear estimate Theorem 1.2
to Hormander-type operators with positive deﬁnite phase, and as a corollary he proved

Theorem 11.5. ([L]) If T is a Hormander-type operator with positive deﬁnite phase, as in (11.2),
then kT f kLp(BR) .ǫ Rǫkf kLp(Bn−1) for p ≥ 2 · n+2
n .

When n = 3, this result is sharp. It establishes Conjecture 11.1 for n = 3. For n ≥ 4, Theorem

11.5 is not as strong as Conjecture 11.1.

I believe that the proofs in this paper can be generalized from the extension operator E to
Hormander-type operators T with positive deﬁnite phase, and I am working on the details of the
argument. There are two main ingredients in the proof: the polynomial partitioning argument and
the transverse equidistribution estimate. The polynomial partitioning argument should work just
as before for all Hormander-type operators T , regardless of whether the phase is positive deﬁnite.
We simply replace tubular neighborhoods of straight lines with tubular neighborhoods of curves of
degree . 1. A straight line can cross a hypersurface Z(P ) at most Deg P times, and a curve of
degree . 1 can cross it . Deg P times. This change only aﬀects the constants in the arguments.

in BR. Suppose that T f = Pθ,v∈TZ

The transverse equidistribution estimate should work for Hormander-type operators with positive
deﬁnite phase – although it fails badly for more general Hormander-type operators. Let Z be a low
degree variety of dimension m, and let TZ be the set of pairs (θ, v) so that Tθ,v is tangent to Z
T fθ,v. Consider a ball B = B(x0, R1/2) ⊂ NR1/2 (Z), and let
TZ,B be the set of (θ, v) ∈ TZ so that Tθ,v intersects the ball B. For each (θ, v) ∈ TZ,B, let GB(θ, v)
denote the direction of the tube Tθ,v at the ball θ.
(Because Tθ,v curves, its tangent direction
changes from place to place, but on the ball θ, the tangent direction is well-deﬁned up to O(R−1/2).
) By the tangency condition, for all (θ, v) ∈ TZ,B, GB(θ, v) lies in the R−1/2-neighborhood of TzZ
(for a point z ∈ Z ∩ B). Each wave packet T fθ,v restricted to the ball B has a frequency ξB(θ, v).
This frequency also changes as we move along the tube Tθ,v, but if ηB is a smooth bump adapted
to B, then (ηB · T fθ,v)∧ is essentially supported in an R−1/2-neighborhood of ξB(θ, v). Since all the
directions GB(θ, v) lie in the R−1/2-neighborhood of T Z, then a computation shows that all the
frequencies ξB(θ, v) lie in the R−1/2-neighborhood of an aﬃne m-plane Vξ. The plane Vξ depends

RESTRICTION ESTIMATES USING POLYNOMIAL PARTITIONING II

49

on the ball B, the operator T , and the plane T Z. If V ′ = V ⊥
locally constant on B ∩ (V ′ + x) for any x ∈ B.

ξ , then we see that |T f | is morally

So far, this discussion applies for any Hormander-type operator T . The positive deﬁnite phase
comes into play to control the angle of the subspace V ′. If the phase Ψ is a small perturbation of
the phase Ψpar, then the plane V ′ points in nearly the same direction that it would have pointed
for the extension operator E, and so V ′ is quantitatively transverse to TzZ. This should give a
transverse equidistribution estimate. On the other hand, for general Hormander-type operators,
the plane V ′ may point in any direction. In the worse case scenario, V ′ may be tangent to Z. In this
situation, |T f | can concentrate into the 1-neighborhood of Z, as in the examples discussed above.
But in the positive deﬁnite case, the transverse equidistribution prevents |T f | from concentrating
into the r-neighborhood of Z for any r ≪ R1/2.

In summary, we have discussed two features that help control the Lp estimates that T obeys:
one is the signature of the phase function and the other is the parity of the dimension. Conjecture
11.1 combines the two eﬀects discussed here: it uses that Q is positive deﬁnite and it uses the parity
of the dimension n.

11.2. Other extension operators. One could also try to apply the methods here to extension
operators for other hypersurfaces besides the paraboloid. The case of the sphere, or other posi-
tively curved hypersurfaces, would follow easily from the variable-coeﬃcient generalization discussed
above. But it would be interesting to know if these methods apply to the cone or the hyperbolic
paraboloid.

11.3. Honest k-linear estimates. Our main result, Theorem 1.5 is a weak version of the k-linear
restriction estimate from Conjecture 1.4. For some purposes, we have seen that Theorem 1.5 is a
good substitute for a k-linear restriction estimate, but there are surely other situations where an
honest k-linear estimate is better. When I tried to prove Conjecture 1.4 using this method, I ran
into the following problem. There are k diﬀerent functions Efj to consider. It may happen that
for some of these k functions, the wave packets of Efj are tangent to a variety Z, and for others
of these k functions, the wave packets of Efj are transverse to the variety Z. I didn’t ﬁnd a good
way to deal with this scenario. The k-broad norm, BLp
k,A, is designed to get around this situation.

11.4. Kakeya-type estimates for low degree varieties. We now return to the extension oper-
ator for the paraboloid. Theorem 1.5 gives essentially sharp broad Lp estimates of the form:

(11.7)

kEf kBLp

k,A(BR) . Rǫkf kL2.

We have seen that this estimate holds if and only if p ≥ ¯p(k, n). What if we consider other norms
on the right-hand side? For some q larger than 2, can we prove an estimate

(11.8)

for some p < ¯p(k, n)?

kEf kBLp

k,A(BR) . Rǫkf kLq,

In the introduction, we mentioned some sharp examples for Theorem 1.5. In these examples,
the wave packets Efθ,v concentrate in the R1/2-neighborhood of a low degree variety Z. Let us
consider the set of caps θ that can appear in this example. Deﬁne Θ(Z) as

Θ(Z) := {θ so that for some v, Tθ,v ⊂ NR1/2+δ (Z)}.

50

LARRY GUTH

In our example, f is supported in Ω(Z) := ∪θ∈Θ(Z)θ. If |Ω(Z)| ≪ 1, then kf kLq ≫ kf kL2 for all
q > 2.

In fact, if we had good estimates for |Ω(Z)|, then I believe we could input them into the proof
of Theorem 1.5 to get some further estimates of the form (11.8), roughly following the argument in
[G].

If Z is an m-dimensional plane, then it is easy to check that |Θ(Z)| ∼ (R1/2)m−1 and so |Ω(Z)| ∼
(R1/2)m−1 · (R1/2)−(n−1). It seems reasonable to conjecture that a similar bound holds for any m-
dimensional variety Z of small degree:

Conjecture 11.6. If Z is an m-dimensional variety in Rn of degree at most D, then

(11.9)

|Θ(Z)| ≤ C(n, D, ǫ)(R1/2)m−1+ǫ.

Conjecture 11.6 is a very special case of the Kakeya conjecture. One variant of the Kakeya

conjecture goes as follows:

Conjecture 11.7. (Kakeya conjecture) Suppose that X ⊂ Bn(1). Suppose that Ti ⊂ X are tubes
of length 1 and radius δ, pointing in δ-separated directions. Then

Number of tubes ≤ C(ǫ)δ−ǫ Vol(X)
Vol(tube)

.

(I haven’t seen this exact version of the Kakeya conjecture in print before, but it’s straightforward
to check that the maximal function version of the Kakeya conjecture implies Conjecture 11.7, which
implies the Minkowski dimension version of the Kakeya conjecture.) Now Conjecture 11.6 is just
the special case of Conjecture 11.7 where the set X is the δ-neighborhood of a low degree algebraic
variety.

Conjecture 11.6 also came up in ongoing joint work with Josh Zahl on the Kakeya problem in R4.
I think it is a basic issue that comes up in trying to apply polynomial methods to the restriction
problem or the Kakeya problem.

I initially expected that Conjecture 11.6 would be rather straightforward. But I have tried for a
while, and I am not able to prove it. I was able to prove it in the case n = 3 in [G], but the proof
there deﬁnitely does not generalize to higher dimensions. For a hypersurface Z ⊂ R4, I have not
been able to prove the conjecture even for degree D = 2 or 3. (For D = 2, I think there is some
hope to prove the conjecture by a brute force case analysis of all possible degree 2 hypersurfaces,
but this strategy looks untenable for D = 3.)

References

[Be] I. Bejenaru, The optimal trilinear restriction estimate for a class of hypersurfaces with curvature,

arXiv:1603.02965

[B1] J. Bourgain, Besicovitch type maximal operators and applications to Fourier analysis. Geom. Funct. Anal. 1

(1991), no. 2, 147-187.

[B2] J. Bourgain, Lp-estimates for oscillatory integrals in several variables. Geom. Funct. Anal. 1 (1991), no. 4,

321-374.

[B3] J. Bourgain, Some new estimates on oscillatory integrals, Annals Math. St. 42, Princeton UP (1995), 83-112.
[B4] J. Bourgain, Moment inequalities for trigonometric polynomials with spectrum in curved hypersurfaces. Israel

J. Math. 193 (2013), no. 1, 441-458.

[BD] J. Bourgain, C. Demeter, The proof of the l2 decoupling conjecture. Ann. of Math. (2) 182 (2015), no. 1,

351-389.

RESTRICTION ESTIMATES USING POLYNOMIAL PARTITIONING II

51

[BG] J. Bourgain, L. Guth, Bounds on oscillatory integral operators based on multilinear estimates. Geom. Funct.

Anal. 21 (2011), no. 6, 1239-1295.

[BCT] J. Bennett, A. Carbery, and T. Tao, On the multilinear restriction and Kakeya conjectures. Acta Math. 196

(2006), no. 2, 261-302.

[CKW] X. Chen, N. Kayal, and A. Wigderson, Partial derivatives in arithmetic complexity and beyond. Found.

Trends Theor. Comput. Sci. 6 (2010), no. 1-2, pages 1-138 (2011).

[CEGSW] K.L. Clarkson, H. Edelsbrunner, L. Guibas, M Sharir, and E. Welzl, Combinatorial Complexity bounds

for arrangements of curves and spheres, Discrete Comput. Geom. (1990) 5, 99-160.

[D] Z. Dvir, On the size of Kakeya sets in ﬁnite ﬁelds. J. Amer. Math. Soc. 22 (2009), no. 4, 1093-1097.
[GP] V. Guillemin and A. Pollack, Diﬀerential Topology, AMS Chelsea Publishing, 1974, reprinted 2010.
[G] L. Guth, A restriction estimate using polynomial partitioning. J. Amer. Math. Soc. 29 (2016), no. 2, 371-413.
[GK] L. Guth and N. Katz, On the Erd˝os distinct distances problem in the plane, Ann. of Math. (2) 181 (2015), no.

1, 155-190.

[H] L. Hormander, Oscillatory integrals and multipliers on F Lp, Arkiv Math. II (1973), 1-11.
[L] S. Lee, Linear and bilinear estimates for oscillatory integral operators related to restriction to hypersurfaces, J.

Funct. Anal. 241:1 (2006), 56-98.

[S] E. Stein, Some problems in harmonic analysis. Harmonic analysis in Euclidean spaces (Proc. Sympos. Pure Math.,
Williams Coll., Williamstown, Mass., 1978), Part 1, pp. 3-20, Proc. Sympos. Pure Math., XXXV, Part, Amer.
Math. Soc., Providence, R.I., 1979.

[S2] E. Stein, Oscillatory integrals in Fourier analysis, Beijing lectures in Harmonic Analysis, Annals Math. St. 112,

Princeton UP (1986).

[StTu] A. Stone, and J. Tukey, Generalized ”sandwich” theorems. Duke Math. J. 9, (1942) 356-359.
[TVV] T. Tao, A. Vargas, L. Vega, A bilinear approach to the restriction and Kakeya conjectures. J. Amer. Math.

Soc. 11 (1998), no. 4, 967-1000.

[T1] T. Tao, The Bochner-Riesz conjecture implies the restriction conjecture. Duke Math. J. 96 (1999), no. 2, 363-375.
[T2] T. Tao, A sharp bilinear restrictions estimate for paraboloids. Geom. Funct. Anal. 13 (2003), no. 6, 1359-1384.
[W1] T. Wolﬀ, A sharp bilinear cone restriction estimate. Ann. of Math. (2) 153 (2001), no. 3, 661-698.
[W2] T. Wolﬀ, Local smoothing type estimates on Lp for large p. Geom. Funct. Anal. 10 (2000), no. 5, 1237-1288.
[W3] T. Wolﬀ, A Kakeya-type problem for circles. Amer. J. Math. 119 (1997), no. 5, 985-1026.
[Wo] R. Wongkew, Volumes of tubular neighbourhoods of real algebraic varieties. Paciﬁc J. Math. 159 (1993), no. 1,

177-184.

