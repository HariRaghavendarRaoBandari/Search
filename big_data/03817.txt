EIGENVALUE VS PERIMETER IN A SHAPE THEOREM

FOR SELF-INTERACTING RANDOM WALKS

MAREK BISKUP1 AND EVIATAR B. PROCACCIA2

1Department of Mathematics, UCLA, Los Angeles, California, USA

2Department of Mathematics, Texas A&M University, College Station, Texas, USA

ABSTRACT. We study paths of time-length t of a continuous-time random walk on Z2 subject
to self-interaction that depends on the geometry of the walk range and a collection of random,
uniformly positive and ﬁnite edge weights. The interaction enters through a Gibbs weight at
inverse temperature b ; the “energy” is the total sum of the edge weights for edges on the outer
boundary of the range. For edge weights sampled from a translation-invariant, ergodic law, we
prove that the range boundary condensates around an asymptotic shape in the limit t → ¥
followed
by b → ¥
. The limit shape is a minimizer (unique, modulo translates) of the sum of the principal
harmonic frequency of the domain and the perimeter with respect to the ﬁrst-passage percolation
norm derived from (the law of) the edge weights. A dense subset of all norms in R2, and thus a
large variety of shapes, arise from the class of weight distributions to which our proofs apply.

6
1
0
2

 
r
a

 

M
1
1

 
 
]

.

R
P
h
t
a
m

[
 
 

1
v
7
1
8
3
0

.

3
0
6
1
:
v
i
X
r
a

1.1 Motivation.

1. INTRODUCTION AND RESULTS

Limit theorems for random shapes have been a topic of recurring interest in both probability and
statistical mechanics. One successful line of attack came up in the 1990s under the banner of
the Wulff construction. There one was interested in the asymptotic shape of a “droplet” of one
equilibrium phase (e.g., the minus phase of the Ising model at inverse temperature b ) immersed
in another (the plus Ising phase) subject to a restriction on the overall order parameter (the mag-
netization, or the total number of plus spins, in the Ising case). See, e.g., Alexander, Chayes and
Chayes [1], Dobrushin, Koteck´y and Shlosman [17], Ioffe and Schonmann [22] for studies in the
spatial dimension d = 2 and Cerf [14], Bodineau [11], Cerf and Pisztora [15] and Bodineau, Ioffe
and Velenik [12] for work in dimensions d ≥ 3.
isoperimetric problem; namely,

In all of the above mentioned studies the asymptotic shape is determined as a solution of an

(1.1)
for |U| denoting the Lebesgue measure of U and P(U ) being a perimeter functional given ex-
plicitly in terms of a model-dependent surface tension t : Rd → (0,¥ ) by

inf(cid:8)P(U ): U ⊂ Rd open, |U| = 1(cid:9)

P(U ) :=Z¶ U

t (cid:0)n(x)(cid:1)H d−1(dx),

(1.2)

c(cid:13) 2016 M. Biskup, E.B. Procaccia. Reproduction, by any means, of the entire article for non-commercial
purposes is permitted without charge.

1

2

BISKUP AND PROCACCIA

where n(x) denotes the unit outer normal to ¶ U at point x and H d−1 is the (d − 1)-dimensional
Hausdorff measure on ¶ U. The mode of convergence of the random shape to its deterministic
limit is generally stronger in d = 2 than in d ≥ 3. This is due to a different type of continuity of
the perimeter functional.
Recently, an interesting example which is related to but does not quite ﬁt under the umbrella of
the Wulff construction program emerged in the work of Berestycki and Yadin [5]. They studied
random walks of time-length t that are subject to an interaction suppressing, through a Gibbs
weight at inverse temperature b , the internal vertex boundary of the walk range (i.e., the set of
sites visited by the walk). The analysis in [5] determined the (typical) spatial size of the range in
the limit t → ¥ but made no deﬁnitive conclusions on the limit shape.

In the present paper we prove the existence of a limit shape for a class of self-interacting
random walks closely related to that studied in [5]; namely, those where the “energy” of a random
walk conﬁguration is the length of the external edge boundary of the range measured using a
sample of random, non-negative, shift-ergodic weights. A novel feature here is that this limit
shape is no longer a solution of an isoperimetric problem. Instead, after a judicious rescaling of
the relevant quantities, it is the minimizer of

where P(U ) is a quantity of the form deﬁned above and

inf(cid:8)l (U ) + P(U ): U ⊂ Rd open(cid:9),

(1.3)

(1.4)

l (U ) := infnk(cid:209) gk2

2 : g ∈ C¥

(Rd), supp(g) ⊂ U,kgk2 = 1o

denotes the principal (i.e., smallest) eigenvalue of the negative Laplacian in U with Dirichlet
boundary conditions on ¶ U. Some attributes of the isoperimetric problem of course remain in
effect; e.g., the eigenvalue part of the functional acts as a kind of soft lower bound on the volume.
However, the precise shape is a consequence of a subtle interplay between both terms and, in
general, the minimizers of (1.1) and (1.3) are not homothetic. A companion paper (Biskup and
Procaccia [10]) carries out a detailed study of this variational problem.

As it turns out, our results are restricted to spatial dimension d = 2 and they require the limit
of zero temperatures, b → ¥
. The restriction on the dimension is (partly) a matter of convenience
— indeed, the control of the shape in d ≥ 3 would suffer the same technical challenges as in the
above Wulff construction studies. The limit of zero temperatures is more serious and is dictated by
our inability to control all aspects of the problem in full generality. (In particular, the variational
problem (1.3) may be relevant only at b = ¥
.) Notwithstanding, since we allow the edge weights
to be random, we are able to demonstrate a rich class of possible limit shapes.

1.2 The model.

Let us now move to precise deﬁnitions. Although we will ultimately restrict attention to d = 2
we will keep d general in the forthcoming discussion until we get to the main result. This will
allow us to track the role of d in the numerical values of some important exponents.

Given a ﬁnite set A ⊂ Zd, let hull (A) denote the complement in Zd of the set of vertices in the
unique inﬁnite connected component of Zd r A — in short, hull (A) is A with all of the “holes”
ﬁlled. Consider the continuous-time simple random walk {Xt : t ≥ 0} on Zd with uniform jump
rate 2d and let Px be its law for Px(X0 = x) = 1. Write ℓt(x) :=R t
0 1{Xs=x} ds for the local time

SHAPE THEOREM FOR RANDOM WALKS

at x and deﬁne

R(t) := hull(cid:0){x ∈ Zd : ℓt (x) > 0}(cid:1).

The reason for taking the hull is that we wish the interaction energy to depend only on the geom-
etry of the outer boundary of the visited set.

Consider now the set B(Zd) of (unoriented) edges in Zd and let w : B(Zd) → (0,¥ ) be a
collection of edge weights. Given a set A ⊂ Zd, let ¶ A denote the set of edges in B(Zd) that have

exactly one endpoint in A. The “energy” of a ﬁnite set A is then given by the Hamiltonian

H(A) := (cid:229)

w(e).

e∈¶ A

3

(1.5)

(1.6)

(1.7)

(1.8)

For b ≥ 0 we consider the Gibbs measure Qx

Qxb ,t (A) :=

b ,t on the path space deﬁned by
1

E x(cid:0)1Ae−b H(R(t))(cid:1),

Z(b ,t)

where

Z(b ,t) := E x(cid:0)e−b H(R(t))(cid:1)

with E x denoting the expectation with respect to Px.

A canonical (and simplest) choice of the weights is w(e) := 1. However, this will lead to
a rather uninteresting limit shape (namely, a square) and so, in order to get a larger variety of
possible limit shapes, we will permit the weights to be random. Some natural restriction on the
law of the weights is still in order; these are the subject of:
Deﬁnition 1.1 Wewillcallaprobability law P on (0,¥ )B(Zd ) admissible ifitisstationary and
ergodic withrespect totranslates of Zd andthemarginal lawof w(e) iscompactly supported in
(0,¥ ) foreache ∈ B(Zd).
The basic problem we wish to address is the behavior of the walk sampled from Q0
and b
admissible law P.

b ,t for t
large, for a given (typical) sample of the random weights w distributed according to some

A reader interested in physics might wish to have a physical system in mind that could be rep-
resented by the above class of models. One such system consists of a hydrophobic polymer chain
of length t immersed in a water-based solvent. The negative afﬁnity between the polymer and the
solvent causes the polymer to fold so that the number of contacts with the solvent is minimized.
The contact energy is represented by H(R(t)); the inverse temperature b
tunes the balance be-
tween the energy and the entropy of the paths. Making the weights random is quite natural, and
particularly so in dimension d = 2, as that permits us to take into account spatial inhomogeneities
of the physical substrate on which the solvent and the polymer co-exist. We refer to, e.g., the
book by den Hollander [16] for more information on polymers in random environment.

1.3 Earlier and related work.

As noted above, Berestycki and Yadin [5] (apparently prompted by questions from I. Benjamini)
studied a related model of an interacting random walk. There are two notable differences between
their and our setting: First, their interaction includes the internal components of the boundary and,

4

BISKUP AND PROCACCIA

second, it is given by the number of vertices on the inner boundary. For this case they showed
that the path is conﬁned (with different type of control in d = 2 and d ≥ 3) on the spatial scale

r(t,b ) :=(cid:16) t

b (cid:17) 1

d+1

.

(1.9)

The exponent is strictly less than 1/2 in all spatial dimensions d ≥ 2; the walk is thus “squeezed”
by the interaction relative to its typical (diffusive) scaling.
This conclusion should naturally be compared with that for the model where the “self-inter-
action” is proportional to the cardinality of the whole range. In this case, Bolthausen [13] showed
that the walk is conﬁned to the spatial scale t 1
d+2 . (Bolthausen’s paper is actually focused on
d = 2 only but one can relate this to the problem of Brownian motion among Poissonian obstacles
studied by Sznitman [25] in d = 2 and Povel [24] in all d ≥ 3.) The minimizing shape is then
determined by the variational problem

whose unique minimizer is, thanks to the Faber-Krahn inequality, a Euclidean ball.

inf(cid:8)l (U ): U ⊂ Rd open, |U| = 1(cid:9)

(1.10)

The appearance of the Dirichlet eigenvalue has to do with the large-deviations cost of keep-
ing the walk conﬁned to a given spatial region. The associated large-deviations principle (which
goes back to Donsker and Varadhan [18]) underlies a large body of literature on random walks
interacting via their local time and/or through an underlying random environment; e.g., the study
of the parabolic Anderson model (cf K¨onig [23] for a recent review), random walk and/or Brow-
nian motion among random obstacles (Sznitman [26]), etc. Two recent papers of Asselah and
Shapira [2, 3] are relevant for our context as they develop a detailed large-deviation approach to
the size of the boundary of the random walk range in spatial dimensions d ≥ 3. This expands on
the study of moderate deviations for the Brownian “sausage” by van den Berg, Bolthausen and
den Hollander [6].

Our variational problem (1.3) is kind of a mix of (1.1) and (1.10). This is because the mech-
anisms underlying the latter two problems meet, and are able to compete, in our model. Under-
standing this competition is key for a proper description of the walk at large time scales.

1.4 Main results.

We are now ready to give the statements of our results. For the remainder of this paper, we will
restrict ourselves to dimension d = 2. The main take-away message from this note is:

Theorem 1.2 (Shape theorem) Let d = 2 and suppose that the law of edge weights P is admis-
sible. Then there is a non-empty bounded open convex set U0 ⊂ R2 and, for each e > 0, there is
b 0(e ) < ¥

such that for all b > b 0(e ) and for r(t,b ) as in (1.9),

b ,t(cid:18) inf

x∈Rd

lim

t→¥ Q0

distH(cid:16)r(t,b )−1R(t), x +U0(cid:17) > e (cid:19) = 0

(1.11)

for P-almost every realization of the weights.

A natural problem next is the determination of the shape U0 for speciﬁc choices of the interac-
tion. As hinted above, this will be done by characterizing U0 as the minimizer (unique, modulo

SHAPE THEOREM FOR RANDOM WALKS

5

translates) of a suitable variational functional. We will take

U :=(cid:8)U ⊂ R2 : Jordan domain with 0 ∈ U(cid:9)

(1.12)
as our class of admissible continuum domains.
(This means that each U ∈ U is a bounded,
open, connected and simply-connected set in R2 whose boundary is the trace of a simple closed
curve.) Given a norm r on R2 and writing g : [0,1] → R2 for the curve constituting ¶ U (where,
necessarily, g (0) = g (1)) we deﬁne the r -perimeter of U by

P(U ) := sup
n≥1

sup

t0,...,tn∈[0,1]

0=t0<t1<...<tn=1

n(cid:229)

i=1

r (cid:0)g (ti)− g (ti−1)(cid:1).

For U ∈ U we then set

with l (U ) as deﬁned in (1.3).

F (U ) := l (U ) + P(U ),

(1.13)

(1.14)

The object F plays the role of a large-deviation functional for the asymptotic shape; we will
thus particularly be interested in sets in U that minimize U 7→ F (U ). This is an analysis problem
that has been studied in a companion paper (Biskup and Procaccia [10]). Let us recall the salient
conclusions of this work:

(1) For any choice of the norm r , the functional U 7→ F (U ) achieves its minimum on U .

Moreover, there is U0 ∈ U such that

M :=(cid:8)U ∈ U : F (U ) = min F(cid:9) =(cid:8)x +U0 : − x ∈ U0(cid:9).

(1.15)
(2) The set U0 is convex and can be taken to be symmetric under reﬂections (x 7→ −x). It is
(3) Letting distH(A,B) denote the Hausdorff distance between sets A,B ⊂ R2, for each e > 0

also symmetric under all rotations that preserve the norm r .
there is d > 0 such that, for each U ∈ U ,

distH(U,M ) > e ⇒ F (U ) ≥ min F + d .

(1.16)
Moreover, the map r
7→ U0 is continuous as a map between the set of continuous func-
tions on the unit circle (endowed with the supremum norm) and the set of bounded non-
empty open subsets of R2 (endowed with the Hausdorff metric).

In order to use these results to determine U0, we thus have to show how to extract the relevant
norm r from the particular problem at hand.

We ﬁrst need some terminology and notation. Consider Z2 regarded as a graph with its nearest-
neighbor structure and let Z2⋆ denote its graph dual. A path of length n is a sequence of vertices
x0, . . . ,xn ∈ Z2 such that xi and xi+1 are nearest neighbors for each i = 0, . . . ,n − 1. A similar
deﬁnition applies to paths on Z2⋆ which we then call dual paths. A path (or a dual path) is self-
avoiding if no vertex appears in the corresponding sequence of vertices more than once. For any
x,y ∈ Z2, let G (x,y) denote the set of all self-avoiding dual paths g = (x⋆
n) (for any n ≥ 0)
Given a self-avoiding dual path g = (x⋆
n), let (e1, . . . ,en) denote the sequence of edges
i ). Assuming a collection of weights w : B(Z2) →
in Z2 such that ei is the edge dual to (x⋆

n = y + (1/2, 1/2).
0, . . . ,x⋆
i−1,x⋆

0 = x + (1/2, 1/2) and x⋆

such that x⋆

0, . . . ,x⋆

6
(0,¥ ) is given, we then set

and deﬁne

d(g ) :=

n(cid:229)

i=1

w(ei)

BISKUP AND PROCACCIA

(1.17)

(1.18)
Relying on duality, r can be identiﬁed with the distance in the ﬁrst-passage percolation (FPP) for
weights distributed according to P. (In this identiﬁcation, w(e) is the passage time for the edge
dual to e.) It is known (see, e.g., Aufﬁnger, Damron and Hanson [4] for a recent review) that the
FPP distance is asymptotic to a deterministic norm. This underlies our next claim:

D(x,y) := inf
g ∈G (x,y)

d(g ).

Theorem 1.3 (Extracting the norm) Suppose d = 2 and assume that P is admissible. Then there
is a norm r on R2 such that for P-almost every realization of the weights,

The FPP norm r
P-almost sure limits

|D(x,y)− r (x− y)|

n

= 0.

lim
n→¥ max
x,y∈Z2
|x|,|y|≤n

(1.19)

is actually constructed from — and is thus completely determined by — the

D(0,nx)

= r (x),

x ∈ Z2,

lim
n→¥

n

(1.20)

whose existence is, in our case, fairly immediate from the Subadditive Ergodic Theorem; cf
Lemma 3.1. The above statement just requires combining (1.20) with some additional uniformity
considerations.

is identiﬁed for each given law of the weights, we can complete the

As soon as the norm r
above shape theorem by:

Theorem 1.4 (Shape characterization) The set U0 in Theorem 1.2 is a minimizer (unique, up to
translates) of U 7→ F (U ) with the perimeter functional P(U ) constructed using the asymptotic
FPP norm r deﬁned, e.g., by (1.20).

1.5 Remarks and extensions.

Let us proceed with some remarks on the above setting and results. We begin with comments on
the connection between the norm and the limit shape.

(1) In the canonical situation w(e) := 1 (i.e., with constant weights), r

is the ℓ1-norm and U0
¥ -ball (a square). In the situation treated by Berestycki and Yadin [5] — where the
is then an ℓ
interaction is through the number of boundary vertices rather then edges — we expect r
to be the
¥ -norm and U0 thus an ℓ1-ball (a diamond). This is in fact quite consistent with the numerical
ℓ
simulations shown in [5].

(2) For non-degenerate laws of the weights, the FPP norm r

is generally not explicitly com-
putable. A question then arises what possible norms one can get in our class of models and what
shapes then arise as minimizers of the associated functional U 7→ F (U ). Here we recall:
Theorem 1.5 (H¨aggstr¨om and Meester [21], Theorem 1.3 and remarks afterwards) For each
compact convex set B ⊂ Rd that has a non-empty interior and is symmetric under the reﬂection

SHAPE THEOREM FOR RANDOM WALKS

7

x 7→ −x there is a translation-invariant, ergodic law P on (0,¥ )B(Zd ) such that B is the unit ball
in the norm r deﬁned implicitly by (1.20). Moreover, the weights w(e) are bounded under P and
their law is strongly mixing.

The norms on Rd are in one-to-one correspondence with the symmetric (non-empty) compact

convex sets B ⊂ Rd via the equivalence
⇔

B := {x ∈ Rd : r (x) ≤ 1}

r (x) = sup{x· y: y ∈ B}, ∀x ∈ Rd.

(1.21)
In particular, all norms in Rd arise as FPP norms for some law of the weights as described in the
theorem. However, the construction in [21] does not make w(e) bounded away from zero (the
whole argument is based on existence of arbitrarily fast edges) and so we are unfortunately not
guaranteed to get all norms from laws that are admissible in the sense of Deﬁnition 1.1. Notwith-
standing, thanks to a continuity of the FPP norm in the underlying law of the edge weights, we
get at least a dense subset of all norms.

The question on what limit shapes arise from the class of admissible laws is more complicated.
Indeed, at this time we do not even know whether the map r
7→ U0 (of a norm to a symmetric,
bounded, open and convex set) is injective and/or surjective. This is very different for the isoperi-
metric problem where we have the one-to-one correspondence (1.21).

(3) A particularly interesting sub-class of admissible laws are those that make the weights
i.i.d. A good amount of research has gone into the analytic properties of such norms. Durrett and
Liggett [19] gave examples of i.i.d. laws for which r
is not strictly convex; this implies facets on
the ball in the r -metric and, by Theorem 1.7 of Biskup and Procaccia [10], appearance of corners
on U0. However, the opposite regime — namely, the conditions for strict convexity of the FPP
norm — is only poorly understood (for the i.i.d. setting); see the review by Aufﬁnger, Damron
and Hanson [4]. We advance some of the existing conjectures into:

Conjecture 1.6 For i.i.d. laws of the edge weights that are continuously distributed and bounded
uniformly away from zero and inﬁnity, U0 as well as the isoperimetric minimizer (a.k.a. the Wulff
shape) for the associated FPP norm have no corners. Notwithstanding, facets on both U0 and the
Wulff shape are allowed and, most likely, typical.

The rest of our comments are concerned with possible extensions of the present work.

(4) We believe that a shape theorem holds for all b sufﬁciently large although we do not think
that the limit shape is obtained by optimizing the functional of the form (1.14). Our need for
taking b → ¥
stems from the inability to control the surface-order terms in the “eigenvalue part”
of the contribution to the partition function (1.8); see also Remark 2.8. Any progress on this
question is certainly of interest.

(5) Theorem 1.2 should extend without signiﬁcant changes to discrete-time random walks.
Our focus on continuous-time walks is more advantageous technically as that makes functional-
analytic techniques and particularly, spectral calculus, readily available.

(6) The above results should be extendable to all d ≥ 2 (still under b → ¥

weaken the Hausdorff metric to

) provided that we

(1.22)
The extension would carry a signiﬁcant amount of technical overhead that would ultimately de-
tract from the principal message of our paper. However, we still think it is worthy an attempt.

dist1(A,B) = |A△B|.

8

BISKUP AND PROCACCIA

Another obstruction is that our understanding of the variational problem for the functional (1.14)
is presently considerably more advanced in d = 2 than in d ≥ 3.
(7) Theorem 1.2 discusses the asymptotic shape of the random-walk support but one can also
ask about how this shape is positioned relative to the starting point of the walk. Similarly, one
might also be interested in the asymptotic law of the endpoint of the path. We expect that both of
these laws can be expressed using the principal eigenfunction of the Laplacian. (Essentially, the
eigenfunction should correspond to the local-time proﬁle of the walk.)

(8) Our choice of the interaction — the sum of non-negative weights on the outer boundary of
the range — is reasonably canonical, but other natural choices exist as well. One is the size of
the inner-vertex boundary (i.e., the case related to that in Berestycki and Yadin [5]). However,
even this example harbors some of the complications that turn out to be the more severe the more
general the interaction becomes: the minimal “energy” of paths from 0 to nx may no-longer be
subadditive in n. There are ways to overcome this in speciﬁc cases (e.g., by way of considering
random-walk bridges) but a general approach seems elusive at this point.

1.6 Main ideas and outline.

The remainder of this paper is devoted to the proofs of the above results. These come roughly in
three parts each of which is the content of one section. Here is the basic starting idea: Consider
the collection of sets

S :=(cid:8)S ⊂ Zd : ﬁnite, connected with Sc connected, 0 ∈ S(cid:9).

(1.23)

For the random walk started from the origin, R(t) takes values in S. Since the interaction depends
only on R(t), to control the shape it sufﬁces to study

Q0

t,b (cid:0)R(t) = S(cid:1) =

e−b H(S)P0(cid:0)R(t) = S(cid:1)
(cid:229) S′∈S e−b H(S′)P0(cid:0)R(t) = S′(cid:1) .
To estimate this probability, we generally need upper bounds on the numerator and lower bounds
on the denominator. The essential point is that, in both of these, the computation separates into
two parts: computing P0(R(t) = S) and matching the result against e−b H(S).
means of the principal eigenvalue l
below). This yields an expression of the form

The proofs are then organized as follows: Section 2 expresses the probability P0(R(t) = S) by
S of the (negative) discrete Laplacian in S (deﬁned precisely

(1.24)

(1)

Qb ,t(cid:0)R(t) = S(cid:1) = e−[tl (1)

S +b H(S)+O(|¶ S|)].

(1.25)

The next step, carried out in Section 3, is a coarse-graining argument. This is achieved by a
resummation of all S that give rise to the same continuum object, called the skeleton P(S), which
is a polygonal domain in R2 that closely approximates the given set S (in the Hausdorff distance).
The result is now expressed in terms of the norm r and the perimeter functional P deﬁned above
in the form that looks, roughly, as

Qb ,t(cid:0)R(t) = S(cid:1) = e−[tl (Int(P))+b P(P)+O(|P|)].

S : P(S)=P

(1.26)

The reason for using skeletons is that they permit us to perform local optimization of the boundary
energy while, at the same time, reduce the combinatorial complexity of possible shapes.

(cid:229)
SHAPE THEOREM FOR RANDOM WALKS

9

The expression in the exponent on the right of (1.26) has the form of the functional F . With
some extra work, this allows us to complete the proofs of main results. This occurs in Section 4;
the ﬁnal section (Section 5) derives some useful estimates for eigenvalues and eigenfunctions of
the Laplacian in ﬁnite subsets of Z2.

2. EXTRACTING THE PRINCIPAL EIGENVALUE

The goal of this section is to express the probability law of R(t) under the random walk measure
using the principal eigenvalue of the Laplacian. This is a classical problem that lies, in one way
or another, at the heart of all the aforementioned studies by Bolthausen [13], Sznitman [25],
Povel [24] and others. Still, since our focus is on controlling all aspects of the problem at the
surface order, some additional caution is needed.

2.1 Key propositions.
Let S be as above and let S ∈ S. Abusing the earlier notation slightly, let
x (cid:12)(cid:12)g(x)(cid:12)(cid:12)2

hx,yi(cid:12)(cid:12)g(y)− g(x)(cid:12)(cid:12)2 : supp g ⊂ S, (cid:229)

S := inf(cid:26)1

2

(1)

l

= 1(cid:27),

where the ﬁrst sum is over unordered pairs of nearest-neighbor vertices in Zd and the inﬁmum is
over functions g: Zd → R with the stated properties. Modulo a sign change, this is the principal
eigenvalue of the discrete Laplacian

f (x) := (cid:229)

y: |y−x|=1(cid:2) f (y)− f (x)(cid:3)

in S with Dirichlet boundary conditions on Z2 r S. We will also frequently need the notation l
for the k-th eigenvalue of −D

in S, where k = 1, . . . ,|S|, and we will write h(k) to denote the

associated (k-th) eigenfunction normalized so that

(k)
S

This eigenfunction is not necessarily unique, but it can always be taken real valued.

x (cid:12)(cid:12)h(k)(x)(cid:12)(cid:12)2

= 1.

Let us start with bounds on P0(R(t) = S). The upper bound is quite simple:

Proposition 2.1 For any S ∈ S,

Proof. Let t S denote the ﬁrst exit time of the random walk Xt from S. The function

(2.1)

(2.2)

(2.3)

(2.4)

(2.5)

(2.6)

(2.7)

solves the differential equation
¶
¶ t

with initial/boundary data

.

S

P0(cid:0)R(t) = S(cid:1) ≤ |S|3/2e−tl (1)
f (x,t) := Px(cid:0)t S > t(cid:1)

f (x,t) = D

f (x,t),

x ∈ S, t > 0,

f (x,0) = 1S(x)

and

f (·,t) = 0 on Sc.

(cid:229)
D
(cid:229)
10

BISKUP AND PROCACCIA

In terms of the canonical inner product h·,·i in ℓ2(S), we get f (0,t) = hd 0,etD
language of eigenvalues/eigenfunctions of D becomes

1Si which in the

P0(cid:0)t S > t(cid:1) =

|S|

e−tl (k)

S h(k)(0) (cid:229)

h(k)(x).

(2.8)

(1)

S along with the fact that h(k) is

Invoking the Cauchy-Schwarz inequality, the bound l
normalized, and in particular obeys |h(k)(0)| ≤ 1, yield

(k)

k=1

x∈S
S ≥ l
P0(cid:0)t S > t(cid:1) ≤ |S|3/2e−tl (1)

.

S

But

and so the claim follows.

P0(cid:0)R(t) = S(cid:1) ≤ P0(cid:0)R(t) ⊆ S(cid:1) = P0(cid:0)t S > t(cid:1)

The corresponding lower bound is somewhat more involved. Fortunately, we will only need it

for a reduced class of sets. Then we have:
Proposition 2.2 Given U ∈ U convex, let
There is c = c(U ) ∈ (0,¥ ) and, for each a ∈ (0,¥ ), there is b 0 = b 0(a) such that for all b ≥ b 0,
all e > 0 small enough and all S ∈ S with

S(U,t,b ) :=(cid:8)x ∈ Z2 : x/r(t,b ) ∈ U(cid:9).

(2.11)

S(cid:0)(1− e )U,t,b (cid:1) ⊆ S ⊆ S(U,t,b )

and

|¶ S| ≤ ar(t,b ),

then

holds as soon as t is sufﬁciently large.

P0(cid:0)R(t) = S(cid:1) ≥ e−tl (1)

S −c|¶ S|

Given a ﬁnite and connected S ⊂ Z2, let diam(S) denote the intrinsic diameter of S; i.e., the
diameter of a graph with vertices in S and edges with both vertices in S measured using the
intrinsic distance. An important input in the proof are the following estimates on the size of the
spectral gap and decay of the principal eigenfunction relative to the size of the set in (2.11):

Lemma 2.3 For U ∈ U convex and e > 0 small enough, there are constants c1,c2 ∈ (0,¥ ) such
that if S ∈ S obeys S((1− e )U,t,b ) ⊆ S ⊆ S(U,t,b ), then
r(t,b )2 ,
c2

(2.14)

c1

(1)

l

S ≤
S − l

(2)

l

(1)

S ≥

r(t,b )2 .

once r(t,b ) is sufﬁciently large. Moreover, there are also c3,c4 ∈ (0,¥ ) such that the principal

eigenfunction in such S obeys

h(1)(0)2 ≥

c3
|S|

and

min
as soon as r(t,b ) is sufﬁciently large.

z∈S(cid:12)(cid:12)h(1)(z)(cid:12)(cid:12) ≥ e−c4 diam(S),

(2.9)

(2.10)

(cid:3)

(2.12)

(2.13)

(2.15)

(2.16)

(2.17)

(cid:229)
SHAPE THEOREM FOR RANDOM WALKS

11

The proof of this lemma requires some standard but rather technical steps that will be also used
elsewhere in this paper. To avoid breaking the ﬂow of the exposition, we therefore postpone the
proof to the Appendix. The key step in the proof of Proposition 2.2 is:

Lemma 2.4 Let U ∈ U . There is c = c(U ) ∈ (0,¥ ) and for each a ∈ (0,¥ ) there is b 0(a) ∈
(0,¥ ) such that for all e > 0 small enough, all b ≥ b 0(a) and any S ∈ S that obeys (2.12),

holds as soon as t is sufﬁciently large.

P0(cid:0)R(t) = S(cid:12)(cid:12)R(t) ⊆ S(cid:1) ≥ e−c|¶ S|

Deferring the proof of the lemma to the next subsection, let us see how it implies the above

proposition:
Proof of Proposition 2.2. Obviously

where we applied that h(1) is of one sign and then bounded the contribution of the second and
higher eigenvalues as in the proof of Proposition 2.1. Invoking (2.15–2.16) along with the deﬁni-
tion of r(t,b ), we then see that, for some c > 0,
P0(cid:0)R(t) ⊆ S(cid:1) ≥

once t is sufﬁciently large. In combination with Lemma 2.4, this proves the claim.

e−tl (1)

c
|S|

(2.21)

(cid:3)

S

2.2 Surface order in conﬁnement probability.

Let us now move to the proof of Lemma 2.4. As it turns out, the main challenge is to deal with the

conditioning on R(t) ⊆ S, which we can write as t S > t where (we recall) t S := inf{t ≥ 0: Xt 6∈ S}.
This would perhaps appear easier if the condition t S > t were replaced by t S = ¥
this is not hard to arrange:

. As it turns out,

Lemma 2.5 There are constants c, ˜c ∈ (0,¥ ) depending only on U such that for all e > 0 small,
all b ≥ 1 and all a ∈ (0,¥ ), if S ∈ S obeys (2.12), then

P0(A|t S > t) ≥

P0(A|t S = ¥ )− e−ct

1
2

holds for all events A ∈ s (Xu : 0 ≤ u ≤ t − u(t)) where

u(t) := ˜car(t,b )3.

Proof. Let u(t) be as above with a constant ˜c to be determined. Abbreviate t′ := t − u(t) and let
A ∈ s (Xu : 0 ≤ u ≤ t′). Deﬁne the collection of stopping times {Ti : i ≥ 0} inductively by

Ti+1 := t′ ∧ inf{u > Ti : Xu 6= XTi}, where T0 := 0,

In light of (2.8) and the equality in (2.10), the ﬁrst term on the right can be bounded as

P0(cid:0)R(t) = S(cid:1) = P0(cid:0)R(t) ⊆ S(cid:1) P0(cid:0)R(t) = S(cid:12)(cid:12)R(t) ⊆ S(cid:1).
P0(cid:0)R(t) ⊆ S(cid:1) ≥ e−tl (1)
≥ e−tl (1)

e−tl (k)
S h(1)(0)2 +
S h(1)(0)2 −|S|3/2e−tl (2)

S h(k)(0) (cid:229)

x∈S

k=2

|S|

,

S

h(k)(x)

(2.18)

(2.19)

(2.20)

(2.22)

(2.23)

(2.24)

(cid:229)
12

and denote

BISKUP AND PROCACCIA

Using the function f (x,t) from (2.5), the Markov property gives us

N := inf{i ∈ N : Ti = t′}.

P0(A|t S > t) = E 0(cid:18)1A∩{t S>t′}

N(cid:213)

i=1

f (XTi,t − Ti)

f (XTi−1,t − Ti−1)(cid:19).

(2.25)

(2.26)

The function f (x,t) admits the representation (2.8). The estimates we derived for the k ≥ 2 part
of the sum above show

S h(1)(x)(cid:229)

(cid:12)(cid:12)(cid:12)(cid:12) f (x,t)− e−tl (1)

For 0 ≤ u ≤ t we then get
f (x,t − u)
f (y,t) ≥ eul (1)

S

h(1)(x)

h(1)(y)(cid:18)1− 2

Thanks to (2.15) and (2.17) we can bound

z∈S

S

.

h(1)(z)(cid:12)(cid:12)(cid:12)(cid:12) ≤ |S|3/2e−tl (2)
minz∈S h(1)(z)2 e−(t−u)(l (2)

|S|3/2

S )(cid:19).
S −l (1)

|S|3/2

minz∈S h(1)(z)2 e−(t−u)(l (2)

S −l (1)

S ) ≤ |S|3/2ec4 diam(S)−u(t)r(t,b )−2

Using the bound on |¶ S| along with the fact that

|¶ S| ≥ diam(S)

,

0 ≤ u ≤ t′.

(2.29)

(2.30)

and also the fact that |S| = O(r(t,b )2), the right-hand side of (2.29) decays to zero with t → ¥
soon as ˜c > c4. We now assume t is large enough so that the expression is less than 1/4.
For all paths of the walk in the event {N ≤ 2t}, we thus get

as

(2.27)

(2.28)

(2.31)

(2.32)

(2.33)

(2.34)

(cid:3)

N(cid:213)

i=1

f (XTi,t − Ti)
f (XTi−1,t − Ti−1) ≥

1
2

et′l (1)

S

h(1)(Xt′)
h(1)(0)

,

and thus

1
2
But the Doob h-transform gives us

P0(A|t S > t) ≥

et′l (1)

S

1

h(1)(0)

E 0(cid:0)1A∩{t S>t′}∩{N≤2t}h(1)(Xt′)(cid:1).

P0(A|t S = ¥ ) = et′l (1)

S

1

h(1)(0)

E 0(cid:0)1A∩{t S>t′}h(1)(Xt′)(cid:1)

so we just need to prove

P0(cid:0)N > 2t(cid:12)(cid:12)t S = ¥ (cid:1) ≤ e−ct.

This is derived directly from (2.33), (2.16) and the fact that tl

(1)

S = o(t); cf (2.14).

In order to proceed further, it will be easier to convert to a discrete-time version of the condi-

tional chain. Here we note:

SHAPE THEOREM FOR RANDOM WALKS

13

Lemma 2.6 Under P0(−|t S = ¥ ), the law of (Xt : t ≥ 0) satisfes

law

(2.35)
where Z = (Zn : n ≥ 0) is the discrete time Markov chain on S with Z0 = 0 a.s. and the transition
probabilities given by

= (ZNt : t ≥ 0),

(Xt : t ≥ 0)

P(x,y) =

1

2d − l

h(1)(y)
h(1)(x)

(1)
S

(2.36)

(1)

S , independent of Z.

whenever x and y are nearest neighbors of Z2, and (Nt : t ≥ 0) is the Poisson process with rate
2d − l
Proof. The general theory ensures that the random walk conditioned on t S = ¥
is still a Markov
process. Since the state space is ﬁnite, this Markov process is automatically realized as a time
change of a discrete-time Markov chain. An inspection of (2.33) shows that the waiting time at
S which, in particular, is independent of x. The same
formula shows that the corresponding discrete-time Markov chain has transition probabilities as
stated in (2.36).
(cid:3)

site x is exponential with parameter 2d − l

(1)

Henceforth, we will think of X as realized by Z and N. In this representation, there is no need
as the Markov chain Z never leaves S with probability

to write impose the conditioning on t S = ¥
one. Before we get to the proof of Lemma 2.4, we need one more observation:
Lemma 2.7 For any S ∈ S and any pair of nearest neighbors x and y in S,

h(1)(y)
h(1)(x) ≥

1
2d

.

(2.37)

Proof. Since S is connected, we may assume that h(1) is of one sign, say, h(1) ≥ 0. Whenever x
and y are neighbors, we thus get

(1)

S )h(1)(y) ≤ 2d h(1)(y),

(2.38)

h(1)(x) ≤ (cid:229)

z: |z−y|=1

h(1)(z) = (2d − l
S ≥ 0.

(1)

we have

using the eigenvalue equation and the fact that l
Proof of Lemma 2.4. Set b 0(a) := max{1,2 ˜ca}, where ˜c is as in Lemma 2.5. In light of (1.9), the
quantity in (2.23) obeys u(t) ≤ t/2 as soon as b ≥ b 0(a). In particular, as soon as S obeys (2.12)

(cid:3)

P0(cid:0)R(t) = S(cid:12)(cid:12)R(t) ⊆ S(cid:1) ≥

1
2

P0(cid:0)R(t/2) = S(cid:12)(cid:12)t S = ¥ (cid:1)− e−ct.

The conditional X process is now representable using Z and N above. Since the latter processes
are independent, dropping probability of order e−ct for some c > 0 small, we can assume that the
Markov chain X makes at least n := ct steps in time t/2. (This uses that the jump rate 2d − l
S is

uniformly positive thanks to (2.14).) Hence,

P0(cid:0)R(t/2) = S(cid:12)(cid:12)t S = ¥ (cid:1) ≥ P0(cid:0)¶ ⋆S ⊆ {Z1, . . . ,Zn}(cid:1)− e−ct ,

(2.40)
where ¶ ⋆S denotes the inner vertex boundary of S. Noting that, under our restrictions in (2.12),
both diam(S) and |¶ ⋆S| are at most order t1/3 which is much less than n, we now realize the lower
bound by forcing Z to take a path going from 0 directly to ¶ ⋆S and then move on or around ¶ ⋆S

(1)

(2.39)

14

BISKUP AND PROCACCIA

until all vertices of ¶ ⋆S are visited. The length of this path is at most a constant times |¶ S|. By
Lemma 2.7, P(x,y) ≥ c > 0 uniformly for all neighbors x,y ∈ S, and so the probability of the
given strategy is at least e−c|¶ S|. By (2.12) again, this is sufﬁciently large to absorb all prefactors
as well as e−ct corrections.
Remark 2.8 The boundary term c|¶ S| in the exponent on the right-hand side of (2.13) arises

directly from (2.18) (other errors are subexponential in the boundary); no such term appears in
the upper bound in (2.4). Our inability to control this term more explicitly than by way of an

(cid:3)

estimate is the sole reason why our proof of the shape theorem is restricted to the limit b → ¥

An interested reader might wonder (as we have) whether the boundary-order error term is not
just an artifact of our way of proving the lower bound. The answer is that, most likely, it is not:
Indeed, denoting, for e > 0,

.

S′t,e :=nS ∈ S : P0(cid:0)R(t) = S(cid:12)(cid:12)R(t) ⊆ S(cid:1) ≥ e−e |¶ S|o,

Z(b ,t) ≥ (cid:229)

S∈S′t,e

e−b H(S)−(e +o(1))|¶ S|−tl (1)

S

,

(2.41)

(2.42)

we have

where o(1) tends to zero with diameter of S. However, H(S) = O(|¶ S|) and so, for b ≪ e ≪ 1,
as soon as S′t,e contains, say, all sets in S within log r(t,b ) Hausdorff distance of the Euclidean
ball of radius Kr(t,b ) for some K > 0 large enough, the sum would diverge in the limit as t → ¥
.
This would be in contradiction with Z(b ,t) ≤ 1, implied by H(S) ≥ 0.

3. BOUNDARY NORM AND SKELETONS

Our next task is to control the energy of each conﬁguration using a suitable norm. In addition,
we will group the discrete “shapes” into (generally non-disjoint) families each of which is repre-
sented by a single continuum object, called a skeleton. A similar coarse-graining argument has
been invoked numerous times in various studies of the two-dimensional Wulff construction. We
will draw on ideas from the early work in the context of the two-dimensional Ising model at low
temperatures by Dobrushin, Koteck´y and Shlosman [17].

3.1 Boundary norm.
The starting point is the construction of the norm r
for each admissible law P. Here and hence-
forth, we will write E to denote the expectation with respect to P. Recall the deﬁnition of D(x,y)
from (1.18). The following lemma is standard; we include it for completeness of exposition.
Lemma 3.1 Suppose P is an admissible law and let 0 < a < b < ¥ be such that the edge weights
are supported in [a,b] under P. Then there exists a norm r on R2 such that

E D(0,nx)

n

= r (x),

lim
n→¥

x ∈ Z2.

(3.1)

In particular, the limit exists and the norm r obeys a|x|1 ≤ r (x) ≤ b|x|1 for all x, where | · |1
denotes the ℓ1-norm on Z2.

SHAPE THEOREM FOR RANDOM WALKS

15

Proof. By deﬁnition,

(3.2)
The stationarity of P with respect to translates of Z2 ensures that D(x,x + y) is equidistributed
to D(0,y). Moreover, we clearly have

D(x,y) ≤ D(x,z) + D(z,y),

x,y,z ∈ Z2.

a|x− y|1 ≤ D(x,y) ≤ b|x− y|1,

(3.3)
It follows that, for each x ∈ Z2, the sequence {ED(0,nx): n ≥ 1} is subadditive. By Fekete’s
Lemma the limit in (3.1) exists and deﬁnes a map r : Z2 → [0,¥ ). By (3.2), r obeys the triangle
inequality on Z2 and, since it is also homogeneous over integers, it is a restriction of a norm
on R2. The bounds between r and the ℓ1-norm then follow from (3.3).
(cid:3)

We are now ready to address the main part of Theorem 1.3 which states, roughly, that the
norm r captures the leading-order behavior of the FPP-distances D(x,y) at linear scales in sufﬁ-
ciently large boxes centered at the origin.
Proof of Theorem 1.3. The inequality (3.2) and the fact that {D(z + x,z + y): z ∈ Z2} is stationary
(and bounded) implies via the Subadditive Ergodic Theorem that the limit ˆr (x) := limn→¥ D(0,nx)
exists P-almost surely. Thanks to the triangle inequality (3.2), one checks that ˆr
is invariant
(a.s.) under translations of Z2. By ergodicity of P, it is thus almost surely constant. Taking
expectations, the Bounded Convergence Theorem and Lemma 3.1 above show that

n

D(0,nx)

n

lim
n→¥

= lim
n→¥

E D(0,nx)

n

= r (x)

(3.4)

holds P-almost surely for each x ∈ Z2. What remains to be done is to bootstrap this “directional”
convergence into the uniform bound (1.19).
First note that, by choosing a ﬁnite set of rational directions on the unit circle and using (3.2)
to interpolate the directions in-between, we can augment (3.4) to the following claim: For each

x ∈ Z2 and each e > 0, there is n0(x,e ) with P(n0(x,e ) < ¥ ) = 1 such that for each y ∈ Z2,

|y− x|1 > n0(x,e ) ⇒ (1− e )r (x− y) ≤ D(x,y) ≤ (1 + e )r (x− y).

(3.5)

(This is standard as it is exactly what one needs to conclude a uniform shape theorem for large

balls in ﬁrst passage percolation.) The sequence {n0(x,e ): x ∈ Z2} is stationary and, since it is
also a.s. ﬁnite, there is an M > 0 such that P(n0(x,e ) ≤ M) > 0 for all x ∈ Z2. The ergodicity of P

then ensures that

has a positive density in Z2. This implies

AM := {x ∈ Z2 : n0(x,e ) ≤ M}

1
n

lim
n→¥

max
z: |z|1≤n

dist1(z,AM) = 0

P-almost surely, where dist1 is the distance in the ℓ1-norm. We will now ﬁx d > 0, assume that n
is so large that

d n ≥ M and

max
z: |z|1≤n

dist1(z,AM) ≤ d n

holds and derive a bound on the maximum in the statement of the theorem.

(3.6)

(3.7)

(3.8)

16

BISKUP AND PROCACCIA

Suppose that (3.8) holds and pick x,y ∈ Z2 with |x|1,|y|1 ≤ n. Let x0, resp., y0 denote the

closest point in ℓ1-distance in AM to x, resp., y. The triangle inequality (3.2) shows

Letting b denote the a.s. upper bound on the weights under P, we have

(cid:12)(cid:12)D(x,y)− D(x0,y0)(cid:12)(cid:12) ≤ D(x,x0) + D(y,y0).
|x− x0|1 ≤ M ⇒ D(x,x0) ≤ b|x− x0|1 ≤ bM

while, assuming e < 1, (3.5) and (3.8) yield

(3.9)

(3.10)

(3.11)

(3.12)

(3.13)

(3.14)

(3.15)

(3.16)

(3.17)

|x− x0|1 > M ⇒ D(x,x0) ≤ (1 + e )r (x− x0) ≤ 2b|x− x0|1 ≤ 2bd n.

Completely analogous statements hold for D(y,y0) as well. Using d n ≥ M we thus get

It remains to relate D(x0,y0) to r (x− y). Invoking again (3.5), a very similar reasoning to one

(3.8) holds ⇒ (cid:12)(cid:12) D(x,y)− D(x0,y0)(cid:12)(cid:12) ≤ 4bd n.

above yields

Since (3.3) gives

(1− e )r (x0,y0)− bd n ≤ D(x0,y0) ≤ (1 + e )r (x0,y0) + bd n.

|x|1,|y|1 ≤ n.

from (3.12–3.14) we thus conclude

(cid:12)(cid:12)r (x− y)− r (x0 − y0)(cid:12)(cid:12) ≤ 2bd n
(3.8) holds ⇒ (cid:12)(cid:12)D(x,y)− r (x− y)(cid:12)(cid:12) ≤ b(e + 7d )n,

As e and d are arbitrary, this proves the claim.
A slight complication with using the quantity D(x,y) is that, in our arguments, the limit b → ¥
has to be taken only after t → ¥
arbitrarily large) b . The following lemma will be quite useful:
Lemma 3.2 Suppose P is admissible and let a > 0 be an almost-sure lower bound on the
weights. Pick b 0 > 1

. This requires us to work with the model at a ﬁxed ﬁnite (albeit

(cid:3)

a log 4. Then for all b > b 0 and all x,y ∈ Z2,
e−b D(x,y) ≤ (cid:229)

e−b d(g ) ≤(cid:0)1− 4e−b 0a(cid:1)−1 e−(b −b 0)D(x,y).

g ∈G (x,y)

Proof. The lower bound is immediate (and we state it mostly for æsthetic reasons). For the upper
bound, we ﬁrst dominate

e−b d(g ) ≤ e(b −b 0)D(x,y)e−b 0d(g ),

g ∈ G (x,y),

and then use d(g ) ≥ a|g |1, where |g |1 is the length of (i.e., the number of edges crossed by) g , and
a standard path-counting argument to estimate the sum of e−b 0d(g ) over g ∈ G (x,y) by a geometric
series with quotient 4e−b 0a.

(cid:3)

3.2 Polygonal approximation.
Consider now a set S ∈ S and recall that ¶ S is the set of outer-boundary edges of S. The collection
of edges dual to those in ¶ S can then be ordered in such a way that they form a simple closed
path g S on Z2⋆. Our next task is to partition this path into pieces whose contribution can be
represented using the norm constructed earlier.

SHAPE THEOREM FOR RANDOM WALKS

17

Fix an integer L ≥ 1. Given a set S ∈ S and the boundary curve g S, we will deﬁne a collection
of points {x0,x1, . . . ,xn(S) = x0} on g S inductively as follows: Let x0 be the vertex of the Z2⋆
that is the smallest of all vertices on g S in the standard lexicographic order on Z2. Following g S
in the counterclockwise orientation, let x2 be the ﬁrst vertex on g S that is at least ℓ1-distance L
from x1; if no such vertex exists we set n(S) := 1 and let xn(S) := x0. Similarly, if {x0, . . . ,xk}
have already been deﬁned, we let xk+1 be the ﬁrst vertex on the portion of g S starting from xk that
is ℓ1-distance L from xk; if no such vertex exists we set n(S) := k + 1 and xn(S) := x0.

Now assume that S ∈ S is such that n(S) > 1. Connecting the pairs (xi,xi+1) by linear segments
gives rise to a polygonal closed curve P(S). In analogy with the objects deﬁned in Dobrushin,
Koteck´y and Shlosman [17], we will refer to P(S) as the L-skeleton of S (the reference to L marks
the obvious dependence of P(S) on L). Abusing notation slightly, we write n(P) for the number
of vertices in P. Let

PL :=(cid:8)P(S): S ∈ S, n(S) > 1(cid:9)

(3.18)

(3.19)

denote the set of all (non-trivial) L-skeletons that can possibly arise. The skeletons will enter the
computation of the probabilities of various shapes via the following estimate:

Lemma 3.3 For each admissible law P and each e ∈ (0,1) there is b 1 ∈ (0,¥ ) and a (random)
L0 ∈ [1,¥ ) such that for all b > b 1, all L ≥ L0 and all P ∈ PL with n := n(P) ≤ 1/e ,

e−b H(S) ≤ e2bb L expn−(1− e )

r (xi − xi−1)o

n(cid:229)

i=1

S : P(S)=P

where x1, . . . ,xn are the vertices of the polygonal curve P and where b is an a.s. upper bound on
the edge weights under P.

Proof. Fix e ∈ (0,1) and let L0 be the smalles non-negative integer such that for all L ≥ L0 and
all x,y ∈ Z2, we have

|x|1,|y|1 ≤ L/e & |x− y| ≥ L ⇒ D(x,y) ≥ (1− e )1/2r (x− y).
Theorem 1.3 ensures that P(L0 < ¥ ) = 1. Let now L ≥ L0 and let P ∈ PL obey n := n(P) ≤ 1/e .
Note that the vertices x0, . . . ,xn of P then satisfy |xi|1 ≤ L/e and, in partiular, we have

(3.20)

D(xi−1,xi) ≥ (1− e )1/2 r (xi − xi−1),

(3.21)
We now ﬁx the skeleton P and proceed to prove (3.19) for b 1 deﬁned (later) only in terms of e
and the a.s. upper and lower bounds on the edge weights.
Given S ∈ S such that P(S) = P, let g S be the simple path on dual-Z2 corresponding to S as
discussed above. Then g S passes through the vertices x1, . . . ,xn of P in the given order and so we
may write g i to denote the portion of g S between xi−1 and xi. Clearly, g i ∈ G (xi−1,xi) and so we

i = 1, . . . ,n− 1.

have an injection

Moreover,

(cid:8)S ∈ S : P(S) = P(cid:9) → G (x0,x1)×···× G (xn−1,xn).

H(S) ≥ d(g 1) +··· + d(g n−1).

(3.22)

(3.23)

(cid:229)
BISKUP AND PROCACCIA

18

It thus follows that

e−b H(S) ≤

n−1

i=1

S : P(S)=P

e−b d(g ).

g ∈G (xi−1,xi)

Invoking the upper bound in Lemma 3.2, for b > b 0 we then get

e−b H(S) ≤ (1− 4e−b 0a)−n

n−1

i=1

S : P(S)=P

e−(b −b 0)D(xi−1,xi).

(3.24)

(3.25)

(3.26)

Assuming that b 1 is so large that 1− b 0/b 1 ≥ (1− e )1/2, as soon as b > b 1 the bound (3.21)

yields (3.19) with the right-hand side multiplied by

CL := ebr

(xn−xn−1)−2b bL(1− 4e−b 0a)−n.

In light of n ≤ 1/e and r (xn − xn−1) ≤ b|xn − xn−1|1 ≤ bL, we have CL ≤ 1 as soon as b 1 is so
large that eb 1b ≥ (1− 4e−b 0a)−1/e .
A minor problem with the above construction of L-skeletons is that P(S) need not be a simple
curve. However, if we deﬁne wP(x) to be the winding number of P (oriented counterclockwise)
around x ∈ R2 r P and set

(cid:3)

Int(P) :=(cid:8)x ∈ R2 r P: wP(x) odd(cid:9),

(3.27)

then P can be reparametrized as a closed curve that “keeps Int(P) on its left.” (An explicit
construction requires a limit argument performed, e.g., in [9, Lemma 4.4]). In this case, it is quite
consistent to abbreviate

P(cid:0)Int(P)(cid:1) :=

n(cid:229)

i=1

r (xi − xi−1),

(3.28)

where x0,x1, . . . ,xn = x0 are the vertices of P.

(1)

Of course, in light of (1.25), the bound in (3.19) will only be useful if we can ﬁrst lower-
bound l
S by a quantity that depends only on P := P(S). Naturally, we would like to work
with Int(P), but the fact that ¶ S may reach as far as L lattice spacings outside of Int(P) forces us
to consider instead an L-neighborhood of Int(P). Relating the perimeter of this L-neighborhood
to P(Int(P)) then seems rather hard, due to possible “holes” and and other effects caused by
“inward” spikes of P. These issues disappear when we consider the convex hull of P,

and, given L ≥ 1, let

hull (P) :=(cid:8)a x + (1− a )y: x,y ∈ P, a ∈ [0,1](cid:9),
VL = VL(P) :=(cid:8)x ∈ R2 : dist1(x,hull (P)) < L + 3(cid:9),

where (we recall) dist1 denotes the ℓ1-distance on R2. Obviously,

Concerning the relation between l S and l (VL), we get

S ⊂ VL(cid:0)P(S)(cid:1),

S ∈ S.

(3.29)

(3.30)

(3.31)

(cid:229)
(cid:213)
(cid:229)
(cid:229)
(cid:213)
SHAPE THEOREM FOR RANDOM WALKS

19

l

(1)

(1)

(1)

(1)
S

(3.32)

S < 1 ⇒

We note that, since l

S (cid:1)2 ≥ l (VL).

Proposition 3.4 There is a constant C ∈ (0,¥ ) such that the following holds: For any L ≥ 1 and
any S ∈ S with P(S) = P and VL = VL(P) as above,
(cid:0)1−Cql

Cql
S ≤ c|S|−1/2 for some constant c ∈ (0,¥ ), the conclusion of (3.32) applies
as soon as |S| is sufﬁciently large. For the proof we will need:
Lemma 3.5 There is a constant C ∈ (0,¥ ) for which the following holds: For any f : Z2 → R
there is ef : R2 → R such that
(1) the map f 7→ ef is linear,
(2) ef is continuous on R2 and ef (x) = f (x) for all x ∈ Z2,
(3) for any x ∈ Zd and any y ∈ x + [0,1)2 we have
(cid:12)(cid:12)ef (y)(cid:12)(cid:12) ≤ max
z∈x+{0,1}2(cid:12)(cid:12) f (z)(cid:12)(cid:12),
(cid:12)(cid:12)(cid:12)kefkL2(R2) −k fkℓ2(Z2)(cid:12)(cid:12)(cid:12) ≤ Ck(cid:209)
(5) ef is piece-wise linear and thus a.e. differentiable with
fkℓ2(Z2).

(4) the L2-norms of the functions are related by

fkℓ2(Z2),

(3.34)

(3.33)

(3.35)

Here (cid:209)

f denotes the discrete gradient whereas (cid:209)

˜f denotes the continuous gradient.

k(cid:209) efkL2(R2) = k(cid:209)

Proof. This is a simpliﬁed version of Lemma 3.3 from Biskup, Fukushima and K¨onig [7].

(cid:3)

With this lemma in hand, the proof of the above proposition is quite straightforward:

Proof of Proposition 3.4. Fix P ∈ PL and let S be such that P(S) = P. Let g: Z2 → R denote the
principal eigenfunction of the (lattice) Laplacian in S with zero boundary conditions outside of S.
Thanks to the above deﬁnitions (and using g for function f in Lemma 3.5) there is a function

h: R2 → R (corresponding to ef in the lemma) such that

(1) h ∈ C1
(2) k(cid:209) hkL2(R2) = k(cid:209) gkℓ2(Z2),
(3) khkL2(R2) ≥ kgkℓ2(Z2) −Ck(cid:209) gkℓ2(Z2).

c (VL),

Hence, assuming that the right-hand side of the expression in (3) is positive,

k(cid:209) gk2
Under the normalization kgkℓ2(Z2) = 1 we have k(cid:209) gkℓ2(Z2) =ql

k(cid:209) hk2
khk2

l (VL) ≤

L2(R2) ≤

L2(R2)

The upshot of Proposition 3.4 is that, once l

(1)

ℓ2(Z2)

(kgkℓ2(Z2) −Ck(cid:209) gkℓ2(Z2))2 .

between l

(1)

S and l (VL). It remains relate P(Int(P)) to P(VL). This is the content of:

S is known to be small, we get a tight comparison

(3.36)

(1)

S and the claim follows.

(cid:3)

related to P as in (3.30), then

20
Proposition 3.6 For each norm r
there is a constant c ∈ (0,¥ ) such that the following holds for
the perimeter functional U 7→ P(U ) deﬁned using r : For each L ∈ N and each P ∈ PL, if VL is
P(cid:0)Int(P)(cid:1) ≥ P(VL)− cL.

(3.37)
Moreover, for each e > 0 there are d > 0 and z > 0 such that for any r > 0 and any minimizing
shape U0 ∈ U (i.e., a set with F (U0) = min F ),

BISKUP AND PROCACCIA

distH(cid:0)hull (P),rU0(cid:1) < d r

and

distH(cid:0)hull (P),Int(P)(cid:1) > e r
⇒

P(cid:0)Int(P)(cid:1) ≥ P(VL)− cL + z r

(3.38)

For the proof we will need to recall some geometric facts established by the present authors in
a companion paper (Biskup and Procaccia [10]). First, setting U +V := {x + y: x ∈ U,y ∈ V} for
any sets U,V ⊂ R2, a particular feature of the two-dimensional perimeter functional is that

U,V ∈ U convex ⇒

P(U +V ) = P(U ) + P(V ),

(3.39)

see [10, Lemma]. This alone now permits us to give:
Proof of Proposition 3.6, formula (3.37). Fix P and consider the perimeter with respect to the
norm r . Note that the vertices of hull (P) are also vertices of P. The triangle inequality then
readily shows

P(cid:0)hull (P)(cid:1) ≤ P(cid:0)Int(P)(cid:1).
If B := {x ∈ R2 : |x|1 < L + 3}, then VL = hull (P) + B. By (3.39),
P(VL) = P(cid:0)hull (P)(cid:1) + P(B).

Hereby (3.37) follows by the fact that P(B) ≤ cL holds for all L ≥ 1 with some c ∈ (0,¥ ) that
only depends on the underlying norm r .

(cid:3)

For the second part of Proposition 3.6 we ﬁrst note that, since the minimizer of F is unique up
to translates (see [10, Theorem 1.1]), it sufﬁces to consider just one minimizing shape U0. Here
we recall that U0 is said to contain a facet in direction of a unit vector e ∈ R2, if there are x,y with
y = x +|x− y|2e, such that the linear segment [x,y] is contained entirely in ¶ U0. If e′ is a unit
vector that is orthogonal to e and deﬁne, in light of convexity s 7→ r (e + se′),

(3.40)

(3.41)

q ± :=

d
ds±

r (e + se′)(cid:12)(cid:12)(cid:12)s=0

.

(3.42)

The difference q + − q − is non-negative and independent of the orientations of e and e′ — and

thus depends only on e. Then

U0 has a facet in direction e ⇔ q + > q −,

(3.43)

see [10, Theorem 1.5]. The direction e with the property on the right is then called degenerate.

The reason why we care for degenerate directions here is as follows: The r -length of a path
that connects two points on the facet can then be compared to the r -length of the linear segment
connecting just the endpoints. Indeed, for any pair of orthogonal unit vectors e and e′,

n(cid:229)

i=1

r (tie + uie′) ≥(cid:16) n(cid:229)

i=1

ti(cid:17)r (e) +

q + − q −

2

n(cid:229)
i=1|ui|

(3.44)

SHAPE THEOREM FOR RANDOM WALKS

21

holds for any t1, . . . ,tn ∈ R and any u1, . . . ,un ∈ R such that (cid:229) n
use these facts efﬁciently, we will also need:
Lemma 3.7 Let U ∈ U be convex and let Br denote the Euclidean ball of radius r. For each
h > 0 and each x > 0 there is d > 0 such that if x,y obey
[x,y] ⊂ ¶ U + Bd ,

i=1 ui = 0; see [10, Lemma 4.1]. To

(3.45)

then either |x− y|2 < h or there are z,z′ ∈ ¶ U with
|z′ − y|2 < x

|z− x|2 < x ,

and

[z,z′] ⊂ ¶ U.

Proof. If the ﬁrst alternative fails for each d > 0 existed then there would exist sequences {xn}
and {yn} with xn → z ∈ ¶ U and yn → z′ ∈ ¶ U such that [xn,yn] ⊂ ¶ U +B1/n and yet |xn−yn|2 ≥ h .
By convexity of U, the segment [z,z′] would then lie on a facet of U.

(cid:3)

With these in hand, we can now give:

Proof of Proposition 3.6, formula (3.38). Let c1,c2 ∈ (0,¥ ) be such that c1|x|2 ≤ r (x) ≤ c2|x|2
for each x ∈ R2. Fix e > 0 and pick h > 0 such that 2c1e > c2h . Next let m denote the minimum
of (q + − q −)/2 for all degenerate directions e for which U0 has a facet of length at least h /2.
Since ¶ U0 is rectiﬁable, there are only a ﬁnite number of such facets and so, by (3.43), m > 0.
Then let x > 0 be such that m(e − h ) > 4c2x and x < h /4. For these h and x , let now d > 0
be such that Lemma 3.7 applies. We claim that if P be such that the two conditions on the left of
(3.38) hold for some r > 0 and the e and d as above, then

(3.46)

with

P(Int(P)) ≥ P(hull (P)) + z r
:= min(cid:8)(2c1e − c2h ),m(e − h )− 4c2x (cid:9)

z

(3.48)
which is positive by our choices above. This is enough to (3.38) by invoking the argument after
(3.41). It thus remains to show that (3.47) indeed holds.

We begin by noting that, since Int(P) ⊆ hull (P), the assumption distH(hull (P),Int(P)) > e r
implies the existence of a vertex v ∈ P such that

(3.47)

(3.49)

dist2(cid:0)v,hull (P)c(cid:1) ≥ e r.

As hull (P) is a polygonal domain whose every vertex is a vertex of P, there are vertices x,y
of hull (P) such that the part of P between x and y (in the chosen orientation) passes through v.
These can in fact be chosen so that [x,y] ⊂ ¶ hull (P). By the triangle inequality,
P(Int(P)) ≥ P(hull (P)) + r (v− x) + r (v− y)− r (x− y).

(3.50)

We will now bound the expression involving norms on the right-hand side.

Let Hxy denote the open half-plane containing v whose boundary line passes through x and y.

Then hull (P) ⊂ Hxy and so

Thus, in particular,

dist2(v, Hc

xy) ≥ dist2(cid:0)v,hull (P)c(cid:1) ≥ e r.
|v− y|2 ≥ e r.

and

|v− x|2 ≥ e r

(3.51)

(3.52)

22

Next, by our assumptions,

BISKUP AND PROCACCIA

dist2(cid:0)x,¶ (rU0)(cid:1) < d r
and so [x,y] ⊂ (rU0) + Brd . Our choice of d
|x− y|2 < h r or there is a segment [z,z′] on ¶ (rU0) such that |x− z|2 < x r and |y− z′|2 < x r. In

dist2(cid:0)y,¶ (rU0)(cid:1) < d r

(and scale invariance) then ensures that then either

(3.53)

and

the former case we have

r (x− y) ≤ c2h r while

r (v− x) + r (v− y) ≥ 2c1e r

(3.54)

and so (3.47) holds with the ﬁrst alternative in (3.48). In the latter case we add the segment [z,x]
and [y,z′] to the path from x to z to y and apply (3.44) with the result

r (x− v) + r (y− v) + r (x− z) + r (y− z′) ≥ r (z− z′) + m(e − h )r.

(3.55)

Bounding r (x− z) + r (y− z′) ≤ 2c2rx and r (z− z′) ≥ r (x− y)− 2c2rx , we thus get (3.47) with

the second alternative in (3.48). Hence (3.47) is proved and the claim holds.

(cid:3)

4. PROOF OF MAIN THEOREMS

We are now ready to move to the proof of the shape theorem. Throughout this section r denotes
the norm constructed in Theorem 1.3 and F is the functional in (1.14) with the perimeter deﬁned
using this norm. The starting point is a lower bound on the partition function Z(t,b ). This will
set a scale to which we will later compare the contribution of various undesirable events.

4.1 Large deviation lower bound.

The sole subject of this subsection is the proof of:

Proposition 4.1 We have

lim inf
b →¥
For the proof we will need:

lim inf
t→¥

r(t,b )2

t

log Z(t,b ) ≥ − min F .

(4.1)

Lemma 4.2 Given U ∈ U , let S = S(U,t,b ) be as in (2.11). For each e > 0 there is r0 = r0(U )
such that if r(t,b ) ≥ r0, then

l

(1)

S ≤ (1 + e )

l (U )
r(t,b )2 .

Proof. Let U ∈ U , let S = S(U,t,b ) and abbreviate r := r(t,b ). Fix e > 0 and pick h ∈ C¥
such that khkL2(R2) = 1 and k(cid:209) hk2

L2(R2) ≤ (1 + e )1/2l (U ). Then deﬁne
x ∈ Z2

h(cid:0)r−1(x + z)(cid:1) dz,

g(x) :=Z[0,1]2

and note that, for r sufﬁciently large, we have supp(g) ⊂ S. We claim that

k(cid:209) gkℓ2(Z2) ≤

r k(cid:209) hkL2(R2)

1

(4.2)

c (U )

(4.3)

(4.4)

23

(4.5)

(4.6)

SHAPE THEOREM FOR RANDOM WALKS

and, for some absolute constant c ∈ (0,¥ ), also
L2(R2) −kgk2

0 ≤ khk2
These then readily give the claim via

ℓ2(Z2) ≤

c

r2k(cid:209) hk2

L2(R2).

l

(1)

ℓ2(Z2)

k(cid:209) gk2
kgk2

1
r2

S ≤

ℓ2(Z2) ≤

r2k(cid:209) hk2
where c′ := c(1 + e )1/2 and where we assumed that c′
necessary, the right-hand side is at most r−2(1 + e )l (U ).

khk2

k(cid:209) hk2
L2(R2) − c

L2(R2)

L2(R2) ≤

1
r2

(1 + e )1/2l (U )
1− c′

l (U )

r2

r2 l (U ) < 1. Indeed, increasing r further if

It thus remains to establish the bounds (4.4–4.5). The ﬁrst of these is quite straightforward:

Letting e1 and e2 denote the unit vectors in coordinate directions, we have

1

r Z[0,1]2

dzZ 1

0

g(x + ei)− g(x) =

Applying Cauchy-Schwarz, we then get

ds ei · (cid:209) h(cid:0)r−1(x + z + sei)(cid:1).
ds(cid:12)(cid:12)(cid:12)ei · (cid:209) h(cid:0)r−1(x + z + sei)(cid:1)(cid:12)(cid:12)(cid:12)
As is now easy to check, the sums on the right-hand side then reduce to k(cid:209) hk2
by using Cauchy-Schwarz in (4.3) and summing over x ∈ Z2. This in turn shows

i=1,2Z[0,1]2

r2 (cid:229)
x∈Z2

dzZ 1

k(cid:209) gk2

ℓ2(Z2) ≤

1

0

L2(R2).

The second inequality (4.5) is slightly more involved. First, the bound on the left is obtained

(4.7)

.

(4.8)

2

A simple rewrite and the Cauchy-Schwarz estimate then permit us to recast this as

h(cid:0)r−1(x + z)(cid:1) dz(cid:17)2(cid:19).

(4.9)

khk2

L2(R2)−kgk2
= (cid:229)

ℓ2(Z2)

x∈Z2(cid:18)Z[0,1]2
h(cid:0)r−1(x + z)(cid:1)2 dz−(cid:16)Z[0,1]2
dzdz′(cid:12)(cid:12)(cid:12)h(cid:0)r−1(x + z)(cid:1)− h(cid:0)r−1(x + z′)(cid:12)(cid:12)(cid:12)
dsZ[0,1]2×[0,1]2

2

x∈Z2Z[0,1]2×[0,1]2
x∈Z2Z 1
r2 (cid:229)

≤

1

0

dzdz′ (cid:12)(cid:12)(cid:12)(cid:12)(z− z′)· (cid:209) h(cid:16)r−1(cid:0)x + sz + (1− s)z′(cid:1)(cid:17)(cid:12)(cid:12)(cid:12)(cid:12)

2

(4.10)

.

The expression in absolute value is bounded by twice the norm of (cid:209) h at the corresponding point.
The push-forward on R2 of the integrating measure under the map (s,z,z′) 7→ sz + (1− s)z′ is
dominated by a constant times the Lebesgue measure on, say, [−1,2]× [−1,2]. Using translation
invariance again, we get the inequality on the right of (4.5) as well.

(cid:3)

We will also need:

Lemma 4.3 For each admissible P there is q ≥ 1 such that for P-a.e. sample of edge weights,
each x,y ∈ Z2 and each path g = (x⋆

0, . . . ,x⋆

n) ∈ G (x,y) with d(g ) ≤ 2D(x,y) we have
i − x|2,|x⋆

i − y|2(cid:9) ≤ q|x− y|2.

max(cid:8)|x⋆

max
i=0,...,n

(4.11)

(cid:229)
(cid:229)
24
Proof. Recall that for each admissible P there are 0 < a < b < ¥
[a,b] P-a.s. Let c,c′ ∈ (0,¥ ) be the constant such that c|x|2 ≥ |x|1 ≥ c′|x|2 for all x ∈ R2. Clearly,

such that the edge weights lie in

BISKUP AND PROCACCIA

d(g ) ≥ a max

i=0,...,n

max(cid:8)|x⋆

i − x⋆

0|1,|x⋆

n|1(cid:9)
i − x⋆

(4.12)

so if the maximum in the statement is larger than r|x− y|2 then we have d(g ) ≥ a(c′/c)q|x− y|1.
But the assumptions also tell us d(g ) ≤ 2D(x,y) ≤ 2b|x− y|1 and so this is not possible once q is
so large that 2b < a(c′/c)q.
Proof of Proposition 4.1. Let U0 be the minimizer of F and let e > 0 be so small that Propo-
sition 2.2 applies to U := (1 + e )U0. Let P = (x0, . . . ,xn) be a polygonal curve such that 0 ∈
Int(P) ⊂ U0, the vertices of P lie on ¶ U0 and, for d
:= min{|xi − xi−1|2 : i = 1, . . . ,n}, we have
(1− e )U0 ∩(cid:0)P + B2qd (cid:1) = /0 and
(cid:0)P + B2qd (cid:1) ⊆ (1 + e )U0,
(4.13)
where BR is the Euclidean ball of radius R centered at the origin and q is as in Lemma 4.3. This
is possible in light of convexity of U0.

(cid:3)

Next abbreviate r := r(t,b ) and assume that r is so large that
D(cid:0)⌊rxi⌋,⌊rxi−1⌋(cid:1) ≤ (1 + e )rr (xi − xi−1),

This is possible thanks to Theorem 1.3, the fact that P is bounded and also thanks to the continuity

of x 7→ r (x). Pick a minimizing path g i ∈ G (⌊rxi⌋,⌊rxi−1) for each i = 1, . . . ,n. These paths form
a closed cycle on Z2 which, however, may not be simple. Notwithstanding, letting S denote the
ﬁnite connected component of the interior of the above cycle containing the origin, Lemma 4.3
and (4.13) ensure that

i = 1, . . . ,n.

(4.14)

(4.15)

(4.16)

(4.17)

(4.18)

(4.19)

˜S ⊆ S ⊆ S((cid:0)1− e )U0,t,b )
The inclusion ˜S ⊆ S and Lemma 4.2 now yield

and thus, in particular, S ∈ S.

for

˜S := S(cid:0)(1− e )U0,t,b )

On the other hand, the construction of S and (4.14) guarantee

l

(1)

S ≤ l

l (U0)
r(t,b )2 .

(1)

˜S ≤

1 + e
(1− e )2
D(cid:0)⌊rxi⌋,⌊rxi−1⌋(cid:1)

H(S) ≤

n(cid:229)

i=1

d(g i) =

n(cid:229)

i=1

≤ (1 + e )r

r (xi − xi−1) ≤ (1 + e )rP(U0).

n(cid:229)

i=1

Since |¶ S| ≤ a−1H(S)≤ crP(U0) where a is the lower bound on the weights in P, Proposition 2.2

implies

S −b H(S)−c|¶ S|
as soon as b and t are sufﬁciently large. From (1.9) we thus get

Z(t,b ) ≥ e−tl (1)
1 + e
(1− e )2
1 + e
(1− e )2(cid:16)F (U0)−

t
r2
t
r2

l (U0)− (b + ca−1)(1 + e )rP(U0)

c

ab P(U0)(cid:17).

log Z(t,b ) ≥ −
≥ −

SHAPE THEOREM FOR RANDOM WALKS

25

(cid:3)

, b → ¥

and e ↓ 0, the claim follows.

Taking the limits t → ¥
4.2 Proof of the shape theorem.
Suppose, throughout this subsection, that a ∈ (0,1) is an P-a.s. lower bound on edge weights.
Before we delve into proof of the shape theorem, we begin with some basic lemmas. The ﬁrst
one notes a restriction on the diameter of R(t):
Lemma 4.4 For each b > b 3 := 2
E 0(cid:16)e−b H(R(t))

1{|¶ R(t)|>Mr(t,b )}(cid:17) ≤ e− 1

a log 4, all M > 0 and all t sufﬁciently large,

Proof. Note that H(R(t)) ≥ a|¶ R(t)|. On the stated event, ¶ R(t) can be identiﬁed with a closed
path on the dual-Z2 of length at least Mr(t,b ) surrounding the origin in Z2. The number of such
paths of length n is at most n4n and so for b 0 := 1

2 aM t/r(t,b )2

(4.20)

.

E 0(cid:16)e−b H(R(t))

1{|¶ R(t)|>Mr(t,b )}(cid:17) ≤ (cid:229)
Now for b > b 3 we even have (b − b 0) > 1

2

n>Mr(t,b )

a log 4 and b > b 0,
n(4e−b a) ≤ C(b )e−(b −b 0)aM r(t,b ).

b and, by deﬁnition of r(t,b ),

(4.21)

(4.22)

(cid:3)

(b − b 0)r(t,b ) >

1
2

t

r(t,b )2 .

For t sufﬁciently large, we can then absorb C(b ) into the exponent.

The next lemma effectively restricts l

(1)

R(t) to values order r(t,b )−2:

Lemma 4.5 For each b > b 3 := 3
E 0(cid:16)e−b H(R(t))

R(t)>Mr(t,b )−2}(cid:17) ≤ 2e− 1
1{l (1)
Proof. By Lemma 4.4 and Proposition 2.1,

a log 4 and all M and t sufﬁciently large,

2 aM t/r(t,b )2

.

(4.23)

E 0(cid:16) e−b H(R(t))

R(t)>Mr(t,b )−2}(cid:17) ≤ e− 1
1{l (1)
+ (cid:229)
S∈S

2 aM t/r(t,b )2

1{|¶ S|≤Mr(t,b )}1{l (1)

S >Mr(t,b )−2}|S|3/2e−b H(S)−tl (1)

S

(4.24)

Bounding |S|3/2 by cM3/2r(t,b )3 for some constant c ∈ (0,¥ ) and employing the restriction
on l

S dominates the second term on the right by

(1)

cM3/2r(t,b )3e−Mt/r(t,b )2 (cid:229)

e−b H(S).

(4.25)

For b > b 0 := 1
sufﬁciently large, the result is thus at most another factor of e− 1

a log 4, the sum is bounded by a constant that only depends on b . Taking M

2 aM t/r(t,b )2 (since a < 1).

(cid:3)

S∈S

We will now use these to prove:

26

BISKUP AND PROCACCIA

Proposition 4.6 Let M := {x +U0 : − x ∈ U0} where U0 is a minimizer of F . For each e > 0
there is d > 0 such that

lim sup
b →¥

lim sup
t→¥

r(t,b )2

t

log E 0(cid:16)e−b H(R(t))

1{distH(r(t,b )−1R(t),M )>e }(cid:17) ≤ − min F − d .

(4.26)

SM,z

Proof. Much of the work has already been done; here we just basically assemble all facts together.

Abbreviate r := r(t,b ) and let L := ⌊2z r⌋ for some z > 0 to be let go to zero at the end. Let

:=(cid:8)S ∈ S : 2L < |¶ S| ≤ Mr, l

is connected, the discrete Faber-Krahn estimate l

(4.27)
S ≥ c|S|−1 along with the
Since each S ∈ SM,z
isoperimetric inequality |¶ S| ≥ c′|S|1/2 (both written for d = 2) show that |¶ S| > 2L is implied
S ≤ Mr−2 as soon as 4z √M < c′√c. Thanks to Lemmas 4.4–4.5, we can choose M so that
by l
for all z sufﬁciently small the event {R(t) ∈ SM,z } may freely be inserted into the expectation.

S ≤ Mr−2(cid:9).

This reduces the proof to a suitable estimate on the quantity

(1)

(1)

(1)

Ye :=

S∈SM,z

distH(r−1S,M )>4e

e−b H(S)P0(cid:0)R(t) = S(cid:1).

(4.28)

instead of e for later convenience.

where we write 4e
We start by applying the inequality from Proposition 2.1, use that |S| ≤ cMr2 for some constant
c ∈ (0,¥ ) and then represent (as an upper bound) the sum over S as a sum over L-skeletons and

the sum over S for a given skeleton. This yields

e−b H(S)|S|3/2e−tl (1)

S

Ye ≤

S∈SM,z

distH(r−1S,M )>4e
≤ (cM)3/2r3

e−b H(S)e−tl (1)

S

,

S∈SM,z
P(S)=P

(4.29)

P∈PL

distH(r−1P,M )>2e

where we invoked the bound distH(S,Int(P)) ≤ L ≤ 2e r (which requires z < e ) along with
distH(Int(P),M ) = distH(P,M ) to move the Hausdorff-distance restriction to P. We also used
that |¶ S| > 2L implies P(S) ∈ PL.
Let now VL be related to P as in (3.30). Proposition 3.4 then shows
≥ l (VL)(1− z )

S ≥ l (VL)(cid:0)1−CM1/2r−1(cid:1)2

(4.30)

(1)

l

for every S ∈ SM,z once r is large enough. Denote

and note that every P ∈ P′L has at most Mr/L + 1 linear segments. This is less than 1/z

large enough so bounding the sum over S with the help of Lemma 3.3 yields

P′L :=(cid:8)P(S): S ∈ SM,z (cid:9),

Ye ≤ (cM)3/2r3e2bb L

P∈P′L

distH(r−1P,M )>2e

e−tl (VL)(1−z )−b (1−z )P(Int(P)).

Our next goal is to invoke Proposition 3.6 so let d correspond to e in the statement. Without loss
of generality we may assume that d < e . Then for each P subject to distH(r−1P,M ) > 2e ,

(4.31)
for r

(4.32)

(cid:229)
(cid:229)
(cid:229)
(cid:229)
(cid:229)
SHAPE THEOREM FOR RANDOM WALKS

27

(1) either distH(r−1hull (P),M ) ≥ d
(2) or distH(r−1hull (VL),M ) < d and distH(cid:0)Int(P),hull (P)(cid:1) > e r.

In the former case we invoke (3.37) while in the letter case we use (3.38) to conclude, for some

numerical constants c1,c2 ∈ (0,¥ ) that

sum in (4.32) ≤ ec1b L

P∈P′L

distH(r−1hull (P),M )>d

e−(1−z ) t

r2 F (VL(P))

+ ec1b L−c2be

r

e−(1−z ) t

r2 F (VL(P))

(4.33)

P∈P′L

Since distH(r−1hull (P),M ) = distH(r−1VL,M )− L/r, once z
then implies the existence of b (e ) < ¥

and d ′ > 0 such that for all b > b (e ),
distH(r−1hull (P),M ) > d ⇒ F(cid:0)VL(P)(cid:1) ≥ min F + d ′.

Since b r = t

r2 , assuming without loss of generality that d ′ ≤ c2e yields, for some c3 ∈ (0,¥ ),

is so small that z < d /2, (1.16)

Ye ≤ 2(cM)3/2r3 eb c3L e− t

r2 (1−z )[min F +d ′]|P′L|.

linear segments each of which is of length at most L, there

(4.34)

(4.35)

Since every P ∈ P′L has at most 1/z
is c ∈ (1,¥ ) such that

|P′L| ≤(cid:0)cL2(cid:1)1/z

.

(4.36)

The entropy of the skeletons is thus negligible and so, since b L = (1 + o(1))2z t/r2, we get

b > b (e ) ⇒ lim sup

t→¥

r(t,b )2

t

logYe ≤ −(1− z )[min F − d ′]− 2c3z .

(4.37)

It now remains to put the pieces together to get:

followed by z ↓ 0 then gives the claim for all e > 0.

Taking b → ¥
Proof of Theorem 1.4. By Propositions 4.1 and 4.6, given e > 0, the probability in the statement
decays exponentially in t/r(t,b )2 as soon as b
is chosen sufﬁciently large. This readily yields
the claim.
(cid:3)

(cid:3)

5. LAPLACIAN EIGENVALUES AND EIGENFUNCTIONS

The last item to ﬁnish is the proof of certain estimates for the eigenvalues and eigenfunctions
of the Laplacian in discrete sets that well approximate a continuum domain. These have been
deferred to here from Section 2. The estimates are fairly standard; we include proofs for com-
pleteness of exposition. We begin with the claims concerning the eigenvalues:
Proof of Lemma 2.3, (2.14–2.15). The inequality (2.14) follows either by Lemma 4.2 (and the
S and the

corresponding statement in the continuum) or directly by the monotonicity of S 7→ l
fact that S contains a box of side of order r(t,b ).

(1)

(cid:229)
(cid:229)
28

BISKUP AND PROCACCIA

To get the spectral gap estimate (2.15), we have to work a bit harder. Fix U ∈ U and let l
(k)(U )
denote the k-th lowest eigenvalue of the negative Laplacian in U with Dirichlet boundary condi-
tions on ¶ U. The argument will be based on the fact that
(1)(U ) + l

(2)(U ) := l

(2)(U )

(5.1)

obeys

(2)(U ) = inf(cid:8)k(cid:209) g1k2

L2(R2) +k(cid:209) g2k2

L2(R2) : g1,g2 ∈ C

c (U ), hgi,g jiL2(R2) = d i j(cid:9).

(5.2)

(This is sometimes called the Ky Fan principle; cf Ky Fan [20].) For the discrete problem and

we similarly have

(2)

S := l

(1)

S + l

(2)
S

(5.3)

(2)

S = inf(cid:8)k(cid:209) g1k2

(5.4)
Our argument is now based on the fact that the principal eigenvalue in any U ∈ U is non-
degenerate, i.e., L
in terms
of l

ℓ2(Z2) : supp(gi) ⊆ S, hgi,g jiℓ2(Z2) = d i j(cid:9).
(2)(U ) > l (U ). Lemma 4.2 gives us a tight upper bound of l

(1)(U ); it thus sufﬁces to show that, for each e > 0,

ℓ2(Z2) +k(cid:209) g2k2

(1)
S

(2)

S ≥ (1− e )

(2)(U )
r(t,b )2

(5.5)

as soon as t and b are sufﬁciently large and S is any set as speciﬁed in the statement. As S 7→ L

is non-decreasing with respect to inclusion and the scaling relation

(2)
S

l

(k)(a U ) = a −2l

(k)(U )

(5.6)

holds, it will in fact sufﬁce to show this S := S(U,t,b ) for any e > 0.

The inﬁmum in (5.4) is achieved by g1 := h(1) and g2 := h(2), the ﬁrst two eigenfunctions of the

discrete Laplacian in S. Recall that these are normalized to have ℓ2(Z2)-norm one. Let eg1,
resp., eg2 be the functions in R2 that are the counterparts to g1, resp., g2 as in Lemma 3.5.
k(cid:209) gik2

These functions are not necessarily normalized or orthogonal. However, thanks to the fact that

S = O(r(t,b )−2), (3.34) shows, for some c1 ∈ (0,¥ ),
i = 1,2.

ℓ2(Z2) ≤ L

(5.7)

(2)

(cid:12)(cid:12)(cid:12)kegikL2(R2) − 1(cid:12)(cid:12)(cid:12) ≤ c1r(t,b )−2,

Since the map f 7→ ef in Lemma 3.5 is linear, a similar argument applied to f± := g1 ± g2 com-
bined with the polarization identity reveals that, for some c2 ∈ (0,¥ ),
Deﬁning, for r(t,b ) sufﬁciently large,

(cid:12)(cid:12)heg1,eg2iL2(R2)(cid:12)(cid:12) ≤ c2r(t,b )−2

(5.8)

we now get a pair of orthonormal functions. By (3.35) and the fact that g1,g2 are normalized
in ℓ2(Z2) we then have, for some c3,c4 ∈ (0,¥ ),

h1 :=

and

h2 :=

eg1 −hh1,eg2iL2(R2)h1
keg1 −hh1,eg2iL2(R2)h1kL2(R2)

eg1
keg1kL2(R2)
k(cid:209) h1kL2(R2) ≤(cid:0)1 + c3r(t,b )−2(cid:1)k(cid:209) g2kℓ2(Z2)

(5.9)

(5.10)

L
L
¥
L
L
L
L
SHAPE THEOREM FOR RANDOM WALKS

and

k(cid:209) h2kL2(R2) ≤(cid:0)1 + c3r(t,b )−2(cid:1)k(cid:209) g2kℓ2(Z2) + c4r(t,b )−2k(cid:209) g1kℓ2(Z2).

Since by (3.33) the support of h1,h2 is contained in (1 + e )U, from (5.2) and (5.4) we get

(2)(cid:0)(1 + e )r(t,b )U(cid:1) ≤(cid:0)1 + c5r(t,b )−2(cid:1)L

(2)
S

for some c5 ∈ (0,¥ ). Invoking the scaling relation (5.6), the bound (5.5) follows.

Next we move to the claims dealing with lower bounds on the principal eigenfunction:

29

(5.11)

(5.12)

(cid:3)

Proof of Lemma 2.3, (2.16–2.17). The proof of (2.16) will be based on the following simple
fact (derived, e.g., in Biskup and K¨onig [8, Lemma 4.1]): Let Y1,Y2, . . . be the simple symmetric
random walk on Z2 and, abusing our earlier notation slightly, let t S be the ﬁrst exit time of the
walk from S. For the eigenfunction h(1) in S, the process {Mn∧t S : n ≥ 0} where

Mn := h(1)(Yn)(cid:0)1− l
is a martingale with respect to the ﬁltration s (Y0, . . . ,Yn).

S /4(cid:1)−n

(1)

We will now derive the desired conclusion from this fact. We actually begin with an upper
n due to the fact

n∧t S is a submartingale and M2

bound instead of a lower bound. Since M2
that h(1)(Yt S ) = 0 when t S < ¥

, we have

h(1)(x)2 ≤ E x(cid:0)M2

n∧t S(cid:1) ≤ E x(cid:0)M2

n(cid:1) =(cid:0)1− l

Now let S be as in the statement and set n := ⌈r(t,b )2⌉. By (2.14), the prefactor on the right is
bounded uniformly in t,b ≥ 1. Since S ﬁts into a ball of radius proportional to r(t,b ), the Local
Central Limit Theorem shows that Px(Yn = y) ≤ cn−1 ≤ cr(t,b )−2 uniformly in x,y ∈ S. Hence,

E x(cid:0)h(1)(Yn)2(cid:1) = (cid:229)

y∈S

Px(Yn = y)h(1)(y)2 ≤ cr(t,b )−2kh(1)k2

ℓ2(Z2).

n∧t S ≤ M2
S /4(cid:1)−nE x(cid:0)h(1)(Yn)2(cid:1).

(1)

(5.13)

(5.14)

(5.15)

(5.16)

(5.17)

(5.18)

(5.19)

Moving over to the desired lower bound, the sequence {h(1)(Yn∧t S ): n ≥ 0} is a non-negative

supermartingale and so for any stopping time T ,

As h(1) is assumed normalized and |S| is of order r(t,b )2, we get

with ˜c depending only on U.

max
x∈S

h(1)(x)2 ≤

˜c
|S|

h(1)(0) ≥ E 0(cid:0)h(1)(YT∧t S )(cid:1).
We will use this for T equal to Ta := inf{n ≥ 0: Yn ∈ La} where
|S|o.
La :=nx ∈ S : h(1)(x)2 ≥
P0(Ta < t S).

Then (5.17) reads

a

h(1)(0) ≥

a
|S|

It sufﬁces to derive a lower bound on P0(Ta < t S) for S := S((1− e )U,t,b ) which is uniformly
positive in the limit as r(t,b ) → ¥

for all e small enough.

L
30

BISKUP AND PROCACCIA

Since h(1) is normalized, the upper bound (5.16) ensures that |La| ≥ 1−a
˜c−a|S| (for a < 1). We
assume a > 0 is small enough that 1−a
˜c−a > (2 ˜c)−1. Let Bs(x) := x + [−s,s]2 ∩ Z2. An averaging
argument then shows that there is d > 0 depending only on ˜c and U such that for at least one x ∈ S,

Bd r(t,b )(x) ⊂ S

and

(cid:12)(cid:12)Bd r(t,b )(x)∩ La(cid:12)(cid:12) ≥

1

2 ˜c(cid:12)(cid:12)Bd r(t,b )(x)(cid:12)(cid:12)

:= d /(4 ˜c). A use of the pigeon-hole principle shows that, for some integer n with

(5.20)

Now take ˜d
n/r(t,b ) ∈ [2 ˜d ,d ] we then have

n
4 ˜c

(cid:12)(cid:12){z ∈ Z2 : |z− x|¥ = n}∩ La(cid:12)(cid:12) ≥

(5.21)
We now bound P0(Ta < t S) by ﬁrst requiring the walk to hit B ˜d r(t,b )(x) before exiting from S
and then to hit {z ∈ Z2 : |z − x|¥ = n} ∩ La before exiting from Bn(x). The former event has
a uniformly positive probability due to the convergence of the walk to Brownian motion in the
supremum norm and the fact that both B ˜d r(t,b )(x) and S scale proportionally to r(t,b ). The
latter event has a uniformly positive probability by the fact that, for any N ≥ 1 large enough and
any c > 2, the exit distributions from BcN(x) for the walk started at x and the walk started at
any z ∈ ¶ BN(x) are mutually absolutely continuous with bounds that are uniform in N and z.

Having proved (2.16), the proof of (2.17) is now straightforward. Indeed, a successive use of

Lemma 2.7 shows that

h(1)(y)
h(1)(x) ≥ (2d)−diam(S),

x,y ∈ S.

Taking x := 0, the lower bound in (2.16) now ﬁnishes the job.

(5.22)

(cid:3)

This research has been partially supported by NSF award DMS-1407558 and GA ˇCR project
P201/16-15238S.

ACKNOWLEDGMENTS

REFERENCES

[1] K. Alexander, J. T. Chayes, and L. Chayes. The Wulff construction and asymptotics of the ﬁnite cluster distribu-

tion for two-dimensional Bernoulli percolation. Commun. Math. Phys., 131(1):1–50, 1990.

[2] S. B. Asselah, Amine. Boundary of the range I: Typical behaviour. arXiv:1507.01031.
[3] S. B. Asselah, Amine. Boundary of the range II: Lower tails. arXiv:1601.03957.
[4] A. Aufﬁnger, M. Damron, and J. Hanson. 50 years of ﬁrst passage percolation. arXiv:1511.03262, 2015.
[5] N. Berestycki and A. Yadin. Condensation of random walks and the Wulff crystal. arXiv:1305.0139.
[6] M. van den Berg, E. Bolthausen, and F. den Hollander. Moderate deviations for the volume of the Wiener sausage.

Ann. of Math. (2), 153(2):355–406, 2001.

[7] M. Biskup, R. Fukushima, and W. K¨onig. Eigenvalue ﬂuctuations for lattice Anderson hamiltonians. arXiv

preprint arXiv:1406.5268, 2014.

[8] M. Biskup and W. K¨onig. Eigenvalue order statistics for random Schr¨odinger operators with doubly-exponential

tails. Commun. Math. Phys., 341(1):179–218, 2016.

[9] M. Biskup, O. Louidor, E. B. Procaccia, and R. Rosenthal. Isoperimetry in two-dimensional percolation. Comm.

Pure Appl. Math., 68(9):1483–1531, 2015.

[10] M. Biskup and E. B. Proccacia. Shapes of drums with lowest base frequency under non-isotropic perimeter

constraints. in preparation, 2015.

SHAPE THEOREM FOR RANDOM WALKS

31

[11] T. Bodineau. The Wulff construction in three and more dimensions. Commun. Math. Phys., 207(1):197–229,

1999.

[12] T. Bodineau, D. Ioffe, and Y. Velenik. Rigorous probabilistic analysis of equilibrium crystal shapes. J. Math.

Phys., 41(3):1033–1098, 2000. Probabilistic techniques in equilibrium and nonequilibrium statistical physics.

[13] E. Bolthausen. Localization of a two-dimensional random walk with an attractive path interaction. Ann. Probab.,

22(2):875–918, 1994.

[14] R. Cerf. Large deviations for three dimensional supercritical percolation. Ast´erisque, (267):vi+177, 2000.
[15] R. Cerf and ´A. Pisztora. On the Wulff crystal in the Ising model. Ann. Probab., 28(3):947–1017, 2000.
[16] F. den Hollander. Random polymers, volume 1974 of Lecture Notes in Mathematics. Springer-Verlag, Berlin,

2009. Lectures from the 37th Probability Summer School held in Saint-Flour, 2007.

[17] R. Dobrushin, R. Koteck´y, and S. Shlosman. Wulff Construction, volume 104 of Translations of Mathematical
Monographs. American Mathematical Society, Providence, RI, 1992. A global shape from local interaction,
Translated from the Russian by the authors.

[18] M. D. Donsker and S. R. S. Varadhan. On the number of distinct sites visited by a random walk. Commun. Pure

Appl. Math., 32(6):721–747, 1979.

[19] R. Durrett and T. M. Liggett. The shape of the limit set in Richardson’s growth model. Ann. Probab., 9(2):186–

193, 1981.

[20] K. Fan. On a theorem of Weyl concerning eigenvalues of linear transformations. I. Proc. Nat. Acad. Sci. U. S. A.,

35:652–655, 1949.

[21] O. H¨aggstr¨om and R. Meester. Asymptotic shapes for stationary ﬁrst passage percolation. Ann. Probab.,

23(4):1511–1522, 1995.

[22] D. Ioffe and R. H. Schonmann. Dobrushin-Koteck´y-Shlosman theorem up to the critical temperature. Commun.

Math. Phys., 199(1):117–167, 1998.

[23] W. K¨onig. The parabolic Anderson model. Springer book series (to appear).
[24] T. Povel. Conﬁnement of Brownian motion among Poissonian obstacles in Rd, d ≥ 3. Probab. Theory Rel. Fields,
[25] A.-S. Sznitman. On the conﬁnement property of two-dimensional Brownian motion among Poissonian obstacles.

114(2):177–205, 1999.

Commun. Pure Appl. Math., 44(8-9):1137–1170, 1991.

[26] A.-S. Sznitman. Brownian motion, obstacles and random media. Springer Monographs in Mathematics.

Springer-Verlag, Berlin, 1998.

