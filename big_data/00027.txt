Prepared for submission to JHEP

FERMILAB-PUB-16-046-PPD

Thinking outside the ROCs: Designing Decorrelated
Taggers (DDT) for jet substructure

James Dolen,a Philip Harris,b Simone Marzani,a Salvatore Rappoccio,a and Nhan Tranc

aUniversity at Buﬀalo, The State University of New York, Buﬀalo, NY 14260-1500, USA
bCERN, European Organization for Nuclear Research, Geneva, Switzerland
cFermi National Accelerator Laboratory (FNAL), Batavia, IL 60510, USA

Abstract: We explore the scale-dependence and correlations of jet substructure observ-
ables to improve upon existing techniques in the identiﬁcation of highly Lorentz-boosted
objects. Modiﬁed observables are designed to remove correlations from existing theoretically
well-understood observables, providing practical advantages for experimental measurements
and searches for new phenomena. We study such observables in W jet tagging and pro-
vide recommendations for observables based on considerations beyond signal and background
eﬃciencies.

6
1
0
2

 
r
a

M
8

 

 
 
]
h
p
-
p
e
h
[
 
 

2
v
7
2
0
0
0

.

3
0
6
1
:
v
i
X
r
a

Contents

1 Introduction

2 Current taggers

3 Shape observable scaling in QCD

4 Designing decorrelated taggers (DDT)

4.1 Transforming τ2/τ1
4.2 Performance of DDT

5 Case studies

5.1 Preservation of mass sidebands
5.2 Diboson Background Estimate

6 Generalized Scale Invariance

7 Conclusion and Outlook

1

2

4

6
6
8

9
9
11

11

13

1 Introduction

Techniques that aim to exploit the substructure of jets in order to identify highly Lorentz-
boosted objects [1–4] have become an essential component of the LHC phenomenology toolkit.
Several grooming and tagging algorithms, e.g. [5–15], have been developed, successfully tested,
and are currently used in experimental analyses. Considerable theoretical progress has also
been made and theoretical calculations that describe the action of groomers and taggers
on both background [16, 17] and signal jets [18, 19] have been performed. More recently,
calculations have been extended to interesting case in which a jet shape is measured in
conjunction with a cut on the jet mass in [20–23] and [24].

Despite this enormous amount of progress, experimental collaborations have yet to fully
exploit the advantages that these ideas can provide. Even more recently, much study has been
focused on the relationship of numerous identiﬁcation observables in order to construct the
most optimal heavy object taggers. Dedicated phenomenological studies [4] and detailed anal-
ysis by CMS [25–28] and ATLAS [29–32] employing multivariate techniques were performed in
order to understand how to best identify boosted W/Z bosons, top quarks and Higgs bosons
optimizing the statistical discrimination power of background rejection and signal eﬃciency.
In the following study, we aim to build a tagger based not only on statistical discrimination
power, but also the robust behavior of the inherent QCD background. This tagger will be

– 1 –

designed such that, after applying a ﬂat cut on the tagging variable, the shape of the QCD
background jet mass distribution remains stable and ﬂat. We demonstrate our methodology,
entitled “designed decorrelated taggers (DDT)”, by performing an example analysis in which
hadronically decaying W boson jets are distinguished from quark- and gluon-initiated jets.
The DDT approach is applicable to the identiﬁcation of any heavy boosted objects, such as
Z, H, and top jets.

Samples

√

The Monte Carlo samples used in this study were originally used for studies in the BOOST13
s = 8 TeV for QCD dijets, and for W +W − pairs
report [4]. Samples were generated at
produced in the decay of a scalar resonance. The QCD events were split into subsamples of gg
and q ¯q events, allowing for tests of discrimination of hadronic W bosons, quarks, and gluons.
QCD samples were produced at leading order (LO) using MADGRAPH5 [33], while W W samples
were generated using the JHU GENERATOR [34]. The samples were produced in exclusive pT
bins of width 100 GeV at the parton level. The pT bins investigated in this report were
300-400 GeV, 500-600 GeV and 1.0-1.1 TeV.

The stable particles in the generator-level events are clustered into jets with the anti-kT
jet algorithm [35] with three diﬀerent distance parameters, R = 0.4, 0.8, 1.2, using fastjet
3.1 [36, 37]. No multiple parton interactions (or pileup) is used in these samples, although
previous LHC measurements [38, 39] have shown that grooming algorithms are more resilient
to pileup eﬀects than standard jet algorithms. Furthermore, it was shown in those mea-
surements that the Monte Carlo simulation can accurately reproduce the data for regions
of high jet mass, whereas there are disagreements below the Sudakov peak. The grooming
algorithms, however, mitigate this disagreement very strongly as well. As such, we study jets
with a grooming algorithm applied. The algorithms we have investigated are the “modiﬁed”
mass-drop tagger (mMDT) [5, 16] with zcut = 0.1, jet trimming [10] with Rsub = 0.3 and
fcut = 0.1, jet pruning [8, 9], and soft drop [12] with zcut = 0.1 for both β = 1 and β = 2
(note that the case of β = 0 is equivalent to the mMDT). We have found that the conclusions
are not strongly dependent on the groomer used, so have used soft-drop with β = 0 (mMDT)
for most of our comparisons due to its smoother scaling behavior than other groomers [16].

2 Current taggers

Current heavy object jet substructure taggers employed by CMS and ATLAS often cut on
some number of observables directly or through some algorithm. Take, for example, something
similar to the CMS Run 1 W tagger that uses simple cuts on the N -subjettiness ratio τ2/τ1 [11]
and the soft drop jet mass [12]. In this study, we consider the τ2/τ1 variable where the subjet
axes are chosen using the kT one-pass axes optimization technique.

In order to distinguish hadronically decaying W bosons (which give rise to jets that
are intrinsically two-pronged) from QCD background, a ﬂat cut on on τ2/τ1 is typically
performed. As expected, this procedure greatly reduces the background, but it also leads

– 2 –

to an unwanted sculpting of the soft drop jet mass distribution (an undesirable feature also
discussed in Ref. [40]), as shown in Fig. 1.

Figure 1: Soft drop mass distribution (zcut = 0.1 and β = 0) for gluon jets after various cuts
on τ2/τ1 (βτ = 1) for diﬀerent jet pT bins: pT = 300-400 GeV (top left), pT = 500-600 GeV
(top right), pT = 1-1.1 TeV (bottom left) and also for the signal (bottom right), distributions
for signal are stable versus pT . The cuts in τ2/τ1 vary from 1.0 to 0.0 in steps of 0.02; the
changing line styles for successive cuts are meant to visually aid the reader.

After cutting on τ2/τ1 to select jets which are two-pronged, the QCD background soft
drop jet mass distribution becomes more peak-like in shape, making it harder to distinguish
QCD jets from W jets which also have a peak in the jet mass distribution. The shape of
the sculpted jet mass distribution, and the location of this artiﬁcial peak, varies for diﬀerent
jet pT regions. This pT dependent sculpting of the jet mass distributions makes sideband
methods of background estimation more diﬃcult. In this case and in further examples, we
primarily consider gluon-initiated jets though performance with quark-initiated jets is similar.
Diﬀerences will be explored in greater detail in future studies.

In Ref. [16] it was argued that ﬂat QCD mass distributions could be obtained by tuning
the value of the soft drop energy fraction threshold (zcut), and optimal values for quark- and
gluon-initiated jets were analytically derived. However, the presence of the τ2/τ1 cut makes
this situation more complex and it requires reconsidering the issue.

Therefore, we propose additional criterion in determining a better tagging observable be-

– 3 –

 cuts1t/2tsoft drop mass [GeV], sucessive 020406080100120140a.u.210310410 cuts1t/2tsoft drop mass [GeV], sucessive 020406080100120140a.u.10210310410 cuts1t/2tsoft drop mass [GeV], sucessive 020406080100120140a.u.10210310410 cuts1t/2tsoft drop mass [GeV], sucessive 020406080100120140a.u.050100150200250310·yond pure statistical discrimination power. For similarly discriminant observables, we would
like to ﬁnd an observable which is (1) primarily uncorrelated with the groomed jet mass ob-
servable (or rather that has complementary correlations as far as discrimination is concerned)
and (2) maintains a desirable groomed mass behavior while scaling pT . Observables satisfying
this criterion would, after applying a rectangular cut, still produce a ﬂat groomed jet mass
distribution.

3 Shape observable scaling in QCD

We start our study of the correlations of substructure variables with the jet mass and pT by
introducing the appropriate scaling variable for QCD jets:

ρ = log(m2/p2

T ).

(3.1)

Here we have diﬀered from the typical deﬁnition of jet ρ by removing the jet distance param-
eter R2 from the denominator of the deﬁnition. For now we keep R = 0.8 ﬁxed and leave
this for future study. Note that when we apply soft-drop, we take the mass in Eq. (3.1) to
be computed on the constituents of the soft-drop jet, while the transverse momentum is the
one of the original (ungroomed) jet.

We now compute, on both our background and signal samples, the average value of the
N -subjettiness ratio τ2/τ1 (computed on the full jet) as a function of the soft-drop ρ. This is
shown in Fig. 2, on the left. The signal W jets are shown in open circles while the background,
here gluon jets, are shown in closed circles. The various colors are diﬀerent bins in jet pT .
We note the typical behavior showing τ2/τ1 for the signal tending to lower values than the
background and at a given value in ρ due to the mass scale of the signal jet in a given pT bin.
The signal tends to be ﬁxed around the W mass and thus shifts for diﬀerent values of pT and
is otherwise most concentrated in the dip region. Now, let us focus on the background curves
(solid points). We notice a strong dependence on τ2/τ1 which is what causes the sculpting
of the mass distributions shown in the previous section. However, we note that there exist a
region in ρ for which this relationship is conspicuously linear1. This is an interesting behavior,
which we will exploit shortly in Sec. 4. We also observe that, even in this linear region, there
is still a residual pT dependence, which looks like, to a very good approximation, a constant
shift.

The behavior observed in Fig. 2 for soft drop ρ is also observed for other groomers, such
as trimming and pruning, within the pT ranges consdidered. At lower values of ρ diﬀerences in
the groomers become more apparent, most likely because in that region trimming and pruning
acquire further sensitivity to soft physics [16]. Thus, in the current study, we concentrate on
the soft-drop mass due to its stable behavior.

1We note that, in the case βτ = 2, τ2 essentially measures the subjet mass, while τ1 corresponds to the
jet mass itself. This leads to an approximately linear relation between τ2/τ1 and ρ in the region of the (soft-
collinear) phase-space where all-order eﬀects can be neglected. We thank Andrew Larkoski for raising this
point.

– 4 –

Figure 2: Proﬁle distributions, (cid:104)τ2/τ1(cid:105), as a function of ρ = log(m2/p2
T ) (left) and as a
function of ρ(cid:48) = log(m2/pT /µ) (on the right). Solid dots correspond to background, while
hollow ones to signal. The diﬀerent colors correspond to diﬀerent pT bins.

Ref. [24] performed calculations for jet mass distributions in the presence of a τ2/τ1 cut
to an accuracy which is close to next-to-leading logarithmic (NLL) accuracy. Despite the fact
that the calculation corresponding to the proﬁle plot in Fig. 2 were not performed, it could
in principle be derived because the authors do provide the double diﬀerential distribution in
τ2/τ1 and ρ. However, some important diﬀerences between our current set-up and the one
of Ref. [24] prevent us from using their results to get insight in the behaviors we observe
beyond the existence of a region with linear correlation. First Ref. [24] did not consider
the soft drop ρ and, second, the deﬁnition of N -subjettiness diﬀers in the two studies both
in regards of the angular exponent (βτ = 1 versus βτ = 2) and of the choice of axes. We
note that, at ﬁxed-coupling, all the transverse momentum dependence is accounted for in the
deﬁnition of the shape and ρ. We have checked whether the origin of the pT dependence that
we see in Fig. 2 (on the left) could be traced back to the transverse momentum used in the
deﬁnition of the ρ (ungroomed vs groomed) but this was found not to be the case. Running
coupling contributions, as well as other subleading corrections, do introduce a pT dependence.
However, a quantitative understanding of these eﬀects would require a calculation using the
techniques of Ref. [24]. This goes beyond the scope of this work and for this study we limit
ourselves to a phenomenological solution, while leaving a ﬁrst-principle analysis for future
work. Thus, in order to remove the constant pT dependence in the τ2/τ1 proﬁle, we introduce
a modiﬁed version of ρ:

(3.2)
This change of variable, together with the choice µ ∼ 1 GeV, appears to perform an excellent
job in getting rid of the pT dependence, as shown in Fig. 2, on the right, though of course we
note this is purely an empirical observation.

= log

pT µ

So far, we have only considered τ2/τ1 versus soft drop mass. We also noted that a similar
linear correlation exists between τ2/τ1 and other groomed masses, though not shown explicitly.

– 5 –

(cid:18) m2

(cid:19)

.

ρ(cid:48) = ρ + log

pT
µ

r10-9-8-7-6-5-4-3-2-1-01t/2t00.20.40.60.811.21.4 = 300-400 GeVTbkg, p = 500-600 GeVTbkg, p = 1000-1100 GeVTbkg, p = 300-400 GeVTsig, p = 500-600 GeVTsig, p = 1000-1100 GeVTsig, p'r1-0123456781t/2t00.20.40.60.811.21.4 = 300-400 GeVTbkg, p = 500-600 GeVTbkg, p = 1000-1100 GeVTbkg, p = 300-400 GeVTsig, p = 500-600 GeVTsig, p = 1000-1100 GeVTsig, p2

and Dβ=1

We can also consider other shape variables, though we leave an exhaustive exploration of all
shape variables to a later study. As an example, we show also energy correlation functions
Cβ=1
shows a relatively ﬂat
distribution versus ρ which is desirable although the behavior is not quite linear. On the right,
Dβ=1
is highly correlated with ρ. In both cases, the correlations have some pT -dependence
that is not trivially empirically determined.

as a function of ρ in Fig. 3. On the left, Cβ=1

2

2

2

Figure 3: Proﬁle distributions, (cid:104)Cβ=1
log(m2/p2
colors correspond to diﬀerent pT bins

(cid:105) (right), as a function of ρ =
T ). Solid dots correspond to background, while hollow ones to signal. The diﬀerent

(cid:105) (left) and (cid:104)Dβ=1

2

2

4 Designing decorrelated taggers (DDT)

4.1 Transforming τ2/τ1
By performing the transformation ρ → ρ(cid:48), we have successfully accounted for most of the pT
dependence of the proﬁle distribution. Next we would like to perform a further transformation
with the aim of ﬂattening the proﬁle dependence on ρ(cid:48), with the idea that this will in turn
reduce the mass-sculpting discussed earlier.

In order to determine the transformation we are after, we concentrate on the region in

which the relationship between τ2/τ1 and ρ(cid:48) is essentially linear. Thus, we introduce

21 = τ2/τ1 − M × ρ(cid:48),
τ(cid:48)

(4.1)

where the slope M is numerically ﬁtted from Fig. 2 (red ﬁt lines). The comparison between
the τ2/τ1 and τ(cid:48)
21 distributions is shown in Fig. 4, for diﬀerent jet pT bins. The transformed
variable, τ(cid:48)
21, looks similar to the original variable τ2/τ1 although the behavior of the corre-
lation with the groomed mass is now practically removed. This can be seen in Fig. 5 which
shows the proﬁle of τ(cid:48)

21 as a function of ρ(cid:48) with the intended decorrelated behavior.

Now, we can explore the sculpting of the mass distributions making a ﬂat cut in τ(cid:48)
21.
This is shown in Fig. 6 which should be contrasted with Fig. 1 which was obtained with
a ﬂat cut in τ2/τ1. Notice that now the sculpting of the mass distribution is considerably

– 6 –

r10-9-8-7-6-5-4-3-2-1-0 = 1b2C00.10.20.30.40.50.60.7 = 300-400 GeVTbkg, p = 500-600 GeVTbkg, p = 1000-1100 GeVTbkg, p = 300-400 GeVTsig, p = 500-600 GeVTsig, p = 1000-1100 GeVTsig, pr10-9-8-7-6-5-4-3-2-1-0 = 1b2D01234567 = 300-400 GeVTbkg, p = 500-600 GeVTbkg, p = 1000-1100 GeVTbkg, p = 300-400 GeVTsig, p = 500-600 GeVTsig, p = 1000-1100 GeVTsig, pFigure 4: Raw τ2/τ1 distributions on the left and transformed distribution, τ(cid:48)

21, on the right.

21(cid:105), as a function of ρ(cid:48) = log(m2/pT /µ). Solid dots corre-
Figure 5: Proﬁle distributions, (cid:104)τ(cid:48)
spond to background, while hollow ones to signal. The diﬀerent colors correspond to diﬀerent
pT bins

reduced, particularly in the region of interest where the W boson peak is. With a simple
transformation, we can now preserve mass sidebands for background estimations and make
robust predictions of the pT dependence of the backgrounds. This practical consequences
of a well-behaved background shape will be explored in Section 5. Generally speaking, a
non-linear dependence is not a technical obstacle to performing an observable transformation
and we discuss this in Section 6; however, studying the behavior in a simple analytic regime
allows us to better understand the underlying physical behavior. The ﬁnal component to
evaluating the success of the observable transformation is to understand the performance of
the new observable in terms of rejecting backgrounds.

– 7 –

1t/2t00.10.20.30.40.50.60.70.80.91fraction of events00.010.020.030.040.050.060.070.080.09 = 300-400 GeVTbkg, p = 500-600 GeVTbkg, p = 1000-1100 GeVTbkg, p = 300-400 GeVTsig, p = 500-600 GeVTsig, p = 1000-1100 GeVTsig, p'21t00.20.40.60.811.21.4fraction of events00.020.040.060.080.10.120.14 = 300-400 GeVTbkg, p = 500-600 GeVTbkg, p = 1000-1100 GeVTbkg, p = 300-400 GeVTsig, p = 500-600 GeVTsig, p = 1000-1100 GeVTsig, p'r1-012345678'21t00.20.40.60.811.21.41.6 = 300-400 GeVTbkg, p = 500-600 GeVTbkg, p = 1000-1100 GeVTbkg, p = 300-400 GeVTsig, p = 500-600 GeVTsig, p = 1000-1100 GeVTsig, pFigure 6: Soft drop mass distribution for gluon jets after various cuts on τ(cid:48)
21 for diﬀerent
jet pT bins: pT = 300-400 GeV (top left), pT = 500-600 GeV (top right), pT = 1-1.1 TeV
(bottom left) and also for the signal (bottom right), distributions for signal are stable versus
pT . The cuts in τ(cid:48)
21 vary from 1.0 to 0.0 in steps of 0.02; the changing line styles for successive
cuts are meant to visually aid the reader.

4.2 Performance of DDT

To evaluate the performance of the transformed variable we use the traditional receiver operat-
ing characteristic (ROC) curve, deﬁned as the signal eﬃciency as a function of the background
eﬃciency. A better discriminating tagger is characterized by higher signal eﬃciency and lower
background eﬃciency. The discriminating performance of τ2/τ1 and the transformed τ(cid:48)
21 are
shown in the left of Fig. 7 for jets within a soft drop mass window of [60-120] GeV (corre-
sponding to the W signal mass region). From the ROC curve, we note that after transforming
the variable the discriminating power does not degrade and even shows modest improvement
in this kinematic regime. We can see where this comes from in the right panel of Fig. 7. After
cutting on raw τ2/τ1 the QCD soft drop jet mass distribution is sculpted such that many of
the jets surviving the cut fall into the W mass region. In contrast, cutting on τ(cid:48)
21 leaves a
more linearly falling distribution which preserves the low sideband. The mass distributions
on the right side of Fig. 7 are after making a cut on the shape observable to maintain a signal
eﬃciency of 50%.

– 8 –

' cuts21tsoft drop mass [GeV], sucessive 020406080100120140a.u.210310410' cuts21tsoft drop mass [GeV], sucessive 020406080100120140a.u.210310410' cuts21tsoft drop mass [GeV], sucessive 020406080100120140a.u.10210310410' cuts21tsoft drop mass [GeV], sucessive 020406080100120140a.u.050100150200250310·Figure 7: (left) ROC discrimination curve: W-tagging eﬃciency versus QCD jet tagging
eﬃciency for three pT regions for the transformed τ(cid:48)
21 variable (solid) and the raw τ2/τ1
variable (dashed). Here eﬃciency is deﬁned as the number of jets with mass satisfying
60 <mMDT< 120 GeV which are tagged. (right) Soft drop mass distributions after a cut
on the transformed τ(cid:48)
21 variable (solid) and the raw τ2/τ1 variable (dashed), where the cut
corresponds to 50% signal eﬃciency. Here the uncertainties on each bin signify the expected
variation for a 10% uncertainty on the W boson tag eﬃciency.

5 Case studies

There are several places where the improved scaling behavior can improve the overall measure-
ments and searches of the LHC experiments, in addition to the performance improvements
in the ROC curves shown in Fig. 7. We will present two improvements, the preservation of
mass sidebands in the kinematic ﬁt to extract the W tagging eﬃciency from semileptonic t¯t
events, and the overall background estimate in diboson analyses. Both cases take advantage
of the ﬂatter background distributions to improve the uncertainties in shape-based ﬁts.

5.1 Preservation of mass sidebands

The shape of the jet mass spectrum is used in the LHC experiments to determine the W
tagging eﬃciency; for instance, CMS relies on a simultaneous ﬁt to the jet mass in events
that pass and fail the τ21 selection. However, as shown in Fig. 1, the τ21 selection signiﬁcantly
kinematically sculpts the background distribution in this variable. This can lead to signif-
icant ﬁtted uncertainties when extracting the background normalization, and thus directly
translates to large uncertainties in the W tagging eﬃciency measurement. By using the τ(cid:48)
21,
a signiﬁcant improvement is observed.

where ρ(cid:48) = log(cid:0)m2/pT /µ(cid:1). This translates into a cut on τ(cid:48)

To demonstrate this, we examine two cases, modiﬁed mass drop tagging with τ21 < 0.45,
and modiﬁed mass drop tagging with a scale-dependent selection τ21 < 0.6 − 0.08 × ρ(cid:48),
21 < 0.6. These selections have
approximately the same signal eﬃciency. For simplicity, the same signal and background
MC samples are used as in the previous sections, but the events are weighted with an easily
speciﬁable fraction of background jets. In this case, the background fraction for the entire

– 9 –

Bkg˛00.20.40.60.81Sig˛00.20.40.60.81 = 300-400 GeVTAK8, p = 500-600 GeVTAK8, p = 1000-1100 GeVTAK8, p = 300-400 GeV rawTAK8, p = 500-600 GeV rawTAK8, p = 1000-1100 GeV rawTAK8, p (GeV)MDTm020406080100120140160180200Events050010001500200025003000 = 300-400 GeVTAK8, p = 500-600 GeVTAK8, p = 1000-1100 GeVTAK8, p = 300-400 GeV rawTAK8, p = 500-600 GeV rawTAK8, p = 1000-1100 GeV rawTAK8, psample is 40%. This gives a comparable fraction of merged to unmerged W bosons in a
semileptonic t¯t selection at 13 TeV at the LHC, but allows us to easily tune the fraction.
In addition, to mimic the approximate detector resolution, the intrinsic resolution of the
W → qq system is smeared with a Gaussian of width 10 GeV. This is indicative of the
resolutions obtained at the CMS and ATLAS experiments.

Figure 8 shows simple ﬁts to the jet mass for 5000 MC events in the range 50 < mJ < 120
GeV, after a selection on the N -subjettiness variable. The model is a double Gaussian, one
for the QCD continuum and one for the W mass peak. The jet pT range considered is
pT = 300− 400 GeV, to give a typical pT range of the W bosons from top quark decays from
SM t¯t production. The ﬁrst ﬁt shows the modiﬁed mass drop algorithm after τ21 < 0.45.
The second ﬁt shows the modiﬁed mass drop algorithm after τ(cid:48)
21 < 0.6. The ﬁts successfully
capture the mass of the W and the input width of 10%.

It is interesting to note that the jet mass of the QCD jets after the τ(cid:48)

21 selection are
signiﬁcantly pushed below 10 GeV. In addition, the remaining distribution is ﬂat. However,
for the standard τ21 selection, the distribution is rising, with signiﬁcantly more background
under the W signal peak.

The background uncertainty on the ﬁt is is 6% when using the standard τ21 selection.
21 selection. This is driven by
21 variable

However, it is reduced by a factor of two to 3% by using the τ(cid:48)
the fact that the ﬁtter can more easily handle sidebands that are ﬂatter, so the τ(cid:48)
outperforms the τ21 variable in this metric.

This would translate directly into a decreased systematic uncertainty for the LHC ex-
periments. While newer and more clever algorithms can achieve better performance in MC
simulations, this does not always translate directly to improvements in actual analyses due
to the need to characterize the systematic uncertainties. We therefore propose this test as
an appropriate metric to characterize the systematic performance of new substructure algo-
rithms.

Figure 8: Jet mass for jets with pT = 300− 400 GeV for the modiﬁed mass-drop tagger after
requiring τ21 < 0.45 and τ(cid:48)
21 < 0.6, respectively. These two selections have approximately the
same signal eﬃciency. The background fraction of the entire sample (for all jet masses) is set
to 40%.

– 10 –

Jet mass (GeV)30405060708090100110120Events / 3 GeV020406080100120140160180200220Bkg Uncertainty =  6% =  9.64 +/- 0.40Ws =  79.92 +/- 0.27WmJet mass (GeV)30405060708090100110120Events / 3 GeV020406080100120140160180200220Bkg Uncertainty =  3% =  9.49 +/- 0.28Ws =  80.44 +/- 0.24Wm5.2 Diboson Background Estimate

The diboson background estimate for the LHC experiments is much the same as the extraction
of the W tagging eﬃciency, except that the background fraction is signiﬁcantly higher. We
have chosen a value of 80% (integrated over the entire spectrum of events) as an indicative
fraction, with the same number of events (5000). We have considered two diﬀerent pT ranges,
pT = 500 − 600 GeV and pT = 1000 − 1100 GeV.

One somewhat obvious but important point is that as the pT increases, the Sudakov peak
from QCD-generated jets shifts further to the right. As this occurs, the ﬁts to discriminate
boosted W bosons from QCD-generated jets are less and less able to distinguish between the
categories.

Figures 9 and 10 show similar ﬁts as shown in Fig. 8. However, the background fraction is
raised from 40% to 80% (again integrated over the entire mass spectrum), and the pT ranges
are set to pT = 500 − 600 GeV and pT = 1000 − 1100 GeV, respectively.
For the range pT = 500−600 GeV, it is plain to see that there is a signiﬁcant improvement
of the τ(cid:48)
21 variable, where the background uncertainty decreases from 15% to 6%. This is even
more apparent for the range pT = 1000 − 1100 GeV,where the uncertainty decreases from
23% to 6%.

Figure 9: Jet mass for jets with pT = 500− 600 GeV for the modiﬁed mass-drop tagger after
requiring τ21 < 0.45 and τ(cid:48)
21 < 0.6, respectively. These two selections have approximately the
same signal eﬃciency. The background fraction of the entire sample (for all jet masses) is set
to 80%.

6 Generalized Scale Invariance

Decorrelation schemes can be extended beyond a pair of variables to decorrelate classes of
many variables. Such a procedure can be used to allow for a class of variables to be merged into
a single multi-variate analysis discriminator (MVA), while preserving decorrelation against
one or a set of variables that are further used in the analysis. Consider, for example, building
an MVA W tagger using both τ2/τ1 and Cβ=1
. Both of these variables have correlations with
pT and mass, so the resulting classiﬁer that combines the variables will also be correlated

2

– 11 –

Jet mass (GeV)30405060708090100110120Events / 3 GeV020406080100120140Bkg Uncertainty = 15% =  8.11 +/- 0.72Ws =  79.66 +/- 0.71WmJet mass (GeV)30405060708090100110120Events / 3 GeV020406080100Bkg Uncertainty =  6% =  9.72 +/- 0.62Ws =  79.95 +/- 0.52WmFigure 10: Jet mass for jets with pT = 1000 − 1100 GeV for the modiﬁed mass-drop tagger
after requiring τ21 < 0.45 and τ(cid:48)
21 < 0.6, respectively. These two selections have approximately
the same signal eﬃciency. The background fraction of the entire sample (for all jet masses)
is set to 80%.

with mass and pT . Decorrelating the space of variables against mass and pT before or during
the construction of the MVA can thus preserve the mass and pT invariance resulting in an
uncorrelated tagger. This idea has previously been pursued in b-physics utilizing an MVA
that minimizes the mass dependence, while simultaneously constructing a classiﬁer [41].

T ) by into it components log(m) and log(pT ). Combining this with either C1

In light of building an example based on previously presented studies, we split ρ =
log(m2/p2
2 or
τ2/τ1 gives a class of three variables for which we decorrelate into a set of three independent
linear combinations of variables. The independent variables can be viewed as properties of
the data which span the space of distinctive features. This space can be explored to further
understand behavior of the data. Additionally, a subset of the independent components
can be merged through an MVA while maintaining the decorrelation of the remaining set of
variables. In this way, mass sidebands or other sideband methods can be used on the merged
MVA discriminator with the decorrelated variable.

As has previously been noted, decorrelating variables which are not implicitly linearly
correlated is poorly deﬁned [42]. We thus consider two generalized approaches that attempt
to decorrelate discriminators that are not necessarily linearly correlated. We consider two
decorrelation approaches: Principle Component Analysis (PCA) of transformed variables
and Independent Component Analysis (ICA).

Decorrelation by PCA and ICA

Given a set of variables need not be linearly correlated, we consider a transformed variable
(v(cid:48)

i) of the original variable vi deﬁned by

v(cid:48)
i = f (vi)

(6.1)

For this transformation, we train a gradient boosted decision tree [43] with the boosted W
boson as a signal and a high pT QCD jet as a background. This transformation places the

– 12 –

Jet mass (GeV)30405060708090100110120Events / 3 GeV020406080100120140Bkg Uncertainty = 23% =  9.6 +/- 1.4Ws =  78.15 +/- 0.72WmJet mass (GeV)30405060708090100110120Events / 3 GeV01020304050607080Bkg Uncertainty =  6% =  10.26 +/- 0.53Ws =  80.19 +/- 0.53Wmvariables into a space that enables the possibility of linearized correlations of the original
variables.

The resulting correlation matrix of the transformed variables can be decorrelated through
principle component analysis by taking the eigenvectors of the matrix. This yields a set of
n-independent vectors for a n-dimensional correlation matrix.

The decorrelated vectors for the triplet of transformed τ2/τ1, log(pT ), and log(m) is
shown in Fig. 11. The correlation of the resulting vectors is compared with a gradient boosted
decision tree using all variables and with the transformed mass. From this correlation, we
observe two discriminating dimensions and the pT . These we can write as

v1 = log(m/µ1) + K1(τ2/τ1)
v2 = τ2/τ1 + K2(log(m3.5/pT µ2.5

(6.2)

(6.3)
where K1,2 correspond to coeﬃcients and µ1,2 are scales, typically µ1,2 ∼ 1 GeV to make the
observables dimensionless. The ﬁrst variable corresponds to the transformed mass and the
second corresponds the transformed τ2/τ1. The second variable is not too diﬀerent from ρ(cid:48)
decorrelated τ2/τ1.

2 ),

An alternative decorrelation approach, known as independent component analysis (ICA),
involves diagonalization of the matrix constructed by computing the pairwise mutual informa-
tion of each pair of variables on the sample of QCD jets. This diﬀers to previous approaches,
which rely on the mutual information to truth. Here, we focus on identifying features in
the data and not necessarily discriminating power. We perform the ICA with an algorithm
that uses k-nearest neighbor to expedite the diagonalization process (MILCA) [44]. The right
panel of Fig. 11 shows the ICA decomposed vectors. As with the transformed PCA, the
ICA decorrelates the pT , however the mass τ2/τ1 interdependence is stronger than in the
transformed case.

Finally, the equivalent decorrelated matrix for a combined set of observables is shown
in Fig. 12, here we show just the transformed PCA approach. From the combined set, we
observe the largest orthogonal set of discrimination power comes from the Cβ=1
as oppose to
τ2/τ1. When comparing the two approaches, we have found variable transformed PCA yields
a more consistent performance with our previous observations.

2

7 Conclusion and Outlook

In this note, we explore the scale-dependence and correlations of jet substructure observables.
The goal is not only to improve the statistical power of such observables, which we also
demonstrate, but also to consider practical issues related to using such observables in searches
for new physics.
In order to design decorrelated taggers (DDT), we transform the shape
observable, here τ2/τ1 → τ(cid:48)
21, by decorrelating it from groomed mass observables also factoring
in the pT scale-dependence. In addition to improving the statistical discrimination between
signal and background, we also preserve a robust, ﬂat background shape and which has more

– 13 –

Figure 11: Decorrelated vectors from variable transformed PCA (left) and ICA (right). The
bottom panel corresponds to the vectors in columns with their relative fraction labeled by
row. The top panel corresponds to the correlation to the soft dropped mass and a gradient
boosted decision tree trained with all variables excluding the pT .

stable behavior when scaling of the background going from lower pT bins to higher pT bins.
We demonstrate the advantages of such an approach in various case studies such as predicting
background normalizations and determining heavy object tagging scale factors related to new
physics searches.

The intention of this note is not to perform a detailed study of all possible heavy object
taggers, but instead, to introduce further considerations when designing taggers and propose
a method by which all considerations can be addressed, namely via observable decorrelation.
We leave studies related to variations on jet mass groomers and shape observables, R-scaling,
quark-gluon fractions, scaling background predictions, behavior at extremely high pT , and
top tagging to future works. We have explored more generic determinations of observable
decorrelation with complex taggers using multivariate techniques and numerical principle-
component analysis.

Acknowledgments

We thank Andrew Larkoski and Petar Maksimovic for their critical reading of the manuscript.
The authors would also like to thank Matteo Cremonesi, Matthew Low, Cristina Mantilla
Suarez, Siddharth Narayanan, Gavin Salam, Gregory Soyez, and Michael Spannowsky for
useful discussion and inputs. JD and SR are partially supported by the U.S. National Science
Foundation, under grant PHY–1401223. PH is supported by CERN. The work of SM is
partly supported by the U.S. National Science Foundation, under grant PHY–0969510, the

– 14 –

100-80-60-40-20-020406080100953791-483v4vMass)Tall(exc. p953791-48100-80-60-40-20-020406080100306-9467-121-99-60v1v2v1t/2t)mdtlog(m)Tlog(p306-9467-121-99-6100-80-60-40-20-020406080100670-851011-843v4vMass)Tall(exc. p670-851011-84100-80-60-40-20-0204060801004-72-68268-7299140v1v2v1t/2t)mdtlog(m)Tlog(p4-72-68268-729914Figure 12: Decorrelated vectors from variable transformed PCA Using the full suite of
observables studied in this paper. The bottom panel corresponds to the vectors in columns
with their relative fraction labeled by row. The top panel corresponds to the correlation to the
soft dropped mass and a gradient boosted decision tree trained with all variables excluding
the pT .

LHC Theory Initiative. NT is supported by the Fermi Research Alliance, LLC under Contract
No. De-AC02-07CH11359 with the United States Department of Energy.

References

[1] A. Abdesselam, E. B. Kuutmann, U. Bitenc, G. Brooijmans, J. Butterworth, et al., Boosted

objects: A Probe of beyond the Standard Model physics, Eur. Phys. J. C 71 (2011) 1661,
[arXiv:1012.5412].

[2] A. Altheimer, S. Arora, L. Asquith, G. Brooijmans, J. Butterworth, et al., Jet Substructure at
the Tevatron and LHC: New results, new tools, new benchmarks, J. Phys. G 39 (2012) 063001,
[arXiv:1201.0008].

[3] A. Altheimer, A. Arce, L. Asquith, J. Backus Mayes, E. Bergeaas Kuutmann, et al., Boosted

objects and jet substructure at the LHC. Report of BOOST2012, held at IFIC Valencia,
23rd-27th of July 2012, Eur.Phys.J. C74 (2014), no. 3 2792, [arXiv:1311.2708].

[4] D. Adams et al., Towards an Understanding of the Correlations in Jet Substructure, Eur. Phys.

J. C75 (2015), no. 9 409, [arXiv:1504.0067].

– 15 –

100-80-60-40-20-02040608010086-15-1-288491034v5vMass)Tall(exc. p86-15-1-28849103100-80-60-40-20-0204060801002270267375614-7263-29-49111-97-10v1v2v3v12C1t/2t)mdtlog(m)Tlog(p2270267375614-7263-29-49111-97-1[5] J. M. Butterworth, A. R. Davison, M. Rubin, and G. P. Salam, Jet substructure as a new Higgs

search channel at the LHC, Phys. Rev. Lett. 100 (2008) 242001, [arXiv:0802.2470].

[6] D. E. Kaplan, K. Rehermann, M. D. Schwartz, and B. Tweedie, Top Tagging: A Method for
Identifying Boosted Hadronically Decaying Top Quarks, Phys. Rev. Lett. 101 (2008) 142001,
[arXiv:0806.0848].

[7] CMS Collaboration, A cambridge-aachen (c-a) based jet algorithm for boosted top-jet tagging,

CMS Physics Analysis Summary CMS-PAS-JME-009-01, CERN, 2009.

[8] S. D. Ellis, C. K. Vermilion, and J. R. Walsh, Techniques for improved heavy particle searches

with jet substructure, Phys. Rev. D 80 (2009) 051501, [arXiv:0903.5081].

[9] S. D. Ellis, C. K. Vermilion, and J. R. Walsh, Recombination Algorithms and Jet Substructure:

Pruning as a Tool for Heavy Particle Searches, Phys. Rev. D 81 (2010) 094023,
[arXiv:0912.0033].

[10] D. Krohn, J. Thaler, and L. T. Wang, Jet Trimming, JHEP 02 (2010) 084, [arXiv:0912.1342].

[11] J. Thaler and K. Van Tilburg, Maximizing Boosted Top Identiﬁcation by Minimizing

N-subjettiness, JHEP 1202 (2012) 093, [arXiv:1108.2701].

[12] A. J. Larkoski, S. Marzani, G. Soyez, and J. Thaler, Soft Drop, JHEP 05 (2014) 146,

[arXiv:1402.2657].

[13] D. E. Soper and M. Spannowsky, Finding physics signals with shower deconstruction, Phys.

Rev. D84 (2011) 074002, [arXiv:1102.3480].

[14] D. E. Soper and M. Spannowsky, Finding top quarks with shower deconstruction, Phys. Rev.

D87 (2013) 054012, [arXiv:1211.3140].

[15] D. E. Soper and M. Spannowsky, Finding physics signals with event deconstruction, Phys. Rev.

D89 (2014), no. 9 094005, [arXiv:1402.1189].

[16] M. Dasgupta, A. Fregoso, S. Marzani, and G. P. Salam, Towards an understanding of jet

substructure, JHEP 09 (2013) 029, [arXiv:1307.0007].

[17] M. Dasgupta, A. Fregoso, S. Marzani, and A. Powling, Jet substructure with analytical methods,

Eur.Phys.J. C73 (2013), no. 11 2623, [arXiv:1307.0013].

[18] I. Feige, M. D. Schwartz, I. W. Stewart, and J. Thaler, Precision Jet Substructure from Boosted

Event Shapes, Phys.Rev.Lett. 109 (2012) 092001, [arXiv:1204.3898].

[19] M. Dasgupta, A. Powling, and A. Siodmok, On jet substructure methods for signal jets, JHEP

08 (2015) 079, [arXiv:1503.0108].

[20] A. J. Larkoski, I. Moult, and D. Neill, Toward Multi-Diﬀerential Cross Sections: Measuring

Two Angularities on a Single Jet, JHEP 1409 (2014) 046, [arXiv:1401.4458].

[21] A. J. Larkoski, I. Moult, and D. Neill, Power Counting to Better Jet Observables, JHEP 12

(2014) 009, [arXiv:1409.6298].

[22] A. J. Larkoski, I. Moult, and D. Neill, Building a Better Boosted Top Tagger, Phys. Rev. D91

(2015), no. 3 034035, [arXiv:1411.0665].

[23] A. J. Larkoski, I. Moult, and D. Neill, Analytic Boosted Boson Discrimination,

arXiv:1507.0301.

– 16 –

[24] M. Dasgupta, L. Schunk, and G. Soyez, Jet shapes for boosted jet two-prong decays from

ﬁrst-principles, arXiv:1512.0051.

[25] CMS Collaboration, V. Khachatryan et al., Identiﬁcation techniques for highly boosted W

bosons that decay into hadrons, JHEP 12 (2014) 017, [arXiv:1410.4227].

[26] CMS Collaboration, Boosted Top Jet Tagging at CMS, Tech. Rep. CMS-PAS-JME-13-007,

CERN, Geneva, 2014.

[27] CMS Collaboration, V Tagging Observables and Correlations, Tech. Rep.

CMS-PAS-JME-14-002, CERN, Geneva, 2014.

[28] CMS Collaboration, Top Tagging with New Approaches, Tech. Rep. CMS-PAS-JME-15-002,

CERN, Geneva, 2016.

[29] ATLAS Collaboration, G. Aad et al., Performance of jet substructure techniques for large-R

s = 7 TeV using the ATLAS detector, JHEP 09 (2013) 076,

jets in proton-proton collisions at
[arXiv:1306.4945].

√

[30] ATLAS Collaboration, G. Aad et al., Identiﬁcation of Boosted, Hadronically Decaying W

Bosons and Comparisons with ATLAS Data Taken at

s = 8 TeV, arXiv:1510.0582.

√

[31] Boosted hadronic top identiﬁcation at ATLAS for early 13 TeV data, Tech. Rep.

ATL-PHYS-PUB-2015-053, CERN, Geneva, Dec, 2015.

[32] Identiﬁcation of boosted, hadronically-decaying W and Z bosons in

√

s = 13 TeV Monte Carlo

Simulations for ATLAS, Tech. Rep. ATL-PHYS-PUB-2015-033, CERN, Geneva, Aug, 2015.

[33] J. Alwall, R. Frederix, S. Frixione, V. Hirschi, F. Maltoni, O. Mattelaer, H. S. Shao, T. Stelzer,

P. Torrielli, and M. Zaro, The automated computation of tree-level and next-to-leading order
diﬀerential cross sections, and their matching to parton shower simulations, JHEP 07 (2014)
079, [arXiv:1405.0301].

[34] Y. Gao, A. V. Gritsan, Z. Guo, K. Melnikov, M. Schulze, and N. V. Tran, Spin determination

of single-produced resonances at hadron colliders, Phys. Rev. D81 (2010) 075022,
[arXiv:1001.3396].

[35] M. Cacciari, G. P. Salam, and G. Soyez, The anti-kt jet clustering algorithm, JHEP 04 (2008)

063, [arXiv:0802.1189].

[36] M. Cacciari and G. P. Salam, Dispelling the N**3 myth for the k(t) jet-ﬁnder, Phys. Lett. B

641 (2006) 57–61, [hep-ph/0512210].

[37] M. Cacciari, G. P. Salam, and G. Soyez, FastJet User Manual, Eur. Phys. J. C72 (2012) 1896,

[arXiv:1111.6097].

√

[38] ATLAS Collaboration, G. Aad et al., Jet mass and substructure of inclusive jets in

s = 7
TeV pp collisions with the ATLAS experiment, JHEP 1205 (2012) 128, [arXiv:1203.4606].

[39] CMS Collaboration, S. Chatrchyan et al., Studies of jet mass in dijet and W/Z+jet events,

JHEP 1305 (2013) 090, [arXiv:1303.4811].

[40] G. Kasieczka, T. Plehn, T. Schell, T. Strebler, and G. P. Salam, Resonance Searches with an

Updated Top Tagger, JHEP 06 (2015) 203, [arXiv:1503.0592].

[41] A. Rogozhnikov, A. Bukva, V. Gligorov, A. Ustyuzhanin, and M. Williams, New approaches for

boosting to uniformity, JINST 10 (2015), no. 03 T03002, [arXiv:1410.4140].

– 17 –

[42] A. J. Larkoski, J. Thaler, and W. J. Waalewijn, Gaining (Mutual) Information about

Quark/Gluon Discrimination, JHEP 11 (2014) 129, [arXiv:1408.3122].

[43] A. Hoecker, P. Speckmayer, J. Stelzer, J. Therhaag, E. von Toerne, and H. Voss, TMVA:

Toolkit for Multivariate Data Analysis, PoS ACAT (2007) 040, [physics/0703039].

[44] A. Kraskov, H. St¨ogbauer, and P. Grassberger, Estimating mutual information, Phys. Rev. E

69 (Jun, 2004) 066138.

– 18 –

