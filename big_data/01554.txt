6
1
0
2

 
r
a

M
4

 

 
 
]

.

A
N
h
t
a
m

[
 
 

1
v
4
5
5
1
0

.

3
0
6
1
:
v
i
X
r
a

VARIATIONAL INTEGRATORS FOR INTERCONNECTED

LAGRANGE–DIRAC SYSTEMS

HELEN PARKS AND MELVIN LEOK

Abstract. Interconnected systems are an important class of mathematical models, as
they allow for the construction of complex, hierarchical, multiphysics, and multiscale mod-
els by the interconnection of simpler subsystems. Lagrange–Dirac mechanical systems pro-
vide a broad category of mathematical models that are closed under interconnection, and
in this paper, we develop a framework for the interconnection of discrete Lagrange–Dirac
mechanical systems, with a view towards constructing geometric structure-preserving
discretizations of interconnected systems. This work builds on previous work on the in-
terconnection of continuous Lagrange–Dirac systems [10] and discrete Dirac variational
integrators [14]. We test our results by simulating some of the continuous examples given
in [10].

1. Introduction

This work is motivated in part by a desire to develop a geometric structure-preserving
simulation framework with which to model control systems by using interconnections. The
need for robust control of mechanical systems is perhaps one of the most common reasons
for viewing a system in terms of interconnections. We have a plant system whose behavior
we wish to control, so it must be mechanically or electrically joined to a controller system.
Hence, we have an interconnected system. Since the controlling device is often itself a
mechanical system, we have the interconnection of two mechanical systems, and we can
begin to study the structure of the interconnected, controlled system as it relates to the
structures of the starting plant and controller. The ﬁeld of port-Hamiltonian systems
and the associated feedback stabilization control paradigm, Interconnection and Damping
Assignment - Passivity-Based Control (IDA-PBC), undertakes just such an approach and
is already a very well-established methodology with an extensive range of results [6, 22],
and which can be viewed as being dual to the method of controlled Lagrangians [4].

As the name suggests, port-Hamiltonian systems adopt a Hamiltonian perspective on
interconnected systems. In Yoshimura and Marsden [23, 24], Lagrange–Dirac mechanics
were developed as a way of understanding the implicit systems central to port-Hamiltonian
systems from the Lagrangian perspective. That aim is rooted partially in the natural desire
to understand implicit systems from both classical perspectives.
It also moves toward
the goal of numerically simulating interconnections and control by interconnection using
structured computational methods via variational integrators. Variational integrators have
been developed for a broad class of problems, including, Lall and West [11], Leok and Zhang
[15] for Hamiltonian systems; Fetecau et al. [8] for nonsmooth problems with collisions; Lew

1

VARIATIONAL INTEGRATORS FOR INTERCONNECTED LAGRANGE–DIRAC SYSTEMS

2

et al. [16], Marsden et al. [17] for Lagrangian PDEs; Cort´es and Mart´ınez [5], Fedorov and
Zenkov [7], McLachlan and Perlmutter [20] for nonholonomic systems; Bou-Rabee and
Owhadi [2, 3] for stochastic Hamiltonian systems; Bou-Rabee and Marsden [1], Lee et al.
[12, 13] for problems on Lie groups and homogeneous spaces; Leok and Ohsawa [14] for
Lagrange–Dirac mechanical systems. However, most of the work on variational integrators
has adopted the Lagrangian as opposed to the Hamiltonian perspective, and this is the
approach that we will adopt as well in this paper.

The next steps were taken in Jacobs and Yoshimura [10], which develop continuous inter-
connections of Lagrange–Dirac systems, and in Leok and Ohsawa [14], where variational
integrators were extended to the Lagrange–Dirac case.
In this paper, we discretize the
interconnections of [10] in accordance with the framework laid out in [14].

While our study of interconnected systems has very speciﬁc roots, we have abstracted
our way to general interconnections (following [10]) and believe that our results have useful
applications outside the realm of plant/controller interconnection. It is natural to approach
the modeling of a large, complex system by breaking it into smaller, more easily understood
components. The full system can then be modeled as the interconnection of several simpler,
component-wise models. Sometimes our engineering objectives themselves are modular,
such as with a robot in need of several diﬀerent appendages, each with a speciﬁc function.
Here, too, interconnection may be useful by providing the ability to alter the models of
each appendage individually with only minimal eﬀort to reconstruct a full system model.
This also naturally leads to a framework for developing parallel and distributed numerical
implementations of such structure-preserving simulations.

2. Background

2.1. Dirac structures and Langrange–Dirac mechanics. Dirac structures are the
simultaneous generalization of symplectic and Poisson structures, and can encode Dirac
constraints that arise in degenerate Lagrangian systems, interconnected systems, and non-
holonomic systems, and thereby provide a uniﬁed geometric framework for studying such
problems. We begin with a review of Dirac structures and their role in Lagrange–Dirac
mechanics. Then, we revisit the continuous interconnection process.
2.1.1. Dirac structures. Let V be a ﬁnite-dimensional vector space with dual V ∗. Denote
the natural pairing between V and V ∗ by (cid:104)·,·(cid:105), and deﬁne the symmetric pairing (cid:104)(cid:104)·,·(cid:105)(cid:105) on
V ⊕ V ∗ by
for (v1, α1), (v2, α2) ∈ V ⊕ V ∗. A Dirac structure on V is a subset D ⊂ V ⊕ V ∗ such that
D = D⊥ with respect to (cid:104)(cid:104)·,·(cid:105)(cid:105). Given a subspace ∆ ⊂ V and its annihilator ∆◦
⊂ V ∗, we
can construct ∆ ⊕ ∆◦
Now, let M be a smooth manifold. Denote by T M⊕T ∗M the Pontryagin bundle over M ,
where the ﬁber over x ∈ M is TxM ⊕ T ∗
D ⊂ T M ⊕ T ∗M such that every ﬁber D(x) is a Dirac structure on TxM . An integrable
Dirac structure has the additional property, (cid:104)£X1α2, X3(cid:105)+(cid:104)£X2α3, X1(cid:105)+(cid:104)£X3α1, X2(cid:105) = 0,

⊂ V ⊕ V ∗, which is an example of a Dirac structure.

x M . Then, a Dirac structure on M is a subbundle

(1)

(cid:104)(cid:104)(v1, α1), (v2, α2)(cid:105)(cid:105) = (cid:104)α1, v2(cid:105) + (cid:104)α2, v1(cid:105)

VARIATIONAL INTEGRATORS FOR INTERCONNECTED LAGRANGE–DIRAC SYSTEMS

3

for all pairs of vector ﬁelds and one-forms (X1, α1), (X2, α2), (X3, α3) ∈ D, where £X is
the Lie derivative. This generalizes the condition that the symplectic two-form is closed,
or that the Poisson bracket satisﬁes Jacobi’s identity. For the purposes of this paper, we
will not assume that a Dirac structure satisﬁes the integrability condition, since it does not
hold for Dirac structures that incorporate non-integrable or nonholonomic constraints. It
should be noted that such non-integrable Dirac structures are sometimes referred to in the
literature as almost-Dirac structures.

Every manifold Dirac structure D has an associated distribution deﬁned by

(2)

∆D(x) = {v ∈ TxM | (v, α) ∈ D(x) for some α}.

The Dirac structure D also deﬁnes a bilinear map on ∆D,

(3)
for any αv such that (v, αv) ∈ D(x) and any w ∈ ∆D(x). The two-form ω∆D is well-deﬁned
on ∆D even if there exist multiple such αv since D = D⊥ with respect to the symmetric
pairing above.

ω∆D (v, w) = (cid:104)αv, w(cid:105),

Conversely, given a two-form ω on M and a regular distribution ∆ ⊂ T M , we can deﬁne

a Dirac structure D on M ﬁber-wise as
(4) D(x) = {(v, α) ∈ TxM ⊕ T
Clearly, in this case ∆D = ∆ and ω∆D = ω|∆D . We use this idea to connect Dirac structures
with constraint distributions.

∗
x M | v ∈ ∆(x) and (cid:104)α, w(cid:105) = ωx(v, w) for all w ∈ ∆(x)}.

2.1.2. Induced Dirac structures. Dirac structures are especially relevant in the case of
Lagrangian systems with linear nonholonomic constraints, i.e. constraints of the form
ωa(q) · ˙q = 0, a = 1, . . . , m, where ωa are one-forms on Q. Such constraints can be equiva-
lently expressed using the regular distribution ∆Q ⊂ T Q deﬁned by ∆Q(q) = ∩a ker(ωa(q)).
Thus, the annihilator codistribution of ∆Q is given by ∆◦
Q(q) = span{ωa(q)}. The con-
straints are then written ˙q ∈ ∆Q(q) or simply ˙q ∈ ∆Q. Nonholonomic constraints such as
these cause the motion on T ∗Q to be pre-symplectic rather than symplectic. The Dirac
structure induced by ∆Q gives a precise description of this pre-symplectic structure. Note
that we may also have primary constraints on T ∗Q if L is degenerate.
The constraints ∆Q induce a Dirac structure on T ∗Q as follows. From ∆Q, deﬁne
∆T ∗Q ⊂ T T ∗Q as
for the canonical projection πQ : T ∗Q → Q and its tangent lift T πQ. We now apply the
construction described in (4) using ∆T ∗Q and the canonical symplectic form Ω on T ∗Q.
This gives the following ﬁber-wise deﬁnition of D∆Q, the Dirac structure on T ∗Q induced
by the constraint distribution ∆Q.

∆T ∗Q = (T πQ)

−1(∆Q)

(5)

(6)

D∆Q(q, p) = {(v, α) ∈ T(q,p)T

Q ⊕ T

Q | v ∈ ∆T ∗Q(q, p) and

∗

∗
(q,p)T

∗

(cid:104)α, w(cid:105) = Ω(v, w) for all w ∈ ∆T ∗Q(q, p)}.

VARIATIONAL INTEGRATORS FOR INTERCONNECTED LAGRANGE–DIRAC SYSTEMS

4

local coordinate expressions. It will be useful to have expressions for
2.1.3. Canonical
∆T ∗Q, ∆◦
T ∗Q, and D∆Q in terms of local canonical coordinates. Let V be a model vec-
tor space for the conﬁguration manifold Q, and let U ⊂ V be a chart around q ∈ Q. Then,
we have the following local representations near q,

T

T Q (cid:55)→ U × V,
∗
∗
Q (cid:55)→ U × V
,
T T Q (cid:55)→ (U × V ) × (V × V ),
∗
∗
Q (cid:55)→ (U × V
),
∗
Q (cid:55)→ (U × V
× V ).

) × (V × V
) × (V

∗
∗

∗

T T
∗

T

T

In these coordinates πQ : (q, p) (cid:55)→ q and T πQ : (q, p, δq, δp) (cid:55)→ (q, δq), so that
(7)

∆T ∗Q = {(q, p, δq, δp) ∈ T(q,p)T

Q | (q, δq) ∈ ∆Q}

∗

with the annihilator distribution

(8)

∆

◦
T ∗Q(q, p) = {(q, p, αq, αp) ∈ T

∗
(q,p)T

∗

◦
Q | (q, αq) ∈ ∆
Q and αp = 0}.

as (δq, δp) in the abstract case or (vq, vp) when referring to a particular v. Similarly, we

As indicated above, any v ∈ T(q,p)T ∗Q has two coordinate components. We will write these
will write α = (αq, αp) for α ∈ T ∗
(q,p)T ∗Q. In this notation, Ω(v, w) = vq · wp − vp · wq. So
the condition (cid:104)α, w(cid:105) = Ω(v, w) for all w ∈ ∆T ∗Q translates to (αq + vp, αp − vq) ∈ ∆◦

Thus, the induced Dirac structure in (6) has the coordinate expression

T ∗Q.

(9)

D∆Q(q, p) = {(vq, vp, αq, αp) ∈ T(q,p)T

Q | vq ∈ ∆Q(q),

αp = vq, and αq + vp ∈ ∆

∗
(q,p)T

∗

∗

Q ⊕ T
◦
Q(q)}.

2.1.4. The Tulczyjew triple. The Tulczyjew triple relates the spaces T ∗T ∗Q, T T ∗Q, and
T ∗T Q and helps bridge the gap between Lagrangian and Hamiltonian mechanics. These
maps were ﬁrst studied by Tulczyjew [21] in the context of a generalized Legendre trans-
form. The ﬁrst map is the usual ﬂat map derived from the symplectic form Ω on T ∗Q. We
write Ω(cid:91) : T T ∗Q → T ∗T ∗Q deﬁned by

The second map, κQ : T T ∗Q → T ∗T Q is given locally by a simple coordinate shuﬄing,

(12)

κQ : (q, p, δq, δp) (cid:55)→ (q, δq, δp, p).

A global deﬁnition of κQ can be found in [23]. A unique diﬀeomorphism κQ exists for any

manifold Q [23]. The third map, γQ : T ∗T Q → T ∗T ∗Q is deﬁned in terms of the ﬁrst two,

(13)

γQ := Ω(cid:91)

T ∗Q ◦ κ

−1
Q .

(10)

In coordinates,

(11)

Ω(cid:91)(v) · w = Ω(v, w).

Ω(cid:91)(v) = (−vp, vq) ∈ T

∗

∗

T

Q.

VARIATIONAL INTEGRATORS FOR INTERCONNECTED LAGRANGE–DIRAC SYSTEMS

5

2.1.5. Lagrange–Dirac dynamical systems. We are now equipped to deﬁne a Lagrange–
Dirac dynamical system. Let L : T Q → R be a given, possibly degenerate, Lagrangian.
We deﬁne the Dirac diﬀerential of L to be

(14)

DL(q, v) := γQ ◦ d : T Q → T

∗

∗

T

Q.

Here d denotes the usual exterior derivative operator so that dL : T T Q → T ∗T Q. For a
curve (q(t), v(t), p(t)) ∈ T Q ⊕ T ∗Q, we deﬁne XD to be the following partial vector ﬁeld

(15)

XD(q(t), v(t), p(t)) = (q(t), p(t), ˙q(t), ˙p(t)) ∈ T T

∗

Q.

Then, the equations of motion for a Lagrange–Dirac dynamical system with Lagrangian L
and constraint distribution ∆Q are given by

(16)

(XD(q(t), v(t), p(t)), DL(q(t), v(t))) ∈ D∆Q(q(t), p(t)).

In local coordinates, dL(q, v) = (q, v, ∂L

∂q , ∂L

∂v ) and

(17)

so we have

(18)

γQ : (q, δq, δp, p) (cid:55)→ (q, p,−δp, δq),

DL(q, v) = (q,

∂L
∂v

,−

∂L
∂q

, v).

Then, using the coordinate expressions from (9), the equations determined by (16) are

(19)

˙q = v ∈ ∆Q(q),

˙p −

∂L
∂q ∈ ∆

◦
Q(q), p =

∂L
∂v

.

The last equation comes from matching the basepoints of XD(q, p) and DL(q, v). This is a

set of diﬀerential algebraic equations on T Q⊕ T ∗Q whereas the Euler–Lagrange equations

give an ODE system on T Q. We see that the ﬁrst and last equations explicitly enforce
the second-order curve condition and the Legendre transform, respectively. The middle
equation reduces to the Euler–Lagrange equations in the absence of constraints. With con-
straints, the Euler–Lagrange relationship holds along the permissible directions. Explicit
enforcement of the Legendre transform serves to enforce any primary constraints on the
system.

2.1.6. The Hamilton–Pontryagin principle. Rather than the usual Hamilton’s principle for

curves on T Q, we apply the Hamilton–Pontryagin principle for curves on T Q ⊕ T ∗Q.

This automatically incorporates a constraint distribution ∆Q and any primary constraints
coming from a degenerate Lagrangian. We have

δ(cid:90) T

0

(20)

L(q(t), v(t)) − (cid:104)p(t), ˙q(t) − v(t)(cid:105) dt = 0,

for variations δq ∈ ∆Q(q) with ﬁxed endpoints and arbitrary variations δv, δp together with
the constraint ˙q ∈ ∆Q(q). This principle yields precisely the Lagrange–Dirac equations of
motion (19).

VARIATIONAL INTEGRATORS FOR INTERCONNECTED LAGRANGE–DIRAC SYSTEMS

6

2.1.7. The Lagrange–d’Alember–Pontryagin principle and Lagrange–Dirac systems with ex-

tem. As in the classical Lagrangian case [18], we take the horizontal lift of F to deﬁne

ternal forces. Suppose we have an external force ﬁeld F : T Q → T ∗Q acting on the sys-
˜F : T Q → T ∗T ∗Q by

(21)
In local coordinates, ˜F (q, v) = (q, p, F (q, v), 0). The equations of motion for the forced
system are given by

(cid:104) ˜F (q, v), w(cid:105) = (cid:104)F (q, v), T πQ(w)(cid:105).

(22)

(XD(q, v, p), DL(q, v) − ˜F (q, v)) ∈ D∆Q(q, p).

As before, we can derive the local coordinate equations from this, producing

(23)

˙q = v ∈ ∆Q(q),

˙p −

∂L
∂q − F ∈ ∆

◦
Q(q), p =

∂L
∂v

.

So, only the second equation changes when forces are introduced. Equations (23) reduce
to the usual forced Euler–Lagrange equations in the absence of constraints.

We must also incorporate the work of the forces into the variational principle. This is
done in exactly the same way as forces are appended to Hamilton’s principle in the usual
forced Lagrangian setting [19].
In that setting, one obtains the Lagrange–d’Alembert
principle. Here, we arrive at the Lagrange–d’Alembert–Pontryagin principle,

(24)

δ(cid:90) T

0

L(q, v) + (cid:104)p, ˙q − v(cid:105) dt +(cid:90) T

0 (cid:104)F (q, v), δq(cid:105) dt = 0,

for variations δq ∈ ∆Q(q) with ﬁxed endpoints and arbitrary variations δv, δp together with
the constraint ˙q ∈ ∆Q(q). The addition of the forcing terms here again produces (23).
2.2. Interconnection of Lagrange–Dirac systems. In this section we review the inter-
connection of continuous Lagrange–Dirac systems laid out in Jacobs and Yoshimura [10].
Throughout this section we assume that we are connecting two systems (L1, ∆Q1) on Q1
and (L2, ∆Q2) on Q2. The results easily extend to the interconnection of a ﬁnite number of
systems, as shown in [10]. The interconnected system will then evolve on Q = Q1×Q2. The
interconnection of the two systems has both a variational formulation and a formulation in
. This
terms of the interconnection of the two starting Dirac structures, D∆Q1
interconnection of Dirac structures in turn involves the direct sum of D∆Q1
, a
product on Dirac structures, and an interaction Dirac structure Dint.

and D∆Q2

and D∆Q2

2.2.1. Standard interaction Dirac structures. Let ΣQ ⊂ T Q be a regular distribution on Q
describing the interaction between systems 1 and 2. Lift this distribution to T ∗Q to deﬁne
(25)
Then, the standard interaction Dirac structure Dint on T ∗Q is given by
(26)
for Σ◦

−1(ΣQ) ⊂ T T
◦
int(q, p),

Dint(q, p) = Σint(q, p) ⊕ Σ

int the annihilator of Σint.

Σint = (T πQ)

Q.

∗

VARIATIONAL INTEGRATORS FOR INTERCONNECTED LAGRANGE–DIRAC SYSTEMS

7

As mentioned above, any Dirac structure on a manifold M deﬁnes an associated distri-
bution ∆M ⊂ T M and a bilinear map ω∆M : ∆M × ∆M → R that is well-deﬁned on ∆M .
Taking D = ∆ ⊕ ∆◦ produces ∆M = ∆ and ω∆M ≡ 0. Thus, the distribution associated
with Dint is Σint, and the associated two-form is the zero form. The zero form obviously
extends to the whole of T ∗Q, so Dint can equivalently be generated from Σint and ω ≡ 0.

2.2.2. The direct sum of Dirac structures. Given two Dirac structures D1 and D2 on M1
and M2, the direct sum D1 ⊕ D2 is the vector bundle over M1 × M2 given by
(27) D1 ⊕ D2(x1, x2) = {((v1, v2), (α1, α2)) ∈ T(x1,x2)(M1 × M2) ⊕ T

∗
(x1,x2)(M1 × M2) |
(v1, α1) ∈ D1(x1) and (v2, α2) ∈ D2(x2)}.

From [10], we have that D1 ⊕ D2 is itself a Dirac structure over M1 × M2. In the particular
case of induced Dirac structures, it was shown in [10] that D∆Q1 ⊕ D∆Q2
2.2.3. The tensor product of Dirac structures. The interconnection of Dirac structures relies
on a product operation on Dirac structures referred to as the Dirac tensor product. We
have the following characterization of the Dirac tensor product.

= D∆Q1⊕∆Q2

.

Deﬁnition 1 (Jacobs and Yoshimura [10]). Let Da and Db be Dirac structures on M . We
deﬁne the Dirac tensor product

(28)

Da (cid:2) Db = {(v, α) ∈ T M ⊕ T

∗

M | ∃β ∈ T

∗

M

such that (v, α + β) ∈ Da, (v,−β) ∈ Db}.

An equivalent deﬁnition is given in [9]. Let D∆ be an induced Dirac structure on Q and
Dint the standard interaction Dirac structure deﬁned above. Then, D∆ (cid:2) Dint is a Dirac
structure when ∆ ∩ ΣQ is a regular distribution [10].
2.2.4. Interconnection of Dirac structures. Recall that we wish to connect the systems
(L1, ∆Q1) and (L2, ∆Q2) with associated Dirac structures D∆Q1
. The smooth
distribution ΣQ ⊂ T Q describes their interaction and is used to deﬁne the interaction Dirac
int, where Σint = (T πQ)−1(ΣQ) ⊂ T T ∗Q. As before, Q = Q1 × Q2
structure Dint = Σint ⊕ Σ◦
will be the conﬁguration manifold of the interconnected system.

and D∆Q2

Given two Dirac structures Da and Db on Qa and Qb, respectively, and an interaction

Dirac structure Dint on Q = Qa × Qb, the interconnection of Da and Db through Dint is
(29)

We noted above that D∆Q1 ⊕ D∆Q2
the interconnection of D∆Q1
Dint = Σint ⊕ Σ◦
Proposition 1 (Jacobs and Yoshimura [10]). If ∆Q1 ⊕ ∆Q2 and ΣQ intersect cleanly, i.e.,
(∆Q2 ⊕ ∆Q2) ∩ ΣQ has locally constant rank, then the interconnection of D∆Q1
and D∆Q2

. We have the following proposition for
through the standard interaction Dirac structure

and D∆Q2

int.

(Da ⊕ Db) (cid:2) Dint.
= D∆Q1⊕∆Q2

VARIATIONAL INTEGRATORS FOR INTERCONNECTED LAGRANGE–DIRAC SYSTEMS

8

(30)

through Dint is locally given by the Dirac structure induced from (∆Q2 ⊕ ∆Q2) ∩ ΣQ as,
for each (q, p) ∈ T ∗Q,
(D∆Q1 ⊕ D∆Q2

) (cid:2) Dint(q, p) = {(w, α) ∈ T(q,p)T

◦
T ∗Q(q, p)},
where ∆T ∗Q = (T πQ)−1((∆Q2 ⊕ ∆Q2) ∩ ΣQ) and Ω = Ω1 ⊕ Ω2, where Ω1 and Ω2 are the
canonical symplectic structures on T ∗Q1 and T ∗Q2.

w ∈ ∆T ∗Q(q, p) and α − Ω(cid:91)(q, p) · w ∈ ∆

∗
(q,p)T

∗

∗

Q × T

Q |

Note that for Q = Q1 × Q2, the canonical symplectic form ΩT ∗Q = ΩT ∗Q1 ⊕ ΩT ∗Q2.

Thus, if we deﬁne

(31)

∆Q = (∆Q1 ⊕ ∆Q2) ∩ ΣQ,

the previous proposition amounts to

(32)

(D∆Q1 ⊕ D∆Q2

) (cid:2) Dint = D∆Q.

2.2.5. Interconnection of Lagrange–Dirac systems. Set L(q, v) = L1(q1, v1)+L2(q2, v2) and
∆Q = (∆Q1 ⊕ ∆Q2) ∩ ΣQ. Here, as usual, (q, v) = (q1, q2, v1, v2) ∈ T Q = T (Q1 × Q2) in
coordinates. Then, the interconnected system satisﬁes

(33)

(XD(q, v, p), DL(q, v)) ∈ D∆Q(q, p).

The interconnected system also satisﬁes the usual Hamilton–Pontryagin principle (20) for
L and ∆Q.

Should there be any external forces Fi : T Qi → T ∗Qi acting on the subsystems, those can
be lifted to Q by pullback with respect to πQi : Q → Qi. That is to say that F =(cid:80)i π∗
QiFi
represents the external forces acting on the interconnected system. Then, the total system
solves the equations

(34)

(XD(q, v, p), DL(q, v) − F ) ∈ D∆Q(q, p),
and satisﬁes the Lagrange–d’Alembert–Pontryagin principle (24).

Note that in [10], the forces considered in the interconnection process are interaction
forces between subsystems, not external forces. As demonstrated in [10], the constraints
imposed by ΣQ have an equivalent representation in terms of internal interaction forces.
We ignore the interaction force perspective for now, viewing interconnections as governed
wholly by constraints ΣQ. We will say more about bringing the interaction force perspective
into discrete interconnections in the concluding sections.

2.3. Discrete Dirac mechanics. In this section, we review the discrete theory of Dirac
mechanics and Dirac structures developed in Leok and Ohsawa [14]. We begin with a
Lagrangian function L : T Q → R and a continuous constraint distribution ∆Q ⊂ T Q.

VARIATIONAL INTEGRATORS FOR INTERCONNECTED LAGRANGE–DIRAC SYSTEMS

9

2.3.1. A discrete Tulczyjew triple. Recall the continuous Tulczyjew triple, summarized in
the following diagram.

γQ

(35)

T ∗T Q

κQ

T T ∗Q

Ω(cid:91)

T ∗Q

T ∗T ∗Q.

(37)

(36)

In [14], the authors deﬁne a discrete Tulczyjew triple using generating functions of a

This is used to deﬁne the continuous Dirac diﬀerential DL = (γQ ◦ d)L.
symplectic map F : T ∗Q → T ∗Q. In coordinates, these are

(38)

κd
Q : ((q0, p0), (q1, p1)) (cid:55)→ (q0, q1,−p0, p1),
Ω(cid:91)
d+ : ((q0, p0), (q1, p1)) (cid:55)→ (q0, p1, p0, q1),
Ω(cid:91)
d− : ((q0, p0), (q1, p1)) (cid:55)→ (p0, q1,−q0,−p1).
The distinction between Ω(cid:91)
d± comes from choosing either the Type II or Type III generating
function in its deﬁnition, or equivalently, whether one chooses to endow Q×Q with a bundle
structure over Q by projecting onto the ﬁrst or second component.

These maps deﬁne the (+) and (−) discrete Tulczyjew triples,

γd+
Q

(39)

and

T ∗(Q × Q)

T ∗(Q × Q)

(40)
We use γd±
induced Dirac structures.

κQ

κQ

T ∗Q × T ∗Q

Ω(cid:91)

d+

T ∗(Q × Q∗),

γd−

Q

T ∗Q × T ∗Q

Ω(cid:91)

d−

T ∗(Q∗

× Q).

Q to deﬁne a (±) discrete Dirac diﬀerential on Ld and Ω(cid:91)

d± to deﬁne (±) discrete

2.3.2. Discrete constraint distributions and discrete induced Dirac structures. Recall that
a continuous Lagrange–Dirac system on a manifold Q has an associated constraint distri-
bution ∆Q ⊂ T Q. With this we have a set of associated constraint one-forms {ωa} such
that

(41)

◦
Q(q) = span{ωa(q)}m
∆

a=1,

i.e., ∆Q = ∩a ker(ωa(q)).

We deﬁne a discrete constraint distribution by discretizing these constraint one-forms. In
the approach developed in [14], we do this by using a retraction R : T Q → Q. As with the

VARIATIONAL INTEGRATORS FOR INTERCONNECTED LAGRANGE–DIRAC SYSTEMS

10

Tulczyjew triple, we have a (+) and a (−) way of doing this, resulting in discrete forms
ωa
d± : Q × Q → R.
(42)

ωa

−1

d+(q0, q1) = ωa(q0)(cid:0)R

d−(q0, q1) = ωa(q1)(cid:0)−R
∆d±
Q = {(q0, q1) ∈ Q × Q | ωd±(q0, q1) = 0, a = 1, . . . , m}.

q0 (q1)(cid:1) , ωa

−1

q1 (q0)(cid:1) .

The discrete constraint distribution is then deﬁned as

(43)

In the classical theory of variational integrators, the pair (q0, q1) is thought of as the discrete
analogue to a tangent vector in T Q. The (±) formulation here can be thought of as a right
and left formulation based on treating one of q0, q1 as the basepoint and the other as a
representative of the velocity. Indeed, as noted in [14], the distribution ∆d+
Q constrains
only q1, while ∆d−
Q constrains only q0. This is consistent with what one would expect with
nonholonomic constraints, where the velocities are constrained locally, but the positions
are unconstrained.
Recall that a continuous Dirac structure on T ∗Q relies on the distribution ∆T ∗Q =
(T πQ)−1(∆Q) ⊂ T T ∗Q for the canonical projection πQ : T ∗Q → Q. At the discrete level,

we deﬁne

∆d+
T ∗Q = (πQ × πQ)

−1(∆d±
Q )

∗

∗

∆

and

(44)

(45)

Q × T

Q (cid:111) ,
=(cid:110)((q0, p0), (q1, p1)) ∈ T
Q | (q0, q1) ∈ ∆d±
Q(q)(cid:9) ,
Q×Q∗ =(cid:8)(q, p, αq, 0) ∈ T
Q(q)(cid:9) .
Q∗×Q =(cid:8)(q, p, 0, αq) ∈ T
The distributions ∆d±
T ∗Q serve as the discrete analogues of ∆T ∗Q, while ∆◦
are the (+) and (−) discrete analogues of ∆◦
d± deﬁned earlier. We have

) | αqdq ∈ ∆
× Q) | αqdq ∈ ∆

∗
(Q × Q
∗
(Q

the discrete maps Ω(cid:91)

T ∗Q, respectively.

◦
◦

∗
∗

◦
◦

∆

We then deﬁne discrete induced Dirac structures using these discrete distributions and

Q×Q∗ and ∆◦

Q∗×Q

(46)

and

(47)

Dd+
∆Q

Dd−

∆Q

∗

∗

= {(cid:0)(z, z+), αˆz(cid:1) ∈ (T
(z, z+) ∈ ∆d+
, z), α˜z(cid:1) ∈ (T
= {(cid:0)(z
−
, z) ∈ ∆d−
−

(z

∗

∗

∗

∗

Q × T
T ∗Q, αˆz − Ω(cid:91)

(Q × Q

Q) × T
) |
d+(z, z+) ∈ ∆Q×Q∗}

∗

∗
(Q

Q × T
T ∗Q, α˜z − Ω(cid:91)

Q) × T
d−(z

× Q) |
, z) ∈ ∆Q∗×Q}.

−

Given z = (q, p) and z+ = (q+, p+), then ˆz = (q, p+). Given z− = (q−, p−) and z = (q, p),
then ˜z = (p−, q).

VARIATIONAL INTEGRATORS FOR INTERCONNECTED LAGRANGE–DIRAC SYSTEMS

11

2.3.3. The discrete Dirac diﬀerential and discrete Dirac mechanics. We have two versions
of the discrete Dirac diﬀerential,

(48)

D+Ld = γd+

Q ◦ dLd

Using the discrete vector ﬁeld

and D−

Ld = γd−

Q ◦ dLd.

(49)

X k
d = ((qk, pk), (qk+1, pk+1)) ∈ T

Q × T

∗

∗

Q,

we have the following systems. A (+) discrete Lagrange–Dirac system satisﬁes

d , D+Ld(qk, q+
(50)
A (−) discrete Lagrange–Dirac system satisﬁes
(51)

(X k

(X k

d , D−

Ld(q

.

∆Q

k )) ∈ Dd+
−
k+1, qk+1)) ∈ Dd−

∆Q

.

The variables q+
equation (50) produces the (+) discrete Lagrange–Dirac equations of motion,

−
k+1 are the discrete analogues of the velocity variable. In coordinates,

k and q

(52a)

(52b)

(52c)

(52d)

0 = ωa
d+(qk, qk+1),
qk+1 = q+
k ,
pk+1 = D2Ld(qk, q+
k ),
pk = −D1Ld(qk, q+

k ) + µaωa(qk),

where µa are Lagrange multipliers, and the last equation uses the Einstein summation
convention. Equation (51) produces the (−) discrete Lagrange–Dirac equations of motion,

(53a)

(53b)

(53c)

(53d)

0 = ωa
d−(qk, qk+1),
−
k+1,

qk = q
pk = −D1Ld(q
−
k+1, qk+1) + µaωa(qk+1).
pk+1 = D2Ld(q

−
k+1, qk+1),

Again, µa are Lagrange multipliers, and the last equation makes use of the Einstein sum-
−
mation convention. Later, we will write these equations with the q+
k+1 variables
eliminated for simplicity.

k and q

Both (±) equations simplify to the DEL equations in the unconstrained case, and they

recover the nonholonomic integrators of Cort´es and Mart´ınez [5].

2.3.4. Variational discrete Dirac mechanics. The (+) discrete Hamilton–Pontryagin prin-
ciple is

N−1(cid:88)k=0

(54)

δ

[Ld(qk, q+

k ) + pk+1(qk+1 − q+

k )] = 0,

with variations that vanish at the endpoints, i.e. δq0 = δqN = 0, and the discrete con-
straints (qk, qk+1) ∈ ∆d+
Q . We also impose the constraint δqk ∈ ∆Q(qk) after computing

VARIATIONAL INTEGRATORS FOR INTERCONNECTED LAGRANGE–DIRAC SYSTEMS

12

variations inside the sum. The variable q+
of v in the continuous principle.

k serves as the discrete analog to the introduction

The (−) discrete Hamilton–Pontryagin principle is

N−1(cid:88)k=0

(55)

δ

[Ld(q

−
k+1, qk+1) − pk(qk − q

−
k+1)] = 0 .

−
The variable q
k now plays the role of the discrete velocity. Again we take variations that
vanish at the endpoints and impose the constraint δqk ∈ ∆Q(qk). We now impose the
discrete constraints (qk, qk+1) ∈ ∆d−

As shown in [14], computing variations of (54) yields (52), and computing variations
for (55) yields (53). Thus, in direct analogy with the continuous case, we have equivalent
variational and Dirac structure formulations of discrete Lagrange–Dirac mechanics.

Q .

3. (+) vs. (−) Discrete Dirac mechanics

Before getting to the interconnected systems results, we say a few words about the
distinction between the (+) and (−) formulations of discrete Dirac mechanics laid out in
[14]. Later sections will focus on interconnections of (+) discrete Dirac systems as that
turns out to be the proper formulation for simulating forward in time.

In their full form, the (+) discrete Dirac equations are only generally solvable for forward
time integration (moving forward in index), and the (−) discrete Dirac equations are only
generally solvable for backward time integration (moving backward in index). This follows
from the implicit function theorem. It also mirrors the case of the augmented approach to
holonomic constraints laid out in [19], which has a similar form.

In momentum-matched form, the discrete Dirac equations become

D2Ld(qk−1, qk) + D1Ld(qk, qk+1) + µaωa(qk) = 0,
ωa
d±(qk, qk+1) = 0,

k = 1, . . . , N − 1,
k = 0, . . . , N − 1.

So the only distinction between the position trajectories of (+) and (−) is, potentially, in
the way the constraints are discretized. The two methods generate the same trajectory
when

(56)

ωa
d+(qk, qk+1) = 0 ⇐⇒ ωa

d−(qk, qk+1) = 0.

For the retraction-based deﬁnition of ωa

(57)

ωa(qk) · R

d+ in [14], this requires
−1
−1
qk (qk+1) = 0 ⇐⇒ ωa(qk+1) · −R
qk+1(qk) = 0.

This holds, for instance, for a force that is independent of the base point, and a retraction
whose inverse is antisymmetric. For example, an equality constraint between two redundant
variables will be independent of the base point, and the vector space retraction Rq(v) =
q + hv has an inverse that is antisymmetric in (qk, qk+1).
−1
qk (qk+1) = (qk+1 − qk)/h = −R
R

−1
qk+1(qk).

(58)

VARIATIONAL INTEGRATORS FOR INTERCONNECTED LAGRANGE–DIRAC SYSTEMS

13

If we consider more general discretizations for ωa
d±, we could purposefully choose symmetric
discretizations so that the (+) and (−) formulations generate the same position trajectories.

4. Discrete Dirac interconnections

In this section we present results for interconnecting a ﬁnite number of systems on
Q1, . . . , Qn to form a system on Q = Q1 × ··· × Qn. Here and throughout the section,
let πQi denote the projection from Q onto Qi and T πQi denote the tangent lift of πQi.
In coordinates, we have q = (q1, . . . , qn), vq = (q1, . . . , qn, vq1, . . . , vqn) with πQi(q) = qi
and T πQi(vq) = (qi, vqi). At the continuous level, we have two equivalent views of Dirac
interconnections: through variational principles and through Dirac structures [10]. We
always have an interconnection distribution ΣQ ⊂ T Q describing the interaction between
the two systems. We can think of the interconnected system as the system generated
variationally by L(q, ˙q) = L1(T πQ1(q, ˙q)) + L2(T πQ2(q, ˙q)) and ∆Q = (∆Q1 ⊕ ∆Q2) ∩ ΣQ.
To view interconnection in terms of Dirac structures, we write (XD, dDL(q, v)) ∈ (D∆Q1 ⊕
)(cid:2) Dint for the same Lagrangian. Here Dint is a Dirac structure on T ∗Q derived from
D∆Q2
ΣQ and (cid:2) is the Dirac tensor product deﬁned earlier.

These two views of interconnection are completely equivalent, so that, in particular,

(D∆Q1 ⊕ D∆Q2
the discrete level, producing an analogous equivalence between the two approaches.

) (cid:2) Dint = D∆Q for ∆Q = (∆Q1 ⊕ ∆Q2) ∩ ΣQ. We mimic each viewpoint at

4.1. Interconnecting two discrete Dirac systems variationally through ΣQ. Sup-
pose we have two systems (L1, ∆Q1) and (L2, ∆Q2) with conﬁguration manifolds Q1 and
Q2. Suppose we also have a distribution ΣQ ⊂ T Q for Q = Q1 × Q2 describing the inter-
connection of systems 1 and 2. Then, from [10], we know that the interconnected system
is again a Dirac system with Lagrangian L(q, v) = L1(q1, v1) + L2(q2, v2) and distribution
∆Q = (∆Q1 ⊕ ∆Q2)∩ ΣQ. To discretize any of these systems in the way laid out in [14], we
must choose a discretization scheme L (cid:55)→ Ld and a retraction R : T Q → Q. We will assume
our discretization scheme is linear in L, i.e. for L = L1(T πQ1(q, v))+L2(T πQ2(q, v)) we get
Ld(qk, qk+1) = L1
k+1). This is a relatively weak assumption. Schemes
for constructing Ld are based on approximating the exact discrete Lagrangian given, with
some assumptions on the curve q(t), by

k+1) + L2

k, q1

d(q2

k, q2

d(q1

(59)

LE

d (q0, q1; h) =(cid:90) h

0

L(q(t), ˙q(t))dt,

where q(t) satisﬁes the Euler–Lagrange equations, and the boundary conditions q(0) = q0,
q(h) = q1. Since the exact discrete Lagrangian is linear in L, discretizations are most often
linear as well. For instance, discretization based on applying quadrature to the integral in
LE

d will satisfy linearity in L.

4.1.1. Compatible constraint discretizations. The relevant constraint distributions in inter-
connection are ∆Q1, . . . , ∆Qn, ΣQ and ∆Q = (∆Q1 ⊕ ··· ⊕ ∆Qn) ∩ ΣQ. To get equivalence

VARIATIONAL INTEGRATORS FOR INTERCONNECTED LAGRANGE–DIRAC SYSTEMS

14

between interconnecting systems before and after discretization, we need to make a par-
ticular choice of basis for ∆◦
Q and assume a compatible constraint discretization, deﬁned
below.
From ∆Q = (∆Q1 ⊕ ··· ⊕ ∆Qn) ∩ ΣQ, we have ∆◦
we can construct a basis for ∆◦
Q from the bases of ∆◦
a basis for ∆◦
bases {ωa
˜ωa
i (q) by ˜ωa
(∆Q1 ⊕ ··· ⊕ ∆Qn)◦(q). Select a basis for Σ◦
span{˜ωa
basis for ∆◦
Q.

Qi(qi). We construct a basis for (∆Q1 ⊕ ··· ⊕ ∆Qn)◦(q) from the individual
a=1. Let πQi(q) ∈ Qi denote the ith component projection of q ∈ Q. Deﬁne
i (q) · vq = ωa
i=1 forms a basis for
b=1. Then, ∆◦
Q(q) =
i (q), αb(q)}, with the appropriate ranging of indices. This will always be our chosen

Q = (∆Q1 ⊕ ··· ⊕ ∆Qn)◦
Qi and Σ◦
int. Let {ωa

a=1}n
Q(q) = span{αb(q)}l

i (πQi(q)) · T πQi(vq). Then, {{˜ωa

∪ Σ◦
i (qi)}mi

Q. Thus,
a=1 denote

i (qi)}mi

i (q)}mi

We will call a constraint discretization compatible if

(60)

˜ωa
d+,i(qk, qk+1) = ωa

d+,i(qi

k, qi

k+1).

We use the notation qi
nate expression at tk is qk = (q1
we make use of the following lemma.

k to mean the ith component at the kth time-step. So the full coordi-
k ∈ Qi. For retraction-based discretizations,

k ) with qi

k, . . . , qn

Lemma 1. For R1, . . . , Rn retractions on Q1, . . . , Qn, respectively, R1 × ··· × Rn is a
retraction on Q = Q1 × ··· × Qn.

Compatibility of retraction-based discretizations requires the use of R1 ×···× Rn as the

retraction on Q = Q1, . . . , Qn.

4.1.2. Discrete interconnections using compatible constraint discretizations. Discretizing
individual systems before interconnection yields

(61a)

(61b)

(61c)

d(qi
k+1 = D2Li
pi
k = −D1Li
pi
d+,i(qi
0 = ωa

k, qi
d(qi
k, qi

k+1),
k, qi
k+1),

k+1) + µaωa

i (qi

k),

a = 1, . . . , m.

Here, Li

d have been discretized according to some scheme linear in L, and

(62)

ωa
d+,i(qi

k, qi

k+1) = ωa(qk)(R

−1
i,qi
k

(qi

k+1)).

As above, take Σ◦
αb
i (q)· vqi = αb(q)· vh
above, we need to append an αb
to each equation for pi

Q(q) = span{αb(q)}l
qi for vh

qi the horizontal lift of vqi. To interconnect the discrete systems
i (q) term, which represents an unknown force of constraint,
d+ constraints to (qk, qk+1) ∈ Q. That is, the

k and impose the αb

b=1, so each αb(q) ∈ T ∗

q Q. Deﬁne αb

i (q) ∈ T ∗Qi by

VARIATIONAL INTEGRATORS FOR INTERCONNECTED LAGRANGE–DIRAC SYSTEMS

15

(63a)

(63b)

interconnected system is
pi
k+1 = D2Li
d(qi
k+1),
k, qi
k = −D1Li
pi
d+,i(qi
0 = ωa
k+1),
0 = αb
d+(qk, qk+1),

k, qi
d(qi
k, qi

(63d)

(63c)

k+1) + µaωa

i (qi

k) + λbαb

i (qk),

a = 1, . . . , mi,

b = 1, . . . , l.
k, . . . , qn

Note that all of the α terms depend on the entire coordinate qk = (q1
the ith component qi
k.
Theorem 1. Assume φ : L → Ld is linear and the constraint discretization is compatible.
Then, the discretely interconnected equations (63a)–(63d) are equivalent to the (+) discrete
Dirac equations for (L, ∆Q) = (L1 + ··· + Ln, (∆Q1 ⊕ ··· ⊕ ∆Qn) ∩ ΣQ).
Proof. We just have to consider the discretization of (L, ∆Q) component-wise. The dis-
cretization of the monolithic system using φ and R yields the usual (+) discrete Dirac
equations,

k ), not just on

(64a)

(64b)

(64c)

pk+1 = D2Ld(qk, qk+1),

pk = −D1Ld(qk, qk+1) + ηcβc(qk),
0 = βc

d+(qk, qk+1) = 0,

∀ c.

From our assumptions on the linearity of φ, the ﬁrst equation decomposes component-wise
to give equation (63a).

In this notation, {βc(qk)}c is a basis for ∆◦
i (q) ∈ T ∗Qi by βc
qi for vh

will see, choosing an appropriate basis leads to equations (63b)–(63d). As above, deﬁne
βc
qi the horizontal lift of vqi. Then, equation
(64b) decomposes into

Q(qk) = ((∆Q1 ⊕ ··· ⊕ ∆Qn) ∩ ΣQ)◦. As we

i (q) · vqi = βc(q) · vh

(65)

k = −D1Li
pi

d(qi

k, qi

k+1) + ηcβc

i (qk).

Taking the basis deﬁned above, we have {βc} = {ωa

equation (63b). Assume we construct βc
(64c) accounts for equations (63c) and (63d).

i (q), αb(q)}, so equation (65) becomes
d+ via a compatible discretization. Then, equation
(cid:3)

Thus, given a ﬁnite number of Lagrange–Dirac systems (Li, ∆Qi) together with the
interconnection constraint ΣQ, we have shown how to interconnect the discrete systems
d, ∆d+
generated by (Li
Q to obtain the discretization of the fully
Qi
interconnected system.

Qi) through Σd+

Q and Σ◦

, ∆◦

4.2. Discrete interconnections as a product on discrete Dirac structures. To
mimic the continuous case, we would like to say that this discrete interconnection process
corresponds to a discrete Dirac tensor product on discrete Dirac structures. That is, we
would like for the discretization of the interconnected system, which can be expressed as
(X k
∆Q1 ⊕

, to be equivalently expressed as (X k

k )) ∈ (Dd+

d , D+Ld(qk, q+

d , D+Ld(qk, q+

k )) ∈ Dd+

∆Q

VARIATIONAL INTEGRATORS FOR INTERCONNECTED LAGRANGE–DIRAC SYSTEMS

16

)(cid:2)d Dd+

int for Dd+

int deﬁned from ΣQ, some deﬁnition of (cid:2)d, and the appropriate notion

Dd+
∆Q2
of ⊕.
4.2.1. The direct sum of induced discrete Dirac structures. The deﬁnition of ⊕ for induced
discrete Dirac structures is relatively obvious. We make it precise in this section to ensure
that the convenient properties of using ⊕ on induced Dirac structures carry over to the
discrete setting. Suppose, again, that Q = Q1 × Q2 and that we have two constraint
distributions ∆Q1 ⊂ T Q1 and ∆Q2 ⊂ T Q2. We can derive each distribution from its
i (qi)}a a basis for ∆◦
annihilator as ∆Qi(qi) = ∩a ker(ωa
Qi(qi). The direct
sum distribution on Q has annihilator given by (∆Q1 ⊕ ∆Q2)◦ = ∆◦
Q1 ⊕ ∆◦
Q2, so we can
construct a basis for it by extending the bases of ∆◦
Qi. As in the last section, we use
: Q → Qi to denote component projections from Q. To extend ωa
i , we denote by
πQi
˜ωa
i the one-form on Q such that ˜ωa
1 =
(ωa
1 , 0) and ˜ωb
2). Then, the distribution ∆Q1 ⊕ ∆Q2 has a local expression as
(∆Q1 ⊕ ∆Q2)(q) = [∩a ker(˜ωa
is given by D∆Q1 ⊕
D∆Q2
(66)

i (πQi(q)) · T πQi(vq). In coordinates ˜ωa

The direct sum of continuous Dirac structures D∆Q1

1 (q))] ∩ [∩b ker(˜ωb

. Fiber-wise, this is given by

i (qi)) for {ωa

i (q) · vq = ωa

= D∆Q1⊕∆Q2

2 = (0, ωb

and D∆Q2

2(q))].

(T

(T

∗

∗

iQ2(q, p)),

)(q, p) = D∆Q1

iQ1(q, p)) ⊕ D∆Q2

where iQi : Qi (cid:44)→ Q is the inclusion and T ∗iQi its tangent lift. In coordinates,
(67) {(v, α) = (v1, v2, α1, α2) ∈ T(q1,q2,p1,p2)T

Q | (v1, α1) ∈ D∆Q1

(q1, p1)

∗

(q2, p2)}.
We mimic this coordinate expression at the discrete level with the following deﬁnition.

and (v2, α2) ∈ D∆Q2

(D∆Q1 ⊕ D∆Q2

1) and Dd+

Deﬁnition 2. Given two discrete induced Dirac structures Dd+
∆Q2 ⊂ (T ∗Q2 × T ∗Q2) × T ∗(Q2 × Q∗
T ∗(Q1 × Q∗
∆Q2 ⊂ (T ∗Q × T ∗Q) × T ∗(Q × Q∗) coordinate-wise as
Dd+
(68) Dd+

= {((z, z+), αˆz) | ((q1, p1, q+

∆Q1 ⊕ Dd+

1 ), (q1, p+

1 , p+

∆Q2

∆Q1 ⊂ (T ∗Q1 × T ∗Q1) ×
∆Q1 ⊕

2), deﬁne their direct sum Dd+

and ((q2, p2, q+

2 , p+

1 , αq1, αp1)) ∈ Dd+
2 ), (q2, p+

∆Q1

2 , αq2, αp2)) ∈ Dd+

∆Q2}

Here, we have partitioned the coordinates as

(69)

and

(70)

(z, z+) = (q, p, q+, p+) = (q1, q2, p1, p2, q+

1 , q+

2 , p+

1 , p+
2 )

αˆz = (q, p+, αq, αp) = (q1, q2, p+

1 , p+

2 , αq1, αq2, αp1, αp2).

We deﬁne the direct sum of two discrete constraint distributions as follows.

VARIATIONAL INTEGRATORS FOR INTERCONNECTED LAGRANGE–DIRAC SYSTEMS

17

Deﬁnition 3. The direct sum of two discrete constraint distributions is given by

(71)

∆d+
Q1 ⊕ ∆d+

Q2 = {(q1, q2, q+

1 , q+
1 ) ∈ ∆d+

2 ) ∈ Q × Q |
Q1 and (q2, q+

(q1, q+

2 ) ∈ ∆d+
Q2}.

We have the following useful lemma.

Lemma 2. Assume we use the same separable discretization scheme to construct ωa
∆Q1 ⊕ Dd+
2,d+, ˜ωa
ωb
Dd+
∆Q1⊕∆Q2

Q2 = (∆Q1 ⊕ ∆Q2)d+ and Dd+
Q1 ⊕ ∆d+
is again a discrete induced Dirac structure.

2,d+. Then, ∆d+
∆Q1 ⊕ Dd+

1,d+, and ˜ωb

. Thus, Dd+

∆Q2

∆Q2

1,d+,
=

Proof. We have

(72)

and

(73)

(74)

and

(75)

(78)

and

(∆Q1 ⊕ ∆Q2)d+ = {(q, q+) ∈ Q × Q | ˜ωa

1,d+(q, q+) = 0 and

˜ωb
2,d+(q, q+) = 0 for all a, b}

By our assumptions, ˜ωa
∆Q1 ⊕ Dd+

To prove Dd+

∆d+
Qi

i,d+(qi, q+

i ) ∈ Qi × Qi | ωa
i,d+(qi, q+

= {(qi, q+
i,d+(q, q+) = ωa
∆Q1⊕∆Q2
(q, q+) ∈ (∆Q1 ⊕ ∆Q2)d+

= Dd+

∆Q2

i ). Thus, ∆d+

i ) = 0 for all a}.

Q1 ⊕ ∆d+

Q2 = (∆Q1 ⊕ ∆Q2)d+.

we need to show that the conditions

◦
(q, p+, αq − p, αp − q+) ∈ {(q, p, β, 0) | βdq ∈ (∆Q1 ⊕ ∆Q2)

(q)}

are equivalent to the conditions

(76)

and

(77)

((q1, p1, q+

1 , p+

1 ), (q1, p+

1 , αq1, αp1)) ∈ Dd+

∆Q1

((q2, p2, q+

2 , p+

2 ), (q2, p+

2 , αq2, αp2)) ∈ Dd+

∆Q2

.

Q1 ⊕ ∆d+

Using ∆d+
are equivalent to (74). From (76) and (77) we also have

Q2 = (∆Q1 ⊕ ∆Q2)d+, the distribution conditions implied by (76) and (77)
(q1, p+

1 , αq1 − p1, αp1 − q+

◦
1 ) ∈ {(q1, p1, β, 0) | βdq ∈ ∆
Q1}
◦
Q2}.

2 ) ∈ {(q2, p2, β, 0) | βdq ∈ ∆

2 , αq2 − p2, αp2 − q+
1 , q+

(q2, p+
(79)
Thus, (αp1, αp2) − (q+
span{˜ωa
span{˜ωa
(75).

2 ) = 0. From αqi − pi ∈ span{ωa

1 (q)} and (0, αq2 − p2) ∈ span{˜ωb
1 (q), ˜ωb

i (qi)} we have (αq1 − p1, 0) ∈
2(q)}. Thus, we have (αq1 − p1, αq2 − p2) ∈
2}, i.e. αq − p ∈ (∆Q1 ⊕ ∆Q2)◦. Hence, conditions (76) and (77) also give
Performing the same calculations from the reversed point of view, we can derive (76)
(cid:3)

and (77) from (74) and (75), proving that Dd+

= Dd+

.

∆Q1 ⊕ Dd+

∆Q2

∆Q1⊕∆Q2

VARIATIONAL INTEGRATORS FOR INTERCONNECTED LAGRANGE–DIRAC SYSTEMS

18

For continuous distributions ∆1 and ∆2, a similar set of calculations show that

(80)

∆d+
1 ∩ ∆d+

2 = (∆1 ∩ ∆2)d+.

int and (cid:2)d. We begin by deﬁning Dd+

4.2.2. Deﬁning Dd+
interconnection constraints on Q = Q1×Q2. Lift ΣQ to T T ∗Q, deﬁning Σint = (T π)−1(ΣQ).
Then, the continuous interaction Dirac structure is induced by Σint and Ωint ≡ 0. To
discretize this construction, we deﬁne Ωd+

int . The distribution ΣQ deﬁnes the

int (q, p, q+, p+) = (q, p+, 0, 0).

Deﬁnition 4. We deﬁned the standard discrete interaction Dirac structure to be

(81)

Dd+
int = {((z, z+), αˆz) | (z, z+) ∈ Σd+

int , αˆz − Ωd+

◦
int (z, z+) ∈ Σ
Q×Q∗}(q)

for Ωd+

int (q, p, q+, p+) = (q, p+, 0, 0).

Here, as in the original deﬁnitions of the discrete Dirac structures, z = (q, p), z+ =
(q+, p+), ˆz = (q, p+). This discrete Dirac structure mirrors the induced discrete Dirac
structure of [14] with Ω(cid:91)

d± replaced by Ωd+
int .

Recall, again, the continuous deﬁnition of (cid:2).

Deﬁnition 5 (Jacobs and Yoshimura [10]). Let Da, Db ∈ Dir(M ), i.e., Da and Db are
Dirac structures on M . We deﬁne the Dirac tensor product
∗
M | ∃β ∈ T

Da (cid:2) Db = {(v, α) ∈ T M ⊕ T

M such that

∗

(82)

Mimicking this deﬁnition at the discrete level, we deﬁne (cid:2)d as follows.

(v, α + β) ∈ Da, (v,−β) ∈ Db}.

Deﬁnition 6. Deﬁne the operation (cid:2)d on two discrete Dirac structures D1 and D2 by

where βˆz = (q, p+, βq, βp+), αˆz = (q, p+, αq, αp+), αˆz+βˆz = (q, p+, αq+βq, αp+ +βp+),−βˆz =
(q, p+,−βq,−βp+).
4.2.3. Discrete interconnections via Dirac structures. With these deﬁnitions in place, we
now have the tools to state the main result.
Theorem 2. Given two discrete Dirac structures Dd+
∆Q1
T Q1 and ∆Q2 ⊂ T Q2 and an interconnection distribution ΣQ ⊂ T Q = T (Q1 × Q2),
(84)

generated from ∆Q1 ⊂

and Dd+
∆Q2

) (cid:2)d Dd+

(Dd+

int = Dd+
∆Q

∆Q1 ⊕ Dd+

∆Q2

for ∆Q = (∆Q1 ⊕ ∆Q2) ∩ ΣQ.
Thus, the statement (X k

the statement (X k
(63a)–(63d).

d , D+Ld(qk, q+

d , D+Ld(qk, q+
k )) ∈ Dd+

∆Q

k )) ∈ (Dd+

∆Q1 ⊕ Dd+

∆Q2

) (cid:2)d Dd+

int

is equivalent to

and to the interconnected equations given in

(83)

D1 (cid:2) D2 = {((z, z+), αˆz) | ∃βˆz ∈ T

∗
∗
ˆz (Q × Q

)

with ((z, z+), αˆz + βˆz) ∈ D1, ((z, z+),−βˆz) ∈ D2},

VARIATIONAL INTEGRATORS FOR INTERCONNECTED LAGRANGE–DIRAC SYSTEMS

19

Proof. First we recall the deﬁnition of a (+) discrete induced Dirac structure,

(85)

Dd+
∆Q

= {((z, z+), αˆz) ∈ (T

Q × T
T ∗Q, αˆz − Ω(cid:91)
For Q = Q1×Q2 we can write z = (z1, z2), z+ = (z+
Then,

(z, z+) ∈ ∆d+

∗

∗

∗

∗

Q) × T
d+(z, z+) ∈ ∆
1 , z+

(Q × Q

) |
◦
Q×Q∗}.

2 ), ˆz = (ˆz1, ˆz2), and αˆz = (αˆz1, αˆz2).

Dd+
∆Q1 ⊕ Dd+

∆Q2

= {((z, z+), αˆz) | ((z1, z+

1 ), αˆz1) ∈ Dd+

∆Q1

and ((z2, z+

2 ), αˆz2) ∈ Dd+

∆Q2}

(86)

and

(87)

(88)

(Dd+

∆Q1 ⊕ Dd+

∆Q2

) (cid:2)d Dd+

int = {((z, z+), αˆz) | ∃βˆz ∈ T
((z, z+), αˆz + βˆz) ∈ Dd+

∗
∗
ˆz (Q × Q
∆Q1 ⊕ Dd+
∆Q2
1 ), αˆz1 + βˆz1) ∈ Dd+

) with
, ((z, z+),−βˆz) ∈ Dd+
int}.
and ((z2, z+

2 ), αˆz2 + βˆz2) ∈

From the ﬁrst condition we have ((z1, z+
Dd+
∆Q2
Consider the distribution conditions ﬁrst. The distribution condition for Dd+
∆Q

∆Q1

.

is that

(z, z+) ∈ ∆d+

T ∗Q. We can break the distribution condition down as
((q, p), (q+, p+)) ∈ {((q, p), (q+, p+)) ∈ T

Q × T

∗

∗

= {((q, p), (q+, p+)) | (q, q+) ∈ (∆d+
= {((q, p), (q+, p+)) | (q, q+) ∈ Σd+

and (q2, q+

2 ) ∈ Dd+

∆Q2}.

Q | (q, q+) ∈ ∆d+
Q }
Q2 ) ∩ Σd+
Q1 ⊕ ∆d+
Q }
1 ) ∈ Dd+
Q , (q1, q+
∆Q1

,

We now derive the distribution condition from ((z, z+), αˆz) ∈ (Dd+
((z1, z+
. From ((z, z+),−βˆz) ∈ Dd+
(q2, q+
conditions derived from ((z, z+), αˆz) ∈ Dd+
are equivalent.

1 ), αˆz1 + βˆz1) ∈ Dd+
2 ) ∈ Dd+

int we have (q, q+) ∈ Σd+

2 ), αˆz2 + βˆz2) ∈ Dd+

and ((z2, z+

∆Q2

∆Q2

∆Q1

∆Q

Now we consider the second condition, coming from αˆz − Ω(cid:91)

general deﬁnition. Recalling the deﬁnitions of ∆◦
(q, p+, p, q+) gives

and ((z, z+), αˆz) ∈ (Dd+

∆Q1 ⊕ Dd+
d+(z, z+) ∈ ∆◦
Q×Q∗, ˆz = (q, p+), and Ω(cid:91)

∆Q2

∆Q1 ⊕Dd+

∆Q2

, we get (q1, q+

Q . Thus, the distribution
) (cid:2)d Dd+

int

Q×Q∗ in the
d+(z, z+) =

)(cid:2)dDd+
1 ) ∈ Dd+

int . From
and

∆Q1

(89)
In the case of ∆Q = (∆Q1 ⊕ ∆Q2) ∩ ΣQ we can rewrite this condition explicitly as
(90)

(q, p+, αq, αp+) − (q, p+, p, q+) ∈ {(q, p, αq, 0) ∈ T
◦
αq − p ∈ [(∆Q1 ⊕ ∆Q2) ∩ ΣQ]

) | αqdq ∈ ∆

∗

∗
(Q × Q

◦
Q(q)}.

(91)

(q0),
αp+ − q+ = 0.

VARIATIONAL INTEGRATORS FOR INTERCONNECTED LAGRANGE–DIRAC SYSTEMS

20

Now consider the statement ((z, z+), αˆz) ∈ (Dd+
((z, z+),−βˆz) ∈ Dd+
{(q, p, αq, 0)|αqdq ∈ Σ◦
examine ((z, z+), αˆz + βˆz) ∈ Dd+
((zi, z+

int . This implies that −βˆz−Ωd+

which gives the conditions

∆Q1 ⊕ Dd+

Q(q)}. Thus, we must have −βp+ = 0 and −βq ∈ Σ◦

∆Q1 ⊕ Dd+
int (z, z+) ∈ Σ◦

int . First examine
∆Q2
Q×Q∗, i.e., (q, p+,−βq,−βp+) ∈
Q(q). Now we
. From the subsection above, we then have that

∆Q2

i ), αˆzi + βˆzi) ∈ Dd+
∆Qi

) (cid:2)d Dd+

(92)

(qi, p+

i , αqi + βqi − pi, αp+

i

+ βp+

i − q+

i ) ∈ {(q, p, α, 0)|αdq ∈ ∆

We already know that βp+ = 0, so these conditions become

(93)

(94)

αp+

i − q+
αqi + βqi − pi ∈ ∆

i = 0,
◦
Qi.

Putting the two indices together gives

◦
Qi}.

(95)

(96)

αq − p + βq ∈ ∆

αp+ − q+ = 0,
◦
Q2.

◦
Q1 ⊕ ∆

We have already established that βq ∈ Σ◦
Q(q), so (96) becomes
◦
αq − p ∈ (∆
Q1 ⊕ ∆

◦
Q2)(q) ∪ Σ

◦
Q(q),

(97)

i.e.,

(98)

◦
αq − p ∈ [(∆Q1 ⊕ ∆Q2) ∩ ΣQ]

(q).

Thus, we derive precisely the same conditions from both Dd+
∆Q
and the two structures are equivalent.

and (Dd+

∆Q1 ⊕ Dd+

∆Q2

) (cid:2)d Dd+
(cid:3)

int

We have now shown that we can interconnect discrete Dirac systems in a way consistent
with the variational discretization of the full system and that the Dirac structure preserved
by the interconnected discrete system can be viewed as a product of Dd+
with a
discrete interaction Dirac structure, analogous to the continuous case. In deﬁning Dd+
int , we
have extended the notion of discrete Dirac structures beyond the induced structures of [14].
This extension as well as the deﬁnition of (cid:2)d, which is agnostic to whether its operands are
induced structures, raises the question of whether we can make a more general deﬁnition
of discrete Dirac structures for which induced structures are just a special case. We discuss
this more in the future work section below.

∆Q1 ⊕ Dd+

∆Q2

5. Numerical Examples

Continuing the theme of reproducing [10] discretely, we now work through the simulation
of some of the interconnected examples presented there. We will rehash the setup of each
example.

VARIATIONAL INTEGRATORS FOR INTERCONNECTED LAGRANGE–DIRAC SYSTEMS

21

Figure 1. A chain of spring masses like that presented in [10].

Figure 2. The chain of springs as two primitive systems [10].

5.1. A chain of spring masses. The ﬁrst example is a chain of three spring masses
attached to a wall. We consider it to be the interconnection of a chain of two spring masses
with the third spring mass pair. Thus, we have two primitive systems with conﬁguration
spaces Q1 = Q2 = R2. The ﬁrst system has coordinates (q1, q2), the second (¯q2, q3). Figures
1 and 2 illustrate these two viewpoints. Note that in the torn case we introduce an extra
variable, ¯q2, to mark the position of the left end of the spring.

Viewed separately, the two primitive systems each have the trivial constraint distribution

∆Qi = T Qi and Lagrangians

(99)

and

(100)

L1(q1, q2, v1, v2) =

1
2

m1v2

1 +

1
2

m2v2

2 −

1
2

k1q2

1 −

1
2

k2(q2 − q1)2

L2(¯q2, q3, ¯v2, v3) =

1
2

m3v2

3 −

1
2

(q3 − ¯q2)2.

To interconnect the systems into the chain in Figure 1, we need to enforce the constraint
q2 = ¯q2. This is a holonomic constraint, but within the framework of Dirac systems
we enforce it with a compatible initial condition and a distribution constraint Σint(q) =
q Q. In coordinates,

{v ∈ TqQ | v2 = ¯v2}. Thus, Σ◦
ω = (0, 1,−1, 0).
We discretized both the simple chain of springs in Figure 1 and the interconnected version
described above using the retraction-based methodology laid out in [14] and used in the
circuit example therein. Namely, we choose the vector space retraction Rq(v) = q + vh for

int = span{ω} for ω = dq2 − d¯q2 ∈ T ∗

88HENRYO.JACOBSANDHIROAKIYOSHIMURAwithrespecttochosenvariationsδq(t)∈∆Q(q(t))withﬁxedendpoints,δv,δparbitrary,andtheconstraint˙q(t)∈∆Q(q(t)).(iv)Thecurves(qi,vi,pi)(t)∈TQi⊕T∗QisatisfytheLagrange-d’Alembert-Pontry-aginprinciples:δZt2t1Li(qi,vi)+hpi,˙qi−viidt+Zt2t1hFi,δqidt=0,fori=1,...,n,togetherwith(˙q1,...,˙qn)∈ΣQ(q1,...,qn)and(F1(q,v),...,Fn(q,v))∈Σ◦Q(q1,...,qn).6.Examples.Theunifyingthemeofinterconnectionisthatweoftenﬁndourselvesinasituationwherewehaveanumberofsystemswhichweunderstandwell(suchasthecomponentsofacircuitorarigidbody),whiletheinterconnectedsystemislessunderstood.Thereforetheconceptofinterconnectionisusefulbecauseitallowsustouseourpreviousknowledgeofthesubsystemstoconstructtheinterconnectedsystem.Theseinterconnectionscanbe,geometricallyspeaking,quitesophisticated(e.g.interconnectionbynonholonomicconstraints).Inthissection,weprovidesomeexamplesofinterconnectionofLagrange-Diracdynamicalsystems.Wehavechosensimpleexamplestoillustratetheessentialideasofinterconnectionconcretely.However,themethodoftearingandinterconnectingsubsystemscanextendtomorecomplicatedsystems.6.1.Amass-springmechanicalsystem.Consideramass-springsystemasinFigure4.Letmiandkibethei-thmassandspringfori=1,2,3.qqqkkkmmmFigure4.AMass-SpringSystem6.1.1.Tearingandinterconnecting.Inspiredbytheconceptoftearingandinter-connectingsystemsdevelopedby[25],themass-springmechanicalsystemcanbetornapartintotwodistinctsubsystemscalled“primitivesystems”asinFigure5.Theprocedureoftearinginevitablyyieldsinteractiveboundaries,throughwhichtheenergyﬂowsbetweentheprimitivesubsystem1andtheprimitivesubsystem2.Upontearing,theseparateprimitivesystemsobeythefollowingconditionattheinteractionboundaries:f2+¯f2=0,˙q2=˙¯q2.(17)Intheabove,˙q2and˙¯q2aretheassociatedvelocitiestotheboundaries,whilef2and¯f2aretheinteractionforces.Wecallequation(17)thecontinuitycondition.Withoutthecontinuitycondition,thereexistsnoenergyinteractionbetweentheprimitivesubsystems.Inotherwords,theoriginalmechanicalsystemcanberecov-eredbyinterconnectingtheprimitivesubsystemswiththecontinuityconditions.Equation(17)impliesthatpowerinvarianceholds:hf2,˙q2i+(cid:10)¯f2,˙¯q2(cid:11)=0.TENSORPRODUCTSOFDIRACSTRUCTURESANDINTERCONNECTION89Subsystem 1qqqqkkffkmmmTearingSubsystem 2Figure5.Torn-apartSystemsNeedlesstosay,theaboveequationmaybeunderstoodbyaninteractionDiracstructureasshownlater.6.1.2.Lagrangiansforprimitivesystems.Letusconsiderhowdynamicsoftheprim-itivesystemscanbeformulatedasforcedLagrange-Diracdynamicalsystems.Theconﬁgurationspaceoftheprimitivesystem1maybegivenbyQ1=R×Rwithlocalcoordinates(q1,q2),whiletheconﬁgurationspaceoftheprimitivesystem2isQ2=R×Rwithlocalcoordinates(¯q2,q3).WecaninvokethecanonicalDiracstructuresDTQ1∈Dir(T∗Q1)andDTQ2∈Dir(T∗Q2)inthisexample.ForSubsystem1,theLagrangianL1:TQ1→Risgivenby,for(q1,q2,v1,v2)∈TQ1,L1(q1,q2,v1,v2)=12m1v21+12m2v22−12k1q21−12k2(q2−q1)2,whiletheLagrangianL2:TQ2→Rfortheprimitivesystem2isgivenby,for(¯q2,q3,¯v2,v3)∈TQ2,L2(¯q2,q3,¯v2,v3)=12m3v23−12k3(q3−¯q2)2.Whenviewingeachsystemseparately,theconstraintforceactsasanexternalforceoneachprimitivesystem.Again,thisisbecausetearingalwaysyieldscon-straintforcesattheboundariesassociatedwiththedisconnectedprimitivesystems,asshowninFigure56.1.3.PrimitiveSystem1.GivenaninteractionforceF1:TQ→T∗Q1,wecansetupequationsofmotionfortheLagrange-Diracsystem(dDL1,F1,DTQ1)by˙q1=v1,˙q2=v2,˙p1=−k1q1−k2(q1−q2),˙p2=k2(q1−q2)+f2(q,v),(18)togetherwithp1=m1v1andp2=m2v2andF1(q,v)=(q1,q2,0,f2(q,v)),where(q,v)=(q1,q2,¯q2,q3,v1,v2,¯v2,v3)∈TQ.ThisimplicitLagrange-d’Alembertequationiswelldeﬁnedwhenwearegiven(q2(t),v2(t))∈TQ2.6.1.4.PrimitiveSystem2.Similarly,byintroducinganinteractionforce,F2:TQ→T∗Q2,ontheportvariable¯q2wecanalsoformulateequationsofmotionfortheLagrange-Diracdynamicalsystem(dDL2,F2,DTQ2)by˙¯q2=¯v2,˙q3=v3,˙¯p2=k3(q3−¯q2)+¯f2,˙p3=−k3(q3−¯q2),(19)togetherwithF2(q,v)=(¯q2,q3,¯f2(q,v),0),VARIATIONAL INTEGRATORS FOR INTERCONNECTED LAGRANGE–DIRAC SYSTEMS

22

Figure 3. A comparison of spring positions over time. Solutions from
discretizing the full system are plotted as lines. Solutions from discretizing
as two interconnected systems are plotted as hollow shapes. The shapes lie
directly over the lines.

h the timestep, giving R−1

q0 (q1) = 1

h (q1 − q0). Then, we set

Ld(qk, qk+1) = hL(qk, R
ωd+(qk, qk+1) = (cid:104)ω(qk), R

−1
qk (qk+1)),
−1
qk (qk+1)(cid:105).

(101)

(102)

Figures 3 through 6 show the results of this numerical experiment.

Figures 3 and 4 compare the interconnected discretization with the discretization of
the full system. Note that we are more concerned with reproducing the behavior of the
full discretization than with the overall accuracy of the simulation. We have excellent
agreement between the two discretizations, with the interconnected results obscuring the
full discretization in the ﬁgures by lying directly on top. It is also diﬃcult to distinguish in
Figure 3 between the trajectories of q2 and ¯q2. This is because, as shown in Figure 5, the
interconnected discretization preserves the q2 = ¯q2 constraint to machine precision. Thus,
the trajectories lie atop one another in Figure 3. Figure 4 shows good agreement between
the energy of the full system discretization and that of the interconnected discretization.
Lastly, Figure 6 shows that the interconnected discretization exhibits the oscillatory energy
behavior characteristic of variational integrators.

5.2. An LC circuit. The next example is a very simple parallel RLC circuit which we
consider as the joining of a capacitor to the RL loop component. We borrow the illustrations
of this idea from [10] in Figures 7 and 8.

Spring positions  q1q2q3q1q2q2barq3VARIATIONAL INTEGRATORS FOR INTERCONNECTED LAGRANGE–DIRAC SYSTEMS

23

Figure 4. A comparison of the spring system energy over time. The line
labeled “variational” is the energy of the full-system discretization. The
hollow circles show the energy for the discretization as two interconnected
systems. The hollow circles lie directly on top of the line. Note also the
small scale of the vertical axis.

When considering electric circuits as Lagrangian, Hamiltonian or Lagrange–Dirac sys-
tems we take the charges as the conﬁguration variables. So the conﬁguration space for the
undivided circuit is R3 with coordinates (qR, qL, qC) representing the charge in the resistor,
inductor and capacitor, respectively. Then,
˙q represents the currents in each component.
The Lagrangian for any circuit is given by the magnetic energy stored in any inductors
minus the electric potential energy of any capacitors. For the ﬁrst primitive circuit we have
Q1 = R3 with local coordinates q1 = (qR, qL, qS1). The qS1 variable represents the possible
point of connection shown in Figure 8 and represents the inﬂuence of any connected circuit
components. The Lagrangian is just the magnetic energy,

(103)

L1(q1, v1) =

1
2

lv2
L,

where l is the inductance. The circuit has a nontrivial constraint distribution given by
Kirchoﬀ’s circuit law,

∆Q1(q1) = {v1 = (vR, vL, vC) ∈ Tq1Q1 | vR − vL + vS1 = 0}.

(104)
Thus, ∆◦
Q1 = span{ω1} for ω1 = dqR − dqL + dqS1. In coordinates, ω1 = (1,−1, 1). This
circuit also has an external force due to the resistor, given by fr = −RdqR = (−R, 0, 0).

02468105.465.475.485.495.55.51Energy  VariationalInterconnectedVARIATIONAL INTEGRATORS FOR INTERCONNECTED LAGRANGE–DIRAC SYSTEMS

24

Figure 5. Deviation of the interconnected discretization from the con-
straint q2 = ¯q2 over time. We see that the constraint is preserved to machine
precision.

Figure 6. The interconnected discretization’s energy oscillates over very
long times, much like the energy of classical variational discretization.

0246810−1−0.500.51Constraint Deviation010020030040050060070080090010005.465.4655.475.4755.485.4855.495.4955.55.5055.51(+) Dirac EnergyVARIATIONAL INTEGRATORS FOR INTERCONNECTED LAGRANGE–DIRAC SYSTEMS

25

R

L

C

Figure 7. A simple parallel RLC circuit [10].

Primitive circuit 1

Primitive circuit 2

R

L

S1

S2

C

Figure 8. Considering the circuit as two primitive circuits. The Si boxes
show the possible points of connection and represent the inﬂuence of any
connected circuit components [10].

The second primitive circuit has conﬁguration space Q2 = R2 with local coordinates

q2 = (qS2, qC). Here, the Lagrangian is given by
L2(q2, v2) = −

(105)

1
2C

q2
C,

where C is the capacitance. Again, we have a nontrivial constraint coming from circuit
laws,

∆Q2(q2) = {v2 = (vS2, vC) ∈ Tq2Q2 | vC − vS2 = 0}.

Q2 = span{ω2} for ω2 = −dqS2 + dqC = (−1, 1).

To interconnect the two circuits, we set Q = Q1 × Q2, L = L1 + L2 and use

(106)
Hence, ∆◦

(107)

Σint = {(vR, vL, vS1, vS2, vC) ∈ T Q | vS1 = vS2}.

Again, we compare the numerical results of a discretization of the full circuit as shown
in Figure 7 to those from a discretization of the primitive circuits shown in Figure 8 and
interconnected via Σint. Figures 9 through 11 show the results.

Figure 9 shows that the capacitor charge of the interconnected discretization correctly
replicates that of the full system discretization. In Figure 10, we see that the same is true for
the overall circuit energy. Lastly, Figure 11 shows preservation of the constraint to machine

VARIATIONAL INTEGRATORS FOR INTERCONNECTED LAGRANGE–DIRAC SYSTEMS

26

Figure 9. A comparison of the capacitor charge in the system generated
by the monolithic and interconnected models. The two agree very closely.

Figure 10. The energy in the circuit system generated by the monolithic
vs. the interconnected model. The two agree very closely.

Capacitor charge  No extra variablesInterconnectedEnergy  No extra variablesInterconnectedVARIATIONAL INTEGRATORS FOR INTERCONNECTED LAGRANGE–DIRAC SYSTEMS

27

Figure 11. The interconnected model preserves the interconnection con-
straint to machine precision.

precision in this case as well. Thus, once again, our interconnected discretization behaves
equivalently to the full system discretization, as predicted by our theoretical development.

6. Conclusions and future work

We have presented a framework for interconnecting discrete Lagrange–Dirac systems,
extending the work of [14]. Our view of interconnections is based on the perspective
presented in [10]. In [10], the authors emphasize the equivalence between the constrained
view and the interaction force view of interconnections. Our discrete interconnections so
far take the constrained point of view. In future work, we would like to see an equivalent
interaction-force perspective at the discrete level.

We would also like to further investigate the relationship between discrete Dirac in-
tegrators and the vast literature on nonholonomic integrators. With any luck, the two
approaches to nonholonomic constraints will mutually shed light on one another.

As a practical consideration, the tearing of systems like those in the examples here can
lead to new, redundant variables in the interconnected system. Those extra variables have
been dealt with on a case by case basis in this study, and our numerical experiments conﬁrm
the the monolithic interconnected system with extra variables produces the same results
as the full system without extra variables in these cases. We would of course prefer to have
a theoretical justiﬁcation for introducing and working with extra variables in this way. We
leave this as future work.

0510152025303540−1−0.500.51Deviation from constraint  InterconnectedVARIATIONAL INTEGRATORS FOR INTERCONNECTED LAGRANGE–DIRAC SYSTEMS

28

7. Acknowledgements

HP has been supported by the NSF Graduate Research Fellowship grant number DGE-
1144086. ML has been supported in part by NSF under grants DMS-1010687, CMMI-
1029445, DMS-1065972, CMMI-1334759, DMS-1411792, DMS-1345013.

References

[1] N. Bou-Rabee and J. E. Marsden. Hamilton-Pontryagin integrators on Lie groups. I.
Introduction and structure-preserving properties. Found. Comput. Math., 9(2):197–
219, 2009.

[2] N. Bou-Rabee and H. Owhadi. Stochastic variational integrators. IMA J. Numer.

Anal., 29(2):421–443, 2009.

[3] N. Bou-Rabee and H. Owhadi. Long-run accuracy of variational integrators in the

stochastic context. SIAM J. Numer. Anal., 48(1):278–297, 2010.

[4] D.-E. Chang. On the method of interconnection and damping assignment passivity-
based control for the stabilization of mechanical systems. Regular and Chaotic Dy-
namics, 19(5):556–575, 2014. doi: 10.1134/S1560354714050049.

[5] J. Cort´es and S. Mart´ınez. Non-holonomic integrators. Nonlinearity, 14(5):1365–1392,

2001.

[6] V. Duindam, A. Macchelli, S. Stramigioli, and H. Bruyninckx. Modeling and Control

of Complex Physical Systems: The Port-Hamiltonian Approach. Springer, 2009.

[7] Y. N. Fedorov and D. V. Zenkov. Discrete nonholonomic LL systems on Lie groups.

Nonlinearity, 18(5):2211–2241, 2005.

[8] R. Fetecau, J. E. Marsden, M. Ortiz, and M. West. Nonsmooth Lagrangian mechanics
and variational collision integrators. SIAM Journal on Applied Dynamical Systems, 2
(3):381–416, 2003.

[9] M. Gualtieri. Generalized complex geometry. Annals of Mathematics, 174:75–123,

2011.

[10] H.O. Jacobs and H. Yoshimura. Tensor products of Dirac structures and interconnec-
tion in Lagrangian mechanics. Journal of Geometric Mechanics, 6(1):67–98, March
2014.

[11] S. Lall and M. West. Discrete variational Hamiltonian mechanics. J. Phys. A, 39(19):

5509–5519, 2006.

[12] T. Lee, M. Leok, and N. H. McClamroch. Lie group variational integrators for the full

body problem. Comput. Methods Appl. Mech. Engrg., 196(29-30):2907–2924, 2007.

[13] T. Lee, M. Leok, and N. H. McClamroch. Lagrangian mechanics and variational
Internat. J. Numer. Methods Engrg., 79(9):1147–1174,

integrators on two-spheres.
2009.

[14] M. Leok and T. Ohsawa. Variational and geometric structures of discrete Dirac me-

chanics. Foundations of computational mathematics, 11(5):529–562, October 2011.

[15] M. Leok and J. Zhang. Discrete Hamiltonian variational integrators. IMA J. Numer.

Anal., 31(4):1497–1532, 2011.

VARIATIONAL INTEGRATORS FOR INTERCONNECTED LAGRANGE–DIRAC SYSTEMS

29

[16] A. Lew, J. E. Marsden, M. Ortiz, and M. West. Asynchronous variational integrators.

Arch. Ration. Mech. Anal., 167(2):85–146, 2003.

[17] J. E. Marsden, G. W. Patrick, and S. Shkoller. Multisymplectic geometry, variational

integrators, and nonlinear PDEs. Comm. Math. Phys., 199(2):351–395, 1998.

[18] J.E. Marsden and T.S. Ratiu. Introduction to Mechanics and Symmetry. Springer, 2

edition, 1999.

[19] J.E. Marsden and M. West. Discrete mechanics and variational integrators. Acta

Numerica, 10:357–514, May 2001.

[20] R. McLachlan and M. Perlmutter. Integrators for nonholonomics mechanical systems.

Journal of Nonlinear Science, 16(4):283–328, 2006.

[21] W.M. Tulczyjew. The Legendre transformation. Annales de l’Institute Henri Poincar´e,

27:101–114, 1977.

[22] A. van der Schaft. Port-Hamiltonian systems: an introductory survey. Proceedings of

the International Congress on Mathematicians, Madrid, Spain, 2006.

[23] H. Yoshimura and J.E. Marsden. Dirac structures in Lagrangian mechanics Part I:
Implicit Lagrangian systems. Journal of Geometry and Physics, 57(1):133–156, 2006.
[24] H. Yoshimura and J.E. Marsden. Dirac structures in Lagrangian mechanics Part II:

Variational Structures. Journal of Geometry and Physics, 57(1):209–250, 2006.

Department of Mathematics, University of California, San Diego, 9500 Gilman Drive, La

Jolla, California, USA.

E-mail address: parks.helen@gmail.com, mleok@math.ucsd.edu

