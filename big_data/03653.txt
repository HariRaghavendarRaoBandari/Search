6
1
0
2

 
r
a

 

M
1
1
 
 
]

.

O
C
h
t
a
m

[
 
 

1
v
3
5
6
3
0

.

3
0
6
1
:
v
i
X
r
a

RNA secondary structures having a compatible

sequence of certain nucleotide ratios

Christopher L. Barrett, Thomas J. X. Li and Christian M. Reidys ⋆

Biocomplexity Institute of Virginia Tech

Blacksburg, VA 24061, USA

Email: cbarrett@vbi.vt.edu, thomasli@vbi.vt.edu, duckcr@vbi.vt.edu

Abstract

Given a random RNA secondary structure, S, we study RNA sequences having ﬁxed ratios of

nuclotides that are compatible with S. We perform this analysis for RNA secondary structures

subject to various base pairing rules and minimum arc- and stack-length restrictions. Our main

result reads as follows:

in the simplex of the nucleotide ratios there exists a convex region in

which, in the limit of long sequences, a random structure a.a.s. has compatible sequence with

these ratios and outside of which a.a.s. a random structure has no such compatible sequence.

We localize this region for RNA secondary structures subject to various base pairing rules and

minimum arc- and stack-length restrictions. In particular, for GC-sequences having a ratio of G

nucleotides smaller than 1/3, a random RNA secondary structure without any minimum arc- and

stack-length restrictions has a.a.s. no such compatible sequence. For sequences having a ratio of

G nucleotides larger than 1/3, a random RNA secondary structure has a.a.s. such compatible

sequences. We discuss our results in the context of various families of RNA structures.

Keywords: RNA secondary structure, compatible sequence, nucleotide ratio, generat-

ing function, singularity analysis.

1. Introduction

This paper is motivated by the question whether there is “more” to DNA sequence data
than the mere sequence of nucleotides, identiﬁed by alignment methods. As DNA is tran-
scribed into RNA and subsequently processed in various ways, we ask here the question
what eﬀect the frequencies of the nucleotides have on the variety of RNA structures that
are compatible with the given sequence. Sequences are called compatible if they satisfy the
base pairing rules for all bonds of the structure. In particular, for RNA secondary struc-
tures the work of McCaskill (McCaskill, 1990), allows to eﬃciently Boltzmann-sample
such conﬁgurations. Simple quantities such as the nucleotide ratios could be used to
identify the functionality of embedded DNA sequences.

This paper provides the mathematical analysis of the fact that in the simplex of the
nucleotide ratios there exists a convex region in which, in the limit of long sequences, a

1

2

random structure a.a.s. has compatible sequences with these ratios and outside of which
a.a.s. a random structure has no such compatible sequence. Here a.a.s. stands for asymp-
totically almost surely, i.e. in the limit of long sequences, the probability tends to 1. The
nucleotide ratios are a discriminant of whether or not a random secondary structure has
such a compatible sequence and is thus accessible by means of folding. By random we
mean a secondary structure that, in the limit of long sequences, has the average number
of arcs, see Theorem 8 for details. On the ﬂip side, given a biologically relevant sequence,
whose ratios are not within this window, we can test for whether or not functionalities
are achieved by other means, i.e. for instance by interactions with either Proteins or other
RNA structures.

Before we proceed by providing some background on RNA secondary structures as
contact structures and diagrams, we validate our modeling Ansatz. As we shall show in
Section 4, the key lies in a central limit theorem for the number of arcs in biologically
“realistic” RNA secondary structures. Here realistic is tantamount to RNA secondary
structures having minimal free energy. These structures do not contain bonds that force
an extreme bending of the backbone and they contain base pairs organized in stacks of
length at least three. The latter reﬂects the fact that the main contribution of lowering free
energy stems from electron delocalization between stacked bonds (Hunter and Sanders,
1990; ˇSponer et al., 2001, 2013).

The space of minimum free energy (mfe) RNA secondary structures can only be un-
derstood by means of extensive computation. The space of all RNA secondary structures
that satisfy the above mentioned constraints, however, can be mathematically analyzed.
It comes down to the question of whether or not the number of arcs of mfe-structures
can be obtained by uniformly sampling RNA secondary structures satisfying minimum
stack-length three and arc-length four constraints.
In Figure 1 we contrast these two
distributions. The similarity of the two distributions allows us to pass to combinatorics
and thus to prove statements in the larger space.

An RNA sequence is described by its primary structure, a linear oriented sequence of
the nucleotides and can be viewed as a string over the alphabet {A, U, G, C}. An RNA
strand folds by forming hydrogen bonds between pairs of nucleotides according to Watson-
Crick A-U, C-G and wobble U-G base-pairing rules. The secondary structure encodes
this bonding information of the nucleotides irrespective of the actual spacial embedding.
More than three decades ago, Waterman and colleagues pioneered the combinatorics and
prediction of RNA secondary structures (Waterman, 1978, 1979; Smith and Waterman,
1978; Howell et al., 1980; Schmitt and Waterman, 1994; Penner and Waterman, 1993).

3

Fig. 1. The number of arcs in RNA secondary structures: we contrast the
limit distribution of RNA secondary structures having minimum arc-length four
and stack-length three (solid line) with the distribution of mfe-structures (dots),
folded by ViennaRNA (Lorenz et al., 2011) from (uniformly sampled) random
sequences of length 1000. Here n = 1000 to minimize ﬁnite size eﬀects that
would otherwise aﬀect the distribution.

RNA secondary structures can be represented as diagrams, see Fig. 2. A diagram is a
labeled graph over the vertex set {1, . . . , n} whose vertices are arranged in a horizontal
line and arcs are drawn in the upper half-plane. Clearly, vertices and arcs correspond to
nucleotides and base pairs, respectively. The number of nucleotides is called the length of
the structure. The length of an arc (i, j) is deﬁned as j − i and an arc of length k is called
a k-arc. The backbone of a diagram is the sequence of consecutive integers (1, . . . , n)
together with the edges {{i, i + 1} | 1 ≤ i ≤ n − 1}. We shall distinguish the backbone
edge {i, i + 1} from the arc (i, i + 1), which we refer to as a 1-arc. Two arcs (i1, j1) and
(i2, j2) are crossing if i1 < i2 < j1 < j2. An RNA secondary structure is deﬁned as a
diagram satisfying the following three conditions (Waterman, 1978):

(1) non-existence of 1-arcs: if (i, j) is an arc, then j − i ≥ 2,
(2) non-existence of base triples: any two arcs do not have a common vertex,
(3) non-existence of pseudoknots: any two arcs are non-crossing, i.e., for two arcs
(i1, j1) and (i2, j2) where i1 < i2, i1 < j1, and i2 < j2, we have either i1 < j1 <
i2 < j2 or i1 < i2 < j2 < j1.

4

5'

hairpin-loop

U

G

20

G

C

C

U

G

G

C

G

G

C

A

10

U

G

C

C

G

U

G

G

G

G

G

G

G

C

G

C

C

C

C

C

C

C

G

C

30

C

C

A

GG

G

G

G

G

C

U

U

G

C

C

A

C

40

C

A

A

3'

90

stack

U

A

U

G

U

G

C

U

80

C

C

G

C

C

G

70

multi-loop

C

C

60

G G

G

G

G

C

G

C

G

50

G

C

A

A

C

U

A

G

C

(a)

(b)

1

10

20

30

40

50

60

70

80

90

G

G G G G G G C G A U C G G C C C U G G U G G G C C G U C C G G G C U U C A A A C C C G G A G G G G G C U A G C A A C G G C C C C G G G G G G U U C G A U U C C C C C G C C C C C C C

G

G

G

G

G

G

G

G

G

A

A

G

G G G G G A

A

A

A

C

C C C C C G

G

G

G

G

G

A

A A A A A A C

C

C

C

C

C

A

G

G

G

G

G

A

A

A

A

A

A

A

A

C

C C C C A

A

G

G G G A

A A A A A A C

C C C C

C

C

C

C

C

C

C

C

G

G

G

G

G

G

G

G

G

A

A

A A A A A A

A

A

A

A

U U U U U U

G

G

G

G

G

G

U U U U U U U

C

C

C

C

C

C

A

G

G

G

G

G

A

A

A

A

A

A

A

A

U U U U U

A

A

U U U U

C C C C C C C

A A A A

C

C

C

C

C

C

C

C

C

Fig. 2. An RNA secondary structure represented as a contact graph (a) with
hydrogen bonds as red edges and as a diagram (b) having minimum stack-
length 4 and arc-length 5. In (b), we display three compatible sequences hav-
ing the AUCG-ratios (0.088, 0.099, 0.417, 0.396), (0.340, 0.000, 0.330, 0.330) and
(0.296, 0.242, 0.242, 0.220), respectively.

More succintly, an RNA secondary structure expressed as a diagram has exclusively non-
crossig arcs in the upper half-plane. Pairs of nucleotides may form Watson-Crick A-U,
C-G and wobble U-G bonds labeling the above mentioned arcs.

This paper is organized as follows: In Section 2, we provide some basic facts of singular-
ity analysis of power series. In Section 3, we compute the bivariate generating function of
RNA secondary structures of length n having l arcs and derive its asymptotic expansion
as well as the central limit theorem for the distribution of arcs. In Section 4, we analyze
the fraction of RNA secondary structures having compatible sequences and prove our
main results. We conclude with Section 5, where we integrate and discuss our ﬁndings.

2. Singularity analysis

RNA secondary structures as combinatorial objects give rise to generating functions,
i.e. formal power series whose coeﬃcients count the number of structures for given se-
quence length. The estimation of these coeﬃcients will be at the heart of this analysis
and we next discuss some basic facts of how to compute them. The key tool here is singu-
larity analysis: facilitated by Cauchy-integration along certain contours passing close by
the dominant critical point(s). Singularity analysis is described in great detail in the book

5

by Flajolet and Sedgewick (Flajolet and Sedgewick, 2009). In the following, we showcase
all facts needed to exact the asymptotics of coeﬃcients from our generating functions.

Let f (x) = Pn≥0 an xn be a combinatorial generating function. We are interested in
the calculation of an in terms of their exponential growth rate, γ and their subexponential
factor P (n), that is, an ∼ P (n) γn. The key for obtaining the asymptotic information
about the coeﬃcients of a generating function is to locate its dominant singularities.
For the particular case of power series with nonnegative coeﬃcients with a radius of
convergence R > 0, Pringsheim’s theorem (Flajolet and Sedgewick, 2009; Titchmarsh,
1939) guarantees a (unique) positive, real, dominant singularity at z = R. In our case
all generating functions are by construction combinatorial, whence we always have such
a positive real, dominant, singularity.

A function f (x) is ∆ρ analytic at its dominant singularity x = ρ, if it is analytic in
some domain ∆ρ(φ, d) = {x | |x| < d, x 6= ρ, |Arg(x − ρ)| > φ}, for some φ, d, where
d > |ρ| and 0 < φ < π

2 . We set

(f (x) = O (g(x)) as x → ρ) ⇐⇒ (f (x)/g(x) is bounded as x → ρ) ,

Noting that for any γ ∈ C \ 0,

[xn]f (x) = γn[xn]f(cid:18) x
γ(cid:19) ,

we can, without loss of generality, reduce our analysis to the case where x = 1 is the unique
dominant singularity. The following transfer-theorem allows us to derive the asymptotics
of coeﬃcients from the asymptotic expansion of its generating function around its domi-
nant singularity.

Theorem 1 (Flajolet and Sedgewick (2009), Theorem VI.3, pp. 390). Let f (x) be a ∆1
analytic function at its unique dominant singularity x = 1. Let

g(x) = (1 − x)α logβ(cid:18) 1

1 − x(cid:19) , α, β ∈ R.

That is we have in the intersection of a neighborhood of 1

Then we have

f (x) = O(g(x))

for x → 1.

[xn]f (x) = O ([xn]g(x)) .

6

Theorem 2 (Flajolet and Sedgewick (2009)). Suppose f (x) = (1 − x)−α, α ∈ C \ Z≤0,
then

[xn]f (x) ∼

nα−1

α(α − 1)

Γ(α)(cid:20)1 +
α2(α − 1)2(α − 2)(α − 3)

2n

+

48n3

α(α − 1)(α − 2)(3α − 1)

+

24n2

+ O(cid:18) 1

n4(cid:19)(cid:21) .

The next result extracts asymptotics of generating functions, satisfying polynomial
equations. It is based on the method of Newton polygons and derives the Newton-Puiseux
expansion and the resultant of two polynomials to locate the dominant singularity. The
j=1(z − βj) is given

resultant of two polynomials f (z) = anQn

i=1(z − αi) and g(z) = bmQm

by

n

m

R(f, g, z) = am

n bn

m

Yi=1

Yj=1
(αi − βj).

Theorem 3. Let z(x) =Pn≥0 znxn be a generating function, analytic at 0, that satisﬁes
the polynomial equation Φ(x, z) = 0. Let ∆(x) = R(cid:0)Φ(x, z), ∂

(1) there exist positive numbers ρ and π = z(ρ), such that ρ is a root of the resultant
∆(x) and (ρ, π) satisﬁes the system of equations,

∂z Φ(x, z), z(cid:1). Suppose

(2.1)

Φ(ρ, π) = 0, Φz(ρ, π) = 0,

(2) Φ(x, z) satisﬁes the conditions:

(2.2)

Φx(ρ, π) 6= 0, Φzz(ρ, π) 6= 0,

(3) z(x) is aperiodic, i.e., there exist three indices i < j < k such that zizjzk 6= 0 and
gcd(j − i, k − i) = 1.

Then ρ is the dominant singularity of z(x) and z(x) has the following expansion at ρ

(2.3)

z(x) = π + δ(ρ − x)

1

2 + O(ρ − x),

Furthermore the coeﬃcients of z(x) satisfy

for some nonxero constant δ.

for some constant c > 0.

[xn]z(x) ∼ c n− 3

2 ρ−n, n → ∞,

The proof can be found in Flajolet and Sedgewick (2009) or alternatively in Hille (1962,
pp. 103). The key point here is, that when applying Newton’s polygon method to deter-
mine the type of expansion of z(x): conditions (1) and (2) guarantee the ﬁrst exponent of
x to be 1
2 . The asymptotics of the coeﬃcients follows then from eq. (2.3) as an application
of the transfer theorem 1 and theorem 2.

7

For a bivariate generating function F (x, y), satisfying a functional equation, the next
theorem allows us to obtain key information about the singular expansion of F (x, y),
considering the latter as a univariate generating function parameterized by y.

Theorem 4 (Flajolet and Sedgewick (2009)). Let F (x, y) be a bivariate function that is
analytic at (0, 0) and has non-negative coeﬃcients. Suppose that F (x, y) is one of the
solutions z of a polynomial equation

Φ(x, y, z) = 0,

where Φ is a polynomial of degree ≥ 2 in z, such that Φ(x, 1, z) satisﬁes the conditions of
Theorem 3. Let

∆(x, y) = R(cid:18)Φ(x, y, z),

∂
∂z

Φ(x, y, z), z(cid:19)

and let ρ be the root of ∆(x, 1), such that z(x) := F (x, 1) is singular at x = ρ and
z(ρ) = π. Suppose there exists some ρ(y) being the unique root of the equation

∆(ρ(y), y) = 0,

analytic at 1 and such that ρ(1) = ρ.

Then F (x, y) has the singular expansion

F (x, y) = π(y) + δ(y) (ρ(y) − x)

1

2 (1 + o(1)) ,

where π(y) and δ(y) are analytic at 1 such that π(1) = π and δ(1) 6= 0. In addition we
have

[xn]F (x, y) = c(y) n− 3

2 ρ(y)−n(cid:18)1 + O(cid:18) 1

n(cid:19)(cid:19) ,

uniformly for y restricted to a small neighborhood of 1, where c(y) is continuous and
nonzero near 1.

Theorem 4 is implied by Proposition IX. 17 and Theorem IX. 12 of Flajolet and Sedgewick

(2009).

We shall end this section by stating the following central limit theorem due to Bender

(Bender, 1973):

Theorem 5 (Bender (1973)). Suppose we are given the bivariate generating function

f (x, u) = Xn,t≥0

f (n, t) xn ut,

where f (n, t) ≥ 0 and f (n) = Pt f (n, t). Let Xn be a r.v. such that P(Xn = t) =

f (n, t)/f (n). Suppose

[xn]f (x, es) = c(s) nα γ(s)−n(cid:18)1 + O(cid:18) 1

n(cid:19)(cid:19) ,

8

uniformly in s in a neighborhood of 0, where c(s) is continuous and nonzero near 0, α is
a constant, and γ(s) is analytic near 0.

Then there exists a pair (µ, σ) such that the normalized random variable

X∗n =

Xn − µ n
√n σ2

,

converges in distribution to a Gaussian variable with a speed of convergence O(n− 1
is we have

2 ). That

P (X∗n < x) =

lim
n→∞

where µ and σ2 are given by

1

√2πZ x

−∞

e− 1

2 t2

dt,

µ = −

γ′(0)
γ(0)

γ(0)(cid:19)2
and σ2 =(cid:18)γ′(0)

γ′′(0)
γ(0)

.

−

3. RNA secondary structures

We consider secondary structures subject to minimum arc-length restrictions, arising
from the rigidity of the backbone. RNA secondary structures having minimum arc-length
two were studied by Waterman (Waterman, 1978). Arguably, the most realistic cases is
λ = 4 (Stein and Waterman, 1979), and RNA folding algorithms, generating minimum
free energy structures, implicitly satisfy this constraint1 for energetic reasons.

A stack of length r is a maximal sequence of ”parallel” arcs, ((i, j), (i+1, j−1), . . . , (i+
(r − 1), j − (r − 1))). Stacks of length 1 are energetically unstable and we ﬁnd typically
stacks of length at least two or three in biological structures (Waterman, 1978). A sec-
ondary structure, S, is r-canonical if its stack-length satisﬁes ≥ r. An RNA sequence is
compatible with a structure S, if and only if for any S-arc (i, j), the pair (xi, xj) forms a
base pair (Reidys et al., 1997).

A rainbow is an arc connecting the ﬁrst and last vertices in a structure. A secondary
structure is called reducible if it does not contain a rainbow. Let s[r]
λ (n)
denote the numbers of r-canonical secondary structures and reducible secondary struc-
tures of n nucleotides with minimum arc-length λ, respectively. Let furthermore s[r]
λ (n, l)
and t[r]
λ (n, l) denote the numbers of r-canonical secondary structures and reducible sec-
ondary structures, ﬁltered by the number of arcs. Let S[r]
λ (n, l)xnyl and
T[r]

λ (n, l)xnyl denote the corresponding bivariate generating functions.

λ (x, y) = Pn,l s[r]

λ (n) and t[r]

λ (x, y) =Pn,l t[r]

First we compute the generating function S[r]

λ (x, y).

1each hairpin loop contains at least three unpaired bases

Theorem 6. For any λ, r ∈ N, the generating function S[r]

λ (x, y) satisﬁes the functional

equation

9

(3.1)

where

(x2y)rS[r]

λ (x, y)2 − B[r]

λ (x, y) S[r]

λ (x, y) + A[r](x, y) = 0,

A[r](x, y) = 1 − x2y + (x2y)r,
B[r]
λ (x, y) = (1 − x)A[r](x, y) + (x2y)r

xi.

λ−2

Xi=0

Explicitly, we have

S[r]
λ (x, y) =

(3.2)

S[r]
λ (x, y) =

A[r](x, y)
B[r]
λ (x, y)

B[r]

λ (x, y) −qB[r]

λ (x, y)2 − 4(x2y)rA[r](x, y)
2(x2y)r
C  (x2y)rA[r](x, y)
λ (x, y)2 ! ,

B[r]

,

where C(x) denotes the generating function for the Catalan numbers and is given by
1−√1−4x

. In particular, for r = 1,

2x

(3.3)

s[1]
λ (n, l) =

l

Xk=1

N(l, k)(cid:18)n − (λ − 1)k

2l

(cid:19),

where N(l, k) = 1
l edges with k leaves.

k(cid:1)(cid:0) l
l(cid:0) l
k−1(cid:1) is the Narayana number, counting the number of plane trees of

Proof. First we derive a functional equation satisﬁed by S[r]
λ (x, y) via a
decomposition for an r-canonical secondary structure with minimum arc-length λ. Any
given structure must belong to one of the following three classes:

λ (x, y) and T[r]

(1) the empty structure it corresponds to the coeﬃcient 1;
(2) the collection of structures, starting with an unpaired vertex, are counted by

xS[r]

λ (x, y);

(3) structures starting with a paired vertex induce a maximum stack containing this
base pair, and two segments, one being the nested substructure and the other the
concatenated substructure. An arc corresponds to x2y and a stack of size at least
r corresponds to (x2y)r
1−x2y . The nested segment must by construction be reducible
and contains at least λ − 1 vertices, as a result of the arc-length restriction. Since
any segment with at most λ − 2 vertices corresponds to the term Pλ−2
i=0 xi, the

10

ø +

+

Fig. 3. The decomposition of secondary structure and irreducible structure (re-
ducible structures are colored in blue).

nested segment gives rise to T[r]
rise to the term S[r]

λ (x, y). Thus we arrive at

i=0 xi. The concatenated segment gives

λ (x, y)−Pλ−2
λ (x, y)(cid:16)T[r]
λ (x, y) −

S[r]

(x2y)r
1 − x2y

λ−2

Xi=0

xi(cid:17).

The decomposition is illustrated in Fig. 3. Accordingly we obtain the functional equation:

(3.4)

S[r]
λ (x, y) = 1 + xS[r]

λ (x, y) +

(x2y)r
1 − x2y

S[r]

λ (x, y)(cid:16)T[r]

λ (x, y) −

λ−2

Xi=0

xi(cid:17).

λ (x, y) and T[r]

Now we decompose an irreducible secondary structure deriving a second functional equa-
tion, relating S[r]
λ (x, y). Given an irreducible structure, it can decomposed
as a maximum stack containing its rainbow and the nested substructure, see Fig. 3. The
nested segment has to be reducible and has length at least λ− 1, i.e. T[r]
i=0 xi.
λ (x, y) − T[r]
The irreducible structures have the generating function S[r]
xi(cid:17).

λ (x, y)−Pλ−2

1 − x2y(cid:16)T[r]

S[r]
λ (x, y) − T[r]

λ (x, y), whence

λ (x, y) −

λ (x, y) =

(x2y)r

(3.5)

λ−2

Xi=0

Solving eq. (3.5) for T[r]
λ (x, y) and substituting the solution into eq. (3.4), we obtain
eq. (3.1) which immediately implies eqs. (3.2).
It remains to prove eq. (3.3). Given
a secondary structure S having n vertices and l arcs, removing any unpaired vertices
induces the diagram S′, i.e. a matching. Suppose S′ has k 1-arcs. It is well-known that
the set of matchings with l arcs and k 1-arcs corresponds to the set of plane trees of l
k(cid:1)(cid:0) l
l(cid:0) l
edges with k leaves, which is counted by the Narayana number N(l, k) = 1
k−1(cid:1) (see
e.g. Stanley (2001)). In view of minimum arc-length constraints, in order to recover S
from S′, we need to guarantee that each 1-arc contains at least λ − 1 unpaired vertices.
Accordingly, the number of all possible insertions is given by (cid:0)n−(λ−1)k
(cid:1), i.e eq. (3.3). (cid:3)
l(cid:0)n−l
l+1(cid:1)(cid:0)n−l−1
l−1 (cid:1) proved

in Schmitt and Waterman (1994) by establishing a bijection between secondary structures
and linear trees.

Remark: Eq. (3.3) generalizes the closed formula s[1]

2 (n, l) = 1

2l

Interpreting the indeterminant y as a parameter, we consider S[r]

λ (x, y) as a univari-
ate powerseries. One key question then is to compute the asymptotic behaviour of the
coeﬃcients.
Theorem 7. For 1 ≤ λ ≤ 4 and 1 ≤ r ≤ 3, the coeﬃcients of S[r]

λ (x, y) are asymptotically

given by

11

[xn]S[r]

λ (x, y) = c[r]

(3.6)
as n → ∞, uniformly, for y restricted to a small neighborhood of 1, where c[r]
uous and nonzero near 1, and ρ[r]
4(x2y)rA[r](x, y) = 0, for y in a neighborhood of 1.

λ (y)(cid:1)−n (cid:0)1 + O(n−1)(cid:1),
2(cid:0)ρ[r]

λ (y) is the minimal positive, real solution of B[r]

λ (y)n− 3

λ (y) is contin-
λ (x, y)2 −

In particular, we have

1 − 2√y
1 − 4y
Proof. We shall employ Theorem 4.

ρ[1]
1 (y) =

,

ρ[1]
2 (y) =

1 + 2√y −p1 + 4√y

2y

.

Step 1: we consider ﬁrst the monovariate power series S[r]
In view of eq. (3.1) of Theorem 6 and setting y = 1, we see that S[r]

λ (x, 1):

λ (x, 1) satisﬁes the

equation

Φ(x, S[r]

λ (x, 1)) = x2rS[r]

λ (x, y)2 − B[r]

λ (x, 1) S[r]

λ (x, 1) + A[r](x, 1) = 0,

λ (x, 1)z + A[r](x, 1). Next we observe that

where Φ(x, z) = x2rz2 − B[r]
∆(x) = R(cid:18)Φ(x, z),

∂
∂z

λ (x, 1)2 − 4x2rA[r](x, 1)),

Φ(x, z), z(cid:19) = −x2r(B[r]
mQn
j=1(αi − βj).

i=1Qm

n bn
j=1(z − βj), R(f, g, z) = am

where R(f, g, z) is the resultant of two polynomials f (z) = anQn
bmQm
Ad (1), we inspect for 1 ≤ λ ≤ 4 and 1 ≤ r ≤ 3, that there exist positive numbers
ρ[r]
λ and π[r]
λ (ρ[r]
λ , π[r]
λ )
and furthermore Φ(ρ[r]
λ is the minimal
positive real solution of the ∆(x)-divisor B[r]

λ is a root of the resultant ∆(x) and (ρ[r]

λ , 1), such that ρ[r]
λ , π[r]

i=1(z − αi) and g(z) =

λ ) = 0 as well as Φz(ρ[r]

λ ) = 0. In fact, ρ[r]

λ = S[r]

λ , π[r]

λ (x, 1)2 − 4x2rA[r](x, 1).

As for (2), we verify Φx(ρ[r]
Ad (3), for any λ there exists some i, such that s[r]

λ ) 6= 0 and Φzz(ρ[r]

λ , π[r]

λ , π[r]

λ ) 6= 0.
λ (i), s[r]

i.e. S[r]

λ (x, 1) is aperiodic.

λ (i + 1), s[r]

λ (i + 2) 6= 0,

Theorem 3 implies that ρ[r]

of S[r]

λ (x, 1) is given by

λ is the dominant singularity and that the singular expansion

S[r]
λ (x, 1) = π[r]

λ + δ[r]

λ (cid:0)ρ[r]

λ − x(cid:1)

1

2 (1 + o(1)),

12

where δ[r]

λ is a positive real number.

Step 2: we are now in position to employ Theorem 4. By eq. (3.1), S[r]

λ (x, y) satisﬁes

(x2y)rS[r]

λ (x, y)2 − B[r]

λ (x, y) S[r]

λ (x, y) + A[r](x, y) = 0

and Φ(x, y, z) = (x2y)rz2 − B[r]
∆(x, y) = R(cid:0)Φ(x, y, z), ∂

λ (x, y)z + A[r](x, y) is a polynomial in z of degree two.
is a root of
∆(x, 1). Step 1 implies that z(x) = S(x, 1) has the unique dominant singularity ρλ
and z(ρ) = πλ. We compute

∂z Φ(x, y, z), z(cid:1) satisﬁes ∆(x, 1) = ∆(x) and ρ[r]

λ

∂
∂z

Φ(x, y, z), z(cid:19) = −(x2y)r(B[r]

∆(x, y) = R(cid:18)Φ(x, y, z),
and check that there exists for 1 ≤ λ ≤ 4 and 1 ≤ r ≤ 3 a unique ρ[r]
∆(ρ[r]
λ (y), y) = 0 and ρ[r]
B[r]
λ (x, y)2 − 4(x2y)rA[r](x, y) = 0 for y in a neighborhood of 1.
By Theorem 4, the singular expansion of S[r]
λ (x, y) is given by

λ (1) = ρ[r]

λ . ρ[r]

λ (y), such that
λ (y) is the minimal, positive, real solution of

λ (x, y)2 − 4(x2y)rA[r](x, y))

S[r]
λ (x, y) = π[r]

λ (y) + δ[r]

λ (y)(cid:0)ρ[r]

λ (y) − x(cid:1)

1

2 (1 + o(1)),

λ (y) and δ[r]

λ (y) are analytic at 1 and δ[r]

λ (1) is a positive, real number and fur-

where π[r]
thermore

[xn]S[r]

λ (x, y) = c[r]

λ (y)n− 3

λ (y)(cid:1)−n (cid:0)1 + O(n−1)(cid:1).
2(cid:0)ρ[r]

(cid:3)

We next analyze the random variable Y[r]
secondary structures. By construction we have

λ,n, counting the numbers of arcs in RNA

P(Y[r]

λ,n = l) =

s[r]
λ (n, l)
s[r]
λ (n)

,

where l = 0, 1, . . . ,⌊ n+1−λ

2

⌋.

Theorem 7 and Theorem 4 immediately imply

Theorem 8. There exists a pair (µ[r]

λ , σ[r]

λ ) such that the normalized random variable

Y[r],∗n,λ =

Y[r]
λ,n − µ[r]
λ n
qn (σ[r]
λ )2

converges in distribution to a Gaussian variable with a speed of convergence O(n− 1
is, we have

2 ). That

13

(3.7)

lim
n→∞

P


Y[r]
λ,n − µ[r]
λ n
qn (σ[r]
λ )2

< x
 =

1

√2πZ x

−∞

e− 1
2 t2

dt ,

where µ[r]

λ and σ[r]

λ are given by

(3.8)

µ[r]
λ = −

θ′(0)
θ(0)

,

(σ[r]

θ(0)(cid:19)2
λ )2 =(cid:18)θ′(0)

θ′′(0)
θ(0)

,

−

where θ(s) = ρ[r]

λ (es).

In Table 1, we list the values of µ[r]

λ and (σ[r]

λ )2 for 1 ≤ λ ≤ 4 and 1 ≤ r ≤ 3.

Remark. The expectation and variance of the number of arcs in secondary structures
has been studied computationally in Fontana et al. (1993) for mfe structures and com-
binatorially in Hofacker et al. (1998) for 1-canonical structures with minimum arc-length
λ. In Jin and Reidys (2008) more general results on local and global limit theorems for
k-noncrossing structures are proved. These imply, setting k = 2, Theorem 8. The above
approach, in light of the combinatorial proof of the recursion in Theorem 6, provides an
elementary derivation.

Table 1. The central limit theorem for the number of arcs. We list the
values of µ[r]

λ )2 derived from eq. (3.8).

λ and (σ[r]

r = 1

r = 2

r = 3

µ[r]

(σ[r]

µ[r]

λ

(σ[r]

λ )2

λ

λ )2

λ )2
λ = 1 0.3333 0.0556 0.3484 0.0719 0.3582 0.0852
λ = 2 0.2764 0.0447 0.3172 0.0643 0.3364 0.0791
λ = 3 0.2500 0.0442 0.2983 0.0631 0.3215 0.0778
λ = 4 0.2367 0.0469 0.2865 0.0651 0.3113 0.0793

λ

(σ[r]

µ[r]

Theorem 8 follows from Theorem 7 and Theorem 4, setting f (x, es) = S[r]

λ (x, es).

We display the distribution of the numbers of arcs for sequence length n = 400 in Fig. 4,
observing that the expected number of arcs drops from 111 to 95, when increasing the
minimum arc-length from 2 to 4.

14

Fig. 4. The distribution of the number of arcs of 1-canonical secondary struc-
tures of length n = 400 for λ = 2(R), λ = 3(M), λ = 4(L).

4. Main results

4.1. Structures having Purine-Pyrimidine base pairs. We consider RNA struc-
tures, S, over sequences having only two types of nucleobases: purines (R) and pyrimidines
(Y ), having the base pairs (R, Y ) and (Y, R).

For any p ∈]0, 1[ and n ∈ N, let s[r]

p,λ(n) denote the number of r-canonical RNA secondary
structures for which there exists at least one compatible sequence, containing ⌊pn⌋ purine
bases and ⌈(1 − p)n⌉ pyrimidine bases, respectively. Let furthermore s[r]
p,λ(n, l) denote the
corresponding number of structures, ﬁltered by the number of arcs.

Remark 1. In view of ⌊pn⌋/n = p + O(n−1), s[r]
p,λ(n, l), count in the limit
of large sequence lengths, secondary structures of sequences whose percentage of purine
bases equals p.

p,λ(n) or s[r]

Proposition 1. For any n, r, l, λ ∈ N and p ∈]0, 1[, we have

(4.1)

s[r]
p,λ(n, l) = s[r]
s[r]
p,λ(n, l) = 0

λ (n, l)

if l ≤ min(⌊pn⌋,⌈(1 − p)n⌉),
if l > min(⌊pn⌋,⌈(1 − p)n⌉,

and

(4.2)

s[r]
p,λ(n) =

min(⌊pn⌋,⌈(1−p)n⌉)

Xl=0

s[r]
λ (n, l).

15

Proof. We shall show that any such structure having l arcs is counted by s[r]
p,λ(n, l) iﬀ
l ≤ ⌊pn⌋ and l ≤ ⌈(1 − p)n⌉. Given a structure S having l arcs, each arc corresponds to
a pair (R, Y ) or (Y, R) for any compatible sequence, while each unpaired vertex could be
either R or Y . Accordingly, in any compatible sequence, the number of purine bases is
at least l. For S to be counted by s[r]
p,λ(n, l) the existence of l arcs thus implies l ≤ ⌊pn⌋.
Since we have ⌈(1 − p)n⌉ pyrimidine bases in such a sequence, we observe for the same
reason l ≤ ⌈(1 − p)n⌉. In case of l > min(⌊pn⌋,⌈(1 − p)n⌉) we either have not enough
purine or pyrimidine bases, whence s[r]

p,λ(n, l) = 0 and the proposition follows.

(cid:3)

Theorem 9. For 1 ≤ λ ≤ 4, 1 ≤ r ≤ 3, p ∈]0, 1

2] and n ∈ N, we have

(4.3)

s[r]
p,λ(n)
s[r]
λ (n)

=

1

√2πZ

)√n

[r]
(p−µ
λ
[r]
σ
λ

−∞

e− 1
2 t2

dt + O(n− 1

2 ),

where µ[r]

λ , σ[r]

λ are the mean and standard deviation of Y[r]

λ,n, respectively.

Equivalently, for p ∈]µ[r]
λ , 1

2], a random structure a.a.s. has a compatible sequence with
λ [, a.a.s. no random structure has a

nucleotide ratio p. Conversely, in case of p ∈]0, µ[r]

compatible sequence.

Proof. For p ∈]0, 1

2], we have

s[r]
p,λ(n)
s[r]
λ (n)

=

min(⌊pn⌋,⌈(1−p)n⌉)

Xl=0

s[r]
λ (n, l)
s[r]
λ (n)

=

⌊pn⌋

Xl=0

s[r]
λ (n, l)
s[r]
λ (n)

= P(Y[r]

λ,n ≤ ⌊pn⌋),

where the ﬁrst equation employs eq. (4.1). Theorem 8 allows us to estimate P(Y[r]
by the integral of the Gaussian density function with an O(n− 1
setting x = ⌊pn⌋−µ
λ √n
σ[r]

in eq. (3.7), we obtain

λ,n ≤ ⌊pn⌋)
2 ) error term. Speciﬁcally,

[r]
λ n

P(Y[r]

λ,n ≤ ⌊pn⌋) =

[r]
⌊pn⌋−µ
λ
√n

σ

[r]
λ

1

√2πZ

−∞

n

e− 1
2 t2

dt+O(n− 1

2 ) =

)√n

[r]
(p−µ
λ
[r]
σ
λ

−∞

1

√2πZ

e− 1
2 t2

dt+O(n− 1

2 ),

16

where the last equality is implied by

)√n

[r]
(p−µ
λ
[r]
σ
λ

e− 1

2 t2

(cid:12)(cid:12)(cid:12)Z

−∞

[r]
⌊pn⌋−µ
λ
√n

σ

[r]
λ

dt −Z

−∞

n

e− 1
2 t2

dt(cid:12)(cid:12)(cid:12)

n

[r]
pn−µ
n
λ
√n
[r]
σ
λ
[r]
⌊pn⌋−µ
λ
√n

=(cid:12)(cid:12)(cid:12)Z
1
λ √n · e− 1
σ[r]

≤

[r]
λ

σ

e− 1
2 t2

dt(cid:12)(cid:12)(cid:12)
2 t2(cid:12)(cid:12)(cid:12)t=0

= O(n− 1

2 ),

whence eq. (4.3). For p ∈]µ[r]
λ , 1
2]
1
√2πZ

s[r]
p,λ(n)
λ (n) ≥
s[r]

−∞

ǫ√n
[r]
σ
λ

e− 1

2

t2

dt + O(n− 1

2 ) → 1,

as n → ∞,

implying that asymptotically, almost surely any structure has a compatible sequence with
nucleotide ratio p and the theorem follows.
(cid:3)

For any Gaussian distributed random variable, X, we have

P(µ − 2σ ≤ X ≤ µ + 2σ) =

P(µ − 3σ ≤ X ≤ µ + 3σ) =

1

σ√2πZ µ+2σ
σ√2πZ µ+3σ

µ−3σ

µ−2σ

1

e− (t−µ)2

2σ2 ≈ 0.9545,

e− (t−µ)2

2σ2 ≈ 0.9973,

i.e. the fraction of its values within two and three standard deviations away from its
mean is approximately 0.9545 and 0.9973, respectively.
In Fig. 5 we display the limit
distribution.

4.2. Watson-Crick base pairs. We next consider RNA secondary structures realized by
sequences composed by the four nucleotides A, U, C, G, assuming Watson-Crick (A-U,
C-G) base pairs.

For any n ∈ N and p = (p1, p2, p3, p4), where pi ∈]0, 1[ and P4
p,λ(n)
denote the number of r-canonical RNA secondary structures for which there exists at
least one compatible AUCG-sequence containing ⌊p1n⌋, ⌊p2n⌋, ⌊p3n⌋, and n − ⌊p1n⌋ −
⌊p2n⌋ − ⌊p3n⌋ nucleotides, respectively. Let s[r]
p,λ(n, l) be deﬁned analogously. Obviously,
as observed for two letter sequences, as the sequence length approaches inﬁnity,

i=1 pi = 1, let s[r]

(cid:16)⌊p1n⌋

n

, ⌊p2n⌋

n

, ⌊p3n⌋

n

,

n − (⌊p1n⌋ + ⌊p2n⌋ + ⌊p3n⌋)

n

Proposition 2. For any n, r, l, λ ∈ N and p, let

(cid:17) = (p1, p2, p3, p4) + O(n−1).

l0 = min(⌊p1n⌋,⌊p2n⌋) + min(⌊p3n⌋, n − (⌊p1n⌋ + ⌊p2n⌋ + ⌊p3n⌋)).

17

as a function of p for GC-sequences of length n = 400 and

Fig. 5. LHS:

s[r]
p,λ(n)
s[r]
λ (n)

3-canonical structures subject to minimum arc-length restrictions λ = 2(green),

3(blue) and 4(red), respectively. RHS:

as a function of p for GC-sequences

of length n = 400 and r-canonical structures with minimum arc-length 4 subject
to minimum stack-length restrictions r = 1(green), 2(blue) and 3(red), respec-

s[r]
p,λ(n)
s[r]
λ (n)

tively.

Then we have

(4.4)

and

(4.5)

p,λ(n, l) = s[r]
s[r]
s[r]
p,λ(n, l) = 0

λ (n, l)

if l ≤ l0,
otherwise,

s[r]
p,λ(n) =

s[r]
λ (n, l).

l0

Xl=0

Proof. We prove that any structure having l arcs is counted by s[r]
p,λ(n, l) if l ≤ l0. Given
a structure S having l arcs, each arc corresponds to an A-U pair or a C-G pair for any
compatible sequence, while each unpaired vertex could be either one of the four bases.
Suppose we have l1 A-U and l2 C-G base pairs. Then l1 ≤ ⌊p1n⌋ and since ⌊p2n⌋ is
the number of U nucleotides, we have l1 ≤ ⌊p2n⌋. The case of C-G pairs is treated
analogously. Thus if l ≤ l0 S is counted by s[r]
p,λ(n, l). We inspect that then for any l′ ≤ l
any structure containing l′ arcs is counted by s[r]

p,λ(n, l).

18

We thus arrive at the following integer linear programming problem:

maximize:

subject to

and

l = l1 + l2
l1 ≤ ⌊p1n⌋, l1 ≤ ⌊p2n⌋, l2 ≤ ⌊p3n⌋, l2 ≤ n − (⌊p1n⌋ + ⌊p2n⌋ + ⌊p3n⌋)
l1 ≥ 0, l2 ≥ 0, l1, l2 ∈ Z.

Here l0 = min(⌊p1n⌋,⌊p2n⌋) + min(⌊p3n⌋, n− (⌊p1n⌋ +⌊p2n⌋ +⌊p3n⌋)) is a solution that is
by construction unique. In case of l > l0, l is of the form l = l1 + l2 such that l1 ≥ ⌊p1n⌋
or l1 ≥ ⌊p2n⌋ or l2 ≥ ⌊p3n⌋, or l2 ≥ n − (⌊p1n⌋ + ⌊p2n⌋ + ⌊p3n⌋). This means however,
that we have not enough of one type of the four bases to satisfy all l base pairings of the
structure, whence s[r]
(cid:3)

p,λ(n, l) = 0.

Theorem 10. Given any 1 ≤ λ ≤ 4, 1 ≤ r ≤ 3, any n ∈ N and p, let p0 = min(p1, p2) +
min(p3, p4). Then we have

(4.6)

s[r]
p,λ(n)
s[r]
λ (n)

=

)√n

[r]
(p0−µ
λ
[r]
σ
λ

e− 1
2 t2

dt + O(n− 1

2 ),

1

√2πZ

−∞

where µ[r]

λ , σ[r]

λ are the mean and standard deviation of Y[r]
λ,n.

Equivalently, for p0 ∈]µ[r]
λ , 1

nucleotide ratio p. Conversely, in case of p0 ∈]0, µ[r]

compatible sequence.

2], a random structure a.a.s. has a compatible sequence with
λ [, a.a.s. no random structure has a

Proof. Given p = (p1, p2, p3, p4), analogous to the proof of Theorem 9, we derive by
eq. (4.4)

s[r]
p,λ(n)
s[r]
λ (n)

=

=

l0

Xl=0
√2πZ

1

−∞

s[r]
λ (n, l)
s[r]
λ (n)

= P(Y[r]

λ,n ≤ l0) =

[r]
l0−µ
n
λ
√n
[r]
σ
λ

e− 1
2 t2

dt + O(n− 1
2 )

1

√2πZ

−∞

n

[r]
p0n−µ
λ
√n
[r]
λ

σ

e− 1

2 t2

dt + O(n− 1

2 ),

where the last equality is implied by the inspecting |l0 − p0n| ≤ 2 and

[r]
l0−µ
n
λ
√n
[r]
σ
λ

e− 1

2 t2

−∞

n

[r]
p0n−µ
λ
√n
[r]
λ

σ

e− 1

2 t2

dt −Z

−∞

(cid:12)(cid:12)(cid:12)Z

dt(cid:12)(cid:12)(cid:12)

=(cid:12)(cid:12)(cid:12)Z

[r]
l0−µ
n
λ
√n
[r]
σ
λ
[r]
p0n−µ
λ
√n
[r]
λ

σ

n

e− 1

2 t2

dt(cid:12)(cid:12)(cid:12) ≤

2
λ √n · e− 1
σ[r]

2 t2(cid:12)(cid:12)(cid:12)t=0

= O(n− 1

2 ),

(cid:3)

whence eq. (4.6) and the theorem is proved.

4.3. Watson-Crick and wobble base pairs. We consider RNA secondary structures
over four letter sequences, having Watson-Crick (A-U, C-G) and wobble (U-G) base
pairs.

19

For any n ∈ N and p = (p1, p2, p3, p4), where pi ∈]0, 1[ and P4
p,λ(n)
denote the number of RNA secondary structures for which there exists at least one com-
patible AUCG-sequence containing ⌊p1n⌋, ⌊p2n⌋, ⌊p3n⌋, and n − ⌊p1n⌋ − ⌊p2n⌋ − ⌊p3n⌋
nucleotides, respectively. Let ¯s[r]

p,λ(n, l) be this quantity, ﬁltered by the number of arcs.

i=1 pi = 1, let ¯s[r]

Proposition 3. For any n, r, l, λ ∈ N and p , let

¯l0 = min{min{⌊p1n⌋,⌊p2n⌋} + n − (⌊p1n⌋ + ⌊p2n⌋ + ⌊p3n⌋),
min{⌊p3n⌋, n − (⌊p1n⌋ + ⌊p2n⌋ + ⌊p3n⌋)} + ⌊p2n⌋}.

Then we have

(4.7)

and

(4.8)

¯s[r]
p,λ(n, l) = s[r]
¯s[r]
p,λ(n, l) = 0

λ (n, l)

if l ≤ ¯l0,
otherwise ,

¯s[r]
p,λ(n) =

s[r]
λ (n, l).

¯l0

Xl=0

Proof. We ﬁrst prove that any structures having l arcs are counted by ¯s[r]

p,λ(n, l) if l ≤ ¯l0.
Suppose we have l1 A-U pairs, l2 C-G pairs and l3 U-G pairs. In order to be counted
by ¯s[r]
p,λ(n, l), the number of U is at least l1 + l3, i.e. we have, l1 + l3 ≤ ⌊p2n⌋ and since we
have ⌊p1n⌋ A nucleotides l1 ≤ ⌊p1n⌋. The situation for C and G is analogous. As long
as l1, l2 and l3 satisfy these conditions, we can always construct a compatible p-sequence
for a structure S having l = l1 + l2 + l3 arcs. Clearly, this holds for any l′ < l, whence a
structure having l arcs is counted by ¯s[r]
p,λ(n, l) if the number of arcs is not greater than
the maximum of l1 + l2 + l3 subject to the constraints of the following integer linear
programming problem:

maximize:

subject to

and

l = l1 + l2 + l3
l1 ≤ ⌊p1n⌋, l1 + l3 ≤ ⌊p2n⌋, l2 ≤ ⌊p3n⌋, l2 + l3 ≤ n − (⌊p1n⌋ + ⌊p2n⌋ + ⌊p3n⌋)
l1, l2, l3 ≥ 0, l1, l2, l3 ∈ Z.

Its unique solution is

¯l0 = min{min{⌊p1n⌋,⌊p2n⌋} + n − (⌊p1n⌋ + ⌊p2n⌋ + ⌊p3n⌋),
min{⌊p3n⌋, n − (⌊p1n⌋ + ⌊p2n⌋ + ⌊p3n⌋)} + ⌊p2n⌋}

20

and in case of l > ¯l0, we observe as in Proposition 2, that we have not enough of at least
one of the four nucleotide types, whence ¯s[r]
(cid:3)

p,λ(n, l) = 0 and the proposition follows.

As a result we derive

Theorem 11. For 1 ≤ λ ≤ 4, 1 ≤ r ≤ 3, n ∈ N and p, let ¯p0 = min(min(p1, p2) +
p4, min(p3, p4) + p2). Then we have

(4.9)

¯s[r]
p,λ(n)
s[r]
λ (n)

=

)√n

[r]
( ¯p0−µ
λ
[r]
σ
λ

e− 1
2 t2

dt + O(n− 1

2 ),

1

√2πZ

−∞

where µ[r]

λ , σ[r]

λ are the mean and standard deviation of Y[r]
λ,n.

Equivalently, for ¯p0 ∈]µ[r]
λ , 1

nucleotide ratio p. Conversely, in case of ¯p0 ∈]0, µ[r]

compatible sequence.

2], a random structure a.a.s. has a compatible sequence with
λ [, a.a.s. no random structure has a

Proof. The proof is analogous to that of Theorem 10, the only diﬀerence being that

|¯l0 − ¯p0n| ≤ 2.

(cid:3)

In Fig. 1 from Supplementary Material, we display

as a function of p1 and p3,
employing the average AUCG-ratios found in RNA databases. We contrast the cases of
Watson-Crick and Watson-Crick together with wobble base pairs.

¯s[r]
p,λ(n)
s[r]
λ (n)

5. Discussion

In this section we discuss our ﬁndings in the context of nucleotide percentages observed
in RNA databases (Berman et al., 2000) and provide some implications of our results.
Using the data from the RCSB PDB database (Berman et al., 2000), we list in Table 2
the average nucleotide ratios for several classes of RNA and the corresponding values of
p0 and ¯p0 (see Theorem 10 and Theorem 11).

The observed average AUCG-ratio of all RNA families is (0.208, 0.200, 0.271, 0.321)
facilitating according to Theorem 10 and Theorem 11 the formation of asymptotically
almost all structures, see Fig. 1 from Supplementary Material.

Table 2 shows, that the average ratio for mRNAs is signiﬁcantly diﬀerent from that of
other families and can thus be used as a discriminat for the mRNAs that can easily be
obtained at the time of sequencing. With a ratio of A being 0.412 and a 2 : 1 ratio of
G to C the mRNA family exhibits particular nucleotide ratios making it it more diﬃcult
to form conﬁgurations having low free energies. For mRNA, p0 and ¯p0 are relatively

Table 2. The average nucleotide ratios and the values of p0, ¯p0 for diﬀerent
families of RNA structures. The theoretical value with whom p0 and ¯p0 have
to be compared is µ[3]

4 = 0.3113.

21

A

U

C

G

σ2

p0

¯p0

mRNA

tRNA

0.412 0.265 0.110 0.213 0.092 0.375 0.375

0.189 0.201 0.292 0.318 0.004 0.481 0.493

5S ribosomal RNA 0.208 0.165 0.304 0.323 0.006 0.470 0.470

16S ribosomal RNA 0.214 0.165 0.268 0.353 0.004 0.433 0.433

23S ribosomal RNA 0.246 0.180 0.244 0.330 0.006 0.424 0.424

Bacteria

0.238 0.197 0.247 0.317 0.010 0.444 0.444

Eukaryota

0.232 0.237 0.238 0.293 0.021 0.470 0.475

Viruses

RNA

0.182 0.205 0.298 0.315 0.015 0.480 0.497

0.208 0.200 0.271 0.321 0.052 0.471 0.471

close to the critical value µ[3]
4 = 0.3113 which motivates to look in more detail at mRNA
structures, in particular in the context of mRNA redesign with the objective to achieve
a mfe-structure without aﬀecting the induced amino acid sequence (Gaspar et al., 2013).
Buratti and Baralle (2004) formulates the hypothesis that pre-mRNA molecules behaved
essentially as a linear structure, or “tape” so to speak. In particular, our results show
that pre-mRNAs with p0 < µ[3]

4 almost surely have a linear structure.

We observe that for mRNAs whose critical values p0 are greater than µ[3]

4 , fold. For
instance, mRNA HP210 (Mahen et al., 2010) with p0 = ¯p0 = 0.45 folds into several
distinct conﬁrmations and interchanges them quickly (in vivo).

mRNA sequences with p0 < µ[3]

4 , have a diminished capability of folding and typically

interact with other biopolymers: for instance, the two synthetic messenger RNAs

5′-UUUUUUUUUUUUUUUUUGGCAAGGAGGUUUUUUUUUUUUUUUUUUUUUUU -3′,

having p0 = 0.08, ¯p0 = 0.18 and

5′-GGCAAGGAGGUAAAAAUGAAAAAAAAA-3′,

having p0 = ¯p0 = 0.11 are used to study the interaction of mRNA with the ribosome at
diﬀerent states of translation (Yusupova et al., 2006). During the translation initiation
these mRNAs combine with 16s ribosomal RNA, forming ribosome complexes, see Fig. 6.
A second instance of such interactions is reported in Rozov et al. (2015). The messenger

RNA

5′-GGCAAGGAGGUAAAAAUGAACAAAAAAAAA-3′,

(p0 = ¯p0 = 0.133), pairs, as a result of a G-U mismatch, with an incorrect tRNA and as
a result produces an incorrect amino acid.

22

1

10

20

30

40

50

5'

U U U U U U U U U U U U U U U U U G

G

C

A

A

G

G

A

G

G

U

U

U

U

U

U

U

U

U

U U U U U U U U U U U U U U

3'

mRNA

16s RNA

3'

U

U

U

C

C

U

C

C

A

C

U

A

G

G

5'

1

10

20

mRNA

5'

G

G

C

A

A

G

G

A

G

G

U

A

A

A

A

A

U

G

A

A

A

A

A

A

A

A

27

A

3'

16s RNA

3'

U

U

U

C

C

U

C

C

A

C

U

A

G

G

5'

Waston-Crick base pair

non-canonical base pair

Fig. 6. Interactions between mRNAs and 16s ribosomal RNA.

Of course nucleotide ratios are a rather coarse criterion: within sequences of a ﬁxed
nucleotide ratio structural conformations depend on additional factors: Seﬀens and Digby
(1999) showed that mRNAs from databases have lower mfe than random RNA sequences
of the same nucleotide ratio. Since mfe critically depends on the stacking of base pairs
and loops, Workman and Krogh (1999) was able to show that random RNA sequences,
generated with the same dinucleotide ratio, have not signiﬁcantly higher mfe values. Ac-
cordingly, the dinucleotide ratio is the adaequate equivalence concept when studying mfe
conﬁgurations.

Irrespective of RNA family, if for an RNA sequence p0 and ¯p0 are smaller than µ[3]

4 =
0.3113, it is likely that it interacts with other biopolymers. In the following we list several
instances of this phenomenon, see Fig. 7,

(1) RNAs found in the bluetongue virus (Diprose et al., 2002), having three distinct
segments of 412, 276, and 265 bp, each of which comprised of two chains of A-
sequences and U-sequences (p0 = ¯p0 = 0) binding to each other by A-U base
pairs;

(2) the consensus sequence 5′-UACUAACACC-3′ (p0 = ¯p0 = 0.2) of the precursor (pre)mRNA

intron, interacting with the short region 5′-GGUGUAGUA-3′ (p0 = 0.222, ¯p0 = 0.333)
of the U2 small nuclear (sn)RNA and forming a complementary helix of seven base
pairs with a single, unpaired A-residue (Newby and Greenbaum, 2002);

(3) the secondary structure of the minimal, hinged hairpin ribozyme, formed by the

interaction between the interdomain linker strand

5′-CGGUGAGAAGGGXGGCAGAGAAACACACGA-3′,

(p0 = ¯p0 = 0.2) and two other strands (MacElrevey et al., 2008).

We display the above three examples in Fig. 7.

The mathematical analysis presented here is currently extended to topological RNA
structures, i.e. RNA structures having pseudoknots. These RNA structures are ﬁltered
by the topological genus of their corresponding fatgraphs. In this framework the concept
of diagrams is enriched by passing from graphs the fatgraphs. This is achieved by ordering

3'

A

A

A

A

A

A

5'

U

U

U

U

U

U

.
.
.

.
.
.

A

A

A

A

A

U

U

U

U

U

3'

C

C

A

C

A

A

U

C

A

U

5'

G

G

U

G

U

A

G

U

A

5'

3'

23

3'

C

C

G

U

C

C

A

U

U

A

C

A

U

G

G

U

G

C

U

5'

X

G

G

G

A

A

G

A

G

U

G

G

C

5'

5'

U

C

C

C

A

G

U

C

C

A

C

C

G

3'

non-canonical

Waston-Crick

X

modified residue S9L

G

G

C

A

G

A

G

A

A

A

C

A

C

A

C

G

A

3'

Fig. 7. LHS: the double-stranded structure (Diprose et al., 2002) com-
prised of an A-sequence and an U-sequence. M: the complementary
helix (Newby and Greenbaum, 2002) formed by the (pre)mRNA intron
and U2 small nuclear (sn)RNA. RHS: the minimal, hinged hairpin ri-
bozyme (MacElrevey et al., 2008) consisting of three interacting strands.

the edges around a vertex and the secondary structures discussed here are just topological
RNA structures of genus zero.

ACKNOWLEDGMENTS

We would like to thank Fenix W.D. Huang for discussions and for providing the data

on the tRNA structures.

AUTHOR DISCLOSURE STATEMENT

24

The authors declare that no competing ﬁnancial interests exist.

References

E.A. Bender. Central and local limit theorems applied to asymptotic enumeration. J.

Combin. Theory A, 15:91–111, 1973.

H.M. Berman, J. Westbrook, Z. Feng, G. Gilliland, T.N. Bhat, H. Weissig, I.N.
Shindyalov, and P.E. Bourne. The Protein Data Bank. Nucleic Acids Res., 28:235–242,
2000.

E. Buratti and F.E. Baralle. Inﬂuence of RNA Secondary Structure on the Pre-mRNA

Splicing Process. Mol. Cell. Biol., 24(24):10505–10514, 2004.

J.M. Diprose, J.M. Grimes, G.C. Sutton, J.N. Burroughs, A. Meyer, S. Maan, P.P.C.
Mertens, and D.I. Stuart. The Core of Bluetongue Virus Binds Double-Stranded RNA.
J. Virol., 76(18):9533–9536, 2002.

P. Flajolet and R. Sedgewick. Analytic Combinatorics. Cambridge University Press New

York, 2009.

W. Fontana, D.A.M. Konings, P.F. Stadler, and P. Schuster. Statistics of RNA secondary

structures. Biopolymers, 33(9):1389–1404, 1993.

P. Gaspar, G. Moura, M.A.S. Santos, and J.L. Oliveira. mRNA secondary structure
optimization using a correlated stem-loop prediction. Nucleic Acids Res., page gks1473,
2013.

E. Hille. Analytic Function Theory, volume Volume II. Chelsea Publishing Company,

1962.

I.L. Hofacker, P. Schuster, and P.F. Stadler. Combinatorics of RNA secondary structures.

Discrete Appl. Math., 88(1–3):207–237, 1998.

J. Howell, T. Smith, and M. Waterman. Computation of Generating Functions for Bio-

logical Molecules. SIAM J. Appl. Math., 39(1):119–133, 1980.

C.A. Hunter and J.K.M. Sanders. The nature of π-π interactions. J. Am. Chem. Soc.,

112(14):5525–5534, 1990.

E.Y. Jin and C.M. Reidys. Central and local limit theorems for RNA structures. J. Theor.

Biol., 250(3):547–559, 2008.

R. Lorenz, S.H. Bernhart, C. H¨oner zu Siederdissen, H. Tafer, C. Flamm, P.F. Stadler,

and I.L. Hofacker. ViennaRNA Package 2.0. Algorithms Mol. Biol., 6:26, 2011.

C. MacElrevey, J.D. Salter, J. Krucinska, and J.E. Wedekind. Structural eﬀects of nucle-
obase variations at key active site residue Ade38 in the hairpin ribozyme. RNA, 14(8):
1600–1616, 2008.

E.M. Mahen, P.Y. Watson, J.W. Cottrell, and M.J. Fedor. mRNA Secondary Structures

Fold Sequentially But Exchange Rapidly In Vivo. PLoS Biol., 8(2):e1000307, 2010.

25

J.S. McCaskill. The equilibrium partition function and base pair binding probabilities for

RNA secondary structure. Biopolymers, 29:1105–1119, 1990.

M.I. Newby and N.L. Greenbaum. Sculpting of the spliceosomal branch site recognition

motif by a conserved pseudouridine. Nature Struct. Biol., 9(12):958–965, 2002.

R.C. Penner and M.S. Waterman. Spaces of RNA secondary structures. Adv. Math., 217:

31–49, 1993.

C. Reidys, P.F. Stadler, and P. Schuster. Generic properties of combinatory maps: neutral

networks of RNA secondary structures. Bull. Math. Biol., 59(2):339–397, 1997.

A. Rozov, N. Demeshkina, E. Westhof, M. Yusupov, and G. Yusupova. Structural insights

into the translational inﬁdelity mechanism. Nat. Commun., 6, 2015.

W. Schmitt and M. Waterman. Linear trees and RNA secondary structure. Disc. Appl.

Math., 51:317–323, 1994.

W. Seﬀens and D. Digby. mRNAs have greater negative folding free energies than shuﬄed

or codon choice randomized sequences. Nucleic Acids Res., 27(7):1578–1584, 1999.

T. F. Smith and M. S. Waterman. RNA secondary structure. Math. Biol., 42:31–49, 1978.
R. P. Stanley. Enumerative Combinatorics: Volume 2. Cambridge University Press, 2001.
P.R. Stein and M.S. Waterman. On some new sequences generalizing the Catalan and

Motzkin numbers. Discrete Math., 26(3):261–272, 1979.

E. Titchmarsh. The theory of functions. Oxford Uninversity Press, Oxford UK, 1939.
J. ˇSponer, J. Leszczynski, and P. Hobza. Electronic properties, hydrogen bonding, stack-

ing, and cation binding of DNA and RNA bases. Biopolymers, 61(1):3–31, 2001.

J. ˇSponer, J.E. Sponer, A. Ml´adek, P. Jureˇcka, P. Ban´aˇs, and M. Otyepka. Nature and
magnitude of aromatic base stacking in DNA and RNA: Quantum chemistry, molecular
mechanics, and experiment. Biopolymers, 99(12):978–988, 2013.

M.S. Waterman. Secondary structure of single-stranded nucleic acids. In Studies on foun-
dations and combinatorics, Advances in mathematics supplementary studies, volume 1,
pages 167–212. Academic Press N.Y., 1978.

M.S. Waterman. Combinatorics of RNA Hairpins and Cloverleaves. Stud. Appl. Math.,

60(2):91–98, 1979.

C. Workman and A. Krogh. No evidence that mRNAs have lower folding free energies
than random sequences with the same dinucleotide distribution. Nucleic Acids Res., 27
(24):4816–4822, 1999.

G. Yusupova, L. Jenner, B. Rees, D. Moras, and M. Yusupov. Structural basis for mes-

senger RNA movement on the ribosome. Nature, 444(7117):391–394, 2006.

