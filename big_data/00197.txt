6
1
0
2

 
r
a

M
1

 

 
 
]

.

O
C
h
t
a
m

[
 
 

1
v
7
9
1
0
0

.

3
0
6
1
:
v
i
X
r
a

A Proof of the Bar´at-Thomassen Conjecture∗

Julien Bensmaila, Ararat Harutyunyanb, Tien-Nam Lec,

Martin Merkera, and St´ephan Thomass´ec

aDepartment of Applied Mathematics and Computer Science

Technical University of Denmark

DK-2800 Lyngby, Denmark

bInstitut de Math´ematiques de Toulouse

Universit´e Toulouse III

31062 Toulouse Cedex 09, France

cLaboratoire d’Informatique du Parall´elisme

´Ecole Normale Sup´erieure de Lyon

69364 Lyon Cedex 07, France

Abstract

The Bar´at-Thomassen conjecture asserts that for every tree T on m edges, there
exists a constant kT such that every kT -edge-connected graph with size divisible by m
can be edge-decomposed into copies of T . So far this conjecture has only been veriﬁed
when T is a path or when T has diameter at most 4. Here we prove the full statement
of the conjecture.

1

Introduction

Unless stated otherwise, all graphs considered in this paper are ﬁnite and simple. Given
a graph G, we denote by V (G) and E(G) its vertex and edge sets, respectively. For any
subset S of vertices or edges of G, we denote by G[S] the subgraph of G induced by S.

Given a connected graph H, we say that G has an H-decomposition if there exists
a partition of E(G) into parts isomorphic to H. When does a graph G admit an H-
decomposition? In general, this question is NP-complete whenever H contains at least 3
edges, see [7]. We focus on the case where we want to decompose G into copies of a given
tree T . A necessary condition for the existence of a T -decomposition is of course that |E(T )|
divides |E(G)|. There are many theorems and conjectures in graph theory stating that this
condition is also suﬃcient in certain cases. By a result of Wilson [17] this holds when G is a
suﬃciently large complete graph, and there exist more general results showing that this is

∗The ﬁrst and fourth authors were supported by ERC Advanced Grant GRACOL, project no. 320812.
The second author was supported by an FQRNT postdoctoral research grant and CIMI research fellowship.
The ﬁfth author was partially supported by the ANR Project STINT under Contract ANR-13-BS02-0007.

1

also true for graphs of large minimum degree. More precisely, for every tree T there exists
a constant εT > 0 such that every graph G of minimum degree (1 − εT )|V (G)| admits a
T -decomposition, provided its size is divisible by the size of T (see for example [2]).

A diﬀerent line of research was started by Bar´at and Thomassen [3], when they ob-
served in 2006 that T -decompositions are intimately related to nowhere-zero ﬂows. Tutte
conjectured that every 4-edge-connected graph admits a nowhere-zero 3-ﬂow, but until re-
cently it was not even known that any constant edge-connectivity suﬃces for this. Bar´at
and Thomassen showed that if every 8-edge-connected graph of size divisible by 3 admits
a K1,3-decomposition, then every 8-edge-connected graph admits a nowhere-zero 3-ﬂow.
Vice versa, they also showed that Tutte’s 3-ﬂow conjecture would imply that every 10-edge-
connected graph with size divisible by 3 admits a K1,3-decomposition. Motivated by this
intrinsic connection, they conjectured the following.

Conjecture 1 (Bar´at-Thomassen Conjecture, [3]). For any tree T on m edges, there exists
an integer kT such that every kT -edge-connected graph with size divisible by m has a T -
decomposition.

When the conjecture was made, it was only known to hold in the trivial cases where T
has less than 3 edges. Since then, Conjecture 1 has attracted growing attention, and it has
now been veriﬁed for diﬀerent families of trees such as stars [14], some bistars [1, 16], and
paths of a certain length [6, 12, 13, 15]. Very recently, breakthrough results were obtained
by Merker [10], who proved the conjecture for all trees of diameter at most 4, hence covering
some of the results above, and by Botler, Mota, Oshiro, and Wakabayashi [5], who proved
the conjecture for all paths. The latter result was improved by Bensmail, Harutyunyan, Le,
and Thomass´e [4], who showed that, for path-decompositions, large minimum degree is a
suﬃcient condition provided the graph is 24-edge-connected.

The purpose of this paper is to verify Conjecture 1 for every tree T , hence settling the

conjecture in the aﬃrmative.

Theorem 2. The Bar´at-Thomassen conjecture is true.

This paper builds upon previous work on the Bar´at-Thomassen conjecture. It was shown
by Thomassen in [16], and independently by Bar´at and Gerbner in [1], that it is suﬃcient
to verify Conjecture 1 for bipartite graphs G.

Theorem 3. [1, 16] Let T be a tree on m edges. The following two statements are equivalent:

(1) There exists a natural number kT such that every kT -edge-connected graph with size

divisible by m has a T -decomposition.

(2) There exists a natural number k′

T such that every k′

T -edge-connected bipartite graph

with size divisible by m has a T -decomposition.

An important tool in the study of Conjecture 1 is a recent result on modulo-k orien-
tations, which was proved by Thomassen in [14]. He showed that the edges of a highly
edge-connected graph can be oriented so that any prescribed out-degrees modulo k are
realized. This was formerly known as Jaeger’s weak k-ﬂow conjecture and it immediately
implies that Conjecture 1 holds for all stars. Moreover, his result implies that every 8-edge-
connected graph admits a nowhere-zero 3-ﬂow. In [8], the method was reﬁned to show that

2

also 6-edge-connected graphs admit a nowhere-zero 3-ﬂow. The question whether edge-
connectivity 4 suﬃces remains open. Another application of these modulo-k orientations is
the following decomposition result, which was shown by Thomassen in [16] and also applied
in [6] and [10].

Theorem 4. [16] Let G be a bipartite graph with partition classes A1 and A2, and size
divisible by m. If G is (4λ + 6m)-edge-connected, then G can be decomposed into two λ-
edge-connected graphs G1 and G2 such that d(v, Gi) is divisible by m for every v in Ai.

By Theorems 3 and 4, it is suﬃcient to prove Conjecture 1 for bipartite graphs G on

vertex classes A and B, where all vertices in A have degree divisible by m, the size of T .

Let TA and TB denote the vertex classes of a bipartition of T . . The T -decompositions
we are going to construct will respect the bipartitions of G and T in the sense that the
vertices corresponding to TA will lie in A for each copy of T . We say that vertices v ∈ V (G)
and t ∈ V (T ) are compatible if v ∈ A and t ∈ TA, or v ∈ B and t ∈ TB.

We study a speciﬁc kind of edge-colouring of G, that was introduced in [10]. Assuming
G is (improperly) edge-coloured, we denote by di(v) the degree of vertex v in colour i. For
t ∈ V (T ), let S(t) denote the set of edges incident with t.

Deﬁnition 5. An edge-colouring φ : E(G) → E(T ) is called T -equitable, if for any com-
patible vertices v ∈ V (G), t ∈ V (T ) and j, k ∈ S(t), we have dj(v) = dk(v).

It was shown by Merker [10], using modulo-k orientations, that highly edge-connected

graphs admit T -equitable edge-colourings.

Theorem 6 (Theorem 3.4 in [10]). There exists a function f (m, L) such that the following
holds: If G is an f (m, L)-edge-connected bipartite graph where all vertices in one side of
the bipartition have degree divisible by m, then G admits a T -equitable colouring where the
minimum degree in each colour is at least L.

Notice that if there exists a T -decomposition of a bipartite graph G where all copies
of T are oriented the same way (with respect to the bipartite classes), then this gives rise
to a T -equitable colouring of G. Vice versa, a T -equitable colouring can also be used to
construct a T -decomposition. This was done in [10] for the case that the girth of G is at
least the diameter of T , and also in general for trees of diameter at most 4.

In this paper we use probabilistic methods, inspired from those used in [4], to show
that a T -equitable colouring can be turned into a T -decomposition whenever the minimum
degree in each colour is large enough.

Theorem 7. Let G be a bipartite graph admitting a T -equitable colouring. If the minimum
degree in each colour is at least 1050m, then G has a T -decomposition.

Combined with the previous theorems, Theorem 7 completes the proof of the Bar´at-

Thomassen conjecture.

Proof of Theorem 2: By Theorem 3, we may assume that G is bipartite. We show that
every (4f (m, 1050m) + 6m)-edge-connected bipartite graph has a T -decomposition, where f
is the function given by Theorem 6. By Theorem 4 we can decompose G into two spanning
f (m, 1050m)-edge-connected graphs G1 and G2, such that in one side of the bipartition of
each Gi all vertices have degree divisible by m. By Theorem 6, we can ﬁnd a T -equitable
colouring of Gi in which the minimum degree in each colour is at least 1050m. This colouring
can be turned into a T -decomposition by Theorem 7.

3

2 Deﬁnitions and sketch of proof

In our proof of Theorem 7, a T -decomposition of a graph G is obtained in two steps, which
we describe more formally below. In the ﬁrst step we construct a decomposition of G into
so-called pseudo-copies of T , which are subgraphs that are in some sense homomorphic to
T . Such a decomposition, which we call a T -pseudo-decomposition, can easily be obtained
from a T -equitable colouring, see also [10]. Instead of choosing any such decomposition,
we use probabilistic methods to ﬁnd one in which the vast majority of pseudo-copies at
every vertex are isomorphic to T . The details of this step can be found in Section 3. In
the second step, we use these isomorphic copies to repair the non-isomorphic copies of T
by making subgraph switches. While the switching itself is a deterministic operation, we
again use probabilistic methods to ﬁnd a suitable set of isomorphic copies. This part of the
proof is detailed in Section 4.

Step 1: Finding a good T -pseudo-decomposition

Let G be a graph with a T -equitable colouring. Recall that S(t) denotes the set of edges
incident with a vertex t ∈ V (T ). Let us denote by Ni(v) the set of edges coloured i

incident with v ∈ V (G). Furthermore, we set NS(t)(v) := Si∈S(t) Ni(v) for every t ∈ V (T )

compatible with v. Since the edge-colouring of G is T -equitable, we have that |NS(t)(v)| is
divisible by |S(t)| for every compatible v ∈ V (G), t ∈ V (T ). Thus, we partition NS(t)(v)
into stars of size |S(t)| that contain each of the colours in S(t) exactly once. Let S be
the collection of stars we get after having done this for every v ∈ V (G) and compatible
t ∈ V (T ). Consider an auxiliary graph GS whose vertices are the stars in S, and where two
vertices are joined by an edge whenever the corresponding stars have an edge in common.
By construction, each connected component of GS is a tree isomorphic to T . For every
connected component in GS , we take the union of all the stars corresponding to it in G. It
is easy to see that this decomposes G into parts of the same size as T . In fact even more
is true: Each part is isomorphic to a graph obtained from T by identifying vertices. This
motivates the following deﬁnition.

Deﬁnition 8. A graph H is a pseudo-copy of T , if there exists a surjective graph homo-
morphism h : V (T ) → V (H) that induces a bijection between E(T ) and E(H).

In other words, a graph H is a pseudo-copy of T , if it is isomorphic to a multigraph
obtained from T by identifying vertices and keeping all edges. We also refer to pseudo-
copies of T as pseudo-trees. The term T -pseudo-decomposition denotes a decomposition
where each part is a pseudo-copy of T . Given a T -equitable colouring of G, the construction
above results in a T -pseudo-decomposition of G.

Notice that it might be the case that a graph H can be considered as a pseudo-copy
of T in diﬀerent ways if there exists more than one homomorphism from T to H with
the required properties. However, we will only consider homomorphisms that induce the
same edge-colouring of H as the given T -equitable colouring. Furthermore, we only consider
pseudo-copies of T in G that respect the bipartition in the sense that vertices corresponding
to TA always lie in A.

Let H be a T -pseudo-decomposition of G. For every compatible v ∈ V (G) and t ∈
V (T ), we denote by NH(v|t) the set of pseudo-trees in H in which v is the image of t.

4

Let dH(v|t) = |NH(v|t)|. Clearly, for any two diﬀerent vertices u and v of G, we have
NH(u|t) ∩ NH(v|t) = ∅. Notice also that

NH(v|t) = H

[v∈G

for every t ∈ V (T ).

So far we have explained how T -pseudo-decompositions can be obtained from a T -
equitable colouring. We denote such a resulting T -pseudo-decomposition of G by H ∪ I,
where I denotes the collection of pseudo-copies that are isomorphic to T and H denotes
the collection of the remaining pseudo-copies.

If the minimum degree in each colour is large in the T -equitable colouring, then there
are many possibilities at every vertex to decompose its incident edges into stars. Using
probabilistic methods, we ﬁnd a T -pseudo-decomposition where dH(v|t) ≤ εdI (v|t) for
some given ε > 0 and every compatible v ∈ V (G), t ∈ V (T ). Now for every non-isomorphic
copy H ∈ NH(v|t), there are many copies isomorphic to T in NI (v|t). We will use one of
these isomorphic copies to improve the T -pseudo-decomposition by repairing H. This is
done by a subgraph switch operation which is explained in more detail in Step 2. However,
if the trees in NI (v|t) overlap too much, then we might not be able to make any switch
that improves the T -pseudo-decomposition. To avoid this, we need to ﬁnd a large set of
isomorphic copies in NI (v|t) that pairwise intersect only in v. To measure how much the
pseudo-trees in a T -pseudo-decomposition overlap, we use the following concept that was
introduced in [4].

Deﬁnition 9. Let H be a collection of pseudo-copies of T in G, and v ∈ V (G) and t ∈ V (T )
be compatible vertices. The conﬂict ratio of v with respect to t, denoted by confH(v|t), is
deﬁned by

confH(v|t) :=

.

maxu6=v(cid:12)(cid:12){T ∈ NH(v|t) : u ∈ V (T )}(cid:12)(cid:12)

dH(v|t)

Intuitively, conf H(v|t) measures the maximum proportion of pseudo-copies in NH(v|t)
in which some ﬁxed vertex u appears. Clearly, we always have 0 ≤ conf H(v|t) ≤ 1. If v
and t are not compatible, then we set conf H(v|t) = 0. Globally, we deﬁne conf(H|t) :=
maxv conf(v|t) and conf(H) := maxt conf(H|t).

To ensure that the isomorphic copies in the T -pseudo-decomposition H∪I are suﬃciently
spread out, we also require conf(H) ≤ δ for some given δ > 0. In Section 3, we prove that
such a T -pseudo-decomposition can always be obtained provided the minimum degree in
each colour is large enough.

Lemma 10. Let T be a tree on m edges and ε, δ real numbers with 0 < ε, δ < 1. Let
G be a T -equitably coloured bipartite graph where the minimum degree in each colour is at
least (10m)18(εδ)−6. Then G admits a T -pseudo-decomposition H ∪ I, where I denotes the
collection of isomorphic copies of T , such that:

(1) for every compatible v ∈ V (G) and t ∈ V (T ), we have dH(v|t) ≤ εdI (v|t);

(2) conf(I) ≤ δ.

5

Step 2: Repairing non-isomorphic copies

For this part of the proof we label the vertices t0, . . . , tm of T so that, for every i ∈ {1, . . . m},
the subgraph induced by t0, . . . , ti is connected. Such an ordering can for example be
obtained by applying a breadth-ﬁrst search algorithm from some vertex t0 of T . We also
label the edges of T so that ei denotes the edge joining ti with T [t0, . . . , ti−1] for every
i ∈ {1, . . . m}. To indicate at which place a pseudo-copy H fails to be isomorphic to T , we
introduce the following deﬁnitions.

Deﬁnition 11. Let H be a pseudo-copy of T , and let vi denote the image of ti in H for
every i ∈ {0, . . . , m}. For i ∈ {1, . . . , m}, we say that H is i-good if the vertices v0, . . . , vi
are pairwise distinct. If H is not i-good, then we say that H is i-bad.

Note that since G does not have multiple edges, every pseudo-copy of T in G is 2-good.

Moreover, since G is bipartite, every pseudo-copy of T in G is even 3-good.

The idea is to use isomorphic copies to repair the pseudo-trees that are not isomorphic
to T . We start by considering all pseudo-trees in H that are 4-bad. For each such H, we
will ﬁnd an isomorphic copy f (H) in I such that H ∪ f (H) can be written as the union
of two 5-good pseudo-copies of T , say H1 ∪ H2. We then remove H from H and f (H)
from I, and add {H1, H2} to H. The technical deﬁnition of this so-called switch is given
below. We use this operation for all 4-bad pseudo-copies of T in H. Let H′ ∪ I ′ denote
the resulting T -pseudo-decomposition, where I ′ again contains only isomorphic copies of T
and all pseudo-copies in H′ are 4-good. We repeat this step, this time repairing all 5-bad
pseudo-copies in H′ by using isomorphic copies in I ′. We continue like this until we get a
T -pseudo-decomposition in which all pseudo-copies are m-good and thus isomorphic to T .

To make sure that we can perform a switch between H and f (H), we need f (H) to
satisfy certain properties. Let vj denote the image of tj in H for j ∈ {0, . . . , m} and
suppose i is chosen minimal such that H is i-bad. By the choice of our labelling, there
exists i′ ∈ {0, . . . , i − 1} with ti′ti ∈ E(T ). To ensure that vi is distinct from the previous
vertices v0, . . . , vi−1, we want to choose a diﬀerent edge corresponding to ei at vi′. Since we
take this edge from f (H), we want f (H) to also use the vertex vi′ as image of t′
i. However,
this should be the only point of intersection with H to ensure that both copies will be
i-good after the switch.

More precisely, for every edge ei ∈ E(T ), let T i− denote the connected component of
T − ei containing t0. Let T i+ be the subgraph of T induced by E(T ) \ E(T i−). If H is a
pseudo-copy of T , then we denote the images of T i− and T i+ under the homomorphism by
H i− and H i+. Now we are ready to deﬁne the switching operation.

Deﬁnition 12. Let H be a collection of pseudo-copies of T in G and i ∈ {1, . . . , m}. Let
ti′ be the endpoint of the edge ei that is diﬀerent from ti. Suppose H1, H2 ∈ NH(v|ti′ ) for
some v ∈ V (G). The i-switch of {H1, H2} is deﬁned by

swi({H1, H2}) = {H i+

1 ∪ H i−

2 , H i−

1 ∪ H i+

2 }.

By making an i-switch between two pseudo-copies H and f (H), their vertices cor-
responding to v0, . . . , vi−1 remain unchanged.
if both H and f (H) are
(i − 1)-good, then also both copies in swi({H, f (H)}) will be (i − 1)-good. Moreover,
if H ∩ f (H) = {vi′}, then after the switch both pseudo-trees will be i-good. Notice that

In particular,

6

neither of the two new pseudo-trees is necessarily still isomorphic to T . In particular, the
collection of isomorphic copies might shrink with every step of the repairing process.

If the pseudo-trees in I overlap too much, we might not be able to ﬁnd a single pseudo-
tree f (H) in I with H ∩ f (H) = {vi′}. A suﬃciently low conﬂict ratio of I ensures that we
can ﬁnd such a function f : H → I. However, to continue this process we also need that
the remaining collection of isomorphic copies I \ f (H) has a low conﬂict ratio. To this end
we use the Local Lemma to prove the following lemma in Section 4.

Lemma 13. Let T be a tree on m edges and ε, δ positive real numbers with ε + δm < 1
2 .
Let H and H′ be collections of pseudo-copies of T in G with conf(H′) ≤ δ and dH′(v|t) >
max{22/ε7, dH(v|t)/ε} for each compatible v ∈ V (G), t ∈ V (T ).
For every t ∈ V (T ), there exists an injective function ft : H → H′ such that

• ft(NH(v|t)) ⊂ NH′(v|t) for every v ∈ V (G) compatible with t,

• H ∩ ft(H) = {v} for every H ∈ NH(v|t), and

• dft(H)(v|t′) ≤ 3εdH′(v|t′) for every compatible v ∈ V (G), t′ ∈ V (T ).

By using Lemma 13 with H′ = I, we ﬁnd a collection f (H) in which the degrees are low
compared to the degrees in I. Thus, the conﬂict ratio of the collection of isomorphic copies
only increases by a constant factor after each step of the repairing process. By choosing ε
and δ suﬃciently small, the proof of Theorem 7 will follow from Lemma 10 and repeated
application of Lemma 13. The details can be found at the end of Section 4.

3 Finding a good T -pseudo-decomposition

Given a graph with a T -equitable colouring and large minimum degree in each colour,
we construct a T -pseudo-decomposition satisfying the conditions in Theorem 10. As de-
scribed in Step 1 of Section 2, every T -equitable colouring gives rise to several T -pseudo-
decompositions. We form the pseudo-copies of T by grouping the edges at every vertex
randomly into rainbow stars. If the degrees in each colour are large enough, we can ensure
that most of the resulting pseudo-trees are isomorphic to T and also the conﬂict ratio of the
resulting T -pseudo-decomposition is small. The proof of this is essentially an application
of the Local Lemma.

Proposition 14 (Symmetric Local Lemma). Let A1, ..., An be events in some probability
space Ω with P[Ai] ≤ p for all i ∈ {1, . . . , n}. Suppose that each Ai is mutually independent
of all but at most d other events Aj. If 4pd < 1, then P[∩n

i=1Ai] > 0.

The bad events in this case are of the form that many copies in NH(v|t) are either
not isomorphic to T or have a vertex diﬀerent from v in common. To show that each
event occurs with low probability, we make use of an inequality due to McDiarmid [9] (see
also [11]). In what follows, a choice is deﬁned to be the position that a particular element
gets mapped to in a permutation.

Proposition 15 (McDiarmid’s Inequality (simpliﬁed version)). Let X be a non-negative
random variable, not identically 0, which is determined by m independent permutations
Π1, ..., Πm. If there exist d, r > 0 such that

7

• interchanging two elements in any one permutation can aﬀect X by at most d, and

• for any s > 0, if X ≥ s then there is a set of at most rs choices whose outcomes

certify that X ≥ s,

then for any 0 ≤ λ ≤ E[X],

Ph|X − E[X]| > λ + 60dprE[X]i ≤ 4e

−

λ2

8d2rE[X] .

A necessary condition to apply the Local Lemma is that each event is mutually inde-
pendent of most other events. To make sure that this is the case, we start the proof by
partitioning the edges at each vertex into so-called fans of roughly the same size. Recall
that for v ∈ V (G) and t ∈ V (T ), we denote by Ni(v) the edges coloured i incident with v
in G, and by S(t) the set of edges incident with t in T .
Proof of Lemma 10: Set c = ⌈(10m)9(εδ)−3⌉. For every v ∈ V (G) and colour i, we
choose rv,i ∈ {0, . . . , c − 2} such that di(v) ≡ rv,i (mod c − 1). Since the minimum degree
in each colour in G is greater than c2, we can partition every set Ni(v) into subsets of size
c and c − 1 so that precisely rv,i of them have size c. We call these subsets i-blades. Note
that an edge uv of colour i in G appears both in an i-blade of Ni(u) as well as in an i-blade
of Ni(v), but we do not require these two i-blades to have the same size.

For every compatible t ∈ V (T ), v ∈ V (G), and i, j ∈ S(t), we have di(v) = dj(v) since
the colouring is T -equitable. Thus, the number of i-blades of size c (respectively, of size
c − 1) in the partition of Ni(v) is equal to the number of j-blades of size c (respectively, of
size c − 1) in the partition of Nj(v). We can therefore partition the edges of NS(t)(v) into
fans, which are unions of blades of the same size, such that every fan contains precisely one
i-blade for every i ∈ S(t). In other words, a fan ϕ at a vertex v (with relation to t) is a
subset of NS(t)(v) of size c|S(t)| or (c − 1)|S(t)| such that all colours in S(t) appear c times
or c − 1 times in ϕ. We also call ϕ a t-fan to indicate the colours appearing in ϕ.

For every compatible t ∈ V (T ), v ∈ V (G), and every t-fan ϕ at v, we uniformly at
random select a rainbow matching between the blades of ϕ. More precisely, for every
i ∈ S(t) we choose a permutation Πϕ,i independently and uniformly at random from all
permutations on c elements (respectively, on c − 1 elements if the blades of ϕ have size
c − 1). By labelling the edges of each blade, each permutation Πϕ,i corresponds to an
ordering of the edges of the i-blade of ϕ. Now we partition the edges of ϕ into stars of
size |S(t)| by grouping the edges of diﬀerent blades that were mapped to the same position.
In other words, for every s ∈ {1, . . . , c} (respectively, s ∈ {1, . . . , c − 1}) we form a star
by choosing for every i ∈ S(t) the edge labelled Πϕ,i(s) in the i-blade of ϕ. These stars
are centered at v and each colour in S(t) appears precisely once. Note that every edge
uv ∈ E(G) belongs to exactly two stars, one centered at u and one centered at v. As
described in Step 1 in Section 2, these stars correspond to a T -pseudo-decomposition of G
in a canonical way. All that remains to show is that there exists an outcome of the random
permutations such that the resulting T -pseudo-decomposition satisfy the conditions (1) and
(2) of Lemma 10.

We denote the set of pseudo-trees using edges of a fan ϕ by Tϕ. Note that |Tϕ| is either
equal to c−1 or c. Now we formally deﬁne what the bad events at a t-fan ϕ at a vertex v are.
Let Aϕ be the event that more than 2m2c2/3 of the pseudo-copies in Tϕ are not isomorphic

8

to T . Let Bϕ be the event that there exists a vertex u ∈ V (G) with u 6= v such that more
than 2mc2/3 pseudo-copies in Tϕ contain u. Finally, let Cϕ = Aϕ ∪ Bϕ. We will prove the
following two statements.

Claim 1: Each Cϕ is mutually independent of all but at most 4(cm)2m other events Cψ.

Claim 2: P[Cϕ] < 9(cm)mme−c2/3/32.

Before we proceed to prove these claims, let us note that they allow us to use the Local
Lemma to get our desired T -pseudo-decomposition H ∪ I. Indeed, since e−x < (9m)!
x9m for
x > 0, we have

4 · 4(cm)2m · P[Cϕ] < 28 · (cm)3m · m · e−c2/3/32

· m · (9m)!

< 245m+8 ·(cid:16) m
c (cid:17)3m
· (9m)3(cid:17)3m
< (cid:16)218 ·
c (cid:19)3m
< (cid:18) 109m4

m
c

< 1 ,

where the last inequality follows from c ≥ (10m)9. Thus, the symmetric version of the Local
Lemma yields a T -pseudo-decomposition H ∪ I for which none of the events Cϕ holds. Now
H ∪ I has the desired properties:

• Since Aϕ does not hold for any ϕ, at most 2m2c2/3 of the pseudo-copies in Tϕ are not
1+ε c
1
1+ε c of them are in I. This holds

isomorphic to T . Since c ≥ (10m)9ε−3, we have 2m2c2/3 < ε
of the pseudo-copies in Tϕ are in H, while at least
for every t-fan at v, so we have dH(v|t) < εdI (v|t).

1+ε c. Thus, less than ε

• Since Bϕ does not hold for any ϕ, there are at most 2mc2/3 trees in Tϕ containing a
c
given vertex u diﬀerent from v. As argued above, at least
1+ε of the pseudo-copies in
Tϕ are in I. Since c ≥ (10m)9(εδ)−3, we have 2mc2/3 < δ c
1+ε . Thus, the proportion
of trees in Tϕ ∩ I containing u is less than δ. This is true for every t-fan at v, so we
have

and thus conf(I) ≤ δ.

(cid:12)(cid:12){H ∈ NI (v|t) : u ∈ V (H)}(cid:12)(cid:12)

dI (v|t)

≤ δ

It remains to verify Claims 1 and 2. We begin by proving Claim 1.

Proof of Claim 1: The structure of Tϕ depends on permutations in diﬀerent fans. Let
J(ϕ) denote the set of fans ψ for which there exists an outcome of the random permutations
such that Tϕ ∩ Tψ is non-empty. Since each fan consists of at most cm edges, there are at
most cm + (cm)2 + . . . + (cm)m fans we can reach from ϕ via a path of length at most m.
Thus,

|J(ϕ)| ≤ cm + (cm)2 + . . . + (cm)m < 2(cm)m .

This shows that there are at most 2(cm)m fans where the outcome of the permutation
aﬀects the structure of Tϕ. The same calculation shows that each permutation aﬀects the

9

structure of at most 2(cm)m sets Tψ. Hence, the event Cϕ is mutually independent of all
but at most 4(cm)2m other events Cψ.

Before we prove Claim 2, let us introduce more terminology. Let ti and tj be two distinct
vertices of T . We say that a pseudo-copy H of T is (ti, tj)-bad if the images of ti and tj in
H are identical. For a t-fan ϕ at a vertex v, let Aϕ(ti, tj) be the event that the number of
(ti, tj)-bad pseudo-trees in Tϕ is greater than 2c2/3. For a vertex u ∈ V (G) with u 6= v, let
Bϕ(u|ti) be the event that the number of pseudo-trees in Tϕ in which u is the image of ti is
greater than 2c2/3. The proof of Claim 2 consists of two parts:

Claim 2A: P[Aϕ(ti, tj)] < 4e−c2/3/32 for every ti, tj ∈ V (T ) with ti 6= tj.

Claim 2B: P[Bϕ(u|ti)] < 4e−c2/3/8 for every u ∈ V (G), ti ∈ V (T ) and u 6= v.

The proofs of Claims 2A and 2B use McDiarmid’s inequality and have a very similar
structure. We will therefore present all the details in the proof of Claim 2A, and only point
out the diﬀerences in the proof of Claim 2B.

Proof of Claim 2A: Fix ti and tj as diﬀerent vertices of T . Let Pi and Pj denote the
paths in T from t to ti and tj. In the case that one is a subpath of the other, we may assume
that Pi is contained in Pj. Let tj ′ denote the second last vertex of Pj and let j denote the
edge joining tj ′ and tj. Now T − j consists of two components, one of which contains tj
while the other one contains t, ti, and tj ′.

Let π be a ﬁxed outcome of all permutations apart from those at the j-blades of tj ′-fans.
In other words, given π, we only need to know the outcome of the permutations Πψ,j for
every tj ′-fan ψ to construct the T -pseudo-decomposition. For any such outcome π, we will
show that the conditional probability P[Aϕ(ti, tj)|π] is at most 4e−c2/3/32. Clearly, since we
condition on an arbitrary but ﬁxed event, this uniform bound implies Claim 2A.

Let T ′ denote the component of T − j containing t, ti and tj ′, and let T ′′ denote the
ϕ denote the images of T ′ in the pseudo-trees
ϕ is also ﬁxed. The permutations of the j-blades at the tj ′-fans

subgraph of T induced by E(T ) \ E(T ′). Let T ′
of Tϕ. By ﬁxing π, the set T ′
only decide how the images of T ′ and T ′′ get matched at the tj ′-fans.

Let Ψ denote the set of tj ′-fans which contain edges of pseudo-copies in Tϕ. Note that
also the set Ψ is completely determined by π. Let Xϕ denote the random variable counting
the number of (ti, tj)-bad pseudo-trees in Tϕ conditional on π. Notice that Xϕ only depends
on the random permutations Πψ,j with ψ ∈ Ψ.

For each pseudo-tree H ∈ T ′

ϕ at a tj ′-fan ψ ∈ Ψ, we already know what the image of ti
in H is. There are c − 1 or c diﬀerent images of T ′′ that could get matched to H at ψ, each
having a distinct vertex as image of tj. Thus, there are at least c − 1 diﬀerent vertices that
could be the image of tj in H. Since the permutation Πψ,j is chosen uniformly at random,
1
c−1 . Now, by
the probability that H will be part of a (ti, tj)-bad pseudo-tree is at most
linearity of expectation,

E[Xϕ] ≤ |Tϕ| ·

1

≤

c

.

c − 1

c − 1

We will apply McDiarmid’s inequality to the random variable Yϕ deﬁned by Yϕ := Xϕ +c2/3.
Clearly E[Yϕ] = E[Xϕ] + c2/3. Only the permutations Πψ,j with ψ ∈ Ψ aﬀect Xϕ and thus
Yϕ. If two elements in one of these permutations are interchanged, then the structure of

10

two pseudo-trees in Tϕ changes. In particular, the number of (ti, tj)-bad trees in Tϕ changes
by at most 2. Thus, we can choose d = 2 in McDiarmid’s inequality.

If Yϕ ≥ s, then Xϕ ≥ s − c2/3, and thus at least s − c2/3 of the pseudo-trees in Tϕ are
(ti, tj)-bad. Let H ′ ∈ T ′
ϕ be a part of a pseudo-tree H that is counted by Xϕ. Let vi and
vj denote the images of ti and tj in H. To verify that H is (ti, tj)-bad, we only need to
know which edge in the j-blade of ψ gets mapped to the same position as the edges in H ′
in other blades of ψ. In other words, the vertex vj is determined by the position of one
element in the permutation Πψ,j, and thus vi = vj can be certiﬁed by a single outcome.
Thus, Xϕ ≥ s − c2/3 can be certiﬁed by the outcomes of s − c2/3 < s choices and we can
choose r = 1 in McDiarmid’s inequality.

By applying McDiarmid’s inequality to Yϕ with λ = E[Yϕ], d = 2, r = 1, we get

P(cid:20)|Yϕ − E[Yϕ]| > E[Yϕ] + 120qE[Yϕ] (cid:21) ≤ 4e−

E[Yϕ]
32 ≤ 4e−

c2/3
32

and thus P(cid:2)Xϕ > 2c2/3(cid:3) ≤ 4e−c2/3/32. Now P[Aϕ(ti, tj)|π] < 4e−c2/3/32 and Claim 2A

follows.

Proof of Claim 2B: Let ti ∈ V (T ) be a ﬁxed vertex diﬀerent from t. Let P denote the
path from t to ti in T . Let tj denote the second last vertex of P and let i denote the edge
joining tj and ti. Now T − i consists of two components, one of which contains t and tj
while the other one contains ti. Let π be any ﬁxed outcome of all permutations apart from
those at the i-blades of tj-fans. We show that the conditional probability P[Bϕ(u|tj)|π] is
at most 4e−c2/3/8. As π is arbitrary, this implies the general bound P[Bϕ(u|tj)] < 4e−c2/3/8.
Let Xϕ denote the random variable conditional on π which counts the number of pseudo-
trees in Tϕ where u is the image of tj. The vertex u appears at most once in each tj-fan, so
by linearity of expectation we have

E[Xϕ] ≤ |Tϕ| ·

1

c − 1

≤

c

c − 1

.

We apply McDiarmid’s inequality to the random variable Xϕ + c2/3. Swapping two
positions in a permutation Πψ,i can aﬀect Xϕ by at most 1 since u is incident to at most
one edge of the i-blade of ψ. If Xϕ + c2/3 ≥ s, then this can be certiﬁed by revealing at
most s positions in the random permutations. Thus, applying McDiarmid’s inequality to
the random variable Xϕ + c2/3 with λ = E[Xϕ] + c2/3, r = 1, d = 1 yields

Now P[Bϕ(u|ti)|π] < 4e−c2/3/8 and Claim 2B follows.

PhXϕ > 2c2/3i ≤ 4e−c2/3/8 .

Now the proof of Claim 2 follows easily from Claims 2A and 2B.

Proof of Claim 2: By Claim 2A, we have

P[Aϕ] ≤ P
[∀i<j

Aϕ(ti, tj)


≤ X∀i<j

P [Aϕ(ti, tj)] < 4m2e−c2/3/32 .

11

Let Bϕ(u) be the event that the number of pseudo-trees in Tϕ containing u is greater than
2mc2/3. Since u cannot be the image of t, we have, by Claim 2B,

P[Bϕ(u)] ≤ P"[∀i

Bϕ(u|ti)# ≤X∀i

P[Bϕ(u|ti)] < 4me−c2/3/8 .

Since each fan consists of at most cm edges, there are at most cm + (cm)2 + . . . + (cm)m
vertices we can reach from ϕ via a path of length at most m. Thus, there are less than
2(cm)m vertices u for which P[Bϕ(u)] could be positive. In particular, we have

P[Bϕ] = P

 [∀u,u6=v

Bϕ(u)


P[Bϕ(u)] < 8(cm)mme−c2/3/8

≤ X∀u,u6=v

and Claim 2 follows from P[Cϕ] ≤ P[Aϕ] + P[Bϕ].

This concludes the proof of Lemma 10.

4 Repairing non-isomorphic copies

Let H ∪ I be the T -pseudo-decomposition given by Lemma 10. As described in Step 2 in
Section 2, we use copies in I to repair the pseudo-trees in H that are not isomorphic to T .
We apply Lemma 13 to show the existence of a suitable subset of I to perform the switches.
The proof of Lemma 13 relies on the following probabilistic tools, see also [11].

Proposition 16 (Lov´asz Local Lemma). Let A1, ..., An be a ﬁnite set of events in some
probability space Ω, and suppose that for some Ji ⊂ [n], Ai is mutually independent of {Aj :
(1−xj)

j /∈ Ji ∪{i}}. If there exist real numbers x1, ..., xn in (0, 1) such that P[Ai] ≤ xiQj∈Ji

for every i ∈ {1, ..., n}, then P[∩n

i=1Ai] > 0.

Proposition 17 (Simple Concentration Bound). Let X be a random variable determined
by n independent trials T1, ..., Tn such that changing the outcome of any one trial Ti can
aﬀect X by at most c. Then

P[|X − E[X]| > λ] ≤ 2e−λ2/(2c2n).

Proof of Lemma 13: Consider a pseudo-tree H ∈ NH(v|t), and let u ∈ V (H) \ {v}. Since
conf(H′|t) ≤ δ, there are no more than δdH′ (v|t) trees in NH′(v|t) containing u. Thus,
there are at least (1 − δm)dH′ (v|t) pseudo-copies of T in NH′(v|t) that intersect H only
in v. Since dH(v|t) ≤ εdH′ (v|t), we can associate a set S(H) of ⌊ 1−δm
⌋ pseudo-copies in
NH′(v|t) with each H ∈ NH(v|t) such that each element of NH′(v|t) is contained in at
most one of these sets. We deﬁne the function ft by choosing ft(H) uniformly at random
from one of the pseudo-trees in S(H). Clearly, any such function will satisfy the ﬁrst
two conditions of Lemma 13. All that remains to show is that with positive probability
dft(H)(v|t′) ≤ 3εdH′ (v|t′) holds for every compatible v ∈ V (G), t′ ∈ V (T ).

ε

The value of dft(H)(v|t′) only depends on the set of pseudo-trees in NH′(v|t′) that are
contained in some S(H). Let H′′ be the collection of pseudo-copies of H′ that are contained

12

in some S(H). Clearly, each tree in NH′′(v|t′) can be matched with exactly one tree in H
and this occurs with probability ⌊ 1−δm

⌋−1. By linearity of expectation,

ε

E[dft(H)(v|t′)] =(cid:22) 1 − δm

ε

(cid:23)−1

dH′′(v|t′) < 2εdH′ (v|t′) .

Let Av,t′ be the event that dft(H)(v|t′) > 3εdH′ (v|t′). Note that dft(H)(v|t′) is completely
determined by dH′′(v|t′) independent trials. Since the outcome of each trial can aﬀect
dft(H)(v|t′) by at most 1, the Simple Concentration Bound gives

P[Av,t′] < 2e−ε2dH′′ (v|t′)/2.

We claim that Av,t′ is mutually independent of all but at most m⌊ 1−δm

⌋dH′′ (v|t′) other
events Av′,t′′. Indeed, Av,t′ depends on dH′′(v|t′) random trials, and in each trial we have a
choice of ⌊ 1−δm

⌋ trees to match. Each tree aﬀects precisely m events other than Av,t′.

ε

ε

Now we apply the asymmetric Local Lemma to show that with positive probability none

of the events Av,t′ occur. Set x = ε4

8 . It is suﬃcient to show that

x (1 − x)m⌊ 1−δm

ε

⌋dH′′ (v|t′) ≥ P[Av,t′ ]

holds for all compatible v ∈ V (G), t′ ∈ V (T ).

ε(cid:1)6
If dH′′(v|t′) < (cid:0) 2
ε(cid:1)6
< 3εdH′(v|t′), so P[Av,t′] = 0. If dH′′(v|t′) ≥(cid:0) 2

, then we have

ε(cid:1)6
(cid:0) 2

x (1 − x)m⌊ 1−δm

ε

⌋dH′′ (v|t′) ≥ x (1 − x)dH′′ (v|t′)/ε2

, then dft(H)(v|t′) <

≥ xe−2xdH′′ (v|t′)/ε2
ε2
4 dH′′ (v|t′)

≥ P[Av,t′] ·

· e

x
2

≥ P[Av,t′] ·(cid:16) ε
2(cid:17)6

≥ P[Av,t′] .

dH′′(v|t′)

By the Local Lemma, there is a positive probability that none of the bad events occur.

Thus, there exists a function ft with the desired properties.

We now have all ingredients for the proof of Theorem 7.

Proof of Theorem 7: As described in Step 2 of Section 2, let t0, . . . , tm be a labelling
of the vertices of T such that T [t0, . . . , ti] is connected for every i ∈ {1, . . . m}. We also
label the edges of T so that ei denotes the edge joining ti with T [t0, . . . , ti−1] for every
i ∈ {1, . . . m}. Set εi = 5i−m/15m for i ∈ {1, . . . , m}. We are going to construct a sequence
(Hi ∪ Ii)m

i=1 of T -pseudo-decompositions of G such that the following holds:

• Ii is a collection of isomorphic copies of T for every i ∈ {1, . . . m};

• Hi is i-good for every i ∈ {1, . . . m};

• dIi(v|t) ≥ max{22/ε7

i , dHi (v|t)/εi} for every compatible v ∈ V (G), t ∈ V (T );

13

• conf(Ii) ≤ εi for every i ∈ {1, . . . , m}.

Since the minimum degree in each colour in G is at least 1050m, we can apply Lemma 10
with parameters ε = δ = 10−2m. Let H ∪ I denote the resulting T -pseudo-decomposition.
Clearly H ∪ I satisﬁes the conditions for H1 ∪ I1. Let i ∈ {2, . . . , m} and suppose we have
constructed Hi−1 ∪ Ii−1 such that the conditions above are satisﬁed. We need to repair the
pseudo-trees in Hi−1 that are not i-good. Since the pseudo-trees in Hi−1 are all (i−1)-good,
we can achieve this by making i-switches. Let tj be the endpoint of ei that is diﬀerent from
ti. Let fj : Hi−1 → Ii−1 be the function we get by applying Lemma 13 with H = Hi−1,
H′ = Ii−1, ε = δ = εi−1, and t = tj. Now fj(Hi−1) is the set of trees we use to repair the
pseudo-trees in Hi−1 that are not i-good. Set

swi(H, fj(H)) and

Hi = [H∈Hi−1

Ii = Ii−1 \ fj(Hi−1) ,

where swi(H, fj(H)) denotes the i-switch of H and fj(H) as deﬁned in Section 2. Since
H ∩ fj(H) = {v} for every H ∈ NHi−1(v|tj), the two pseudo-copies in swi(H, fj(H)) are
both i-good.

Notice that the degree dHi(v|t) of a vertex is invariant under i-switches between pseudo-
trees in Hi. Since dfj (Hi−1)(v|t) ≤ 3εi−1dIi−1(v|t) holds for compatible v ∈ V (G) and
t ∈ V (T ), we have dIi(v|t) ≥ (1 − 3εi−1)dIi−1 (v|t) and dHi(v|t) ≤ 4εi−1dIi−1(v|t) . Thus,

dHi(v|t) ≤

4εi−1

(1 − 3εi−1)

dIi(v|t) ≤ 5εi−1dIi(v|t) = εidIi(v|t) ,

dIi(v|t) ≥ (1 − 3εi−1)dIi−1(v|t) ≥ 22

1 − 3εi−1

ε7
i−1

≥

22
ε7
i

and

conf(Ii) ≤

conf(Ii−1)
1 − 3εi−1

≤

5
4

εi−1 < εi .

Hence, the T -pseudo-decomposition Hi ∪ Ii has the desired properties. In particular, Hm
is m-good and Hm ∪ Im is a T -decomposition of G.

References

[1] J. Bar´at and D. Gerbner. Edge-Decomposition of Graphs into Copies of a Tree with

Four Edges. Electronic Journal of Combinatorics, 21(1):#P1.55, 2014.

[2] B. Barber, D. K¨uhn, A. Lo, and D. Osthus. Edge-decompositions of graphs with high

minimum degree. Advances in Mathematics, 288: 337-385, 2016.

[3] J. Bar´at and C. Thomassen. Claw-decompositions and Tutte-orientations. Journal of

Graph Theory, 52:135-146, 2006.

[4] J. Bensmail, A. Harutyunyan, T.-N. Le, and S. Thomass´e. Edge-partitioning a graph

into paths: beyond the Bar´at-Thomassen conjecture. Preprint, 2015.

14

[5] F. Botler, G.O. Mota, M. Oshiro, and Y. Wakabayashi. Decompositions of highly edge-

connected graphs. Preprint, 2015.

[6] F. Botler, G.O. Mota, M. Oshiro, and Y. Wakabayashi. Decompositions of highly

connected graphs into paths of length ﬁve. Preprint, 2015.

[7] D. Dor and M. Tarsi. Graph Decomposition is NP-Complete: A Complete Proof of

Holyer’s Conjecture. SIAM Journal on Computing, 26(4):1166-1187, 1997.

[8] L.M. Lov´asz, C. Thomassen, Y. Wu, and C.-Q. Zhang. Nowhere-zero 3-ﬂows and mod-

ulo k-orientations. Journal of Combinatorial Theory, Series B, 103:587-598, 2013.

[9] C. McDiarmid. Concentration for Independent Permutations. Combinatorics, Proba-

bility and Computing, 11:163-178, 2002.

[10] M. Merker. Decomposing highly edge-connected graphs into homomorphic copies of a

ﬁxed tree. Preprint, 2015.

[11] M. Molloy and B. Reed. Graph Colouring and the Probabilistic Method. Springer, 2002.

[12] C. Thomassen. Decompositions of highly connected graphs into paths of length 3.

Journal of Graph Theory, 58:286-292, 2008.

[13] C. Thomassen. Edge-decompositions of highly connected graphs. Abhandlungen aus

dem Mathematischen Seminar der Universit¨at Hamburg, 18:17-26, 2008.

[14] C. Thomassen. The weak 3-ﬂow conjecture and the weak circular ﬂow conjecture.

Journal of Combinatorial Theory, Series B, 102:521-529, 2012.

[15] C. Thomassen. Decomposing graphs into paths of ﬁxed length. Combinatorica,

33(1):97-123, 2013.

[16] C. Thomassen. Decomposing a graph into bistars. Journal of Combinatorial Theory,

Series B, 103:504-508, 2013.

[17] M. Wilson. Decompositions of complete graphs into subgraphs isomorphic to a given
graph. In Proceedings of the Fifth British Combinatorial Conference (Univ. Aberdeen,
Aberdeen, 1975), pages 647 - 659. Congressus Numerantium, No. XV, Utilitas Math.,
Winnipeg, Man., 1976.

15

