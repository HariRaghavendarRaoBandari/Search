6
1
0
2

 
r
a

 

M
3
1

 
 
]
h
p
-
t
n
a
u
q
[
 
 

1
v
6
9
9
3
0

.

3
0
6
1
:
v
i
X
r
a

The methodology of composite quantum gates

Guang Hao Low, Theodore J. Yoder, and Isaac L. Chuang
Department of Physics and Research Laboratory of Electronics,

Massachusetts Institute of Technology, Cambridge, Massachusetts 02139, USA

(Dated: March 15, 2016)

The creation of composite quantum gates that implement quantum response functions ˆU (θ) de-
pendent on some parameter of interest θ has historically been more of an art than a science. Through
inspired design, a sequence of L primitive gates also depending on θ can engineer a highly nontriv-
ial ˆU (θ) that enables myriad precision metrology, spectroscopy, and control techniques. However,
discovering new useful examples of ˆU (θ) requires great intuition to perceive the possibilities, and
often brute-force to ﬁnd optimal implementations. These demands hobble our imagination of new
applications. We present a systematic and eﬃcient methodology for composite gate design of ar-
bitrary length, where phase-controlled primitive gates all rotating by θ act on a single spin. We
fully characterize the realizable family of ˆU (θ), provide an eﬃcient algorithm that decomposes a
choice of ˆU (θ) into its shortest sequence of gates, and show how to eﬃciently choose an achievable
ˆU (θ) that for ﬁxed L, is an optimal approximations to objective functions on its quadratures. A
strong connection is forged with classical discrete-time signal processing, allowing us to swiftly con-
struct, as examples, compensated gates with optimal bandwidth that implement arbitrary single
spin rotations with optimal sub-wavelength spatial selectivity.

PACS numbers: 03.67.Ac, 03.67.Lx, 82.56.Jn, 84.30.Vn

I.

INTRODUCTION

Composite quantum gates [1, 2] are indispensable
to many important quantum technologies and experi-
ments. Diverse examples include nuclear magnetic res-
onance, magnetic resonance imaging, quantum sensing,
and quantum computation [3] Their versatility arises
from a construction with sequences of L primitive quan-
tum gates, cunningly chosen to produce an eﬀective
quantum gate ˆU with a more desirable dependence on
some parameters of interest θ, such as drive amplitude
or background magnetic ﬁelds. As a function of θ, the
quantum response function ˆU (θ) can be tailored to am-
plify weak signals beyond the statistics of repetition, and
suppress noise without measurement. Finding such use-
ful composite gates is the subject of intense research.

Even in single spin systems, extraordinary richness
can be found in the possible forms of ˆU (θ). For exam-
ple: NMR spectroscopy, where minute chemical shifts
θ are made clearer through ˆU (θ) [2, 4, 5]; Heisenberg-
limited quantum imaging, where ˆU (θ) is made sensi-
tive to sub-wavelength position variations θ [6] without
aliasing [7, 8]; sub-wavelength spatial addressing where
arbitrary quantum gates ˆU (θ) with low crosstalk are
applied on spin arrays [8–10]; quantum phase estima-
tion for atomic clocks [11] or tomography [12], where
extremely small drifts θ are ampliﬁed by factor L in
the gradient of ˆU (θ); error-compensation, where frac-
tional control errors θ are exponentially suppressed like
ˆU (θ) = ˆU (0) + O(θpoly(L)) [13–21]; quantum algorithms
such as amplitude ampliﬁcation [22] where a computa-
tion ˆU (θ) proceeds with input θ. Other amazing solu-
tions via composite gates undoubtedly exist, and their
discovery would be expedited if a useful characterization
of all achievable ˆU (θ) could be found.

However, the road to new results does not end with
a choice of ˆU (θ); its optimal realization as a composite
gate must also be found. This quantum control prob-
lem [23] has celebrated results such as gradient ascent al-
gorithms [5] and pseudospectal methods [24, 25]. These
formulate the design of composite gates as a nonlinear,
but systematic optimization problem for some objective
function that can be solved numerically by brute force.
Unfortunately, the worst-case runtime of such procedures
is exponential O(eL), and are also not guaranteed to ﬁnd
optimally short L solutions for arbitrary objective func-
tions. Only with rare exceptions [8, 9, 16] and great eﬀort
are optimal, arbitrary length examples found in closed-
form. An eﬃcient solution to this control problem would
unleash the potential of long composite gates, for which
the most sophisticated quantum response functions can
be constructed.

A tantalizing similarity is seen in discrete-time sig-
nal processing [26]. Optimal ﬁnite-impulse response ﬁl-
ters [27] can be designed simply by choosing the lowest-
degree L polynomial that is the optimal approximation
to a desired frequency response, from which an optimal
and exact implementation is computed – made possible
by eﬃcient algorithms for both steps.
It is recognized
that composite gates implement a ﬁlter on physical pa-
rameters [20, 28], and the use of polynomials in quantum
response functions is well-known [29, 30]. Unfortunately,
quantum constraints render computing these polynomi-
als and their optimal implementation a hard problem.
It would be a tremendous advance if eﬃcient solutions
to these problems could be found, and even more so if
the countless results from the exalted history of classical
discrete-time signal processing were transferable to the
quantum realm.

We make great strides towards this aspiration with a

methodology for designing composite gates built from L
primitive gates acting on a single spin, all rotating by
angle θ, but not necessarily with the same phase. We
fully characterize the quantum response functions ˆU (θ)
achievable in this manner, show how we can eﬃciently
choose its form with trigonometric polynomials of de-
gree L, and show how its optimal implementation with
the shortest sequence of primitive gates can be eﬃciently
computed.
In the process, a connection is made with
discrete-time signal processing that allows us to inherit
some of its machinery. These powerful tools expedite
composite gate design, which we demonstrate with two
important examples: (1) compensated gates with opti-
mal bandwidth which (2) enable arbitrary single spin ro-
tations with optimal sub-wavelength spatial selectivity.

We elucidate in Sec. II the controls available to our sin-
gle qubit system and demonstrate how equiangular com-
posite gates motivate in Sec. III the intuitive concept
of choosing polynomials to explicitly deﬁne the quan-
tum response function ˆU (θ). This is made rigorous and
tractable in Sec. III A by a simple characterization of the
space of achievable ˆU (θ), and showing in Sec. III B how
an optimal implementation of any such ˆU (θ) can be ef-
ﬁciently computed. We then show in Sec. III C how an
achievable ˆU (θ) can be eﬃciently computed from a par-
tial speciﬁcation with polynomials that describe only the
composite gate ﬁdelity or transition probability response
functions. This enables in Sec. III D the eﬃcient design
of achievable ˆU (θ) by inheriting from discrete-time signal
processing existing polynomials and eﬃcient polynomial
design algorithms. Together, these provide a method-
ology outlined in Sec. III E for the systematic and eﬃ-
cient design of composite quantum gates. Use of this
methodology is demonstrated in Sec. IV by presenting
some optimal polynomials in Sec. IV A used to create
optimal bandwidth compensated gates in Sec. IV B that
provide an optimal solution in Sec. IV C to the problem
of implementing sub-wavelength spatially selective arbi-
trary quantum gates. Further directions are discussed in
Sec.V.

II. MODEL

The quantum response function ˆU (θ) is a unitary func-
tion of some parameter θ of interest that describes how
a quantum system evolves under the inﬂuence of θ. We
consider the generic system of a coherently driven single
spin, and present a construction for composite quantum
gates that motivates a powerful approach for designing
their implemented quantum response functions.

A two-level system driven by time-dependent Rabi fre-
quency Ω(t) and phase φ(t) is controlled by the Hamilto-
nian ˆHc(t) = Ω(t)
2 ˆσφ(t), where ˆσφ = cos(φ)ˆσx + sin(φ)ˆσy
and σx,y,z are Pauli matrices. Taking φ(t) = φ to be

2

constant over time τ , we generate the primitive rotation

ˆRφ(θ) = e−i θ

2 ˆσφ ,

θ =Z τ

0

Ω(t)dt.

(1)

2 ˆσz, we can also construct θ =R τ

Note that Ω(t) might only be partially under our con-
trol and thus contain an uncontrollable residual signal.
Our parameter of interest is thus θ, which captures both
In the presence of an oﬀ-resonant background
eﬀects.
ˆHr = δ(t)
0 δ(t)dt through
ˆRφ(θ) = e−i π
2 ˆσφ−π/2 if we assume bang-
bang control Ω ≫ δ.
An equiangular composite gate of length L is built from
these primitive rotations, each with the same rotation
amplitude θ, but with varying phases ~φ = (φ1, ..., φL).
This produces a θ-dependent unitary ˆU (θ), or quantum
response function, of the form

2 ˆσφ+π/2 e−i θ

2 ˆσz e−i π

ˆU (θ) = ˆRφL(θ) ˆRφL−1 (θ) . . . ˆRφ1(θ),
2(cid:19) cosL−j(cid:18) θ

(−i)j sinj(cid:18) θ
Xj=0

=

L

2(cid:19) ˆΦL,j,

(2)

where ˆΦL,j = ˆσj
sums ΦL,j are deﬁned through the recurrence [19]

x(Re[ΦL,j]ˆ1+i Im[ΦL,j]ˆσz), and the phase

ΦL,j = ΦL−1,j + ΦL−1,j−1ei(−1)j+1φj ,
Φ0,0 = 1, Φ0,j6=0 = 0.

(3)

Now, we make the crucial observation that ˆU (θ) is
polynomial of degree L in x ≡ cos (θ/2) and y ≡ sin (θ/2)
with a particularly elegant representation. Using the
trigonometric relation x2 + y2 = 1, ˆU (θ) has the form
ˆU (θ) = (A(x)ˆ1 + iB(x)ˆσz + iC(y)ˆσx + iD(y)ˆσy,

L odd,
A(x)ˆ1 + iB(x)ˆσz + ixC(y)ˆσx + ixD(y)ˆσy, L even.

(4)

where A(x), B(x), C(y), D(y) are polynomials of degree
at most L with coeﬃcients ak, bk, ck, dk respectively. In
the following, A, B, C, D without arguments are under-
stood to be functions of the x, y seen in Eq. 4. As the
tuple (A, B, C, D) is an equivalent representation of ˆU (θ),
we refer to both interchangeably. In particular, achiev-
able tuples are those than can be realized by some com-
posite gate of Eq. 2:

Deﬁnition 1 (Achievable polynomial tuples). A tuple of
polynomials (A, B, C, D) is achievable if ∃L, ~φ ∈ RL s.t.
ˆU (θ) = ˆRφL (θ) ˆRφL−1 (θ) . . . ˆRφ1 has the form of Eq. 4.

We are often interested in only a few components of
(A, B, C, D). For example, the partial tuple (A,·, C,·)
fully deﬁnes the gate ﬁdelity response function Fχ(θ) =
4|Tr[ ˆR†0(χ) ˆU ]|2 with respect to some target gate ˆR0(χ).
1
Fχ(θ) =((cid:12)(cid:12)cos(cid:0) χ
(cid:12)(cid:12)cos(cid:0) χ

2(cid:1)A + sin(cid:0) χ
2(cid:1)C(cid:12)(cid:12)
2(cid:1)A + x sin(cid:0) χ
2(cid:1)C(cid:12)(cid:12)

L odd,
, L even.

(5)

,
2

2

Similarly, (A, B,·,·) or (·,·, C, D) fully deﬁnes the tran-
sition probability response function p(θ) = |h0| ˆU|1i|2,

p(θ) = 1 − A2 − B2 = (C2 + D2)


1,
L odd,
x2, L even.

(6)

We refer to a tuple with n empty slots as an n-partial
tuple. An n-partial tuple is achievable if it is consistent
with some achievable tuple.

A brute-force approach to composite gate design is
minimizing an objective function for ˆU (θ) over a space
L ∈ N, ~φ ∈ RL. Though useful examples have been dis-
covered in this manner, such an approach is highly unap-
pealing. In addition to being ineﬃcient with a runtime
O(eL), there is no guarantee that a globally optimal solu-
tion will be found. Furthermore, the procedure provides
little of the necessary insight into possible ˆU (θ) for envi-
sioning further novel applications.

III. SYSTEMATIC AND EFFICIENT DESIGN

OF OPTIMAL COMPOSITE GATES

The functional

form of ˆU (θ) hints at a powerful
methodology for composite gate design via choices of
the polynomials (A, B, C, D) of degree L. This ambition
must solve long-standing problems:

(P1): An insightful

characterization of achievable
(A, B, C, D) to eliminate the traditional guesswork
in envisioning novel quantum response functions
and their dependence on ~φ.

(P2): An eﬃcient algorithm to compute the optimal ~φ
implementing an achievable (A, B, C, D), in con-
trast to the intractable random search in time
O(eL) of current state-of-art [8].
(P3): An eﬃcient algorithm to compute an achiev-
able (A, B, C, D) from achievable partial tuples e.g.
(A,·, C,·), as might be encountered with common
objective functions for Eq. 5, 6.
(P4): An eﬃcient algorithm for computing achievable
partial tuples optimal for some objective function.

Our main technical advances are precisely the resolu-
tion of problems (1-4). We describe in a simple and intu-
itive manner the set of achievable (A, B, C, D), and pro-
vide eﬃcient algorithms for solving what has tradition-
ally been the hardest aspects of composite gate design.
In particular, a beautiful connection is made with the his-
toric ﬁeld of discrete-time signal processing that allows
allows us to inherit much of its prior work in polynomial
design.
In this manner, the inspired art of composite
gates is transformed into a systematic science. Optimal
composite gates are simply polynomials optimal for the
objective function, and these polynomials can be found
eﬃciently.

3

A. Characterization of quantum response functions

We characterize here achievable choices of quantum re-
sponse functions (A, B, C, D) in a manner independent
of ~φ, hence resolving problem (P1). By providing in-
sight into the forms of possible ˆU (θ), we also obtain a
quantitative explanation for the remarkable versatility of
composite gates. Achievability constraints on the poly-
nomials (A, B, C, D) are as follows:

Theorem 1 (Achievable tuples). A tuple polynomials
(A, B, C, D) of degree at most L is achievable iﬀ all the
following are true:
(1) A, B, C, D are real.

(2) A(1) = 1 or B(1) = 0.

L odd,
A, B are even and C, D are odd, L even.

(3) nA, B, C, D are odd,
(4) 1 =nA(x)2 + B(x)2 + C(y)2 + D(y)2,

L odd,
A(x)2 + B(x)2 + x2C(y)2 + x2D(y)2, L even.

Proof. In forward direction, (1) and (3) are true by ap-
plying the trigonometric substitution x2 + y2 = 1 in
Eq. 2 and collecting coeﬃcients of ˆ1, ˆσx,y,z. (2) is true as
ˆU (0) = 1 in Eq. 2. (4) is true as ˆU is unitary so ˆU† ˆU = ˆ1
and 1

2 Tr[ ˆU† ˆU ] evaluated via Eq. 4 produces

L odd,
A(x)2 + B(x)2 + x2C(y)2x2D(y)2, L even.

1 =nA(x)2 + B(x)2 + C(y)2 + D(y)2,

(7)

In the reverse direction, we need to show that any
(A, B, C, D) satisfying (1-4) is achievable in the sense of
Def. 1. We leave these steps to Lem. 1.

Conditions (1-4) for achievable (A, B, C, D) appear
fairly general, which allows for great ﬂexibility in choos-
ing arbitrary response functions. They are also under-
standable and intuitive. A characterization of achiev-
able partial tuples is also useful. Not all quadratures
of ˆU (θ) might be relevant to an objective function, and
optimizing over a subset (A, B, C, D) could be easier. In
the following, we examine how the unitarity constraint of
condition (4) is weakened for all possible 2-partial tuples.

L odd,
A(x)2 + x2C(y)2 ≤ 1, L even.
L odd,
B(x)2 + x2C(y)2 ≤ 1, L even.

Theorem 2 (Achievable 2-partial tuples). Assuming
A, B, C, D satisfy conditions (1-3) of Thm. 1,
(1) (A,·, C,·), (A,·,·, C) is achievable iﬀ
(1a) ∀θ ∈ R,nA(x)2 + C(y)2 ≤ 1,
(2) (·, B, C,·), (·, B,·, C) is achievable iﬀ
(2a) ∀θ ∈ R,nB(x)2 + C(y)2 ≤ 1,
(3)(A, B,·,·) is achievable iﬀ
(3a) ∀θ ∈ R, A(x)2 + B(x)2 ≤ 1, and
(3b) ∀|x| ≥ 1, A(x)2 + B(x)2 ≥ 1, and
(3c) ∀L even,∀x ≥ 1, A(ix)2 + B(ix)2 ≥ 1.
(4)(·,·, C, D) is achievable iﬀ
(4a) ∀θ ∈ R,nC(y)2 + D(y)2 ≤ 1,
(4b) ∀L odd,|y| ≥ 1, C(y)2 + D(y)2 ≥ 1.

L odd,
x2C(y)2 + x2D(y)2 ≤ 1, L even,

and

Proof. In the forward direction, all the (a) conditions are
true from Eq. 7 using the fact that A, B, C, D are all real,
hence their squares are positive. (3b) is true by consid-

ering Eq. 7 with the substitution x = √λ, y = √1 − λ,
and computing 1 − A2(√λ) − B2(√λ) = ··· . Using the
odd/even symmetry of C, D, the RHS factorizes into a
positive term times (1 − λ) or λ(1 − λ). This is nega-
tive ∀λ ≥ 1 so A2(√λ) + B2(√λ) ≥ 1. (3c) is similarly
proven by considering λ ≤ 0. The RHS factorizes into
λ(1 − λ) and a positive term. (4b) proven with the sub-
stitution x = √1 − λ, y = √λ and by considering λ ≥ 1.
In the reverse direction, we need to show that assuming
these conditions enable the computation of an achievable
(A, B, C, D). We leave these steps to Lems. 2. 3.

We also characterize all possible 3-partial tuples.

Theorem 3 (Achievable 3-partial tuples). Assuming
A, B, C, D satisfy conditions (1-3) of Thm. 1, the fol-
lowing are achievable under their respective conditions
(1) (A,·,·,·) iﬀ ∀θ ∈ R, A(x)2 ≤ 1 and A(1) = 1.
(2) (·, B,·,·) iﬀ ∀θ ∈ R, B(x)2 ≤ 1 and B(1) = 0.
(3) (·,·, C,·) iﬀ ∀θ ∈ R,nC2(y) ≤ 1,
L odd,
x2C2(y) ≤ 1, L even.
(4) (·,·,·, D) iﬀ ∀θ ∈ R,nD2(y) ≤ 1,
L odd,
x2D2(y) ≤ 1, L even.
Proof. The forward direction follows by deﬁnition and
from Eq. 7 where A, B, C, D are all real ∀θ ∈ R, hence
their squares are positive. The reverse direction is true
from setting the unspeciﬁed polynomial to 0 in one of the
2-partial tuples (1), (3) in Thm. 2.

These simple characterizations show how one can in
principle encode almost any arbitrary desired function
into quadratures of ˆU (θ). Consider (A,·,·,·), which aside
from symmetry and A(1) = 1, only needs to satisfy
∀|x| ≤ 1, A2(x) ≤ 1. The famous Stone-Weierstrass the-
orem [31] assures us that A(x) of suﬃciently large degree
L can approximate arbitrarily well any arbitrary contin-
uous real function that satisﬁes these constrains on the
interval |x| ≤ 1. This ability to create almost arbitrary
quantum response functions helps explain the applicabil-
ity of composite gates to many diverse problems.

4

Lemma 1. [Optimal quantum response compilation] Ex-
actly L phases ~φ ∈ RL are required to implement an
achievable (A, B, C, D) of degree at most L, and these
L phases can be computed in time O(poly(L)).
Proof. A minimum of L phases ~φ are required to im-
plement a given (A, B, C, D) of degree at most L as
each application of Rφk (θ) only increases the degree of
(A, B, C, D) by one. We now show that (A, B, C, D) can
be implemented with at most L phases ~φ. Due to the
even/odd symmetry of real A, B, C, D from Thm. 1 con-
ditions (1) and (3), we can compute its unique phase sum
representation in Eq. 2 via the invertible transformation

ΦL,j = ij

L

Xn=0((icn − dn)(cid:0)⌊(L−n)/2⌋
(j−n)/2 (cid:1),
(an + ibn)(cid:0)(L−n)/2
(cid:1),

j/2

j odd,

j even.

(8)

Let us take the ansatz ˆU (θ) = ˆRφL (θ) ˆV (θ) where ˆV (θ) is
unitary and ˆV (0) = 1 as (A, B, C, D) represents a unitary
from Thm. 1 condition (4). Thus ˆV (θ) also has a phase
sum representation ΦL−1,j. These two phase sums are
related by the linear map of Eq. 3, with inverse

ΦL−1,j =

ΦL,k(−e−(−1)jiφL ,

1,

j

Xk=0

j + k odd,
j + k even.

(9)

By choosing

eiφL = PL
PL
L) − (c2

L + b2

k=1 odd ΦL,k
k=0 even ΦL,k

=

c2⌈L/2⌉−1 + id2⌈L/2⌉−1
(−1)⌈L/2⌉(aL + ibL)

, (10)

2⌈L/2⌉−1 + d2

we satisfy the necessary condition ΦL−1,L = 0 from Eq. 3.
In particular, φL is real, as Eq. 7 has the trailing term
2⌈L/2⌉−1)) sin2L (θ/2) = 0.
((a2
Hence the RHS of Eq. 10 has absolute value 1. By recur-
sively reducing the degree of ˆV (θ), we obtain all L phases
~φ. The terminal case at L = 1 must be consistent with
Eq. 3 where Φ0,0 = 1. When evaluated with Eq. 8, 9,
this is satisﬁed only if A(1) = 1 (Thm. 1 condition (2)),
which is true for achievable (A, B, C, D). All steps in
this procedure can be computed in time O(poly(L)),
and there are only L recursions, leading to a runtime
of O(poly(L)).

B.

Implementation of quantum response functions

C. Computation of quantum response functions

Unleashing the potential of arbitrarily sophisticated
choices of achievable (A, B, C, D) requires an eﬃcient
computation of their implementation ~φ. It is clear that
the a random search is wholly inadequate as the degree of
L could be very large. Nevertheless achievability leads to
a certain structure that resolves this problem (P2). This
is encapsulated in the following lemma, which is proven
constructively and furnishes the reverse direction proof
of Thm. 1.

A consequence of Lem. 1 is that designing a compos-
ite gate is no more diﬃcult than ﬁnding the (A, B, C, D)
to describe the quantum response function ˆU (θ). Op-
timizing (A, B, C, D) for some objective function is far
more intuitive than the prior art of a random search over
~φ. However, this still is a diﬃcult problem. The unitary
constraint Eq. 7 represent a system of quadratic multino-
mial equations that would have to be solved at each step
of the optimization to obtain an achievable (A, B, C, D).

Solving such systems is in general an NP-complete task.
This is the essence of problem (P3):
it would be much
easier to optimize a subset of (A, B, C, D), and doing so
is often the problem of practical interest anyway.

This subset optimization is illustrated by the response
functions Fχ(θ), p(θ) of Eq. 5,6 which depend on only two
polynomials. Optimizing just these for some objective
function oﬀers more freedom as the unitary constraint
Eq. 7 is weakened to that of Thm. 2. Ultimately, we
must compute some achievable (A, B, C, D) from a par-
tial speciﬁcation in order to ﬁnd the phases ~φ.

Fortunately, the structure of achievable partial tuples
can be exploited to derive a algorithm resembling those
for polynomials sum-of-squares problems [32], but spe-
cialized to the symmetries of Thm. 2. We present results
for (A, B·,·), (A,·, C,·) of odd degree and show how they
apply to all achievable 2-partial tuple.

Lemma 2 (Transition probability sum-of-squares). ∀ 2-
partial tuples (A, B,·,·) of odd degree at most L that
satisfy the conditions (3a,3b) of Thm. 2, ∃ achievable
(A, B, C, D) of degree at most L that can be computed in
time poly(L).

Proof. Consider the real polynomial of degree at most L

f (λ) = 1 − A2(√1 − λ) − B2(√1 − λ),
and group its roots S = {s | f (s) = 0} as follows:
S0 = {s ∈ S | s = 0}, Sc = {s ∈ S | Im[s] 6= 0}, (12)
Sr = {s ∈ S | Re[s] 6= 0 ∧ Im[s] = 0}.
And so we factorize

(11)

f (λ) = K 2λ|S0| Ys∈Sr
(λ − s) Ys∈Sc(cid:0)(λ − Re[s])2 + Im[s]2(cid:1) , (13)
with scale constant K ∈ R. Using (3b), f (λ) ≤ 0, ∀λ ≤
0. Hence all positive roots in Sr occur with even mul-
tiplicity. Using (3a), f (λ) ∈ [0, 1], ∀λ ∈ [0, 1]. As f (λ)
changes sign at λ = 0, |S0| is odd. Using the oddness of
A, B, f (λ) ≥ 1, ∀λ ≥ 1. Since f (λ) ≥ 0, ∀λ ≥ 0, all neg-
ative roots in Sr occur with even multiplicity. Thus all
real roots excluding s = 0 occur with even multiplicity.
By repeated application of the two-squares identity

(r2 + s2)(t2 + u2) = (rt ± su)2 + (ru ∓ st)2,

(14)

the complex factors

Ys∈Sc(cid:0)(λ − Re[s])2 + Im[s]2(cid:1) = g2(λ) + h2(λ),

(15)

where g, h are real polynomials in λ. Thus f (λ) =
C2(√λ) + D2(√λ) where
D(y)(cid:27) = Ky|S0| Ys∈Sr
(cid:26)C(y)

2!(cid:26)g(y2)
h(y2)(cid:27) ,

(16)

1

(y2 − s)

5

and C, D are odd real polynomials of degree at most L.
Note that diﬀerent choices of signs Eq. 14 generates a
ﬁnite number of diﬀerent valid solutions. Computing the
roots of f (λ) is the most diﬃcult step of this algorithm,
but can be done in time O(poly(L)) [33].

The proof for even L, and tuples (·,·, C, D) carries
through with minor modiﬁcation. The stated conditions
in Thm. 2 guarantee that the various factors of λ, (1− λ)
necessary for the correct symmetry of the unspeciﬁed
polynomials occur with the right multiplicity, and that
all other real roots occur with even multiplicity. Some
additional processing for the (·,·, C, D) case is required
as the output (A, B, C, D) is not guaranteed to satisfy
A(1) = 1. However, A(1)2 + B(1)2 = 1 is still true so
by computing γ = Arg[A(1) + iB(1)], we can form an
achievable (A cos γ + B sin γ, B cos γ − A sin γ, C, D). We
now present the analogous algorithm for (A,·, C,·).

Lemma 3 (Fidelity response sum-of-squares). ∀ 2-
partial tuples (A,·, C,·) of odd degree at most L that sat-
isfy condition (1a) of Thm. 2, ∃ achievable (A, B, C, D)
of degree at most L that can be computed in time poly(L).

Proof. With the Weierstrass substitution x = 1−t2
2t
1+t2 , we deﬁne the polynomials

1+t2 , y =

( ˜A(t), ˜B(t), ˜C(t), ˜D(t)) = (1 + t2)L(A, B, C, D)

(17)

These polynomials have extremely useful symmetries.
˜A, ˜B are Even hEi aNtipalindromes hNi while ˜C, ˜D
are Odd hOi Palindromes hPi. Antipalindromes sat-
isfy ˜A(t) = −t2L ˜A(t−1) whereas palindromes satisfy
˜C(t) = t2L ˜C(t−1). Note that hEi,hOi and hPi,hNi poly-
nomials with multiplication form a group isomorphic to
Z2 × Z2. For example, hENihOPi = hONi. Consider the
positive polynomial

(t − s), (18)

˜f (t)= (1 + t2)2L − ˜A2(t) − ˜C2(t) = K 2Ys∈S
with scale constant K ∈ R, and 4L − |S0| roots S =
{s | f (s) = 0}, where |S0| is the multiplicity of the zero
roots. Note that, ∀ roots s 6= 0, ∃ roots s∗,−s, and s−1
as due to the symmetries of ˜f (t). We group these roots
as follows:

(19)

S0 = {s ∈ S | s = 0}, S1 = {s ∈ S | s = 1},
Sr = {s ∈ S | Re[s] > 1 ∧ Im[s] = 0},
Si = {s ∈ S | Re[s] = 0 ∧ Im[s] = 1},
Su = {s ∈ S | |s| = 1 ∧ 0 < Arg[s] < π/2},
Sι = {s ∈ S | Re[s] = 0 ∧ Im[r] > 1},
Sc = {s ∈ S | |s| > 1 ∧ 0 < Arg[s] < π/2}.

From the real roots, we construct the factor

D. Selection of quantum response functions

6

1

2 (t2 − 1) |S1|
2 hENi |S1|

2 Qs∈Sr(cid:0)t4 − t2(s2 + s−2) + 1(cid:1)
2 hEPi |Sr|2 .

fr = t |S0|
hfri = hOPi |S0|
The positiveness of ˜f (t) means that all real factors have
even multiplicity. Thus fr is a polynomial. From roots
s = ±i, we form

(20)

2 ,

fi = (t2 + 1)

|Si|
2 ,

hfii = hEPi

|Si|
2 .

(21)

From all other complex roots, we form

(22)

(t2 − 1)2 + (2t sin (Arg[s]))2,
(t2 − 1)2 + (t(Im[s] + Im[s]−1))2,

fu =Qs∈Su
fι =Qs∈Sι
fc =Qs∈Sc(cid:0)t4 − t2(|s|−2 + 4 sin2 (Arg[s]) + |s|2) + 1(cid:1)2

+(cid:0)2(t3 − 1) Im[s](cid:0)1 − |s|−2(cid:1)(cid:1)2

The symmetry of terms under the squares is one of
hEPi,hENi,hOPi,hONi, and occur in a combination that
forms a group under repeated application of the two-
squares identity of Eq. 14. Thus we can construct

.

fufιfc = g2 + h2,

(23)

hgi = hENi|Su|+|Sι|,
˜f (t) = (Kfrfig)2 + (Kfrfih)2.

hhi = hOPi|Su|+|Sι|,

For some combinations of multiplicities, this decompo-
sition will not produce polynomials with the symmetry
hENi,hOPi required by ˜B, ˜D. However, summing the
multiplicities of these roots shows that such combina-
tions do not exist. From this decomposition, we compute
B(x), D(y) using

bk = 1

d2k+1 = (−1)k

n=0

m=0(−1)m(cid:0) n

˜b2nhPn
k−m(cid:1)i ,
2L PL
m(cid:1)(cid:0)L−n
˜d2n+1hPn
2L PL−1
m=0P⌊L/2⌋
p=0 (−1)m(cid:0)p
k(cid:1)
m(cid:1)i .
2p−m+(1−(−1)L)/2(cid:1)(cid:0) n
(cid:0)

L−n−1

n=0

(24)

As with Lem. 2, diﬀerent choices of signs in the two-
squares identity lead to multiple valid solutions. Com-
puting the roots of ˜f (t) is the still most diﬃcult step, but
can be done in time O(poly(L)).

The case of even L replaces Eq. 18 with ˜f (t) = (1 +
t2)2L− ˜A2(t)−( 1−t2
1+t2 )2 ˜C2(t) and we ﬁnd ˜B with hEPi and
(1− t2) ˜D with hONi symmetry . A similar root counting
argument guarantees the existence of such solutions. The
coeﬃcients of B(x), D(y) are then computed also using
Eq. 24. This procedure carries through without modiﬁ-
cation for the other tuples (1) ,(2) of Thm. 2.

It should be clear that optimal composite gate design is
a systematic process no more diﬃcult than choosing one
or two polynomials optimal for some objective function.
Nevertheless, problem (P4) is that computing these op-
timal polynomials could still be a diﬃcult task. However,
the constraints on achievable partial tuples in Thms. 2,3
seem fairly lax, which lends hope that this could be done
eﬃciently. In fact these constraints are consistent with
textbook problems in approximation theory [34].

It is at this point where a close connection with
discrete-time signal processing [26] is made. Eﬃcient al-
gorithms [35–39] for designing polynomials optimal for
arbitrary objective functions under a variety of opti-
mality criteria have been extensively studied for ﬁnite-
impulse response ﬁlters [27]. We thus inherit much of
this machinery, and in many cases, existing polynomi-
als consistent with achievability have already been found
and are directly transferable!

A most common optimality criterion is the Chebyshev
norm: Let Po(x) be the objective function, with contin-
uous weight function W (x) > 0, to be approximated by
a polynomial P (x) of degree L on a bounded subset B of
the closed interval B ∈ [−1, 1) with the smallest Cheby-
shev error norm

ǫ = max

x∈B |W (x) (P (x) − Po(x))|.

(25)

The unique best approximation can be computed eﬃ-
ciently by Ramez-type exchange algorithms [40]. Many
variants exist such as where P (x) is a trigonometric poly-
nomial [35], bounded [37], subject other unary or linear
constraint [38], and even complex [36]. Linear program-
ming methods [38] provides an alternate solution. Eﬃ-
cient algorithms for other optimality criteria such as least
squares are also available [41, 42].

These algorithms eﬃciently solve the problem of op-
timization over achievable quantum response functions
ˆU (θ) where the objective functions are 2-partial or 3-
partial tuples. Optimization for a 3-partial objective
function involves a single quadrature from (A, B, C, D)
together with a single real objective function Po(θ). Thus
we optimize over P (θ) for Po(θ) in Eq. 25 subject to
the constraints of Thm. 3 for the corresponding quadra-
ture. The slightly more complicated 2-partial case in-
stead speciﬁes two quadratures and real objective func-
tions Po,1(θ), Po,2(θ). Thus we deﬁne Po(θ) = Po,1(θ) +
iPo,2(θ), and optimize over P (θ) = P1(θ) + iP2(θ) for
Po(θ) subject to the constraints of Thm. 2 for the corre-
sponding quadratures. Note that the unitarity inequality
constraint poses no diﬃculty as |P (θ)|2 = P 2
2 (θ).

1 (θ) + P 2

E. The methodology of composite quantum gates

Our eﬀorts have led us to a methodology for the design
of single spin quantum response functions ˆU (θ) through

composite quantum gates built from a sequence of L
primitive gates all rotating by θ, but each with its own
phase ~φ = (φ1, ..., φL). The procedure is systematic, ﬂex-
ible, and most importantly, provably eﬃcient:

Problem statement: Given L ≥ 1 and objective func-
tion ˆU (θ) for either 3-partial or 2-partial tuples,
ﬁnd the composite quantum gate that implements
through ~φ the optimal ǫ-approximation to ˆU (θ).

Solution procedure:
(S1): Check that ˆU (θ) is consistent with achievability.

–Satisﬁes conditions of Thms. 2,3.

(S2): Choose optimality criterion.

–The Chebyshev norm is most common.

(S3): Execute polynomial optimization algorithm over

achievable partial tuples.

–Ramez-type algorithms are eﬃcient.

(S4): Compute achievable tuple from partial tuple.
–This can be done eﬃciently by Lems. 2, 3.

(S5): Compute phases ~φ.

–This can be done eﬃciently by Lem. 1.

IV. EXAMPLES

We now execute this methodology to eﬃciently cre-
ate optimal bandwidth B composite quantum gates built
from L equiangular primitive gates acting on a single
spin. These composite gates have a ﬁdelity response func-
tion Fχ(θ) bounded below by 1 − I over the widest con-
tiguous range of θ ∈ B. These provide a solution to the
problem of applying arbitrary quantum gates with a sub-
wavelength spatial selectivity that is shown to be optimal
and far surpasses state-of-art.

From our characterization of achievable ˆU (θ)

in
Sec. III A, this is equivalent to an optimization prob-
lem over achievable (A,·, C,·). Let us construct optimal
bandwidth polynomials of odd degree L for the even sim-
pler 3-partial tuple (A,·,·,·):

A = argmax

A

(cid:8)|B|(cid:12)(cid:12) ∀x ∈ B,|A(x) − Po(x)| ≤ ǫ(cid:9) .

(26)

It may not be surprising that an eﬃcient algorithm ex-
ists [39]. Achievability is respected by imposing the ap-
propriate symmetry on Po(x) and ensuring that A2(x) ≤
1. The unary constraint A(1) = 1 is easily incorporated.
From here on, we drop the |·| notation for the width |B|.
In the following, we choose the objective functions
Po(x) = 0 and Po(x) = 1. The resulting polynomials,
which we name DC and M, are presented in Sec. IV A.
These are applied to the creation of various useful com-
posite gates in Sec. IV A, namely narrowband population
inversion gates (S), broadband NOT gates (OB, BBn),
and broadband identity gates (ID). The ID gate is shown
in Sec. IV C to solve the problem of implementing arbi-
trary quantum gates with optimal sub-wavelength spatial
selectivity.

7

A. Optimal bandwidth polynomials

Consider Po(x) = 0 and target error ǫ = √

I. The
solution is the Dolph-Chebyshev window function [43, 44]
famous in discrete-time signal processing.

DCL,I(x) = √

ITL (βL,Ix) , βL,I = TL−1(I−1/2), (27)
where Tn(x) = cos (n arccos (x)) are Chebyshev polyno-
mials. The ripples of DC2
L,I(x) bounded by I in Fig. 1
are a generic property of optimal bandwidth polynomials.
This is in contrast to monotonic increase of the limiting

DCf(x) = lim
I→0

DCL,I(x) = xL,

(28)

which solves the optimality criterion of maximal ﬂatness,
labeled by the subscript f. Note that ﬂat solutions have
signiﬁcantly narrower bandwidth. Using x = cos (θ/2),
the bandwidth in θ coordinates is to order O(I
= 41−L.

(29)

2L )

,

3

B = 23− 1
L I

1

2L , Bf = 4I

1
2L
f

I
If

Given the same target bandwidth, the worst-case error
of DCL,I is exponentially smaller than DCf. Note also
the quadratic diﬀerence in the scaling with L of the band-
width over which DCL,I does not approximate F (x) = 0.
¯B = 4arcsech√

L + O( 1

L3 ), ¯Bf = 4q log 1

+ O( 1

). (30)

I

L

L

I

3
2

Now consider Po(x) = 1 with target error ǫ = 1 −
√1 − I. This choice of ǫ is made so that 1−I will later be
the composite gate ﬁdelity. We label the solution ML,I.
As seen in Fig. 1(inset), they exhibit ripples similar to
DCL,I(x). In the following, we drop the subscripts where
appropriate. For L = 5, we have

M5,I = (2x1+1)x5−(4x3
I = (x1−1)3(1+3x1+x2

3125x6

2x3

1(x1+1)2
1)2(1−2x1−4x2
1(1+x1)4(1+2x1)3

1+3x2

1+2x1+1)x3+(2x5

1+4x4

1+6x3

1+3x2

1)x

,

1)(3+9x1+8x2

1)3

. (31)

For larger L, the ML,I can always be computed numer-
ically. However, we provide approximate solutions that
provide insight into their asymptotic behavior. The max-
imally ﬂat solution limI→0 M(x) = O((x − 1)
2 (cid:19)L−j(cid:18) 1 − x
2 (cid:19)j

j(cid:19)(cid:18) 1 + x

Mf(x) =

(L−1)/2

2 ) is

Xj=0 (cid:18)L

(32)

L+1

.

An alternate deﬁnition of ML,I for L = 4N + 1 pins M(x)
and its derivatives to

M(1) = M(xk) = 1,

dM(xk)

dxk

= 0,

k ∈(cid:2)1, L−1

4 (cid:3) , (33)

for some set of xk. By comparing the leading coeﬃcients

8

L

I

~φ where φk = φL−k+1
, tan−1 t2, 0, ...), t2 =q 8x3

Eq. 31 5 2(tan−1 −t2
1+2x1
10−2
10−4
10−6
10−2 13 (2.390, 0.771, 2.791, 2.824, 2.115, 4.573, 4.888, ...)
10−4 13 (2.233, 0.455, 2.853, 2.862, 1.838, 4.558, 5.041, ...)
10−6 13 (2.159, 0.314, 2.874, 2.877, 1.677, 4.495, 5.092, ...)

(2.987, 5.166, 4.021, 1.678, 2.815, ...)
(2.889, 5.334, 4.042, 1.490, 2.926, ...)
(2.844, 5.381, 4.034, 1.414, 2.976, ...)

1+8x2
1+2x1

1−1

9
9
9

FIG. 2. (color) Worst-case inﬁdelity I of compensated NOT
gates (·, 0, ML,I(sin (θ/2)), ·) optimized for bandwidth B plot-
ted for L = 5, 9, ..., 25 (from top). Exact solutions (points)
are well approximated by Eq. 36 (solid), and are expo-
nential smaller I/If = 21−L than that of maximally ﬂat
gates (·, 0, Mf, ·) (dashed). The table provides examples of
~φ rounded to 3 decimal places.

(37)

we can apply Lem. 1 to eﬃciently compute its implemen-
tation with ~φ. In any case, closed-form solutions exist in
earlier work [8, 45]: φk = φL−k+1 where φ1 = 0 and
L,I(cid:21).
L (cid:19)q1 − β−2
φk+1 = φk + 2 tan−1(cid:20)tan(cid:18) 2jkπ
OB = (·, 0, ML,I(y),·) is a compensated broadband
NOT gate. It implements the NOT gate R0(π) with high
ﬁdelity Fπ(θ) ≥ 1−I, ∀θ ∈ B over a wide range of θ with-
out any σz error. Using Lem. 3 followed by Lem. 1, we
can eﬃciently compute (A, B, C, D) and hence its imple-
mentation ~φ. We provide some examples in Fig. 2.
BBn = (·, 0, Mf(y),·) deserves special mention.

It is
the limiting ﬂat case of OB and implements NOT with ﬁ-
delity Fπ(θ) = 1−O((θ−π)2n+2). Gates of this form with
optimal correction order n for some given L [13, 19, 46]
have been constructed by brute force up to L = 25 lead-
ing to a conjecture that n = L−1
2 . Our construction
proves this as Mf(y) expanded about y = 1 is ﬂat in the
ﬁrst L−1
2 derivatives. This exact form Mf was not pre-
ciously known, and we can compute its implementation
~φ eﬃciently. A comparison in Fig. 2 with OB reveals a
tremendous separation in performance. From Eq. 36, the
L−1
L+1 . In
bandwidth of ML,I exceeds that of Mf by factor 2
other words, given the same target bandwidth, the OB
gate oﬀers an exponentially superior worst-case inﬁdelity
I
If

= 21−L.
ID = (ML,I(y), 0,·,·) is a compensated broadband
It implements identity R0(0) with high
identity gate.
ﬁdelity F0(θ) ≥ 1 − I, ∀θ ∈ B over a wide range of θ
without any σz error. This unassuming gate solves the

FIG. 1. (color) DCL,I (black), ML,I (teal) polynomials plot-
ted for L = 9 and target worst-case inﬁdelity I = 10−2 (solid)
and I → 0 (dashed), indexed by f. The observed ripples are
a generic feature of bandwidth optimized polynomials, unlike
those optimized for maximal ﬂatness DCf, Mf. The inset plots
their squares and deﬁnes the bandwidth B in x coordinates.

of DCf(x), Mf(x − 1), let us choose for for I ≪ 1,
(L + 1)/2(cid:19),

cos(cid:16) π(2k−1)
L+1 (cid:17)

2L(cid:18)

2 , 1−√1−Iκ

xk =

β L+1

κ =

L

1

,

(34)

which are poles of DC(L+1)/2,(1−√1−I)/κ(√1 − x2). This
approximates in the neighbourhood of |x| ≤ 1
(cid:16)p1 − x2(cid:17) .

ML,I(x) ≈ 1 − κDC2

1−√1−Iκ

(35)

β L+1

2

,

The bandwidth B of ML,I(x), plotted in Fig. 2 is well
approximated in this regime by Eq. 29 with the replace-
ments L → L+1
L+1 ),
B = 23− 2

and I → 1−√1−Iκ
L+1 , Bf = 4( If
2κ )

. To order O(I
L+1 , I
If

L+1 ( I2κ )

= 21−L.

(36)

2

2

1

1

Once again, given the same target bandwidth, the error
of the ML,I is exponentially smaller than its ﬂat variant.

B. Optimal bandwidth composite quantum gates

With these optimal bandwidth polynomials DCL,I(x)
and ML,I, we can design a variety quantum response
functions with ﬁdelity or transition probability responses
that remain unchanging over wide range of θ parameters.
S = (·,·, DCL,I(x), 0) is a highly selective narrowband
population inversion gate. It has transition probability
bounded by ∀θ ∈ B, p(θ) ≤ I, over a wide range of θ
and only in a very narrow region does it spike to 1. It
is easy to verify that this quantum response function is
achievable. Thus we can eﬃciently compute the unspec-
iﬁed A, B quadratures using Lem. 2. With (A, B, C, D),

sub-wavelength spatial selectivity problem in Sec. IV C.
As with all the above, its implementation ~φ is eﬃciently
computed with examples in Fig. 3.

Further novel combinations can be

constructed.
For example, broadband population inversion gates
(DCL,I(x), 0,·,·) [8] that reﬂect states |0i ↔ |1i about
the σx − σy plane, or (DCL,I(x),·,·, 0) for reﬂections
|−i ↔ |+i about the σz − σy plane, or (·, ML,I,·, 0) for
broadband −iσz gates. However, we shall not consider
them further. Their behavior is easily understood and
their implementation in ~φ is eﬃciently computed.

C. Composite quantum gates for sub-wavelength

spatial selectivity

Consider a plane covered in spins with a minimum
spin-spin separation of d. Our goal is to implement a
perfect unitary gate R0(χ) of arbitrary rotation |χ| ≤ π
on any one of these spin while performing the identity
gate with inﬁdelity at most I on all other spins. At our
disposal is a single gaussian beam of ﬁxed width λ, so any
applied primitive gate rotates by θ(r) = θ0e−r2/2λ2
. Note
in particular the single gate bandwidth ¯B1 = log2 π2
, be-
4I
λ < ¯B1 it becomes impossible to avoid
low which at d
illuminating neighbouring spins.
It is well-known that narrowband composite gates
of length L solving this problem exist.
Indeed, beam
λ ≈ 0.7 ¯B1 [10, 13] have
width reductions by factor d
been reported. Further reduction is possible with longer
gates [19], but with poor scaling d
λ = O(L−1/4). Using
the broadband identity gate ID = (ML,I(x), 0,·,·) pre-
sented in Sec. IV B, we improve this substantially by an
optimal square-root factor to d

λ = O(L−1/2).

Let us compose ID with the gaussian beam to produce

the spatially-varying quantum response function

ˆUspace(r) = ID(θ0e−r2/2λ2

) = ID(θ0) + O(r2),

(38)

for some choice |θ0| ≤ π. Note that ˆUspace(r) is sta-
ble with respect to beam-pointing errors in r due to the
vanishing ﬁrst derivative. The degree of spatial selec-
tivity is easily computed from the bandwidth in Eq. 30.
From Eq. 5, the ﬁdelity response function with respect
to identity is F0(θ) = M2
L,I(x). Thus, identity is imple-
mented with inﬁdelity at most I on all spins located at
r ≥ d ≥ λ ¯Bspace as seen in Fig. 3, where to leading order
O(L−1/2),

¯Bspace
λ

= 2s 2arcsechq 1−√1−Iκ

π(L+1)

− lnq π

θ0

.

Meanwhile at r = 0, we obtain the gate

ˆUspace(0) = Rγ(cid:0)2 cos−1 (ML,I (cos (θ0/2)))(cid:1) .

where γ = Arg[C(sin θ0

2 ) + iD(sin θ0

2 )]. The desired ro-

(39)

(40)

9

I

L

Eq. 31 5 2(0, tan−1 t1, tan−1
10−2
9
10−4
9
10−6
9
10−2 13
10−4 13
10−6 13

~φ where φk = φL−k+1

t1

1−4x2

1

, ...), t1 =p8x3

(0, 0.772, 4.357, 2.827, 3.886, ...)
(0, 1.087, 4.501, 2.707, 3.961, ...)
(0, 1.235, 4.601, 2.695, 4.029, ...)

1 + 8x2

1 − 1

(0, 1.450, 3.683, 2.501, 3.220, 5.577, 5.728, ...)
(0, 1.872, 4.326, 2.844, 3.602, 6.271, 0.257, ...)
(0, 2.077, 4.616, 2.978, 3.742, 0.250, 0.578, ...)

2 e−r2/λ2

(color) Inﬁdelity of spatially selective composite
FIG. 3.
gates (ML,10−4 (cos ( θ0
)), 0, ·, ·) plotted for θ0 = π and
L = 1, ..., 25 (solid, from right). The eﬀective beam width
¯Bspace = O(L−1/2)(inset) beyond which the identity gate is
well-approximated is dramatically reduced over that of a sin-
gle gate ¯B1. By varying θ0, arbitrary unitary gates can be ap-
plied at r = 0 with high beam-pointing stability. Poorer scal-
ing ¯Bspace = O(L−1/4) results from using the ﬂat (Mf, 0, ·, ·)
(dashed). The table provides examples of ~φ to 3 decimal
places.

2 σz ˆUspace(0)ei γ

tation R0(χ) is thus obtained by choosing θ0 such that
cos (χ/2) = M(cos (θ0/2)) and rotating all phases φk ←
φk+γ, which follows from e−i γ
2 σz = R0(χ).
The optimality of these results follows from the con-
struction of ML,I as optimal bandwidth polynomials. In
particular, using the ﬂat polynomial Mﬂat(x) leads to
the scaling ¯Bspace = O(L−1/4) found in prior art and
Fig. 3(inset). A further square-root improvement to
achieve Heisenberg-limited scaling ¯Bspace = O(L−1) [8]
is possible at non-zero r where the gradient of θ(r) is
non-zero, but at the cost of beam-pointing stability and
applying R0(χ) along a ring of radius r.

V. CONCLUSION

We have presented and applied a methodology for the
systematic design of quantum response functions through
composite quantum gates of length L, where all steps are
provably eﬃcient with time complexity O(poly(L)). In
the process, an elegant and practical connection made
with discrete-time signal processing allows us to inherit
and adapt many existing algorithms and polynomials
used in the design of classical response functions for this
quantum problem. Vast potential remains untapped in
that hallowed ﬁeld, and interdisciplinary exchange could
spur the discovery of further connections, leading to the
development of applications previously undreamed of but
perhaps now within reach.

Our work also bridges discrete-time signal processing

10

and quantum query algorithms for evaluating symmetric
boolean functions. The idea here is that the SU(2) space
of a single-qubit, as we study here, is isomorphic to the
SU(2) subspace spanned by a uniform superposition of
marked states and a uniform superposition of unmarked
state in such a query problem. Query algorithms can be
built to calculate a boolean function f : {0, 1}n → {0, 1}
that depends only on the number of marked states (i.e.
f (x) = ˜f (|x|) for some ˜f : {0, 1, . . . , n} → {0, 1}) and
do so with a Grover-type algorithm of partial reﬂections
[22, 47–49]). Thus, the same methods introduced
(e.g.
here also give a way to determine how many reﬂections
(analogous to our L) and what reﬂections (analogous to
our φj ) are required to compute any particular symmet-
ric boolean function, achieving the known lower bounds
for this problem, which (not) coincidentally are also de-
rived using polynomials [50]. As examples of this corre-
spondence, DCL,I is an optimal solution for OR [45] and
ML,I is optimal for Majority.

Other thought provoking extensions are also moti-
vated. The set of achievable quantum response functions
is changed by introducing elements such as additional
(possibly continuous) control parameters, disturbances,
coupled spins [10, 51, 52], or open systems [20, 53]. These
all enable their own unique applications, but also appear
diﬃcult to solve somehow systematically and intuitively.
Our success in the case of composite gates provides at
least supporting evidence that a useful characterization
as well as eﬃcient methods for these more complex design
problems could exist.

VI. ACKNOWLEDGEMENTS

G.H.Low acknowledges funding by NSF RQCC Project
No.1111337 and NRO. T.J.Yoder acknowledges funding
by NDSEG. We thank Alan Oppenheim and Tom Baran
for inspiring discussions, and connections made possible
by their 6.341x open online MITx course.

[1] L. M. K. Vandersypen and I. L. Chuang, “NMR
for quantum control and computation,”

techniques
Rev. Mod. Phys. 76, 1037–1069 (2005).

[2] R Freeman, Spin choreography (Oxford University Press

Oxford, UK, 1998).

[3] Michael A. Nielsen and Isaac L. Chuang, Quantum Com-
putation and Quantum Information, 1st ed. (Cambridge
University Press, 2004).

[4] Malcolm H. Levitt, “Composite pulses,” in eMagRes

(John Wiley & Sons, Ltd, 2007).

[5] Navin Khaneja, Timo Reiss, Cindie Kehlet, Thomas
and Steﬀen J. Glaser, “Opti-
Schulte-Herbr¨uggen,
mal control of coupled spin dynamics:
design of
NMR pulse sequences by gradient ascent algorithms,”
J. Mag. Res. 172, 296 – 305 (2005).

[6] K. Arai, C. Belthangady, H. Zhang, N. Bar-Gill, S. J.,
DeVience, P. Cappellaro, A. Yacoby,
and R. L.,
Walsworth, “Fourier magnetic imaging with nanoscale
resolution and compressed sensing speed-up using elec-
tronic spins in diamond,” Nat. Nano 10, 859–864 (2015).
[7] T. H¨aberle, D. Schmid-Lorch, K. Karrai, F. Rein-
hard, and J. Wrachtrup, “High-dynamic-range imaging
of nanoscale magnetic ﬁelds using optimal control of a
single qubit,” Phys. Rev. Lett. 111, 170801 (2013).

[8] Guang Hao Low, Theodore J. Yoder,

and Isaac L.
Chuang, “Quantum imaging by coherent enhancement,”
Phys. Rev. Lett. 114, 100801 (2015).

[9] Boyan T. Torosov and Nikolay V. Vitanov, “Smooth com-
posite pulses for high-ﬁdelity quantum information pro-
cessing,” Phys. Rev. A 83, 053420 (2011).

[10] J. T. Merrill, S. C. Doret, Grahame Vittorini, J. P.
Addison,
and Kenneth R. Brown, “Transformed
composite sequences for improved qubit addressing,”
Phys. Rev. A 90, 040301 (2014).

[11] J. Vanier, “Atomic clocks based on coherent population
trapping: a review,” App. Phys. B 81, 421–442 (2005).

[12] Shelby Kimmel, Guang Hao Low,

Yoder, “Robust
qubit
robust
set
Phys. Rev. A 92, 062315 (2015).

gate

via

calibration of a universal

and Theodore J.
single-
estimation,”

phase

[14] Holly K. Cummins, Gavin

[13] S. Wimperis, “Broadband, narrowband, and passband
composite pulses for use in advanced NMR experiments,”
J. Mag. Res., Series A 109, 221 – 231 (1994).
Llewellyn,

and
Jonathan A.
errors
in quantum logic gates with composite rotations,”
Phys. Rev. A 67, 042308 (2003).

systematic

“Tackling

Jones,

[15] Kenneth R. Brown, Aram W. Harrow,

and Isaac L.
Chuang, “Arbitrarily accurate composite pulse se-
quences,” Phys. Rev. A 70, 052318 (2004).

S.

[16] G¨otz
alive
Phys. Rev. Lett. 98, 100504 (2007).

optimized

“Keeping

Uhrig,

by

a

π-pulse

quantum bit
sequences,”

[17] Xin Wang, Lev S. Bishop, J.P. Kestner, Edwin Barnes,
Kai Sun,
and S. Das Sarma, “Composite pulses
for robust universal control of singlet-triplet qubits,”
Nat. Commun 3, 997– (2012).

composite
computation,”

[18] Jonathan

A.

Jones,

“Nested

gates

NOT
Phys. Lett. A 377, 2860 – 2862 (2013).
[19] Guang Hao Low, Theodore J. Yoder,

quantum

for

and Isaac L.
Chuang, “Optimal arbitrarily accurate composite pulse
sequences,” Phys. Rev. A 89, 022341 (2014).

[20] A. Soare, H. Ball, D. Hayes, J. Sastrawan, M. C. Jarratt,
J. J. McLoughlin, X. Zhen, T. J. Green, and M. J. Bier-
cuk, “Experimental noise ﬁltering by quantum control,”
Nat. Phys 10, 825–829 (2014).

[21] Xin Wang, Lev S. Bishop, Edwin Barnes, J. P. Kest-
ner,
and S. Das Sarma, “Robust quantum gates
for singlet-triplet spin qubits using composite pulses,”
Phys. Rev. A 89, 022310 (2014).

[22] Gilles Brassard, Peter Høyer, and Alain Tapp, “Quan-
tum counting,” in Automata, Languages and Program-

ming (Springer, 1998) pp. 820–831.

[23] Steﬀen J Glaser, Ugo Boscain, Tommaso Calarco,
Christiane P Koch, Walter K¨ockenberger, Ron-
nie Kosloﬀ,
Ilya Kuprov, Burkhard Luy, Sophie
Schirmer, Thomas Schulte-Herbr¨uggen, et al., “Train-
ing Schr¨odinger’s cat: Quantum optimal control,”
Eur. Phys. J. D 69, 1–24 (2015).

[24] J.

Ruths

and

trol
IEEE Trans. Autom. Control 57, 2021–2032 (2012).

of

S.

Li,
J.
inhomogeneous

“Optimal

con-
ensembles,”

[25] I. Michael Ross and Mark Karpenko, “A review of
pseudospectral optimal control: From theory to ﬂight,”
Annu. Rev. Control 36, 182 – 197 (2012).
R.W.

Oppenheim

[26] A.V.

and

Discrete-time Signal Processing , Prentice-Hall
processing series (Prentice Hall, 1989).

Schafer,
signal

[27] F.J. Harris, “On the use of windows

for har-
monic analysis with the discrete fourier transform,”
Proc. IEEE 66, 51–83 (1978).

[28] Chingiz Kabytayev, Todd J. Green, Kaveh Khod-
and
compos-
noise,”

jasteh, Michael J. Biercuk, Lorenza Viola,
Kenneth R. Brown,
ite
Phys. Rev. A 90, 012316 (2014).
N.

time-dependent

“Robustness

Khaneja,

control

[29] J.

pulses

and

Li

to

S.

of

semble
IEEE Trans. Autom. Control 54, 528–536 (2009).

control

bloch

of

“En-
equations,”

[30] Jr-Shin Li, Justin Ruths, Tsyr-Yan Yu, Haribabu Artha-
nari,
and Gerhard Wagner, “Optimal pulse design in
quantum control: A uniﬁed computational method,”
Proc. Natl. Acad. Sci. U.S.A. 108, 1879–1884 (2011).

[31] M. H. Stone, “The generalized weierstrass approximation

theorem,” Mathematics Magazine 21, 167–184 (1948).

[32] Murray Marshall, Positive polynomials and sums of

squares, 146 (American Mathematical Soc., 2008).
“An

[33] C.Andrew Neﬀ and

John H. Reif,

eﬃ-
complex roots problem,”

cient algorithm for
J. Complex 12, 81 – 115 (1996).

the

[34] G¨unter Meinardus, Approximation of functions: Theory
and numerical methods, Vol. 13 (Springer Science & Busi-
ness Media, 2012).

T. Parks,

[35] J. McClellan,
computer

“A
timum
IEEE Trans. Audio Electroacoust. 21, 506–526 (1973).

program

phase

linear

FIR

for

and L. Rabiner,
op-
ﬁlters,”

designing

digital

[36] Lina J. Karam and James H. McClellan, “Chebyshev dig-
ital ﬁr ﬁlter design,” Signal Process. 76, 17 – 36 (1999).
[37] Francis Grenez, “Design of linear or minimum-phase
FIR ﬁlters by constrained chebyshev approximation,”
Signal Process. 5, 325–332 (1983).

11

[38] Mathias Lang, Algorithms for the Constrained Design of
Digital Filters with Arbitrary Magnitude and Phase Re-
sponses, Ph.D. thesis, Vienna University of Technology
(1999).

[39] Edward M Hofstetter, A new technique for the design of
non-recursive digital ﬁlters, Tech. Rep. (Lincoln Labora-
tory, 1970).

[40] W. Fraser, “A survey of methods of

computing
minimax and near-minimax polynomial approxima-
tions for functions of a single independent variable,”
J. ACM 12, 295–314 (1965).

[41] Y. C. Lim, J. H. Lee, C. K. Chen,

and R. H.
Yang, “A weighted least squares algorithm for quasi-
equiripple FIR and IIR
digital ﬁlter design,”
IEEE Trans. Signal Process. 40, 551–558 (1992).

[42] P. Vaidyanathan and Truong Nguyen,

“Eigenﬁl-
A new approach to least-squares FIR ﬁl-
ters:
ter design and applications including Nyquist ﬁlters,”
IEEE Trans. Circuits Syst. 34, 11–23 (1987).

[43] C. L. Dolph, “A Current Distribution for Broad-
the Relationship
Level,”

side Arrays Which Optimizes
between Beam Width
Proc. IRE 34, 335–348 (1946).

Side-Lobe

and

[44] Peter Lynch, “The Dolph-Chebyshev window:

A
optimal ﬁlter,” Monthly Weather Review,

simple
Mon. Wea. Rev. 125, 655–660 (1997).

[45] Theodore

J. Yoder, Guang Hao Low,

L.

Isaac
search with
Phys. Rev. Lett. 113, 210501 (2014).

Chuang,
an

optimal

number

“Fixed-point

of

and
quantum
queries,”

[46] Sami Husain, Minaru Kawamura,

and Jonathan A.
Jones, “Further analysis of some symmetric and anti-
symmetric composite pulses for tackling pulse strength
errors,” J. Mag. Res. 230, 145 – 154 (2013).

[47] Lov K. Grover, “A fast quantum mechanical algo-
rithm for database search,” Proceedings of the Twenty-
eighth Annual ACM Symposium on Theory of Comput-
ing, STOC ’96, 212–219 (1996).

[48] Peter Høyer, “Arbitrary phases in quantum amplitude

ampliﬁcation,” Phys. Rev. A 62, 052304 (2000).

[49] Lov K. Grover,

“Fixed-point

quantum search,”

Phys. Rev. Lett. 95, 150501 (2005).

[50] Robert Beals, Harry Buhrman, Richard Cleve, Michele
Mosca, and Ronald de Wolf, “Quantum lower bounds
by polynomials,” J. ACM 48, 778–797 (2001).

[51] Y Tomita,
“Multi-qubit
New J. Phys. 12, 015002 (2010).

J T Merrill,

compensation

and K R Brown,
sequences,”

[52] Svetoslav S. Ivanov and Nikolay V. Vitanov, “Composite

two-qubit gates,” Phys. Rev. A 92, 022333 (2015).

[53] Kaveh Khodjasteh, Daniel A. Lidar, and Lorenza Viola,
“Arbitrarily accurate dynamical control in open quantum
systems,” Phys. Rev. Lett. 104, 090501 (2010).

