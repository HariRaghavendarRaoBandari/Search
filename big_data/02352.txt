Systematic Low-Thrust Trajectory Optimization for a
Multi-Rendezvous Mission using Adjoint Scaling

Fanghua Jiang • Gao Tang

6
1
0
2

 
r
a

M
8

 

 
 
]

M

I
.

h
p
-
o
r
t
s
a
[
 
 

1
v
2
5
3
2
0

.

3
0
6
1
:
v
i
X
r
a

Abstract A deep-space exploration mission with low-thrust
propulsion to rendezvous with multiple asteroids is investi-
gated. Indirect methods, based on the optimal control the-
ory, are implemented to optimize the fuel consumption. The
application of indirect methods for optimizing low-thrust
trajectories between two asteroids is brieﬂy given. An ef-
fective method is proposed to provide initial guesses for
transfers between close near-circular near-coplanar orbits.
The conditions for optimality of a multi-asteroid rendezvous
mission are determined. The intuitive method of splitting the
trajectories into several legs that are solved sequentially is
applied ﬁrst. Then the results are patched together by a scal-
ing method to provide a tentative guess for optimizing the
whole trajectory. Numerical examples of optimizing three
probe exploration sequences that contain a dozen asteroids
each demonstrate the validity and efﬁciency of these meth-
ods.

Keywords asteroid exploration; low-thrust trajectory opti-
mization; indirect methods; adjoint scaling

1 Introduction

Small bodies in the solar system, especially asteroids, have
attracted the attention of both space agencies and scientists
for several decades. Innovative applications such as deﬂect-
ing the Earth-crossing asteroids with new propulsion sys-
tems such as low-thrust propulsion or solar sail have been
widely studied in literature (Casalino and Simeoni 2012;
McKay et al. 2011; Zeng et al. 2011, 2014; Wu et al. 2014;
Gong and Li 2015; McInnes 2002). Low-thrust propulsion
is especially ideal for deep-space missions because of its

Fanghua Jiang
Gao Tang
School of Aerospace Engineering, Tsinghua University

Its successful application in deep-
high speciﬁc impulse.
space missions such as DAWN (Rayman et al. 2007) has
demonstrated its capability to increase the payload. Fuel-
optimal low-thrust trajectories optimization problems are
much more difﬁcult to solve because the low thrust leads to
a long ﬁring of the engine. Interplanetary missions designed
to explore multiple targets promote the scientiﬁc return and
decrease the average expense but also lead to greater chal-
lenges in optimizing low-thrust trajectories. In this paper,
we develop a systematic approach which is used to ﬁnd the
fuel-optimal trajectories of a multi-asteroid rendezvous mis-
sion.

Indirect methods for optimizing low-thrust trajectories
can take advantage of the calculus of variation and thus con-
vert the optimal control problem into a multi-point bound-
ary value problem (MPBVP) (Bryson and Ho 1975). Indi-
rect methods are favored for their efﬁciency and optimal-
ity if proper initial guesses are given. The homotopic ap-
proach (Bertrand and Epenoy 2002; Jiang et al. 2012), nor-
malization of initial adjoint variables (Jiang et al. 2012), and
the switching detection methods (Tang and Jiang 2016) are
widely applied to overcome the difﬁculty arising from the
bang-bang control.

In the problem under discussion, transfers preferably
take place between close near-circular and near-coplanar
orbits, so reasonable simpliﬁcations are applied and the
closed-form energy optimal transfer is solved analytically
to guess the initial adjoint variables. Compared with ran-
dom guesses, providing initial guesses using this method is
more reliable and effective. The simpliﬁcations are based on
Casalino (2014); Gatto and Casalino (2015). Similar meth-
ods have also been used to provide an initial guess for indi-
rect methods (Li and Xi 2012).

The whole trajectories of a multi-asteroid rendezvous
mission should be optimized in order not to lose optimality.
Although the optimization of a low-thrust trajectory from
one asteroid to the next within a ﬁxed time is relatively easy,
the increment of the asteroid number and setting the ren-

2

dezvous moments free signiﬁcantly increase the difﬁculty.
The intuitive method is to split the mission into multiple
legs each of which drops into the transfer from one aster-
oid to another, denoted as the single-leg transfer. These legs
are then solved sequentially. Yang et al. (2015); Jiang et al.
(2014); Casalino et al. (2014) proposed several methods for
optimizing similar missions with multiple targets, but none
of the missions is optimized in whole so the optimality loses.
Our contribution is to develop a systematic method for op-
timizing the whole trajectory in order not to lose optimality.
The difﬁculty arising from the large number of variables is
overcome by the adjoint scaling technique which provides a
tentative guess that is likely to converge because it satisﬁes
most of the boundary conditions.

This paper is organized as follows: in Section 2, the in-
direct methods for optimizing single-leg transfers are intro-
duced. The method for guessing initial adjoint variables is
described.
In Section 3, the necessary conditions for op-
timality when the whole mission is optimized are derived.
The adjoint scaling technique is proposed to provide an ini-
tial guess. In Section 4, numerical examples from the 7th
Global Trajectory Optimization Competition (GTOC7) are
presented to verify the validity of these methods. The low-
thrust trajectories of three probes which must rendezvous
with more than 10 asteroids each are optimized. The results
show that our methods can save a considerable amount of
fuel. Finally the conclusion is given in Section 5.

2 Fuel-Optimal Single-Leg Transfer

A single-leg transfer denotes a transfer when the spacecraft
rendezvous with one asteroid to its rendezvous with another
asteroid. In this case, MPBVP degenerates into two-point
boundary value problem (TPBVP). Instead of the position
and velocity of the spacecraft, equinoctial elements (EE),
denoted as x which is composed of (p, ex, ey, hx, hy, L), are
used to describe the motion of the spacecraft (Walker et al.
1985). The dynamical equations are given by




˙x = f 0 (x) + M (x)

˙m = −

uT
c

uT α

m

(1)

where u is the thrust ratio within the interval [0, 1]; T is the
maximal thrust; m is the mass of the spacecraft; the unit
vector α denotes the thrust direction; c = Ispg0 where Isp
is the speciﬁc impulse and g0 is the gravitational accelera-
tion at sea-level; the details of f 0 and M can be found in
Gao and Kluever (2004). Such a choice actually contributes
to the robustness and efﬁciency of our algorithm. The per-
formance index is

J =

T

c Z tf

t0

udt

(2)

where t0 and tf denote the initial and ﬁnal moments, respec-
tively. The physical meaning of J is the fuel consumption.
It should be noted that minimizing J is equivalent to mini-
mizing −m(tf ).

The application of indirect methods to solve the single-

leg transfer can be found in Casalino et al. (2007); Bertrand and Epenoy
(2002). We refer to Jiang et al. (2012); Bertrand and Epenoy
(2002) for the details of homotopic approaches. Jiang et al.
(2012) proposed the normalization of initial adjoint vari-
ables which is used to help provide initial guesses. The
switching detection method (Tang and Jiang 2016) is effec-
tive in solving the bang-bang control as long as the homo-
topic approach provides a good initial guess. The combi-
nation of these three techniques yields an efﬁcient method
for solving fuel-optimal low-thrust trajectories. However,
the lack of physical meanings for the adjoint variables still
leads to a difﬁculty in providing initial guesses.
In most
cases, we can only guess them randomly so a multiple start
technique has to be applied, which signiﬁcantly reduces the
efﬁciency.

2.1 Guessing Initial Adjoint Variables

In the problem under investigation most transfers, at least
the preferable ones, are between close, near-circular and
near-coplanar orbits. Casalino (2014) investigated time-
optimal transfers between close low-eccentricity orbits with
little change of inclination, which inspired the method pro-
posed here. Some reasonable simpliﬁcations are applied
based on the fact that ex, ey, hx, hy are small and the change
of p is also small. By simplifying ex, ey, hx, hy to be 0 and
introducing a constant p′ which is chosen to be the average
of the initial and target orbit, the dynamical equations are
simpliﬁed as

˙x = f ′

0 +

uT
m

M ′α

where the vector ﬁelds f ′

0 and M ′ are deﬁned as

f ′

0 = r µ0
p′ (cid:2) 0 0


0

M ′ = r p′

µ0



0 1/p′ (cid:3)T

0 0

2p′

sin L

2 cos L
− cos L 2 sin L

0
0
0

0
0
0

cos L/2
sin L/2

0

0
0
0





(3)

(4)

After the simpliﬁcation of the dynamical equations, it
˙L is constant during the
is obvious from equation (4) that
transfer, which eliminates the possibility of simultaneously
satisfying both the change of t and L. However, this is still
acceptable if we only want to generate an initial guess. An-
other reason is that transfers with an improper selection of

3

transfer time and phases are mostly eliminated in the pre-
liminary design. The change of mass is neglected, otherwise
λm should be considered, and it would be difﬁcult to obtain
a closed-form solution. This simpliﬁcation is reasonable be-
cause the high efﬁciency of low-thrust propulsion leads to
a small amount of fuel consumption. Another simpliﬁca-
tion is to assume that u is boundless and to seek the energy
optimal transfer, otherwise the bang-bang control has to be
taken into consideration, for which it is difﬁcult to obtain a
closed-form solution. The Hamiltonian is built as

H = λT

x f ′

0 +

T
m

λT

xM ′u +

T
c

u · u

(5)

where u = uα. Because H does not depend on p, ex,
ey, hx, hy (note that p′ in M ′ are chosen to be constant),
adjoint variables λp, λex , λey , λhx, λhy are actually adjoint
constants. The adjoint variable λL does change during the
transfer, but it does not affect the optimal control because
the 6th row of M ′ are all 0. As a result, the change in λL is
neglected.

The optimal control which minimizes H is

u = −

c
2m

M ′T

λx.

With the optimal u, the dynamical equation is

˙x = f ′

0 −

T c
2m2

M ′M ′T

λx.

(6)

(7)

Denote N = M ′M ′T. It is obvious that the L appearing
in N depends on time. With the simpliﬁcation

L = L0 + ωt

(8)

where L0 is the L when the transfer begins and ω =
pµ0/p′3, equation (7) is analytically integrable and the

details are given in APPENDIX A. It is obvious that the
changes of p, ex, ey, hx, hy are linear with respect to
λp, λex , λey , λhx, λhy . With a given orbital transfer prob-
lem, the changes of p, ex, ey, hx, hy are known and the
corresponding adjoint variables are calculated by solving a
system of linear equations.

The advantage of this method is obviously the high ef-
ﬁciency. However, neglecting the changes in L and m in-
ﬂuences the accuracy of the obtained adjoint variables. To
obtain the initial guess, λL and λm are guessed randomly
in interval [−1, 1] and [0, 1], respectively. We apply the
technique of normalizing the initial adjoint variables to in-
crease the robustness of single-leg solving by introducing
λ0 (Jiang et al. 2012) and setting it to unity. A scaling is
applied to λx, λm and λ0 so they are on the surface of
a high-dimensional sphere after the scaling.
It is widely
known that the change of phase during orbital transfer is
fuel-consuming and even a small deviation from the proper

phases might lead to a signiﬁcant increase in fuel consump-
tion. In other word, this method works well for the problems
without the constraints of phase such as transfers between
two orbits, meanwhile it may fail to deal with rendezvous
problem. Through preliminary designs the transfers which
take place between improper phases are somewhat elimi-
nated so this method should always be the ﬁrst choice. If
this method fails to provide an initial guess which eventu-
ally leads to convergence, the method of randomly guessing
with multiple starts should be applied.

3 Fuel-Optimal Multi-Asteroid Transfer

0 = t(i−1)

The positive multiplier λ0 (Jiang et al. 2012) is removed
from this section because the adjoint variables are not ran-
domly guessed anymore. The initial adjoint variables λx
and λm of every single-leg transfer have to be divided by the
corresponding λ0 to yield the same optimal control, which is
equivalent to a scaling that sets λ0 to unity. Denote A0, A1,
..., An as the sequence of asteroids, t(i)
0 the moment to leave
Ai−1, t(i)
the moment to rendezvous with Ai, i = 1, ..., n,
and ∆t the minimum time to stay on the asteroids.
It is
supposed that t(i)
+ ∆t for simplicity which in-
dicates that the spacecraft stays for the minimum time at
the asteroid. The superscripts + and − denote when the
spacecraft arrives at and leaves the asteroid, respectively. As
shown in Figure 1, a mission containing n single-leg trans-
fers should be optimized. In our case, t(1)
are ﬁxed
0
while t(1)
are optimized subject to the inequal-
ity constraints t(i)
f , i = 1, ..., n − 1. However, these
inequality constraints are not imposed but checked a posteri-
ori. In fact, t(1)
is set to match the phase when the spacecraft
0
leaves the Earth, rendezvous with and stays at asteroid A0,
and t(n)

is chosen according to the length of the mission.

0 < t(i)

f , t(2)

0 , ..., t(n)

and t(n)

f

f

0

f

f

(cid:1)(cid:1)(cid:1)

(cid:2) (cid:3)(cid:2)
(cid:1)(cid:3)(cid:1) (cid:2)(cid:4)

(cid:1)

(cid:2) (cid:3)(cid:2)
(cid:2) (cid:3) (cid:4)(cid:1) (cid:2)(cid:1)

(cid:2) (cid:3)(cid:4)
(cid:1)(cid:3)(cid:1) (cid:2)(cid:4)

(cid:2)

Fig. 1 Multi-Asteroid Rendezvous Mission

3.1 Multi-Point Boundary Value Problem

(cid:2) (cid:3)
(cid:3)
(cid:4)(cid:1) (cid:2)(cid:1)

(cid:3)

(cid:3)

The EE of the spacecraft at t(i)
are constrained to
0
be the same as that of the corresponding asteroid. For an
intermediate asteroid Ai, i = 1, ..., n − 1 the constraints are

and t(i)

f

x(t(i)

f ) − xAi(t(i)

f ) = 0

(9)

4

x(t(i+1)

0

) − xAi (t(i+1)

0

) = 0

t(i+1)
0

− t(i)

f

− ∆t = 0

m(t(i+1)

0

) − m(t(i)

f ) = 0

(10)

(11)

(12)

These constraints hold only for those n − 1 intermediate as-
teroids, i.e. A1 to An−1. For A0 and An only equation (10)
and (9) hold, respectively. To handle these constraints equa-
tions (9)–(12) are multiplied by the numerical adjoint mul-
i , and χmi, respectively; the transversality
tipliers χi, χ′
and static conditions at t(i)

f and t(i+1)

i, χ′′

are

0

(−λx(t(i)

f ) + χi) = 0

(λx(t(i+1)

0

) + χ′

i) = 0

H(t(i)

f ) − χi · ˙xAi (t(i)

f ) − χ′′

i = 0

−H(t(i+1)

0

) − χ′

i · ˙xAi(t(i+1)

0

) + χ′′

i = 0

−λm(t(i)

f ) − χmi = 0

(13)

(14)

(15)

(16)

(17)

0

) + χmi = 0

λm(t(i+1)
where only L of xAi depends on time. Equations (13) and
(14) suggest the discontinuity of λx. After algebraic manip-
ulations it is easily derived from equations (15) and (16) that

(18)

H(t(i)

f ) − λL(t(i)
H(t(i+1)

f ) ˙LAi(t(i)
) − λL(t(i+1)

f ) =

0

0

) ˙LAi(t(i+1)

0

)

and the combination of equations (17) and (18) leads to

λm(t(i+1)

0

) = λm(t(i)
f )

(19)

(20)

equations; there are n − 1 static conditions in the form of
equation (19) with i = 1, ..., n − 1 and λm(t(n)
f ) = 0. The
MPBVP is built and then solved with shooting methods.

3.2 Adjoint Scaling Technique

The sensitivity of the shooting function, i.e. MPBVP, in-
creases when the number of legs increases. The number
of variables to be solved is linear with respect to the num-
ber of legs. A mission containing many legs is thus difﬁ-
cult to optimize because of the large number of variables
to be solved. Randomly guessing with multiple starts is
not efﬁcient. To help guess the initial values of adjoint
variables, the mission is split into several legs which are
solved sequentially. Using the techniques applied to solve
the single-leg transfer, every leg is solved efﬁciently. Denote
as Λ(i) ∆= [λx(t(i)
0 )] the solution of leg i when the
bang-bang control is solved and λ0 is removed.

0 ); λm(t(i)

The sign of the switching function, denoted as ρ deter-
mines whether the thruster is on or off (Jiang et al. 2012). It
is deﬁned as

ρ = 1 − λm −

.

(22)

c

m (cid:13)(cid:13)(cid:13)
M Tλx(cid:13)(cid:13)(cid:13)

where λx and λm are the adjoint variables. Because mul-
tiplying ρ and λx by a positive scalar, denoted as k, at any
instantaneous moment, denoted as t′, does not change the
sign of ρ (thus the thrust magnitude) or the thrust direc-
tion, the optimal control at t′ does not change. It can be
inferred from the dynamical and adjoint differential equa-
tions (Gao and Kluever 2004) that ˙ρ and ˙λx are also multi-
plied by k while ˙x and ˙m do not change. As a result, the
optimal control stays invariant for the whole trajectory. It is
obvious that the change of λm, denoted as ∆λm in a single
leg is also multiplied by k.

We might as well investigate two sequential legs whose
initial adjoint variables for fuel-optimal transfer are Λ(i−1)
m (t(i−1)
and Λ(i), respectively. It is obvious that λ(i−1)
) of
leg i − 1 is 0, as is λ(i)
m (t(i)
0 ) is positive,
otherwise the condition λ(i)
f ) = 0 cannot be satisﬁed.
As a result, equation (20) is not satisﬁed. To ﬁx this error,
λ(i−1)

f ). However, λ(i)
m (t(i)

) are multiplied by k, i.e.

) and ρ(t(i−1)

(t(i−1)

m (t(i)

f

x

0

0

which indicates that λm is continuous during the mission.
As with the single-leg transfer, the mass of the spacecraft at
t(n)

has no constraint so

f

λm(t(n)

f ) = 0.

(21)

In summary, the variables to be solved are: t(1)
0 ) to λx(t(n)

to t(n−1)
,
λx(t(1)
0 ). The total number of
variables to be solved is 7n. The constraints to be satis-
ﬁed are: x(t(i)
f ), i = 1, ..., n, which gives 6n

0 ), and λm(t(1)

f ) = xAi (t(i)

f

f

λ(i−1)′

x

(t(i−1)

0

) = kλ(i−1)

x

(t(i−1)

0

)

(t(i−1)

ρ(i−1)′

0
to satisfy

) = kρ(i−1)(t(i−1)

0

)

λ(i−1)′
m

(t(i−1)

f

) = λ(i)

m (t(i)
0 )

(23)

(24)

(25)

where the superscript ′ means the adjoint variables after the
scaling. The change of λm of leg i − 1 is multiplied by

5

k so λm at the initial moment of leg i − 1, denoted as
λ(i−1)′

(t(i−1)

), is

m

0

λ(i−1)′
m

(t(i−1)

0

) = kλ(i−1)

m (t(i−1)

0

) + λ(i)

m (t(i)
0 ).

(26)

After algebraic manipulations of equations (23)–(26) we ob-
tain

k = 1 − λ(i)

m (t(i)
0 )

(27)

m (t(i)

Remark: The scaling factor k has to be positive which is
equivalent to saying that λ(i)
0 ) cannot exceed unity. The
adjoint scaling is equivalent to resolving the single leg so
the optimal control does not change while λm(tf ) is set to
a new positive scalar, denoted as λ′
m. This is accomplished
by choosing the performance index as

J ′ =

T

c Z tf

t0

udt + λ′

mm(tf )

(28)

= m(t0) + (λ′

m − 1)m(tf )

Because the ﬁxed m(t0) does not inﬂuence J ′, the perfor-
mance index is equal to (λ′
m − 1)m(tf ). Taking into ac-
count that the original performance index is −m(tf ), the
two problems yield the same optimal control as long as
m − 1 < 0, which is why λ(i)
0 ) cannot exceed unity,
λ′
otherwise the problem becomes maximizing the fuel con-
sumption.

m (t(i)

A brief illustration is shown in Figure 2. Before the scal-
ing, the results of two fuel-optimal single-leg transfers can-
not guarantee the continuity of λm. After the transforma-
tion, the control stays invariant but λm becomes continuous,
which is required by the boundary conditions.

e
d
u
t
i
n
g
a
M

e
d
u
t
i
n
g
a
M

1

0

−1

−2

−3

−4
 
0

1

0

−1

−2

−3
 
0

1

2

3

4

5

6

Time

 

7

 

λm
ρ
u

λm
ρ
u

1

2

3

4

5

6

7

Time

Fig. 2 History of λm, ρ, and u before and after Scaling. Top:
before. Bottom: after

For the mission under investigation which contains more
than just two legs, every leg is solved sequentially in the ﬁrst

f

to t(n)

step, where t(1)
are obtained from the preliminary de-
0
sign. The initial adjoint variables of every leg are obtained.
Then the aforementioned method of scaling the initial ad-
joint variables is implemented to obtain an initial guess for
solving the whole mission. The solution of the last leg does
not have to be scaled, but the solutions of other legs have to
be scaled backwards from leg n − 1 to leg 1. For the i-th leg,
λ(i) is scaled according to λ(i+1)′ which has been scaled in-
stead of the original one. This initial guess satisﬁes all the
boundary conditions except for the static conditions and is
more likely to converge than the random guess. However, it
is possible that at the i-th leg, λ(i)
0 ) exceeds unity af-
ter the scaling. On the condition that k > 0 is satisﬁed for
every leg, equation (26) indicates that λ(i)′
0 ) is always
increasing when i is decreasing from n − 1 to 1. Although it
rarely happens in our numerical examples, it is possible that
m exceeds unity and k becomes negative which contradicts
λ′
the assumption so the optimal control cannot stay invariant.
However, there is a simple method to estimate whether
such problem might happen or not. Equations (26) and (27)
are combined to derive

m (t(i)

(t(i)

m

′

m

λ(i−1)′
+λ(i)′

0
m (t(i)

) = (1 − λ(i)′
(t(i−1)
0 ) = 1 − (1 − λ(i)′

m (t(i)
m (t(i)

0 ))λ(i−1)
m (t(i−1)
0 ))(1 − λ(i−1)

0
m (t(i−1)

)

0

))
(29)

There are four cases according to the value of λ(i−1)
and λ(i)′

m (t(i)

m (t(i−1)

)

0

1. λ(i−1)

0 ):
m (t(i−1)
(a) 0 < λ(i)′

0

) > 1
m (t(i)

unity.
0 ) > 1: λ(i−1)′
(b) λ(i)′
m (t(i)
but might be negative.

m

0 ) < 1: λ(i−1)′

m

(t(i−1)

0

) is larger than

(t(i−1)

0

) is smaller than unity,

2. 0 < λ(i−1)

) < 1

0
(a) 0 < λ(i)′
than λ(i)
m (t(i)

m (t(i−1)
m (t(i)
m (t(i)
0 ) > 1: λ(i−1)′

(b) λ(i)′

m

0 ) < 1: λ(i−1)′
0 ), and smaller than unity.

(t(i−1)

m

0

(t(i−1)

0

) is larger than unity.

) is positive, larger

As a result, if the original results satisfy λm(t0) < 1 for
every leg, k is always positive. On the contrary, any leg
whose λm(t0) exceeds unity will cause the problem. There
are three methods to handle such a problem: 1) k is chosen
to be the same as the former one to avoid possible prob-
lems; 2) the preliminary design is reﬁned so such a problem
might be avoided; and 3) the adjoint variables are guessed
randomly for this leg. It is obvious that the ﬁrst method is the
easiest to use but might not lead to convergence. The second
method is actually difﬁcult to use and currently there is no
method to estimate whether λm(t0) will exceed unity. The
third method needs to be combined with multiple starts. A
method for overcoming such a difﬁculty is the future work.

6

4 Numerical Examples

To validate the methods proposed in this paper, three multi-
rendezvous sequences in a mission originated from GTOC71
are optimized where every probe rendezvous with dozens
of asteroids. The topic of GTOC7 is the multi-spacecraft
exploration of the main-belt asteroids and the three probes,
initially carried by the mother ship, should visit different se-
quences of asteroids each. A brief introduction of the prob-
lem is given.

A mother ship launches from the Earth and releases three
probes which must rendezvous with as many asteroids as
possible and return to and rendezvous with the mother ship.
We refer to the website for the details of the mother ship
because the trajectory of the mother ship is not considered
in this paper. Every probe has an electric propulsion system
with a speciﬁc impulse of 3000 s and a maximum thrust level
of 0.3 N. After being released, the probes must return to the
mother ship within 6 years. The probe has to stay at every
asteroid for at least 30 days. Besides the thrust propulsion,
the probes suffer only the central gravitation of the Sun. The
candidate asteroids move on Keplerian orbits. The primary
performance index is to maximize the overall number of as-
teroids reached by the probes. The sum of probe masses
when the mission ends is the secondary performance index.
The ﬁrst step to solve the problem is to determine the
asteroid sequences through the preliminary design. The au-
thors’ team from Tsinghua University proposed a tree search
algorithm with trimming strategy to ﬁnd the sequences. Af-
ter obtaining the sequences the trajectory of every probe has
to be optimized to improve the secondary performance in-
dex. Every probe starts from a rendezvous with the head of
the sequence and ﬁnishes the mission when it reaches the
tail of the sequence. During the competition our team em-
ployed the intuitive method of optimizing single-leg trans-
fers sequentially. Our ﬁnal result has a primary performance
index of 32 and secondary performance index of 2457 kg. It
should be noted that due to the carelessness in programming,
one asteroid was visited twice. The ﬁnal ranking2 of the top
ﬁve teams is listed in Table 1 where J and J ′ denote the pri-
mary and secondary performance index, respectively. It is
apparent that the secondary performance index is essential
to determine the ﬁnal ranking. Our methods are designed
for improving the secondary performance index.

All the computations are executed on a desktop personal
computer with a CPU of 3.60 GHz. The programs are
written in C++ and compiled with Microsoft Visual Stu-
dio Express 2013. All quantities concerning the length

Table 1 Ranking of Top Five Teams of GTOC7

Rank

1
2
3
4
5

Team
JPL

ACT/ESA-ISAS

Un. Texas

CAS

Tsinghua Un.

J
36
35
35
32
32

J ′

2450.3
2502.2
2493.0
2509.7
2457.0

are nondimensionalized with the astronomical unit (AU,
1.49597870691 × 108km); the time is so nondimensional-
ized that the angular velocity of a circular orbit whose radius
is 1 AU is unity; the gravitational parameter of the Sun is
nondimensionalized to unity; and the mass of the spacecraft
is nondimensionalized with its initial mass.

We need four steps to obtain the fuel-optimal bang-bang
control. First, multiple single-leg transfers are solved se-
quentially. The initial adjoint variables are guessed with
the aforementioned method, and they can all lead to con-
vergence. The problem that λm > 1 occurs in none of these
transfers. In this step the bang-bang control is not solved.
Instead, the homotopic approach is still used, and the per-
turbation added to the performance index is in the form of a
logarithmic barrier (Bertrand and Epenoy 2002) with a ε of
0.01. Second, these adjoint variables are scaled to provide
an initial guess for the next step where the whole sequence
is solved. Third, an approximate solution to the bang-bang
control is obtained with the logarithmic barrier with a ε of
0.01. Finally, the approximate result is used as the initial
guess to solve the bang-bang control directly.

The overall results of the three sequences are listed in Ta-
ble 2. The subscript I and R denote the initial and reﬁned
results, respectively; and mf denotes the ﬁnal mass of the
probe when the mission is completed. The sum of the ﬁ-
nal mass improves about 5%, which improves the ranking
by one. The improvements in the ﬁnal masses demonstrate
that these methods can be applied to obtain the fuel-optimal
multi-asteroid trajectory. For all the sequences all the com-
putations are ﬁnished in less than 2 seconds, which demon-
strates the efﬁciency of these methods.

Table 2 Initial and Reﬁned Final Masses of All Three Sequences

mf I (kg)
mf R (kg)

Improvement

Seq. 2
Seq. 1
808.2
842.0
881.3
850.9
4.7% 5.3%

Seq. 3
806.8
852.1
5.6%

Sum
2457.0
2584.3
5.2%

1Available online at http://sophia.estec.esa.int/gtoc_portal/?page_id=515,
retrieved 06 December 2015.
2Data available online at http://sophia.estec.esa.int/gtoc_portal/wp-content/uploads/2014/09/gtoc7_ranks.pdf,
retrieved 06 December 2015.

The details of the three sequences are listed in Table 3–
5 in APPENDIX B. The classical orbital elements of every
asteroid in every sequence are listed in APPENDIX C. In
Table 3–5 the ﬁrst column is the name of the asteroid in
the sequence. The second and third columns list the initial

7

epoch and the corresponding mass when the probe encoun-
ters every asteroid, respectively. These results are obtained
by the intuitive method. The fourth and ﬁfth columns list the
reﬁned epoch and the corresponding mass, respectively.

As an example, the history of the thrust magnitude of
probe 1 is shown in Figure 4. The blue dashed curves de-
note the thrust when the homotopic approach is applied. The
red and black curves denote the thrusting and coasting seg-
ments when the bang-bang control is solved, respectively.
The blue solid lines at the bottom denote when the probe
stays at the asteroid. When the homotopic approach is used,
the thrust magnitude is continuous and is an approximate
solution to the bang-bang control. The switching detection
method demonstrates its ability in dealing with the bang-
bang control. Two types of thrust structure exist. The ﬁrst
type is composed of two thrusting segments separated by
one coasting segment. The second type contains a single
thrusting segment, which is easily trimmed in the prelimi-
nary design where Lambert problems are solved when ap-
proximating low-thrust trajectories by two-impulse trajecto-
ries.

0.3

0.25

0.2

)
N
(
T

0.15

0.1

0.05

0
0

200

400

600

800

1000
1200
Time(Day)

1400

1600

1800

2000

2200

Fig. 3 Thrust Magnitude History of Probe 1. Blue: with Logarith-
mic Homotopy; Red and Black: the Bang-Bang Control

Through checking the value of λm a posteriori we ﬁnd
that λm never exceeds unity during the whole mission,
which agrees with the previous check that λm > 1 occurs in
none of the single-leg transfers. We might as well propose a
conjecture that in similar problems which are composed of
multiple single-leg transfers, λm never exceeds unity from
the second leg. Although difﬁcult to prove, this condition is
necessary if the adjoint scaling technique can be used. We
might as well list some interesting observations about the
physical meaning of λm, although a complete understand-
ing deserves more investigation and it is the future work.

1. The variation of the performance index δJ has the
term λm(t0)δm(t0) (Bryson and Ho 1975). A positive
λm(t0) suggests that the J is improved, i.e., the fuel con-
sumption is reduced, if m(t0) is reduced. This conclu-
sion corresponds to the fact that larger acceleration is

preferable to reduce fuel consumption (Tang and Jiang
2016).

2. The improvement of J is larger when λm(t0) is larger.
3. If the adjoint variable λm(t0) exceeds unity, the engine
must be on at t0 because equation (22) suggests the
switching function is negative no matter what other pa-
rameters are.

The optimal trajectories of the three probes are shown
in Figures 4–6 where red and black arcs denote thrusting
and coasting segments, respectively. The discontinuity of
the trajectory denotes when spacecraft stays on the asteroid.

)
U
A
(
y

3

2

1

0

−1

−2

−3
−3

A−
5
A+
5

A−
3

A+
3

A−
4

A+
4

A+
2

A−
2

A−
10

A+
1
A−
1

A+
9

A−
9

A−

6 A+
6

−2

−1

A−

7 A+
7

0

x(AU)

A+
8

A−
8

A+
0

1

2

3

Fig. 4 Optimal Trajectory of Probe 1 Projected on the xy–Plane

)
U
A
(
y

3

2

1

0

−1

−2

−3
−3

A+
11

A−
11
A+
1

A−
1

A+
10

A−
10

A−
12
A+
2

A−
2

A−
3

A+
3

A−
4
A+
4

A+
0

A+
9

A−
9

A+
8

A−
8

A+
7

A−
7

A−
5

A+
5

−2

−1

A+
6

A−
6

0

x(AU)

1

2

3

Fig. 5 Optimal Trajectory of Probe 2 Projected on the xy–Plane

The method of optimizing the whole trajectory has sig-
niﬁcance. Not only can it be applied to increase the perfor-
mance index in GTOC, it can also be used to evaluate the
largest possible payload as well as the least fuel consump-
tion for deep-space missions. Exploration of multiple main-
belt asteroids is practical, and thus this method can also be

also composed of multiple legs and every leg is relatively
easy to solve. However, a better way for handling the cases
where λm exceeds unity and a more general method for pro-
viding initial guesses still deserve further investigation.

6 Acknowledgment

This work is supported by the National Natural Science
Foundation of China (Grant No. 11302112 and 11432001).
The authors thank the reviewers and the editor for their help-
ful comments and suggestions, especially on the physical
meanings of some adjoint variables.

A−
11

A+
11
A−
2A+

2

8

3

2

1

0

−1

−2

)
U
A
(
y

A−
12

A−
3
A+
3

A−
4
A+
4

A+
10
A+
1

A−
10
A−
1

A+
9

A−
9

A+
0

A+
8

A−
8

A+
7

A−
7

A+
6

A−
6

−3

−2

−1

A−

5 A+
5

0

x(AU)

1

2

3

Fig. 6 Optimal Trajectory of Probe 3 Projected on the xy–Plane

used in the preliminary design to estimate the largest pay-
load. When designing the sequence of asteroids, the trim
strategy can be less strict in order not to miss the possi-
ble global optima. As a result the possibility of ﬁnding the
global optimal solution is higher.

5 Conclusion

The systematic method for optimizing low-thrust trajecto-
ries to rendezvous with a dozen main-belt asteroids is pro-
posed. The whole trajectories are optimized after intro-
ducing dozens of inner-point constraints.
Indirect meth-
ods are rarely applied to optimize such complex trajectories.
The difﬁculty arising from the large number of variables is
solved, i.e. the difﬁculty in providing an initial guess is over-
come by the adjoint scaling technique, which is the main
contribution of this paper. The adjoint scaling technique can
help provide a tentative guess by solving multiple single-leg
transfers, which are usually much easier to solve. The ad-
joint scaling technique connects the adjoint variables of mul-
tiple single-leg transfers with those of the multi-leg transfer.
The fact that this technique may fail if λm exceeds unity
provides a clue to the understanding of its physical mean-
ing. Another contribution is that we propose a simple but
efﬁcient method for providing initial guesses for transfers
between close low-eccentricity and low-inclination orbits.
The initial guesses of some adjoint variables are obtained
by analytically solving a simpliﬁed energy-optimal trans-
fer. Compared with the random guess, such a guess is more
probable and faster to converge and should always be the
ﬁrst choice. The improvement in the performance index and
the short computation time in numerical examples demon-
strate the robustness and efﬁciency of these methods. These
methods can be easily extended to other problems which are

9

Denote N = M ′M ′T whose components are

Appendix: A

N =

P
µ




N 11

0

0

0 N 22 0
0
0

0




where P = p′ and

N 11 = 


4P 2

4P cos L

4P sin L

4P cos L 1 + 3cos2L 3 sin L cos L
4P sin L 3 sin L cos L 1 + 3sin2L




N 22 = (cid:20)

cos2L

sin L cos L

sin L cos L

sin2L

(cid:21)

Denote Lt = L0 + ωt, the indeﬁnite integral of N 11, N 22 with respect to time is

4P sin Lt

3
2

sin2Lt

5
2

Lt

−4P cos Lt

3
sin2Lt
2
3
2

5
2

Lt −

sin Lt cos Lt




4P sin Lt

sin Lt cos Lt +

P
ωµ

P

N ′

11 =

N ′

22 =

4ωP 2t

3
2

−4P cos Lt



8ωµ (cid:20) Lt + sin Lt cos Lt

sin2Lt

sin2Lt

Lt − sin Lt cos Lt (cid:21)

Appendix: B

Table 3 Initial and Reﬁned Results of Sequence 1
Ast. Name
Grantham
1991 ND7
1998 TN33

Karlin

1998 WE12
Tosamakoto

Hermannbondi

Podobed
Woszczyk
Shcheglov

Mogamigawa

MJDI mI (kg) MJDR mR (kg)
61444.2
2000.0
1869.3
61711.7
1754.9
61964.4
1630.6
62222.1
62380.4
1557.2
1440.6
62603.1
1328.7
62832.3
1218.6
63007.4
63250.6
1108.2
1018.9
63434.4
63634.1
881.3

61444.2
61727.4
61970.0
62224.1
62379.9
62601.7
62846.9
63001.9
63259.0
63444.2
63634.1

2000.0
1855.6
1735.4
1608.3
1535.0
1415.6
1288.4
1184.8
1057.9
963.4
842.0

(1)

(2)

(3)

(4)

(5)

10

Table 4 Initial and Reﬁned Results of Sequence 2
Ast. Name
Grantham
1259 T-2
1999 WJ4
Mimosa
Arpetito

2000 ET45
1999 CO16
1999 XL44
1998 QU47

Stefﬂ
Silcher

Alprokhorov
Mogamigawa

Table 5 Initial and Reﬁned Results of Sequence 3
Ast. Name
Grantham
1998 VD13
Sinyavskaya
Mayakovsky
1999 AP9
Bohrmann
1999 CA97

Silcher
1997 DR
Radishchev

H˜afez

2000 ET165
Mogamigawa

MJDI mI (kg) MJDR mR (kg)
61882.2
2000.0
1854.3
62112.2
1758.4
62306.0
1685.5
62482.1
62728.6
1603.4
1543.5
62867.9
1454.4
63024.4
1317.7
63272.5
63456.6
1220.3
1148.7
63571.0
1060.0
63744.3
970.4
63898.1
64087.0
850.9

61882.2
62091.3
62276.4
62456.2
62686.6
62859.8
63019.5
63264.7
63452.4
63563.7
63733.7
63894.1
64087.0

2000.0
1861.8
1764.3
1685.2
1571.1
1497.0
1414.9
1280.1
1176.7
1111.7
1019.7
927.9
808.2

MJDI mI (kg) MJDR mR (kg)
2000.0
61947.2
62175.9
1870.5
1790.9
62344.2
1666.8
62646.4
1543.8
62847.9
63095.3
1443.8
1366.3
63276.3
1256.0
63466.2
1182.2
63584.0
63742.8
1076.9
991.5
63885.0
915.0
64020.9
64138.3
852.1

61947.2
62135.6
62296.9
62554.8
62795.9
63019.4
63231.1
63451.8
63579.0
63737.1
63880.1
64015.7
64138.3

2000.0
1890.2
1812.2
1655.8
1533.6
1399.9
1301.7
1192.5
1133.2
1038.1
956.5
876.6
806.8

11

Appendix: C

Table 6 Classical Orbital Elements of the Asteroids in the First Sequence at Epoch MJD 56800

Ast. Name
Grantham
1991 ND7
1998 TN33

Karlin

1998 WE12
Tosamakoto

Hermannbondi

Podobed
Woszczyk
Shcheglov

Mogamigawa

a(AU)

2.8351662
2.7057099
2.8928373
2.8786586
2.9025244
2.8358216
2.7849273
2.7878827
2.9038493
2.8808048
2.7518476

e

0.0636863
0.0474122
0.0711471
0.0139888
0.0362789
0.0429025
0.0801049
0.0412754
0.0585692
0.0571353
0.1116506

i(deg)

1.2216500
2.7967900
3.1684200
3.5152300
3.2817800
3.1132600
1.7763800
0.9289900
1.4313700
1.0089900
3.1007000

ω(deg)

21.1984300
160.1996600
298.4774200
356.9468000
90.6428100
321.1444700
247.9127800
12.0766700
199.8942000
164.6990200
308.0214700

Ω(deg)

309.0437500
155.1344800
89.8558800
98.8148700
95.3195900
119.9078400
96.2210600
157.3179400
204.0671700
262.5768500
347.1361900

M (deg)

87.6164602
29.6144276
67.3416368
357.9468249
285.1736252
342.5165325
55.9168827
218.4845623
74.8749440
37.7106098
56.7308881

Table 7 Classical Orbital Elements of the Asteroids in the Second Sequence at Epoch MJD 56800
Ω(deg)

e

Ast. Name
Grantham
1259 T-2
1999 WJ4
Mimosa
Arpetito

2000 ET45
1999 CO16
1999 XL44
1998 QU47

Stefﬂ
Silcher

Alprokhorov
Mogamigawa

a(AU)
2.83517
2.89408
2.85203
2.87398
2.87457
2.93180
2.95045
2.83978
2.85584
2.82693
2.95964
2.99640
2.75185

0.06369
0.04969
0.04612
0.04722
0.01452
0.05444
0.02487
0.03896
0.04394
0.03731
0.05885
0.10778
0.11165

i(deg)
1.22165
2.35270
1.53399
1.17803
1.02431
1.72475
2.16902
1.12783
1.69997
2.16367
0.46464
2.93522
3.10070

ω(deg)
21.19843
90.45222
70.69924
108.28712
305.81295
178.14692
295.50305
159.71372
249.47639
100.49009
246.80145
281.08595
308.02147

309.04375
31.86648
355.88393
329.40022
297.62030
359.74187
27.34924
323.00591
189.61051
195.07442
125.27473
84.17199
347.13619

M (deg)
87.61646
339.75347
6.65304
8.57038
210.19707
306.18772
181.62682
307.57937
4.84867
118.81004
138.18915
163.66004
56.73089

Table 8 Classical Orbital Elements of the Asteroids in the Third Sequence at Epoch MJD 56800

Ast. Name
Grantham
1998 VD13
Sinyavskaya
Mayakovsky
1999 AP9
Bohrmann
1999 CA97

Silcher
1997 DR
Radishchev

H˜afez

2000 ET165
Mogamigawa

a(AU)
2.83517
2.89350
2.87595
2.87651
2.94598
2.85353
2.96704
2.95964
2.79916
2.87780
2.84585
2.92012
2.75185

e

0.06369
0.06760
0.07705
0.05619
0.03595
0.05767
0.08180
0.05885
0.02324
0.06612
0.09951
0.03646
0.11165

i(deg)
1.22165
3.24541
2.70407
2.21570
1.57970
1.81556
2.11304
0.46464
2.76067
1.33509
1.73301
2.05960
3.10070

ω(deg)
21.19843
307.42881
298.61193
287.00774
82.83970
132.91074
151.83228
246.80145
268.16626
347.22497
293.91723
276.41478
308.02147

Ω(deg)

309.04375
44.90694
50.22626
25.34998
191.15193
184.53332
162.60897
125.27473
31.24239
336.83005
25.51876
16.21004
347.13619

M (deg)
87.61646
98.51234
91.28100
134.58903
211.96557
115.08813
193.57845
138.18915
94.84897
125.02051
103.16738
192.18541
56.73089

12

References

Bertrand, R., Epenoy, R.: Optimal Control Applications and Methods 23(4), 171 (2002)
Bryson, A.E., Ho, Y.C.: Applied Optimal Control; Optimization, Estimation, and Control. Hemisphere, Washington (1975)
Casalino, L.: Journal of Guidance, Control, and Dynamics 37(3), 1003 (2014)
Casalino, L., Simeoni, F.: Journal of Guidance, Control, and Dynamics 35(2), 423 (2012)
Casalino, L., Colasurdo, G., Sentinella, M.R.: Acta Astronautica 61(9), 769 (2007)
Casalino, L., Pastrone, D., Simeoni, F., Colasurdo, G., Zavoli, A.: Acta Futura 8, 29 (2014)
Gao, Y., Kluever, C.A.: No. AIAA 5088 (2004)
Gatto, G., Casalino, L.: Journal of Guidance, Control, and Dynamics (2015)
Gong, S., Li, J.: Astrophysics and Space Science 355(2), 213 (2015)
Jiang, F., Baoyin, H., Li, J.: Journal of Guidance, Control, and Dynamics 35(1), 245 (2012)
Jiang, F., Chen, Y., Liu, Y., Baoyin, H., Li, J.: Acta Futura 8, 37 (2014)
Li, J., Xi, X.-n.: Journal of Guidance, Control, and Dynamics 35(6), 1709 (2012)
McInnes, C.R.: Astrophysics and space science 282(4), 765 (2002)
McKay, R., Macdonald, M., Biggs, J., McInnes, C.: Journal of Guidance, Control, and Dynamics 34(3), 645 (2011)
Rayman, M.D., Fraschetti, T.C., Raymond, C.A., Russell, C.T.: Acta Astronautica 60(10), 930 (2007)
Tang, G., Jiang, F.: Astrophysics and Space Science 361(1), 1 (2016)
Walker, M., Ireland, B., Owens, J.: Celestial Mechanics 36(4), 409 (1985)
Wu, Z., Jiang, F., Li, J.: Astrophysics and Space Science 352(2), 503 (2014)
Yang, H., Li, J., Baoyin, H.: Advances in Space Research 56(5), 837 (2015)
Zeng, X.-Y., Baoyin, H., Li, J.-F., Gong, S.-P.: Research in Astronomy and Astrophysics 11(7), 863 (2011)
Zeng, X., Gong, S., Li, J.: Acta Astronautica 105(1), 40 (2014)

This manuscript was prepared with the AAS LATEX macros v5.2.

