6
1
0
2

 
r
a

 

M
9
1

 
 
]

.

R
S
h
p
-
o
r
t
s
a
[
 
 

1
v
9
7
0
6
0

.

3
0
6
1
:
v
i
X
r
a

Mon. Not. R. Astron. Soc. 000, 1–15 (0000)

Printed 22 March 2016

(MN LATEX style ﬁle v2.2)

Smoothed Temporal Variance Spectrum: weak line proﬁle
variations and NRP diagnostics

A.F. Kholtygin1⋆ and N.P. Sudnik1
1Saint-Petersburg State University, Universitetskij pr. 28, Saint-Petersburg, 198504, Russia

Accepted 0000 Month 00. Received 0000 Month 00; in original form 0000 Month 00

version

of

the

the Temporal Variance

ABSTRACT
Spectrum (TVS,
We
describe
Fullerton, Gies & Bolton 1996) method with pre-smoothed line proﬁle (smoothed
Temporal Variance Spectrum, smTVS). This method introduced by Kholtygin et al.
(2003) can be used to detect the ultra weak variations of the line proﬁle even for very
noisy stellar spectra. We also describe how to estimate the mode of the non-radial
pulsations (NRP) using the TVS and smTVS with diﬀerent time spans. The inﬂuence
of the rotational modulation of the line proﬁle on the TVS is considered. The analysis
of the contribution of NRP and rotational modulation in the global TVS is studied.

Key words:

line: proﬁles – methods: data analysis – stars: early-type.

1

INTRODUCTION

Most OB stars show line proﬁle variability (LPV). The ac-
tive investigation of this phenomenon started about 40 years
ago. The LPV was found in X-ray, UV and the optical region
of spectrum. It turned out that variability can be regular,
cyclic and stochastic and all types of variability can present
at the same time. The stochastic LPV is connected with
the formation of small-scale structures in the stellar wind.
The regular and cyclic LPV can be induced by the large-
scale structures in the stellar atmosphere. The presence of
these structures is stimulated by wind instabilities, NRP,
local inhomogeneities and the presence of global dipolar or
small-scale local magnetic ﬁelds.

If the amplitude of the variations is large compared to
the noise contribution and the data are well sampled in time,
it is easy to detect the LPV by overplotting individual or
residual (individual proﬁle minus the average proﬁle) proﬁles
of a line or by plotting the dynamical LPV spectrum.

The commonly accepted method of detecting the rela-
tively weak LPV is Temporal Variance Spectrum analysis in-
troduced by Fullerton, Gies & Bolton (1996). This method
can be used when the observations were obtained for both
regular and irregular time grids. In this method the standard
deviations of LPVs for both lines and continuum are com-
pared. If the amplitude of deviations within a line is clearly
larger than in the continuum then detection at a selected
signiﬁcance level can be claimed. If the observed standard
deviations for LPVs are smaller than expected for the noise
contribution then only the upper limit of the LPV amplitude
can be estimated.

⋆ E-mail: afkholtygin@gmail.com

In the following years the TVS was frequently used to
study LPVs. Kaufer et al. (1996) used the TVS to investi-
gate the long-term variations in the Hα line proﬁles in spec-
tra of 6 BA supergiants. The method of TVS was used by
Markova (2002) to analyse the spectral variability of O9.5 Ia
supergiant α Cam. Markova et al. (2005) employed the TVS
analysis to study the LPV for Hα line proﬁles. They mod-
iﬁed the method to take into account the eﬀects of wind
emission.

In many cases TVS analysis detects the weak LPV. For
example, Oliveira, Steiner & Cieslinski (2003) found vari-
ability of O VI λ 3811/34 ˚A lines in spectra of WR7a star us-
ing TVS though the O VI lines central depth does not exceed
the noise level (see their Fig. 1). Oliveira & Steiner (2004)
have investigated the TVS spectra for WR 48c star WX
Cen. They found a highly variable component in the TVS of
highly ionized ion O VI λ 3811/34 ˚A lines. This component
was also seen in the TVS red wings of Hβ and He II λ4686 ˚A.
The nature of the component remains unknown.

Recently Oliveira, Lima & Steiner (2014) have analysed
the strong variability of the emission line proﬁles in spectra
of the Close Binary Supersoft X-ray Source V Sge, which
is considered as a candidate to SN Ia progenitor, with TVS
technique. The TVS for the strongest spectral lines were con-
structed using their 110 spectra obtained in 2010 and 2012.
They detected only marginal LPV of the Bowen C III/N III
complex (λλ 4640 − 4650 ˚A) and strong variations for lines
He II λ 4686 ˚A and Hβ.
Thompson & Morrison (2013) have presented the re-
sults of a time series analysis of 130 ´echelle spectra of ε Ori
(B0 Ia), acquired over seven observing seasons between 1998
and 2006 at Ritter Observatory. TVS revealed signiﬁcant
wind variability in both Hα and He I λ 5876 ˚A lines. The He I

2

A.F. Kholtygin and N.P. Sudnik

line TVS has a double-peaked proﬁle consistent with radial
velocity oscillations. In the recent paper by Martins et al.
(2015) the variability of twelve spectral lines was investi-
gated by means of the TVS for seven O9–B0.5 stars. The
selected lines probe the radial structure of the atmosphere
from the photosphere to the outer wind. The variability of
H and He I–II lines was detected.

If the amplitude of LPV is suﬃciently high the value
of TVS within the corresponding line substantially exceeds
its value in the adjacent continuum. In many cases the LPV
are extremely weak, not more than 1% of the continuum
level for many of O stars. To detect such variability the
smoothed Temporal Variance Spectrum method proposed
by Kholtygin et al. (2003) can be used.

The detection of extremely weak LPV gives an oppor-
tunity to explore the stratiﬁcation in the stellar atmosphere,
so the detection of such micro LPV seems to be very impor-
tant. We also show that the TVS (or smTVS) method can
be used not only for looking for LPV.

One of the important problems in the study of non-
radial pulsations of stars is determination of pulsation modes
l and m. For this purpose diﬀerent methods were de-
veloped, for example Aerts, de Pauw & Waelkens (1992);
Schrijvers et al.
(1997); Berdyugina, Telting & Korhonen
(2003). The most convenient of these methods is the anal-
ysis of changes of the pulsation phase component between
blue and red wings of the line proﬁle (Telting & Schrijvers
1997b).

These methods require a large number of observations
covering several periods of pulsations. It is not always possi-
ble to carry out such observations because this would require
a large number of spectra with a high signal-to-noise ratio
for each star.

Quite often collected spectra comprise only a frac-
tion of the stellar pulsation period or the spectra are
obtained at time intervals separated by large gaps. In
this case using of the equations for calculation l and m
from Telting & Schrijvers (1997b) is impossible. However,
applying TVS or smTVS is still possible.

The inﬂuence of pulsational velocity ﬁelds on photo-
spheric line proﬁles was shown by Fullerton, Gies & Bolton
(1996). The purely radial mode produces the double-peaked
TVS. When there is a mode with a large horizontal com-
ponent present, the peak separation of the TVS becomes
smaller compared to a purely radial mode. A mode with
smaller horizontal velocity ﬁeld produces TVS with one
peak. The authors note that the shape of TVS depends on
the time sampling so TVS obtained during diﬀerent runs
will not in general look the same.

In the present paper we describe how the TVS and
smTVS method can be applied for detection of extremely
small amplitude LPV in spectra of OB stars. We also stud-
ied the possibility to estimate non-radial pulsation mode
using the TVS and smTVS analysis.

Our paper is organized as follow. In Sect. 2 we describe
the observational material. The Smoothed Temporal Vari-
ance Spectrum is outlined in Sect. 3. Statistical properties
of smTVS are described in Sect. 4. In Sect. 5 we show how
to model the variable line proﬁles in spectra of non-radially
pulsating stars. In Sects. 6 the results of our analysis to-
gether with the application to the real stellar spectra are
presented in detail. The conclusions are given in Sect. 7.

2 OBSERVATIONS

Our target list consists of 3 OB supergiants. The log of ob-
servations and stellar parameters are given in the tables 1
and 2 respectively.

The star λ Cep (HD 210839) is bright, fast rotating,
runaway star, with spectral class O6.5 I (Sota et al. 2011).
On the Hertzsprung-Russell diagram λ Cep is located very
close to the β Cep stars instability strip. In 2007 the star
was observed in Bohyunsan Optical Astronomy Observatory
(BOAO, South Korea) by using the 1.8-m telescope and the
ﬁber-fed echelle BOES spectrograph (Kim et al. 2002) with
spectral resolution 45000 and large CCD (2048 x 4096 pix-
els). All spectra were obtained in the 3830–8260 ˚A region.
Reduction of CCD frames was made with iraf.

The supergiant ρ Leo (HD 91316) is a slowly rotat-
ing star of spectral class B1 Iab (Howarth et al. 1997).
The brightest component δ Ori A (HD 36486) of the
wide visual triple system δ Ori
is a physical triple sys-
tem. The primary δ Ori Aa is an eclipsing binary (O9.5 II
and B0.5 III (Harvin et al. 2002)) with the orbital pe-
riod P = 5.73 d (Hoﬄeit 1996). The third component
δ Ori Ab of early B subtype (Harvin et al. 2002) has the
orbital period of 224.5 yr. The spectral observations for
these stars were made in Special Astrophysical Observatory
(SAO, Russia) on 10 January 2004 in the region λλ 4500–
6000˚A with using 6-m telescope, the quartz echelle spec-
trograph NES (Panchuk et al. 2002) in Nasmyth focus with
2048 x 2048 Uppsala CCD. The reduction of SAO spectra
was made using the midas package (e.g., Kholtygin et al.
2003). The positions of the spectral order was found by us-
ing the method by Ballester (1994).

For studying the LPV all spectra were normalized to the
individual continuum for each spectral order. The method
of Shergin, Kniazev & Lipovetsky (1996) was used to de-
termine the continuum level in spectral orders with nar-
row spectral lines. In orders containing broad spectral lines
the continuum was drawn using the procedure described
by Kholtygin et al. (2006) where polynomial approximation
for all wavelengths of the order except for the regions of the
broad spectral lines is used.

3 SMOOTHED TEMPORAL VARIANCE

SPECTRUM (SMTVS). DEFINITION AND
MAIN EQUATIONS

For detection of micro LPV of various nature we used the
smoothed Temporal Variance Spectrum technique, which is
a modiﬁed version of the TVS analysis.

In the absence of any visible variations we can determine
whether a line proﬁle was indeed variable using a following
procedure.

Before obtaining the standard deviation spectrum
(TVS)1/2, the residual spectra were smoothed using a wide
Gauss ﬁlter S. The amplitude of the noise component de-

creases by a factor of ≈p S/h after smoothing, where h is

the width of the pixel. If the width of the variable compo-
nent is larger than the width of the ﬁlter, then smoothing
will not signiﬁcantly change the amplitude of the variable
component, and peak in the standard deviation spectrum
that corresponds to the variable component can be detected.

smTVS: weak LPV and NRP diagnostics

3

Table 1. Summery of observations.

HD

Name

Date

Number of
spectra

Exposition
(min)

Length of Telescope
observa-
tions, h

Spectrograph, CCD S/N

36 486
91 316
210 839

δ Ori A 10 Jan 2004
ρ Leo
10 Jan 2004
20 Nov – 16 Dec 2007
λ Cep

40
30
30

3
6
3–5

2.8
3.5
7.2

SAO, 6-m
SAO, 6-m
BOAO, 1.8-m BOES, 2048 x 4096

NES, 2k x 2k
NES, 2k x 2k

700
450
350

Table 2. Stellar parameters.

HD

Name

Spectral
type

36 486
91 316
210 839

δ Ori A O9.5 II
ρ Leo
B1 Iab
O6.5 I (n)fp
λ Cep

V

(mag)

2.218
3.85
5.043

Teﬀ
(K)

30 600
22 000
36 200

log(L/L⊙)

M

R

log g

˙M

(M⊙)

(R⊙)

(cm/s−2)

(10−6M⊙/yr)

V sin i
(km/s)

V∞

(km/s)

5.26
5.47
5.68

11.2
18
34

11
37.4
17.5

3.4
2.55
3.48

0.76
0.35
5.1

157
75
214

2000
1110
2200

The parameters for ρ Leo are from Crowther, Lennon & Walborn (2006). The parameters for λ Cep are from Markova et al. (2004).
The spectral class and V for λ Cep and δ Ori A are from Sota et al. (2011) and Ma´ız-Apell´aniz et al. (2004), respectively. For δ Ori A
the Teﬀ ,

˙M and V∞ are from Fullerton, Massa & Prinja (2006), log(L/L⊙), M , R, log g, V sin i are from Harvin et al. (2002).

This procedure, called smoothed Temporal Variance
Spectrum (smTVS), was introduced by Kholtygin et al.
(2003). The smTVS is described by next formula:

smT V S(λ, S) =

=

1

N − 1  N
Xi=1

qi(λ, S)(cid:2)Fi(λ, S) − F (λ, S)(cid:3)2! ,

(1)

where N is the number of spectra, Fi(λ, S) is the ﬂux in the
spectrum with number i at wavelength λ normalized to the
continuum level and smoothed with variable Gauss ﬁlter (S
is the ﬁlter width):

Fi(λ, S) =

1

√2πS

∞

Z−∞

Fi(l)e− 1

2 ( l−λ

S )2

dl ,

(2)

where Fi(l) is the continuum normalized ﬂux for spectrum i,
F (λ, S) is the ﬂux at wavelength λ averaged over all spectra:

N

1
N

F (λ, S) =

ωiFi(λ, S), N
Xi=1

Xi=1
Here ωi ∼ (S/N )2
where (S/N )i is the signal-to-noise ratio for spectrum i.

i is the relative weight of i-th observation,

ωi .

(3)

The wavelength correction factor qi(λ, S) which is ac-
counted for pixel-to-pixel variations of the noise component
within the line proﬁle is considered in subsection 4.3. Out-
side the line qi(λ, S) ≈ 1, whereas within the line this factor
can appreciably diﬀer from 1.
It was shown empirically that the best results are ob-
tained for smoothing with a Gaussian ﬁlter width S =
0.5 − 1.3 ˚A (usually 15–30 pixels). For S = 0 the value
of smTVS(λ,0) corresponds to the TVS value introduced
by Fullerton, Gies & Bolton (1996).

Note that the eﬃciency of the method is sensitive to
the number of the spectra, and it enhances substantially as
this number increases.

For the sake of convenience smTVS can be normalized:

0.60
0.40
0.20
0.00
−0.20
−0.40
−0.60
−0.80
−1.00
1.02
1.00
0.98
0.96
0.94
0.92
0.90

S
g

l

t

n
o
c
F

/

F

 25

 20

 15

 10

 5

 0

1
7
4
4

 
I
 

e
H

1
8
4
4

 
I
I
 

g
M

6
8
4
4
V

 

I
 

S

 4465  4469  4473  4477  4481  4485  4489  4493

l , Å

Figure 1. Density plot for (smTVS)1/2
N (top) and mean line pro-
ﬁle of the line He I λ 4471 ˚A (bottom) in the spectra of λ Cep. The
darker areas correspond to higher amplitudes of the (smTVS)1/2
N .
Filer width S is expressed in decimal logarithms. S is measured
in ˚A.

(smT V S)N(V, S) =

smT V S(V, S)

hsmT V Scont(V, S)i

.

(4)

Here hsmT V Scont(V, S)i is the smTVS in the adjacent con-
tinuum near the line averaged over the interval ∆λ ≫ h,
where h is the pixel width. Similarly, we can introduce the
normalized TVS: (TVS)N=(TVS)N(V)=(smTVS)N(V, 0).

Fig. 1 presents a density plot of the (smTVS)1/2

N for the
He I λ 4471 ˚A line proﬁles in the spectra of λ Cep. Darker
areas correspond to higher amplitudes of the smTVS. The
density plot shows that the variability of the He I λ 4471 ˚A
line is clearly presented at all ﬁlter widths. The smTVS
also indicates variability of the weak Mg II λ 4481 ˚A and
S IV λ 4486 ˚A lines proﬁles, which cannot be detected by
TVS without smoothing.

In Fig. 2 (TVS)1/2

N (middle
panel) functions for LPV in spectra of λ Cep are shown for

N (top panel) and (smTVS)1/2

l
2

/

1

N
)
S
V
T
(

2

/

1

N
)
S
V
T
m
s
(

t

n
o
c
F

/

Fl

3.00
2.50
2.00
1.50
1.00

9.00
7.00
5.00
3.00
1.00
1.02
1.00
0.98
0.96
0.94
0.92
0.90

He I 4471

He I 4471

1
7
4
4
 
I
 

e
H

1
8
4
4

 
I
I
 

g
M

1
8
4
4

 
I
I
 

g
M

1
8
4
4

 
I
I
 

g
M

6
8
4
4
V

 

I
 

S

6
8
4
4
V

 

I
 

S

6
8
4
4
V

 

I
 

S

In a simple case µ1 = µ2 = . . . = µN = µ and σ2

1 =

σ2
2 = . . . = σ2

N = σ2 the mean and the variance

N

N

E[ζ] = µ

ai, Var[ζ] = σ2

a2
i .

(7)

Xi=1

Xi=1

Filtering of the signal can completely or partially suppress
some aspect of the signal (e.g., Orfanidis 2010). The oper-
ator of ﬁltering ˆS is the convolution of the source (signal)
function f (x) with the family of the ﬁlter functions GS(x)
having a variable width S:

−∞

ˆS[f ](z) =

Z−∞

GS(z − x)f (x)dz.

(8)

Here the ﬁlter function GS(x) = (1/s)g(x/S). Hereinafter
we will use both the simple rectangular ﬁlter: gR(x) = 1 for
x ∈ [−1/2, 1/2] and gR(x) = 1 for all other values of x, and
the Gauss ﬁlter gN(x) = (2π)−1/2 exp(−x2/2).
For smoothing the function f (x) we have to calculate
the integral Eq. (8). Suppose that f (x) is determined in the
points {xi}, where i = 0, 1, . . . , N . Then we can present the
integral Eq. (8) as a sum

N−1

aif (˜xi) .

(9)

ˆS[f ](z) ≈

Xi=1

Here ai = GS(z− ˜xi), where ˜xi = xi +ε ∆xi, ∆xi = xi+1−xi
and the parameter ε 6 1.

4.1 Smoothing the random function

Suppose that the random function f (x) is determined at
the points xi, i = 1, 2, . . . , N and for each i the value of
f (xi) is the normally distributed random value ξi with the
mean µ, the variance σ2, and with the distribution function
F(xi). Smoothing the random function f (x) with using the
arbitrary operator of ﬁltering ˆS gives us the next expression:
η = η(z) = ˆS[ζ] ≈X GS(z − ˜xi)∆xiξi .
If the distribution function F(xi) does not depend on i then
the sum (10) does not depend on the value of z. For the sake
of the convenience we can put z = 0. The random value η
is the normally distributed with the mean and the variance
which can be found accordingly Eq. (6).

(10)

Hereinafter for simplicity we will suppose that ε = 1/2,
then ˜xi = (i + 1/2)h, where i = 0,±1, ±2, . . .. In this case
for all i ∆xi = h. Then

η = ˆS[ζ] =

∞

Xi=−∞

GS(ih + h/2)hξi =

aiξi ,

(11)

∞

Xi=−∞

4

A.F. Kholtygin and N.P. Sudnik

 4464  4468  4472  4476  4480  4484  4488  4492

l , Å

N (top),(smTVS)1/2

Figure 2. (TVS)1/2
N (middle) normalized by
unity and mean line proﬁle (bottom) of the line He I λ 4471 ˚A in
the spectra of λ Cep. Filter width S is 0.2 ˚A. The horizontal line
corresponds to the signiﬁcance level 0.001.

comparison. The (smTVS)1/2
N is a cross-section of the den-
sity plot in the Fig. 1 with the smoothing ﬁlter width 0.2 ˚A.
The smTVS clearly demonstrates variability of the Mg II
and S IV lines which is undetected by simple TVS analysis.
The variability of the He I line is seen in TVS and smTVS
both. The smTVS shows that whole He I line proﬁle is vari-
able though the TVS detects the variability in central part
of the line proﬁle.

Note that in spite of the fact that a lot of lines are
extremely weak and their residual intensities do not exceed
the noise level of the adjacent continuum their variability is
clearly detected in the case of using smTVS.

Unfortunately, the smTVS technique cannot be used for
accurate localization of weak lines with variable proﬁles for
large ﬁlter widths.

4 STATISTICAL PROPERTIES OF THE

SMTVS

Let Ξ = (ξ1, ξ2, . . . , ξN ) be the set of N mutually inde-
pendent normally distributed random values with means
µ1, µ2, . . . , µN and variances σ2
N . For N constants
a1, a2, . . . , aN we can introduce the random variable

2 , . . . , σ2

1, σ2

ζ =

N

Xi=1

aiξi .

(5)

where ai = GS(ih + h/2)h. Suppose that for all i the mean
µi = µ and the variance σ2
i = σ2. Then the mean and vari-
ance of η

Then accordingly for example Brandt (1970) the variable ζ
has a normal distribution with mean and variance

E[ζ] =

N

Xi=1

aiµi, Var[ζ] =

i σ2
a2
i .

N

Xi=1

(6)

∞

∞

E[η] ≈ µ

Xi=−∞

aiµi = µ, Var[η] ≈ σ2

Xi=−∞
For the symmetrical ﬁlters Var[η] = σ2P∞

i=0 2a2
case of the rectangular ﬁlter it is easy to ﬁnd that

a2
i .

(12)

i . In the

6.0

5.0

4.0

3.0

2.0

1.0

)
x
(
f

31.0

26.0

21.0

)
x
(
f

16.0

11.0

6.0

1.0

-0.20 -0.10

0.00
x

0.10

0.20

-0.20 -0.10

0.00
x

0.10

0.20

Figure 3. Top panel: distribution function for the smoothed with
the rectangular ﬁlter normally distributed random variables with
µ = 0, σ = 0.6 and h = 0.01 for the ﬁlter width S = 0.8. The
thick dashed line shows the Gauss ﬁt. Bottom panel: the same as
in the top panel, but for the Gauss Filter.

.

(13)

E[η] = µ, Var[ζ] = σ2(cid:16) h

S(cid:17) , St.Dev[η] = σr h

S

In Fig. 3 (top panel) we plot the distribution of the smoothed
with the the rectangular ﬁlter (S = 0.8) the normally dis-
tributed values ξi with parameters µ = 0, σ = 0.5 and
h = 0.01. We can see that in accordance with Eq. (13) the
smoothed variable is also normally distributed but with the

standard deviation which is ≈p0.8/0.01 ≈ 9 time smaller.

For the the scaled Gauss ﬁlter with width S the mean
of the random value η is E[η] = µ. To calculate the variance
we can use Eq. (12), where

smTVS: weak LPV and NRP diagnostics

5

.
v
e
D

0.30

 
.
t

0.20

 

S
d
e
h

t

0.10

o
o
m
S

0.00

0.30

0.60
h

0.90

1.20

Figure 4. Standard Deviation for the smoothed with the Gauss
ﬁlter (S = 0.8) normally distributed random variables with µ = 0,
σ = 0.6 as a function of h (solid line). The analytical ﬁt Eq. (19)
is shown with the dashed line.

Var[η] =

σ2r2
2π × θ2(0, q) .

(17)

Usually the value of r2 = (h/S)2 ≪ 1. Thus q ≈ 1. In
this case we can use the asymptotic by Zhuravskii (1941)
of the function θ2 at q → 1: θ2(0, q) ≈ √ρ′ (1 − 2q′ + . . .),
where ρ′ = π/ ln(1/q) = π/r2 and q′ = exp(−πρ′) =
exp(−(π/r)2). Using this asymptotic one can easily ﬁnd that
at q → 1
Var[η] ≈
and

S(cid:17)(cid:16)1 − 2e−(π/r)2

+ . . .(cid:17) ,

1
2√π

(18)

S (cid:16)1 − e−(π/r)2

+ . . .(cid:17) .

(19)

Thus, in the case of the Gauss ﬁlter the variance of
the smoothed random variables for the same ﬁlter width is
much smaller than in the case of the rectangular one. This
conclusion is illustrated in Fig. 3 (bottom panel) where the
distribution of η smoothed with the Gauss ﬁlter (S = 0.8)
is the normally distributed values ξi with parameters µ = 0,
σ = 0.6 for h = 0.01 is given.

The quality of the ﬁt Eq. (19) for all ratios h/S < 0.5
is very good as it clearly shown in Fig 4. It means that in
all practically important cases we can use Eq. (19) to obtain
the Standard Deviation for the smoothed with Gauss ﬁlter
random values.

σ2(cid:16) h
21/2π1/4 r h

σ

St. Dev. [η] ≈

,

(14)

4.2 Correlation of the smoothed random variables

ai =

h

S√2π

e

− 1

S

2(cid:0) ih+h/2

(cid:1)2

Substituting Eq. (14) in Eq. (12) one can ﬁnd that

∞

π (cid:19)(cid:16) h
S(cid:17)2

Var[η] =(cid:18) σ2
Denote r = (h/S), q = exp (−r2), then

Xi=0

e−( h

S )2

×

(i+1/2)2

Var[η] =

σ2r2
2π ×

∞

Xi=0

2q(i+1/2)2

.

.

(15)

(16)

i=0 2q(i+1/2)2

Here P∞

(1960)). Thus

= θ2(0, q) (e.g. Yanke, Emde & L¨osch

Smoothed with an arbitrary ﬁlter, random value η(z) (see
Eq. (10)) depends on the value of z. Thus, for small diﬀer-
ence ∆z = |z1 − z2| the random values η(z1) and η(z2) are
not independent. The correlation coeﬃcients r = r(z1, z2)
depends on the diﬀerence ∆z and the width of the ﬁlter S.
In Fig. 5 (top panel) we plot the value of r as a function
of ∆z (in units of the ﬁlter width). Inspecting the ﬁgure we
can conclude that only for diﬀerences ∆z > (3 − 4) × S the
random variables η(z1) and η(z2) become independent.
On the other hand if we consider diﬀerent sets Ξ and
Θ of random values with equal means and variances, then
the smoothed random variables referred to these sets are
independent as clearly shown in Fig. 5 (bottom panel).

6

A.F. Kholtygin and N.P. Sudnik

i

s
t
n
e
c
i
f
f
e
o
C
 
n
o
i
t
a
e
r
r
o
C

l

1.0

0.8

0.6

0.4

0.2

0.0

0.0

2.0

4.0

6.0

8.0

s
t

i

n
e
c
i
f
f
e
o
C
 
n
o
i
t
a
e
r
r
o
C

l

1.0

0.8

0.6

0.4

0.2

0.0

0.0

2.0

4.0

8.0
 z (in the filter width)

6.0

Figure 5. Top panel: the correlation coeﬃcients for the smoothed
with the Gauss ﬁlter (S = 0.2) normally distributed random vari-
ables as a function of ∆z (solid line) for µ = 0, σ = 0.5 and
h = 0.05 for one set of random values. The level r = 0 is marked
with the dashed line. Bottom panel: the same as in the top panel,
but for random variables from diﬀerent sets.

4.3 Statistics of the smTVS

Let Fi(λ) be the continuum normalized ﬂux at the wave-
length λ for i-th spectrum. It can be presented as sum

Fi(λ) = Ic + Zi(λ) + Ni(λ) ,

(20)

where Ic = 1, Zi(λ) is the net continuum normalized line
ﬂux at the wavelength λ and Ni(λ) is the corresponding
noise contribution. Out of line proﬁle Zi(λ) = 0.

Suppose that the noise component Ni(λ) can be de-
scribed by the Gauss (normal) distribution N (0, σi(λ)),
where σi(λ) is the standard deviation for the noise com-
ponent for i-th spectrum at wavelength λ. Outside the line
σi(λ) = σic, where σic is the noise standard deviation in the
continuum near the line. For weak lines we can put that the
noise σi(λ) = σic both inside and outside the line.

Analogously Eq.

(10) by Fullerton, Gies & Bolton
(1996) we can introduce the mean noise value σ0 for con-
sidered N spectra:

σ0 =  1

N

N

Xi=1

(σic)−2!−1/2

.

(21)

The ratio σi(λ)/σic can be calculated using equation (8)
by Fullerton, Gies & Bolton (1996). Taking into account
Eq. (20) we easily can obtain that

σic (cid:19)2
αi(λ) =(cid:18)σi(λ)

=

1 + Zi(λ) + (1 + 1/b)g′R2

1 + (1 + 1/b)g′R2

.

(22)

Here b is the number of bias exposures averaged, R is the
read-out noise in analog-to-digital conversion unit (ADU)
and g′ = g/Eic, where g is the number of electrons per
ADU and Eic is the continuum ﬂux in ADU.

The factor αi(λ) is responsible for pixel-to-pixel vari-
ations of σi(λ) arising due to the presence of absorption
(Zi(λ) < 0) or emission (Zi(λ) > 0) features. In the limit
of relatively high signal-to-noise ratio S/N > 50 typical for
studied LPV and for usual value of R =2–3 the read-out
noise can be neglected and αi(λ) = 1 + Zi(λ).

Resuming we can write the wavelength correction factor

in Eq. (1) for S = 0 as

qi(λ, 0) =

ω

′

i

αi(λ)

=

σ2
0
σ2
i (λ)

,

(23)

N

Pi=1

where ω

′

i = ωi/

ωi. Taking into account that σic =

i

(S/N )−1
trum i and using equation (22) one can ﬁnd that ω
(σ0/σic)2
(1996)).

, where (S/N )i is the signal-to-noise ratio for spec-
i =
(cf. Eq.(11)-(13) by Fullerton, Gies & Bolton

′

The smoothed ﬂux can be described as

Fi(λ, S) = Ic + Zi(λ, S) + Ni(λ, S) ,

(24)

where the smoothed net line proﬁle Zi(λ, S) can be eval-
uated using Eq. (2) with replacing Fi(l) by Zi(l). The
smoothed noise component

Ni(λ, S) =

1

√2πS

∞

Z−∞

Ni(l)e− 1

2 ( l−λ

S )2

dl ,

(25)

where Ni(l) has the normal distribution N (0, σi(l)) with

σi(l) = σicp1 + Zi(l) . Here we understand the integration

of the random value of noise Ni(l) in terms of calculating
the integral sum of random variables like it was considered
in Eq. (10).

Outside the line the smoothed noise component
Ni(λ, S) has the N (0, σsm
ic ) distribution, where the value of
σsm
ic can be obtained from Eq. (19) with the replacement of
σ by σic and taking into account that parameter h is the
pixel width. Thus

(26)

σsm
ic ≈

σic

21/2π1/4 r h

S (cid:16)1 − e−(πS/h)2(cid:17) .

Due to the strong dependence σi(λ) on λ the distribution
function for the smoothed noise Ni(λ, S) within and near
the line cannot be found analytically.

Let us describe the smoothed residual spectra by the

usual way (see Eq. (1)):

di(λ, S) = Fi(λ, S) − Fi(λ, S) .
The value di(λ, S) corresponds to the residual spectra dij
by Fullerton, Gies & Bolton (1996) (see their Eq. 2) but for
smoothed ﬂuxes Fi(λ, S). Consider the random variable

(27)

η = η(λ, S) =

1

qi(λ, S)d2

i (λ, S) =

1

N − 1
where qi(λ, S) = (σsm

N − 1
0 /σi(λ, S))2. The parameter

N

Xi=1

ξ2
i , (28)

N

Xi=1

D
1.60

1.40

1.20

)

S

,

(
q

1.00

0.80

0.60

0.6

0.4

0.2

0.0

−0.5
−1.0

−2.0

6550 6555 6560 6565 6570 6575

l , Å

Figure 6. The factor q(λ, S) for line Hα and for the diﬀerent
values of the parameter A (marked at the corresponding curves)
for absorption (A > 0, blue and purple curves) and emission (A <
0, red curves) line proﬁles for S = 0.8 ˚A and S/N = 50. Blue solid,
dashed and dotted lines show the variations of the parameter
q(λ, S) for A = 0.4 and S = 0.0, 0.8, and 2.4 ˚A respectively.

σsm

0 =  1

N

N

Xi=1

(σsm

ic )−2!−1/2

(29)

is an analogue of value σ0 but for smoothed ﬂuxes. The ran-
dom value ξi = (qi(λ, S))1/2 di(λ, S). For all i E[ξi] = 0.
Thus E[η] = 0. Any random value ξi has N (0, σsm
0 ) distri-
bution.

To illustrate, we present the results of our calculations
of the selected curves q(λ, S) for the model Hα net line proﬁle
in Fig. (6):

− 1

W (cid:1)2
2(cid:0) λ−λ0

,

(30)

Z(λ) = −Ae
and the signal-to-noise ratio S/N = 50. Here λ0 =
6562.849 ˚A is the laboratory wavelength of the line and
W = 5 ˚A is the typical value of the Hα line width in the
spectra of early type stars correspondingly. The value of A
is the line depth (positive for the absorption line and nega-
tive for the emission ones). Inspecting Fig. (6) it is possible
to conclude that the factor q(λ, S) has to be taken into ac-
count mainly for the strong (|A| > 0.3) lines.
Note that the variation of the parameter S and the ratio
S/N extremely weakly inﬂuence the value of q(λ, S). This
result holds for diﬀerent values of the line proﬁle parameters
and the ratio S/N . Therefore for all S we can put q(λ, S) ≈
q(λ, 0). Thus for all values of S it is possible to use the simple
formula (23) instead of making the numerical integration in
Eq. (25).

The smoothed random values ξi are independent as
belonging to diﬀerent spectra (see subsection 4.2). Thus
the random value η(λ, S) (smooth Temporal Variance Spec-
trum) has (σsm

N−1 distribution.

0 )2χ2

Next we determine by the usual way the small value
of the signiﬁcance level α ≪ 1 and a value χ2
α such as
the probability P (χ2 > χ2
α) = α for given N − 1 de-
grees of freedom. We suppose if within the line the value
smT V S(λ, S) > (σsm
α/(N − 1) then the LPV is real at
the signiﬁcance level α.
Our calculations show that with the error smaller than
10−3 in the continuum units the value hsmT V Scont(λ, S)i =

0 )2 χ2

smTVS: weak LPV and NRP diagnostics

7

0 )2. It signiﬁes that normalized (smT V S)N(λ, S) =
(σsm
0 )2. In the case of using the normalized
smT V S(λ, S)/ (σsm
smTVS we will suppose that LPV is real if smT V SN(λ, S) >
χ2
α/(N − 1).

5 CALCULATIONS OF LINE PROFILES IN

SPECTRA OF NON-RADIAL PULSATING
STARS

The line proﬁle of non-radial pulsating star in an arbitrary
moment of time t can be represented as

I(λ) = Imean(λ, t) + ∆I(λ, t) .

(31)

Here Imean(λ) is the main part of the line proﬁle that does
not depend on time (average proﬁle), ∆I(λ) is the vari-
able part of the proﬁle that can be presented according
to Telting & Schrijvers (1997b) as follow:

∆I(λ) =

I0(λ) sin(ωt + Ψ0(λ))

+I1(λ) sin(2ωt + Ψ1(λ))

(32)

+I2(λ) sin(3ωt + Ψ2(λ)) + . . . .

Telting & Schrijvers (1997b) performed detailed mod-
elling of line proﬁles in the spectra of non-radially pulsating
stars using Monte-Carlo method for l 6 15, |m| 6 l and
random values of parameters i, W, Vmax, k, ω, Ω etc. Here i
is the inclination of the rotational axis, W is the width
of the intrinsic line proﬁle for any surface element of the
star, Vmax is the maximal pulsation velocity amplitude, k
is deﬁned as the ratio of the horizontal to the vertical pul-
sation velocity amplitude, ω is the angular pulsation fre-
quency and Ω is the angular rotation frequency of the star.
Their calculations showed that amplitudes of harmonics
Ii(V ) decrease fast along with increasing number of har-
monic and the phase diﬀerence between red and blue wings
is ∆Φi = Φi(+V sin i) − Φi(−V sin i) ∼ π(i + 1)l. The au-
thors found out that the value ∆Φ0 is determined by l, and
the value ∆Φ1 is determined by modulus of the value m.
Telting & Schrijvers (1997b) obtained the relations:

|∆Φ0|

π = 0.10 + 1.09 |∆Φ0 |
π = −1.33 + 0.54 |∆Φ1 |

l ≈ p0 + q0
|m| ≈ p1 + q1
that can be used for modelling line proﬁles in the spectra of
non-radial pulsating stars.

(34)

(33)

|∆Φ0|

π

π

,

,

The modelling shows that the component I2 practically
does not aﬀect the proﬁle shape. Therefore only main fre-
quency (I0) and its ﬁrst harmonic (I1) can be used in equa-
tion (32).
The

dependences

I0(V )

I1(V )

and

(1997); Telting & Schrijvers

in Schrijvers et al.
we have approximated as
I0(V ) = I 0(1 − xµ1 ),
I1(V ) = I 1(1 − xµ2 ),
where I 0 = I0(0), I 1 = I1(0), the parameter x =
|V /(V sin i + W )|. The values of µ1 and µ2 are chosen so that
they ﬁt the dependences I0(V ) and I1(V ) by Schrijvers et al.
(1997). Our computations show that the values of µ1 ≈
µ2 = 3–4 are optimal.

(35)

obtained
(1997b)

l
8

A.F. Kholtygin and N.P. Sudnik

s
y
a
d

 
,

T

0.8

0.6

0.4

0.2

0.0

0.04

0.02

0.00

-0.02

0.8

0.6

0.4

0.2

0.04

0.02

0.00

-0.02

0.8

0.6

0.4

0.2

-200

 0

V, km/s

 200

-0.04

0.0

-200

 0

V, km/s

 200

-0.04

0.0

-200

 0

V, km/s

 200

0.04

0.02

0.00

-0.02

-0.04

Figure 7. Left panel: model residual proﬁles for pulsation mode
l = 2, m = −2, γ = −1 for three pulsation cycles. Middle panel:
the same as in the left panel but for l = 4, m = −4. Right panel:
the same as in the left panel but for l = 8, m = 8, γ = 1.

The amplitudes of harmonics of main pulsation fre-
quency ν = 2πω decrease fast with increasing the number
of harmonic j. Usually I j/I j+1 = 3–5.

The phase dependences of the main component and its
ﬁrst harmonic consistent with empirical dependences (33)
can be written as

Ψ0(V ) = Ψ0(V ) + γ l−p0
q0

π
2 ,
π
2 .

Ψ1(V ) = Ψ0(V ) + γ |m|−p1

q1

(36)

The parameter γ deﬁnes the direction of motion of pulsation
waves on the stellar surface.The value γ = −1 corresponds
to prograde (p) waves that move in the direction of star ro-
tation. The value γ = 1 corresponds to retrograde (r) waves
that move in the direction opposite to the rotation of the
star.

The results of the modelling of residual proﬁles in sec-
toral (l = m) mode using equations (32), (35) and (36) are
presented in Fig. 7. Fig. 7 clearly shows the motion of the
features along the line proﬁle from blue to red wings in a
case of prograde motion and from red to blue for retrograde
motion and that with increasing l the number of the fea-
tures, related to NRP, increases. With increasing l the ve-
locity of motion of the NRP features along the line proﬁle
also increases.

The calculations for NRP mode (4,-4) with the set
of parameters as used by Telting & Schrijvers (1997a) in
their Fig.1 were done to check our method of modelling
NRP. From a comparison of our Fig. 8 and Fig.1 by
Telting & Schrijvers (1997a) we can conclude that both am-
plitude and phase curves in both cases are close, but the
diﬀerences are noticeable. These diﬀerences have a little ef-
fect on the LPV, because the shape of the mean proﬁle has
been removed from the individual ones.

6 RESULTS AND DISCUSSION

6.1 Diagnostic of ultra weak LPV

To illustrate the eﬃciency of smTVS we will analyse vari-
ability related to NRP with parameters ν = 3.4 d−1, l = 5,
m = −2, V sin i = 160 km/s, W = 5 km/s for low S/N
model spectra. The time interval between sequential proﬁles
is 0.021h. The number of spectra is 100. The full length of
simulated observations is 2.1h. The dynamic spectrum of
model line proﬁles for low signal-to-noise ratio S/N = 50
and the amplitudes of main frequency and its ﬁrst harmonic
I0 = 0.01, I1 = 0.003 in continuum units respectively is
presented in Fig. 9 (top).

For the residual proﬁles, showed in Fig. 9 (top), smTVS

0.8

0.6

0.4

0.2

s
y
a
d

 
,

T

e
d
u

t
i
l

p
m
A

0.0
0.18

0.15

0.12

0.09

0.06

0.03

0.00
 10

 8

 6

e
s
a
h
P

 4

 2

 0

-2

0.04

0.02

0.00

-0.02

-0.04

A0
A1

0j
1

-200

-100

 0

V, km/s

 100

 200

Figure 8. Line proﬁle variations due NRP in mode (4,-4) for the
set of parameters similar to those used by Telting & Schrijvers
(1997a) in their Fig. 1. From top to bottom: residual proﬁles for
3 pulsation cycles, distribution of the amplitudes of the variations
with input pulsation frequency I0 (solid red line) and its ﬁrst har-
monic I1 (dashed black line) expressed in units of average central
line depth according to Telting & Schrijvers (1997a), phase distri-
bution of the variations with input pulsation frequency Φ0 (solid
red line) and its ﬁrst harmonic Φ1 (dashed black line) expressed
in units of π radians.

were calculated for diﬀerent ﬁlter widths S. The normal-
ized (smTVS)1/2
for ﬁlter widths from S = 2 km/s to
S = 10 km/s are given in Fig. 9 (bottom panel). The lowest
curve in the ﬁgure shows normalized (TVS)1/2
N .

N

For the adopted low S/N = 50 the pulsation amplitude
is equal only 50% of the average noise level. It is seen from
the Fig. 9, the contribution of the variable component of
the proﬁle associated with NRP in TVS does not stand out
against the noise contribution. At the same time the smTVS
clearly demonstrates the presence of weak LPV.
√S which let
us detect even very weak variations of the line proﬁle using
suitable smoothing ﬁlter width S.

The amplitude of (smTVS)1/2

N increases ∼

6.2 TVS and NRP

Firstly, we did TVS analysis for the model
line proﬁles
caused by NRP only. It turns out that the number of peaks
Np in the TVS is related to l and m if the time sampling is
uniform.

For determination of Np, only peaks whose amplitudes
are higher then the amplitude of the noise in the TVS con-
tinuum region were counted. See, for example, Fig. 13 and

j
s
y
a
d

 
,

T

0.08

0.06

0.04

0.02

0.00

2

/

1

N
)
S
V
T
m
s
(

2.2

1.9

1.6

1.3

1.0

0.7

0.10

0.05

0.00

-0.05

-0.10

TVS
2 km/s
5 km/s
10 km/s

-300 -200 -100  0  100  200  300

V, km/s

Figure 9. Top panel: The dynamic spectrum of 100 sequen-
tial model line proﬁles for NRP with parameters ν = 3.4 d−1,
l = 5, m = −2, V sin i = 160 km/s, W = 5 km/s, I0 = 0.01,
I1 = 0.003, S/N = 50. Bottom panel: Normalized (smTVS)1/2
for diﬀerent ﬁlter widths marked in the panel. The bottom solid
red line is (TVS)1/2
N . The thin dashed line shows the signiﬁcance
level 0.001.The vertical dashed lines mark ±V sin i.

N

Fig. 14. The number of peaks in each panel of Fig. 13 de-
noted in Fig. 14 versus corresponding value of length of ob-
servations.

Unfortunately, there is no dependence between Np and
pulsation mode for time sampling with gaps. If the uniform
part is present in the data it can be used for the following
analysis. The calculations and results described below are
performed for uniform time sampling.

In a case if the length of observations (T ) is less than
1/3 of the pulsation period (P ) and only main frequency (I0)
is presented or the ratio I1/I0 6 0.1 the number of peaks in
TVS equal to l except l = 0 (1 peak) and l = 1 (2 peaks)
(Fig. 10). For l = 9 the number of peaks can be l−1 because
the amplitude of one peak can be small and in some random
realizations it is very close to the noise level.

When the ratio I1/I0 > 0.1 the number of peaks in-
creases. Usually, the higher the value of m, the higher the
number of peaks. There is no clear dependence between l,
m and Np in this case. Fig. 11 and Fig. 12 show Np in the
TVS versus l and (l + |m|)/2 respectively. Here for l = 9
the number of peaks also can be l − 1 like for I1/I0 6 0.1
because the amplitude of the ninth peak is very close to the
noise level. Note that the scattering of points in the ﬁgures
stays small.

Generally the number of peaks in TVS obeys the fol-

lowing conditions

l 6 NP if T 6

1
3

P .

(37)

If T > 1

3 P the number of peaks decreases and usually
smaller than l. (TVS)1/2
N for diﬀerent length of observations
in units of the pulsation period is shown in Fig. 13. For

smTVS: weak LPV and NRP diagnostics

9

 10

I1/I0 = 0.0

p
N

 8

 6

 4

 2

 0

 0

 1

 2

 3

 4

l

 5

 6

 7

 8

 9

Figure 10. Number of peaks in (TVS)1/2
for diﬀerent l ob-
tained for 100 sequential spectra with parameters I1/I0 = 0,
ν = 3.4 d−1, S/N = 1000. The solid line is least squares linear
approximation ﬁt for this dependence.

N

 14

 12

 10

p
N

 8

 6

 4

 2

 0

I1/I0 = 0.3

 0

 1

 2

 3

 4

l

 5

 6

 7

 8

 9

Figure 11. Number of peaks in (TVS)1/2
N versus l obtained for
100 sequential spectra with parameters I1/I0 = 0.3, ν = 3.4 d−1,
S/N = 1000. The solid line is least squares linear ﬁt.

T = nP , where n = 1, 2, 3... there is only one peak in the
TVS. The number of peaks (Np) in (TVS)1/2
N versus length
of observations (T) is shown in Fig 14. This dependence can
be useful to estimate the pulsation period. Denote via tk the
time interval between ﬁrst spectrum and the spectrum with
number k. Then we can look for minima in the dependence
Np(tk). These minima correspond to values of tk = nP .

The amplitude and the location of peaks in TVS also de-

 14

 12

 10

p
N

 8

 6

 4

 2

 0

I1/I0 = 0.3

 0

 1

 2

 3

 4
 5
(l+|m|)/2

 6

 7

 8

 9

Figure 12. Number of peaks in (TVS)1/2
N versus (l + |m|)/2
obtained for 100 sequential spectra with parameters I1/I0 = 0.3,
ν = 3.4 d−1, S/N = 1000. The solid line is least squares linear
ﬁt.

10

A.F. Kholtygin and N.P. Sudnik

 7

1/4P

3/4P

1.5P

2

/

1

N
)
S
V
T
(

 5

 3

 1

 7

1/3P

1P

1.75P

2

/

1

N
)
S
V
T
(

 5

 3

 1

 7

1/2P

1.25P

2P

2

/

1

N
)
S
V
T
(

 5

 3

 1
−400 −200

Velocity, km/s

Velocity, km/s

 0  200  400

−400 −200

 0

 200  400

−400 −200  0

 200  400

Velocity, km/s

Figure 13. (TVS)1/2
N for NRP in mode (5, -2) for diﬀerent length of observations in a fraction of pulsation period (P ) denoted on the
panels, ν = 3.4 d−1, I1/I0 = 0.3, S/N = 1000. The number of spectra is 25 for the length of observations equal 0.25P, 50 for 0.5P, 100 for
P, 150 for 1.5P, 200 for 2P. The signiﬁcance level 0.001 is shown by the dashed horizontal line. The vertical dashed lines display ±V sin i.

 6

 5

 4

p
N

 3

 2

 1

 0

 0.5

 1

 1.5

T/P

 2

 2.5

 3

Figure 14. Number of peaks in (TVS)1/2
N for diﬀerent length
of observations as a function of time-series length (in units of
pulsation period P ). NRP mode (5, -2), ν = 3.4 d−1, I1/I0 =
0.3, S/N = 1000. The number of spectra is 25 for the length of
observations equal 0.25P, 50 for 0.5P, 100 for P, ..., 300 for 3P.

pends on the initial phase of NRP for the ﬁrst spectrum from
those which were used to calculate the TVS. The number of
peaks stays the same for most values of the initial phase but
it can change for few of them. In Fig. 15 the (TVS)1/2
N for
pulsation mode (5, -2) for diﬀerent initial phases is shown.
Although the TVS for diﬀerent initial phases look diﬀerent
it is diﬃcult to estimate the initial phase from the TVS
without additional modelling.

 7

j =0

 7

2
1

/

 5

 3

N
)
S
V
T
(

 1

 7

2
/
1

 5

 3

N
)
S
V
T
(

 1

 7

2
/
1

 5

 3

N
)
S
V
T
(

j =1

j =2

2
1

/

 5

 3

N
)
S
V
T
(

 1

 7

2
/
1

 5

 3

N
)
S
V
T
(

 1

 7

2
/
1

 5

 3

N
)
S
V
T
(

 1

 1

j =3

j =4

j =5

−400 −200

 0

 200  400

Velocity, km/s

−400 −200

 0

 200  400

Velocity, km/s

Figure 15. (TVS)1/2
N for diﬀerent initial phases. The phases are
denoted on the panels. NRP mode is (5, -2), 100 sequential spec-
tra, ν = 3.4 d−1, I1/I0 = 0.3, S/N = 1000. The signiﬁcance level
0.001 is shown by the dashed horizontal line. The vertical dashed
lines show ±V sin i.

 8

 6

2

/

1

p1=1.0
p2=0.0

 8

 6

2

/

1

p1=0.8
p2=0.2

 8

 6

2

/

1

p1=0.6
p2=0.4

smTVS: weak LPV and NRP diagnostics

11

−400 −200

 0

 200  400

−400 −200

 0

 200  400

−400 −200

 0

 200  400

Velocity, km/s

Velocity, km/s

Velocity, km/s

p1=0.4
p2=0.6

p1=0.2
p2=0.8

p1=0.0
p2=1.0

N
)
S
V
T
(

 4

 2

 0

 8

 6

2
1

/

N
)
S
V
T
(

 4

 2

 0

N
)
S
V
T
(

 4

 2

 0

 8

 6

2
1

/

N
)
S
V
T
(

 4

 2

 0

N
)
S
V
T
(

 4

 2

 0

 8

 6

2
1

/

N
)
S
V
T
(

 4

 2

 0

−400 −200

 0

 200  400

−400 −200

 0

 200  400

−400 −200

 0

 200  400

Velocity, km/s

Velocity, km/s

Velocity, km/s

Figure 16. (TVS)1/2
ν = 4.6 d−1, I1/I0 = 0.3, S/N = 1000, T = 1.7h (T 6 1
p1 = A1
vertical dashed lines show ±V sin i. The horizontal dashed line is the signiﬁcance level 0.001.

N obtained for 100 sequential spectra for NRP in two modes (l, m) = (2, −1), ν = 3.4 d−1 and (l, m) = (5, −2),
3 P , where P is the pulsation period). Here A1 + A2 = 0.01 = const, where
, A1 and A2 are the amplitudes of pulsation in modes (l, m) = (2, −1) and (l, m) = (5, −2) respectively. The

, p2 = A2

A1+A2

A1+A2

N

We also modelled TVS for multiple NRP modes. The
(TVS)1/2
for two pulsation modes (l, m) = (2, −1), ν =
3.4 d−1 and (l, m) = (5, −2), ν = 4.6 d−1 with diﬀerent am-
plitudes and T 6 1
3 P obtained for 100 sequential spectra is
shown in Fig. 16. In the ﬁgure A1+A2 = 0.01 = const, where
p1 = A1
, A1 and A2 are the amplitudes of
pulsations in modes (l, m) = (2,−1) and (l, m) = (5,−2) re-
spectively. In the case of multiple NRP modes equation (37)
is valid at least for lowest l.

, p2 = A2

A1+A2

A1+A2

For low quality data equation (37) should be used with
caution. The number and the amplitude of peaks in the TVS
also depend on the amplitude of pulsations, the S/N ratio
and the number of spectra. Depending on the combination
of these three factors there could be one or several peaks in
the TVS (smTVS). The smaller amplitude of pulsations the
smaller the amplitude of the peaks. The lower the S/N and
the fewer number of spectra the fewer number of peaks can
be seen. For high modes decreasing of Np goes faster with
decreasing S/N, number of spectra, and pulsation amplitude
than for low modes. Using smTVS can add some extra peaks
if the ﬁlter width is small. For higher ﬁlter width some small
amplitude peaks can disappear but the high amplitude peaks
remain visible.

To estimate the pulsation mode using smTVS one has
to play with the smoothing ﬁlter width. A good strategy is
to start with a very small ﬁlter width and to increase it.
Firstly, the number of peaks in smTVS will increase. The
amplitude of peaks will increase. For some value of the ﬁlter
width, the number of peaks will reach its maximum and
when increasing the ﬁlter width further the number of peaks
will decrease. This happens because by increasing the ﬁlter
width, the amplitude and the width of the peaks increase
and eventually the peaks will merge. The smTVS for the
ﬁlter width with maximum number of peaks should be used

to estimate the pulsation mode. Note, that this method gives
only estimation of the pulsation mode.

When a diﬀerent ﬁlter width changes a number of peaks,
smTVS can be used to estimate the pulsation mode. It is
also possible that for some value of S the smTVS will show
extra peaks but the number of peaks will be fewer than it
will be for good quality data. If the number of peaks is one
for any ﬁlter width the smTVS cannot be used for pulsa-
tion mode estimation. If the amplitude of pulsation is small
(for example 0.001) even for high quality data smTVS will
detect variability but will show only one peak for diﬀerent
ﬁlter widths. In this case the smTVS cannot be used for the
pulsation mode estimation.

6.3 NRP and Rotational modulation

To analyse the contribution of rotation on the shape of TVS
we performed the TVS analysis for the spectra aﬀected by
rotational modulation only. We calculated the spectra ac-
cording to Henrichs & Sudnik (2014) model where the line
proﬁle variability induced by the stellar prominences repre-
sented as a spheres touching the stellar surface. The promi-
nence will give extra absorption or emission in the line pro-
ﬁle depending on its location in the line of sight. After that
we computed spectra caused by rotational modulation and
NRP both. Then the TVS for the spectra aﬀected by ro-
tational modulation only, by NRP only, and by NRP and
rotational modulations both was calculated.

Fig. 17 shows the (TVS)1/2

for 5 prominences ran-
domly located around the star. The conﬁguration of the
prominences does not change with time. Here the length
of simulated observations (T ) is 2.1h, the number of spec-
tra included in the time series is 33, the pulsation period is
7.06h, the pulsation mode (5,-2), the rotation period is 4d,

N

2
/
1

N
)
S
V
T
(

 9
 8
 7
 6
 5
 4
 3
 2
 1
 0

 9
 8
 7
 6
 5
 4
 3
 2
 1
 0

N
)
S
V
T
(

RM
NRP
RM+NRP

−400−300−200−100  0  100  200  300  400

Velocity, km/s

12

A.F. Kholtygin and N.P. Sudnik

RM
NRP
RM+NRP

2
/
1

−400−300−200−100  0  100  200  300  400

Velocity, km/s

Figure 17. (TVS)1/2
N for rotational modulation caused by ﬁve
prominences randomly located around the star (red dotted line),
by NRP in the mode (5,-2) (green dashed line) and for their super-
position (blue solid line). The length of simulated observations is
2.1h, the number of spectra included in time series is 33, the pulsa-
tion period is 7.06h, the rotation period is 4d, V sin i = 160 km/s
(marked by the vertical dashed lines), and S/N = 1000.

2
1

/

N
)
S
V
T
(

 9
 8
 7
 6
 5
 4
 3
 2
 1
 0

RM
NRP
RM+NRP

−400−300−200−100  0  100  200  300  400

Velocity, km/s

Figure 18. The same as in Fig. 17 but the length of simulated
observations is 7.06h, the number of spectra is 100.

V sin i = 160 km/s, S/N = 1000. The amplitude of the TVS
for rotational modulation (red dotted line) is small. The
rotation modulation does not change the number of peaks
in the TVS for superposition of rotational modulation and
NRP (solid blue line). Though the amplitude of the TVS for
superposition of rotational modulation and NRP is smaller
that for NRP only (green dashed line) the number of peaks
stays the same. In this case it is possible to estimate mode
l using TVS.

For longer T the impact of rotation on the shape of re-
sulting TVS increases. The amplitude of TVS related with
rotation increases and the shape of TVS caused by superpo-
sition of NRP and rotational modulation would be diﬀerent
from both of them separately (Fig. 18 and Fig. 19). In this
situation the TVS (smTVS) cannot be used for the estima-
tion of the NRP modes and the pulsation period.

6.4 Interpretation of the observations

Weak variability of the lines of the ions Si, C, O, N, Mg in
the spectra of programme O stars revealed by smTVS only
was reported in our previous papers (Kholtygin et al. 2003,
2006, 2011; Sudnik 2012).

To estimate pulsation modes the TVS (smTVS) was

Figure 19. The same in as Fig. 17 but the length of simulated
observations is 12.35h, the number of spectra is 175.

computed for datasets that have eight or more spectra per
1–3h observations. This time interval was chosen taking into
account that equation (37) is valid if T 6 1
3 P . It is not
reasonable to consider a smaller number of spectra during 1
to 3h observations.

Our source list yields only two datasets that are suitable
for estimation NRP mode using TVS (smTVS). The spectra
were divided into three groups with the length of observa-
tions approximately one hour, two hours and three hours.
For these groups both TVS and smTVS were calculated.

The (TVS)1/2

N and (smTVS)1/2

N for the N II λ 5731 ˚A,
Si III λ 5740 ˚A, N II λ 5767 ˚A lines proﬁles in the spectra of
star ρ Leo are shown in Fig. 20. The star is slow rotator
(V sin i=75 km/s). The rotation would not substantially af-
fect the TVS (smTVS) for the length of observations 3.5h
and less.

The TVS obtained for the length of observations 1h does
not show variability for all three lines. In the same way the
smTVS for the same length of observations with the ﬁlter
width S = 0.1 ˚A demonstrates the existence of LPV at the
signiﬁcance level α = 10−3.

The number of peaks in smTVS is diﬀerent for these
three lines and decreases with increasing length of ob-
servations. There are four peaks in smTVS for the line
N II λ 5767 ˚A (right panel) and T = 1h. The number of peaks
is reduced to three for T = 2h and to two for T = 3.5h. The
number of peaks for the line Si III λ 5740 ˚A (middle panel)
in the V sin i band decreases from 4 for T = 1h to 2 for
T = 3.5h. The number of peaks for the line N II λ 5731 ˚A
(left panel) (3–4) practically does not change for all lengths
of observations. The decrease of the number of peaks in the
smTVS with increasing length of observation is consistent
with our model. To search the pulsation period we need a
longer dataset as long as rotation would not inﬂuence TVS
for T = P .

To estimate the pulsation mode l we can use the number
of peaks in smTVS for minimal length of observations T =
1h. The smTVS shows diﬀerent number of peaks for the
N II λ 5731 ˚A, Si III λ 5740 ˚A, N II λ 5767 ˚A lines. The mode
l would be equal or less than minimum number of peaks.
Thus l 6 4. Using the linear ﬁt in Fig. 11 we can estimate
l = 3 − 4. This value is agree with an estimation l > 2 by
Kholtygin et al. (2007).
The TVS and smTVS for the line Si III λ 5740 ˚A present
special interest. We see in the smTVS for this line in Fig. 20

(middle panel) (unlike the smTVS for the N II λ 5731 ˚A and
N II λ 5767 ˚A lines) the strong contribution in the region
outside the ±V sin i range. Furthermore, the amplitude of
the smTVS beyond the ±V sin i range is nearly constant in
contrast with the smTVS inside the ±V sin i range. More-
over, the number of small peaks in the parts of smTVS to
the left and right of ±V sin i range is close to the number of
peaks inside this range.
The cause of such behaviour is not clear. We can con-
clude that it may be connected with the modulation of
the stellar wind by the NRP. This possibility was noted by
Kholtygin et al. (2006). When such modulation is extended
far from the stellar surface the eﬀect of absorption due to
the matter of the stellar wind in the line of sight between the
star and the observer leads to repeating the shape of both
the TVS and the smTVS inside and outside the ±V sin i
band.
The TVS for δ Ori A (Fig. 21) for T = 1h shows the
LPV but the amplitude of the TVS is small and does almost
not exceed the signiﬁcance level α = 10−3. The smTVS for
T = 1h indicates that smTVS is deﬁnitely above this level
and the peaks in smTVS are clearly seen.

The number of peaks in smTVS for the C III λ 5696 ˚A
line (right panel) in the ±V sin i range is 3 for the length
of observations T = 1h and T = 3.5h. For T = 2h the
number of peaks is diﬃcult to estimate. Such behaviour of
smTVS for the C III λ 5696 ˚A line can be explained by the
modulation of the stellar wind (see above). The shape of
smTVS beyond the ±V sin i range is strongly asymmetric.
This asymmetry can be connected with the contribution of
the component Ab of δ Ori A in NRP (see, for example,
Kholtygin et al. 2006).

The number of peaks in the He I λ 4713 ˚A line (left
panel) is two and does not strongly change by increasing
the length of the observations. In smTVS for the line Hβ
(middle panel) the number of peaks also does not exceed 2
in the ±V sin i range. So, we can conclude that the mode
l 6 2 in line with the conclusion by Kholtygin et al. (2006)
that the main component Aa1 of the triple system δ Ori A
pulsates in the NRP (l,m) mode (2,-2).

The diﬀerent number of peaks observed in diﬀerent lines
can, in principle, be connected with various values of the
intrinsic line width W . More over, these lines can be formed
at the various depth in the stellar atmosphere and hence the
velocity ﬁeld in the line formation area could be diﬀerent.

The rotation modulation does almost not change the
number of peaks for such length of observations but it
can change the amplitude and the shape of peaks in TVS
(smTVS) as it was shown in Sect. 6.3. If some lines are more
sensitive to local inhomogeneities in the stellar atmosphere
than others then rotation modulation will have various inﬂu-
ence on diﬀerent lines proﬁles. Consequently the amplitude
and the shape of peaks in TVS (smTVS) will be diﬀerent
for diﬀerent lines.

7 CONCLUSIONS

We demonstrated that the method of smTVS analysis is very
eﬀective in detecting micro LPV that cannot be discovered
the usual way. This method can be used when amplitude of
the proﬁle variations is small (less than 1% in continuum

smTVS: weak LPV and NRP diagnostics

13

unit) and does not exceed the noise level, the number of
spectra is small and the time series are irregular.

Weak variability of the lines of the ions N, Mg, S in
spectra of stars ρ Leo and λ Cep was revealed by smTVS
only.

We show how the TVS and smTVS analysis of the spec-
tra of non-radially pulsating stars can be used for the esti-
mation of a pulsation mode l.

ACKNOWLEDGMENTS

We would like to acknowledge our anonymous referee for
very useful comments and suggestions which improved an
earlier version of the manuscript. We acknowledge Saint-
Petersburg State University (SPbGU) for the research
grants 6.50.1555.2013 and 6.38.18.2014.

REFERENCES

Aerts C., de Pauw M., Waelkens C., 1992, A&A, 266, 294
Ballester P., 1994, A&A, 286, 1011
Berdyugina S.V., Telting J.H., Korhonen H., 2003, A&A,

406, 273

Brandt S., 1970, Statistical and Computational methods in
data analysis. North Holland Publ. Comp., Amsterdam -
London

Crowther P.A., Lennon D.J., Walborn N.R., 2006, A&A,

446, 279

Fullerton A.W., Gies D.R., Bolton C.T., 1996, ApJS, 103,

475

Fullerton A.W., Massa D.L., Prinja R.K., 2006, ApJ, 637,

1025

Harvin J.A., Gies D.R., Bagnuolo W.G., Jr., Penny L.R.,

Thaller M.L., 2002, ApJ, 565, 1216

Henrichs H.F., Sudnik N.P., 2014, IAU Symposium, 302,

280

Hoﬄeit D, 1996, JAAVSO, 24, 105
Howarth I.D., Siebert K.W., Hussain G.A.J., Prinja R.K.,

1997, MNRAS, 284, 265

Kaufer A., Stahl O., Wolf B., G¨ang Th., Gummersbach
C.A., Ko´vacs J., Mandel H., Szeifert Th., 1996, A&A,
305, 887

Kim K.-M., Jan B.-H., Han I., Jang J.G., Sung H.C.,
Chun M.-Y., Hyung S., Yoon T.-S., Vogt S.S., 2002, Jour-
nal of Korean Astronomical Society, 35, 221

Kholtygin A.F., Monin D.N., Surkov A.E., Fabrika S.N,

2003, Astronomy Letters, 29, 3, 175

Fabrika

Kholtygin A.F., Burlakova T.E.,

S.N.,
Valyavin G.G, Yushkin M.V., 2006, Astronomy Re-
ports, 50, 11, 887
Kholtygin A.F.,

S.N., Burlakova T.E.,
Valyavin G.G., Chountonov G.A., Kudryavtsev G.O.,
Kang D., Yushkin M.V., Galazutdinov G.A., 2007,
Astronomy Reports, 51, 11, 920

Fabrika

Sudnik N.P.,

Kholtygin A.F.,

Burlakova T.E.,
Valyavin G.G, 2011, Astronomy Reports, 55, 12,
1105
Ma´ız-Apell´aniz et al. J., Walborn N.R.,Galu´e H. ´A.,
Wei L.H., 2004, ApJS, 151, 103

Markova N., 2002, A&A, 385, 479

14

A.F. Kholtygin and N.P. Sudnik

3.5 h

2 h

1 h

1 h

 5
 4
 3
 2
 1
 5
 4
 3
 2
 1
 5
 4
 3
 2
 1
 5
 4
 3
 2
 1

2

/

1

N
)
S
V
T
m
s
(

2

/

1

N
)
S
V
T
m
s
(

2

/

1

N
)
S
V
T
m
s
(

2

/

1

N
)
S
V
T
(

1.005

1.000

0.995

0.990

t

n
o
c
F

/

Fl

N II 5731

Si III 5740

3.5 h

2 h

1 h

1 h

2

/

1

N
)
S
V
T
m
s
(

2

/

1

N
)
S
V
T
m
s
(

2

/

1

N
)
S
V
T
m
s
(

 9
 7
 5
 3
 1

 9
 7
 5
 3
 1

 9
 7
 5
 3
 1

2

/

1

N
)
S
V
T
(

 9
 7
 5
 3
 1
1.00

t

n
o
c
F

/

Fl

0.95

0.90

0.85

N II 5767

3.5 h

2 h

1 h

1 h

 7

 5

 3

 1

 7

 5

 3

 1

 7

 5

 3

 1

 7

 5

 3

2

/

1

N
)
S
V
T
m
s
(

2

/

1

N
)
S
V
T
m
s
(

2

/

1

N
)
S
V
T
m
s
(

2

/

1

N
)
S
V
T
(

 1
1.01

1.00

0.99

t

n
o
c
F

/

Fl

-150

-50
 50
Velocity, km/s

 150

0.80

-300 -150

 0

 150  300

Velocity, km/s

0.98

-200 -100

 0

 100  200

Velocity, km/s

N for the length of observation 0.98h, (smTVS)1/2

Figure 20. The N II λ 5731 ˚A, Si III λ 5740 ˚A, N II λ 5767 ˚A lines in the spectra of ρ Leo. From bottom to top: the line proﬁle, the
(TVS)1/2
N for the length of observation
2.01h, (smTVS)1/2
N for the length of observation 3.54h. The ﬁlter width S is 0.1 ˚A. The horizontal line corresponds to the signiﬁcance
level 0.001. The vertical dashed lines denote ±V sin i.

N for the length of observation 0.98h, (smTVS)1/2

Markova N., Puls J., Repolust T., Markov H., 2004, A&A,

413, 693

Markova N., Puls J., Scuderi S., Markov H., 2005, A&A,

440, 1133

Positional and photometric characteristics of a large for-
mat ”Uppsala CCD”. Preprint 169. Special Astrophysical
Observatory, Nizhnii Arkhyz

Schrijvers C., Telting J.H., Aerts C., Ruymaekers E., Hen-

Martins F., Marcolino W., Hillier D.J., Donati J.-F.,

richs H.F., 1997, A&AS, 121, 343

Bouret J.-C., 2015, A&A, 574, id.A142

Shergin V.S., Kniazev A.Y., Lipovetsky V.A, 1996, Astron.

Oliveira A.S, Steiner J.E., Cieslinski D., 2003, MNRAS,

Nachr., 317, 95

346, 963

Oliveira A.S, Steiner J.E., 2004, MNRAS, 351, 685
Oliveira A.S, Lima H.J.F., Steiner J.E. et al., 2014, MN-

RAS, 444, 2692

Orfanidis S.J., 2010, Introduction to Signal Processing.

Rutgers University, New Jersey

Panchuk V.E., Piskunov N.E., Klochkova V.G.,
Yushkin M.V., Ermakov S.V., 2002, Spectral com-
plex of the Nasmyth focus of the 6 m telescope. X.

Sota A., Ma´ız-Apell´aniz J., Walborn N.R., Alfaro E.J.,
Barb´a R.H., Morrell N.I., Gamen R.C., Arias J.I., 2011,
ApJS, 193, 24

Sudnik N.P., 2012, AASP, 2, 5
Telting J.H., Schrijvers C., 1997a, A&A, 317, 723
Telting J.H., Schrijvers C., 1997b, A&A, 317, 742
Thompson G.B., Morrison N.D., 2013, AJ, 145, id. 95
Yanke E., Emde F., L¨osch F., 1960, Tafeln H¨oherer funk-

tionen. B.G. Teubner Verlagsgesellschaft, Stuttgart

He I 4713

2.8 h

2 h

1 h

1 h

 14

 10

 6

 2
 14

 10

 6

 2
 14

 10

 6

 2
 14

 10

 6

2

/

1

N
)
S
V
T
m
s
(

2

/

1

N
)
S
V
T
m
s
(

2

/

1

N
)
S
V
T
m
s
(

2

/

1

N
)
S
V
T
(

 2
1.01

0.99

0.97

0.95

0.93

t

n
o
c
F

/

Fl

Hb  4861

2.8 h

2 h

1 h

1 h

 14

 10

 6

 2
 14

 10

 6

 2
 14

 10

 6

 2
 14

 10

 6

2

/

1

N
)
S
V
T
m
s
(

2

/

1

N
)
S
V
T
m
s
(

2

/

1

N
)
S
V
T
m
s
(

2

/

1

N
)
S
V
T
(

 2
1.00

0.90

0.80

t

n
o
c
F

/

Fl

0.70

-800 -400

 0

 400  800

Velocity, km/s

smTVS: weak LPV and NRP diagnostics

15

 14

 10

 6

 2
 14

 10

 6

 2
 14

 10

 6

 2
 14

 10

 6

2

/

1

N
)
S
V
T
m
s
(

2

/

1

N
)
S
V
T
m
s
(

2

/

1

N
)
S
V
T
m
s
(

2

/

1

N
)
S
V
T
(

 2
1.05

1.03

1.01

0.99

t

n
o
c
F

/

Fl

C III 5696

2.8 h

2 h

1 h

1 h

-400 -200  0  200  400

Velocity, km/s

-600 -300

 0

 300  600

Velocity, km/s

N for the length of observation 1.01h, (smTVS)1/2

Figure 21. The He I λ 4713 ˚A, Hβ λ 4861 ˚A, C III λ 5696 ˚A lines in the spectra of δ Ori A. From bottom to top: the line proﬁle, the
(TVS)1/2
N for the length of observation
2.02h, (smTVS)1/2
N for the length of observation 2.8h. The ﬁlter width S is 0.1 ˚A. The horizontal line corresponds to the signiﬁcance
level 0.001. The vertical dashed lines show ±V sin i.

N for the length of observation 1.01h, (smTVS)1/2

Zhuravskii A.M., 1941, Handbook of elliptic functions.

Academy of Science USSR, Moscow-Leningrad

