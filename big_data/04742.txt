Noname manuscript No.
(will be inserted by the editor)

Recent developments in helioseismic analysis methods and
solar data assimilation

A. Schad · L. Jouve · T. L. Duvall Jr. · M.
Roth · S. Vorontsov

Received: date / Accepted: date

Abstract We review recent advances and results in enhancing and developing he-
lioseismic analysis methods and in solar data assimilation. In the ﬁrst part of this
paper we will focus on selected developments in time-distance and global helioseis-
mology. In the second part, we review the application of data assimilation methods
on solar data. Relating solar surface observations as well as helioseismic proxies
with solar dynamo models by means of the techniques from data assimilation is a
promising new approach to explore and to predict the magnetic activity cycle of
the Sun.

Keywords Sun · helioseismology · data analysis

1 Introduction

Helioseismic inferences are subject to statistical and systematic errors of diﬀerent
origin. Part of the errors may be reduced by analyzing longer observations or aver-
aging over observations. But especially systematic errors often result from the ne-
glect of inevitable instrumental eﬀects on the observations or from model misspeci-
ﬁcations in the data analysis and cannot be diminished for example by longer obser-
vations. Consequently, more accurate models and a better account of instrumental
eﬀects are essential for the enhancement of local and global helioseismic analysis

T. L. Duvall, Jr.
Max-Planck-Institut f¨ur Sonnensystemforschung, Justus-von-Liebig-Weg 3, 37077 G¨ottingen,
Germany

L. Jouve
Universit´e de Toulouse, UPS-OMP, Institut de Recherche en Astrophysique et Plan´etologie,
31028 Toulouse Cedex 4, France

M. Roth · A. Schad
Kiepenheuer-Institut f¨ur Sonnenphysik, Sch¨oneckstr. 6, 79104 Freiburg, Germany

S. V. Vorontsov
Astronomy Unit, School of Physics and Astronomy, Queen Mary University of London, Mile
End Road, London E1 4NS, UK; and Institute of Physics of the Earth, B. Gruzinskaya 10,
Moscow 123810, Russia

6
1
0
2

 
r
a

 

M
5
1

 
 
]

.

R
S
h
p
-
o
r
t
s
a
[
 
 

1
v
2
4
7
4
0

.

3
0
6
1
:
v
i
X
r
a

2

A. Schad et al.

methods. This will improve the accuracy and reliability of estimates of helioseismic
parameters like mode frequencies and wave travel times. Just recently, for example,
progress was made in measuring the meridional ﬂow in the deep layers with the
time-distance technique not only by the availability of high-resolution data from
the HMI instrument but also after becoming aware and removal of a systematic
center-to-limb eﬀect in the travel–time estimates (Zhao et al. 2012, 2013). In order
to detect weak processes like the meridional ﬂow in the deeper interior or highly
dynamic processes like supergranular convective motions with the time-distance
technique, travel–time measurements of high signal-to-noise ratio are needed. The
development of spatial averaging strategies and optimized ﬁlters can help here. Re-
garding global helioseismic investigations, diﬀerent models and estimation schemes
are used to extract the mode parameters of modes of medium and large harmonic
degree from the data of GONG, MDI or HMI (e.g., Anderson et al. 1990; Schou
1992, 1998; Hill et al. 1996; Korzennik 2005; Reiter et al. 2015). Recent advances
are made on identiﬁcation and eradication of systematic inﬂuences of diﬀerent ori-
gin on the mode parameter estimates (Larson & Schou 2008; Rabello-Soares et al.
2008; Vorontsov et al. 2009; Korzennik et al. 2013). Further advances in global he-
lioseismology are made by the development of analysis methods that exploit the
perturbation of mode eigenfunctions due to the advection of the acoustic waves
by ﬂows. This kind of perturbation is also described as mode coupling. It mani-
fests in correlations that can be investigated by cross-spectral analysis of spher-
ical harmonic decomposed global oscillation data (Woodard 2000; Schad et al.
2013). Such an approach is promising for inferences on the meridional ﬂow inside
the Sun since its inﬂuence on mode frequencies is only of second order and very
small (Roth & Stix 2008; Gough & Hindmann 2010; Schad et al. 2011; Vorontsov
2011).

One essential purpose of helioseismic investigations of dynamic processes within
the solar interior is to explore and better understand the solar dynamo and the
related activity cycle. In particular, some dynamo models predict a strong link
between the meridional ﬂow speed and the magnetic cycle period. Enabling ob-
servations as well as helioseismic constraints and models to work hand in hand
could deﬁnitely help to progress on our understanding of the solar cycle and pos-
sibly produce reliable forecasts of solar phenomena and activity. The concepts of
data assimilation are promising for solving these issues. Data assimilation has been
extensively used for decades to predict the weather on Earth. Moreover, by com-
bining physically-based models and well-chosen observables, it allows to constrain
processes unaccessible to any measurement through their indirect impact on ob-
servations. With the increasing collection of solar data, this technique has become
more and more attractive in solar physics and starts to be adapted to this ﬁeld.

In the following we review some of the limitations related with the estima-
tion of the helioseismic quantities in time-distance and global helioseismology and
ideas and current attempts to accomplish them. For the time-distance analysis
two recent advances, ensemble averaging and optimal ﬁltering, will be discussed
in detail. The inclusion of enhanced models of the solar oscillation spectrum to
improve global helioseismic parameter estimates is addressed by the ”Global He-
lioseismic Metrology” project. As another advancement in global helioseismology
we review the mode eigenfunction perturbation analyses that uses cross-spectra of
solar oscillations. In the second part of this paper we overview the latest develop-

Recent developments in helioseismic analysis methods and solar data assimilation

3

ments and results from application of data assimilation methods in solar physics
with regard to activity cycle predictions.

2 Developments in local helioseismology

One recent challenge in local helioseismology is to obtain precise three-dimensional
maps of the temporal evolution of the solar sub-surface layers. Here we focus on the
time-distance method which is one tool to obtain such measurements and promises
for example the detection of the emergence of magnetic ﬂux or the analysis of
convective motions like supergranulation.

2.0.1 Large and small separations

In time-distance helioseismology, travel times are measured between pairs of sur-
face locations with angular heliocentric separation ∆. A problem in the analy-
sis of travel times is that information from larger depths is only obtained from
signals measured at locations with larger separations ∆ and these are adversely
aﬀected by larger noise levels due to the geometrical spreading of the wave-
fronts (Gizon & Birch 2004, eq. (31)). In recent years much of time-distance helio-
seismology has been carried out using what we will call small separations, like ∆ <
2.4◦(29.2 Mm) (Jackiewicz, Gizon & Birch 2008) and ∆ < 5◦(61 Mm) (Zhao & Kosovichev
2003). In particular for the analysis time periods appropriate for studying near-
surface features, say 8 hours, and to get suﬃcient signal-to-noise ratio to easily
see perturbation signals, analyses have been restricted to relatively small sepa-
rations ∆. One of the diﬃculties with the restriction to small separations ∆ is
the inability to separate horizontal and vertical ﬂow signals near the surface. The
travel–time signal from a ﬂow is measured from the time diﬀerence between coun-
terpropagating waves traveling between two points. The ray theory predicts that
the time diﬀerence δτ is given by the integral of the ﬂow along the ray path Γ ,

δτ = −2RΓ v · ds/c2, where v is the ﬂow velocity, ds is the element of length along

the ray path, and c is the sound speed. When studying near-surface phenomena,
like supergranulation or sunspots, the restriction to short distances means that
horizontal and vertical ﬂows are not cleanly separated (Zhao & Kosovichev 2003).
However, for large distances, the separation is much cleaner. To illustrate this
point, Fig. 1b shows the travel–time contributions of the vertical and horizontal
ﬂow components as well as the sum for the shallow supergranular ﬂow model shown
in Fig. 1a. For such a shallow ﬂow model, the horizontal component contributes
almost nothing for ∆ > 6 deg. But the vertical contribution of ≈ 5[s] at large ∆
can be used to deﬁne a constant of the model, namely an integral over depth of

the vertical ﬂow at cell center, δτ z = −2R vzdz/c2.

To make full use of large travel distances, the signal-to-noise ratio in the
travel–time maps needs to be increased. This requires several steps: optimal choice
of phase-speed ﬁlters and spatial averaging schemes. For example, Ilonidis et al.
(2013) used a broad phase speed ﬁlter with a non-Guassian shape and particular
averaging schemes with multiple arc conﬁgurations to obtain their results on the
detection of emerging magnetic ﬂux (Ilonidis et al. 2011). However, the reliability
of their ﬁndings still needs to be validated (Braun 2012).

4

A. Schad et al.

a)

]

m
M

[
 
z

−2

−4

−6
−15

b)

]
s
[
 

i
o

t
 
δ

6

4

2

0

−2
 
0

−10

−5

0

x [Mm]

5

10

15

 

vertical
horizontal
sum

5

10

15

∆ [deg]

20

25

Fig. 1 a) Flow vectors of a shallow supergranular model (Duvall & Hanasoge 2013), and b)
Vertical ﬂow and horizontal ﬂow contributions to the center-annulus travel–time diﬀerence
δtoi[s] and their sum.

2.0.2 Averaging over features

Diﬀerent averaging schemes are applied in time-distance helioseismology to get
a signiﬁcant signature of a particular feature in the wave travel times. As an
example Birch et al. (2010) employed numerical models to estimate that a rising
ﬂux tube causes travel–time shifts in the order of 1 s. A signal which could be
certainly detected only by averaging over 150 of such events.

A powerful method to increase the signal-to-noise ratio and to obtain average
properties directly is to average either cross correlations or travel times about the
locations of features detected near the surface. The basic assumptions of this fea-
ture averaging are that there is an underlying linear process that can be averaged
and that the systematic errors are suﬃciently understood. This averaging tech-
nique has been used with small magnetic features (Duvall, Birch and Gizon (2006)
and Felipe et al. (2012)) and to supergranulation (Birch et al. (2006), Hirzberger et al.
(2008), Duvall & Birch (2010), Duvall & Hanasoge (2013)), and ˇSvanda (2012)).
An example of features corresponding to the supergranulation cell centers is shown
in Fig. 2 from Duvall & Birch (2010). To derive these feature locations, a map of
the center-annulus travel–time diﬀerences of f-mode waves is used to approximate
the horizontal divergence of the ﬂow. Local maxima of a smoothed version of this
map are located and only features farther apart than 22 Mm are accepted. The
smaller (in terms of travel–time diﬀerence) of a pair closer than 22 Mm is rejected.
This results in a useful choice of supergranules, although it is likely biased towards
larger than average cells (ˇSvanda (2012)).

Recent developments in helioseismic analysis methods and solar data assimilation

5

200

150

100

50

0

−50

−100

−150

]

m
M

[
 

y

−200

 
−200

−100

0

x [Mm]

100

200

 

30

20

10

0

−10

−20

−30

]
s
[
 
e
m

i
t

Fig. 2 Feature locations (red) determined by the local peaks in the horizontal divergence
signal (gray scale) derived as the annulus minus center travel–time diﬀerence for the f mode
(Figure adapted from Duvall & Birch 2010).

From the feature analysis of Duvall & Birch (2010), only a single parameter
is derived from each cell, namely the strength of the f-mode divergence signal.
Travel times could be binned based on the value of this parameter, enabling some
discrimination of diﬀerent strength or size cells. No one has published such results
yet, but it is an obvious extension of the present work. However, it is likely that an
additional parameter (at least one) would be required to describe supergranular
cells. Cell size comes to mind as a candidate. However, it is very likely that the
peak f-mode divergence signal will be highly correlated with the size. If the cells
were to be described by two parameters, it would be useful to have parameters
that are orthogonal. A way to analyze the horizontal divergence map to derive
additional cell information is the Fourier segmentation procedure developed by
Hirzberger et al. (2008).

2.0.3 Optimized ﬁlters

An essential element of time-distance helioseismic methods is the construction and
usage of optimized ﬁlters. They have been used in time-distance helioseismology
since its inception (Duvall et al. (1993)), where it was shown that ﬁltering the data
in horizontal phase speed ω/k (ω circular frequency of a wave and k its horizontal
wavenumber) leads to isolated features in a time-distance correlation function.
This is important because waves with the same horizontal phase speed travel to
the same depth in the Sun (Duvall (1982)). In the early work, it was considered
that by measuring travel–time diﬀerences between surface points that the eﬀect
of perturbations along the ray path could be measured just by considering waves
with the particular phase speed corresponding to that depth. However, it was
shown by Woodard (1998) that perturbations, such as supergranulation, spread

6

A. Schad et al.

]
s
[
 

i
o

t
 
δ

(a)

6

4

2

0
0

200

400
Γ
l

600

(b)

e
s
i
o
n

/
l
a
n
g
i
s

10

8

6

4

2

0
0

200

400
Γ
l

600

Fig. 3 (a) Travel–time diﬀerence [δtoi] versus ﬁlter FWHM [Γℓ]. The unﬁltered case has
5.3 ± 1.2 seconds. (b) The travel–time diﬀerence from (a) divided by the size of the error
bar from (a) versus the ﬁlter FWHM Γℓ. The value for the unﬁltered case is 4.6. Figure
from Duvall & Hanasoge (2013).

power in the k − ω power spectrum by an amount corresponding to their inverse
size. Supergranulation, with a spectrum peaking at spherical harmonic degree
ℓ = kR = 120, spreads signal considerably in the power spectrum.

To study features such as supergranulation, it is useful to have a ﬁlter broad
enough to admit most or all of the signal. This issue has been examined by
Duvall & Hanasoge (2013). They have constructed ﬁlters with a central phase
speed but a full width at half maximum (FWHM) Γℓ that is independent of ω.
For a range of large separations of ∆ = 19 − 22 deg, they have measured the
center-annulus travel–time diﬀerence [δtoi] for the average supergranules versus
ﬁlter width (Fig. 3a). At small widths, the signal strength is approximately linear
with ﬁlter width until most of the supergranular signal is captured for Γℓ > 240.
Another important parameter of the ﬁlter is the subsequent signal to noise ratio.
This ratio is shown in Fig. 3b. It is found that narrow ﬁlters, in addition to not
capturing most of the signal, do not yield the best signal to noise ratio. From
Fig. 3b a ﬁlter width of Γℓ = 400 was chosen for further study.

2.1 Discussion

In this section we have touched on two relatively new advances in time-distance he-
lioseismology: ensemble or feature averaging and optimal ﬁltering. Both strategies
improve the signal-to-noise ratio of travel–time measurements that is necessary to
measure the solar subsurface velocities. Of course other methods such as the ring-
diagram analysis (Hill 1988), helioseismic holography (Lindsey & Braun 1990),
and Fourier-Hankel analysis (Braun et al. 1987) can provide independent views
on the processes insides the Sun. However, all local helioseismic techniques require
a certain strategy of averaging or ﬁltering to increase the signal-to-noise ratio. An-
other issue of time-distance analysis concerns its reliability and ability to retrieve
subsurface structures, especially in the presence of magnetic ﬁelds (Gizon et al.
2009; Moradi et al. 2010), but also of subsurface supergranular-like ﬂows as shown
by DeGrave et al. (2014). The authors of that simulation study showed that cur-
rent time-distance techniques were not able to adequately retrieve the supergranu-

Recent developments in helioseismic analysis methods and solar data assimilation

7

lar ﬂow pattern and suggested that averaging schemes, as proposed by Duvall & Birch
(2010) and ˇSvanda et al. (2011), might help to obtain reliable results in this case.

3 Developments in global helioseismology

Global helioseismic analyses of mode frequencies were very fruitful in the past for
our current picture of the Sun’s internal structure and dynamics. The ﬁdelity and
resolution of these ﬁndings is restricted by the quality of the observations but also
by systematic errors entering the analysis methods used to determine the mode
parameters from the data. Especially the systematic errors are crucial for global
helioseismic inferences and cannot be overcome by improving the quality or length
of observations. In the following we focus on some of the diﬃculties in estimating
global mode parameters and the eﬀorts on identifying and eradicating associated
systematic errors by means of the “Global Helioseismic Metrology” project.

3.1 Measurement of solar oscillation frequencies: Uncertainties and limitations

A signiﬁcant part of the uncertainty in global helioseismic measurements has been
identiﬁed as systematic in nature. The evidence for these errors comes both from
the direct comparison of the results provided by diﬀerent data-analysis techniques
applied to the same data (Larson & Schou (2008); Vorontsov et al. (2009)), and
from the helioseismic inversions, where they are revealed as an internal inconsis-
tency in the input data set. Fig. 4 illustrates systematic errors in published SOHO
MDI rotational splitting coeﬃcients, revealed by the inversion in an attempt to im-
plement the splitting measurements, accumulated over ﬁve years of observations
and corrected for temporal variations in the solar internal rotation (“torsional
oscillations”), to improve the measurement of the time-independent component
of the rotation (Vorontsov et al. 2002a). The prominent horn-like structures in
the mismatch between the data and the inverted model do not allow the mea-
surement to beneﬁt from the prolonged observation. Fig. 5 illustrates a simpler
example with centroid (m-averaged) frequencies. Here, the centroid frequencies
tabulated over the entire span of MDI observations were averaged without any
corrections for variations with solar activity, for addressing the equation of state
of solar plasma (Vorontsov et al. 2013a). The diﬀerence between the averaged fre-
quencies and those measured in the ﬁrst year of SOHO mission (low solar activity)
demonstrates a well-known frequency dependence, but only on average: the obvi-
ous outliers are the higher-degree modes, the most precious part of data for this
particular measurement (modes with turning points in the vicinity of HeII ioniza-
tion region). Again, attempting to implement a prolonged observation brings no
beneﬁt, but only makes systematic errors more evident.

The challenges to the accurate measurement of the solar oscillation frequen-
cies are illustrated by two examples of Doppler-velocity power spectra shown in
Fig. 6. The diﬃculties originate largely from the spatial leaks coming from modes
of neighboring values of degree l (Fig. 6a) and azimuthal order m (Fig. 6b). The
accurate modeling of the spatial leaks, which may blend into the target peak,
puts very tough requirements on the accuracy of the leakage matrix. Further,
the asymmetry of the line proﬁles (Fig. 6a) needs to be properly accounted for.

8

nHz

448

446
 
444
 
442
 
440
 
438
 
436
 
434
 
432
 
430

428
0

0    0.3 0.5   0.7   0.9          0.99 1

r
/R
1

a1

p
5

p
2
p
1
f

0.4

0.2
0.8
/T
Acoustic radius t
1

0.6

1

r
/R
1

f
p
1p
2p
5

0    0.3 0.5   0.7   0.9          0.99 1
 
22
 
20
 
18
 
16
 
14
 
12
 
10
 
8
 
6
 
4
 
0

a3

0.4

0.2
0.8
/T
Acoustic radius t
1

0.6

1

A. Schad et al.

0    0.3 0.5   0.7   0.9          0.99 1

r
/R
1

8

6
 
4
 
2
 
0
 
−2
 
−4

−6

−8
 
 
0

a5

p
5

p
2

p
1
f

0.4

0.2
0.8
/T
Acoustic radius t
1

0.6

1

Fig. 4 First three rotational splitting coeﬃcients a1, a3, a5 of solar p- and f modes, plotted
versus the position of their inner turning points. Blue crosses: average of splitting coeﬃcients
measured from 27 consecutive 72d slots of SOHO MDI observations and corrected for the tem-
poral variation of the solar rotation. Green circles: the same splitting coeﬃcients but calculated
from the inverted rotating model.

✷✢✢

☎♥✦✧✦★

✶✥✢

✦✩✝✁✪ ✫✧✦✝✁✪ 

✶✷✢

✣✢

✤✢

✢

✲✤✢

✲✣✢

✲✶✷✢

✶

✶✛✜

♣

✬

✷

♣

✮

♣

✭

✷✛✜

✸

✸✛✜

❋ ✁✂✄✁☎✆✝ ✞✟✠✡☛

Fig. 5 Diﬀerence between centroid frequencies averaged over 15 years of SOHO MDI obser-
vations and frequencies of the 1-yr measurement at solar activity minimum (Vorontsov et al.
2013a). The error bars are 1-σ errors of the 1-yr data set.

Finally, deviations from the spherical symmetry of the equilibrium solar conﬁgu-
ration lead, in general, to mode coupling—instead of individual modes described
by a particular pair of (l, m) values, we have the coherent composite states. The
biggest eﬀect comes from the mode coupling by diﬀerential rotation; an exam-
ple of how the mode coupling aﬀects the power spectra is the asymmetry of the
amplitudes of m − 2 and m + 2 leaks, clearly seen in Fig. 6b. The biggest chal-
lenge is data analysis at high degree l, where modes of individual degree can no
longer be identiﬁed and the modal analysis has to be replaced by “ridge-ﬁtting”
techniques (Rabello-Soares et al. 2008; Korzennik et al. 2013; Reiter et al. 2015).
Better spectral modeling in the intermediate-degree range, where systematic er-
rors of frequency measurements are clearly seen and their origin can be identiﬁed,
will also bring better conﬁdence to the analysis of lower-degree (Korzennik 2005)

☞
✌
✍
✎
✏
✍
✑
✒
✓
✔
✕
✖
✖
✍
✌
✍
✑
✒
✍
✗
✑
✘
✙
✚
Recent developments in helioseismic analysis methods and solar data assimilation

9

t✔✕✖✗t ✘✙✚✛✛ ✜
✢

✻

✒✹✒

✒

✓✹✒

✓

✭✣✤

t✘✙✚✛t ✜✢✣✤✤ ✥ ✦✧★✛

✦✩✢✦

✭✬✮

✸✗✕

✸✗✓

✸✗✏

✸✗✑

✦✩✢✦✪✣

✦✩✢✦✫✣

✷✏✑✑

✷✏✒✑

✷✓✑✑
✷✓✒✑
❋ ✁✂✄✁☎✆✝ ✞♠❍✟✠

✷✒✑✑

✷✒✒✑

✸
✶✏✑✏

✶✏✑✒

✶✏✑✓
✶✏✑✔
❋ ✁✂✄✁☎✆✝ ✞♠❍✟✠

✶✏✑✕

✶✏✑✖

Fig. 6 1-year SOHO MDI power spectra (red) and their models (blue) for p4 mode of degree
l = 100 (a) and f mode of l = 200 (b).

and higher-frequency (Rhodes et al. 2011) domains of the solar-oscillation power
spectra.

3.2 Global Helioseismic Metrology

Signiﬁcant eﬀorts are now invested in enhancing the data analysis in global so-
lar seismology. The standard SOHO MDI data analysis pipeline is largely rede-
veloped, from better accounting for instrumental eﬀects when mapping Dopp-
lergrams to spherical harmonics to more elaborated techniques of frequency ﬁt-
ting (Larson & Schou 2008), and extended for implementation to SDO HMI data
(Larson & Schou 2011). Below, we address in more detail the prospects of the
“Global Helioseismic Metrology” project, based on modeling the solar acoustic
oscillation in the continuous spectrum.

For each pair of target degree l and azimuthal order m, the observed power
spectrum is approximated by the spectral model deﬁned as (Jeﬀeries et al. 2006;
Vorontsov & Jeﬀeries 2013b)

Pobs =(cid:12)(cid:12)LU + hLV(cid:12)(cid:12)

2((cid:20) A cos(ϕ − S)

1 − R2

(cid:21)2

+ B2) ,

tan ϕ =

1 + R
1 − R

tan θ.

(1)

In this model, θ is the phase integral of the trapped acoustic wave – a continuous
function of frequency ω with θ(ω) = πn at frequencies of acoustic resonances. The
energy losses are assumed to be localized in the near-surface layers and described
by the surface acoustic reﬂectivity R. The average strength of the stochastic ex-
citation is described by the excitation amplitude A. The composite background
B is contributed by both the coherent and incoherent components of the solar
noise. Parameter S describes line asymmetry, which is governed by the depth and
parity of the excitation source and by the coherent component of the solar noise.
LU and LV are two components of the leakage matrix, which account for vertical
and horizontal velocities on the solar surface, h is the ratio of the magnitudes of
the two velocity components. The leakage matrix is calculated using a computa-
tionally eﬃcient semi-analytic approach described in (Vorontsov & Jeﬀeries 2005)
and extended later to account for non-zero B-angle and for the discrete bin sam-
pling implemented in the SOHO MDI “medium-l” program. Mode coupling by
diﬀerential rotation is treated as suggested in (Vorontsov 2007).

▲
✡
☛
☞
✡
✌
✍
✎
▲
✡
☛
☞
✡
✌
✍
✎
10

✸

✷✎✍

✷

✶✎✍

✶

✌✎✍

✌

♣

✏

❢

♣

✑

♣

✒

♣

✹

♣

✺

✭✓✔

✲✶

✲✶✓✒

✲✷

✲✷✓✒

✲✸

✲✸✓✒

❢

A. Schad et al.

♣

✕

♣

✖

♣

✹

♣

✔

✭✗✘

✲✌✎✍

✶✌✌✌

✶✍✌✌

✷✌✌✌

✷✍✌✌

❋ ✁✂✄✁☎✆✝ ✞♠❍✟✠

✸✌✌✌

✸✍✌✌

✶✑✑✑

✶✒✑✑

✷✑✑✑

✷✒✑✑

✸✑✑✑

✸✒✑✑

❋ ✁✂✄✁☎✆✝ ✞♠❍✟✠

✡

✲✡☞✡✶

✲✡☞✡✷

❙

✲✡☞✡✸

✲✡☞✡✌

✲✡☞✡☛

❢

✶✡✡✡

✶☛✡✡

✭✑✒

♣

✹

✶✹✡✡✡✡

✶☞✡✡✡✡

✶✡✡✡✡✡

♣

✌✍

✥✎✏✑✒

✭✖✗

✷

❇

✽✡✡✡✡

❢

♣

✌

✻✡✡✡✡

✹✡✡✡✡

♣

✓

♣

✔

♣

✕

♣

✺

✸✡✡✡

✸☛✡✡

☞✡✡✡✡

✶✡✡✡

✶☛✡✡

☞✡✡✡

☞☛✡✡

✸✡✡✡

✸☛✡✡

❋ ✁✂✄✁☎✆✝ ✞♠❍✟✠

♣

✏

♣

✎

♣

✍
✷✡✡✡

❋ ✁✂✄✁☎✆✝ ✞♠❍✟✠

✷☛✡✡

Fig. 7 Excitation amplitude (a), acoustic reﬂectivity (b), asymmetry parameter (c), and com-
posite background (d) obtained from a 1-year SOHO MDI Doppler-velocity power spectra
(adapted from Vorontsov & Jeﬀeries 2013b). Solid lines show approximations by slowly-varying
functions of frequency for lower-degree modes. The results obtained for f modes are shown in
red. The asymmetry parameter S is extrapolated by a straight line at frequencies below 1500
µHz, where its measurement suﬀers from uncertainties coming from smaller signal-to-noise
ratio and narrow line proﬁles.

The parameters of the spectral model, resulted from ﬁtting SOHO MDI power
spectra obtained from the ﬁrst year of observations (at low solar activity) are il-
lustrated by Fig. 7. The results are shown for p modes of radial order n from 1
to 10 and for f modes, in the degree range limited by l = 200. The maximum-
likelihood solution was obtained by an iterative improvement of the spectral pa-
rameters (A, R, S, B) and of the resonant frequencies and frequency splittings. The
resulted agreement between the model and the data is almost adequate, as can be
judged by comparing the m-averaged power spectra (Fig. 6). A small systematic
inaccuracy in the predicted amplitudes of spatial leaks remains, however. The ori-
gin of this mismatch is not yet properly understood; it may be related, in part,
with asymmetric distortion of the point-spread function of the MDI instrument
(Rabello-Soares et al. 2008).

An important property of this model, which is behind its diagnostic potential, is
that the spectral parameters of individual modes do not depend on the degree and
collapse to slowly-varying functions of frequency only when the degree l is not too
high (less than about 100). The composite background B2 (Fig. 7d) may look as
an exception. However, an accurate measurement of the background at frequencies
higher than about 2 mHz is a diﬃcult task, because the background level appears
to be signiﬁcantly smaller than the resonant signals coming from the spatial leaks.
As a result, the measurement of B2 can be distorted by small inaccuracies in
the leakage matrix. The ﬁtted background is also signiﬁcantly higher than the

❧
✡
☛
☞
❧
✡
☛
☞
✌
✍
✎
✏
Recent developments in helioseismic analysis methods and solar data assimilation

11

average at lowest values of target degree l (p10 mode of l = 2 in Fig. 7d). A
possible explanation of this excess is the contribution of the instrumental noise,
which can probably be modeled by adding an l = 0 component to the (otherwise
degree-independent) solar B2(ω).

Interestingly, the analysis of solar f modes reveal the same values of the ex-
citation amplitude A and “acoustic reﬂectivity” R as solar p modes of similar
frequencies (Fig. 7a,b). It indicates that excitation and damping mechanisms do
not distinguish between p- and f modes, despite the diﬀerence in their physical
nature (the f modes are incompressible waves). The composite background of f
modes appears to be smaller than that of p modes (Fig. 7d). Since at low frequen-
cies the ﬁtted background B2 is dominated by the granulation noise, one possible
explanation is that its contribution to the observational power shall be modeled
with a smaller (or zero) value of h, the ratio of horizontal and vertical velocities.
In data processing, a simple theoretical value h = GM⊙/(R3
⊙ω2) has been used,
which corresponds to incompressible motion: this approximation is hardly relevant
to the granulation noise.

The major beneﬁt to the p-mode data analysis, expected from the global de-
scription of spectral parameters, is that the global spectral variables (A, R, S, B as
functions of frequency), inferred from the large volume of high-quality intermediate-
degree data, can be used in measurements at lower degree l. Reducing the number
of free parameters in low-degree measurements will bring signiﬁcant improvement
to the accuracy and precision of frequencies (and frequency splittings) of the p
modes which penetrate into the deepest solar interior.

Fig. 8 shows the rotational splitting coeﬃcients resulting from the measurement
which is described above, in comparison with published splitting coeﬃcients. The
horn-like structures, which signify systematic errors (cf Fig. 4) are now eliminated.
As indicated by a detailed analysis (Vorontsov et al. 2009), the dominant part
of the systematic errors came from discarding the eﬀects of mode coupling by
diﬀerential rotation in the original version of the SOHO MDI data analysis pipeline
(which was later improved to include these eﬀects, among others. Systematic errors
in centroid frequencies, illustrated by Fig. 5, are due apparently to the temporal
variation of the plate-scale error).

The diﬀerences between the centroid frequencies and their published values are
shown in Fig. 9. The major part of the discrepancies is due to the line asymmetries,
discarded in the original version of the MDI data analysis pipeline (cf Fig. 7c).
Smaller-scale features are due apparently to the combination of the mode-coupling
eﬀects with the plate-scale error. The centroid frequencies measured in the “Global
Helioseismic Metrology” project have been used in a recent study targeted at the
seismic diagnostics of the equation of state (Vorontsov et al. 2013a). Interestingly,
it was found that these frequencies allow the achievement of a signiﬁcantly better
agreement with solar models. This is quite an unusual ﬁnding: better accuracy of
observational data brings better agreement with theoretical models.

The ﬁnal goal of the project is a new approach to helioseismic inversion, where
frequency measurements will be eliminated from the analysis, and the parameters
of the rotating solar model will be matched directly with p-mode power spectra.
This approach will bring beneﬁts of streamlined regularization, ﬁrst of all – by
eliminating problems with error correlation and possible mode misidentiﬁcation in
frequency measurements.

12

A. Schad et al.

r
/R
1
0.6 0.7 0.8
p
10

445

444

nHz

443

442

441

440

439

438

437

436

435

  0.99

a5

0.9       0.95   

  0.99

r
/R
1
0.6 0.7 0.8

23

0.9       0.95   

  0.99

r
/R
1
0.6 0.7 0.8
2

0.9       0.95   

p
10

p
6

a1

p
6

22

21

20

19

18

17

16

15

14

p
6

a3

p
10

1

0

−1

−2

−3

−4

−5

−6

−7

0.3 0.4 0.5 0.6 0.7 0.8 0.9

0.3 0.4 0.5 0.6 0.7 0.8 0.9

0.3 0.4 0.5 0.6 0.7 0.8 0.9

13

−8

Acoustic radius t
/T
1

Acoustic radius t
/T
1

Acoustic radius t
/T
1

Fig. 8 First rotational splitting coeﬃcients a1, a3, a5, inferred from the ﬁrst year of SOHO
MDI measurements. Blue crosses: published coeﬃcients. Red circles: the result obtained in the
“Global Helioseismic Metrology” project (Vorontsov & Jeﬀeries 2013b).

✶✹✵

✶✷✵

✶✵✵

✽✵

✻✵

✹✵

✷✵

✵

✶

♣

✢

❢
✶✛✜

♣

✣

♣

✤

✷

✷✛✜

✸

✸✛✜

❋ ✁✂✄✁☎✆✝ ✞✟✠✡☛

Fig. 9 Diﬀerence between the centroid frequencies measured in the “Global Helioseismic
Metrology” project from the 1-year SOHO MDI power spectra and their published val-
ues (Vorontsov & Jeﬀeries 2013b).

3.3 Global helioseismology from cross-spectral analysis

In the past, global helioseismology was very successful in measuring the diﬀerential
rotation inside the Sun from the splitting of the p-mode frequencies. But the
meridional ﬂow in the deeper interior is hardly accessible from mode frequencies
since the ﬂow is small in amplitude and its inﬂuence on the frequencies is only
of second order in the ﬂow. Numerical simulations suggest frequency shifts of the
order of a few nHz due to the ﬂow (Roth & Stix 2008; Chatterjee & Antia 2009;
Schad et al. 2011; Vorontsov 2011). The perturbation of another characteristic of
resonant waves by the meridional ﬂow, the mode eigenfunction, and its potential
for helioseismic analyses was early recognized, but largely neglected, likely due
the diﬃculty to measure this kind of perturbation and to discriminate it from
systematic instrumental eﬀects in the observations. Below we address the recent
advances in using cross-spectral analysis for a global helioseismic measurement of
the meridional ﬂow from the perturbation of mode eigenfunctions.

☞
✌
✍
✎
✏
✍
✑
✒
✓
✔
✕
✖
✖
✍
✌
✍
✑
✒
✍
✗
✑
✘
✙
✚
Recent developments in helioseismic analysis methods and solar data assimilation

13

3.3.1 Perturbation of mode eigenfunctions by advective mode coupling

Expressions for the eigenfunctions perturbed by the meridional ﬂow were derived
by several authors (Woodard 2000; Schad et al. 2011; Vorontsov 2011), who used
however partly diﬀerent assumptions and approximations. The perturbations are
considered with respect to a ﬂow-free, purely hydrodynamic reference model of
the Sun from which the frequencies and eigenfunctions, (ωnlm, ξ0
nlm), of the un-
perturbed p-modes are obtained. A ﬂow u leads to an advection of the acoustic
waves, which causes a perturbation of eigenfunctions and eigenfrequencies of the p-
modes with respect to the reference model. If the ﬂow amplitude is small compared
to the speed of sound, the perturbed eigenfunctions can be expanded linearly in
k′ , where k substitutes
the triplet (n, l, m) of the wave numbers of a mode. The perturbations are often
considered as a kind of mode coupling and the expansion coeﬃcients {ckk′ } specify
the coupling coeﬃcients which determine the strength of the coupling.

terms of the unperturbed eigenfunctions: ξk = Pk′ ckk′ ξ0

Following the general mathematical framework for the perturbation of p-modes
from Lavely & Ritzwoller (1992), Schad et al. (2011) have shown that the coupling
coeﬃcients of a mode k due to the meridional ﬂow are approximated in ﬁrst order
by a linear integral equation, whose integrand speciﬁes the advection kernel,

ckk′ ≈ 2 i

ωk

ω2
k − ω2

k′ Z ρ0 ξ0

k′ · (u · ∇ξ0

k) d3r

for k′ 6= k ,

(2)

where ckk = 1. For the meridional ﬂow, the coupling coeﬃcients ckk′ are purely
imaginary. They are expected to be largest for modes of similar frequency and
wave numbers (n, l). The meridional ﬂow does not contribute to a self-coupling
of modes. As a consequence, the shift of the mode frequencies due to the merid-
ional ﬂow is only of second order in u. Assuming azimuthal symmetry for the
meridional ﬂow, coupling is only possible between modes of equal harmonic de-
gree m and the coupling coeﬃcient for ﬁxed pairs of (n, l) and (n′, l′) may be
considered as a function of m: ckk′ = cnl,n′l′ (m). This expression can be expanded
in terms of polynomials in azimuthal order, where the polynomial order is given
by the harmonic degree s of the individual meridional ﬂow components when ex-
panded in spherical harmonics Y 0
s . Diﬀerent polynomial expansions are suggested.
Schad et al. (2011) uses a complete set of orthogonal polynomials {P s
l′,l(m)} that
are based on the Clebsch–Gordan coeﬃcients. In the asymptotic case of high de-
gree l and for coupling modes of equal radial order n′ = n, Vorontsov (2011) uses
associated Legendre functions which are however not perfectly orthogonal on a
discrete grid in m. The expression in Equation (2) deﬁnes a linear inversion prob-
lem. The polynomial expansion allows to simplify the expression of the coupling
coeﬃcients in terms of one dimensional integral equations and to investigate the
harmonic components of the ﬂow separately.

3.3.2 Cross-spectral analysis of solar oscillations

The oscillating amplitude αk(t) of individual global modes of harmonic degree l′
and azimuthal order m′ can be extracted by a spherical harmonic transformation
(SHT) from sequences of Dopplergrams. Each of these spherical harmonic (SH)

14

A. Schad et al.

coeﬃcients is a weighted sum over the amplitudes of several modes: ol′m′ (t) =

Pk αk(t)Pk′′ ckk′′ Ll′m′,k′′ Uk′′ (R). The weighting is given by the coupling coeﬃ-

cients ckk′′ , the amplitude of the radial eigenfunction component Uk′′ (R) of mode
k′′ observed at radius R, where the respective absorption line is formed, and the
leakage matrix elements {Lk′k′′ } of the observing instrument. The leakage origins
from the imperfect orthogonality of the spherical harmonic functions when not in-
tegrated over the complete solar sphere. The leakage matrix elements are further
largely inﬂuenced by the apodization mask and the projection of the solar velocity
ﬁeld onto the line-of-sight axis. As a consequence of leakage and mode coupling,
modes of a speciﬁc target degree l and order m are not perfectly separated from
modes of neighboring degree l′ and order m′ by the SHT. This results in a cross-
talk between the SH coeﬃcients and the power of a mode is spread amongst the
spectra of spherical harmonic coeﬃcients of neighboring (l′, m′), where it shows
up as sidelobes at the respective mode frequency.

Woodard (2000) pointed out the sensitivity of the cross-spectrum of the SH
coeﬃcients to mode coupling. The cross-spectrum of two SH coeﬃcients olm and
ol′m′ is deﬁned by CSlm,l′m′(ω) = h˜o∗
lm(ω)˜ol′m′ (ω)i, where ˜o..(ω) is the Fourier
transform of o..(t) and hXi denotes the statistical expectation value of the random
variable X. It is related to the coupling coeﬃcients by

CSlm,l′m(ω) =Xk

Sα,k(ω) Xk′,k′′

kk′ ckk′′ L∗
c∗

lm,k′ Ll′m,k′′ Uk′ (R)Uk′′ (R) ,

(3)

where it is assumed that the solar modes are excited independently and Sα,k =
h|αk(ω)|2i is the auto-spectrum of mode k.

Schad et al. (2011) introduced a slightly diﬀerent quantity to relate the coupling-

coeﬃcients with observations: the amplitude ratio ylm,l′m(ωnlm) := ˜ol′m(ωnlm)/˜olm(ωnlm).
It measures the relative cross-talk of power of a reference mode with frequency
ωnlm between the SH coeﬃcients due to mode coupling and leakage. Given certain
assumptions on the separability of the mode frequencies in the solar oscillation
spectrum, which are met only by modes of low and medium harmonic degree l,
the amplitude ratio is independent of the amplitude αk and can be approximated
in ﬁrst order by (Schad et al. 2011)

ylm,l′m(ωnlm) ≈ Pk′′ ckk′′ Lk′k′′ Uk′′ (R)
Pk′′ ckk′′ Lkk′′ Uk′′ (R)

∈ C .

(4)

Its expectation value is in leading order determined by the cross-spectrum, since
hylm,l′m(ωnlm)i ∼ CSlm,l′m(ωnlm)/Snlm(ωnlm). This quantity, denoted as the com-
plex gain, is related to the gain in linear ﬁlter theory. The asymptotic statisti-
cal distribution of the estimator of the complex gain can be expressed analyti-
cally (Schad et al. 2013).

3.3.3 Inﬂuence of diﬀerential rotation

The toroidal velocity ﬁeld of diﬀerential rotation also leads to a coupling of modes,
which cannot be neglected in the eigenfunction perturbation analysis. The pertur-
bation of eigenfunctions due to rotation was investigated by Vorontsov (2007, 2011)
for the asymptotic case of large degree l. The case of low and medium degree l

Recent developments in helioseismic analysis methods and solar data assimilation

15

Fig. 10 Real and imaginary part of amplitude ratios for (n = 1, l = 180) and (n′ = 1, l′ = 182)
as a function of azimuthal order m (Schad 2013). The amplitude ratios are estimated from
SH coeﬃcients from MDI data covering 2004–2010. The ratios are compared to theoretical
amplitude ratios computed for simple ﬂow models: Model A) two-cell meridional ﬂow; Model
B) two-cell meridional ﬂow and diﬀerential rotation adapted to observed rotation rates. The
real part essentially exhibits features from leakage and rotation, the latter is responsible for an
antisymmetry in azimuthal order. The imaginary part is inﬂuenced by leakage, rotation, and
meridional ﬂow. Theoretical amplitude ratios for Model B after compensation for rotation by
azimuthal symmetrization are shown by a dashed blue line.

k′k

k′k + c(poloidal)

was investigated by Schad (2013). Formally rotation leads to an additional term
to the coupling coeﬃcient: ck′k = c(rot)
. Again, rotation couples only
modes of similar frequency and of equal azimuthal order and the coupling coeﬃ-
cients can be expanded by polynomials in m which are equal to the ones used for
meridional ﬂow. But in contrast to the coupling coeﬃcients due to the meridional
ﬂow, the rotational coupling coeﬃcients c(rot)
k′k are real valued and anti-symmetric
with respect to the azimuthal order. The diﬀerent symmetry properties can be
exploited to compensate approximately the inﬂuence of rotation on the amplitude
ratios in analyses for the meridional ﬂow. In this case, the amplitude ratios ylm,l′m
are symmetrized with respect to azimuthal order (Schad et al. 2013). Exemplary
amplitude ratios estimated from about 6 years of MDI data for (n = 1, l = 180)
and (n = 1, l = 182), as well as simulated amplitude ratios from numerical forward
computations of simple ﬂow proﬁles, are shown in Fig. 10. The inﬂuence of rota-
tion is clearly visible. Both the real and the imaginary part of the amplitude ratios
deviate signiﬁcantly from azimuthal symmetry if rotation is present. The compen-
sation of the rotational inﬂuences by azimuthal symmetrization is also illustrated
using simulated amplitude ratios. The symmetrized amplitude ratios matches very
well to the amplitude ratios obtained for a velocity ﬁeld without solar rotation.

3.3.4 Application to data: Measurement of the meridional ﬂow

First measurements of the meridional ﬂow from analysis of the perturbation of
p-mode eigenfunctions were given by Schad et al. (2012, 2013); Woodard et al.
(2013).

Woodard et al. (2013) ﬁtted a model to cross-spectra estimated from HMI data
to measure the horizontal component of the meridional ﬂow. The model for the
cross-spectrum incorporates instrumental leakage, diﬀerential rotation, and the
solar background. They analyzed HMI data with a length of 500 days and investi-
gated couplings between modes of the same radial order n for the harmonic degrees
20 ≤ l ≤ 300. Cross-spectra estimated from the HMI data and averaged over az-
imuthal order as well as cross-spectra after ﬁtting diﬀerent cross-spectral models

16

A. Schad et al.

to the data are depicted in Fig. 11. The comparison illustrates the improvement
of the cross-spectral model by inclusion of ﬂow-dependent eigenfunction perturba-
tions (Woodard et al. 2013).

m
u
r
t
c
e
p
s
 
s
s
o
r
c
 
f
o

 
t
r
a
p

 
l
a
e
R

5

0

-5

-10

-15

m
u
r
t
c
e
p
s
 
s
s
o
r
c
 
f
o

 
t
r
a
p

 
.

g
a
m

I

0.5

0.0

-0.5

-1.0

-1.5

-2.0

0

-5
10 15 20
Relative frequency (µHz)

5

0

10 15 20
-5
Relative frequency (µHz)

5

Fig. 11 De-rotated cross-spectra for l = 200 and l′ = 202 averaged over positive order m as
a function of ν relative to the frequency of the f-mode multiplet of degree l (Figures adapted
from Woodard et al. (2013)). Left: Real part. Right: Imaginary part. The black curves depict
the cross-spectrum estimated from 500 days of HMI data. The blue dash-dotted curve is the
ﬁtted cross-spectrum when ignoring the eﬀect of ﬂows on mode eigenfunctions. The red dashed
curves are ﬁtted cross-spectra including the eﬀect of diﬀerential rotation and meridional ﬂow.

The estimated peak velocities of the horizontal ﬂow component with harmonic
degree 2 (V 2) are shown in Fig. 12 as a function of ν/L that is related to the lower
turning point of the acoustic waves (Woodard et al. 2013). Near the surface, the
horizontal peak velocities are of the order of about 20 m/s as expected from local
helioseismic measurements. Toward the interior, the velocities exhibit an unex-
pected large increase and the authors assume that their measurements are likely
aﬀected by a systematic eﬀect (Woodard et al. 2013).

Schad et al. (2012, 2013) set up a global helioseismic estimation scheme for the
meridional ﬂow based on the analysis of amplitude ratios of coupling modes. It
takes into account leakage and the inﬂuence of rotation is compensated by sym-
metrization of amplitude ratios. They applied their method to MDI data covering
2004–2010 for modes with 0 ≤ l ≤ 200 and investigated couplings between modes
of diﬀerent radial order and for ﬂow components of harmonic degree s = 1, . . . , 10.
They found two ﬂow components of harmonic degree s = 2 and s = 8, which
diﬀer signiﬁcantly from zero. Individual components, like the s = 8 ﬂow com-
ponent were measured deep down to 0.5 R. The radial component of the ﬂow
s (θ, φ) is estimated from a composite of the individual ﬂow
s (θ, φ) is re-
constructed from the radial components {us} assuming mass conservation. The
composite of ﬂow components of even degree s = 2, . . . , 8 are depicted in Fig. 13
as a function of radius and latitude. The meridional ﬂow exhibits a multi-cellular

U(r, θ) = Ps us(r)Y 0
components. The horizontal ﬂow component V (r, θ) = Ps vs(r)∂θY 0

Recent developments in helioseismic analysis methods and solar data assimilation

17

Fig. 12 Surface peak velocities for the horizon-
tal ﬂow component V 2 estimated from a cross-
spectral analysis of HMI data as a function of
ν/L as found by Woodard et al. (2013). The
steep increase of the peak velocity with depth
toward speeds > 30 m/s is suspected to be due
to systematic errors (Woodard et al. 2013).

pattern over latitude and depth. Near the solar surface, the horizontal ﬂow is con-
sistent with subsurface ﬂow measurements from ring-diagram analyses indicating
a poleward directed ﬂow on each hemisphere with a small-scale latitudinal mod-
ulation and a speed of about 20 m/s at mid-latitudes. Their ﬁndings substantiate
the assumption that the ﬂow is conﬁned between the tachocline region and the
solar surface.

3.4 Discussion

The systematic features of the estimates of global mode parameters considered in
Sec. 3.1 were found from analyses of medium-l MDI data and can be reduced by the
approach used by the global metrology project. Parameters estimated from data
from the same instrument but of diﬀerent preprocessing or from data from other
instruments, e.g., HMI or GONG, may show other systematic features. But inde-
pendent of the instrument, one cannot avoid for example leakage of mode power
due to the observational restrictions or mode coupling dominated by rotation.

The development of global analysis methods based on mode eigenfunction per-
turbations and the analysis of cross-spectra of spherical harmonic Doppler velocity
coeﬃcients is a promising emerging ﬁeld for inferences on the meridional ﬂow in the
deep solar interior. In this approach, care must be taken of mode eigenfunction per-
turbations from other sources, for example from diﬀerential rotation. Vice versa,
analyses of mode eigenfunction perturbations may also be used to investigate ro-
tation. Next to the solar subsurface, the meridional ﬂow measured by Schad et al.
(2013) seems to be consistent with ﬂow measurements from a ring-diagram anal-
ysis. But, the recent measurement of the meridional ﬂow from a deep focusing
time-distance helioseismic analysis of HMI data by Zhao et al. (2013) seems to
disagree with their ﬁndings. However, the investigated HMI data cover a later ob-
servation time period. Further investigations are necessary to test the reliability
of these results.

The success of each of the global helioseismic methods considered here strongly
depends on the accurate knowledge of the leakage matrix. The inferences from
global helioseismic analyses suﬀer from systematic eﬀects if the leakage matrix is
inaccurate or the models used to estimate the helioseismic parameters from spectra
or cross-spectra are misspeciﬁed. For example, a comparison study of splitting
coeﬃcients and rotation proﬁles obtained from medium-l and full-disk MDI data
indicate that the there used leakage matrix used for the medium-l MDI data

18

A. Schad et al.

R

/
r

R

/
r

1

0.8

0.6

0.4

0.2

0

−0.2

−0.4

−0.6

−0.8

−1

 
0

1

0.8

0.6

0.4

0.2

0

−0.2

−0.4

−0.6

−0.8

−1

 
0

(r,θ)

U

even

 

]
s
/
m

[

R

/
r

20

15

10

5

0

−5

−10

−15

0.5
r/R

1

error U

(r,θ)

even

 

10

]
s
/
m

[

R

/
r

9

8

7

6

5

4

3

2

1

0

0.5
r/R

1

1

0.8

0.6

0.4

0.2

0

−0.2

−0.4

−0.6

−0.8

−1

 
0

1

0.8

0.6

0.4

0.2

0

−0.2

−0.4

−0.6

−0.8

−1

 
0

(r,θ)

V

even

0.5
r/R

error V

(r,θ)

even

 

1

 

0.5
r/R

1

50

40

30

20

10

0

−10

−20

−30

−40

−50

]
s
/
m

[

22

20

18

16

14

12

10

8

6

4

2

0

]
s
/
m

[

Fig. 13 Top row: The meridional ﬂow estimated from MDI data covering 2004–2010 as a
function of radius r/R and latitude (Schad et al. 2013). The proﬁle is obtained from a com-
posite of ﬂow components of the harmonic degrees s = 2, 4, 6, 8. A dashed line indicates the
solar surface. Left: Radial ﬂow component. Positive (negative) values of U refer to an outward
(inward) directed radial ﬂow. Right: Horizontal ﬂow component. Positive (negative) values of
V refer to a northward (southward) directed horizontal ﬂow. Bottom row: 1σ-error on the
respective ﬂow estimates.

probably does not perfectly account for the apodization function and that might be
responsible for a spurious polar jet in the solar rotation proﬁle from the medium-l
MDI data (Larson & Schou 2009).

The results obtained so far clearly illustrate the necessity of putting eﬀorts
into enhancing the models of the solar oscillation spectrum and of improving the
accuracy of the leakage matrix of the respective instruments. A diﬃculty in the
computation of the leakage matrix comes along with taking into account systemat-
ics that change over time, like the B-angle, or from not properly known instrument
characteristics, like the plate-scale error or the point spread function.

Recent developments in helioseismic analysis methods and solar data assimilation

19

4 Data assimilation in solar physics

Understanding and predicting the solar activity cycle poses one of the main prob-
lems in solar physics and comes along with questions about the timing, amplitude,
and shape of the currently evolving and following cycle. Convection, rotation and
the mean meridional ﬂow are thought to be key ingredients that drive the gen-
eration and evolution of the solar magnetic ﬁeld. In the previous sections it was
shown that new helioseismic techniques could provide estimates of some of these
ingredients. We will see in this section how observations and helioseismic measure-
ments could be combined with physical models to improve our knowledge of the
solar activity cycle.

We have entered an era where extremely large amounts of data are avail-
able concerning the Sun, thanks to the high-resolution observations of satellites
like Hinode or more recently SDO. At the same time, considerable progress has
been made on the multi-dimensional numerical simulations of highly non-linear
physical processes interacting in the solar interior and in its atmosphere. Al-
though still far from realistic values of the parameters, several impressive local
and global computations now seem to reach high levels of turbulence and cap-
ture relevant physical processes occurring in our star. Various 3D MHD codes
are used for that purpose, among which the ASH code (e.g. Miesch et al. 2008;
Brun et al. 2011; Nelson et al. 2013; Alvan et al. 2014), the PENCIL code (e.g.
K¨apyl¨a et al. 2012; Warnecke et al. 2014), the MURaM code (e.g. Cheung et al.
2010; Rempel & Cheung 2014) or the STAGGER code (e.g. Stein & Nordlund
2012). This improvement is intimately linked to the recent fast development of
high performance computing, several computers in the world now reaching the
performance of tens of PetaFlops. Finally, we live today in a technological society
in which strong solar ﬂares, CMEs or any violent events linked to solar activity
could cause signiﬁcant damage to satellites, air traﬃc or telecommunication net-
works. That is why a solar cycle panel, whose role is to produce predictions of solar
activity, was created in 1997 and has provided us with estimates of the sunspot
number for Cycle 23 and current Cycle 24.

As Cycle 24 progressed, it became clearer and clearer that it would be a weak
cycle. A quantitative estimate of the cycle strength can be given by the Wolf
number, deﬁned as R = k(10g + s), with g the number of sunspot groups, s the
total number of individual sunspots in all groups and k a variable scaling factor
that accounts for instruments or observation conditions. We now know that for
Cycle 24, the monthly smoothed Wolf number reached a peak of about 82 in April
2014. This will probably become the oﬃcial maximum. This second peak surpassed
the level of the ﬁrst peak (about 67 in February 2012). Many cycles are double
peaked but this is the ﬁrst in which the second peak in sunspot number was larger
than the ﬁrst. These features make Cycle 24 the weakest cycle since Cycle 14, which
peaked in 1906. Among the predictions, less than 25% had anticipated such a small
number. It thus still seems extremely diﬃcult to provide reliable predictions of the
long-term solar activity with the techniques that have been used so far (mostly
relying on geomagnetic precursors or other statistical estimates – see Hathaway
2009 for a review on the subject). In meteorology, data assimilation which cleverly
combines observational data and numerical models has been used for decades and
now routinely in weather-forecasting. Considering the high-quality observations
at our disposal, the recent progress in numerical simulations and the necessity to

20

A. Schad et al.

produce predictions of the amplitude, timing and shape of the next solar cycle, it
seems rather reasonable to try to apply data assimilation to solar physics (Brun
2007).

4.1 First attempts to introduce data into models

There have been ﬁrst attempts to connect models and data, not exactly through
data assimilation but rather by driving models with a time series of well-chosen
data. This procedure has been implemented for ﬂux-transport dynamo models
and for photospheric and heliospheric magnetic ﬁeld evolutions. In their mean-
ﬁeld dynamo model, Dikpati & Gilman (2006) have introduced a surface source of
magnetic ﬁeld that depended upon the sunspot areas observed since 1874, when
Choudhuri et al. (2007) chose the surface ﬁeld at minimum to be their driving ob-
servations. Both models produced good agreement with previous observed cycles
but diﬀered completely on the predictions for Cycle 24. One of the reasons was
that one model (Dikpati’s) was dominated by the advection process while the other
(Choudhuri’s) was dominated by diﬀusion, changing drastically the characteristics
of the memory of the system, as was shown by Yeates et al. (2008). It should be
noted that both predictions happen to be quite far from reality, either on the
timing of the cycle, or its amplitude. Data-driven models for the solar atmosphere
now also tend to develop. A ﬁrst attempt was made by Schrijver & DeRosa (2003)
when they introduced SOHO/MDI magnetograms into a ﬂux-dispersal model to
see the inﬂuence on the coronal reconﬁgurations. More recently, Cheung & DeRosa
(2012) simulated the evolution of the active region coronal ﬁeld driven by temporal
sequences of photospheric magnetograms from SDO/HMI. Under certain condi-
tions, they found that data-driven simulations could produce ﬂux ropes that were
ejected from the modeled active region due to loss of equilibrium, possibly showing
a way to predict violent events through simulations.

In the future, we would like to make observations and models really work to-
gether and feed the simulations with data so that the model improves itself and
allows to make reliable predictions. To do so, data assimilation techniques are ex-
actly what we are looking for (see Kalnay 2003 for a general introduction related
to atmospheric sciences and Fournier et al. 2010 for applications to geophysics).
Indeed, they consist in combining observational data and numerical models to pro-
duce what is called an analysis: the new information provided by the observational
data is taken into account in order to advance in time the “background” state that
the numerical code has predicted. The increment is obtained by taking the diﬀer-
ence, or innovation, between the observational data and the observation operator.
More speciﬁcally, let xb be the background vector state characterizing the current
state of the model, H the observational operator and yo the observational data to
be assimilated in the model, then one can show that the analysis xa is:

a = x

b + W (y

o − H(x

b)),

x

(5)

where W represents weights whose exact determination will diﬀer from one as-
similation technique to another. Two approaches and their applications to solar
physics will now be brieﬂy presented and discussed.

Recent developments in helioseismic analysis methods and solar data assimilation

21

4.2 Sequential assimilation and application to solar physics

In the sequential assimilation technique, the background state is advanced in time
thanks to the numerical model and corrected (i.e. an analysis is performed) each
time an observation is available. The analysis is performed using Equation 5, where
W is given by the Kalman gain matrix which is a combination of the covariance
matrices of the forecast and of the observational errors.

The analysis at time k thus provides the new state vector xa

k from which the
forecast is calculated by running the numerical model. This forecast step thus pro-
duces the new background xb
k+1 which in turn will be corrected by the observation
at time k + 1. This sequential process is illustrated in Fig. 14. This technique thus
propagates information forward in time and also gives an estimate of the forecast
errors and of their evolution.

Sequential Assimilation

o

o

b

b

o
y
 
s
n
o
i
t
a
v
r
e
s
b
o

 
,
a
 
 
x
 
s
i
s
y
l
a
n
a

 

 
,
b
 
 
x
d
n
u
o
r
g
k
c
a
b

b

o

Time

Fig. 14 Schematic representation of the sequential data assimilation method used in weather
forecast (adapted from Bocquet 2015). The background state (xb) is updated every time an
observation is available and the model evolves the state until the next step (following the
arrows), at which observational data (yo) are again assimilated to produce the analysis (xa).

As far as predictions of future solar activity is concerned, sequential assimila-
tion has been implemented for the ﬁrst time by Kitiashvili & Kosovichev (2008)
in a 1D mean-ﬁeld dynamo model evolving jointly the three components of the
magnetic ﬁeld and a measure of the magnetic helicity. The observations used were
the annually smoothed Wolf sunspot number for the period 1857-2007. To derive
the observational operator H, the following relationship between the Wolf number
and the toroidal (in the azimuthal direction) magnetic ﬁeld was used: |Bφ| ∝ R2/3.
The model used was a classical αΩ dynamo model in which the toroidal ﬁeld owes
its origin to the diﬀerential rotation shearing the poloidal (in the meridian plane)
ﬁeld lines (the Ω-eﬀect) and where the poloidal ﬁeld is due to helical turbulence
within the solar convection zone acting on the toroidal ﬁeld (the α-eﬀect). This
model contains a number of simpliﬁcations (see Brun et al. 2013 and Charbonneau
2010), most notably a rather crude parameterization of the eﬀects of turbulence
on the large-scale magnetic ﬁeld but has the advantage of producing a cyclic vari-

22

A. Schad et al.

ation of B and an exponential growth of the magnetic energy (saturated here by
the back-reaction of the magnetic ﬁeld on the α-eﬀect).

15

Fig. 15 Prediction of the sunspot number for Cycle 24 from Kitiashvili & Kosovichev (2008).
The green curve shows the model reference solution. The blue curve shows the best estimate of
the sunspot number using the observational data (open circles) and the model outputs (black
dots), for the previous cycles. The black curve the model solution according to the initial
conditions of the last measurement. The red curve shows the prediction results. The model
solution is shown for three diﬀerent estimates of the sunspot number for 2008: 3 (black curve),
5 (dashed curve), and 10 (dotted curve).

Fig. 15 shows the result of their forecasting step for Cycle 24, after they applied
their sequential assimilation to get the analysis at the time they wrote the paper
(2008). Their predictions were shown for three diﬀerent estimates of the Wolf
number in 2008 since they did not have yet the real data. What we see on this
ﬁgure is actually quite a good agreement with what Cycle 24 looks like now,
reaching its maximum of around 80 in 2013 (a bit early then). However, we should
keep in mind that the model was here very simple and the relationship between the
observational data and the outputs of the model rather uncertain, leading them to
state in the conclusion that additional observations like the latitudinal distribution
of sunspots should probably also be taken into account to make progress in the
subject.

First steps towards using a more complete model including a large-scale merid-
ional circulation were undertaken recently by Dikpati & Anderson (2012) and
Dikpati et al. (2014). Their idea is to use a 2D dynamo model in which the
poloidal ﬁeld is generated by the decay of active regions emerging at the solar
surface (Babcock 1961; Leighton 1969) and not by small-scale turbulence in the
convection zone like in classical αΩ dynamo models. The data they are planning to
use is similar to what Kitiashvili & Kosovichev (2008) chose, namely the monthly
smoothed sunspot number data from the Royal Observatory of Belgium but they
also intend to make eﬃcient use of data concerning the solar meridional circulation.
Their ﬁrst step was thus to determine the response time of the whole system to per-

Recent developments in helioseismic analysis methods and solar data assimilation

23

turbations of the meridional ﬂow, which is not very well measured below the ﬁrst
few Mm of the Sun and which is known to produce large changes in the timing and
possibly the shape of the magnetic cycles in those types of ﬂux-transport dynamo
models (Dikpati & Charbonneau 1999; Jouve & Brun 2007). Dikpati & Anderson
found that in the advection-dominated regimes they considered, the models time
of peak response to a change in ﬂow speed was rather short compared to the full
circulation time and thus that a modiﬁcation of the amplitude of the ﬂow would
quickly show large changes in the evolution of the magnetic ﬁeld. In a recent sub-
sequent paper (Dikpati et al. 2014), they applied a sequential data assimilation
technique to reconstruct the meridional ﬂow speed at the solar surface (ﬁxing the
meridional ﬂow proﬁle to one large circulation cell per hemisphere) from synthetic
observations of the magnetic ﬁeld. The synthetic observations were produced by
running the model with a ﬁxed meridional ﬂow proﬁle and speed and then noised
to mimic observational errors. They found that the best reconstruction of merid-
ional ﬂow-speed could be obtained when 10 or more observations were used with
an up-dating time of 15 days and an observational error of less than 10%.

Another relevant quantity to assess when dealing with forecasting in such dy-
namical systems is what Lhuillier et al. (2011) call the forecast horizon or the
time interval over which reliable predictions can be achieved. They made a de-
tailed analysis of the growth rate of perturbations applied to the magnetic, ve-
locity or temperature ﬁeld for geodynamo simulations and found that the limit
of predictability would be a combination of this growth time (estimated to be
of about 30 yr), of all types of errors aﬀecting the initial conditions and of the
limited numerical resolution. Recently, Sanchez et al. (2014) performed the same
kind of analysis for a ﬂux-transport mean-ﬁeld dynamo model, similar to the one
considered by Dikpati et al. (2014). They measured the rate associated with the
exponential growth of an initial perturbation of the model trajectory, and found a
characteristic e-folding time of 2.76 solar cycle durations. These results are quite
promising for possible future predictions of solar activity. However, thorough stud-
ies of the sensitivity to all model parameters and on the predictability skills of these
models will have to be undertaken before being able to apply more complete se-
quential data assimilation and to rely on predictions coming from simpliﬁed solar
dynamo models.

4.3 Variational assimilation and applications to solar physics

As opposed to sequential assimilation, the variational technique consists in ad-
justing the trajectory of the model through observations over a signiﬁcant time
interval. This is illustrated in Fig. 16. To be more formal, the analysis xa is found
here by minimizing a cost function J, deﬁned over the entire time window where
observations are available. This cost (or objective) function is the sum of two
terms. The ﬁrst one measures the distance between the outputs of the model and
the observations and the other one measures the distance to an a priori estimate
of the background state, if there is any. This second term is called the background
term, it can be used to provide the system with information about regularity of
the solutions we are looking for, approximations that our ﬂows need to satisfy
or typical values we expect at certain points in the domain. After the analysis is
found, the forecast step is similar to the one performed in the sequential technique,

24

A. Schad et al.

it is calculated by applying the numerical model to the analysis which has just
been determined. This technique thus propagates information both forward and
backward in time since the present state is estimated using the past and future
observations available over the entire time window. This is important if we wish to
reassimilate past data or in other words propagate backward in time the current
quality of observational data. This advantage of variational assimilation might be
of great use for solar physics for example if we wish to have a better insight on the
state of the system at periods where observations were missing because of a lack
of instruments or of a lack of surface events, like in the periods of grand minima.
However, as stated before, we should of course keep in mind that the quality of the
forecast will be strongly limited by the range of predictability in such dynamical
systems (Lhuillier et al. 2011).

Variational Assimilation

o

o

o
y
 
s
n
o
i
t
a
v
r
e
s
b
o
 
,
a
 
 
x
 
s
i
s
y
l
a
n
a

o

Time

Fig. 16 4D variational method and comparison with sequential assimilation (adapted from
Bocquet 2015). In the 4D variational method, within a time interval the model and the ob-
servations are taken into account in the cost function that needs to be ”minimized”. The
minimization of this cost function results in a best trajectory (plain arrows) across the obser-
vations.

The main drawback however of using variational assimilation is that it requires
the development of an adjoint model which will be used to provide the gradient
of the cost function with respect to all input variables. Both the values of the
function itself and of its gradient are then combined in a minimization algorithm
to produce the analysis. Simple recipes can be used to write the adjoint code of a
numerical program by hand (e.g. Talagrand 1991; Giering & Kaminski 1998) but
for very large codes, it can be tempting to resort to automatic diﬀerentiation (AD)
algorithms. AD is becoming a very eﬃcient and powerful tool used to produce the
adjoint code of general circulation models in meteorology (among many others,
we can quote the on-line tool TAPENADE, developed by the TROPICS team in
INRIA Sophia Antipolis, France).

Variational assimilation (or 3D/4D-VAR) was used recently in astrophysics for
the problem of 2D stratiﬁed convection (Svedin et al. 2013) and in the context of

Recent developments in helioseismic analysis methods and solar data assimilation

25

solar physics for two main applications as of today: models of solar ﬂares and dy-
namo models. In both studies, only synthetic observations were used, i.e. produced
by a model and not by nature. Nevertheless, those are ﬁrst steps towards under-
standing how variational assimilation may help us understand the current state of
our Sun and hopefully predict its magnetic activity. In 2007, B´elanger et al. used
a phenomenological model, called the avalanche model, which, although a priori
far removed from the physics of magnetic reconnection and magnetohydrodynami-
cal evolution of coronal structures, nonetheless reproduces quite well the observed
statistical distribution of ﬂare characteristics. This model is the continuous anal-
ogous to one of a sandpile where grains are dropped one by one until the pile
reaches an equilibrium conical shape. Addition of more grains will then sometimes
produce small to large avalanches or may have no consequences at all, leading to a
strongly intermittent unloading while the loading remains slow and gradual. The
cost function which is minimized here is the misﬁt between the outputs of the
model and the synthetic observations (produced with a known set of parameters),
in terms of an amount of energy released, averaged in time. They show that, despite
the unpredictable (and unobservable) stochastic nature of the driving/triggering
mechanism within the avalanche model, 4D-VAR succeeds in producing optimal
initial conditions that reproduce adequately the time series of energy released by
avalanches and ﬂares. More recent works about the predictability of solar ﬂares
with the avalanche model have however shown that only a modiﬁed version of it,
purely deterministically driven, could produce reliable predictions for large erup-
tive events (Strugarek & Charbonneau 2014).

Reconstructed alpha function

Difference with true poloidal field A at t=0.5

Fig. 17 Adapted from Jouve, Brun & Talagrand (2011). Left panel: α function reconstructed
after assimilation of data in the Southern hemisphere only, with 2 diﬀerent sets of observations,
superimposed with the true state. The red dots indicate the locations of the observations in
the case were we have 10 observations in latitude (ny = 10). Right panel: diﬀerence between
the poloidal potential produced by the reconstructed α and the true state at t=0.5 (in the
middle of the time interval).

Variational data assimilation was also applied in the context of solar dynamo
models. Since the idea is to produce predictions of future solar activity, trying to
use a technique which is now used routinely in weather forecasting on Earth sounds
like a reasonable way to go. In Jouve, Brun & Talagrand (2011), a variational data
assimilation technique was developed, using a 2D mean-ﬁeld αΩ dynamo model.

26

A. Schad et al.

As we said before, synthetic data were used, consisting of outputs from the model
produced by a particular set of parameters and more speciﬁcally a particular choice
of α as a function of latitude (designated by the coordinate y here). After the
observations were produced, a cost function was chosen to be the misﬁt between
the model toroidal ﬁeld and the observations of the same quantity. The result of
the minimization was then supposed to reproduce the α function used to calculate
the observations. The authors performed an analysis of the dependence of the
quality of this recovery as a function of the number and location of observations.
In Fig. 17, an example of such a calculation is shown, where data were only present
in one hemisphere (from y = −1 to y = 0). The recovery of the α function was
very good in the hemisphere where data were present but the diﬀerence with the
real solution (called the true state) was also found to be reduced in the other
hemisphere when more observations were assimilated. This indicates that the cost
function (and thus the values of the magnetic ﬁeld) in one hemisphere was sensitive
to the α-eﬀect in the other hemisphere, which is the kind of insight that can be
gained from variational data assimilation techniques.

One of the challenges in solar physics that can be tackled under the angle
of data assimilation is to get a better knowledge of the meridional ﬂow and its
role in the dynamo process. Hung, Jouve, Brun, Fournier & Talagrand, 2015 (in
preparation) are now developing a variational data assimilation technique applied
to a 2D spherical ﬂux-transport dynamo model. This will allow consideration of
various possible observations beyond the basic averaged sunspot number. For the
magnetic ﬁeld, one could use the amount of poloidal ﬁeld at the poles, the timing
of its reversal (that we can get from Hinode or SDO for example), the components
of the multipolar expansion of the magnetic ﬁeld (accessible of course on the Sun,
DeRosa et al. 2012, but also now for other stars through spectropolarimetry, see
Petit et al. 2008). For the velocity ﬁeld, use could be made of the amplitude and
proﬁle of the meridional ﬂow (both at the surface and deeper down thanks to
new helioseismic techniques, as discussed in this paper) and possibly of torsional
oscillations (Vorontsov et al. 2002b; Spruit 2003). By applying data assimilation
with those various sources of observations and an a priori knowledge of part of
the meridional ﬂow, the ﬁrst results of this study indicate that it is possible to
reconstruct not only its amplitude as in the work of Dikpati et al. (2014) but also
its proﬁle in the solar interior and its structure close to the base of the convection
zone, which are of prime interest for dynamo modelers.

4.4 Perspectives for data assimilation in solar physics

The applications presented here are of course very preliminary in terms of models
and observations. Firstly, they do not yet use real data but were only tested on
synthetic observations or on very smoothed proxies. Secondly, the models are ex-
tremely simple compared to the most up-to-date 3D models evolving the full set
of magneto-hydrodynamics equations in spherical geometry. However, and that is
maybe what constitutes a big diﬀerence with meteorology, we have limited ac-
cess to observations within the solar interior (with the notable exception of what
is learned thanks to helioseismology and particularly new global and local tech-
niques, as is shown in this paper) and moreover we do not have yet at our disposal
a self-consistent 3D dynamo model reproducing the main characteristics of the

Recent developments in helioseismic analysis methods and solar data assimilation

27

large-scale solar magnetic ﬁeld. We thus have to move step by step towards this
goal by ﬁrst considering surface observations assimilated in simpliﬁed solar models.
In this context, it could be useful to work on ensemble forecasting, similar to
what is used today in weather predictions on Earth. In the case of weather forecast-
ing, the idea is to make several predictions starting with slightly diﬀerent initial
conditions and to take an average of those predictions to get the actual forecast.
This has mainly three goals: improving the forecast thanks to the averaging, pro-
viding an indication of the reliability of the prediction and giving a quantitative
way to assess the quality of each individual forecast. In solar physics, we could
think of forming an ensemble not by perturbing the initial conditions for the same
model but rather by considering diﬀerent models, where the key physical processes
may have more or less impact on the evolution of the magnetic ﬁeld. Each model
would then provide its own forecast. Eventually, the averaging process would give
us a way to distinguish between those various models and would indicate which
characteristics of the cycle we are the most likely to correctly anticipate. That is
probably a future development to be considered on the way towards better and
more reliable long-term predictions of solar activity.

5 Summary

In the ﬁrst part of this paper we reviewed some recent developments of local and
global helioseismic data analysis methods. For the local helioseismic analysis we
focused on the time-distance method as used for the estimation of velocity ﬁelds in
the solar subsurface, e.g., supergranulation. Such analyses of rather rapidly evolv-
ing processes beneﬁt from sophisticated averaging schemes and ﬁltering meth-
ods that help to increase the signal-to-noise ratio and to retrieve signatures from
travel–time shifts.

Regarding global helioseismology, we considered two advances, the metrology
project and the mode eigenfunction perturbation analysis for inferences of the
meridional ﬂow. Global helioseismic inferences rely on the accuracy and reliabil-
ity of estimated global seismic mode parameters, like the mode frequencies. The
global helioseismic metrology project aims to improve accuracy and reliability of
the parameter estimates by better incorporation of systematic inﬂuences in the
parameter estimation scheme. The systematic inﬂuences cannot be overcome by
longer observations and are of diﬀerent origin, for example from leakage of mode
power in the l − ω–diagram that comes essentially from the technical restrictions
in observing the solar velocity ﬁeld in the photosphere and mode coupling domi-
nated by rotation. The method used by the global helioseismic metrology project
is able to reduce some of the systematic errors of the estimated parameters which
provide a better agreement with solar models constructed with recent versions of
the equation of state.

One systematic inﬂuence, the mode coupling, actually results from a perturba-
tion of the mode eigenfunctions by ﬂows in the solar interior. These perturbations
lead to a cross-talk between the spherical harmonic coeﬃcients of the Doppler
velocity measurements that manifests as leakage in the power spectra. This phe-
nomenon was recently exploited to develop global helioseismic methods to infer
the meridional ﬂow in the deeper interior. Here, the characteristic cross-talk due
to the meridional ﬂow is investigated by a cross-spectral analysis of time series of

28

A. Schad et al.

these spherical harmonic velocity coeﬃcients. The meridional ﬂow measured by
this approach shows a complex ﬂow pattern over latitude and depth and extends
from the surface down to the base of the convection zone. Since mode eigenfunc-
tions are also perturbed by other kinds of disturbance, e.g., rotation, their analysis
may be also of interest for studies on these perturbations.

One important objective of helioseismic investigations is to reveal the dynamic
processes in the interior associated with the solar dynamo, e.g., the meridional
ﬂow, in order to better understand this mechanism. Another approach to explore
this mechanism and moreover to predict the related solar magnetic activity cycle
was recently made by the use of data assimilation methods. This subject was
reviewed in detail in the second part of this paper. We discussed two approaches,
sequential and variational data assimilation, and their application to solar data. So
far, diﬀerent kinds of observational quantities, for example the sunspot numbers,
the speed of the meridional ﬂow, the polar magnetic ﬁeld as well as synthetic
data, and rather simple models relating observations to the solar dynamo were
combined to aﬀord forecasts of the magnetic solar cycle or ﬂares. The results of
these investigations and the increasing amount of solar data of high quality make
data assimilation a promising approach for forecasts of the solar activity cycle as
well as magnetic activities relevant for space weather.

Acknowledgements LJ would like to thank Sacha Brun for helpful comments on the data
assimilation part in this paper. MR and AS have received funding from the European Research
Council under the European Unions Seventh Framework Program (FP/2007-2013)/ERC Grant
Agreement no. 307117. The authors thank M.F. Woodard for providing Fig. 11.

Conﬂict of Interest: The authors declare that they have no conﬂict of interest.

References

L. Alvan, A.S. Brun, S. Mathis, Theoretical seismology in 3D: nonlinear simulations of internal

gravity waves in solar-like stars, Astron. Astrophys. 565, 42 (2014)

E.R. Anderson, T.L. Duvall, Jr., S.M. Jeﬀries, Modelling of solar oscillation power spectra,

Astrophys. J. 364, 699-705 (1990)

H.W. Babcock, The topology of the Sun’s magnetic ﬁeld and the 22-year cycle, Astrophys.

J. 133, 572 (1961)

E. B´elanger, A. Vincent, P. Charbonneau, Predicting Solar Flares by Data Assimilation in

Avalanche Models. I. Model Design and Validation, Solar Phys. 245, 141–165 (2007)

A. Birch, T.L. Duvall Jr., L. Gizon, J. Jackiewicz, Helioseismology of the ”Average” Super-

granule, Bull. Am. Astron. Soc. 38, 224 (2006)

A. Birch, D.C. Braun, Y. Fan, An Estimate of the Detectability of Rising Flux Tubes, Astro-

phys. J. Lett. 723, L190–L194 (2010)

M.

Bocquet,

lecture
http://cerea.enpc.fr/HomePages/bocquet/teaching.html (2015)

OACOS/WAPE/ParisTech

M2

notes

2014–2015,

D.C. Braun, T.L. Duvall Jr., B.J. LaBonte, Acoustic absorption by sunspots, Astrophys. J.

Lett. 319, L27--L31 (1987)

D.C. Braun, Comment on “Detection of Emerging Sunspot Regions in the Solar Interior”,

Science 336, pp. 296 (2012)

A.S. Brun, Towards using modern data assimilation and weather forecasting methods in solar

physics, Astron. Nachr. 328, 329–338 (2007)

A.S. Brun, M.S. Miesch, J. Toomre, Modeling the dynamical coupling of solar convection with

the radiative interior, Astrophys. J. 742, 79 (2011)

A.S. Brun, M.K. Browning, M. Dikpati, H. Hotta, A. Strugarek, Recent advances on Solar
Global Magnetism and Variability Space Sci. Rev. doi: 10.1007/s11214-013-0028-0, (2013)

Recent developments in helioseismic analysis methods and solar data assimilation

29

P. Charbonneau, Dynamo Models of the Solar Cycle, Living Rev. Sol. Phys. 7, 3 (2010)
P. Chatterjee, H.M. Antia, Solar Flows and their Eﬀect on Frequencies of Acoustic Modes,

Astrophys. J. 707, 208–217 (2009)

M.C.M. Cheung, M. Rempel, A.M. Title, M. Sch¨ussler, Simulation of the Formation of a Solar

Active Region, Astrophys. J. 720, 233–244 (2010)

M.C.M. Cheung, M.L. DeRosa, A Method for Data-driven Simulations of Evolving Solar Active

Regions, Astrophys. J. 757, 147 (2012)

A.R. Choudhuri, P. Chatterjee, J. Jiang, Predicting solar cycle 24 with a solar dynamo model,

Phys. Rev. Lett. 98, 13 (2007)

K. DeGrave, J. Jackiewicz, M. Rempel, Validating time-distance helioseismology with realistic

quiet-Sun simulations Astrophys. J. 127, pp. 15 (2014)

M.L. DeRosa, A.S. Brun, J.T. Hoeksema, Solar Magnetic Field Reversals and the Role of

Dynamo Families, Astrophys. J. 757, 96 (2012)

M. Dikpati, P. Charbonneau, A Babcock-Leighton ﬂux transport dynamo with solar-like dif-

ferential rotation, Astrophys. J. 518, 508–520 (1999)

M. Dikpati, P.A. Gilman, Simulating and predicting solar cycles using a ﬂux-transport dynamo,

Astrophys. J. 649, 498–514 (2006)

M. Dikpati, J.L. Anderson, Evaluating potential for data assimilation in a ﬂux-transport dy-
namo model by assessing sensitivity and response to meridional ﬂow variation, Astrophys.
J. 756, 20 (2012)

M. Dikpati, J.L. Anderson, D. Mitra, Ensemble Kalman ﬁlter data assimilation in a Babcock-
Leighton solar dynamo model: an observation system simulation experiment for recon-
structing meridional ﬂow-speed, Geophys. Res. Lett. 41, 5361 (2014)

T.L. Duvall Jr., A Dispersion Law for Solar Oscillations, Nature 300, 242–243 (1982)
T.L. Duvall Jr., S.M. Jeﬀeries, J.W. Harvey, M.A. Pomerantz, Time-Distance Helioseismology,

Nature 362, 430–432 (1993)

T.L. Duvall Jr., A.C. Birch, L. Gizon, Direct Measurement of Travel-Time Kernels for Helio-

seismology, Astrophys. J. 646, 553–559 (2006)

T.L. Duvall Jr., A.C. Birch, The Vertical Component of the Supergranular Motion, Astrophys.

J. 725, L47–L51 (2010)

T.L. Duvall Jr., S.M. Hanasoge, Subsurface Supergranular Vertical Flows as Measured Us-
ing Large Distance Separations in Time-Distance Helioseismology, Solar Phys. 287, 71–83
(2013)

T. Felipe, D. Braun, A. Crouch, A. Birch, Scattering of the f-mode by Small Magnetic Flux El-
ements from Observations and Numerical Simulations, Astrophys. J. 757, 148–160 (2012)
A. Fournier, G. Hulot, D. Jault, W. Kuang, A. Tangborn, N. Gillet, E. Canet, J. Aubert, F.
Lhuillier, An introduction to data assimilation and predictability in geomagnetism, Space
Sci. Rev. 155, 247–291 (2010)

L. Gizon, A.C. Birch, Time-Distance Helioseismology: Noise Estimation, Astrophys. J. 614,

472–489, (2004)

L. Gizon, H. Schunker, C.S. Baldner, S. Basu, A.C. Birch, R.S. Bogart, D.C. Braun, R.
Cameron, T.L. Duvall Jr., S.M. Hanasoge, J. Jackiewicz, M. Roth, T. Stahn, M.J. Thomp-
son, S. Zharkov, Helioseismology of Sunspots: A Case Study of NOAA Region 9787, Space
Sci. Rev. 114, 249–273, (2009)

R. Giering, T. Kaminski, Recipes for adjoint code construction, ACM Trans. Math. Software

24, 437–474 (1998)

D. Gough, B.W. Hindman, Helioseismic detection of deep meridional ﬂow, Astrophys. J. 714,

960–970 (2010)

D.H. Hathaway, Solar cycle forecasting, Space Sci. Rev. 144, 401–412 (2009)
F. Hill, Rings and Trumpets – Three-dimensional Power Spectra Of Solar Oscillations, Astro-

phys. J. 333, 996–1013 (1988)

F. Hill, P.B. Stark, R.T. Stebbins, E.R. Anderson, H.M. Antia, T.M. Brown, T.L. Duvall,
Jr., D.A. Haber, J.W. Harvey, D.H. Hathaway, R. Howe, R. Hubbard, H.P. Jones, J.R.
Kennedy, S.G. Korzennik, A. Kosovichev, J.W. Leibacher, K.G. Libbrecht, J.A. Pintar,
E.J. Rhodes, Jr., J. Schou, M.J. Thompson, S. Tomczyk, C.G. Toner, R. Toussaint, W.E.
Williams, The Solar Acoustic Spectrum and Eigenmode Parameters, Science 272, 1292–
1295 (1996)

J. Hirzberger, L. Gizon, S.K. Solanki, T.L. Duvall Jr., Structure and Evolution of Supergran-

ulation from Local Helioseismology, Solar Phys. 251, 417–437 (2008)

S. Ilonidis, J. Zhao, A. Kosovichev, Science 333, 993 (2011)

30

A. Schad et al.

S. Ilonidis, J. Zhao, T. Hartlep, Helioseismic investigation of emerging magnetic ﬂux in the

solar convection zone, Astrophys. J. 777, 138 (2013)

J. Jackiewicz, L. Gizon, A.C. Birch, High-Resolution Mapping of Flows in the Solar Interior:
Fully Consistent OLA Inversion of Helioseismic Travel Times, Solar Phys. 251, 381–415
(2008)

S.M. Jeﬀeries, S.V. Vorontsov, C. Giebink, Toward improving the seismic visibility of the solar
tachocline, in Proc. SOHO 18/GONG 2006/HELAS I: Beyond the spherical Sun, ed. by
K. Fletcher and M. Thompson (ESA SP-624, ESA, Noordwijk, 2006)

L. Jouve, A.S. Brun, On the role of meridional ﬂows in ﬂux transport dynamo models, Astron.

Astrophys. 474, 239–250 (2007)

L. Jouve, A.S. Brun, O. Talagrand, Assimilating data into an αΩ dynamo model of the Sun:

A variational approach, Astrophys. J. 735, 31 (2011)

E. Kalnay, Atmospheric Modeling, Data Assimilation and Predictability (Cambridge Univer-

sity Press, 2003)

P.J. K¨apyl¨a, M.J. Mantere, A. Brandenburg, Cyclic Magnetic Activity due to Turbulent Con-

vection in Spherical Wedge Geometry.Astrophys. J. Lett. 755, L22 (2012)

I. Kitiashvili, A.G. Kosovichev, Application of data assimilation method for predicting solar

cycles, Astrophys. J. Lett. 688, L49 (2008)

S.G. Korzennik, A mode-ﬁtting methodology optimized for very long helioseismic time series,

Astrophys. J. 626, 585–615 (2005)

S.G. Korzennik, M.C. Rabello-Soares, J. Schou, T.P. Larson, Accurate Characterization of

High-degree Modes Using MDI Observations, Astrophys. J. 772, 87(28pp) (2013)

T.P. Larson, J. Schou, Improvements in global mode analysis, J. Phys. Conf. Series 118, 012083

(2008)

T.P. Larson, J. Schou, Variations in global mode analysis, in Solar-Stellar Dynamos as Re-
vealed by Helio- and Asteroseismology, ed. by M. Dikpati, T. Arentoft, I. Gonzalez Her-
nandez, C. Lindsey, F. Hill, (Astron. Soc. Paciﬁc Conf. Series 416, 2009), pp. 311–314

T.P. Larson, J. Schou, HMI global helioseismology data analysis pipeline, J. Phys. Conf. Series

271, 012062 (2011)

E.M. Lavely, M.H. Ritzwoller, The Eﬀect of Global-Scale, Steady-State Convection and Elastic-
Gravitational Asphericities on Helioseismic Oscillations, Phil. Trans. R. Soc. Lond. A 339,
431–496 (1992)

R.B. Leighton, A Magneto-Kinematic Model of the Solar Cycle, Astrophys. J. 156, 1 (1969)
F. Lhuillier, J. Aubert, G. Hulot, Earths dynamo limit of predictability controlled by magnetic

dissipation, Geophys. J. Int. 186, 492–508 (2011)

C. Lindsey, D.C. Braun, Helioseismic imaging of sunspots at their antipodes, Solar Phys. 126,

101–115 (1990)

M.S. Miesch, A.S. Brun, M.L. DeRosa, J. Toomre, Structure and evolution of giant cells in

global models of solar convection, Astrophys. J. 673, 557 (2008)

H. Moradi, C. Baldner, A.C. Birch, D.C. Braun, R.H. Cameron, T.L. Duvall Jr., L. Gizon,
D. Haber, S.M. Hanasoge, B.W. Hindman, J. Jackiewicz, E. Khomenko, R. Komm, P.
Rajaguru, M. Rempel, M. Roth, R. Schlichenmaier, H.J. Schunker, H.C. Spruit, K.G.
Strassmeier, M.J. Thompson, S. Zharkov, Modeling the Subsurface Structure of Sunspots,
Solar Phys. 267, 1–62 (2010)

N.J. Nelson, B.P. Brown, A.S. Brun, M.S. Miesch, J. Toomre, Magnetic Wreaths and Cycles

in Convective Dynamos. The Astrophysical Journal 762, 73 (2013)

P. Petit, B. Dintrans, S.K. Solanki, M. Auri`ere, F. Ligni`eres , J. Morin, F. Paletou, J. Ramirez,
C. Catala, R. Fares, Toroidal vs. Poloidal Magnetic Fields in Sun-Like Stars: A Rotation
Threshold, Mon. Not. Roy. Astron. Soc. 388, 80–88 (2008)

M.C. Rabello-Soares, S.G. Korzennik, J. Schou, Analysis of MDI High-Degree Mode Frequen-

cies and their Rotational Splittings, Solar Phys. 251, 197 (2008)

J. Reiter, E.J. Rhodes Jr., A.G. Kosovichev, J. Schou, P.H. Scherer, T.P. Larson, A method
for the estimation of p-mode parameters from averaged solar oscillation power spectra,
Astrophys. J. 803, 92(42pp) (2015)

M. Rempel, M. Sch¨ussler, M. Kn¨olker, Radiative magnetohydrodynamic simulation of sunspot

structure, Astrophys. J. 691, 640–649 (2009)

M. Rempel, M.C.M. Cheung, Numerical Simulations of Active Region Scale Flux Emergence:

From Spot Formation to Decay, Astrophys. J. 785, 90 (2014)

E.J. Rhodes Jr, J. Reiter, J. Schou, T. Larson, P. Scherrer, J. Brooks, P. McFaddin, B. Miller,
J. Rodriguez, J. Yoo, Temporal changes in the frequencies and widths of the solar p-mode

Recent developments in helioseismic analysis methods and solar data assimilation

31

oscillations, J. Phys.: Conf. Ser., 271, 012029 (2011)

M. Roth, M. Stix, Meridional Circulation and Global Solar Oscillations, Solar Phys. 251, 77–89

(2008)

S. Sanchez, A. Fournier, J. Aubert, The predictability of advection-dominated ﬂux-transport

solar dynamo models, Astrophys. J., 781, 8 (2014)

A. Schad, J. Timmer, M. Roth, A Uniﬁed Approach to the Helioseismic Inversion Problem of

the Solar Meridional Flow from Global Oscillations, Astrophys. J. 734, 97–105 (2011)

A. Schad, J. Timmer, M. Roth, Measuring the solar meridional ﬂow from perturbations of

eigenfunctions of global oscillation, Astron. Nachr. 333, 991-994 (2012)

A. Schad, J. Timmer, M. Roth, Global helioseismic evidence for a deeply penetrating merid-

ional ﬂow consisting of multiple ﬂow cells, Astrophys. J. Lett. 778, L38–L44 (2013)

A. Schad, A new approach for the global helioseismic investigation of the solar meridional ﬂow,

(Doctoral Dissertation, Albert-Ludwig University of Freiburg, Germany, 2013)

J. Schou, On the analysis of helioseismic data, (Doctoral Dissertation, Aarhus University,

Denmark, 1992)

J. Schou, Observations of medium- and high-degree modes: methods and sandtraps, in Struc-
ture and Dynamics of the Interior of the Sun and Sun-like Stars, ed. by S.G. Korzennik
& A. Wilson (ESA SP-418; Noord- wijk: ESA, 1998), pp. 47–52

J. Schou, P.H. Scherrer, R.I. Bush, R. Wachter, S. Couvidat, and others, Design and Ground
Calibration of the Helioseismic and Magnetic Imager (HMI) Instrument on the Solar Dy-
namics Observatory (SDO), Solar Phys. 275, 229–259 (2012)

C.J. Schrijver, M.L. DeRosa, Photospheric and heliospheric magnetic ﬁelds, Solar Phys. 212,

165–200 (2003)

H.C. Spruit, Origin of the torsional oscillation pattern of solar rotation, Solar Phys. 213, 1–21

(2003)

R.F. Stein, ˚A. Nordlund, On the Formation of Active Regions, Astrophys. J. Lett. 753, L13

(2012)

A. Strugarek, P. Charbonneau, Predictive Capabilities of Avalanche Models for Solar Flares,

Solar Phys., 289, 4137 (2014)

vector ﬂows, ˚A 530, pp. 148 (2011)

M. ˇSvanda, L. Gizon, S.M. Hanasoge, S.D. Ustyugov, Validated helioseismic inversions for 3D

M. ˇSvanda, Inversions for Average Supergranular Flows Using Finite-frequency Kernels, As-

trophys. J. Lett. 759, 29–33 (2012)

A. Svedin, M. C. Cu´ellar, A. Brandenburg, Data assimilation for stratiﬁed convection, Mon.

Not. Roy. Astron. Soc., 433, 2278 (2013)

O. Talagrand, The use of adjoint equations in numerical modeling of the atmospheric circula-
tion, in Automatic Diﬀerentiation of Algorithms: Theory, Implementation, and Applica-
tion, ed. by A. Griewank, G.F. Corliss, (Society for Industrial and Applied Mathematics,
Philadelphia, 1991), pp. 169–180 (1991)

S.V. Vorontsov, J. Christensen-Dalsgaard, J. Schou, V.N. Strakhov, M.J. Thompson, Solar
internal rotation as seen from SOHO MDI data, in From Solar Min to Max: Half a Solar
Cycle with SOHO, ed. by A. Wilson, (ESA SP-508, 2002a), pp. 111–114

S.V. Vorontsov, J. Christensen-Dalsgaard, J. Schou, V.N. Strakhov, M.J. Thompson, Helio-

seismic measurement of solar torsional oscillations, Science 296, 101–103 (2002b)

S.V. Vorontsov, S.M. Jeﬀeries, Modeling Solar Oscillation Power Spectra. I. Adaptive Response

Function for Doppler Velocity Measurements, Astrophys. J. 623, 1202–1214 (2005)

S.V. Vorontsov, Solar p modes of high degree l: Coupling by diﬀerential rotation, Mon. Not.

Roy. Astron. Soc. 378, 1499–1506 (2007)

S.V. Vorontsov, S.M. Jeﬀeries, C. Giebink, J. Schou, Toward Eliminating Systematic Errors
in Intermediate-Degree p-Mode Measurements, in Solar-Stellar Dynamos as Revealed by
Helio- and Asteroseismology, ed. by M. Dikpati, T. Arentoft, I. Gonzalez Hernandez, C.
Lindsey, F. Hill, (Astron. Soc. Paciﬁc Conf. Series 416, 2009), pp. 301–305

S.V. Vorontsov, Eﬀects of diﬀerential rotation and meridional circulation in solar oscillations

of high degree l, Mon. Not. Roy. Astron. Soc. 418, 1146–1155 (2011)

S.V. Vorontsov, V.A. Baturin, S.V. Ayukov, V.K. Gryaznov, Helioseismic calibration of the
equation of state and chemical composition in the solar convective envelope, Mon. Not.
Roy. Astron. Soc. 430, 1636–1652 (2013a)

S.V. Vorontsov, S. M. Jeﬀeries, Modeling Solar Oscillation Power Spectra. II. Parametric
Model of Spectral Lines Observed in Doppler-Velocity Measurements, Astrophys. J. 778,
75(10pp) (2013b)

32

A. Schad et al.

J. Warnecke, P.J. K¨apyl¨a, M.J. K¨apyl¨a, A. Brandenburg, On The Cause of Solar-like Equator-
ward Migration in Global Convective Dynamo Simulations, Astrophys. J. Lett. 796, L12
(2014)

M.F. Woodard, Eﬀect of Subsurface Inhomogeneities on the Statistics of Solar Oscillation

Power Spectra, Solar Phys. 180, 19–28 (1998)

M.F. Woodard, Theoretical signature of solar meridional ﬂow in global seismic data, Solar

Phys. 197, 11–20 (2000)

M.F. Woodard, J. Schou, A.C. Birch, T.P. Larson, Global-oscillation eigenfunction measure-

ments of solar meridional ﬂow, Solar Phys. 287, 129–147 (2013),

A.R. Yeates, D. Nandy, & D.H. Mackay, Exploring the physical basis of solar cycle predic-
tions: Flux transport dynamics and persistence of memory in advection versus diﬀusion-
dominated solar convection zones, Astrophys. J. 673, 544–556 (2008)

J. Zhao, A.G. Kosovichev, On the inference of supergranular ﬂows by time-distance helioseis-
mology, in GONG+ 2002. Local and Global Helioseismology: the Present and Future, ed.
by H. Sawaya-Lacoste (ESA SP-517, ESA, Noordwijk, 2003), pp. 417–420

J. Zhao, K. Nagashima, R.S. Bogart, A.G. Kosovichev, T.L. Duvall Jr., Systematic center-to-
limb variation in measured helioseismic travel times and its eﬀect on inferences of solar
interior meridional ﬂows, Astrophys. J. Lett. 749, 5 (2012)

J. Zhao, R.S. Bogart, A.G. Kosovichev, T.L. Duvall Jr., T. Hartlep, Detection of equatorward
meridional ﬂow and evidence of double-cell meridional circulation, Astrophys. J. Lett. 774,
29 (2013)

