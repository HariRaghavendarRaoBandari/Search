A TWO WEIGHT FRACTIONAL SINGULAR INTEGRAL THEOREM WITH SIDE

CONDITIONS, ENERGY AND k-ENERGY DISPERSED

ERIC T. SAWYER, CHUN-YEN SHEN, AND IGNACIO URIARTE-TUERO

Abstract. This paper is a sequel to our paper [SaShUr7]. Let σ and ω be locally ﬁnite positive Borel
measures on Rn (possibly having common point masses), and let T α be a standard α-fractional Calder´on-
Zygmund operator on Rn with 0 ≤ α < n. Suppose that Ω : Rn → Rn is a globally biLipschitz map, and
refer to the images ΩQ of cubes Q as quasicubes. Furthermore, assume as side conditions the Aα
2 conditions,
punctured Aα
2 conditions, and certain α-energy conditions taken over quasicubes. Then we show that T α
is bounded from L2 (σ) to L2 (ω) if the quasicube testing conditions hold for T α and its dual, and if the
quasiweak boundedness property holds for T α.

Conversely, if T α is bounded from L2 (σ) to L2 (ω), then the quasitesting conditions hold, and the
σ (or more generally
2 conditions and

quasiweak boundedness condition holds. If the vector of α-fractional Riesz transforms Rα
a strongly elliptic vector of transforms) is bounded from L2 (σ) to L2 (ω), then both the Aα
the punctured Aα

2 conditions hold.

We do not know if our quasienergy conditions are necessary when n ≥ 2, except for certain situations
in which one of the measures is one-dimensional [SaShUr8], and for certain side conditions placed on the
measures such as doubling and k-energy dispersed, which when k = n − 1 is similar to the condition of
uniformly full dimension in [LaWi, versions 2 and 3].

Contents

6
1
0
2

 
r
a

 

M
4
1
 
 
]

.

A
C
h
t
a
m

[
 
 

1
v
2
3
3
4
0

.

3
0
6
1
:
v
i
X
r
a

2

Introduction

1.
1.1. A brief history of the T 1 theorem
2. Statements of results
2.1. Standard fractional singular integrals and the norm inequality
2.2. Quasicube testing conditions
2.3. Quasiweak boundedness property
2.4. Poisson integrals and Aα
2.5. A weighted quasiHaar basis
2.6. Good quasigrids and quasienergy conditions
2.7. Statement of the Theorems
3. Proof of Theorem 1
4. Necessity of the Aα
5. Monotonicity lemma and Energy lemma
5.1. The monotonicity lemma
5.2. The Energy Lemma
6. Preliminaries of NTV type
7. Corona Decompositions and splittings
7.1. The Calder´on-Zygmund corona
7.2. The energy corona
7.3. General stopping data
7.4. Doubly iterated coronas and the NTV quasicube size splitting
8. Control of functional energy by energy modulo Aα
8.1. Reduction to Hyt¨onen’s bilinear positive inequality

2 conditions

2

2
2
6
6
7
8
8
10
11
16
17
18
23
23
24
24
25
26
26
27
28
29
29

Date: May 20, 2015.
Research supported in part by NSERC.
C.-Y. Shen supported in part by the NSC, through grant NSC 104-2628-M-008 -003 -MY4.
I. Uriarte-Tuero has been partially supported by grants DMS-1056965 (US NSF), MTM2010-16232, MTM2009-14694-C02-01

(Spain), and a Sloan Foundation Fellowship.

1

2

E.T. SAWYER, C.-Y. SHEN, AND I. URIARTE-TUERO

8.2. Continuous Poisson testing
8.3. The forward Poisson testing inequality
8.4. The backward Poisson testing inequality
9. The stopping form
10. Energy dispersed measures
10.1. Energy dispersed measures and reversal of energy
10.2. Fractional Riesz transforms and semi-harmonicity
10.3. Necessity of the energy conditions
References

34
40
43
44
45
45
46
51
51

Dedication: This paper is dedicated to the memory of Cora Sadosky and her contributions to the

theory of weighted inequalities and her promotion of women in mathematics.

1. Introduction

The boundedness of the Hilbert transform Hf (x) = RR

L2 (R) has been known for at least a century (perhaps dating back to A & E1):
(1)

f (y)

kHfkL2(R) . kfkL2(R) ,

f ∈ L2 (R) .

y−x dy on the real line R in the Hilbert space

This inequality has been the subject of much generalization, to which we now turn.

1.1. A brief history of the T 1 theorem. The celebrated T 1 theorem of David and Journ´e [DaJo] extends
(1) to more general kernels by characterizing those singular integral operators T on Rn that are bounded on
L2 (Rn), and does so in terms of a weak boundedness property, and the membership of the two functions T 1
and T ∗1 in the space of bounded mean oscillation,

These latter conditions are actually the following testing conditions in disguise,

kT 1kBMO(Rn) . k1kL∞(Rn) = 1,
kT ∗1kBMO(Rn) . k1kL∞(Rn) = 1.
kT 1QkL2(Rn) . k1QkL2(Rn) =p|Q| ,
kT ∗1QkL2(Rn) . k1QkL2(Rn) =p|Q| ,

tested uniformly over all indicators of cubes Q in Rn for both T and its dual operator T ∗. This theorem was
the culmination of decades of investigation into the nature of cancellation conditions required for boundedness
of singular integrals2.

A parallel thread of investigation had begun even earlier with the equally celebrated theorem of Hunt,
Muckenhoupt and Wheeden [HuMuWh] that extended (1) to measures more general than Lebesgue’s by
characterizing boundedness of the Hilbert transform on weighted spaces L2 (R; w). This thread culminated
in the theorem of Coifman and Feﬀerman3 [CoFe] that characterizes those nonnegative weights w on Rn for
which all of the ‘nicest’ of the L2 (Rn) bounded singular integrals T above are bounded on weighted spaces
L2 (Rn; w), and does so in terms of the A2 condition of Muckenhoupt,

taken uniformly over all cubes Q in Rn. This condition is also a testing condition in disguise, in particular
it follows from

(cid:18) 1
|Q|ZQ
(cid:13)(cid:13)(cid:13)(cid:13)T(cid:18)sQ

w (x) dx(cid:19)(cid:18) 1
|Q|ZQ
.(cid:13)(cid:13)(cid:13)(cid:13)sQ
w(cid:19)(cid:13)(cid:13)(cid:13)(cid:13)L2(Rn;w)

ℓ(Q)+|x−cQ|

ℓ(Q)

1

w (x)

1

dx(cid:19) . 1 ,
w(cid:13)(cid:13)(cid:13)(cid:13)L2(Rn;w)

1

,

of cubes Q in Rn.

tested over all ‘indicators with tails’ sQ (x) =

1Peter Jones used A&E to stand for Adam and Eve.
2See e.g. chapter VII of Stein [Ste] and the references given there for a historical background.
3See e.g. chapter V of [Ste] and the references given there for the long history of this investigation.

uniformly over all cubes Q, and the two testing conditions hold,

s2

kH (f σ)kL2(Rn;ω) . kfkL2(Rn;σ) ,

Qdω (x)(cid:19)(cid:18) 1
|Q|ZQ

f ∈ L2 (Rn; σ) ,
(cid:18) 1
Qdσ (x)(cid:19) . 1 ,
|Q|ZQ
kH1QσkL2(Rn;ω) . k1QkL2(Rn;σ) =q|Q|σ ,
kH∗1QωkL2(Rn;σ) . k1QkL2(Rn;ω) =q|Q|ω ,

s2

TWO WEIGHT BOUNDEDNESS

3

turning to the simplest (nontrivial) singular integral of all, namely the Hilbert transform Hf (x) =RR

A natural synthesis of these two threads leads to the ‘two weight’ question of characterizing those pairs of
weights (σ, ω) having the property that nice singular integrals are bounded from L2 (Rn; σ) to L2 (Rn; ω). Re-
y−x dy
on the real line, Cotlar and Sadosky gave a beautiful function theoretic characterization of the weight pairs
(σ, ω) for which H is bounded from L2 (R; σ) to L2 (R; ω), namely a two-weight extension of the Helson-Szego
theorem. This characterization illuminated a deep connection between two quite diﬀerent function theoretic
conditions, but failed to shed much light on when either of them held. On the other hand, the two weight
inequality for the positive fractional integrals were characterized using testing conditions by one of us in
[Saw], but relying in a very strong way on the positivity of the kernel, something the Hilbert kernel lacks. In
light of these considerations, Nazarov, Treil and Volberg formulated the two weight question for the Hilbert
transform [Vol], that in turn led to the following NTV conjecture:

f (y)

Conjecture 1. [Vol] The Hilbert transform is bounded from L2 (Rn; σ) to L2 (Rn; ω), i.e.
(2)

if and only if the two weight A2 condition with two tails holds,

uniformly over all cubes Q.

In a groundbreaking series of papers including [NTV1],[NTV2] and [NTV4], Nazarov, Treil and Volberg
used weighted Haar decompositions with random grids, introduced their ‘pivotal’ condition, and proved the
above conjecture under the side assumption that the pivotal condition held. Subsequently, in joint work of
two of us, Sawyer and Uriarte-Tuero, with Lacey [LaSaUr2], it was shown that the pivotal condition was not
necessary in general, a necessary ‘energy’ condition was introduced as a substitute, and a hybrid merging of
these two conditions was shown to be suﬃcient for use as a side condition. Eventually, these three authors
with Shen established the NTV conjecture in a two part paper; Lacey, Sawyer, Shen and Uriarte-Tuero
[LaSaShUr3] and Lacey [Lac]. A key ingredient in the proof was an ‘energy reversal’ phenomenon enabled
by the Hilbert transform kernel equality
1

1

y − x −

y − x′

=

(y − x) (y − x′)

x − x′

,

having the remarkable property that the denominator on the right hand side remains positive for all y outside
the smallest interval containing both x and x′. This proof of the NTV conjecture was given in the special
case that the weights σ and ω had no point masses in common, largely to avoid what were then thought
to be technical issues. However, these issues turned out to be considerably more interesting, and this ﬁnal
assumption of no common point masses was removed shortly after by Hyt¨onen [Hyt2], who also simpliﬁed
some aspects of the proof.

At this juncture, attention naturally turned to the analogous two weight inequalities for higher dimensional
singular integrals, as well as α-fractional singular integrals such as the Cauchy transform in the plane. In a
long paper begun in [SaShUr5] on the arXiv in 2013, and subsequently appearing in [SaShUr7], the authors
introduced the appropriate notions of Poisson kernel to deal with the Aα
2 condition on the one hand, and the
α-energy condition on the other hand (unlike for the Hilbert transform, these two Poisson kernels diﬀer in
general). The main result of that paper established the T 1 theorem for ‘elliptic’ vectors of singular integrals
under the side assumption that an energy condition and its dual held, thus identifying the culprit in higher
dimensions as the energy conditions. A general T 1 conjecture is this (see below for deﬁnitions).

Conjecture 2. Let Tα,n denote an elliptic vector of standard α-fractional singular integrals in Rn. Then
Tα,n is bounded from L2 (Rn; σ) to L2 (Rn; ω), i.e.
(3)

kTα,n (f σ)kL2(Rn;ω) . kfkL2(Rn;σ) ,

f ∈ L2 (Rn; σ) ,

4

E.T. SAWYER, C.-Y. SHEN, AND I. URIARTE-TUERO

if and only if the two one-tailed Aα
the two testing conditions hold,

2 conditions with holes hold, the punctured Aα,punct

2

conditions hold, and

kTα,n1QσkL2(Rn;ω) . k1QkL2(Rn;σ) =q|Q|σ ,
(cid:13)(cid:13)Tα,n,dual1Qω(cid:13)(cid:13)L2(Rn;σ) . k1QkL2(Rn;ω) =q|Q|ω ,

for all cubes Q in Rn (whose sides need not be parallel to the coordinate axes).

In view of the aforementioned main result in [SaShUr7], the following conjecture is stronger.

Conjecture 3. Let Tα,n denote an elliptic vector of standard α-fractional singular integrals in Rn. If Tα,n
is bounded from L2 (Rn; σ) to L2 (Rn; ω), then the energy conditions hold as deﬁned in Deﬁnition 6 below.

While no counterexamples have yet been discovered to the energy conditions, there are some cases in
which they have been proved to hold. Of course, the energy conditions hold for the Hilbert transform on
the line [LaSaUr2], and in recent joint work with M. Lacey and B. Wick, the ﬁve of us have established
that the energy conditions hold for the Cauchy transform in the plane in the special case where one of the
measures is supported on either a straight line or a circle, thus proving the T 1 theorem in this case. The key
to this result was an extension of the energy reversal phenomenon for the Hilbert transform to the setting
of the Cauchy transform, and here the one-dimensional nature of the line and circle played a critical role. In
particular, a special decomposition of a 2-dimensional measure into ‘end’ and ‘side’ pieces played a crucial
role, and was in fact discovered independently in both [SaShUr3] and [LaWi1]. A further instance of energy
reversal occurs in our T 1 theorem [SaShUr8] when one measure is supported on a C1,δ curve in Rn.

The paper [LaWi, v3] by Lacey and Wick overlaps both our paper [SaShUr7] and this paper to some

extent, and we refer the reader to [SaShUr7] for a more detailed discussion.

Finally, we mention an entirely diﬀerent approach to investigating the two weight problem that has
attracted even more attention than the T 1 approach we just described. Nazarov has shown that the two-tailed
Aα
2 condition of Muckenhoupt (see below) is insuﬃcient for (3), and this begs the question of strengthening
the Muckenhoupt condition enough to make it suﬃcient for (3). The great of advantage of this approach is
that strengthened Muckenhoupt conditions are generally ‘easy’ to check as compared to the highly unstable
testing conditions. The disadvantage of course is that such conditions have never been shown to characterize
(3). The literature devoted to these issues is both too vast and too tangential to this paper to record here,
and we encourage the reader to search the web for more on ‘bumped-up’ Muckenhoupt conditions.

2

2 conditions (with holes), punctured Aα. punct

This paper is concerned with the T 1 approach and is a sequel to our ﬁrst paper [SaShUr7]. We prove
here a two weight inequality for standard α-fractional Calder´on-Zygmund operators T α in Euclidean space
Rn, where we assume n-dimensional Aα
conditions, and certain
α-energy conditions as side conditions on the weights (in higher dimensions the Poisson kernels used in
these two conditions diﬀer). The two main diﬀerences in this theorem here are that we state and prove4
our theorem in the more general setting of quasicubes (as in [SaShUr5]), and more notably, we now permit
the weights, or measures, to have common point masses, something not permitted in [SaShUr7] (and only
obtained for a partial range of α in [LaWi, version 3]). As a consequence, we use Aα
2 conditions with holes
as in the one-dimensional setting of Hyt¨onen [Hyt2], together with punctured Aα,punct
conditions, as the
usual Aα
2 ‘without punctures’ fails whenever the measures have a common point mass. The extension to
permitting common point masses uses the dyadic bilinear Poisson inequality of Hyt¨onen [Hyt] to obtain
functional energy, together with a delicate adaptation of arguments in [SaShUr7].
In higher dimensions
the ‘punctured’ Muckenhoupt Aα,punct
conditions are typically necessary, and they turn out to be crucial
in estimating the backward Poisson testing condition later in the paper. The Muckenhoupt Aα
2 conditions
(with holes) are also typically necessary for the norm inequality, but the proofs require extensive modiﬁcation
when quasicubes and common point masses are included.

2

2

On the other hand, the extension to quasicubes in the setting of no common point masses turns out to
be, after checking all the details, mostly a cosmetic modiﬁcation of the proof in [SaShUr7], as demonstrated
in [SaShUr5]. The use of quasicubes is however crucial in our T 1 theorem when one of the measures is
supported on a C1,δ curve [SaShUr8], and this accounts for their inclusion here.

4Very detailed proofs of all of the results here can be found on the arXiv [SaShUr6].

TWO WEIGHT BOUNDEDNESS

5

We also introduce a new side condition on a measure, that we call k-energy dispersed, which captures the
notion that a measure is not supported too near a k-dimensional plane at any scale. When 0 ≤ α < n is
appropriately related to k, we are able to obtain the necessity of the energy conditions for k-energy dispersed
measures, and hence a T 1 theorem for strongly elliptic operators Tα. The case k = n − 1 is similar to the
condition of uniformly full dimension introduced in [LaWi, versions 2 and 3].
We begin by recalling the notion of quasicube used in [SaShUr5] - a special case of the classical notion

used in quasiconformal theory.
Deﬁnition 1. We say that a homeomorphism Ω : Rn → Rn is a globally biLipschitz map if
(4)

kΩ (x) − Ω (y)k

kΩkLip ≡ sup
x,y∈Rn

kx − yk

< ∞,

Note that a globally biLipschitz map Ω is diﬀerentiable almost everywhere, and that there are constants

and(cid:13)(cid:13)Ω−1(cid:13)(cid:13)Lip < ∞.

c, C > 0 such that

c ≤ JΩ (x) ≡ |det DΩ (x)| ≤ C,

x ∈ Rn.

Example 1. Quasicubes can be wildly shaped, as illustrated by the standard example of a logarithmic spiral
in the plane fε (z) = z |z|2εi = zeiε ln(zz). Indeed, fε : C → C is a globally biLipschitz map with Lipschitz
constant 1 + Cε since f−1

ε

(w) = w |w|−2εi and
∇fε =(cid:18) ∂fε
∂fε

∂z

,

∂z(cid:19) =(cid:16)|z|2εi + iε|z|2εi , iε

z

z |z|2εi(cid:17) .

On the other hand, fε behaves wildly at the origin since the image of the closed unit interval on the real line
under fε is an inﬁnite logarithmic spiral.
Notation 1. We deﬁne P n to be the collection of half open, half closed cubes in Rn with sides parallel to
2 , ck + ℓ
the coordinate axes. A half open, half closed cube Q in Rn has the form Q = Q (c, ℓ) ≡
for some ℓ > 0 and c = (c1, ..., cn) ∈ Rn. The cube Q (c, ℓ) is described as having center c and sidelength ℓ.

nYk=1(cid:2)ck − ℓ

2(cid:1)

We repeat the natural quasi deﬁnitions from [SaShUr5].

Deﬁnition 2. Suppose that Ω : Rn → Rn is a globally biLipschitz map.

(1) If E is a measurable subset of Rn, we deﬁne ΩE ≡ {Ω (x) : x ∈ E} to be the image of E under the
homeomorphism Ω.
(a) In the special case that E = Q is a cube in Rn, we will refer to ΩQ as a quasicube (or Ω-quasicube

if Ω is not clear from the context).

(b) We deﬁne the center cΩQ = c (ΩQ) of the quasicube ΩQ to be the point ΩcQ where cQ = c (Q)

is the center of Q.

(c) We deﬁne the side length ℓ (ΩQ) of the quasicube ΩQ to be the sidelength ℓ (Q) of the cube Q.
(d) For r > 0 we deﬁne the ‘dilation’ rΩQ of a quasicube ΩQ to be ΩrQ where rQ is the usual

‘dilation’ of a cube in Rn that is concentric with Q and having side length rℓ (Q).

(2) If K is a collection of cubes in Rn, we deﬁne ΩK ≡ {ΩQ : Q ∈ K} to be the collection of quasicubes
(3) If F is a grid of cubes in Rn, we deﬁne the inherited quasigrid structure on ΩF by declaring that

ΩQ as Q ranges over K.
ΩQ is a child of ΩQ′ in ΩF if Q is a child of Q′ in the grid F .

Note that if ΩQ is a quasicube, then |ΩQ|

n = ℓ (Q) = ℓ (ΩQ). For a quasicube J = ΩQ, we will
generally use the expression |J|
n in the various estimates arising in the proofs below, but will often use ℓ (J)
when deﬁning collections of quasicubes. Moreover, there are constants Rbig and Rsmall such that we have
the comparability containments

n ≈ |Q|

1

1

1

Given a ﬁxed globally biLipschitz map Ω on Rn, we will deﬁne below the n-dimensional Aα

2 conditions
, testing conditions, and energy conditions using

(with holes), punctured Muckenhoupt conditions Aα,punct

2

Q + ΩxQ ⊂ RbigΩQ and RsmallΩQ ⊂ Q + ΩxQ .

6

E.T. SAWYER, C.-Y. SHEN, AND I. URIARTE-TUERO

Since the Aα

Ω-quasicubes in place of cubes, and we will refer to these new conditions as quasiAα
2 , quasitesting and
quasienergy conditions. We will then prove a T 1 theorem with quasitesting and with quasiAα
2 and quasienergy
side conditions on the weights. Since quasiAα
(see [SaShUr8]), we usually
drop the preﬁx quasi from the various Muckenhoupt conditions (warning: quasiAα
2 6= Aα
2 ).
2 and punctured Muckenhoupt conditions typically hold, this identiﬁes the culprit in higher
dimensions as the pair of quasienergy conditions. We point out that these quasienergy conditions are implied
by higher dimensional analogues of essentially all the other side conditions used previously in two weight
theory, in particular doubling conditions and the Energy Hypothesis (1.16) in [LaSaUr2], as well as the
condition of k-energy dispersed measures that is introduced below. This leads to our second theorem, which
establishes the T 1 theorem for strongly elliptic operators Tα when both measures are k-energy dispered with
k and α appropriately related.

2 ∩ quasi Aα,punct

2 ∩ Aα,punct

= Aα

2

2

It turns out that in higher dimensions, there are two natural ‘Poisson integrals’ Pα and P α that arise,
the usual Poisson integral Pα that emerges in connection with energy considerations, and a diﬀerent Poisson
integral P α that emerges in connection with size considerations. The standard Poisson integral Pα appears
in the energy conditions, and the reproducing Poisson integral P α appears in the Aα
2 condition. These two
kernels coincide in dimension n = 1 for the case α = 0 corresponding to the Hilbert transform.

Now we turn to a precise description of our main two weight theorem.

2. Statements of results

quasi-notions.

Assumption: We ﬁx once and for all a globally biLipschitz map Ω : Rn → Rn for use in all of our
We will prove a two weight inequality for standard α-fractional Calder´on-Zygmund operators T α in
Euclidean space Rn, where we assume the n-dimensional Aα
2 conditions,
In particular, we show that for
and certain α-quasienergy conditions as side conditions on the weights.
positive locally ﬁnite Borel measures σ and ω in Rn, and assuming that both the quasienergy condition and
its dual hold, a strongly elliptic vector of standard α-fractional Calder´on-Zygmund operators Tα is bounded
from L2 (σ) to L2 (ω) if and only if the Aα
2 conditions hold (we assume a mild additional condition on the
quasicubes for this), the punctured Muckenhoupt conditions Aα,punct
hold, the quasicube testing conditions,
and the quasiweak boundedness property holds. In order to state our theorem precisely, we deﬁne these
terms in the following subsections.

2 conditions, new punctured Aα

2

Remark 1. It is possible to collect our various Muckenhoupt and quasienergy assumptions on the weight
pair (σ, ω) into just two compact side conditions of Muckenhoupt and quasienergy type. We prefer however,
to keep the individual conditions separate so that the interested reader can track their use below.
2.1. Standard fractional singular integrals and the norm inequality. Let 0 ≤ α < n. We deﬁne
a standard α-fractional CZ kernel K α(x, y) to be a function deﬁned on Rn × Rn satisfying the following
fractional size and smoothness conditions of order 1 + δ for some δ > 0,

(5)

|K α (x, y)| ≤ CCZ |x − y|α−n and |∇K α (x, y)| ≤ CCZ |x − y|α−n−1 ,

|∇K α (x, y) − ∇K α (x′, y)| ≤ CCZ(cid:18)|x − x′|
|x − y|(cid:19)δ

|x − y|α−n−1 ,

|x − x′|
|x − y| ≤

1
2

,

and the last inequality also holds for the adjoint kernel in which x and y are interchanged. We note that
a more general deﬁnition of kernel has only order of smoothness δ > 0, rather than 1 + δ, but the use of
the Monotonicity and Energy Lemmas below, which involve ﬁrst order Taylor approximations to the kernel
functions K α (·, y), requires order of smoothness more than 1.
2.1.1. Deﬁning the norm inequality. We now turn to a precise deﬁnition of the weighted norm inequality

σ fkL2(ω) ≤ NT α

σ kfkL2(σ) ,
of nonnegative functions on [0,∞) so that the truncated
δ,R (|x − y|) K α (x, y) are bounded with compact support for ﬁxed x or y. Then the

f ∈ L2 (σ) .

(6)

kT α
δ,Ro0<δ<R<∞
For this we introduce a family nηα
σ,δ,Rf (x) ≡ZRn

kernels K α
truncated operators

δ,R (x, y) = ηα

K α

T α

δ,R (x, y) f (y) dσ (y) ,

x ∈ Rn,

TWO WEIGHT BOUNDEDNESS

7

integral operator, which we typically denote by T α, suppressing the dependence on the truncations.

are pointwise well-deﬁned, and we will refer to the pair(cid:18)K α,nηα
Deﬁnition 3. We say that an α-fractional singular integral operator T α =(cid:18)K α,nηα

δ,Ro0<δ<R<∞(cid:19) as an α-fractional singular
δ,Ro0<δ<R<∞(cid:19) satisﬁes

the norm inequality (6) provided

(cid:13)(cid:13)T α
σ,δ,Rf(cid:13)(cid:13)L2(ω) ≤ NT α

σ kfkL2(σ) ,

f ∈ L2 (σ) , 0 < δ < R < ∞.

It turns out that, in the presence of Muckenhoupt conditions, the norm inequality (6) is essentially
independent of the choice of truncations used, and we now explain this in some detail. A smooth truncation
of T α has kernel ηδ,R (|x − y|) K α (x, y) for a smooth function ηδ,R compactly supported in (δ, R), 0 <
δ < R < ∞, and satisfying standard CZ estimates. A typical example of an α-fractional transform is the
α-fractional Riesz vector of operators

The Riesz transforms Rn,α
deﬁned by

ℓ

Rα,n = {Rα,n

ℓ

: 1 ≤ ℓ ≤ n} ,

0 ≤ α < n.

are convolution fractional singular integrals Rn,α

ℓ f ≡ K n,α

ℓ

∗ f with odd kernel

K α,n

ℓ

(w) ≡

wℓ

|w|n+1−α ≡

Ωℓ (w)

|w|n−α ,

w =(cid:0)w1, ..., wn(cid:1) .

ℓ

However, in dealing with energy considerations, it is more convenient to use the tangent line truncation
of the Riesz transform Rα,n
whose kernel is deﬁned to be Ωℓ (w) ψα
δ,R (|w|) where ψα
δ,R is continuously
diﬀerentiable on an interval (0, S) with 0 < δ < R < S, and where ψα
δ,R (r) = rα−n if δ ≤ r ≤ R, and has
constant derivative on both (0, δ) and (R, S) where ψα
δ,R (S) = 0. Here S is uniquely determined by R and
α. Finally we set ψα
δ,R (S) = 0 as well, so that the kernel vanishes on the diagonal and common point masses
do not ‘see’ each other. Note also that the tangent line extension of a C1,δ function on the line is again C1,δ
with no increase in the C1,δ norm.

It was shown in the one dimensional case with no common point masses in [LaSaShUr3], that boundedness
of the Hilbert transform H with one set of appropriate truncations together with the Aα
2 condition without
holes, is equivalent to boundedness of H with any other set of appropriate truncations. We need to extend
this to Rα,n and more general operators in higher dimensions and to permit common point masses, so that
we are free to use the tangent line truncations throughout the proof of our theorem. For this purpose, we
note that the diﬀerence between the tangent line truncated kernel Ωℓ (w) ψα
δ,R (|w|) and the corresponding
cutoﬀ kernel Ωℓ (w) 1[δ,R] |w|α−n satisﬁes (since both kernels vanish at the origin)

where the kernels Kρ (w) ≡ 1
(17) with constant controlled by the oﬀset Aα
for these two families of truncations now follows from the summability of the series P∞k=0 2−k(n−α) for

ρn−α 1[ρ,2ρ] (|w|) are easily seen to satisfy, uniformly in ρ, the norm inequality
2 condition (7) below. The equivalence of the norm inequality

0 ≤ α < n. The case of more general families of truncations and operators is similar.
2.2. Quasicube testing conditions. The following ‘dual’ quasicube testing conditions are necessary for
the boundedness of T α from L2 (σ) to L2 (ω),

T2
T α ≡
(T∗T α)2 ≡

sup
Q∈ΩP n
sup
Q∈ΩP n

1

|Q|σZQ |T α (1Qσ)|2 ω < ∞,
|Q|ωZQ(cid:12)(cid:12)(T α)∗ (1Qω)(cid:12)(cid:12)2

1

σ < ∞,

and where we interpret the right sides as holding uniformly over all tangent line truncations of T α.

(cid:12)(cid:12)(cid:12)Ωℓ (w) ψα
δ,R (|w|) − Ωℓ (w) 1[δ,R] |w|α−n(cid:12)(cid:12)(cid:12)
2−k(n−α)n(cid:0)2−kδ(cid:1)α−n
∞Xk=0
∞Xk=0

1[2−k−1δ,2−kδ] (|w|)o +
∞Xk=1

2−k(n−α)K2−kδ (w) +

2−k(n−α)K2kR (w) ,

.

≡

∞Xk=1

2−k(n−α)n(cid:0)2kR(cid:1)α−n

1[2k−1R,2kR] (|w|)o

8

E.T. SAWYER, C.-Y. SHEN, AND I. URIARTE-TUERO

Remark 2. We alert the reader that the symbols Q, I, J, K will all be used to denote either cubes or qua-
sicubes, and the context will make clear which is the case. Throughout most of the proof of the main theorem
only quasicubes are considered.

2.3. Quasiweak boundedness property. The quasiweak boundedness property for T α with constant C
is given by

(cid:12)(cid:12)(cid:12)(cid:12)ZQ

T α (1Q′ σ) dω(cid:12)(cid:12)(cid:12)(cid:12) ≤ WBP T αq|Q|ω |Q′|σ,

C ≤ |Q|
|Q′|
and either Q ⊂ 3Q′ \ Q′ or Q′ ⊂ 3Q \ Q,

for all quasicubes Q, Q′ with

1

1
n

1

n ≤ C,

and where we interpret the left side above as holding uniformly over all tangent line trucations of T α. Note
that the quasiweak boundedness property is implied by either the tripled quasicube testing condition,

k13QTα (1Qσ)kL2(ω) ≤ Ttriple

Tα

k1QkL2(σ) ,

for all quasicubes Q in Rn,

or its dual deﬁned with σ and ω interchanged and the dual operator Tα,∗ in place of Tα. In turn, the tripled
quasicube testing condition can be obtained from the quasicube testing condition for the truncated weight
pairs (ω, 1Qσ).

2.4. Poisson integrals and Aα
an Ω-quasicube in Rn. Recall that |Q|
of µ on a quasicube Q are given by:

2 . Let µ be a locally ﬁnite positive Borel measure on Rn, and suppose Q is
n ≈ ℓ (Q) for a quasicube Q. The two α-fractional Poisson integrals

1

1

1
n

|Q|

Pα (Q, µ) ≡ ZRn
n + |x − xQ|(cid:17)n+1−α dµ (x) ,
(cid:16)|Q|
n + |x − xQ|(cid:17)2
P α (Q, µ) ≡ ZRn
(cid:16)|Q|

|Q|

n−α

1
n

1

dµ (x) ,

where we emphasize that |x − xQ| denotes Euclidean distance between x and xQ and |Q| denotes the Lebesgue
measure of the quasicube Q. We refer to Pα as the standard Poisson integral and to P α as the reproducing
Poisson integral. Let σ and ω be locally ﬁnite positive Borel measures on Rn, possibly having common point
masses, and suppose 0 ≤ α < n.
We say that the pair K, K′ in P n are neighbours if K and K′ live in a common dyadic grid and both
K ⊂ 3K′ \ K′ and K′ ⊂ 3K \ K, and we denote by N n the set of pairs (K, K′) in P n × P n that are
neighbours. Let

be the corresponding collection of neighbour pairs of quasicubes. Then we deﬁne the classical oﬀset Aα
2
constants by

ΩN n = {(ΩK, ΩK′) : (K, K′) ∈ N n}

(7)

Aα
2 (σ, ω) ≡

sup

(Q,Q′)∈ΩN n

|Q|σ
|Q|1− α

n

|Q′|ω
|Q|1− α

n

.

Since the cubes in P n are products of half open, half closed intervals [a, b), the neighbouring quasicubes
(Q, Q′) ∈ ΩN n are disjoint, and the common point masses of σ and ω do not simultaneously appear in each
factor.
2 constant using P α. The energy constants Eα introduced in the next

We now deﬁne the one-tailed Aα

subsection will use the standard Poisson integral Pα.

2 with holes taken over quasicubes with Aα

Note that these deﬁnitions are the analogues of the corresponding conditions with ‘holes’ introduced by
Hyt¨onen [Hyt] in dimension n = 1 - the supports of the measures 1Qc σ and 1Qω in the deﬁnition of Aα
2 are
disjoint, and so the common point masses of σ and ω do not appear simultaneously in each factor. Note
also that, unlike in [SaShUr5], where common point masses were not permitted, we can no longer assert the
equivalence of Aα
|Q|σ
2.4.1. Punctured Aα
|Q|1− α
fails to be ﬁnite when the measures σ and ω have a common point mass - simply let Q in the sup above
shrink to a common mass point. But there is a substitute that is quite similar in character that is motivated
by the fact that for large quasicubes Q, the sup above is problematic only if just one of the measures is
mostly a point mass when restricted to Q. The one-dimensional version of the condition we are about to
describe arose in Conjecture 1.12 of Lacey [Lac2], and it was pointed out in [Hyt2] that its necessity on
the line follows from the proof of Proposition 2.1 in [LaSaUr2]. We now extend this condition to higher
dimensions, where its necessity is more subtle.

2 conditions. As mentioned earlier, the classical Aα

2 characteristic supQ∈ΩQn

2 with holes taken over cubes.

|Q|ω
|Q|1− α

Borel measure µ, deﬁne

Given an at most countable set P = {pk}∞k=1 in Rn, a quasicube Q ∈ ΩP n, and a positive locally ﬁnite
where the supremum is actually achieved since Ppk∈Q∩P µ (pk) < ∞ as µ is locally ﬁnite. The quantity
µ (Q, P) is simply the eµ measure of Q whereeµ is the measure µ with its largest point mass in Q removed.
Given a locally ﬁnite measure pair (σ, ω), let P(σ,ω) = {pk}∞k=1 be the at most countable set of common

point masses of σ and ω. Then the weighted norm inequality (6) typically implies ﬁniteness of the following
punctured Muckenhoupt conditions:

µ (Q, P) ≡ |Q|µ − sup{µ (pk) : pk ∈ Q ∩ P} ,

n

n

Aα,punct

2

(σ, ω) ≡

Aα,∗,punct

2

(σ, ω) ≡

sup

Q∈ΩP n

sup
Q∈ΩP n

n

ω(cid:0)Q, P(σ,ω)(cid:1)
|Q|σ
|Q|1− α
|Q|1− α
σ(cid:0)Q, P(σ,ω)(cid:1)
|Q|ω
|Q|1− α
|Q|1− α

n

n

n

,

.

Deﬁnition 4. The one-tailed constants Aα

for the weight pair (σ, ω) are given by

TWO WEIGHT BOUNDEDNESS

9

Aα
2 ≡
Aα,∗2

≡

2 and Aα,∗2
Q∈ΩP n P α (Q, 1Qcσ)
sup
Q∈ΩP n P α (Q, 1Qcω)

sup

n

|Q|ω
|Q|1− α
|Q|σ
|Q|1− α

n

< ∞,

< ∞.

Lemma 1. Let Tα be an α-fractional singular integral operator as above, and suppose that there is a positive
constant C0 such that

Aα
2 (σ, ω) ≤ C0N2

Tα (σ, ω) ,

for all pairs (σ, ω) of positive locally ﬁnite measures having no common point masses. Now let σ and ω
be positive locally ﬁnite Borel measures on Rn and let P(σ,ω) be the possibly nonempty set of common point
masses. Then we have

Aα,punct

2

(σ, ω) + Aα,∗,punct

2

(σ, ω) ≤ 4C0N2

Tα (σ, ω) .

Proof. Fix a quasicube Q ∈ ΩP n. Suppose ﬁrst that P(σ,ω) ∩ Q = {pk}2N
{1, 2, ..., 2N} so that

k=1 is ﬁnite. Choose k1 ∈ N2N =

Then choose k2 ∈ N2N \ {k1} such that

σ (pk1 ) = max
k∈N2N

σ (pk) .

ω (pk2) = max

k∈N2N\{k1}

ω (pk) .

Repeat this procedure so that

σ(cid:0)pk2m+1(cid:1) =
ω(cid:0)pk2m+2(cid:1) =

max

k∈N2N\{k1,...k2m}

σ (pk) ,

max

k∈N2N\{k1,...k2m+1}

ω (pk) ,

k2m+1 ∈ N2N \ {k1, ...k2m} ,

k2m+2 ∈ N2N \ {k1, ...k2m+1} ,

10

E.T. SAWYER, C.-Y. SHEN, AND I. URIARTE-TUERO

for each m ≤ N − 1. It is now clear that both

N−1Xi=0

σ(cid:0)pk2i+1(cid:1) ≥

1
2

σ(cid:0)Q ∩ P(σ,ω)(cid:1) and

N−1Xi=0

ω(cid:0)pk2i+2(cid:1) ≥

1

2(cid:2)ω(cid:0)Q ∩ P(σ,ω)(cid:1) − ω (p1)(cid:3) .

Now deﬁne new measureseσ andeω by

N−1Xi=0

σ(cid:0)pk2i+2(cid:1) δpk2i+2

eσ ≡ 1Qσ −

so that

ω(cid:0)pk2i+1(cid:1) δpk2i+1

andeω = 1Qω −

N−1Xi=0
ω(cid:0)Q, P(σ,ω)(cid:1)

|Q|eσ ≥

1
2 |Q|σ and |Q|eω ≥

1
2

have

Noweσ and eω have no common point masses and NTα (σ, ω) is monotone in each measure separately, so we

|Q|σ
|Q|1− α

n ≤ 4Aα

2 (eσ,eω) ≤ 4C0N2

Tα (eσ,eω) ≤ 4C0N2

Tα (σ, ω) .

2

Thus Aα,punct
argument proves the general case. The dual inequality Aα,∗,punct
interchanging the measures σ and ω.

Tα (σ, ω) if the number of common point masses in Q is ﬁnite. A limiting
Tα (σ, ω) now follows upon
(cid:3)

(σ, ω) ≤ 4C0N2

2

ω(cid:0)Q, P(σ,ω)(cid:1)
|Q|1− α
(σ, ω) ≤ 4C0N2

n

Now we turn to the deﬁnition of a quasiHaar basis of L2 (µ).

2.5. A weighted quasiHaar basis. We will use a construction of a quasiHaar basis in Rn that is adapted
to a measure µ (c.f. [NTV2] for the nonquasi case). Given a dyadic quasicube Q ∈ ΩD, where D is a dyadic
grid of cubes from P n, let △µ
Q (µ) of
L2 (µ) that consists of linear combinations of the indicators of the children C (Q) of Q that have µ-mean zero
over Q:

Q denote orthogonal projection onto the ﬁnite dimensional subspace L2

L2

Q (µ) ≡
f = XQ′∈C(Q)
Qf (x) = 1Q0 (x)(cid:16)Eµ

△µ

aQ′ 1Q′ : aQ′ ∈ R,ZQ

f dµ = 0

.

Q0

f − Eµ

Q2

f(cid:17) ,

Then we have the important telescoping property for dyadic quasicubes Q1 ⊂ Q2:

(8)

1Q0 (x) XQ∈[Q1,Q2]

Q0 ∈ C (Q1) , f ∈ L2 (µ) .
Q oa∈Γn

of L2

basis for L2 (µ), with the understanding that we add the constant function 1 if µ is a ﬁnite measure. In
particular we have

We will at times ﬁnd it convenient to use a ﬁxed orthonormal basis nhµ,a
{0, 1}n \ {1} is a convenient index set with 1 = (1, 1, ..., 1). Thennhµ,a
Q oa∈Γn and Q∈ΩD
Q Eµ(cid:12)(cid:12)(cid:12)(cid:12)
≡ Xa∈Γn(cid:12)(cid:12)(cid:12)(cid:12)Df, hµ,a
(cid:12)(cid:12)(cid:12)bf (Q)(cid:12)(cid:12)(cid:12)

L2(µ) = XQ∈ΩD(cid:13)(cid:13)(cid:13)△µ
Qf(cid:13)(cid:13)(cid:13)

= XQ∈ΩD Xa∈Γn(cid:12)(cid:12)(cid:12)bf (Q)(cid:12)(cid:12)(cid:12)

where the measure is suppressed in the notation bf . Indeed, this follows from (8) and Lebesgue’s diﬀerentiation
theorem for quasicubes. We also record the following useful estimate. If I′ is any of the 2n ΩD-children of
I, and a ∈ Γn, then
(9)

Q (µ) where Γn ≡
is an orthonormal

kfk2

2

,

L2(µ)

1

2

2

2

.

,

|Eµ
I ′ hµ,a

I

| ≤qEµ

I ′ (hµ,a

I

)2 ≤

q|I′|µ

TWO WEIGHT BOUNDEDNESS

11

K ≡PJ ∈ΩD: J⊂K △µ
and kPµ

Kfk2

2.6. Good quasigrids and quasienergy conditions. Given a dyadic quasicube K ∈ ΩD and a positive
measure µ we deﬁne the quasiHaar projection Pµ

J on K by

2

J

Pµ

J iµ hµ,a

J iµ(cid:12)(cid:12)(cid:12)
L2(µ) = XJ ∈ΩD: J⊂K Xa∈Γn(cid:12)(cid:12)(cid:12)hf, hµ,a

K f = XJ ∈ΩD: J⊂K Xa∈Γn
and where a quasiHaar basis {hµ,a
quasiHaar basis above.

hf, hµ,a
J }a∈Γn and J∈ΩDΩ was deﬁned in the previous subsection on a weighted
Now we deﬁne various notions for quasicubes which are inherited from the same notions for cubes. The
main objective here is to use the familiar notation that one uses for cubes, but now extended to Ω-quasicubes.
We have already introduced the notions of quasigrids ΩD, and center, sidelength and dyadic associated to
quasicubes Q ∈ ΩD, as well as quasiHaar functions, and we will continue to extend to quasicubes the
additional familiar notions related to cubes as we come across them. We begin with the notion of good. Fix
a quasigrid ΩD. We say that a dyadic quasicube J is (r, ε)-deeply embedded in a (not necessarily dyadic)
quasicube K, or simply r-deeply embedded in K, which we write as J ⋐r K, when J ⊂ K and both
(10)

,

ℓ (J) ≤ 2−rℓ (K) ,

qdist (J, ∂K) ≥

ℓ (J)ε ℓ (K)1−ε ,

1
2

where we deﬁne the quasidistance qdist (E, F ) between two sets E and F to be the Euclidean distance

1
n . For the most part we will consider J ⋐r K when J and K belong to a common

dist(cid:0)Ω−1E, Ω−1F(cid:1) between the preimages Ω−1E and Ω−1F of E and F under the map Ω, and where we

recall that ℓ (J) ≈ |J|
quasigrid ΩD, but an exception is made when deﬁning the reﬁned and xreﬁned energy constants below.
Deﬁnition 5. Let r ∈ N and 0 < ε < 1. Fix a quasigrid ΩD. A dyadic quasicube J is (r, ε)-good, or simply
good, if for every dyadic superquasicube I, it is the case that either J has side length at least 2−r times
that of I, or J ⋐r I is (r, ε)-deeply embedded in I.

Note that this deﬁnition simply asserts that a dyadic quasicube J = ΩJ′ is (r, ε)-good if and only if the

cube J′ is (r, ε)-good in the usual sense. Finally, we say that J is r-nearby in K when J ⊂ K and

ℓ (J) > 2−rℓ (K) .

The parameters r, ε will be ﬁxed suﬃciently large and small respectively later in the proof, and we denote
the set of such good dyadic quasicubes by ΩDgood.
Throughout the proof, it will be convenient to also consider pairs of quasicubes J, K where J is ρ-deeply
embedded in K, written J ⋐ρ K and meaning (10) holds with the same ε > 0 but with ρ in place of r; as
well as pairs of quasicubes J, K where J is ρ-nearby in K, ℓ (J) > 2−ρℓ (K), for a parameter ρ ≫ r that
will be ﬁxed later. We deﬁne the smaller ‘good’ quasiHaar projection Pgood,ω
by
J iµ hµ,a
J ,

hf, hµ,a

Pgood,µ

K

K

f ≡ XJ ∈G(K)

J f = XJ ∈G(K) Xa∈Γn
△µ

where G (K) consists of the good subcubes of K:

and also the not quite as small ‘subgood’ quasiHaar projection Psubgood,µ

G (K) ≡ {J ∈ ΩDgood : J ⊂ K} ,

K

J ′f = XJ ∈Mgood (K) XJ ′⊂J Xa∈Γn
△µ

by
hf, hµ,a

J ′ iµ hµ,a
J ′ ,

where Mgood (K) consists of the maximal good subcubes of K. We thus have

K

(cid:13)(cid:13)(cid:13)Pgood,µ

2

K

Psubgood,µ

f ≡ XJ ∈Mgood (K) XJ ′⊂J
x(cid:13)(cid:13)(cid:13)
L2(µ) ≤ (cid:13)(cid:13)(cid:13)Psubgood,µ
x(cid:13)(cid:13)(cid:13)
L2(µ) =ZI(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

≤ kPµ

I xk2

K

2

L2(µ)

where Pµ
of ⊕n

I x is the orthogonal projection of the identity function x : Rn → Rn onto the vector-valued subspace

k=1L2 (µ) consisting of functions supported in I with µ-mean value zero.

x −  1
|I|µZI

xdµ!(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

2

dµ (x) ,

x = (x1, ..., xn) ,

12

E.T. SAWYER, C.-Y. SHEN, AND I. URIARTE-TUERO

At this point we emphasize that in the setting of quasicubes we continue to use the linear function x and
not the pushforward of x by Ω. The reason of course is that the quasienergy deﬁned below is used to capture
the ﬁrst order information in the Taylor expansion of a singular kernel.

Recall that in dimension n = 1, and for α = 0, the energy condition constant was deﬁned by

E 2 ≡ sup
I= ˙∪Ir

1
|I|σ

∞Xr=1(cid:18) Pα (Ir, 1I σ)

|Ir|

(cid:19)2(cid:13)(cid:13)Pω

Ir

x(cid:13)(cid:13)2

L2(ω) ,

where I, Ir and J are intervals in the real line. The extension of the energy conditions to higher dimensions
in [SaShUr7] used the collection

of maximal r-deeply embedded dyadic subquasicubes of a quasicube K (a subquasicube J of K is a dyadic
subquasicube of K if J ∈ ΩD when ΩD is a dyadic quasigrid containing K). We let J∗ = γJ where γ ≥ 2.
Then the goodness parameter r is chosen large, depending on ε and γ, so that the bounded overlap property

Mr−deep (K) ≡ {maximal J ⋐r K}

XJ∈Mr−deep(K)

1J ∗ ≤ β1K ,

(11)

(12)

holds for some positive constant β depending only on n, γ, r and ε (see e.g. [SaShUr7]).

In [SaShUr7] and [SaShUr5], for a ﬁxed a dyadic quasigrid ΩD, we also deﬁned a reﬁnement and extension
of the collection Mr−deep (K) for certain K and each ℓ ≥ 1. We say that a quasicube K (not necessarily
in ΩD) is a shifted ΩD-quasicube if it is a union of 2n ΩD-quasicubes K′ with side length ℓ (K′) = 1
2 ℓ (K).
Thus for any ΩD-quasicube L there are exactly 2n shifted ΩD-quasicubes of twice the side length that
contain L, and one of them is of course the ΩD-parent of L. We denote the collection of shifted ΩD-
quasicubes by SΩD. For a shifted quasicube K ∈ SΩD, deﬁne Mr−deep,ΩD (K) to consist of the maximal
r-deeply embedded ΩD-dyadic subquasicubes J of K. (In the special case that K itself belongs to ΩD, then
Mr−deep,ΩD (K) = Mr−deep (K).) Then in [SaShUr5] for ℓ ≥ 1 we deﬁned the reﬁnement

r−deep,ΩD (K) ≡ (cid:8)J ∈ Mr−deep,ΩD(cid:0)πℓK′(cid:1) for some K′ ∈ CΩD (K) :
Mℓ

J ⊂ L for some L ∈ Mr−deep (K)} ,

where CΩD (K) is the obvious extension to shifted quasicubes of the set of ΩD-dyadic children. Thus
Mℓ
happen to be contained in some L ∈ Mr−deep,ΩD (K). Since J ∈ Mℓ
r−deep,ΩD (K) implies γJ ⊂ K, we also
have from (11) that

r−deep,ΩD (K) is the union, over all quasichildren K′ of K, of those quasicubes in Mr−deep(cid:0)πℓK′(cid:1) that

XJ∈M(ℓ)

r−deep,ΩD (K)

1J ∗ ≤ β1K ,

for each ℓ ≥ 0.

Of course M1
K the larger ℓ is, and may in fact be empty.

r−deep,ΩD (K) ⊃ Mr−deep (K), but Mℓ

r−deep,ΩD (K) is in general a ﬁner subdecomposition of

Now we proceed to recall the deﬁnition of various quasienergy conditions from [SaShUr5].

Deﬁnition 6. Suppose σ and ω are positive Borel measures on Rn without common point masses, and ﬁx
γ ≥ 2. Then the deep quasienergy condition constant E deep
and the reﬁned quasienergy condition constant
E reﬁned

are given by

α

α

α

(cid:0)E deep
(cid:0)E reﬁned

α

(cid:1)2
(cid:1)2

≡ sup
I= ˙∪Ir

1
|I|σ

∞Xr=1 XJ∈Mr−deep(Ir)  Pα(cid:0)J, 1I\γJ σ(cid:1)

|J|

1
n

≡ sup
ΩD

sup
I∈SΩD

sup
ℓ≥0

1
|I|σ

r−deep,ΩD (I)  Pα(cid:0)J, 1I\γJ σ(cid:1)
XJ∈Mℓ

|J|

L2(ω)

2

J

!2(cid:13)(cid:13)(cid:13)Psubgood,ω

x(cid:13)(cid:13)(cid:13)
!2(cid:13)(cid:13)(cid:13)Psubgood,ω

1
n

J

,

x(cid:13)(cid:13)(cid:13)

2

L2(ω)

,

where supΩD supI in the second line is taken over all quasigrids ΩD and shifted quasicubes I ∈ SΩD, and
supI= ˙∪Ir in the ﬁrst line is taken over

(1) all dyadic quasigrids ΩD,
(2) all ΩD-dyadic quasicubes I,

(3) and all subpartitions {Ir}N or ∞

r=1

of the quasicube I into ΩD-dyadic subquasicubes Ir.

TWO WEIGHT BOUNDEDNESS

13

When σ and ω are permitted to have common point masses, as in this paper, we continue to use the
deﬁnition above for the deep energy E deep
since the supports of σ and ω are disjoint in each Poisson/energy
product. On the other hand we introduce a further generalization E xreﬁned
to replace the reﬁned energy
E reﬁned
that we need here in our proof where common point masses of σ and ω are permitted. Recall that
a quasicube J ∈ ΩP n is (r, ε)-deeply embedded in a quasicube K ∈ ΩP n, or simply r-deeply embedded in K,
2 ℓ (J)ε ℓ (K)1−ε.
which we write as J ⋐r K, when J ⊂ K and both ℓ (J) ≤ 2−rℓ (K) and qdist (J, ∂K) ≥ 1
Now given K ∈ SΩD and F ∈ ΩP n with ℓ (F ) ≥ ℓ (K), deﬁne

α

α

α

MF

r−deep,ΩD (K) ≡ {maximal J ∈ ΩD : J ⋐r K and J ⋐r F} ,

and

α

(cid:0)E xreﬁned

(cid:1)2

≡ sup
ΩD

sup
I∈SΩD

sup

F∈ΩP n: ℓ(F )≥ℓ(I)

1
|I|σ

r−deep,ΩD(I)  Pα(cid:0)J, 1I\γJ σ(cid:1)
XJ∈MF

|J|

1
n

2

!2(cid:13)(cid:13)(cid:13)Psubgood,ω

J

x(cid:13)(cid:13)(cid:13)

.

L2(ω)

The important diﬀerence here is that the quasicube F is permitted to lie outside the quasigrid ΩD containing
the children of the shifted quasicube I ∈ SΩD. Similarly we have a dual version of E xreﬁned
. Finally we
deﬁne

α

(Eα)2 ≡(cid:0)E deep

α

(cid:1)2

+(cid:0)E xreﬁned

α

(cid:1)2

,

and similarly for the dual energy constant E∗α, obtained by interchanging σ and ω.
Remark 3. The xreﬁned quasienergy condition appears in only one place in this paper, namely in the right
hand side of the estimate (52) in Lemma 14 below.

We include diﬀerent grids for I and F in the xreﬁned energy here because we will be forced to use more

than one grid in applying the bilinear inequality of Hyt¨onen in our treatment of functional energy below.

Note that in the reﬁned and xreﬁned quasienergy conditions there is no outer decomposition I = ˙∪Ir.
These deﬁnitions of the quasienergy conditions depend on the choice of γ and the goodness parameters r
and

and ε. Note that we can ‘partially’ plug the γ-hole in the Poisson integral Pα(cid:0)J, 1I\γJ σ(cid:1) for both E deep

2 condition and the bounded overlap property (12). Indeed, deﬁne

using the oﬀset Aα

α

α

E xreﬁned
(13)

α

(cid:0)E deep partial
(cid:1)2
(cid:0)E xreﬁned partial

α

≡ sup
I= ˙∪Ir

1
|I|σ

sup

I

≡ sup
ΩD

(cid:1)2
(cid:0)E deep partial

α

(cid:1)2

1
n

sup

|J|

∞Xr=1 XJ∈Mr−deep(Ir )  Pα(cid:0)J, 1I\J σ(cid:1)
XJ∈MF
2 and (cid:0)E reﬁned partial

F∈ΩP n: ℓ(F )≥2ℓ(I)

1
|I|σ

.(cid:0)E deep

+ βAα

(cid:1)2

α

α

r−deep(I),ΩD

,

L2(ω)

2

J

!2(cid:13)(cid:13)(cid:13)Psubgood,ω
x(cid:13)(cid:13)(cid:13)
  Pα(cid:0)J, 1I\J σ(cid:1)

1
n

|J|

(cid:1)2

.(cid:0)E xreﬁned

α

(cid:1)2

+ βAα

2 ,

!2(cid:13)(cid:13)(cid:13)Psubgood,ω

J

x(cid:13)(cid:13)(cid:13)

2

L2(ω)

.

(14)

by (11) and (12) respectively.

Then by a standard argument as in [SaShUr6], we have both

1

Notation 2. As above, we will typically use the side length ℓ (J) of a Ω-quasicube when we are describing
collections of quasicubes, and when we want ℓ (J) to be a dyadic or related number; while in estimates we will
typically use |J|
n ≈ ℓ (J), and when we want to compare powers of volumes of quasicubes. We will continue
to use the preﬁx ‘quasi’ when discussing quasicubes, quasiHaar, quasienergy and quasidistance in the text, but
will not use the preﬁx ‘quasi’ when discussing other notions. In particular, since quasiAα
≈
2 +Aα,punct
Aα
(see e.g. [SaShUr8] for a proof ) we do not use quasi as a preﬁx for the Muckenhoupt conditions,
even though quasiAα
2 . Finally, we will not modify any mathematical symbols

to reﬂect quasinotions, except for using ΩD to denote a quasigrid, and qdist (E, F ) ≡ dist(cid:0)Ω−1E, Ω−1F(cid:1) to
denote quasidistance between sets E and F , and using |x − y|qdist ≡(cid:12)(cid:12)Ω−1x − Ω−1y(cid:12)(cid:12) to denote quasidistance

between points x and y. This limited use of quasi in the text serves mainly to remind the reader we are
working entirely in the ‘quasiworld’.

2 alone is not comparable toAα

2 + quasi Aα,punct

2

2

14

E.T. SAWYER, C.-Y. SHEN, AND I. URIARTE-TUERO

2.6.1. Plugged quasienergy conditions. We now use the punctured conditions Aα,punct

control the plugged quasienergy conditions, where the hole in the argument of the Poisson term Pα(cid:0)J, 1I\J σ(cid:1)

in the partially plugged quasienergy conditions above, is replaced with the ‘plugged’ term Pα (J, 1I σ). The
resulting plugged quasienergy condition constants will be denoted by

and Aα,∗,punct

to

2

2

E deep plug

α

,E reﬁned plug

α

,E xreﬁned plug

α

and Eα ≡ E deep plug

α

+ E xreﬁned plug

α

,

for example

α

(cid:0)E deep plug

(cid:1)2

≡ sup
I= ˙∪Ir

1
|I|σ

∞Xr=1 XJ∈Mr−deep(Ir )  Pα (J, 1I σ)

|J|

1
n

We ﬁrst show that the punctured Muckenhoupt conditions Aα,punct

the ‘energy Aα

2 conditions’, denoted Aα,energy

2

and Aα,∗,energy

2

!2(cid:13)(cid:13)(cid:13)Psubgood,ω

J

x(cid:13)(cid:13)(cid:13)

and Aα,∗,punct

2

2

L2(ω)

.

control respectively

(15)

Aα,energy

2

(σ, ω) ≡

Q∈ΩP n(cid:13)(cid:13)(cid:13)Pω

sup

2

where

n

x

2

Q

ℓ(Q)(cid:13)(cid:13)(cid:13)
n (cid:13)(cid:13)(cid:13)Pσ

|Q|1− α
|Q|ω
|Q|1− α

Q

L2(ω)

|Q|σ
|Q|1− α

n

L2(σ)

,

.

2

x

ℓ(Q)(cid:13)(cid:13)(cid:13)

|Q|1− α

n

Aα,∗,energy

2

(σ, ω) ≡

sup

Q∈ΩP n

Lemma 2. For any positive locally ﬁnite Borel measures σ, ω we have
(σ, ω) ≤ max{n, 3} Aα,punct
(σ, ω) ≤ max{n, 3} Aα,∗,punct

Aα,energy
Aα,∗,energy

2

2

2

2

(σ, ω) ,

(σ, ω) .

x

2

Q

L2(ω)

2 |Q|ω, then we trivially have

Proof. Fix a quasicube Q ∈ ΩD. If ω(cid:0)Q, P(σ,ω)(cid:1) ≥ 1
n ≤ n |Q|ω
|Q|1− α

ℓ(Q)(cid:13)(cid:13)(cid:13)

(cid:13)(cid:13)(cid:13)Pω

|Q|1− α

|Q|σ
|Q|1− α
2 |Q|ω then there is a point p ∈ Q ∩ P(σ,ω) such that

n ≤ 2nAα,punct

|Q|σ
|Q|1− α

On the other hand, if ω(cid:0)Q, P(σ,ω)(cid:1) < 1
and consequently, p is the largest ω-point mass in Q. Thus if we deﬁne eω = ω − ω ({p}) δp, then we have

1
2 |Q|ω ,

ω ({p}) >

(σ, ω) .

2

n

n

ω(cid:0)Q, P(σ,ω)(cid:1) = |Q|eω .

Now we observe from the construction of Haar projections that

△eω
J = △ω
J ,

for all J ∈ ΩD with p /∈ J.

So for each s ≥ 0 there is a unique quasicube Js ∈ ΩD with ℓ (Js) = 2−sℓ (Q) that contains the point p. For
this quasicube we have, if {hω,a

is a basis for L2 (ω),

J }J∈ΩD, a∈Γn

Thus we can estimate

Js

(cid:13)(cid:13)△ω

Q

(cid:13)(cid:13)(cid:13)(cid:13)Pω

2

2

Js

hω,a
Js

L2(ω) k1Js (x − p)k2

= Xa∈Γn(cid:12)(cid:12)(cid:12)(cid:12)ZJs
, x − p(cid:11)ω(cid:12)(cid:12)(cid:12)
L2(ω) = Xa∈Γn(cid:12)(cid:12)(cid:12)(cid:10)hω,a
x(cid:13)(cid:13)2
≤ Xa∈Γn(cid:13)(cid:13)hω,a
Js (cid:13)(cid:13)2
ℓ (Q)2 XJ∈ΩD: p /∈J⊂Q(cid:13)(cid:13)(cid:13)△eω
J x(cid:13)(cid:13)(cid:13)
ℓ (Q)2 ℓ (Q)2 |Q|eω +
2−2sℓ (Q)2 |Q|eω! ≤ 3 |Q|eω ≤ 3ω(cid:0)Q, P(σ,ω)(cid:1) ,
∞Xs=0

(x) (x − p) deω (x)(cid:12)(cid:12)(cid:12)(cid:12)
L2(ω)
x(cid:13)(cid:13)2

L2(eω) ≤ n2nℓ (Js)2 |Js|eω ≤ 2−2sℓ (Q)2 |Q|eω .

∞Xs=0(cid:13)(cid:13)△ω

ℓ (Q)(cid:13)(cid:13)(cid:13)(cid:13)

L2(eω)

L2(ω)

≤

+

=

Js

x

1

1

2

2

TWO WEIGHT BOUNDEDNESS

15

and so

2

(cid:13)(cid:13)(cid:13)Pω

x

ℓ(Q)(cid:13)(cid:13)(cid:13)

Q

3ω(cid:0)Q, P(σ,ω)(cid:1)
|Q|1− α
Now take the supremum over Q ∈ ΩD to obtain Aα,energy
inequality follows upon interchanging the measures σ and ω.

|Q|σ
|Q|1− α

|Q|1− α

n ≤

L2(ω)

2

n

n

2

n ≤ 3Aα,punct

|Q|σ
|Q|1− α
(σ, ω) ≤ max{n, 3} Aα,punct

(σ, ω) .

2

(σ, ω). The dual
(cid:3)

The next corollary follows immediately from Lemma 2. Deﬁne

Corollary 1.

α

α

E deep plug
E reﬁned plug
E xreﬁned plug
E plug

α

α

=(cid:0)E deep plug

α

(cid:1)2

α

(cid:1)2

(cid:0)E plug
. E deep partial
. E reﬁned partial
. E xreﬁned partial
. Eα + Aα

α

α

α

2 + Aα,punct

2

.

.

(cid:1)2

α

+(cid:0)E xreﬁned plug
. E deep
α + Aα
. E reﬁned
. E xreﬁned

α

α

+ Aα,punct

2

2

+ Aα,punct
+ Aα,punct

2

,

2 + Aα,punct
+ Aα

2

2 + Aα,punct

,
2 + Aα,punct

2

2

+ Aα

,

and similarly for the dual plugged quasienergy conditions.
2.6.2. One-tailed Aα,energy plug
tions:

2

conditions. Using Lemma 2 we can control the ‘plugged’ energy Aα

2 condi-

Aα,energy plug

2

(σ, ω) ≡

Aα,∗,energy plug

2

(σ, ω) ≡

L2(ω)

x

2

Q

sup

Q∈ΩP n(cid:13)(cid:13)(cid:13)Pω
ℓ(Q)(cid:13)(cid:13)(cid:13)
Q∈ΩP n P α (Q, ω)(cid:13)(cid:13)(cid:13)Pσ

|Q|1− α

sup

n

Q

P α (Q, σ) ,

2

x

ℓ(Q)(cid:13)(cid:13)(cid:13)

|Q|1− α

n

L2(σ)

.

Lemma 3. We have

Proof. We have

2

Aα,energy plug
Aα,∗,energy plug

2

2 (σ, ω) + Aα,energy

2

(σ, ω) ,

(σ, ω) . Aα
(σ, ω) . Aα,∗2

2

L2(ω)

n

x

x

2

Q

Q

L2(ω)

(cid:13)(cid:13)(cid:13)Pω

P α (Q, σ) = (cid:13)(cid:13)(cid:13)Pω
ℓ(Q)(cid:13)(cid:13)(cid:13)
ℓ(Q)(cid:13)(cid:13)(cid:13)
n P α (Q, 1Qcσ) +(cid:13)(cid:13)(cid:13)Pω
ℓ(Q)(cid:13)(cid:13)(cid:13)

|Q|1− α
|Q|ω
|Q|1− α

|Q|1− α

|Q|1− α

L2(ω)

Q

2

x

n

n

.

(σ, ω) + Aα,∗,energy

2

(σ, ω) .

P α (Q, 1Qcσ) +(cid:13)(cid:13)(cid:13)Pω

Q

2

x

ℓ(Q)(cid:13)(cid:13)(cid:13)

|Q|1− α

n

L2(ω)

P α (Q, 1Qσ)

|Q|σ
|Q|1− α

n

. Aα

2 (σ, ω) + Aα,energy

2

(σ, ω) .

(cid:3)

Note on restricting quasigrids: In our proof of the main theorem below, we will restrict consider-
ation to only those dyadic quasigrids for which no boundary of a dyadic quasicube is charged by
either σ or ω. Indeed, with probability 1, a random grid has the above property. This will apply
to the quasigrids in which our Haar expansions live, as well as to the associated ‘tripled grids’ that
arise in the proof of the functional energy condition below.

16

E.T. SAWYER, C.-Y. SHEN, AND I. URIARTE-TUERO

2.7. Statement of the Theorems. We can now state our main quasicube two weight theorem for general
measures allowing common point masses, as well as our application to energy dispersed measures. Recall
that Ω : Rn → Rn is a globally biLipschitz map, and that ΩP n denotes the collection of all quasicubes in Rn
whose preimages under Ω are usual cubes with sides parallel to the coordinate axes. Denote by ΩD ⊂ ΩP n
a dyadic quasigrid in Rn. For the purpose of obtaining necessity of Aα
2 ≤ α < n, we adapt the notion
of strong ellipticity from [SaShUr7].

2 for n

be a vector of singular integral operators
. We say that Tα is strongly elliptic with respect to Ω if for each m ∈

j=1

j=1

j (cid:9)J
Deﬁnition 7. Fix a globally biLipschitz map Ω. Let Tα =(cid:8)T α
j(cid:9)J
with standard kernels (cid:8)K α
{1,−1}n, there is a sequence of coeﬃcients(cid:8)λm
j (cid:9)J
j (x, x + tu)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

holds for all unit vectors u in the quasi-n-ant ΩVm where

≥ ctα−n,

JXj=1

such that

λm
j K α

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

(16)

j=1

t ∈ R,

i.e.

(17)

Vm = {x ∈ Rn : mixi > 0 for 1 ≤ i ≤ n} ,

m ∈ {1,−1}n .

Theorem 1. Suppose that T α is a standard α-fractional singular integral operator on Rn, and that ω and
σ are positive Borel measures on Rn (possibly having common point masses). Set T α
σ f = T α (f σ) for any
smooth truncation of T α

σ . Let Ω : Rn → Rn be a globally biLipschitz map.
(1) Suppose 0 ≤ α < n and that γ ≥ 2 is given. Then the operator T α

σ is bounded from L2 (σ) to L2 (ω),

uniformly in smooth truncations of T α, and moreover

kT α

σ fkL2(ω) ≤ NT α

σ kfkL2(σ) ,

NT α

σ ≤ Cα(cid:18)qAα

2 + Aα,∗2 + Aα,punct

2

+ Aα,∗,punct

2

+ TT α + T∗T α + Eα + E∗α + WBPT α(cid:19) ,

provided that the two dual Aα
2 conditions and the two dual punctured Muckenhoupt conditions all
hold, and the two dual quasitesting conditions for T α hold, the quasiweak boundedness property for
T α holds for a suﬃciently large constant C depending on the goodness parameter r, and provided
that the two dual quasienergy conditions Eα + E∗α < ∞ hold uniformly over all dyadic quasigrids
ΩD ⊂ ΩP n, and where the goodness parameters r and ε implicit in the deﬁnition of Mℓ
r−deep,ΩD (K)
are ﬁxed suﬃciently large and small respectively depending on n, α and γ.
j(cid:9)J
(2) Conversely, suppose 0 ≤ α < n and that Tα =(cid:8)T α
j(cid:9)J
with standard kernels (cid:8)K α
. In the range 0 ≤ α < n
j (x, x + tu)(cid:12)(cid:12) ≥ ctα−n,
(cid:12)(cid:12)K α
f(cid:13)(cid:13)(cid:13)L2(ω) ≤ NT α
(cid:13)(cid:13)(cid:13)(cid:0)T α
j (cid:1)σ

2 ≤ α < n, we assume the strong ellipticity condition in Deﬁnition 7 above. Further-

For the range n
more, assume that each operator T α
j

2 conditions (with ‘holes’) hold as well as the punctured Muckenhoupt condi-

([SaShUr7]): there is c > 0 such that for each unit vector u there is j satisfying

2 , we assume the ellipticity condition from

is a vector of Calder´on-Zygmund operators

is bounded from L2 (σ) to L2 (ω),

j kfkL2(σ) .

t ∈ R.

j=1

j=1

Then the fractional Aα
tions, and moreover,

(18)

qAα
2 + Aα,∗2 + Aα,punct

2

+ Aα,∗,punct

2

≤ CNTα .

Problem 1. Given any strongly elliptic vector Tα of classical α-fractional Calder´on-Zygmund operators, it
is an open question whether or not the usual (quasi or not) energy conditions are necessary for boundedness
of Tα. See [SaShUr4] for a failure of energy reversal in higher dimensions - such an energy reversal was
used in dimension n = 1 to prove the necessity of the energy condition for the Hilbert transform, and also in
[SaShUr3] and [LaSaShUrWi] for the Riesz transforms and Cauchy transforms respectively when one of the
measures is supported on a line, and in [SaShUr8] when one of the measures is supported on a C1,δ curve.

TWO WEIGHT BOUNDEDNESS

17

Remark 4. If Deﬁnition 7 holds for some Tα and Ω, then Ω must be fairly tame, in particular the logarithmic
spirals in Example 1 are ruled out! On the other hand, the vector of Riesz transforms Rα,n is easily seen to be
strongly elliptic with respect to Ω if Ω satisﬁes the following sector separation property. Given a hyperplane
H and a perpendicular line L intersecting at point P , there exist spherical cones SH and SL intersecting
only at the point P ′ = Ω (P ), such that H′ ≡ ΩH ⊂ SH and L′ ≡ ΩL ⊂ SL and

dist (x, ∂SH ) ≈ |x| , x ∈ H and dist (x, ∂SL) ≈ |x| , x ∈ L .

Examples of globally biLipshcitz maps Ω that satisfy the sector separation property include ﬁnite compositions
of maps of the form

where ψ : R → Rn−1 is a Lipschitz map with suﬃciently small Lipschitz constant.

Ω (x1, x′) = (x1, x′ + ψ (x1)) ,

(x1, x′) ∈ Rn,

In order to state our application to energy dispersed measures, we introduce some notation and a deﬁnition.
k the collection of all

Fix a globally biLipschitz map Ω : Rn → Rn. For 0 ≤ k ≤ n − 1, denote by Ln
k-dimensional planes in Rn. If in addition J is an Ω-quasicube in Rn, denote by M n

k (J, µ) the moments

and note that Mn

0 (J, µ) is related to the energy E (J, µ):

k (J, µ)2 ≡ inf
Mn
L∈Ln
0 (J, µ)2 =ZJ |x − Eµ

Mn

dist (x, L)2 dµ (x) ,

kZJ
J x|2 dµ (x) = |J|µ |J|

2

n E (J, µ)2 .

Clearly the moments decrease in k and we now give a name to various reversals of this decrease.
Deﬁnition 8. Suppose µ is a locally ﬁnite Borel measure on Rn, and let k be an integer satisfying 0 ≤ k ≤
n− 1. We say that µ is k-energy dispersed if there is a positive constant C such that for all Ω-quasicubes J,

Mn
0 (J, µ) ≤ CMn

k (J, µ) .

If both σ and ω are appropriately energy dispersed relative to the order 0 ≤ α < n, then the T 1 theorem

holds for the α-fractional Riesz vector transform Rα,n.
Theorem 2. Let 0 ≤ α < n and 0 ≤ k ≤ n − 1 sastisfy

(cid:26) n − k < α < n, α 6= n − 1

0 ≤ α < n, α 6= 1, n − 1

if
if

1 ≤ k ≤ n − 2

k = n − 1

.

Suppose that Rα,n is the α-fractional Riesz vector transform on Rn, and that ω and σ are k-energy dispersed
locally ﬁnite positive Borel measures on Rn (possibly having common point masses). Set Rα,n
(f σ)
for any smooth truncation of Rα,n. Let Ω : Rn → Rn be a globally biLipschitz map. Then the operator Rα,n
is bounded from L2 (σ) to L2 (ω), i.e.

σ f = Rα,n

σ

σ

kT α

σ fkL2(ω) ≤ NRα

σ kfkL2(σ) ,

uniformly in smooth truncations of Rα,n, if and only if the Muckenhoupt conditions hold, the testing condi-
tions hold and the weak boundedness property holds. Moreover, we have the equivalence

NRα,n

σ ≈qAα

2 + Aα,∗2 + Aα,punct

2

+ Aα,∗,punct

2

+ TRα,n + T∗Rα,n + WBP Rα,n .

The case k = n − 1 of k-energy dispersed is similar to the notion of uniformly full dimension introduced

by Lacey and Wick in [LaWi, versions 2 and 3].

3. Proof of Theorem 1

We now give the proof of Theorem 1 in the following sections. Using the analogue for dyadic quasigrids of
the good random grids of Nazarov, Treil and Volberg, a standard argument of NTV, see e.g. [Vol], reduces
the two weight inequality (17) for T α to proving boundedness of a bilinear form T α (f, g) with uniform
and g are contained in the collection ΩDgood of good quasicubes, whose children are all good as well, with
goodness parameters r < ∞ and ε > 0 chosen suﬃciently large and small respectively. Here the quasiHaar

constants over dyadic quasigrids, and where the quasiHaar supports suppbf and suppbg of the functions f
support of f is suppbf ≡ {I ∈ ΩD : △σ

I f 6= 0}, and similarly for g.

18

E.T. SAWYER, C.-Y. SHEN, AND I. URIARTE-TUERO

(19)

ΩDτ

contained in the collection of τ -good quasicubes

In fact we can assume even more, namely that the quasiHaar supports suppbf and suppbg of f and g are

(r,ε)−good ≡(cid:8)K ∈ ΩD : CK ⊂ ΩD(r,ε)−good and πℓ

ΩDK ∈ ΩD(r,ε)−good for all 0 ≤ ℓ ≤ τ(cid:9) ,

that are (r, ε)-good and whose children are also (r, ε)-good, and whose ℓ-parents up to level τ are also (r, ε)-
good. Here τ > r is a parameter to be ﬁxed below. We may assume this restriction on the quasiHaar supports
of f and g by choosing (r, ε) appropriately and using the following elementary lemma. See [SaShUr7]) for a
proof.
Lemma 4. Given s ≥ 1, t ≥ 2 and 0 < ε < 1, we have

provided

ΩDs

(s+t,ε)−good ⊂ ΩD(t,δ)−good ,

sε < t (1 − ε) − 2 and δ = ε +

sε + 1

t

.

For convenience in notation we will sometimes suppress the dependence on α in our nonlinear forms,
but will retain it in the operators, Poisson integrals and constants. More precisely, let ΩDσ = ΩDω be an
(r, ε)-good quasigrid on Rn, and let {hσ,a
be corresponding quasiHaar
bases as described above, so that

I }I∈ΩDσ, a∈Γn

f = XI∈ΩDσ △σ
g = XJ∈ΩDω △ω

I f = XI∈ΩDσ, a∈Γn
hf, hσ,a
J g = XJ∈ΩDω, b∈ΓnDg, hω,b

I

andnhω,b
i hσ,a
J E hω,b

J oJ∈ΩDω, b∈Γn
I = XI∈ΩDσ, a∈Γn bf (I; a) hσ,a
J = XJ∈ΩDω, b∈Γnbg (J; b) hω,b

,

I

J ,

where the appropriate measure is understood in the notation bf (I; a) andbg (J; b), and where these quasiHaar
coeﬃcients bf (I; a) andbg (J; b) vanish if the quasicubes I and J are not good. Inequality (17) is equivalent

to boundedness of the bilinear form

T α (f, g) ≡ hT α

σ (△σ

I f ) ,△ω

J giω

on L2 (σ) × L2 (ω), i.e.
(20)

σ (f ) , giω =

XI∈ΩDσ and J∈ΩDω hT α
|T α (f, g)| ≤ NT α kfkL2(σ) kgkL2(ω) ,

uniformly over all quasigrids and approriate families of truncations. We may assume the two quasigrids
ΩDσ and ΩDω are equal here, and this we will do throughout the paper, with the notable exception that, in
controlling functional energy by Hytonen’s bilinear inequality below, we will need to introduce shifted grids.
We will also sometimes continue to use the measure as a superscript on ΩD for clarity of exposition. Roughly
speaking, we analyze the form T α (f, g) by splitting it in a nonlinear way into three main pieces, following in
part the approach in [LaSaShUr2] and [LaSaShUr3]. The ﬁrst piece consists of quasicubes I and J that are
either disjoint or of comparable side length, and this piece is handled using the section on preliminaries of
NTV type. The second piece consists of quasicubes I and J that overlap, but are ‘far apart’ in a nonlinear
way, and this piece is handled using the sections on the Intertwining Proposition and the control of the
functional quasienergy condition by the quasienergy condition. Finally, the remaining local piece where the
overlapping quasicubes are ‘close’ is handled by generalizing methods of NTV as in [LaSaShUr], and then
splitting the stopping form into two sublinear stopping forms, one of which is handled using techniques of
[LaSaUr2], and the other using the stopping time and recursion of M. Lacey [Lac]. See the schematic diagram
in Subsection 7.4 below.

4. Necessity of the Aα

2 conditions

Here we consider in particular the necessity of the fractional Aα

2 condition (with holes) when 0 ≤ α < n, for
the boundedness from L2 (σ) to L2 (ω) (where σ and ω may have common point masses) of the α-fractional
Riesz vector transform Rα deﬁned by

Rα (f σ) (x) =ZRn

K α

j (x, y)f (y) dσ (y) ,

K α

j (x, y) =

xj − yj
|x − y|n+1−α ,

TWO WEIGHT BOUNDEDNESS

19

j (x, y) satisﬁes (5) for 0 ≤ α < n. More generally, necessity holds for elliptic operators as in

whose kernel K α
the next lemma. See [SaShUr7] for the easier proof in the case without holes.
Lemma 5. Suppose 0 ≤ α < n. Let T α be any collection of operators with α-standard fractional kernel
satisfying the ellipticity condition (18), and in the case n
2 ≤ α < n, we also assume the more restrictive
condition (16). Then for 0 ≤ α < n we have

2 . Nα (T α) .

pAα

Proof. First we give the proof for the case when T α is the α-fractional Riesz transform Rα, whose kernel is
|x−y|n+1−α . Deﬁne the 2n generalized n-ants Qm for m ∈ {−1, 1}n, and their translates Qm (w)
Kα (x, y) =
for w ∈ Rn by

x−y

Qm = {(x1, ..., xn) : mkxk > 0} , Qm (w) = {z : z − w ∈ Qm} ,

w ∈ Rn.

Fix m ∈ {−1, 1}n and a quasicube I. For a ∈ Rn and r > 0 let

sI (x) =

ℓ (I)

ℓ (I) + |x − ζ I|
where ζ I is the center of the cube I. Now

,

fa,r (y) = 1Q−m(a)∩B(0,r) (y) sI (y)n−α ,

ℓ (I)|x − y| ≤ ℓ (I) |x − ζI| + ℓ (I) |ζI − y| ≤ [ℓ (I) + |x − ζI|] [ℓ (I) + |ζI − y|]

implies

Now the key observation is that with Lζ ≡ m · ζ, we have

1

|x − y| ≥

1

ℓ (I)

sI (x) sI (y) ,

x, y ∈ Rn.

L (x − y) = m · (x − y) ≥ |x − y| ,

x ∈ Qm (y) ,

which yields

(21)

L (Kα (x, y)) =

L (x − y)
|x − y|n+1−α ≥

1

|x − y|n−α ≥ ℓ (I)α−n sI (x)n−α sI (y)n−α ,

provided x ∈ Qm (y). Now we note that x ∈ Qm (y) when x ∈ Qm (a) and y ∈ Q−m (a) to obtain that for
x ∈ Qm (a),

L (T α (fa,rσ) (x)) = ZQ−m(a)∩B(0,r)

L (x − y)
|x − y|n+1−α sI (y) dσ (y)

≥ ℓ (I)α−n sI (x)n−αZQ−m(a)∩B(0,r)

sI (y)2n−2α dσ (y) .

Applying |Lζ| ≤ √n|ζ| and our assumed two weight inequality for the fractional Riesz transform, we see

that for r > 0 large,

ℓ (I)2α−2nZQm(a)
≤ kLT (σfa,r)k2

sI (x)2n−2α ZQ−m(a)∩B(0,r)

sI (y)2n−2α dσ (y)!2

dω (x)

L2(ω) . Nα (Rα)2 kfa,rk2

L2(σ) = Nα (Rα)2ZQ−m(a)∩B(0,r)

sI (y)2n−2α dσ (y) .

Rearranging the last inequality, and upon letting r → ∞, we obtain
ℓ (I)n−α

ZQm(a)

ℓ (I)n−α

(ℓ (I) + |x − ζ I|)2n−2α dω (x)ZQ−m(a)

(ℓ (I) + |y − ζ I|)2n−2α dσ (y) . Nα (Rα)2 .

Note that the ranges of integration above are pairs of opposing n-ants.

20

E.T. SAWYER, C.-Y. SHEN, AND I. URIARTE-TUERO

Fix a quasicube Q, which without loss of generality can be taken to be centered at the origin, ζ Q = 0.

Then choose a = (2ℓ (Q) , 2ℓ (Q)) and I = Q so that we have

 ZQm(a)
≤ CαZQm(a)

ℓ (Q)n−α

(ℓ (Q) + |x|)2n−2α dω (x)!(cid:18)ℓ (Q)α−nZQ
(ℓ (Q) + |x|)2n−2α dω (x)ZQ−m(a)

ℓ (Q)n−α

dσ(cid:19)

ℓ (Q)n−α

(ℓ (Q) + |y|)2n−2α dσ (y) . Nα (Rα)2 .

Now ﬁx m = (1, 1, ..., 1) and note that there is a ﬁxed N (independent of ℓ (Q)) and a ﬁxed collection of
rotations {ρk}N
k=1, such that the rotates ρkQm (a), 1 ≤ k ≤ N , of the n-ant Qm (a) cover the complement
of the ball B (0, 4√nℓ (Q)):

Then we obtain, upon applying the same argument to these rotated pairs of n-ants,

(22)

 ZB(0,4√nℓ(Q))c

Now we assume for the moment the oﬀset Aα

dσ(cid:19) . Nα (Rα)2 .

⊂

N[k=1

ℓ (Q)n−α

ρkQm (a) .

B(cid:0)0, 4√nℓ (Q)(cid:1)c
(ℓ (Q) + |x|)2n−2α dω (x)!(cid:18)ℓ (Q)α−nZQ
ℓ (Q)2(α−n)(cid:18)ZQ′
dσ(cid:19) ≤ Aα

dω(cid:19)(cid:18)ZQ

2 condition

2 ,

where Q′ and Q are neighbouring quasicubes, i.e. (Q′, Q) ∈ ΩN n. If we use this oﬀset inequality with Q′
ranging over 3Q \ Q, and then use the separation of B (0, 4√nℓ (Q)) \ 3Q and Q to obtain the inequality

2 ,

2

ℓ (Q)n−α

together with (22), we obtain

 ZRn\Q

Clearly we can reverse the roles of the measures ω and σ and obtain

dω!(cid:18)ZQ
ℓ (Q)2(α−n) ZB(0,4√nℓ(Q))\3Q
dσ(cid:19) . Aα
(ℓ (Q) + |x|)2n−2α dω (x)! 1
2(cid:18)ℓ (Q)α−nZQ
dσ(cid:19) 1
pAα
2 . Nα (Rα) +pAα
j of PJ
key estimate (21) above extends to the kernel PJ
2(cid:18) 1
ℓ (Q)α(cid:18) 1
dω(cid:19) 1
|Q|ZQ
dσ(cid:19) . Nα (Rα)2 |Q|2− 2α

More generally, to obtain the case when T α is elliptic and the oﬀset Aα
j=1 λm

for the kernels Kα, 0 ≤ α < n.

pAα
i.e. (cid:18)ZQ′

dω(cid:19)(cid:18)ZQ

|Q′|ZQ′

(Q′,Q)∈ΩN n

j K α

2 ≡

sup

n ,

2

2 condition holds, we note that the
j T α
in (16) if the n-ants above are
j
replaced by thin cones of suﬃcently small aperture, and there is in addition suﬃcient separation between
opposing cones, which in turn may require a larger constant than 4√n in the choice of Q′ above.
2 condition is implied by the norm inequality, i.e.

Finally, we turn to showing that the oﬀset Aα

j=1 λm

. Nα (Rα) ;

2

dσ(cid:19) 1
(Q′, Q) ∈ ΩN n.

. Nα (Rα) +pAα

2 .

In the range 0 ≤ α < n

The ‘one weight’ argument on page 211 of Stein [Ste] yields the asymmetric two weight Aα

2 where we only assume (18), we adapt a corresponding argument from [LaSaUr1].
2 condition

(23)
where Q and Q′ are quasicubes of equal side length r and distance C0r apart for some (ﬁxed large) positive
constant C0 (for this argument we choose the unit vector u in (18) to point in the direction from Q to Q′).
In the one weight case treated in [Ste] it is easy to obtain from this (even for a single direction u) the usual
(symmetric) A2 condition. Here we will have to employ a diﬀerent approach.

|Q′|ω |Q|σ ≤ CNα (Rα)|Q|2(1− α
n ) ,

TWO WEIGHT BOUNDEDNESS

21

Now recall (see Sec 2 of [Saw] for the case of usual cubes, and the case of half open, half closed quasicubes
here is no diﬀerent) that given an open subset Φ of Rn, we can choose R ≥ 3 suﬃciently large, depending
are the dyadic quasicubes maximal among those dyadic quasicubes
Q satisfying RQ ⊂ Φ, then the following properties hold:

j(cid:9)j
only on the dimension, such that if(cid:8)Qk

(24)



(disjoint cover)
(Whitney condition) RQj ⊂ Φ and 3RQj ∩ Φc 6= ∅ for all j
(ﬁnite overlap)

Φ =Sj Qj and Qj ∩ Qi = ∅ if i 6= j
Pj χ3Qj ≤ CχΦ

.

So ﬁx a pair of neighbouring quasicubes (Q′0, Q0) ∈ ΩN n, and let {Qi}i be a Whitney decomposition into
quasicubes of the set Φ ≡ (Q′0 × Q0) \ D relative to the diagonal D in Rn × Rn. Of course, there are no
common point masses of ω in Q′0 and σ in Q0 since the quasicubes Q′0 and Q0 are disjoint. Note that if
Qi = Q′i × Qi, then (23) can be written
(25)
where ω × σ denotes product measure on Rn × Rn. We choose R suﬃciently large in the Whitney de-
composition (24), depending on C0, such that (25) holds for all the Whitney quasicubes Qi. We have

|Qi|ω×σ ≤ CNα (Rα)|Qi|1− α

Pi |Qi| = |Q′ × Q| = |Q|2.
Moreover, if R = Q′ × Q is a rectangle in Rn × Rn (i.e. Q′, Q are quasicubes in Rn), and if R = ·∪iRi is a

ﬁnite disjoint union of rectangles Rα, then by additivity of the product measure ω × σ,

n ,

|R|ω×σ =Xi

|Ri|ω×σ .

Let Q0 = Q′0 × Q0 and set

Λ ≡(cid:8)Q = Q′ × Q : Q ⊂ Q0, ℓ (Q) = ℓ (Q′) ≈ C−1

0 qdist (Q, Q′) and (23) holds(cid:9) .

0, ..., Q4n

4 , and again, set aside those Qj,i

Divide Q0 into 2n × 2n = 4n2 congruent subquasicubes Q1
2 , and set aside those
Qj
0 ∈ Λ (those for which (23) holds) into a collection of stopping cubes Γ. Continue to divide the remaining
Qj
0 ∈ Λ of side length 1
0 ∈ Φ into Γ, and continue subdividing those that
remain. We continue with such subdivisions for N generations so that all the cubes not set aside into Γ have
side length 2−N . The important property these latter cubes have is that they all lie within distance r2−N
of the diagonal D = {(x, x) : (x, x) ∈ Q′0 × Q0} in Q0 = Q′0 × Q0 since (23) holds for all pairs of cubes Q′
and Q of equal side length r having distance at least C0r apart. Enumerate the cubes in Γ as {Qi}i and
those remaining that are not in Γ as {Pj}j. Thus we have the pairwise disjoint decomposition

0 of side length 1

The countable additivity of the product measure ω × σ shows that

Pj .
Qi![[j
|Qi|ω×σ +Xj
Nα (Rα)2 |Qi|1− α

|Pj|ω×σ .

n ,

Q0 = [i
|Q0|ω×σ =Xi
|Qi|ω×σ .Xi
Xi
Xk∈Z: 2k≤ℓ(Q0) Xi: ℓ(Qi)=2k(cid:0)22nk(cid:1)1− α
= ℓ (Q0)n Xk∈Z: 2k≤ℓ(Q0)

2nk(−1+2− 2α

Now we have

and

Xi

|Qi|1− α

n =

n ≈ Xk∈Z: 2k≤ℓ(Q0)(cid:18) 2k
n ) ≤ Cαℓ (Q0)n ℓ (Q0)n(1− 2α

ℓ (Q0)(cid:19)−n(cid:0)22nk(cid:1)1− α

n

(Whitney)

n ) = Cα |Q0 × Q0|2− 2α

n = Cα |Q0|1− α

n ,

22

E.T. SAWYER, C.-Y. SHEN, AND I. URIARTE-TUERO

provided 0 ≤ α < n
the following limit,

2 . Using that the side length of Pj = Pj × P ′j is 2−N and dist (Pj, D) ≤ Cr2−N , we have

[j

Xj

→ 0 as N → ∞,

|Pj|ω×σ =(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

Pj shrinks to the empty set as N → ∞, and since locally ﬁnite measures such as ω × σ are regular

Pj(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)ω×σ
since[j
in Euclidean space. This completes the proof thatpAα
Now we turn to proving pAα
2 ≤ α < n, where we assume the stronger
ellipticity condition (16). So ﬁx a pair of neighbouring quasicubes (K′, K) ∈ ΩN n, and assume that σ + ω
doesn’t charge the intersection K′ ∩ K of the closures of K′ and K. It will be convenient to replace n by
n + 1, i.e to introduce an additional dimension, and work with the preimages Q′ = Ω−1K′ and Q = Ω−1K
that are usual cubes, and with the corresponding pullbackseω = m1× Ω∗ω andeσ = m1× Ω∗σ of the measures

ω and σ where m1 is Lebesgue measure on the line. We may also assume that

2 . Nα (Rα) for the range 0 ≤ α < n
2 .

2 . Nα (Rα) for the range n

Q′ = [−1, 0) ×

Qi,

Q = [0, 1) ×

Qi.

nYi=1

where Qi = [ai, bi] for 1 ≤ i ≤ n (since the other cases are handled in similar fashion). It is important to note
that we are considering the intervals Qi here to be closed, and we will track this diﬀerence as we proceed.

Choose θ1 ∈ [a1, b1] so that both

[−1, 0) × [a1, θ1] ×

[−1, 0) × [θ1, b1] ×

Now denote the two intervals [a1, θ1] and [θ1, b1] by [a∗1, b∗1] and [a∗∗1 , b∗∗1 ] where the order is chosen so that

nYi=1

nYi=2

[0, 1) × [a∗1, b∗1] ×

[0, 1) × [a∗∗1 , b∗∗1 ] ×

Then we have both

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

[−1, 0) × [a∗1, b∗1] ×

[0, 1) × [a∗∗1 , b∗∗1 ] ×

1
2 |Q|eσ .

Now choose θ2 ∈ [a2, b2] so that both
[−1, 0) × [a∗1, b∗1] × [a2, θ2] ×

[−1, 0) × [a∗1, b∗1] × [θ2, b2] ×

1
4 |Q|eω ,

≥

and denote the two intervals [a2, θ2] and [θ2, b2] by [a∗2, b∗2] and [a∗∗2 , b∗∗2 ] where the order is chosen so that

[a∗∗1 , b∗∗1 ] × [a∗2, b∗2] ×

[0, 1) × [a∗∗1 , b∗∗1 ] × [a∗∗2 , b∗∗2 ] ×

[0, 1) ×(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

Then we have both

1
2 |Q′|eω .

.

≥

Qi(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)eω
Qi(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)eσ
nYi=2
Qi(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)eσ
nYi=2
Qi(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)eω
nYi=3
nYi=2

≥

.

Qi(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)eσ

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

nYi=2

,

1

Qi(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)eω
(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)
Qi(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)eσ
≤(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)
nYi=2
2 |Q|eω and (cid:12)(cid:12)(cid:12)(cid:12)(cid:12)
Qi(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)eω
(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)
Qi(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)eσ
nYi=2

≤(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

,

nYi=2

≥

Qi(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)eω
nYi=3

[−1, 0) × [a∗1, b∗1] × [a∗2, b∗2] ×

[0, 1) × [a∗∗1 , b∗∗1 ] × [a∗∗2 , b∗∗2 ] ×

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

nYi=3
nYi=3

≥

≥

1
4 |Q|eω ,

1
4 |Q|eσ ,

Qi(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)eω
Qi(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)eσ

G ≡ [−1, 0) × [a∗1, b∗1] × [a∗2, b∗2] × ... [a∗n, b∗n] ,
H ≡ [0, 1) × [a∗∗1 , b∗∗1 ] × [a∗∗2 , b∗∗2 ] × ... [a∗∗n , b∗∗n ] ,

and continuing in this way we end up with two rectangles,

that satisfy

TWO WEIGHT BOUNDEDNESS

23

|G|eω = |[−1, 0) × [a∗1, b∗1] × [a∗2, b∗2] × ... [a∗n, b∗n]|eω ≥
|H|eσ = |[0, 1) × [a∗∗1 , b∗∗1 ] × [a∗∗2 , b∗∗2 ] × ... [a∗∗n , b∗∗n ]|eσ ≥

1
2n |Q|eω ,

1
2n |Q|eσ .

However, the quasirectangles ΩG and ΩH lie in opposing quasi-n-ants at the vertex Ωθ = Ω (θ1, θ2, ..., θn),

and so we can apply (16) to obtain that for x ∈ ΩG,

&ZΩH |x − y|α−n dσ (y) & |ΩQ|

α

n −1 |ΩH|σ .

For the inequality above, we need to know that the distinguished point Ωθ is not a common point mass of
σ and ω, but this follows from our assumption that σ + ω doesn’t charge the intersection K′ ∩ K of the
closures of K′ and K. Then from the norm inequality we get

JXj=1

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

λm
j T α

λm
j K α

j (1ΩH σ) (x)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)
|ΩG|ω(cid:16)|ΩQ|

JXj=1

ZΩH

=(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)
n −1 |ΩH|σ(cid:17)2

α

j (x, y) dσ (y)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)
. ZG(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)
JXj=1

. N2PJ

j=1 λm

j T α

from which we deduce that

|ΩQ|2( α

n −1) |ΩQ′|ω |ΩQ|σ . 22n |ΩQ|2( α

λm
j T α

2

dω

j (1ΩH σ)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)
j Z 12
n −1) |ΩG|ω |ΩH|σ . 22nN2PJ

ΩH dσ = N2PJ

j=1 λm

j T α

j |ΩH|σ ,

j=1 λm

j T α
j

;

|K|2( α

n −1) |K′|ω |K|σ . 22nN2PJ

j=1 λm

j T α
j

,

and hence

Aα

2 . 22nN2PJ

j=1 λm

j T α
j

.

Thus we have obtained the oﬀset Aα

2 condition for pairs (K′, K) ∈ ΩN n such that σ + ω doesn’t charge
the intersection K′ ∩ K of the closures of K′ and K. From this and the argument at the beginning of this
proof, we obtain the one-tailed Aα
2 conditions. Indeed, we note that |∂ (rQ)|σ+ω > 0 for only a countable
number of dilates r > 1, and so a limiting argument applies. This completes the proof of Lemma 5.
(cid:3)

5. Monotonicity lemma and Energy lemma

The Monotonicity Lemma below will be used to prove the Energy Lemma, which is then used in several
places in the proof of Theorem 1. The formulation of the Monotonicity Lemma with m = 2 for cubes is due
to M. Lacey and B. Wick [LaWi], and corrects that used in early versions of our paper [SaShUr5].

5.1. The monotonicity lemma. For 0 ≤ α < n and m ∈ R+, we recall the m-weighted fractional Poisson
integral

Pα

m (J, µ) ≡ZRn

m
n

|J|

(cid:16)|J|

1

n + |y − cJ|(cid:17)n+m−α dµ (y) ,

1 (J, µ) = Pα (J, µ) is the standard Poisson integral. The next lemma holds for quasicubes and

where Pα
common point masses with the same proof as in [SaShUr7].
Lemma 6 (Monotonicity). Suppose that I and J are quasicubes in Rn such that J ⊂ 2J ⊂ I, and that µ
is a signed measure on Rn supported outside I. Finally suppose that T α is a standard α-fractional singular
integral on Rn as deﬁned in Subsubsection 2.2.1 with 0 < α < n. Then we have the estimate

(26)

k△ω

J T αµkL2(ω) . Φα (J,|µ|) ,

24

E.T. SAWYER, C.-Y. SHEN, AND I. URIARTE-TUERO

where for a positive measure ν,

Φα (J, ν)2 ≡   Pα (J, ν)
n !2
k△ω
|J|ωZJ

mJ ≡ Eω

|J|
J x =

1

1

xdω.

L2(ω) +  Pα
J xk2

1+δ (J, ν)
|J|

1
n

!2

kx − mJk2

L2(1J ω) ,

H =PJ∈H △ω

J be the corresponding ω-quasiHaar projection. We deﬁne H∗ ≡ [J∈H

5.2. The Energy Lemma. Suppose now we are given a subset H of the dyadic quasigrid ΩDω. Let
{J′ ∈ ΩDω : J′ ⊂ J}.
Pω
The next lemma also holds for quasicubes and common point masses with the same proof as in [SaShUr7].
Lemma 7 (Energy Lemma). Let J be a quasicube in ΩDω. Let ΨJ be an L2 (ω) function supported in
J and with ω-integral zero, and denote its quasiHaar support by H = suppcΨJ . Let ν be a positive measure
supported in Rn \ γJ with γ ≥ 2, and for each J′ ∈ H, let dν J ′ = ϕJ ′dν with |ϕJ ′| ≤ 1. Let T α be a standard
α-fractional singular integral operator with 0 ≤ α < n. Then with δ′ = δ
n !kPω
. kΨJkL2(ω)  Pα (J, ν)
γδ′   Pα
. kΨJkL2(ω)  Pα (J, ν)

J ′ ΨJiω(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

1+δ′ (J, ν)
|J|

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)XJ ′∈H

hT α (νJ ′ ) ,△ω

!kPω

+ kΨJkL2(ω)

H∗xkL2(ω) ,

H∗ xkL2(ω)

HxkL2(ω)

1

|J|
1

2 we have

and in particular the ‘pivotal’ bound

1
n

1

n !kPω
|hT α (ν) , ΨJiω| ≤ C kΨJkL2(ω) Pα (J,|ν|)q|J|ω .
Hxk2

|J|

1+δ′ times the ‘big’ energy term kPω

Remark 5. The ﬁrst term on the right side of the energy inequality above is the ‘big’ Poisson integral Pα
times the ‘small’ energy term kPω
L2(ω) that is additive in H, while the second term on the right is the
‘small’ Poisson integral Pα
H∗xkL2(ω) that is no longer additive in H. The
ﬁrst term presents no problems in subsequent analysis due solely to the additivity of the ‘small’ energy term.
It is the second term that must be handled by special methods. For example, in the Intertwining Proposition
below, the interaction of the singular integral occurs with a pair of quasicubes J ⊂ I at highly separated
levels, where the goodness of J can exploit the decay δ′ in the kernel of the ‘small’ Poisson integral Pα
1+δ′
relative to the ‘big’ Poisson integral Pα, and results in a bound directly by the quasienergy condition. On the
other hand, in the local recursion of M. Lacey at the end of the paper, the separation of levels in the pairs
J ⊂ I can be as little as a ﬁxed parameter ρ, and here we must ﬁrst separate the stopping form into two
sublinear forms that involve the two estimates respectively. The form corresponding to the smaller Poisson
1+δ′ is again handled using goodness and the decay δ′ in the kernel, while the form corresponding
integral Pα
to the larger Poisson integral Pα requires the stopping time and recursion argument of M. Lacey.

6. Preliminaries of NTV type

An important reduction of our theorem is delivered by the following two lemmas, that in the case of
one dimension are due to Nazarov, Treil and Volberg (see [NTV4] and [Vol]). The proofs given there do
not extend in standard ways to higher dimensions with common point masses, and we use the quasiweak
boundedness property to handle the case of touching quasicubes, and an application of Schur’s Lemma to
handle the case of separated quasicubes. The ﬁrst lemma below is Lemmas 8.1 and 8.7 in [LaWi] but with
the larger constant Aα
2 here. We emphasize that only the oﬀset
Aα
2 condition is needed with testing and weak boundedness in these preliminary estimates.
Lemma 8. Suppose T α is a standard fractional singular integral with 0 ≤ α < n, and that all of the
quasicubes I ∈ ΩDσ, J ∈ ΩDω below are good with goodness parameters ε and r. Fix a positive integer ρ > r.

2 there in place of the smaller constant Aα

TWO WEIGHT BOUNDEDNESS

25

For f ∈ L2 (σ) and g ∈ L2 (ω) we have
(27)

|hT α

σ (△σ

I f ) ,△ω

X(I,J)∈ΩDσ×ΩDω

2−ρℓ(I)≤ℓ(J)≤2ρℓ(I)

J giω| .(cid:16)Tα + T∗α + WBPT α +pAα

2(cid:17)kfkL2(σ) kgkL2(ω)

and

(28)

X(I,J)∈ΩDσ×ΩDω

I∩J=∅ and ℓ(J)

ℓ(I) /∈[2−ρ,2ρ]

|hT α

σ (△σ

I f ) ,△ω

2 kfkL2(σ) kgkL2(ω) .

J giω| .pAα

Lemma 9. Suppose T α is a standard fractional singular integral with 0 ≤ α < n, that all of the quasicubes
I ∈ ΩDσ, J ∈ ΩDω below are good, that ρ > r, that f ∈ L2 (σ) and g ∈ L2 (ω), that F ⊂ ΩDσ and G ⊂ ΩDω
are σ-Carleson and ω-Carleson collections respectively, i.e.,

|G′|ω . |G|ω ,

G ∈ G,

such that

βG (G)2 |G|σ ≤ kgk2

L2(σ) ,

XF ′∈F : F ′⊂F
XF∈F

that there are numerical sequences {αF (F )}F∈F
αF (F )2 |F|σ ≤ kfk2
(29)

|F ′|σ . |F|σ ,

F ∈ F , and XG′∈G: G′⊂G
and(cid:8)βG (G)(cid:9)G∈G
L2(σ) and XG∈G
(cid:13)(cid:13)βI,J(cid:13)(cid:13)∞
(cid:12)(cid:12)(cid:12)(cid:10)T α
σ (cid:0)βF,J 1F αF (F )(cid:1) ,△ω

,(cid:13)(cid:13)γI,J(cid:13)(cid:13)∞ ≤ 1.
J g(cid:11)ω(cid:12)(cid:12)(cid:12) +

.pAα

2 kfkL2(σ) kgkL2(ω) .

and ﬁnally that for each pair of quasicubes (I, J) ∈ ΩDσ × ΩDω, there are bounded functions βI,J and γI,J
supported in I \ 2J and J \ 2I respectively, satisfying

Then

(30)

X(F,J)∈F×ΩDω

F∩J=∅ and ℓ(J)≤2−ρℓ(F )

X(I,G)∈ΩDσ×G

I∩G=∅ and ℓ(I)≤2−ρℓ(G)

σ (△σ

(cid:12)(cid:12)(cid:12)(cid:10)T α

I f ) , γI,G1GβG (G)(cid:11)ω(cid:12)(cid:12)(cid:12)

See [SaShUr6] for complete details of the proofs when common point masses are permitted.

Remark 6. If F and G are σ-Carleson and ω-Carleson collections respectively, and if αF (F ) = Eσ
βG (G) = Eω
than quasi), and this special case of Lemma 9 serves as a basic example.

F |f| and
G |g|, then the ‘quasi’ orthogonality condition (29) holds (here ‘quasi’ has a diﬀerent meaning

Remark 7. Lemmas 8 and 9 diﬀer mainly in that an orthogonal collection of quasiHaar projections is
replaced by a ‘quasi’ orthogonal collection of indicators {1F αF (F )}F∈F
. More precisely, the main diﬀerence
between (28) and (30) is that a quasiHaar projection △σ
J g has been replaced with a constant multiple
of an indicator 1F αF (F ) or 1GβG (G), and in addition, a bounded function is permitted to multiply the
indicator of the quasicube having larger sidelength.

I f or △ω

7. Corona Decompositions and splittings

We will use two diﬀerent corona constructions, namely a Calder´on-Zygmund decomposition and an energy
decomposition of NTV type, to reduce matters to the stopping form, the main part of which is handled by
Lacey’s recursion argument. We will then iterate these coronas into a double corona. We ﬁrst recall our
basic setup. For convenience in notation we will sometimes suppress the dependence on α in our nonlinear
forms, but will retain it in the operators, Poisson integrals and constants. We will assume that the good/bad
quasicube machinery of Nazarov, Treil and Volberg [Vol] is in force here as in [SaShUr7]. Let ΩDσ = ΩDω
be an (r, ε)-good quasigrid on Rn, and let {hσ,a
be corresponding
quasiHaar bases as described above, so that
f = XI∈ΩDσ △σ

I f and g = XJ∈ΩDω △ω

J oJ∈ΩDω, b∈Γn

and nhω,b

I }I∈ΩDσ, a∈Γn

J g ,

where the quasiHaar projections △σ
we must show the bilinear inequality (20), i.e. |T α (f, g)| ≤ NT α kfkL2(σ) kgkL2(ω).

I f and △ω

J g vanish if the quasicubes I and J are not good. Recall that

26

E.T. SAWYER, C.-Y. SHEN, AND I. URIARTE-TUERO

We now proceed for the remainder of this section to follow the development in [SaShUr7], pointing out
just the highlights, and referring to [SaShUr7] for proofs, when no changes are required by the inclusion of
quasicubes and common point masses.

Let F be a collection of Calder´on-Zygmund stopping quasicubes for f , and let ΩDσ = [F∈F

7.1. The Calder´on-Zygmund corona. We now introduce a stopping tree F for the function f ∈ L2 (σ).
CF be the
associated corona decomposition of the dyadic quasigrid ΩDσ. See below and also [SaShUr7] for the standard
deﬁnitions of corona, etc.
For a quasicube I ∈ ΩDσ let πΩDσ I be the ΩDσ-parent of I in the quasigrid ΩDσ, and let πF I be the
smallest member of F that contains I. For F, F ′ ∈ F , we say that F ′ is an F -child of F if πF (πΩDσ F ′) = F
(it could be that F = πΩDσ F ′), and we denote by CF (F ) the set of F -children of F . For F ∈ F , deﬁne the
projection Pσ

by

CF onto the linear span of the quasiHaar functions {hσ,a
hf, hσ,a

I f = XI∈CF , a∈Γn
△σ

Pσ

I

I }I∈CF , a∈Γn

iσ hσ,a

I

.

The standard properties of these projections are

f = XF∈F

Pσ
CF f,

CF f(cid:1) σ = 0,

kfk2

L2(σ) = XF∈F(cid:13)(cid:13)Pσ
CF f(cid:13)(cid:13)2

L2(σ) .

7.2. The energy corona. We also impose a quasienergy corona decomposition as in [NTV4] and [LaSaUr2].

Deﬁnition 9. Given a quasicube S0, deﬁne S (S0) to be the maximal subquasicubes I ⊂ S0 such that

(31)

XJ∈Mτ −deep(I)  Pα(cid:0)J, 1S0\γJ σ(cid:1)

|J|

1
n

!2(cid:13)(cid:13)(cid:13)Psubgood,ω

J

2

x(cid:13)(cid:13)(cid:13)
L2(ω) ≥ Cenergyh(cid:0)E deep

α

+ Aα

2 + Aα,punct

2

i |I|σ ,

(cid:1)2

α

where E deep
is the constant in the deep quasienergy condition deﬁned in Deﬁnition 6, and Cenergy is a
suﬃciently large positive constant depending only on τ ≥ r, n and α. Then deﬁne the σ-energy stopping
quasicubes of S0 to be the collection

where S0 = S (S0) and Sn+1 = [S∈Sn

S = {S0} ∪

∞[n=0

Sn

S (S) for n ≥ 0.

From the quasienergy condition in Deﬁnition 6 we obtain the σ-Carleson estimate

CF f = XI∈CF
Z (cid:0)Pσ

Finally, we record the reason for introducing quasienergy stopping times. If

(32)

(33)

Xα (CS)2 ≡ sup
I∈CS

I ∈ ΩDσ.

|S|σ ≤ 2 |I|σ ,

XS∈S: S⊂I
|I|σ XJ∈Mτ −deep(I)  Pα(cid:0)J, 1S\γJ σ(cid:1)

|J|

1

1
n

!2(cid:13)(cid:13)(cid:13)Psubgood,ω

J

x(cid:13)(cid:13)(cid:13)

2

L2(ω)

is (the square of) the α-stopping quasienergy of the weight pair (σ, ω) with respect to the corona CS, then
we have the stopping quasienergy bounds

(34)

where Aα

2 + Aα,punct

2

Xα (CS) ≤pCenergyr(cid:16)E deep

α

(cid:17)2

+ Aα

2 + Aα,punct

2

,

S ∈ S,

and the the deep quasienergy constant E deep

α

are controlled by assumption.

TWO WEIGHT BOUNDEDNESS

27

7.3. General stopping data. It is useful to extend our notion of corona decomposition to more general
stopping data. Our general deﬁnition of stopping data will use a positive constant C0 ≥ 4.
Deﬁnition 10. Suppose we are given a positive constant C0 ≥ 4, a subset F of the dyadic quasigrid
ΩDσ (called the stopping times), and a corresponding sequence αF ≡ {αF (F )}F∈F
of nonnegative numbers
αF (F ) ≥ 0 (called the stopping data). Let (F ,≺, πF ) be the tree structure on F inherited from ΩDσ, and
for each F ∈ F denote by CF = {I ∈ ΩDσ : πF I = F} the corona associated with F :

CF = {I ∈ ΩDσ : I ⊂ F and I 6⊂ F ′ for any F ′ ≺ F} .

We say the triple (C0,F , αF ) constitutes stopping data for a function f ∈ L1

loc (σ) if

(1) Eσ

I |f| ≤ αF (F ) for all I ∈ CF and F ∈ F ,

(2) PF ′(cid:22)F |F ′|σ ≤ C0 |F|σ for all F ∈ F ,
(3) PF∈F αF (F )2 |F|σ ≤C2
(4) αF (F ) ≤ αF (F ′) whenever F ′, F ∈ F with F ′ ⊂ F .

0 kfk2

L2(σ),

Deﬁnition 11. If (C0,F , αF ) constitutes (general) stopping data for a function f ∈ L1
the othogonal decomposition

loc (σ), we refer to

f = XF∈F

Pσ
CF f ;

Pσ

CF f ≡ XI∈CF

△σ
I f,

as the (general) corona decomposition of f associated with the stopping times F .

Property (1) says that αF (F ) bounds the quasiaverages of f in the corona CF , and property (2) says that
the quasicubes at the tops of the coronas satisfy a Carleson condition relative to the weight σ. Note that a
standard ‘maximal quasicube’ argument extends the Carleson condition in property (2) to the inequality

(35)

XF ′∈F : F ′⊂A

|F ′|σ ≤ C0 |A|σ for all open sets A ⊂ Rn.

Property (3) is the ‘quasi’ orthogonality condition that says the sequence of functions {αF (F ) 1F}F∈F is in
the vector-valued space L2(cid:0)ℓ2; σ(cid:1), and property (4) says that the control on stopping data is nondecreasing
on the stopping tree F . We emphasize that we are not assuming in this deﬁnition the stronger property that
there is C > 1 such that αF (F ′) > CαF (F ) whenever F ′, F ∈ F with F ′ $ F . Instead, the properties (2)
and (3) substitute for this lack. Of course the stronger property does hold for the familiar Calder´on-Zygmund
stopping data determined by the following requirements for C > 1,

Eσ
F ′ |f| > CEσ

F |f| whenever F ′, F ∈ F with F ′ $ F,

Eσ
I |f| ≤ CEσ

F |f| for I ∈ CF ,

which are themselves suﬃciently strong to automatically force properties (2) and (3) with αF (F ) = Eσ
‘quasi’ orthogonal property relative to f with a constant C′0 depending only on C0:

We have the following useful consequence of (2) and (3) that says the sequence {αF (F ) 1F}F∈F

F |f|.
has a

(36)

2

(cid:13)(cid:13)(cid:13)(cid:13)(cid:13)XF∈F

αF (F ) 1F(cid:13)(cid:13)(cid:13)(cid:13)(cid:13)

L2(σ)

≤ C′0 kfk2

L2(σ) .

We will use a construction that permits iteration of general corona decompositions.

Lemma 10. Suppose that (C0,F , αF ) constitutes stopping data for a function f ∈ L1
F ∈ K (F ). There is a positive constant C1, depending only on C0, such that if

each F ∈ F ,(cid:0)C0,K (F ) , αK(F )(cid:1) constitutes stopping data for the corona projection Pσ

loc (σ), and that for
CF f , where in addition

K∗ (F ) ≡ (cid:8)K ∈ K (F ) ∩ CF : αK(F ) (K) ≥ αF (F )(cid:9)

K ≡ [F∈F

αK (K) ≡

K∗ (F ) ∪ {F} ,
αK(F ) (K)
max(cid:8)αF (F ) , αK(F ) (F )(cid:9)

for K ∈ K∗ (F ) \ {F}
for

K = F

,

for F ∈ F ,

hT α
σ f, giω
↓B⋐ρ (f, g)

↓
↓

↓
↓
(f, g)
↓
↓

BA
⋐ρ

BA
E deep

stop (f, g)

α +pAα

2

↓
↓

TT α

+ T2

T1
far below (f, g)
NT V α + Eα
paraproduct (f, g) + BA

far below (f, g)

NT V α

neighbour (f, g)

+ BA

pAα

2

28

E.T. SAWYER, C.-Y. SHEN, AND I. URIARTE-TUERO

the triple (C1,K, αK) constitutes stopping data for f . We refer to the collection of quasicubes K as the
f as the iterated corona de-
composition of f , where

iterated stopping times, and to the orthogonal decomposition f = PK∈K

PCK

K

CKK ≡ {I ∈ ΩD : I ⊂ K and I 6⊂ K′ for K′ ≺K K} .

Note that in our deﬁnition of (C1,K, αK) we have ‘discarded’ from K (F ) all of those K ∈ K (F ) that are
not in the corona CF , and also all of those K ∈ K (F ) for which αK(F ) (K) is strictly less than αF (F ). Then
the union over F of what remains is our new collection of stopping times. We then deﬁne stopping data
αK (K) according to whether or not K ∈ F : if K /∈ F but K ∈ CF then αK (K) equals αK(F ) (K), while if
K ∈ F , then αK (K) is the larger of αK(F ) (F ) and αF (K). See [SaShUr7] for a proof.
7.4. Doubly iterated coronas and the NTV quasicube size splitting. Let

Here is a brief schematic diagram of the decompositions, with bounds usingin :

NT V α ≡qAα

2 + Aα,∗2 + Aα,punct

2

+ Aα,∗,punct

2

+ TT α + T∗T α .

+

B

ρ⋑ (f, g)
dual

+

B∩ (f, g)
NT V α

+

B(cid:30) (f, g)
NT V α

Tdiagonal (f, g) +

Tfar below (f, g)

+ Tfar above (f, g) + Tdisjoint (f, g)

∅

∅

We begin with the NTV quasicube size splitting of the inner product hT α

σ f, giω - and later apply the iterated
corona construction - that splits the pairs of quasicubes (I, J) in a simultaneous quasiHaar decomposition
of f and g into four groups, namely those pairs that:

(1) are below the size diagonal and ρ-deeply embedded,
(2) are above the size diagonal and ρ-deeply embedded,
(3) are disjoint, and
(4) are of ρ-comparable size.
More precisely we have

hT α

σ f, giω =

=

XI∈ΩDσ , J∈ΩDω hT α
XI∈ΩDσ , J∈ΩDω
hT α
+ XI∈ΩDσ, J∈ΩDω

J ⋐ρI

J∩I=∅

σ (△σ

I f ) , (△ω

I g)iω

σ (△σ

I f ) , (△ω

hT α

σ (△σ

I f ) , (△ω

J g)iω + XI∈ΩDσ, J∈ΩDω
hT α
XI∈ΩDσ, J∈ΩDω

J g)iω +

Jρ⋑I

2−ρ≤ℓ(J)(cid:30)ℓ(I)≤2ρ

σ (△σ

I f ) , (△ω

J g)iω

hT α

σ (△σ

I f ) , (△ω

J g)iω

= B⋐ρ (f, g) + B

ρ⋑ (f, g) + B∩ (f, g) + B(cid:30) (f, g) .

Lemma 8 in the section on NTV preliminaries show that the disjoint and comparable forms B∩ (f, g) and
B(cid:30) (f, g) are both bounded by the Aα
, quasitesting and quasiweak boundedness property con-
stants. The below and above forms are clearly symmetric, so we need only consider the form B⋐ρ (f, g), to
which we turn for the remainder of the proof. The main ingredient used in reducing control of the below
form B⋐ρ (f, g) to control of functional energy Fα and the stopping form BA
stop (f, g), is an adaptation of the

2 + Aα,punct

2

TWO WEIGHT BOUNDEDNESS

29

Intertwining Proposition from [SaShUr7] to include quasicubes and common point masses. This adaptation
is easy because the measures ω and σ never ‘see’ each other in the proof, and the straightforward details can
be found in [SaShUr6]. We now turn to controlling functional energy.

8. Control of functional energy by energy modulo Aα

2

Now we arrive at one of the main new propositions in the proof of our theorem. We show that the functional
quasienergy constants Fα are controlled by Aα
and both the deep and xreﬁned quasienergy constants
E deep
. The proof of this fact is
further complicated when common point masses are permitted, accounting for the inclusion of the punctured
Muckenhoupt condition Aα,punct

deﬁned in Deﬁnition 6. Recall (Eα)2 =(cid:0)E deep

+(cid:0)E xreﬁned

and E xreﬁned

2 , Aα,punct

(cid:1)2

(cid:1)2

α

α

α

α

2

.

2

Proposition 1.

Fα . Eα +pAα

.
To prove this proposition, we ﬁx F as in Deﬁnition 10, and for η ≥ 2m0 to be chosen later, set

2

2 +qAα,∗2 +qAα,∗,punct

2

2 +qAα,∗2 +qAα,punct
µη ≡ XF∈F XJ∈Mr−deep(F )(cid:13)(cid:13)Pω

and F∗α . E∗α +pAα
F,J x(cid:13)(cid:13)2

L2(ω) · δ(cJ ,ηℓ(J)) ,

(37)

where Mr−deep (F ) consists of the maximal r-deeply embedded subquasicubes of F , and where δq denotes a
Dirac unit mass at a point q in the upper half-space Rn+1
+ . Here J is a dyadic quasicube with center cJ and
side length ℓ (J).
Deﬁnition 12. Let F be a collection of dyadic quasicubes. The good τ -shifted corona corresponding to F is
deﬁned by

good : J ⋐τ F and J 6⋐τ F ′ for any F ′ ∈ CF (F )(cid:9) .
good, and that the collections Cgood,τ−shift
have bounded overlap τ
since for ﬁxed J, there are at most τ quasicubes F ∈ F with the property that J is good and J ⋐τ F and
J 6⋐τ F ′ for any F ′ ∈ CF (F ). Here CF (F ) denotes the set of F -children of F . In fact we have
(38)

≡(cid:8)J ∈ ΩDω
= C τ−shift

Note that Cgood,τ−shift

Cgood,τ−shift

∩ ΩDω

1

F

F

F

F

Cτ −shift

F

(J) ≤ τ ,

J ∈ ΩD.

Given any collection H ⊂ ΩD of quasicubes, and a dyadic quasicube J, we deﬁne the corresponding quasiHaar
projection Pω

H and its localization Pω

(39)

XF∈F

Pω

H;J to J by
H and Pω
△ω

H = XH∈H

H;J = XH∈H: H⊂J

△ω
H .

F,J ≡ Pω
Pω

Cgood,τ −shift

F

=

;J

X

F

J ′⊂J: J ′∈Cgood,τ −shift

△ω
J ′.

For convenience in notation, we denote for any dyadic quasicube J the localized projection Pω
given by

Cgood,τ −shift

F

;J

We emphasize that the quasicubes J ∈ Mr−deep (F ) are not necessarily good, but that the subquasicubes
J′ ⊂ J arising in the projection Pω
F,J are good. We can replace x by x − c inside the projection for any
choice of c we wish; the projection is unchanged.

8.1. Reduction to Hyt¨onen’s bilinear positive inequality. We prove the two-weight inequality

(40)

(cid:19)kfkL2(σ) ,
for all nonnegative f in L2 (σ), noting that F and f are not related here. Above, ePα,γ∗

renormalized α-fractional Poisson extension with a ‘hole’ to the upper half-space Rn+1
Hyt¨onen [Hyt2],

+ ,µη ) .(cid:18)Eα +pAα

2 +qAα,∗2 +qAα,punct

kePα,γ∗

(f σ)kL2(Rn+1

2

(·) denotes the
+ , as introduced in

ν (x, t) ≡ZRn\γ ∗Q(x,t)

ePα,γ∗

1

(cid:16)t2 + |x − y|2(cid:17) n+1−α

2

dν (y) ,

30

E.T. SAWYER, C.-Y. SHEN, AND I. URIARTE-TUERO

where Q (x, t) ∈ ΩP n is the unique Ω-quasicube centered at x with side length t, and where γ∗ ≥ 1 will be
chosen later. In particular, we have

2

(cid:13)(cid:13)(cid:13)ePα,γ∗

(f σ)(cid:13)(cid:13)(cid:13)

L2(Rn+1

+ ,µη )

(f σ) (cJ , ηℓ (J))i2(cid:13)(cid:13)Pω
= XF∈F XJ∈Mr−deep(F )hePα,γ∗
F,J x(cid:13)(cid:13)2
≈ XF∈F XJ∈Mr−deep(F )hePα,γ (f σ) (cJ , ℓ (J))i2(cid:13)(cid:13)Pω
F,J x(cid:13)(cid:13)2

L2(ω)

,

L2(ω)

if we choose η and γ∗ so that γ∗η = γ, since then

ν (cJ , ηℓ (J)) ≈ZRn\Q(cJ ,γt)

ePα,γ∗

1

(cid:16)ℓ (J)2 + |cJ − y|2(cid:17) n+1−α

2

dν (y) =ePα,γ (ν) (cJ , ℓ (J)) .

Thus (40) proves the ﬁrst line in Proposition 1 upon inspecting the deﬁnition of functional quasienergy.

In order to prove (40), we will use Hyt¨onen’s dyadic positive bilinear inequality in [Hyt2], and the point
of introducing the parameters η and γ∗ with γ∗η = γ (as opposed to simply taking η = 1 and γ∗ = γ) is to
obtain a bilinear inequality below that has the exact form of that in Hyt¨onen [Hyt2]. To reduce matters to
this inequality, we ﬁrst recall that given a dyadic quasigrid ΩD and a dyadic quasicube Q ∈ ΩD, we denote

Pα

dyadic,ΩD (Q, µ) ≡ XK∈ΩD: K%Q
ΩD (x,t)cν(cid:17)

ΩD (x, t) , 1Qdy

dyadic,ΩD(cid:16)Qdy,m0

Pα

1
n

n |K|

1

|Q|
|K|

α

n −1 |K|µ ,

and we now deﬁne the renormalized dyadic α-fractional Poisson operator with a ‘2m0 dyadic hole’,

dyadic,ΩD

ν (x, t) ≡

ePα,m0
where for m ≥ 1, Qdy,m
ΩDL (x, t) where L (x, t) ∈ ΩD is the smallest dyadic ΩD-quasicube
ΩD
containing Q (x, t), and where for K and L in a common dyadic quasigrid, KL denotes the child of K
containing L.

(x, t) = πm

ΩD (x,t)

|K|

=

t

,

n

(cid:12)(cid:12)(cid:12)K \ KQdy

ΩD (x,t)(cid:12)(cid:12)(cid:12)ν

XK: K%Qdy,m0

1
n+1−α

Remark 8. It might be possible to prove the two weight Poisson inequality without holes here in the setting of
common point masses, if we use the argument in [SaShUr7] with the plugged energy Muckenhoupt conditions
Aα,energy plug
. The
reason is that the upper halfspace measure

in conjunction with the plugged energy conditions E plug

and Aα,∗,energy plug

and E∗,plug

α

α

2

2

µη ≡ XF∈F XJ∈Mr−deep(F )(cid:13)(cid:13)Pω

F,J x(cid:13)(cid:13)2

L2(ω) · δ(cJ ,ηℓ(J))

is a sum of norms of projections that are almost orthogonal, and the products of such projection norms
and Poisson expressions can be appropriately controlled by the energy conditions and energy Muckenhoupt
conditions. See for example (58) below. However, the method of proof in [SaShUr7] requires verifying a global
testing condition as well, which introduces yet further complications. In any event, the bilinear inequality of
Hyt¨onen provides a slick way of obtaining the inequality we want, and we will pursue this route.

We will use a generalization of the variation on the familiar ‘one third trick’ given in Lemma 2.5 of
[HyLaPe], that permits handling of ‘holes’ in repeated arguments. We will follow Hytonen [Hyt2], but take
m1 to be a power of 2 instead of m1 = 3 so as to avoid leaving the world of quasigrids with side lengths
a power of 2. Momentarily ﬁx m1 ≫ 1 which will be chosen large later in the proof. For a given dyadic
quasigrid ΩD, partition the collection of m1-multiples {m1Q}Q∈ΩD of ΩD-quasicubes into mn
1 subcollections
{Su}mn
u=1, with the property that for each subcollection Su there exists a dyadic quasigrid ΩDu with side
lengths m1 · 2m, m ∈ Z, such that Su ⊂ ΩDu. With these quasigrids {ΩDu}mn
u=1 ﬁxed, there is m0 ∈ N
depending on m1 such that the following sandwiching property holds: for each quasicube Q ∈ ΩP n and each
integer j ∈ N, there is a choice of u = u (Q, j) with 1 ≤ u ≤ mn
1 and a quasicube I = Iu(Q,j) ∈ ΩDu such

1

1

TWO WEIGHT BOUNDEDNESS

31

that

(41)

ℓ (I) ≤ 2m0 ℓ (Q) ,
m1Q ⊂ I,
2jQ ⊂ π(j)
ΩDu

I.

We keep m0 and m1 as above ﬁxed for now.

Now we deﬁne the ‘good’ upper half space points for the grid ΩDu by

Gu ≡n(x, t) ∈ Rn+1

+ : Qdy,m0
ΩDu

(x, t) ⊃ m1Q (x, t)o ,

where from the above construction (41) it follows that

Rn+1
+ ⊂

mn

1[u=1

Gu .

We now use this construction to dominate the continuous renormalized Poisson operator ePα,γ∗
γ∗-hole, by the sum of the dyadic renormalized Poisson operatorsePα,m0

Lemma 11. With notation as above we have

restricted to the sets Gu:

dyadic,ΩDu

with a

ν (x, t) .

ePα,γ∗

mn

1Xu=1

1Gu (x, t)ePα,m0

dyadic,ΩDu

ν (x, t) ,

ν ≥ 0,

for γ∗ > 1 suﬃciently large depending on m0.

Proof. This is essentially proved in Proposition 6.6 of Hyt¨onen [Hyt2] with m1 = 3. Here we will content

ourselves by observing that we can dominateePα,γ∗
ePα,γ ∗
(cid:16)t2 + |x − y|2(cid:17) n+1−α

ν (x, t) =ZRn\Q(x,γ∗t)

1

2

ν by

dν (y) .

∞Xj=0

1

(2jt)n+1−α(cid:12)(cid:12)Q(cid:0)x, γ∗2j+1t(cid:1) \ Q(cid:0)x, γ∗2jt(cid:1)(cid:12)(cid:12)ν ,

and then apply the above sandwiching property (41) appropriately to obtain the conclusion of the lemma. (cid:3)

Thus we have reduced the proof of (40) to proving the dyadic version

uniformly over all dyadic quasigrids ΩDu. So with µη

u ≡ 1Guµη, we will prove

dyadic,ΩDu

(42)

(cid:13)(cid:13)(cid:13)ePα,m0
ZRn+1
+ (cid:16)ePα,m0

dyadic,ΩDu

(f σ)(cid:13)(cid:13)(cid:13)L2(Rn+1
f σ (x, t)(cid:17)2

dµη

Now deﬁne

2 +qAα,∗2 +qAα,punct

2

+ ,1Gu µη)

.(cid:18)Eα +pAα
 XK: K%Qdy

+

ΩDu

u (x, t) = ZRn+1
. (cid:0)E 2
α + Aα
XF∈F : J∈Mr−deep(F )(cid:13)(cid:13)Pω

µJ ≡
µη
u,J ≡ 1Gu (cJ , ηℓ (J)) µJ .

(x,t)

|K|
2 + Aα,∗2 + Aα,punct

2

1

n+1−α

n

(cid:1)ZRn

;

L2(ω)

F,J x(cid:13)(cid:13)2

(cid:19)kfkL2(σ) ,
f σ

ZK\KQ(x,t)

2

f 2σ.

dµη

u (x, t)

Continuing to follow Hyt¨onen [Hyt2], we note that by duality, (42) is equivalent to

XJ∈ΩD

dyadic,ΩDu

µη

u,J ePα,m0

f σ (cJ , ηℓ (J)) φJ .qE 2

α + Aα

2 + Aα,∗2

kfkL2(σ) s XJ∈ΩD

J µη
φ2

u,J .

1

n+1−α

n

X

J: Qdy,m0

ΩDu

(cJ ,ℓ(J))&K

µη

u,J φJZK\K

f dσ

Q

dy,m0
ΩDu

(cJ ,ℓ(J))

f dσ

(relabelling K → πΩDuK)

(cJ , ℓ (J)) ⊂ K if and only if there is an mth

0 generation

32

E.T. SAWYER, C.-Y. SHEN, AND I. URIARTE-TUERO

Now we compute, recalling that KL denotes the child of K containing L, that

XJ∈ΩD
= XK∈ΩDu
= XK∈ΩDu

dyadic,ΩDu

µη

u,J ePα,m0

1
|πK|
1
|πK|

n+1−α

n

n+1−α

n

J: Qdy,m0

ΩDu

XK ′∈C

(m0)
ΩDu

f σ (cJ , ηℓ (J)) φJ = XK∈ΩDu
u,J φJZπK\K

µη

|K|

X

(cJ ,ℓ(J))⊂K

XJ: Qdy,0

ΩDu

(K)

(cJ ,ℓ(J))⊂K ′

µη

u,J φJZπK\K

f dσ,

where in the last line we have used that Qdy,m0
ΩDu
grandchild K′ ∈ C(m0)
ΩDu
XJ: Qdy,0

(K) so that Qdy,0
ΩDu

µη
u,J φJ =

(cJ ,ℓ(J))⊂K ′

ΩDu

(cJ , ℓ (J)) ⊂ K′. Now we note that
XJ: Qdy,0

(cJ ,ℓ(J))⊂K ′

ΩDu

and

so we can continue with

ZπK\K

f dσ =

K ′′∈C

X

(m0+1)
ΩDu

(πK)\C

XJ∈ΩD

µu,J ePα

dyadic,ΩDu f σ (cJ , ηℓ (J)) φJ = XK∈ΩDu
≈ Xθ,θ′∈Θm0 : θ6=θ′ XQ∈ΩDu

λQ Z[θ(Q)

1
n+1−α
|πK|

n

φdµη

u ,

(m0)
ΩDu

f dσ ,

1Gu (cJ , ηℓ (J)) µJ φJ =ZcK ′
(K)ZK ′′
XK ′∈C

(K)ZcK ′
f d (σ × δ0) Z\θ′(Q)

φdµη
u,

φdµη
u

(m0)
ΩDu

X

(K)ZK ′′

(m0 )
ΩDu

f dσ

K ′′∈C

(m0 +1)
ΩDu

(πK)\C

n

1

n+1−α

|Q|

collection of pairs by

where Θm0 = {−1, 1}m0 labels the locations of the grandchildren at generation m0 of a given dyadic qua-
if Q ∈ ΩDu. Note that we actually do not sum over all the pairs of distinct
sicube, and where λQ =
θ, θ′ ∈ Θm0, but rather only over those pairs(cid:0)θ, θ′(cid:1) in which the locations θ and θ′ belong (denoted ֒→) to
diﬀerent children θ1 and θ′1 with (cid:0)θ1, θ′1(cid:1) ∈ Θ1 at the ﬁrst generation, and we will denote this restricted

By Hyt¨onen’s bilinear inequality in Theorem 6.8 of [Hyt2] for the bilinear operator

Υm0 ≡(cid:8)(cid:0)θ, θ′(cid:1) ∈ Θm0 : θ ֒→ θ1 and θ′ ֒→ θ′1 with (cid:0)θ1, θ′1(cid:1) ∈ Θ1 and θ1 6= θ′1(cid:9) .
f dσ(cid:19)(cid:18)Zdθ′Q

u(cid:19) ,
Λθ,θ′,u (f, g) ≡ XQ∈ΩDu
ﬁniteness of the following three quantities, taken over all(cid:0)θ, θ′(cid:1) ∈ Υm0, is necessary and suﬃcient for (42)

f d (σ × δ0) Z\θ′(Q)

u = XQ∈ΩDu

n (cid:18)ZθQ

λQ Z[θ(Q)

to hold:

φdµη

φdµη

|Q|

n+1−α

1

(43)

U ≡

sup

Q∈ΩDu

|Q|1+ 1

T ≡

sup

Q∈ΩDu

kφkL2(µ

η

u)=1

T ∗ ≡

sup

Q∈ΩDu

kfkL2(σ)=1

u

,

1

1

1

n − α

nr|θ (Q)|σ(cid:12)(cid:12)(cid:12)dθ′Q(cid:12)(cid:12)(cid:12)µη
n (cid:18)ZθK
p|Q|σ XK⊂Q
n (cid:18)ZθK
XK⊂Q
r(cid:12)(cid:12)(cid:12)bQ(cid:12)(cid:12)(cid:12)µη

|K|1+ 1

|K|1+ 1

n − α

n − α

1

1

u

φdµη

dσ(cid:19)(cid:18)Zdθ′K
f dσ(cid:19)(cid:18)Z dθ′K

Q∈ΩDu

u(cid:19) = sup
u(cid:19) = sup

Q∈ΩDu

dµη

n

1

n − α

(cid:13)(cid:13)(cid:13)(cid:13)(cid:13)(cid:13)
XK⊂Q
|θK|σ
p|Q|σ
|K|1+ 1
(cid:13)(cid:13)(cid:13)(cid:13)(cid:13)(cid:13)(cid:13)
XK⊂Q
r(cid:12)(cid:12)(cid:12)bQ(cid:12)(cid:12)(cid:12)µη

|K|1+ 1

(cid:12)(cid:12)(cid:12)dθ′K(cid:12)(cid:12)(cid:12)µη

1

u

u

n − α

n

,

,

u)

1dθ′K(cid:13)(cid:13)(cid:13)(cid:13)(cid:13)(cid:13)L2(µη
1θK(cid:13)(cid:13)(cid:13)(cid:13)(cid:13)(cid:13)(cid:13)L2(σ)

(44)

(45)

taken over all dyadic quasicubes I ∈ ΩDu. Here we have for any measure dν (y),

TWO WEIGHT BOUNDEDNESS

33

where for all dyadic quasicubes Q ∈ ΩDu, we denote by bQ = Q× [0, ℓ (Q)) the quasibox over Q in the upper

half-space Rn+1
+ .

The ﬁrst condition U < ∞ is easy to establish since

u

(cid:12)(cid:12)(cid:12)\θ′ (Q)(cid:12)(cid:12)(cid:12)µη
n!2

n − α

1

gives

 

|Q|1+ 1

=

Qdy,0
ΩDu

X(cJ ,ηℓ(J)):

(cJ ,ηℓ(J))⊂θ′(Q)

|θ (Q)|σ(cid:12)(cid:12)(cid:12)\θ′ (Q)(cid:12)(cid:12)(cid:12)µη

u ≤  

XF∈F :
F,J x(cid:13)(cid:13)2
J∈Mr−deep(F )(cid:13)(cid:13)Pω
n!2
|θ (Q)|σ XF∈F
n(cid:12)(cid:12)θ′ (Q)(cid:12)(cid:12)ω
(cid:12)(cid:12)θ′ (Q)(cid:12)(cid:12)1+ 1

|θ (Q)|σ
|θ (Q)|1+ 1

|Q|1+ 1

n − α

n − α

n− α

ℓ (Q)

1

n

n

2

. τ

L2(ω) ≤ XF∈F XJ∈Mr−deep(F ):

J⊂θ′(Q)

(cid:13)(cid:13)Pω
F,J x(cid:13)(cid:13)2

L2(ω)

J∈Mr−deep(F ): J⊂θ′(Q)(cid:13)(cid:13)Pω

X

F,J x(cid:13)(cid:13)2

L2(ω)

. τ Aα
2 ,

since the quasicubes θ (Q) and θ′ (Q) are either well separated or neighbours.

We will now show that the two conditions T < ∞ and T ∗ < ∞ follow from T . Pforward and T ∗ .
Pbackward where Pforward and Pbackward are the best constants inthe following two local continuous testing
conditions that are local analogues of testing conditions used in [SaShUr7]:

ZbIhPα(cid:16)1I\ m1
η Q(x,t)σ(cid:17) (x, t)i2
ZIhQα(cid:16)t1bI µη
u(cid:17) (y)i2
Pαν (x, t) ≡ZRn

forward |I|σ ,

dµη

u (x, t) ≤ P2
backwardZbI

dσ(y) . P2

t2dµη

u(x, t),

t

dν (y) ,

t

2

(cid:16)t2 + |x − y|2(cid:17) n+1−α
dλ (x, t) =ZV (y)
Q (x, t)(cid:27) .

m1
η

2

(cid:16)t2 + |x − y|2(cid:17) n+1−α
V (y) =(cid:26)(x, t) : y /∈

and for any measure dλ (x, t),

Qα (λ) (y) ≡Z{(x,t):y /∈ m1

η Q(x,t)}

with

t

(cid:16)t2 + |x − y|2(cid:17) n+1−α

2

dλ (x, t) ,

In the continuous testing conditions (44) and (45), the measure µη

u is given by dµη

u (x, t) = dµη
u(x,t)
t2

.

Remark 9. The reason for passing to these continuous testing conditions here, rather than controlling the
dyadic quantities T and T ∗ directly, is that we have already controlled these continuous testing conditions
in [SaShUr7] when the measures have no common point masses. Since the diﬃculty with common point
masses manifests itself in part by requiring diﬀerent grids to be used simultaneously, the familiar advantages
of nested grids largely disappear here, and it is more eﬃcient to import the arguments from [SaShUr7]. Key
diﬀerences arise however, both in Lemma 14 below, and in our treatment of the backward Poisson testing
condition (45), in which we require the punctured Muckenhoupt conditions Aα,punct

and Aα,∗,punct

.

2

2

We turn ﬁrst to the second condition in (43), the one that involves T :

which because µη

u is supported in the set Gu, can be rewritten as

+  XK⊂I
ZRn+1
XK⊂I: θ′K⊃ m1

η Q(x,t)

|θK|σ
|K|1+ 1

n − α

n

|θK|σ
|K|1+ 1

n− α

n

dµη

1dθ′K!2
1dθ′K (x, t)

2

ZbI

u ≤ T 2 |I|σ ,

I ∈ ΩDu ,

dµη

u (x, t) ≤ T 2 |I|σ ,

I ∈ ΩDu ,

34

E.T. SAWYER, C.-Y. SHEN, AND I. URIARTE-TUERO

where we have used that dθ′K ⊂ bI when K ⊂ I, and also that if a quasicube K arises in the sum in the

deﬁnition of T in (43) with 1dθ′K (x, t) 6= 0 and (x, t) ∈ Gu, then (x, t) = (cJ , ηℓ (J)) for some J with
(46)

Q (cJ , ηℓ (J)) ,

Qdy,0
ΩDu

(cJ , ηℓ (J)) ⊃ Qdy,m0
ΩDu

(cJ , ℓ (J)) ⊃ m1Q (cJ , ℓ (J)) =

m1
η

1dθ′K (x, t) .ZI\ m1

1

by the deﬁnition of Gu and (41), since we have assumed η ≥ 2m0. Then (cJ , ηℓ (J)) ∈ θ′K implies that
θ′K ⊃ Qdy,0
ΩDu

(cJ , ηℓ (J)) and (46) shows that θ′K contains m1

η Q (x, t). We claim the pointwise bound

XK⊂I: θ′K⊃ m1

|θK|σ
|K|1+ 1

n

(47)

n − α

η Q(x,t)

η Q(x,t)

(x, t) ∈bI.
Recall that the pair(cid:0)θ, θ′(cid:1) ∈ Υm0 is ﬁxed. In the left hand side of (47), we sum only over those quasicubes θ′K
n for y ∈ θK. The quasicubes θ′K that
η Q (x, t) form a nested tower, and from(cid:0)θ, θ′(cid:1) ∈ Υm0, we see that the quasicubes θK are pairwise

that contain m1
contain m1
disjoint as K ranges over quasicubes K $ I. It follows that we have the pointwise bound (47), and this
completes the proof that T . Pforward.

η Q (x, t). From this we obtainqt2 + |x − y|2 ≈ |K|

(cid:16)t2 + |x − y|2(cid:17) n+1−α

dσ (y) ,

Now we turn to the condition involving T ∗ which can be rewritten as

2

1

since θK ⊂ I when K $ I. We claim the pointwise bound,

2

XK$I
ZI
(cid:12)(cid:12)(cid:12)dθ′K(cid:12)(cid:12)(cid:12)µη

|K|1+ 1

u

n − α

n

|K|1+ 1

u

n

n − α

(cid:12)(cid:12)(cid:12)dθ′K(cid:12)(cid:12)(cid:12)µη

1θK (y)
1θK (y) .ZbI∩V (y)

dσ (y) ≤ T ∗2(cid:12)(cid:12)(cid:12)bI(cid:12)(cid:12)(cid:12)µη

u

1

(cid:16)t2 + |x − y|2(cid:17) n+1−α

2

,

I ∈ ΩDu ,

dµη

u (x, t) ,

y ∈ I.

(48)

XK$I

u, then θ′K ⊃ m1

η Q (x, t) by (46), and since θK ∩ θ′K = ∅, we have y /∈ m1

η Q (x, t),
which implies that (x, t) ∈ V (y) by deﬁnition of V (y). Now for ﬁxed y ∈ I, the quasicubes θK that contain

Recall that the pair(cid:0)θ, θ′(cid:1) ∈ Υm0 is ﬁxed. We claim that if y ∈ θK, then dθ′K ∩ supp µη
u ⊂ bI ∩ V (y). Indeed,
if (x, t) ∈ dθ′K ∩ supp µη
y form a nested tower, and since(cid:0)θ, θ′(cid:1) ∈ Υm0, the quasicubes dθ′K are pairwise disjoint as K ranges over
the quasicubes K $ I. We also haveqt2 + |x − y|2 ≈ |K|
n for (x, t) ∈ dθ′K. Thus we have the pointwise
bound (48), and this completes the proof that T ∗ . Pbackward.
8.2. Continuous Poisson testing. We now turn to proving the continuous local Poisson testing conditions
(44) and (45) by showing that both Pforward .qAα,∗2 + E 2

Similar testing conditions have been considered in [SaShUr7] ‘without holes’, and the proofs there carry over
to the situation here, but careful attention must be paid to the ‘holes’ that are now included. One new diﬃ-
culty we face is derived from the fact that the quasigrids ΩD and ΩDu used here are diﬀerent quasigrids, as
opposed to the common quasigrid used in [SaShUr7]. A second new diﬃculty arises in the appearance of the
energy Muckenhoupt bounds Aα,energy
, which require control by the punctured Muckenhoupt
conditions Aα,punct

and Pbackward .qAα

. The following elementary Poisson inequalities will be used extensively.

and Aα,∗,energy

and Aα,∗,punct

α + Aα,punct

2 + E∗2

2

2

2

2

1

2

2

α + Aα,∗ punct

.

Lemma 12. Suppose that J, K, I are quasicubes satisfying J ⊂ K ⊂ 2K ⊂ I, and that µ is a positive
measure supported in Rn \ I. Then

Now we record the bounded overlap of the projections Pω

F,J .

Pα (J, µ)

1
n

|J|

.

Pα (K, µ)

1
n

|K|

.

Pα (J, µ)

1
n

|J|

.

TWO WEIGHT BOUNDEDNESS

35

F,J is as above and ﬁx any I0 ∈ ΩD, so that I0, F and J all lie in a common

Lemma 13. Suppose Pω
quasigrid. If J ∈ Mr−deep (F ) for some F ∈ F with F % I0 and Pω
F I0 for some 0 ≤ ℓ ≤ τ .

F = π(ℓ)

As a consequence we have the bounded overlap,

F,J 6= 0, then

#(cid:8)F ∈ F : J ⊂ I0 $ F for some J ∈ Mr−deep (F ) with Pω
for some ℓ > τ , then either J′ ∩ π(0)
F I0, we cannot have J′ contained in J, and this shows that Pω

Proof. Indeed, if J′ ∈ Cgood,τ−shift
J ⊂ I0 ⊂ π(0)

F I0

π(ℓ)

π(ℓ)

F,J 6= 0(cid:9) ≤ τ .
F I0 = ∅ or J′ ⊃ π(0)

= 0.

F I0,J

F I0. Since
(cid:3)

Finally we record the only place in the proof where the xreﬁned quasienergy condition is used. This lemma
will in turn be used in bounding both of the local continuous Poisson testing conditions. For the second
estimate in the lemma below we use the following three deﬁnitions.
Deﬁnition 13. Suppose that J and I live in possibly diﬀerent dyadic grids. We use the notation J ∼ I to
mean that J ∩ I 6= ∅ with ℓ (J) ≤ 1

η ℓ (I).

We next deﬁne a more general localization of the projection

Pω
F,J ≡ Pω

Cgood,τ −shift

F

=

;J

X

F

J ′⊂J: J ′∈Cgood,τ −shift

△ω

J ′

to the intersection of J ∈ ΩD with a quasicube I ∈ ΩDu, with the novelty here being that J and I come
from diﬀerent grids.
Deﬁnition 14. Suppose that J ∈ ΩD and I ∈ ΩDu. Then deﬁne

Pω
F,J∩I ≡ Pω

Cgood,τ −shift

F

=

;J∩I

X

J ′⊂J∩I: J ′∈Cgood,τ −shift

F

△ω
J ′.

Since J′ in the deﬁnition above is good with respect to both quasigrids ΩD and ΩDu, we have

Pω

F,J =

Xθ(I)∈CΩDu (πΩDu I)

Pω
F,J∩θ(I) .

The following notion of mesh will help pigeonhole large dyadic quasicubes not in the same grid.

Deﬁnition 15. Fix quasigrids J = ΩD and I = ΩDu. Given J ∈ J , let LI be the smallest integer in
such that J ⊂ 3K for some K ∈ I with ℓ (K) = LI. Then deﬁne the I-mesh MI (J) to
consist of the I-quasicubes K that intersect J and have side length LI:

(cid:8)m1 · 2k(cid:9)k∈Z

MI (J) ≡ {K ∈ I : K ∩ J 6= ∅ and ℓ (I) = LI} .

Clearly there are at most 3n I-quasicubes in MI (J). See Figure 1.
Recall that SΩD consists of all shifted ΩD-dyadic quasicubes where K is shifted if it is a union of 2n

ΩD-dyadic quasicubes K′ with ℓ (K′) = 1
Remark 10. The following lemma is another of the key results on the way to the proof of our theorem.
The ﬁrst half of the following lemma is an analogue of the corresponding lemma from [SaShUr7], but with
the right hand side involving only the plugged energy constants and the energy Muckenhoupt constants. In
the second half of the following lemma, the shifted quasicube I0 is permitted to lie in one of the diﬀerent
quasigrids ΩDu for 1 ≤ u ≤ mn
1 .

2 ℓ (K).

be as above with J, F in the dyadic

Lemma 14. Let ΩD,F ⊂ΩD be quasigrids and (cid:8)Pω
F,J(cid:9)

quasigrid ΩD. For any shifted quasicube I0 ∈ SΩD deﬁne

F∈F

J∈Mr−deep(F )

(49)

B (I0) ≡

X

F∈F : F %I ′

0 for some I ′

0∈C(I0)

XJ∈Mr−deep(F ): J⊂I0  Pα (J, 1I0σ)

|J|

1
n

!2

(cid:13)(cid:13)Pω
F,J x(cid:13)(cid:13)2

L2(ω)

.

36

E.T. SAWYER, C.-Y. SHEN, AND I. URIARTE-TUERO

Figure 1. Four quasisquares in the I-mesh MI (J)

Then

+ Aα,energy
(50)
If more generally, for any shifted quasicube I0 ∈ SΩDu we deﬁne

B (I0) . τ(cid:16)(cid:0)E plug

(cid:1)2

2

α

(cid:17)|I0|σ .
XJ∈Mr−deep(F ): J∼I0  Pα (J, 1I0σ)
!2
(cid:17) |I0|σ .

+ Aα,energy

|J|

1
n

2

Bu (I0) . τ(cid:16)(cid:0)E plug

α

(cid:1)2

Bu (I0) ≡ XF∈F : ℓ(F )>ℓ(I0)

(51)

then

(52)

F,J∩I0

(cid:13)(cid:13)Pω

L2(ω)

x(cid:13)(cid:13)2

,

Proof. We ﬁrst prove the bound (50) for B (I0). So suppose that I0 ∈ SΩD is a shifted ΩD-dyadic quasicube.
Deﬁne

and pigeonhole this collection as Λ (I0) = [I ′

Λ (I0) ≡(cid:8)J ⊂ I0 : J ∈ Mr−deep (F ) for some F % I′0, I′0 ∈ C (I0) with Pω
F,J 6= 0(cid:9) ,
Λ (I′0), where for each I′0 ∈ C (I0) we deﬁne
F,J 6= 0(cid:9) .
F I′0(cid:1)(cid:9) ,

Λ (I′0) ≡(cid:8)J ⊂ I′0 : J ∈ Mr−deep (F ) for some F % I′0 with Pω
Λℓ (I′0) ≡(cid:8)J ⊂ I′0 : J ∈ Mr−deep(cid:0)πℓ

By Lemma 13 we may further pigeonhole the quasicubes J in Λ (I′0) as follows:

τ[ℓ=1

Λ (I′0) =

Λℓ (I′0) ;

0∈C(I0)

since every F % I′0 is of the form πℓ

F I′0 for some ℓ ≥ 1. Altogether then, we have pigeonholed Λ (I0) as

Λ (I0) = [I ′

0∈C(I0)

τ[ℓ=1

Λℓ (I′0) .

Now ﬁx I′0 ∈ C (I0) and 1 ≤ ℓ ≤ τ , and for each J in the pairwise disjoint decomposition Λℓ (I′0) of I′0,

note that either J must contain some K ∈ Mr−deep (I′0) or J ⊂ K for some K ∈ Mr−deep (I0); deﬁne

Λℓ (I′0) = Λbig

ℓ

(I′0) ·∪ Λsmall

ℓ

(I′0) ;

Λsmall

ℓ

(I′0) ≡ {J ∈ Λℓ (I′0) : J ⊂ K for some K ∈ Mr−deep (I′0)} ,

and we make the corresponding decomposition of B (I0);

B (I0) = Bbig (I0) + Bsmall (I0) ;

Bbig / small (I0) ≡ XI ′

0∈C(I0)

τXℓ=0 XJ∈Λbig / small

ℓ

(I ′
0)

  Pα (J, 1I0σ)

1
n

|J|

!2

X
0 and J∈Mr−deep(F )(cid:13)(cid:13)Pω

F,J x(cid:13)(cid:13)2

.

L2(ω)

F∈F : F %I ′

We use the τ -overlap (38) of the projections Pω

F,J , together with Lemma 12 to obtain

TWO WEIGHT BOUNDEDNESS

37

(53)

0∈C(I0)

Bsmall (I0) ≤ τ XI ′
τXℓ=0 XK∈Mℓ
≤ τ XI ′
τXℓ=0 XK ′∈Mℓ
≤ τ XI ′

0∈C(I0)

0∈C(I0)

ℓ

(I ′

τXℓ=0 XJ∈Λsmall
0)  Pα (K, 1I0σ)
0)  Pα (K′, 1I0 σ)

|K|

|K′|

1
n

r−deep(I ′

r−deep(I ′

ℓ

2

2

J

J

1
n

(I0)

L2(ω)

L2(ω)

|J|

J⊂K

!2(cid:13)(cid:13)(cid:13)Pgood,ω
x(cid:13)(cid:13)(cid:13)
(cid:13)(cid:13)(cid:13)Pgood,ω
x(cid:13)(cid:13)(cid:13)
x(cid:13)(cid:13)(cid:13)
2(cid:0)E xreﬁned plug

0)  Pα (J, 1I0σ)
!2 XJ∈Λsmall
!2(cid:13)(cid:13)(cid:13)Pgood,ω
XK∈Mr−deep(I0): K⊂J(cid:13)(cid:13)(cid:13)Pgood,ω

x(cid:13)(cid:13)(cid:13)

L2(ω) +

J ′ xk2

L2(ω)

. τ

K ′

K

1
n

α

2

2

,

L2(ω)

|I0|σ .

(cid:1)2

This is the only point in the proof of Theorem 1 that the xreﬁned quasienergy condition is used.
Turning now to the more delicate term Bbig (I0), we write for J ∈ Λbig

(I0),

ℓ

2

J

(cid:13)(cid:13)(cid:13)Pgood,ω

x(cid:13)(cid:13)(cid:13)

L2(ω)

= XJ ′∈Nr(I): J ′⊂J

k△ω

where Nr (I) ≡ {J′ ⊂ I : ℓ (J′) ≥ 2−rℓ (I)} denotes the set of r-near quasicubes in I, and then using the
τ -overlap (38) of the projections Pω

F,J , we estimate

0∈C(I0)

Bbig (I0) ≤ τ XI ′
+τ XI ′
≡ τ Bbig

1

0∈C(I0)

ℓ (I ′

τXℓ=0 XJ∈Λbig
τXℓ=0 XJ∈Λbig

1
n

|J|

0)  Pα (J, 1I0σ)
0)  Pα (J, 1I0 σ)

!2 XJ ′∈Nr(I ′
!2
XK∈Mr−deep(I ′

0): J ′⊂J

|J|

1
n

ℓ (I ′

(I0) + τ Bbig

2

(I0) .

k△ω

J ′ xk2

L2(ω)

0): K⊂J(cid:13)(cid:13)(cid:13)Psubgood,ω

K

2

L2(ω)L2(ω)

x(cid:13)(cid:13)(cid:13)

Now using that the quasicubes J in each Λbig
and pairwise disjoint, and that there are altogether only 2nr quasicubes in Nr (I′0), we have

(I′0) that arise in the term Bbig

1

ℓ

(I0) are both r-nearby in I′0

Bbig

1

(I0) . τ 2nr

sup
I ′
0∈C(I0)

. τ 2nr  |I0|σ
|I0|1− α

Since

Pα(J,1I0 σ)

1
n

|J|

.

Pα(K,1I0 σ)

1
n

|K|

for K ⊂ J, we have

Bbig

2

(I0) . XI ′

0∈C(I0)

τXℓ=0 XK∈Mr−deep(I ′

2

!2(cid:13)(cid:13)(cid:13)Pgood,ω

J

x(cid:13)(cid:13)(cid:13)

. τ 2nrAα,energy

2

L2(ω)

|I0|σ .

2

1
n

I0

x

|J|

sup
J∈Nr(I ′

0)  Pα (J, 1I0σ)
n!2(cid:13)(cid:13)(cid:13)(cid:13)Pω
ℓ (I0)(cid:13)(cid:13)(cid:13)(cid:13)
!2(cid:13)(cid:13)(cid:13)Psubgood,ω
0)  Pα (K, 1I0 σ)

|K|

L2(ω)

K

1
n

x(cid:13)(cid:13)(cid:13)

2

L2(ω)

. τ(cid:0)E deep plug

α

(cid:1)2

|I0|σ ,

where the ﬁnal inequality follows from the plugged deep energy condition with the trivial outer decomposition

I′0. This completes the proof of (50) in the ﬁrst part of Lemma 14.

I0 = [I ′

0∈C(I0)

Now we turn to proving the bound (52) for Bu (I0) where I0 ∈ SΩDu is a shifted quasicube in the diﬀerent
grid ΩDu, which no longer need contain either F or J. We begin by decomposing the sum Bu (I0) into a

38

E.T. SAWYER, C.-Y. SHEN, AND I. URIARTE-TUERO

sum over those J ∼ I0 which are contained in I0, and those which ‘cut across I0’:

Bu (I0) = Bcontained

(I0) + Bcutacross

(I0) ;

u

u

Bcontained

u

(I0) ≡

Bcutacross

u

(I0) ≡

XF∈F : ℓ(F )>ℓ(I0)
XF∈F : ℓ(F )>ℓ(I0)

XJ∈Mr−deep(F ):

J⊂I0 and ℓ(J)≤ 1

η ℓ(I0)

  Pα (J, 1I0σ)

1
n

!2

|J|

XJ∈Mr−deep(F ):

J∩I06=∅, J∩I c

06=∅ and ℓ(J)≤ 1

η ℓ(I0)

F,J∩I0

,

L2(ω)

(cid:13)(cid:13)Pω
  Pα (J, 1I0σ)

1
n

|J|

x(cid:13)(cid:13)2
!2
(cid:13)(cid:13)Pω

F,J∩I0

,

L2(ω)

x(cid:13)(cid:13)2

and proving

(54)

Bcontained

u

(I0) . τ(cid:16)(cid:0)E plug
(cid:1)2
(cid:1)2
(I0) . τ(cid:0)E plug

α

+ Aα,energy

2

(cid:17)|I0|σ ,

|I0|σ .
In order to adapt the above proof of (50) to the sum Bcontained

α

Bcutacross

u

(I0), we ﬁrst claim that if ℓ (F ) > ℓ (I0),
then F must contain one of the quasicubes I′0 in the mesh MΩDu (I0) of I0. Indeed, since both ℓ (F ) and
ℓ (I0) are powers of 2, we have ℓ (F ) ≥ 2ℓ (I0). In dimension n = 1, the claim is now obvious since every
interval [a, a + 2), a ∈ R, must contain [k, k + 1) for some k ∈ Z. An easy induction now yields the claim in
general. Now we note that for each J′ that arises in Bu (I0), i.e.

u

J′ ∈ Cgood,τ−shift

F

and J′ ⊂ J for some J ∈ Mr−deep (F ) with ℓ (F ) > ℓ (I0) , J ∼ I0 ,

(55)

Bcontained

there is I′0 in the ΩDu-mesh MΩDu (I0) such that I′0 ⊂ F and J′ ⋐r I0 and J′ ⋐r F where F ∈ F , F ∩ I0 6=
F F ′, where cMF (I0) is a
∅, ℓ (F ) ≥ 2ℓ (I0). Thus there is F ′ ∈ cMF (I0) such that J′ ⊂ J ⊂ F ′ ⊂ F = πℓ
close relative of the ΩDu-mesh MΩDu (I0) that is deﬁned to consist of the minimal stopping quasicubes in
F that contain a quasicube I′ ∈ MΩDu (I0). Thus we have
!2(cid:13)(cid:13)(cid:13)Pω
F F ′,J x(cid:13)(cid:13)(cid:13)

(I0) ≤ XF ′∈ cMF (I0)

  Pα (J, 1I0σ)

J∈Mr−deep(πℓ

F F ′): J⊂I0

X

If we deﬁne fMF (I0) to consist of the minimal stopping quasicubes in F that contain a quasicube I′ ∈
CΩDu (I0), then B (I0) is the same as the right hand side of (55) except that cMF (I0) is replaced by fMF (I0).
An inspection of the argument for (50) now shows that it applies with just the change fMF (I0) → cMF (I0)

Now we turn to proving the estimate for Bcutacross

to prove the estimate for Bcontained

(I0) in (54). As above, we have

(I0) in (54).

τXℓ=0

|J|

L2(ω)

πℓ

1
n

u

u

2

.

u

Bcutacross

u

(I0) ≤ XF ′∈ cMF (I0)

τXℓ=0

XJ∈Mr−deep(πℓ

F F ′):

J∩I06=∅, J∩I c

06=∅ and ℓ(J)≤ 1

η ℓ(I0)

  Pα (J, 1I0 σ)

1
n

|J|

!2(cid:13)(cid:13)(cid:13)Pω

πℓ

F F ′,J x(cid:13)(cid:13)(cid:13)

2

L2(ω)

,

where the only diﬀerence here is that instead of having J ⊂ I0 we have
(56)

J ∩ I0 6= ∅, J ∩ I c

0 6= ∅ and ℓ (J) ≤

1
η

ℓ (I0) .

From (56) we have

ℓ (J′) ≤ ℓ (J) ≤

1
η

ℓ (I0) < 2−rℓ (I0) ,

since η > 2r, and then since J′ is good with respect to the grid ΩDu, we have J′ ⋐r I0. Thus we also have
J′ ⊂ 3L for some L ∈ Mr−deep (I0), where the dilation factor 3 is necessary since L and J′ live in diﬀerent
quasigrids. Since J ‘cuts across I0’, i.e. (56) holds, we then have |J|

n and

1

1

3J ⊃ 3L and so

Pα (J, 1I0σ)

1
n

|J|

n ≥ 3 |L|
Pα (L, 1I0σ)
.

.

1
n

|L|

TWO WEIGHT BOUNDEDNESS

39

Figure 2. J ∈ Mr−deep (F ) cuts across I0; F large

Figure 3. Detail for F large

See Figure 2 for the zoomed out picture, and Figure 3 for the detail. Thus we have pigeonholed the stopping
quasicubes F that arise in Bu (I0) into a bounded number of collections, where in each such collection, we

have F ⊃ F ′ for some F ′ ∈ cMΩD (I0), and the associated sum to be estimated is

BF ′
u (I0) ≤

!2

1
n

J∈Mr−deep(πℓ

F F ′): 3J⊃3L  Pα (J, 1I0 σ)
X
τXℓ=0 XL∈Mr−deep(I0)
τXℓ=0 XL∈Mr−deep(I0)  Pα (L, 1I0σ)
!2
!2
τXℓ=0 XL∈Mr−deep(I0)  Pα (L, 1I0σ)

J∈Mr−deep(πℓ

X

L2(ω) .

kPω

3Lxk2

|L|

|L|

|J|

1
n

1
n

.

≤

X
X

J ′∈Cgood,τ −shift

F F ′

πℓ

k△ω

J ′ xk2

L2(ω)

: J ′⊂J∩3L

F F ′): 3J⊃3L

J ′∈Cgood,τ −shift

F F ′

πℓ

: J ′⊂J∩3L

τXℓ=0 XL∈Mr−deep(I0)  Pα (L, 1I0 σ)

|L|

1
n

L2(ω)

J ′ xk2
k△ω
!2

kPω

Lxk2

L2(ω) ,

which is controlled by a trivial application of the plugged deep energy constant:

BF ′

u (I0) .(cid:0)E deep plug

α

(cid:1)2

|I0|σ .

Summing over the at most 3n quasicubes F ′ ∈ cMJ (I0), we obtain the estimate for Bcutacross

and this completes the proof of Lemma 14.

u

(I0) in (54),
(cid:3)

40

E.T. SAWYER, C.-Y. SHEN, AND I. URIARTE-TUERO

8.3. The forward Poisson testing inequality. Fix I ∈ ΩDu. We rename the left side of (44) as
(57)

dµη

u (x, t) ;

µη
u =

1
t2 µη

u ≡

Local (I) ≡ZbIhPα(cid:16)1I\ m1
t2 XJ∈ΩD

η Q(x,t)σ(cid:17) (x, t)i2
1Gu (cJ , ηℓ (J)) XF∈F XJ∈Mr−deep(F )(cid:13)(cid:13)Pω

1

F,J x(cid:13)(cid:13)2

Here is a brief schematic diagram of the decompositions, with bounds in , used in this subsection:

L2(ω) · δ(cJ ,ηℓ(J)).

Local (I)

↓

Localplug (I)

↓
↓A
(cid:1)2

α

(cid:0)E deep

+ Localhole (I)

.

α

(cid:0)E deep
(cid:1)2
(Eα)2 + Aα

B

2

+

+ Aα
2

u and ΩDn respectively,
Remark 11. The quasicubes I and J appearing in (57) lie in the quasigrids ΩDn
and these quasigrids are diﬀerent. Recall that the proof of functional energy for the Hilbert transform in
[LaSaShUr3], and the proof that functional energy is implied by energy in higher dimensions [SaShUr7], both
used the two weight Poisson theorem (without holes) in [Saw], and there we were free to choose the grid
of testing cubes I to coincide with the existing grid for J - albeit at the price of having to prove global
testing conditions. The luxury of having I and J in the same grid was a crucial technical assumption in the
subsequent arguments. To circumvent the diﬃculty of dealing with diﬀerent quasigrids for I and J, we will
restrict our deﬁnition of good quasicubes J to include the requirement that J is good with respect to all of the
grids {ΩDu}mn
u=1 ∪ ΩD, and we will choose η ≥ 2r in the deﬁnition of the upper half space atomic measure
dµη so that the inclusion (cJ , ηℓ (J)) ∈ I implies that the good quasicubes J′ that arise in the projection Pω
2 ℓ (J′)ε ℓ (I)1−ε. With this restricted notion of
lie either ouside I or satisfy J′ ⋐r I and qdist (J′, ∂I) ≥ 1
good quasicube in place, we will run the arguments used in [SaShUr7], but with a number of complications
arising.

F,J

1

Assumption: The grids {ΩDu}mn

1

u=1 are uniquely determined by ΩD. With probability 1, no boundary

of a quasicube in ΩD or ΩDu for the random grid ΩD is charged by either σ or ω,

|∂Q|σ+ω = 0,

Q ∈ {ΩDu}mn

u=1 ∪ ΩD.

1

We will henceforth assume this additional property.

Recall that for quasicubes J ∈ ΩD and I ∈ ΩDu, we have both

F,J∩I ≡ Pω
Pω

Cgood,τ −shift

F

;J∩I

Pω

F,J =

Xθ(I)∈CΩDu (πΩDu I)

The key property for us now is this:

=

X

△ω
J ′,

J ′⊂J∩I: J ′∈Cgood,τ −shift
Pω
F,J∩θ(I) .

F

Recall that J and F live in the quasigrid ΩD, and that I lives in the diﬀerent quasigrid ΩDu. We split

each atom

into ﬁnitely many pieces according to the ΩDu-mesh MΩDu (J) as follows. For each K ∈ MΩDu (J) deﬁne
cK (J) to be the ‘center’ of J ∩ K (R = Ω−1 (J ∩ K) is a rectangle in Rnand so has a well-deﬁned center

F

(cJ , ηℓ (J)) ∈bI and J′ ∈ Cgood,τ−shift
F,J x(cid:13)(cid:13)2

XF∈F : J∈Mr−deep(F )(cid:13)(cid:13)Pω

∇J ≡

and J′ ⊂ J imply J′ ⋐r I .

L2(ω) · δ(cJ ,ηℓ(J)) = µJ · δ(cJ ,ηℓ(J))

c (R); we set cK (J) = c (R)) and let

TWO WEIGHT BOUNDEDNESS

41

L2(ω) · δ(cK (J),ηℓ(J)) = µK

J · δ(cK (J),ηℓ(J)) ;

∇K
J ≡

XF∈F : J∈Mr−deep(F )(cid:13)(cid:13)Pω
XF∈F : J∈Mr−deep(F )(cid:13)(cid:13)Pω

F,J∩K x(cid:13)(cid:13)2
F,J∩K x(cid:13)(cid:13)2
at the translated points(cid:0)cK (J) , ηℓ (J)(cid:1) for K ∈ MI (J).

µK
J ≡

L2(ω)

.

Now we will use the following inequality for the term Local (I),

Thus we have redistributed the positive mass µJ at the point (cJ , ηℓ (J)) into a sum of positive masses µK
J

(58)

hPα(cid:16)1I\ m1

η Q(cJ ,ηℓ(J))σ(cid:17) (cJ , ηℓ (J))i2

µJ ≤ XK∈MI (J)(cid:2)Pα (1I σ)(cid:0)cK

J , ηℓ (J)(cid:1)(cid:3)2

µK

J ,

u

u

(59)

µ⊞,η

be the redistribution of the measure µη

Thus to prove the estimate we want for Pforward in (44), it suﬃces to prove,

J . Note that
we are plugging the hole in the Poisson integral since we have both the plugged energy and Muckenhoupt
conditions at our disposal. Let µ⊞,η

which follows immediately from the above decomposition of the point mass ∇J =PK∈MI (J) ∇K
u =PJ∈ΩD ∇J given by
F,J∩Kx(cid:13)(cid:13)2
.(cid:0)Aα,∗2 + E 2
whereePα is the renormalized Poisson integral without holes, which is equivalent to
F,J∩K∩I x(cid:13)(cid:13)2

J ≡ XJ∈ΩD
∇K
(x, t) ≡(cid:13)(cid:13)(cid:13)ePα (1I σ)(cid:13)(cid:13)(cid:13)
n XF∈F :
J∈Mr−deep(F )(cid:13)(cid:13)Pω

≡ XJ∈ΩD XK∈MΩDu (J)
ZbI

XJ∈ΩD XK∈MΩDu (J)(cid:2)Pα (1Iσ)(cid:0)cK

XF∈F : J∈Mr−deep(F )(cid:13)(cid:13)Pω

.(cid:0)Aα,∗2 + E 2

J , ηℓ (J)(cid:1)(cid:3)2

L2(ω) · δ(cK(J),ηℓ(J)).

[Pα (1I σ) (x, t)]2 dµ⊞,η

α(cid:1)|I|σ .

α(cid:1)|I|σ ,

1
|J|

L2(bI,µ

(60)

L2(ω)

⊞,η
u )

u

2

2

to write Local′ (I) = Localplug (I) + Localhole (I), where the plugged local term Localplug (I) is given by

Now the left hand side LHS of (60) satisﬁes

(61)

LHS . XF∈F

We now use

J∩I6=∅ and ℓ(J)≤2−rℓ(I)

!2

  Pα (J, 1Iσ)

1
n

|J|

XJ∈Mr−deep(F )

L2(ω) ≡ Local′ (I) .

(cid:13)(cid:13)Pω
F,J∩I x(cid:13)(cid:13)2
Pα (J, 1I σ) = Pα(cid:0)J, 1I\F σ(cid:1) + Pα (J, 1F∩Iσ)
XJ∈Mr−deep(F )
F,J∩I x(cid:13)(cid:13)2
(cid:13)(cid:13)Pω
  Pα (J, 1F∩Iσ)
!2
(cid:13)(cid:13)Pω
F,J∩I x(cid:13)(cid:13)2

  Pα (J, 1F∩I σ)

XJ∈Mr−deep(F )

+ XF∈FF∩I6=∅

J∩I6=∅ and ℓ(J)≤2−rℓ(I)

!2

J∩I6=∅

|J|

|J|

L2(ω)

1
n

1
n

ℓ(F )>ℓ(I)

ℓ(J)≤2−rℓ(I)

L2(ω)



(62)

Localplug (I) ≡ XF∈F



=

XF∈F : F⊂I

+ XF∈F : F6⊂I

F∩I6=∅
ℓ(F )≤ℓ(I)

= A + B + C.

42

E.T. SAWYER, C.-Y. SHEN, AND I. URIARTE-TUERO

Figure 4. J cuts across I and F is small

Then a trivial application of the deep quasienergy condition (where ‘trivial’ means that the outer decompo-
sition is just a single quasicube) gives

A ≤ XF∈F : F⊂I XJ∈Mr−deep(F )  Pα (J, 1F∩I σ)

|J|

!2

1
n

(cid:13)(cid:13)Pω
F,J∩I x(cid:13)(cid:13)2
|F ∩ I|σ .(cid:0)E 2

α + Aα

(cid:1)2

L2(ω)

2 + Aα,punct

2

(cid:1)|I|σ ,

≤

α

XF∈F
F∩I6=∅ and ℓ(F )≤ℓ(I) (cid:0)E deep plug
x(cid:13)(cid:13)(cid:13)
F,J∩I x(cid:13)(cid:13)2

=(cid:13)(cid:13)(cid:13)Pgood,ω

2

since if F ⊂ I then(cid:13)(cid:13)Pω

J
a σ-Carleson measure estimate as in (35).

L2(ω)

For term B we pigeonhole the good J′ that arise in the projections Pω

F,J∩I into groups contained in triples
3L of quasicubes L ∈ Mr−deep (I) and use deep quasienergy. Indeed, suppose J′ ⋐r I with J′ ⊂ J and
J ∩ I c 6= ∅. Then there is L ∈ Mr−deep (I) with J′ ⊂ 3L. The key point to observe now is that 3J ⊃ 3L.
See Figure 4.

Thus we have Pα(J,1F ∩I σ)

. Pα(L,1I σ)

, and so with

1
n

|J|

1
n

|L|

. We also used that the stopping quasicubes F satisfy

L2(ω)

Qω
I ≡

XF∈F : F6⊂I

F∩I6=∅ and ℓ(F )≤ℓ(I)

XJ∈Mr−deep(F )

J∩I6=∅ and ℓ(J)≤2−rℓ(I)

Pω
F,J∩I,

and using bounded overlap of the the cubes 3L, we obtain that term B satisﬁes

(63)

B .

.

1
n

|L|

XL∈Mr−deep(I)  Pα (L, 1Iσ)
!2 XJ ′∈Qω
!2(cid:13)(cid:13)(cid:13)Pgood,ω
XL∈Mr−deep(I)  Pα (L, 1Iσ)
C ≤ τ(cid:16)(cid:0)E plug
(cid:1)2

|L|

1
n

L

α

2

+ Aα,energy

I : J ′⊂3L
2

L2(ω)

x(cid:13)(cid:13)(cid:13)
(cid:17)|I|σ .

L2(ω)

J ′ xk2
k△ω
.(cid:0)E deep plug

α

|I|σ .

(cid:1)2

For term C we use Lemma 14 with I0 = I to immediately obtain the bound

It now remains to prove the appropriate inequality with ‘holes’, where the support of σ is restricted to
the complement of the quasicube F . Thus for J ∈ Mr−deep (F ) we may use I \ F in the argument of the
Poisson integral. Now note

TWO WEIGHT BOUNDEDNESS

43

Lemma 15. We have

(64)

Localhole (I) = XF∈F

XJ∈Mr−deep(F )

J∩I6=∅ and ℓ(J)≤2−rℓ(I)

  Pα(cid:0)J, 1I\F σ(cid:1)

1
n

!2

|J|

(65)

Local′ (L) .(cid:16)(Eα)2 + Aα

2 + Aα,punct

2

L2(ω)

.(cid:0)E deep

α

(cid:1)2

|I|σ .

(cid:13)(cid:13)Pω
F,J∩I x(cid:13)(cid:13)2
(cid:17)|L|σ , L ∈ ΩD.

Details are left to the reader, or see [SaShUr6] for a proof. This completes the proof of the estimate

8.3.1. The shifted local estimate. For future use, we note an extension of the local estimate Local′ (L) to
shifted quasicubes M ∈ SΩD.
Lemma 16. With notation as above and M ∈ SΩDu a shifted quasicube,
(66)

Local′ (M ) ≡ XF∈F

J∩M6=∅ and ℓ(J)≤2−rℓ(M)

XJ∈Mr−deep(F )
2(cid:17) |M|σ , M ∈ SΩD.

. (cid:16)(Eα)2 + Aα

Again details are left to the reader, or see [SaShUr6] for a proof.

  Pα (J, 1M σ)

1
n

!2

|J|

(cid:13)(cid:13)Pω
F,J∩M x(cid:13)(cid:13)2

L2(ω)

8.4. The backward Poisson testing inequality. Fix I ∈ ΩDu. It suﬃces to prove
(67)

Local (I) ≡ ZIhQα(cid:16)t1bI µ⊞,η
u (cid:17) (y)i2
(cid:26)Aα
2 +(cid:16)E xreﬁned plug

α

dσ(y) .

+pAα

2(cid:17)qAα,punct

2

(cid:27)ZbI

t2dµ⊞,η

u (x, t).

Note that in dimension n = 1, Hyt¨onen obtained in [Hyt2] the simpler bound Aα
(67). Here is a brief schematic diagram of the decompositions, with bounds in , used in this subsection:

2 for the term analogous to

Local (I)

↓Us

↓T proximal
Aα
2 + E xreﬁned plug

α

s

qAα,punct

2

Note that the right hand side of (67) is

+

V remote

s

↓
↓

s

T diﬀerence
Aα
2 + E xreﬁned plug

α

qAα,punct

2

.

+

T intersection

s

E xreﬁned plug

α

pAα

2

(68)

ZbI

t2dµ⊞,η

u = XF∈F XJ∈Mr−deep(F )

J∼I

kPω

F,J∩I xk2

L2(ω) .

where Pω

F,J∩I and J ∼ I were deﬁned earlier. Suppose that J and I live in diﬀerent dyadic grids. Then
η ℓ (I), or that (x, t) =

(x, t) ∈ bI means either that (x, t) = (cJ , ηℓ (J)) for some J ⊂ I with ℓ (J) ≤ 1
(cJ∩I , ηℓ (J)) with ℓ (J) ≤ 1

η ℓ (I). In either case we have J ∼ I.

44

E.T. SAWYER, C.-Y. SHEN, AND I. URIARTE-TUERO

We now compute using that

(69)

u (cid:17) (y) =ZbI∩V (y)

Qα(cid:16)t1bI µ⊞,η
= Z{(x,t)∈bI: y /∈ m1

t2

(cid:16)t2 + |x − y|2(cid:17) n+1−α

2

1

dµ⊞,η

dµ⊞,η

u

(x, t)

(x, t)

=

XJ∼I

y /∈m1Q(cJ ,ℓ(J))

= XF∈F XJ∈Mr−deep(F )

J∼I and y /∈m1J

2

2

u

1

η Q(x,t)}

(cid:16)t2 + |x − y|2(cid:17) n+1−α
hℓ (J)2 + |cJ − y|2i n+1−α
(cid:13)(cid:13)Pω
F,J∩I x(cid:13)(cid:13)2
n + |y − cJ|(cid:17)n+1−α ,
(cid:16)|J|
(cid:13)(cid:13)Pω
F,J∩I x(cid:13)(cid:13)2
ZI\(m1J∪m1J ′)
(cid:16)|J|
n + |y − cJ|(cid:17)n+1−α

L2(ω)

L2(ω)

1

1

XF∈F

J∼I

J∈Mr−deep(F )

XF ′∈F :

J ′∼I

J ′∈Mr−deep(F ′)

and then expand the square and integrate to obtain that the term Local (I) is

XF∈F
J∈Mr−deep(F )(cid:13)(cid:13)Pω

F,J∩I x(cid:13)(cid:13)2

L2(ω)

(cid:13)(cid:13)Pω
F ′,J ′∩I x(cid:13)(cid:13)2
n + |y − cJ ′|(cid:17)n+1−α dσ (y) .
(cid:16)|J′|

L2(ω)

1

Note that there are three essential diﬀerences between this term Local (I) and the corresponding local
term in [SaShUr7]. First, the σ-integration in [SaShUr7] is taken over the quasicube I as opposed to the
smaller set I \ (m1J ∪ m1J′) here. Second, the notation J ∼ I includes quasicubes J that are not contained
F ′,J ′∩I are restricted to quasicubes J′′ ⊂ J and J′′ ⊂ J′
in I, and third, the projections Pω
respectively that are deeply embedded in I as well as J and J′ respectively. These latter two diﬀerences
correspond to the fact that we are integrating with respect to the redistributed measure µ⊞,η
u . By this same
token, our bound will be in terms of µ⊞,η

as well, as required by (67).

F,J∩I and Pω

and J′ with ℓ (J′) = 2−sℓ (J). For ﬁxed s we will control the expression

By symmetry we may assume that ℓ (J′) ≤ ℓ (J). We ﬁx an integer s, and consider those quasicubes J
Us ≡ XF,F ′∈F

(cid:13)(cid:13)Pω
F ′,J ′∩I x(cid:13)(cid:13)2
n + |y − cJ ′|(cid:17)n+1−α dσ (y) ,
(cid:16)|J′|

(cid:13)(cid:13)Pω
F,J∩I x(cid:13)(cid:13)2
(cid:16)|J|
n + |y − cJ|(cid:17)n+1−α

ZI\(m1J∪m1J ′)

XJ∈Mr−deep(F ),

J ′∈Mr−deep(F ′)

L2(ω)

L2(ω)

1

1

u

J,J ′∼I, ℓ(J ′)=2−sℓ(J)

by proving that

(70)

Us . 2−εsAα
2 .

With this accomplished, we can sum in s ≥ 0 to control the term Local (I). See [SaShUr7] or [SaShUr6] for
the remaining straightforward details of the proof.

9. The stopping form

This section is virtually unchanged from the corresponding section in [SaShUr7], so we content ourselves
with a brief recollection. In the one-dimensional setting of the Hilbert transform, Hyt¨onen [Hyt2] observed
that ”...the innovative veriﬁcation of the local estimate by Lacey [Lac] is already set up in such a way that
it is ready for us to borrow as a black box.” The same observation carried over in spirit regarding the
adaptation of Lacey’s recursion and stopping time to proving the local estimate in [SaShUr7]. However,
that adaptation involved the splitting of the stopping form into two sublinear forms, the ﬁrst handled by
methods in [LaSaUr2], and the second by the methods in [Lac]. The arguments are little changed when
including common point masses, and we leave them for the reader (or see [SaShUr6] for the proofs written
out in detail).

TWO WEIGHT BOUNDEDNESS

45

10. Energy dispersed measures

In this ﬁnal section we prove that the energy side conditions in our main theorem hold if both measures
are appropriately energy dispersed. We begin with the deﬁnitions of energy dispersed and reversal of energy.

10.1. Energy dispersed measures and reversal of energy. Let µ be a locally ﬁnite positive Borel
k the collection of all k-dimensional planes in Rn,
measure on Rn. Recall that for 0 ≤ k ≤ n, we denote by Ln
and for a quasicube J, we deﬁne the k-dimensional second moment Mn

k (J, µ) of µ on J by

k (J, µ)2 ≡ inf
Mn
L∈Ln

kZJ

dist (x, L)2 dµ (x) .

Finally we deﬁned µ to be k-energy dispersed if there is c > 0 such that

Mn
k (J, µ) ≥ cMn

0 (J, µ) ,

for all quasicubes J in Rn.

In order to introduce a useful reformulation of the k-dimensional second moment, we will use the obser-
vation that minimizing k-planes L pass through the center of mass. More precisely, for any k-plane L ∈ Ln

k

ZA

Eµ
Ax ∈ L .

dist (x, L)2 dµ (x) = ZA

such thatRA dist (x, L)2 dµ (x) is minimized, where A is a set of positive µ-measure, we claim that
Indeed, if we rotate coordinates so that L =(cid:8)(cid:0)x1, ..., xk, ak+1, ..., an(cid:1) :(cid:0)x1, ..., xk(cid:1) ∈ Rk(cid:9), then
dµ (x)(cid:21)
− 2RA xjdµ (x)
RA dµ (x)

xjdµ (x) +(cid:0)aj(cid:1)2ZA
dµ (x)(cid:19)(cid:26)(cid:0)aj(cid:1)2

dµ (x) − 2ajZA
dµ (x) +(cid:18)ZA

is minimized over ak+1, ..., an when

dµ (x)

=

=

aj(cid:27)(cid:21)

nXj=k+1(cid:0)xj − aj(cid:1)2
nXj=k+1(cid:20)ZA(cid:0)xj(cid:1)2
nXj=k+1(cid:20)ZA(cid:0)xj(cid:1)2
aj = RA xj dµ (x)
RA dµ (x)

= (Eµ

Ax)j ,

k + 1 ≤ j ≤ n.

This shows that the point Eµ

Ax belongs to the k-plane L.

Now we can obtain our reformulation of the k-dimensional second moment. Let Sn
k is the subspace parallel to L, then we have the variance identity,

of k-dimenional subspaces in Rn. If PS denotes orthogonal projection onto the subspace S ∈ Sn
S = L⊥0 and L0 ∈ Sn
(71)

k denote the collection
n−k where

Mn

J x)|2 dµ (x)

kZJ

k (J, µ)2 = inf
L∈Ln
1
2

=

inf
S∈S n

n−k

=

1
2

inf
L0∈S n

k

n−kZJ |PSx − PS (Eµ

dist (x, L)2 dµ (x) = inf
S∈S n

1

|J|µZJZJ |PSx − PSy|2 dµ (x) dµ (y)
|J|µZJZJ

dist (x, L0 + y)2 dµ (x) dµ (y) ,

1

J x) = Eµ

J x of x in J.

since PS (Eµ
through the center of mass Eµ

Note that if µ is supported on a k-dimensional plane L in Rn, then Mn

J (PSx). Here we have used in the ﬁrst line the fact that the minimizing k-planes L pass
k (J, µ) vanishes for all quasicubes J.
On the other hand, Mn
0 (J, µ) is positive for any quasicube J on which the restriction of µ is not a point mass,
and we conclude that measures µ supported on a k-plane. and whose restriction to J is not a point mass, are
not k-energy dispersed. Thus Mn
k (J, µ) measures the extent to which a certain ‘energy’ of µ is not localized
to a k-plane. In this ﬁnal section we will prove the necessity of the energy conditions for boundedness of the
vector Riesz transform Rα,n when the locally ﬁnite Borel measures σ and ω on Rn are k-energy dispersed
with

(72)

(cid:26) n − k < α < n, α 6= n − 1

0 ≤ α < n, α 6= 1, n − 1

if
if

1 ≤ k ≤ n − 2

k = n − 1

.

46

E.T. SAWYER, C.-Y. SHEN, AND I. URIARTE-TUERO

ℓ }2
Now we recall the deﬁnition of strong energy reversal from [SaShUr2]. We say that a vector Tα = {T α

ℓ=1
of α-fractional transforms in the plane has strong reversal of ω-energy on a cube J if there is a positive
constant C0 such that for all γ > 2 suﬃciently large and for all positive measures µ supported outside γJ,
we have the inequality

(73)

Eω

Jh(x − Eω

J x)2i  Pα (J, µ)
n !2

|J|

1

Now note that if ω is k-energy dispersed, then we have

= E (J, ω)2 Pα (J, µ)2 ≤ C0 Eω

J(cid:12)(cid:12)Tαµ − Edω

J Tαµ(cid:12)(cid:12)2

,

E (J, ω)2 =

1

2
n

|J|ω |J|

Mn

0 (J, ω)2 .

1

|J|ω |J|

k (J, ω)2 ≡ Ek (J, ω)2 ,
Mn

2
n

and where we have deﬁned on the right hand side the analogous notion of energy Ek (J, ω) in terms of
Mk (J, ω), and which is smaller than E (J, ω). We now state the main result of this ﬁrst subsection.

Lemma 17. Let 0 ≤ α < n. Suppose that ω is k-energy dispersed and that k and α satisfy (72). Then the
α-fractional Riesz transform Rα,n = {Rn,α

ℓ=1 has strong reversal (73) of ω-energy on all cubes J.

ℓ }n

In [SaShUr4] we showed that energy reversal can fail spectacularly for measures in general, but left open
the possibility of reversing at least one direction in the energy for Rα,n when α 6= 1 in the plane n = 2, and
we will show in the next subsection that this is indeed possible, with even more directions included in higher
dimensions.

10.2. Fractional Riesz transforms and semi-harmonicity. Now we ﬁx 1 ≤ ℓ ≤ n and write x = (x′, x′′)
with x′ = (x1, ..., xℓ) ∈ Rℓ and x′′ = (xℓ+1, ..., xn) ∈ Rn−ℓ (when ℓ = n we have x = x′). Then we compute
for β real that

△x′ |x|β = △x′(cid:16)|x′|2 + |x′′|2(cid:17) β

2

= ∇x′ · ∇x′(cid:16)|x′|2 + |x′′|2(cid:17) β

2

2

2

2

2 −1

β − 2

2x′(cid:27) = β∇x′ ·(cid:26)x′(cid:16)|x′|2 + |x′′|2(cid:17) β
2 −1(cid:27)
2 (cid:27)
+ x′ · ∇x′(cid:16)|x′|2 + |x′′|2(cid:17) β−2
2x′(cid:27)
(cid:16)|x′|2 + |x′′|2(cid:17) β−2
+ x′ ·
2 (cid:27)
+ (β − 2)|x′|2(cid:16)|x′|2 + |x′′|2(cid:17) β−4

= ∇x′ ·(cid:26) β
2(cid:16)|x′|2 + |x′′|2(cid:17) β
= β(cid:26)(∇x′ · x′)(cid:16)|x′|2 + |x′′|2(cid:17) β−2
= β(cid:26)ℓ(cid:16)|x′|2 + |x′′|2(cid:17) β−2
= β(cid:26)ℓ(cid:16)|x′|2 + |x′′|2(cid:17) β−2
= β(cid:26)ℓ(cid:16)|x′|2 + |x′′|2(cid:17)(cid:16)|x′|2 + |x′′|2(cid:17) β−4
= βn(ℓ + β − 2)|x′|2 + ℓ |x′′|2o(cid:16)|x′|2 + |x′′|2(cid:17) β−4
△x′ |x|β = ∇x′ · ∇x′ |x|α−n+1 = ∇x′ · ∇|x|α−n+1 = cα,n∇x′ · Kα,n (x) ,

2 (cid:27)
+ (β − 2)|x′|2(cid:16)|x′|2 + |x′′|2(cid:17) β−4

2 −1

2

.

2

2

The case of interest for us is when β = α − n + 1, since then

(74)

where Kα,n is the vector convolution kernel of the α-fractional Riesz transform Rα,n. Now if ℓ = 1 in this
case, then the factor

Fℓ,β (x) ≡ (ℓ + β − 2)|x′|2 + ℓ |x′′|2

is (β − 1)|x′|2 + |x′′|2, and thus in dimension n ≥ 2, the factor F1,β (x) will be of one sign for all x if and
only if α − n + 1 = β > 1, i.e. α > n, which is of no use since the Riesz transform Rα,n is deﬁned only for
0 ≤ α < n.

TWO WEIGHT BOUNDEDNESS

47

(75)

Thus we must assume ℓ ≥ 2 and β = α − n + 1 when n ≥ 2. Under these assumptions, we then note that

Fℓ,β (x) will be of one sign for all x if ℓ + β − 2 > 0, i.e. α > n + 1 − ℓ, in which case we conclude that

(cid:12)(cid:12)(cid:12)△x′ |x|α−n+1(cid:12)(cid:12)(cid:12) = |α − n + 1|n(ℓ + α − n − 1)|x′|2 + ℓ |x′′|2o(cid:16)|x′|2 + |x′′|2(cid:17) α−n−3

2

= |x|α−n−1 ,

for α 6= n − 1.

≈ (cid:16)|x′|2 + |x′′|2(cid:17) α−n−1

2

When ℓ = n, this shows that(cid:12)(cid:12)(cid:12)△x |x|α−n+1(cid:12)(cid:12)(cid:12) ≈ |x|α−n−1 for α > 1 with α 6= n − 1. But in the case ℓ = n we

can obtain more. Indeed, since x′′ is no longer present, we have for 0 ≤ α < 1 that

△x |x|α−n+1 ≈ |x|α−n−1 .

(This includes dimension n = 1 but only for 0 < α < 1).

We summarize these results as follows. For dimension n ≥ 2 and x = (x′, x′′) with x′ ∈ Rℓ and x′′ ∈ Rn−ℓ,

we have

provided

(76)

(cid:12)(cid:12)(cid:12)△x′ |x|α−n+1(cid:12)(cid:12)(cid:12) ≈ |x|α−n−1 ,

either 2 ≤ ℓ ≤ n − 1 and n + 1 − ℓ < α < n with α 6= n − 1,
or ℓ = n and 0 ≤ α < n with α 6= 1, n − 1.

Thus the two cases not included are α = 1 and α = n − 1. The case α = 1 is not included since |x|α−n+1 =
|x|2−n is the fundamental solution of the Laplacian for n > 2 and constant for n = 2. The case α = n − 1 is
not included since |x|α−n+1 = 1 is constant.
So we now suppose that α and ℓ are as in (76), and we consider ℓ-planes L intersecting the cube J. Recall
that the trace of a matrix is invariant under rotations. Thus for each such ℓ-plane L, and for z ∈ J ∩ L,
we have from (74) and (75), and with Iα+1,nµ (z) ≡ RRn |z − y|α+1−n dµ (y) denoting the convolution of
|x|α+1−n with µ, that

|∇LRα,nµ (z)| & |trace∇LRα,nµ (z)| =(cid:12)(cid:12)△LIα+1,nµ (z)(cid:12)(cid:12) ≈Z |y − z|α−n−1 dµ (y) ≈

Pα (J, µ)

,

1
n

|J|

where ∇L denotes the gradient in the ℓ-plane L, i.e. ∇L = PS∇ where S is the subspace parallel to L and
PS is orthogonal projection onto S, and where we assume that the positive measure µ is supported outside
the expanded cube γJ.
We now claim that for every z ∈ J ∩ L, the full matrix gradient ∇Rα,nµ (z) is ‘missing’ at most ℓ − 1
. Indeed, to see this,

‘large’ directions, i.e. has at least n − ℓ + 1 eigenvalues each of size at least c Pα(J,µ)
suppose instead that the matrix ∇Rα,nµ (z) has at most n − ℓ eigenvalues of size at least c Pα(J,µ)

. Then

|J|

1
n

1
n

(77)

|J|

there is an ℓ-dimensional subspace S such that

|∇SRα,nµ (z)| = |(PS∇) Rα,nµ (z)| = |PS (∇Rα,nµ (z))| ≤ c

Pα (J, µ)

1
n

|J|

,

which contradicts (77) if c is chosen small enough. This proves our claim, and moreover, it satisﬁes the
quantitative quadratic estimate

|ξ · ∇Rα,nµ (z) ξ| ≥ c
for all vectors ξ in some (n − ℓ + 1)-dimensional subspace

Pα (J, µ)

1
n

|J|

|ξ|2 ,

Sn−ℓ+1
z
z ∈ Sn−1 for 1 ≤ j ≤ n − ℓ + 1.
It is convenient at this point to let

with vj

≡ Span(cid:8)v1

z, ..., vn−ℓ+1

z

(cid:9) ∈ Sn

n−ℓ+1,

k = ℓ − 1,

48

E.T. SAWYER, C.-Y. SHEN, AND I. URIARTE-TUERO

so that 1 ≤ k ≤ n − 1 and the assumptions (76) become
(78)

either 1 ≤ k ≤ n − 2 and n − k < α < n with α 6= n − 1,
or k = n − 1 and 0 ≤ α < n with α 6= 1, n − 1,

and our conclusion becomes

(79)

|ξ · ∇Rα,nµ (z) ξ| ≥ c

|ξ|2 ,

ξ ∈ Sn−k

z

, z ∈ J.

Pα (J, µ)

1
n

|J|

10.2.1. Proof of strong reversal of energy. We are now in a position to prove the strong reversal of energy
for Riesz transforms in Lemma 17.

Proof. (of Lemma 17) Recall that Ek (J, ω)2 = inf L∈Ln

k

(80)

1

n !2
|J|ωZJ  dist (x, L)

1

dω (x) =

1
2

1

|J|ωZJ

dω (x) and

1

1

|J|ωRJ(cid:18) dist(x,L)
n (cid:19)2
|J|ωZJ  dist (x, z + L0)

|J|

1

1
n

!2

|J|
where we recall that L0 ∈ Sn
(81)
is a scalar multiple of the Hessian of |x|α+1, hence is symmetric, and so we can rotate coordinates to
diagonalize the matrix,

k is parallel to L. The real matrix

M (x) ≡ ∇Rα,nµ (x) ,

x ∈ J,

|J|

dω (x) dω (z) ,

M (x) =

λ1 (x)

0

0
...
0

λ2 (x)

···

···

. . .
0

0
...
0

λn (x)

,



|λ1| ≤ |λ2| ≤ ... ≤ |λn| ,

λj ≡ λj (cJ ) ,

where |λ1 (x)| ≤ |λ2 (x)| ≤ ... ≤ |λn (x)|. We now ﬁx x = cJ to be the center of J in the matrix M (cJ ) and
ﬁx the eigenvalues corresponding to M (cJ ):

and deﬁne also the subspaces Sn−i to be Sn−i
Let Li

z be the i-plane

cJ

for 1 ≤ i ≤ k. Note that we then have Sn−i = Span{ei+1, ..., en}.

(82)

By (79) we have

Li

z ≡ z +(cid:0)Sn−i(cid:1)⊥ =(cid:8)(cid:0)u1, ..., ui, zi+1, ..., zn(cid:1) :(cid:0)u1, ..., ui(cid:1) ∈ Ri(cid:9) .

|λk+1| ≥ c

Pα (J, µ)

.

1
n

|J|

For convenience deﬁne |λ0| ≡ 0 and then deﬁne 0 ≤ m ≤ k be the unique integer such that
(83)

Pα (J, µ)

|λm| < c
Now consider the largest 0 ≤ ℓ ≤ m that satisﬁes
(84)

2n |λℓ+1| .
Note that this use of ℓ is quite diﬀerent than that used in (76).

|λℓ| ≤ γ− 1

|J|

n ≤ |λm+1| .

1

So suppose ﬁrst that ℓ satisﬁes 1 ≤ ℓ ≤ m and is the largest index satisfying (84). Then if ℓ < m we have

|λi| > γ− 1
(85)

2n |λi+1| for ℓ + 1 ≤ i ≤ m, and so both

|λℓ+1| > γ− 1
|λ1| ≤ ... ≤ |λℓ| ≤ γ− 1

2n |λℓ+2| > ... > γ− m−ℓ
2n |λℓ+1| .

2n |λm+1| ≥ γ− m−ℓ

2n c

Pα (J, µ)

1
n

|J|

,

Both inequalities in the display above also hold for ℓ = m by (83) and (84). Roughly speaking, in this case
where 1 ≤ ℓ ≤ m, the gradient of Rα,nµ has modulus at least |λℓ+1| in the directions of eℓ+1, ..., en, while
the gradient of Rα,nµ has modulus at most γ− 1

2n |λℓ+1| in the directions of e1, ..., eℓ.

TWO WEIGHT BOUNDEDNESS

49

Recall that Sn−ℓ = Sn−ℓ

cJ

is the subspace on which the symmetric matrix M (cJ ) = ∇ (Rα,nµ) (cJ ) has

energy ξtrM (cJ ) ξ bounded below by |λℓ+1|. Now we proceed to show that
(86)

n E (J, µ)2 .

2

ωZJZJ |Rα,nµ (x) − Rα,nµ (z)|2 dω (x) dω (z) .
1
|J|2

|λℓ+1|2 |J|

We will use our hypothesis that µ is k-energy dispersed to obtain

E (J, µ) ≤ Ek (J, µ) ≤ Em (J, µ) ≤ Eℓ (J, µ)
z as in (82) and begin with

since ℓ ≤ m ≤ k. To prove (86), we take Lz ≡ Lℓ
(87)

dist (x, Lz)2 = dist(cid:16)x, z +(cid:0)Sn−ℓ(cid:1)⊥(cid:17)2

= (xℓ+1 − zℓ+1)2 + ... + (xn − zn)2 = |x′′ − z′′|2 ,

where x = (x′, x′′) with x′ ∈ Rℓ and x′′ ∈ Rn−ℓ, and Lz =(cid:8)(u′, z′′) : u′ ∈ Rℓ(cid:9). Now for x, z ∈ J we take
ξ ≡(cid:16)0, x′′−z′′

0 = 0). We use the estimate

|x′′−z′′|(cid:17) ∈ Sn−ℓ (where 0
n(cid:13)(cid:13)∇2Rα,nµ(cid:13)(cid:13)L∞(J) . |J|

|J|

1

(88)

to obtain

(89)

.

We then start with a decomposition into big B and small S pieces,

1

γZRn\γJ

dµ (y)

|y − cJ|n−α+1 ≈

1
γ

Pα (J, µ)

,

1
n

|J|

1

nZRn\γJ

dµ (y)

1

1

dω (x) dω (z)

dω (x) dω (z) =

|y − cJ|n−α+2 .
ωZJZJ(cid:16)(cid:13)(cid:13)∇2Rα,nµ(cid:13)(cid:13)L∞(J) |x − z||J|
n(cid:17)2
ωZJZJ |x − z|
n !2

1
|J|2
γ2 Pα (J, µ)2 1
1
|J|2
ωZJZJ |Rα,nµ (x) − Rα,nµ (z)|2 dω (x) dω (z)
1
|J|2
ωZJZJ |Rα,nµ (z′, x′′) − Rα,nµ (z′, z′′)|2 dω (x) dω (z)
1
|J|2
ωZJZJ |Rα,nµ (x′, x′′) − Rα,nµ (z′, x′′)|2 dω (x) dω (z)
1
−
|J|2
≡ B − S.

|J|

&

1
γ2 Pα (J, µ)2 E (J, µ)2 .

For w ∈ J we have
(90)

|∇Rα,nµ (w) − M (cJ )| = |∇Rα,nµ (w) − ∇Rα,nµ (cJ )|

. |w − cJ|(cid:13)(cid:13)∇2Rα,nµ(cid:13)(cid:13)L∞(J) .

1
γ

Pα (J, µ)

,

1
n

|J|

from (88), and this inequality will allow us to replace x or z by cJ at appropriate places in the estimates
below, introducing a harmless error. We now use the second inequality in (85) with the diagonal form of
M (cJ ) = ∇Rα,nµ (cJ ), along with the error estimates (89) and (90), to control S by

S ≤

.

dω (x) dω (z)

1
|J|2
1
+
|J|2
1
|J|2
1
+
|J|2

ωZJZJ(cid:12)(cid:12)(x′ − z′) · ∇′Rα,nµ (x)(cid:12)(cid:12)2
ωZJZJn(cid:13)(cid:13)∇2Rα,nµ(cid:13)(cid:13)L∞(J) |x′ − z′|2o2
ωZJZJ(cid:12)(cid:12)(x′ − z′) · ∇′Rα,nµ (cJ )(cid:12)(cid:12)2
ωZJZJn(cid:13)(cid:13)∇2Rα,nµ(cid:13)(cid:13)L∞(J) |x′ − z′||J|
no2

1

dω (x) dω (z)

dω (x) dω (z)

dω (x) dω (z) ,

50

E.T. SAWYER, C.-Y. SHEN, AND I. URIARTE-TUERO

and then continuing with

S .

.

=

ωZJZJ {|x′ − z′| |λℓ|}2 dω (x) dω (z) +
1
|J|2
ωZJZJ |x − z|2 dω (x) dω (z) +
1
γ |λℓ+1|2 1
|J|2
1
γ |J|

n |λℓ+1|2 E (J, ω)2 +

1
γ2 Pα (J, µ)2 E (J, ω)2 ,

2

1
γ2 Pα (J, µ)2 E (J, ω)2
1
γ2 Pα (J, µ)2 E (J, ω)2

which is small enough to be absorbed later on in the proof. To bound term B from below we use (90) in

1

n(cid:17) ,

Rα,nµ (z′, x′′) − Rα,nµ (z′, z′′) = (x′′ − z′′) · ∇′′Rα,nµ (z) + O(cid:16)(cid:13)(cid:13)∇2Rα,nµ(cid:13)(cid:13)L∞(J) |x − z|2(cid:17)
= (x′′ − z′′) · ∇′′Rα,nµ (cJ ) + O(cid:16)(cid:13)(cid:13)∇2Rα,nµ(cid:13)(cid:13)L∞(J) |x − z||J|
|x′′−z′′|(cid:17) ∈ Sn−ℓ, to obtain
and then (79) with the choice ξ ≡(cid:16)0, x′′−z′′
|x′′ − z′′||λℓ+1| ≤ |x′′ − z′′|(cid:12)(cid:12)(cid:0)ξ · ∇′′(cid:1) Rα,nµ (cJ ) · ξ(cid:12)(cid:12)
= (cid:12)(cid:12)(x′′ − z′′) · ∇′′Rα,nµ (cJ ) · ξ(cid:12)(cid:12)
≤ (cid:12)(cid:12)(x′′ − z′′) · ∇′′Rα,nµ (cJ )(cid:12)(cid:12)
≤ |Rα,nµ (z′, x′′) − Rα,nµ (z′, z′′)| + O(cid:16)(cid:13)(cid:13)∇2Rα,nµ(cid:13)(cid:13)L∞(J) |x − z||J|
ωZJZJ |Rα,nµ (z′, x′′) − Rα,nµ (z′, z′′)|2 dω (x) dω (z)
1
|J|2

Then using (89) and (90) we continue with

n(cid:17) .

1

ωZJZJ |x′′ − z′′|2 dω (x) dω (z) −
& |λℓ+1|2 1
|J|2

1
γ2 Pα (J, µ)2 E (J, ω)2 ,

and then

(91)

2

2

.

n Eℓ (J, ω)2

|λℓ+1|2 |J|
n E (J, ω)2 ≤ C |λℓ+1|2 |J|
ωZJZJ
ωZJZJ |x′′ − z′′|2 dω (x) dω (z)
dist (x, Lz)2 dω (x) dω (z) = |λℓ+1|2 1
= |λℓ+1|2 1
|J|2
|J|2
ωZJZJ |Rα,nµ (z′, x′′) − Rα,nµ (z′, z′′)|2 dω (x) dω (z) +
1
1
γ2 Pα (J, µ)2 E (J, ω)2
|J|2
ωZJZJ |Rα,nµ (x) − Rα,nµ (z)|2 dω (x) dω (z) + S +
1
|J|2
ωZJZJ |Rα,nµ (x) − Rα,nµ (z)|2 dω (x) dω (z) +
1
|J|2

1
γ2 Pα (J, µ)2 E (J, ω)2
n E (J, ω)2 ,

1
γ |λℓ+1|2 |J|

.

.

2

since 1
can absorb the last term on the right hand side of (91) into the left hand side to obtain (86):

n |λℓ+1|2 E (J, ω)2 for γ large enough. Finally then, for γ large enough we

γ2 Pα (J, µ)2 E (J, ω)2 ≤ 1

γ |J|

2

|λℓ+1|2 |J|

2

n E (J, ω)2 .

ωZJZJ |Rα,nµ (x) − Rα,nµ (z)|2 dω (x) dω (z) .
1
|J|2

But since γ− m−ℓ

2n c Pα(J,µ)

1

n ≤ |λℓ+1| by (85), we have obtained

|J|

Pα (J, µ)2 E (J, ω)2 ≤

.

2

n E (J, ω)2

1
c2 γ |λℓ+1|2 |J|
ωZJZJ |Rα,nµ (x) − Rα,nµ (z)|2 dω (x) dω (z) ,
1
|J|2

TWO WEIGHT BOUNDEDNESS

51

which is the strong reverse energy inequality for J since

ωZJZJ |Rα,nµ (x) − Rα,nµ (z)|2 dω (x) dω (z) = Eω

1
2 |J|2

J(cid:12)(cid:12)Rα,nµ − Edω

J Rα,nµ(cid:12)(cid:12)2

.

This completes the proof of strong reversal of energy under the assumption that 1 ≤ ℓ ≤ m.

If instead ℓ = 0, then |λi| > γ− 1

2n |λi+1| for all 1 ≤ i ≤ m, and so the smallest eigenvalue satisﬁes

In this case the arguments above show that

|λ1| > γ− 1
n !2

Pα (J, µ)

1

|J|

 γ− 1

2 c

2n |λ2| > γ− 2

2n |λ3| > ... > γ− k

2n |λm+1| > γ− 1

2 c

Pα (J, µ)

.

1
n

|J|

E (J, ω)2 .

ωZJZJ |Rα,nµ (x) − Rα,nµ (z)|2 dω (x) dω (z)
1
|J|2
1
γ2 Pα (J, µ)2 E (J, ω)2 ,
+

which again yields the strong reverse energy inequality for J since the second term on the right hand side
can then be absorbed into the left hand side for γ suﬃciently large.
(cid:3)

10.3. Necessity of the energy conditions. Now we demonstrate in a standard way the necessity of the
energy conditions for the vector Riesz transform Rα,n when the measures σ and ω are appropriately energy
dispersed. Indeed, we can then establish the inequality

So assume that (78) holds. We use Lemma 17 to obtain that the α-fractional Riesz transform Rα,n has
strong reversal of ω-energy on all quasicubes J. Then we use the next lemma to obtain the energy condition

Eα .pAα

2 + TRα,n .

Eα . TTn,α +pAα

2 .

Eα . TRn,α +pAα

2 .

Lemma 18. Let 0 ≤ α < n and suppose that Rα,n has strong reversal of ω-energy on all quasicubes J.
Then we have the energy condition inequality,

Proof. From the strong reversal of ω-energy with dµ ≡ 1I0\γJ dσ, we have

and so

XJ

|J|ω

E (J, ω)2 Pα(cid:0)J, 1I0\γJ dσ(cid:1)2
J(cid:12)(cid:12)Tα(cid:0)1I0\γJ dσ(cid:1) − Edω
≤ C0 Eω
J(cid:12)(cid:12)Tα(cid:0)1I0\γJ dσ(cid:1)(cid:12)(cid:12)2
. Eω

. Eω

J Tα(cid:0)1I0\γJ dσ(cid:1)(cid:12)(cid:12)2

J |Tα (1I0 dσ)|2 + Eω

J |Tα (1γJ dσ)|2 ,

E (J, ω)2 Pα (J, µ)2 . XJ ZJ |Tα (1I0 dσ) (x)|2 dω (x) +XJ ZJ |Tα (1γJ dσ) (x)|2 dω (x)
. ZI0 |Tα (1I0 dσ) (x)|2 dω (x) +XJ ZγJ |Tα (1γJ dσ) (x)|2 dω (x)
. TTn,α |I0|σ +XJ

TTn,α |γJ|σ . TTn,α |I0|σ

by the bounded overlap of the quasicubes γJ.

(cid:3)

References

[CoFe]

[DaJo]

[HuMuWh]

[Hyt]

R. R. Coifman and C. L. Fefferman, Weighted norm inequalities for maximal functions and singular integrals,
Studia Math. 51 (1974), 241-250.
David, Guy, Journ´e, Jean-Lin, A boundedness criterion for generalized Calder´on-Zygmund operators, Ann.
of Math. (2) 120 (1984), 371–397, MR763911 (85k:42041).
R. Hunt, B. Muckenhoupt and R. L. Wheeden, Weighted norm inequalities for the conjugate function and
the Hilbert transform, Trans. Amer. Math. Soc. 176 (1973), 227-251.
Hyt¨onen, Tuomas, On Petermichl’s dyadic shift and the Hilbert transform, C. R. Math. Acad. Sci. Paris 346
(2008), MR2464252.

52

[Hyt2]

[HyLaPe]

[Lac]

[Lac2]
[LaSaUr1]

[LaSaUr2]

[LaSaShUr]

[LaSaShUr2]

[LaSaShUr3]

E.T. SAWYER, C.-Y. SHEN, AND I. URIARTE-TUERO

inequality for

the Hilbert

transform with general measures,

Hyt¨onen, Tuomas, The two weight
arXiv:1312.0843v2.
Hyt¨onen, Tuomas, Lacey, Michael T., and P´erez, C., Sharp weighted bounds for the q-variation of singular
integrals, Bull. Lon. Math. Soc. 45 (2013), 529-540.
Lacey, Michael T., Two weight inequality for the Hilbert transform: A real variable characterization, II, Duke
Math. J. Volume 163, Number 15 (2014), 2821-2840.
Lacey, Michael T., The two weight inequality for the Hilbert transform: a primer, arXiv:1304.5004v1.
Lacey, Michael T., Sawyer, Eric T., Uriarte-Tuero, Ignacio, A characterization of two weight norm
inequalities for maximal singular integrals with one doubling measure, Analysis & PDE, Vol. 5 (2012), No. 1,
1-60.
Lacey, Michael T., Sawyer, Eric T., Uriarte-Tuero, Ignacio, A Two Weight Inequality for the Hilbert
transform assuming an energy hypothesis, Journal of Functional Analysis, Volume 263 (2012), Issue 2, 305-363.
Lacey, Michael T., Sawyer, Eric T., Shen, Chun-Yen, Uriarte-Tuero, Ignacio, The Two weight inequal-
ity for Hilbert transform, coronas, and energy conditions, arXiv: (2011).
Lacey, Michael T., Sawyer, Eric T., Shen, Chun-Yen, Uriarte-Tuero, Ignacio, Two Weight Inequality
for the Hilbert Transform: A Real Variable Characterization, arXiv:1201.4319 (2012).
Lacey, Michael T., Sawyer, Eric T., Shen, Chun-Yen, Uriarte-Tuero, Ignacio, Two weight inequality
for the Hilbert transform: A real variable characterization I, Duke Math. J, Volume 163, Number 15 (2014),
2795-2820.

[LaSaShUrWi] Lacey, Michael T., Sawyer, Eric T., Shen, Chun-Yen, Uriarte-Tuero, Ignacio, Wick, Brett D., Two

[LaWi1]

[LaWi]

[NTV1]

[NTV2]

[NTV4]

[Saw]

[SaShUr2]

[SaShUr3]

[SaShUr4]

[SaShUr5]

[SaShUr6]

[SaShUr7]

[SaShUr8]

[Ste]

[Vol]

weight inequalities for the Cauchy transform from R to C+, arXiv:1310.4820v4.
Lacey, Michael T., Wick, Brett D., Two weight inequalities for the Cauchy transform from R to C+,
arXiv:1310.4820v1.
Lacey, Michael T., Wick, Brett D., Two weight inequalities for Riesz transforms: uniformly full dimension
weights, arXiv:1312.6163v1,v2,v3.
F. Nazarov, S. Treil and A. Volberg, The Bellman function and two weight inequalities for Haar multipliers,
J. Amer. Math. Soc. 12 (1999), 909-928, MR{1685781 (2000k:42009)}.
Nazarov, F., Treil, S. and Volberg, A., The T b-theorem on non-homogeneous spaces, Acta Math. 190
(2003), no. 2, MR 1998349 (2005d:30053).
F. Nazarov, S. Treil and A. Volberg, Two weight estimate for the Hilbert transform and corona decompo-
sition for non-doubling measures, preprint (2004) arxiv:1003.1596
E. Sawyer, A characterization of two weight norm inequalities for fractional and Poisson integrals, Trans.
A.M.S. 308 (1988), 533-545, MR{930072 (89d:26009)}.
Sawyer, Eric T., Shen, Chun-Yen, Uriarte-Tuero, Ignacio, A two weight theorem for α-fractional singular
integrals with an energy side condition, arXiv:1302.5093v8.
Sawyer, Eric T., Shen, Chun-Yen, Uriarte-Tuero, Ignacio, A geometric condition, necessity of energy,
and two weight boundedness of fractional Riesz transforms, arXiv:1310.4484v1.
Sawyer, Eric T., Shen, Chun-Yen, Uriarte-Tuero, Ignacio, A note on failure of energy reversal for classical
fractional singular integrals, IMRN, Volume 2015, Issue 19, 9888-9920.
Sawyer, Eric T., Shen, Chun-Yen, Uriarte-Tuero, Ignacio, A two weight theorem for α-fractional singular
integrals with an energy side condition and quasicube testing, arXiv:1302.5093v10.
Sawyer, Eric T., Shen, Chun-Yen, Uriarte-Tuero, Ignacio, A two weight theorem for α-fractional singular
integrals with an energy side condition, quasicube testing and common point masses, arXiv:1505.07816v2.
Sawyer, Eric T., Shen, Chun-Yen, Uriarte-Tuero, Ignacio, A two weight theorem for α-fractional singular
integrals with an energy side condition, Revista Mat. Iberoam. 32 (2016), no. 1, 79-174.
Sawyer, Eric T., Shen, Chun-Yen, Uriarte-Tuero, Ignacio, The two weight T 1 theorem for fractional
Riesz transforms when one measure is supported on a curve, arXiv:1505.07822v4.
E. M. Stein, Harmonic Analysis: real-variable methods, orthogonality, and oscillatory integrals, Princeton
University Press, Princeton, N. J., 1993.
A. Volberg, Calder´on-Zygmund capacities and operators on nonhomogeneous spaces, CBMS Regional Confer-
ence Series in Mathematics (2003), MR{2019058 (2005c:42015)}.

Department of Mathematics & Statistics, McMaster University, 1280 Main Street West, Hamilton, Ontario,

Canada L8S 4K1

E-mail address: sawyer@mcmaster.ca

Department of Mathematics, National Central University, Chungli, 32054, Taiwan
E-mail address: cyshen@math.ncu.edu.tw

Department of Mathematics, Michigan State University, East Lansing MI
E-mail address: ignacio@math.msu.edu

