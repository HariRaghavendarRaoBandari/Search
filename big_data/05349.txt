6
1
0
2

 
r
a

 

M
7
1

 
 
]
h
p
-
t
n
a
u
q
[
 
 

1
v
9
4
3
5
0

.

3
0
6
1
:
v
i
X
r
a

Parallel repetition via fortiﬁcation: analytic view and

the quantum case

Mohammad Bavarian ˚1, Thomas Vidick:2, and Henry Yuen;1

1Massachusetts Institute of Technology, Cambridge, MA, USA

2Department of Computing and Mathematical Sciences, California Institute of

Technology, Pasadena, CA, USA

March 18, 2016

Abstract

In a recent work, Moshkovitz [FOCS ’14] presented a transformation on two-player games
called “fortiﬁcation”, and gave an elementary proof of an (exponential decay) parallel repe-
tition theorem for fortiﬁed two-player projection games. In this paper, we give an analytic
reformulation of Moshkovitz’s fortiﬁcation framework, which was originally cast in combina-
torial terms. This reformulation allows us to expand the scope of the fortiﬁcation method to
new settings.

First, we show any game (not just projection games) can be fortiﬁed, and give a simple
proof of parallel repetition for general fortiﬁed games. Then, we prove parallel repetition and
fortiﬁcation theorems for games with players sharing quantum entanglement, as well as games
with more than two players. This gives a new gap ampliﬁcation method for general games in
the quantum and multiplayer settings, which has recently received much interest.

An important component of our work is a variant of the fortiﬁcation transformation, called
“ordered fortiﬁcation”, that preserves the entangled value of a game. The original fortiﬁcation
of Moshkovitz does not in general preserve the entangled value of a game, and this was a
barrier to extending the fortiﬁcation framework to the quantum setting.

1 Introduction

A central concept in theoretical computer science and quantum information is that of a two-player
one-round game. A two-player game G is speciﬁed by question sets X and Y , answer sets A and B,
a distribution µ over pairs of questions, and a veriﬁcation predicate V : A ˆ B ˆ X ˆ Y Ñ t0, 1u.
The game is played between two cooperating (but non-communicating) players and a referee. The
referee samples px, yq P XˆY according to µ and sends x and y to each player, who provide answers
˚bavarian@mit.edu. Work was supported by National Science Foundation grants CCF-0939370 and CCF-1420956.
:vidick@cms.caltech.edu. Work was partially supported by the IQIM, an NSF Physics Frontiers Center (NFS Grant

PHY-1125565) with support of the Gordon and Betty Moore Foundation (GBMF-12500028).

;hyuen@mit.edu. Work was supported by Simons Foundation grant #360893, and National Science Foundation

Grants 1122374 and 1218547. Work partially conducted while visiting the IQIM at Caltech.

1

a P A and b P B respectively. The players win the game if their answers satisfy the predicate
Vpa, b, x, yq.

Games arise naturally in settings ranging from hardness of approximation [H˚as01] and in-
teractive proof systems [BOGKW88, FRS88] to the study of Bell inequalities and non-locality in
quantum physics [CHSH69, CHTW04]. Depending on the context it is natural to consider players
with access to diﬀerent resources. In particular, in this work we distinguish between the classical
value ValpGq of a game, deﬁned as the maximum winning probability of players allowed to pro-
duce their answers using private and shared randomness, and the entangled value Val˚pGq, for
which the players may use shared entanglement as well .

An important operation on games and the main focus of this work is that of repeated tensor
product or parallel repetition. This operation takes a game G and a parameter m and outputs a
new game Gbm in which m independent instances of G are simultaneously played with the two
players: the referee samples m independent questions tpxi , yiqum
i“1 from G, sends px1, . . . , xmq to
the ﬁrst and py1, . . . , ymq to the second player, and checks their corresponding answers pa1, . . . , amq
and pb1, . . . , bmq using the predicate V “ śm
i“1 Vpai , bi , xi , yiq. Parallel repetition is often used
in complexity theory in order to perform some form of ampliﬁcation, such as amplifying the
completeness-soundness gap of a proof system. A fundamental question that arises in this con-
text is how the value of a repeated game Gbm relates to the value of the original game G and the
number of repetitions m.

The behavior of the game value under parallel repetition can in general be quite subtle [FV02,
FKO07, Raz11]. In a celebrated paper, Raz showed that if ValpGq ă 1, then ValpGbmq goes to 0
exponentially fast in m [Raz98]. Even with later simpliﬁcations and improvements to the proof
(e.g. [Hol07, Rao11, BG15]), Raz’s parallel repetition theorem remains a substantial technical re-
sult.

Recently, Moshkovitz [Mos14] introduced a simple yet powerful framework for parallel repeti-
tion, called parallel repetition via fortiﬁcation. In this framework, a game G is transformed through
an operation called “fortiﬁcation” to a new game G1. This new game G1 is equivalent to G in that
ValpGq “ ValpG1q, but then Moshkovitz shows that behavior of the value of fortiﬁed games un-
der parallel repetition is much simpler than the general case, and avoids many of the subtleties
encountered in the general case. The main beneﬁts of fortiﬁed games are two-fold: ﬁrst, their
behavior under parallel repetition is much simpler than the general case, and second, all games
can be easily fortiﬁed. Thus for nearly all intents and purposes, it suﬃces to focus on the parallel
repetition of fortiﬁed games.

Despite its attractive features, the fortiﬁcation framework [Mos14] has some limitations; for
instance it is only applicable to the restricted (though very important) setting of classical two-
player projection games.
In this work, we continue the study of the fortiﬁcation approach to
parallel repetition and try to expand its scope to wider classes of games.

Previously, an attempt to address the limitation of fortiﬁcation to projection games was made
in [BSVV15, Lemma 1.9], but this was only partially successful.1 Here, using a slightly modiﬁed

1The diﬃculty there was that fortiﬁcation increases the alphabet size of the game considerably, which in turn in-
creased the additive error of the parallel repetition to the extent that for general two-prover games the whole approach
seemed to entirely break down. We get around this diﬃculty by showing that for the kinds of games (concatenated
games) that arise from the fortiﬁcation procedure it is possible to establish a parallel repetition theorem where the
additive error only depends on the alphabet size of the original, rather than the fortiﬁed game. See Subsection 1.1 for
more on this.

2

form of the framework (see the discussion of our analytic formulation below), we are able to
extend fortiﬁcation to all classical games (i.e. games that are not projection games, and involve any
number of players), as well as the challenging setting of entangled games.

More precisely, the following is a summary of our main contributions:

• Analytic formulation of fortiﬁcation. The framework of parallel repetition by fortiﬁcation
was originally cast in combinatorial terms; Moshkovitz’s deﬁnition of fortiﬁed games, which
we describe below in detail, involves a guarantee on the value of every suﬃciently large
rectangular subgame of a game. In our analytic reformulation, fortiﬁed games are deﬁned
in terms of substrategies, which one can think of as randomized strategies for the game where
the probability that the players output an answer may be less than 1. This deﬁnition behaves
much more “smoothly”, allowing us to generalize them to the entangled and multiplayer
settings.

• Fortiﬁcation of general classical games and games with more than two players. Next, we
show how to fortify a general k-player game G, for any k ě 2. We show that for any two
fortiﬁed general classical games G1 and H1, ValpG1 b H1q « ValpG1q ¨ ValpH1q. Together this
implies new gap ampliﬁcation results for general (as opposed to projection) two-player and
multiplayer classical games.

• An entangled-value preserving variant of concatenation. A major obstacle in extending
the fortiﬁcation framework to the quantum setting is that concatenation, the main ingre-
dient of the original fortiﬁcation results, does not in general preserve the entangled value.
That is, if G1 is the fortiﬁcation of G, it doesn’t generally hold that Val*pG1q “ Val*pGq (even
though ValpG1q “ ValpGq). This is problematic for obtaining gap ampliﬁcation results: if
Val*pGq “ 1, then Val*pGbnq “ 1, but Val*pG1bnq could be exponentially small!
To resolve this issue, we augment the ordinary concatenation procedure of [Mos14] by giving
the players some auxiliary advice input (see Deﬁnition 1.4) which helps in keeping the en-
tangled value unchanged. Using this, we deﬁne a variant of the fortiﬁcation transformation
which we call ordered fortiﬁcation. As desired, in addition to preserving the classical value,
this transformation also preserves the entangled value, which is essential for the complete-
ness of our gap ampliﬁcation result.

• Fortiﬁcation of games with entangled players. We show that for a general two-player game
G, its ordered-fortiﬁcation GOF is a two-player game such that Val˚pGOFq “ Val˚pGq, and
is also quantumly fortiﬁed. We then prove that for any two quantumly fortiﬁed games
G1 and H1, Val*pG1 b H1q « Val*pG1q ¨ Val*pH1q. Together this implies a new general gap
ampliﬁcation method for entangled two-player games. This (see Theorem 1.3) is the most
technically challenging component of this work.

Let us note that our extensions of the fortiﬁcation approach, as described in the last three
items above, are ultimately enabled by the analytic viewpoint described in point 1. In order to
describe the main ideas behind these results, we ﬁrst brieﬂy recall the combinatorial framework
from [Mos14].

3

The combinatorial framework. Let G be a two-player game with question sets X, Y and accep-
tance predicate V . For S Ď X and T Ď Y , the subgame GSˆT is deﬁned as the game where the
referee selects px, yq P X ˆ Y according to µ conditioned on x P S, y P T and checks the players’
answers according to the same predicate V (the referee accepts automatically if µpS ˆ Tq “ 0). A
game G is said to be pε, δq-combinatorially fortiﬁed2 if

ValpGSˆTq ď ValpGq` ε,

@ S Ď X, T Ď Y , s.t. µpS ˆ Tq ě δ.

(1)

The main insight underlying [Mos14] is that games satisfying (1) also satisfy a strong form of
parallel repetition (up to some number of rounds depending on ε, δ, and the alphabet size of
G). This motivates the following approach to parallel repetition: Given a game G, Moshkovitz
transforms the game G Ñ G1 such that ValpG1q « ValpGq and G1 is pε, δq-combinatorially fortiﬁed
for an appropriate choice of pε, δq. Since fortiﬁed games satisfy a strong form of parallel repetition,
one expects
(2)
Indeed, by appropriately choosing the parameters pε, δq, [Mos14] can show that the full procedure
(3)

ValpG1bmq « ValpG1qm « ValpGqm.

G ÝÑ G1 ÝÑ G1bm

amounts to a size-eﬃcient method of gap ampliﬁcation. That is, we have

ValpGq ě c ñ ValpG1bmq & cm
ValpGq ď s ñ ValpG1bmq . sm ,

(4)

where we refer to the ﬁrst condition as completeness and the second as soundness. The gap
ampliﬁcation procedure of Moshkovitz G Ñ G1 Ñ G1bm from (3) has three components: (i) a
preprocessing step (biregularization), (ii) fortiﬁcation, (iii) parallel repetition for fortiﬁed games.

The goal of the preprocessing step – the simplest step of the three – is to make the game
biregular (a game G is called biregular if the marginals of questions on both Alice and Bob sides
are uniform), since it is typically easier to analyze the fortiﬁcation procedure for such games.
The second step is fortiﬁcation, which is the main technical ingredient of the whole approach.
It is achieved by “concatenating” the game (see Section 1.1 below) with appropriate bipartite
pseudorandom graphs. The third step G1 Ñ G1bm is the parallel repetition of fortiﬁed games,
which as observed by [Mos14] is considerably simpler to analyze than the general (non-fortiﬁed)
games.

1.1 Results and techniques

The main result of our work is the extension of the fortiﬁcation framework to general classical
games (with any number of players) and two-player entangled games. On the way to these results
we prove new results on all three components of the fortiﬁcation framework: (i) biregularization,
(ii) fortiﬁcation, and (iii) parallel repetition. In this subsection, we discuss some of these results
in detail.

2We shall refer to this notion as combinatorial fortiﬁcation to distinguish it from the distinct (though closely related)

notion of analytic fortiﬁcation we primarily use throughout the paper; see Deﬁnition 3.1.

4

Parallel repetition. A main contribution of [Mos14] was the realization that the two-player pro-
jection fortiﬁed games satisfy a strong form of parallel repetition, up to an additive error. This
additive error depended on the parameters of fortiﬁcation as well as the alphabet size of the for-
tiﬁed game. In this work, we prove an improved parallel repetition theorem (Theorem 3.4) which
has the same dependance in the parameters of fortiﬁcation, but instead of the alphabet size of
the resulting fortiﬁed game, it only depends on the alphabet size of the original game (which has
exponentially smaller alphabet size). This new parallel repetition theorem is crucial for extending
the fortiﬁcation framework to the setting of general (as opposed to projection) two-player games.

Let us remark that the reason why alphabet blow-up of fortiﬁcation does not cause an issue for
projection games is because for projection games it suﬃces to only fortify one side of the game (by
working with so-called “square projection” version of the game). As a result there is no alphabet
blow-up for the “unfortiﬁed” side, which allows the arguments of [Mos14, BSVV15] to go through.
This one-sided fortiﬁcation does not work for general games, which is why we need Theorem 3.4.

Fortiﬁcation. We start with a deﬁnition. Let G “ pX ˆ Y , A ˆ B, µ, Vq be a game, and M and P
two bipartite graphs over vertex sets pX1, Xq and pY 1, Yq respectively. For each x P X or x1 P X1 let
Npxq Ď X1 and Npx1q Ď X denote the set of neighbors of x and x1, respectively (similarly for any
y, y1).
Deﬁnition 1.1 (Concatenated game [Mos14]). In the concatenated game G1 “ pM ˝ G˝ Pq, the referee
selects questions px, yq according to µ, and independently selects a random neighbor x1 for x using M, and
y1 for y using P. The players receive questions x1 and y1 and respond with assignments a1 : Npx1q Ñ A
and b1 : Npy1q Ñ B respectively. The players win if Vpa1pxq, b1pyq, x, yq “ 1.

Our ﬁrst two main results show how, both in the classical and quantum settings, any game
can be fortiﬁed by concatenating it with bipartite graphs M and P with suﬃciently good spectral
expansion.3 (See Section 2.4 for the deﬁnition of spectral expanders, and Section 3.1 for the notion
of weak fortiﬁcation.)

Theorem 1.2 (Main-classical). Let G be a biregular game and M and P two bipartite λ-spectral ex-
2b δ
panders. If λ ď ε
2 , then the concatenated game G1 “ pM ˝ G ˝ Pq is pε, δq-weakly fortiﬁed against
classical substrategies.

Theorem 1.3 (Main-quantum). Let G be a biregular game and M and P two bipartite λ-spectral
expanders. If λ ď ε2δ
56 , then the concatenated game G1 “ pM ˝ G ˝ Pq is pε, δq-weakly fortiﬁed against

entangled strategies.

We stress that both in the quantum and classical settings the procedure used to fortify a game
is precisely the same, i.e. concatenation with spectral expanders, and the only diﬀerence is in
the resulting parameters. Despite the similarities, the proof of Theorem 1.3 is signiﬁcantly more
involved, requiring several new ideas and substantial matrix analytic arguements.

Next we discuss a distinctively quantum phenomenon which makes the construction of a full
quantum gap ampliﬁcation theorem – quantum analogue of (4) – considerably more diﬃcult. As

3Even though explaining these results in full requires the deﬁnition of analytically fortiﬁed games, which we intro-
duce only later in Section 3.1, the analogy with the notion of combinatorially fortiﬁed games from (1) should still be
suﬃcient to understand the basic ideas.

5

it turns out, even though Theorem 1.3 is suﬃcient to prove the soundness case of the gap ampliﬁ-
cation theorem, the concatenation procedure used in the process can undermine the completeness
condition (i.e. Val*pG1bmq & Val*pGqm in general fails to hold).
The issue is as follows: let G be a game and G1 “ pM ˝ G ˝ Pq be a concatenated version of G.
Classically we have ValpG1q “ ValpGq. Quantumly, even though we still have Val*pG1q ď Val*pGq
the other direction in general fails: we would have liked to argue that the players in G1 are able to
utilize the strategy in G to achieve the same success probability in the concatenated game, but this
seems impossible: having received x1 P X1 and y1 P Y 1, the players have access to lists Npx1q Ď X
and Npy1q Ď Y that they know contain the true questions of the referee, i.e. x˚ P Npx1q, y˚ P Npy1q.
The players would like to apply their optimal strategy in G to each and every px, yq P Npx1qˆNpy1q
simultaneously, but this is in general impossible in the quantum setting.4

Note that the same issue does not arises classically because the optimal strategy in G can be
taken to be a deterministic one, and the players in G1 can use the same labeling suggested by
the optimal strategy in G to give labels to all of Npx1q and Npy1q simultaneously. This strategy
however relies on the fact that classically diﬀerent questions have a simultaneous labeling, a fact
which certainly has no quantum analogue.

We resolve the above issue using a novel entangled value-preserving variant of fortiﬁcation
which we call ordered fortiﬁcation. The basic idea for ordered fortiﬁcation is to give the players
some extra advice information which helps in preserving the entangled value.

Let G be a game and G1 “ pM˝G˝Pq be a concatenated version of G. There is an extra parameter
l in the construction deﬁned as l “ max maxx1PX1 |Npx1q|, maxy1PY 1 |Npy1q|(.
Deﬁnition 1.4 (Ordered concatenation). Let G and G1 be as above. In G1OF, the referee samples px, yq
according to G and picks random neighbors x1 „ Npxq and y1 „ Npyq independently. She then also picks
two random injective maps rx1 : Npx1q Ñ rls and sy1 : Npy1q Ñ rls conditioned on sx1pxq “ ry1pyq. The
referee sends x1 and rx1 to the ﬁrst player, and y1 and sy1 to the second and accepts if the players’ answers
a1 : Npx1q Ñ A and b1 : Npy1q Ñ B satisfy Vpa1pxq, b1pyq, x, yq “ 1.

Here the crucial point is that rx1 and sy1 are correlated. They give matching labels to true
questions x and y. To achieve the same winning probability as in G, the players in G1OF will share
l copies of the state |ψy from the optimal strategy in G. For each x˚ P Npx1q with label i “ rx1px˚q,
the ﬁrst player will apply the optimal G-strategy for x to the ith copy of |ψy (similarly for the
second player). The fact that rx1pxq “ sy1pyq ensures that for the true questions x and y the players
apply the optimal G strategies to the same copy of |ψy, and hence are able to win with exactly the
same winning probability as in G.

Of course, the crucial part here is that even though the auxiliary information in rx1 and sy1 is
helpful to the players for replicating the winning probability of G, it should not be “too helpful”.
In particular, we need to still be able to prove that G1OF is fortiﬁed with appropriate parameters.
This point is established by the following theorem.

Theorem 1.5 (Main-ordered fortiﬁcation). Let G be a game and M and P be two bipartite graphs as
above. Let G1OF be constructed from G and G1 “ pM ˝ G ˝ Pq as in Deﬁnition 1.4. Then, we have

Val*pG1OFq “ Val*pGq.

4This is because the measurement operators of diﬀerent questions do not in general commute which prevents Alice
(say) to obtain simultaneous answers for all questions in Npx1q. As a further illustration of this issue, see Section 2.2
for an example of a game where Val*pG1q ă Val*pGq.

6

Furthermore if M and P are λ-spectral expanders and λ ď ε2δ

56 , then G1OF is also pε, δq weakly fortiﬁed.
We prove Theorem 1.5 in Section 6 using a spectral argument that reduces it to Theorem 1.3.
Beside the above, we also prove a simple multiplayer fortiﬁcation in Section 5 for classical games.
It may be possible to adapt the proofs of Theorem 1.3 and Theorem 5.2 to obtain a multiplayer
fortiﬁcation theorem for entangled games. Although plausible, some further technical issues arise
in this case which we do not pursue here.

Biregularization. As already mentioned, biregularization is a minor (but necessary) step in the
fortiﬁcation framework. Our biregularization lemmas are presented in Subsection 2.3 and are
proved in Appendix A. In terms of ﬁnal statement, our biregularization lemmas are incomparable
with those of [Mos14, BSVV15]. For example, in the case of graphical games, we prove a biregular-
ization lemma which preserves the value exactly but has a cubic blow-up in the number of ques-
tions, whereas the biregularization lemmas from [BSVV15, Mos14] had a nearly linear blow-up
but only preserved value up to an additive error. Moreover, in this work we prove biregularization
for all games whereas [BSVV15, Mos14] only considered graphical games. (See Subsection 2.3 for
deﬁnitions.)

1.2 Related work

The main result underlying the present work is Moshkovitz [Mos14], where the framework of
parallel repetition via fortiﬁcation was ﬁrst introduced. Some simpliﬁcations and corrections
to the work of Moshkovitz appeared in Bhangale et al. [BSVV15]. In particular, an important
contribution of [BSVV15] was the clariﬁcation of the best bounds possible in classical fortiﬁcation
theorems [BSVV15, Appendix C]. Going back, the general idea of modifying the game in order to
facilitate its analysis under parallel repetition originates from the work of Feige and Kilian [FK00]
who introduced the confuse/miss-match style repetition of games. The Feige-Kilian type parallel
repetition was later extended by Kempe and Vidick [KV11] to the quantum setting allowing them
to obtain the ﬁrst general parallel repetition theorem for quantum games.5

Another important set of ideas underlying our work is related to the analytic approach to par-
allel repetition pioneered by Dinur and Steurer [DS14], further extended by Dinur et al. [DSV14].
Our analytic reformulation of fortiﬁcation framework is very much inspired by the ideas in these
works.

Yet another diﬀerent stream of work (more distantly related to the present work) follows the
original ideas of Raz and Holenstein [Raz98, Hol07] by taking a more information theoretic ap-
proach to quantum parallel repetition. The ﬁrst results in this direction were obtained by Chail-
loux and Scarpa [CS14] and Jain et al. [JPY14] who prove exponential-decay parallel repetition
results for free two-player games. Their analysis, as well as the follow-up work of Chung et
al. [CWY15], provided the basis for the recent work of the authors [BVY15] who obtained hard-
ness ampliﬁcation method in great generality by introducing and analyzing the parallel repetition
of a class of games called anchored games. The ﬁnal hardness ampliﬁcation results obtained here
through fortiﬁcation are incomparable to that of [BVY15]: fortiﬁcation allows for a somewhat

5Their transformation did not preserve the entangled value, and hence did not lead to a fully general hardness
ampliﬁcation method for entangled games (being restricted to the case where the completeness holds with classical
strategies). Our Theorem 1.3, without the improvement of Theorem 1.5, is applicable to a similar setting.

7

faster rate of decay in some regimes,6 yet it suﬀers from a much larger blow-up in terms of alpha-
bet size.

Turning to the multiplayer setting, very little was known prior to the present work and [BVY15].
It is folklore that free games with any number of players satisfy a parallel repetition theorem, and
this was explicitly proved in both classical and quantum settings in [CWY15]. Multiplayer par-
allel repetition has been studied in the setting of non-signaling strategies, a superset of entangled
strategies which allows the players to generate any correlations that do not imply communication.
Buhrman et al. [BFS13] show that the non-signaling value of a game G with any number of players
decays exponentially under parallel repetition, with a rate of decay that depends on the entire de-
scription of the game G. Arnon-Friedman et al. [AFRV14] and Lancien and Winter [LW15] achieve
similar results using a diﬀerent technique based on “de Finetti reductions”. An interesting fact
about the latter work [LW15] is the use of a notion of sub-no-signalling strategies which seems
related to our notion of quantum/classical substrategies.

1.3 Organization

In Section 2, we introduce some basic deﬁnitions and notation including the notion of substrate-
gies, induced strategies, and some other basic results and deﬁnitions that are used throughout
the paper. In Section 3, we complete the presentation of our main results (which was started in
the introduction), discuss the parameters of the ﬁnal gap ampliﬁcation results, and present the
formal deﬁnition of analytically fortiﬁed games.

The remaining sections contain proof of the main theorems. Our parallel repetition theorem
is proved in Section 4. Theorems 1.2 and 1.3 are proved in Sections 5 and 7, respectively. The
reduction from Theorem 1.5 to Theorem 1.3 is given in Section 6. The biregularization lemmas
are proved in Appendix A. We conclude by some open problems in Section 8.

2 Preliminaries
Given a distribution µ, by z „ µ we mean that the random variable z is distributed according to µ.
For a set S, by z „ S we mean z „ US where US is the uniform distribution over S. For Hermitian
matrices A, B we write A ě B if and only if A´ B is positive semideﬁnite.

Given two games G1 and G2, we deﬁne the tensor product game G1 b G2 as the game where
the referee selects two pairs of questions px1, y1q and px2, y2q independently according to G1 and
G2, sends px1, x2q and py1, y2q to Alice and Bob respectively, and checks their answers pa1, a12q and
pb1, b2q according to the product predicateś2

2.1 Game value and strategies

i“1 Vpai , bi , xi , yiq.

The main goal of this section is to introduce the notion of classical and quantum substrategies
which replace the notion of subgames from [Mos14, BSVV15]. As subgames were central in the
combinatorial framework of [Mos14], substrategies are similarly central to our analytic framework.
Let G be a game with question sets X, Y , answer sets A, B, predicate V , and question distribu-

tion µ on X ˆ Y .
Deﬁnition 2.1 (Classical substrategies). Let G “ pXˆY , AˆB, µ, V q be a two-player game. A classical
6For example, for general two-player games the fortiﬁcation approach gives a nearly perfect decay in terms of
number of repetitions and question size blow-up, whereas [BVY15] and other information theoretic results have a
p1´ ε2qΩpmq type behavior which is weaker than fortiﬁcation when m ! ε´1.

8

substrategy is given by pf , gq where f : X ˆ A Ñ r0, 1s, g : Y ˆ B Ñ r0, 1s satisfy

@x P X, f pxq :“ÿa

f px, aq ď 1,

@y P Y , gpyq :“ÿb

gpy, bq ď 1.

We call pf , gq a “complete strategy” (sometimes simply strategy) if equality holds in all above inequal-
ities, i.e. f pxq “ gpyq “ 1 for all x, y.
Deﬁnition 2.2. Given a substrategy pf , gq, the value of G with respect to pf , gq is given by

ValpG, f , gq :“ E

Vpa, b, x, yq f px, aq¨ gpy, bq.

px,yq„µ ÿaPA,bPB

(5)

(6)

The classical value of G is

where the supremum is taken over all complete strategies f , g.

ValpGq :“ sup

f ,g

ValpG, f , gq,

We note that the deﬁnition given by (6) can be easily seen to be equivalent to the more tradi-

tional deﬁnition of the classical value, i.e.

ValpGq :“ max
p:XÑA
q:YÑB

E

px,yq„µ

Vpppxq, qpyq, x, yq,

(7)

because any strategy f : X ˆ A Ñ r0, 1s, g : Y ˆ B Ñ r0, 1s can be written as convex combination of
a collection of strategies of t0, 1u valued strategies; on the other hand, taking supremum over f , g
which are t0, 1u valued is precisely equivalent to (7).

Next, we extend the above notions to the quantum setting.

Deﬁnition 2.3 (Quantum substrategies). Let G “ pX ˆ Y , A ˆ B, µ, Vq be a two-player game. A
quantum (or entangled) substrategy for G is a tuple p|ψy,tAa
xu,tBb
yuq deﬁned by an integer d P N,
a unit vector |ψy P Cdˆd and sets of positive semi-deﬁnite matrices tAa
xuxPX,aPA,tBb
yuyPY ,bPB over Cd
satisfying
@y P Y , By :“ÿb
Bb
y ď Id.
(8)

@x P X, Ax :“ÿa

Aa
x ď Id,

If Ax “ By “ Id for every x, y the quantum substrategy is called a “complete strategy” (sometimes
simply strategy).
Deﬁnition 2.4. Given a quantum substrategy p|ψy,tAa
is given by
px,yq„µÿa,b

xu,tBb
Vpa, b, x, yqxψ|Aa

yuq, the value of G with respect to p|ψy,tAa

Val*pG,|ψy,tAa

yuq “ E

xu,tBb

x b Bb

y|ψy.

xu,tBb
yuq

The entangled value of G is deﬁned as
Val*pGq “

sup
|ψy,tAa
xu,tBb
yu

Val*pG,|ψy,tAa

xu,tBb

yuq,

(9)

where the supremum is taken over all complete strategies p|ψy,tAa

xu,tBb

yuq.

9

2.2 Concatenated games
Let G “ pX ˆ Y , A ˆ B, µ, Vq be a game, and M and P two bipartite graphs over vertex sets pX1, Xq
and pY 1, Yq respectively. For each x P X or x1 P X1 let Npxq Ď X1 and Npx1q Ď X denote the set of
neighbors of x and x1, respectively (similarly for any y, y1). Recall the deﬁnition of Concatenated
Games from the introduction.
Deﬁnition (Deﬁnition 1.1 restated). In the concatenated game G1 “ pM ˝ G ˝ Pq, the referee selects
questions px, yq according to µ, and independently selects a random neighbor x1 for x using M, and y1
for y using P. The players receive questions x1 and y1 and respond by assignments a1 : Npx1q Ñ A and
b1 : Npy1q Ñ B respectively. The players win if Vpa1pxq, b1pyq, x, yq “ 1.
For a concatenated game G1 “ pM ˝ G ˝ Pq, we refer to G1 as the outer game and to G as the inner

game.

Let G1 “ pM ˝ G ˝ Pq be a concatenated game. Let dX1 “ maxx1PX1 |Npx1q|, dY 1 “ maxy1PB1 |Npy1q|.
Then, the alphabet of the concatenated game is given by A1 “ AdX1 , B1 “ BdY 1 . Similarly, it is easy
to see that the distribution µ1 of questions in G1 is given by µ1px1, y1q “ Epx,yq„µ
Deﬁnition 2.5. Let G1 “ pM ˝ G ˝ Pq be a concatenated game. To any pair of substrategies pf , gq for G1
we associate the induced substrategy7

1y1PN pyq
|Npyq|

|Npxq| ¨

1x1PN pxq

.

f px, aq :“ E

x1„Npxq ÿa1:a1pxq“a

f px1, a1q,

gpy, bq :“ E

y1„Npyq ÿb1:b1pyq“b

f py1, b1q.

(10)

Similarly, given an entangled substrategy p|ψy,tAa1
Aa1
x1,

as

Aa
x :“ E

x1„Npxq ÿa1pxq“a

x1u,tBb1
y1uq for G1, we deﬁne the induced substrategy
y1„Npyq ÿb1pyq“b
Bb
y :“ E
(11)

Bb1
y1.

Intuitively, an induced strategy is a strategy for the inner game in which the players proceed
as follows: given question x P X, y P Y and a strategy pf , gq for the outer game, the players select
two random neighbors of their questions x1 P Npxq, y1 P Npyq independently, and play according
to the labeling of x, y suggested by pf , gq at x1 and y1.

The following simple proposition will play an important role throughout the paper.

Proposition 2.6. Let G1 “ pM˝G˝Pq be a concatenated game. The value of any classical strategy pf , gq
(resp. quantum strategy p|ψy,tAa1
y1uq) in the outer game G1 is equal to the value of the induced

x1u,tBb1

strategy in the inner game G:
ValpG1, f , gq “ ValpG, f , gq
As a consequence,

and

Val*pG1,|ψy,tAa1

x1u,tBb1

y1uq “ Val*pG,|ψy,tAa

xu,tBb

yuq.

Furthermore,

ValpG1q ď ValpGq,

and

Val*pG1q ď Val*pGq.

ValpG1q “ ValpGq.

7Note the slight (but convenient) abuse of notation due to the use of the same letter to represent a substrategy
and the corresponding induced substrategy. The more accurate but more cumbersome way of denoting the induced
strategies in in [DS14]’s language would have been Mf and Pg.

10

(12)

(13)

(14)

Proof. The ﬁrst equality in (12) follows from linearity of expectation and the deﬁnition of induced
strategies as

ValpG1, f , gq “ E
px,yq„µ

E

x1„Npxq

E

y1„Npyq ÿa1PA1,b1PB1

Vpa1pxq, b1pyq, x, yq f px1, a1q¨ gpy1, b1q

“ E

px,yq„µ ÿaPA,bPB

“ ValpG, f , gq.

Vpa, b, x, yq f px, aq¨ gpy, bq

The second equality is proved similarly. The two inequalities (13) follow directly from (12). To
show (14) it remains to show that ValpG1q ě ValpGq. Consider an optimal deterministic strategy
for G given by p : X Ñ A and q : Y Ñ B. For any x1 P X1, y1 P Y 1 deﬁne a1 : Npx1q Ñ A according to p
and b1 : Npy1q Ñ B according to q. It is easy to see that this achieves the same value in G1 as pp, qq
did in G.

As mentioned in the introduction, the quantum analogue of (14) does not hold in general. For
example, consider the case that M and P are complete bipartite graphs. In this case, the players
playing G1 “ pM ˝ G ˝ Pq need to provide a labeling to all vertices in X and Y simultaneously.
But this is essentially just a classical strategy as the labelings for X, Y are now ﬁxed. Hence,
Val*pG1q “ ValpGq, the classical value, which in many cases could be much smaller than Val*pGq.
2.3 Biregularization

As in [Mos14, BSVV15] we prove our fortiﬁcation theorems for the special class of biregular games.

Deﬁnition 2.7. A two-prover game G “ pX ˆ Y , Aˆ B, µ, Vq is called biregular if the marginals of µ on
X and Y are both uniform.

The following lemma justiﬁes that for our purposes we may always assume a game is biregular.

Lemma 2.8 (Biregularization lemma). Let G “ pXˆY , AˆB, µ, V q be a two-prover game and τ P p0, 1q
a ﬁxed constant. There exists an eﬃcient algorithm that given G produces a biregular game Gint with
question sets Xint and Yint of cardinality at most
8|X|2|Y|

8|X||Y|2

(15)

,

,

|Xint| ď

τ

|Yint| ď

τ

the same answer alphabet size as G, and value satisfying

ValpGq ď ValpGintq ď ValpGq` τ,

Val*pGq ď Val*pGintq ď Val*pGq` τ.

(16)

Note that (16) implies that applying the Biregularization Lemma to a game never decreases its

value, and hence the procedure is completeness preserving.

A widely used class of games in applications are so-called graphical games, for which we can

get an improved biregularization result that does not require any approximation factor τ.

Deﬁnition 2.9. A graphical game G is a game where the questions are given by choosing an edge of
a bipartite graph uniformly at random (i.e. E Ď X ˆ Y and µpx, yq “ 1
if px, yq P E and µpx, yq “ 0
|E|
otherwise). The predicate and the answers do not have any restrictions.

11

Lemma 2.10 (Biregularization lemma, graphical case). Suppose G is two-prover graphical game with
E edges between pX, Yq. There exists an eﬃcient algorithm that given G produces a biregular game Gint
with question sets Xint and Yint bounded by

|Xint| ď |E|¨|X| ď |X|2|Y|,

|Yint| ď |E|¨|Y| ď |X||Y|2,

the same answer alphabet size as G, and the value satisfying

ValpGq “ ValpGintq

Val*pGq “ Val*pGintq.

(17)

(18)

Remark 2.11. In the above, we can allow for multiple edges across vertices of G. In this case E
must be taken as a multi-set and the bound |E| ď |X||Y| used in (17) must be suitably modiﬁed.

Interestingly, our technique for proving the biregularization lemmas is concatenation itself!

This is done in Appendix A.

2.4 Expanders

The method used in [Mos14, BSVV15] for fortifying a game is concatenation with suﬃcient pseu-
dorandom bipartite graphs. This is done using extractors in [Mos14] whereas expanders are em-
ployed in [BSVV15].8 Here we follow the latter approach and use expanders.

Let M “ pX1 ˆ X, Eq be a bipartite graph. For x P X let Npxq Ď X1 denote the set of neighbors
of x and similarly for x1 P X1. We shall work with graphs that are X-regular, i.e. d “ |Npxq| for all
x P X. Deﬁne distributions µ and µ1 on X and X1 via

µpxq “

,

1
|X|

µ1px1q “ |Npx1q|

d

.

for all x P X and x1 P X1. Note that µ1px1q is the probability of obtaining x1 by sampling x „ µ
and taking a random neighbor of (according M) x . Let M be the following normalized adjacency
matrix of M

µ1px1q

if x1 P Npxq
otherwise

0

d ¨b µpxq
Mpx, x1q “# 1
db|X1|

|X|

We usually view M as an operator from ℓ2pX1q to ℓ2pXq. Note that when M is a biregular expander
we get the simpler deﬁnition Mpx, x1q “ 1
Deﬁnition 2.12. A bipartite graph M is called a λ-spectral expander if the second-largest singular
value of M is at most λ.

for x1 P Npxq, and 0 otherwise.

A simple useful proposition for us is the following:

Proposition 2.13. Let M “ pX1 ˆ X, Eq be a bipartite λ-spectral expander. For f : X1 Ñ R and x P X
let f pxq “ Ex1„Npxq f px1q, and ¯f “ Ex1„µ1 f px1q “ Ex„µ f pxq. Then

E

x„µpf pxq´ ¯f q2 ď λ2 E

x1„µ1pf px1q´ ¯f q2.

(19)

8The two approaches however lead to essentially to similar parameters (e.g. λ “ Opε?δq to get pε, δq-fortiﬁed graph

where λ is the second largest singular value of normalized adjacency matrix of the concatenating graph.); moreover, in
the classical setting the approaches are in fact are more or less equivalent. See [BSVV15] for more.

12

to unit vectors deﬁned as pµpxq :“aµpxq and pµ1px1q :“aµpx1q.
Proof. Let pµ P RX, pµ1 P RX1
LetqXpxq :“aµpxq f pxq, qX1px1q :“aµpx1q f px1q.
First, observe that M pµ1 “ pµ and Mt pµ1 “ pµ. It follows that ppµ, pµ1q form a pair of singular
vectors of M. Moreover, it is easy to see9 that these are top singular vectors which shows that
}M}op “ 1. Now notice that

E

x1Ðµ1pf px1q´ ¯f q2 “ÿx1 pbµpx1qf px1q´ ¯fbµpx1qq2 “ }qX1 ´ ¯f pµ1}2

2,

Second, observe

As such, (19) precisely corresponds to

M qX1 “ qX .

2 “ }MpqX1 ´ ¯f pµ1q}2
The claim follows by noting the orthogonality property

}qX ´ ¯f pµ}2

2 ď λ2 ¨}qX1 ´ ¯f pµ1}2
2.

xqX1 ´ ¯f pµ1, pµ1y “ÿx1

µpx1qf px1q´ ¯f “ 0.

(20)

(21)

(22)

(23)

3 Fortiﬁcation Framework

This section introduces the fortiﬁcation framework. We deﬁne the notion of analytically fortiﬁed
games and recall our main parallel repetition and fortiﬁcation theorems. We end by a discussion
of the parameters of the resulting gap ampliﬁcation results.

3.1 Analytical fortiﬁcation

We distinguish between two variants of the notion of fortiﬁed games which we call weakly fortiﬁed
games and strongly fortiﬁed games. Although the diﬀerence between the two may seem minor, this
diﬀerence is in fact quite important in the quantum case.
Deﬁnition 3.1 (Fortiﬁed games). Let ε, δ P r0, 1s. A concatenated game G1 “ pM ˝ G ˝ Pq is called
weakly pε, δq- fortiﬁed against classical substragies if for any substrategy f , g we have

ValpG1, f , gq ď pValpGq` εq¨ E
px,yq„µ

f pxq gpyq` δ.

(24)

Similarly, we deﬁne G1 to be weakly pε, δq-fortiﬁed against entangled substrategies if for any substrategy
tAa1

y1u we have

x1u,tBb1

Val*pG1,tAa1

x1u,tBb1

y1uq ď pVal*pGq` εq¨ E

px,yq„µxψ|Ax b By|ψy` δ.

(25)

If furthermore ValpGq (resp. Val*pGq) can be replaced by ValpG1q, (resp. Val*pG1q) in the above then
the game is called “strongly fortiﬁed” against classical (resp. quantum) substrategies.

9e.g. by appealing to the Perron-Frobenius theorem.

13

Note that our main results, Theorems 1.2 and 1.3, show how any game can be (weakly) fortiﬁed

by concatenating it with good-enough spectral expanders.

Two remarks regarding the above deﬁnition are in order:

• Using (13), we see that strong fortiﬁcation implies weak fortiﬁcation, as expected from the

terminaology.

• From (14) it follows that the two notions in fact coincide in the case of classical fortiﬁcation,

but this is no longer the case for quantum fortiﬁcation.

Our notion of fortiﬁed games and that of [Mos14, BSVV15] are closely related. Essentially, in
Deﬁnition 3.1 we have replaced the the condition for all δ-large rectangles in (1) with a smoother
condition. In terms of a precise relation, we can show the following.

Claim 3.2. Every pε, εδq strongly fortiﬁed game is also p2ε, δq combinatorially fortiﬁed.
Proof. Consider a subgame given by S Ď X, T Ď Y in G. To every strategy pp, qq for GSˆT , i.e.,
p : S Ñ A, q : T Ñ B, we can associate a natural substrategy pf , gq by

if y P T ^ qpyq “ b,
otherwise

.

(26)

f px, aq “#1

0

if x P S ^ ppxq “ a,
otherwise

,

gpy, bq “#1

0

Then one can easily see

ValpG, f , gq “ ValpGSˆT , p, qq¨ µpS ˆ Tq.10

(27)

Now assuming that rectangle S ˆ T is δ-large, i.e. µpS ˆ Tq ě δ, and since G is fortiﬁed against
classical substrategies, we have

ValpGSˆT , p, qq “

ValpG, f , gq
µpS ˆ Tq

ď pValpGq` εq¨
ď ValpGq` 2ε

Epx,yq„µ f pxqgpyq

µpS ˆ Tq

`

δε

µpS ˆ Tq

(28)

(29)

(30)

where in the second inequality we used µpS ˆ Tq “ Epx,yq„µ f pxqgpyq.

We note that in Lemma 3.2, the reverse implication does not hold and the notion of analytically
fortiﬁed game is strictly stronger. In what follows, in the rare occasion when we call a game
fortiﬁed (without specifying weak or strong) we mean strongly fortiﬁed.
10The term µpS ˆ Tq “ Epx,yq„µ f pxqgpyq is a natural scaling parameter playing an important role in our discussion

as a measure of the “largeness” of a subgame or a substrategy.

14

3.2 Parallel repetition of fortiﬁed games

Using the deﬁnition of fortiﬁed games, it is straightforward to prove the following parallel repe-
tition theorem.
Theorem 3.3 (Basic parallel repetition). Let G12 be a pε, δq-fortiﬁed game against classical substrate-
gies. Then for any game G11 we have

ValpG11 b G12q ď pValpG12q` εq¨ ValpG11q` δ ¨|Σ

1|,
G1

(31)

where Σ

G1
1

is the total answer alphabet size (i.e. the product of Alice and Bob’s alphabets) of G11.

We prove this theorem in Section 4 by adapting the proof of the analogous theorems in [Mos14,
BSVV15] to the analytic setting. Unfortunately, while this theorem exempliﬁes the main idea
behind our results, it is not directly useful for applications. The reason for this is that the
fortiﬁcation procedure G Ñ G1 via concatenation induces a large blow-up in the alphabet size,
G|D, where D “ 1
|Σ
is the degree of the expander graph chosen. As one iterates the rep-
ε?δ
G1|m´1.
etition procedure m times, the blow-up due to the additive term in (31) will be of order δ|Σ
G|pm´1q{?δ, leading to a term larger than 1 and rendering the theorem
But typically |Σ
useless.

G1|m´1 " |Σ

G1| « |Σ

We resolve this problem by proving an improved repetition theorem which exploits the fact
that G1 takes the form of a concatenated game, whose inner game G has a much smaller alphabet.
Theorem 3.4. Let G1 be a concatenated game, with inner game G, that is pε, δq-weakly fortiﬁed against
classical substrategies. If δ ¨pm´ 1q¨|Σ

G|m´1 ď η then

ValpG1bmq ď pValpGq` εqm ` η.

Similarly, if G1 is pε, δq weakly-fortiﬁed against entangled substrategies and δ ¨ pm ´ 1q ¨ |Σ
then

Val*pG1bmq ď pVal*pGq` εqm ` η.

(32)

G|m´1 ď η
(33)

The main advantage of Theorem 3.4 compared to Theorem 3.3 is in the additive error, which
G| is indepen-
G1| grows exponentially as δ decreases. Let us

is now is in terms |Σ
dent of the fortiﬁcation parameters pε, δq whereas |Σ
also note that Theorem 3.4 is quite general, and in particular applies to the multiplayer case.

G1|. What is important here is that the size of |Σ

G| rather than |Σ

3.3 Gap ampliﬁcation

Having stated our main parallel repetition, fortiﬁcation, and biregularization theorems, all the
main components of gap ampliﬁcation are ﬁnally in place. Indeed, using ValpGq “ ValpG1q The-
orem 3.4 implies our ﬁnal gap ampliﬁcation for the classical value. This matches the parameters
of main results of [Mos14, BSVV15] and extends it to more general settings.

Since quantumly we could have Val*pG1q ă Val*pGq, from (33) we cannot obtain

Val*pG1bmq ď pVal*pG1q` εqm ` η.

(34)

However, Theorem 1.3 and Theorem 3.4 are still suﬃcient to prove a gap ampliﬁcation theorem
for the case where the completeness holds against classical players and the soundness against the

15

quantum ones.11 To obtain a fully quantum gap ampliﬁcation however, we need to appeal to the
notion of ordered fortiﬁcation which, as we discussed, is a entangled-value preserving variant of
the ordinary fortiﬁcation.

Theorem (Theorem 1.5 restated). Let G be a game and M and P be two bipartite graphs as above. Let
G1OF be constructed from G and G1 “ pM ˝ G ˝ Pq as in Deﬁnition 1.4. Then, we have

Val*pG1OFq “ Val*pGq.
Furthermore if M and P are λ-spectral expanders and λ ď ε2δ

56 , then G1OF is also pε, δq weakly fortiﬁed.
We stress that G1OF constructed above is itself a concatenated game with the inner game G‘l,
disjoint union of l “ polyp 1
ε2δq copies of G. This means the inner alphabet size of G1OF is precisely
the same as G’s, and therefore there is fortunately no issue in terms of alphabet blow-up for
applying Theorem 3.4 to G1OF. So using G1OF instead of G1 in Theorem 3.4, we can ﬁnally prove
the analogue of (34) for G1OF.
Parameters of gap ampliﬁcation. We can now discuss the parameters of the gap ampliﬁcation
corollaries. As in [Mos14, BSVV15], the parameters are typically very good in terms of question
sizes but much worse in terms of alphabet size. Here, we mostly focus our discussion to gap
ampliﬁcation in the classical setting as the calculations in the quantum setting are similar.

To understand the parameters, we need to only consider the soundness case. Suppose we are
given a game G with guarantee ValpGq ď 1´ τ and a target soundness value β. We choose ε “ τ{2
and m such that pValpGq` εqm ď β{2. Hence, we have m “ logp2{βq
ValpG1bmq ď pValpGq` εqm ` δ ¨pm´ 1q|Σ
G|m´1 ď β{2. So we have δ “

Hence, we just need to ensure δ ¨|Σ
So what does the above mean in terms of the size of the ﬁnal output of gap ampliﬁcation
G1bm. The question size is |X|m and |Y|m (since we have |X1| “ |X| and |Y 1| “ |Y|). Note that m is
essentially as small as we can hope for because even given a perfect parallel repetition theorem,
we had to take m « logp1{βq
. Hence, the construction is essentially optimal in terms of question

G|m´1 ď β.
G|m´1 .

logp1´τ{2q ď 2 logp2{βq

β
pm´1q¨|Σ

. We want

(35)

τ

sizes.

τ

For the alphabet size, the situation is much worse. We have |Σ
m2|ΣG |m´1

This means (up to dominant factors) that |Σ
exponentially worse than basic parallel repetition which results in |Σ
typical settings where |Σ
this exponentially worse behavior of alphabet size does not cause a signiﬁcant problem.

G1| “ |Σ
which means that the alphabet is
G|m. Note that however in
G| is constant and β a small constant (or inverse logarithmic in size of G),

G1bm| “ |Σ

G|

β

G|D where D “ Op poly logp1{ε2δq

ε2δ

q.

Next, let us consider the setting where the completeness holds for classical players and sound-
ness against entangled players. In this case, we can just use Theorem 1.3 instead of Theorem 1.2,
and hence all the calculations are precisely the same with ε and δ replaced with their squares.

Lastly, in the fully quantum case we need to use Theorem 1.5. In this case, m, ε, δ are chosen
in precisely the same way. Alphabet size is also exactly the same as G1OF has the same alphabet
11E.g. as was the case in [IV12, Vid13].

16

size as G1. The only diﬀerence is that the question sizes in G1OF are slightly larger than G1: we have
|X1| “ |X|¨ polyp|Σ
q. This is however arguably a minor blow-up since
we typically expect that |Σ
4 Parallel Repetition Theorems

G|{β to be much smaller than sizepGq “ |X|¨|Y|.

q and |Y 1| “ |Y|¨ polyp|Σ

G|m
β

G|m
β

In this section we prove our main parallel repetition theorem.
Theorem (Theorem 3.4 restated). Let G1 be a concatenated game pε, δq-weakly fortiﬁed against classi-
cal substrategies with inner game G. If δ ¨pm´ 1q¨|Σ

G|m´1 ď η then
ValpG1bmq ď pValpGq` εqm ` η.

Similarly, if G1 is pε, δq weakly-fortiﬁed against entangled substrategies and δ ¨ pm ´ 1q ¨ |Σ
then

Val*pG1bmq ď pVal*pGq` εqm ` η.

The proof follows directly from the following proposition.

Proposition 4.1. Let tG1iut
that G1t is pε, δq weakly fortiﬁed against classical substrategies. Then,

i“1 be a collection of concatenated games with inner games tGiut
t´1źi“1

ValpG11 b G12 b . . . b G1tq ď pValpGtq` εq¨ ValpG11 b G12 b . . . b G1t´1q` δ ¨

|Σ

Gi|.

Similarly, if G1t is pε, δq weakly fortiﬁed against quantum substrategies, then

Val*pG11 b G12 b . . . b G1tq ď pVal*pGtq` εq¨ Val*pG11 b G12 b . . . b G1t´1q` δ ¨

t´1źi“1

|Σ

Gi|.

(36)

G|m´1 ď η
(37)

i“1. Suppose

(38)

(39)

The key to proving Proposition 4.1 is to work with the induced strategies. This allows us to
get an additive error depending just on the alphabet size of the inner game. In the proof, we use
the usual notation where a strategy missing an (answer) argument indicates summation over that
variable. For example,

f px1, a1, . . . , xt´1, at´1, xtq “ÿat

f px1, a1, . . . , xt´1, at´1, xt, atq.

Proof. We only prove (38) as the proof of (39) follows the same structure. Also for simplicity, we
focus on the case of two-player games as the proof of the multiplayer case is a straightforward
extension.

Consider any strategies f : X11 ˆ A11 ˆ . . .ˆ X1t ˆ A1t Ñ r0, 1s, g : Y 11 ˆ B11 ˆ . . .ˆ Y 1t ˆ B1t Ñ r0, 1s. To
clarify notation we will denote tuples pz1, . . . , zt´1q as zăt. With this notation, ValpG11b. . .bG1t, f , gq
is precisely

E

pxďt,yďtq

E
x1

ďt

E
y1

ďt ÿa1

ďt,b1

tźi“1

ďt

Vpa1ipxiq, b1ipyiq, xi , yiq f px1ďt, a1ďtq¨ gpy1

ďt, b1ďtq,

(40)

17

where the expectations are according to pxi , yiq „ µi and x1i „ Npxiq and y1i „ Npyiq for all i “
1, . . . , t. As usual let

f pxăt, aăt, x1t, a1tq “

f px1ăt, a1ăt, x1t, a1tq.

ipxiq“ai , iăt

x1

E

ăt„Npxătq ÿa1
t´1źi“1

Using this notation, we can rewrite (40) as

where Spxăt, yăt, aăt, bătq is given by

E

Vpai , bi , xi , yiq Spxăt, yăt, aăt, bătq,

pxăt,yătq ÿaăt,băt
t ÿa1
Vpa1tpxtq, b1tpytq, xt, ytq f pxăt, aăt, x1t, a1tq¨ gpyăt, băt, y1t, b1tq.

t,b1
t

E

pxt ,ytq

E
x1
t

E
y1

(41)

(42)

(43)

Consider the following substrategy G1t: ﬁx the ﬁrst 2pt ´ 1q arguments of f to pxăt, aătq and the
ﬁrst 2pt´ 1q arguments of g to pyăt, bătq. Then (43) is precisely the value of this substrategy in G1t.
Since G1t is pε, δq weakly fortiﬁed, it follows that

f pxăt, aăt, xtq¨ gpyăt, băt, ytq` δ.
Plugging this expression back into (42), ValpG11 b . . . b G1t, f , gq is bounded by

(43) ď pValpGtq` εq¨ E
pxt ,ytq

pValpGtq` εq E

Vpai , bi , xi , yiq f pxăt, aăt, xtq¨ gpyăt, băt, ytq` δ ¨

(44)

t´1źi“1

|Σ

Gi|.

To conclude we observe that

pxďt ,yďtq ÿaăt,băt
pxďt ,yďtq ÿaăt,băt

E

t´1źi“1
t´1źi“1

Vpai , bi , xi , yiq f pxăt, aăt, xtq¨ gpyăt, băt, ytq

(45)

is at most ValpG11 b . . .b G1t´1q, as for any ﬁxed pxt, ytq the functions f p¨, xtq : X11 ˆ A11 ˆ . . .ˆ X1t´1 ˆ
A1t´1 Ñ r0, 1s and gp¨, ytq : Y 11ˆB11ˆ. . .ˆY 1t´1ˆB1t´1 Ñ r0, 1s are valid strategies in G11b. . .bG1t´1.
Remark 4.2. Theorem 3.3 immediately follows from Proposition 4.1 by taking t “ 2 and consid-
ering the trivial concatenation G11 “ G1, G12 “ G2.

Theorem 3.4 follows easily.

Proof of Theorem 3.4. We prove (36) as the proof of (37) is similar.

The proof is by induction on m. The case m “ 1 is clear. By the induction hypothesis we have

ValpG1bpm´1qq ď pValpGq` εqm´1 ` δ ¨pm´ 2q|Σ

G|m´2.

Note that we can assume ValpGq` ε ă 1 otherwise (36) holds trivially. Applying Proposition 4.1
we see that

ValpG1bmq ď pValpGq` εq¨ ValpG1bpm´1qq` δ ¨|Σ

G|m´1
ď pValpGq` εqm ` δ ¨pValpGq` εq¨pm´ 2q|Σ
ď pValpGq` εqm ` δ ¨pm´ 1q¨|Σ

G|m´1.

G|m´2 ` δ ¨|Σ

G|m´1

18

5 Classical Fortiﬁcation

In this section we prove our main theorem regarding the fortiﬁcation of classical games. Beside
providing a short and self-contained treatment of the main result of [Mos14, BSVV15], it serves
as preparation for the analysis of Section 7.

Theorem (Theorem 1.2 restated). Let G be a biregular game, M and P two bipartite λ-spectral ex-
2b δ
panders. If λ ď ε
2 , then the concatenated game G1 “ pM ˝ G ˝ Pq is pε, δq weakly fortiﬁed against
classical substrategies.

We note that it follows from [BSVV15, Appendix C] that the dependence λ and δ in Theorem
1.2 is up to constant factors optimal. On the other hand, the tightness of dependence of ε and δ
does not seem to follow from [BSVV15] lower bound (however, δ is by far the more signiﬁcant of
the two parameters).

5.1 Proof of Theorem 1.2

We start with a simple claim whose proof we will defer to the end of the subsection.
Claim 5.1. Let M “ pX1 ˆ X, Eq and N “ pY 1 ˆ Y , Fq be two biregular bipartite graphs that are λ-
spectral expanders. Let µ be a distribution on X ˆ Y such that both marginals of µ are uniform. Let
f : X1 Ñ R and g : Y 1 Ñ R be any functions, and denote f : X Ñ R and g : Y Ñ R the functions
f : x ÞÑ Ex1„Npxq f pxq, g : y ÞÑ Ey1„Npyq gpyq respectively. Then

and

px2,y2q„µ

E

px1,y1q„µˇˇˇf px1qgpy1q´ E
ˇˇˇ E

f pxq E
y1„Y

gpy1q´ E

x1„X

f px2qgpy2qˇˇˇ ď 2?2λ´ E
f px2qgpy2qˇˇˇ ď 2λ2´ E

x1„X1|f px1q|2¯1{2´ E
x1„X1|f px1q|2¯1{2´ E

y1„Y 1|gpy1q|2¯1{2
y1„Y 1|gpy1q|2¯1{2

.

px2,y2q„µ

We prove a slightly stronger statement which implies Theorem 1.2. Let f , g be any substrate-

gies for G, and let γ “ Epx,yq„µ f pxqgpyq. We claim that

ValpG1, f , gq ď ValpGqγ ` 2?2 λ?γ ` 4 λ2.

(46)

To deduce the bound claimed in Theorem 1.2 from (46) we distinguish two cases. Either γ ď δ, in
which case using the trivial estimate ValpG1, f , gq ď γ the bound immediately follows. Or γ ą δ,
in which case

ValpGqγ ` 2?2λ?γ ` 4λ2 ď γpValpGq` 2?2λδ´1{2q` 4λ2

ď γpValpGq` εq` δ

given the relation between ε, δ and λ expressed in the theorem.
It remains to prove (46). Fix substrategies f and g. We have

ValpG1, f , gq “ E

px,yq„µ ÿVpa,b,x,yq“1

f px, aq¨ gpy, bq

“ E

px,yq„µ

f pxqgpyq ÿV pa,b,x,yq“1

f px, aq
f pxq ¨

gpy, bq
gpyq

,

19

where we adopt the convention that 0{0 “ 0. Using the triangle inequality,

ValpG1, f , gq ď γ E

px,yq„µ ÿV pa,b,x,yq“1

f px, aq
f pxq ¨

gpy, bq
gpyq ` E

px,yq„µˇˇf pxqgpyq´ γˇˇ

ď γ ValpGq` E

px,yq„µˇˇf pxqgpyq´ γˇˇ,

(47)

where the second inequality follows since px, aq ÞÑ f px, aq{f pxq and py, bq ÞÑ gpy, bq{gpyq form a
valid pair of strategies for G. It remains to estimate the second term above. Applying the ﬁrst
inequality in Claim 5.1,

y1„Y 1|gpy1q|2¯1{2
x1„X1|f px1q|2¯1{2´ E
gpy1q¯1{2

f px1q E
y1„Y 1

E

px,yq„µˇˇf pxqgpyq´ γˇˇ ď 2?2λ´ E
ď 2?2λ´ E
ď 2?2λbγ ` 2λ2
ď 2?2λp?γ `
?2λq
“ 2?2λ?γ ` 4λ2,

x1„X1

where in the second inequality we used 0 ď f px1q, gpy1q ď 1 for all x1, y1 and the third uses the
second inequality in Claim 5.1. Together with (47) this proves (46).

Finally, we prove Claim 5.1.

Proof of Claim 5.1. For the ﬁrst inequality, write

E

px1,y1q„µˇˇf px1qgpy1q´ E

E

ď

px2,y2q„µ

f px2qgpy2qˇˇ
px1,y1q,px2,y2q„µ`|f px1q´ f px2q||gpy1q|`|f px2q||gpy1q´ gpy2q|˘
x1,x2„X|f px1q´ f px2q|2¯1{2´ E
ď´ E
y1,y2„Y |gpy1q´ gpy2q|2¯1{2
2„X1|f px11q´ f px12q|2¯1{2´ E
ď λ´ E

y1„Y |gpy1q|2¯1{2
1„Y 1|gpy11q|2¯1{2

x2„X |f px2q|2¯1{2´ E
`´ E

x1
1,x1

y1

where the last inequality uses Proposition 2.13. Now note that E

` λ´ E

2„X1|f px12q|2¯1{2´ E

y1
1,y1

x1

2„Y 1|gpy11q´ gpy12q|2¯1{2
2„X1 |f px11q´f px12q|2 ď 2 Ex1„X1 |f px1q|2.
1,x1
x1

,

20

Applying a similar bound for g gives us the ﬁrst inequality. For the second, write

ˇˇ E

px2,y2q„µ

f px2qgpy2q E
x1„X

f pxq E
y1„Y
E

gpy1qˇˇ

“ˇˇ
px2,y2q„µ,x1„X,y1„Ypf px1q´ f px2qqpgpy1q´ gpy2qqˇˇ
x1,x2„Xpf px1q´ f px2qq2¯1{2´ E
ď´ E
2„X1pf px1q´ f px2qq2¯1{2´ E
ď λ2´ E
y1„Y 1|gpy1q|2¯1{2
x1„X1|f px1q|2¯1{2´ E
ď 2λ2´ E

y1,y2„Ypgpy1q´ gpy2qq2¯1{2
2„Y 1pgpy11q´ gpy12qq2¯1{2

y1
1,y1

x1
1,x1

.

5.2 A simple multiplayer fortiﬁcation

The following is a simple fortiﬁcation theorem for k-player games. Since Theorem 3.4 applies
equally well to the multiplayer setting, we get a hardness ampliﬁcation result for classical multi-
player games.

Theorem 5.2. Let G be a k-player game. Suppose G1 is given by composing each of the k sides of G by a
λ-spectral expander where λ ď 2δ{k. Then G1 is a p0, δq fortiﬁed game.12
Proof. Consider a classical substrategy for G1 given by fi : X1i ˆ A1i Ñ R` for i “ 1, 2, . . . , k. As usual,
denote fi : Xi ˆ Ai Ñ R` the projection of fi to the inner game G. By deﬁnition,

Vpa1, . . . , ak, x1, . . . , xkq¨ f1px1, a1q¨ fxpx2, a2q . . . fkpxk, akq.

ValpG,tfiuk

i“1q “ E

px1,...,xkq ÿa1,a2,...,ak

We can rewrite the above as

fipxiq ÿa1,...,ak

E

px1,...,xkq

kźi“1
Let γ “ Epx1,...,xkqśk

Vpa1, . . . , ak, x1, . . . , xkq¨

f1px1, a1q¨ fxpx2, a2q . . . fkpxk, akq

f px1q¨ f px2q . . . ¨ f pxkq

.

i“1 fipxiq. Applying the triangle inequality,

ValpG,tfiuk

i“1q ď γ ¨ ValpGq` E

px1,...,xkq|

kźi“1

fipxiq´ γ|.

12Although there is no ε dependence in the above, when applied to 2-player games the theorem is still weaker than

Theorem 1.2 because of the worse dependence on δ – which is the more crucial parameter than ε.

21

E

px1,...,xkqˇˇˇˇˇ
kźi“1

ď 2

“ E

fipxiq´

fipxiq´

ď 2¨ E

x1,...,xkˇˇˇˇˇ
fipxiq´ γˇˇˇˇˇ ď E
kźi“1
px1,...,xkqˇˇˇˇˇ
kźi“1
px1,...,xkqˇˇˇˇˇ
kźi“1
kÿi“1
kÿℓ“1ˇˇˇˇˇ
ℓ´1źi“1
kźi“ℓ
xipfipxiq´ fiq2˙1{2

xi |fipxiq´ fi|,

kÿi“1ˆE

fipxiq¨

E

Hence,

E

x1,...,xkˇˇˇˇˇ

kźi“1

fipxiq´ γˇˇˇˇˇ ď 2

The desired result follows.

fi ´ γˇˇˇˇˇ
kźi“1

fi ´ E

x1,...,xk

px1,...,xkqˇˇˇˇˇ
fiˇˇˇˇˇ` E
kźi“1
kźi“1
fiˇˇˇˇˇ`ˇˇˇˇˇ
kźi“1
kźi“1
fiˇˇˇˇˇ
kźi“1

fipxiq´

fipxiqˇˇˇˇˇ

fi ´

fipxiq¨

fiˇˇˇˇˇ ď
kźi“ℓ`1
kÿi“1
ipfipx1iq´ fiq2¸1{2

ℓźi“1
kÿi“1˜E

x1

ď 2λ

ď 2λk.

To conclude it will suﬃce to show the second term above is at most δ. Let fi “ Exi f pxiq. Then

where the ﬁrst equality is by deﬁnition of γ , the second inequality by convexity of |¨|, and the last
follows from

|f1px1qf2px2q . . . fkpxkq´ f1f2 . . . fk| ď

E

xi |fipxiq´ fi|.

6 Reducing Strong to Weak Fortiﬁcation for Entangled Games

In this section, we start working toward the problem of fortifying games in the entangled case. In
particular, we show how Theorem 1.5 follows from Theorem 1.3. Let G “ pX ˆ Y , Aˆ B, µ, V q be a
two-player game.
Deﬁnition 6.1. For a game G and integer l P N let G‘l denote the disjoint union of l copies of G.

Suppose that M and P are regular bipartite graphs over X1ˆX and Y 1ˆY , respectively. Suppose
further that M and P are balanced, i.e. |X1| “ |X| and |Y 1| “ |Y|. Let dM and dN denote the degree
of vertices M and P, respectively. (Note that since the graphs are balanced and regular, the left
and right degrees are the same.)

Following [BSVV15], we assume that M and P are explicit bipartite almost-Ramanujan ex-
panders, as provided e.g. by [BL06], for which the second-largest singular values λM and λP of
AM and AP (the normalized adjacency matrices) respectively satisfy

λM “ O˜ polyplog dMq
adM

¸ ,

λP “ O˜ polyplog dPq
adP

¸ .

(48)

fortiﬁed. Next we recall the deﬁnition of G1OF from the introduction.

ε2δq then Theorem 1.3 implies that G1 “ pM ˝ G ˝ Pq is pε, δq weakly-

Note that if dM , dP “ rΩp 1

22

Ordered fortiﬁcation. Let G, M, P and G1 “ pM ˝ G ˝ Pq be as above. let l “ maxtdM , dPu. In G1OFl
(or simply G1OF where l “ maxtdM , dPu) the referee samples questions px, yq as in G and selects two
random neighbors x1 P X1 and y1 P Y 1 of x and y in M and P respectively. Then the referee selects
two random injective maps rx1 : Npx1q Ñ rls and sy1 : Npy1q Ñ rls under the condition rx1pxq “ sy1pyq.
Alice’s question then is the pair px1, rx1q and Bob’s is the pair py1, sy1q. Alice outputs an answer tuple
a1 : Npx1q Ñ A and Bob b1 : Npy1q Ñ B. The players win if Vpa1pxq, b1pyq, x, yq “ 1.
Remark 6.2. Note that G1OF has exactly the same answer alphabet size as G1, the question sizes
|X1OF| and |Y 1OF| are larger than in G1. This blow-up can be mitigated as follows. It turns out that
in Deﬁnition 6.3 the use of the complete set Spd,lq is unnecessary. More precisely, from the proof
of the main claim of this section, Claim 6.6 below, it will be clear that the only condition required
is that the permutations be chosen from a pairwise independent subset of Spd,lq. Selecting the
smallest possible such subset lets us reduce the blow-up in the size of the question sets from a
multiplicative D! down to polypDq “ polyp 1

ε2δq. We omit the details.

Although it may not be immediately apparent, it is possible to view G1OF as a concatenated
game. Let G‘l be as in Deﬁnition 6.1. Note that G‘l has exactly the same classical and entangled
value as G. Let SpdM ,lq denote the set of all injective maps from rdMs Ñ rls. Fix maps ux1 : Npx1q Ñ
rdMs and vy1 : Npy1q Ñ rdMs ordering the neighborhoods of each x1, y1 in an arbitrary way.
Deﬁnition 6.3. Let M be a regular bipartite graph over X1 ˆ X as above . We deﬁne ĂM as a bipartite
graph over X1OF :“ X1 ˆ SpdM ,lq and XOF :“ X ˆrls where
We deﬁne rP from P in a similar way.
Note that here π ˝ ux1 exactly corresponds to rx1 : Npx1q Ñ rls map from the original deﬁnition

px1, πq „ ˜M px, iq

of G1OF. Hence, we obtain the following alternative characterization of G1OF.
Proposition 6.4. The game G1OF constructed above is a concatenated game given by

ðñ

πpux1pxqq “ i.

Next, we show that ordered fortiﬁcation preserves the entangled value (the classical value is

G1OF “ pĂM ˝ G‘l ˝rPq.

also preserved but that is not important here).
Proposition 6.5. We have Val*pG1OFq “ Val*pGq.
Proof. In one direction we have Val*pG1OFq ď Val*pG‘lq “ Val*pGq where we used Propositions
2.6 and 6.4. For the other direction, consider any entangled strategy p|ψy,tAa
yuq for G. We
construct a strategy for G1
‘ that achieves the same value. The provers share l copies of the state
|ψy, and each copy is assigned a unique label i P rls. Alice and Bob receive questions px1, rx1q and
py1, sy1q, respectively. For each x P Npx1q, Alice applies tAa
xu to the rx1pxq-th copy of |ψy. Bob applies
a similar strategy.

xu,tBb

Since by construction the “true questions” x˚ and y˚ are given the same label, the distribution
of answers obtained for x˚ and y˚ is identical to the distribution of answers obtained while playing
G using p|ψy,tAa

yuq, hence achieving the same winning probability.

xu,tBb

23

The main technical step in reducing Theorem 1.5 to Theorem 1.3 is an analysis of the singular

values ofĂM,rN in terms of the singular values of M and N . We prove the following.
Claim 6.6. Let M be a bipartite graph over X1ˆX as above and let λM denote the second largest singular
value of M. Let ˜M be as in Deﬁnition 6.3. Then,

λ ˜M ď max#λM ,

1

adM ´ 1+ .

Since in our case λM “ Oppolyplog dMq{dMq, Claim 6.6 implies that λ ˜M satisﬁes the same
bound. Also note that a similar statement of course applies to ˜P and λ ˜P. So we see that Theorem
1.3, Propositions 6.5 and 6.4, and Claim 6.6 together imply Theorem 1.5; it remains to prove the
latter.

Proof of Claim 6.6. Recall that by assumption M is a regular balanced bipartite graph. Let d :“ dM
the degree of vertices in M. The normalized adjacency matrix of ˜M is given by

A ˜Mppx1, πq,px, iqq “# 1

0

d ¨bpl´dq!

pl´1q!

px1, πq „ ˜M px, iq
px1, πq ≁ ˜M px, iq

.

(49)

We relate the second largest singular value λM of AM and the second largest singular value λ ˜M
of ˜M by relating the eigenvalues of B “ AJM AM and C “ AJ˜M
A ˜M . We can explicitly compute the
entries of B and C. For B,

Bpx1, x2q “ |tx1 P X1 : tx1, x2u Ă Npx1qu|
d for all x P X. To compute entries of C, ﬁrst note that when x1 ‰ x2

(50)

d2

,

and in particular Bpx, xq “ 1
and i ‰ j we have

Cppx1, iq,px2, jqq “ |tx1 P X1 : tx1, x2u Ă Npx1qu|¨pl ´ dq!

d2pl ´ 1q!

¨ pl ´ 2q!
pl ´ dq! “

Bpx1, x2q
l ´ 1

.

(51)

Finally, observe the following special cases:

• Cppx, iq,px, iqq “ 1
d .
• Cppx1, iq,px2, iqq “ 0 if x1 ‰ x2.
• Cppx, iq,px, jqq “ 0 when i ‰ j.

oﬀ-diagonal entries, and 0 along the diagonal. Then it is easy to see that

LetrB “ B´ 1

d Id and rC “ C ´ 1

d Id. LetrJ “ 1

l´1pJ ´ Idq be the l ˆ l matrix that is pl ´ 1q´1 in the
rC “rB brJ.

(52)

24

The matrixrJ has a single eigenvalue equal to 1 and l ´ 1 eigenvalues equal to ´ 1
M ´ 1
single eigenvalue equal to 1´ 1{d and the remaining are in the range r´ 1
the top eigenvalue of C “ rC ` 1

d , λ2
d Id is 1 (as expected) and the next one satisﬁes

l´1 , and rB has a

ds. It follows that

which is bounded by max!λM ,

λ ˜M ď max#λM ,d 1
1?d´1) since l ě d.

dpl ´ 1q `

1

d+ ,

7 Weak Fortiﬁcation of Entangled Games

Our goal in this section is to prove the following.
Theorem (Theorem 1.3 restated). Let G1 “ pM ˝ G ˝ Pq be a concatenated game obtained by concate-
nating two sides of a game G with some λ-spectral expanders M and P. If λ ď ε2δ
56 , then G1 is pε, δq

weakly-fortiﬁed against entangled substrategies.

We need some basic matrix analytic facts.

7.1 Basic lemmas

Choi-Jamiolkowski isomorphism. We make use of the correspondence between bipartite states
|ψy P H1 b H2 and linear operators L : H˚2 Ñ H1 given by the Choi-Jamiolkowski isomorphism.
Explicitly, let |ψy P Cd b Cd be a quantum state and consider a Schmidt basis for |ψy so we have
|ψy “řd

i“1aλi|iy|iy where λi P Rě0, up to a local change of basis. Set

ρ :“

λi|iyxi|.

(53)

dÿi“1

Proposition 7.1. Let Z, W be two linear operators acting on Cd and let |ψy and ρ be as above. Then,

xψ|Z b W|ψy “ TrpZρ1{2W T ρ1{2q.

i,j“1bλiλj Zij ¨ Wij .

Proof. Both expressions evaluate tořd
For a density matrix ρ and a matrix A for convenience we sometimes denote TrpAρq by TrρpAq.
Matrix norms and inequalities. The Frobenius norm of a matrix A P Cnˆm is deﬁned as }A}F “
aTrpAA:q. The trace norm is deﬁned as }A}tr “ Tr?AA:. The following analogue of Proposi-
tion 2.13 will be used repeatedly in our argument.
Claim 7.2. Let M be a bipartite λ-spectral expander on vertex set X1 Y X. Let tAx1ux1PX1 and ρ be
positive semideﬁnite matrices. For all x P X, deﬁne Ax “ Ex1„Npxq Ax1 and deﬁne A “ Ex„µ Ax. Then

E
x„µ

TrρppAx ´ Aq2q ď 2λ2 ¨ E
x1„µ1

TrρpA2
x1q.

(54)

25

Proof. Deﬁne Sx1 “ ρ1{2Ax1, Sx “ ρ1{2Ax, and S “ Ex Sx “ ρ1{2A. Using that M is a bipartite
λ-spectral expander, for any ﬁxed entry pi, jq
x |pSxqij ´ Sij|2 ď λ2 ¨ E

x1 |pSx1qij ´ Sij|2 ď 2λ2 ¨ E

x1 |pSx1qij|2

(55)

E

Summing over all entries,

E

xÿi,j

|pSxqij ´ Sij|2 “ E

x }Sx ´ S}2

|pSx1qij|2 “ 2λ2 E

x1 }Sx1}2
F.

(56)

x1ÿi,j
F ď 2λ2 E
F “ TrρpA2

Observing that TrρppAx ´ Aq2q “ }Sx ´ S}2

F and }Sx1}2

x1q, we obtain the desired result.

If A has singular value decomposition A “ UJV : its pseudo-inverse is A´1 “ V J´1U:, where
J´1 is obtained from J by taking the reciprocal of non-zero diagonal entries. A simple consequence
of the singular value decomposition is the following:

Fact 7.3. Let A be an n ˆ n matrix. Then there exists a unitary matrix U such that U A is positive
semi-deﬁnite.

Proof. Write the SVD as A “ UJV :, and choose U “ V U:.

We make frequent use of the matrix Cauchy-Schwarz inequality.

Proposition 7.4. For any two matrices S, T we have

TrpST :q ď TrpSS:q1{2 ¨ TrpT T :q1{2 “ }S}F}T}F.

If S and T are Hermitian,

TrpST STq ď TrpS 2T 2q.

Finally, we need a variant of Powers-Størmer inequality due to Kittaneh [Kit86]. This also

played a role in the analysis of [DSV14].

Lemma 7.5 ([Kit86]). Let X, Y be positive semideﬁnite matrices. Then

Tr´pX ´ Yq4¯ ď Tr`pX2 ´ Y 2q2˘ .

7.2 Proof of Theorem 1.3

At a high level, the proof of Theorem 1.3 follows the same outline as the classical proof of Sec-
tion 5.

x1upx1,a1qPX1ˆA1, tBb1

Consider a substrategy tAa1

y1upy1,b1qPY 1ˆB1 for G1. Deﬁne Ax “ Ex„Npx1q Ax1 and
By “ Ey„Npy1q By1.13 Deﬁne A “ Ex„µX Ax and B “ Ey„µY By. To prove Theorem 1.3 we must
13In what follows, we assume without loss of generality that all Ax1 and By1 are invertible. Note that proving Theorem
1.3 for this subset of substrategies suﬃces. This follows by a limiting argument because of the continuity of (25) in Ax1
and By1 .

26

analyze the following expression:

Val*pG1,tAa1

x1u,tBb1

y1uq “ E

x1 ρ1{2Bb1

y1ρ1{2q

Vpa1x1pxq, b1y1pyq, x, yq¨ TrpAa1
xρ1{2Bb

E

x1„Npxq,y1„Npyqÿa1,b1
yρ1{2q
Vpa, b, x, yq¨ TrpAa
TrpAxρ1{2Byρ1{2q¨ ÿV pa,b,x,yq“1

xρ1{2Bb

yρ1{2q
TrpAa
TrpAxρ1{2Byρ1{2q

,

px,yq„µ

“ E

px,yq„µÿa,b

“ E

px,yq„µ

where Aa
y are deﬁned as in (11), and we use the convention that 0{0 “ 0. Our analysis splits
into two cases. First let us consider the small case. This is handled by the following proposition.

x and Bb

Proposition 7.6. Suppose Trpρ1{2Aρ1{2Bq ă δ{2. Then Val*pG1,tAa1

x1u,tBb1

y1uq ă δ.

Proof. First of all we have

Val*pG1,tAa1

x1u,tBb1

y1uq “ E

x,y ÿVpa,b,x,yq“1

TrpAa

xρ1{2Bb

yρ1{2q ď E

x,y

TrpAxρ1{2Byρ1{2q.

Subtracting TrpAρ1{2Bρ1{2q,

E
x,y

TrpAxρ1{2Byρ1{2q´ TrpAρ1{2Bρ1{2q “ E

x,y

TrppAx ´ Aqρ1{2pBy ´ Bqρ1{2q.

By applying Cauchy-Schwarz to the latter expression and using Claim 7.2 it follows that

Val*pG1,tAa1

x1u,tBb1

y1uq ď δ{2` λ2;

this is smaller than δ by the choice of λ.

The large case. In this case, the hypothesis of Proposition 7.6 is not satisﬁed and without loss of
generality we assume that

min  TrρpAq, TrρpBq( ě TrpAρ1{2Bρ1{2q ě δ{2.

γ :“ E

px,yq„µ

TrpAxρ1{2Byρ1{2q.

Let

By the triangle inequality,

Val*pG1, Ax1, By1q ď E

px,yq„µ| TrpAxρ1{2Byρ1{2q´ γ|` γ ¨ E

px,yq„µ ÿVpa,b,x,yq“1

(57)

(58)

(59)

xρ1{2Bb

yρ1{2q
TrpAa
TrpAxρ1{2Byρ1{2q

.

To bound the ﬁrst term, we use the triangle inequality to get

| TrpAxρ1{2Byρ1{2q´ γ| ď | TrpAxρ1{2Byρ1{2 ´ Aρ1{2Bρ1{2q|`| TrpAρ1{2Bρ1{2q´ γ|.

(60)

27

The ﬁrst term on the right-hand side of (60) can be bounded as

E

px,yq„µ| TrpAxρ1{2Byρ1{2 ´ Aρ1{2Bρ1{2q|

px,yq„µ| TrpAxρ1{2pBy ´ Bqρ1{2q|` E
ď E
xq1{2 ¨ TrρppBy ´ Bq2q1{2ı` E
px,yq„µ”TrρpA2
ď E
TrρppBy ´ Bq2q˙1{2
¨ˆE
xq¯1{2
ď´E
TrρpA2

x

y

ď 4¨ λ,

x | TrppAx ´ Aqρ1{2Bρ1{2q|

x”TrρpB2q1{2 ¨ TrρppAx ´ Aq2q1{2ı
TrρppAx ´ Aq2q¯1{2
` TrρpB2q1{2 ¨´E

x

(61)

where the ﬁrst inequality is the triangle inequality, the next two follow from Cauchy-Schwarz,
and the last from Claim 7.2 and the trivial bounds TrρpA2
xq, TrρpB2q ď Trpρq “ 1. To bound the
second term on the right-hand side of (60) we note that

| TrpAρ1{2Bρ1{2q´ γ| “ | E
px,yq„µ
TrρrpAx ´ Aq2sq1{2 ¨pE
ď pE

TrppAx ´ Aqρ1{2pBy ´ Bqρ1{2q|

TrρrpBy ´ Bq2sq1{2,

x

y

and the latter is again bounded by 2λ by Claim 7.2. In total we have

E

px,yq„µ| TrpAxρ1{2Byρ1{2q´ γ| ď 4λ ` 2λ2 ď δ,

(62)

which provides an upper bound on the ﬁrst term in the right-hand side of (59).

To bound the second term term in the right-hand side of (59) we use a strategy inspired in part
by the parallel repetition theorem of [DSV14]. Let Ux, Vy, U, V be a family of unitaries such that
the operators

Λ

x “ UxaAxρ1{4, Λ “ U?Aρ1{4,

Γ

y “ VybByρ1{4,

Γ “ V?Bρ1{4

(63)

are all positive semideﬁnite, which is possible by Fact 7.3. Note that this in particular implies that
Λ

x “ Λ:x and hence

(64)

(65)

Λ2

x “ Λ:xΛ

x “ ρ1{4aAxU:x UxaAxρ1{4 “ ρ1{4Axρ1{4,

Deﬁne “rescaled” strategies by

and similarly Λ2 “ ρ1{4Aρ1{4, Γ2 “ ρ1{4Bρ1{4 and so on.
x U:x , xBb

x “ UxA´1{2
xAa

xA´1{2
Aa

where A´1

x

y “ VyB´1{2

y

yB´1{2
Bb

y

V :y ,

y ’s are the pseudo-inverses of Ax, By. Note that the operators (65) satisfyxAx “řaxAa

x,

xBy “řbxBb

x , B´1
y ď Id as required. Let
UxA

Kxy “

1{2
x ρ1{2B

1{2
y V :y

bTrpAxρ1{2Byρ1{2q

UA1{2ρ1{2B1{2V :

bTrpAρ1{2Bρ1{2q

.

,

K “

28

(66)

By deﬁnition of Λ

x, Γ

y, X, Y we see that the above is equivalent to

Kxy “

Now note the following identity

Λ

x

Γ
y
x Γ2
y q

bTrpΛ2

,

K “

.

ΛΓ

aTrpΛ2Γ2q

So to ﬁnish the argument it suﬃces to estimate

yK:xyq.

xρ1{2Bb

yρ1{2q

TrpAa
TrpAxρ1{2Byρ1{2q “ TrpxAa
px,yq„µ ÿVpa,b,x,yq“1
TrpxAa

xKxyxBb
xKxyxBb

E

yK:xyq.

E

px,yq„µ ÿV pa,b,x,yq“1

TrpKxAa

xK:xBb

yq ď Val*pGq.

(67)

(68)

(69)

(70)

(71)

(72)

(73)

To this end note that since TrpKK:q “ 1 it follows from the deﬁnition of Val*pGq that

To conclude we use the following proposition.

Proposition 7.7. Let Kxy and K be as above. Then

E

px,yq„µ}Kxy ´ K}2
F ď

12λ

δ

.

Before proving the proposition let us see how it implies the desired bound on the second term

of (59).

| TrpKxyxAa

xK:xyxBb

yq|

xK:xBb
yq´ TrpKxAa
xK:xyxBb
xpK:xy ´ K:qxBb
ď | TrppKxy ´ KqxAa
yq|`| TrpKxAa
yq|
xpKxy ´ Kq:xBb
xK:xyxBb
ď TrppKxy ´ KqxAa
yq1{2 ¨ TrpKxyxAa
yq1{2
xpKxy ´ Kq:xBb
xK:xBb
` TrppKxy ´ KqxAa
yq1{2 ¨ TrpKxAa
yq1{2.
yqı1{2
¨”` E
px,yq„µ ÿVpa,b,x,yq“1
xpKxy ´ Kq:xBb
TrpKxyxAa
px,yq„µ ÿV pa,b,x,yq“1
`` E
TrpKxAa

Averaging with Epx,yq„µřVpa,b,x,yq“1 and applying Cauchy-Schwarz we see that (72) is bounded by
” E
px,yq„µ ÿV pa,b,x,yq“1

TrppKxy ´ KqxAa

xK:xyxBb
xK:xBb

yq˘1{2
yq˘1{2ı.

We claim that the second term in brackets is at most 2. To see this note that replacing the sum from

řVpa,b,x,yq“1 to ařa,b only increase the term, and the claim follows from TrpKxyK:xyq “ TrpKK:q “

29

additional terms introduced in the sum are nonnegative. The desired result follows because

1. To bound the ﬁrst term in (73), we again relax the summation fromřV pa,b,x,yq“1 tořa,b. This
is valid because all the operators of the form pKxy ´ KqxAa
xpKxy ´ Kq:, By ě 0 and hence all the
px,yq„µÿa,b

TrppKx,y ´ KqpKx,y ´ Kq:q “ E

x,y}Kx,y ´ K}2
F,

yq ď E

xpKxy ´ Kq:xBb

TrppKxy ´ KqxAa

px,yq„µ

(74)

E

which is bounded by Proposition 7.7. Combining all bounds, from (72) we get

E

px,yq„µ ÿV pa,b,x,yq“1

xρ1{2Bb

yρ1{2q

TrpAa
TrpAxρ1{2Byρ1{2q “ E
ď E

yK:xyq

px,yq„µ ÿVpa,b,x,yq“1
xKxyxBb
TrpxAa
px,yq„µ ÿVpa,b,x,yq“1
xKxBb
TrpxAa
yK:q
xK:xyxBb
`| TrpKxyxAa
yq´ TrpKxAa
ď Val*pGq` 2¨ˆ E
px,yq„µ}Kxy ´ K}2
ď Val*pGq` 2c12λ

δ

.

yq|

xK:xBb
F˙1{2

The latter is bounded by ε by the choice of λ. It only remains to prove Proposition 7.7.

Proof of Proposition 7.7. We have

For the ﬁrst term,

´

}Kxy ´ K}F ď››››
bTrpΛ2

Γ
y
x Γ2
y q

´

Λ

x

x

Λ

Γ
y
x Γ2
y q

bTrpΛ2
aTrpΛ2Γ2q››››

Γ
y

Λ

x

2

E

px,yq„µ››››

(75)

.

ΛΓ

´

aTrpΛ2Γ2q››››F
aTrpΛ2Γ2q˙2
y q´bTrpΛ2Γ2q˙2

´

1

F “ E
px,yq„µ

x Γ2
y q
x Γ2

x

x

E

Λ

1

1

Γ
y

ΛΓ

Γ2

TrpΛ2

TrpΛ2Γ2q

aTrpΛ2Γ2q››››F `››››
aTrpΛ2Γ2q
y q¨ˆ
bTrpΛ2
px,yq„µˆbTrpΛ2
px,yq„µ| TrpΛ2
px,yq„µ| TrppΛ2
x rTrppΛ2
x rTrppΓ2

TrpΛ2Γ2qˇˇˇE
TrpΛ2Γ2qˇˇˇE

x ´ Λ2q2qsˇˇˇ
y ´ Γ2q2qsˇˇˇ

TrpΛ2Γ2q

TrpΛ2Γ2q

1

1

1

1

E

E

x

1{2

“

ď

ď

ď

`

30

Γ2
y q´ TrpΛ2Γ2q|
x ´ Λ2qΓ2
y q|`| TrpΛ2pΓ2
y ´ Y 2qq|
1{2
1{2

¨ˇˇˇˇE

y rTrpΓ4
¨ TrpΛ4q1{2,

y qsˇˇˇˇ

(76)

(77)

where the last step follows from two applications of Cauchy-Schwarz. Rewriting the above in
terms of Ax, By and ρ using (64) and its analogues we see that the term in (76) equals

Bounding the last term TrpByρ1{2Byρ1{2q by 1 and the ﬁrst term by 2λ (which follows by applying
Fact 7.4 and Claim 7.2) and doing the same analysis for (77) we see that

1

TrpAρ1{2Bρ1{2qˇˇˇE

1{2

¨ˇˇˇˇE
y rTrpByρ1{2Byρ1{2qˇˇˇˇ

1{2

x rTrppAx ´ Aqρ1{2pAx ´ Aqρ1{2qsˇˇˇ
aTrpΛ2Γ2q››››
px,yq„µ››››

Γ
y
x Γ2
y q

Γ
y

Λ

Λ

E

x

x

´

bTrpΛ2
y}2
F ` 2¨}pΓ

y ´ ΓqX}2

F

x ´ Λq2q` 2¨ TrppΓ

y ´ Γq2X2q

2

F ď

8λ
δ

.

(78)

(79)

(80)

(81)

(82)

(83)

To bound the second term in (75) we argue as follows:

}Λ

x

Γ

y ´ ΛΓ}2

F ď 2¨}pΛ
“ 2¨ TrpΓ2
ď 2¨ TrpΓ4
ď 2¨ TrpΓ4

x ´ ΛqΓ
y pΛ
y q1{2 ¨ TrppΛ
y q1{2 ¨ TrrpΛ2

x ´ Λq4q1{2 ` 2¨ TrpΛ4q1{2 ¨ TrppΓ
x ´ Λ2q2s1{2 ` 2¨ TrpΛ4q1{2 ¨ TrrpΓ2

y ´ Γq4q1{2
y ´ Γ2q2s1{2,

where in the last step we used Lemma 7.5. Using the same bound on the above terms as in the
above we see that

Since in the large case TrpAρ1{2Bρ1{2q ě δ
8 Discussion and open problems

x

E

px,yq„µ}Λ

Γ

y ´ ΛΓ}2

F ď 8λ.
2 the result follows.

An obvious open problem is to extend our results to the case of multiplayer entangled games. This
is likely to be achievable by combining the ideas of Sections 5.2 and 7. However, some subtleties
arise with respect to the use of the Choi-Jamiolkowski isomorphism, and we leave this for future
work.

An important (and somewhat surprising) message of our work is that there is a modiﬁed form
of game concatenation with no adverse eﬀect on the entangled value. This is notable because or-
dinary concatenation may appear to be not very well-behaved with respect to quantum strategies:
we typically do not expect that entangled players would be able to answer a number of questions
from a game G simultaneously, while preserving the same question/answer statistics as in G, as
players’ measurement operators associated with diﬀerent questions generally do not commute.

The concatenation and composition of games play an important role in the classical setting in
the context of PCPs [AS98, Din07] and multiprover interactive proof systems [BFL90]. It remains
to be seen whether ideas related to our ordered fortiﬁcation can be useful in lifting some of these
techniques to the quantum world.

References

[AFRV14]

Rotem Arnon-Friedman, Renato Renner, and Thomas Vidick. Non-signalling par-
allel repetition using de ﬁnetti reductions. arXiv preprint arXiv:1411.1582, 2014.

31

[AS98]

[BFL90]

[BFS13]

[BG15]

Sanjeev Arora and Shmuel Safra. Probabilistic checking of proofs: A new character-
ization of np. Journal of the ACM (JACM), 45(1):70–122, 1998.

L´aszl ´o Babai, Lance Fortnow, and Carsten Lund. Nondeterministic exponential time
has two-prover interactive protocols. In Proceedings of Annual Symposium on Foun-
dations of Computer Science (FOCS), pages 16–25, 1990.

Harry Buhrman, Serge Fehr, and Christian Schaﬀner. On the parallel repetition of
multi-player games: The no-signaling case. arXiv preprint arXiv:1312.7455, 2013.

Mark Braverman and Ankit Garg. Small value parallel repetition for general games.
In Proceedings of the Annual ACM Symposium on Theory of Computing (STOC), pages
335–340, 2015.

[BL06]

Yonatan Bilu and Nathan Linial. Lifts, discrepancy and nearly optimal spectral gap.
Combinatorica, 26(5):495–519, 2006.

[BOGKW88] Michael Ben-Or, Shaﬁ Goldwasser, Joe Kilian, and Avi Wigderson. Multi-prover in-
teractive proofs: How to remove intractability assumptions. In Proceedings of Sym-
posium on Theory of computing (STOC), 1988.

[BSVV15]

Amey Bhangale, Ramprasad Saptharishi, Girish Varma, and Rakesh Venkat. On
fortiﬁcation of projection games. In RANDOM (arXiv:1504.05556), 2015.

[BVY15]

Mohammad Bavarian, Thomas Vidick, and Henry Yuen. Anchoring games for par-
allel repetition. arXiv preprint arXiv:1509.07466, 2015.

[CHSH69]

John F Clauser, Michael A Horne, Abner Shimony, and Richard A Holt. Proposed ex-
periment to test local hidden-variable theories. Physical Review Letters, 23(15):880–
884, 1969.

[CHTW04] Richard Cleve, Peter Høyer, Benjamin Toner, and John Watrous. Consequences and
limits of nonlocal strategies. In Proceedings Conference on Computational Complexity
(CCC), pages 236–249, 2004.

[CS14]

Andr´e Chailloux and Giannicola Scarpa. Parallel repetition of entangled games
with exponential decay via the superposed information cost. In Proceeding of Inter-
national Colloquium on Automata, Languages, and Programming (ICALP), pages 296–
307, 2014.

[CWY15]

Kai-Min Chung, Xiaodi Wu, and Henry Yuen. Parallel repetition for entangled k-
player games via fast quantum search. In Proceedings of Conference on Computational
Complexity (CCC), page 512, 2015.

[Din07]

[DS14]

Irit Dinur. The PCP theorem by gap ampliﬁcation.
54(3):12, 2007.

Journal of the ACM (JACM),

Irit Dinur and David Steurer. Analytical approach to parallel repetition. In Pro-
ceedings ofAnnual ACM Symposium on Theory of Computing (STOC), pages 624–633,
2014.

32

[DSV14]

[FK00]

[FKO07]

[FRS88]

[FV02]

[H˚as01]

[Hol07]

[IV12]

[JPY14]

[Kit86]

[KV11]

[LW15]

[Mos14]

[Rao11]

[Raz98]

Irit Dinur, David Steurer, and Thomas Vidick. A parallel repetition theorem for en-
tangled projection games. In Proceedings of Conference on Computational Complexity
(CCC), pages 197–208, 2014.

Uriel Feige and Joe Kilian. Two-prover protocols—low error at aﬀordable rates.
SIAM Journal on Computing, 30(1):324–346, 2000.

Uriel Feige, Guy Kindler, and Ryan O’Donnell. Understanding parallel repetition
requires understanding foams. In Proceedings of Conference on Computational Com-
plexity (CCC), pages 179–192, 2007.

Lance Fortnow, John Rompel, and Michael Sipser. On the power of multi-power
interactive protocols.
In Proceedings of Structure in Complexity Theory Conference
(CCC), pages 156–161, 1988.

Uriel Feige and Oleg Verbitsky. Error reduction by parallel repetition: a negative
result. Combinatorica, 22(4):461–478, 2002.

Johan H˚astad. Some optimal inapproximability results. Journal of the ACM (JACM),
48(4), 2001.

Thomas Holenstein. Parallel repetition: simpliﬁcations and the no-signaling case.
In Proceedings of Symposium on Theory of computing (STOC), pages 411–419, 2007.

Tsuyoshi Ito and Thomas Vidick. A multi-prover interactive proof for NEXP sound
against entangled provers. In Proceedings of Foundations of Computer Science (FOCS),
pages 243–252, 2012.

Rahul Jain, Attila Pereszl´enyi, and Penghui Yao. A parallel repetition theorem for
entangled two-player one-round games under product distributions. In Proceedings
of Conference on Computational Complexity (CCC), pages 209–216, 2014.

Fuad Kittaneh. Inequalities for the schatten p-norm IV. Communications in Mathe-
matical Physics, 106(4):581–585, 1986.

Julia Kempe and Thomas Vidick. Parallel repetition of entangled games. In Proceed-
ings of Symposium on Theory of computing (STOC), pages 353–362, 2011.

C´ecilia Lancien and Andreas Winter. Parallel repetition and concentration for (sub-
) no-signalling games via a ﬂexible constrained de ﬁnetti reduction. arXiv preprint
arXiv:1506.07002, 2015.

Dana Moshkovitz. Parallel repetition from fortiﬁcation. In Annual Symposium on
Foundations of Computer Science (FOCS), pages 414–423, 2014.

Anup Rao. Parallel repetition in projection games and a concentration bound. SIAM
Journal on Computing, 40(6):1871–1891, 2011.

Ran Raz. A parallel repetition theorem. SIAM Journal on Computing, 27(3):763–803,
1998.

33

[Raz11]

[Vid13]

Ran Raz. A counterexample to strong parallel repetition. SIAM Journal on Comput-
ing, 40(3):771–777, 2011.

Thomas Vidick. Three-player entangled XOR games are NP-hard to approximate.
In Proceedings of the Foundations of Computer Science (FOCS), pages 766–775, 2013.

A Biregularization

In this section, we prove Lemmas 2.8 and 2.10. We start by the second lemma on the graphical
games and then derive the general case by reduction.

Graphical games. Suppose G is a graphical game: there is a set of edges E Ď X ˆ Y such that
µpx, yq “ 1
|E|

for all px, yq P E. In this case we have

,

@x P X, y P Y .

µpxq “ |Npxq|
|E|

,

Let dx :“ |Npxq| denote the degree of x, and set Sx be the set txuˆrdxs. Deﬁne

µpyq “ |Npyq|
|E|
Xint “ ďx„X
Note that |Xint| “ |E| ď |X||Y|. Deﬁne Mintppx, iq, xq “ 1
struct Yint and Pint similarly.
Proposition A.1. Let Gint “ Mint ˝ G˝ Pint. Then marginal of µint induced on Xint and Yint is uniform.
Moreover, we have
(85)

for i P t1, . . . , dxu, and 0 otherwise. Con-

(84)

Sx.

dx

ValpGintq “ ValpGq,

Val˚pGintq “ Val˚pGq.

Proof. It is easy to see that for all Xint “ px, iq P Xint we have µintpxintq “ 1
and similarly for
|E|
all yint P Yint. The claims ValpGintq “ ValpGq and Val˚pGintq ď Val˚pGq are true for all concate-
nated games in general. The ﬁnal claim Val˚pGintq ě Val˚pGq follows by considering the strategy
Apx,iq “ Ax, Bpy,jq “ By which achieves the same value as pAx, Byq in G.
General case. Although graphical games include many games considered in applications, it would
nevertheless still be nice to extend the above construction to all games. We do not know how to
do this exactly, but we can achieve an approximate variant.

The idea is essentially to approximate a general game by a graphical game. More formally, let

τ P p0, 1q be an error parameter and q an integer such that |E|τ ď q ď 2|E|τ . We have

τ

2|E| ď

1
q ď

.

τ
|E|

(86)

We would like to deﬁne a game ˜G in which all probabilities in the underlying distribution
˜µpx, yq are fractions with denominator q. Let ˜X “ X Y txnulu and ˜Y “ Y Y tynulu. For every
px, yq P X ˆ Y set

˜µpx, yq “

tq ¨ µpx, yqu

q

.

(87)

Finally let ˜µpxnul , ynulq such that ˜µ is a proper probability distribution (i.e. by transferring the
excess probabilities to pxnul , ynulq) and put an arbitrary winnable predicate on pxnul , ynulq.

34

Proposition A.2. The game ˜G is a graphical game with q (possibly parallel) edges. Moreover, we have

ValpGq ď Valp ˜Gq ď ValpGq` τ,

Val˚pGq ď Val˚p ˜Gq ď Val˚pGq` τ.

(88)

A few remarks are in order: ﬁrstly, since the previous construction for graphical games applies
equally well in the presence of multiples edges, we can combine it with the above preprocessing
to prove Lemma 2.8. Secondly, note that the operation G Ñ ˜G is value-increasing and hence
preserves perfect completeness. Thirdly, note that the right scale for the error parameter τ is c´s
2
where c ´ s is the completeness-soundness gap.
Proof. By construction all ˜µpx, yq are integer multiples of 1
˜µpxnul , ynulq. Since µpx, yq ě ˜µpx, yq for all px, yq, for any strategy pf , gq for G we have
f px, aq¨ gpy, bq ě 1´ Valp ˜G, f , gq,

q . This ensures that the same is true for

1´ ValpG, f , gq “ E

px,yq„µ ÿV pa,b,x,yq“0

which shows that ValpGq ď Valp ˜Gq. For the other direction, consider an optimal strategy pf , gq
for ˜G (which necessarily always wins on pxnul , ynulq). We have,
px,yq„µ ÿVpa,b,x,yq“0
f px, aq¨ gpy, bq` ÿpx,yqPE

˜µpx, yq ÿV pa,b,x,yq“0

1´ ValpGq ď 1´ ValpG, f , gq “ E

pµpx, yq´ ˜µpx, yqq

f px, aq¨ gpy, bq

ďÿx,y
ď 1´ Valp ˜Gq` τ

The quantum case is similar.

35

