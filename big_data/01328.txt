6
1
0
2

 
r
a

 

M
4
 
 
]
n
n
-
s
i
d
.
t
a
m
-
d
n
o
c
[
 
 

1
v
8
2
3
1
0

.

3
0
6
1
:
v
i
X
r
a

Statistical mechanics of clonal expansion
in lymphocyte networks modelled with
slow and fast variables

Alexander Mozeika† and Anthony CC Coolen†‡
†Institute for Mathematical and Molecular Biomedicine, King’s College London,
Hodgkin Building, London SE1 1UL, UK
‡ Department of Mathematics, King’s College London, The Strand, London
WC2R 2LS, UK

PACS numbers: 87.18.Vf, 02.50.-r, 05.70.Fh, 05.50.+q

E-mail: alexander.mozeika@kcl.ac.uk, ton.coolen@kcl.ac.uk

Abstract. We study the Langevin dynamics of the adaptive immune system,
modelled by a lymphocyte network in which the B cells are interacting with the T
cells and antigen. We assume that B clones and T clones are evolving in diﬀerent
thermal noise environments and on diﬀerent timescales. We derive stationary
distributions and use statistical mechanics to study clonal expansion of B clones
in this model when the B and T clone sizes are assumed to be the slow and fast
variables respectively and vice versa. We derive distributions of B clone sizes and
use general properties of ferromagnetic systems to predict characteristics of these
distributions, such as the average B cell concentration, in some regimes where
T cells can be modelled as binary variables. This analysis is independent of
network topologies and its results are qualitatively consistent with experimental
observations. In order to obtain full distributions we assume that the network
topologies are random and locally equivalent to trees. The latter allows us to
employ the Bethe-Peierls approach and to develop a theoretical framework which
can be used to predict the distributions of B clone sizes. As an example we use
this theory to compute distributions for the models of immune system deﬁned on
random regular networks.

1. Introduction

The main task of the immune system is to defend the organism from invading
pathogens such as viruses, bacteria, parasites, etc.
In complicated multicellular
organisms, such as vertebrates, the immune system is usually divided into two
subsystems: the innate immune system and the adaptive immune system [1]. The
former can be seen as a ﬁrst line of defence on which the organism is relying for
its protection in the ﬁrst hours and days of infection with a new pathogen, but its
immune response is not speciﬁc to this particular pathogen. The latter is a second line
of defence, which is usually triggered by the innate immune system, whose immune
response is more speciﬁc and also oﬀers a more long-term immunity. These properties
of the adaptive immune system arise from its ability to learn and memorise a wide
range of pathogens, an important part of which is learning to recognise the molecules

Statistical mechanics of lymphocyte networks modelled with slow and fast variables 2

of the organism [2], which emerges from the interactions of its cells mediated by
signalling proteins (cytokines).

Interactions between the B cells and T cells are dominant in the adaptive immune
response [1]. The main feature of a B cell is its B cell receptor (BCR) which is used
to recognise the antigen (Ag). Antigen is a (unique) protein on the surface of the
pathogen. However, BCR recognises only a speciﬁc part of the Ag, which is called
epitope, so potentially a single BCR can recognise many diﬀerent Ags [3, 4]. Ag that
binds to the BCR is then internalised and is broken by the cell into peptides (short
proteins) which are then displayed on its surface. The T cell also has its T cell receptor
(TCR) to recognise Ag, however, in contrast to the B cell a T cell binds to the peptides
on the surface of antigen presenting cells (APCs), such as dendritic cells, B cells, etc.
The adaptive immune response is triggered when the T helper cells, attached by
their TCRs to the B cells, activate the B cells (by cytokine mediated signals) that
recognise the same Ag. The strength of this interaction between the BCR (TCR)
and Ag is called aﬃnity. Upon activation the B cells with highest aﬃnity begin to
proliferate in a process known as clonal expansion. A group of B cells (T cells ) with
the same BCR (TCR) is called a clone. While B cell clones (B clones) are expanding
the T cells, activated by Ag, are also going through the process of clonal expansion.
We note that the mode of B cell activation described here is called “T-dependent
B cell activation”, however for some “simple” Ags with repetitive patterns, such as
polysaccharides, the B cell can be activated directly by Ag and without the help from
a T cell (“T-independent activation”).

One part of proliferating B cells is diﬀerentiated into plasma cells secreting large
quantities of antibodies (BCRs in soluble form). The antibodies (Ab) protect the host
from the infection by binding to the pathogen and thus, by blocking its parts, making
the attack ineﬀective or “marking” the pathogen for the ingestion by the other cells.
However, the Abs produced in this initial clonal expansion, especially if the host is
infected with this pathogen for the ﬁrst time, are of very low aﬃnity.

The other part of proliferating B cells is used to seed the germinal centres (GCs).
GCs are special micro-environments, formed within secondary lymphoid organs, which
are divided into the light and dark zones. In the dark zone B cells undergo somatic
hypermutation which introduces random mutations into the genes of BCRs. This
process is followed by the interaction of B cells with the helper cells and Ag in the
light zone of the GC. Here B cells with higher aﬃnity are selected and diﬀerentiated
into plasma cells and memory B cells. Presence of high aﬃnity memory B cells in the
organism leads to a more vigorous immune response on the subsequent infections by
the same Ag.

The statistical physics (SP) approaches to the modelling of adaptive immune
system [5, 6] are predominantly based on the idea that the immune system is a network
(or graph). The nodes in a such network are usually lymphocyte clones (B cells and
T cells), antibody types, antigens, etc. and the edges model the interactions such
as B cells receiving “signals” from T cells, antibodies binding to antigen, etc. One
of the ﬁrst such works was the study [7] of the network of interacting antibodies,
i.e. the idiotypic network. Despite being very simple (binary variables assigned to the
nodes represented Ab concentrations and the interactions were assumed to be random)
the model studied exhibited memory which was interpreted as the (immunological)
memory of the past exposure to the Ag.

A more detailed model with lymphocytes and cytokines was introduced in [8]. The
(bipartite) network in this model is formed by the interactions between the eﬀector

Statistical mechanics of lymphocyte networks modelled with slow and fast variables 3

clones, formed by B cells and killer T cells, and helper clones (T cells) which are
mediated by the cytokines (strengths of (random) interactions in the model). The
immunological memory in this model arises from the ability of T clone component
to memorise an extensive number of cytokine signalling “strategies” (or patterns)
allowing to cope with possible Ag stimulation. However, the fully connected network
topology used in this model restricts the immune memory to retrieve only one pattern
at a time which limits the abilities of the immune system to ﬁght against multiple
Ags [8]. The ﬁnitely connected network topology, which is more realistic from the
biological point of view [9], allows to retrieve an extensive number of patterns in
parallel.

The above studies used and equilibrium statistical physics framework and
assumed existence of an energy function, governing behaviour of Abs, lymphocytes,
etc., from the very beginning. However when it is not clear that such a function exists
or if we want to study relaxation to the equilibrium, then we must study dynamics.
The dynamics of the immune idiotypic networks and bipartite lymphocyte networks
was studied in [10] and [11] respectively.

Finally, we note that statistical physics models and concepts are also used in the
statistical inference of the immune system data. The maximum entropy model of
amino acid sequences was used to study the repertoire of memory B cell receptors in
zebraﬁsh [12]. Recently similar approaches were applied to study the repertoires of T
cells [13] and B cells [14] in humans.

In this paper, we further develop the lymphocyte network model [8, 9] in both
qualitative and quantitative directions. The main diﬀerence between the current
and previous versions of the model is that we relax the assumption that B clones,
represented by log-concentrations of B cells, and T cell clones (T clones), represented
by concentrations of T cells, are subject to the same thermal noise [9]. We note that
both populations of B cells and T cells are aﬀected by various random events such
as stochasticity in cell division and cell death [15], thermal ﬂuctuations in the TCR-
peptide bond strengths [16], etc. However, since these are populations of diﬀerent cells
it is more plausible for the random noises in B clones and T clones to be diﬀerent and
uncorrelated. The latter assumption is chosen for its mathematical convenience.

Having diﬀerent random noises for the B clones and T clones introduces some
technical diﬃculties in the analysis of the problem. Here, in contrast to previous
studies [8, 9], we are unable to use the equilibrium framework directly. However, we can
make progress by assuming that either B clones or T clones are “fast” variables [17].
This assumption is not only mathematically convenient but can be also justiﬁed by
the following argument. Suppose that the B cells are heavier than the T cells. In the
immune response the population of B cells is approximately one order of magnitude
larger than the population of T cells, but the B cells, in order to survive, have to be
activated by the T cells. If we assume that the lymphocytes behave as a “gas” this
would imply that the T cells and B cells are the fast and slow “variables” respectively.
The opposite scenario, i.e.
the B cells are fast variables and the T cells are slow
variables, is also possible if the T cells are heavier than the B cells. We note that both
scenarios are not ruled out [18].

Furthermore, previous studies were not distinguishing the T helper cells from the
T regulator cells [19]. The latter play an important role in preventing autoimmunity
by suppressing the growth of self-reactive B clones which could be produced during
the T-dependent immune responses [20]. Also, B cells inﬁltrate tumours and there is
an evidence for in situ immune responses [21], to tumour-associated (self) Ags, which

Statistical mechanics of lymphocyte networks modelled with slow and fast variables 4

σ1

σi

σN

b1

bµ

bM

Figure 1. Network of T-clones and B-clones generated by the T-dependent
immune response. Red (blue) link between the helper (regulator) T-clone i and
the B-clone µ implies that the B-clone receives the signal to expand (contract).

are thought to be strongly inﬂuenced by the presence of regulator T cells [22].

Finally, we note that our main focus in this paper will be on the properties of B
clone distributions and how they are aﬀected by the other parameters of the model
such as network topology, concentration of Ag, etc. Recently, the importance of these
properties in our understanding of the ageing immune system was emphasised in [23]
and we also envisage that these properties are important in tumour immunology [21].

2. Dynamics
We consider M B-clones interacting with N T-clones on the bipartite graph G =
(V,F,E), where N = |V|, M = |F| and E is the set of edges. The set of indices ∂µ
points to all T-clones i connected to the B-clone µ and similarly the set ∂i involves
all B-clones µ connected to the T-clone i. The B-clones are speciﬁed by the log-
concentration variables b = (b1, . . . , bM ) and we assume that these variables are
governed by the Langevin equation

 − ρbµ + χµ(t)

(1)

(cid:88)
clone receives the “signal”(cid:80)

dbµ
dt

i∈∂µ

τb

= Jµ

ξµ
i σi + θµ

˜β−1δµνδ(t − t(cid:48)), is
where the noise χµ(t), with (cid:104)χµ(t)(cid:105) = 0 and (cid:104)χµ(t)χν(t(cid:48))(cid:105) = 2τb
controlled by the “temperature” parameter ˜T = ˜β−1. In this dynamics the µ-th B-
i σi from |∂µ| T-clones which are speciﬁed by the
concentrations σ = (σ1, . . . , σN ). The i-th T-clone is either formed by T helper cells
or by T regulator cells . The T-helper clones and T-regulator clones are encoded

i∈∂µ ξµ

(cid:80)

i∈∂µ ξµ

i > 0 and ξµ

Statistical mechanics of lymphocyte networks modelled with slow and fast variables 5

i σi is modulated by the interaction Jµ =(cid:80)M

respectively by the ξµ
i < 0 variables. The signal from the T-clones
ν=1 Sµνaµ where the Ag/Ags is
given by the vector of epitope “concentrations” a = (a1, . . . , aM ). Here Sµν ≥ 0 is an
element of an “aﬃnity” matrix which speciﬁes how well the ν-th epitope is “matched”
by the µ-th B-clone. A very specialised B-clone will interact with only one epitope (for
example Sµν = δµν) and poly-reactive B-clone [3, 4] can interact with many diﬀerent
epitopes (for example Sµν > 0 for all ν). The θµ term gives possibility of B-clone
activation even in the absence of the signal (or weak signal) from the T clones, i.e. it
facilitates T-independent activation. Thus positive (negative) “ﬁeld” Fµ(σ) , where
Fµ(σ) = Jµ
, has excitatory (inhibitory) eﬀect on the growth of µ-
th B-clone. Furthermore, the growth of this clone is kept in check by the “apoptosis”
therm −ρbµ, which limits the amplitude of bµ , and is subject to noise χµ(t). For
Jµ = 0, i.e. without Ag, the distribution of log-concentration bµ in equilibrium is the
Gaussian e− 1

(cid:16)(cid:80)

i σi + θµ

i∈∂µ ξµ

2 ρ ˜βb2

(cid:17)

In order to derive the dynamic equation for the T-clones we will proceed as follows.

Firstly, we note that if we deﬁne the energy (or Hamiltonian) function

µ/

2π/ρ ˜β.

(cid:113)
H(b, σ) = − M(cid:88)

b2
µ,

(2)

bµFµ(σ) +

1
2

ρ

µ=1

M(cid:88)

µ=1

then the equation (1) can be written in the form
H(b, σ) + χµ(t).

τb

dbµ
dt

= − ∂
∂bµ

(3)
We note that above equation is invariant under the transformation H(b, σ) →
H(b, σ) + V (σ) where V (σ) is any function of σ. Secondly, we assume that

dσi
dt

= − ∂
∂σi

H(b, σ) + ηi(t),

τσ

(4)
where the noise ηi(t), with (cid:104)ηi(t)(cid:105) = 0 and (cid:104)ηi(t)ηj(t(cid:48))(cid:105) = 2τσβ−1δijδ(t − t(cid:48)), is
controlled by the “temperatures” T = β−1. From above follows the equation

τσ

dσi
dt

=

Jµξµ

i bµ − ∂
∂σi

V (σ) + ηi(t).

(5)

(cid:88)

µ∈∂i

For now we will leave the function V (σ), which will be used later to “restrict” the
range of σi’s , unspeciﬁed but such that it allows us to deﬁne various thermodynamic
functions in what follows. The relation between the time-scales (τb (cid:29) τσ or
τσ (cid:29) τb) of T-clone and B-clone subsystems will give us two possible scenarios of
the equilibrium [24].

2.1. Fast equilibration of B-clones

Let us assume that the B-clone variables bµ are the “fast” variables and equilibrate
before the T-clone σi variables then this gives us that in equilibrium (t → ∞) these
variables are governed by the distribution

P ˜β(b|σ) =

1

Z ˜β(σ)

e− ˜βH(b,σ),

(6)

Statistical mechanics of lymphocyte networks modelled with slow and fast variables 6

where Z ˜β(σ) = (cid:82) db e− ˜βH(b,σ) is a partition function. Then using above and the

dynamic equation (4) we obtain the equation‡

(cid:28) ∂

(cid:29)

= −

dσi
dt

= − ∂
∂σi

+ ηi(t)

H(b, σ)

∂σi
F ˜β(σ) + ηi(t),

˜β

where F ˜β(σ) = − ˜β−1 log Z ˜β(σ) is (formally) a free energy of a state σ. It follows
from the above that in equilibrium the T-clones are governed by the distribution

where Zβ, ˜β =(cid:82) dσ e−βF ˜β (σ). The distributions (6) and (8) allows us to construct the

e−βF ˜β (σ),

Pβ, ˜β(σ) =

Zβ, ˜β

(8)

1

joint distribution

Pβ, ˜β(b, σ) = P ˜β(b|σ)Pβ, ˜β(σ).

(9)
In order to compute the joint distribution (9) we consider the partition function

db e− ˜βH(b,σ) = e− ˜βV (σ)

dbµe− 1

2 ρ ˜βb2

µ+ ˜βbµFµ(σ)

(cid:90)
(cid:18) 2π

ρ ˜β

Z ˜β(σ) =

=

(cid:19) M

2

˜β
2ρ

e

Pβ, ˜β(b, σ) = P ˜β(b|σ)

(cid:90)

M(cid:89)

µ=1

µ=1 F 2

(cid:80)M
µ (σ)− ˜βV (σ).
(cid:80)M
(cid:82) D ˜σ e
(cid:80)M
(cid:16)
(cid:113)
bµ− Fµ(σ)

µ=1 F 2

µ=1 F 2

(cid:17)2

µ (σ)

2 ρ ˜β

β
2ρ

β
2ρ

e

ρ

From above follows the joint distribution

(cid:16)
where Dσ = e−βV (σ)dσ, and its marginals are
(cid:113)

Pβ, ˜β(b) =

Dσ

2 ρ ˜β

− 1

e

bµ− Fµ(σ)

ρ

2π/ρ ˜β

and

Pβ, ˜β(σ) =

The marginal of the distribution (12), which is given by

µ ( ˜σ)

β
2ρ

µ=1 F 2

 e
(cid:80)M
(cid:82) D ˜σ e
(cid:80)M
 e
(cid:80)M
(cid:82) D ˜σ e
(cid:80)M

(cid:17)2

β
2ρ

β
2ρ

β
2ρ

µ (σ)

µ=1 F 2

µ ( ˜σ)

µ=1 F 2

µ (σ)

µ=1 F 2

µ ( ˜σ)

(7)

(10)

,

(11)

. (12)

(13)

=

e

(cid:90)

µ=1

µ=1

− 1

2π/ρ ˜β

 M(cid:89)
 M(cid:89)
(cid:80)M
(cid:82) D ˜σ e
(cid:80)M
(cid:90)
(cid:16)
(cid:113)
bµ− Fµ(σ)
(cid:90)
(cid:113)
(cid:90)

2 ρ ˜β(bµ− F

2π/ρ ˜β

2π/ρ ˜β

− 1
e

µ=1 F 2

µ=1 F 2

µ (σ)

µ ( ˜σ)

Dσ

ρ )2

2 ρ ˜β

− 1

dF

β
2ρ

β
2ρ

β
2ρ

e

e

.

ρ

×

e

Dσ

Pβ, ˜β(bµ) =

=

(cid:17)2

(cid:80)M
(cid:82) D ˜σ e
(cid:80)M

β
2ρ

β
2ρ

e

ν=1 F 2

ν (σ)

ν=1 F 2

ν ( ˜σ)

(cid:80)M
(cid:82) D ˜σ e

ν=1 F 2

ν (σ)δ (F − Fµ(σ))

(cid:80)M

β
2ρ

ν=1 F 2

ν ( ˜σ)

,

(14)

‡ We note that used here “averaging procedure” is procedure is exact when τb → ∞ [25].

Statistical mechanics of lymphocyte networks modelled with slow and fast variables 7

σi

J µ
ij

σj

Figure 2. Example of a local topology in the T-clone network generated by the
system with fast B-clone equilibration. B-clone µ is governed by three T helper
clones (red nodes) and one T regulator clone (blue node) forming clique of four
nodes.

allows us to construct the density

where

1
M

(cid:90)

P (b) =

P (F ) =

M(cid:88)

µ=1

Dσ

(cid:90) e

(cid:113)

− 1

2 ρ ˜β(b− F

ρ )2

2π/ρ ˜β

(cid:104)δ(b − bµ)(cid:105)β, ˜β =

(cid:80)M
(cid:82) D ˜σ e
(cid:80)M

β
2ρ

β
2ρ

e

ν=1 F 2

ν (σ)

ν=1 F 2

ν ( ˜σ)

1
M

M(cid:88)

µ=1

P (F ) dF,

(15)

δ (F − Fµ(σ))

(16)

is a distribution of ﬁelds. Using above we ﬁnd that the number of B cells in a volume
V , c, is governed by the distribution§

(cid:90) e

(cid:113)

− 1

2 ρ ˜β(log(c)− F

ρ )2

c

2π/ρ ˜β

P (c) =

P (F ) dF.

(17)

β
2ρ

(cid:80)M

(cid:80)

(cid:80)

i ξµ

j and θµ

µ (σ) can be written, up to an irrelevant constant, in the form e−β(cid:80)M

Finally, we note that in the equations (11)-(13) the “Boltzmann” factor
µ=1 Eµ(σ).
µ=1 F 2
e
The “energy” function Eµ(σ) = − 1
ij =
J 2
ρ ξµ
µ
i θµ, can be represented as a fully connected weighted graph (or
clique) which is formed from the T-clones controlling the B-clone µ. Thus the B-clone
dynamics (1), combined with the assumptions of this section, leads us to the result
that in equilibrium the T-clones are interacting via the network of cliques (see Figure
2).

ijσiσj −(cid:80)

§ For any distribution P (b) we have P (c) =(cid:82) P (b) δ(cid:0)c − eb(cid:1)db = 1

i σi, where J µ

j∈∂µ J µ

i∈∂µ θµ

J 2
ρ ξµ
µ

i∈∂µ

i =

2

c P (log (c)).

Statistical mechanics of lymphocyte networks modelled with slow and fast variables 8

2.2. Fast equilibration of T-clones

Here we assume that the T-clones equilibrate ﬁrst and are governed by the distribution

Pβ(σ|b) =

where Zβ(b) = (cid:82) dσ e−βH(b,σ). Then the dynamics of B-clones is given by the

e−βH(b,σ),

Zβ(b)

(18)

1

equation

= −

dbµ
dt

(cid:28) ∂

∂bµ

(cid:29)

H(b, σ)

= − ∂
∂bµ

Fβ(b) + χµ(t),

+ χµ(t)

β

(19)

where Fβ(b) = −β−1 log Zβ(b), and in equilibrium they are governed by the
distribution

P ˜β,β(b) =

1

Z ˜β,β

e− ˜βFβ (b) =

,

(20)

where n = ˜β/β. We can use above and the distribution (18) to construct the joint
distribution

β (˜b)

β (b)

Z n

(cid:82) d˜bZ n
(cid:82) d˜bZ n

β (b)

β (˜b)

Z n

P ˜β,β(b, σ) =

e−βH(b,σ)

Zβ(b)

In order to compute the joint distribution (21) we ﬁrst consider the partition

function

(cid:90)
where Wβ(b) =(cid:82) Dσ eβ(cid:80)M

Zβ(b) =

= e− 1

us the joint distribution

.

(21)

(cid:90)

2 ρβ(cid:80)M

µ=1 b2

µ

Dσ eβ(cid:80)M

µ=1 bµFµ(σ)

dσ e−βH(b,σ) = e− 1
2 ρβ(cid:80)M

µ=1 b2

µWβ(b),

(22)
µ=1 bµFµ(σ). Using above result in the equation (21) gives

The marginals of this distribution are given by

β

µ=1

=

µ=1 b2

µ=1 b2

µ W n−1
˜b2
µW n

2 ρ(n−1)β(cid:80)M
(cid:82) d˜b e− 1
e− 1
2 ρnβ(cid:80)M
(b)
P ˜β,β(b, σ) = e−βH(b,σ)
2 ρnβ(cid:80)M
µ eβ(cid:80)M
β (˜b)
(cid:82) d˜b e− 1
e− 1
µ=1 bµFµ(σ)W n−1
2 ρnβ(cid:80)M
2 ρnβ(cid:80)M
(cid:82) d˜b e− 1
e− 1
2 ρnβ(cid:80)M
(cid:82) db e− 1
µ eβ(cid:80)M
2 ρnβ(cid:80)M
(cid:82) d˜b e− 1
2 ρnβ(cid:80)M
˜b2
µW n
(cid:90)
(cid:90)
Let us ﬁrst consider the case when n ∈ Z+. Then
Dσn eβ(cid:80)M
µ=1 bµ

β (b)
˜b2
µW n

µ=1 bµFµ(σ)W n−1

Dσ1 ···

P ˜β,β(σ) =

P ˜β,β(b) =

α=1 Fµ(σα)

˜b2
µW n

(cid:80)n

β (˜b)

β (˜b)

β (˜b)

µ W n

µ=1 b2

µ=1 b2

µ=1

µ=1

µ=1

W n

β (b) =

β

and

(b)

β

.

(23)

(b)

.

(24)

(25)

(26)

Statistical mechanics of lymphocyte networks modelled with slow and fast variables 9

σ1
i

σ2
i

σ3
i

σn
i

J µ
ij
n

σ1
j

σ2
j

σ3
j

σn
j

Figure 3. Enlargement of the T-clone network in the system with fast T-clone
equilibration and n ∈ Z+. All n copies of a T-clone clique (shown here only for
one link in this clique) associated with the µ-th B-clone are interconnected in a
such way that they form a fully connected (weighted) network of n × |∂µ| nodes.

and for any function f (σ) its average (cid:104)f (σ)(cid:105) =(cid:82) DσP ˜β,β(σ)f (σ) satisﬁes the following

“replica” relation

β

2nρ

β

2nρ

α,γ

α=1

(28)

β

2nρ

e

i∈∂µ

j∈∂µ

(cid:80)

α=1 Fµ(σα))2

α=1 Fµ(σα))2

J µ
n σα
ij

i σγ

where we have deﬁned the average

In above the Boltzmann weight e

α=1 Fµ( ˜σα))2 {···}.

(cid:104){···}(cid:105)n =
(cid:80)

µ=1((cid:80)n
(cid:80)M
(cid:82) {D ˜σα} e
(cid:80)M
µ=1((cid:80)n
{Dσα}
(cid:80)M
µ=1((cid:80)n
irrelevant constant, in the form e−β(cid:80)M
(cid:80)
(cid:80)
j −(cid:80)n
can be written, up to an
µ=1 Eµ({σα}). The energy function Eµ({σα}) =
− 1
i =
2
i θµ, can be represented as a clique constructed from n × |∂µ| T-clones which are
J 2
ρ ξµ
µ
controlling the B-clone µ. Thus for n ∈ Z+ the fast T-clone equilibration leads to the
(cid:80)M
enlargement of the T-clone system (see Figure 3).
ν=1 (cid:104)δ(b − bν)(cid:105) ˜β,β can be computed by using the identity
(cid:90) e
(cid:112)2π/ρnβ
(cid:32)
(cid:42)
M(cid:88)
F − n(cid:88)

(26) in the distribution (24) which gives us

with the distribution of (replicated) ﬁelds

The density P (b) = 1
M

i∈∂µ θµ

i σα

i , where J µ

i ξµ

j and θµ

− 1

2 ρnβ(b− F

nρ )2

(cid:33)(cid:43)

P (F ) dF,

J 2
ρ ξµ
µ

P (F ) =

P (b) =

Fν(σα)

,

ij =

(29)

(30)

1
M

δ

ν=1

α=1

n

µ(cid:82) {Dσα} eβ(cid:80)M
2 ρnβ(cid:80)M

µ=1

˜b2
µ W n

µ=1 bµ
β (˜b)

(cid:80)n

α=1 Fµ(σα)

f (σ1)

(27)

(cid:82) db e− 1
2 ρnβ(cid:80)M
(cid:82) d˜b e− 1
(cid:43)
(cid:42)
n(cid:88)

µ=1 b2

f (σα)

α=1

,

n

(cid:104)f (σ)(cid:105) =

=

1
n

(cid:90)

Statistical mechanics of lymphocyte networks modelled with slow and fast variables 10

from which also follows the distribution of B-cell concentrations

P (c) =

(31)
Let us now compute the distribution (23) for a more general case of n ∈ R+. In

P (F ) dF.

order to do this we ﬁrst consider the integral

nρ )2

− 1

(cid:90) e
(cid:90)
= eβ(cid:80)M
= eβ(cid:80)M

2 ρnβ(log(c)− F

c(cid:112)2π/ρnβ
Dσ eβ(cid:80)M

(cid:90)
µ=1 bµJµθµ+(cid:80)N

µ=1 bµJµθµ

µ=1 bµFµ(σ)

Wβ(b) =

Dσ eβ(cid:80)N
(cid:80)
i=1 log(cid:82) Dσ eβσ(cid:80)

i=1 σi

µ∈∂i bµJµξµ

i

The last line in the above was obtained by assuming that Dσ = e−β(cid:80)N

i .

µ∈∂i bµ Jµξ

µ

(32)

i=1 V (σi)dσ.

Using this result in the joint distribution (23) gives us its marginal distributions

µ
µ∈∂i bµ Jµξ
i

µ
µ∈∂i bµ Jµξ
i

e

µ=1

ρ

µ=1

ρ

˜β,β

˜β,β

(cid:16)

− 1

− 1

db e

(cid:17)2

bµ− Jµ θµ

bµ− Jµ θµ

P ˜β,β(b) = Z−1

P ˜β,β(σ) = Z−1
(cid:90)
2 ρnβ(cid:80)M

(cid:17)2
2 ρnβ(cid:80)M
i=1 log(cid:82) Dσ eβσ(cid:80)
× en(cid:80)N
(cid:90)
(cid:16)
2 ρnβ(cid:80)M
i=1 log(cid:82) Dσ eβσ(cid:80)
× e(n−1)(cid:80)N
× eβ(cid:80)N
(cid:80)
(cid:40) N(cid:89)
(cid:80)
(cid:82) D˜σ eβ ˜σ(cid:80)
(cid:17)2
(cid:16)˜bµ− Jµθµ
i=1 log(cid:82) Dσ eβσ(cid:80)
+n(cid:80)N
(cid:82) db P ˜β,β(b) δ(b − bµ) = 1
(cid:80)M
(cid:82) Dσi eβσi
(cid:80)
(cid:82) D˜σi eβ ˜σi

(cid:80)N

µ∈∂i bµJµξµ

µ∈∂i bµJµξµ

µ∈∂i bµJµξµ

P ˜β,β(b)

P ˜β,β(b)

µ∈∂i bµJµξµ

Pi(σ) =

(cid:80)

(cid:90)

eβσi

i=1 σi

− 1

i=1

=

i

i

µ∈∂i bµJµξµ

i

where Z ˜β,β = (cid:82) d˜b e
(cid:80)N

(cid:80)M

ρ

µ=1

i and Dσ =
e−βV (σ)dσ. The distributions (33) and (34) can be used to construct the densities
P (b) = 1
µ=1 Pµ(b) (the concentration density
M
P (c) is given by P (b)/c with b = log c ) and P (σ) = 1
N
1
N

(cid:82) Dσ P ˜β,β(σ) δ(σ − σi) =

i=1 Pi(σ), where the marginal distribution Pi(σ) is given by the equation

µ=1

i=1

M

µ∈∂i

˜bµJµξ

µ

(33)

db,

(34)

(cid:41)

and

i δ(σ − σi)

i

db,

(35)

(cid:90)

(cid:90)

respectively. In a similar manner, using the deﬁnition

we can derive the distribution of ﬁelds(cid:107)

Pµ(F ) =

Dσ P ˜β,β(σ)δ (F − Fµ(σ)) ,

(cid:89)

(cid:82) Dσieβσi
(cid:82) D˜σieβ ˜σi

(cid:80)
(cid:80)

ν∈∂i bν Jν ξν

i

ν∈∂i bν Jν ξν
i

 db

(36)

Pµ(F ) =

P ˜β,β(b)
× δ (F − Fµ(σ)) .

i∈∂µ

Statistical mechanics of lymphocyte networks modelled with slow and fast variables 11

1

m±

1
2

0

(cid:104)c(cid:105)

∞ 0

βc
Figure 4. Fraction of regulator T cells (lower branch) m− = 1−m
, fraction
and average B-clone size (cid:104)c(cid:105) as a
of helper T cells (upper branch) m+ = 1+m
function of the inverse temperature β in the T-clone system modelled with the
σi ∈ {−1, 1} binary variables.

βc

2

2

∞

3. Analysis of equilibrium

i=1

i=1 σ2

i=1 σ2

i (σi − 1)2 + 1

(cid:0)σ2
i − 1(cid:1)2

and V (σ) = ∆(cid:80)N

V (σ) = ∆(cid:80)N
2 ω(cid:80)N
“chemical” potential ω allows us to control the number of activated T cells(cid:80)N
integral (cid:82) Dσf (σ), for example in the equation (27), into the sum (cid:80)

In this article we consider simplest case when the T clones (or T cells) are modelled
by the (binary) Ising variables σi ∈ {−1, 1} or by the binary variables σi ∈ {0, 1}.
The former and the latter can be obtained by using the double well potentials
i , where the
i=1 δσi;1,
in the integral measure Dσ. Taking the ∆ → ∞ limit converts the N -dimensional
σ f (σ) over
binary variables. Furthermore, the choice of σi ∈ {−1, 1}, combined with ξµ
i = 1,
gives us the scenario when the T cell is either a regulator cell or a helper cell. On
one hand the fact that the i-th T cell can change from the regulator σi = −1 to the
helper σi = 1 , or vice versa, can be seen as an assumption that the change in the T
cell function occurs on the same time scale as the immune response to the Ag. On the
other hand in the experiments [20, 27] one usually has access only to the number of
T cells of either type and such assumption could be suﬃcient to capture the observed
phenomena. For the choice of σi ∈ {0, 1} with ξµ
i = ξi) the
i=1 δξi;−1 is independent from the immune response.
The consequences of our choice for the variables σi, when T cells are fast variables
with n =∈ Z+ (see section 2.2), is that the T cells are governed by the distribution

number of regulating T cells(cid:80)N

i ∈ {−1, 1} (in this case ξµ

β

e

2nρ

µ=1((cid:80)n
(cid:80)M
(cid:80){ ˜σα} e
(cid:80)M
µ=1((cid:80)n
(cid:17)

2nρ

β

α=1 Fµ(σα))2

α=1 Fµ( ˜σα))2 ,

(37)

P (σ1, . . . , σn) =

(cid:16)(cid:80)
2 βω(cid:80)N

i∈∂µ ξµ

i σα

i + θµ

where Fµ(σα) = Jµ
, which is equivalent to the ferromagnetic Ising
spin model for σi ∈ {−1, 1} or the “lattice gas” for σi ∈ {0, 1}. For the latter we need
to add the term − 1
i to the “energy” function in the exponential of
(cid:107) Similarly to a B-clone the i-th T-clone experiences the ﬁeld(cid:80)
(37). We note that the distribution of T-clones (13) in the fast B clone equilibration

α=1 σα

(cid:80)n

i=1

j (see equation (35)) .

µ∈∂j bµJµξµ

Statistical mechanics of lymphocyte networks modelled with slow and fast variables 12

(cid:16) J 2
(cid:17)
(cid:16)(cid:110) J 2

1
ρ

For the Ising case the average “magnetization” m = 1
N

regime can be obtained from the distribution (37) by setting n = 1, so for T-clones
(cid:80)N
the case of integer n covers both equilibration scenarios. Let us for now discuss the
case of n = 1 and θµ = 0.
i=1(cid:104)σi(cid:105), which is related
to the fraction of helper (regulator) T-cells via the identity m+ = 1−m− (m− = 1−m
2 ),
has a phase transition at βc = β from the disordered paramagnetic (PM) m = 0 phase
to the ordered ferromagnetic (FM) phase m (cid:54)= 0 (see Figure 4) when N → ∞ [28].
We not that there are many possible topologies of a bipartite graph G for which
the T cell system (37) has ﬁnite βc. Suppose we choose one of such topologies (see
Figure 5) then for β ∈ (βc,∞) the fraction of helper (regulator) T cells m+ ( m−)
is either a monotonic non-decreasing or a monotonic non-increasing function of the
J 2
µ
ρ This is follows from the Griﬃths-
noise parameter β (see Figure 4) and interaction
Kelly-Sherman (GKS) theorem [29] which is true for any ferromagnetic Ising spin
system. Furthermore, if we know the average magnetization m ≡ m
T cell system with uniform interactions, i.e. J 2

(cid:16)(cid:110) J 2

(cid:111)(cid:17)

J 2
µ
ρ , then by the same theorem
, where J0 = inf µ Jµ and J1 = supµ Jµ, from which

ρ =

(cid:111)(cid:17) ≤ m

(cid:17) ≤ m

(cid:16)(cid:110) J 2

(cid:16) J 2

0
ρ

0
ρ

µ
ρ

µ
ρ

: βc

m
also follows that for βc ≡ βc
. We note
that the ratio of the number of regulator T cells to the total number of T cells was
observed, during a normal immune response to the Ag stimulation, to be in the range
0.1 − 0.25 in the experiments on mice [20]. In the phase diagram (see Figure 4) this
corresponds to the lower branch of the m− plot. Also in this regime the ratio of helper
T-cells m+ is a monotonic non-decreasing function of Ag concentration (in our model
Jµ ∝ Ag concentration) which is consistent with the experimental data [27]. We note
that the case of “lattice gas” gas σi ∈ {0, 1} and ξi = 1 (this is a scenario when we
have only T helper cells) which are either active, σi = 1, or inactive, σi = 0, can be
2 , where si ∈ {−1, 1}) into the ferromagnetic
also mapped (for example using σi = 1+si
Ising model with (positive) external ﬁeld [28]. The eﬀect of this on the phase diagram
in Figure 4 is that the fraction of helper T clones m+ = 1 − m− is a continuous
function of β and
We now turn to the analysis of B clone properties in the fast B clone and fast
T clone (n ∈ Z+) equilibration regimes. For the former the average B clone size (or
average B cell concentration) (cid:104)c(cid:105) can be computed from the distribution (17) and for
the latter the same average can be computed from the distribution (31). In order to
simplify the analysis of both equilibration regimes, we deﬁne the distribution

J 2
µ
ρ [29].

(cid:111)(cid:17) ≤ βc

(cid:17) ≤ βc

(cid:16)(cid:110) J 2

(cid:16) J 2

1
ρ

(cid:16) J 2

(cid:111)(cid:17)

µ
ρ

(cid:17)

for the

µ
ρ

where

P (c) =

P (F ) =

(cid:90) e
(cid:88)

{σα}

(cid:113)

− 1

2 ρ ˜β(log(c)− F

nρ )2

c

2π/ρ ˜β

P (σ1, . . . , σn)

P (F ) dF,

(cid:32)
F − n(cid:88)

δ

α=1

M(cid:88)

ν=1

1
M

(38)

(cid:33)

Fν(σα)

.

(39)

The distribution (38) is the distribution of B clone sizes for the fast B-clone and fast
T-clone equilibration regimes when n = 1 and ˜β = nβ respectively. We note that the
log-normal distribution in the equation (38) can be interpreted as the (asymptotic)
distribution of the “size” ci of an element in the growth process where each element

Statistical mechanics of lymphocyte networks modelled with slow and fast variables 13

Figure 5. Possible topologies for bipartite graphs (left and centre). T cells and
B clones are represented by circles and squares respectively. Bipartite graph on
the left gives rise to the T cell system (on the right) interacting on the classical
square lattice (circles and thick solid lines). Bipartite graph in the centre gives
rise to the T cell system (on the right) interacting on the classical square lattice
with extended interaction range (circles and solid lines).

changes its size with the rate w(c → c(cid:48)) = λδ (c(cid:48) − (1 + g)c), where λ is a (mean)
growth rate and g is a growth factor [30]. In this interpretation the growth factor g is
related to the apoptosis parameter ρ via the equation log2(1 + g) = ρ−1 and the noise
(cid:17)
parameter ˜β is related to the (rescaled) time λt , where λ is a (mean) growth rate, via
the equation λt = ˜β−1. Furthermore, when the initial size ci = c0 then c0 = e
and hence the distribution (38) is an average over random initial conditions. Since
c is a clone size, the growth process picture is consistent with the adaptive immune
response: the B-cells which “survived” interactions with the T cells, there are c0 such
cells, serve as an initial condition for the subsequent B cell proliferation process.

(cid:16) F
n − √

ρ
˜β

1
ρ

Let us now consider the distribution (38). Its ﬁrst moment is given by the equation

(40)

(41)

(cid:90)

(cid:17)

(cid:104)c(cid:105) = e1/2ρ ˜β

eF/nρP (F )dF

(cid:104)(c − (cid:104)c(cid:105))2(cid:105) = e1/2ρ ˜β(cid:16)

(cid:17)(cid:90)

and its variance is given by the equation

Jµ

µ=1 e

e1/2ρ ˜β − 1

e2F /nρP (F )dF .

ρ θµ coshn|∂µ|(cid:16) Jµ

Let us deﬁne the function (cid:104)eF/nρ(cid:105)β =(cid:82) eF/nρP (F )dF and consider its properties. For
(cid:80)M

β → 0 this function can be expanded around β = 0 which gives us (cid:104)eF/nρ(cid:105)β =
+ O(β) and in the opposite limit of β → ∞ this
1
M
function is dominated by the ferromagnetic ground state σ = (1, . . . , 1) which gives
us (cid:104)eF/nρ(cid:105)∞ = 1
ρ (|∂µ|+θµ) (for θµ (cid:54)= 0 the dynamics (5) can also “select”
the (1, . . . , 1) state as N → ∞), so (cid:104)eF/nρ(cid:105)∞ ≥ (cid:104)eF/nρ(cid:105)0. Furthermore, (cid:104)eF/nρ(cid:105)β is
monotonic non-decreasing function of β which for N < ∞ is smooth everywhere but
at βc when N → ∞ with θµ = 0 (see Appendix A for details).
From above analysis of the function (cid:104)eF/nρ(cid:105)β we conclude that in the fast B-
clone equilibration regime (n = 1) the average number of B-cells (cid:104)c(cid:105) is a monotonic
If we
non-decreasing function of β (see Figure 4 for one of possible behaviours).

(cid:80)M

µ=1 e

nρ

Jµ

M

Statistical mechanics of lymphocyte networks modelled with slow and fast variables 14
combine two plots in the Figure 4 then it is clear that (cid:104)c(cid:105) is a monotonic non-
decreasing (non-increasing) function of the fraction of helper T-cells m+ (regulator
function (cid:104)e2F/nρ(cid:105)β = (cid:82) e2F/nρP (F )dF used in the variance equation (41) has the
T-cells m−) which is consistent with what is observed in in vivo
[27, 20]. We
note that the variance (cid:104)(c − (cid:104)c(cid:105))2(cid:105) has a similar behaviour in this regime (the
same behaviour as the function (cid:104)eF/nρ(cid:105)β).
The case of fast T-clone equilibration with n ∈ Z+, because of the relation ˜β = nβ,
(cid:17)
is not so clear. Here the average (cid:104)c(cid:105) = e1/2ρnβ(cid:104)eF/nρ(cid:105)β is diverging as β → 0 (it is ﬁnite
when β → ∞) and the derivative ∂
is
negative when β → 0 (in this limit ∂
2ρnβ2(cid:104)eF/nρ(cid:105)β ∈ O(1/β)) and
2ρnβ2(cid:104)eF/nρ(cid:105)β ∈ O(1/β2) but we expect the
could be positive or negative (in this limit
∂β(cid:104)eF/nρ(cid:105)β → 0 to be strongly inﬂuenced by the properties of T-clone
convergence of ∂
network) when β → ∞.
The fast T-clone equilibration regime with n ∈ R+ is much more diﬃcult to
analyse, but in the low B-clone noise ˜β → ∞ limit we expect at least in some regimes
the same phase diagram as in the Figure 4. To show this we ﬁrst note that the
marginal distribution (35) can be written as the integral

∂β(cid:104)c(cid:105) = e1/2ρnβ(cid:16) ∂

∂β(cid:104)eF/nρ(cid:105)β < ∞ and

∂β(cid:104)eF/nρ(cid:105)β − 1

2ρnβ2(cid:104)eF/nρ(cid:105)β

1

1

(cid:82)Dσi eβσi
(cid:80)
(cid:82) D˜σi eβ ˜σi
(cid:19)2
N(cid:88)

+

1
β

i=1

(cid:80)
(cid:90)

log

µ∈∂i bµJµξµ

i δ(σ − σi)

µ∈∂i bµJµξµ

i

db,

(42)

Dσ eβσ(cid:80)

µ∈∂ibµJµξµ
i .

(43)

where

This integral can be computed exactly by the Laplace method [31] which gives us

where b∗

µ is a solution of the system of equations

i δ(σ − σi)
µJµξµ

i

,

ν∈∂i bν Jν ξν

i σ
µ∈∂i bν Jν ξν
i



+ θµ

Pi(σ) =

φ(b) = − 1
2

ρ

(cid:90)

µ=1

e ˜βφ(b)

µJµξµ
µ∈∂i b∗

(cid:82) d˜b e ˜βφ(˜b)
(cid:18)
M(cid:88)
bµ− Jµθµ
ρ
(cid:82)Dσi eβσi
(cid:80)
(cid:82) D˜σi eβ ˜σi
(cid:80)
µ∈∂i b∗
 1
(cid:82)Dσ eβσ(cid:80)
(cid:88)
(cid:82) D˜σ eβ ˜σ(cid:80)
(cid:82)Dσi eβσi
(cid:80)
(cid:82) D˜σi eβ ˜σi
(cid:80)
µ∈∂i b∗
µ∈∂i b∗
 1
(cid:88)
(cid:82)Dσ eβσ(cid:80)
(cid:82) D˜σ eβ ˜σ(cid:80)

j (cid:104)σj(cid:105) + θµ
ξµ
(cid:80)
(cid:80)

i σi
µJµξµ



µ∈∂i J 2

µ∈∂i J 2

µξµ

i ( 1

µξµ

i ( 1

µJµξµ

j∈∂µ

i∈∂µ

ξµ
i

ρ

ρ

ρ

ρ

i

Pi(σ) =

bµ = Jµ

(cid:104)σi(cid:105) =

bµ = Jµ

(cid:104)σi(cid:105) =

corresponding to a maximum of the function φ(b). From the ﬁrst moment

of the distribution (44) and the extremum condition (45) follows that

which gives us the equation

j∈∂µ ξµ

j∈∂µ ξµ

j (cid:104)σj(cid:105)+θµ)σ
j (cid:104)σj(cid:105)+θµ)

.

(44)

(45)

(46)

(47)

(48)

Statistical mechanics of lymphocyte networks modelled with slow and fast variables 15

ρ

(cid:80)

µ∈∂i J 2

µξµ

i ( 1

ρ

j∈∂µ ξµ

Pi(σ) =

µ∈∂i J 2

µξµ

i ( 1

Solutions of this equation can be used to compute the marginal T clone distribution
(44) via the equation

and the distribution (36) via the equation

j (cid:104)σj(cid:105)+θµ)δ(σ − σi)
j∈∂µ ξµ

(cid:82)Dσi eβσi
(cid:80)
(cid:82) D˜σi eβ ˜σi
(cid:80)
(cid:82)Dσi eβσi
(cid:89)
(cid:80)
(cid:82) D˜σi eβ ˜σi
(cid:80)
The average B-cell concentration (cid:104)c(cid:105) = (cid:82) ∞
(cid:82) P ˜β,β(b)ebµdb which gives us the equation
(cid:80)

× δ(F − Fµ(σ)) .

integral (cid:104)c(cid:105) = 1

j (cid:104)σj(cid:105)+θν)
j (cid:104)σj(cid:105)+θν)

(cid:80)
(cid:80)
(cid:80)

(cid:80)M

µ=1 lim ˜β→∞

j (cid:104)σj(cid:105)+θµ)

Pµ(F ) =

0 P (c)c dc can be also computed from the

(49)

(50)

ν∈∂i J 2

ν ξν

i ( 1

j∈∂ν ξν

j∈∂ν ξν

ν∈∂i J 2

ν ξν

i ( 1

ρ

i∈∂µ

M

ρ

eJµ( 1

ρ

j∈∂µ ξµ

j (cid:104)σj(cid:105)+θµ).

(51)

(cid:104)c(cid:105) =

1
M

In the case of Ising variables σi ∈ {−1, 1} and ξµ
binary case σi ∈ {0, 1}, the above framework gives us the equation

i ∈ {−1, 1}, which also includes the
(cid:88)

 .

j (cid:104)σj(cid:105) + θµ
ξµ

(52)

 1

ρ

µξµ
J 2

i

j∈∂µ

(cid:88)

µ∈∂i

(cid:104)σi(cid:105) = tanh

µ=1

M(cid:88)
β

A simplest case here is a regular network topology (such as in the Figure 5) with
the uniform interactions Jµ = J and without the self-activation, i.e. θµ = 0. For this
ρ K(cid:104)σi(cid:105), where |∂µ| = K, by
case the equation (52) simpliﬁes considerably: here bµ = J
the equation (47) and if we deﬁne m = (cid:104)σi(cid:105), then this gives us the equation

(cid:18) J 2

(cid:19)

LKm

m = tanh β

(53)
where |∂i| = L, for the average magnetization m and the average B cell concentration
(cid:104)c(cid:105) = e
ρ Km follows from the equation (51). Also, the distribution of ﬁelds (50) takes
a more simple form and is given by the equation

ρ

,

J

(cid:88)

{σj}

ρ LKm(cid:80)K
2K coshK(cid:16)

eβ J2

β J 2

j=1 σj

ρ LKm

F − J

(cid:17) δ

 ,

σj

K(cid:88)

j=1

(54)

P (F ) =

where P (F ) = Pµ(F ).

The equation (53) has m = 0 as its solution for any β but this solution becomes
J 2LK , and two stable solutions |m| (cid:54)= 0 emerge.
unstable for β > βc, where βc = ρ
Furthermore, the average number of B cells, (cid:104)c(cid:105), is a monotonic non-increasing function
2 (1 − m) (the case of J = ρ = 1 is studied
of the fraction of T regulator cells m− = 1
in the Figure 6). The B-clones are receiving predominantly excitatory (inhibitory)
signal from the T clones, which is governed by the distribution P (F ), when m− < 1
2
(m− > 1
2 ) as can be seen in the Figure 6. For β < βc the point m = 0 is the only
solution and the B cells are no longer controlled by the T cells : (cid:104)c(cid:105) = 1 for all β.

So far we were able to discuss behaviour of T clones and B clones by making a
very weak assumptions about the topologies of networks and their interactions. This
analysis is very qualitative and it only covers the cases where we can map our model

Statistical mechanics of lymphocyte networks modelled with slow and fast variables 16

(cid:104)c(cid:105)

P (F )

m−

P (F )

F

F

Figure 6. Behaviour of B clones and T cells in the immune system with fast B
clone equilibration. The system, deﬁned a graph with connectivity L = K = 4,
was studied for the high β < βc (βc = 0.0625) and low β > βc T clone noise levels
in the noiseless B clone regime ( ˜β → ∞). Top: Left: The average B-clone size,
(cid:104)c(cid:105), as a function of the fraction of T regulator cells , m− = 1−m
. Right: The
distribution P (F ) of the T cell activity F for β = 0.0525 with m− = 1
2 . Bottom:
The distribution P (F ) for β = 0.0855 with m− = 0.1 (left) and m− = 0.9 (right).

2

onto the ferromagnetic Ising spin systems which are quite well understood [29, 28].
Unfortunately, we can not construct such arguments for the case of σi ∈ {0, 1} with
i ∈ {−1, 1} which is also equivalent to the the Ising model but it is no longer
ξµ
ferromagnetic (the map σ : {−1, 1} → {0, 1}, where σ = 1+s
2 , gives rise to site-
dependent external ﬁelds which could be positive or negative). Furthermore, to make
quantitive predictions about the observables such as fractions of T cells, m±, and
concentrations of B cells, (cid:104)c(cid:105), and for a more informative observables, such as the
B-clone distribution (38), we have to be more speciﬁc about the graph G and the
interactions {ξµ

i }, {Jµ}.

(cid:80)N

Since we don’t have such detailed knowledge about the real immune systems,
we will follow the “Bayesian” route here and choose these parameters to be random,
but subject to biological constraints such as the average number of regulator T cells
p = 1
i=1 δξi;−1 or the number of T cells a single T cell can interact with (for
N
example in two graphs in the Figure 5 these numbers are 4 and 8) which can be
deduced by the arguments presented in [32].

We note that in the real immune systems the interactions of lymphocytes with the
Ag are occurring in a 3-dimensional (3d) volume, so it is reasonable to choose a regular
3d lattice for the graph topology. However, even if we choose a simpler 2d lattice there
are many possibilities how to construct the graph G (two possible constructions are

Statistical mechanics of lymphocyte networks modelled with slow and fast variables 17

presented in the Figure 5). Also, systems interacting on d-dimensional (d > 1) lattices
are very diﬃcult to study analytically and one often uses locally tree-like [33] random
graph topologies as an approximation which is expected to be quite good away from
the phase transitions [34].
3.1. Bethe−Peierls approximation
For the systems interacting on trees the local observables, such us for example the
distribution of ﬁelds (36), can be computed recursively. Let us ﬁrst consider the
i } in both the
distribution (37), which governs the (replicated) T-clone variables {σα
fast B-clone (n = 1) and fast T-clone (n ∈ Z+) equilibration regimes, deﬁned on a
factor-tree Tµ(r) of radius r which is centred at the factor-node µ (see Figure B1 in
the Appendix B). The ﬁeld Fµ(σα) = Jµ
on this factor node is
governed by the distribution

(cid:16)(cid:80)

i∈∂µ ξµ

i + θµ

i σα

(cid:17)

(cid:33)(cid:43)

Pµ(F ) =

=

where the cavity distribution Pµi[σ] can be computed recursively¶ , starting from the
variables laying on the boundary ∂Tµ of the tree Tµ, via the equation
ν∈∂i\µ((cid:80)n

α=1Fν (σα))2

(cid:80)

β

(56)

Pµi[σi] =

(55)

,

δ

α=1

(cid:42)
(cid:32)
F − n(cid:88)
(cid:80){σi}(cid:81)
(cid:80){ ˜σi}(cid:81)
 (cid:89)
(cid:34)(cid:88)
(cid:88)

(cid:88)

ν∈∂i\µ

{σj}

×

˜σi

{ ˜σj}

i∈∂µ Pµi[σi] e

α=1 Fµ(σα))

α=1 Fµ( ˜σα))2

Fµ(σα

β

n
β

2nρ F 2

i∈∂µ Pµi[ ˜σi]e

δ (F −(cid:80)n
2nρ ((cid:80)n
e
(cid:89)
(cid:80)
ν∈∂i\µ((cid:80)n



α=1Fν ( ˜σα))2

(cid:89)
 (cid:89)

Pνj[ ˜σj]

Pνj[σj]

ν∈∂i\µ

j∈∂ν\i

2nρ

j∈∂ν\i

(cid:35)−1

.

× e

β

2nρ

Similarly, if we consider the distribution (37) which is deﬁned on a factor-tree Ti with
the variable-node i at its root then, using the replica identity (27), we can also compute
the local magnetization+

(cid:104)σi(cid:105) =

=

(cid:88)
(cid:88)

σ

{σj}
× e

Pi(σ)

1
n

(cid:89)

µ∈∂i

(cid:80)

α=1

σα

n(cid:88)
(cid:89)
µ((cid:80)

j∈∂µ\i

(cid:88)

σ

(cid:80)n

n(cid:88)

α=1

1
n

σα

(cid:80)n

Pµj[σj]

β

2nρ

µ∈∂i J 2

j∈∂µ\i ξµ

j

α=1 σα

j +ξµ

i

α=1 σα+θµ))2

(57)

¶ The distribution of Pµi[σ] is the distribution of variable σi on a graph where the link (µ, i) is
removed. To distinguish such a “cavity” distributions from the distributions on graphs with all links
intact, such as the distribution of σi, Pi(σ), for example, we will use the square brackets [. . .] in their
deﬁnitions throughout this paper.
+ The details of derivation of the ﬁrst three equations of this section are provided in the Appendix
B.

Statistical mechanics of lymphocyte networks modelled with slow and fast variables 18

(cid:40) (cid:88)

×

{ ˜σj}

× e

β

2nρ

(cid:89)

µ∈∂i

(cid:80)

(cid:89)
µ((cid:80)

j∈∂µ\i

(cid:88)

˜σ

(cid:80)n

Pµj[ ˜σj]

µ∈∂i J 2

j∈∂µ\i ξµ

j

α=1 ˜σα

j +ξµ

i

(cid:80)n

α=1 ˜σα+θµ))2

(cid:41)−1

.

We note that the structure of these equations is not aﬀected by the choice for the
i ∈ {−1, 1} with θµ = 0 the recursion (56)
σα
i variables, but in the Ising case σα
preserves the spin-reversal symmetry, i.e. the equality Pν(cid:96)[σ] = Pν(cid:96)[−σ] implies that
Pµj[σ] = Pµj[−σ]. For n = 1 this gives us that Pν(cid:96)[σ] = 1
2 is a solution of this map
for any β but for n > 1 the uniform distribution Pν(cid:96)[σ] = 1
2n is a solution of (56) only
when β = 0. The consequence of the symmetry Pµj[σ] = Pµj[−σ] is that the local
magnetization (cid:104)σi(cid:105) = 0 and the distribution (39) is symmetric, i.e. Pµ(F ) = Pµ(−F ).
The equations (39)-(57) can be simpliﬁed if we deﬁne the replica “magnetization”

For example using above deﬁnition in (39) and (56) gives us respectively the equations

distribution

P [h] =

(cid:88)

σ

Pµ(F ) =

Pµi[hi] =

and

i∈∂µ Piµ[˜hi]

× δ

α=1 σα.

P [σ]δh;(cid:80)n
(cid:110)(cid:81)
(cid:80){hi}
(cid:110)(cid:81)
(cid:80){˜hi}
F − Jµ
 (cid:89)
(cid:89)
(cid:80)
ν ((cid:80)
 (cid:89)
(cid:34)(cid:88)
(cid:88)
(cid:80)

{hj}
× e
×

(cid:88)

ν∈∂i\µJ 2

ν∈∂i\µ

j∈∂ν\i

{˜hj}

˜hi

2nρ

β

β

ν∈∂i\µJ 2

2nρ

× e

ν ((cid:80)

(cid:111)
2nρ ((cid:80)

i∈∂µ Piµ[hi]
βJ2
µ

(cid:111)
(cid:88)

e

i∈∂µ

ξµ
i hi + θµ

 (cid:88)
(cid:89)

σ1,...,σn
j hj +θν)2

Pνj[˜hj]

Pνj[hj]

j∈∂ν ξν

ν∈∂j\µ

j∈∂ν\i

β

2nρ F 2

e

i∈∂µ ξµ

˜hi+θµ)2

i


δhi;(cid:80)n

α=1 σα

 (cid:88)
(cid:35)−1

˜σ1,...,˜σn

j∈∂ν ξν

j

˜hj +θν)2

.

δ˜hi;(cid:80)n

α=1 ˜σα

(58)

(59)

(60)

Let us now consider the distribution (33) which governs B-clones in the fast T-
clone equilibration regime with n ∈ R+. Using the same factor-tree Tµ allows us to
compute∗ the marginal (see Appendix C)
(cid:90) ∞

(cid:17)2

(cid:16)

− 1

2 ρnβ

b− Jµ

ρ θµ

(61)

Pµ(b) =

Piν[bν]dbν

ν∈∂i\µ

−∞

(cid:89)

i∈∂µ

(cid:89)

 e

∗ All equations for the n ∈ R+ regime are derived for σi ∈ {−1, 1}, but they can be used for
σi ∈ {0, 1} if we make the transformations 2 cosh(x) → 1 + ex and 2 sinh(x) → ex.

Statistical mechanics of lymphocyte networks modelled with slow and fast variables 19

2 cosh

Jνξν

i bν + βJµξµ
i b



(cid:90) ∞

−∞

Piν[˜bν]d˜bν

d˜b e

Jνξν
i

˜bν + βJµξµ
i

n
n(cid:35)−1

2 ρnβ

− 1

˜b

(cid:16)˜b− Jµ

ρ θµ

(cid:17)2

ν∈∂i\µ

2 cosh

(cid:89)

ˆν∈∂j\ν

ν∈∂i\µ

−∞

ν∈∂i\µ

β
(cid:88)
(cid:90) ∞
(cid:89)
β
(cid:88)
(cid:90) ∞
β
(cid:88)
(cid:90) ∞
(cid:89)
β
(cid:88)

−∞

−∞

i∈∂µ

×

×

×

i∈∂µ

i∈∂µ

(cid:89)
(cid:34)(cid:89)
(cid:89)
 (cid:89)
 (cid:89)
(cid:34) (cid:89)
 (cid:89)
(cid:110)(cid:81)
(cid:110)(cid:81)

j∈∂ν\i

j∈∂ν\i

j∈∂ν\i

×

×

×

 e

of this distribution, where the cavity distribution Pνi[b] can be computed recursively
via the equation

− 1

2 ρnβ(b− Jν

Pνi[b] =

Pˆνj[bˆν]dbˆν

d˜b e

(62)

ρ θν)2

− 1

ρ θν)2

2 ρnβ(˜b− Jν

n
n(cid:35)−1
σ1,...,σn ex(cid:80)n
(cid:80)n
(cid:17)(cid:105)n ,(63)

α=1 σα

α=1 σα

i bν

˜b

.

i

ν∈∂i\µ Jν ξν

j bˆν + βJνξν
j b

j bˆν + βJνξν
j

−∞

Jˆνξ ˆν

Jˆνξ ˆν

2 cosh

2 cosh

j∈∂ν\i

ν∈∂i\µ

ˆν∈∂j\ν

ˆν∈∂j\ν

ˆν∈∂j\ν

Piµ[σi] =

Pˆνj[˜bˆν]d˜bˆν

(cid:90) ∞


For n ∈ Z+ the above equation, with the identity 2n coshn(x) =(cid:80)
eβ(cid:80)
(cid:16)
β(cid:80)

(cid:82) ∞
(cid:82) ∞

and the deﬁnition

−∞Piν[bν]dbν

−∞Piν[˜bν]d˜bν

(cid:111)
(cid:111)(cid:104)
To compute the local magnetization (cid:104)σi(cid:105) = (cid:80)
 coshn
β

 coshn

(cid:89)
(cid:90) ∞
β
(cid:88)
(cid:89)
(cid:90) ∞

Pµi[˜bµ]d˜bµ

(cid:88)

× tanh

(cid:104)σi(cid:105) =

Pµi[bµ]dbµ

ν∈∂i\µ

Jµξµ

2 cosh

µ∈∂i

µ∈∂i

µ∈∂i

i bµ

−∞

−∞

×

can be used to recover the equation (56) and all other equations of n ∈ Z+ which use
the cavity distribution Piµ[σi].
σ Pi(σ)σ from the distribution
(35) we need to know the joint distribution of the variable in the set {bµ : µ ∈ ∂i}.
Computing this distribution for the factor-tree centred at node i (see Appendix C)
gives us the equation

β

(cid:88)

µ∈∂i

−1

. (64)

Jµξµ
i

˜bµ

ν∈∂i\µJνξν
i

˜bν



Jµξµ

i bµ

µ∈∂i

Statistical mechanics of lymphocyte networks modelled with slow and fast variables 20

(cid:110)(cid:82) ∞

Also, in order to compute the distribution (65) we need to know the joint distribution
Pµ(b,{bν}) of the variable b = bµ and of all its immediate neighbours bν (see Figure
C1 in the Appendix C). This distribution can be “read oﬀ”, using the identity
Pµ(b,{bν}), from the equation (61) which gives us the equation
Pµ(b) =
(cid:17)2

−∞ dbν

(cid:111)

(cid:16)

Pµ(F ) =

Piν[bν]dbν

dbµe

− 1

2 ρnβ

bµ− Jµ

ρ θµ

(65)


(cid:90) ∞
(cid:33)

−∞

ν∈∂i\µ

i∈∂µ

i∈∂µ

(cid:89)
× (cid:89)
×(cid:88)
(cid:34)(cid:89)
× (cid:89)

i∈∂µ

{σi}

β

−∞

coshn

(cid:89)

(cid:90) ∞
(cid:32)
(cid:88)
eβ(cid:80)
(cid:80)
i∈∂µ 2 cosh(cid:0)β(cid:80)
(cid:81)
(cid:90) ∞
(cid:89)
(cid:32)

ν∈∂i
i∈∂µ σi

ν∈∂i\µ

−∞

(cid:88)

coshn

β

i∈∂µ

ν∈∂i

Jνξν

i bν

ν∈∂i bν Jν ξν

i

ν∈∂i bνJνξν
i


(cid:90) ∞
(cid:33)(cid:35)−1

−∞

Jνξν
i

˜bν

.

Piν[˜bν]d˜bν

(cid:1) δ (F − Fµ(σ))
(cid:16)˜bµ− Jµ

− 1

2 ρnβ

d˜bµ e

(cid:17)2

ρ θµ

The equation (62) preserves the symmetry Pνi[b] = Pνi[−b] when θµ = 0. This gives
us that the marginal distribution (61) and the distribution of ﬁelds (65) are symmetric
functions. Also the local magnetization (64) is vanishing.
Finally, we note that the equations derived in this section can be used to compute
local observables, such as the distribution Pµ(F ) or the local magnetization (cid:104)σi(cid:105), on
locally-tree like graphs. In these graphs a “ball” of radius r centred on any variable
node i (or factor node µ ) converges to the tree of radius r centred at this node,
N < ∞), for any r [33]. Then an
Ti(r), when N → ∞ (also M → ∞ with M
observable associated with the node i in such graph is usually approximated by the
same observable computed on Ti(∞)(cid:93). Furthermore, local observables computed on
random trees can be used to compute densities: for example assuming that the density
P (F ) = limM→∞ 1
µ=1 Pµ(F ) is self-averaging [33] we replace this average with
M
the average over the trees Tµ(∞) which for n ∈ Z+ gives us the equation

P (K)

(cid:90)

(cid:40) K(cid:89)
(cid:110)(cid:81)K
(cid:80){˜hi}

(cid:90)
(cid:110)(cid:81)K

i=1

{dPi} W [{Pi}]

(cid:111)
(cid:111)
i=1 Pi[hi|ξi]
2nρ F 2
i=1 Pi[˜hi|ξi]

e

δ

β

(cid:41)(cid:90)
(cid:16)

dJP (J)

(cid:16)(cid:80)K
F − J
2nρ ((cid:80)K

dθP (θ)

(cid:17)(cid:17)
(cid:43)

i=1 ξihi + θ

(66)
.
{ξi}
Above equation was derived for the ensemble of random graphs with the prescribed
distributions P (L) and P (K) of the variable-node and factor-node connectivities
respectively. Also we have assumed that the parameters {ξi}, {Jµ} and {θµ} are
independent random variables which are drown from the distributions P (ξ), P (J)
and P (θ) respectively. The distribution W [{P}] is usually approximated by the

i=1 ξi˜hi+θ)2

βJ2

e

(cid:93) This procedure is exact for ferromagnetic Ising model with uniform interactions [35].

(cid:80)M
(cid:88)
(cid:42)(cid:80){hi}

K≥1

P (F )

=

×

i=1

(cid:80)N
(cid:81)
Statistical mechanics of lymphocyte networks modelled with slow and fast variables 21
h,ξ δ (P [h|ξ] − Pi[h|ξ]) which is obtained by
(empirical) density W [{P}] = 1N
L−1(cid:89)
the population dynamics algorithm [33] which at each step replaces a member i of the
population P = {Pj[h|ξ]} with the new value
(cid:88)
K−1(cid:89)
(cid:80)L−1
(cid:40)(cid:88)
(cid:88)
j }
{˜ha
(cid:80)L−1

j|ξa
j ]
a((cid:80)K−1
K−1(cid:89)
a((cid:80)K−1

 (cid:88)
(cid:41)−1

 (cid:88)

L−1(cid:89)

j }
{ha
× e
×

Pi[h|ξ] =

δh;(cid:80)n

δ˜h;(cid:80)n

Pi(a,j)[˜ha

Pi(a,j) [ha

˜ha
j +θa+ξ˜h)2

j +θa+ξh)2

j|ξa
j ]

j=1 ξa

a=1 J 2

α=1 ˜σα

α=1 σα

σ1,...,σn

˜σ1,...,˜σn

a=1 J 2

a=1

j=1

a=1

j=1

j=1 ξa

j

(67)

j ha

β

2nρ

˜h

× e

β

2nρ

which is computed using the (L − 1) × (K − 1) distributions Pi(a,j)[h|ξ] (i(a,j) ∈
{1, . . . ,N}) ( L and K are random numbers generated from the distributions
(cid:80)
respectively) randomly and uniformly chosen from the
population P. The parameters {ξa
i }, {Ja} and {θa} are also random numbers from
the distributions P (ξ), P (J) and P (θ) respectively.

KP (K)
˜K≥1

LP (L)
˜L≥1

˜KP ( ˜K)

(cid:80)

˜LP ( ˜L)

and

3.2. Analysis of homogeneous systems on random regular factor-graphs

A simplest non-trivial case which allows us to obtain a more quantitative results is
to consider models deﬁned on random regular factor-graphs. The ensemble of these
graphs contains all graphs with the ﬁxed connectivities of variable-nodes, |∂i| = L,
and factor-nodes, |∂µ| = K . The regularity imposes the constraint L
N on the
ratio of factor-nodes (B-clones) to variable nodes (T-clones) M
N . Also, we assume
that Jµ = J and θµ = θ and consider the case of σi ∈ {−1, 1} with n ∈ Z+. For
N → ∞ random regular factor-graphs are locally tree-like [33] and we expect the the
“tree approximation”, described in the previous section, to be exact on such graphs.
Furthermore, the (local) topology of the T-clones system (37) in this connectivity
regime resembles a variant of the Bethe lattice [28] where each node is connected to
exactly L fully connected graphs (cliques) of size K (see Figure 7). From now on we
will call such a graph a random (K, L)-regular clique graph.

K = M

Let us consider the system (37) on one of such graphs. Since the variable nodes
and factor nodes in this graph are all equivalent, the cavity distribution Piµ[h] in
the equation (60) is the same for all i and µ, i.e. Piµ[h] = P [h], which gives us the
recursive equation

P [h] =

where h ∈ {−n,−n + 1, . . . , n − 1, n} and the binomial coeﬃcient(cid:0) n
the computation (cid:80)

j=1 P [˜hj]

βJ2

e

2

n+h

α=1 σα . The solution of this equation can be used to

(cid:20)(cid:80){hj}
(cid:104)(cid:80){˜hj}
(cid:80)
σ1,...,σn δh;(cid:80)n

˜h

(cid:110)(cid:81)K−1
(cid:110)(cid:81)K−1

j=1 P [hj]

(cid:111)

j=1 hj +h)2(cid:21)L−1(cid:0) n
(cid:1)
2nρ ((cid:80)K−1
(cid:111)
˜hj +˜h)2(cid:105)L−1(cid:0) n
2nρ ((cid:80)K−1

βJ2

j=1

e

2

n+h

(cid:1) , (68)
(cid:1) is a result of

n+˜h

2

Statistical mechanics of lymphocyte networks modelled with slow and fast variables 22

Figure 7.
Immune system with the topology of a random (K, L)-regular factor-
graph (left) gives rise to the system of T clones interacting on a random (K, L)-
regular clique graph (right).

P (F )

F

Figure 8. The distribution P (F ) of the T-clone activity F in the model of
immune system with fast B-clone equilibration. The system, deﬁned on a random
regular factor-graph with the connectivity L = K = 4, was studied in the high
β < βc and low β > βc (βc ≈ 0.0929) T-clone noise regimes for the noise
parameters β = 0.0639 with m− = 1
2 (left), β = 0.1219 with m− = 0.1 (centre)
and β = 0.1219 with m− = 0.9 (right).

(cid:80){hj}

(cid:110)(cid:81)K
(cid:80){˜hj}

(cid:111)

β

2nρ F 2

δ

e

(cid:111)

j=1 P [˜hj]

e

j=1 P [hj]

(cid:110)(cid:81)K
(cid:80)

(cid:16)
F − J(cid:80)K
2nρ ((cid:80)K

˜hj )2

j=1

βJ2

j=1 hj

(cid:17)

,

(69)

compute the ﬁeld distribution (59), via the equation

P (F ) =

and the average magnetization m = 1
h P (h)h, where P (h) is the RHS of the
n
equation (68) with L = L+1. The latter result is obtained by comparing the equations
(57) and (60).

Let us ﬁrst consider the case of fast B-clone equilibration. This regime can be
studied using the equations (68), (69) and (38) with n = 1. For n = 1 the T-clone
system is in the paramagnetic (PM) m = 0 phase when β < βc (see Appendix D).
The distribution of ﬁelds P (F ) is symmetric in this phase (see Figures 8) which gives
rise to the quadratic behaviour in the distribution of B-clones P (c) (see Figures 9).
As we increase β the system is eventually develops the ferromagnetic (FM) m (cid:54)= 0

Statistical mechanics of lymphocyte networks modelled with slow and fast variables 23

(cid:104)c(cid:105)

P (c)

m−

P (c)

P (c)

c

c

c

Figure 9. Behaviour of B clones in the immune system with fast B-clone
equilibration. The system, deﬁned on a random regular factor-graph with
connectivity L = K = 4, was studied for the B-clone noise parameters ˜β ∈
{0.5, 1.0, 2.0}, represented by the dotted, dashed and solid lines respectively, in
the high β < βc and low β > βc (βc ≈ 0.0929) T-clone noise regimes. Top:
Left: The average B-clone size, (cid:104)c(cid:105), as a function of the fraction of T regulator
cells , m−. Right: The distribution P (c) of the B-clone size c for β = 0.0639
(m− = 1
2 ). Bottom: B-clone size distributions for β = 0.1219 with m− = 0.1
(left) and m− = 0.9 (right).

phase when β > βc. In FM phase the distribution P (F ) is no longer symmetric (see
Figures 8) and distribution of B-clones behaves as a “power law” when β → ∞ (see
Figures 9). We note that in this regime the distribution (38) is dominated by the
probability P (F ) evaluated at the ﬁeld value F = JK or F = −JK, corresponding to
the magnetization m > 0 or m < 0, which gives rise to such behaviour. In particular
when β → ∞, we have that

P (c) ∝ c−1+ ˜βF e− 1

2 ρ ˜β log2(c).

(70)

Also, in FM phase the average concentration of B cells (40) can be controlled by the
fraction m− of regulating T-clones (see Figures 9).
In the regime of fast T-clone equilibration with n ∈ Z+ (n > 2) we solve the

(cid:18) 1 + m0

recurrence equation (68) using the initial condition

(cid:19) n+h
2 (cid:18) 1 − m0
solution P [h] is symmetric for any m0 and(cid:80)

where the parameter m0 ∈ [−1, 1] is such that m0 = 1

P0[h] =

(cid:19)

(cid:19) n−h
2 (cid:18) n
(cid:80)

n+h

2

2

,

(71)

2
h P0[h]h. For small β the
h P [h]h = 0 which corresponds to the PM

n

Statistical mechanics of lymphocyte networks modelled with slow and fast variables 24

P (F )

F

Figure 10. The distribution P (F ) of the T-clone activity F in the model of
immune system with fast T-clone equilibration. The system, deﬁned on a random
regular factor-graph with the connectivity L = K = 4, was studied in the high
β < βc (left) and low β > βc (centre and right) T-clone noise regimes for the
B-clone noise parameters ˜β = 2β (βc ≈ 0.077) and ˜β = 5β (βc ≈ 0.069) which
are represented by the empty and ﬁlled boxes respectively. The T-clone noise
parameters for the case of ˜β = 2β (empty boxes) were β = 0.076 with m− = 1
2
(left), β = 0.1015 with m− = 0.1 (centre) and β = 0.1015 with m− = 0.9 (right).
The T-clone noise parameters for the case of ˜β = 5β (ﬁlled boxes) were β = 0.068
with m− = 1
2 (left), β = 0.0915 with m− = 0.1 (centre) and β = 0.0915 with
m− = 0.9 (right).

phase m = 0. For large β the solution P [h] is no longer symmetric and(cid:80)
((cid:80)

h P [h]h > 0
h P [h]h < 0) for m0 > 0 (m0 < 0) which corresponds to the m > 0 (m < 0) FM
phase . The transition from PM to FM happens at βc which is, in addition to L
and K, is also a function of the parameter n. The T-clones behave similarly as the
T-clones in fast B-clone equilibration regime (see Figures 10) but the behaviour of
B-clones is diﬀerent.
The average concentration of B cells (cid:104)c(cid:105) is not a monotonic function of m−: (cid:104)c(cid:105) is
increasing with m− on the interval [0, M−) and decreasing on the interval (M−, 1] (see
Figure 11). However, as n → ∞ the interval [0, M−) is shrinking and in this limit we
expect to recover the exact equations (53) and (54) of the (equivalent) ˜β → ∞ limit.
The “power law” behaviour of the distribution P (c) is less pronounced (see Figure 11)
than in the Figure 9 of the fast B-clone case. We ascribe this to the dependence on β
of the log-normal part of the distribution (38) via the relation ˜β = nβ.

Finally, we note that the equation (68), which thus far we were able to analyse only
numerically, can be studied in a much more analytical manner when the connectivity
L or K is large. Also, this analysis allows us to probe the extreme regime of large B
cell number M (cid:29) N or large T cell number (N (cid:29) M ).

3.2.1. Large L and ﬁnite K (or M
(68) can be also written in the form
(L − 1)!

(cid:88)

{N}

P [h] =

N → ∞) regime To start we note that the equation

(cid:26)(cid:81){hj}
(cid:16)(cid:81)K−1
(cid:110)(cid:81){hj} N [{hj}]!
(cid:111)
(cid:80){hj} N [{hj}](h+(cid:80)K−1

(cid:17)N [{hj}](cid:27)
j=1 hj)2(cid:18) n

j=1 P [hj]

× e

βJ2
2nρ

(cid:19)

n+h

2

Statistical mechanics of lymphocyte networks modelled with slow and fast variables 25

(cid:104)c(cid:105)

P (c)

m−

P (c)

P (c)

c

c

c

Figure 11. Behaviour of B cell clones in the model of immune system with fast
T-clone equilibration. The system, deﬁned on a random regular factor-graph with
connectivity L = K = 4, was studied in the high β < βc and low β > βc T-clone
noise regimes for the B-clone noise parameters ˜β = 2β (βc ≈ 0.077) and ˜β = 5β
(βc ≈ 0.069) which are represented by the dashed and solid lines respectively. Top:
Left: The average B clone size, (cid:104)c(cid:105), as a function of the fraction of T regulator
cells, m−. Right: The distribution P (c) of the B-clone size c for β = 0.076
(dashed line) and β = 0.068 (solid line) with m− = 1
2 . Bottom: The B-clone
size distributions for β = 0.1015 (dashed line) and β = 0.0915 (solid line) with
m− = 0.1 (left) and m− = 0.9 (right).

(cid:40)(cid:88)

(cid:88)

{N}

˜h

×

(L − 1)!

(cid:26)(cid:81){˜hj}
(cid:17)N [{˜hj}](cid:27)
(cid:16)(cid:81)K−1
(cid:110)(cid:81){˜hj} N [{˜hj}]!
(cid:111)
(cid:19)(cid:41)−1
˜hj)2(cid:18) n
(cid:80){˜hj} N [{˜hj}](˜h+(cid:80)K−1

j=1 P [˜hj]

where(cid:80){hj} N [{hj}] = L − 1 and N [{hj}] ∈ {0, . . . , L − 1}. Then the formula [36]

, (72)

n+˜h

j=1

2

× e

βJ2
2nρ

√

2πN e

θN

12N , where |θN| < 1, gives us the

N ! = ρNN N e−N with ρ0 = 1 and ρN =
identity

(L − 1)!

(cid:81){hj} N [{hj}]!

ρL−1(L − 1)(L−1)e−(L−1)

(cid:81){hj} ρN [{hj}]N N [{hj}][{hj}]e−N [{hj}]
−(L−1)(cid:80){hj}

N [{hj}]

N [{hj}]
L−1 +RL−1({N}),

L−1

log

=

= e

(73)

where RL−1({N}) = log ρL−1 − (cid:80){hj} log ρN [{hj}]
L−1||P K−1(cid:17)
(cid:16) N

L−1}) + O(log(L − 1))).
(L−1)(cid:81)K−1
N [{hj}]

RL−1({N}) = Ω({ N
D

= (cid:80){hj}

N [{hj}]

L−1

log

(it is easy to show that
Let us deﬁne the functional
, which is a Kullback−Leibler

and(cid:81)K−1

j=1 P [hj ]
N [{hj}]
L−1

Statistical mechanics of lymphocyte networks modelled with slow and fast variables 26

j=1 P [hj], and use the
(KL) “distance” [37] between the distributions
identity (73) to compute the numerator in the equation (72). This computation is
L−1 and take the limit of L− 1 → ∞ which
greatly simpliﬁed if we assume that J 2 = 1
gives us

(cid:80){hj}

2nρ (h+(cid:80)K−1

β

j=1 hj)2

N [{hj}]

L−1

(cid:88)

{N}

=

L−1||P K−1)+RL−1({N})

2nρ (h+(cid:80)K−1

β

j=1 hj)2

L−1||P K−1)+RL−1({N})

×

e−(L−1)D( N

L−1||P K−1)+RL−1({N})e

{N}

L−1

{N}

× e

N [{hj}]

(cid:80){hj}{(cid:81)K−1

e−(L−1)D( N
(cid:80){hj}
e−(L−1)D( N

(cid:88)
(cid:88)
2nρ (h+(cid:80)K−1
2nρ (h2+2h(K−1)(cid:104)˜h(cid:105))(cid:0) n
(cid:1)
2nρ (ˆh2+2ˆh(K−1)(cid:104)˜h(cid:105))(cid:0) n
2nρ (h2+2h(K−1)(cid:104)˜h(cid:105))(cid:0) n
2nρ (ˆh2+2ˆh(K−1)(cid:104)˜h(cid:105))(cid:0) n

(cid:80)
(cid:80)
(cid:80)

j=1 P [hj ]} β

ˆh e

h e

n+h

e

β

β

β

β

2

2

2

n+ˆh

n+h

(cid:1)
(cid:1)h
(cid:1)

ˆh e

n+ˆh

2

P [h] =

(cid:104)h(cid:105) =

−1

where (cid:104)˜h(cid:105) =(cid:80)

that this distribution

= e

(74)
˜h P [˜h]˜h. Using above result to compute the distribution (72) gives us

= e

j=1 hj)2

β

2nρ (h2+2h(K−1)(cid:104)˜h(cid:105)),

(75)

(76)

(77)

is only a function of its ﬁrst moment. We note that in this limit the cavity P [h]
(cid:104)h(cid:105)
n is equals to the
and the physical P (h) distributions are the same and the average
average magnetization m.

Let us deﬁne the average

(cid:80)
(cid:80)

h e

(cid:1)g(h)
2nρ (h2+2h(K−1)x)(cid:0) n
2nρ (ˆh2+2ˆh(K−1)x)(cid:0) n
(cid:1)

n+h

β

β

2

ˆh e

n+ˆh

2

(cid:104)g(h)(cid:105)x =

then the RHS of the equation (76) is given by (cid:104)h(cid:105)x, where x = (cid:104)˜h(cid:105). The function (cid:104)h(cid:105)x
has the following properties:
i) (cid:104)h(cid:105)−x = −(cid:104)h(cid:105)x;
ii) ∂

(h − (cid:104)h(cid:105)x)2(cid:69)
(cid:104)(cid:68)
(K − 1)2(cid:104)(cid:68)

(cid:105) ≥ 0;
(h − (cid:104)h(cid:105)x)3(cid:69)

x

(cid:16) β
(cid:17)2
nρ (K − 1)
∂x(cid:104)h(cid:105)x = β
∂x2(cid:104)h(cid:105)x =

nρ

iii) ∂2
From i) follows that (cid:104)˜h(cid:105) = 0 is a ﬁxed point of the recursion (76). By ii) this point
∂x(cid:104)h(cid:105)x|x=0
becomes unstable when ∂

nρ (K − 1)(cid:104)h2(cid:105)0 ≥ 1. The derivative ∂

∂x(cid:104)h(cid:105)x|x=0 = β

x

(cid:105) ≤ 0, for all x ≥ 0.

Statistical mechanics of lymphocyte networks modelled with slow and fast variables 27

is a monotonic nondecreasing function of β by the inequality
β(K − 1)

(K − 1)

∂2

(cid:104)h(cid:105)x|x=0 =

(cid:104)h2(cid:105)0 +

Furthermore, for β large

β

n+h

nρ

h e

∂β∂x

(cid:104)h2(cid:105)0 =

(cid:1)h2
2nρ h2(cid:0) n
(cid:80)
(cid:1) =
ˆh2(cid:0) n
(cid:80)
(cid:1)(−n)2 +(cid:0)n
(cid:1)n2
(cid:0)n
(cid:0)n
(cid:1) +(cid:0)n
(cid:1)
∂x(cid:104)h(cid:105)x|x=0 ∈(cid:104)
(cid:105)
ρ (K − 1)

ˆh e

n+ˆh

=

2nρ

n

0

β

2

2

(cid:3) ≥ 0 (78)

nρ

(cid:2)(cid:104)h4(cid:105)0 − (cid:104)h2(cid:105)2
(cid:1)h2
(cid:1)

2nρ (n2−h2)(cid:0) n
2nρ (n2−ˆh2)(cid:0) n

n+h

0

2

− β

n+ˆh

2

(cid:80)
(cid:80)

− β

h e

ˆh e

= n2

n

0
0, βn

(79)
for β ∈ [0,∞). Thus there exists (ﬁnite) βc
and hence ∂
such that the solution (cid:104)˜h(cid:105) = 0 of the recursion (76) becomes unstable. By i) and
iii) the function (cid:104)h(cid:105)x is concave (convex) on the interval x ∈ (0,∞) (x ∈ (−∞, 0))
and hence this function crosses the diagonal x only once on this interval when
∂x(cid:104)h(cid:105)x|x=0 > 1. This intersection corresponds to the stable solution |(cid:104)˜h(cid:105)| (cid:54)= 0 of
∂

the equation (76).

To show iii) we use the identity(cid:0) n
(cid:80)
(cid:80){˜σα} e

which gives us the equation
(cid:104)g(h)(cid:105)x =

(cid:80){σα} e

β
nρ

2

n+h

(cid:1) =(cid:80){σα} δh;(cid:80)n
nρ (K−1)x(cid:80)n
(cid:80)

g((cid:80)n
nρ (K−1)x(cid:80)n

α=1 σα

α<γ σασγ + β

.

β
nρ

α=1 ˜σα

α<γ ˜σα ˜σγ + β

(80)
From the above follows that the average (cid:104)h(cid:105)x is equal to the average magnetization in
ferromagnetic Ising system with the interactions and external ﬁeld being equal to 1
nρ
and (K − 1)x respectively. By the the Griﬃths–Hurst–Sherman (GHS) theorem [38]
the average magnetization in such system is a concave function of positive external
ﬁeld and hence the inequality iii) is true.
Furthermore, using (80) to compute the average (cid:104)h2(cid:105)0 we obtain the identity
nρ (K − 1)(cid:104)h2(cid:105)0 = β
α<γ(cid:104)σασγ(cid:105)0. The correlation function
(cid:104)σασγ(cid:105)0 ≥ 0 by the Griﬃths-Kelly-Sherman (GKS) theorem [29] and (cid:104)σασγ(cid:105)0 ≤ 1
by σα ∈ {−1, 1}. From this follow the inequalities β
nρ (K − 1)(cid:104)h2(cid:105)0 <
ρ (K − 1) which gives us lower and upper bounds on βc:
n β

nρ (K − 1)(cid:80)

ρ (K − 1) + 2 β

ρ (K − 1) ≤ β

β

α=1 σα in the equation (77)

α=1 σα)

using the recursive equation (76) we obtain the recursive equation

Let us now deﬁne the function m(h) = h

h en β

(cid:80)

(cid:80)

2ρ (m2(h)+2m(h)(K−1)m)(cid:0)
2ρ (m2(˜h)+2m(˜h)(K−1)m)(cid:0)
(cid:1) then for n → ∞ we obtain the equation

˜h en β

m =

for this average. If we deﬁne the function φn(m(h)) = β
2ρ
1

n

n log(cid:0)

n 1+m(h)

2

ρ

(K−1) .

n(K−1) < βc ≤ ρ

n and its average m =(cid:80)
(cid:1)m(h)
(cid:1)
(cid:0)m(h)2 + 2m(h)(K − 1)m(cid:1)+

h P [h]m(h) then

n 1+m(h)
n

n 1+m(˜h)

(81)

n

2

2

h en φn(m(h))m(h)

(cid:80)
(cid:80)
(cid:80)
(cid:80)
h e−n (supM∈[−1,1] φ∞(M )−φn(m(h)))m(h)
˜h e−n (supM∈[−1,1] φ∞(M )−φn(m(˜h)))

˜h en φn(m(˜h))

m =

=

(cid:26) β

2ρ

(cid:0)M 2 + 2M (K − 1)m(cid:1) + S

(cid:18) 1 + M

(cid:19)(cid:27)

2

,(82)

= argsupM∈[−1,1]

(cid:19)

(cid:18) β

ρ

Statistical mechanics of lymphocyte networks modelled with slow and fast variables 28

(cid:1) is the Shannon entropy of a binary variable [37]. From the above

where S(cid:0) 1+M

follows that m satisﬁes the equation

2

m = tanh

Km

(83)

which recovers the ˜β → ∞ equation (53) in the limit of L → ∞ with J 2 = 1
L → ∞ with J 2 = 1
(one can set J 2 = ˜J 2

Finally, we note that the ﬁeld distribution (69) converges to δ (F ) in the limit of
L−1 and although the T-clones are responding to Ag in this regime
L−1 ) the are unable to control the B-clones.

L−1 .

3.2.2. Finite L and large K (or M
this regime is to note that the equation (68) can be written in the form

N → 0 ) regime A starting point of the analysis in

(cid:1) ,(84)

(85)

−∞ Dz ezJ

˜h P [˜h] ezJ

−∞ Dz ezJ

˜h P [˜h] ezJ

(cid:20)(cid:80)
(cid:20)(cid:80)

ˆh

nρ h

(cid:113) β
(cid:113) β
(cid:35)K−1

nρ

(cid:21)K−1(cid:35)L−1(cid:0) n
(cid:1)
(cid:21)K−1(cid:35)L−1(cid:0) n

n+h

˜h

2

˜h

(cid:113) β
(cid:113) β

nρ

nρ

n+ˆh

2

(cid:41)

(cid:113) β
nρN [h]h
(cid:113) β
(cid:80)
h N [h]h,

nρ

ezJ

(cid:41)

P N [h][h]ezJ

P N [h][h]

(cid:34)(cid:82) ∞
(cid:34)(cid:82) ∞
(cid:80)

ˆh

P [h] =

√
dz/

(cid:34)(cid:88)

h

=

=

P [h] ezJ

nρ h

{N [h]}

(cid:88)
(cid:88)

(cid:113) β
{(cid:81)
{(cid:81)
(cid:34) (cid:88)

{N [h]}

(K − 1)!
h N [h]!}
(K − 1)!
h N [h]!}

P [h] =

(cid:111)
(K − 1)!
˜h N [˜h]!

{N [˜h]}

(cid:110)(cid:81)
(cid:34) (cid:88)
(cid:40)(cid:88)

(cid:110)(cid:81)

ˆh

{N [˜h]}

×

h

=

(cid:40)(cid:89)
(cid:40)(cid:89)
(cid:89)

h

where Dz ≡ e− 1

2 z2

2π. Then using the multinomial theorem we obtain

where(cid:80)

(84) gives us

h N [h] = K − 1 and N [h] ∈ {0, 1, . . . , K − 1}. Using above in the equation



˜h

βJ2

× e

P N [˜h][˜h]
2nρ (h+(cid:80)
(cid:111)
(K − 1)!
˜h N [˜h]!
2nρ (ˆh+(cid:80)

(cid:89)

βJ2

˜h

× e

˜h N [˜h]˜h)2

P N [˜h][˜h]

(cid:19)

n+h

(cid:35)L−1(cid:18) n

(cid:35)L−1(cid:18) n

2

n+ˆh

2

(cid:19)(cid:41)−1

˜h N [˜h]˜h)2

,(86)

Let us consider the multinomial distribution in the equation (86). Using the
12K , where |θK| < 1, we

formula K! = ρKK Ke−K with ρ0 = 1 and ρK =

2πKe

θK

√



˜h

Statistical mechanics of lymphocyte networks modelled with slow and fast variables 29

(cid:89)

˜h

˜h

obtain

=

e

(cid:17)

(K−1)P [˜h]

functional R

P N [˜h][˜h]

(cid:110)(cid:81)

˜h N [˜h] log P [˜h]

˜h log ρN [˜h]+log ρK−1

K−1 ) +const.,

where the functional D

between the distributions

(cid:80)
(cid:17)−(cid:80)
(cid:16) N [˜h]

(cid:111)
(K − 1)!
˜h N [˜h]!
(cid:81)
ρK−1(K − 1)K−1e−(K−1)
˜h ρN [˜h] N N [˜h][˜h] e−N [˜h]
(cid:16) N [˜h]
−(K−1)(cid:80)
N [˜h]
K−1 log
= e
(cid:16) N
(cid:17)
= (cid:80)
K−1||P ) − R( N
= e−(K−1)D( N
N [˜h]
K−1||P
K−1 log
(cid:17)
(cid:16) N [˜h]
(cid:17)
(cid:16) N
+(cid:80)
(cid:80)
N [h]
K−1 and P [h]. Also we have deﬁned the remainder
˜h log
(cid:110)(cid:81)
(cid:80){N [˜h]}
Let us consider the average
{(cid:81)
(cid:80){N [˜h]}
(K−1)!
˜h N [˜h]!}
{(cid:81)
(cid:80){N [˜h]} e−(K−1)D( N
(cid:80){N [˜h]} e−(K−1)D( N
K−1 +(cid:80)
(cid:80)

For K − 1 large, with the interaction J = 1
N [h]
the summands
K−1 = P [h] and is equal to e
compute the distribution (86) for large K − 1 which satisﬁes the equation

2nρ (h+(cid:80)
(cid:111)
˜h P N [˜h][˜h]
(cid:16)
h+(K−1)(cid:80)

(cid:111)
˜h P N [˜h][˜h]
(K−1)!
˜h N [˜h]!}

(cid:110)(cid:81)

K−1 , the above average is dominated by
. This allows us to

˜h P [˜h]˜h)2

2nρ ( h

K−1 ) e
K−1||P ) − R( N

θN [˜h]/(K−1)
12N [˜h]/(K−1)

K−1||P ) − R( N

is a KL distance

˜h N [˜h]˜h)2

(K−1)P [˜h]

K−1

= 1
2

N [˜h]
K−1

˜h

˜h

βJ2

e

(cid:17)2

K−1

˜h

K−1 )

(87)

.

βJ2
2nρ

(88)

=

β

P [h] =

(89)

(K−1)2 +2

h

(K−1)

˜h P [˜h]˜h

(K−1)2 +2

ˆh

(K−1)

˜h P [˜h]˜h

(cid:80)

(cid:17)(cid:0) n
(cid:1)
(cid:17)(cid:0) n

h+n

2

n+ˆh

(cid:1) .

e

(cid:80)

β

2nρ (L−1)

(cid:16) h2
(cid:16) ˆh2
2nρ (L−1)
(cid:80)

β

ˆh e

2

when K − 1 → ∞, so this limit is

)

( n
)
ˆh+n
2
ˆh ( n
ˆh+n

2

From the above it is clear that P [h] =

equivalent to the inﬁnite temperature regime β = 0 and the T-clones are unable to
control the B-clones.

4. Discussion

In this paper we studied the lymphocyte network model of adaptive immune system.
We ﬁrst derived dynamic equation for the B cell clones (B clones), which is a function
of T cell clones (T clones) and antigen, and then we assumed that the Hamiltonian
of this dynamic equation is also governs dynamics of T clones. Furthermore, we
assumed that the dynamics of B clones and T clones is subject to diﬀerent thermal
noises and also that they evolve on diﬀerent timescales. The latter assumption allows
to compute the stationary distribution of this process in the limit of inﬁnite separation
of timescales which corresponds to the equilibration scenario when the fast (slow) B cell
clone variables are interacting with the slow (fast) T clone variables. The stationary

Statistical mechanics of lymphocyte networks modelled with slow and fast variables 30

˜β

distribution is then used to compute the average density of B clone sizes and the
thermal averages of other macroscopic observables.
To simplify the analysis we consider the scenario when T clones (or T cells ) are
modelled by the Ising spin variables {−1, 1} and binary variables {0, 1}. The former
corresponds to the activated helper, modelled by +1, and regulator, modelled by −1, T
cells and the latter corresponds to the inactive, modelled by 0, and active, modelled by
+1, T helper cells. We show that in the fast B clone equilibration regime and in the fast
T clone equilibration regime, with the ratio of B clone noise to T clone noise parameter
β ∈ Z+, the behaviour of T cells is governed by the equilibrium distribution of
n =
n × N interacting Ising spins in the ferromagnetic model with inverse temperature β
J 2
µ
and interactions
ρ . The consequences of this is that there are network topologies
for which there exists the critical noise βc such that for β > βc the fraction of helper
(regulator) T cells is a monotonic function of the Ag concentration. Furthermore,
we show that in the fast B clone equilibration regime the average B cell clone size
(or average B cell concentration), (cid:104)c(cid:105), is a monotonic increasing (decreasing) function
of the fraction of helper (regulator) T cells m+ (m−). We note that this result is
consistent with the experimental data [27, 20]. Unfortunately, at present we are unable
to carry out such an independent of the network topology analysis for the fast T clone
equilibration regime with n ∈ R+.

N is equals to α = L

Obtaining distributions of B clone sizes, P (c), requires a more detailed knowledge
about the topology of networks. Assuming that these topologies are locally equivalent
to trees we use the Bethe-Peierls (BP) approximation to derive the equations for the
distribution P (c) and other observables in the models deﬁned on random networks.
We solve these equations for the case when the model is homogeneous (Jµ = J for
all µ) and is deﬁned on a random regular graph where each B clone is connected to
exactly K T-cells and each T cell is connected to exactly L B-clones; here the ratio
of B clones to T cells α = M
K . We study this model in the fast B
cell clone equilibration regime and in the fast T cell clone equilibration regime with
n ∈ Z+ and ˜β → ∞. We ﬁnd that in the regime of fast B cell clone equilibration
the distribution P (c) in the “overregulated” (m− = 0.9) immune response regime is
diﬀerent from the distribution in the “normal” (m− = 0.1) immune response regime:
it behaves as a “power law” when m− = 0.9. We note that the latter value corresponds
to the “branch” of the phase diagram (see Figure 4) where the “signal” from the T
cells to the B cell clones is predominantly suppressive (see Figure 8). We envisage
that in the real immune system such a situation can occur when the B cell clones are
self-reactive which is possible in the immune response to tumours [22].
For the same model we ﬁnd that in the fast T clone equilibration regime with
n ∈ Z+ the average B cell concentration (cid:104)c(cid:105) is still a monotonic function of the average
fraction of T regulator cells m− but it is both increasing and decreasing (see Figure
11). We note that such a behaviour is seems to be quite counterintuitive but, perhaps,
can not be ruled out [39]. The region where (cid:104)c(cid:105) is increasing with m− is shrinking
as n getting larger and completely vanishes as n → ∞ (see Figure 6). We also study
the regimes when α → ∞ (‘large” B cell number limit) and α → 0 (“large” T cell
number limit) with the rescaled, for technical reasons, interactions J 2 = 1
L−1 and
J = 1
K−1 respectively. We ﬁnd that in both of these regimes B clones are operating
independently of T cells. In the regime of α → ∞ we ﬁnd the response of T cells to
Ag is following the same phase transition pattern as in the Figure 4. Also, in this
regime the “cavity” distribution equation (56) simpliﬁes signiﬁcantly and much can

Statistical mechanics of lymphocyte networks modelled with slow and fast variables 31

be learned about this equation analytically (for ﬁnite K, L and n > 1 we were unable
to ﬁnd an explicit solution to this equation even in the “simple” high temperature
phase). The regime of α → 0 is equivalent to the inﬁnite temperature regime where
T cells are insensitive to the Ag stimulation.
In future we plan to compute phase diagram for the model in the fast T clone
equilibration regime with n ∈ R+. A good starting point here would be to consider
the regular case (see Appendix E). Also, it would interesting to consider the case when
we the fraction T regulator cells is ﬁxed and all T cells could be active or inactive,
i.e. the case of σi ∈ {0, 1} and ξi ∈ {−1, 1}. Here one could assume that that the
networks and interactions are random and compute the phase diagrams by solving the
equation (67) by population dynamics. In order to model the aﬃnity maturation one
can also assume that, in addition to B clones and T clones, the interactions Jµ are also
evolving in time and use the slow (or fast) variable assumptions to compute stationary
distributions of the process. However, the most important would be to connect the
theoretical framework developed in this article with the concrete experimental data.

Acknowledgements

The authors are indebted to Deborah Dunn-Walters, Franca Fraternali, Victoria
Martin and Joselli Silva O’Hare for their invaluable assistance and very enlightening
discussions. AM also would like to thank Alessia Annibale, Adriano Barra, Elena
Agliari and Silvia Bartolucci for very interesting discussions. This work was supported
by MRC (MR/L01257X/1).

References

[1] Charles Janeway, Kenneth P Murphy, Paul Travers, and Mark Walport.

Janeway’s

Immunobiology. Garland Science, 2012.

[2] Jos´e AM Borghans, Andr´e J Noest, and Rob J De Boer. How speciﬁc should immunological

memory be? The Journal of Immunology, 163(2):569–575, 1999.

[3] Abner Louis Notkins. Polyreactivity of antibody molecules. Trends in Immunology, 25(4):174

– 179, 2004.

[4] Jordan D Dimitrov, Cyril Planchais, Lubka T Roumenina, Tchavdar L Vassilev, Srinivas V
Kaveri, and Sebastien Lacroix-Desmazes. Antibody polyreactivity in health and disease:
statu variabilis. The Journal of Immunology, 191(3):993–999, 2013.

[5] Alan S. Perelson and G´erard Weisbuch. Immunology for physicists. Rev. Mod. Phys., 69:1219–

1268, 1997.

[6] Arup K Chakraborty and Andrej Koˇsmrlj. Statistical mechanical concepts in immunology.

Annual review of physical chemistry, 61:283–303, 2010.

[7] G Parisi. A simple model for the immune network. Proceedings of the National Academy of

Sciences, 87(1):429–433, 1990.

[8] Elena Agliari, Adriano Barra, Francesco Guerra, and Francesco Moauro. A thermodynamic

perspective of immune capabilities. J. Theor. Biol., 287:48–63, 2011.

[9] E Agliari, A Annibale, A Barra, A C C Coolen, and D Tantari. Immune networks: multitasking

capabilities near saturation. J. Phys. A: Math. Theor., 46(41):415003, 2013.

[10] Tatsuya Uezu, Chihiro Kadono, Jon Hatchett, and Anthony CC Coolen. A large scale dynamical
system immune network model with ﬁnite connectivity. Progress of Theoretical Physics
Supplement, 161:385–388, 2006.

[11] Silvia Bartolucci and Alessia Annibale. A dynamical model of the adaptive immune system:
eﬀects of cells promiscuity, antigens and b-b interactions. J. Stat. Mech. Theory Exp.,
2015(8):P08017, 2015.

[12] Thierry Mora, Aleksandra M. Walczak, William Bialek, and Curtis G. Callan. Maximum
entropy models for antibody diversity. Proceedings of the National Academy of Sciences,
107(12):5405–5410, 2010.

Statistical mechanics of lymphocyte networks modelled with slow and fast variables 32

[13] Anand Murugan, Thierry Mora, Aleksandra M Walczak, and Curtis G Callan. Statistical
inference of the generation probability of t-cell receptors from sequence repertoires.
Proceedings of the National Academy of Sciences, 109(40):16161–16166, 2012.

[14] Yuval Elhanati, Zachary Sethna, Quentin Marcou, Curtis G. Callan, Thierry Mora,
and Aleksandra M. Walczak.
Inferring processes underlying b-cell repertoire diversity.
Philosophical Transactions of the Royal Society of London B: Biological Sciences, 370(1676),
2015.

[15] Ken R Duﬀy, Cameron J Wellard, John F Markham, Jie HS Zhou, Ross Holmberg, Edwin D
Hawkins, Jhagvaral Hasbold, Mark R Dowling, and Philip D Hodgkin. Activation-induced
b cell fates are selected by intracellular stochastic competition. Science, 335(6066):338–341,
2012.

[16] Daniel R. Bush and Amit K. Chattopadhyay. Contact time periods in immunological synapse.

Phys. Rev. E., 90:042706, 2014.

[17] RW Penney, ACC Coolen, and D Sherrington. Coupled dynamics of fast spins and slow
interactions in neural networks and spin systems. J. Phys. A: Math. Gen., 26(15):3681,
1993.

[18] Dmitry I Strokotov, Maxim A Yurkin, Konstantin V Gilev, Dirk R Van Bockstaele, Alfons G
Is there a diﬀerence between t-and

Hoekstra, Nikolay B Rubtsov, and Valeri P Maltsev.
b-lymphocyte morphology? Journal of biomedical optics, 14(6):064036–064036, 2009.

[19] Steven Z Josefowicz, Li-Fan Lu, and Alexander Y Rudensky. Regulatory t cells: mechanisms of

diﬀerentiation and function. Annual review of immunology, 30:531–564, 2012.

[20] Ine Vanderleyden, Michelle A Linterman, and Kenneth GC Smith. Regulatory t cells and control

of the germinal centre response. Arthritis research & therapy, 16(5):471, 2014.

[21] Julia A Coronella, Catherine Spier, Matthew Welch, Katrina T Trevor, Alison T Stopeck, Hugo
Villar, and Evan M Hersh. Antigen-driven oligoclonal expansion of tumor-inﬁltrating b cells
in inﬁltrating ductal carcinoma of the breast. The Journal of Immunology, 169(4):1829–1836,
2002.

[22] Weiping Zou. Regulatory t cells, tumour immunity and immunotherapy. Nature Reviews

Immunology, 6(4):295–307, 2006.

[23] Yu-Chang Bryan Wu, David Kipling, and Deborah K Dunn-Walters. Age-related changes
in human peripheral blood igh repertoire following vaccination. Frontiers in Immunology,
3(193), 2012.

[24] ACC Coolen, RW Penney, and D Sherrington. Coupled dynamics of fast spins and slow

interactions: An alternative perspective on replicas. Phys. Rev. B., 48(21):16116, 1993.

[25] Mark I Freidlin and Alexander D Wentzell. Random perturbations of dynamical systems, volume

260. Springer Science & Business Media, 2012.

[26] Freddy Bouchet, Tobias Grafke, Tom´as Tangarife, and Eric Vanden-Eijnden. Large deviations

in fast–slow systems. Journal of Statistical Physics, pages 1–20, 2015.

[27] Dirk Baumjohann, Silvia Preite, Andrea Reboldi, Francesca Ronchi, K Mark Ansel, Antonio
Lanzavecchia, and Federica Sallusto. Persistent antigen and germinal center b cells sustain t
follicular helper cell responses and phenotype. Immunity, 38(3):596–605, 2013.

[28] R. J. Baxter. Exactly Solved Models in Statistical Mechanics. Academic Press, 1982.
[29] Cyril Domb and Melville S Green. Phase Transitions and Critical Phenomena: Volume 1.

Academic Press, 1972.

[30] Segun Goh, H. W. Kwon, M. Y. Choi, and J.-Y. Fortin. Emergence of skew distributions in

controlled growth processes. Phys. Rev. E., 82:061115, 2010.

[31] Nicolaas Govert De Bruijn. Asymptotic methods in analysis, volume 4. Courier Corporation,

1970.

[32] Thomas Charles Butler, Mehran Kardar, and Arup K Chakraborty. Quorum sensing allows
t cells to discriminate between self and nonself. Proceedings of the National Academy of
Sciences, 110(29):11833–11838, 2013.

[33] M M´ezard and A Montanari. Information, physics, and computation. Oxford University Press,

2009.

[34] Alexander Mozeika and Anthony C C Coolen. Spin systems on hypercubic bethe lattices: a

bethe-peierls approach. J. Phys. A: Math. Theor., 48(25):255001, 2015.

[35] A Dembo and A Montanari.

Ising models on locally tree-like graphs. The Annals of Applied

Probability, 20(2):565–592, 2010.

[36] Herbert Robbins. A remark on stirling’s formula. American Mathematical Monthly, pages

26–29, 1955.

[37] Thomas M Cover and Joy A Thomas. Elements of information theory. John Wiley & Sons,

2012.

Statistical mechanics of lymphocyte networks modelled with slow and fast variables 33

[38] Robert B Griﬃths, Charles A Hurst, and Seymour Sherman. Concavity of magnetization of an

ising ferromagnet in a positive external ﬁeld. J. Math. Phys., 11(3):790–795, 1970.

[39] Silvia Preite, Dirk Baumjohann, Mathilde Foglierini, Camilla Basso, Francesca Ronchi, Blanca
M Fernandez Rodriguez, Davide Corti, Antonio Lanzavecchia, and Federica Sallusto. Somatic
mutations and aﬃnity maturation are impaired by excessive numbers of t follicular helper cells
and restored by treg cells or memory t cells. European journal of immunology, 45(11):3010–
3021, 2015.

Appendix A. Analysis of (cid:104)eF/nρ(cid:105)β function

In this section we study how the average

(cid:104)eF/nρ(cid:105)β =

P (σ1, . . . , σn)

where Fµ(σα) = Jµ
µ), is behaving as a function of β. In particular we are interested in the derivative

i ∈ {−1, 1} (Jµ ≥ 0 and θµ ≥ 0 for all

i∈∂µ σα

with σα

i + θµ

is a subset of the set [(cid:96)] = {1, . . . , (cid:96)},

j=1 Fν(σαj ) as sums we obtain the equation

(A.5)

to rewrite the products

(cid:88)
M(cid:88)

{σα}

ν=1

=

1
M

(cid:16)(cid:80)

2nρ

∂
∂β

(cid:104)eF/nρ(cid:105)β =

1
M

α=1Fν (σα)

(cid:80)n

α=1Fν (σα)

1
nρ

α=1Fµ(σα))2
e

(A.1)

,

α=1 Fµ( ˜σα))2

(cid:43)
(cid:80)n
α=1Fν (σα)(cid:69)(cid:41)
(cid:80)n

α=1Fν (σα)

1
nρ

e

1
nρ

e

.(A.2)

(cid:80){σα}e
(cid:17)

β

β

e

2nρ

2nρ

1
nρ

ν=1

1
M

(cid:80)n

M(cid:88)
(cid:80)M
µ=1((cid:80)n
(cid:80){ ˜σα} e
µ=1((cid:80)n
(cid:80)M
(cid:33)2
(cid:40)(cid:42)(cid:32) n(cid:88)
(cid:88)
(cid:33)2(cid:43)(cid:68)
(cid:42)(cid:32) n(cid:88)
(cid:33)(cid:96)
(cid:32) n(cid:88)

Fµ(σα)

Fµ(σα)

α=1

α=1

ν,µ

1

Fν(σα)

−

(nρ)(cid:96)(cid:96)!

(cid:96)≥0

α=1

(A.3)

(cid:33)(cid:96)(cid:43)

(cid:33)2(cid:32) n(cid:88)
(cid:33)(cid:96)(cid:43)(cid:41)

α=1

Fµ(σα)

Fν(σα)

Fµ(σα)

Fν(σα)

.

(A.4)

Using the power series representation

(cid:80)n
α=1Fν (σα) =

1
nρ

e

(cid:88)

this derivative can be written as the inﬁnite sum

2nρ

∂
∂β

=

1
M

1

(cid:96)≥0

(cid:104)eF/nρ(cid:105)β

(nρ)(cid:96)(cid:96)!

(cid:88)
(cid:42)(cid:32) n(cid:88)
(cid:88)

−

α=1

ν,µ

α=1

(cid:40)(cid:42)(cid:32) n(cid:88)
(cid:88)
(cid:33)2(cid:43)(cid:42)(cid:32) n(cid:88)
θ(cid:96)−|S(cid:96)| (cid:89)

xj,

α=1

S(cid:96)⊆[(cid:96)]

j∈S(cid:96)

Finally, using the identity

(cid:96)(cid:89)
α=1Fν(σα))(cid:96) =(cid:80)
((cid:80)n

where S(cid:96)

j=1

(xj + θ) =

(cid:81)(cid:96)

α1,...,α(cid:96)
∂
∂β

(cid:104)eF/nρ(cid:105)β

2nρ

Statistical mechanics of lymphocyte networks modelled with slow and fast variables 34

1

=

(cid:96)≥0

1
M

S2⊆[2]

(nρ)(cid:96)(cid:96)!

(cid:88)
(cid:88)
(cid:88)
(cid:88)
(cid:89)
(cid:40)(cid:42)(cid:89)
(cid:88)
× (cid:88)
(cid:88)
(cid:43)(cid:42)(cid:89)
(cid:42)(cid:89)
(cid:88)
(cid:88)

J 2
µ J (cid:96)

ik∈∂µ

S(cid:96)⊆[(cid:96)]

k∈S2

α1,...,α(cid:96)

σγk
ik

j∈S(cid:96)

γ1,γ2

−

ν,µ

σγk
ik

µ

ν θ2−|S2|
(cid:88)

ij∈∂ν

σαj
ij

ν

θ(cid:96)−|S(cid:96)|

(cid:43)
(cid:43)(cid:41)

σαj
ij

.

k∈S2

ik∈∂µ

j∈S(cid:96)

ij∈∂ν

(A.6)

(cid:80)M
µ=1 ((cid:80)n

Now, by the GKS theorem, the correlation terms in the above sum are positive from
∂β(cid:104)eF/nρ(cid:105)β ≥ 0 and hence the average (cid:104)eF/nρ(cid:105)β is a monotonic
which follows that ∂
non-decreasing function of β.
The distribution P (σ1, . . . , σn) used in the deﬁnition (A.1) can be written
in the canonical form P (σ1, . . . , σn) ∝ e−βE(σ1,...,σn), where E(σ1, . . . , σn) =
− 1
α=1 Fµ(σα))2 is energy function. Then the speciﬁc heat (density)
C(β) = d
dT

(cid:10)E(σ1, . . . , σn)(cid:11), where T = 1
M(cid:88)

(cid:110)(cid:10)E2(σ1, . . . , σn)(cid:11) −(cid:10)E(σ1, . . . , σn)(cid:11)2(cid:111)
(cid:19)2 1
(cid:18) β

(cid:40)(cid:42)(cid:32) n(cid:88)

β , is given by the equation

C(β) =

β2
N

2nρ

1
N

=

2nρ

N

µ=1

α=1

−

(cid:33)2(cid:43)2(cid:41)

Fµ(σα)

.

(A.7)

(cid:33)4(cid:43)
(cid:42)(cid:32) n(cid:88)

Fµ(σα)

equation (A.4) we note

∂β(cid:104)eF/nρ(cid:105)β = 2N

β2M C(β) + ···. As N → ∞, with 0 < N

Comparing above with the
2nρ ∂
ciﬁc heat C(β) is diverging in some systems, such as ferromagnetic Ising model on
d-dimensional lattice, or in some systems, such as ferromagnetic Ising model on ran-
dom trees, it jumps when β → β−

M < ∞, then the spe-

the derivative

c or β → β+
c .

that

α=1

Appendix B. Computation on a factor tree for n ∈ Z+
Let us assume that the system (37) is deﬁned on a factor tree Tµ(r) of radius r rooted
at the factor-node µ (see Figure B1). Then the distribution of (replicated) ﬁeld on µ

Pµ(F ) =

P (σ1, . . . , σn) δ

Fµ(σα)

(B.1)

(cid:32)
F − n(cid:88)

α=1

(cid:33)

{σα}

(cid:88)
(cid:88)
2nρ F 2 (cid:88)
(cid:32)
F − n(cid:88)

2nρ

{σi:i∈Tµ}

× δ

e

β

β

{σi:i∈Tµ}

(cid:80)

α=1 Fν (σα))2

δ

ν∈Tµ((cid:80)n
(cid:80)
ν∈Tµ\µ((cid:80)n
(cid:33)

2nρ

e

β

Fµ(σα)

α=1

(cid:33)

Fµ(σα)

(cid:32)
F − n(cid:88)

α=1

α=1 Fν (σα))2

Zµ(F ) =

= e

can be computed recursively as follows. Firstly, we compute the “partition” function

Statistical mechanics of lymphocyte networks modelled with slow and fast variables 35

µ

σi

ν

σj

Figure B1. The interaction topology of a replicated spin system on a factor-
tree Tµ rooted at factor-node µ. All spins are represented by circular “variable”
nodes, and each term in the “Boltzmann factor” e
=
Fν ({σj : j ∈ ∂ν}) corresponds to a square “factor” node. A link between

(cid:80)
ν∈Tµ ((cid:80)n

α=1 Fν (σα))2

(cid:81)

2nρ

β

ν∈Tµ

variable node (cid:96) and factor node ν implies that σ(cid:96) acts as an argument of Fν .

β

2nρ F 2

(cid:89)
(cid:32)
F − n(cid:88)
2nρ F 2 (cid:88)

i∈µ

α=1

β

× δ

{σj :j∈Ti}

(cid:88)
(cid:89)

i∈µ

Fµ(σα)

{σi:i∈∂µ}

= e

= e

β

2nρ

e

(cid:33)

(cid:80)

ν∈Ti((cid:80)n

α=1 Fν (σα))2



 δ

(cid:32)
F − n(cid:88)

α=1

(cid:33)

Fµ(σα)

, (B.2)

Zµi[σi]

where in above we deﬁned factor tree Ti (of radius r − 1) rooted at variable node i.
The partition function Zµ(F ) can be used to construct the distribution of ﬁeld

Pµ(F ) =

=

Zµ(F )
˜F Zµ( ˜F )

(cid:80)
(cid:110)(cid:81)
2nρ F 2(cid:80){σi:i∈∂µ}
(cid:110)(cid:81)
(cid:80){ ˜σi:i∈∂µ}

e

β

(B.3)

(cid:111)
δ (F −(cid:80)n
2nρ ((cid:80)n

β

(cid:111)

α=1 Fµ(σα))

α=1 Fµ( ˜σα))2

i∈µ Zµi[σi]

i∈µ Zµi[ ˜σi]

e

which, if we deﬁne the “cavity”, i.e.
distribution

the edge (i, µ) is removed (see Figure B1),

Pµi[σ] =

,

(B.4)

(cid:80)

Zµi[σ]
˜σ Zµi[ ˜σ]

Statistical mechanics of lymphocyte networks modelled with slow and fast variables 36

gives us the equation (55).

Secondly, we compute the partition function

Using above with in the deﬁnition (B.4) gives us the equation (56).

Finally, we note that the partition function

(B.5)

α=1 Fν (σα))2

ˆν∈Tj ((cid:80)n

α=1 Fˆν (σα))2

δσ;σi

β

2nρ

e

α=1 Fν (σα))2

δσ;σi

(cid:80)
ν∈Ti((cid:80)n
(cid:80)
ν∈∂j\µ((cid:80)n

β

β

e

e

2nρ

2nρ

j∈∂ν\i

(cid:89)
(cid:80)
ν∈∂i\µ((cid:80)n
(cid:80)
(cid:89)

α=1 Fν (σα))2

 δσ;σi.

Zνj[σj]

ν∈∂i\µ

j∈∂ν\i

β

2nρ

ν∈Ti((cid:80)n
(cid:80)
(cid:89)
µ((cid:80)

j∈∂µ\i

Zµj[σj]



α=1 Fν (σα))2

δσ;σi

(cid:80)n

(cid:80)n

Zµi[σ] =

=

=

Zi(σ) =

=

β

e

2nρ

ν∈∂i\µ

{σj :j∈Ti}

{σj :j∈Ti}

(cid:88)
(cid:88)
× (cid:89)
(cid:88)
 (cid:89)
(cid:88)
(cid:89)
(cid:88)

{σj}

×

e

{σj :j∈Ti}

{σj}
× e

µ∈∂i

(cid:80)

β

Zi(σ)(cid:80)

˜σ Zi( ˜σ)

, (B.6)
which is deﬁned on a factor-tree Ti(R) rooted at the variable node i, can be used to
construct the distribution

2nρ

j

µ∈∂i J 2

j∈∂µ\i ξµ

α=1 σα

j +ξµ

i

α=1 σα+θµ))2

(cid:80)

σ Pi(σ) 1

n

Pi(σ) =

(cid:80)n

the
α=1 σα .

which gives us

equation (57)

for

the

(B.7)
local magnetization (cid:104)σi(cid:105) =

Appendix C. Computation on a factor tree for n ∈ R+

Let us assume that the distribution (33), which is given by the equation

P (b) = Z−1e

− 1

(cid:16)

2 ρnβ(cid:80)M
× en(cid:80)N

(cid:17)2
i=1 log 2 cosh(β(cid:80)

bµ− Jµ θµ

µ=1

ρ

(C.1)
when it is adopted to the Ising case σi ∈ {−1, 1}, is deﬁned on a factor-tree Tµ(r) of
radius r rooted at the variable-node µ (see Figure C1). Then to compute the marginal
distribution

µ∈∂i bµJµξµ
i )

Pµ(b) =

P (b) δ(b − bµ) db

(C.2)

we consider the partition function

(cid:90) ∞

dbν

−∞

 δ (b − bµ) e

2 ρnβ(cid:80)

− 1

ν∈Tµ(bν− Jν

ρ θν)2

(cid:90)
(cid:89)

ν∈Tµ

Zµ(b) =

Statistical mechanics of lymphocyte networks modelled with slow and fast variables 37

bµ

bν

i

j

(cid:16)

(cid:110)(cid:81)

mann factor” e

2 ρnβ(cid:80)

Figure C1. The interaction topology of a replicated system of real val-
ued spins on a factor-tree Tµ rooted at variable-node µ.
All spins are
log 2 cosh(β(cid:80)
represented by circular “variable” nodes, and each term in the “Boltz-

=
corresponds to a small ﬁlled (used to
represent f (bν )) or large unﬁlled (used to represent Fi) square “factor” node. A
link between variable node ν and factor node i implies that bν acts as an argument
of Fi.

(cid:17)2
+n(cid:80)
(cid:111)
ν∈Tµ
Fi({bν : ν ∈ ∂i})

ν∈∂i Jν ξν

ν∈Tµ

b− Jν

i∈Tµ

f (bν )

i∈Tµ

i bν )

ρ θν

2 cosh

i bν

− 1

= e

b− Jµ

ρ θµ

dbν

−∞

i bν

β

ν∈∂i

ν∈Tµ

Jνξν

(cid:90) ∞

(cid:32)
(cid:88)
(cid:89)
(cid:17)2
(cid:32)
(cid:88)
(cid:32)
(cid:88)
(cid:89)
(cid:90) ∞

ρ θν)2

Jνξν

(cid:17)2

ν∈∂i

ν∈Tµ

β

β

(cid:33)n
 δ (b − bµ)
(cid:33)n
(cid:33)n
 δ (b − bµ)

2 cosh

Jνξν

i bν

dbν

−∞

− 1

(cid:16)

i∈Tµ

(cid:111)(cid:110)(cid:81)
(cid:89)
(cid:89)
 (cid:89)

i∈∂µ
− 1

2 ρnβ

×

×

× e
×

2 cosh

2 ρnβ(cid:80)

ν∈∂i
ν∈Tµ\µ(bν− Jν

i∈Tµ\∂µ

(cid:16)

− 1

2 ρnβ

= e

b− Jµ

ρ θµ

(cid:17)2

(cid:16)

ρ θˆν

bˆν− Jˆν

(cid:33)n
n(cid:41)
(cid:90) ∞
(cid:88)

−∞

Jνξν

i bν

Jνξν

i bν

ˆν∈Tν

Jˆνξ ˆν

j bˆν

(cid:89)
(cid:32)

β

ν∈∂i\µ



Zνi[bν]dbν

(cid:33)n

ν∈∂i

 e
(cid:88)

ν∈∂i

Zνi[bν]dbν

(cid:32)

β

Zνi[˜bν]d˜bν

ρ θµ)2

− 1

i bν

Jνξν

2 ρnβ(b− Jµ

(cid:33)n

(cid:90) ∞
(cid:33)n(cid:35)−1

−∞

d˜bµe

2 cosh

β

Jνξν
i

˜bν

ν∈∂i

δ (b − bµ) (C.3)

(C.4)

δ (b − bµ)

− 1

2 ρnβ(˜bµ− Jµ

ρ θµ)2

(C.5)

Now if in the above we use the deﬁnition

then this gives us the equation (61).
In order to derive the equation for the distribution Pνi[b] we compute the partition
function, associated with the factor-tree Tν of radius r − 1 (see Figure C1), as follows

(cid:41)
(cid:41)

dbˆν

ˆν∈Tν

dbˆν

δ (b − bν)
ρ θˆν )2+n(cid:80)

(bˆν− Jˆν

− 1

2 ρnβ(b− Jν

ρ θν )2

e

j∈Tν

log 2 cosh(β(cid:80)
δ (b − bν)

ˆν∈∂j Jˆν ξ ˆν

j bˆν)

Statistical mechanics of lymphocyte networks modelled with slow and fast variables 38

which gives us the marginal via the eqation

(cid:32)

e

β

− 1

ν∈∂i

(cid:17)2

i∈∂µ

ˆν∈∂j

2 cosh

(cid:40)

(cid:88)
2 ρnβ(cid:80)
β
(cid:88)
(cid:89)
(cid:89)
(cid:90) ∞
(cid:89)
(cid:89)
(cid:32)

(cid:90) ∞
(cid:88)

2 cosh

i∈∂µ

i∈∂µ

−∞

−∞

ν∈∂i\µ

2 cosh

(cid:89)

ν∈∂i\µ

2 cosh

i∈∂µ

×

i∈∂µ

(cid:89)
× (cid:89)
(cid:89)
(cid:90) ∞

2 ρnβ

×

− 1

(cid:16)

j∈Tν

×

= e

b− Jµ

ρ θµ

dbµ

−∞

ν∈∂i\µ

−∞ d˜b Zµ(˜b)

×

×

dbµ

−∞

i∈∂µ

i∈∂µ

Zµ(b)

(cid:89)

(cid:82) ∞
(cid:89)
(cid:90) ∞
(cid:34)(cid:89)
(cid:89)
(cid:82) ∞
(cid:40)(cid:89)
(cid:90) ∞
2 ρnβ(cid:80)
(cid:40)(cid:89)
(cid:90) ∞

ˆν∈Tν
× e
− 1

Zνi[b]

i∈∂µ

−∞

×

ˆν∈Tν

−∞

−∞ Zνi[˜b]d˜b

Pµ(b) =

=

Pνi[b] =

Zνi[b] =

=

Statistical mechanics of lymphocyte networks modelled with slow and fast variables 39

×

j∈∂ν\i

 (cid:89)
× (cid:89)
(cid:40)(cid:89)
 (cid:89)
 (cid:89)

j∈∂ν\i

(cid:96)∈Tˆν

×

×

j∈∂ν\i

2 cosh

(cid:89)

ˆν∈∂j\ν

(cid:89)

ˆν∈∂j\ν

Jˆνξ ˆν

j bˆν

v∈Tˆν

ρ θv)2

(bv− Jv

n
(cid:33)(cid:41)n(cid:41)
 e

− 1

e

− 1

ˆν∈∂j

β
(cid:88)
(cid:40)
2 ρnβ(cid:80)
(cid:32)
(cid:88)
(cid:90) ∞
β

(cid:88)

v∈∂(cid:96)

−∞

β

log 2 cosh

Jvξv

(cid:96) bv

=

Zˆνj[bˆν]dbˆν

2 ρnβ(b− Jν

ρ θν )2

n

2 cosh

j∈∂ν\i

ˆν∈∂j\ν

Jˆνξ ˆν

j bˆν + βJνξν
j b

(C.6)

Using above in the deﬁnition (C.5) gives us the recursive equation (62) for this
distribution. Furthermore, the above approach can be used to compute any marginal
of (C.1). In particular, the joint distribution of the variables in the set {bµ : µ ∈ ∂i}

Pi({bµ : µ ∈ ∂i})

(cid:110)(cid:81)

µ∈∂i

(cid:111)

coshn(cid:16)
β(cid:80)
coshn(cid:16)
(cid:111)
β(cid:80)

(cid:82) ∞

µ∈∂i Pµi[bµ]
−∞ Pµi[˜bµ]d˜bµ

(cid:110)(cid:81)

=

µ∈∂i bµξµ

i

µ∈∂i

˜bµξµ
i

(cid:17)

(cid:17) ,

(C.7)

which we use to compute the local magnetization (64), is derived by considering the
distribution (C.1) deﬁned on a factor-tree Ti rooted at the factor-node i.

Appendix D. Analysis of n = 1 case

For n = 1 the equation (68) can be simpliﬁed further by noticing that in this case
h ∈ {−1, 1} and the distribution P [h], with h = σ, can be written in the form

P [σ] =

.

(D.1)

where φ is a “cavity ﬁeld” parameter. Using above in (68) gives us the equation

j=1 σj +σ)2

ρ ((cid:80)K−1
ρ ((cid:80)K−1

βJ2

+φ(cid:80)K−1
+φ(cid:80)K−1

j=1 σj

j=1 ˜σj +˜σ)2

j=1 ˜σj

(cid:21)L−1
(cid:105)L−1

eφσ

˜σ

1
2

1
2

βJ2

2 cosh(φ)

(cid:20)(cid:80){σj} e
(cid:104)(cid:80){˜σj} e
(cid:80)
(cid:19)
(cid:18) P [+1]
(cid:80)K−1
(cid:80)K−1

P [−1]

log

(cid:96)=0

,

˜(cid:96)=0

P [σ] =

φ =

1
2

log

L − 1

2

φ =

from which, via the identity

we can derive the recursive equation

(D.2)

(D.3)

(D.4)

 .

(cid:1)e
(cid:0)K−1
(cid:0)K−1
(cid:1)e

1
2

(cid:96)

˜(cid:96)

βJ2

ρ (2(cid:96)−K+2)2+φ(2(cid:96)−K+1)
ρ (2˜(cid:96)−K)2+φ(2˜(cid:96)−K+1)

βJ2

1
2

Statistical mechanics of lymphocyte networks modelled with slow and fast variables 40

The solution φ of the above equation can be used to compute the marginal distribution

Comparing above with the cavity distribution (D.2) gives us the magnetization formula

Also using the deﬁnition (D.1) in the distribution of ﬁelds (69) gives us the equation

˜σ

1
2

1
2

βJ2

βJ2

(cid:20)(cid:80){σj} e
(cid:104)(cid:80){˜σj} e
(cid:80)
(cid:88)

ρ ((cid:80)K−1
ρ ((cid:80)K−1
(cid:18) L
L − 1
(cid:80){σj} e
ρ F 2+φ(cid:80)K
(cid:80){˜σj} e
ρ ((cid:80)K
(cid:19)
(cid:18) P [+1]

P (σ)σ = tanh

βJ2

1
2

1
2

σ

β

j=1 σj δ

P (σ) =

m =

P (F ) =

j=1 σj +σ)2

(cid:21)L
(cid:105)L .

+φ(cid:80)K−1
+φ(cid:80)K−1

j=1 σj

j=1 ˜σj

j=1 ˜σj +˜σ)2

.

φ

(cid:19)
(cid:16)
F − J(cid:80)K
j=1 ˜σj )2+φ(cid:80)K

j=1 ˜σj

(cid:17)

j=1 σj

If we deﬁne the function

f (φ) =

log

P [−1]

1
2

(D.5)

(D.6)

.

(D.7)

(D.8)

then the recursive equation (D.4) can be written as φ = f (φ). The point φ = 0,
which corresponds to the paramagnetic (PM) m = 0 phase, is always a solution of this
equation. However this solution becomes unstable when the derivative f(cid:48)(0) = ∂
∂φ f
at φ = 0, which is given by the equation
f(cid:48)(0) = (L − 1)(K − 1)

(cid:80){σj} e
(cid:80){˜σj} e

1
2

×

βJ2

ρ ((cid:80)K−1
ρ ((cid:80)K−1

βJ2

1
2

j=1 σj)2

sinh

j=1 ˜σj)2

cosh

(cid:17)

(cid:16) βJ 2
(cid:80)K−1
(cid:16) βJ 2
(cid:80)K−1

j=1 σj

ρ

j=1 ˜σj

ρ

σ1

(cid:17) , (D.9)

is greater or equals to 1. Then the equation (D.4) also has two stable solutions φ (cid:54)= 0
which correspond to the ferromagnetic (FM) m (cid:54)= 0 phase. Solving the equation
f(cid:48)(0) = 1 gives us the critical inverse temperature βc (J = ρ = 1) where the PM to
FM transition occurs (see Figure D1). We note that for L > 2 and K = 2 the equation
(D.9) recovers the result βc = tanh
lattice.

of ferromagnetic Ising model on Bethe

−1(cid:16) 1

(cid:17)

L−1

Appendix E. n ∈ R+ regime of of homogeneous system on a random
regular factor-graph

The equations derived in the section Appendix C can be easily adopted to study the
system (C.1) which is homogeneous and deﬁned on a random regular factor-graph
(see section 3.2 for details). The marginal distribution P (b) = Pµ(b) in such system
is given by the equation

(cid:34)L−1(cid:89)

ν=1

(cid:90) ∞
(cid:34)L−1(cid:89)
(cid:90) ∞

−∞

(cid:90) ∞

(cid:32)

βJ

(cid:32)

(cid:32)L−1(cid:88)
(cid:32)L−1(cid:88)

ν=1

ν=1

(cid:33)(cid:33)(cid:35)K
(cid:33)(cid:33)(cid:35)K−1

(E.1)

P (b) = e− 1

2 ρnβb2

P [bν]dbν coshn

bν + b

×

d˜b e− 1
−∞

2 ρnβ˜b2

P [˜bν]d˜bν coshn
−∞

βJ

ν=1

˜bν +˜b

Statistical mechanics of lymphocyte networks modelled with slow and fast variables 41

βc

m = 0

m (cid:54)= 0

K

L

Figure D1. Phase diagram of ferromagnetic Ising model on random (K, L)-
regular clique graphs. Critical inverse temperature βc is plotted as a function
of the vertex degree L and factor degree K. The system is in the ferromagnetic
m (cid:54)= 0 phase for β > βc and in the paramagnetic m = 0 phase for β < βc.

and the cavity distribution P [ b ] = Pνi[ b ] can be computed recursively via the
equation

(cid:34)(cid:40)L−1(cid:89)

(cid:90) ∞

−∞

ν=1

(cid:41)

(cid:32)

(cid:32)L−1(cid:88)

(cid:33)(cid:33)(cid:35)K−1

P [bν]dbν

coshn

βJ

bν + b

(E.2)

2 ρnβ˜b2

e− 1

(cid:90) ∞

d˜b

(cid:41)

(cid:32)

P [˜bν]d˜bν

coshn

βJ

−∞

ν=1

ν=1

(cid:33)(cid:33)(cid:35)K−1(cid:41)−1

˜bν + ˜b

.

(cid:32)L−1(cid:88)

ν=1

P [ b ] = e− 1

2 ρnβb2

(cid:40)(cid:90) ∞
(cid:34)(cid:40)L−1(cid:89)

−∞

×

×

We note that the distributions P (b) and P [b] are related by the transformation
K − 1 → K.

Finally, once we know the distribution P [b] then the magnetization

(cid:104)σi(cid:105) =

(cid:110)(cid:81)L
(cid:110)(cid:81)L

µ=1

µ=1

× tanh

(cid:82) ∞
(cid:82) ∞
(cid:32)

βJ

−∞ P [bµ]dbµ
−∞ P [˜bµ]d˜bµ

(cid:33)

L(cid:88)

µ=1

coshn(cid:16)
(cid:111)
(cid:111)
coshn(cid:16)

βJ(cid:80)L
βJ(cid:80)L

µ=1 bµ
˜bµ

µ=1

(cid:17)
(cid:17)

bµ

(E.3)

Statistical mechanics of lymphocyte networks modelled with slow and fast variables 42

and the distribution of ﬁelds

P (F ) =

can be also computed.

×

−∞

−∞

j=1

ν=1

cosh

βJ

j=1

ν=1

P [bjν]dbjν

(cid:90) ∞

(cid:90) ∞

 K(cid:89)

L−1(cid:89)
 K(cid:89)
(cid:32)
(cid:32)L−1(cid:88)
×(cid:88)
eβJ(cid:80)K
j=1 σj((cid:80)L−1
(cid:16)(cid:80)L−1
(cid:16)
(cid:81)K
(cid:34) K(cid:89)

(cid:90) ∞
L−1(cid:89)
 K(cid:89)
(cid:32)

(cid:32)L−1(cid:88)

P [˜bjν]d˜bjν

j=1 cosh

{σj}

j=1

ν=1

cosh

βJ

−∞

×

×

j=1

ν=1

˜bjν + ˜b

bjν + b

ν=1 bjν +b)

βJ

ν=1 bjν + b

(E.4)



σj

K(cid:88)

j=1

db e− 1

2 ρnβb2

(cid:33)(cid:33)n
F − J
(cid:17)(cid:17) δ
(cid:90) ∞
(cid:33)(cid:33)n(cid:35)−1

d˜b e− 1

2 ρnβ˜b2

−∞

