6
1
0
2

 
r
a

 

M
4
1

 
 
]

.

R
P
h
t
a
m

[
 
 

1
v
7
0
1
4
0

.

3
0
6
1
:
v
i
X
r
a

Interpolating between random walk and rotor walk

Wilfried Huss*, Lionel Levine†, Ecaterina Sava-Huss‡

March 14, 2016

Abstract

We introduce a family of stochastic processes on the integers, depending on a
parameter 𝑝 ∈ [0, 1] and interpolating between the deterministic rotor walk (𝑝 = 0)
and the simple random walk (𝑝 = 1/2). This p-rotor walk is not a Markov chain
but it has a local Markov property: for each 𝑥 ∈ ℤ the sequence of successive exits
from 𝑥 is a Markov chain. The main result of this paper identifies the scaling limit
of the p-rotor walk with two-sided i.i.d. initial rotors. The limiting process takes
the form
𝑝 𝑋(𝑡), where 𝑋 is a doubly perturbed Brownian motion, that is, it
satisfies the implicit equation

√︁ 1−𝑝

𝑋(𝑡) = ℬ(𝑡) + 𝑎 sup
𝑠≤𝑡

𝑋(𝑠) + 𝑏 inf
𝑠≤𝑡

𝑋(𝑠)

(1)

for all 𝑡 ∈ [0,∞). Here ℬ(𝑡) is a standard Brownian motion and 𝑎, 𝑏 < 1 are constants
depending on the marginals of the initial rotors on ℕ and −ℕ respectively. Chaumont
and Doney have shown that equation (1) has a pathwise unique solution 𝑋(𝑡), and
that the solution is almost surely continuous and adapted to the natural filtration of
the Brownian motion [CD99]. Moreover, lim sup 𝑋(𝑡) = +∞ and lim inf 𝑋(𝑡) = −∞
[CDH00]. This last result, together with the main result of this paper, implies that
the p-rotor walk is recurrent for any two-sided i.i.d. initial rotors and any 0 < 𝑝 < 1.

2010 Mathematics Subject Classification. 60G42, 60F17, 60J10, 60J65, 60K37, 82C41.

Key words and phrases. Abelian network, correlated random walk, locally Markov walk,
perturbed Brownian motion, martingale, rotor-router model, scaling limit, recurrence.

1 Introduction

In a rotor walk on a graph, the exits from each vertex follow a prescribed periodic se-
In the last decade Propp [Pro03], Cooper and Spencer [CS06], and Holroyd
quence.

*Research supported by the Austrian Science Fund (FWF): J3628-N26
†Research supported by NSF grant DMS-1455272 and a Sloan Fellowship.
‡Research supported by the Austrian Science Fund (FWF): J3575-N26

1

1

INTRODUCTION

and Propp [HP10] developed close connections between the behavior of rotor walk and
the first-order properties of random walk. On finite graphs and on ℤ, rotor walk ap-
proximates the 𝑛-step distribution, stationary distribution, expected hitting times and
harmonic measure of random walk to within a bounded additive error. On other in-
finite graphs, especially in questions concerning recurrence and transience, rotor walk
can have different behavior from random walk [LL09, AH11, AH12, HS12, FGLP14,
HMSH15, FKK15].

An interesting question is how to define a modification of rotor walk that approximates
well not just the mean, but also the second and higher moments of some observables
of random walk. Propp (personal communication) has proposed an approach involving
multiple species of walkers. In the current work we explore a rather different approach to
this question. We interpolate between rotor and random walk by introducing a parameter
𝑝 ∈ [0, 1]. During one step of the p-rotor walk, if the current rotor configuration is
𝜌 : ℤ → {−1, +1} and the current location of the walker is 𝑥 ∈ ℤ, then we change the
sign of 𝜌(𝑥) with probability 1 − 𝑝, and then move the walker one step in the direction
of 𝜌(𝑥).
More formally, we define a Markov chain on pairs (𝖷𝑛, 𝜌𝑛) ∈ ℤ × {−1, +1}ℤ

by setting

{︃

𝜌𝑛+1(𝑥)
𝐵𝑛𝜌𝑛(𝖷𝑛)

for 𝑥 ̸= 𝖷𝑛,
for 𝑥 = 𝖷𝑛

𝜌𝑛+1(𝑥) =

(2)
where 𝐵0, 𝐵1, . . . are independent with 𝑃 (𝐵𝑛 = 1) = 𝑝 = 1− 𝑃 (𝐵𝑛 = −1), for all 𝑛 ∈ ℕ.
Then we set

𝖷𝑛+1 = 𝖷𝑛 + 𝜌𝑛+1(𝖷𝑛).

(3)

Here 𝜌𝑛 represents the rotor configuration and 𝖷𝑛 the location of the walker after 𝑛
steps. The parameter 𝑝 has the following interpretation: at each time step the rotor at
the walker’s current location is broken and fails to flip with probability 𝑝, independently
of the past. Note that if the walker visited 𝑥 at some previous time, then the rotor
𝜌𝑛(𝑥) indicates the direction of the most recent exit from 𝑥, but it retains no memory of
whether it was broken previously.

If 𝑝 = 1/2 then (𝖷𝑛) is a simple random walk on ℤ.

The p-rotor walk is an example of a stochastic Abelian network as proposed in [BL14].
The pair (𝖷𝑛, 𝜌𝑛) is a Markov chain, but (𝖷𝑛) itself is not a Markov chain unless 𝑝 ∈
{1/2, 1}.
If 𝑝 = 1 then (𝖷𝑛)
deterministically follows the initial rotors 𝜌0. If 𝑝 = 0 then (𝖷𝑛) is a rotor walk in the
usual sense. The aim of the current work is to prove that the p-rotor walk on ℤ with
two-sided i.i.d. configuration, when properly rescaled, converges weakly to a doubly-
perturbed Brownian motion.

1.1 Main results

We prove a scaling limit theorem for p-rotor walks (𝖷𝑛) with random initial rotor con-
figuration on ℤ as following. The two-sided initial condition we will consider depends on

2

parameters 𝛼, 𝛽 ∈ [0, 1]: the initial rotors(︀𝜌0(𝑥))︀

1

INTRODUCTION

𝑥∈ℤ are independent with

⎧⎪⎪⎪⎪⎪⎪⎪⎪⎪⎨⎪⎪⎪⎪⎪⎪⎪⎪⎪⎩

−1 with probability 𝛽, if 𝑥 < 0
with probability 1 − 𝛽, if 𝑥 < 0
1
−1 with probability 1/2, if 𝑥 = 0
with probability 1/2, if 𝑥 = 0
1
1
with probability 𝛼, if 𝑥 > 0
−1 with probability 1 − 𝛼, if 𝑥 > 0.

𝜌0(𝑥) =

(4)

That is, initially, all rotors on the positive integers point to the right with probability
𝛼 and to the left with probability 1 − 𝛼. Similarly, on the negative integers, initially all
rotors point to the left with probability 𝛽 and to the right with probability 1 − 𝛽. We
can change any finite number of rotors in the initial configuration (4), and the scaling
limit of the p-rotor walk will still be the same. See Remark 2.13 for more details. For
every 𝛼, 𝛽 ∈ [0, 1], for the configuration (4) we shall use the name (𝛼, 𝛽)-random initial
configuration.

For a continuous time process 𝑋(𝑡) we denote by

𝑋(𝑠)

𝑋 𝗌𝗎𝗉(𝑡) = sup
𝑠≤𝑡

and by 𝑋 𝗂𝗇𝖿(𝑡) = inf
𝑠≤𝑡

the running supremum and the infimum of 𝑋(𝑡) respectively. Denote by(︀ℬ(𝑡))︀

𝑡≥0 the
standard Brownian motion started at 0.
Definition 1.1. A process 𝒳𝑎,𝑏(𝑡) is called an (𝑎, 𝑏)-perturbed Brownian motion with
parameters 𝑎, 𝑏 ∈ ℝ, if 𝒳𝑎,𝑏(𝑡) is a solution of the implicit equation

𝑋(𝑠)

𝒳𝑎,𝑏(𝑡) = ℬ(𝑡) + 𝑎𝒳 𝗌𝗎𝗉

𝑎,𝑏 (𝑡) + 𝑏𝒳 𝗂𝗇𝖿

𝑎,𝑏 (𝑡)

(5)

for all 𝑡 ≥ 0.
The process 𝒳𝑎,𝑏(𝑡) has been called a doubly perturbed Brownian motion [Dav96, CPY98].
For 𝑎, 𝑏 ∈ (−∞, 1) equation (5) has a pathwise unique solution; moreover, the solution
is almost surely continuous and is adapted to the natural filtration of the Brownian
motion ℬ(𝑡) [CD99, Theorem 2]. for additional results in this direction see also For other
important properties of the doubly perturbed Brownian motion we refer to [CDH00]. We
are now ready to state our main result.
Theorem 1.2. For all 𝑝 ∈ (0, 1) and all 𝛼, 𝛽 ∈ [0, 1], the p-rotor walk (𝖷𝑛) on ℤ
with (𝛼, 𝛽)-random initial configuration as in (4), after rescaling converges weakly to an
(𝑎, 𝑏)-perturbed Brownian motion

{︂ 𝖷(𝑛𝑡)√

𝑛

}︂ 𝒟−→

{︂√︂ 1 − 𝑝

𝑝

, 𝑡 ≥ 0

}︂

𝒳𝑎,𝑏(𝑡), 𝑡 ≥ 0

as 𝑛 → ∞,

with

𝛼(2𝑝 − 1)

𝑝

𝑎 =

and

𝑏 =

𝛽(2𝑝 − 1)

𝑝

.

3

1

INTRODUCTION

Note that

1 − 𝑎 =

𝛼(1 − 𝑝) + 𝑝(1 − 𝛼)

𝑝

> 0

and 1 − 𝑏 =

𝛽(1 − 𝑝) + 𝑝(1 − 𝛽)

𝑝

> 0,

hence 𝑎, 𝑏 < 1 for all 𝑝 ∈ (0, 1) and all 𝛼, 𝛽 ∈ [0, 1], which ensures the existence and
uniqueness of the solution of the equation (5). Moreover 𝑎 and 𝑏 have the same sign:
𝑎, 𝑏 ≥ 0 if 𝑝 ≥ 1/2 and 𝑎, 𝑏 < 0 if 𝑝 < 1/2.

Doubly perturbed Brownian motion arises as a weak limit of several other discrete pro-
cesses: perturbed random walks [Dav96]; pq walks [Dav99]; asymptotically free walks
[To´t96]; and certain excited walks [DK12].
It is also a degenerate case of the “true
self-repelling motion” of To´th and Werner [TW98].

If we take 𝛽 = 0 in (4), then all rotors on the negative integers point initially towards
the origin. In this special case the perturbed Brownian motion 𝒳𝑎,𝑏 with 𝑏 = 0 has a
well-known explicit formula: it is a linear combination of a standard brownian motion
ℬ(𝑡) and its running maximum ℳ(𝑡) = sup𝑠≤𝑡 ℬ(𝑠).
Corollary 1.3. For all 𝑝 ∈ (0, 1) and all 𝛼 ∈ [0, 1], the rescaled p-rotor walk (𝖷𝑛) with
(𝛼, 0)-random initial configuration, with 𝛽 = 0 in (4), converges weakly to a one-sided
perturbed Brownian motion

as 𝑛 → ∞,

{︂ 𝖷(𝑛𝑡)√

𝑛

, 𝑡 ≥ 0

}︂ 𝒟−→

{︂√︂ 1 − 𝑝

𝑝

(︀ℬ(𝑡) + 𝜆ℳ(𝑡))︀, 𝑡 ≥ 0

}︂

where

𝜆 = 𝜆𝑝,𝛼 =

𝛼(2𝑝 − 1)

𝛼(1 − 𝑝) + 𝑝(1 − 𝛼)

.

The process arising as the scaling limit in this result has the following intuitive interpre-
tation: it behaves as a Brownian motion except when it is at its maximum, when it gets
a push up if 𝜆 > 0 or a push down if 𝜆 < 0. By symmetry, we get the same scaling limit
in the case 𝛼 = 0, with the minimum of the Brownian motion replacing the maximum
in Corollary 1.3.

The scaling limit of the p-rotor walk (Theorem 1.2) along with the fact (proved in
[CDH00]) that the doubly perturbed Brownian motion 𝒳𝑎,𝑏 satisfies lim sup𝑡→∞ 𝒳𝑎,𝑏(𝑡) =
+∞ and lim inf 𝑡→∞ 𝒳𝑎,𝑏(𝑡) = −∞ almost surely, implies the following.
Corollary 1.4. For all 𝑝 ∈ (0, 1) and all 𝛼, 𝛽 ∈ [0, 1], the p-rotor walk (𝖷𝑛) with (𝛼, 𝛽)-
random initial configuration (4) is recurrent on ℤ.

Figure 1 shows sample paths of the p-rotor walk (𝖷𝑛) in the case 𝛽 = 0 and various
extreme cases of the parameters 𝑝 and 𝛼. The parameter values and the formula for
the corresponding scaling limit appear in the corner of each picture. In the pictures on
the left (𝑝 = 0.01) the p-rotor walk takes long sequences of steps in the same direction

4

1

INTRODUCTION

Figure 1: Sample paths of the p-rotor walk 𝖷𝑛 for various extreme cases of the param-
eters 𝑝 and 𝛼. In each case 𝛽 = 0, so the scaling limit of (𝖷𝑛) is a linear combination of
a Brownian motion ℬ(𝑡) and its running maximum ℳ(𝑡).

because the rotors are rarely broken. On the right side (𝑝 = 0.99) the rotors are broken
most of the time and the walk spends most of its time trapped in a cycle alternating
between two neighboring sites, as seen in the inset in the picture on the upper right. If 𝛼
is close to 1, so that most rotors initially point to the right, then the maximum increases
slowly if 𝑝 is small (bottom left). On the other hand, for 𝑝 and 𝛼 both close to 1 (bottom
right), when the process forms a new maximum it tends to take many consecutive steps
to the right.

In the course of the evolution of the process (𝖷𝑛), the rotor configuration 𝜌𝑛 has always
a simple form. Let

𝖬𝑛 = max
𝑘≤𝑛

𝖷𝑘

and 𝗆𝑛 = min
𝑘≤𝑛

𝖷𝑘

(6)

be the running maximum and running minimum of (𝖷𝑘) up to time 𝑛 respectively. For all
𝗆𝑛 ≤ 𝑥 ≤ 𝖬𝑛, if 𝑥 ̸= 𝖷𝑛 then the rotor 𝜌𝑛(𝑥) necessarily points from 𝑥 in the direction
of 𝖷𝑛. Indeed, if 𝑥 was visited before time 𝑛 then 𝜌𝑛(𝑥) points in the direction of the

5

020000400006000080000100000−1000−500050010001500MmXmp=0.01α=0.01β=0.009.950B(t)−4.925M(t)020000400006000080000100000−100102030MmXmp=0.99α=0.01β=0.000.101B(t)+0.001M(t)17181920020000400006000080000100000−2500−2000−1500−1000−5000MmXmp=0.01α=0.99β=0.009.950B(t)−9.848M(t)02000040000600008000010000002004006008001000MmXmp=0.99α=0.99β=0.000.101B(t)+4.925M(t)1

INTRODUCTION

most recent exit from 𝑥. On the other hand, for all 𝑥 ̸∈ {𝗆𝑛, . . . , 𝖬𝑛}, the rotors remain
in their random initial state 𝜌0, see Figure 2. Hence whenever the process visits a vertex
𝑥 for the first time, there will be some perturbation if the rotor at 𝑥 initially does not
point toward the origin.

𝗆𝑛

𝖷𝑛

𝖬𝑛

Figure 2: Each rotor 𝜌𝑛(𝑥) is shown by an arrow pointing left or right from 𝑥, accordingly
as 𝜌𝑛(𝑥) is −1 or +1. The rotors in the visited interval [𝗆𝑛, 𝖬𝑛] always point towards
the current position 𝖷𝑛 of the walker.

Notation 1.5. Discrete time processes will be denoted (𝖷𝑛), (𝖸𝑛), etc., omitting the
subscript 𝑛 ≥ 0. Square brackets [·] denote an event and 1[·] its indicator. For all
probabilities related to p-rotor walks, we omit the starting point 0, writing just ℙ instead
of ℙ0. For a discrete time process (𝖷𝑛), we denote by 𝖷(𝑡) its linear interpolation to real
times 𝑡 ∈ [0,∞)

𝖷(𝑡) = 𝖷⌊𝑡⌋ + (𝑡 − ⌊𝑡⌋)(𝖷⌊𝑡⌋+1 − 𝖷⌊𝑡⌋).

√
For the scaling limit we look at the sequence of random continuous functions 𝖷(𝑘𝑡)/
𝑘 on
the interval [0,∞). Let 𝒞[0,∞) and 𝒞[0, 𝑇 ] (for 0 < 𝑇 < ∞) be the spaces of continuous
𝒟−→ for weak convergence
functions [0,∞) → ℝ and [0, 𝑇 ] → ℝ, respectively. We write
on 𝒞[0, 𝑇 ] with respect to the norm ‖𝑓‖ = sup0≤𝑡≤𝑇 |𝑓 (𝑡)|. We say that a sequence
of random functions 𝑋𝑘 ∈ 𝒞[0,∞) converges weakly to 𝑋 ∈ 𝒞[0,∞) if the restrictions
converge weakly: 𝑋𝑘|[0,𝑇 ]

𝒟−→ 𝑋|[0,𝑇 ] in 𝒞[0, 𝑇 ] for all 𝑇 > 0; see [Dur10, Page 339].

The rest of the paper is structured as follows. In Section 2 we prove the main theorem,
which is based on the decomposition of the p-rotor walk path into a martingale term and
a compensator. The compensator decomposes as a linear combination of three pieces:
𝗆𝑛, 𝖬𝑛, and 𝖷𝑛 itself.

√︁ 1−𝑝

√︁ 1−𝑝

We apply a version of the functional central limit theorem to show that the martin-
gale term converges weakly to a Brownian motion with a constant factor different from
𝑝 appears after we correct for the 𝖷𝑛 term in the

𝑝 . The true constant factor

compensator.

The proof of the scaling limit for (𝖷𝑛) requires the understanding of the scaling limit
(and recurrence) of the native case, which is the p-rotor walk with 𝛼 = 𝛽 = 0 in the
initial configuration (4). This will be done in Subsection 2.1. We conclude with several
questions and possible extensions of our model in Section 3.

6

2 Scaling limit

2 SCALING LIMIT

We decompose first the p-rotor walk into a martingale and a compensator, and we prove
that (𝖷𝑛) does not grow too fast, i.e. it is tight. A similar approach has been used in
[DK12] to deduce the scaling limit of a recurrent particular case of an excited random
walk on ℤ.
Let Δ𝑘 = 𝖷𝑘+1 − 𝖷𝑘 for 𝑘 ≥ 0 and denote by ℱ𝑘 = 𝜎(𝖷0, . . . , 𝖷𝑘) the natural filtration
of the p-rotor walk (𝖷𝑛). Then, for all 𝑛 ≥ 1 we can write

𝖷𝑛 =

𝑛−1∑︁
(︀Δ𝑘 − 𝔼[Δ𝑘|ℱ𝑘])︀

𝑘=0

Δ𝑘 = 𝖸𝑛 + 𝖹𝑛,

𝑛−1∑︁

𝑘=0

𝔼[Δ𝑘|ℱ𝑘].

and 𝖹𝑛 =

with

𝑛−1∑︁

𝑘=0

𝖸𝑛 =

(7)

(8)

Let

Since 𝜉𝑘 ∈ ℱ𝑘+1 and 𝔼[𝜉𝑘|ℱ𝑘] = 0 for all 𝑘 ≥ 0, the sequence {︀𝜉𝑘, ℱ𝑘+1

𝜉𝑘 = Δ𝑘 − 𝔼[Δ𝑘|ℱ𝑘].

𝑘≥0 is a
martingale difference sequence. Therefore the process (𝖸𝑛) is a martingale with respect
to the filtration ℱ𝑛. We will use the following functional limit theorem for martingales,
see Durrett [Dur10, Theorem 7.4].
Theorem 2.1 (Martingale central limit theorem). Suppose {𝜉𝑘,ℱ𝑘+1}𝑘≥1 is a martin-

gale difference sequence and let 𝖸𝑛 =∑︀

𝔼[︀𝜉2

]︀. If

}︀

𝑘|ℱ𝑘

1≤𝑘≤𝑛

1≤𝑘≤𝑛 𝜉𝑘 and 𝖵𝑛 =∑︀
𝑛}]︀ → 0 for all 𝜖 > 0, as 𝑛 → ∞

∑︁

𝔼[︀𝜉2

𝑘

√
1{|𝜉𝑘| > 𝜖

(a)

1
𝑛

(b)

𝖵𝑛
𝑛

1≤𝑘≤𝑛
→ 𝜎2 > 0 in probability, as 𝑛 → ∞ and

then 𝖸(𝑛𝑡)√

𝑛 converges weakly to a Brownian motion:

}︂ 𝒟−→{︀𝜎ℬ(𝑡), 𝑡 ∈ [0, 1]}︀,

, 𝑡 ∈ [0, 1]

{︂ 𝖸(𝑛𝑡)√

𝑛

as 𝑛 → ∞.

In order to prove the scaling limit theorem for (𝖷𝑛), we first look at the compensator 𝖹𝑛
in the decomposition (7) of 𝖷𝑛.

Proposition 2.2. The compensator 𝖹𝑛 in the decomposition (7) of the p-rotor walk is
equal to

𝖹𝑛 = (2𝑝 − 1)(2𝛽𝗆𝑛−1 + 2𝛼𝖬𝑛−1 − 𝖷𝑛−1),

for all 𝑛 ≥ 1.

7

2 SCALING LIMIT

Proof. Recall, from (3) that Δ𝑘 = 𝖷𝑘+1 − 𝖷𝑘 = 𝐵𝑘𝜌𝑘(𝖷𝑘) and 𝜌𝑘(𝖷𝑘) ∈ ℱ𝑘 if 𝖷𝑘 has
been already visited. If 𝖷𝑘 has not been visited before time 𝑘 ≥ 1, that is, if 𝖷𝑘 < 𝗆𝑘−1
or 𝖷𝑘 > 𝖬𝑘−1, then 𝜌𝑘(𝖷𝑘) = 𝜌0(𝖷𝑘) and thus is independent of ℱ𝑘. The working state
of the rotor 𝐵𝑘 is independent of ℱ𝑘, and we have 𝔼[𝐵𝑘] = 2𝑝 − 1. It follows that for
𝑘 ≥ 1

Using the fact that 𝗆𝑛 = −∑︀𝑛

𝖹𝑛 = 𝔼[Δ0] +

𝔼[Δ𝑘|ℱ𝑘] = (2𝑝 − 1)(1 − 2𝛽)1{𝖷𝑘 < 𝗆𝑘−1}
+ 𝔼[Δ𝑘|ℱ𝑘]1{𝗆𝑘−1 ≤ 𝖷𝑘 ≤ 𝖬𝑘−1}
+ (2𝑝 − 1)(2𝛼 − 1)1{𝖷𝑘 > 𝖬𝑘−1}.

𝑘=1

𝔼[Δ𝑘|ℱ𝑘] = (2𝑝 − 1){︀(2𝛽 − 1)𝗆𝑛−1 + (2𝛼 − 1)𝖬𝑛−1

𝑘=1

}︀

1{𝖷𝑘 < 𝗆𝑘−1} and 𝖬𝑛 =∑︀𝑛
𝑛−1∑︁

+

𝔼[Δ𝑘|ℱ𝑘]1{𝗆𝑘−1 ≤ 𝖷𝑘 ≤ 𝖬𝑘−1}.

𝑛−1∑︁

𝑘=1

1{𝖷𝑘 > 𝖬𝑘−1}, gives

On the other hand, on the event {𝗆𝑘−1 ≤ 𝖷𝑘 ≤ 𝖬𝑘−1}

𝑘=1

Δ𝑘 = Δ𝑘−11{𝐵𝑘 = −1} − Δ𝑘−11{𝐵𝑘 = 1},

with Δ𝑘−1 ∈ ℱ𝑘. It follows that

𝔼[Δ𝑘|ℱ𝑘]1{𝗆𝑘−1 ≤ 𝖷𝑘 ≤ 𝖬𝑘−1} = (1 − 2𝑝)

𝑛−1∑︁

𝑘=1

𝑛−1∑︁

𝑘=1

Δ𝑘−11{𝗆𝑘−1 ≤ 𝖷𝑘 ≤ 𝖬𝑘−1}.

Let us denote by 𝖢𝑛 the quantity

𝑛−1∑︁

𝖢𝑛 = 𝗆𝑛−1 +

Δ𝑘−11{𝗆𝑘−1 ≤ 𝖷𝑘 ≤ 𝖬𝑘−1} + 𝖬𝑛−1.

The compensator 𝖹𝑛 can then be rewritten as

𝑘=1

𝖹𝑛 = (2𝑝 − 1)(2𝛽𝗆𝑛−1 − 𝖢𝑛 + 2𝛼𝖬𝑛−1).

It remains to show that 𝖢𝑛 = 𝖷𝑛−1, for all 𝑛 ≥ 1. This is a straightforward calculation.
We have

𝑛−1∑︁

𝑘=1

Δ𝑘−11{𝖷𝑘 < 𝗆𝑘−1}

𝑛−1∑︁

𝑘=0

𝑛−2∑︁
𝑛−1∑︁
𝑛−1∑︁

𝑘=1

𝖷𝑛−1 − 𝖢𝑛 =

=

+

Δ𝑘 − 𝖢𝑛 =

Δ𝑘−1 − 𝖢𝑛

𝑘=1

Δ𝑘−11{𝗆𝑘−1 ≤ 𝖷𝑘 ≤ 𝖬𝑘−1} +

Δ𝑘−11{𝖷𝑘 > 𝖬𝑘−1} − 𝖢𝑛.

𝑘=1

8

2 SCALING LIMIT

On the event {𝖷𝑘 < 𝗆𝑘−1}, we have that 𝖷𝑘−1 = 𝗆𝑘−1 and Δ𝑘−1 = −1. On the event
{𝖷𝑘 > 𝖬𝑘−1}, we have that 𝖷𝑘−1 = 𝖬𝑘−1 and Δ𝑘−1 = 1. Therefore

𝖷𝑛−1 − 𝖢𝑛 = − 𝑛−1∑︁

𝑛−1∑︁

1{𝖷𝑘 < 𝗆𝑘−1} +

1{𝖷𝑘 > 𝖬𝑘−1} − 𝗆𝑛−1 − 𝖬𝑛−1 = 0,

𝑘=1

𝑘=1

which completes the proof.
Proposition 2.3. For all 𝑝 ∈ (0, 1) and all 𝛼, 𝛽 ∈ [0, 1], the p-rotor walk (𝖷𝑛) with
(𝛼, 𝛽)-random initial configuration 𝜌0 as in (4) satisfies:

𝖷𝑛 = 𝖶𝑛 + 𝑎𝖬𝑛 + 𝑏𝗆𝑛, for all 𝑛 ≥ 1,

with

and 𝖶𝑛 given by

𝛼(2𝑝 − 1)

𝑝

𝑎 =

𝖶𝑛 =

1
2𝑝

𝛽(2𝑝 − 1)

and

𝑏 =

(︀𝖸𝑛+1 − Δ𝑛

𝑝

)︀.

(9)

(10)

(11)

Proof. From (7) and Proposition 2.2 we get

𝖷𝑛 = 𝖸𝑛 + (2𝑝 − 1)(2𝛽𝗆𝑛−1 + 2𝛼𝖬𝑛−1 − 𝖷𝑛−1),

which together with 𝖷𝑛 = 𝖷𝑛−1 + Δ𝑛−1 gives the following representation of the p-rotor
walk in terms of its minimum and maximum

2𝑝𝖷𝑛−1 = 𝖸𝑛 − Δ𝑛−1 + 2𝛼(2𝑝 − 1)𝖬𝑛−1 + 2𝛽(2𝑝 − 1)𝗆𝑛−1.

Dividing by 2𝑝 and reindexing gives the claim.

We focus next our attention on the martingale term 𝖸𝑛 in the decomposition (7) of the
p-rotor walk. First we consider briefly the special case of 𝛼 = 𝛽 = 0, which is particularly
simple to understand and whose properties will be used in the behavior of the general
case.

2.1 Native environment

In the native case 𝛼 = 𝛽 = 0 our initial rotor configuration has the form

⎧⎪⎪⎪⎪⎨⎪⎪⎪⎪⎩

𝜌0(𝑥) =

−1
−1 with probability 1/2
1 with probability 1/2
1

for 𝑥 > 0,
for 𝑥 = 0,
for 𝑥 = 0,
for 𝑥 < 0,

(12)

9

2 SCALING LIMIT

Denote by (𝖴𝗇) the p-rotor walk started with this initial configuration. We shall call
(𝖴𝗇) the native p-rotor walk. As mentioned in the introduction, in the previously visited
region {𝗆𝑛, . . . , 𝖬𝑛}, the configuration 𝜌𝑛 of the p-rotor walk (𝖷𝑛) points in the direction
of the current position. Therefore, in the visited region the p-rotor walk (𝖷𝑛) behaves
exactly like (𝖴𝑛). The process (𝖴𝑛) is an easy special case of a correlated random walk
which has been studied in greater generality in [Enr02].
Definition 2.4. A correlated random walk on ℤ with persistence 𝑞 ∈ (0, 1) is a nearest
neighbour random walk, such that with probability 𝑞 the direction of a step is the same
as the direction of the previous step. If 𝑞 = 1/2, then it is a simple random walk.

Since all rotors always point to the current position 𝖴𝑛 of the walker, the rotor 𝜌𝑛(𝖴𝗇)
points towards the previous position 𝖴𝑛−1. Thus the direction of movement changes only
if the rotor at time 𝑛 is broken (i.e. 𝐵𝑛 = 1), which happens with probability 𝑝. Thus
(𝖴𝑛) is a correlated random walk with persistence 1 − 𝑝.
It is easy to see that (𝖴𝑛) when properly rescaled converges weakly to a Brownian motion.
We give a quick proof of this fact for completeness.
Proposition 2.5. For every 𝑝 ∈ (0, 1), the native p-rotor walk (𝖴𝑛) with initial con-
𝑛, converges weakly on 𝒞[0, 1] to a Brownian
figuration as in (12) when rescaled by
motion:

√

{︂ 𝖴(𝑛𝑡)√

𝑛

}︂ 𝒟−→

{︂√︂ 1 − 𝑝

𝑝

}︂

, 𝑡 ∈ [0, 1]

ℬ(𝑡), 𝑡 ∈ [0, 1]

,

as 𝑛 → ∞.

Proof. From Proposition 2.3 with 𝛼 = 𝛽 = 0 we get that for all 𝑛 ≥ 1

𝖴𝑛 =

Since Δ𝑛 ∈ {−1, +1}, the process (2𝑝𝖴𝑛) has the same scaling limit as 𝖸𝑛 =∑︀𝑛−1

𝑘=0 𝜉𝑘,
with 𝜉𝑘 = Δ𝑘 − 𝔼[Δ𝑘|ℱ𝑘]. Because 𝖸𝑛 is a martingale, we can apply Theorem 2.1. The
first condition of Theorem 2.1 is satisfied since 𝜉𝑘 is uniformly bounded for all 𝑘 ≥ 0.
Thus, we only have to show convergence of the quadratic variation process (𝖵𝑛). Using
the fact that 𝖴𝑛 is a nearest neighbour walk, the following holds

𝖵𝑛 =

𝔼[𝜉2

𝑘|ℱ𝑘] =

𝔼[︀(Δ𝑘 − 𝔼[Δ𝑘|ℱ𝑘])2|ℱ𝑘

]︀

𝑛∑︁

𝑘=1

𝔼[(Δ2

𝑘 − 2Δ𝑘𝔼[Δ𝑘|ℱ𝑘] + 𝔼[Δ𝑘|ℱ𝑘]2)|ℱ𝑘]

(13)

(︀𝖸𝑛+1 − Δ𝑛

)︀.

1
2𝑝

𝑘=1

𝑛∑︁
𝑛∑︁
=𝑛 − 𝑛∑︁

𝑘=1

=

𝑘=1

𝔼[Δ𝑘|ℱ𝑘]2,

10

2 SCALING LIMIT

On the other hand, from equation (3) we have the equality Δ𝑘 = 𝖷𝑘+1 − 𝖷𝑘 = 𝐵𝑘𝜌𝑘(𝖷𝑘)
where 𝜌𝑘(𝖷𝑘) ∈ ℱ𝑘 and 𝐵𝑘 independent of ℱ𝑘 with 𝔼[𝐵𝑘] = (2𝑝 − 1). Hence

𝔼[Δ𝑘|ℱ𝑘]2 = (2𝑝 − 1)2𝜌𝑘(𝖷𝑘)2 = (2𝑝 − 1)2.

Then

= 4𝑝(1 − 𝑝),

𝖵𝑛
𝑛

from which the claim immediately follows.

2.2 General environment
We now treat the general case of an (𝛼, 𝛽)-random initial configuration with 𝛼, 𝛽 ∈ [0, 1].
In order to check that (𝖸𝑛) as defined in (8) satisfies the assumptions of the martingale
central limit theorem, we first prove that the running maximum and minimum of (𝖷𝑛)
have sublinear growth.

The argument we will use is similar to the one used to prove [Dav96, Lemma 3.2].
The main idea is that (𝖷𝑛) performs correlated random walk as long as it remains in
previously visited territory, so if 𝖬𝑛 − 𝗆𝑛 ≥ 𝐿 then the time to form a new extremum is
stochastically at least the time for a correlated random walk to exit an interval of length
𝐿.

Proposition 2.6. Let (𝖷𝑛) be a p-rotor walk with (𝛼, 𝛽)-random initial configuration 𝜌0
as in (4). For every 𝑝 ∈ (0, 1) and 𝛼, 𝛽 ∈ [0, 1],

in probability, as 𝑛 → ∞.

Proof. Fix 𝐿 > 1 and let

→ 0

𝖬𝑛
𝑛

and

→ 0

𝗆𝑛
𝑛

𝜏1 = inf{𝑛 > 0 : 𝖬𝑛 − 𝗆𝑛 = 𝐿}

be the first time when (𝖷𝑛) has visited 𝐿 + 1 distinct points. For 𝑘 ≥ 1 consider the
sequence of stopping times

𝜏2𝑘 = inf{︀𝑖 > 𝜏2𝑘−1 : 𝗆𝑖 < 𝖷𝑖 < 𝖬𝑖
𝜏2𝑘+1 = inf{︀𝑖 > 𝜏2𝑘 : 𝖷𝑖 < 𝗆𝑖−1 or 𝖷𝑖 > 𝖬𝑖−1

}︀,

}︀.

For each 𝑘 ≥ 1 the p-rotor walk reaches a previously unvisited vertex at time 𝜏2𝑘+1. It
follows that 𝜌𝜏2𝑘+1(𝖷𝜏2𝑘+1) = 𝜌0(𝖷𝜏2𝑘+1) and 𝖷𝜏2𝑘+1 ∈ {𝗆𝜏2𝑘+1, 𝖬𝜏2𝑘+1}. The conditional
distribution of 𝜏2𝑘+2 − 𝜏2𝑘+1 given ℱ𝜏2𝑘+1 on the event [𝖷𝜏2𝑘+1 = 𝖬𝜏2𝑘+1] is the geometric
distribution with parameter 𝛼(1 − 𝑝) + 𝑝(1 − 𝛼), since it represents the number of con-
secutive increases of the maximum before changing direction. The process (𝖷𝑛) stops

11

2 SCALING LIMIT

}︂

{︂

increasing the maximum if the rotor at the current position points to the right in the
initial configuration (with probability 𝛼) and it is working (with probability 1− 𝑝) or if it
points to the left (with probability 1− 𝛼) and it is broken (with probability 𝑝). Similarly
the conditional distribution of 𝜏2𝑘+2 − 𝜏2𝑘+1 given ℱ𝜏2𝑘+1 on the event [𝖷𝜏2𝑘+1 = 𝗆𝜏2𝑘+1]
is the geometric distribution with parameter 𝛽(1 − 𝑝) + 𝑝(1 − 𝛽). It follows that

𝔼[𝜏2𝑘+2 − 𝜏2𝑘+1] ≤ 𝐶 := max

1

𝛼(1 − 𝑝) + 𝑝(1 − 𝛼)

,

1

𝛽(1 − 𝑝) + 𝑝(1 − 𝛽)

.

(14)

For 𝑘 ≥ 1, in order to estimate the conditional distribution of 𝜏2𝑘+1 − 𝜏2𝑘 given ℱ𝜏2𝑘 ,
note that at time 𝜏2𝑘, the p-rotor walk is at distance 1 from either its current maximum
or the current minimum, and 𝖬𝜏2𝑘 − 𝗆𝜏2𝑘 ≥ 𝐿.
Inside the already visited interval
𝐼𝑘 := {𝗆𝜏2𝑘 , . . . , 𝖬𝜏2𝑘} the rotors to the left of 𝖷𝜏2𝑘 point right and the rotors to the
right of 𝖷𝜏2𝑘 point left. These rotors coincide with the native environment (12) with
the origin shifted to 𝖷𝜏2𝑘 . Therefore, starting at time 𝜏2𝑘 until the time 𝜏2𝑘+1 when
it exits the interval 𝐼𝑘, the p-rotor walk is a correlated random walk with persistence
1 − 𝑝 (Definition 2.4). Thus, the conditional distribution of 𝜏2𝑘+1 − 𝜏2𝑘 given ℱ𝜏2𝑘 is
stochastically no smaller than the distribution of the time it takes a (1 − 𝑝)-correlated
random walk started at 1 to first visit the set {0, 𝐿}. Denote by 𝐸𝐿 the expected hitting
time of the set {0, 𝐿} for a (1 − 𝑝)-correlated random started at 1, where the first step
goes to 0 with probability 𝑝 and to 2 with probability 1 − 𝑝. From the law of large
numbers

lim sup
𝑛→∞

∑︀𝑛
∑︀𝑛−1
𝑘=1(𝜏2𝑘 − 𝜏2𝑘−1)
𝑘=1(𝜏2𝑘+1 − 𝜏2𝑘)
𝜏2𝑛∑︁

≤ 𝐶
𝐸𝐿

,

𝑛∑︁

(𝜏2𝑘 − 𝜏2𝑘−1) =

1{𝖷𝑖 < 𝗆𝑖−1 or 𝖷𝑖 > 𝖬𝑖−1}

with 𝐶 given in (14). On the other hand

𝑘=1

and

𝑛−1∑︁

𝑘=1

𝑖=𝜏1

(𝜏2𝑘+1 − 𝜏2𝑘) ≤ 𝜏2𝑛.

Then we have

lim sup
𝑛→∞

1
𝑛

(𝖬𝑛 − 𝗆𝑛) = lim sup
𝑛→∞

≤ lim sup
𝑛→∞
≤ lim sup
𝑛→∞

1
𝑛

𝐿 +

(︃
𝑛∑︁
(︃ 𝜏2𝑛∑︁
∑︀𝑛
∑︀𝑛−1
𝑘=1(𝜏2𝑘 − 𝜏2𝑘−1)
𝑘=1(𝜏2𝑘+1 − 𝜏2𝑘)

1
𝜏2𝑛

𝑖=𝜏1

𝑖=𝜏1

)︃

)︃

1{𝖷𝑖 < 𝗆𝑖−1 or 𝖷𝑖 > 𝖬𝑖−1}

1{𝖷𝑖 < 𝗆𝑖−1 or 𝖷𝑖 > 𝖬𝑖−1}

≤ 𝐶
𝐸𝐿

.

12

Proposition 2.5 (which also implies the recurrence of the correlated random walk) to-
gether with the Portmanteau theorem yields that sup𝐿>1 𝐸𝐿 = ∞, which gives

2 SCALING LIMIT

lim sup
𝑛→∞

1
𝑛

(𝖬𝑛 − 𝗆𝑛) = 0.

Since 𝖬𝑛 ≤ 𝖬𝑛 − 𝗆𝑛 and |𝗆𝑛| ≤ 𝖬𝑛 − 𝗆𝑛, the proposition follows.

√︁ 1−𝑝

Now we obtain the scaling limit of the martingale portion (𝖸𝑛) of the 𝑝-rotor walk. Note
that the constant factor in front of the Brownian motion here is different from the
we are ultimately aiming for in the scaling limit of (𝖷𝑛).
Theorem 2.7. Let (𝖸𝑛) be the martingale defined in (8). Then on the space 𝒞[0, 1]

𝑝

}︂ 𝒟−→{︁

}︁
2√︀𝑝(1 − 𝑝)ℬ(𝑡), 𝑡 ∈ [0, 1]

, 𝑡 ∈ [0, 1]

as 𝑛 → ∞.

{︂ 𝖸(𝑛𝑡)√

𝑛

Proof. We check the conditions of the martingale central limit theorem from Theorem
2.1. As in the proof of Proposition 2.5 the first condition of Theorem 2.1 is satisfied
since 𝜉𝑘 is bounded. Similarly to (13) the following equality holds

𝖵𝑛 = 𝑛 − 𝑛∑︁

𝔼[Δ𝑘|ℱ𝑘]2.

𝑘=1

We use once again that Δ𝑘 = 𝖷𝑘+1−𝖷𝑘 = 𝐵𝑘𝜌𝑘(𝖷𝑘), where 𝐵𝑘 is independent of ℱ𝑘 with
𝔼[𝐵𝑘] = (2𝑝 − 1). On the event [𝗆𝑘−1 ≤ 𝖷𝑘 ≤ 𝖬𝑘−1] the rotor 𝜌𝑘(𝖷𝑘) is ℱ𝑘-measurable,
since it points into the direction of the last exit from 𝖷𝑘. On the other hand, on the
event [𝗆𝑘−1 > 𝖷𝑘 or 𝖬𝑘−1 < 𝖷𝑘] the rotor 𝜌𝑘(𝖷𝑘) = 𝜌0(𝖷𝑘) is still in its initial state,
which is independent of ℱ𝑘. Thus

𝔼[Δ𝑘|ℱ𝑘]2 = (2𝑝 − 1)2(1 − 2𝛽)21{𝖷𝑘 < 𝗆𝑘−1}

Moreover, because 𝗆𝑛 = −∑︀𝑛

+ (2𝑝 − 1)2𝜌𝑘(𝖷𝑘)21{𝗆𝑘−1 ≤ 𝖷𝑘 ≤ 𝖬𝑘−1}
+ (2𝑝 − 1)2(2𝛼 − 1)21{𝖷𝑘 > 𝖬𝑘−1}.

1{𝖷𝑘 < 𝗆𝑘−1}, 𝖬𝑛 =∑︀𝑛

𝑘=1

𝑘=1

1{𝖷𝑘 > 𝖬𝑘−1} and

(15)

equations (13) and (15) imply that

= 1 − (2𝑝 − 1)2

𝖵𝑛
𝑛

𝑛∑︁

𝑘=1

{︂

1{𝗆𝑘−1 ≤ 𝖷𝑘 ≤ 𝖬𝑘−1} = 𝑛 − 𝖬𝑛 + 𝗆𝑛,

}︂

.

− (1 − 2𝛽)2 𝗆𝑛
𝑛

+

𝑛
𝑛

− 𝖬𝑛
𝑛

+

𝗆𝑛
𝑛

+ (2𝛼 − 1)2 𝖬𝑛
𝑛

13

This together with Proposition 2.6 finally yields

2 SCALING LIMIT

Since all conditions from Theorem 2.1 are satisfied, with 𝜎 = 2√︀𝑝(1 − 𝑝), the claim

→ 1 − (2𝑝 − 1)2 = 4𝑝(1 − 𝑝) > 0.

𝖵𝑛
𝑛

follows.

Recall that for all 𝑛 ≥ 1, the p-rotor walk satisfies an equation of the form

with 𝑎, 𝑏 < 1 and 𝖶𝑛 given in Proposition 2.3.

𝖷𝑛 = 𝖶𝑛 + 𝑎𝖬𝑛 + 𝑏𝗆𝑛,

Lemma 2.8. Let 𝖶𝑛 as defined in Proposition 2.3. Then 𝖶𝑛, when rescaled by
converges weakly on 𝒞[0, 1] to a Brownian motion:

{︂ 𝖶(𝑛𝑡)√

𝑛

}︂ 𝒟−→

{︂√︂ 1 − 𝑝

𝑝

, 𝑡 ∈ [0, 1]

ℬ(𝑡), 𝑡 ∈ [0, 1]

as 𝑛 → ∞.

}︂

(16)

√

𝑛

Proof. Because 𝖶𝑛 is 𝖸𝑛 plus a bounded quantity, rescaled by 1/2𝑝, this implies that 𝖶𝑛
has the same scaling limit as 1

2𝑝 𝖸𝑛. This together with Theorem 2.7 gives the claim.

√

In the remainder of this section we will show that this implies the weak convergences of
𝖷(𝑛𝑡)/
𝑛 to a doubly perturbed Brownian motion. We shall use the following identities
from [CPY98, page 243] characterizing the maximum and minimum of a solution to an
equation of the form (16). We include the proof for completeness.

Lemma 2.9. Let 𝖬𝑛 and 𝗆𝑛 be the running maximum and minimum of a process (𝖷𝑛)
satisfying (16). Then

𝖬𝑛 =

1

1 − 𝑎

max
𝑘≤𝑛

(︂
(︀𝖶𝑙 + 𝑎𝖬𝑙

𝖶𝑘 +

)︂

and 𝗆𝑛 =

𝑔𝑘

𝑏
1 − 𝑏

)︀ and 𝐺𝑘 = max𝑙≤𝑘

)︂

𝖶𝑘 +

𝐺𝑘

,

𝑎
1 − 𝑎

(︂

min
𝑘≤𝑛

)︀,

1
1 − 𝑏

(︀𝖶𝑙 + 𝑏𝗆𝑙
)︀.
(︀𝖶𝑘 + 𝑏𝗆𝑛
)︀.
(︀𝖶𝑘 + 𝑎𝖬𝑛

where 𝑔𝑘 = min𝑙≤𝑘
Proof. From (9) we have 𝖷𝑛 − 𝑎𝖬𝑛 = 𝖶𝑛 + 𝑏𝗆𝑛. Taking the maximum over 𝑛 on both
sides gives

(1 − 𝑎)𝖬𝑛 = max
𝑘≤𝑛

Similarly

(1 − 𝑏)𝗆𝑛 = min
𝑘≤𝑛

Solving for the running maximum 𝖬𝑛 and for the running minimum 𝗆𝑛 gives the claim.

14

2 SCALING LIMIT

We shall also use the following easy inequality.
Proposition 2.10. Let (𝑥𝑘)𝑘≥0 be a sequence of real numbers. Then for all 𝑛, 𝑗 ∈ ℕ0,

max
𝑘≤𝑛+𝑗

𝑥𝑘 − max
𝑘≤𝑗

𝑥𝑘 ≤ max
𝑘≤𝑛

(︀𝑥𝑗+𝑘 − 𝑥𝑗

)︀.

(17)

Proof. If the left hand side of (17) is equal to zero, the statement is trivially true. Now
assume that max𝑘≤𝑛+𝑗 𝑥𝑘 > max𝑘≤𝑗 𝑥𝑘. It follows that

max
𝑘≤𝑛+𝑗

𝑥𝑘 = max

𝑗≤𝑘≤𝑛+𝑗

𝑥𝑘 = max
𝑘≤𝑛

𝑥𝑘+𝑗.

Hence

max
𝑘≤𝑛+𝑗

𝑥𝑘 − max
𝑘≤𝑗

𝑥𝑘 ≤ max
𝑘≤𝑛

𝑥𝑘+𝑗 − 𝑥𝑗 = max
𝑘≤𝑛

(︀𝑥𝑘+𝑗 − 𝑥𝑗

)︀.

Lemma 2.11. There exists a constant 𝐶 > 0 such that

|𝖬𝑗+𝑛 − 𝖬𝑗| ≤ 𝐶 max
𝑘≤𝑛

|𝖶𝑗+𝑘 − 𝖶𝑗| and

|𝗆𝑗+𝑛 − 𝗆𝑗| ≤ 𝐶 max
𝑘≤𝑛

|𝖶𝑗+𝑘 − 𝖶𝑗|,

for all 𝑗, 𝑛 ≥ 0.

Proof. By Lemma 2.9 and Proposition 2.10

{︂

(︂

)︂

(︂

𝖬𝑗+𝑛 − 𝖬𝑗 =

1

1 − 𝑎

max
𝑘≤𝑗+𝑛

{︂

𝖶𝑘 +

𝑏
1 − 𝑏
𝑔𝑘
(𝖶𝑗+𝑘 − 𝖶𝑗) +

− max
𝖶𝑘 +
𝑘≤𝑗
(𝑔𝑗 − 𝑔𝑗+𝑘)

≤ 1

𝑏
1 − 𝑏
We shall distinguish two cases. Let first 𝑏 ≤ 0. Since

1 − 𝑎

max
𝑘≤𝑛

)︂}︂

𝑔𝑘

(18)

𝑏
1 − 𝑏

.

}︂
)︀ ≥ 0,

we get the bound

𝖬𝑗+𝑛 − 𝖬𝑗 ≤ 1
1 − 𝑎

If 𝑏 > 0 we can apply again Proposition 2.10 to obtain

𝑙≤𝑗+𝑘

max
𝑘≤𝑛

(︀𝖶𝑙 + 𝑎𝖬𝑙

(︀𝖶𝑙 + 𝑎𝖬𝑙
)︀ − min
)︀.
(︀𝖶𝑗+𝑘 − 𝖶𝑗
)︀ − min
(︀𝖶𝑙 + 𝑎𝖬𝑙
)︀
(︀𝖶𝑙 + 𝑎𝖬𝑙
(︀ − 𝖶𝑙 − 𝑎𝖬𝑙
)︀ − max
(︀ − 𝖶𝑙 − 𝑎𝖬𝑙
(︀(𝖶𝑗 − 𝖶𝑗+𝑙) + 𝑎(𝖬𝑗 − 𝖬𝑗+𝑙))︀
)︀,
(︀𝖶𝑗 − 𝖶𝑗+𝑙

𝑙≤𝑗+𝑘

𝑙≤𝑗

)︀

𝑔𝑗 − 𝑔𝑗+𝑘 = min
𝑙≤𝑗

𝑔𝑗 − 𝑔𝑗+𝑘 = min
𝑙≤𝑗

= max
𝑙≤𝑗+𝑘
≤ max
𝑙≤𝑘
≤ max
𝑙≤𝑘

15

where the last inequality follows from the fact 𝖬𝑗 − 𝖬𝑗+𝑙 ≤ 0 and that 𝑏 > 0 implies
that also 𝑎 > 0. Together with (18) this gives

2 SCALING LIMIT

)︀}︂
(︀𝖶𝑗 − 𝖶𝑗+𝑙
}︂
}︂

|𝖶𝑗+𝑙 − 𝖶𝑗|
|𝖶𝑗+𝑘 − 𝖶𝑗|

𝖬𝑗+𝑛 − 𝖬𝑗 ≤ 1
1 − 𝑎

≤ 1

1 − 𝑎

≤ 1

1 − 𝑎

max
𝑘≤𝑛

max
𝑘≤𝑛

{︂

max
𝑘≤𝑛

(𝖶𝑗+𝑘 − 𝖶𝑗) +
|𝖶𝑗+𝑘 − 𝖶𝑗| +
|𝖶𝑗+𝑘 − 𝖶𝑗| +

𝑏
1 − 𝑏
𝑏
1 − 𝑏
𝑏
1 − 𝑏
|𝖶𝑗+𝑘 − 𝖶𝑗|.

max
𝑙≤𝑘

max
𝑙≤𝑘

max
𝑘≤𝑛

=

1

(1 − 𝑎)(1 − 𝑏)

max
𝑘≤𝑛

{︂
{︂

{︂ 1

[︃

[︂

The upper bound for the differences of the minimum follows from the same argument
with the roles of 𝑎 and 𝑏 exchanged. By setting

𝐶 = max

1 − 𝑎

,

1
1 − 𝑏

,

1

(1 − 𝑎)(1 − 𝑏)

}︂

the claim follows.
Proposition 2.12. For 𝑛 ≥ 1 let 𝑀𝑛(𝑡) = 𝖬(𝑛𝑡)√
be the processes
obtained by linearly interpolating and rescaling the running maximum and the running
minimum of (𝖷𝑛), respectively. Then (𝑀𝑛)𝑛≥1 and (𝑚𝑛)𝑛≥1 are tight sequences in 𝒞[0, 1].

𝑛 and 𝑚𝑛(𝑡) = 𝗆(𝑛𝑡)√

𝑛

Proof. We show the tightness only for the rescaled maximum 𝑀𝑛. By symmetry, the
same argument also applies to 𝑚𝑛(𝑡). Since 𝑀𝑛(0) = 0 for all 𝑛 ≥ 1 by Theorem 7.3 of
[Bil99] we only need to show that for all 𝜖 > 0

lim
𝛿→0

lim sup
𝑛→∞

ℙ

sup
|𝑠−𝑡|<𝛿

|𝑀𝑛(𝑠) − 𝑀𝑛(𝑡)| ≥ 𝜖

= 0.

Undoing the rescaling, this is equivalent to showing that
√
|𝖬𝑗+𝑘 − 𝖬𝑗| ≥ 𝜖

ℙ

lim sup
𝑛→∞

lim
𝛿→0
for all 𝑗 ≥ 0 and all 𝜖 > 0.
By Lemma 2.11 we have max𝑘<𝑛𝛿|𝖬𝑗+𝑘 − 𝖬𝑗| ≤ 𝐶 max𝑘≤𝑛𝛿|𝖶𝑗+𝑘 − 𝖶𝑗|. Thus

max
𝑘<𝑛𝛿

𝑛

= 0,

lim
𝛿→0

lim sup
𝑛→∞

ℙ

√
|𝖬𝑗+𝑘 − 𝖬𝑗| ≥ 𝜖

𝑛

max
𝑘<𝑛𝛿

≤ lim
𝛿→0

ℙ

lim sup
𝑛→∞

|𝖶𝑗+𝑘 − 𝖶𝑗| ≥ 𝜖
𝐶

max
𝑘<𝑛𝛿

]︂

[︂

]︂

𝑛

.

√

By Lemma 2.8 the right side is zero: 𝖶(𝑛𝑡)√
is therefore a tight sequence. Hence (𝑀𝑛) is tight.

𝑛 converges weakly to a Brownian motion and

16

]︃

]︂

[︂

2 SCALING LIMIT

Now we turn to the proof of the main result.

Proof of Theorem 1.2. To recall the setup, 𝑋𝑛(𝑡) = 𝖷(𝑛𝑡)/
𝑛 is the linearly interpolated
rescaling of the p-rotor walk with the initial configuration (4). Using the decomposition
(9) we have

√

(19)

𝑋𝑛(𝑡) = 𝑊𝑛(𝑡) + 𝑎𝑀𝑛(𝑡) + 𝑏𝑚𝑛(𝑡).

√

√
𝑛 and 𝑚𝑛(𝑡) = 𝗆(𝑛𝑡)/

√

𝑛 are the linearly interpolated rescalings
𝑛 with 𝖶𝑛

where 𝑀𝑛(𝑡) = 𝖬(𝑛𝑡)/
of the maximum and minimum of (𝖷𝑛), respectively; and 𝑊𝑛(𝑡) = 𝖶(𝑛𝑡)/
defined in Proposition 2.3.
The sequence 𝑊𝑛 converges weakly in 𝒞[0, 1] to a Brownian motion by Lemma 2.8, and
the sequences 𝑀𝑛 and 𝑚𝑛 are tight by Proposition 2.12. So 𝑋𝑛 is a sum of three tight
sequences, hence tight. By Prohorov’s theorem, every subsequence of 𝑋𝑛 contains a fur-
ther subsequence that converges weakly in 𝒞[0, 1]. Let 𝑋𝑛𝑗 be a convergent subsequence
with a weak limit point which we denote by 𝑋.
Now we apply the continuous mapping theorem, using the map Θ : 𝒞[0, 1] → 𝒞[0, 1] given
by

Θ(𝑕)(𝑡) = 𝑕(𝑡) − 𝑎 sup
0≤𝑠≤𝑡

𝑕(𝑠) − 𝑏 inf
0≤𝑠≤𝑡

𝑕(𝑠).

Rearranging the terms in (19), we have

Θ(𝑋𝑛𝑗 ) = 𝑊𝑛𝑗 .

√︁ 1−𝑝
By the continuous mapping theorem, the left side converges weakly in 𝒞[0, 1] to Θ(𝑋),
𝑝 ℬ. We
and by Lemma 2.8 the right side converges weakly to a Brownian motion
conclude that

as processes on [0, 1]. It follows that

1−𝑝 𝑋 is a solution of the implicit equation (5),

i.e. it is an (𝑎, 𝑏)-perturbed Brownian motion.
Since 𝑎, 𝑏 ∈ (−∞, 1), the equation (5) uniquely determines the law of 𝑋 (see Chaumont
and Doney [CD99, Theorem 2], who show something stronger: (5) has a pathwise unique
solution, which is almost surely continuous and adapted to the filtration of ℬ). Hence
every convergent subsequence of 𝑋𝑛 has the same weak limit point in 𝒞[0, 1], which
implies that the sequence 𝑋𝑛 itself converges weakly (see the Corollary to Theorem 5.1
in [Bil99]).

The same argument proves weak convergence of (𝑋𝑛(𝑡))0≤𝑡≤𝑇 to an (𝑎, 𝑏)-perturbed
Brownian motion in 𝒞[0, 𝑇 ], for each fixed 0 < 𝑇 < ∞. Since weak convergence in
𝒞[0,∞) is defined as weak convergence in 𝒞[0, 𝑇 ] for all 0 < 𝑇 < ∞, the proof is
complete.

17

√︂ 1 − 𝑝

ℬ

𝑝

𝑋 − 𝑎𝑋 𝗌𝗎𝗉 − 𝑏𝑋 𝗂𝗇𝖿 𝒟
=

√︁ 𝑝

𝑝

𝑋(𝑡) =

√︂ 1 − 𝑝
(︀𝑋(𝑠) − 𝑎𝑋 sup(𝑡))︀ =
√︂ 1 − 𝑝
(︁ℬ(𝑡) +

√︂ 1 − 𝑝

𝑋 sup(𝑡) =

𝑝

𝑝

𝑋(𝑡) =

·

1

1 − 𝑎

ℳ(𝑡)

)︁

𝑎
1 − 𝑎

ℳ(𝑡)

.

which implies that

(1 − 𝑎)𝑋 sup(𝑡) = sup
𝑠≤𝑡

Thus

and

2 SCALING LIMIT

Remark 2.13. If we change any finite number of rotors in the initial rotor configuration
(4), the scaling limit of the p-rotor walk will be the same as in Theorem 1.2. The only
difference in the proof is that in the compensator 𝖹𝑛 from Proposition 2.2 there will
be some additional terms of order 1, which, after rescaling by
𝑛 and letting 𝑛 go to
infinity, go to zero.

√

If one of the parameters 𝛼 or 𝛽 are 0 in the initial configuration 𝜌0 given in (4), then
the scaling limit can be determined explicitly and it is a one-sided perturbed Brownian
motion, as in Corollary 1.3. The proof is a simple calculation, which we state here for
completeness.

Proof of Corollary 1.3. By letting 𝛽 = 0, we have 𝑏 = 0 and the scaling limit of (𝖷𝑛)
satisfies the implicit equation

ℬ(𝑡) + 𝑎𝑋 sup(𝑡),

(20)

√︂ 1 − 𝑝

𝑝

√︂ 1 − 𝑝

𝑝

ℳ(𝑡).

ℬ(𝑠) =

sup
𝑠≤𝑡

On the other hand, since 𝑎 = 𝛼(2𝑝−1)

𝑝

, we have

𝑎
1 − 𝑎

= 𝜆𝑝,𝛼 =

𝛼(2𝑝 − 1)

𝛼(1 − 𝑝) + 𝑝(1 − 𝛼)

and this proves the claim.

By symmetry, the same scaling limit can be obtained if we take 𝛼 = 0, and the p-rotor
walk with (0, 𝛽)- rescaled by a factor of
𝑛 converges weakly to a Brownian motion
perturbed at its minimum.

√

We conclude with the proof of recurrence of p-rotor walk.

Proof of Proposition 1.4. In [CDH00, Theorem 1.1] a version of the law of iterated loga-
rithm was proved for doubly perturbed Brownian motion 𝒳𝑎,𝑏(𝑡). In particular this im-
plies that lim sup𝑡→∞ 𝒳𝑎,𝑏(𝑡) = +∞ and lim inf 𝑡→∞ 𝒳𝑎,𝑏(𝑡) = −∞. This further implies
that 𝒳𝑎,𝑏(𝑡) crosses 0 an infinite number of times. Hence ℙ[𝖷𝑛 = 0 infinitely often] = 1
by Theorem 1.2 and the fact that p-rotor walk is a nearest neighbor process.

18

3 HIGHER DIMENSIONS AND LONGER JUMPS

3 Higher dimensions and longer jumps

Two dimensions. Consider the following nearest-neighbor walk (𝑋𝑛) in ℤ2, with ro-
tors 𝜌𝑛 : ℤ2 → {(0, 1), (0,−1), (1, 0), (−1, 0)}. Initially the rotors 𝜌0 are i.i.d. uniform.
At each time step, the rotor 𝜌𝑛(𝑋𝑛) at the walker’s current location either resets to a
uniformly random direction (with probability 𝑝) or rotates clockwise 90∘ (with probabil-
ity 1− 𝑝), and then the walker follows the new rotor: 𝑋𝑛+1 = 𝑋𝑛 + 𝜌𝑛+1(𝑋𝑛). This walk
interpolates between the uniform rotor walk (𝑝 = 0) and simple random walk (𝑝 = 1).
Question 1: Prove that (𝑋𝑛) is recurrent for all 𝑝 ∈ (0, 1).
Question 2: What is the scaling limit of (𝑋𝑛), for 𝑝 ∈ (0, 1)?
Following the outline of this paper, one could first seek to understand the process (𝑋𝑛)
in its native environment, which is when 𝜌0 is a variant of the uniform spanning tree
(oriented toward the origin).

1 < 𝑡𝑥

𝑘+1)𝑘≥1 is a Markov chain, where 𝑡𝑥

Locally Markov walks. The p-rotor walk (𝖷𝑛) on ℤ is not a Markov chain, but for
each vertex 𝑥 ∈ ℤ, the sequence of successive exits from 𝑥 is a Markov chain. More
formally, we could make the following definition.
Definition 3.1. A walk (𝖷𝑛)𝑛≥0 is locally Markov if for each vertex 𝑥 the sequence
2 < ··· are the times of successive visits to
(𝑋𝑡𝑥
𝑥.
In the case of the p-rotor walk on ℤ, for each 𝑥 ∈ ℤ, the Markov chain (𝖷𝑡𝑥
𝑘+1)𝑘≥1 has
state space {𝑥 − 1, 𝑥 + 1}. A natural generalization allows longer range jumps while
preserving the local Markov property. Specifically, suppose that each vertex 𝑥 has a
finite state space 𝑄𝑥 ⊂ ℤ, and let (𝗉𝑥(𝑞, 𝑞′))𝑞,𝑞′∈𝑄𝑥 be a transition matrix on 𝑄𝑥. The
total state of the system is specified by the current location the walker in ℤ, along with a
local state 𝑞𝑥 ∈ 𝑄𝑥 for each 𝑥 ∈ ℤ. A walker located at 𝑥 and finding local state 𝑞 = 𝑞𝑥,
first changes the local state to 𝑞′ with probability 𝗉𝑥(𝑞, 𝑞′) and then moves to 𝑥 + 𝑞′.
Let us denote by (𝑋𝑛) the location of the walker after 𝑛 such steps. For each 𝑥 ∈ ℤ,
𝑘+1)𝑘≥1 of successive exits from 𝑥 is a Markov chain on the finite state
the sequence (𝑋𝑡𝑥
space {𝑥 + 𝑞 : 𝑞 ∈ 𝑄𝑥}. Assume that 𝗉𝑥 is irreducible, so that this chain has a unique
stationary distribution 𝜋𝑥.
The process (𝑋𝑛) has a corresponding coarse-grained Markov chain (𝑌𝑛) on ℤ whose
transition probabilities are 𝑝(𝑥, 𝑦) = 𝜋𝑥(𝑦). Comparing these two processes raises a
number of questions.

Question 3: Is it possible that (𝑌𝑛) is recurrent but (𝑋𝑛) is transient?

Question 4: Suppose (𝑌𝑛) has no drift (i.e., each 𝜋𝑥 has mean 𝑥). Under what conditions
is the scaling limit of (𝑋𝑛) a perturbed Brownian motion like in Theorem 1.2?

Question 5: What is the scaling limit of (𝑋𝑛) in the case when (𝑌𝑛) has drift?

19

REFERENCES

Acknowledgements

We thank Ba´lint Toth for bringing reference [To´t96] to our attention, and Boyao Li for
helpful comments on an early draft.

References

[AH11]

[AH12]

[Bil99]

[BL14]

[CD99]

Omer Angel and Alexander E. Holroyd. Rotor walks on general trees. SIAM
J. Discrete Math., 25(1):423–446, 2011, arXiv:1009.4802.

Omer Angel and Alexander E. Holroyd. Recurrent rotor-router configura-
tions. J. Comb., 3(2):185–194, 2012, arXiv:1101.2484.

Patrick Billingsley. Convergence of probability measures. Wiley Series in
Probability and Statistics: Probability and Statistics. John Wiley & Sons,
Inc., New York, second edition, 1999. A Wiley-Interscience Publication.

Benjamin Bond and Lionel Levine. Abelian networks I. Foundations and
examples. 2014, arXiv:1309.3445.

L. Chaumont and R. A. Doney. Pathwise uniqueness for perturbed versions
of Brownian motion and reflected Brownian motion. Probab. Theory Related
Fields, 113(4):519–534, 1999.

[CDH00] L. Chaumont, R. A. Doney, and Y. Hu. Upper and lower limits of dou-
bly perturbed Brownian motion. Ann. Inst. H. Poincare´ Probab. Statist.,
36(2):219–249, 2000.

[CPY98] Philippe Carmona, Fre´de´rique Petit, and Marc Yor. Beta variables as times
spent in [0,∞[ by certain perturbed Brownian motions. J. London Math.
Soc. (2), 58(1):239–256, 1998.

[CS06]

[Dav96]

[Dav99]

[DK12]

Joshua N. Cooper and Joel Spencer. Simulating a random walk with constant
error. Combin. Probab. Comput., 15(6):815–822, 2006, arXiv:math/0402323.

Burgess Davis. Weak limits of perturbed random walks and the equation
𝑌𝑡 = 𝐵𝑡 + 𝛼 sup{𝑌𝑠 : 𝑠 ≤ 𝑡} + 𝛽 inf{𝑌𝑠 : 𝑠 ≤ 𝑡}. Ann. Probab., 24(4):2007–
2023, 1996.

Burgess Davis. Brownian motion and random walk perturbed at extrema.
Probab. Theory Related Fields, 113(4):501–518, 1999.

Dmitry Dolgopyat and Elena Kosygina. Scaling limits of recurrent excited
random walks on integers. Electron. Commun. Probab., 17:no. 35, 14, 2012.

20

REFERENCES

[Dur10]

[Enr02]

Rick Durrett. Probability: theory and examples. Cambridge Series in Statisti-
cal and Probabilistic Mathematics. Cambridge University Press, Cambridge,
fourth edition, 2010.

Nathanae¨l Enriquez. Correlated random walks and their continuous time
counterpart. Pre´publication no. 754 du Laboratoire de Probabilite´s de Paris
6, 2002.

[FGLP14] Laura Florescu, Shirshendu Ganguly, Lionel Levine, and Yuval Peres. Escape
rates for rotor walks in ℤ𝑑. SIAM J. Discrete Math., 28(1):323–334, 2014,
arXiv:1301.3521.

[FKK15] Tobias Friedrich, Maximilian Katzmann, and Anton Krohmer. Unbounded
discrepancy of deterministic random walks on grids. In Algorithms and Com-
putation - 26th International Symposium, ISAAC 2015, Nagoya, Japan, to
appear., 2015.

[HMSH15] Wilfried Huss, Sebastian Mu¨ller, and Ecaterina Sava-Huss. Rotor-routing
on Galton-Watson trees. Electron. Commun. Probab., 20:no. 49, 1–12, 2015,
arXiv:1412.5330.

[HP10]

[HS12]

[LL09]

[Pro03]

[To´t96]

[TW98]

Alexander. E. Holroyd and James Propp. Rotor Walks and Markov Chains.
In M. Marni M. E. Lladser, Robert S. Maier and A. Rechnitzer, editors, Algo-
rithmic Probability and Combinatorics, volume 520 of Contemporary Mathe-
matics, pages 105–126, 2010, arXiv:0904.4507.

Wilfried Huss and Ecaterina Sava. Transience and recurrence of rotor-router
walks on directed covers of graphs. Electron. Commun. Probab., 17:no. 41,
13, 2012, arXiv:1203.1477.

Itamar Landau and Lionel Levine. The rotor–router model on regular trees.
Journal of Combinatorial Theory, Series A, 116(2):421 – 433, 2009.

James Propp. Random walk and random aggregation, derandomized,
2003. http://research.microsoft.com/apps/video/default.aspx?id=
104906.

Ba´lint To´th. Generalized Ray-Knight theory and limit theorems for self-
interacting random walks on Z1. Ann. Probab., 24(3):1324–1367, 1996.

Ba´lint To´th and Wendelin Werner. The true self-repelling motion. Probab.
Theory Related Fields, 111(3):375–452, 1998.

21

REFERENCES

Wilfried Huss, Department of Mathematics, Cornell University, Ithaca,
NY 14850. huss@math.tugraz.at; http://www.math.tugraz.at/˜huss
Lionel Levine, Department of Mathematics, Cornell University, Ithaca,
NY 14850. http://www.math.cornell.edu/˜levine
Ecaterina Sava-Huss, Department of Mathematics, Cornell University,
Ithaca, NY 14850. sava-huss@tugraz.at; http://www.math.tugraz.at/˜sava

22

