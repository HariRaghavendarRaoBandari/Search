6
1
0
2

 
r
a

M
2

 

 
 
]

.

O
C
h
t
a
m

[
 
 

1
v
3
2
9
0
0

.

3
0
6
1
:
v
i
X
r
a

ASYMPTOTIC JOINT DISTRIBUTION OF THE

EXTREMITIES OF A RANDOM YOUNG DIAGRAM AND

ENUMERATION OF GRAPHICAL PARTITIONS

BORIS PITTEL

Abstract. An integer partition of n is a decreasing sequence of positive
integers that add up to [n]. Back in 1979 Macdonald posed a question
about the limit value of the probability that two partitions chosen uni-
formly at random, and independently of each other, are comparable in
terms of the dominance order. In 1982 Wilf conjectured that the uni-
formly random partition is a size-ordered degree sequence of a simple
graph with the limit probability 0.
In 1997 we showed that in both,
seemingly unrelated, cases the limit probabilities are indeed zero, but
our method left open the problem of convergence rates. The main result
−0.11 log n/ log log n, at
in this paper is that each of the probabilities is e
most. A key element of the argument is a local limit theorem, with con-
1/4−ε] tallest columns
vergence rate, for the joint distribution of the [n
1/4−ε] longest rows of the Young diagram representing the
and the [n
random partition.

1. Introduction and main results

A weakly decreasing sequence λ = (λ1, . . . , λm), m = m(λ) ≥ 1, of pos-
itive integers is called a partition of a positive integer n into m parts if
λ1 + ··· + λm = n. We will denote the set of all such partitions λ by Ωn. It
is customary to visualize a partition λ as a (Young-Ferrers) diagram formed
by n unit squares, with the columns of decreasing heights λ1, . . . , λm. We
will use the same letter λ for the diagram representing the partition λ. In-
troduce the positive integers

λ′i =(cid:12)(cid:12){1 ≤ j ≤ m(λ) : λj ≥ i}(cid:12)(cid:12),

so λ′i is the number of parts in the partition λ that are i, at least. Clearly
λ′i decrease and add up to n; so λ′ := (λ′1, . . . , λ′m′ ), (m′ = λ1), is a partition
of [n], usually referred to as the dual to λ.

1 ≤ i ≤ λ1;

The dominance order on the set Ωn is a partial order (cid:22) deﬁned as follows.

For λ, µ ∈ Ωn, we write λ (cid:22) µ if
Xj=1
(1)

i

λj ≤

i

Xj=1

µj,

i ≥ 1;

Date: March 4, 2016.
2010 Mathematics Subject Classiﬁcation. 05A15, 05A16, 05A17, 11P82, 60C05, 60F10.
Key words and phrases. integer partition, Young diagram, tallest column, longest rows,

enumeration, graphical partition, Macdonald/Wilf conjectures, convergence rate.

1

2

BORIS PITTEL

(by deﬁnition λj = 0 for i > m(λ), µj = 0 for j > m(µ)). Under (cid:22),
Ωn is a lattice. Brylawski [4] demonstrated how ubiquitous this lattice is.
For instance, Gale-Ryser theorem (Gale [10] and Ryser [18], Brualdi and
Ryser [3]) asserts: given two decreasing positive tuples α = (α1, α2, . . . , αr),
β = (β1, β2, . . . , βs), there exists a bipartite graph on a vertex set (X, Y ),
|X| = r, |Y | = s, such α and β are the size-ordered degree sequences of
vertices in X and Y respectively, iﬀ Pr
t=1 βt and α (cid:22) β′. The
lattice Ωn is also at the core of the classic description of the irreducible
representations of the symmetric group Sn, see Diaconis [5], Macdonald
[13], Sagan [20], for instance.

t=1 αt = Ps

Soon after [10], [18], Erd˝os and Gallai [6] found the necessary and suﬃ-
cient conditions a partition λ ∈ Ωn, (n even), has to satisfy to be graphical,
i.e. to be a size-ordered degree sequence of a simple graph. According to
Nash-Williams (see Sierksma and Hoogeveen [21] for the proof), the Erd˝os-
Gallai conditions are equivalent to

(2)

i

Xj=1

λ′j ≥

i

Xj=1

λj + i,

1 ≤ i ≤ D(λ);

here D(λ) is the size of the Durfee square of λ, i.e. the number of rows
of the largest square inscribed into the Young diagram λ. Obvious diﬀer-
ences notwithstanding, the Gale-Ryser conditions and the Nash-Williams
conditions are undeniably similar.

Macdonald [13] (Ch.1, Section 1, Example 18) posed a probabilistic ques-
tion, which may be formally interpreted as follows. Let λ, µ ∈ Ωn be chosen
uniformly at random and independently of each other; does P(λ (cid:22) µ) ap-
proach 0 as n → ∞? This question had already been there in the 1979
In 1982 Wilf conjectured that lim P(λ is graphical) = 0;
edition of [13].
apparently he wasn’t aware of Macdonald’s question.

In an attempt to prove Wilf’s conjecture, Erd˝os and Richmond [8] found
an expression for the limiting probability that λ satisﬁes the ﬁrst k conditions
(2) as a 2k-dimensional integral, thus reducing the problem to the question
whether the integral’s value ck → 0 as k → ∞. The authors also showed
that Pn := P(λ is graphical) is of order n−1/2 at least, meaning that if
Pn → 0, it does so rather slowly. Rousseau and Ali [19] demonstrated that
limk→∞ ck ≤ 1/4 and ck ≥ 2−2k(cid:0)2k
k(cid:1); consequently lim sup Pn ≤ 1/4, and ck
cannot approach 0 faster than k−1/2, if indeed ck → 0.
Barnes and Savage [2] discovered a recurrence-based algorithm for com-
puting the total number of graphical partitions of n. They demonstrated
that for n ranging from 2 to 220 the fraction (probability) of graphical par-
titions steadily, but slowly, decreases from 0.5 to 0.3503 . . . , which is still
above the Rousseau-Ali limiting bound 0.25. More recently, Kohnert [12]
derived a new recursion formula that allowed to compute the fraction of
graphical partitions for n up to 910. For n = 910, the fraction is 0.3264 . . . ,

GRAPHICAL PARTITIONS

3

still noticeably exceeding 0.25. Thus, as n runs from 220 to 910, the fraction
decreases by 0.025 only.

In [15] we proved the positive answer to Macdonald’s question. The idea

of the proof, certainly inspired by [8], [19], was to show that

lim
k→∞

lim sup
n→∞

P(cid:0)λ, µ meet the ﬁrst k conditions in (1)(cid:1) = 0.

A key tool was a theorem on the limiting joint distribution of the k largest
parts of the random λ due to Fristedt [9]. We also conﬁrmed Wilf’s con-
jecture by proving that, as Erd˝os and Richmond expected, lim ck = 0. We
did so via a slight modiﬁcation of the proof for Macdonald’s question. The
proofs similarity is due to an implicit discovery in [8] that the limiting joint
distribution of the k largest parts in λ and in its dual λ′ is the same as that
of the largest k parts in two independent partitions of n.

In both cases, we found a way to use Kolmogorov’s 0 − 1 law for the
tail events of a sequence of independent random variables to show that the
limiting probability in question cannot be anything but 0 or 1. And then
we used a central limit theorem to rule out the value 1. So our solution left
open a fundamental question about the actual convergence rates for both
Macdonald’s and Wilf’s probabilities.

Our main result in this paper is that, for n suﬃciently large, each of those

probabilities is

(3)

exp(cid:18)−

0.11 log n

log log n (cid:19) ,

at most. Thus, the bound (3) is negligible compared to any negative power
of log n, but it approaches 0 slower than any n−a, a > 0 being ﬁxed.

We compared the values of this bound and the exact values of the fraction
of the graphical partitions for n = 250, 450, 910, computed in [12]. For what
it’s worth, replacing 0.11 with ≈ 0.326, ≈ 0.321, ≈ 0.315, we get the actual
numerical values of the fraction. Could it be that the expression (3) with
a constant close to 0.25 replacing 0.11 is an asymptotic formula for the
fraction?

As a direct byproduct of our proofs, (3) also bounds P(λ (cid:22) λ′), i.e. the
probability that the random partition λ is both an in-degree sequence and
an out-degree sequence, each being size-ordered, of a directed graph.

As the ﬁrst step, we prove that, for k = [nγ] and γ < 1/4, the total
variation distance of the joint distribution of the k tallest columns and the
k longest rows of the random diagram λ from the distribution of the random
tuple

(4)

 & n1/2

c

log

c

n1/2

j=1 Ej' ,& n1/2
Pi

c

is at most n−1/2+2γ(log n)3. Here E1, . . . , Ek, E′1, . . . , E′k are independent
copies of E, with P(E > x) = e−x.

log

c

n1/2

j=1 E′j'!1≤i≤k
Pi

,

c :=

π
√6

,

4

BORIS PITTEL

We note that Fristedt [9] proved a convergence theorem—in terms of
Prohorov distance, without an explicit convergence rate—for the k = o(n1/4)
tallest columns, or, by symmetry, for the k longest rows, but not for the joint
distribution. In [15] we already observed that Fristedt’s limit theorem can
be reformulated in the form (4). It was this observation that led us to the
argument based on Kolmogorov’s 0 − 1 law.
To show the convergence in terms of total variation distance we use saddle-
point techniques for analysis of Cauchy integrals representing the counts
of restricted partitions, which involve the generating function of restricted
partitions and Freiman’s estimate of the Euler generating function of unre-
stricted partitions.

Using this approximation theorem we reduce, asymptotically, Nash-Williams

conditions (2) to their counterpart involving the sums

Si =

i

Xj=1

Ej, S′i =

E′j.

i

Xj=1

A series of Chernoﬀ-type bounds allows us essentially to embed the resulting
log k
log log k independent events, each of probability
event into an intersection of
≈ P(N ≥ −1/2), N being the standard normal variable. This yields the
bound for Wilf’s P(λ is graphical), and also for P(λ (cid:22) λ′). As for the bound
of Macdonals’s P(λ (cid:22) µ), its proof is the simpliﬁed version of that for Wilf’s
probability, since λ and µ are exactly independent.

2. Joint distribution of the k largest heights and k largest

widths of the random diagram

A partition of n is visualized as the diagram of area n with column heights
decreasing from left to right. Let pn denote the total number of partitions
of n, or equivalently the Young diagrams of area n, i.e. pn = |Ωn|. It is well
known since Euler that

(5)

p(q) :=Xn≥1

qnpn = Yj≥1

(1 − qj)−1,

|q| < 1.

Let pn,r,s denote the total number of the (restricted) diagrams, those with
the tallest column of height ≤ r and the longest (base) row of length ≤ s.
It is also known that

pr,s(q) := Xn≥1

qnpn,r,s =

(6)

Qr+s
i=1 (1 − qi)
Qr
j=1(1 − qj)Qs
(1 − qk) · Yi>r+s

k=1(1 − qk)

(1 − qi)−1,

= p(q) ·Yj>r

(1 − qj) ·Yk>s

GRAPHICAL PARTITIONS

5

see Andrews [1], Section 3.2. Hardy and Ramanujan [11] used the Euler
formula to ﬁnd a series type formula for p(n), whose simple corollary delivers

(7)

p(n) =

eπ√2n/3
4√3n (cid:0)1 + O(n−1/2)(cid:1).

This result can be obtained in a short way via a remarkably simple formula
due to Freiman (see Postnikov [17]):

(8)

(1 − e−ku)−1 = exp(cid:18) π2
Yk≥1

6u

+

1
2

Log

u
2π

+ O(|u|)(cid:19) ,

uniformly for u → 0 within a wedge {u : Im u ≤ εRe u, Re u > 0}, ε >
0 being ﬁxed, and Log standing for the main branch of the logarithmic
function.
(Freiman used (8) to obtain a weaker version of (7) with the
remainder term O(n−1/4+ε).) Our aim is a sharp asymptotic formula for
pn,r,s with r, s of order n1/2 log n. As a warm-up preparation, let us derive
(7).
Lemma 2.1. Let q = reiθ, 0 < r < 1, θ ∈ (−π, π]. Then

|p(q)| ≤ p(r) exp −

Proof. Using an inequality

αrθ2

(1 − r)(cid:0)(1 − r)2 + 2rαθ2(cid:1)

! , α := 2/π2.

see [14], we obtain

(cid:12)(cid:12)(cid:12)(cid:12)

1

1

≤

1 − |z|

1 − z(cid:12)(cid:12)(cid:12)(cid:12)
|p(reiθ)| ≤ p(r) exp
Xj≥1

exp(cid:0)Rez − |z|),

(|z| < 1),

rj(cos(θj) − 1)
 .

Here

Xj≥1

rj(cos(θj) − 1) = −(1 − r)−1 + Re(1 − riθ)−1

= −

r
1 − r
1 − r ·

+ Re
Xj≥1
(1 − r)2 + 2r(1 − cos θ) ≤ −

(reiθ)j
r(1 − cos θ)

 = −

r
1 − r

1 + r

+ Re(cid:18) reiθ(1 − re−iθ)
|1 − reθ|2 (cid:19)
1 − r ·
(1 − r)2 + 2rαθ2 ,

αrθ2

1 + r

= −

since 1 − cos θ ≥ αθ2 for |θ| ≤ π.

(cid:3)

6

BORIS PITTEL

This Lemma and Freiman’s formula yield (7) with a relatively little eﬀort.

First of all, by Cauchy’s integral formula,

(9)

pn = (2πi)−1

z−(n+1)p(z) dz.

Iz=ρeiθ

θ∈(−π,π]

Predictably, we want to choose ρ close to the root of (ρ−np(ρ))′ = 0, or
setting ρ = e−ξ,

Xj≥1
ξ−2(cid:20)Z ∞

0

j

ejξ − 1

= n,

y dy
ey − 1

+ O(ξ)(cid:21) = n.

implying that

Since the integral equals Pj≥1 1/j2 = π2/6, we select ξ = cn−1/2, c =
π√6
. Break [−π, π] in two parts, [−n−δ, n−δ] and [−n−δ, nδ]c, where δ ∈
(2/3, 3/4). Since δ > 1/2, by Lemma 2.1, and Freiman’s formula,

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)
Z|θ|≥n−δ

z−(n+1)p(z) dz(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

(10)

e−α1n3/2−2δ

≤ ρ−np(ρ)Z|θ|≥n−δ
= exp(cid:16)bn1/2 − α2n3/2−2δ(cid:17) ,

dθ

αj > 0 being absolute constants. Consider |θ| ≤ n−δ. Since δ > 1/2, we
have |θ| = o(ξ). So we apply Freiman’s formula for u = ξ − iθ and, using
ξ2 = n−1π2/6, easily obtain

log

p(ρeiθ)
(ρeıθ)n = bn1/2 +

1
2

log

c

2π√n −

1
2ξ

iθ − θ2n3/2γn

(11)
where O(n−1/2) comes from O(|u|) in Freiman’s formula, and

+ iθ3n2γ′n + O(cid:0)θ4n5/2 + n−1/2(cid:1),

γn = c−1(cid:0)1 + O(n−1/2)(cid:1),
(To be sure, there is also a term O(nθ2) in (11), but it is absorbed by the
big Oh-term already there.) For |θ| ≤ n−δ,

γ′n = O(1).

|θ|3n2 ≤ n2−3δ → 0,

θ4n5/2 ≤ n5/2−4δ → 0,

as δ > 2/3. Therefore

exp(cid:18)−

1
2ξ

iθ + iθ3n2γ′n + O(cid:0)θ4n5/2 + n−1/2(cid:1)(cid:19)

= 1 −

1
2ξ

iθ + iθ3n2γ′n + O(cid:0)θ4n5/2 + n−1/2(cid:1).

GRAPHICAL PARTITIONS

7

Consequently, as dz = izdθ,

(12)

I

z−(n+1)p(z) dz = i exp(cid:18)bn1/2 +
exp(cid:0)−θ2n3/2γn(cid:1)(cid:18)1 −

1
2ξ

|θ|≤n−δ

× Z

|θ|≤n−δ

1
2

log

c

2π√n(cid:19)

iθ + iθ3n2γ′n + O(cid:0)θ4n5/2 + n−1/2(cid:1)(cid:19) dθ.

Here

Z
Z
Z

|θ|≤n−δ

|θ|≤n−δ

|θ|≤n−δ

e−θ2n3/2γn dθ = (πc/n3/2)1/2(1 + o(n−1/2)),

1
2ξ

iθ + iθ3n2γ′n(cid:19) dθ = 0,

e−θ2n3/2γn(cid:18)−
e−θ2n3/2γn(cid:0)θ4n5/2 + n−1/2(cid:1) dθ = O(cid:0)n−3/4n−1/2(cid:1).

Using these equations together with (9), (10) and (12) we ﬁnish the proof
of (7).

Let us show how to modify the argument above to obtain an asymptotic

formula for pn,r,s for r, s ≫ n1/2
Lemma 2.2. Let h = h(n) > 0, w = w(n) > 0 be such that h, w = O(nβ),
β < 1/4. If r and s are the integer parts of

log n.

4c

n1/2

c

log

n1/2

,

c
h

n1/2

c

log

n1/2

c
w

respectively, then

pn,r,s =

eπ√2n/3
4√3n

e−h−w(cid:0)1 + O(n−1/2(h + w + 1)2)(cid:1).

Proof. The number pn,r,s is given by the Cauchy integral formula, like (9),
with pr,s(q) instead of p(q). We choose again the circle of radius ρ = e−ξ,

ξ = c/n1/2. On this circle, the product Qi>r+s(1 − qi)−1 in the formula (6)
for pr,s(ρeiθ) is (uniformly) exp (O (ρr+s/(1 − ρ))), and

ρr+s

1 − ρ ∼

so

(13)

exp(cid:0)− log n
c2hw(cid:1)
1 − e−cn−1/2 = O(cid:0)n−1/2hw(cid:1) = O(cid:0)n−1/2(h2 + w2)(cid:1);
Yi>r+s

(1 − qi)−1 = 1 + O(cid:0)n−1/2(h2 + w2)(cid:1).

8

BORIS PITTEL

As for two other products in (6),

(14) Yj>r

(1 − qj)Yk>s

(1 − qk) = exp(cid:20)−
= exp(cid:18)−

qr + qs
1 − q
qr + qs
1 − q

ρ2r + ρ2s

+ O(cid:18)ρr + ρs +
1 − ρ (cid:19)(cid:21)
+ O(cid:0)n−1/2(h2 + w2)(cid:1)(cid:19) .

We use (13) and (14) to bound the contribution of the set {θ : |θ| ≥ n−δ}
to the contour integral. To this end, evaluate ﬁrst
Re (cid:18) eirθ

1 − q(cid:19) −
(1 − 2ρ cos θ + ρ2)(1 − ρ) ·(cid:20)(1 − ρ)(cid:0)cos θr − cos((r − 1)θ)(cid:1)

cos θr − ρ cos((r − 1)θ)

1 − 2ρ cos θ + ρ2

1
1 − ρ
1

1
1 − ρ

−

=

=

+(1 − ρ)2(cid:0)cos((r − 1)θ) − 1(cid:1) + 2ρ(cos θ − 1)(cid:21).

, the expression within the square brack-

Using | sin x| ≤ |x| and ρ = e−c/n1/2
ets is of order

and the denominator exceeds a constant factor times n−1/2(cid:0)n−1 + θ2(cid:1); so

θ2(cid:0)n−1/2r + n−1r2 + 1(cid:1) = O(θ2 log2 n),
Re (cid:18) eirθ
1 − q(cid:19) −
Consequently, as ρr ∼ ch
Re (cid:18) qr
(15)

n−1/2(cid:0)n−1 + θ2(cid:1)
= O(cid:18) θ2nβ log2 n
n−1 + θ2 (cid:19) ,
and the analogous estimate holds for qs
1−q .

= O 
n1/2 and h = O(nβ),

1 − q(cid:19) −

ρr
1 − ρ

1
1 − ρ

θ2 log2 n

! .

Let

|θ| ≥ n−δ,

δ ∈ (max{2/3, 1/2 + β}, 3/4).

The remainder term in (15) is O(cid:0)θ2n1+β log2 n(cid:1). So using also (13), (14),

and then Lemma 2.1, we obtain

|pr,s(ρeiθ)| ≤ 2|p(ρeiθ)| exp(cid:20)−

≤ 2p(ρ) exp(cid:18)−

+ O(cid:0)θ2n1+β log2 n(cid:1)(cid:21)

ρr + ρs
1 − ρ
1 − ρ − α3n3/2−2δ(cid:19) ,

ρr + ρs

as β < 1/2. Here

ρr + ρs
1 − ρ

= h + w + O(cid:0)n−1/2(h + w)(cid:1) = h + w + O(cid:0)n−1/2+β(cid:1).

GRAPHICAL PARTITIONS

9

So, as −1/2 + β < 3/2 − 2δ,

Z

|θ|≥n−δ

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

pr,s(z)

zn+1 dz(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

(16)

ρr + ρs

1 − ρ − α3n3/2−2δ(cid:19)

≤ 4πρ−np(ρ) exp(cid:18)−
≤ exp(cid:16)bn1/2 − h − w − α4n3/2−2δ(cid:17) .

Let |θ| ≤ n−δ. We need a sharp estimate for qr+qs
1−q

computation shows that, for q = ρeiθ,

in (14). An easy

qr
1 − q

=

Here

ρr

ρ

1 − ρ(cid:19) + O((rθ)2)(cid:21)
1 − ρ(cid:20)1 + iθ(cid:18)r +
ρr
1 − ρ (cid:18)r +
1 − ρ

+ iθ

ρr

=

ρ

1 − ρ(cid:19) + O(cid:18) (rθ)2ρr
1 − ρ (cid:19) .

ρr
1 − ρ

= (1 + O(n−1/2))h,

and, since r ∼ n1/2

c

log n1/2/c

h

, h = O(nβ), we have the bounds

|θ|

1 − ρ

max{r, n1/2}ρr
(rθ)2ρr
1 − ρ

= O(n−δhn1/2 log n) = O(cid:0)n1/2+β−δ log n(cid:1) → 0,
=O(n1−2δh log2 n) = O(cid:0)n1+β−2δ log2 n) → 0.
Of course, we have the similar formulas for qs/(1 − q). Therefore

qr + qs
1 − q

= h + w + iθ

ρr

ρ

1 − ρ(cid:19)

1 − ρ(cid:18)r +
1 − ρ (cid:19) + O(cid:0)n−1/2(h + w)(cid:1),

+ O(cid:18)(rθ)2ρr

with the θ-dependent terms approaching zero uniformly for θ in question.
Plugging this expression into (14) and using also (13), we see that the contri-
bution of the interval [−n−δ, n−δ] to the contour integral representing pn,r,s
is obtained via replacing the second factor in the integrand over those θ’s in
(12) with

e−h−w(cid:20)1 + iθ(cid:18)−

1
2ξ

+

ρr

1 − ρ(cid:18)r +

ρ

1 − ρ(cid:19)(cid:19)

+iθ3n2γ′n + O(cid:0)θ4n5/2 + n−1/2(h + w + 1)2(cid:1) + O(cid:18)(rθ)2ρr
1 − ρ (cid:19)(cid:21).

10

BORIS PITTEL

As in the case of pn, the contributions of the iθ-term and the iθ3-term to
the resulting integral are both zero, and we get

I

|θ|≤n−δ

pr,s(z)

zn+1 dz = i exp(cid:18)bn1/2 +

c

1
2

log

2π√n − h − w(cid:19)
n3/4 (cid:0)1 + O(n−1(h + w + 1)2)(cid:1).

(πc)1/2

×

Combining this formula with the bound (16), and dividing by 2πi, we com-
plete the proof of Lemma 2.2.
(cid:3)

Let Λ = (Λ1, Λ2, . . . ) denote the uniformly random partition of n, visu-
alized as the Ferrers diagram Λ with left-to-right ordered columns of de-
creasing heights Λ1 ≥ Λ2 ≥ . . . . Let Λ′ = (Λ′1, Λ′2, . . . ) denote the partition
(Ferrers diagram) dual to Λ; so Λ′j is the length of the j-th longest row of
Λ.

Lemma 2.2 yields an asymptotic formula for the joint distribution of Λ1,

Λ′2, together with a convergence rate.
Corollary 2.3. Introduce H1, W1 by setting

Λ1 =

n1/2

c

log

n1/2

c
H1

, Λ′1 =

n1/2

c

log

n1/2

c
W1

.

If h, w = O(nβ), β < 1/4, then

P(H1 ≥ h, W1 ≥ w) = e−h−w(cid:0)1 + O(n−1/2(h + w + 1)2)(cid:1).

Informally, H1 and W1 are asymptotically independent, each exponentially
distributed with parameter 1.

Proof. Immediate from P(H1 ≥ h, W1 ≥ w) = pn,r,s
h ' , s :=& n1/2

r :=& n1/2

log

n1/2

pn

c

c

c

log

n1/2

c

w ' ,

, with

and Lemma 2.2.

(cid:3)

The limit marginal distributions of Λ1 and Λ′1 were known since the pi-
oneering work of Erd˝os and Lehner [7]. The novelty here is the asymptotic
independence of Λ1 and Λ′1 and the explicit convergence rate. Fristedt [9] ex-
tended the Erd˝os-Lehner result considerably, by establishing the limit joint
distribution of the ﬁrst o(n1/4) largest parts of Λ, thence, separately, the
ﬁrst o(n1/4) largest parts of Λ′, but without an explicit convergence rate.
Our goal is to prove a counterpart of the Fristedt result for the distribution
of the ﬁrst k parts of Λ and jointly the ﬁrst k parts of Λ′, together with an
explicit convergence rate, for k = [nγ], γ < 1/4. We will use some of the
techniques from our studies of the random Young diagram [14] and the ran-
dom solid diagram [16], with the added emphasis on the convergence rates

GRAPHICAL PARTITIONS

11

as related to k, the number of the largest parts of Λ and Λ′ that we focus on.

Let ~λ = (λ1, . . . , λk), ~λ′ = (λ′1, . . . , λ′k) be such that λj and λ′j decrease,

λk > k, λ′k > k, and Pj λj, Pj λ′j ≤ n. A diagram λ of area n, with the

leftmost k tallest columns of height λ1, . . . , λk, and the “bottom-most” k
longest rows of length λ′1, . . . , λ′k, exists iﬀ
k

k

(17)

ν := n −

λj −

Xj=1

Xj=1

λ′j + k2 > 0.

If we delete these k columns and k rows, we end up with a diagram of area ν,
with the tallest column of height r = λk − k at most, and the longest row of
length s = λ′k − k at most. So introducing pn(~λ, ~λ′), the total number of the
diagrams of area n with parameters ~λ, ~λ′, we see that pn(~λ, ~λ′) = pν,r,s. To
apply Lemma 2.2 to pν,r,s, the parameters ν, r = λk − k, s = λ′k − k need to
meet the conditions of this Lemma, with ν playing the role of n, of course.
This observation coupled with the statement of Corollary 2.3, and Fristedt’s
result for the ﬁrst o(n1/4) parts of the random partition is our motivation
for focusing on k = [nγ], γ < 1/4, and the integers λj, λ′j, such that

(18)

λj =

n1/2

c

log

n1/2

c
hj

, λ′j =

n1/2

c

log

n1/2

c
wj

,

1 ≤ j ≤ k,

hj, wj (weakly) increase with j increasing, and

(19)

hk, wk = O(nγ log n);

h1, w1 ≥ n−1/2+2γ.

With ν instead of n in Lemma 2.2 we need to determine h∗ and w∗ such

that

i.e

r = λk − k =& ν1/2

c

log

c

ν1/2

h∗ ' ,

s = λ′k − k =& ν1/2

c

log

c

ν1/2

w∗ ' ,

ν1/2

c

log

ν1/2

ν1/2

c
h∗
ν1/2

c
w∗
Here, by the deﬁnition (17),

log

c

=

=

n1/2

c

n1/2

c

n1/2

log

c

hk − k + O(1)

n1/2

log

c

wk − k + O(1).

(20)

n1/2

c

hjwj

+ O(k)

k

n1/2

log

c

Xj=1

ν = n + k2 −
=n − θ(cid:0)nγ+1/2 log n(cid:1),

θ(A) denoting a reminder term of order A exactly. Using the second line in
(20), and the fact that | log hk|, log wk| are of order log n exactly, we easily

12

BORIS PITTEL

show that h∗, w∗ exist, and are given by

(21)

h∗ =(cid:0)1 + O(nγ−1/2 log2 n)(cid:1)hk, w∗ =(cid:0)1 + O(nγ−1/2 log2 n)(cid:1)wk,

implying that

h∗ + w∗ = hk + wk + O(cid:0)(hk + wk)nγ−1/2 log2 n(cid:1)

= hk + wk + O(cid:0)n2γ−1/2 log3 n(cid:1).

Another simple evaluation, based on the ﬁrst line in (20), yields

(22)

πr 2ν

3

= πr 2n
3 −

It follows then from Lemma 2.2 and (21), (22) that

k

c (cid:17)2
log(cid:16) n1/2

hjwj

k

+ O(cid:0)n2γ−1/2 log n(cid:1).

Xj=1
eπ√2n/3
4√n
× exp(cid:0)−hk − wk + O(n2γ−1/2 log3 n)(cid:1).

c (cid:17)2
(cid:16) n1/2

Yj=1

hjwj

pn(~λ, ~λ′) =

(23)

Note. The RHS of (23) is obviously positive, whence it had better be 1,
at least. And indeed, the RHS approaches inﬁnity for hj, wj meeting the
constraints (19).
Corollary 2.4. Let γ < 1/4. Then, uniformly for (λj, λ′j)1≤j≤k deﬁned in
(18), with hj, wj, (1 ≤ j ≤ [nγ]) satisfying (19),

{Λj = λj, Λ′j = λ′j}


P
 \1≤j≤k
= exp(cid:0)−hk − wk + O(n2γ−1/2 log3 n)(cid:1)

k

Yj=1

hjwj

c (cid:17)2 .
(cid:16) n1/2

To interpret this result gainfully, introduce the “slanted” Λj as follows.
Let E = (E1, . . . , Ek), E′ = (E′1, . . . , E′k) be such that all Ei, E′i are in-
dependent copies of a random variable E, with P(E > x) = e−x, x ≥ 0.
Deﬁne

(24)

(25)

c

Λj =& n1/2
Xi=1

Sj =

j

log

n1/2

c

Sj ' , Λ′j =& n1/2

c

log

c

n1/2

S′j ' ,

j

Ei, S′j =

E′i.

Xi=1

For the generic values u1, . . . uk, v1, . . . , vk of S1, . . . , Sk, S′1, . . . , S′k, the joint
density is e−uk−vk , provided that u1 ≤ ··· ≤ uk, v1 ≤ ··· ≤ vk; the density
is zero otherwise.

GRAPHICAL PARTITIONS

13

Let us compute P(cid:0)∩1≤j≤k{Λj = λj, Λ′j = λ′j}(cid:1). Using (18) and (24), we

obtain that

Λj = λj

Λ′j = λ′j

iﬀ

iﬀ

Sj ∈ I(λj) :=
S′j ∈ I(λ′j) :=

n1/2

c

n1/2

c

e−cλjn−1/2(cid:0)e−cn−1/2
jn−1/2(cid:0)e−cn−1/2

e−cλ′

, 1(cid:3),
, 1(cid:3).

The intervals I(λj) (I(λ′j ) resp.) do not overlap, with inf{x : x ∈ I(λj)} ≥
max{x : x ∈ I(λj−1)} (inf{x : x ∈ I(λ′j)} ≥ max{x : x ∈ I(λ′j−1)} resp.), if
λj−1 − λj ≥ 1 (λ′j−1 − λ′j ≥ 1 resp.). For this choice of λ1, . . . , λk, λ′1, . . . , λ′k,
we have
(26) P

e−u−v du dv.

k−1

{Λj = λj, Λ′j = λ′j}
 =

 \1≤j≤k

Yj=1(cid:12)(cid:12)I(λj)(cid:12)(cid:12)(cid:12)(cid:12)I(λ′j)(cid:12)(cid:12) ZZu∈I(λk)

v∈I(λ′
k

)

c

hj ! = (1 + O(n−1/2))

hj
n1/2

c

,

Next, the leftmost, i.e. the inﬁmum, points of I(λk) and I(λ′k) are respec-
tively

hk(cid:0)1 + O(n−1/2)(cid:1) = hk + O(cid:0)nγ−1/2(cid:1), wk(cid:0)1 + O(n−1/2)(cid:1) = wk + O(cid:0)nγ−1/2(cid:1).

Consequently

(28)

ZZu∈I(λk)

v∈I(λ′
k

)

e−u−v du dv =(cid:0)1 + O(nγ−1/2)(cid:1)

hkwk

c (cid:17)2 e−hk−wk .
(cid:16) n1/2

Combining (26), (27) and (28), we conclude

{Λj = λj, Λ′j = λ′j}

P
 \1≤j≤k

 = (1 + O(nγ−1/2))

k

Yj=1

hjwj

c (cid:17)2 e−hk−wk ;
(cid:16) n1/2

For 1 ≤ j ≤ k,
n1/2

|I(λj)| =

and likewise

So

(27)

c

n1/2

e−cλj n−1/2(cid:0)1 − e−cn−1/2(cid:1)
=(cid:0)1 + O(n−1/2)(cid:1) exp − log
|I(λ′j)| =(cid:0)1 + O(n−1/2)(cid:1)
Yj=1(cid:12)(cid:12)I(λj)(cid:12)(cid:12)(cid:12)(cid:12)I(λ′j)(cid:12)(cid:12) = (1 + O(nγ−1/2))

k−1

wj
n1/2

.

c

k−1

Yj=1

hjwj

c (cid:17)2 .
(cid:16) n1/2

14

BORIS PITTEL

to remind, Λj, Λ′j are deﬁned in (24) and (25). This equation and Corollary
2.4 imply
Lemma 2.5. Let G denote the set of all tuples (λj, λ′j)1≤j≤k deﬁned in (18),
with hj, wj, (1 ≤ j ≤ [nγ]) satisfying (19), and such that λj, λ′j strictly
decrease with j. Uniformly for (λj, λ′j)1≤j≤k ∈ G,

{Λj = λj, Λ′j = λ′j}

P
 \1≤j≤k

 = (cid:16)1 + O(cid:0)n2γ−1/2 log3 n(cid:1)(cid:17)

(29)

Λj,

{Λj = λj, Λ′j = λ′j}
 .
Let us show that whp (Λj, Λ′j)1≤j≤k ∈ G. (1) Recalling the deﬁnition of

× P
 \1≤j≤k

=

2≤j≤k

P(cid:18) min
P(cid:18) Sj
Xj=2

k

(Λj−1 − Λj) = 0(cid:19) ≤
Xj=2
Sj−1 ≤ ecn−1/2(cid:19) =
Xj=2
e−u(1−e−cn−1/2

)−1

k

=

Z0

uj−2
(j − 2)!

Xj=2
= O(k2n−1/2) = O(n2γ−1/2) → 0.

k

∞

k

P(cid:0)Λj−1 − Λj = 0(cid:1)
uj−2
(j − 2)!

ZZ
u ≤exp(cid:16) c
(1 − e−cn−1/2
Xj=2

n1/2 (cid:17)

k

du =

u+v

e−u−v dudv

)j−1

so does Λ′j.

Thus, with probability 1 − O(cid:0)n2γ−1/2(cid:1), Λj strictly decreases, and similarly
(2) Next, for Sk in the formula for Λk we have E(cid:2)ezSk(cid:3) = (1 − z)−k if
z ∈ (0, 1). So, using Chernoﬀ-type bound,
E(cid:2)ezSk(cid:3)
exp(cid:0)znγ log n(cid:1) ≤
The last fraction attains its minimum at z = 1 − 1
(30)
Analogous bound holds for S′k in the formula for Λ′k.
(3) For S1 in the formula for Λ1, and S′1 in the formula for Λ′1,

P(cid:0)Sk ≥ nγ log n(cid:1) ≤ exp(cid:0)−0.5nγ log n(cid:1).

(1 − z)−nγ
exp(cid:0)znγ log n(cid:1)

P(cid:0)Sk ≥ nγ log n(cid:1) ≤

log n , and so

.

Summarizing the bounds in the items (1), (2), (3), we obtain:

a bound matching the bound in the item (1).

(31) P(cid:0)S1 ≤ n−1/2+2γ(cid:1) = P(cid:0)S′1 ≤ n−1/2+2γ(cid:1) = 1 − e−n−1/2+2γ
P(cid:0)(Λj, Λ′j)1≤j≤k ∈ G) ≥ 1 − O(cid:0)n2γ−1/2(cid:1).

(32)

≤ n−1/2+2γ,

GRAPHICAL PARTITIONS

15

Adding up the equations (29) for all (λj, λ′j)1≤j≤k ∈ G and using (32), we
get

(33)

P(cid:0)(Λj, Λ′j)1≤j≤k ∈ G) = 1 − O(cid:0)n2γ−1/2 log3 n(cid:1).

Let µ(~Λ,~Λ′), µ( ~Λ, ~Λ′) denote the probability distribution of (~Λ, ~Λ′) and the

probability distribution of ( ~Λ, ~Λ′). Introduce dT V(cid:0)µ(~Λ,~Λ′), µ( ~Λ, ~Λ′)(cid:1), the total

variation distance between the two distributions, i.e.

dT V(cid:0)µ(~Λ,~Λ′), µ( ~Λ, ~Λ′)(cid:1) := max
here A is a generic subset of the set of all, weakly decreasing, tuples (λj, λ′j)1≤j≤k,
with P1≤j≤k λj ≤ n, P1≤j≤k λ′j ≤ n.

A (cid:12)(cid:12)P(cid:0)(~Λ, ~Λ′) ∈ A(cid:1) − P(cid:0)( ~Λ, ~Λ′) ∈ A(cid:1)(cid:12)(cid:12);

Theorem 2.6. If k = [nγ] and γ < 1/4, then

Consequently, for two generic subsets B1, B2 of all, weakly decreasing, tuples

dT V(cid:0)µ(~Λ,~Λ′), µ( ~Λ, ~Λ′)(cid:1) = O(cid:0)n2γ−1/2 log3 n(cid:1).

(λj)1≤j≤k, with P1≤j≤k λj ≤ n,
Proof. Immediate, based on A = A ∩ G + A ∩ Gc and (29), (32), (33). (cid:3)

P(~Λ ∈ B1, ~Λ′ ∈ B2) = P(~Λ ∈ B1)P(~Λ′ ∈ B2) + O(cid:0)n2γ−1/2 log3 n(cid:1).

3. Graphical Partitions

Our task is to bound Wilf’s probability P (n) := P(Λ is graphical) using
Theorem 2.6. According to Nash-Williams conditions (2), Λ is graphical iﬀ

(34)

i

Xj=1

Λ′j ≥

i

Xj=1

Λj + i,

1 ≤ i ≤ D(Λ),

where D(Λ) is the size of the Durfee square of Λ, i.e. the number of rows of
the largest square inscribed into the Young diagram Λ.

Combining (30), (31) and Theorem 2.6, we see that, with probability

1 − O(cid:0)n2γ−1/2 log3 n(cid:1), all Λj, Λ′j are between an1/2 log n and bn1/2 log n, for
some constants a, b. In particular, with probability this high, Λk/k, Λ′k/k ≫
1, whence D(Λ) ≫ k, and
Xj=1

Λj + i =(cid:0)1 + O(n−1/2)(cid:1)

Xj=1

Λj.

Using this fact and applying Theorem 2.6 yet again, we see that

i

i

(35) P (n) ≤ O(cid:0)n2γ−1/2 log3 n(cid:1)
+P
 \1≤i≤k(cid:26)

n1/2 log n ∈ [a, b](cid:27) k
\i=1

Λ′u

i


Xj=1


i

Λj ≥(cid:0)1 + O(n−1/2)(cid:1)

Xj=1


 ,

Λ′j


16

BORIS PITTEL

where, as we recall,

c

Λj =& n1/2
Λ′j = & n1/2

c

log

log

n1/2

c

Sj ' , Sj =
S′j ' , S′j =

n1/2

c

j

j

Xℓ=1
Xℓ=1

Eℓ,

E′ℓ,

with Eℓ, E′ℓ being independent copies of E, (P(E > x) = e=x). The event
on the RHS of (35) looks more complex than the Nash-Williams conditions
(34), but crucially that event is expressed in terms of eminently tractable
sums of the i.i.d. random variables.

Now, for

we have

Λ′u

n1/2 log n ∈ [a, b],

1 ≤ u ≤ k,

i

i

Xj=1

Λ′j



uniformly for i ≤ k. Thus, for k = [nγ],

Λj ≥(cid:0)1 + O(n−1/2)(cid:1)

⊆
Yj=1


Xj=1

i

S′j

Sj ≥ 1 + O(cid:0)nγ−1/2 log n(cid:1)


,

(36)

P (n) ≤ O(cid:0)n2γ−1/2 log3 n(cid:1) + Pk(n),
2
Pk(n) := P
 .

 min

S
Sj ≥

Yj=1

1≤i≤k

1

′
j

i

That limn→∞ P (n) = 0 was already proved in [15]. We will show that in
fact P (n) → 0 faster than any negative power of log n. To this end, we need
to analyze the likely behavior of the products Qi
Let κ = κ(k) < k be such that κ → ∞, κ = o(k) as k → ∞. Using
Sj − j =Pj
i=1(Ei − 1), we have: for z ∈ (0, 1),

j=1 S′j/Sj.

1 − z(cid:19)j
E(cid:2)exp(z(Sj − j))(cid:3) =(cid:0)E(cid:2)exp(z(E − 1))(cid:3)(cid:1)j =(cid:18) e−z

So, given d > 0, denoting Rj := Sj − j and using Chernoﬀ-type bound, we
estimate

.

1−z(cid:17)j
P(|Rj| ≥ d) = P(cid:0)|Sj − j| ≥ jd(cid:1) ≤ (cid:16) e−z
ezjd = exp(cid:20)j(cid:18)log

The last function attains its minimum at z = d

1+d , and so

e−z

1 − z − zd(cid:19)(cid:21) .

(37)

P(|Rj| ≥ d) ≤ exp(cid:2)j(log(1 + d) − d)(cid:3) ≤ exp(cid:0)−jd2/2(cid:1).

GRAPHICAL PARTITIONS

17

Therefore, picking α > 1/2 and denoting y1 = log(κ − 1), y2 = log k,
P(cid:0)|Rj| ≥ j−1/2(log j)α(cid:1)

Xj=κ

exp(cid:2)(y − y1)(1 − 2αy2α−1

1

)(cid:3) dy

exp(cid:0)−(log x)2α(cid:1) dx

k

k

k

y2

=

≤

Zκ−1

P
 [κ≤j≤k(cid:8)|Rj| ≥ j−1/2(log j)α(cid:9)
 ≤
Xj=κ
exp(cid:0)−(log j)2α(cid:1) ≤
Zy1
Zy1
exp(cid:0)−y2α + y(cid:1) dy ≤ exp(cid:0)−y2α
1 + y1(cid:1)
1 + y1(cid:1) = 2κ exp(cid:0)−(log κ)2α(cid:1),
≤2 exp(cid:0)−y2α
P
 [κ≤j≤k(cid:8)|Rj| ≥ j−1/2(log j)α(cid:9)

∞

so that

(38)

Consider j < κ. First of all, denoting R′j := S′j − j,

 ≤ 2κ exp(cid:0)−(log κ)2α(cid:1),

R′j − Rj =

1
j

j

Xt=1

Yj,

Yj := E′j − Ej,

So

j

1
j

κ−1

κ−1

1
j

,

Yt

Yt =

Xj=t

Xt=1

(R′j − Rj) =Xj<κ
Xj<κ

Xt=1
and, picking ω = ω(κ) → ∞ as κ → ∞, by Chebyshev’s inequality,
(R′j − Rj)
 ≤ (ωκ)−1Var
Xj=1


j

Xt=1
Xj=t



(R′j − Rj) > √ωκ

P
Xj<κ

= 2(ωκ)−1

κ−1

κ−1

κ−1

(39)

1

2

= O(ω−1),

since

2

κ−1

Xt=1

κ−1

Xj=t




2

1

j


≤

≤

κ−1

Xt=1
Xt=1

∞

t

+ log

t (cid:19)2
2(cid:18) 1
κ − 1
t2 + (κ − 1)Z 1

1

0

≤

κ−1

Xt=1(cid:18) 1

t (cid:19)
t2 + log2 κ − 1

log2 x dx = O(κ).

18

BORIS PITTEL

Further, for β > 1, by independence of S′j and Sj we have: for 0 < z < 1,

P(cid:18) S′j
Sj ≥ β(cid:19) = P(cid:0)ez(S ′
≤ E(cid:2)ez(S ′

j−βSj) ≥ 1(cid:1)
j−βSj)(cid:3) =(cid:18) 1

1 + zβ(cid:19)j
1 − z(cid:19)j(cid:18) 1
The function (1 − z)(1 + zβ) attains its maximum at z = β−1
the maximum value is 1 + (β−1)2

. Therefore

.

4β

2β ∈ (0, 1), and

P(cid:18)S′j

Sj ≥ β(cid:19) ≤(cid:18)1 +

4β (cid:19)−j
(β − 1)2

.

For β = βj = 1 +q ω

j ,

1 +

(β − 1)2

4β

=

4j

j + ω

1 +q ω
1 +q ω
1 + √x

j
x

1
4

= f (ω/j),

.

f (x) := 1 +

Consequently

P
 [1≤j<κ(cid:26) S′j

Sj ≥ βj(cid:27)

 ≤Xj<κ

P(cid:18) S′j
Sj ≥ βj(cid:19) ≤ Xj≥1

f (ω/j)−j.

Let us bound the sum. Consider j ≥ ω. Using 1 + x ≥ exp(cid:0)x − x2

2(1−x)(cid:1) for

x < 1,

ω/j

8 ≥ exp(cid:0) ω
9j(cid:1),
f (ω/j)−j ≤ κe−ω/9.

so

f (ω/j) ≥ 1 +
Xj∈[ω,κ]
For j ≤ ω, introducing yj = j/ω,
f (ω/j)−j ≤ [g(yj)]ω,

g(y) :=(cid:18)1 +

1

8√y (cid:19)−y

.

Since (log g(y))′′ > 0,

max

y∈[1/ω,1]

g(y) = max{g(1/ω), g(1)}
√ω
8 (cid:19)−1/ω

= max((cid:18)1 +

,

8

9) =(cid:18)1 +

√ω
8 (cid:19)−1/ω

,

GRAPHICAL PARTITIONS

19

for all ω large enough. Therefore

f (ω/j)−j ≤ f (ω) =(cid:18)1 +

√ω
8 (cid:19)−1

,

and it can be shown that

We conclude that

(40)

Xj∈[1,ω]
P
 [1≤j<κ(cid:26) S′j

f (ω/j) ≤ 2f (ω) =

2

1 +

√ω
8

≤ 16 ω−1/2.

j(cid:27)
Sj ≥ 1 +r ω
 ≤ κe−ω/9 + 16 ω−1/2.

For Pk(n) deﬁned in (36) we obviously have

.

j
Sj

κ−1

1
2

Sj
S ′

ℓ

′
j

Sj
S ′

Yj<κ

min
κ≤ℓ≤k

Further, on the event

j
S
Yj=1
Sj ≥

jo we have
< 1 +q ω

Pk ≤ Pk,1(n) := P
Yj=κ

Observe that on the event E1 :=Tj<κn S ′
j (cid:19)−1
j ≥ Yj<κ(cid:18)1 +r ω
j
≥ exp
 ≥ exp(cid:0)−3√ωκ(cid:1).
−Xj<κr ω
E2 := [κ≤j≤k(cid:8)|Rj| + |R′j| ≤ 2j−1/2(log j)α(cid:9)
1 + Rj
 ≤ exp
Xj=κ

j−1(log j)2α


1 + Rj ≤ exp
Xj=κ

Xj=κ
(R′j − Rj) + 4
(R′j − Rj) + 2(log k)2α+1
Xj=κ
 .

Yj=κ
≤ exp

≤ exp


Xj=κ

ℓ

we have: by log(1 + x) ≤ x,
Yj=κ

1 + R′j

S′j
Sj

=

ℓ

1 + R′j

(41)

log

ℓ

ℓ

ℓ

ℓ

ℓ

1 + Rj 
R′j − Rj


20

BORIS PITTEL

Combining (38), (39), (40) and (41), we arrive at

(42)

Pk(n) ≤ Pk,2(n) + U,
(R′j − Rj) ≥ −V
Xj=1


Pk,2(n) := P


min
κ≤ℓ≤k

ℓ

,

U = U (κ, ω) := 4κ exp(cid:0)−(log κ)2α(cid:1) + κe−ω/9 + 17 ω−1/2,
V = V (κ, ω, k) := 4√ωκ + 2(log k)2α+1;

here α > 1/2 is ﬁxed. We will use (42) for

(43)

in which case

κ =(cid:22)exp(cid:18)(log k)

1

2α(cid:19)(cid:23) , ω = exp(cid:18) 2 log k

log log k(cid:19) ,

(44)

log k

U ≤ U∗ := 18 exp(cid:18)−
V ≤ V ∗ := exp(cid:18) 2 log k

log log k(cid:19) .

log log k(cid:19) ,

Usefulness of this choice of κ and ω will become clearer later.

Let us use independence of Yj = E′j − Ej to show that the event in (42) is
almost contained in the intersection of a sequence of independent events such
that the product of their individual probabilities goes to zero at a certain
explicit rate. Introduce the sequence {ℓr}:
(45)

ℓr = ℓ0ζ r,

ℓ0 = κ,

ζ = ζ(k) = ⌊a(log log k) log k⌋,
% ∼

log k
κ

log(cid:2)a(log log k) log k(cid:3)
Xt=1

Yt,

j

Yt = E′t − Et,

1
j

ℓr

Xj=1

log k

log log k

,

a > 0 being ﬁxed. So

(46) |{r > 0 : ℓr ≤ k}| ≥ ρ = ρ(k) :=$

since by (43) log κ = o(log k). Introducing

ℓr

Zr :=

Xj=1
(R′j − Rj) =
we have: for r ∈ [1, ρ],
1
Xj=1
j
Xt=1

Xt=1
Xj=t

Zr =

Yt =

(47)

ℓr−1

1
j

Yt

+

=

ℓr

ℓr

j

ℓr

ℓr

Yt

Xt=1
Xj=t
Xt=ℓr−1+1

ℓr

Yt

1
j

ℓr

Xj=t

1
j

=: Zr,1 + Zr,2.

Here Zr,1 is measurable with respect to Fr−1, the σ-ﬁeld generated by
Y1, . . . , Yℓr−1, and Zr,2 is independent of Fr−1. Crucially as well, Zr,2 are
mutually independent.

GRAPHICAL PARTITIONS

21

To see, semi-formally, the reason behind our choice of ℓr, observe that,

since Yt are independent and E[Yt] = 0, Var(Yt) = 2,

(48)

Var(Zr,1) = 2

ℓr−1

π2
6

≤

+ ℓr

ℓr

Z0

2

ℓr−1

ℓr

ℓr−1




j


1

≤

Xj=t

Xt=1 (cid:18) 1
Xt=1
(log x)2 dx ≤ (2 + εr)ℓr−1(cid:18)log

t (cid:19)
t2 + log2 ℓr

ℓr

ℓr−1(cid:19)2

,

(εr → 0),

i.e. Var(Zr,1) = O(cid:0)ℓr−1(log log k)2(cid:1). Thus, typically, |Zr,1| is roughly of
order O(cid:0)pℓr−1 log log k(cid:1). As for Zr,2,
Xj=t

t (cid:19)
log2(cid:18) ℓr

Xt=ℓr−1+1

Var(Zr,2) = 2

≥ 2

(49)

ℓr

ℓr

ℓr

2




1

j


(log x)2 dx = 4ℓr,

Xt=ℓr−1+1
∼ 2ℓrZ 1

0

meaning, hopefully, that |Zr,2| assumes values of order √ℓr with not to
too small probability. And the interval [−√ℓr,√ℓr] contains the interval
[−pℓr−1 log log k,pℓr−1 log log k] with room to spare, because

pℓr−1 log log k

√ℓr

= O s log log k
log k ! .

Notice also that √ℓr ≫ V ∗, the bound for V deﬁned in (44), if

r ≥ r∗ :=

3 log k

(log log k)2 ≪ ρ(k) ∼

log k

log log k

.

So we should expect that for those r, conditioned on Fr−1, the probability
that Zr > −V ∗ is close to the unconditional P(Zr,2 > −V ∗) ∼ 1
2 , the latter
holding because Zr,2 and −Zr,2 are equidistributed. Once these steps are
justiﬁed, we will get a bound analogous to, but weaker than the naive bound

Pk,2(n) ≤(cid:18) 1

2

+ o(1)(cid:19)ρ(k)

= exp(cid:0)−(log 2)ρ(k)(cid:1),

see (46) for the deﬁnition of ρ(k).

22

BORIS PITTEL

To start, since E(cid:2)eξY(cid:3) = (1 − ξ2)−1 for |ξ| < 1, we see that, by (48),

−1

ℓr

1

ℓr

1

ℓr−1

ℓr−1

E(cid:2)exp(ξZr,1)(cid:3) =

2

j
1 − ξ2
Yt=1
Xj=t



2
j
≤ exp

Xt=1
Xj=t
ξ2(1 + o(1))



ξ2# .
= exp"(2 + o(1))ℓr−1(cid:18)log
ℓr−1(cid:19)2
for |ξ| = o(cid:0)(log ℓr)−1(cid:1). Consequently, for every such ξ > 0,
ℓr−1(cid:19)2

P(cid:0)Zr,1 ≥pℓr(cid:1) ≤ exp"(2 + o(1))ℓr−1(cid:18)log

ℓr

ℓr

ξ2 − ξpℓr# .

The exponent attains its absolute minimum at

√ℓr

ξ =

(2 + o(1))ℓr−1(cid:16)log ℓr

ℓr−1(cid:17)2 ≪ ζ−(r−2)/2 ≪ (log k)−1 = O(cid:0)(log ℓr)−1(cid:1),

for r ≥ 4, as ℓr ≤ k, meaning that this ξ is (easily) admissible for r ≥ r∗.
For these r and ξ we obtain

P(cid:0)Zr,1 ≥pℓr(cid:1) ≤ exp
−
= exp(cid:18)−

ℓr−1(cid:17)2

(4 + o(1))ℓr−1(cid:16)log ℓr
(4 + o(1)) log log k(cid:19) ,

a log k

ℓr

if k is large enough; see (45) for the ratio ℓr/ℓr−1. Consequently, with
ρ = ρ(k) deﬁned in (46),

(50)

P  ρ
[r=r∗nZr,1 ≥ pℓro! ≤ ρ exp(cid:18)−
= exp(cid:18)−

a log k

(4 + o(1)) log log k(cid:19)
(4 + o(1)) log log k(cid:19) .

a log k

Notice at once that the last RHS dwarfs U∗, see (44), the upper bound for
the term U in the inequality (42) for Pk.

GRAPHICAL PARTITIONS

23

The rest is short. Since the random variables Zr,1 are mutually indepen-

dent, we use (50) to bound

Pk,2(n) ≤ P  ρ
≤ P  ρ
≤ exp(cid:18)−

\r=r∗{Zr ≥ −V ∗}!
[r=r∗nZr,1 ≥ pℓro! + P  ρ
\r=r∗{Zr ≥ −V ∗, Zr,1 ≤pℓr}!
(4 + o(1)) log log k(cid:19) +
Yr=r∗
P(cid:0)Zr,2 ≥ −V ∗ −pℓr(cid:1),

Now, r∗ was chosen to make √ℓr ≫ V ∗, and, by (49), we also know that
Var(Zr,2) ∼ 4ℓr. Since Zr,2 is asymptotically normal with mean 0 and
variance 4ℓr we see that

a log k

ρ

P(cid:0)Zr,2 ≥ −V ∗ −pℓr(cid:1) =

1

√2π Z ∞

−1/2

e−u2/2 du + o(1).

log log k , and r∗ = o(ρ), we obtain

Using this bound and (36), we conclude that, for every γ < 1/4,

Pk(n) ≤ Pk,2(n) + U∗ ≤ exp(cid:18)−
P (n) ≤ O(cid:0)n2γ−1/2 log3 n(cid:1) + exp(cid:18)−

Theorem 3.1. For n large enough,

0.445.. log k

log log k(cid:17) ,
log log k (cid:19) .
log log k (cid:19)(cid:12)(cid:12)(cid:12)(cid:12)k=[nγ]

0.445.. log k

.

P (n) ≤ exp(cid:18)−

0.11 log n

log log n (cid:19) .

Since ρ = ρ(k) ∼ log k
(51) Pk,2(n) ≤ exp(cid:18)−
√2π Z ∞
b < log  1

+  1

−1/2

if

and a > 4b. Observe also that

exp(cid:18)−

see (44). So, by (42),

a log k

(4 + o(1)) log log k(cid:19)
e−u2/2 du + o(1)!

log k

log log k

≤ exp(cid:18)−

b log k

log log k(cid:19) ,

= 0.445...,

−1/2

e−u2/2 du!−1

√2π Z ∞
log log k(cid:19) ≫ U∗ := 18 exp(cid:16)− log k

b log k

24

BORIS PITTEL

4. Pairs of comparable partitions

Almost as an afterthought, let Λ, ∆ be two uniformly random, mutually
independent, partitions of n. Our task is to bound Macdonald’s probability,
i.e.





 .

Λj


Q(n) := P(Λ (cid:23) ∆) = P
\i

i

Xj=1

∆j ≤

i

Xj=1

(Notice that the Durfee squares do not enter the comparability conditions
at all.) This time the tuples (∆j)j≥1 and (Λj)j≥1 are mutually indepen-
dent. Furthermore, the distributions of the sub-tuples, (∆j)1≤i≤[nγ] and
(Λj)1≤i≤[nγ], are each within the total variation distance of order O(cid:0)n−1/2+2γ
log3 n(cid:1) from the distribution of (Λj)1≤i≤[nγ ]; see Theorem 2.6. Thus a sim-

pliﬁed version of the proof of Theorem 3.1 establishes

Theorem 4.1. For n large enough,

Q(n) ≤ exp(cid:18)−

0.11 log n

log log n (cid:19) .

Acknowledgment. Since publication of [15] I repeatedly thought of a
possibility to determine the actual convergence rates for the Macdonald-Wilf
probabilities. A recent letter from Bruce Richmond, who read that paper
very closely, gave me a badly needed push to try to do so ﬁnally. I owe a
debt of gratitude to Bruce for his inspiring feedback.

References

[1] G. E. Andrews, Theory of Partitions, (1976).
[2] T. M. Barnes and C. D. Savage, A recurrence for counting graphical partitions, Elec-

tron. J. Combinatorics 2, # R11 (1995).

[3] R. A. Brualdi and H. J. Ryser, Combinatorial Matrix Theory, (1992).
[4] T. Brylawski, The lattice of integer partitions, Discr. Math. 6 (1973) 201–219.
[5] P. Diaconis, Group Representations in Probability and Statistics, (1988).
[6] P. Erd˝os and T. Gallai, Graphs with given degree of vertices 11 (1960) 264–274.
[7] P. Erd˝os and J. Lehner, The distribution of the number of summands in the partition

of a positive integer, Duke Math. J. 8 (1941) 335–345.

[8] P. Erd˝os and L. B. Richmond, On graphical partitions, Combinatorica 13 (1993)

57–63.

[9] B. Fristedt, The structure of random partitions of large integers, Trans. Amer. Math.

Soc. 337 (1993) 703–735.

[10] D. Gale, A theorem on ﬂows in networks, Paciﬁc J. Math. 7 (1957) 1073–1082.
[11] G. H. Hardy and S. Ramanujan, Asymptotic formulae in combinatory analysis, Proc.

London Math. Soc. (2) 17 (1918) 75–115.

[12] A. Kohnert, Dominance order and graphical partitions, Electron. J. Combinatorics

11, # N4 (2004).

[13] I. G. Macdonald, Symmetric Functions and Hall Polynomials, 2nd Edition, (1995).
[14] B. Pittel, On a likely shape of the random Ferrers diagram, Adv. Appl. Math. 18

(1997) 432–488.

GRAPHICAL PARTITIONS

25

[15] B. Pittel, Conﬁrming two conjectures about the integer partitions, J. Comb. Theory,

Series A 88 (1999) 123–135.

[16] B. Pittel, On dimensions of a random solid diagram, Combinatorics, Probability and

Computing 14 (2005) 873–895.

[17] A. G. Postnikov, Introduction to Analytic Number Theory, (1988).
[18] H. J. Ryser, Combinatorial properties of matrices of 0’s and 1’s, Canad. J. Math. 9

(1957) 371–377.

[19] C. Rousseau and F. Ali, On a conjecture concerning graphical partitions, Congr.

Numer. 104 (1994) 150–160.

[20] B. E. Sagan, The Symmetric Group: Representations, Combinatorial Algorithms, &

Symmetric Functions, (1991).

[21] G. Sierksma and H. Hoogeveen, Seven criteria for integer sequences being graphic, J.

of Graph Theory 15 (1991) 223–231.

Department of Mathematics, The Ohio State University, 231 West 18-th

Avenue, Columbus, Ohio 43210 − 1175 (USA)

E-mail address: bgp@math.ohio-state.edu

