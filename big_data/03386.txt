6
1
0
2

 
r
a

 

M
0
1

 
 
]

M

I
.

h
p
-
o
r
t
s
a
[
 
 

1
v
6
8
3
3
0

.

3
0
6
1
:
v
i
X
r
a

On Bayesian analysis of on–oﬀ measurements

Dalibor Noseka, Jana Noskov´ab

aCharles University, Faculty of Mathematics and Physics, Prague, Czech Republic
bCzech Technical University, Faculty of Civil Engineering, Prague, Czech Republic

Abstract

We propose an analytical solution to the on–oﬀ problem within the framework
of Bayesian statistics. Both the statistical signiﬁcance for the discovery of
new phenomena and credible intervals on model parameters are presented in a
consistent way. We use a large enough family of prior distributions of relevant
parameters. The proposed analysis is designed to provide Bayesian solutions
that can be used for any number of observed on–oﬀ events, including zero.
The procedure is checked using Monte Carlo simulations. The usefulness of
the method is demonstrated on examples from γ–ray astronomy.

Keywords: Bayesian inference, On–oﬀ problem, Source detection,
Gamma–ray astronomy

1. Introduction

We consider an on–oﬀ experiment that is designed for counting two classes
of events, source and background events, the type of which cannot be dis-
tinguished in principle. These events are registered in two disjoint regions
characterized by some sets of coordinates. We deal with small numbers of
events the detection rates of which are modeled as independent Poisson pro-
cesses with unknown means.

The problem of the on–oﬀ measurement we want to solve is whether
the same emitter with a constant but unknown intensity is responsible for
the observed counts in both studied regions. Any inconsistency between
the numbers of events collected in these regions, when they are properly
normalized, then speaks in favor of the predominance of a source producing
more events in one of the explored region over the other.

Email address: nosek@ipnp.troja.mff.cuni.cz (Dalibor Nosek)

Preprint submitted to Nuclear Instruments and Methods A

March 11, 2016

Techniques for addressing these issues from a classical point of view have
been presented in the literature. The likelihood ratio test together with the
Wilks’ theorem [1] are often utilized to characterize asymptotically the level
of agreement between the data and the assumption of new phenomena, see
e.g. Refs. [2–4]. A widely discussed problem is of how to establish upper
bounds of the source intensity for small numbers of detected counts [4–7]. A
Bayesian solution of the on–oﬀ problem was proposed in Refs. [8, 9] when
analyzing multichannel spectra in nuclear physics. More general solutions
can be found in Refs. [10–13]. Very recently, two speciﬁc Bayesian solutions
to the on–oﬀ problem have been presented [14, 15].

In this study, we focus on how to conﬁrm the presence of a weak source
and on the determination of credible intervals for its intensity at a given level
of signiﬁcance. We address these issues from a Bayesian point of view. Our
original intent is to provide diﬀerent insights pertaining to the on–oﬀ problem
that beneﬁt from its simplicity. We do not follow Bayesian alternatives to
classical hypothesis testing that deal with priors for models (hypotheses) and
compare competing models in terms of Bayes factors. In our concept, the
plausibility of possible models for the on–oﬀ data is assessed by parametrizing
the space of models using a suitable parameter. Here we use the diﬀerence
between the on–source and background means inferred from the on–oﬀ mea-
surement, treating these quantities as random variables within the Bayesian
setting. Information on the various aspects of the investigated phenomena
are accessible in the posterior distribution of this diﬀerence.

Our `a priori knowledge about the underlying Poisson processes is consis-
tently improved by using only the on–oﬀ data without any external assump-
tions. By ﬁnding the extent to which the on–source Poisson mean is greater
or less than the background one, this option allows us to obtain a new well–
reasoned formula for the Bayesian probability of the source presence in the
on–source zone. As other Bayesian approaches to the on–oﬀ problem, we also
receive solutions in the case of small numbers, including the null experiment
or the experiment with no background, when classical methods based on the
asymptotic properties of the likelihood ratio statistic [2–4] are not easily ap-
plicable. In addition, our strategy allows us to establish limits on parameters
for the processes that are responsible for the observed phenomena. There are
no problems with the discreteness of counting experiments or with unphys-
ical likelihood estimates, see e.g. Refs. [5–7]. We provide credible intervals
that are likely to be very similar to the way in which the experimental results
are usually communicated.

2

The proposed method is particularly suitable when dealing with pecu-
liar sources whose observational conditions cannot be set in an optimal
way. Examples include transient γ–ray sources and gamma–ray bursts when
searching for an accompanying signal on targets in their space–time vicinity.
This approach can also advantageously be used to assess possible sources of
charged cosmic rays with characteristics hypothesized in previous measure-
ments.

The structure of the paper is as follows. The essential features of our
approach are described in detail in Section 2. We present and discuss gen-
eral formulae for assessing the existence of the source and for estimating its
activity. Particular attention is paid to cases with uninformative priors. Ex-
amples are presented and discussed in Section 3. The paper is concluded
in Section 4.

2. Bayesian solutions to on–oﬀ problem

In a typical on–oﬀ analysis, a measurement of a physical quantity of in-
terest is set by comparing the number of events non recorded in a signal
(on–source) region, where a source is expected, with the number of events
noﬀ detected in a reference (oﬀ–source) region. The on–oﬀ data, especially
when only a few events are recorded, are modeled as discrete random vari-
ables generated in two independent Poisson processes with unknown on–
and oﬀ–source means, µon and µoﬀ, i.e. non ∼ Po(µon) and noﬀ ∼ Po(µoﬀ)1,
respectively.
The relationship between both the on– and oﬀ–source regions is given by
the ratio of on– and oﬀ–source exposures, by the on–oﬀ parameter α > 0.
This parameter includes, for example, the ratio of the observational time for
the two kinds of events and the ratio of their collecting areas modiﬁed by
corresponding experimental eﬃciencies.
Its value is assumed to be known
from the experimental details. It can be estimated from additional measure-
ments or extracted from a model of the detection. Relying upon that, the
unknown mean of background counts in the on–source region is µb = αµoﬀ.
In our treatment, the on–oﬀ problem consists in the assessment of the
relationship between the two unknown on– and oﬀ–source means, µon and
µoﬀ. To solve this task we utilize Bayesian reasoning. It is worth pointing out

1 Throughout this study, we use the same symbols for random variables and their

sample values.

3

that we do not use often adopted scheme, whereby the source and background
parameters, that are responsible for observed on–source counts, are chosen as
the basic independent variables, see e.g. [13–15]. We proceed quite diﬀerently.
In our concept, the Bayesian inference is applied to improve our knowledge
about the observed phenomena without any external assumptions about the
relationship of the underlying processes. We do not compare models with
and without a source in the on–source zone, as usually proposed, i.e. no
hypotheses about the source presence are tested nor Bayes factors for on–
source model selection are examined.
In addition to our `a priori notion
derived from our previous experience or just selected with respect to our
ignorance, for example, we use only experimental data in order to assess
whether a source may be identiﬁed in the on–source region. We also show
how new information may be incorporated in our treatment. This scheme is
not only backed by a compelling statistical motivation, but also fairly simple
to implement, yet suﬃciently general. Nonetheless, our results may deviate
from the results obtained under the assumptions used in other Bayesian
inference methods aiming to analyze the on–oﬀ problem [10–15]. Based on
that, our ﬁndings are to be interpreted diﬀerently in some cases.

In the ﬁrst step of our analysis, we focus on what kind of information
about the on– and oﬀ–source means can be obtained from the on–oﬀ mea-
surements provided that observed counts in both zones follow the Poisson
distribution. Since we have no `a priori knowledge whether or in what way
these means are related, we examine their independent prior distributions.
Using the on–oﬀ data and our prior information about the on– and oﬀ–source
means, we derive their marginal posterior distributions. These distributions
summarize our state of knowledge and remaining uncertainty about the on–
source mean µon and separately about the oﬀ–source mean µoﬀ, given the
data. Thus, the probability that the on–source mean acquires a certain value
is given without reference to values of the oﬀ–source mean, and vice versa.

In the second step, we compare information we have about both inferred
means. Using a known on–oﬀ parameter α, we normalize the oﬀ–source mean
in order to obtain a parameter that corresponds to the on–source exposure,
i.e. we construct the marginal distribution for the parameter µb = αµoﬀ.
Then, we determine which of the observed on–oﬀ processes is more sub-
stantial without any assumptions about the relationship of the underlying
processes. In order to get the most unbiased value of the source probabil-
ity, we assume a maximally uninformative joint distribution of the on–source
and background means, given the on–oﬀ data. For this purpose, we exam-

4

ine the product of their marginal posterior distributions, as dictated by the
principle of maximum entropy, and construct the distribution of their diﬀer-
ence δ = µon − µb with a real valued domain. The probability with which
δ > 0, as inferred from this distribution, tells us what is the probability that
a larger intensity is detected in the on–source region than expected from the
oﬀ–source measurement.

In more detail, the posterior distribution of the diﬀerence δ allows us
to decide whether a source is or is not present in the on–source zone. The
presence of a source in the on–source region is validated if the on–oﬀ data
prefers δ > 0 at a given level of signiﬁcance. On the other hand, if the data
indicates that δ ≤ 0 at a chosen level of signiﬁcance, we state that a source is
not present in the on–source region. Instead, we infer that the data suggests
more activity observed in the oﬀ–source region than in the on–source zone.
Although, in the Bayesian context, the assumption of a non–negative
source rate (δ ≥ 0) is often taken into account by noting that its negative
values are unphysical [10–15], we initially do not require that a source is
present in the on–source region. In this step, our choice of the on– and oﬀ–
source region is regarded as purely formal considering the fact that it is not
clear in advance what the data will reveal. This feature brings our analy-
sis closer to widely used classical methods that strive for knowledge about
the source activity without constraints on the properties of the underlying
processes and beneﬁt just from the maximum likelihood estimates of rele-
vant parameters, see e.g. Refs. [2–7]. In this sense, we adopt more precise
information about the same parameters including their uncertainties. This
information is contained in their marginal posterior distributions obtained
with the help of the on–oﬀ data using the Bayesian reasoning. We end up
with simple expressions that, in agreement with our initial knowledge and
without any additional assumptions, describe what can be learned about the
source presence in the on–oﬀ experiment.

In the ﬁnal step of our analysis, we focus on the important case when it
is known before the measurement is carried out that a source may be present
only in the on–source region. Under this condition, our initial ignorance
about the relationship between the on– and oﬀ–source processes is updated.
With the prior requirement that only the joint distribution of the on–source
and background means satisfying µon ≥ µb (δ ≥ 0) is admissible, the de-
pendence between on– and oﬀ–source processes reappears in the posterior
probability distribution of the non–negative diﬀerence. Using this distribu-
tion, we ﬁnally obtain credible intervals or upper bounds of the intensity of a

5

possible source that is expected in the on–source zone. By their construction,
these limits are to be non–negative. In special cases, we obtain the posterior
distributions of the non–negative diﬀerence that are in agreement with the
distributions of the source rate that have been derived using a joint prior
distribution with dependent on– and oﬀ–source parameters ( µon ≥ αµoﬀ,
µoﬀ > 0) within diﬀerent Bayesian approaches [8–11, 13, 14].

2.1. On–oﬀ means

We consider that non and noﬀ counts were registered independently in
the on– and oﬀ–source regions, respectively. We treat the on– and oﬀ–source
data separately on an equal footing and construct the marginal posterior
distributions of the on– and oﬀ–source means µon and µoﬀ. This way, infor-
mation about the on–source mean contained in its posterior distribution is
given without reference to what is known about the oﬀ–source mean, and
vice versa.

For both these random variables, we adopt a suﬃciently large family of
conjugate prior distributions for the Poisson likelihood function. Speciﬁcally,
we assume that the prior probability distribution of the on–source mean is
p(µon) = fGa(µon | sp, γp − 1) and, in a similar way, the prior distribution
of the oﬀ–source mean is p(µoﬀ) = fGa(µoﬀ | sq, γq − 1), where the Gamma
distribution fGa = fGa(µ | s, λ) is introduced in Appendix A. The prior shape
parameters, sp > 0 and sq > 0, and the prior rate parameters, γp > 1 and
γq > 1, characterize our information about the on– and oﬀ–source zones
before the measurement began.

Here we allow that the prior parameters for the on– and oﬀ–source means
can acquire diﬀerent values. This freedom is due to the fact that we can
have in principle diﬀerent initial knowledge about the on– and oﬀ–source
zone. Such informative prior distributions express our speciﬁc knowledge of
the examined parameters that may be taken from other experiments or from
theoretical considerations, for example. On the other hand, when no such
input information is available, the use of uninformative prior distributions
(small values of the prior parameters, e.g. 0 < s ≤ 1 and γ → 1) typically
yields results which are not too diﬀerent from the results of conventional
statistical analysis.

The posterior distributions of the means µon and µb = αµoﬀ, given the
on–oﬀ data, non and noﬀ, then take again the form of the Gamma distribu-
tion, see Appendix A. In particular, we have µon ∼ Ga(p, γp) for the posterior
distribution of µon and µb ∼ Ga(q, γq
α ) for the posterior distribution of µb.
6

Here, the shape parameters, p = non + sp and q = noﬀ + sq, include, except of
the prior input (sp or sq), also the information acquired from the on–oﬀ mea-
surement (non or noﬀ ). The rate parameters of the posterior distributions of
the on– and oﬀ–source means are given by the prior rates γp and γq, respec-
tively. The rate parameter of the posterior distribution of the background
mean µb is modiﬁed according to the exposures of the on– and oﬀ–source
zones as expressed by the on–oﬀ parameter α.

2.2. Diﬀerence of on–oﬀ means

In the context of a single on–oﬀ measurement, we address a question of
what we are able to learn about the relationship of the underlying Poisson
processes that generate the observed on– and oﬀ–source counts. Since there
is no other relevant information, we assume that the joint probability dis-
tributions of the involved on–source and background means is given by the
product of their marginal posterior distributions, as it results from maximiz-
ing missing information.

With the marginal posterior distributions of the on–source and back-
ground means, µon and µb = αµoﬀ, derived from the on–oﬀ data (see Sec-
tion 2.1), we arrive at the ﬁrst important result of our study. Under the
transformation δ = µon − µb while keeping µb unchanged, with the Jacobian
J = 1, and then marginalizing over µb, we obtain after the standard calcu-
lations the probability distribution of the diﬀerence of these two unknown
means (to simplify the notation we denote fδ(x) = fδ(δ = x | non, noﬀ, I)
where I = (sp, sq, γp, γq, α) stands for prior information)2

fδ(x) =

γp

Γ(p)

α(cid:1)q
p(cid:0) γq
α(cid:1)q
p(cid:0) γq

Γ(q)

γq
α

e

γp

fδ(x) =

e−γpxxp+q−1 U(q, p + q, ηx),

x(−x)p+q−1 U(p, p + q,−ηx),

x ≥ 0,

(1)

x < 0.

(2)

Here p = non + sp and q = noﬀ + sq where sp > 0, sq > 0, γp > 1 and γq > 1
are the prior parameters, η = γp + γq

e−tta−1 dt stands for the

∞

α , Γ(a) =

R0

2 In the following, the explanatory variable x in the probability distribution denotes
the values which the corresponding random variable may acquire, in the sense that, for
example, the probability P (x < δ ≤ x + dx) = fδ(x) dx.

7

Gamma function and

U(a, b, z) =

1

Γ(a)

∞

Z0

e−ztta−1(1 + t)b−a−1 dt,

(3)

is the integral representation of the Tricomi conﬂuent hypergeometric func-
tion [16]. The probability distribution written in Eqs. (1) and (2) is our full
inference about the diﬀerence of the two unknown means µon and µb = αµoﬀ
given the on–oﬀ data. This solution is maximally noncommittal with respect
to unavailable information about the relationship between these means. Note
that, by deﬁnition, the domain of the new random variable δ = µon − µb is
not limited and this diﬀerence may take all real values.
In practical applications, the integrals in Eq. (3) can be calculated nu-
merically. The saddle point approximation can be used with a good precision
if the parameters p > 1 and q > 1. Analytic expressions can be obtained
when selecting particular parameters of the prior distributions.

In some cases, it may be preferred to work with integer values of the
parameters p and q. Then, the Tricomi conﬂuent hypergeometric function
in Eq. (3) may be after some calculations expressed as a ﬁnite series (a, b ∈ N)
(4)

U(a, b, z) = z1−b (b − a − 1)! Q(a, b, z),

where

Q(a, b, z) =

b−a−1

Xi=0 (cid:18) b − i − 2

b − a − i − 1(cid:19)zi

i!

Straightforward calculations then give (p, q ∈ N)

fδ(x) =

fδ(x) =

α(cid:1)q
p(cid:0) γq
γp
ηp+q−1 e−γpx Q(q, p + q, ηx),
α(cid:1)q
p(cid:0) γq
γp
ηp+q−1 e

α x Q(p, p + q,−ηx),

γq

.

x ≥ 0,

x < 0.

(5)

(6)

(7)

Special examples are sp = sq = 1 or a limiting case when sp = sq → 0 (for
non > 0 and noﬀ > 0).
Notice that, if γp = γq, any probabilistic conclusion based on the distri-
bution of the diﬀerence is independent of the choice of the common prior
rate. This property is conﬁrmed when integrating the distribution for the

8

diﬀerence over an arbitrary interval. Indeed, after a suitable transformation
of variables it turns out that the result of integration, and the cumulative
distribution function in particular, depends only on the ratio γp
γq

.

δ(x) where f ′

It is also worth mentioning the following property of the diﬀerence of the
on–source and background parameters. Let us deﬁne a new random variable
δ ′ = −δ/α. Then, it is easy to show that its distribution function, gδ′(x), sat-
isﬁes gδ′(x) = f ′
δ(x) denotes the distribution function of the dif-
ference δ = µon−αµoﬀ, as given in Eqs. (1) and (2), that is obtained under the
transformation (p, q, γp, γq, α) → (q, p, γq, γp, 1
α). Stated diﬀerently, when the
on– and oﬀ–source regions are exchanged, i.e. (non, noﬀ, α) → (noﬀ, non, 1
α ),
and, accordingly, prior information is exchanged, (sp, sq, γp, γq) → (sq, sp, γq, γp),
then the resulting distribution function describes the diﬀerence δ ′ = µoﬀ −
µon/α. Thus, any imbalance between the involved regions leads to the same
statistical conclusion irrespective what is the reference region. Any excess
of counts in one of these zones that suggests the source presence therein is
equivalently described as an unknown process that reduces the number of
events in the complementary region.

From this point of view, it is worth bearing in mind that other classical
test statistics possess the same property. For example, the asymptotic Li–
Ma signiﬁcance, see Eq.(17) in Ref. [2], is in this sense invariant under the
transformation (non, noﬀ, α) → (noﬀ, non, 1
α). In the binomial treatment [3],
the binomial p–value for a deﬁcit of counts in the new on–source region
is equal to the p–value for an excess of counts in the original on–source
zone. Also the asymptotic binomial formula for the source detection, see e.g.
Eq.(9) in Ref. [2], has the same characteristics. In a similar manner, when
the on– and oﬀ–source regions are exchanged, it is easy to show that the
transformed proﬁle likelihood ratio, see e.g. Ref. [7], provides asymptotic
conﬁdence intervals for δ ′ = −δ/α = µoﬀ − µon/α.
2.3. Source detection

With the posterior probability distribution of the diﬀerence we compare
the involved on–source and background means. The Bayesian probability
that the source is not present in the on–source region corresponds to the non–
positive diﬀerence of the on–source and background means. It is obtained by
integrating the probability distribution of the diﬀerence δ given in Eq. (2)
for µon ≤ µb, i.e. δ ≤ 0. After straightforward calculations we get the second
important result of this study. The Bayesian probability of the absence of a

9

source in the on–source region takes a simple form

P − = P (δ ≤ 0) =

0

Z−∞

fδ(x) dx = I ρ

1+ρ

(p, q),

(8)

where ρ = αγp
γq

is determined by B(a, b)Ix(a, b) = Bx(a, b) where Bx(a, b) =

, Ix(a, b) denotes the regularized incomplete Beta function that
ta−1(1−t)b−1 dt
is the incomplete Beta function and B(a, b) = B1(a, b) = Γ(a)Γ(b)
Γ(a+b) denotes the
Beta function [16]. Obviously, the source is observed in the on–source region
with the Bayesian probability

x

R0

P + = P (δ > 0) = 1 − P − = I 1

1+ρ

(q, p).

(9)

For practical reasons, we also deﬁne the Bayesian signiﬁcance by SB =
Φ−1(P +) where Φ = Φ(x) is the cumulative standard normal distribution.
This signiﬁcance corresponds to the number of standard deviations from a
hypothesized value in a classical one–tailed test with a normal distributed
variable [3]. We use notation in which a negative value of this signiﬁcance
indicates that the absence of a source in the on–source region is more likely
than its presence therein, i.e. if P − > 0.5.

The result written in Eq. (9) represents the Bayesian probability of the
source hypothesis, given the on–oﬀ data and our prior knowledge of the un-
derlying processes. It allows us to assess the extent to which the processed
data is indicative of the source of events. This approach diﬀers from the clas-
sical concept designed to measure the exceptional nature of the on–oﬀ data
with respect to the background model. Our determination of the probability
of the source model also diﬀers from the Bayesian strategy based on the ini-
tial premise of the non–negative source rate (µon ≥ µb), see our discussion on
special cases in Sections 2.4.2 and 2.4.3. In a sense, by using a wider range
of alternative models (µon > 0 and µoﬀ = αµb > 0), our approach can yield
more robust information.

The interpretation of the probability of the source presence in the on–
source zone is valid only if the on–oﬀ experiment is well designed in the
sense that only background counts are recorded in the oﬀ–source zone, the
corresponding background applies in the on–source region where an extra
source may be present. Nonetheless, if it is not the case and, for example,

10

an unknown source is present in the oﬀ–source zone or the on–source region
is shielded due to an unknown process, the resultant probabilities apply as
well, but they should be assigned diﬀerent meanings. Naturally, the above
mentioned options can not be distinguished in a statistical evaluation.

The Bayesian probabilities of the source absence or presence in the on–
source region do not depend on the prior rate parameters if γp = γq implying
ρ = α. In such a case, if the parameters p > 0 and q > 0 acquire integer
values, the result in Eq. (8) can be rephrased using the representation of the
binomial distribution. Since the probability P (N ≤ q − 1) = I α
(p, q) [16]
where N is a binomial random variable with parameters p + q − 1 and 1
1+α ,
i.e. N ∼ Bi(p + q − 1,

1+α ), we have (p, q ∈ N)

1+α

1

P − =

q−1

Xi=0 (cid:18)p + q − 1

i

(cid:19)(cid:18) 1

1 + α(cid:19)i(cid:18) α

1 + α(cid:19)p+q−i−1

.

(10)

It gives the probability that less than q events out of p + q − 1 events are
registered in the oﬀ–source region or, alternatively, p or more events out of
p + q − 1 events are detected in the on–source region, if the null background
hypothesis is true, i.e. µon = µb.
Alternatively, when the parameters p > 0 and q > 0 are integers and
(p, q) where
1+α, i.e.
1
1+α). Then, one easily recovers that the probability of the

γp = γq, it also holds that the probability P (N ≤ q − 1) = I α
N is a negative binomial random variable with parameters p and 1
N ∼ NBi(p,
absence of a source in the on–source region is (p, q ∈ N)
1 + α(cid:19)i(cid:18) α
1 + α(cid:19)p

(cid:19)(cid:18) 1

Xi=0 (cid:18)p + i − 1

P − =

(11)

1+α

q−1

i

.

This probability describes that less than q events are registered in the oﬀ–
source region before the chosen number of p events is detected in the on–
source region, if the null hypothesis stating that no source is present in the
on–source region is true.

The above mentioned results written in Eqs. (10) and (11) hold, for exam-
ple, for the uniform prior distributions of the on– and oﬀ–source means when
the prior shape parameters sp = sq = 1 or for the scale invariant prior distri-
butions when sp = sq → 0 (for non > 0, noﬀ > 0), while γp = γq → 1. In both
these cases, the Bayesian probability of no source in the on–source region is

11

similar to the classical probability to reject the background hypothesis, if it
is true, in favor of an excess of the on–source events (excess p–value). Note
that this p–value follows from the classical test of the ratio of two unknown
Poisson means [3].

Interestingly, assuming γp = γq → 1, the probability of the source absence
in the on–source zone derived with the uniform priors (sp = sq = 1) is higher
than the corresponding probability derived with the scale invariant priors
(sp = sq → 0 for non > 0, noﬀ > 0), i.e. P −(sp = sq = 1) > P −(sp = sq → 0),
only if αnon > noﬀ, and vice versa. This result is easily obtained by combining
the recurrence relations for the incomplete Beta function [16].

2.4. Known source

An important case occurs if it is guaranteed with certainty that a source
may be observed only in the on–source region. Then, the mean event rate
in the on–source zone can only increase beyond what is expected from back-
ground. Such a situation is encountered when the ability of the source to
produce detectable events has been conﬁrmed in previous analyses or deduced
from theoretical considerations, for example. In our concept, the additional
knowledge about the source, thought of as a new piece of prior information, is
easily incorporated into the Bayesian inference by conditioning on the source
rate. This modiﬁcation allows us to describe the properties of the predeﬁned
source, thus also providing us with information related to its detection.

Assuming that the on–source mean is not less than the background one,
we are now dealing the case when the processes generating observed counts
in both zones are not independent. For this purpose, we consider the joint
prior of both means that is written in a separable form and supplemented
with the condition µon ≥ µb = αµoﬀ, i.e. δ ≥ 0. Under this condition,
the posterior probability distribution of the non–negative diﬀerence is easily
determined by using the results written in Eqs. (1) and (2). The resultant
distribution allows us to deduce a credible interval or an upper bound of
the source intensity, while there are no problems with negative limits. It is
worth emphasizing that this fairly simple construction of limits is equivalent
to the analysis scheme in which the model with non–negative source intensity
(µon ≥ αµoﬀ) is examined. Therefore, using special kinds of the prior distri-
butions, we arrive to the posterior distributions of the non–negative diﬀerence
which agree with the corresponding posterior distributions of the source in-
tensity obtained in other Bayesian approaches, see Sections 2.4.1, 2.4.2, 2.4.3
and 2.4.4.

12

When one is concerned with the non–negative source rate, the corre-
sponding probability distribution is derived under the condition of non–
negative values of the diﬀerence of the on–source and background means,
i.e. µon ≥ µb = αµoﬀ implying δ ≥ 0. The distribution of the non–negative
diﬀerence then follows from Eq. (1). Another important result of our analysis
that includes several previously derived results [8–11, 13, 14] is

f +
δ (x) =

Γ(q)

γp

α(cid:1)q
p(cid:0) γq

Γ(p + q)B 1

(q, p)

1+ρ

e−γpxxp+q−1 U(q, p + q, ηx),

x ≥ 0,

(12)

where we introduced the conditional distribution f +
P + for x ≥ 0,
P + = 1 − P − is the Bayesian probability that the source is present in the
on–source region, as given in Eq. (9), η = γp + γq
.
In particular, if the parameters p > 0 and q > 0 acquire integer values,
the probability distribution of the non–negative diﬀerence of the on–source
and background means is obtained from Eq. (6) (p, q ∈ N)

α and ρ = αγp

δ (x) = fδ(x)

γq

f +
δ (x) =

fδ(x)

P + = e−γpx Q(q, p + q, ηx)
γp(q, p + q, η)

Q+

,

x ≥ 0,

(13)

where the function Q(a, b, z) is given in Eq. (5) and P + is the probability
that the source is present in the on–source region written

P + =

α(cid:1)q
p(cid:0) γq
γp
ηp+q−1 Q+

γp(q, p + q, η),

where (a, b ∈ N)

Q+

γp(a, b, z) =

∞

Z0

Q(a, b, zx)e−γpx dx =

b−a−1

Xi=0 (cid:18) b − i − 2

b − a − i − 1(cid:19) zi

γi+1
p

(14)

.

(15)

2.4.1. Scale invariant priors

The scale invariant prior for a non–negative random variable corresponds
to a uniform prior of its logarithm. In our treatment, such prior distributions
of the means µon and µoﬀ can be selected only if the numbers of detected on–
and oﬀ–source events are positive. These prior distributions are classiﬁed
by the rate parameters γp = γq → 1, i.e. η = 1+α
α and ρ = α, the shape
parameters sp = sq → 0, i.e. p = non > 0 and q = noﬀ > 0. Hence, for

13

the posterior distributions we have µon ∼ Ga(non, 1) and µb ∼ Ga(noﬀ, 1
α ),
see Appendix A. Then it follows from Eq. (13) that the non–negative diﬀer-
ence of the on–source and background means, µon ≥ µb, is

f +
δ (x) = e−x

,

x ≥ 0.

(16)

non−1

non−1

Pi=0 (cid:0)non+noﬀ −i−2
Pi=0 (cid:0)non+noﬀ −i−2

α (cid:1)i xi
non−i−1 (cid:1)(cid:0) 1+α
α (cid:1)i
non−i−1 (cid:1)(cid:0) 1+α

i!

The same result was presented in Ref. [11].

In our analysis, the Bayesian probability that a source is present in the

on–source region is given explicitly by, see Eq. (14),

P + =(cid:18) 1

1 + α(cid:19)noﬀ non−1

Xi=0 (cid:18)non + noﬀ − i − 2

non − i − 1 (cid:19)(cid:18) α

1 + α(cid:19)non−i−1

.

(17)

2.4.2. Uniform priors

Let us consider the uniform prior distributions of the means µon and µoﬀ.
In such a case, the rate parameters γp = γq → 1, i.e. η = 1+α
α and ρ = α,
the shape parameters sp = sq = 1, i.e. p = non + 1 and q = noﬀ + 1. The
posterior distributions are µon ∼ Ga(non + 1, 1) and µb ∼ Ga(noﬀ + 1, 1
α ),
see Appendix A. Assuming the non–negative diﬀerence of the on–source and
background means, µon ≥ µb, we get from Eq. (13)
α (cid:1)i xi
non−i (cid:1)(cid:0) 1+α
α (cid:1)i
non−i (cid:1)(cid:0) 1+α

Pi=0(cid:0)non+noﬀ −i
Pi=0(cid:0)non+noﬀ −i

f +
δ (x) = e−x

x ≥ 0.

(18)

non

non

i!

,

The same result was obtained in Refs. [10, 13].

The Bayesian probability that a source is present in the on–source region

follows from Eq. (14), namely,

P + =(cid:18) 1

1 + α(cid:19)noﬀ +1 non

Xi=0 (cid:18)non + noﬀ − i

non − i (cid:19)(cid:18) α

1 + α(cid:19)non−i

.

(19)

We note that a quite diﬀerent formula has been advocated in Ref. [13]. Its
justiﬁcation is based on the Bayes factor that accounts for a complex source
model put against a simple background hypothesis. However, as pointed

14

out in Ref. [13], the signiﬁcant disadvantage is that the resultant probability
strongly depends on the choice of the upper bound of the uniform prior used
for the source activity.

Our Bayesian probabilities for the presence or absence of a source in the
on–source region are easily obtained in the case of the null experiment, when
no counts are registered in the on–source region, i.e. non = 0 and p = 1, or
in the experiment with zero background counts, i.e. noﬀ = 0 and q = 1,

P +

non=0 =(cid:18) 1

1 + α(cid:19)noﬀ +1

,

P −

noﬀ =0 =(cid:18) α

1 + α(cid:19)non+1

.

(20)

Both these probabilities depend on the relationship between the on– and
oﬀ–source regions, on the on–oﬀ parameter α. Unlike other results [13], our
approach provides us with well understandable solutions. For example, in the
null experiment (non = 0), the Bayesian probability of the source detection
in the on–source region drops down with the increasing on–source exposure
(increasing α) as well as with the increasing number of registered oﬀ–source
events. If no events are registered at all, we get P +

non=noﬀ =0 = (1 + α)−1.

2.4.3. Jeﬀreys’ priors

The key characteristic of the Jeﬀreys’ prior distribution is that it is in-
variant under a transformation of parameters. Thus, it expresses the same
prior belief no matter which metric is used.

In our notation scheme, Jeﬀreys’ prior distributions of the on– and oﬀ–
source means are of the form introduced in Appendix B. The posterior dis-
tributions are formally constructed if the rate and shape parameters of the
Gamma distributions given in Appendix A satisfy sp = sq = 1
2 and γp =
γq → 1, respectively. Then, the distribution of the diﬀerence is obtained
putting p = non + 1
and ρ = α into the relevant
equations.

2, q = noﬀ + 1

2, η = 1+α

α

In particular, the distribution for the non–negative diﬀerence written
in Eq. (12) implies the recent result based on Jeﬀreys’ rule presented in
Ref. [14]. Indeed, using the identities for the hypergeometric functions [16]

and

a
xa Bx(a, b) = 2F1(a, 1 − b, a + 1, x),

2F1(a, b, c, x) = (1 − x)a

2F1(a, c − b, c,

x
x − 1

),

15

(21)

(22)

one has, in our notation scheme,

2F1(q, 1−p, q+1,

1 + α

1

).

1 + α(cid:19)q

qαqB 1

1+α

) = 2F1(q, p+q, q+1,−

(q, p) =(cid:18) α

1
α
(23)
Substituting this result into Eq. (12) and decoding the values of the param-
eters p, q and η, while γp = γq → 1, the correspondence with the result
written in Eq.(30) in Ref. [14] is evident.
This consistency is due to the above mentioned invariant property of
the Jeﬀreys’ prior.
In our strategy, we started with the two independent
variables µon > 0 and µoﬀ > 0 the prior distributions of which are given
by Jeﬀreys’ rule, see Eq. (B.1) in Appendix B. Choosing a new mean µs =
µon − αµoﬀ ≥ 0 and keeping µoﬀ > 0 unchanged, the bidimensional prior
distribution considered in Eq.(15) in Ref. [14] is easily obtained under this
transformation.

It is worth stressing, however, that the probability of the absence of a
source in the on–source zone that was derived in this study using the distribu-
tion of the diﬀerence (see Section 2.3) diﬀers from the results of Refs. [14, 15]
when Jeﬀreys’ rule for prior distributions is considered. The reason is that
the other methods do not beneﬁt from all input information or do not fully
utilize the Bayesian inference.

In Ref. [14], the determination of the Bayesian probability of the back-
ground hypothesis was based on the questionable argument about how to
choose the ratio of the arbitrary scale factors of the prior distributions of
model parameters. This ratio was derived following the ad hoc assump-
tion that if no counts are observed in both zones, the probabilities of both
the signal and background model remain the same. However, one may suc-
cessfully argue that such a null measurement with no background counts
(non = noﬀ = 0) should update our knowledge about the signal. The point
is that one has additional information since the ratio of the on– and oﬀ–
source exposures is known by deﬁnition. Therefore, the result of the null
experiment with no background counts is to prefer the signal alternative
if 0 < α < 1 (larger oﬀ–source exposure) and vice versa. Unfortunately,
the premise behind the procedure that provides the probability of the back-
ground hypothesis, as advocated in Ref. [14], does not take into account the
possibility of diﬀerent exposures. Interestingly, while the probability of the
no–source hypothesis H0 is assumed to be P (H0 | non = noﬀ = 0) = 1
2 in
Ref. [14], we obtain from Eq. (8) for the Bayesian probability of the absence

16

of a source in the on–source region a more intuitively appealing result

P −

non=noﬀ =0 = I α

1+α

(

1
2

,

1
2

) =

2
π

arctan(√α).

(24)

With the increasing on–source exposure (increasing α), the probability that
a source is not in the on–source region increases if no counts (non = noﬀ = 0)
are detected in both on–oﬀ zones, for the uniform priors see Eq. (20).

In Ref. [15], a predictive distribution of background counts was utilized in
order to assess to what extent the source model is not supported by the on–
oﬀ data. Following Jeﬀreys’ rule, the distribution for the background mean
was modeled as the Gamma distribution with parameters deduced from the
oﬀ–source observation using the method of moments. The signiﬁcance of the
signal deviation from the background hypothesis was established based on
the Poisson–Gamma mixture. In this approach, the on– and oﬀ–source zones
are treated diﬀerently. The resultant p–values are to be interpreted as the
probability of obtaining a result at least as extreme as the observed data if
the null background hypothesis is true. Thus, such an approach does not
fully exploit the Bayesian reasoning and, therefore, it cannot provide us with
information what hypothesis is more likely, given the data.

2.4.4. Known background

The analysis may be adapted for the case of known background with
remaining uncertainty in the on–source zone, for classical results see e.g.
Ref. [5]. Let us assume that the background mean µb is known, but we do
not measure the counts due to the background during the experiment. Such
a situation may be reviewed as the limit q → ∞ (q = noﬀ + sq), α → 0
when qα = µb remains a ﬁnite constant [10]. In our scheme, the diﬀerence of
the two Poisson parameters enlarged by the constant background parameter
follows the Gamma distribution, i.e. µon = (δ + µb) ∼ Ga(p, γp) where
p = non + sp and γp > 1 are parameters for the prior distribution of the
on–source mean. Therefore, the probability distribution of the diﬀerence δ
is then given by (here we have hδ(x) = hδ(δ = x | non, µb, I))

hδ(x) =

γp
p
Γ(p)

(x + µb)p−1e−γp(x+µb),

x ≥ −µb.

(25)

In addition, assuming non–negative values of the diﬀerence δ, i.e. µon ≥ µb,
we have for its probability distribution

h+
δ (x) =

hδ(x)
R+ =

γp
p

Γ(p, µb)

(x + µb)p−1e−γp(x+µb),

x ≥ 0,

(26)

17

where Γ(a, x) =

∞

Rx

ta−1e−t dt is the upper incomplete Gamma function and

R+ = P (δ > 0) =

∞

Z0

hδ(x) dx =

Γ(p, µb)

Γ(p)

,

(27)

is the probability of the presence of a source in the on–source region if the
background mean is known.

Note that for the uniform prior distribution of the on–source parameter,
when p = non + 1 (sp = 1) and γp → 1, the result written in Eq. (26)
was obtained in Ref. [9]. More general expressions with the prior parameter
γp → 1 were presented in Ref. [10].
2.5. Source intensity

With the complete information about the on–oﬀ measurement contained
in the distribution of the diﬀerence δ, we can estimate the source intensity.
We use the shortest credible interval hδ−, δ+i that includes the source inten-
sity at a chosen signiﬁcance level of P . In order to obtain these intervals,
one has to solve numerically

P =

δ+

Zδ−

fδ(x) dx,

fδ(δ−) = fδ(δ+),

(28)

with the indicated condition on interval endpoints, if it can be fulﬁlled.

In those cases when the lower endpoint of a credible interval is negative,
an upper bound for the source intensity is usually required. Its value, δ+, is
determined numerically using the integral in Eq. (28) where we put δ− → −∞
and relax the constraint on interval endpoints.
When it is known that a source may be present only in the on–source
zone (see Section 2.4), we obtain credible intervals for the source intensity
by putting fδ(x) → f +
δ (x) with 0 ≤ δ− into Eq. (28). For upper bounds we
set δ− = 0 while not using the constraint on interval endpoints.

3. Examples

3.1. Source detection signiﬁcance

We present examples which illustrate some of the features of the method
described in Section 2.3 that allows us to assign the probability of the source

18

absence or presence in the on–source zone for a pair of on–oﬀ measurements.
We focused on the cases with small numbers of events. For this purpose,
we use the signiﬁcance derived from the Bayesian probability of the source
presence in the on–source region using the standard normal variate, see Sec-
tion 2.3.
In each example we calculated Bayesian signiﬁcances using the
scale invariant, Jeﬀreys’ as well as uniform prior distributions of the on– and
oﬀ–source means (γ = γp = γq → 1, s = sp = sq, s → 0 or s = 1
2, 1). We
also calculated the asymptotic Li–Ma signiﬁcance [2] with which, relying on
the likelihood ratio method, the no–source hypothesis is rejected if it is true.
We added a sign to the Li–Ma statistic SLM considering it as non–negative
LM,
since the original statistic [2] is equivalent to the absolute value of a standard
normal variable.

if non − αnoﬀ ≥ 0 and negative otherwise, i.e. SLM = sgn(non − αnoﬀ)pS2

In the ﬁrst example, we chose the number of events detected in the oﬀ–
source zone while varying the number of registered on–source counts. We
dealt with two cases. In the ﬁrst case, we assumed that noﬀ = 36 counts were
detected in the oﬀ–source region the exposure of which is 12–times larger than
the exposure of the on–source zone, i.e. α = 1
12 . In the second case, we chose
the same exposures of the on– and oﬀ–source regions (α = 1), and assumed
that noﬀ = 3 events were registered in the oﬀ–source zone. The numbers of
on–source events were small, non ∈ h0, 16i. Note that for non = 0 the scale
invariant and Li–Ma signiﬁcances are not determined. In Fig. 1, our results
obtained within the Bayesian inference are compared with the asymptotic Li–
Ma signiﬁcances [2]. Obviously, better knowledge about background (noﬀ =
36, α = 1
12 ) implies higher absolute values of signiﬁcances. Note that in this
case (noﬀ = 36, α = 1
12), the Bayesian signiﬁcances based on the uniform
prior distributions are larger when compared with the scale invariant results
since αnon < noﬀ = 36, see Section 2.3. The opposite is true in the second
case (noﬀ = 3, α = 1) only when non > noﬀ = 3. The Bayesian signiﬁcances
based on Jeﬀreys’ prior distributions always lie in between results derived
assuming the uniform and scale invariant prior distributions, if the latter
choice is possible (non > 0 and noﬀ > 0).

In the second example, using the Monte Carlo technique, we focused on
the distributions of signiﬁcances for the source detection. We generated 105
pairs of on– and oﬀ–source counts that follow the Poisson distribution with
predeﬁned source and background means, respectively, assuming that they
were registered in the regions of the same exposures (α = 1). We determined
the Bayesian probabilities of the source presence in the on–source region

19

B

S

 
,

M
L

S

4

2

0

-2

Significance

noff = 36, a

 = 1/12

noff =  3, a

 = 1

Li-Ma
Scale
Jeffreys
Uniform

0

5

10

15

non

Figure 1: Signiﬁcances for the source detection are shown as functions of the number
of events detected in the on–source zone for two diﬀerent oﬀ–source measurements.
In the ﬁrst case (thick lines), noﬀ = 36 and α = 1
12 . In the second case (thin lines),
noﬀ = 3 and α = 1. The Li–Ma signiﬁcances are shown in magenta. The Bayes
signiﬁcances for scale invariant (black lines), Jeﬀreys’ (blue lines) and uniform (red
lines) prior distributions were derived from the probability of the source presence
in the on–source region, see Eq. (9).

(see Eq. (9)) and the corresponding signiﬁcances as well as the asymptotic
Li–Ma signiﬁcances [2] for each pair of on– and oﬀ–source counts. In Fig. 2,
we present the signiﬁcance distributions for no source in the on–source zone,
when the on– and oﬀ–source means µon = µoﬀ = 3.2 (light red area and thick
lines). Typically, in about 10% of on–oﬀ pairs, it happened that no events
in the on– or oﬀ–source zone were generated. This results in dips in scale
invariant (thick black line) and Li–Ma (light red area) histograms located
around zero signiﬁcance since, in such cases, the relevant signiﬁcances cannot
be determined.
In Fig. 2, we also show signiﬁcance distributions that we

20

Significance
on= m

 = 1

off = 3.2, a
Li-Ma
Scale
Jeffreys
Uniform

on= 3 m

off = 9.6, a

 = 1

f

0.25

0.2

0.15

0.1

0.05

0

-2

0

2

4

SLM, SB

Figure 2: Distributions of signiﬁcances for the source detection. Histograms for
the Li–Ma signiﬁcances (ﬁlled areas) as well as for the Bayes signiﬁcances using
scale invariant (black lines), Jeﬀreys’ (blue lines) and uniform (red lines) prior
distributions are visualized. Two examples for the same exposures of the on–
and oﬀ–source zones (α = 1) are presented. In the ﬁrst example (light red area
and thick lines), the on– and oﬀ–source counts were generated with the mean
parameters µon = µoﬀ = 3.2.
In the second example (light blue area and thin
dashed lines), the mean parameters were µon = 3µoﬀ = 9.6.

received in the case when the source is present in the on–source region using
µon = 3µoﬀ = 9.6 (light blue and thin dashed lines). In both presented cases,
except the problem with zero counts, the signiﬁcance distributions obtained
using the Bayesian inference, with the scale invariant, Jeﬀreys’ or uniform
prior distributions, are similar to each other as well as to the corresponding
outputs obtained with the help of the asymptotic Li–Ma formula [2].

21

m
m
3.2. Gamma–ray bursts

The method described in Section 2 was applied to the data sets examined
in Refs. [14, 15]. We used information about very high energy (VHE) pho-
tons from gamma–ray bursts (GRB) collected by the VERITAS setup [17]
and by the Fermi Large Area Telescope [18]. These data sets of VHE pho-
tons detected during or shortly after 12 bursts are listed in the ﬁrst four
columns in Table 1. Typically, only a few VHE photons were registered in
the directions of GRBs.
In most cases, the number of collected events is
not too diﬀerent from the corresponding number of events expected from
background.

We assumed the same prior distributions for the on– and oﬀ–source means
with the common shape parameter, s = sp = sq, and zero rate parameters,
i.e. γ = γp = γq → 1. With these restrictions we calculated the distributions
of the diﬀerence of the on–source and background means. The probability
that a source is absent in the on–source region is then given by Eq. (8). We
also determined credible intervals and, if appropriate, upper bounds of the
source intensity at a given level of signiﬁcance as described in Section 2.5.
The conditional distributions of the diﬀerence (µon ≥ µb) for all data
sets are depicted in Fig. 3. These results were obtained with Jeﬀreys’ prior
distributions (s = 1
2 and γ → 1). Speciﬁc properties of the GRB sources are
summarized in Table 1. In this table, we present the Bayesian probabilities
of the absence of a source of VHE photons in the on–source zone (P −).
Negative values of the corresponding Bayesian signiﬁcance (SB) indicate that
the absence of a source in the on–source region is more likely than its presence
therein, i.e. P − > 0.5. For all data sets, we also give credible intervals for
the diﬀerence of the on–source and background means at a 99% level of
conﬁdence. With the distributions of the diﬀerence conditioned on the non–
negative source intensity we reproduce the upper bounds (δ+
+) obtained in
Ref. [14] at the same level of conﬁdence (see Section 2.4.3).

In Table 1, we also present other on–oﬀ results which were obtained within
the classical concept and have, therefore, a diﬀerent meaning. In particular,
we calculated the Li–Ma signiﬁcance [2]. Also conﬁdence intervals derived
using the unbounded likelihood method [7] were determined.
It is worth
stressing that both these classical statistics are obtained asymptotically re-
lying upon the likelihood ratio and the Wilks’ theorem [1]. The asymptotic
conﬁdence intervals or upper bounds are constructed in such way that they
cover an unknown true value of the parameter under consideration with a
speciﬁed probability. The Li–Ma signiﬁcance corresponds to the probability

22

Table 1: GRB data collected by VERITAS [17], GRB 080825C was observed by
Fermi–Lat [18]. The same sets of data as in Refs. [14, 15] are used. GRB as-
signments, measured counts and on–oﬀ parameters α are listed in the ﬁrst four
columns. The Bayesian probability of the absence of a source in the on–source zone
(P −), corresponding signiﬁcance (SB) and Li–Ma signiﬁcance (SLM) are given in
the following three columns. We show credible intervals for the diﬀerence (hδ−, δ+i)
and its upper bounds obtained by assuming that a source may be present only in
the on–source zone (δ+
+ ), both at a 99% level of conﬁdence. Conﬁdence intervals for
the diﬀerence (hδ−, δ+iL) derived in the unbounded proﬁle likelihood method [7]
at the same level of conﬁdence are given in the rightmost column. For Bayesian
results, Jeﬀreys’ prior distributions (s = 1

2 and γ → 1) were used.

GRB

non

noﬀ

α

P −

SB

SLM

070419A
070521
070612B
080310
080330
080604
080607
080825C
081024A
090418A
090429B
090515

2
3
3
3
0
2
4
15
1
3
2
4

14
113
21
23
15
40
16
19
7
16
7
24

0.057
0.057
0.066
0.128
0.123
0.063
0.112
0.063
0.142
0.123
0.106
0.126

0.110
0.923
0.106
0.455
0.932
0.591
0.080
7 10−10
0.441
0.233
0.106
0.282

1.23
-1.43
1.25
0.11
-1.49
-0.23
1.41
6.22
0.15
0.73
1.25
0.58

1.08
-1.48
1.14
0.03

-0.33
1.32
6.36
0.01
0.64
1.12
0.50

hδ−, δ+i

-1.11, 7.74
-6.86, 2.91
-1.50, 8.61
-3.60, 6.92
-3.84, 3.43
-3.03, 5.10
-1.82,10.12
5.05, 26.60
-2.13, 5.64
-2.50, 8.24
-1.04, 6.41
-3.25, 8.63

δ+
+

6.88
6.12
8.00
7.16
4.10
6.12
9.17

5.30
7.64
6.92
8.34

hδ−, δ+iL

-0.88, 7.34
-6.77, 3.58
-1.23, 8.55
-3.37, 7.08
-3.38, 2.40
-2.93, 5.66
-1.42, 9.84
5.86, 26.12
-1.89, 5.19
-2.17, 8.01
-0.99, 7.41
-2.94, 8.66

with which the null background hypothesis is rejected if it is true. We added
a sign to the Li–Ma statistic SLM in order that SLM < 0 if non − αnoﬀ < 0.
There is a clear evidence that VHE photons from GRB 080825C were
detected by the Fermi–Lat instrument [18]. The signiﬁcance of the presence
of a source in the on–source zone, SB = 6.22, provides the same conclusion
as the asymptotic Li–Ma signiﬁcance, as the original ﬁnding [18] and other
results [14, 15]. Our 1σ estimate of the source intensity, δ ∈ h9.75, 17.49i ob-
tained with Jeﬀreys’ prior distributions, corresponds to previously presented
estimates [14, 15, 18].

23

)
x
(

+

f

1

-1

-2

-3

-4

-5

10

10

10

10

10

GRB
Jeffreys prior

080825C
070521
080330

070419A
070612B
080310
080604
080607
081024A
090418A
090429B
090515

40

x

0

10

20

30

Figure 3: Distributions of the diﬀerence conditioned on non–negative values of the
on–source rate for 12 data sets connected with GRB observations [17, 18]. These
results were obtained with Jeﬀreys’ prior distributions for the on– and oﬀ–source
means (s = 1
2 and γ → 1). Full black, blue and red curves are for GRB 080825C,
GRB 070521 and GRB 080330, respectively.

Other data sets of VHE photons collected in the directions of GRBs
show no signature that would distinguish them from background data. The
Bayesian probabilities of the absence of a source in the selected on–source
regions are above 8%, see Table 1. The absolute values of the corresponding
signiﬁcance are below 1.50. Three data sets indicate a deﬁcit of events in the
on–source region, i.e. P − > 0.5 and SB < 0.

Of particular interest are the results derived from the data associated with
GRB 080330 since no on–source event was recorded in this observation. We
recall that the data is easy to evaluate in the Bayesian approach. No special
assumptions or external constraints are needed. The only exception is that
the choice of the scale invariant priors (s → 0) is excluded. Using Jeﬀreys’

24

d
GRB 070521

Scale
Jeffreys
Uniform

)
x
(

+

f
 
,
)
x
(

f

1

-1

-2

-3

-4

-5

10

10

10

10

10

-10

-5

0

5

10

15

x

Figure 4: Distributions of the diﬀerence using the GRB 070521 data. The distri-
butions shown in black, blue and red were obtained with scale invariant (s → 0),
Jeﬀreys’ (s = 1
2 ) and uniform (s = 1) priors, respectively. The thick full curves are
for the distributions determined by assuming that a source may be present only in
the on–source zone. The dashed lines indicate solutions without this information.
Horizontal lines visualize credible intervals at a 99% level of conﬁdence.

prior distributions, our analysis yields the Bayesian probability of the absence
of a source in the on–source zone of about 93%, see Table 1. Our upper
bound for the source intensity is somewhat higher than the estimate which
was obtained by extrapolation within the unbounded likelihood method [7].
With the aim to demonstrate the impact of diﬀerent prior distributions,
we choose the data set of GRB 070521. This data yields the lowest positive
ratio of the number of on–source events with respect to the background
counts expected in the on–source region.
In Fig. 4, various distribution
functions of the diﬀerence for GRB 070521 are shown. Three types of prior
distributions were examined. Namely, we present results based on the scale

25

d
d
GRB

070521

080330

-

P

1

0.8

0.6

0.4

0.2

0

080604

081024A
080310

090515
090418A

070419A
070612B
090429B
080607

080825C

0

0.2

0.4

0.6

0.8

1

s

Figure 5: Probabilities of the source absence in the on–source zone are shown as
functions of the common shape parameter of prior distributions. The thick full
black, blue and red curves are for GRB 080825C, GRB 070521 and GRB 080330,
respectively.

invariant (s → 0, in black), Jeﬀreys’ (s = 1
2, blue) and uniform (s = 1,
red) prior distributions. The depicted distributions were obtained without
(dashed curves) or with (full curves) assuming that a source may be present
only in the on–source zone. The former distributions are used in order to
determine the probability of the source presence in the on–source zone. The
latter conditional distributions are then used for estimating credible intervals
or upper bounds of the source intensity.

In this case, and also for other data sets listed in Table 1, we mostly
obtained very similar results for the three types of prior distributions used
for the on– and oﬀ–source means. This situation is documented in Fig. 5
where the Bayesian probabilities for the source absence in the on–source
zone are shown as functions of the common shape parameter of the prior

26

>

 
++

 
,
 
-+

 

<

 
,
 
++

15

10

5

080825C

GRB

080607
090515
070612B
090418A
080310
090429B
070419A
080604
081024A

070521

080330

0

0.2

0.4

0.6

0.8

1

s

Figure 6: Upper bounds for the diﬀerence at a 99% level of conﬁdence are shown
as functions of the common shape parameter of prior distributions. They were
obtained by assuming that a source may be present only in the on–source zone. The
thick full blue and red curves are for GRB 070521 and GRB 080330, respectively.
A grey band represents the 1σ credible interval for the activity associated with
GRB 080825C.

distributions. The no–source probabilities mostly slowly decrease with the
increasing value of the prior shape parameter, from the scale invariant option
(s → 0) down to the uniform choice (s = 1). The largest decline is found for
the data associated with the observation of GRB 081024A when the lowest
total number of events was detected.

Finally, the 99% upper bounds of the source intensity, and the 1σ credible
interval in case of 080825C, are depicted in Fig. 6 as functions of the com-
mon shape parameter of the prior distributions. These characteristics were
obtained by assuming that a source may be present only in the on–source re-
gion. We learned that the limits of the source intensity are weakly dependent

27

d
d
d
on the prior choice of the common shape parameter for 0 < s ≤ 1.

4. Conclusions

In this study we dealt the issue of detection of a source the activity of
which is immersed in the surrounding background. For this purpose, we
adopted the Bayesian concept that provides, on one side, a uniﬁed and in-
tuitively appealing approach to the problem of drawing inferences from ob-
servations and, on the other side, it oﬀers a powerful and suﬃciently general
framework for determining optimal behavior in the face of uncertainty. As
often reported, the Bayesian inference also allows us to alleviate some of the
issues that aﬀect conventional statistical approaches.

We have proposed a consistent description of the on–oﬀ measurement. We
focused on cases of small numbers of registered events that obey a Poisson
distribution. For the on– and oﬀ–source means, we used an adequately large
class of conjugate prior distributions for the Poisson likelihood function. It
consists of Gamma distributions, each of which is parametrized by two pa-
rameters, by the rate and shape parameter. The Gamma family includes
several interesting and widely used options, i.e. scale invariant, uniform or
Jeﬀreys’ prior distributions.

We examined the distribution of the diﬀerence between the on–source
and background means. This distribution is maximally noncommittal with
regard to their dependence, but it carries all the information available from
the on–oﬀ experiment. Using it, the probability of the presence of a source
in the on–source zone and other source properties are consistently derived
within the Bayesian concept and, therefore, have well deﬁned meaning. We
stress that our interpretation of the on–oﬀ data is diﬀerent from reasoning
behind hypothesis testing, regardless of whether the test is conducted in a
classical or Bayesian framework.

The distribution of the diﬀerence is well suited for weak sources whose
observations may reveal a signal either in the on–source or oﬀ–source zone,
due to experimental limitations, for example. Except one case, the proposed
Bayesian solutions can be used for any number of on–oﬀ counts, including the
null experiment or the experiment with no background. To our knowledge,
such results of the Bayesian inference have not yet been discussed in the
literature. By conditioning on the values of the diﬀerence we obtained a
probability distribution that allows us to describe the on–oﬀ problem with
a preassigned source in the on–source region the activity of which is to be

28

examined. In this case, the resultant conditional distribution includes several
results that have previously been obtained in other Bayesian approaches.
Using this distribution, well reasoned limits of the source activity are easily
determined.

We also presented several numerical examples that may serve as guides for
practical applications. In most cases, when little is known about investigated
phenomena, it turned out that the scale invariant, if applicable, or uniform
prior distributions are good choices. The corresponding formulae reduce
to simple algebraic sums, as described in Sections 2.4.1 and 2.4.2 provided
that a source may be present only in the on–source zone. The Bayesian
inference using Jeﬀreys’ prior distributions should be a better compromise.
However, this option, as well as the choice of informative priors, requires
more complicated calculations based on integral expressions.

Appendix A. Bayesian inference with Poisson likelihood

We consider that the number of events registered in a counting exper-
iment, a random variable n, obeys the Poisson distribution with a mean
µ > 0, i.e. n ∼ Po(µ). The probability to observe n events (n = 0, 1, . . .) is
(A.1)

e−µ.

PPo(n | µ) =

µn
n!

Our aim is to deduce some information about the Poisson mean µ from a
measurement in which n counts were registered. For this purpose, we adopt
the Bayesian reasoning. The probability distribution of the Poisson mean to
have the value µ > 0 is found by means of Bayes’ theorem

f (µ | n) ∝ L(µ | n)p(µ),

(A.2)

where L(µ | n) = PPo(n | µ) is the likelihood function and p(µ) denotes the
prior distribution of the mean µ.
The problem is solved once we specify the form of the prior distribution.
To this end, we use Gamma distributions that provide a family of conjugate
prior distributions for the Poisson likelihood function

p(µ) = fGa(µ | s, λ) =

λs
Γ(s)

µs−1e−λµ,

(A.3)

where s > 0 is the shape parameter, λ > 0 denotes the rate parameter
and Γ(s) is the Gamma function. Notice that the mean and variance of

29

a random variable obeying the Gamma distribution are E(µ) = λ−1s and
Var(µ) = λ−2s, respectively. Hence, with the increasing value of the shape
parameter s, the prior distribution is peaked at larger values around a mode
λ−1(s− 1). With the increasing value of the rate parameter λ, that shifts the
position of the mean towards lower values, the prior distribution becomes
narrower.

The Gamma family of prior distributions is suﬃciently large. The two
prior parameters s and λ may be chosen to contain our degree of belief about
the problem before the experiment is conducted. Notice that traditionally
accepted prior assumptions about the studied parameter are included among
these possibilities. For example, in a limiting case, if λ → 0, the choice s = 1
represents the uniform prior, s = 1
2 is for the Jeﬀreys’ prior (see Appendix B)
and, if n > 0, then the scale invariant prior distribution with s → 0 may be
selected.
The posterior distribution of the Poisson mean µ then depends on the
prior choice and experimental data.
If n events were collected, one easily
ﬁnds that µ ∼ Ga(p, γ), where p = n + s > 0 and γ = λ + 1 > 1, follow
from Eq. (A.2) for the prior distributions chosen from the Gamma family
deﬁned in Eq. (A.3). Hence, the posterior distribution function is

f (µ | n) = fGa(µ | p, γ) =

γp
Γ(p)

µp−1e−γµ.

(A.4)

Let us ﬁnally note, that for the random variable µ′ = kµ, where k > 0 is a
constant, one obtains µ′ ∼ Ga(p, γ
k ).

Appendix B. Jeﬀreys’ prior

By deﬁnition, the Jeﬀreys’ prior is proportional to the square root of the
determinant of the Fisher information. In the case of a single–valued Poisson
mean µ > 0, it is written

p(µ) ∝s−E(cid:20) ∂2 ln L(µ | n)

∂2µ

(cid:21) =

1
√µ

,

(B.1)

where L(µ | n) = PPo(n | µ) is the likelihood function given in Eq. (A.1) and
E denotes the mean value with respect to the Poisson model under study.

Acknowledgment: We would like to thank the two unknown reviewers
for their constructive criticism and many useful suggestions that helped us

30

with the presentation of our study. This work was supported by the Czech
Science Foundation under project 14-17501S.

[1] S.S.Wilks, Ann.Math.Stat. 9 (1938) 60.

[2] T.P.Li, Y.Q.Ma, Astrophys.J. 272 (1983) 317.

[3] R.D.Cousins, J.T.Linnemann, J.Tucker, Nucl.Instrum.Methods A 595

(2008) 480.

[4] G.Cowan, K.Cranmer, E.Gross, O.Vitells, Eur.Phys.J. C71 (2011), 1554;
G.Cowan, K.Cranmer, E.Gross, O.Vitells, Eur.Phys.J. C73 (2013) 2501.

[5] G.J.Feldman, R.D.Cousin, Phys.Rev. D57 (1998) 3873.

[6] R.D.Cousins, Nucl.Instrum.Methods A 417 (1998) 391.

[7] W.A.Rolke, A.M.L´opez, J.Conrad, Nucl.Instrum.Methods A 551 (2005)

493.

[8] O.Helene, Nucl.Instrum.Methods 212 (1983) 319.

[9] O.Helene, Nucl.Instrum.Methods 228 (1984) 120.

[10] H.B.Prosper, Nucl.Instrum.Methods A 241 (1985) 236.

[11] H.B.Prosper, Phys.Rev. 37 (1988) 1153.

[12] S.Gillesen and H.L.Harney, Astron.Astrophys. 430 (2005) 355.

[13] P.Gregory, Bayesian Logical Data Analysis for the Physical Sciences,

Cambridge, Cambridge University Press, 2005, (Chapter 14).

[14] M.L.Knoetig, Astrophys.J. 790 (2014) 106.

[15] D.Casadei, Astrophys.J. 798 (2015) 5.

[16] F.W.J.Olver, D.M.Lozier, R.F.Boisvert, C.W.Clark (eds.), NIST Hand-
book of Mathematical Functions, Cambridge University Press, Cam-
bridge, 2010, (Chapters 8, 13 and 15).

[17] V.A.Acciari et al., Astrophys.J. 743 (2011) 62.

[18] A.A.Abdo et al., Astrophys.J. 707 (2009) 580.

31

