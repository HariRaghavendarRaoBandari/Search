6
1
0
2

 
r
a

 

M
8
1

 
 
]
E
M

.
t
a
t
s
[
 
 

1
v
8
3
9
5
0

.

3
0
6
1
:
v
i
X
r
a

Eﬃcient and powerful familywise error control in genome-wide

association studies using generalized linear models

K. K. Halle1,2 Ø. Bakke1, S. Djurovic3,4, A. Bye7, E. Ryeng8,

U. Wisløﬀ7, O. A. Andreassen5,6 and M. Langaas1

1Department of Mathematical Sciences, Norwegian University of Science and Technology, NO-7491
Norway. 2Liaison Committee between the Central Norway Regional Health Authority (RHA) and
the Norwegian University of Science and Technology (NTNU), Trondheim, Norway. 3NORMENT,
K. G. Jebsen Centre for Psychosis Research, Department of Clinical Science, University of Bergen,
Bergen, Norway. 4Department of Medical Genetics, Oslo University Hospital, Oslo, Norway.
5NORMENT, K. G. Jebsen Centre for Psychosis Research, Division of Mental Health and Addic-
tion, Oslo University Hospital and Institute of Clinical Medicine, University of Oslo, Oslo, Norway.
6Institute of Clinical Medicine, University of Oslo, NO-0318 Oslo, Norway. 7K.G. Jebsen Centre for
Exercise in Medicine, Department of Circulation and Medical Imaging, Faculty of Medicine, Nor-
wegian Institute of Science and Technology, Trondheim, Norway. 8Department of Cancer Research
and Molecular Medicine, Norwegian University of Science and Technology, NO-7491 Trondheim,
Norway.

18 March 2016

Abstract

In genetic association studies, detecting phenotype–genotype association is a primary
goal. We consider testing a large number of common genetic variants, and stress the im-
portance of controlling the familywise error rate. Multiple testing correction methods may
achieve this by estimating a local signiﬁcance level for the individual tests. We assume that
data – phenotype, genetic markers and environmental covariates – are available from in-
dependent individuals in a case–control, cohort study or cross-sectional study. Further, we
assume that the relationship between the phenotype and the genetic and environmental co-
variates can be modelled by a generalized linear model (GLM). We use a multivariate score
statistic, which under the complete null hypothesis of no phenotype–genotype association
asymptotically has a multivariate normal distribution with a covariance matrix that can be
estimated from key features of the ﬁtted GLM model, under the complete null hypothesis,
and the genetic markers. For common genetic variants, it is well known that the genotype
correlation between variants can be markedly non-zero. We use an approximation to the dis-
tribution of the complete multivariate score test statistics to estimate the local signiﬁcance
level. We show, using simulated and real data (one study on schizophrenia and bipolar dis-
order and one study on maximal oxygen uptake), that our method is a powerful alternative
to the popular Bonferroni method. For GLMs without environmental covariates, we show
that our method is an eﬃcient alternative to permutation methods for multiple testing.
As a byproduct, the local signiﬁcance level can be used to deﬁne an eﬀective number of
independent tests.

Key words: FWER control, error bounds, FWER approximation, local signiﬁcance level,

eﬀective number of independent tests, generalized linear model, MSM, the HUNT study.

1

Introduction

In Genome-Wide Association (GWA) studies the aim is to test for association between genetic
markers and a phenotype. A large number of markers are tested simultaneously, and it is

1

important to control the overall Type I error rate. Multiple testing correction methods may
achieve this goal by estimating a local signiﬁcance level for the individual tests. In this work
we present a new method for ﬁnding a local signiﬁcance level in multiple hypothesis testing for
correlated common variants, as is often observed in GWA studies.

Assume that we have collected independent individual observations in a case–control, cohort
or cross-sectional study. The phenotype of interest can be continuous or discrete. We consider
biallelic genetic markers, giving three possible genotypes. For each genetic marker we specify a
hypothesis situation, where the null hypothesis is of the type “no association between the phe-
notype and genetic marker” and we have a two sided alternative. We will model the data using
a generalized linear regression model (GLM) with phenotype as response (exposure), genotype
as the independent variable of interest, and possibly non-genetical, referred to as environmental,
independent covariates (not of interest) in the model. In epidemiological studies, a confounder
is a common factor which is associated with both the exposure and outcome. In GWA studies,
population substructure may be associated with both the exposure (genotype) and outcome
(phenotype) and therefore may be a confounding factor and need to be adjusted for in the
analysis. Population stratiﬁcation can be adjusted for by including principal components of the
genotype covariance matrix of the individuals as covariates in the model. As test statistics for
the multiple hypothesis problem we use the score test statistics to evaluate the genotype contri-
bution to the model for each genetic marker separately. We calculate the score test statistics for
the contribution of each genotype separately. It is known that the vector of separate score test
statistics asymptotically follows a multivariate normal distribution with a covariance matrix
that can be estimated using key features of the ﬁtted GLM model and the genetic markers
(Schaid et al., 2002; Seaman and M¨uller-Myhsok, 2005). This has also been a key ingredient in
the work of Conneely and Boehnke (2007).

Further, we show that for the special case when no environmental covariates are present there
is a simple relationship between the Pearson correlation between genotypes and the correlation
between score test statistics.

In a multiple testing situation with m tests the familywise error rate (FWER) can be con-
trolled at level α by specifying a local p-value cut-oﬀ, αloc, to be used for all the m hypothesis
tests. Inspired from the work of Moskvina and Schmidt (2008) and Dickhaus and Stange (2013)
we will use an approximation to the m-dimensional simultaneous multivariate normal distribu-
tion of the score test statistics vector to estimate αloc. The αloc estimate can be used to deﬁne
an eﬀective number of independent tests.

This method is more powerful than the ˇSid´ak method (which assumes that the score test
statistics are independent across markers) and the Bonferroni method (which is valid for all
dependence structures between the score test statistics). Further, it is more eﬃcient than the
method of Conneely and Boehnke (2007) and in Section 5 we will see that this method depends
on numerical integration and is computationally intensive. The Westfall-Young permutation
procedure is known to have asymptotically optimal power for a broad class of problems, in-
cluding block-dependent and sparse depencence structure (Meinshausen et al., 2011). However,
this method is computer intensive and to have a valid permutation test, the assumption of
exchangeability needs to be satisﬁed (Commenges, 2003). This assumption is in general not
satisﬁed when environmental covariates are present in the model.

We will use two genetic datasets presented in Athanasiu et al. (2010), Djurovic et al. (2010),

Aspenes et al. (2011) and Loe et al. (2013) to illustrate our method applied to real data.

The paper is organized as follows. In Section 2 we present statistical background on the
score test, and derive expressions for the score test covariance matrix, which is of importance
for the subsequent work. Our proposed method is outlined and presented in detail in Section
3, together with characteristics of our method. In Section 4 simulated and real data is used to

2

evaluate our proposed model and compare to other methods. Finally, we discuss in Section 5
and conclude in Section 6.

2 Statistical background

In this section, we present notation and details on the score test in generalized linear models.

2.1 Notation and data

We assume that data – phenotype, m genetic covariates and d environmental covariates – from
n independent individuals are available in a case–control, cohort or cross-sectional study. Let
Y be an n-dimensional vector having the phenotype Yi of individual i as its ith entry, i = 1,
. . . , n. Let Xe be an n × d matrix having environmental covariates (the ﬁrst one being 1 to
allow for an intercept in the model presented below) for individual i as its ith row, and let Xg
be an n× m matrix having genetic covariates, or genotypes, for individual i as its ith row, each
column corresponding to a locus.

We assume that the genetic data are from common variant biallelic genetic markers with
alleles a and A, where A is the minor allele. We will use the additive coding 0, 1, 2 for the
genotypes aa, aA, and AA, respectively in the genetic covariate matrix Xg, but other coding
schemes are also possible. We denote the total design matrix X = (Xe Xg), which has the total
covariate vector for individual i as its ith row.

2.2 Testing statistical hypotheses with the score test

e βT

We assume that the relationship between the phenotype Y and covariates X can be modelled by
a generalized linear model (GLM) (McCullagh and Nelder, 1989) with an n-dimensional vector
η = Xeβe + Xgβg = Xβ of linear predictors, where β = (βT
g )T is a d + m-dimensional
parameter vector. Let ηi be the ith entry of η, and let µ be the n-dimensional vector having
µi = EYi as its ith entry. We assume that the link function g deﬁned by ηi = g(µi) of the GLM is
canonical, which implies that the log likelihood for individual i is li = (Yiηi−b(ηi))/φi +c(Yi, φi),
where b and c are functions deﬁning the exponential family of the phenotypes and φi the
dispersion parameter. In our context φi = φ will be equal for all observations. In general,
µi = b(cid:48)(ηi) and Var Yi = σ2
i = σ2 = φ,
and for Yi Bernoulli distributed, σ2

The full d + m-dimensional score vector(cid:80)n

i = φb(cid:48)(cid:48)(ηi). For Yi normally distributed, this reduces to σ2
i=1 ∇βli can then be calculated to be
X T (Y − µ),

i = µi(1 − µi) with φ = 1.

U =

1
φ

which is asymptotically normal with mean 0 and covariance matrix

V =

1
φ2 X T ΛX,

where Λ is the diagonal matrix having σ2

i as its ith entry.

Partition U into its environmental and genetic components, U T = (U T

g ). Since βe are
nuisance parameters and unknown, they are estimated by their maximum likelihood estimates
under the null hypothesis. In eﬀect, µ is to be replaced by ˆµe, the ﬁtted values in a model with
only environmental covariates Xe present, giving the statistic

e U T

Ug|e =

g (Y − ˆµe).
X T

1
φ

3

(1)

Then Ug|e has the conditional distribution of Ug given Ue = 0, which is asymptotically normal
with mean 0 and covariance matrix
Vg|e = Vgg − VgeV −1

(cid:0)Λ − ΛXe(X T

e Λ(cid:1)Xg,

e ΛXe)−1X T

ee Veg =

(2)

1
φ2 X T

g

where Vee, Veg, Vge and Vgg are the upper left d × d, upper right d × m, lower left m × d and
lower right m × m submatrices of V , respectively (see Smyth, 2003).

The score test statistic U T

g|e Ug|e with βg = 0 s asymptotically χ2 distributed with m
degrees of freedom when the complete null hypothesis βg = 0 is true (see Smyth, 2003). However,
our interest lies not in the complete null hypothesis, but in the m individual hypotheses βgk = 0
for each component βgk of βg, k = 1, . . . , m. We consider the standardized components of Ug|e,

g|eV −1

Tk =

,

(3)

where Ug|e k denotes the kth entry of Ug|e and Vg|e kl the kl entry of Vg|e. Under the null
hypothesis βgk = 0, Tk is asymptotically standard normal distributed, and under the complete
null hypothesis βg = 0, the vector of test statistics T = (T1, T2, . . . , Tm) is asymptotically
multivariate standard normally distributed with covariance matrix R, having

Cov(Tk, Tl) =

,

(4)

Ug|e k(cid:112)Vg|e kk

(cid:112)Vg|e kkVg|e ll

Vg|e kl

as its kl entry. all evaluated at βg = 0. Note that the dispersion parameter φ is cancelled from
T and the covariances. However, the σ2

i of Λ will have to be estimated.

2.3 Special cases

We will now look at Ug|e and Vg|e for some special cases.

2.3.1 No environmental covariates

If no evironmental covariates except the intercept are present in the GLM, then Xe = 1, the
n-dimensional vector having all entries equal to 1, and Λ = σ2I under the null hypothesis, where
I is the n × n identity matrix. Then

(cid:16)

11T(cid:17)

Ug|e =

1
φ

X T
g

I − 1
n

Y

and

Vg|e =

Xg,

so that

Tk =

(cid:113)
k (I − 1
xT
k (I − 1
xT

n 11T )Y
n 11T )xk

and

Cov(Tk, Tl) =

σ

√

n 11T )xl
(5)
where xk is the kth column of Xg, 1 ≤ k, l ≤ m. Thus, Tk, the score test statistic for testing
n times the Pearson correlation between xk and Y when σ2 = Var Yi is replaced by
βgk = 0, is
the estimate Y T (I − 1
n 11T )Y /n, and Cov(Tk, Tl) is the sample correlation between xk and xl.
Thus, for a GLM without adjustment for environmental covariates, the correlation between the
score test statistics can be estimated by estimating the genotype correlation. which estimates
twice the composite linkage disequilibrium if the genotypes are coded 0, 1, 2 (Weir, 2008).

n 11T )xl

l (I − 1
xT

,

g

(cid:16)

I − 1
n

σ2
φ2 X T

11T(cid:17)
(cid:113)
k (I − 1
xT
k (I − 1
xT
n 11T )xk

(cid:113)

4

2.3.2 Uncorrelated environmental and genetic covariates

Two n-dimensional vectors X1 and X2 of observations have zero Pearson correlation if their
centered observations are orthogonal,

0 = (X1 − 1 ¯X1)T (X2 − 1 ¯X2) = X T

1

(cid:16)

I − 1
n

11T(cid:17)

X2.

If X1 and X2 are two matrices, then near zero Pearson correlation of each combination of a
column of X1 and a column of X2 can be written compactly as
1 X2 ≈ 1
X T
n

11T(cid:17)

X2 ≈ 0,

I − 1
n

1 11T X2.

(cid:16)

X T
1

X T

(6)

or

If we consider genetic and environmental covariates to be random variables, and all pairs of
an environmental and a genetic covariate to be independent, we would expect (6) to hold for
all X1 having columns that are functions of genetic covariates and X2 having columns that are
functions of environmental covariates. In particular, we consider X1 = Xg and X2 = ΛXe. Since
Λ is a function of environmental covariates only under the null hypothesis, so is X2. By (6),
g ΛXe ≈ 1
X T

n X T

g 11T ΛXe, Then, from (2),
g ΛXg − 1
g ΛXg − 1

φ2Vg|e ≈ X T

= X T

n2 X T
n2 X T

g 11T ΛXe(X T

e ΛXe)−1X T

e Λ11T Xg

g 11T Λ1/2HΛ1/211T Xg,

e Λ1/2 will project onto the column space of Λ1/2Xe. Since 1 is
where H = Λ1/2Xe(X T
a column (the intercept) of Xe, Λ1/21 is in the column space of Λ1/2Xe, so that HΛ1/21 = Λ1/21,
and

e ΛXe)−1X T

φ2Vg|e ≈ X T

g ΛXg − 1

n2 (tr Λ)X T
g ΛXg. Its (k, l) entry is X T

g 11T Xg.

We now turn to the term X T

1 Λ1, where X1 is the vector consisting
of the entry-wise products of the kth and the lth column of Xg. Letting X2 = Λ1, by (6), inde-
pendence of environmental and genetic covariates yields X T
1 1,
g ΛXg ≈ 1
which is the (k, l) entry of 1
I − 1
n

n X T
g Xg, and we have

1 Λ1 ≈ 1
n (tr Λ)X T

11T(cid:17)

Vg|e ≈ tr Λ

g Xg. Thus X T

1 11T Λ1 = 1

n (tr Λ)X T

n (tr Λ)X T

nφ2 X T

(cid:16)

Xg,

g

(cid:80)n

i=1 σ2

which is the same expression as in the case of no environmental covariates with the exception
that the common variance σ2 of the responses is replaced by their average variance tr Λ/n =
1
i are deﬁned by the environmental covariates. The conclusion is that, if
n
environmental and genetic covariates are uncorrelated, correlations of the score vector under the
null hypothesis can be estimated more easily by estimating only correlations between genetic
covariates instead

i , where the σ2

2.3.3 The normal model
For Yi normally distributed, Λ = σ2I, where I is the n × n identity matrix. The score vector
can then be written

Ug|e =

1
σ2 X T

g (I − H)Y ,

and (2) reduces to

Vg|e =

1
σ2 X T

g (I − H)Xg,

5

e Xe)−1X T

where H = Xe(X T
e is the idempotent matrix projecting onto the column space of Xe.
Then I − H is the idempotent matrix projecting onto the orthogonal complement of the column
spcace of Xe, and (I − H)Y are the residuals when ﬁtting the multiple linear model with only
the environmental covariates present. Note that σ2 enters into the test statistics Tk (3), and
needs to be replaced by an estimate; we have used the residual sum of squares of a ﬁtted model
with only environmental covariates present (the null hypothesis), divided by n − d.

2.3.4 The logistic model

i of Λ are estimated by ˆµei(1 − ˆµei), where ˆµei are
For Yi Bernoulli distributed, φ = 1 and the σ2
the ﬁtted values under the null hypothesis with only environmental covariates. Inference about
βg is valid also if data are collected in a case–control study since the canonical (logit) link is
used (Agresti, 2002, pp. 170–171).

In the special case of no environmental covariates, that is, Xe = 1, each score test statistic,
Tk (5), is equal to the Cochran–Armitage trend test (Armitage, 1955; Cochran, 1954) statistic,

(cid:80)2
(cid:0)(cid:80)2
i=0 si(n2xi − n1yi)
i=0 s2

i mi − 1

i=0 simi)2(cid:1) ,
n ((cid:80)2

(cid:113)

n1n2

where si are the possible values of the genetic covariates, n1 and n2 the number of 0 and 1
phenotypes Yi, respectively, xi the number of observations having phenotype 1 and genotype
si at locus k, yi the number of observations having phenotype 0 and genotype si, and mi =
xi + yi. The Cochran–Armitage test is used in disease–genotype association testing with scores
(s0, s1, s2) = (0, s, 1) (Sasieni, 1997; Slager and Schaid, 2001), for example with s = 1
2 for an
additive genetic model.

3 Familywise error rate control and approximations

To test for phenotype–genotype association in a GWA study we ﬁrst ﬁt a GLM with phenotype
as response and environmental variables as covariates. Then we test the m individual hypotheses
βgk = 0 for each component βgk of βg, k = 1, . . . , m, using the score test statistics in (3).

We will now turn to the topic of multiple testing, by ﬁrst looking at multiple testing in
general, with emphasis on the familywise error rate (FWER), then we move to intersection
approximations to the FWER, and then apply this to our score statistic situation.

3.1 Multiple hypothesis familywise error rate control

We have a collection of m null hypotheses, Hk : βgk = 0 (no association between phenotype and
genotype at marker k), 1 ≤ k ≤ m. We will present a method for multiple testing correction that
controls the FWER – the probability of making at least one type I error. The null hypotheses
are tested with the corresponding test statistics Tk, as deﬁned in (3), 1 ≤ k ≤ m. We adopt
the notation of Moskvina and Schmidt (2008), and denote by Ok the event |Tk| < c that the
null hypothesis Hk is not rejected, and by ¯Ok its complement, with corresponding probability
P (Ok) = 1 − αloc, under the complete null hypothesis, 1 ≤ k ≤ m.

We will consider single-step multiple testing methods, and choose the same local signiﬁcance
level αloc for all the m hypothesis tests, which will then deﬁne the cut-oﬀ c for the test statistics.
Then

FWER = P ( ¯O1 ∪ ··· ∪ ¯Om) = 1 − P (O1 ∩ ··· ∩ Om)

(7)

6

under the complete null hypothesis. When the joint distribution of the test statistics is known,
or can be estimated, then FWER control can be achieved by solving the inequality FWER ≤ α
for αloc, based on either the union or intersection formulation of (7). When m is large, this
involves evaluating high dimensional intergrals over the acceptance or rejection regions, which
is suggested by Conneely and Boehnke (2007).

To avoid calculating these costly high dimensional integrals, we may instead turn to control-
ling FWER by looking at bounds, based on (7). For example, the Bonferroni method is based
on the Boole inequality applied to the union formulation of (7),

FWER = P ( ¯O1 ∪ ··· ∪ ¯Om) ≤ m(cid:88)

m(cid:88)

P ( ¯Ok) =

αloc = mαloc,

k=1

k=1

from which it is seen that a local signiﬁcance level of αloc = α/m guarantees FWER ≤ α.

Since the FWER is calculated under the complete null hypothesis, so-called weak FWER
control is achieved. However, in our situation, subset pivotality is satisﬁed, meaning that the
distribution of any subvector (Tk)k∈K is identical under ∩k∈KHk and under the complete null
hypthesis ∩m
k=1Hk, for all subsets K ⊆ {1, 2, . . . , m}. In particular, a subvector of Ug|e (1) and
a submatrix of Vg|e (2) corresponding to K only involve genetic covariates corresponding to
K. Then strong FWER control is achieved, meaning that FWER ≤ α regardless of which null
hypotheses are true (Westfall and Young, 1993; Westfall and Troendle, 2008).

The focus in this work will be on the intersection formulation of (7). Background theory

will be given next and new application in 3.3.

3.2 Intersection approximations

Following Glaz and Johnson (1984), we deﬁne

m(cid:89)

j=k+1

γk = P (O1 ∩ ··· ∩ Ok)

P (Oj | Oj−k+1 ∩ ··· ∩ Oj−1),

1 ≤ k ≤ m.

(8)

In particular, γ1 =(cid:81)m

j=1 P (Oj) = (1− αloc)m, and γm = P (O1 ∩···∩ Om) = 1− FWER by (7).
The idea is that the γk constitute increasingly better approximations of γm as k increases, and
that calculation of γk is less costly than calculation of γm when k < m, since only k-variate
distributions are involved in γk.
In the special case that the test statistics are independent, (1 − αloc)m = γ1 = γm =
1 − FWER, and FWER control is achieved by solving for the αloc giving the desired FWER.
Even if the test statistics are not independent, γ1 can be viewed as an approximation of γm.
In our case, where the test statistic vector is (|T1|, . . . ,|Tm|) with (T1, . . . , Tm) asymptotically
multivariate normally distributed with mean 0 under the complete null hypothesis, γ1 ≤ γm
(ˇSid´ak, 1967), so that FWER = 1− γm ≤ 1− γ1 = 1− (1− αloc)m = α, and asymptotic FWER
control is also in this case kept at the α level by solving the last equation for αloc . It is well
known that the αloc found by this method, the ˇSid´ak method, is slightly larger than the αloc
found by the Bonferroni method, thus the ˇSid´ak method will give slightly higher power.
We have seen that in our case, γ1 ≤ γm, meaning that the ˇSid´ak method can safely be used.
If the vector of test statistics is monotonically sub-Markovian of order k (MSMk, 2 ≤ k ≤ m−1),
we have ordered bounds up to order k, γ1 ≤ γ2 ≤ . . . ≤ γk ≤ γm (Block et al., 1992). Ideally,
we should have γ1 ≤ γ2 ≤ ··· ≤ γm for all αloc. If the vector of test statistics is MSMm−1,
FWER = 1 − γm ≤ 1 − γk = α can be used to control FWER by solving the last equation for
αloc (choosing the greatest solution if not unique). Note that γk = 1 for αloc = 0 (no rejections)
and that γk = 0 for αloc = 1 (always rejection) and that γk is continuous as a function of αloc.

7

Thus, if αloc is found to control FWER via 1 − γk = α for the γk approximation, then, if k < l,
1 − γl ≤ 1 − γk = α evaluated at αloc, so that the greatest solution of 1 − γl = α is greater than
αloc, and higher power is achieved for the γl approximation.
Unfortunately, our test statistic (|T1|, . . . ,|Tm|) is not MSMm−1. It is possible to ﬁnd a
trivariate normal distribution with mean 0 such that γ1 < γ3 < γ2 for some αloc. However, the
violations of MSMm−1 we have observed have been very small and only for restricted ranges of
αloc, and only for carefully constructed covariance matrices. We have not observed violations
for covariance matrices estimated from real data. It should also be noted that we have never
observed a γk that is not monotonically decreasing in αloc. We will therefore proceed to apply γ2
and γ3 as a better approximation to γm than γ1 (giving ˇSid´ak cutoﬀs). A summary of concepts,
like MSM, of positive dependence, were given by (Dickhaus, 2014, pp. 58–61).

3.3 Controlling FWER using kth order approximation for score tests

As we have seen, the vector of score test statistics are asymptotically multivariate normal with
mean zero and covariance matrix R deﬁned in (4). We now further assume that R is such that
the vector of score test statistics (|T1|, . . . ,|Tm|) is MSMk, so that a kth order FWER bound
would give γm ≥ γk ≥ . . . ≥ γ1. Thus, the local signiﬁcance level of the kth order approximation
would be larger than the ﬁrst order approximation (e.g. the ˇSid´ak method), and also larger than
the Bonferroni method (since the ˇSid´ak method always gives a local signﬁcance level that is not
smaller than the Bonferroni method) while still controlling the FWER at level α. We will now
ﬁrst develop a second order FWER bound based on our vector of score test statistics.

Finding αloc from γ2 We will ﬁnd a closed form equation to be solved for αloc controlling
FWER by an second order FWER approximation. Our ﬁnal equation is identical to what is
found by Moskvina and Schmidt (2008) for the allelic test and the LD correlation. This is
because the common core of the two situations is to consider an ordered vector (T1, . . . , Tm) of
multivariate normal test statistics with mean zero and given covariance matrix R. This means
that the following result is valid for all vectors of test statistics with these characteristics.

The starting point is

γ2 = P (O1)

P (Ok|Ok−1) =

(cid:81)m
(cid:81)m−1
k=2 P (Ok−1 ∩ Ok)

k=2 P (Ok)

.

Now let the statistics (T1, . . . , Tm) be ordered, for example in the same ordering that the
genetic markers k = 1, . . . , m are positioned along the genome (that is, along each chomosome
and then order the chromosome).
Denote by rk element (k − 1, k) of the covariance matrix R, and by Φ the cumulative

distribution function of the univariate standard normal distribution. Then

P (Ok) =

1√
2π
P (Ok−1 ∩ Ok) = 1 − αloc −

−c

(cid:114) 2

(cid:90) c

e−x2/2dx = (1 − αloc),

e−x2/2

Φ

 rkx − c(cid:113)

1 − r2

k

 dx,

m(cid:89)

k=2

(cid:90) c

π

−c

8

and

(cid:81)m

k=2

γ2 =

(cid:18)
(cid:18)
1 − αloc −(cid:113) 2
(cid:82) c−c e−x2/2Φ
1 −
(cid:114) 2
(cid:90) c
m(cid:89)

(1 − αloc)m−2

1

π

1 − αloc

π

−c

k=2

(cid:19)

rkx−c√
1−r2

k

e−x2/2Φ

dx

(cid:19)
 rkx − c(cid:113)

1 − r2

k

= (1 − αloc)

 dx

 .

(9)

For a given value of the desired FWER control level α we solve the equation 1 − γ2 = α
with respect to αloc. This can be done numerically using for example a bisectioning algorithm.
See R script in Appendix A.
Finding αloc from γk We can ﬁnd FWER approximations of order k, k ≥ 1 by solving the
equation FWER = 1 − γk = α, k = 1, 2, . . . , m, where γk involves the ratio of products of
k-dimensional and products of k − 1-dimensional multivariate normal integrals.

For γ3, we have

γ3 = P (O1 ∩ O2)

m(cid:89)

P (Ok|Ok−1 ∩ Ok−2) =

and αloc is found by solving FWER = 1 − γ3.

k=3

(cid:81)m
(cid:81)m
k=3 P (Ok ∩ Ok−1 ∩ Ok−2)
k=4 P (Ok−1 ∩ Ok−2)

,

3.4 FWER control with independent blocks

Genetic markers are distributed along the chromosomes and a common assumption is indepen-
dence of genetic markers from diﬀerent chromosomes.

As we have seen in Section 2.3, if the genetic markers are independent and no environmental
covariates that are correlated with the genetic markers are included, the score test statistics for
these markers would also be independent. Within a chromosome, genetic markers can belong
to diﬀerent haplotype blocks, being highly correlated within a block and independent or nearly
independent between the blocks (Griﬃths et al., 2002).

Assume that this is the situation and that the m markers to be tested can be partitioned
l = 1, . . . , M , so that

into M independent blocks, with ml hypotheses to be tested in block l,

m =(cid:80)M

l=1 ml, and

P (O1∩ O2∩···∩ Om) = P (O1∩···∩ Om1)P (Om1+1∩···∩ Om1+m2)··· P (Om−mM +1∩···∩ Om).
For simplicity, we consider the second order approximation and combine the above with (9).
The covariance matrix R is now block diagonal, since we have M independent blocks. We now
deﬁne r1k to be entry (k − 1, k) of the ﬁrst block, r2k to be entry (k − 1, k) of the second block,
and so on. Then

1 −

m1(cid:89)

k=2

(cid:114) 2
··· mM(cid:89)

π

(cid:90) c
1 −

−c

k=2

 r1kx − c
(cid:113)
(cid:114) 2
(cid:90) c

1 − r2

1k

π

−c

 dx


 rM kx − c
(cid:113)

1 − r2

M k

e−x2/2Φ

 dx

 .

1

1 − αloc

γ2 = (1 − αloc)M

1

1 − αloc

e−x2/2Φ

Note that the equation FWER = 1 − γ2 = α must be solved for αloc for the complete equation,
and not separately for each of the M parts. The above formula is identical to setting rk = 0
when marker k − 1 is in one block and marker k is in another, and applying (9) directly.

This result can easily be extended to the kth order FWER approximation.

9

3.5 The eﬀective number of independent tests

The concept of an eﬀective number of independent tests, Meﬀ, in multiple testing problems
have previously been described and discussed by many authors, including Nyholt (2004), Gao
et al. (2008), Moskvina and Schmidt (2008), Li and Ji (2005), Galwey (2009) and Chen and Liu
(2011).

All except Moskvina and Schmidt (2008) ﬁrst estimates Meﬀ, and then use Meﬀ in place of

m in the ˇSid´ak formula to estimate αloc by

αloc = 1 − (1 − α)1/Meﬀ.

(10)

An alternative formulation using the Bonferroni formula also exists.

None of these methods use the concept of FWER in the derviation of Meﬀ, and there
is no mathematical justiﬁcation that FWER is controlled. All methods start with the linkage
disequilibria or composite linkage disequilibria matrix, and there is no mention of the dependence
of the Meﬀ estimate on the test statistics used for the hypothesis tests.

The method of Moskvina and Schmidt (2008) is based on an allelic test and controls the
FWER if the vector of test statistics is MSMm−1. As for our method, the main output of the
Moskvina and Schmidt (2008) method is an estimate of αloc. Using the ˇSid´ak correction αloc
can together with α can be used to deﬁne Meﬀ as

Meﬀ =

log(1 − α)
log(1 − αloc)

.

(11)

Observe that Meﬀ is a derived quantity dependent on both the local signiﬁcance level αloc and
the FWER threshold α. We will not use the Meﬀ further in this paper.

4 Power and eﬃciency of the FWER approximation method

We will investigate diﬀerent aspects of the FWER approximation method presented in the
previous section, and compare the method to the Bonferroni method and the Westfall and Young
(1993) maxT permutation method. For each method we will report the computer resources
needed to calculate the local signiﬁcance level.

We will not look directly at power calculations, but instead compare the local signiﬁcance
level αloc as calculated by the diﬀerent methods under study. In a given situation the method
that gives the highest local signiﬁcance level will be the most powerful method. Our order k
FWER approximation method is based on assuming asymptotic multivariate normality of the
vector of score test statistics, which may be achieved when the data is analysed by ﬁtting a GLM.
If the vector of test statistics, T , is MSMk our method of order k will be more powerful than
the Bonferroni or ˇSid´ak correction, since the estimated local signiﬁcance level of our method,
αloc, will be larger than the αloc from the Bonferroni or ˇSid´ak correction.

4.1 The maxT permutation method

In this section, we will present the Westfall and Young (1993) maxT method, which will be
used in Section 4.2 to compare with the results of our FWER approximation method when no
environmental covariates are present.

For our two-sided tests, based on our score test statistics T with elements (3), the

maxT method can easily be related to γm, by observing

10

FWER = 1 − P (O1 ∩ ··· ∩ Om) = 1 − γm = 1 − P (|T1| ≤ c ∩ ··· ∩ |Tm| ≤ c)

= 1 − P (maxk|Tk| ≤ c) = P (maxk|Tk| ≥ c),

where c is the critical value for rejecting each of the m null hyptotheses. The cut-oﬀ value
for the test statistics is the 1 − α-quantile of the empirical distribution of the maximal test
statistics. To ﬁnd the local signiﬁcance level, αloc, we must assume the score test statistics, Tk,
are asymptotically multivariate normally distributed, that is, if c is the cut-oﬀ value for the
maximal test statistics the local signiﬁcance level is given by
P (|Tk| ≤ c) = 1 − αloc.

If our score test vector can be seen to be multivariate normally distributed then the
maxT and the order m FWER method would give identical critical values. In the maxT method
the critical value c is found empirically by permutation in order to generate samples from the
distribution of the maxk|Tk| statistic.

The success of the permutation method relies on the exhangeablity of the data, which in
general doesn’t hold for regression problems (Commenges, 2003). In our GLM the responses Yi,
i = 1, . . . , n are in general not exchangeable since the expected value of Yi is not the same for all
i when enviromental covariates are present. Without environmental covariates (only intercept)
the responses are exchangeable and permutation of Y gives valid error control. With discrete
environmental covariates permutation can be done in a stratiﬁed manner (Solari et al., 2014).
When the exchangeability assumption is not satisﬁed, there is no standard solution to how
permutation testing can be performed. Asymptotic or second moment exchangeability may be
obtained by diﬀerent transformations of the data, but comparison with these methods is beyond
the scope of this paper.

4.2 Illustration of methods: TOP and VO2-max data

Our two data sets (referred to as TOP and VO2-max) are of limited sample size, and our aim is
to use the data to investigate the correlation structure of GWA-data and the eﬀect this has on
the estimation of the local signiﬁcance level. We assume that our ﬁndings will hold in data sets
with larger sample sizes. An increase in sample size will give more precise estimates of the score
test statistics correlations, but the estimation of the local signiﬁcance level is mainly dependent
on score test statistics correlations under study (not the sample size).

The TOP data set is a case–control GWA data set, where case is schizophenia or bipolar dis-
order. The data set was collected with the aim to detect SNPs associated with the schizophenia
or bipolar disorder (Athanasiu et al., 2010; Djurovic et al., 2010). The preprocessed TOP GWA
data contains genetic information on 672972 SNPs (Aﬀymetrix Genome-Wide Human SNP Ar-
ray 6.0) for 1148 cases and 420 controls. Our dataset included individuals sampled until March
2013, and therefore the sample size is larger than in the cited papers. Genotype–phenotype
association is assessed by ﬁtting a logistic GLM without any environmental covariates, and
then performing one score test for each SNP, so that score test correlations will equal genotype
correlations for this data set.

The VO2-max data set comes from a cross-sectional GWA study (Aspenes et al., 2011;
Loe et al., 2013), where the aim was to ﬁnd SNPs associated with maximum oxygen uptake
(named VO2-max). The preprocessed VO2-max GWAS data consists of 123497 SNPs (Cardio-
Metabochip from Illumina, Moore et al. (2012)) for 2943 individuals. The VO2-max data are
analysed using a normal GLM, including age, sex and physical activity score as covariates in
the model.

11

FWER control at α = 0.05
Bonferroni
Order 1 FWER-approx. (ˇSid´ak )
Order 2 FWER-approx.
Order 3 FWER-approx.

TOP
7.43 · 10−8
7.62 · 10−8
8.62 · 10−8(1.13)
9.07 · 10−8(1.19)

VO2-max
4.05 · 10−7
4.15 · 10−7
4.70 · 10−7 (1.13)
5.02 · 10−7 (1.21)

Table 1: Estimated local signiﬁcance level for the TOP and VO2-max data, controlling the
FWER at level 0.05. The TOP data contains m = 672972 SNPs, the VO2-max data contains
m = 123497 SNPs. The local signiﬁcance level ratio for each method compared to the ˇSid´ak
method is given in parenthesis.

Figure 1: Smoothed frequency distributions of the estimated genotype correlations between
neighbouring SNPs on each chromosome, one line per chromosome. TOP data (left) and VO2-
max data (right)

For both datasets, mean imputation of genotypes was done to calculate αloc. For the TOP
data, mean imputation was done for 0.04% of the genotypes, and in the VO2-max data for 0.7%
of the genotypes. Results for estimating the local signiﬁcance level controlling the FWER at
level 0.05 using the Bonferroni, ˇSid´ak , order 2 and 3 FWER approximations, are presented in
Table 1 for the two data sets under study.

For the TOP data, since no environmental covariates are included in the model, permutation
(of the binary response vector) is feasible (the exchangeability assumption is satisﬁed), and the
maxT method can be used to estimate the local signiﬁcance level controlling FWER at level
0.05. Permutation of the responses followed by calculation of the maximal score test statistics
over the whole genome, is a time consuming task, and we will only present results on two of
the smallest chromosomes (chromosome 21 and 22, separately and jointly). Figure 1 presents
the smoothed frequency distribution of the estimated correlation between neigbouring SNPs
(closest SNP measured in base-pair distance on the chip used). Observe that the distribution is
very similar across chromosomes, and therefore, we would expect that the same trends observed
in our results from chromosome 21 and 22 can be also be found for the other chromosomes.

Table 2 shows the results using the order 2 and 3 FWER approximation for the TOP data.

12

Method
Bonferroni
Order 1 FWER approx. (ˇSid´ak )
Order 2 FWER approx.
Order 3 FWER approx.
maxT lower CI
maxT estimate
maxT upper CI

Chr 21 αloc Chr 22 αloc Chr21&Chr22 αloc
2.66
2.73 (1.00)
3.12 (1.14)
3.36 (1.23)
3.60 (1.32)
3.65 (1.34)
3.70 (1.36)

5.10
5.23 (1.00)
6.09 (1.16)
6.57 (1.26)
7.34 (1.40)
7.44 (1.42)
7.55 (1.44)

5.57
5.72 (1.00)
6.46 (1.13)
6.93 (1.21)
7.68 (1.34)
7.79 (1.36)
7.91 (1.38)

Table 2: Estimated local signiﬁcance level for the TOP data, controlling FWER at level 0.05.
All numbers are 10−6. Chromosome 21 contains 9802 SNPs, chromosome 22 8970 SNPs and
chromosome 21 and 22 in total 18772 SNPs. The number of permutations for the maxT method
is 500000. The local signiﬁcance level ratio for each method compared to the ˇSid´ak method is
given in parenthesis.

We see that the estimated local signiﬁcance levels for the order 2 and 3 FWER approximation is
greater than the ˇSid´ak correction. For the TOP we see that the lower limit of the 95% conﬁdence
interval for the maxT method is greater than the order 3 FWER approximation. For the VO2-
max data, covariates are present in the model, so the exchangeability assumption is not satisﬁed
and the maxT permutation method cannot be used.
On a 4×6-core Xeon 2.67 GHz computer (Intel CPU) running Linux (Ubuntu 14.0) using
one thread, the analyses on chromosome 22 took 85 hours for maxT , 20 minutes for the FWER
order 3 and 10 seconds for FWER order 2.

4.3 Correlation structure and local signiﬁcance level

We investigated the eﬀect of the correlation between SNPs on the order k FWER approximation
method for two diﬀerent correlation structures, compound symmetry and autoregressive order 1
(AR1) correlation structure. We considered 1001 SNPs, and the 1001 × 1001 correlation matrix
with compound structure had 1 on the diagonal and ρ oﬀ diagonal, while the AR1 correlation
matrix had 1 on the diagonal, ρ on the ﬁrst band diagonal, ρ2 on the second band, and so on.
Using these correlation matrices, we estimated the local signiﬁcance level up to FWER order
5. For multivariate normal distributed test statistics with these correlation structures, the local
signiﬁcance level of order 1 − 5 will be increasing (Dickhaus, 2014, p. 58-61).

Figure 2 shows the estimated local signiﬁcance levels, where the left panel is compound
symmetry correlation structure, and right panel is AR1 correlation structure. We see that the
increase from the ˇSid´ak correction to the local signiﬁcance level of order 2 is greater than the
increase between higher orders, both for compound symmetry and for AR1 correlation, but the
increase between higher orders is smallest for AR1 correlation structure. We also see that the
eﬀect of the correlation coeﬃcient on the estimated local signiﬁcance level is small for correlation
coeﬃcient less than ρ ≈ 0.7.

5 Discussion

In this paper we have presented a new method, the order k FWER approximation method, for
estimating the local signiﬁcance level used to control the FWER in a GWA study, when the data
can be analyzed using a GLM. Our method uses the estimated correlation structure between
the test statistics, and is applicable when environmental covariates are present, and when the

13

Figure 2: The vertical axis gives the estimated local signiﬁcance level for the FWER approx-
imation of order k = 2,··· , 5, with dashed and dotted lines (value of αloc is increasing with
order of the approximation), and the horizontal axis gives the value of the parameter ρ in the
two correlation structures. Left panel is compound symmetry correlation structure, and right
panel is AR1 correlation structure. Solid horizontal line is ˇSid´ak correction (FWER order 1),
αloc = 5.12 · 10−5.

phenotype response is binary or continuous. We have applied the method to common genetic
variants, but the method can also be used for with rare variants. However, since rare variants
are less correlated than common variantes we expect the increase in αloc from the ˇSid´ak method
to be less for than when analyzing common variants.

The validity of our method is based on the assumption of positive dependence between test
statistics as disussed in Section 3.2. The distribution of test statistics need to be monotonically
sub-Markovian of order k, MSMk, to have ordered FWER bounds up to order k. The conditions
for MSM2 and MSM3 are diﬃcult to prove in GWA data, but as discussed in Section 3.2 it is
reasonable to assume that they are satisﬁed.
As we have seen in Equation (8), the order k FWER approximation method is based on
conditioning on the previous k − 1 neighbouring SNPs (ordered) along the chromosome. The
order 2 FWER approximation method conditions on the neighbouring SNP (measured in base-
pair distance) on the chromosome. The order 3 FWER approximation method conditions on
two neighbouring SNPs.

Population substructure can be associated with both the genotype and phenotype and is
therefore a possible confounding factor in GWA studies. Population substructure can be adjusted
for in the analysis using principal components of the covariance matrix of the individuals (Price
et al., 2006). In both the TOP data and the VO2-max data, related individuals were removed
in the preprocessing of the data, and no adjustment for population structure were used in our
analysis.
In Section 4.3 we use simulated data with compound and AR1 correlation structure, to com-
pare the FWER approximation methods of order 1− 5. The results showed that the correlation
between neighbouring SNPs need to be above 0.5 − 0.6 in absolute value to have an eﬀect on
the estimated local signiﬁcance level. We also saw that the increase in αloc between orders 2-5

14

Algorithm
Genz Bretz (absolute error = 0.001)
Genz Bretz (absolute error = 0.00001)
Miwa (steps = 4096)
Miwa (steps = 2000)

αloc
6.01 · 10−5
6.78 · 10−5
5.72 · 10−5
5.72 · 10−5

Table 3: Estimated local signiﬁcance level, αloc, for the order 3 FWER approximation method
using chromosome 22 in the VO2-max data using diﬀerent numerical algorithms.

was larger with compound symmetry correlation structure than for AR1 correlation structure.
Correlation between SNPs depends on the distance between SNPs on the chromosome, so we
would expect the AR1 correlation structure to be more realistic than compound symmetry for
SNP data.

As discussed in Section 3 and illustrated by simulations and analysis of GWA data in Section
4 our method has greater power than the ˇSid´ak method (i.e. higher local signiﬁcance level). For
the TOP data, the estimated local signiﬁcance level using the order 2 and 3 FWER approxi-
mation method is smaller than the local signiﬁcance level using the maxT resampling method
by Westfall and Young (1993), thus our method also control the FWER at a given level α. We
observed that the running time (for chromosome 22 in the TOP data) was 10 seconds (FWER
2), and 20 minutes (FWER 3), and that the maxT permutation method took 85 hours with
500000 permutations.

Parametric bootstrap methods can be used to estimate the local signiﬁcance level when the
exchangeability assumption is not satisﬁed. It will be an eﬀective method, but to our knowledge
it has not been proven that parametric bootstrap methods will control the overall error rate.
Since nuisance parameters need to be estimated, parametric bootstrap will in general not give
valid p-values.

Conneely and Boehnke (2007) introduced a method for multiple testing correction for GLMs
based on the estimated correlation structure of the score vector. The method of Conneely
and Boehnke (2007) is described to be used for large datasets by calculating high dimensional
integrals up to dimension 1000 using numerical integration in R (R Core Team, 2015). Using R,
multivariate normal integrals can be calculated using the pmvnorm function with two diﬀerent
algorithms. Conneely and Boehnke (2007) used the Monte-Carlo based algorithm by Genz (1992,
1993); Genz and Bretz (2002), while we use the algorithm by Miwa et al. (2003) to estimate
the local signiﬁcance level of order 3. In Table 3 we see that these algorithms may give very
diﬀerent results when analysing chromosome 22 in the VO2-max data. We also see that the
formulas derived in the appendix of Conneely and Boehnke (2007) is only valid for normal
distributed response variables.

6 Conclusions

In this paper we have presented a new method for controlling the FWER for GWA data.
The order k FWER approximation method can be used for GLMs and include adjustment for
environmental covariates. The method can also be used when testing for association between
a single response variable and other types of genomic data, for example rare variants or gene
expression data. When the vector of test statistics is MSM2 our FWER order 2 method is valid,
and if the vector of test statistics is MSM3, our FWER order 2 and 3 methods are valid. In the
situation were permutation methods can’t be used (exchangeability assumption not satisﬁed),
our method would be a powerful alternative to the Bonferroni and ˇSid´ak methods.

15

Software

The statistical analysis were performed using R (R Core Team, 2015), and the preprocessing of
the genetic data were done using the software PLINK (Purcell et al., 2007).

Acknowledgements

The authors would like to thank Dr. Jelle J. Goeman (Leiden University Medical Centre, Leiden,
The Netherlands) for valuable comments. Part of the work was done while the last author was
on sabbatical at Centre for the Genetic Origins of Health and Disease, University of Western
Australia, Australia. The PhD position of the ﬁrst author is founded by the Liaison Committee
between the Central Norway Regional Health Authority (RHA) and the Norwegian University
of Science and Technology (NTNU).

Conﬂict of Interest: None declared.

References

Agresti, A. (2002). Categorical data analysis (2nd ed.). Hoboken, New Jersey: John Wiley &

Sons.

Armitage, P. (1955). Tests for linear trends in proportions and frequencies. Biometrics 11,

375–386.

Aspenes, S. T., T. I. L. Nilsen, E.-A. Skaug, G. F. Bertheussen, Ø. Ellingsen, L. Vatten, and
U. Wisløﬀ (2011). Peak oxygen uptake and cardiovascular risk factors in 4631 healthy women
and men. Medicine and Science in Sports and Exercise 43, 1465–1473.

Athanasiu, L., M. Mattingsdal, A. K. K¨ahler, A. Brown, O. Gustafsson, I. Agartz, I. Giegling,
P. Muglia, S. Cichon, M. Rietschel, et al. (2010). Gene variants associated with schizophrenia
in a Norwegian genome-wide study are replicated in a large European cohort. Journal of
psychiatric research 44 (12), 748–753.

Block, H. W., T. Costigan, and A. R. Sampson (1992). Product-type probability bounds of

higher order. Probability in the Engineering and Informational Sciences 6, 349–370.

Chen, Z. and Q. Liu (2011). A new approach to account for the correlations among single

nucleotide polymorphisms in genome-wide association studies. Human Heredity 72, 1–9.

Cochran, W. G. (1954). Some methods for strengthening the common χ2 tests. Biometrics 10,

417–451.

Commenges, D. (2003). Transformations which preserve exchangeability and application to

permutation tests. Journal of Nonparametric Statistics 15, 171–185.

Conneely, K. N. and M. Boehnke (2007). So many correlated tests, so little time! Rapid adjust-
ment of p values for multiple correlated tests. American Journal of Human Genetics 81 (6),
1158–1168.

Dickhaus, T. (2014). Simultaneous Statistical Inference (1st ed.). Berlin, Heidelberg: Springer-

Verlag.

16

Dickhaus, T. and J. Stange (2013). Multiple point hypothesis test problems and eﬀective
numbers of tests for control of the family-wise error rate. Calcutta Statistical Association
Bulletin 65, 123–144.

Djurovic, S., O. Gustafsson, M. Mattingsdal, L. Athanasiu, T. Bjella, M. Tesli, I. Agartz,
S. Lorentzen, I. Melle, G. Morken, et al. (2010). A genome-wide association study of bipolar
disorder in Norwegian individuals, followed by replication in Icelandic sample. Journal of
aﬀective disorders 126 (1), 312–316.

Galwey, N. W. (2009). A new measure of the eﬀective number of tests, a practical tool for
comparing families of non-independent signiﬁcance tests. Genetic Epidemiology 33, 559–568.

Gao, X., J. Starmer, and E. R. Martin (2008). A multiple testing correction method for genetic
association studies using correlated single nucleotide polymorphisms. Genetic Epidemiol-
ogy 32, 361–369.

Genz, A. (1992). Numerical computation of multivariate normal probabilities. Journal of

Computational and Graphical Statistics 1, 141–150.

Genz, A. (1993). Comparison of methods for the computation of multivariate normal probabil-

ities. Computing Science and Statistics 25, 400–405.

Genz, A. and F. Bretz (2002). Methods for the computation of multivariate t-probabilities.

Journal of Computational and Graphical Statistics 11, 950–971.

Glaz, J. and B. M. Johnson (1984). Probability inequalities for multivariate distributions with

dependence structures. Journal of the American Statistical Association 79, 436–440.

Griﬃths, A. J. F., W. M. Gelbart, R. C. Lewontin, and J. H. Miller (2002). Modern genetic

analysis: integrating genes and genomes (2nd. ed.). W. H. Freeman and Company.

Li, J. and L. Ji (2005). Adjusting multiple testing in multi locus analyses using the eigenvalues

of the correlation matrix. Heredity 95, 221–227.

Loe, H., Ø. Rognmo, B. Saltin, and U. Wisløﬀ (2013). Aerobic capacity reference data in 3816

healthy men and women 20-90 years. PLoS One 8.

McCullagh, P. and J. A. Nelder (1989). Generalized Linear Models - second edition. Chapman

and Hall.

Meinshausen, N., M. H. Maathuis, and P. Buhlmann (2011). Asymptotic optimality of the
Westfall-Young permutation procedure for multiple testing under dependence. Annals of
Statistics 39 39, 3369–3391.

Miwa, A., J. Hayter, and S. Kuriki (2003). The evaluation of general non-centered orthant

probabilities. Journal of the Royal Statistical Society, Ser. B 65, 223–234.

Moore, A., D. A. Enquobahrie, S. E. Sanchez, C. V. Ananth, P. N. Pacora, and M. A. Williams
(2012). A genome-wide association study of variations in maternal cardiometabolic genes and
risk of placental abruption. Int. J. Mol. Epidemiology Genet. 3, 305–313.

Moskvina, V. and K. M. Schmidt (2008). On multiple-testing correction in genome-wide asso-

ciation studies. Genetic Epidemiology 32, 567–573.

17

Nyholt, D. R. (2004). A simple correction for multiple testing for single-nucleotide polymor-

phisms in linkage disequilibrium with each other. Am. J. Hum. Genet. 74, 765–769.

Price, A. L., N. J. Patterson, R. M. Plenge, M. E. Weinblatt, N. A. Shadick, and D. Reich
(2006). Principal components analysis corrects for stratiﬁcation in genome-wide association
studies. Nature Genetics 38, 904–909.

Purcell, S., B. Neale, K. Todd-Brown, L. Thomas, M. Ferreira, D. Bender, J. Maller, P. Sklar,
P. D. Bakker, M. Daly, and P. Sham (2007). PLINK: a tool set for whole-genome association
and population-based linkage analyses. The American Journal of Human Genetics 81, 559–
575.

R Core Team (2015). R: A Language and Environment for Statistical Computing. Vienna,

Austria: R Foundation for Statistical Computing.

Sasieni, P. D. (1997). From genotypes to genes: doubling the sample size. Biometrics 53,

1253–1261.

Schaid, D. J., C. M. Rowland, D. E. Tines, R. M. Jacobson, and G. A. Poland (2002). Score tests
for association between traits and haplotypes when linkage phase is ambiguous. American
Journal of Human Genetics 70, 425–434.

Seaman, S. R. and B. M¨uller-Myhsok (2005). Rapid simulation of p values for product meth-
ods and multiple-testing adjustment in association studies. American Journal of Human
Genetics 76, 399–408.

Slager, S. L. and D. J. Schaid (2001). Case–control studies of genetic markers: Power and sample

size approximations for Armitage’s test for trend. Human Heredity 52, 149–153.

Smyth, G. K. (2003). Pearson’s goodness of ﬁt statistic as a score test statistic.

In D. R.
Goldstein (Ed.), Science and Statistics: A Festschrift for Terry Speed, Volume 40 of IMS
Lecture Notes—Monograph Series, pp. 115–126. Institute of Mathematical Statistics.

Solari, A., L. Finos, and J. J. Goeman (2014). Rotation-based multiple testing in the multivariate

linear model. Biometrics 70, 954–961.

ˇSid´ak, Z. (1967). Rectangular conﬁdence regions for the means of multivariate normal distri-

butions. Journal of the American Statistical Association 62, 626–633.

Weir, B. S. (2008). Linkage disequilibrium and association mapping. Annual Review of Genomics

and Human Genetics 9, 129–142.

Westfall, P. H. and J. F. Troendle (2008). Multiple testing with minimal assumptions. Biomet-

rical Journal 50 (5), 745–755.

Westfall, P. H. and S. S. Young (1993). Resampling-Based Multiple Testing. John Wiley and

Sons, Inc.

A R code

R code used for estimating the local signiﬁcance level using the FWER order 2 and 3 method
can be found at http://www.math.ntnu.no/∼karikriz/alphaloc.

18

B Supplementary information on the TOP and VO2-max data

Preprocessing of TOP data All participants in the TOP data were genotyped at Expression
Analysis Inc. (Durham, NC, USA) using the Aﬀymetrix Genome-Wide Human SNP Array 6.0
(Aﬀymetrix Inc., Santa Clara, CA, USA). Quality control was performed using PLINK (version
1.07; http://pngu.mgh.harvard.edu/purcell/plink/) (Purcell et al., 2007). As a quality control,
exclusions of individuals based on genotyping were made of (I) one of two duplicates, (II)
one of two relatives (identity by descent (IBD) > 0.1875), (III) individuals with a recorded
gender diﬀering from that determined by X chromosome marker homozygosity, (IV) mixup-
samples (calculated by pairwise genome-wide identity by state (IBS)), (V) individuals with
non-European ancestry (calculated with HapMap3 and PLINK’s ﬁrst two MDS components)
and (VI) individuals with more than 5% missing genotype data. SNPs were excluded based on
(I) severe deviation from Hardy-Weinberg equilibrium, (II) minor allele frequency below 1%
and (III) low yield (< 95% in controls), as described in earlier reports (Athanasiu et al., 2010;
Djurovic et al., 2010). The TOP data analyzed in this paper contains information about 672972
genetic markers for 1148 cases and 420 controls.

Sample sizes for TOP and VO2-max The sample size in both the TOP data and the VO2-
max data were relatively small, ≈ 1500 individuals in the TOP data and ≈ 3000 individuals in
the VO2-max data. Because of this small sample size, we do not expect to ﬁnd SNPs that are
genomewide signiﬁcant in these data. The lowest p-value in the TOP data was 1.66 · 10−6 and
the lowest p-value in the VO2-max data was 7.95 · 10−6.

Comparing results for TOP and VO2-max on diﬀerent chromosomes
In Section 4.2
we deﬁned the local signiﬁcance level ratio of order k, k > 1 as the ratio between the local
signiﬁcance level of order k, and the ˇSid´ak correction. From Table 4 we see that the local
signiﬁcance level ratio of order 2 is approximately equal for both the TOP data and the VO2-
max data. Figure 3 shows the local signiﬁcance level ratio of order 2 and 3 for each chromosome in
both the TOP data and the VO2-max data. We see that for the TOP data, the local signiﬁcance
level ratio is similar on diﬀerent chromosomes, while there is some variation for the VO2-max
data. For the VO2-maxdata, the largest diﬀerence in local signiﬁcance level ratio was found for
chromosome 16 (1.167) and 21 (1.066), see Figure 4.

The TOP data was genotyped using a Aﬀymetrix Genome-Wide Human SNP Array 6.0(ref),
and the VO2-max data was genotyped using a Cardio-Metabochip from Illumina (Moore et al.,
2012). Both the TOP data and the VO2-max data are sampled from the Norwegian population.

Data
TOP
VO2-max

Individual chromosomes Whole genome
1.132530
1.131234

1.132128 − 1.165482
1.066073 − 1.167285

Table 4: Local signiﬁcance level ratio order 2, TOP and VO2-max

19

Figure 3: Local signiﬁcance level ratio of order 2 and 3, for each chromosome in the VO2-max
data (left panel) and the TOP data (right panel). Black line is ˇSid´ak correction, dashed line is
order 2 FWER approximation, dotted line is order 3 FWER approximation.

Figure 4: VO2-max data, chromosome 16 and 21: Smoothed frequency distribution of the esti-
mated correlation between neighbouring SNPs (left panel) and smoothed frequency distribution
of the base pair distance between neighbouring SNPs (right panel). Black line is chromosome
16, dashed line is chromosome 21.

20

