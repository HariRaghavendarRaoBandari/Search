6
1
0
2

 
r
a

M
4

 

 
 
]
P
A

.
t
a
t
s
[
 
 

1
v
6
7
4
1
0

.

3
0
6
1
:
v
i
X
r
a

Vine copula based inference of
multivariate event time data

Nicole Barthel∗, Candida Geerdens†, Matthias Killiches∗,

Paul Janssen† and Claudia Czado∗

March 7, 2016

Abstract

In many studies multivariate event time data are generated from clus-
ters of equal size. Flexible models are needed to capture the possibly
complex association pattern in such data. Vine copulas serve this pur-
pose. Inference methods for vine copulas are available for complete data.
Event time data, however, are often subject to right-censoring. As a
consequence, the existing inferential tools, e.g.
likelihood estimation,
need to be adapted. We develop likelihood based inference for clus-
tered right-censored event time data using vine copulas. Due to the
right-censoring single and double integrals show up in the likelihood ex-
pression and numerical integration is needed for the likelihood evaluation.
A simulation study, inspired by the three-dimensional rat data of Mantel
et al. (1977), provides evidence for the good ﬁnite sample performance
of the proposed method. Using the four-dimensional mastitis data of
Laevens et al. (1997), we show how an appropriate vine copula model
can be selected for the data at hand. We further demonstrate that our
ﬁndings are in line with the results in Geerdens et al. (2015) where
Joe-Hu copulas are used to analyze this data set.

Keywords: multivariate data, event time data, survival analysis, right-
censoring, vine copulas, maximum likelihood estimation

1 Introduction

In many studies, primary interest lies in the time until a prespeciﬁed event occurs.
Often, the data appear in clusters of equal size. For example, in Mantel et al. (1977)
∗Department of Mathematics, Technische Universit¨at M¨unchen, Boltzmanstraße 3, 85748 Garch-
ing, Germany (email: nicole.barthel@tum.de (corresponding author), cczado@ma.tum.de,
matthias.killiches@tum.de)
†Center for Statistics, I-BioStat, Universiteit Hasselt, Agoralaan 1, B-3590 Diepenbeek, Belgium
(email: paul.janssen@uhasselt.be, candida.geerdens@uhasselt.be)

1

N. Barthel, C. Geerdens, M. Killiches, P. Janssen, C. Czado

2

time to tumor appearance (tumorigenesis) in a litter of three rats is observed. The
litter is the cluster, where one rat is drug treated and two rats serve as controls. In
Laevens et al. (1997), time to mastitis infection in udder quarters of primiparous
cows is observed. The cow is the cluster and the infection times of the four udder
quarters are the clustered data. For an accurate analysis of clustered data the model
used should take the within-cluster association into account. Copulas provide the
right tools to explore and to unravel this association. A d-dimensional copula C
is a distribution function on [0, 1]d with uniformly distributed margins. According
to Sklar (1959), a copula is a dependence function that interconnects the marginal
survival functions Sj, j = 1, . . . , d, and thereby models the joint survival function
S, i.e. with tj ≥ 0

S (t1, . . . , td) = C (S1 (t1) , . . . , Sd (td)) .

For clusters of size two, a large catalog of bivariate families exists. For clusters of
size more than two, popular multivariate copula constructions such as exchangeable
(EAC) and nested Archimedean copulas (NAC) (Embrechts et al. 2003; Hofert 2008;
Nelsen 2006) induce rather restrictive association patterns. For instance, in EAC
models all marginal copulas show exactly the same type (and even strength) of
tail-dependence. In NAC models, the so-called nesting condition limits all building
blocks to stem from the same copula family leading again to the same type (but
not strength) of tail-dependence. More ﬂexible models are thus needed to capture
complex association patterns present in clustered data. This is a diﬃcult but at the
same time a challenging exercise. Flexible alternatives for EAC and NAC include
Joe-Hu copulas (Joe and Hu 1996) and vine copulas (Aas et al. 2009; Bedford and
Cooke 2002; Czado 2010; Kurowicka and Cooke 2006; Kurowicka and Joe 2010). A
Joe-Hu copula corresponds to a mixture of positive powers of max-inﬁnitely divisible
bivariate copulas. The induced association pattern is completely determined by
the mixture and by the choice of bivariate copulas. The idea of a vine copula is to
decompose the joint density of the clustered event times into a cascade of bivariate
copula densities via conditioning. So, in both approaches bivariate copulas or copula
densities are the building blocks. Given the variety of well-studied bivariate copulas,
it is clear that Joe-Hu copulas and vine copulas allow a ﬂexible modeling of the
within-cluster association in clustered event time data.

For the above mentioned copula models the focus is usually on complete, i.e. non-
censored, data. However, event time data are often subject to right-censoring. This
means that for some observations the true event time is not observed but instead
a lower (censored) time is registered. For example, in the rat study or in the cow
study rats/ cows may be lost to follow-up (e.g due to death) or may experience the
event after the end of the study (censored at study end). For right-censored event
time data the application of copulas has been less explored. Recently, Geerdens
et al. (2015) studied, for right-censored data, the model ﬂexibility of Joe-Hu copulas
as compared to EAC and NAC models. Vine copulas have not yet been studied for
right-censored event times. In this paper, we ﬁll this gap.

In Section 2, we describe the construction of vine copulas; we consider trivariate
and quadruple data. The tumorigenesis data and the mastitis data are described
in detail in Section 3. Following the ideas in Shih and Louis (1995), Section 4

Vine copula based inference of multivariate event time data

3

contains the likelihood function for right-censored quadruple event time data. In
particular, we provide the likelihood expression in terms of vine copula components
and therewith extend existing vine copula concepts to the setting of right-censored
clustered time-to-event data. A simulation study is performed in Section 5 to
demonstrate the good ﬁnite sample performance of our approach. In Section 6,
we revisit the mastitis data. Conclusions and some ﬁnite remarks are collected in
Section 7.

2 Vine Copulas

First, we recall the deﬁnition of vine copulas (Aas et al. 2009; Bedford and Cooke
2002; Czado 2010; Kurowicka and Cooke 2006; Kurowicka and Joe 2010) and explain
how vine copulas are constructed following the approach taken in Czado (2010).
The basic idea is to decompose a d-dimensional copula density c into a product of
d (d − 1) /2 so-called pair-copulas via conditioning. The latter are copulas associated
to bivariate conditional distributions. It is essential to note that the representation
of c in terms of pair-copulas is not unique. Depending on the conditioning strategy,
there is a variety of possible decompositions. To organize the structure of a d-
dimensional vine-copula, Bedford and Cooke (2002) propose a sequence of linked
trees. More precisely, a set of connected trees V := (T1, . . . ,Td−1) is called a regular
vine (R-vine) on d elements with the set of edges E (V) := E1 ∪ ··· ∪ Ed−1 and the
set of nodes N (V) := N1 ∪ ··· ∪ Nd−1 if the following holds:
(i) T1 is a tree with nodes N1 = {1, . . . , d} and edges E1.
(ii) For j = 2, . . . , d − 1, Tj is a tree with nodes Nj = Ej−1 and edges Ej.
(iii) (Proximity condition) For j = 2, . . . , d − 1, whenever two nodes of Tj are

connected by an edge, the associated edges of Tj−1 share a node.

Two four-dimensional examples of possible tree sequences, also called vine structures,
are visualized in Figure 1. We see that except for the labeling of the nodes the
two examples illustrate the only possible ways to arrange the four nodes in T1. In
the vine structure on the right, there exists a unique node in Tj, j = 1, 2, 3, that is
connected to d − j edges. This vine structure suggests an ordering by importance
and is referred to as a C-vine. The vine structure on the left is called a D-vine.
Here, no node is connected to more than two edges implying a serial ordering. In
particular, in dimension three C-vines and D-vines are equivalent. In this paper, we
concentrate on D-vines. The derived concepts, however, can easily be applied to
C-vines (Barthel 2015).

In the tree sequences, each node can be identiﬁed with a uniformly distributed
random variable and each edge corresponds to a pair-copula that captures the
associated dependence. To give insight into the dependencies that are captured by
the examples in Figure 1 and into the labeling of the edges, we construct the vine
copula density c corresponding to the D-vine in Figure 1. Recall that c is a density
function deﬁned on [0, 1]4 and that the univariate marginals are uniform on [0, 1].

N. Barthel, C. Geerdens, M. Killiches, P. Janssen, C. Czado

1

12

12

2

13;2

23

23

3

24;3

34

34

4

T1

1

T2

12

2
1

3 1
1

4

3;1
2

2

4

;

1

4

T3

23;1

2
1
;
4
3

T1

T2

T3

13;2

14;23

24;3

2

3

4

13

14

24;1

Figure 1: Two examples of a four dimensional vine structure: a D-vine on the left

and a C-vine on the right.

Therefore,

c (u1, u2, u3, u4) = c4|123 (u4|u1, u2, u3) c3|12 (u3|u1, u2) c2|1 (u2|u1)

with

c2|1 (u2|u1) = c12 (u1, u2) .

(1)

(2)

We now rewrite the conditional densities in (1) such that at the end we have a pair-
copula decomposition of c. The used conditioning strategy reﬂects the underlying
D-vine structure. In the following derivation, cij;k (for diﬀerent i, j, k ∈ {1, 2, 3, 4}) is
the bivariate copula density associated with the bivariate conditional distribution of
(Ui, Uj) given Uk = uk; and cij;kl (for diﬀerent i, j, k, l ∈ {1, 2, 3, 4}) is the bivariate
copula density associated with the bivariate conditional distribution of (Ui, Uj) given
Uk = uk and Ul = ul. We further assume that the obtained pair-copulas do not
depend on the conditioning variables; this is the so-called simplifying assumption.

To rewrite c4|123 (u4|u1, u2, u3) in terms of pair-copulas, ﬁrst note that

c4|123 (u4|u1, u2, u3) =

c14|23 (u1, u4|u2, u3)
c1|23 (u1|u2, u3)

(cid:0)C1|23(u1|u2, u3), C4|23(u4|u2, u3)(cid:1) c4|23(u4|u2, u3), (3)

= c14;23

where the second equality follows from an application of Sklar’s theorem (Sklar
1959) to the bivariate conditional density c14|23; c14;23 is the corresponding copula
density; C1|23 and C4|23 are the conditional marginals. In a similar way we obtain

c4|23(u4|u2, u3) =

c24|3(u2, u4|u3)
c2|3(u2|u3)

(cid:0)C2|3(u2|u3), C4|3(u4|u3)(cid:1) c34(u3, u4)

= c24;3

and

c3|12(u3|u1, u2) =

c13|2(u1, u3|u2)
c1|2(u1|u2)

(cid:0)C1|2(u1|u2), C3|2(u3|u2)(cid:1) c23(u2, u3).

= c13;2

(4)

(5)

Vine copula based inference of multivariate event time data

5

From (1) - (5) it easily follows that

c (u1, u2, u3, u4) = c12 (u1, u2) c23 (u2, u3) c34 (u3, u4) c13;2

(cid:0)C2|3 (u2|u3) , C4|3 (u4|u3)(cid:1)
(cid:0)C1|23 (u1|u2, u3) , C4|23 (u4|u2, u3)(cid:1) .

× c24;3
× c14;23

(cid:0)C1|2 (u1|u2) , C3|2 (u3|u2)(cid:1)

(6)

Note that only bivariate copula densities are included. Since the latter can be chosen
independently from a large catalog of bivariate copula families, vine copulas proof
themselves as a ﬂexible tool to model complex association patterns.
The arguments of the pair-copulas in T2 and T3 are conditional distribution
functions of the form Ci|k, Ck|i, Ci|jk and Cj|ik. Recall that these expressions are
conditional marginals of bivariate conditional distributions that result from the
conditioning strategy used. Thus, they are completely determined by the underlying
R-vine structure. They can be computed by recursive partial diﬀerentiation of the
pair-copulas of higher tree levels, i.e. it holds that

Ci|k (ui|uk) =
Ci|jk (ui|uj, uk) =
Cj|ik (uj|ui, uk) =

Cik (ui, uk) ,

Cik (ui, uk) , Ck|i (uk|ui) =
∂

∂
∂ui

(cid:0)Ci|k (ui|uk) , Cj|k (uj|uk)(cid:1) ,
(cid:0)Ci|k (ui|uk) , Cj|k (uj|uk)(cid:1) .

∂
∂uk
∂Cj|k (uj|uk)
∂Ci|k (ui|uk)

∂

Cij;k

Cij;k

Usually, these expressions are further identiﬁed with so-called h-functions that
allow for a recursive notation of the associated conditional distributions. We deﬁne

hi|k (ui|uk) :=
hi|j;k (ui|uj) :=

∂
∂uk
∂
∂uj

Cik (ui, uk),

Cij;k (ui, uj),

hk|i (uk|ui) :=
hj|i;k (uj|ui) :=

∂
∂ui
∂
∂ui

Cik (ui, uk) ,

Cij;k (ui, uj) .

For instance, for the considered D-vine structure we have

(cid:0)C1|2 (u1, u2)(cid:12)(cid:12)C3|2 (u2, u3)(cid:1) = h1|3;2

(cid:0)h1|2 (u1|u2)(cid:12)(cid:12)h3|2 (u3|u2)(cid:1) .

C1|23 (u1|u2, u3) = h1|3;2

The vine copula density (6) can ﬁnally be written as

c (u1, u2, u3, u4)

= c12 (u1, u2) c23 (u2, u3) c34 (u3, u4)

(cid:0)h1|2 (u1|u2) , h3|2 (u3|u2)(cid:1) c24;3
(cid:0)h1|3;2

(cid:0)h1|2 (u1|u2)(cid:12)(cid:12)h3|2 (u3|u2)(cid:1) , h4|2;3

(cid:0)h2|3 (u2|u3) , h4|3 (u4|u3)(cid:1)

(cid:0)h4|3 (u4|u3)(cid:12)(cid:12)h2|3 (u2|u3)(cid:1)(cid:1) .

(7)

× c13;2
× c14;23

In this section, we considered a four-dimensional example to explain how a d-
dimensional copula density can be decomposed into a product of bivariate copula
densities. We further introduced h-functions to provide an expression of the density
exclusively in terms of vine copula components. The presented concepts can be

N. Barthel, C. Geerdens, M. Killiches, P. Janssen, C. Czado

6

directly extended to d dimensions. For complete data, likelihood based inference
of vine copulas is well elaborated (Brechmann et al. 2012; Dissmann et al. 2013).
The algorithms to estimate the R-vine structure, the associated bivariate copula
families and the copula parameters are implemented in the R-library VineCopula
(Schepsmeier et al. 2015). In this paper, we assume the vine structure and the
bivariate copula families of a d-dimensional (d = 3 and d = 4) R-vine model to
be speciﬁed except for the parameters in the bivariate copulas. We investigate
likelihood based parameter estimation given d-dimensional event time data. Such
data are typically subject to right-censoring, which complicates the analysis in a
non-trivial way.

3 Multivariate right-censored event time data:

examples

We consider vine copula based likelihood inference for d-dimensional event time
data subject to right-censoring. We focus on d = 3 and d = 4. For a sample of n
clusters, let Tij be the j-th event time and Cij be the j-th censoring time in cluster
i (i = 1, . . . , n and j = 1, . . . , d). We observe Yij = min(Tij, Cij) together with the
censoring indicator δij = I(Tij ≤ Cij). Throughout, we assume that Tij and Cij are
independent (i = 1, . . . , n and j = 1, . . . , d) and that censoring is noninformative.
The setting where Cij = Ci for all j = 1, . . . , d is called common (univariate)
right-censoring. Before we discuss, in Section 4, likelihood based estimation of the
parameters of a vine copula model, we give some details on the two data examples
mentioned in the introductory section.

3.1 Example 1: Tumorigenesis data

Mantel et al. (1977) (see also Hougaard (2000)) study the time to tumor appearance
for 50 female litters, each containing three rats. The litter is the cluster and the
times to tumor appearance of the three rats are the clustered data (d = 3). In each
cluster, one rat was drug treated, while the other two served as controls.

For the 50 litters in the study, the available data consists of the litter identiﬁ-
cation number, the minimum of the time to tumor appearance and the censoring
time (both in weeks) for each rat in the litter as well as the corresponding cen-
soring indicators, e.g.
for the ﬁrst and last litter the data information is given
by {1, (49, 101, 104), (1, 0, 0)}, resp. {50, (104, 104, 79), (0, 0, 1)}, where the second
component in a data triple corresponds to the drug treated rat. See Table 1.5 in
Hougaard (2000) for the complete data set. Censoring occurs at the level of an
individual rat, i.e. rats within the same litter can have a diﬀerent censoring time.
Table 1 summarizes information on the censoring patterns of the tumorigenesis data.
In total, about 73% of the observations are censored. The tumorigenesis data serves
as an inspiration for the simulation study conducted in Section 5.

Vine copula based inference of multivariate event time data

7

Number of censored observations in a cluster (d = 3)

Number of litters

0

1

1

2

3

11

15

23

Table 1: Censoring patterns of the tumorigenesis data.

3.2 Example 2: Mastitis data

Data that received considerable attention in a number of papers are the udder
infection data of Laevens et al. (1997), see Geerdens et al. (2015) for references. The
study aims to quantify the impact of mastitis on the milk production and the milk
quality. For this, information on the time from parturition to infection is collected
for the four udder quarters of a cow. The cow is the cluster and the infection times
of the four udder quarters are the clustered data (d = 4).

For the 407 primiparous cows in the study, the available data consist of the
cow identiﬁcation number, the minimum of the infection time and the censoring
time (both in days) for each udder quarter as well as the corresponding censor-
ing indicators, e.g.
for the ﬁrst and last cow the data information is given by
{1, (67, 67, 119, 67), (1, 1, 1, 1)}, resp. {407, (279, 279, 279, 263), (0, 0, 0, 1)}, where
the ordering in a data quadruple corresponds to left front, right front, left rear and
right rear. Censoring occurs at the level of the udder quarters and it is common
(univariate) in the sense that the same censoring time applies to all udder quarters
of an individual cow. Table 1 summarizes information on the censoring patterns of
the mastitis data. In total, censoring is present in about 66.15% of the observations.
Flexible association modeling of the mastitis data has been studied by Geerdens
et al. (2015). Here, Joe-Hu copulas were applied. In Section 6, we use vine copulas
to study the dependence pattern in the mastitis data; our ﬁndings will conﬁrm the
need for ﬂexible modeling.

Number of censored observations in a cluster (d = 4)

0

1

2

3

4

Number of cows

73

49

36

40

209

Table 2: Censoring patterns of the mastitis data.

4 Maximum likelihood estimation for

four-dimensional right-censored event time data

An appropriate likelihood expression is needed to perform parametric likelihood
inference for d-dimensional right-censored time-to-event data. We focus on quadruple
data (d = 4). We refer to Barthel (2015, Chapter 3) for a more detailed discussion.
Based on the observed data Yi = (Yi1, . . . , Yi4) and δi = (δi1, . . . , δi4) with Yij and
δij as given in Section 3 (i = 1, . . . , n and j = 1, . . . , 4), we deﬁne for each cluster
the following joint censoring indicators:

N. Barthel, C. Geerdens, M. Killiches, P. Janssen, C. Czado

8

∆i (1, 2, 3, 4) := δi1δi2δi3δi4

4(cid:89)

∆i :=

(1 − δij)

j=1

∆i (p) := δip

4(cid:89)

j=1;j(cid:54)=p

(1 − δij)

4(cid:89)

∆i (p, q) := δipδiq
for p (cid:54)= q

j=1;j(cid:54)=p,q

no censoring

all components censored

pth component not censored

(1 − δij)

pth, qth component not censored

∆i (p, q, v) := δipδiqδiv (1 − δiw)

for w (cid:54)= p, q, v and p (cid:54)= q (cid:54)= v

pth, qth, vth component not censored

The actual censoring in a particular cluster determines the joint censoring indi-
cators for that cluster, e.g. for δi = (1, 0, 0, 1) we have ∆i (1, 4) = 1 and all other
joint censoring indicators equal zero. With the copula data given by uij = Sj(yij)
(i = 1, . . . , n and j = 1, . . . , 4), in the above example ui1 and ui4 are associated with
observed event times. On the other hand, ui2 and ui3 are associated with observed
censoring times that are lower than the unknown true event times. Therefore, the
contribution to the loglikelihood is given by

(cid:96)i,d (θ; ui, δi) = log

C (ui1, S2(yi2), S3(yi3), ui4; θ)

(cid:18) ∂2

∂ui1∂ui4

(cid:19)(cid:12)(cid:12)(cid:12)(cid:12) ui1=S1(yi1)

ui4=S4(yi4)

,

where ui = (ui1, ui2, ui3, ui4) and with θ the vector collecting all parameters of the
copula C.

In general, the contribution of the i-th cluster to the loglikelihood is given by

(cid:96)i,d ( θ; ui, δi)

:= ∆i log (C (ui1, ui2, ui3, ui4; θ))

(cid:18) ∂
(cid:18) ∂2
(cid:18)

∂uip

p=1

4(cid:88)
(cid:88)
(cid:88)

p(cid:54)=q

p(cid:54)=q(cid:54)=v

+

+

+

∆i (p) log

C (ui1, ui2, ui3, ui4; θ)

∆i (p, q) log

C (ui1, ui2, ui3, ui4; θ)

∂uip∂uiq

∆i (p, q, v) log

C (ui1, ui2, ui3, ui4; θ)

∂3

∂uip∂uiq∂uiv

(cid:19)

(cid:19)

(cid:19)

+ ∆i (1, 2, 3, 4) log (c (ui1, ui2, ui3 ui4; θ)) .

The loglikelihood for four-dimensional time-to-event data subject to right-censoring

Vine copula based inference of multivariate event time data

9

is therefore given by

log Ln,d (θ; u1, . . . , un, δ1, . . . , δn) :=

n(cid:88)

i=1

(cid:96)i,d (θ; ui, δi) .

(8)

Massonnet et al. (2009) and Geerdens et al. (2015) use this likelihood expression to
model dependencies within the mastitis data. Shih and Louis (1995) and Andersen
(2005) consider similar versions for bivariate event time data.

Once we have decided on the vine structure to be used, we need the vine version
of the partial derivatives in (8). For instance, for the D-vine given in Figure 1 we
have

∂2C (ui1, ui2, ui3, ui4)

(cid:90) ui2

∂ui1∂ui4

0

c12 (ui1, vi2) c23 (vi2, vi3) c34 (vi3, ui4)

(cid:90) ui3
(cid:0)C1|2 (ui1|vi2) , C3|2 (vi3|vi2)(cid:1) c24;3
(cid:0)C1|23 (ui1|vi2, vi3) , C4|23 (ui4|vi2, vi3)(cid:1) dvi3dvi2
(cid:90) ui3
(cid:0)h1|2 (ui1|vi2) , h3|2 (vi3|vi2)(cid:1) c24;3
(cid:0)h1|3;2

(cid:0)h1|2 (ui1|vi2)(cid:12)(cid:12)h3|2 (vi3|vi2)(cid:1) , h4|2;3

(cid:0)C2|3 (vi2|vi3) , C4|3 (ui4|vi3)(cid:1)
(cid:0)h2|3 (vi2|vi3) , h4|3 (ui4|vi3)(cid:1)

c12 (ui1, vi2) c23 (vi2, vi3) c34 (vi3, ui4)

(cid:0)h4|3 (ui4|vi3)(cid:12)(cid:12)h2|3 (vi2|vi3)(cid:1)(cid:1)

=

=

0

× c13;2
× c14;23

(cid:90) ui2

0

0

× c13;2
× c14;23
× dvi3dvi2.

The complete collection of vine equivalents of the partial derivatives is derived in
Barthel (2015, Chapter 3) and is given in the Appendix (Theorem 1 and Corollary 1).

Note that due to right-censoring the use of single and double integrals and hence
numerical integration cannot be avoided when evaluating the loglikelihood. For
the practical implementation we use standard optimization methods, in which we
balance the trade-oﬀ between numerical demand and accuracy of the estimates.
To achieve dimension reduction, we ﬁrst solve (in case of quadruple data) three
separate two-dimensional problems to obtain the parameter estimates for the three
bivariate copulas in T1. To do so, we use the bivariate version of the loglikelihood
given in (8). Then, we use these estimates and maximize the loglikelihood (8) with
respect to the remaining parameters of the bivariate copulas in T2 and T3. We
refer to this approach as T1-sequential estimation. Recall that the arguments of the
pair-copulas in T2 and T3 are univariate conditional distributions evaluated at the
associated copula data that are the arguments of the bivariate copulas in T1. Thus,
the arguments in T2 and T3 are not associated with observed (event or censored)
times. As a consequence, we cannot estimate the pair-copulas in T2 and T3 via
the two-dimensional version of (8). The use of the latter is only possible for T1.
Further, we rely on the R-package VineCopula (Schepsmeier et al. 2015), in which
the evaluation of h-functions, of the cumulative distribution function and of the
density function is implemented for many parametric bivariate copulas.

N. Barthel, C. Geerdens, M. Killiches, P. Janssen, C. Czado

10

We end this section by an important remark concerning the marginal modeling.
In practice, the marginal survival functions, which are assumed to be known in the
above discussion, are typically unknown. We can then use the two-stage estimation
procedure described in Shih and Louis (1995). First, a parametric approach can be
applied. In stage one, we assume Sj(·) to be known up to some parameter vector αj,
i.e. Sj(·) = Sj(·, αj) (j = 1, . . . , 4). We obtain the maximum likelihood estimate
(MLE) ˆαj of αj and we calculate ˆuij = Sj(yij, ˆαj) (i = 1, . . . , n and j = 1, . . . , 4). In
stage two, we replace uij by the pseudo-observation ˆuij (i = 1, . . . , n and j = 1, . . . , 4)
and we maximize the loglikelihood with respect to θ. Second, a semi-parametric
approach can be applied. In stage one, we estimate the marginals nonparametrically.
We obtain the Kaplan-Meier estimate (KME) ˆSj(·) of Sj(·) (j = 1, . . . , 4) and we
calculate the pseudo-observations ˆuij = ˆSj(yij). In stage two, we maximize the
loglikelihood with respect to θ.

5 Simulation study

We investigate the ﬁnite sample performance of the loglikelihood approach presented
in Section 4 through a simulation study. We hereby restrict ourselves to three
dimensions. A more elaborate study can be found in Barthel (2015, Chapter 4).

5.1 Considered scenarios

To generate multivariate right-censored time-to-event data with a dependence struc-
ture speciﬁed by a vine copula, we simulate in a ﬁrst step complete copula data
using the VineCopula package in R (Schepsmeier et al. 2015). We assume the copula
C to be a vine copula with density

(cid:0)C1|2 (u1|u2) , C3|2 (u3|u2)(cid:1) .

c (u1, u2, u3) = c12 (u1, u2) c23 (u2, u3) c13;2

Recall that in dimension three, all vine structures are equivalent up to the labeling
of the nodes. Here, the copulas C12 and C23 are assumed to arise from the same
copula family. We investigate both the scenario of lower tail-dependent copulas
using the Clayton family and the scenario of upper tail-dependent copulas using the
Gumbel family. To compare the simulation results, we take Kendall’s τ to be the
same in both tail-dependence scenarios; we set τ12 = 0.6 and τ23 = 0.6. We assume
C13;2 to be a Frank copula, which has no tail dependence, with τ13;2 = 0.3.

In a second step, the inverse probability integral transform is applied to the
marginal copula data to obtain the true event times. The marginal settings as well
as the censoring distributions from which the common right-censoring times are
sampled are given in Table 3. There, we assume Weibull models given by the survival

(cid:1)α(cid:1) with shape parameter α and scale parameter λ (in

function S (t) = exp(cid:0)−(cid:0) t

λ

accordance with the parametrization in R). Our choices are inspired by a modiﬁed
version of the three-dimensional rat data set of Mantel et al. (1977), where a common
censoring time applies to all rats of an individual litter (see Barthel (2015, Section
4.1.1)). To assess the eﬀect of censoring, we investigate the performance of the
estimation procedure for complete data as well as for a moderate overall censoring

Vine copula based inference of multivariate event time data

11

Weibull parameters

Marginal censoring

Event times

Censoring times

T1

α 3.39
λ
3.32

T2

4.20
2.21

T3

3.53
2.68

52% 12% 29%
82% 49% 67%

25%

6.72
3.11

x

65%

6.72
2.17

x

Table 3: Speciﬁcation of the Weibull parameters of the survival function for each of
the event times T1, T2, T3 and of the two common censoring distributions
leading to 25%, resp. 65% overall common right-censoring. Further, the
individual censoring rates for each of the three margins are shown.

rate of 25% and for a heavy censoring rate of 65%. Table 3 also illustrates that the
margins are aﬀected to a diﬀerent extent by a common censoring mechanism due to
diﬀerent associated survival functions.

Finally, the observed data are obtained by taking the minima of the true event
times and the associated censoring times. To this data we apply a two-stage approach
for known margins as well as for parametrically (MLE) and nonparametrically (KME)
estimated margins as described in Section 4. In case of complete event time data,
we use the empirical distribution functions (ECDF) as nonparametric estimates for
the marginals. All scenarios are investigated for samples of size 200 and 500. Each
sample is replicated 200 times.

The computations are conducted on a customary Windows 7 Lenovo laptop with
Intel(R) Core(TM) i5-3320M CPU @ 2.60 GHz and 8 GB RAM. For a sample
size of 500, the computation time for one loglikelihood evaluation, i.e.
for one
replication, ranges from on average 0.15 seconds for complete data to 3.2 minutes in
case of 65% censoring. This observation is due to an increasing amount of integrals
which need to be evaluated with an increasing percentage of censored observations.
For censored data, the three estimators using known margins, parametrically and
nonparametrically estimated margins show comparable performance in terms of
computation time.

5.2 Results

In the following, we visualize the results of the simulations in Figure 2 and Figure 3,
where the true Kendall’s τ values are indicated by a horizontal line. Table 4 and
Table 5 (Clayton for T1 and Frank for T2) and Table 6 and Table 7 (Gumbel for
T1 and Frank for T2) give a detailed summary of the simulation results. Here, θ
is the true parameter value, ¯θ and ¯θ0.05 are the mean estimate, resp. the trimmed
mean estimate, ˆb(¯θ) is the estimated bias, s2(¯θ) is the estimated standard error and
mse(¯θ) is the estimated mean squared error of ¯θ. The same performance measures
are given for the true Kendall’s τ values.

Figure 2 shows satisfactory performance of the estimators when common right-
censoring is present, even in case of heavy censoring (65%). The two-stage approaches
with (non)parametrically estimated margins beneﬁt the most from an increasing
sample size. In particular, due to the comparable performance of the fully parametric

N. Barthel, C. Geerdens, M. Killiches, P. Janssen, C. Czado

12

and the semiparametric estimation approach the latter qualiﬁes as an appropriate
choice when working with real data. It allows a ﬂexible estimation of the marginals
and excludes the risk to misspecify the underlying parametric models. Figure 3
illustrates the censoring eﬀect. Comparing the ﬁrst and second row particularly
illustrates the impact of the marginal censoring rates. Given Table 3 we indeed
expect that τ23 can be estimated in a more accurate way than τ12; the boxplots in
case of 65% censoring are therefore convincing (see also Figure 2). Also, the method
is more sensitive to heavy common right-censoring, especially when estimating the
parameters of a lower tail-dependent copula, as can be seen by comparing the left-
hand side and right-hand side of Figure 3. This is due to the lack of information in
the data for small copula values, i.e. high event times (see also Figure 4). Finally, we
can conclude that the presented method is on target for all investigated parameters
in the underlying R-vine models.

Vine copula based inference of multivariate event time data

13

2
T

n

i

a
l

u
p
o
c

k
n
a
r
F

,
1
T

n

i

s
a
l

u
p
o
c

l
e
b
m
u
G

2
T

n

i

a
l

u
p
o
c

k
n
a
r
F

,
1
T

n

i

s
a
l

u
p
o
c

n
o
t
y
a
l
C

,
s
n

i
g
r
a
m
n
w
o
n
K

.
0
0
5

d
n
a

0
0
2

s
e
z
i
s

e
l
p
m
a
s

d
n
a

3
.
0
=

2
;
3
1
τ

,
6
.
0
=

3
2
τ

,
6
.
0
=

2
1
τ

e
u
r
t

n
i

)
t
h
g
i
r
(

s
a
l

u
p
o
c

l
e
b
m
u
G
d
n
a

.

d
e
r
e
d
i
s
n
o
c

e
r
a

s
n
i
g
r
a
m
d
e
t
a
m

i
t
s
e

)
E
M
K
(

y
l
l
a
c
i
r
t
e
m
a
r
a
p
n
o
n

d
n
a

)
E
L
M

(

d
e
t
a
m

i
t
s
e

y
l
l
a
c
i
r
t
e
m
a
r
a
p

)
t
f
e
l
(

s
a
l
u
p
o
c

n
o
t
y
a
l
C
h
t
i
w
a
t
a
d

e
m

i
t

t
n
e
v
e

d
e
r
o
s
n
e
c
-
t
h
g
i
r

n
o
m
m
o
c
%
5
6

r
o
f

s
e
u

l
a
v

τ

s
’
l
l
a
d
n
e
K
d
e
t
a
m

i
t
s
e

e
h
t

f
o

s
t
o
l
p
x
o
B

:
2

e
r
u
g
i
F

,
1
T

KnownMLEKMEKnownMLEKMEt^120.000.100.200.300.400.500.600.70                     n = 200                                                    n = 500                 KnownMLEKMEKnownMLEKMEt^230.000.100.200.300.400.500.600.70                     n = 200                                                    n = 500                 KnownMLEKMEKnownMLEKMEt^13;20.000.100.200.300.400.500.600.70                     n = 200                                                    n = 500                 KnownMLEKMEKnownMLEKMEt^120.000.100.200.300.400.500.600.70                     n = 200                                                    n = 500                 KnownMLEKMEKnownMLEKMEt^230.000.100.200.300.400.500.600.70                     n = 200                                                    n = 500                 KnownMLEKMEKnownMLEKMEt^13;20.000.100.200.300.400.500.600.70                     n = 200                                                    n = 500                 N. Barthel, C. Geerdens, M. Killiches, P. Janssen, C. Czado

14

1
T

n

i

s
a
l
u
p
o
c

l
e
b
m
u
G

1
T

n

i

s
a
l

u
p
o
c

n
o
t
y
a
l
C

n
o
t
y
a
l
C
h
t
i
w
g
n

i
r
o
s
n
e
c
-
t
h
g
i
r

n
o
m
m
o
c

f
o

e
g
a
t
n
e
c
r
e
p

g
n

i
s
a
e
r
c
n

i

n
a

r
o
f

1
T

n

y
l
l
a
c
i
r
t
e
m
a
r
a
p

,
s
n

i
g
r
a
m
n
w
o
n
K

.
0
0
5

e
z
i
s

e
l

p
m
a
s
d
n
a

6
.
0
=

3
2
τ

,
6
.
0
=

2
1
τ

e
u
r
t

i

,
1
T
n

s
e
u

i

)
t
h
g
i
r
(

s
a
l

u
p
o
c

l
e
b
m
u
G
d
n
a

)
t
f
e
l
(

s
a
l
u
p
o
c

l
a
v

τ

s
’
l
l
a
d
n
e
K
d
e
t
a
m

i
t
s
e

e
h
t

f
o

s
t
o
l
p
x
o
B

:
3

e
r
u
g
i
F

.

d
e
r
e
d
i
s
n
o
c

e
r
a

)
E
M
K
/
F
D
C
E
(

s
n

i
g
r
a
m
d
e
t
a
m

i
t
s
e

y
l
l
a
c
i
r
t
e
m
a
r
a
p
n
o
n

d
n
a

)
E
L
M

(

s
n
i
g
r
a
m
d
e
t
a
m

i
t
s
e

KnownMLEECDFKnownMLEKMEKnownMLEKMEt^120.500.550.600.650.70                       complete data                     25% censoring                    65% censoring                       KnownMLEECDFKnownMLEKMEKnownMLEKMEt^230.500.550.600.650.70                       complete data                     25% censoring                    65% censoring                       KnownMLEECDFKnownMLEKMEKnownMLEKMEt^120.500.550.600.650.70                       complete data                     25% censoring                    65% censoring                       KnownMLEECDFKnownMLEKMEKnownMLEKMEt^230.500.550.600.650.70                       complete data                     25% censoring                    65% censoring                       Vine copula based inference of multivariate event time data

15

)
¯τ
(
e
s

(cid:100)m

6
3
0
0
.
0

6
1
0
0
.
0

2
6
0
0
.
0

1
4
0
0
.
0

4
2
0
0
.
0

6
6
0
0
.
0

1
4
0
0
.
0

6
2
0
0
.
0

7
6
0
0
.
0

3
1
0
0
.
0

7
0
0
0
.
0

8
2
0
0
.
0

5
1
0
0
.
0

8
0
0
0
.
0

8
2
0
0
.
0

6
1
0
0
.
0

8
0
0
0
.
0

9
2
0
0
.
0

τ

s
’
l
l
a
d
n
e
K

)
¯τ
(

2
s

6
3
0
0
.
0

6
1
0
0
.
0

2
6
0
0
.
0

0
4
0
0
.
0

4
2
0
0
.
0

6
6
0
0
.
0

1
4
0
0
.
0

5
2
0
0
.
0

6
6
0
0
.
0

3
1
0
0
.
0

7
0
0
0
.
0

7
2
0
0
.
0

5
1
0
0
.
0

8
0
0
0
.
0

8
2
0
0
.
0

6
1
0
0
.
0

8
0
0
0
.
0

9
2
0
0
.
0

)
¯τ
(
ˆb

5
2
0
0
.
0

9
0
0
0
.
0

2
5
0
0
.
0

3
7
0
0
.
0

9
3
0
0
.
0

2
5
0
0
.
0

1
2
0
0
.
0

5
2
0
0
.
0
-

1
8
0
0
.
0

4
4
0
0
.
0

8
0
0
0
.
0

2
5
0
0
.
0

1
5
0
0
.
0

6
1
0
0
.
0

2
5
0
0
.
0

0
3
0
0
.
0

7
1
0
0
.
0
-

3
6
0
0
.
0

5
0
.
0
¯τ

0
6
.
0

0
6
.
0

1
3
.
0

1
6
.
0

1
6
.
0

1
3
.
0

0
6
.
0

0
6
.
0

1
3
.
0

0
6
.
0

0
6
.
0

1
3
.
0

1
6
.
0

0
6
.
0

1
3
.
0

0
6
.
0

0
6
.
0

1
3
.
0

¯τ

τ

0
6
.
0

0
6
.
0

1
3
.
0

1
6
.
0

0
6
.
0

1
3
.
0

0
6
.
0

0
6
.
0

1
3
.
0

0
6
.
0

0
6
.
0

1
3
.
0

1
6
.
0

0
6
.
0

1
3
.
0

0
6
.
0

0
6
.
0

1
3
.
0

0
6
.
0

0
6
.
0

0
3
.
0

0
6
.
0

0
6
.
0

0
3
.
0

0
6
.
0

0
6
.
0

0
3
.
0

0
6
.
0

0
6
.
0

0
3
.
0

0
6
.
0

0
6
.
0

0
3
.
0

0
6
.
0

0
6
.
0

0
3
.
0

6
6
9
5
.
0

6
3
5
2
.
0

4
6
2
8
.
0

4
0
5
7
.
0

6
3
9
3
.
0

3
8
7
8
.
0

9
1
9
6
.
0

7
7
8
3
.
0

1
5
1
9
.
0

3
4
3
2
.
0

3
9
0
1
.
0

4
5
7
3
.
0

3
3
8
2
.
0

6
8
3
1
.
0

4
4
8
3
.
0

1
9
7
2
.
0

3
2
3
1
.
0

4
6
9
3
.
0

2
6
7
5
.
0

9
9
4
2
.
0

1
3
1
8
.
0

8
9
9
6
.
0

2
8
7
3
.
0

1
4
6
8
.
0

1
8
6
6
.
0

7
5
8
3
.
0

1
1
9
8
.
0

6
4
2
2
.
0

3
8
0
1
.
0

1
8
6
3
.
0

3
0
7
2
.
0

4
6
3
1
.
0

1
7
7
3
.
0

3
1
7
2
.
0

3
2
3
1
.
0

7
6
8
3
.
0

0
3
4
1
.
0

9
0
6
0
.
0

5
5
1
1
.
0

7
4
2
2
.
0

0
4
2
1
.
0

0
9
1
1
.
0

2
4
5
1
.
0

5
5
4
0
.
0

8
4
5
1
.
0

3
8
9
0
.
0

8
1
3
0
.
0

5
5
8
0
.
0

3
4
1
1
.
0

0
6
4
0
.
0

5
5
8
0
.
0

7
8
8
0
.
0

2
4
0
0
.
0

8
8
9
0
.
0

(cid:1)

(cid:0)

¯θ

ˆb

(cid:1)

¯θ

(cid:0)

e
s

(cid:100)m

(cid:1)

¯θ

(cid:0)
2
s

r
e
t
e
m
a
r
a
p

a
l

u
p
o
C

5
0
.
0
¯θ

3
1
.
3

6
0
.
3

3
0
.
3

1
2
.
3

2
1
.
3

3
0
.
3

3
1
.
3

4
0
.
3

7
0
.
3

8
0
.
3

3
0
.
3

9
9
.
2

9
0
.
3

4
0
.
3

0
0
.
3

7
0
.
3

0
0
.
3

1
0
.
3

¯θ

4
1
.
3

6
0
.
3

3
0
.
3

2
2
.
3

2
1
.
3

4
0
.
3

5
1
.
3

5
0
.
3

7
0
.
3

0
1
.
3

3
0
.
3

0
0
.
3

1
1
.
3

5
0
.
3

0
0
.
3

9
0
.
3

0
0
.
3

2
0
.
3

θ

0
0
.
3

0
0
.
3

2
9
.
2

0
0
.
3

0
0
.
3

2
9
.
2

0
0
.
3

0
0
.
3

2
9
.
2

0
0
.
3

0
0
.
3

2
9
.
2

0
0
.
3

0
0
.
3

2
9
.
2

0
0
.
3

0
0
.
3

2
9
.
2

2
1
θ

3
2
θ

2
;
3
1
θ

2
1
θ

3
2
θ

2
;
3
1
θ

2
1
θ

3
2
θ

2
;
3
1
θ

2
1
θ

3
2
θ

2
;
3
1
θ

2
1
θ

3
2
θ

2
;
3
1
θ

2
1
θ

3
2
θ

2
;
3
1
θ

C

C

F

C

C

F

C

C

F

C

C

F

C

C

F

C

C

F

Known

MLE

KME

Known

MLE

KME

n=200,65%censoring

n=500,65%censoring

)
F
(

k
n
a
r
F

,
)
C
(

n
o
t
y
a
l
C

,
)
C
(

n
o
t
y
a
l
C

n
o
i
t
a
n

i

b
m
o
c

a
l
u
p
o
c

e
h
T

.
0
0
5

d
n
a

0
0
2

s
e
z
i
s

e
l
p
m
a
s

h
t
i
w

a
t
a
d

e
m

i
t

t
n
e
v
e

d
e
r
o
s
n
e
c

d
n
a

)
E
L
M

(

s
n
i
g
r
a
m
d
e
t
a
m

i
t
s
e

y
l
l
a
c
i
r
t
e
m
a
r
a
p

,
s
n

i
g
r
a
m
n
w
o
n
K

.

d
e
t
a
g
i
t
s
e
v
n

i

s
i

3
.
0
=

2
;
3
1
τ

d
n
a

6
.
0
=

3
2
τ

,
6
.
0
=

2
1
τ

e
u
r
t

h
t
i
w

-
t
h
g
i
r

n
o
m
m
o
c
%
5
6

f
o

e
s
a
c

n

i

s
e
u

l
a
v

τ

s
’
l
l
a
d
n
e
K
d
n
a

s
r
e
t
e
m
a
r
a
p

a
l
u
p
o
c

e
h
t

f
o

n
o
i
t
a
m

i
t
s
e

e
h
t

r
o
f

s
e
r
u
s
a
e
m
e
c
n
a
m
r
o
f
r
e
P

:
4

e
l

b
a
T

.

d
e
r
e
d

i
s
n
o
c

e
r
a

)
E
M
K
(

s
n

i
g
r
a
m
d
e
t
a
m

i
t
s
e

y
l
l
a
c
i
r
t
e
m
a
r
a
p
n
o
n

N. Barthel, C. Geerdens, M. Killiches, P. Janssen, C. Czado

16

)
¯τ
(
e
s

(cid:100)m

3
0
0
0
.
0

2
0
0
0
.
0

1
1
0
0
.
0

6
0
0
0
.
0

4
0
0
0
.
0

1
1
0
0
.
0

6
0
0
0
.
0

5
0
0
0
.
0

2
1
0
0
.
0

2
0
0
0
.
0

2
0
0
0
.
0

7
0
0
0
.
0

3
0
0
0
.
0

3
0
0
0
.
0

7
0
0
0
.
0

3
0
0
0
.
0

4
0
0
0
.
0

8
0
0
0
.
0

τ

s
’
l
l
a
d
n
e
K

)
¯τ
(

2
s

)
¯τ
(
ˆb

3
0
0
0
.
0

2
0
0
0
.
0

1
1
0
0
.
0

6
0
0
0
.
0

4
0
0
0
.
0

1
1
0
0
.
0

6
0
0
0
.
0

4
0
0
0
.
0

1
1
0
0
.
0

1
0
0
0
.
0

2
0
0
0
.
0

7
0
0
0
.
0

3
0
0
0
.
0

3
0
0
0
.
0

7
0
0
0
.
0

3
0
0
0
.
0

4
0
0
0
.
0

7
0
0
0
.
0

4
1
0
0
.
0

7
0
0
0
.
0
-

5
1
0
0
.
0

4
1
0
0
.
0

2
1
0
0
.
0
-

7
1
0
0
.
0

4
2
0
0
.
0
-

1
6
0
0
.
0
-

5
2
0
0
.
0

5
2
0
0
.
0

1
0
0
0
.
0
-

5
3
0
0
.
0

1
0
0
0
.
0

8
2
0
0
.
0
-

0
3
0
0
.
0

4
0
0
0
.
0

3
2
0
0
.
0
-

6
3
0
0
.
0

5
0
.
0
¯τ

0
6
.
0

0
6
.
0

0
3
.
0

0
6
.
0

0
6
.
0

0
3
.
0

0
6
.
0

9
5
.
0

0
3
.
0

0
6
.
0

0
6
.
0

0
3
.
0

0
6
.
0

0
6
.
0

0
3
.
0

0
6
.
0

0
6
.
0

0
3
.
0

¯τ

τ

0
6
.
0

0
6
.
0

0
3
.
0

0
6
.
0

0
6
.
0

0
3
.
0

0
6
.
0

9
5
.
0

0
3
.
0

0
6
.
0

0
6
.
0

0
3
.
0

0
6
.
0

0
6
.
0

0
3
.
0

0
6
.
0

0
6
.
0

0
3
.
0

0
6
.
0

0
6
.
0

0
3
.
0

0
6
.
0

0
6
.
0

0
3
.
0

0
6
.
0

0
6
.
0

0
3
.
0

0
6
.
0

0
6
.
0

0
3
.
0

0
6
.
0

0
6
.
0

0
3
.
0

0
6
.
0

0
6
.
0

0
3
.
0

)
F
(

k
n
a
r
F

,
)
C
(

n
o
t
y
a
l
C

,
)
C
(

n
o
t
y
a
l
C
n
o
i
t
a
n

i

b
m
o
c

a
l

u
p
o
c

e
h
T

.
0
0
5

e
z
i
s

e
l
p
m
a
s

h
t
i
w
a
t
a
d

e
m

i
t

t
n
e
v
e

d
e
r
o
s
n
e
c
-
t
h
g
i
r

n
o
m
m
o
c

d
n
a

)
E
L
M

(

s
n
i
g
r
a
m
d
e
t
a
m

i
t
s
e

y
l
l
a
c
i
r
t
e
m
a
r
a
p

,
s
n
i
g
r
a
m
n
w
o
n
K

.

d
e
t
a
g
i
t
s
e
v
n

i

s
i

3
.
0
=

2
;
3
1
τ

d
n
a

6
.
0
=

3
2
τ

,
6
.
0
=

2
1
τ

e
u
r
t

h
t
i
w

%
5
2

d
n
a

e
t
e
l

p
m
o
c

f
o

e
s
a
c

n

i

s
e
u

l
a
v

τ

s
’
l
l
a
d
n
e
K
d
n
a

s
r
e
t
e
m
a
r
a
p

a
l
u
p
o
c

e
h
t

f
o

n
o
i
t
a
m

i
t
s
e

e
h
t

r
o
f

s
e
r
u
s
a
e
m
e
c
n
a
m
r
o
f
r
e
P

:
5

e
l

b
a
T

.

d
e
r
e
d

i
s
n
o
c

e
r
a

)
E
M
K
(

s
n

i
g
r
a
m
d
e
t
a
m

i
t
s
e

y
l
l
a
c
i
r
t
e
m
a
r
a
p
n
o
n

5
4
5
0
.
0

2
2
3
0
.
0

9
3
4
1
.
0

4
8
8
0
.
0

9
9
5
0
.
0

7
8
4
1
.
0

5
0
9
0
.
0

1
6
6
0
.
0

2
1
5
1
.
0

8
4
2
0
.
0

9
3
2
0
.
0

7
3
9
0
.
0

5
1
5
0
.
0

3
2
5
0
.
0

9
2
9
0
.
0

5
4
5
0
.
0

5
5
5
0
.
0

0
0
0
1
.
0

7
3
5
0
.
0

2
2
3
0
.
0

1
3
4
1
.
0

2
7
8
0
.
0

9
9
5
0
.
0

8
7
4
1
.
0

4
0
9
0
.
0

1
2
6
0
.
0

7
9
4
1
.
0

5
3
2
0
.
0

9
3
2
0
.
0

6
1
9
0
.
0

4
1
5
0
.
0

7
1
5
0
.
0

2
1
9
0
.
0

3
4
5
0
.
0

1
5
5
0
.
0

7
7
9
0
.
0

2
8
2
0
.
0

1
2
0
0
.
0
-

5
7
2
0
.
0

5
4
3
0
.
0

8
2
0
0
.
0
-

2
9
2
0
.
0

3
1
1
0
.
0
-

9
2
6
0
.
0
-

1
9
3
0
.
0

4
6
3
0
.
0

6
3
0
0
.
0

7
5
4
0
.
0

0
1
1
0
.
0

7
4
2
0
.
0
-

8
0
4
0
.
0

3
5
1
0
.
0

6
7
1
0
.
0
-

1
8
4
0
.
0

(cid:1)

(cid:0)

¯θ

ˆb

(cid:1)

¯θ

(cid:0)

e
s

(cid:100)m

(cid:1)

¯θ

(cid:0)
2
s

r
e
t
e
m
a
r
a
p

a
l

u
p
o
C

5
0
.
0
¯θ

3
0
.
3

0
0
.
3

4
9
.
2

4
0
.
3

0
0
.
3

5
9
.
2

9
9
.
2

3
9
.
2

5
9
.
2

3
0
.
3

0
0
.
3

6
9
.
2

1
0
.
3

7
9
.
2

6
9
.
2

1
0
.
3

8
9
.
2

6
9
.
2

¯θ

3
0
.
3

0
0
.
3

4
9
.
2

3
0
.
3

0
0
.
3

5
9
.
2

9
9
.
2

4
9
.
2

6
9
.
2

4
0
.
3

0
0
.
3

6
9
.
2

1
0
.
3

8
9
.
2

6
9
.
2

2
0
.
3

8
9
.
2

7
9
.
2

θ

0
0
.
3

0
0
.
3

2
9
.
2

0
0
.
3

0
0
.
3

2
9
.
2

0
0
.
3

0
0
.
3

2
9
.
2

0
0
.
3

0
0
.
3

2
9
.
2

0
0
.
3

0
0
.
3

2
9
.
2

0
0
.
3

0
0
.
3

2
9
.
2

2
1
θ

3
2
θ

2
;
3
1
θ

2
1
θ

3
2
θ

2
;
3
1
θ

2
1
θ

3
2
θ

2
;
3
1
θ

2
1
θ

3
2
θ

2
;
3
1
θ

2
1
θ

3
2
θ

2
;
3
1
θ

2
1
θ

3
2
θ

2
;
3
1
θ

C

C

F

C

C

F

C

C

F

C

C

F

C

C

F

C

C

F

Known

MLE

KME

Known

MLE

ECDF

n=500,25%censoring

n=500,completedata

Vine copula based inference of multivariate event time data

17

)
¯τ
(
e
s

(cid:100)m

6
1
0
0
.
0

0
1
0
0
.
0

9
6
0
0
.
0

1
2
0
0
.
0

4
1
0
0
.
0

6
7
0
0
.
0

4
2
0
0
.
0

5
1
0
0
.
0

5
7
0
0
.
0

7
0
0
0
.
0

4
0
0
0
.
0

0
3
0
0
.
0

9
0
0
0
.
0

6
0
0
0
.
0

0
3
0
0
.
0

1
1
0
0
.
0

6
0
0
0
.
0

3
3
0
0
.
0

)
¯τ
(

2
s

)
¯τ
(
ˆb

6
1
0
0
.
0

0
1
0
0
.
0

9
6
0
0
.
0

1
2
0
0
.
0

4
1
0
0
.
0

6
7
0
0
.
0

3
2
0
0
.
0

5
1
0
0
.
0

5
7
0
0
.
0

7
0
0
0
.
0

4
0
0
0
.
0

0
3
0
0
.
0

9
0
0
0
.
0

6
0
0
0
.
0

0
3
0
0
.
0

0
1
0
0
.
0

6
0
0
0
.
0

3
3
0
0
.
0

3
0
0
0
.
0

7
0
0
0
.
0

8
0
0
0
.
0

6
2
0
0
.
0
-

4
0
0
0
.
0

9
0
0
0
.
0

7
6
0
0
.
0

9
4
0
0
.
0

1
1
0
0
.
0

2
4
0
0
.
0

6
0
0
0
.
0

0
2
0
0
.
0

9
2
0
0
.
0

2
0
0
0
.
0

1
2
0
0
.
0

6
5
0
0
.
0

0
1
0
0
.
0

5
2
0
0
.
0

5
0
.
0
¯τ

0
6
.
0

0
6
.
0

0
3
.
0

0
6
.
0

0
6
.
0

0
3
.
0

1
6
.
0

1
6
.
0

0
3
.
0

0
6
.
0

0
6
.
0

0
3
.
0

0
6
.
0

0
6
.
0

0
3
.
0

1
6
.
0

0
6
.
0

0
3
.
0

τ

s
’
l
l
a
d
n
e
K

¯τ

τ

(cid:1)

¯θ

(cid:0)

e
s

(cid:100)m

(cid:1)

¯θ

(cid:0)
2
s

(cid:1)

(cid:0)

r
e
t
e
m
a
r
a
p

a
l

u
p
o
C

¯θ

ˆb

0
6
.
0

0
6
.
0

0
3
.
0

0
6
.
0

0
6
.
0

0
3
.
0

1
6
.
0

0
6
.
0

0
3
.
0

0
6
.
0

0
6
.
0

0
3
.
0

0
6
.
0

0
6
.
0

0
3
.
0

1
6
.
0

0
6
.
0

0
3
.
0

0
6
.
0

0
6
.
0

0
3
.
0

0
6
.
0

0
6
.
0

0
3
.
0

0
6
.
0

0
6
.
0

0
3
.
0

0
6
.
0

0
6
.
0

0
3
.
0

0
6
.
0

0
6
.
0

0
3
.
0

0
6
.
0

0
6
.
0

0
3
.
0

8
4
6
0
.
0

0
0
4
0
.
0

8
2
0
9
.
0

0
3
8
0
.
0

7
7
5
0
.
0

8
4
0
0
.
1

6
3
1
1
.
0

5
6
6
0
.
0

4
4
0
0
.
1

5
0
3
0
.
0

1
7
1
0
.
0

5
2
8
3
.
0

6
8
3
0
.
0

4
4
2
0
.
0

8
1
9
3
.
0

2
7
4
0
.
0

7
5
2
0
.
0

9
4
2
4
.
0

1
4
6
0
.
0

6
9
3
0
.
0

8
7
9
8
.
0

7
2
8
0
.
0

0
7
5
0
.
0

6
8
9
9
.
0

9
6
0
1
.
0

4
3
6
0
.
0

9
7
9
9
.
0

1
9
2
0
.
0

0
7
1
0
.
0

0
0
8
3
.
0

6
7
3
0
.
0

3
4
2
0
.
0

2
9
8
3
.
0

5
4
4
0
.
0

4
5
2
0
.
0

6
1
2
4
.
0

5
6
2
0
.
0

1
0
2
0
.
0

5
0
7
0
.
0

8
5
1
0
.
0

0
5
2
0
.
0

3
8
7
0
.
0

0
2
8
0
.
0

8
5
5
0
.
0

5
0
8
0
.
0

6
7
3
0
.
0

6
0
1
0
.
0

4
9
4
0
.
0

4
2
3
0
.
0

7
0
1
0
.
0

7
0
5
0
.
0

4
2
5
0
.
0

2
6
1
0
.
0

8
7
5
0
.
0

5
0
.
0
¯θ

2
5
.
2

2
5
.
2

9
9
.
2

1
5
.
2

2
5
.
2

9
9
.
2

7
5
.
2

5
5
.
2

0
0
.
3

3
5
.
2

1
5
.
2

7
9
.
2

3
5
.
2

1
5
.
2

8
9
.
2

5
5
.
2

2
5
.
2

8
9
.
2

¯θ

3
5
.
2

2
5
.
2

9
9
.
2

2
5
.
2

3
5
.
2

0
0
.
3

8
5
.
2

6
5
.
2

0
0
.
3

4
5
.
2

1
5
.
2

7
9
.
2

3
5
.
2

1
5
.
2

7
9
.
2

5
5
.
2

2
5
.
2

8
9
.
2

θ

0
5
.
2

0
5
.
2

2
9
.
2

0
5
.
2

0
5
.
2

2
9
.
2

0
5
.
2

0
5
.
2

2
9
.
2

0
5
.
2

0
5
.
2

2
9
.
2

0
5
.
2

0
5
.
2

2
9
.
2

0
5
.
2

0
5
.
2

2
9
.
2

2
1
θ

3
2
θ

2
;
3
1
θ

2
1
θ

3
2
θ

2
;
3
1
θ

2
1
θ

3
2
θ

2
;
3
1
θ

2
1
θ

3
2
θ

2
;
3
1
θ

2
1
θ

3
2
θ

2
;
3
1
θ

2
1
θ

3
2
θ

2
;
3
1
θ

G

G

F

G

G

F

G

G

F

G

G

F

G

G

F

G

G

F

Known

MLE

KME

Known

MLE

KME

n=200,65%censoring

n=500,65%censoring

)
F
(

k
n
a
r
F

,
)

G

(

l
e
b
m
u
G

,
)

G

(

l
e
b
m
u
G
n
o
i
t
a
n
b
m
o
c

i

a
l
u
p
o
c

e
h
T

.
0
0
5

d
n
a

0
0
2

s
e
z
i
s

e
l
p
m
a
s

h
t
i
w

a
t
a
d

e
m

i
t

t
n
e
v
e

d
e
r
o
s
n
e
c

d
n
a

)
E
L
M

(

s
n
i
g
r
a
m
d
e
t
a
m

i
t
s
e

y
l
l
a
c
i
r
t
e
m
a
r
a
p

,
s
n

i
g
r
a
m
n
w
o
n
K

.

d
e
t
a
g
i
t
s
e
v
n

i

s
i

3
.
0
=

2
;
3
1
τ

d
n
a

6
.
0
=

3
2
τ

,
6
.
0
=

2
1
τ

e
u
r
t

h
t
i
w

-
t
h
g
i
r

n
o
m
m
o
c
%
5
6

f
o

e
s
a
c

n

i

s
e
u

l
a
v

τ

s
’
l
l
a
d
n
e
K
d
n
a

s
r
e
t
e
m
a
r
a
p

a
l
u
p
o
c

e
h
t

f
o

n
o
i
t
a
m

i
t
s
e

e
h
t

r
o
f

s
e
r
u
s
a
e
m
e
c
n
a
m
r
o
f
r
e
P

:
6

e
l

b
a
T

.

d
e
r
e
d

i
s
n
o
c

e
r
a

)
E
M
K
(

s
n

i
g
r
a
m
d
e
t
a
m

i
t
s
e

y
l
l
a
c
i
r
t
e
m
a
r
a
p
n
o
n

N. Barthel, C. Geerdens, M. Killiches, P. Janssen, C. Czado

18

)
¯τ
(
e
s

(cid:100)m

3
0
0
0
.
0

3
0
0
0
.
0

2
1
0
0
.
0

5
0
0
0
.
0

4
0
0
0
.
0

2
1
0
0
.
0

5
0
0
0
.
0

4
0
0
0
.
0

2
1
0
0
.
0

2
0
0
0
.
0

2
0
0
0
.
0

8
0
0
0
.
0

3
0
0
0
.
0

3
0
0
0
.
0

8
0
0
0
.
0

3
0
0
0
.
0

4
0
0
0
.
0

8
0
0
0
.
0

)
¯τ
(

2
s

)
¯τ
(
ˆb

3
0
0
0
.
0

3
0
0
0
.
0

2
1
0
0
.
0

5
0
0
0
.
0

4
0
0
0
.
0

2
1
0
0
.
0

5
0
0
0
.
0

4
0
0
0
.
0

2
1
0
0
.
0

2
0
0
0
.
0

2
0
0
0
.
0

8
0
0
0
.
0

3
0
0
0
.
0

3
0
0
0
.
0

8
0
0
0
.
0

3
0
0
0
.
0

4
0
0
0
.
0

8
0
0
0
.
0

1
2
0
0
.
0

2
0
0
0
.
0

0
0
0
0
.
0

1
2
0
0
.
0

4
0
0
0
.
0

7
0
0
0
.
0
-

8
1
0
0
.
0

7
0
0
0
.
0
-

1
0
0
0
.
0
-

9
2
0
0
.
0

5
0
0
0
.
0

8
2
0
0
.
0

4
1
0
0
.
0

8
0
0
0
.
0
-

8
1
0
0
.
0

2
3
0
0
.
0

6
0
0
0
.
0

8
1
0
0
.
0

5
0
.
0
¯τ

0
6
.
0

0
6
.
0

0
3
.
0

0
6
.
0

0
6
.
0

0
3
.
0

0
6
.
0

0
6
.
0

0
3
.
0

0
6
.
0

0
6
.
0

0
3
.
0

0
6
.
0

0
6
.
0

0
3
.
0

0
6
.
0

0
6
.
0

0
3
.
0

τ

s
’
l
l
a
d
n
e
K

¯τ

τ

(cid:1)

¯θ

(cid:0)

e
s

(cid:100)m

(cid:1)

¯θ

(cid:0)
2
s

(cid:1)

(cid:0)

r
e
t
e
m
a
r
a
p

a
l

u
p
o
C

¯θ

ˆb

0
6
.
0

0
6
.
0

0
3
.
0

0
6
.
0

0
6
.
0

0
3
.
0

0
6
.
0

0
6
.
0

0
3
.
0

0
6
.
0

0
6
.
0

0
3
.
0

0
6
.
0

0
6
.
0

0
3
.
0

0
6
.
0

0
6
.
0

0
3
.
0

0
6
.
0

0
6
.
0

0
3
.
0

0
6
.
0

0
6
.
0

0
3
.
0

0
6
.
0

0
6
.
0

0
3
.
0

0
6
.
0

0
6
.
0

0
3
.
0

0
6
.
0

0
6
.
0

0
3
.
0

0
6
.
0

0
6
.
0

0
3
.
0

2
3
1
0
.
0

1
0
1
0
.
0

8
1
5
1
.
0

3
0
2
0
.
0

8
4
1
0
.
0

9
2
5
1
.
0

0
1
2
0
.
0

5
5
1
0
.
0

3
0
6
1
.
0

3
8
0
0
.
0

6
8
0
0
.
0

2
1
0
1
.
0

5
2
1
0
.
0

1
3
1
0
.
0

1
9
9
0
.
0

1
4
1
0
.
0

5
4
1
0
.
0

8
4
0
1
.
0

9
2
1
0
.
0

0
0
1
0
.
0

7
1
5
1
.
0

8
9
1
0
.
0

8
4
1
0
.
0

9
2
5
1
.
0

7
0
2
0
.
0

5
5
1
0
.
0

2
0
6
1
.
0

8
7
0
0
.
0

6
8
0
0
.
0

7
9
9
0
.
0

3
2
1
0
.
0

1
3
1
0
.
0

3
8
9
0
.
0

5
3
1
0
.
0

4
4
1
0
.
0

0
4
0
1
.
0

1
8
1
0
.
0

2
5
0
0
.
0

7
0
1
0
.
0

7
0
2
0
.
0

4
8
0
0
.
0

7
2
0
0
.
0

3
9
1
0
.
0

8
1
0
0
.
0

6
0
1
0
.
0

2
1
2
0
.
0

4
6
0
0
.
0

8
8
3
0
.
0

6
3
1
0
.
0

0
0
0
0
.
0
-

6
7
2
0
.
0

5
5
2
0
.
0

4
9
0
0
.
0

9
7
2
0
.
0

5
0
.
0
¯θ

2
5
.
2

1
5
.
2

2
9
.
2

2
5
.
2

1
5
.
2

1
9
.
2

2
5
.
2

0
5
.
2

2
9
.
2

2
5
.
2

1
5
.
2

5
9
.
2

1
5
.
2

0
5
.
2

4
9
.
2

3
5
.
2

1
5
.
2

4
9
.
2

¯θ

2
5
.
2

1
5
.
2

3
9
.
2

2
5
.
2

1
5
.
2

2
9
.
2

2
5
.
2

0
5
.
2

3
9
.
2

2
5
.
2

1
5
.
2

6
9
.
2

1
5
.
2

0
5
.
2

5
9
.
2

3
5
.
2

1
5
.
2

5
9
.
2

θ

0
5
.
2

0
5
.
2

2
9
.
2

0
5
.
2

0
5
.
2

2
9
.
2

0
5
.
2

0
5
.
2

2
9
.
2

0
5
.
2

0
5
.
2

2
9
.
2

0
5
.
2

0
5
.
2

2
9
.
2

0
5
.
2

0
5
.
2

2
9
.
2

2
1
θ

3
2
θ

2
;
3
1
θ

2
1
θ

3
2
θ

2
;
3
1
θ

2
1
θ

3
2
θ

2
;
3
1
θ

2
1
θ

3
2
θ

2
;
3
1
θ

2
1
θ

3
2
θ

2
;
3
1
θ

2
1
θ

3
2
θ

2
;
3
1
θ

G

G

F

G

G

F

G

G

F

G

G

F

G

G

F

G

G

F

Known

MLE

KME

Known

MLE

ECDF

n=500,25%censoring

n=500,completedata

)
F
(

k
n
a
r
F

,
)

G

(

l
e
b
m
u
G

,
)

G

(

l
e
b
m
u
G
n
o
i
t
a
n

i

b
m
o
c

a
l
u
p
o
c

e
h
T

.
0
0
5

e
z
i
s

e
l
p
m
a
s

h
t
i
w
a
t
a
d

e
m

i
t

t
n
e
v
e

d
e
r
o
s
n
e
c
-
t
h
g
i
r

n
o
m
m
o
c

d
n
a

)
E
L
M

(

s
n
i
g
r
a
m
d
e
t
a
m

i
t
s
e

y
l
l
a
c
i
r
t
e
m
a
r
a
p

,
s
n

i
g
r
a
m
n
w
o
n
K

.

d
e
t
a
g
i
t
s
e
v
n

i

s
i

3
.
0
=

2
;
3
1
τ

d
n
a

6
.
0
=

3
2
τ

,
6
.
0
=

2
1
τ

e
u
r
t

h
t
i
w

%
5
2

d
n
a

e
t
e
l
p
m
o
c

f
o

e
s
a
c

n

i

s
e
u

l
a
v

τ

s
’
l
l
a
d
n
e
K
d
n
a

s
r
e
t
e
m
a
r
a
p

a
l
u
p
o
c

e
h
t

f
o

n
o
i
t
a
m

i
t
s
e

e
h
t

r
o
f

s
e
r
u
s
a
e
m
e
c
n
a
m
r
o
f
r
e
P

:
7

e
l

b
a
T

.

d
e
r
e
d

i
s
n
o
c

e
r
a

)
E
M
K
/
F
D
C
E
(

s
n

i
g
r
a
m
d
e
t
a
m

i
t
s
e

y
l
l
a
c
i
r
t
e
m
a
r
a
p
n
o
n

Vine copula based inference of multivariate event time data

19

6 Real data application: The mastitis data

In this section, we investigate the dependence structure present in the mastitis data
by ﬁtting several vine copula models. Recall that we observe 407 clusters with heavy
censoring of 66.15%. With the simulation results for nonparametrically estimated
margins in mind, we use the two-stage semiparametric estimation approach (see
Section 4). The copula parameters are estimated T1-sequentially. We consider vine
copula models based on one parameter bivariate copulas such that all considered
models have the same number of parameters (six). In this case, the AIC and BIC
both select the model that gives the highest loglikelihood. We therefore use the
loglikelihood for model selection. The use of the loglikelihood value as well as the
AIC and BIC for model selection in the context of semiparametric copula estimation
has been studied in Chen et al. (2010) and, for right-censoring, in Geerdens et al.
(2015).

One loglikelihood evaluation, performed on a customary Windows 7 Lenovo
laptop with Intel(R) Core(TM) i5-3320M CPU @ 2.60 GHz and 8 GB RAM, takes
on average 100 minutes. Note that the computation time particularly depends on
the R-vine structure of the investigated model. The latter determines, based on the
censoring pattern within the clusters, the number of double integrals that need to
be evaluated.

In the following, we assume a D-vine tree structure for the mastitis data. This
choice captures a serial ordering and therewith implies that the infection might
spread from one udder quarter to a neighbouring one. For all possible 12 D-vines
the same type of copula is assumed in T1, i.e. we use the Clayton, Gumbel or
Frank copula, respectively. Further, Frank copulas are taken in the two lower tree
levels. By doing so, 36 models are investigated in total. Table 8 shows the values
of the loglikelihood for the considered models. In general, D-vine structures that
capture the dependence along the two ﬂanks perform best, whereas D-vines with
two diagonals would generally not be selected. Further, the choice of Frank and
Clayton copulas in T1 is superior to the one of Gumbel copulas. Models with Frank
copulas perform slightly better than those with Clayton copulas. Note that for
heavy censored copula data the lower left corner of a pairs plot is empty. However,
there might be a considerable amount of observed event times in the upper right
corner, where, therefore, most of the information is located (see Figure 4 and the
detailed discussion below). Since Clayton and Frank copulas behave similarly in the
upper right corner, i.e. for early event times, it is plausible that the information loss
in case of heavy right-censoring makes it diﬃcult to distinguish between Clayton
and Frank copulas.

To further explore this ﬁnding we consider for the D-vine with structure (c) (the
best performing structure in Table 8) the 24 additional vine models (besides C-C-C,
G-G-G and F-F-F in T1) having structure (c), where we allow combinations of
Clayton, Gumbel and Frank copulas in T1. The values of the loglikelihood are listed
in Table 9. The model with all dependencies captured by Frank copulas remains
the best (see Table 8), but models which combine Clayton and Frank copulas in T1
perform equally well. The estimated copula parameters of the four best models are
given in Table 10 together with their corresponding estimated Kendall’s τ values
and tail-dependence coeﬃcients. A strong lower tail-dependence and thus a strong

N. Barthel, C. Geerdens, M. Killiches, P. Janssen, C. Czado

20

association between late event times is detected for Clayton copulas in T1. Further,
the overall dependence strengths detected for the three udder pairs in T1 is higher
for Clayton copulas as compared to Frank copulas.

These results are in line with the ﬁndings in Geerdens et al. (2015), where a
Joe-Hu copula that combines a Clayton Laplace transform with bivariate Frank
copulas is in the top three of the best models. Both analyses, using a vine copula
or using a Joe-Hu copula, stress the need for ﬂexible copula models for the mastitis
data.

The above discussion clearly indicates that information loss due to right-censoring
complicates accurate model selection and shows the need for a careful comparison of
possible models. To demonstrate this, we give, in Figure 4, the pairs plot correspond-
ing to the two front udder quarters of the mastitis data. The pseudo-observations
are generated via Kaplan-Meier estimates of the marginals. In particular, for each
data point the joint censoring status is indicated.

An observation visualized using a left-pointing arrow corresponds to a true event
time for the right front quarter and a censored observation for the left front quarter.
For the latter, the observed time is smaller than the true event time, which results
in a larger observed copula value (the copula represents a survival function). Thus,
the left arrow indicates that the copula value associated with the true event time lies
anywhere to the left of the observed value. In general, see also the down-pointing
arrows and the combination of both left- and down-pointing arrows, it is clear
that right-censoring leads to a shift of the complete copula data, i.e. copula data
associated with the true event times, away from the lower left corner of the unit-
square. Thus, even when using modiﬁed estimation methods that take the censoring
into account, it is a challenge to ﬁt copula families that have high probability mass
for low copula values.

Figure 4: Pairs plot of the two front udder quarters of the mastitis data based
on pseudo-observations generated via Kaplan-Meier estimates of the
marginals. Observations shown as • are event times for both udder quar-
ters; ← is an event time only for FR; ↓ is an event time only for FL;
censored in both components is shown as ←↓.

0.00.20.40.60.81.00.00.20.40.60.81.0Front left quarter (FL)Front right quarter (FR)Vine copula based inference of multivariate event time data

21

FRONT

(a)

(b)

(c)

(d)

D-vine

Common family in T1

Clayton Gumbel

Frank

T
F
E
L

1

3

1

3

1

3

2

4

2

4

2

4

(e)

(i)

1

3

1

3

1

3

2

4

2

4

2

4

(f)

(j)

1

3

1

3

1

3

2

4

2

4

2

4

(g)

(k)

REAR

1

3

1

3

1

3

2

4

2

4

2

4

(h)

(l)

I

R
G
H
T

d
o
o
h

i
l
e
k
i
l
g
o
l

(a)
(b)
(c)
(d)
(e)
(f)
(g)
(h)
(i)
(j)
(k)
(l)

-138.27
-139.20
-127.30
-138.56
-140.17
-129.89
-138.42
-132.20
-140.88
-133.18
-137.61
-130.19

-153.69
-148.99
-143.09
-148.21
-142.31
-145.99
-144.80
-147.64
-146.00
-143.88
-141.80
-145.73

-137.30
-136.10
-124.81
-134.96
-136.77
-130.16
-136.41
-131.03
-139.46
-134.90
-137.16
-134.29

Table 8: D-vine structures considered for the mastitis data and corresponding values
of the loglikelihood using a T1-sequential estimation approach. Frank
copulas are taken in T2 and T3.

loglikelihood Copula parameter Kendall’s τ

Tail-dependence
upper
lower

Frank
Frank
Frank
Frank
Frank
Frank

Clayton
Frank
Frank
Frank
Frank
Frank

Frank
Frank
Clayton
Frank
Frank
Frank

Clayton
Frank
Clayton
Frank
Frank
Frank

ˆθ13
ˆθ34
ˆθ24
ˆθ14;3
ˆθ23;4
ˆθ12;34
ˆθ13
ˆθ34
ˆθ24
ˆθ14;3
ˆθ23;4
ˆθ12;34
ˆθ13
ˆθ34
ˆθ24
ˆθ14;3
ˆθ23;4
ˆθ12;34
ˆθ13
ˆθ34
ˆθ24
ˆθ14;3
ˆθ23;4
ˆθ12;34

-124.81

-125.49

-125.78

-125.82

6.38
6.34
6.77
1.69
2.82
3.72

3.60
6.34
6.77
1.49
2.78
3.46

6.38
6.34
3.90
1.57
2.72
3.84

3.60
6.34
3.90
1.38
2.72
3.70

0.53
0.53
0.55
0.18
0.29
0.37

0.64
0.53
0.55
0.16
0.29
0.35

0.53
0.53
0.66
0.17
0.28
0.38

0.64
0.53
0.66
0.15
0.28
0.37

–
–
–
–
–
–

0.82

–
–
–
–
–

–
–

0.84

–
–
–

0.82

–

0.84

–
–
–

–
–
–
–
–
–

–
–
–
–
–
–

–
–
–
–
–
–

–
–
–
–
–
–

Table 10: Estimated copula parameters, Kendall’s τ values and tail-dependence
coeﬃcients for the four best models ﬁtted to the mastitis data with
underlying D-vine structure (c).

N. Barthel, C. Geerdens, M. Killiches, P. Janssen, C. Czado

22

C–C–F
-127.53

C–F–C
-125.82

Families in T1: fam13–fam34–fam24
F–C–C
-128.82

C–F–F
-125.49

F–C–F
-127.88

F–F–C
-125.78

C–C–G C–G–C
-141.96
-137.65

d
o
o
h

i
l
e
k
i
l
g
o
l

G–C–C C–G–G G–C–G G–G–C C–G–F C–F–G G–C–F F–C–G
-144.55
-141.98

-155.19

-138.53

-135.04

-138.18

-143.61

-144.37

G–F–C F–G–C G–G–F G–F–G F–G–G G–F–F
-141.47
-139.56

-139.77

-136.07

-136.42

-149.27

F–G–F
-132.79

F–F–G
-137.43

Table 9: Values of the loglikelihood for models with D-vine structure (c) and combi-
nations of Clayton (C), Gumbel (G) and Frank (F) copulas in T1. Frank
copulas are taken in T2 and T3. The results are obtained through the
T1-sequential approach.

7 Conclusion and Outlook

In this paper, we investigate likelihood based inference for clustered right-censored
event times using vine copulas. Prior to this work, vine theory has only been
developed for complete data. Theorem 1 and Corollary 1 (see Appendix) provide
the likelihood contributions for right-censored quadruple data in terms of vine copula
components. For right-censored trivariate data a simulation study gives evidence
that the presented estimators are on target. Several R-vine models are ﬁtted to
the four-dimensional mastitis data. The results are in line with Geerdens et al.
(2015), where the Joe-Hu family is used for ﬂexible dependence modeling in right-
censored event time data. Both methods stress the need for more ﬂexible copula
models as compared to less elaborated ones such as exchangeable (EAC) and nested
Archimedean copulas (NAC).

Due to the appearance of double integrals, the vine based likelihood approach
where all parameters of the underlying R-vine model are estimated simultaneously
is numerically demanding even for quadruple data. Also, for higher dimensions the
number of parameters increases rapidly for both vine copulas and Joe-Hu copulas.
Many ﬁelds of application such as clinical experiments or actuarial science claim
ﬂexible dependence modeling also in higher dimensions. Therefore, it is desirable to
utilize the so-called sequential estimation approach that is speciﬁcally designed for
pair-copula constructions also for event time data. The basic idea is to reduce the
estimation of a d-dimensional density to several two-dimensional problems. This
extension is an interesting and at the same time a challenging research problem that
we are currently investigating.

Acknowledgements

The authors wish to thank Dr. H. Laevens (Catholic University College Sint-Lieven,
Sint- Niklaas, Belgium) for the permission to use the mastitis data as a real data
example for this research and Dr. Ulf Schepsmeier for discussions on early drafts of

Vine copula based inference of multivariate event time data

23

the paper. Financial support from the Deutsche Forschungsgemeinschaft (DFG CZ
86/41) and the Interuniversity Attraction Poles Programme (IAP-network P7/06),
Belgian Science Policy Oﬃce, is gratefully acknowledged. The 3rd author is thankful
for the support from Allianz Deutschland AG.

Parts of the numerical calculations were performed on a Linux cluster supported

by DFG grant INST 95/919-1 FUGG.

References

Aas, K., Czado, C., Frigessi, A., and Bakken, H. (2009). Pair-copula constructions
of multiple dependence. Insurance: Mathematics and Economics, 44(2):182–198.

Andersen, E. W. (2005). Two-stage estimation in copula models used in family

studies. Lifetime Data Analysis, 11(3):333–350.

Barthel, N. (2015). Multivariate Survival Analysis using Vine-Copulas. Master’s

thesis, Technische Universit¨at M¨unchen.
https://mediatum.ub.tum.de/doc/1276329/1276329.pdf.

Bedford, T. and Cooke, R. M. (2002). Vines: A new graphical model for dependent

random variables. Annals of Statistics, 30(4):1031–1068.

Brechmann, E. C., Czado, C., and Aas, K. (2012). Truncated regular vines in high
dimensions with application to ﬁnancial data. Canadian Journal of Statistics,
40(1):68–85.

Chen, X., Fan, Y., Pouzo, D., and Ying, Z. (2010). Estimation and model selection of
semiparametric multivariate survival functions under general censorship. Journal
of Econometrics, 157(1):129 – 142.

Czado, C. (2010). Pair-copula constructions of multivariate copulas. In Copula

Theory and its Applications, pages 93–109. Springer.

Dissmann, J., Brechmann, E. C., Czado, C., and Kurowicka, D. (2013). Selecting and
estimating regular vine copulae and application to ﬁnancial returns. Computational
Statistics & Data Analysis, 59:52–69.

Embrechts, P., Lindskog, F., and McNeil, A. (2003). Modelling dependence with cop-
ulas and applications to risk management. Handbook of Heavy Tailed Distributions
in Finance, 8(1):329–384.

Geerdens, C., Claeskens, G., and Janssen, P. (2015). Copula based ﬂexible modeling
of associations between clustered event times. Lifetime Data Analysis. doi:
10.1007/s10985-015-9336-x.

Hofert, M. (2008). Sampling archimedean copulas. Computational Statistics & Data

Analysis, 52(12):5163–5174.

Hougaard, P. (2000). Analysis of Multivariate Survival Data, volume 564. Springer

New York.

N. Barthel, C. Geerdens, M. Killiches, P. Janssen, C. Czado

24

Joe, H. and Hu, T. (1996). Multivariate distributions from mixtures of max-inﬁnitely

divisible distributions. Journal of Multivariate Analysis, 57(2):240–265.

Kurowicka, D. and Cooke, R. M. (2006). Uncertainty Analysis with High Dimensional

Dependence Modelling. John Wiley & Sons.

Kurowicka, D. and Joe, H. (2010). Dependence Modeling: Vine Copula Handbook.

World Scientiﬁc.

Laevens, H., Deluyker, H., Schukken, Y. H., De Meulemeester, L., Vandermeersch,
R., De Meulenaere, E., and De Kruif, A. (1997). Inﬂuence of parity and stage
of lactation on the somatic cell count in bacteriologically negative dairy cows.
Journal of Dairy Science, 80:3219–3226.

Mantel, N., Bohidar, N. R., and Ciminera, J. L. (1977). Mantel-Haenszel analyses of
litter-matched time-to-response data, with modiﬁcations for recovery of interlitter
information. Cancer Research, 37:3863–3868.

Massonnet, G., Janssen, P., and Duchateau, L. (2009). Modeling udder data using
copula models for quadruples. Journal of Statistical Planning and Inference,
139:3865–3877.

Nelsen, R. B. (2006). An Introduction to Copulas. Springer Series in Statistics.

Springer-Verlag New York Inc.

Schepsmeier, U., Stoeber, J., Brechmann, E., and Gr¨aler, B. (2015). VineCopula:

Statistical inference of vine copulas. R Package Version 1.7/r66.

Shih, J. H. and Louis, T. A. (1995). Inferences on the association parameter in

copula models for bivariate survival data. Biometrics, 51:1384–1399.

Sklar, A. (1959). Fonctions de r´epartition `a n dimensions et leurs marges. Publ.

Inst. Stat. Universit´e Paris 8.

Vine copula based inference of multivariate event time data

25

Appendix

Partial derivatives of a four-dimensional D-vine

Theorem 1. For the copula density (6) the following holds:

(cid:0)C1|23 (u1|v2, v3) , C4|23 (u4|v2, v3)(cid:1) dv3dv2

c23 (v2, v3) C14;23

(cid:0)C1|2 (u1|v2) , C3|2 (v3|v2)(cid:1)

c12 (u1, v2) c23 (v2, v3) c13;2

(cid:0)˜u1, C4|23 (u4|v2, v3)(cid:1)(cid:12)(cid:12)(cid:12)(cid:12)˜u1=C1|23(u1|v2,v3)

0

0

× ∂
∂ ˜u1

C14;23

dv3dv2

C (u1, u2, u3, u4)

(cid:90) u2

(cid:90) u3

0

0
∂C (u1, u2, u3, u4)

(cid:90) u2

(cid:90) u3

=

∂u1

=

∂C (u1, u2, u3, u4)

∂C (u1, u2, u3, u4)

(cid:90) u3

0

(cid:90) u2

0

∂u2

=

∂u3

=

c23 (u2, v3) C14;23

c23 (v2, u3) C14;23

1.

2.(a)

(b)

(c)

(d)

3.(a)

(b)

(c)

(cid:0)C1|23 (u1|u2, v3) , C4|23 (u4|u2, v3)(cid:1) dv3
(cid:0)C1|23 (u1|v2, u3) , C4|23 (u4|v2, u3)(cid:1) dv2
(cid:0)C2|3 (v2|v3) , C4|3 (u4|v3)(cid:1)
(cid:1)(cid:12)(cid:12)(cid:12)(cid:12)˜u4=C4|23(u4|v2,v3)
(cid:0)C1|2 (u1|u2) , C3|2 (v3|u2)(cid:1)

dv3dv2

∂C (u1, u2, u3, u4)

(cid:90) u2

(cid:90) u3

∂u4

=

∂2C (u1, u2, u3, u4)

(cid:90) u3

∂u1∂u2

c23 (v2, v3) c34 (v3, u4) c24;3

(cid:0)C1|23 (u1|v2, v3) , ˜u4

0

0

× ∂
∂ ˜u4

C14;23

=

c12 (u1, u2) c23 (u2, v3) c13;2

(cid:0)˜u1, C4|23 (u4|u2, v3)(cid:1)(cid:12)(cid:12)(cid:12)(cid:12)˜u1=C1|23(u1|u2,v3)

dv3

0

× ∂
∂ ˜u1

C14;23

∂2C (u1, u2, u3, u4)

(cid:90) u2

∂u1∂u3

=

c12 (u1, v2) c23 (v2, u3) c13;2

(cid:0)C1|2 (u1|v2) , C3|2 (u3|v2)(cid:1)

(cid:0)˜u1, C4|23 (u4|v2, u3)(cid:1)(cid:12)(cid:12)(cid:12)(cid:12)˜u1=C1|23(u1|v2,u3)

dv2

0

× ∂
∂ ˜u1

C14;23

∂2C (u1, u2, u3, u4)

(cid:90) u2

∂u1∂u4

=

(cid:90) u3
(cid:0)C1|2 (u1|v2) , C3|2 (v3|v2)(cid:1) c24;3
(cid:0)C1|23 (u1|v2, v3) , C4|23 (u4|v2, v3)(cid:1) dv3dv2

c12 (u1, v2) c23 (v2, v3) c34 (v3, u4)

0

(cid:0)C2|3 (v2|v3) , C4|3 (u4|v3)(cid:1)

0

× c13;2
× c14;23

N. Barthel, C. Geerdens, M. Killiches, P. Janssen, C. Czado

26

∂2C (u1, u2, u3, u4)

∂u2∂u3

= c23 (u2, u3) C14;23

(cid:0)C1|23 (u1|u2, u3) , C4|23 (u4|u2, u3)(cid:1)

∂2C (u1, u2, u3, u4)

(cid:90) u3

∂u2∂u4

=

c23 (u2, v3) c34 (v3, u4) c24;3

dv3

(cid:0)C1|23 (u1|u2, v3) , ˜u4

(cid:0)C2|3 (u2|v3) , C4|3 (u4|v3)(cid:1)
(cid:1)(cid:12)(cid:12)(cid:12)(cid:12)˜u4=C4|23(u4|u2,v3)
(cid:0)C2|3 (v2|u3) , C4|3 (u4|u3)(cid:1)
(cid:1)(cid:12)(cid:12)(cid:12)(cid:12)˜u4=C4|23(u4|v2,u3)
(cid:0)C1|23 (u1|v2, u3) , ˜u4
(cid:0)C1|2 (u1|u2) , C3|2 (u3|u2)(cid:1)
(cid:0)˜u1, C4|23 (u4|u2, u3)(cid:1)(cid:12)(cid:12)(cid:12)(cid:12)˜u1=C1|23(u1|u2,u3)

dv2

= c12 (u1, u2) c23 (u2, u3) c13;2

× ∂
∂ ˜u1

C14;23

0

× ∂
∂ ˜u4

C14;23

∂2C (u1, u2, u3, u4)

(cid:90) u2

∂u3∂u4

0

× ∂
∂ ˜u4

C14;23

4.(a)

∂3C (u1, u2, u3, u4)

∂u1∂u2∂u3

=

c23 (v2, u3) c34 (u3, u4) c24;3

(d)

(e)

(f )

(b)

(c)

(d)

∂3C (u1, u2, u3, u4)

∂u1∂u2∂u4

(cid:90) u3

0

× c13;2
× c14;23
∂3C (u1, u2, u3, u4)

∂u1∂u3∂u4

(cid:90) u2

=

=

0

× c13;2
× c14;23
∂3C (u1, u2, u3, u4)

∂u2∂u3∂u4

c12 (u1, u2) c23 (u2, v3) c34 (v3, u4)

(cid:0)C1|2 (u1|u2) , C3|2 (v3|u2)(cid:1) c24;3
(cid:0)C1|23 (u1|u2, v3) , C4|23 (u4|u2, v3)(cid:1) dv3

(cid:0)C2|3 (u2|v3) , C4|3 (u4|v3)(cid:1)

c12 (u1, v2) c23 (v2, u3) c34 (u3, u4)

(cid:0)C2|3 (v2|u3) , C4|3 (u4|u3)(cid:1)

(cid:0)C1|2 (u1|v2) , C3|2 (u3|v2)(cid:1) c24;3
(cid:0)C1|23 (u1|v2, u3) , C4|23 (u4|v2, u3)(cid:1) dv2
(cid:0)C2|3 (u2|u3) , C4|3 (u4|u3)(cid:1)
(cid:1)(cid:12)(cid:12)(cid:12)(cid:12)˜u4=C4|23(u4|u2,u3)
(cid:0)C1|2 (u1|u2) , C3|2 (u3|u2)(cid:1)
(cid:0)C1|23 (u1|u2, u3) , C4|23 (u4|u2, u3)(cid:1)

(cid:0)C2|3 (u2|u3) , C4|3 (u4|u3)(cid:1) c14;23

(cid:0)C1|23 (u1|u2, u3) , ˜u4

C14;23

= c12 (u1, u2) c23 (u2, u3) c34 (u3, u4) c13;2

× c24;3

= c23 (u2, u3) c34 (u3, u4) c24;3

× ∂
∂ ˜u4

5.

c (u1, u2, u3, u4)

Vine copula based inference of multivariate event time data

27

Corollary 1.
holds:

C (u1, u2, u3, u4)

(cid:90) u2

(cid:90) u3

In terms of h-functions, for the copula density (6) the following

(cid:0)h1|3;2

(cid:0)h1|2 (u1|v2)(cid:12)(cid:12)h3|2 (v3|v2)(cid:1)(cid:1) , h4|2;3

(cid:0)h4|3 (u4|v3)(cid:12)(cid:12)h2|3 (v2|v3)(cid:1)

C14;23

0

0

× c23 (v2, v3) dv3dv2

=

=

∂C (u1, u2, u3, u4)

(cid:90) u2

∂u1

(cid:90) u3
(cid:18)

0

0

× h4|1;23

∂C (u1, u2, u3, u4)

(cid:90) u3

∂u2

(cid:90) u2

∂u3

=

C14;23

0

× c23 (u2, v3) dv3

∂C (u1, u2, u3, u4)

=

C14;23

0

× c23 (v2, u3) dv2

∂C (u1, u2, u3, u4)

(cid:90) u2

∂u4

=

(cid:90) u3
(cid:18)

0

0

× h1|4;23

∂2C (u1, u2, u3, u4)

(cid:90) u3

∂u1∂u2

(cid:0)h1|2 (u1|v2) , h3|2 (v3|v2)(cid:1)

h4|2;3

c12 (u1, v2) c23 (v2, v3) c13;2

(cid:0)h4|3 (u4|v3)(cid:12)(cid:12)h2|3 (v2|v3)(cid:1)(cid:12)(cid:12)(cid:12)(cid:12)h1|3;2
(cid:0)h1|2 (u1|u2)(cid:12)(cid:12)h3|2 (v3|u2)(cid:1)(cid:1) , h4|2;3
(cid:0)h1|3;2

(cid:0)h1|2 (u1|v2)(cid:12)(cid:12)h3|2 (v3|v2)(cid:1)(cid:19)
(cid:0)h4|3 (u4|v3)(cid:12)(cid:12)h2|3 (u2|v3)(cid:1)

dv3dv2

(cid:0)h1|3;2

(cid:0)h1|2 (u1|v2)(cid:12)(cid:12)h3|2 (u3|v2)(cid:1)(cid:1) , h4|2;3

(cid:0)h4|3 (u4|u3)(cid:12)(cid:12)h2|3 (v2|u3)(cid:1)

(cid:0)h2|3 (v2|v3) , h4|3 (u4|v3)(cid:1)

c23 (v2, v3) c34 (v3, u4) c24;3

(cid:0)h1|2 (u1|v2)(cid:12)(cid:12)h3|2 (v3|v2)(cid:1)(cid:12)(cid:12)(cid:12)(cid:12)h4|2;3

h1|3;2

(cid:0)h4|3 (u4|v3)(cid:12)(cid:12)h2|3 (v2|v3)(cid:1)(cid:19)

dv3dv2

1.

2.(a)

(b)

(c)

(d)

3.(a)

(b)

(c)

=

c12 (u1, u2) c23 (u2, v3) c13;2

0

× h4|1;23

h4|2;3

(cid:0)h1|2 (u1|u2) , h3|2 (v3|u2)(cid:1)

(cid:0)h4|3 (u4|v3)(cid:12)(cid:12)h2|3 (u2|v3)(cid:1)(cid:12)(cid:12)(cid:12)(cid:12)h1|3;2

(cid:0)h1|2 (u1|u2)(cid:12)(cid:12)h3|2 (v3|u2)(cid:1)(cid:19)

∂2C (u1, u2, u3, u4)

(cid:90) u2

∂u1∂u3

=

c12 (u1, v2) c23 (v2, u3) c13;2

0

× h4|1;23

h4|2;3

(cid:0)h1|2 (u1|v2) , h3|2 (u3|v2)(cid:1)

(cid:0)h4|3 (u4|u3)(cid:12)(cid:12)h2|3 (v2|u3)(cid:1)(cid:12)(cid:12)(cid:12)(cid:12)h1|3;2

(cid:0)h1|2 (u1|v2)(cid:12)(cid:12)h3|2 (u3|v2)(cid:1)(cid:19)

(cid:18)

(cid:18)

dv3

dv2

∂2C (u1, u2, u3, u4)

(cid:90) u2

∂u1∂u4

=

0

× c13;2
× c14;23

(cid:90) u3
(cid:0)h1|2 (u1|v2) , h3|2 (v3|v2)(cid:1) c24;3
(cid:0)h1|3;2

(cid:0)h1|2 (u1|v2)(cid:12)(cid:12)h3|2 (v3|v2)(cid:1) , h4|2;3

c12 (u1, v2) c23 (v2, v3) c34 (v3, u4)

0

(cid:0)h2|3 (v2|v3) , h4|3 (u4|v3)(cid:1)

(cid:0)h4|3 (u4|v3)(cid:12)(cid:12)h2|3 (v2|v3)(cid:1)(cid:1) dv3dv2

N. Barthel, C. Geerdens, M. Killiches, P. Janssen, C. Czado

28

∂2C (u1, u2, u3, u4)

∂u2∂u3
= c23 (u2, u3) C14;23

(cid:0)h1|3;2

∂2C (u1, u2, u3, u4)

(cid:90) u3

∂u2∂u4

(cid:0)h1|2 (u1|u2)(cid:12)(cid:12)h3|2 (u3|u2)(cid:1)(cid:1) , h4|2;3
(cid:0)h2|3 (u2|v3) , h4|3 (u4|v3)(cid:1)

=

c23 (u2, v3) c34 (v3, u4) c24;3

(cid:18)

0

× h1|4;23

h1|3;2

(cid:0)h1|2 (u1|u2)(cid:12)(cid:12)h3|2 (v3|u2)(cid:1)(cid:12)(cid:12)(cid:12)(cid:12)h4|2;3

(cid:0)h4|3 (u4|v3)(cid:12)(cid:12)h2|3 (u2|v3)(cid:1)(cid:19)

(cid:0)h4|3 (u4|u3)(cid:12)(cid:12)h2|3 (u2|u3)(cid:1)

(d)

(e)

(f )

4.(a)

(b)

(c)

(d)

5.

(cid:0)h2|3 (v2|u3) , h4|3 (u4|u3)(cid:1)

(cid:0)h4|3 (u4|u3)(cid:12)(cid:12)h2|3 (v2|u3)(cid:1)(cid:19)

dv3

dv2

(cid:0)h1|2 (u1|u2)(cid:12)(cid:12)h3|2 (u3|u2)(cid:1)(cid:19)
(cid:0)h4|3 (u4|v3)(cid:12)(cid:12)h2|3 (u2|v3)(cid:1)(cid:1)

(cid:0)h1|2 (u1|u2) , h3|2 (v3|u2)(cid:1)

=

c23 (v2, u3) c34 (u3, u4) c24;3

∂3C (u1, u2, u3, u4)

∂u1∂u2∂u3
= c12 (u1, u2) c23 (u2, u3) c13;2

∂2C (u1, u2, u3, u4)

(cid:90) u2

∂u3∂u4

0

× h1|4;23

× h4|1;23

∂3C (u1, u2, u3, u4)

∂u1∂u2∂u4

=

c14;23

∂3C (u1, u2, u3, u4)

∂u1∂u3∂u4

=

c14;23

(cid:90) u3

0

(cid:90) u2

0

× c12 (u1, u2) c23 (u2, v3) c34 (v3, u4) c13;2
× c24;3

h1|3;2

h4|2;3

(cid:18)

(cid:18)

(cid:0)h1|2 (u1|v2)(cid:12)(cid:12)h3|2 (u3|v2)(cid:1)(cid:12)(cid:12)(cid:12)(cid:12)h4|2;3
(cid:0)h1|2 (u1|u2) , h3|2 (u3|u2)(cid:1)
(cid:0)h4|3 (u4|u3)(cid:12)(cid:12)h2|3 (u2|u3)(cid:1)(cid:12)(cid:12)(cid:12)(cid:12)h1|3;2
(cid:0)h1|2 (u1|u2)(cid:12)(cid:12)h3|2 (v3|u2)(cid:1) , h4|2;3
(cid:0)h1|3;2
(cid:0)h2|3 (u2|v3) , h4|3 (u4|v3)(cid:1) dv3
(cid:0)h1|3;2
(cid:0)h2|3 (v2|u3) , h4|3 (u4|u3)(cid:1) dv2
(cid:18)

(cid:0)h2|3 (u2|u3) , h4|3 (u4|u3)(cid:1)
(cid:0)h1|2 (u1|u2)(cid:12)(cid:12)h3|2 (u3|u2)(cid:1)(cid:12)(cid:12)(cid:12)(cid:12)h4|2;3
(cid:0)h1|2 (u1|u2)(cid:12)(cid:12)h3|2 (u3|u2)(cid:1) , h4|2;3

(cid:0)h1|2 (u1|u2) , h3|2 (u3|u2)(cid:1) c24;3
(cid:0)h1|3;2

h1|3;2

(cid:0)h1|2 (u1|v2)(cid:12)(cid:12)h3|2 (u3|v2)(cid:1) , h4|2;3

(cid:0)h4|3 (u4|u3)(cid:12)(cid:12)h2|3 (v2|u3)(cid:1)(cid:1)

(cid:0)h1|2 (u1|v2) , h3|2 (u3|v2)(cid:1)

× c12 (u1, v2) c23 (v2, u3) c34 (u3, u4) c13;2
× c24;3

∂3C (u1, u2, u3, u4)

∂u2∂u3∂u4
= c23 (u2, u3) c34 (u3, u4) c24;3

× h1|4;23

c (u1, u2, u3, u4)

× c13;2
× c14;23

= c12 (u1, u2) c23 (u2, u3) c34 (u3, u4)

(cid:0)h4|3 (u4|u3)(cid:12)(cid:12)h2|3 (u2|u3)(cid:1)(cid:19)

(cid:0)h2|3 (u2|u3) , h4|3 (u4|u3)(cid:1)

(cid:0)h4|3 (u4|u3)(cid:12)(cid:12)h2|3 (u2|u3)(cid:1)(cid:1)

