6
1
0
2

 
r
a

 

M
5
1
 
 
]

.

R
G
h
t
a
m

[
 
 

2
v
9
5
0
4
0

.

3
0
6
1
:
v
i
X
r
a

ALGORITHMIC ASPECTS OF BRANCHED COVERINGS II.

SPHERE BISETS AND THEIR DECOMPOSITIONS

LAURENT BARTHOLDI AND DZMITRY DUDKO

Abstract. We consider the action of mapping class groups, by pre- and post-
composition, on branched coverings, and encode them algebraically as mapping
class bisets. We show how the mapping class biset of maps preserving a multi-
curve decomposes into mapping class bisets of smaller complexity, called small
mapping class bisets.

We phrase the decision problem of Thurston equivalence between branched
self-coverings of the sphere in terms of the conjugacy and centralizer problems
in a mapping class biset, and use our decomposition results on mapping class
bisets to reduce these decision problems to small mapping class bisets.

This is the main step in our proof of decidability of Thurston equivalence,
as outlined in the ﬁrst article of the series, since decidability of conjugacy and
centralizer problems in the small mapping class bisets are well understood in
terms of linear algebra, group theory and complex analysis.

Branched coverings themselves are also encoded into bisets, with actions of
the fundamental groups. We characterize those bisets that arise from branched
coverings between topological spheres, and extend this correspondence to maps
between spheres with multicurves, whose algebraic counterparts are sphere
trees of bisets.

1. Introduction

This is the second of a series of ﬁve articles, and specializes the ﬁrst article [3]
to 2-dimensional spheres. For an overview of the series, see [2]. The main focus
is computability of the bisets associated with sphere maps f : pS2, Aq ý and their
deformations.
More precisely, we consider a topological sphere S2 and a ﬁnite subset A Ă
S2. A Thurston map is a branched covering f : pS2, Aq ý such that A contains
the critical values of f .
It is natural to consider Thurston maps up to isotopy:
f0, f1 : pS2, Aq ý are isotopic, written f0 « f1, if there is a path of Thurston maps
pft : pS2, Aq ýqtPr0,1s connecting them. We denote by KpS2, Aq the set of isotopy
classes of Thurston maps pS2, Aq ý.
In particular, those isotopy classes of Thurston maps that ﬁx A and are homeo-
morphisms form a group ModpS2, Aq, the pure mapping class group. Two Thurston
maps f : pS2, Aq ý and g : pS2, Cq ý are combinatorially equivalent, written f „ g,
if there exists a homeomorphism φ : pS2, Aq Ñ pS2, Cq with φ ˝ f « g ˝ φ. Equiv-
alently, f0 „ f1 if there exists a path of Thurston maps pft : pS2, Atq ýqtPr0,1s
connecting them, see Deﬁnition 2.10 and Lemma 2.11.
The fundamental decision problems that we consider are:

Date: March 10, 2016.
Partially supported by ANR grant ANR-14-ACHN-0018-01 and DFG grant BA4197/6-1.

1

2

LAURENT BARTHOLDI AND DZMITRY DUDKO

give a witness m P ModpS2, Aq to mg “ f m.
Zpfq :“ tm P ModpS2, Aq | mf “ f mu.

The conjugacy problem: Given f, g P KpS2, Aq, are they conjugate? If so,
The centralizer problem: Given f P KpS2, Aq, compute its centralizer
To determine whether two Thurston maps f : pS2, Aq ý and g : pS2, Cq ý are
combinatorially equivalent, enumerate all bijections φ : A Ñ C, and extend each φ

arbitrarily to a homeomorphism pφ : pS2, Aq Ñ pS2, Cq. Then f „ g if and only it f
and pφ´1 ˝ g ˝pφ are conjugate in KpS2, Aq for some φ : A Ñ C.

A multicurve on pS2, Aq is a collection C of disjoint pairwise non-homotopic
closed curves on S2zA, none of which can be homotoped rel A to a point, and viewed
up to isotopy. We let KpS2, A, Cq denote those Thurston maps f P KpS2, Aq that
preserve C in the sense that f ´1pCq Ě C , and we denote by ModpS2, A, C q the
subgroup of ModpS2, Aq consisting of mapping classes that preserve C curvewise.
Consider pS2, Aq and a multicurve C . The connected components of S2zC
are called small spheres, and are themselves homeomorphic to punctured spheres.
Given f P KpS2, A, Cq and a periodic small sphere S Ă S2zC , the ﬁrst return map
f e : pS, A X Sq ý is called a small Thurston map. We denote by Rpf, A, Cq the set
of small Thurston maps of f .
The main outcome of this article is the following theorem; brieﬂy said, it reduces

the decision problems for a Thurston map to that of its small Thurston maps:
Theorem A (See Theorem 6.21). Let pS2, Aq be a punctured sphere, and let C be
a multicurve on pS2, Aq. There is then an algorithm with oracle that,

computable (e.g. as ﬁnite-index subgroups of products of mapping class groups),

— given two Thurston maps f, g P KpS2, A, C q,
— assuming that the centralizers of all small Thurston maps in Rpf, A, Cq are
— assuming that the conjugacy problems between maps in Rpf, A, Cq and the
corresponding maps in Rpg, A, Cq are solvable, and that witnesses can be produced
in case maps are conjugate,
answers whether f, g are conjugate under ModpS2, A, C q, if so produces a witness,
and computes the centralizer of f as the kernel of a homomorphism from a ﬁnite-
index subgroup of a product of mapping class groups towards a ﬁnitely generated
abelian group.

We show by an example (see §8.3) that this description of centralizers of Thurston
maps is in a sense the best that can be achieved; this makes centralizers of Thurston
maps signiﬁcantly more complicated than centralizers of mapping classes, which are
always ﬁnite-index subgroups of products of mapping class groups.

1.1. Algebraic structure of branched coverings. It is in fact worthwhile to
consider a slightly more general situation: ﬁx a branched covering f : pS2, Cq Ñ
pS2, Aq such that A contains fpCq and the critical values of f ; we call f a sphere
map. Set
(1) Mpf, C, Aq “ tm1f m2 | m1 P ModpS2, Cq, m2 P ModpS2, Aqu{ isotopy,
the composition being written in algebraic (left-to-right) order. Then Mpf, C, Aq is
a biset : a set endowed with commuting left and right actions by ModpS2, Cq and
ModpS2, Aq respectively. We call it the mapping class biset of f .
We give an algorithm (Algorithm 6.11) that computes the structure of Mpf, C, Aq
It uses in a fundamental manner the facts that G :“ π1pS2zAq is a
as a biset.

SPHERE BISETS AND THEIR DECOMPOSITIONS

3

free group, and that ModpS2, Aq acts faithfully on G by outer automorphisms.
Decompositions of (certain variants of) mapping class bisets are important steps in
proving Theorem A; see for example §6.4 and §6.5.

Sphere maps f : pS2, Cq Ñ pS2, Aq themselves are represented as π1pS2zCq-G-
bisets Bpfq, see [3, §5]. It was shown by Kameyama [20] that Bpfq is a complete
invariant of isotopy, namely Bpfq – Bpgq if and only if f, g are isotopic. We give a
converse to this result in Theorem 2.7 by showing that to every sphere biset there
is an associated sphere map, unique up to isotopy. This allows us to switch freely
between geometric and algebraic settings of sphere maps and bisets.

In fact, [3] associates bisets with topological correspondences, namely pairs of
maps Y Ð Z Ñ X such that Z Ñ X is a covering; and the mapping class biset
Mpf, C, Aq is also the biset of a correspondence, between the moduli spaces MC
and MA; see Proposition 8.1 in §8.
Multicurves C on pS2, Aq are represented as a collection of conjugacy classes
in G. The main result from [3] was that, given a 1-dimensional cover of a space
such as that aﬀorded by the small spheres of pS2, Aq, and a map compatible with
this cover such as a Thurston map f preserving C , there exists a tree of bisets
decomposition of f whose “fundamental biset” is isomorphic to Bpfq. We show
that this decomposition is computable:

Theorem B (See Theorem 3.9). There is an algorithm that, given a Thurston map
f : pS2, Aq ý by its biset Bpfq and given an f -invariant multicurve C on pS2, Aq,
computes the tree of bisets decomposition of Bpfq along C .

We extend Kameyama’s result to maps with multicurves: we deﬁne sphere trees
of bisets in Deﬁnition 4.12, and prove that the decomposition of a sphere map is
a sphere tree of bisets and conversely, giving a complete invariant up to isotopy or
combinatorial equivalence:
Theorem C (See Theorem 3.10, Corollary 3.11 and Corollary 4.15). Let f, f 1 : pS2, A, C q ý
be Thurston maps with a (possibly empty) invariant multicurve C . Then f, f 1 are
isotopic rel A Y C if and only if the sphere trees of bisets of f, f 1 are isomorphic.
Consequently, if g : pS2, C, Dq ý be a Thurston map with invariant multicurve
D, then f, g are combinatorially equivalent by a mapping class sending C to D if
and only if the sphere trees of bisets of f, g are conjugate.

Finally, for every sphere tree of bisets YBX with spheres pS2, C, Dq and pS2, A, Cq
associated respectively with the trees of groups Y and X there exists a sphere map
f : pS2, C, Dq Ñ pS2, A, C q, unique up to isotopy rel C Y D, whose graph of bisets
is isomorphic to B.

Theorem C expresses, in the algebraic language of bisets, the decomposition and
combination theorems of Kevin Pilgrim (see e.g. [29, Theorem 5.1]). Numerous
examples of sphere tree of bisets decompositions appeared in [2, §7]. Here two
graphs of bisets XBX and YCY are called conjugate if there exists a biprincipal
(see [3, §3.8]) tree of bisets XIY such that B bX I and I bY C are isomorphic,
namely have same underlying graphs and isomorphic vertex and edge bisets.
We extend in §7 the equivalence between sphere maps and bisets to the setting
of orbispheres (spheres with singularities of cone type 2π{n): given an orbisphere
map f , its biset Bpfq is a complete invariant of isotopy; and conversely given an
orbisphere biset B there is an orbisphere map f , unique up to isotopy, realizing B,
see Theorem 7.9.

4

LAURENT BARTHOLDI AND DZMITRY DUDKO

We end this article, in §8, with a description of Mpf, A, Aq for some Thurston
maps f : pS2, Aq ý, recasting the calculations of [1] and its interpretation via Te-
ichm¨uller theory in the language of mapping class bisets.
The language of trees of groups and trees of bisets is particularly well suited to
describe the dynamical operations of tuning and renormalizing. Consider a map
f : pS2, Aq ý. Tuning refers to removing a periodic component (disk, say) from
S2 and attaching a cycle of (presumably more complicated) spaces with their own
dynamics. Cutting S2 along the boundaries of the disks yields a tree of groups
decomposition of the fundamental group, and a tree of bisets decomposition of f ,
and tuning amounts to replacing a small biset by a more complicated one in the
tree of bisets.

Renormalizing refers to considering a periodic component of a decomposition of
S2 and taking its ﬁrst return map. In terms of graphs of groups, this amounts to
taking an invariant subtree of a tensor power of the biset.

Branched coverings f : pS2, Cq Ñ pS2, Aq, and the biset (1) may be considered for
C “ H, and correspond to well-studied objects. When C “ H, the biset Bpfq is just
a right π1pS2zA,˚q-set of cardinality degpfq, namely an #A-tuple of permutations
in degpfqÓ. satisfying some conditions and considered up to conjugation (see §2.1).
Two branched coverings f, f 1 : S2 Ñ pS2, Aq are isomorphic as coverings (they are
also called “Hurwitz equivalent”) if and only if f « m ˝ f 1 for a mapping class
m P ModpS2, Aq, if and only if f 1 P Mpf,H, Aq. Thus Hurwitz equivalence classes
of branched coverings coincide with conjugacy classes of mapping class bisets in
the case C “ H. The problem of classifying Hurwitz equivalence classes for which
the tuple of permutations has given cycle structure (its “Hurwitz passport”) has
been extensively investigated, even when #A “ 3, see e.g. [23, Chapter 5]. From
our perspective, this problem can be interpreted as a classiﬁcation of mapping class
bisets with given portrait, as subbisets of KpS2, Aq.

1.2. Notation. We continue with the notation of the previous articles in the series.
In particular, we write í for group actions, and SÓ. for the symmetric group on S.
Concatenation of paths is written γ#δ for “ﬁrst γ, then δ”; inverses of paths are

written γ´1.

f

If β : r0, 1s Ñ X is a path and f : Y Ñ X is a covering map, we denote by βÒy
the f -lift of the path β starting at y P f ´1pβp0qq.
We write « for isotopy or homotopy of paths, maps etc, „ for conjugacy or
combinatorial equivalence, and – for isomorphism of algebraic objects.
The main objects of study are marked, or punctured spheres. There is no funda-
mental diﬀerence between S2zA and a pair pS2, Aq with A Ă S2; it is usually more
convenient to keep the points in A while remembering that they have a special sta-
tus (for example, they are frozen by homotopies), but when marked spheres are cut
along multicurves the boundary components appear topologically as punctures, not
marked points. We therefore sometimes have to switch between these notations.
We allow A “ H, but forbid #A “ 1.
In all sections except §7, by f : pS2, Cq Ñ pS2, Aq we denote an orientation
preserving map between marked spheres, called a sphere map; see §2.1 for the
precise deﬁnition. In §7 the map f : pS2, Cq Ñ pS2, Aq will be allowed to reverse
orientation.

SPHERE BISETS AND THEIR DECOMPOSITIONS

5

For a small sphere S Ă pS2, Aq, cut by curves C1, . . . , Cm Ă S2zA, we denote by

topological sphere marked by the image of A and the boundary curves.

S its topological closure, namely S Y C1 Y ¨¨¨ Y Cm, and by pS the corresponding

Given a map f : pS2, C, Dq Ñ pS2, A, Cq with marked curves, a small sphere map
of f is the restriction of f to a small sphere of pS2, C, Dq. If f : pS2, A, C q ý is a
Thurston map, a small Thurston map of f is the ﬁrst return map f e on a periodic
small sphere of pS2, A, Cq.
We denote by 1 the identity map. By a slight abuse of notation, if A Ă C then
we denote by 1 : pS2, Cq Ñ pS2, Aq the identity map on S2 which erases the marked
points in CzA.
1.3. Acknowledgments. We are grateful to Jean-Pierre Spaenlehauer for having
helped in computing the algebraic correspondence in §8.2.2.

2. Spheres

The previous article [3] in the series set up the general theory of bisets associated
with maps between topological spaces. Much sharper results may be obtained in a
more speciﬁc context, that of maps between punctured spheres.

Let us consider a topological sphere S2 with a ﬁnite, ordered collection of marked
points A “ ta1, . . . , anu Ă S2. We allow n “ 0, but expressly forbid n “ 1. Choose
a basepoint ˚ P S2zA. The fundamental group π1pS2zA,˚q may then be presented
in the following, explicit manner: choose for each i P t1, . . . , nu a loop γi in S2zA
that starts at ˚, goes towards ai, encircles it counterclockwise in a very small loop,
and returns to ˚ along the same path. Make sure that all paths γi are disjoint
except at their endpoints, and that they are arranged counterclockwise around ˚.
We call the γi Hurwitz generators, or colloquially lollipops. We then have

G “ π1pS2, A,˚q :“ π1pS2zA,˚q “ xγ1, . . . , γn | γ1 ¨¨¨ γny.

(2)
Indeed, if one cuts S2 open along paths from the basepoint ˚ to the marked points
ai along the beginnings of the γi, one is left with a disk, whose perimeter gives the
unique relation of G.

1 , . . . , γG

A cycle (loop without basepoint) in S2zA is represented by a conjugacy class in
π1pS2zA,˚q. The group G comes with extra data: the collection tγG
n u of
conjugacy classes, called peripheral conjugacy classes, deﬁned by the property that
γG
i represents can be homotoped to a loop circling ai once counterclockwise.
We use the notation β «A γ to mean that curves β, γ are isotopic relative to
their endpoints and to A; in other words, that β#γ´1 is trivial in the fundamental
group π1pS2, A, βp0qq.
Deﬁnition 2.1 (Sphere groups). A sphere group is a tuple pG, Γ1, . . . , Γnq con-
sisting of a group and n ­“ 1 conjugacy classes Γi in G, such that G admits a
presentation as in (2) for some choice of γi P Γi. The classes Γ1, . . . , Γn are called
the peripheral conjugacy classes of G.
△
In other words, G is a free group of rank n ´ 1, with n distinguished conjugacy
classes Γi satisfying a certain relation. If n “ 0, then G is a trivial group. For every
d P N we denote by Γd
i . By the
remarks above,
Lemma 2.2. Let pS2, Aq be a marked sphere, and choose ˚ P S2zA. Then π1pS2zA,˚q
is a sphere group. Conversely, given a sphere group pG, Γiq there exists a sphere,

i the subset tgd | g P Γiu. We also set Γ`

i “Ťdě1 Γd

6

LAURENT BARTHOLDI AND DZMITRY DUDKO

unique up to homeomorphism, whose fundamental group is isomorphic to G and
whose peripheral conjugacy classes are tΓiu.
(cid:3)

From the perspective of a computer, a sphere group can be represented in two
diﬀerent manners. It may be considered as just a number ‘n’, and its elements are
words in the symbols ˘1, . . . ,˘n, subject to appropriate reduction rules. It may
also be considered as a collection of n reduced words γ1, . . . , γn in the standard
free group Fn´1 on n´ 1 generators, and its elements are in bijection with reduced
words in Fn´1’s generators. These two forms are obviously equivalent, and both
have their advantages in terms of implementation.
2.1. Maps between spheres. Let ModpS2, Aq denote the pure mapping class
group of pS2, Aq, namely the set of isotopy classes of homeomorphisms S2 ý ﬁxing
A pointwise. Given a choice of basepoint ˚ P S2zA, consider the fundamental
group G “ π1pS2zA,˚q. Then every homeomorphism φ : pS2, Aq ý induces an
isomorphism G Ñ π1pS2zA, φp˚qq; choosing a path ℓ from ˚ to φp˚q in S2zA leads
to an automorphism of G deﬁned by rγs ÞÑ rℓ#pφ ˝ γq#ℓ´1s, which is well-deﬁned
up to inner automorphisms, and yields a homomorphism ModpS2, Aq Ñ OutpGq.
The classical Dehn-Nielsen-Baer Theorem asserts that this map is injective, and
describes its image:
Theorem 2.3 (Dehn-Nielsen-Baer, see [15, Theorem 8.8]). Let pG, Γ1, . . . , Γnq be
a sphere group. Then the natural map ModpS2, Aq Ñ OutpGq is injective, and
its image in OutpGq consists of those automorphisms of G that map each Γi to
itself.
Deﬁnition 2.4. The mapping class group ModpGq of a sphere group G as in
Deﬁnition 2.1 is the group of outer automorphisms of G that preserve all peripheral
conjugacy classes of G.
△

(cid:3)

For calculations, it is useful to know that ModpGq is generated by Dehn twists:
for example, the automorphisms τi,j , for 1 ď i ă j ă n, that map γk to γ
for k P ti, . . . , ju while ﬁxing the other generators, see [25]. Geometrically, τi,j is
a homeomorphism that acts as a “Chinese burn” on an annulus surrounding the
points ai, . . . , aj and acts trivially elsewhere.

γiγi`1¨¨¨γj
k

A sphere map f : pS2, Cq Ñ pS2, Aq between marked spheres is a branched cover-
ing between the underlying spheres, locally modelled at c P S2 in oriented complex
charts by z ÞÑ zdegcpf q for some integer degcpfq ě 1, and such that A contains fpCq
and all fpcq for which degcpfq ą 1. Those c P S2 with degcpfq ą 1 are called critical
points, and their images fpcq are called critical values. The map f is a covering if
C “ f ´1pAq. The restriction f : C Ñ A is called a portrait of f : pS2, Cq Ñ pS2, Aq.
Two sphere maps f0, f1 : pS2, Cq Ñ pS2, Aq are isotopic if there is a continuous path
ft : pS2, Cq Ñ pS2, Aq of sphere maps with t P r0, 1s.
2.1.1. Sphere bisets. This notion of maps admits a precise algebraic translation, to
which we turn now. Consider a sphere map f : pS2, Cq Ñ pS2, Aq; we may interpret
it as a correspondence

1

pS2, Cq

f

(3)
Ð pS2, f ´1pAqq forgets points in f ´1pAqzC. Note that pS2, Cq
such that pS2, Cq
pS2, f ´1pAqq is not a sphere map (unless C “ f ´1pAq), however its inverse pS2, Cq

Ð pS2, f ´1pAqq

Ñ pS2, Aq

1

1

1

Ð
Ñ

SPHERE BISETS AND THEIR DECOMPOSITIONS

7

pS2, f ´1pAqq is a sphere map. In [3, §4.1] we gave a general deﬁnition for the biset
of a correspondence; applied to (3) this deﬁnition takes the following form (see
[3, Equation (15)])

Bpf,:,˚q “ tδ : r0, 1s Ñ S2zC | δp0q “ :, fpδp1qq “ ˚u{ «C,

(4)
and with left and right actions of π1pS2, C,:q and π1pS2, A,˚q given by preconcate-
nation, respectively postconcatenation through lifting by f . If pS2, Cq “ pS2, Aq,
then it will be usually assumed that : “ ˚; thus (4) is a π1pS2, A,˚q-biset. The
biset (4) possesses extra properties coming from the peripheral conjugacy classes
of the sphere groups π1pS2, C,:q and π1pS2, A,˚q; they will be described in Deﬁni-
tion 2.5 and Lemma 2.6.
Hurwitz describes in [19] an elegant classiﬁcation of branched self-coverings S2 ý
in terms of admissible n-tuples of permutations pσ1, . . . , σnq in dÓ.. Such an n-tuple
is admissible if σ1 ¨¨¨ σn “ 1, the group xσ1, . . . , σny acts transitively on t1, . . . , du,
and the cycle lengths of the permutations γ1, . . . , γn satisfy

(5)

nÿi“1 ÿc cycle
of σi `lengthpcq ´ 1˘ “ 2d ´ 2.

Hurwitz gives a bijection between degree-d branched self-coverings S2 ý with crit-
ical values contained in ta1, . . . , anu, viewed up to isomorphism of coverings, and
admissible n-tuples in dÓ., viewed up to global conjugacy by dÓ. and the “mapping
class group action”. For the latter, set G “ π1pS2zA,˚q and identify pσ1, . . . , σnq
with the homomorphism π : G Ñ dÓ. given by γi ÞÑ σi, and let the mapping class
group ModpGq act on π by precomposition. Condition (5) amounts to the state-
ment that the Euler characteristic of the cover is 2 “ χpS2q.
Let H BG be a left-free biset, and contract every left orbit of B to a point by
considering t¨u bH B. Consider g P G. Then t¨u bH B decomposes into orbits
S1 \ ¨¨¨ \ Sℓ under the action of g, of respective cardinalities d1, . . . , dℓ; and for
all i “ 1, . . . , ℓ, choosing si P B with t¨u bH si P Si there are elements hi P H
with hisi “ sigdi. The multiset tpdi, hH
i q | i “ 1, . . . , ℓu consisting of degrees and
conjugacy classes in H is independent of the choice of the si, and depends only on
the conjugacy class of g; it is called the lift of gG. If B be the biset of a sphere map
f : pS2, Cq Ñ pS2, Aq, then the multiset tphH
i q | i “ 1, . . . , ℓu is, up to homotopy,
the set f ´1pgGq, and the di are the degrees with which f maps the corresponding
closed curve onto gG.

Deﬁnition 2.5 (Sphere bisets). Consider pH, ∆jq and pG, Γiq two sphere groups.
A sphere biset is an H-G-biset B such that the following hold:

(SB1) B is left-free and right-transitive;
(SB2) choose representatives γ1 P Γ, . . . , γn P Γn; then the permutations of t¨ubH
(SB3) the multiset of all lifts of Γ1, . . . , Γn contains exactly once every ∆j, all the

B induced by the right action of γ1, . . . , γn satisfy (5);

other conjugacy classes being trivial.

By the last condition, to every peripheral conjugacy class ∆j in H is associated
a well-deﬁned degree deg∆jpBq P N and conjugacy class Γi “: B˚p∆jq, such that
pdeg∆jpBq, ∆jq belongs to the lift of Γi. We deﬁne in this manner a map B˚ from
the peripheral conjugacy classes in H to those of G, called the portrait of B. △

8

LAURENT BARTHOLDI AND DZMITRY DUDKO

In case the peripheral conjugacy classes of G, H are indexed as pΓaqaPA and
p∆cqcPC respectively, we write B˚pcq “ a rather than B˚p∆cq “ Γa, deﬁning in this
manner a map B˚ : C Ñ A. It is easy to see that if B be the biset of f : pS2, Cq Ñ
pS2, Aq and Γa and ∆c denote the peripheral conjugacy classes around a P A and
c P C respectively, then deg∆cpBq “ degcpfq, and fpcq “ a if and only if B˚pcq “ a.
Lemma 2.6. The biset deﬁned in (4) of a sphere map f : pS2, Cq Ñ pS2, Aq is a
sphere π1pS2, C,:q-π1pS2, A,˚q-biset.
Proof. The biset Bpfq is clearly left-free. Consider b1, b2 P Bpfq. Up to homotopy
we may assume that b1, b2, and : are away from f ´1pAq. Set g :“ fpb´1
1 q#fpb2q P
π1pS2, A,˚q. Then b1g “ b2; this veriﬁes Condition (SB1) of Deﬁnition 2.5.
Consider a peripheral conjugacy class Γ, say around a puncture a P A. Let
i q | i “ 1, . . . , ℓu be the multiset of lifts of Γ. We may enumerate f ´1paq
tpdi, hH
as tc1, c2, . . . , cℓu such that f maps ci to a with degree di and such that hH
is
the peripheral conjugacy class around ci, respectively the trivial class, if ci P C,
respectively ci R C. This veriﬁes Condition (SB3) of Deﬁnition 2.5. Since f ´1pAq
contains 2d ´ 2 critical points counting with multiplicities, we have (5); this is
Condition (SB2).

(cid:3)

i

2.1.2. Equivalence between sphere maps and bisets. Kameyama essentially proves
in [20, Theorem 3.6] that to an isomorphism class of sphere bisets corresponds a
unique isotopy class of sphere maps. In fact, we give a bijection between isotopy
classes of maps and isomorphism classes bisets, extending at the same time the
Dehn-Nielsen-Baer Theorem 2.3 to non-invertible maps:
Theorem 2.7. Let f0, f1 : pS2, Cq Ñ pS2, Aq be sphere maps, and consider H :“
π1pS2zC,:q and G :“ π1pS2zA,˚q for choices of : P S2zC and ˚ P S2zA. Then
Bpf0q is a sphere H-G-biset, and Bpf0q – Bpf1q if and only if f0 « f1.
Conversely, for every sphere H-G-biset B there exists a sphere map f : pS2, Cq Ñ
pS2, Aq, unique up to isotopy, such that B – Bpfq.

The proof of Theorem 2.7 appears below, after some preparation. Consider a
sphere H-G-biset B. Choose b P B, and let Gb be the stabilizer of t¨u b b in the
G-set t¨u bH B. It is a subgroup of G of index equal to the degree of B. Then B
naturally splits as

(6)

H BG – HbGb b GbGG.

This splitting is the algebraic counterpart of (3), and we use it to give, along the

way, the structure of a sphere group to Gb:
Lemma 2.8. Suppose that H BG is the biset of a sphere map f : pS2, Cq Ñ pS2, Aq
as in (4) and with G “ π1pS2zA,˚q and H “ π1pS2zC,:q. Consider b P B and let
˚1 be the endpoint of b.
Then π1pS2, f ´1pAq,˚1q is identiﬁed via f˚ : π1pS2, f ´1pAq,˚1q Ñ π1pS2, A,˚q
with Gb, and via this identiﬁcation the π1pS2, f ´1pAq,˚1q-G-biset of f : pS2, f ´1pAqq Ñ
pS2, Aq is isomorphic to Gb GG while the H-π1pS2, f ´1pAq,˚1q-biset of pS2, Cq
Ñ
pS2, f ´1pAqq is isomorphic to HbGb.
Moreover, via the identiﬁcation of Gb with π1pS2, f ´1pAq,˚1q the peripheral con-
jugacy classes of Gb are pΞi,jqi,j constructed as follows. Let Γ1, . . . , Γn be the pe-
ripheral conjugacy classes of G. Then for each Γi there is a unique decomposition

1

(7)

Γ`
i X Gb “ Ξ`

i,1 \ Ξ`

i,2 \ ¨¨¨ \ Ξ`

i,s

SPHERE BISETS AND THEIR DECOMPOSITIONS

9

i,j

such that every Ξi,j is a conjugacy class of Gb. Assuming Ξi,j is generated by γdpi,jq
with γi,j P Γi, we let tpdpi, jq, Ξi,jqu be the multiset of lifts of Γi via GbGG.
Proof. Since f : S2zf ´1pAq Ñ S2zA is a covering map, π1pS2, f ´1pAq,˚1q is identi-
ﬁed with Gb via f˚ and the biset of f : pS2, f ´1pAqq Ñ pS2, Aq is GbGG. It follows
Ñ pS2, f ´1pAqq
immediately from (4) that the H-π1pS2, f ´1pAq,˚1q-biset of pS2, Cq
is HbGb.
Let us prove the claims concerning pΞi,jqi,j. Suppose that Γi is a peripheral
conjugacy class around ai P A, suppose that f ´1paiq “ tci,1, ci,2, . . . , ci,su and that
f has degree dpi, jq at ci,j, and suppose that Ξi,j is the peripheral conjugacy class of
π1pS2, f ´1pAq,˚1q around ci,j. Observe that Ξi,j are pairwise disjoint as peripheral
conjugacy classes around diﬀerent points in f ´1pAq. Therefore, Ξ`
i,j are pairwise
disjoint. Then f˚ identiﬁes Ξ`
i X Gb and we get (7). If
dpi, jq be the local degree of f at ci,j, then f˚pΞi,jq is generated by γdpi,jq
with
γi,j P Γi.
(cid:3)
Lemma 2.9. Consider a sphere H-G-biset B and choose b P B. Endow Gb with
the sphere structure given in Lemma 2.8: assuming that Γ1, . . . , Γn are peripheral
conjugacy classes of G, the peripheral conjugacy classes of Gb are pΞi,jqi,j speciﬁed
by (7). Then in the decomposition (6) the bisets HbGb and GbGG are sphere bisets.

i,2 \ . . . Ξ`

i,1 \ Ξ`

1

i,s with Γ`

i,j

group; then by Hurwitz’s theorem [19], the cover pĆS2zAq{Gb of S2zA associated

Proof. Observe that t¨u bH B – t¨u bGb G as right G-sets; thus the action of G on
t¨u bGb G satisﬁes the Hurwitz condition (5). Write G “ π1pS2zA,˚q as a sphere
with Gb ď G is a ﬁnitely-punctured sphere. By Lemmas 2.6 and 2.8 the group Gb
is a sphere group with peripheral conjugacy classes pΞi,jqi,j speciﬁed by (7) and,
moreover, GbGG is a sphere biset.
Observe that the multiset of the lifts of Γi via H BG is the multiset of the lifts
via HbGb of the lifts via Gb GG of Γi with the corresponding degrees being mul-
tiplied. Since HbGb has degree one, the multiset of the lifts of Ξi,j is a singleton

tp1,rΞi,jqu. Therefore, the multiset of the lifts of Γi is tpdpi, jq,rΞi,jqu with dpi, jq as

in Lemma 2.8. This veriﬁes Conditions (SB2) and (SB3) of Deﬁnition 2.5; Condi-
tion (SB1) is immediate.
(cid:3)

Proof of Theorem 2.7. If f0 « f1, say via a path pft : pS2, Cq Ñ pS2, AqqtPr0,1s, then
Bpf0q – Bpf1q because Bpftq, being a discrete object, remains constant along the
isotopy.
Assume Bpf0q – Bpf1q; say β : Bpf0q Ñ Bpf1q is a biset isomorphism. Let
us construct a homeomorphism ψ : pS2, Cq ý such that f0 “ ψf1 and such that
Bpψq – H HH . Then using Theorem 2.3 we will get ψ « 1, and therefrom f0 « f1.
Choose b P Bpf0q and decompose H Bpf0qG – HbGb b GbGG. and H Bpf1qG –
HβpbqGβpbq b Gβpbq GG as in (6). Since β is an isomorphism we have Gb “ Gβpbq,
so GbGG “ Gβpbq GG. By Lemma 2.8 the bisets of f0 : pS2, f ´1
0 pAqq Ñ pS2, Aq
and f1 : pS2, f ´1
1 pAqq Ñ pS2, Aq are isomorphic to GbGG and Gβpbq GG after iden-
tifying π1pS2, f ´1
0 pAqq and π1pS2, f ´1
1 pAqq with Gb and Gβpbq as in Lemma 2.8.
Therefore, f0 : pS2, f ´1
1 pAqq Ñ pS2, Aq are cov-
ering maps associated with the same subgroup of G; thus the map ψ :“ f0 ˝
f ´1
1 pAqq is a well deﬁned homeomorphism speciﬁed so
1

0 pAqq Ñ pS2, Aq and f1 : pS2, f ´1

0 pAqq Ñ pS2, f ´1

: pS2, f ´1

10

LAURENT BARTHOLDI AND DZMITRY DUDKO

that ψpthe endpoint of bq “ the endpoint of βpbq. Finally

H Bpψ : pS2, Cq ýqH “ HbGb bGb“Gβpbq GβpbqβpbqH – H HH .

Let us now prove the second part of the theorem. Decompose H BG – HbGb b
GbGG as in (6). By Hurwitz’s theorem [19] the cover of S2zA associated with
Gb ď G is a ﬁnitely punctured sphere; write this cover as f : S2zf ´1pAq Ñ S2zA.
As in Lemma 2.8 we identify Gb with π1pS2, f ´1pAqq and we denote by pΞaqaPf ´1pAq
the peripheral conjugacy classes of Gb – π1pS2, f ´1pAqq.
By Lemma 2.9 the biset HbGb is a sphere biset. Since HbGb has a single left

orbit, for every a P f ´1pAq the multiset of the lifts of Ξa is a singleton tp1,rΞaqu.
ιpΞaq “rΞa; i.e. ι “forgets” all Ξa with trivial rΞa.
rΞa. Since the biset of this map is naturally identiﬁed with HbGb, we obtain a

Then the homomorphism ι : Gb Ñ H given by bg “ ιpgqb has the property that
Let 1 : pS2, f ´1pAqq Ñ pS2, C1q be the map forgetting all a P f ´1pAq with trivial
natural isomorphism of π1pS2, C1q with H, and therefore of C1 with C. Using these
identiﬁcations, the biset of pS2, C1q
Ñ pS2, Aq is isomorphic to
H BG.
It follows from Theorem 2.3 that there is a map, unique up to isotopy, identifying
pS2, Cq with pS2, C1q and such that the biset of this map is isomorphic to H HH .
This ﬁnishes the construction of a sphere map f : pS2, Cq Ñ pS2, Aq with the biset
H BG.

(cid:3)

1

Ñ pS2, f ´1pAqq

f

2.2. Thurston maps. Consider a branched self-covering f : pS2, Aq ý. This means
fpAq Ď A and A contains the critical values of f . In particular, A contains the
post-critical set of f ,

Pf “ ďkě1

f kpcritical points of fq.

On the other hand, A could also contain ﬁxed points of f , or more generally prepe-
riodic points together with their forward orbit.
If A is ﬁnite, then f is called a
Thurston map.

Let f : pS2, Aq ý be a Thurston map.

In particular, f induces a map A ý.
Then its portrait f : A ý is a ﬁnite dynamical system also called a critical portrait.
Analogously, if GBG be a sphere biset for a sphere group G with peripheral con-
jugacy classes pΓaqaPA, then the induced map B˚ : A ý is the critical portrait of
GBG.

Deﬁnition 2.10 (Combinatorial equivalence of maps). Let f0 : pS2, A0q ý and
f1 : pS2, A1q ý be two Thurston maps. We say that f0 and f1 are combinatorially
equivalent, aka “Thurston-equivalent”, if there exists a path of Thurston maps
pft : pS2, Atq ýqtPr0,1s connecting f0 to f1. In that case, we write f „ g.
△
There is an equivalent formulation in terms of isotopy:

Lemma 2.11. Two Thurston maps f0 : pS2, A0q ý and f1 : pS2, A1q ý are combi-
natorially equivalent if and only if there exists homeomorphisms φ0, φ1 : pS2, A0q Ñ

SPHERE BISETS AND THEIR DECOMPOSITIONS

11

pS2, A1q with φ0 ˝ f0 “ f1 ˝ φ1 and φ0 isotopic to φ1 rel A0:

φ1

ö

φ0

pS2, A0q

f0

pS2, A0q

pS2, A1q

f1

pS2, A1q

commutes up to isotopy rel A0.

Proof. Given a path pftq of Thurston maps connecting f0 to f1, factor each map
ft as ft “ λt ˝ f0 ˝ ρ´1
for homeomorphisms λt, ρt : pS2, A0q Ñ pS2, Atq depending
continuously on t, with λ0 “ ρ0 “ 1. Deﬁne then φt “ ρ1 ˝ ρ´1
1´t ˝ λ1´t, and note
that φt : pS2, A0q Ñ pS2, A1q is a homeomorphism with φ0 “ λ1 and φ1 “ ρ1 so
φ0 ˝ f0 “ f1 ˝ φ1. Furthermore, pφtqtPr0,1s is an isotopy rel A0 from φ0 to φ1.
Conversely, let φ0, φ1 : pS2, A0q Ñ pS2, A1q be isotopic homeomorphisms, and
let pφtqtPr0,1s be an isotopy rel A0 between them. Let pλtqtPr0,1s be an isotopy
(possibly non-constant on A0) from λ0 “ 1 to λ1 “ φ0. Deﬁne At :“ λtpA0q and
ft :“ λt ˝ f0 ˝ φ´1
, and note ftpAtq Ď At, so ft is a Thurston map along
an isotopy from f0 to f1.

t ˝ φ0 ˝ λ´1

(cid:3)

t

t

Corollary 2.12 (Kameyama [20, Corollary 3.7]; see also [27, Theorem 6.5.2]). Two
Thurston maps f : pS2, Aq ý, g : pS2, Cq ý with |C|,|A| ě 2 are combinatorially
equivalent if and only if their bisets Bpfq and Bpgq are conjugate.
Proof. If f : pS2, Aq ý and g : pS2, Cq ý are combinatorially equivalent, then by
Lemma 2.11 there exists a homeomorphism φ : pS2, Aq Ñ pS2, Cq such that f and
φ´1 ˝ g ˝ φ are isotopic rel A; so Bpfq and Bpφq b Bpgq b Bpφq_ are isomorphic by
Theorem 2.7, and Bpfq and Bpgq are conjugate.
Conversely, if GBpfqG and H BpgqH are conjugate with respective sphere groups
G “ π1pS2zA,˚q and H “ π1pS2zC,:q, let ϕ : G Ñ H be a sphere group isomor-
phism such that the bisets Bpfq and Bϕ b Bpgq b B_
ϕ are isomorphic. By Theo-
rem 2.3, the homomorphism ϕ may be (uniquely) realized as φ˚ for a homeomor-
phism φ : pS2, Aq Ñ pS2, Cq, so f and φ´1 ˝ g ˝ φ are isotopic rel A by Theorem 2.7,
so f and g are combinatorially equivalent by Lemma 2.11.

(cid:3)

3. Decompositions of sphere bisets

We now explore how spheres and sphere bisets can be decomposed into simpler
components. As before, we describe side by side the topology and its associated
group theory.

We will use the following conventional notations. Two closed curves ℓ, ℓ1 in S2zA
are homotopic rel A if their parameterizations ℓ, ℓ1 : S1 Ñ S2zA are homotopic rel
A. Given a subset T Ă S2, we say that T is homotopic rel A to a point x P S2
(or T is contractible to x) if there is a homotopy h : T ˆ r0, 1q Ñ S2 rel A, namely
hp´, 0q “ 1 and hpy, tq “ hpy, 0q for all y P hpT,r0, 1qq X A, and hp´, tq Ñ x as
t Ñ 1. Note that if T is homotopic to x, then either T X A “ H or T X A “ txu.
Finally, we say that T Ă S2 is homotopic to a curve ℓ if there is a homotopy
h : T ˆr0, 1s Ñ S2 rel A and a curve ℓ1 Ă T such that hp´, 0q “ 1, hpT, 1q Ă ℓ, and
the restriction of h to ℓ1 ˆ r0, 1s is a homotopy rel A between ℓ1 and ℓ.

12

LAURENT BARTHOLDI AND DZMITRY DUDKO

3.1. Multicurves. Let pS2, Aq be a sphere. A multicurve C on pS2, Aq is a col-
lection of non-trivial, non-peripheral, mutually non-homotopic, non-intersecting,
simple closed curves on S2zA. A noded sphere is pS2, A, Cq, a sphere with a mul-
ticurve.
Although a noded sphere is still topologically a sphere, one should think, psycho-
logically, that the curves in C are extremely short, so that the sphere looks more
like a tree of sausages than a sphere.

If pS2, A, C q be a noded sphere, one may cut S2 along C , and shrink the bound-
ary components to punctures. Algebraically, this amounts to the following. Each
curve in C may be expressed as a conjugacy class Γ in G :“ π1pS2, Aq. Choose in
each Γ P C a representative tΓ P Γ. Then G decomposes as a tree of groups, with
one vertex per component S of S2zC and associated vertex group π1pSq, and one
edge per curve Γ P C with associated edge group xtΓy. The underlying graph is a
tree.
So as to follow [3, Deﬁnition 3.6], we consider rather the barycentric subdivision

of the above tree of groups:
Deﬁnition 3.1 (Tree of groups of a multicurve). Let pS2, A, C q be a sphere given
with a multicurve C . Its associated sphere tree of groups X is deﬁned as follows.
Consider the ﬁnite 1-dimensional cover [3, Deﬁnition 3.4] of pS2, Aq by compo-
nents of C and the set S of closures of components of S2zC ; call the former curves
and the latter small spheres. The underlying graph of X has one vertex per curve
and one per small sphere. It has four edges per curve, with an edge connecting each
curve to its two neighbouring spheres and back. Thus V “ C \ S is the vertex
set, and E “ tpv, wq P C ˆ S \ S ˆ C | v X w ‰ Hu is the edge set. We have
pv, wq´ “ v and pv, wq “ pw, vq.
Consider a vertex v P V ; it is represented by a subset Sv of S2, and is either a
curve or a small sphere. Choose a basepoint ˚v P SvzA, and for each edge pv, wq
choose a path ℓv,w in pSv Y SwqzA from ˚v to ˚w, assuming ℓ´1
v,w “ ℓw,v. The
group associated to the vertex v is the fundamental group Gv “ π1pSvzA,˚vq. The
group associated with the edge pv, wq is Gv if v P C and is Gw if w P C . The
homomorphism Gpv,wq Ñ Gpw,vq is the identity. The homomorphism Gpv,wq ÞÑ Gv
is the identity if v P C and is γ ÞÑ ℓv,w#γ#ℓw,v otherwise.
△

In particular, the groups associated with small spheres are sphere groups (there
is no distinction, from their point of view, between boundary components in A
or in C ), and the vertex groups associated with curves are inﬁnite cyclic (they
could be thought as sphere groups of S2zt0,8u), as are the edge groups. The
underlying graph is a tree. The van Kampen theorem, see [3, Theorem 3.7], asserts
that the fundamental group of pS2, Aq is isomorphic to the fundamental group of
X. We recall from [3, Lemma 4.9] that a tree of groups is deﬁned uniquely up to
congruence (see [3, Deﬁnition 3.29]).

For a small sphere S Ă pS2, Aq or S2zA, we write pS for the quotient of S in which
every boundary curve is shrunk to a point; so pS is a topological sphere, marked by

the image of A and the boundary curves.

3.1.1. Algebraic multicurves. Recall from [3, §3.2] that the barycentric subdivision
of a graph X “ V \ E is a new graph X1 “ V 1 \ E1 with vertex set V 1 “ X{tx “
xu “ V \ E{tx “ xu and edge set E1 “ E ˆ t`,´u; for e P E and ε P t˘1u,
set pe, εqε “ eε and pe, εq´ε “ res and pe, εq “ pe,´εq. Let us say that a vertex

SPHERE BISETS AND THEIR DECOMPOSITIONS

13

v P V 1 is old if v P V and is new if v P E{tx “ xu. Old and new vertices form a
bipartite structure of X1. We are now ready to state an algebraic counterpart of
Deﬁnition 3.1; the equivalence of the objects is proven in Lemma 3.3.

Deﬁnition 3.2 (Sphere groups and algebraic multicurves). A stable sphere tree of
groups is

(1) a tree X that is the barycentric subdivision of a smaller tree; old vertices of
X are called sphere vertices while new vertices of X are called curve vertices;
(2) a sphere group at every vertex, so that curve vertex groups are cyclic

ripheral conjugacy classes;

(thought at π1ppC,t0,8uq) while sphere vertex groups have at least 3 pe-

(3) a cyclic group at every edge, which embeds into vertex groups by mapping
a generator to an element of a peripheral conjugacy class, in such a manner
that diﬀerent edge groups attach to diﬀerent peripheral conjugacy classes.
A peripheral conjugacy class in a vertex group Gv is vacant if it doesn’t intersect
the image of any edge group. Clearly, vacant peripheral classes in a sphere tree of
groups X are identiﬁed with peripheral conjugacy classes in π1pXq.
Let G be a sphere group. An algebraic multicurve is a collection C of distinct,
non-peripheral conjugacy classes in G, such that there exists a decomposition of G
as a sphere tree of groups with edges in bijection with C , such that the edge group
associated with Γ P C is cyclic and generated by a representative tΓ P Γ.
△
The following extends Lemma 2.2 to spheres with multicurves:
Lemma 3.3. Let pS2, Aq be a marked sphere with multicurve C , and choose ˚ P
S2zA. Then the tree of groups decomposition X of G “ π1pS2zA,˚q along C is a
sphere tree of groups as in Deﬁnition 3.2. Via this decomposition, peripheral con-
jugacy classes in G form vacant peripheral conjugacy classes in X while conjugacy
classes of G encoding C form non-vacant peripheral conjugacy classes of X.

Conversely, to a sphere tree of groups corresponds a marked sphere with multic-

urve, which is unique up to homeomorphism.
Proof. It is easy to check that the tree of groups decomposition of π1pS2zA,˚q
along C satisﬁes Deﬁnition 3.2. Conversely, given a sphere tree of sphere groups as
in Deﬁnition 3.2, construct a sphere with multicurve by ﬁrst realizing every small
sphere vertex group as the fundamental group of a sphere with marked points;
remove a small disk around each marked point whose corresponding peripheral
class is not vacant, and attach cylinders, with a marked curve along their core,
between these spheres by gluing their boundary to the boundary of the removed
disks. The uniqueness of the obtained sphere follows from Theorem 2.3.
(cid:3)

Note that there exists a general notion, that of “JSJ decomposition” of groups [30],
over cyclic subgroups. One usually considers it for freely indecomposable groups;
while, on the other hand, we apply it here to study bisets over decompositions of
free groups over cyclic subgroups.
Theorem 3.4. There is an algorithm that, given pG, Γiq a sphere group and C a
collection of conjugacy classes in G, computes a sphere tree of groups decomposition
as in Deﬁnition 3.2 (if C is an algebraic multicurve), or returns fail (if it is not).

Proof. There are algorithms (see [9, 10]) that compute geometric intersection num-
bers of curves; and, in particular, whether a conjugacy class represents a simple
closed curve.

14

LAURENT BARTHOLDI AND DZMITRY DUDKO

Given a multicurve C , apply such an algorithm to each curve gG of C , in turn.
If it is a simple closed curve, then t1, . . . , nu may be partitioned as ti1, . . . , isu \
tj1, . . . , jtu in such a manner that g may be written as a product of conjugates of
Hurwitz generators of G as

g “ γu1

i1 ¨¨¨ γus

is “ pγv1

j1 ¨¨¨ γvt

jt q´1

for u1, . . . , us, v1, . . . , vt P G. The partition ti1, . . . , isu \ tj1, . . . , jtu is obtained by
computing the image of g in G{rG, Gs – Zn{p1, . . . , 1q and writing it as ei1 ` ¨¨¨ `
eis “ ´pej1 ` ¨¨¨ ` ejtq with e1, . . . , en the image of the standard basis of Zn.
The claimed decomposition of g exists for topological reasons: picture the sphere
with ˚ at the north pole, all ai on the equator, and all lollipop generators along
meridians except for their little loop around ai. Consider g as a closed curve on
S2. There is then an isotopy of S2 that brings g into a thin neighbourhood of the
equator, turning once around it. Under the isotopy, every lollipop generators gets
deformed to a conjugate of itself. The curve g is isotopic to the product of the
original lollipop generators γi that lie above it, namely such that the curve g passes
below ai as it revolves around S2. Once we know that such a decomposition exists,
we can ﬁnd it by enumerating all choices of u1, . . . , us, v1, . . . , vt.

i1 , . . . , γ1

s “ γus

, g´1 and relation γ1

This shows how to split G as an amalgamated free product over Z: the edge
group Z is generated by g, one vertex group is the sphere group G1 generated by
1 “ γu1
γ1
sg´1 “ 1, and the other vertex
1 ¨¨¨ γ1
group G2 is similarly generated by g and the γ2
with relation
1 ¨¨¨ γ2
γ2
The remaining curves in C ztgGu should now be rewritten in terms of the gen-
erators of G1 or of G2. If this is impossible, then the curves in C are not disjoint.
Otherwise, proceed inductively with G1 and G2, which have smaller complexity. (cid:3)

1 “ γv1

t “ γvt

t g “ 1.

j1 , . . . , γ2

is

jt

3.2. Invariant multicurves. Consider a sphere map f : pS2, Cq Ñ pS2, Aq and
a multicurve C in pS2, Aq. Since f is a covering away from A, there is a lifted
multicurve f ´1pC q in pS2, Cq.
Algebraically, f is represented as an H-G-biset Bpfq, and C is represented by
conjugacy classes in G. By [3, §2.6], conjugacy classes in G may be lifted through
B to conjugacy classes in H, and this operation corresponds to taking preimages
of multicurves.

We consider more generally the situation of a sphere map f : pS2, C, Dq Ñ
pS2, A, Cq, meaning D is isotopic to a subset of f ´1pC q. For our purpose, the
most valuable information about lifts of multicurves is contained in the Thurston
matrix, see [3, (2)]: it is the linear operator Tf,C : QC Ñ QD given by
(8)

δ.

1

Tf,Cpγq “ ÿεPf ´1pγq

ε«δPD

degpf åε : ε Ñ γq

Here by deg one means the usual positive degree of f ; i.e. the degree of zd : t|z| “
1u ý is |d|.
If H BG be a sphere biset, C be a multicurve in G and D be a multicurve in
H, both represented as collections of conjugacy classes, then by [3, §2.6] there is a
linear operator TB,C : QC Ñ QD, which coincides with (8) in case B “ Bpfq.
structure of abelian sub-bisets for the mapping class group ModpGq.

In Proposition 6.9 we shall later interpret the Thurston matrix as giving the

SPHERE BISETS AND THEIR DECOMPOSITIONS

15

Consider a Thurston map f : pS2, Aq ý. A multicurve C is invariant if C is, up
to isotopy, a subset of f ´1pC q. The Thurston matrix Tf,C is then an endomorphism
of QC .
Its importance was made clear by a fundamental result of Thurston character-
izing Thurston maps that are combinatorially equivalent to rational maps. An
annular obstruction for a Thurston map f is an f -invariant multicurve C such that
the spectral radius of Tf,C is ě 1.
Theorem 3.5 (Thurston [13]). Let f : pS2, Pfq ý be a Thurston map with hyper-
bolic orbifold, see §7. Then f is combinatorially equivalent to a rational map if
and only if f admits no annular obstruction. Furthermore, in that case the rational
map is unique up to conjugation by M¨obius transformations.
3.3. Decomposition along multicurves. Consider again a sphere map f : pS2, C, Dq Ñ
pS2, A, Cq with multicurves satisfying now D Ď f ´1pC q. By Theorem 3.4, there
are sphere tree of groups decompositions X of G “ π1pS2zA,˚q and Y of H “
π1pS2zC,:q. Using the van Kampen Theorem for bisets, we shall decompose the
H-G-biset Bpfq into an Y-X-tree of bisets Bpfq.
Up to homotopy, the map f : pS2, C, Dq Ñ pS2, A, Cq may be written as a cor-
respondence

(9)

pS2, C, Dq iÐ pS2, f ´1pAq, f ´1pCqq

f

Ñ pS2, A, C q;

the map f is the same as the original map f , but is now a covering, and we specify
the map i as follows. It ﬁrst forgets all points in f ´1pAqzC and all curves in f ´1pCq
that are not isotopic to curves in D. It squeezes all annuli between the remaining
curves in f ´1pC q that are isotopic in S2zC, and maps them to the corresponding
curve in D. This deﬁnes uniquely i as a monotone map (preimages of connected
sets are connected), up to isotopy.
Let us say that a curve γ P f ´1pC q is

essential
non-essential otherwise.

if γ is homotopic rel C to a curve in D,

Lemma 3.6. Consider γ P f ´1pCq. If both connected components of S2zγ contain
essential curves of f ´1pC q, then γ is non-trivial rel C.
Proof. If γ is a non-essential curve, then it surrounds a disc homotopic rel C to a
point in S2. Therefore, all curves in this disc are peripheral or trivial rel C.
(cid:3)

The respective multicurves D, f ´1pC q and C in (9) deﬁne 1-dimensional covers
as in Deﬁnition 3.1; following [3, §4.2] we deﬁne the tree of bisets associated with
f as follows:
Deﬁnition 3.7 (Sphere tree of bisets Bpfq). Consider a map f : pS2, C, Dq Ñ
pS2, A, Cq and decompose it as in (9). Let Y and X be the sphere trees of groups
associated with pS2, C, Dq and pS2, A, Cq respectively as in Deﬁnition 3.1. Then
the Y-X sphere tree of bisets B “ Bpfq is constructed as follows.
Vertices of B are in bijection with components of f ´1pC q and closures of com-
ponents of S2zf ´1pCq; call the former curve vertices and the latter sphere vertices.
Consider a vertex z of Bpfq; it is represented by a subset Sz of S2, and is either a
curve or a small sphere. The graph morphism ρ : B Ñ X is given by the covering
f so that fpSzq “ Sρpzq.

16

LAURENT BARTHOLDI AND DZMITRY DUDKO

Deﬁne the map λ : B Ñ Y such that ipSzq Ă Sλpzq for every object z P B and
such that
(TB1) λ is a monotone map; i.e. λ´1pzq is a subtree of B for every z P B; and
(TB2) λ maps essential curve vertices to essential curve vertices.
For every z P B the Gλpzq-Gρpzq-biset attached to z is
(10)

Bpi : Szzf ´1pAq Ñ SλpzqzCq_ b Bpf : Szzf ´1pAq Ñ SρpzqzAq.

△

Furthermore, for every curve vertex e P Y we have i´1pSyq “ŤzPλ´1pyq Sz and

By [3, Theorem 4.8], the fundamental biset of Bpfq is isomorphic to Bpfq.
In the next Lemma 4.1 we will show that Conditions (TB1) and (TB2) uniquely
specify λ : B Ñ Y; in particular these conditions are realizable. Let us also note
that without these conditions there are in general many choices of λ, and therefore
many slightly diﬀerent graphs of bisets as in [3, §4.2] decomposing B.
Lemma 3.8 (Uniqueness of B). Deﬁnition 3.7 determines the map λ : B Ñ Y
uniquely. Up to congruence of trees of bisets (see [3, Deﬁnition 3.29]), the sphere tree
of bisets B “ Bpfq is determined by the isotopy type of f : pS2, C, Dq Ñ pS2, A, C q.
this set is an annulus (possibly a closed curve) bounded by two (possibly equal)
curves in f ´1pC q that are isotopic rel C to Se.
Proof. Conditions (TB1) and (TB2) are equivalent to the following property obvi-
ously implying the uniqueness of λ. For every curve vertex y P Y and every vertex
z P B we have λpzq “ y if and only if ipSzq Ă Sy, see (9). Indeed, from the last
property follows the monotonicity of λ (by monotonicity of i) and, clearly, λ maps
essential curve vertices to curve vertices. Conversely, for every curve vertex y P Y
the set i´1pSyq is an annulus (possibly a closed curve) bounded by two curves
Sz, Sz1 P f ´1pC q isotopic rel C (possibly with Sz “ Sz1). By Condition (TB2)

we have λpzq “ λpz1q, and by monotonicity of λ we have i´1pSyq ĂŤzPλ´1pyq Sz.
Therefore, i´1pSyq “ ŤzPλ´1pyq Sz because ipSvq Ă Sλpvq for all vertices v P B,

and the claim of the lemma follows. The second claim follows from [3, Lemma 4.9]
because λ, ρ are uniquely speciﬁed. The last claim has already been veriﬁed.
(cid:3)

Note here one of the reasons we considered in Deﬁnition 3.1 the barycentric
subdivision of the simpler decomposition with one vertex per small sphere and one
edge per curve: our deﬁnition of graphs does not allow vertices to be mapped to
midpoints of edges, as we would like to do in case z is a small sphere vertex and
ipSzq is homotopic to a curve. Without taking a barycentric subdivision, we would
have been forced to choose one of its two neighbouring spheres to which to map z;
and no such choice can be made canonical.

Theorem 3.9. There is an algorithm that, given a sphere biset H BG and algebraic
multicurves C in G and D in H with D contained in the B-lift of C , computes the
decomposition of B as a sphere tree of bisets.

Proof. By Theorem 2.7 we may assume that H BG is the biset of a sphere map
f : pS2, Cq Ñ pS2, Aq. Then C and D deﬁne multicurves, still denoted by C and
D, in pS2, Aq and pS2, Cq.
Choose b P B and decompose H BG “ HbGb b GbGG as in (6). Recall from
Lemmas 2.8 and 2.9 that this decomposition is the algebraic counterpart of (3) and
that Gb is identiﬁed with the fundamental group of pS2, f ´1pAqq.

SPHERE BISETS AND THEIR DECOMPOSITIONS

17

Denote by pΓaqaPA the peripheral conjugacy classes in G, by p∆cqcPC the periph-
eral conjugacy classes in H, and by pΞaqaPf ´1pAq the peripheral conjugacy classes
in Gb. Note that pΞaqaPf ´1pAq is easily computable as the set of all lifts of pΓaqaPA
through Gb GG, see Lemma 2.8.
Denote by f ´1pCq the set of all lifts of C through GbGG. Again f ´1pC q is
easily computable and is the algebraic counterpart of the multicurve f ´1pC q in
pS2, f ´1pAqq. By Theorem 3.4, the sphere groups G, Gb, H can be decomposed
relatively to C , f ´1pC q, D as trees of groups X, K, Y respectively.
By deﬁnition, the underlying tree of bisets decomposing B is the graph K. The
map ρ : K Ñ X is induced by inclusion: consider a vertex z P K, with corresponding
group Gz. Then ρpzq is the unique vertex of X such that Gz Ď Gρpzq.
By lifting curves in f ´1pCq through HbGb we compute the set of essential curve
vertices in K as well the λ on this set. By monotonicity of λ (see the second claim
in Lemma 3.8) it has a unique, and thus computable, extension on the whole graph
K.

As a graph, B is the underlying graph of K. Consider now a vertex z P K; we
deﬁne a Hλpzq-Gρpzq-biset Bz, to be put at z in the tree of bisets, as follows. We
compute bGz “ Lzb for a ﬁnitely generated subgroup Lz of H; this is possible since
elements of Gz stabilize b. We ﬁnd (e.g. by enumeration) an element h P H with
Lz ď H h
λpzq. This is possible because ipSzq Ă Sλpzq using the notation of (10). We
ﬁnally set Bz :“ HλpzqhbGρpzq, the sub-biset (10) of B.
3.4. Kameyama’s theorem extended to spheres with multicurves. We are
ready to extend Kameyama’s algebraic characterization of combinatorial equiva-
lence, taking multicurves into account. This will lead to algorithmic constructibility
of sphere decompositions.

(cid:3)

Theorem 3.10. Let f, g : pS2, C, Dq Ñ pS2, A, Cq be two sphere maps and let
Y and X be the sphere trees of groups associated with pS2, C, Dq and pS2, A, Cq
respectively as in Deﬁnition 3.1. Then f is isotopic to g by an isotopy mapping D
to C if and only if the sphere trees of bisets YBpfqX and YBpgqX are isomorphic.
Proof. Since the sphere tree of bisets Bpfq is constructed out of Bpfq and C , D
viewed as conjugacy classes in π1pS2, Cq and π1pS2, Aq; and similarly Bpgq is con-
structed out of Bpgq and C , D, the trees of bisets Bpfq and Bpgq are isomorphic
if and only if Bpfq and Bpgq are isomorphic by an isomorphism preserving the
dynamics on multicurves.
By Theorem 2.7, this happens if and only if f is isotopic to g by an isotopy
(cid:3)

preserving D and C

We recall that two graphs of bisets XBX and YCY are called conjugate if there
exists a biprincipal (see [3, §3.8]) graph of bisets XIY such that BbX I and IbY C
are isomorphic, namely have same underlying graphs and isomorphic vertex and
edge bisets. If XBX and YCY are sphere trees of bisets, then XIY is also required
to be a sphere tree of bisets.

Two Thurston maps f0 : pS2, A0, C0q ý and f1 : pS2, A1, C1q ý with respective
invariant multicurves C0, C1 are combinatorially equivalent if there exists a path of
Thurston maps pft : pS2, At, Ctq ýqtPr0,1s connecting them.

18

LAURENT BARTHOLDI AND DZMITRY DUDKO

Corollary 3.11. Let f : pS2, A, C q ý and g : pS2, C, Dq ý be Thurston maps with
respective invariant multicurves C , D. Then f, g are combinatorially equivalent if
and only if the sphere trees of bisets of f, g are conjugate.

Proof. As in the case of Thurston maps without multicurve (see Lemma 2.11), a
combinatorial equivalence between Thurston maps with multicurves factors as a
composition of an isotopy and a conjugation. The corollary therefore follows from
Theorem 3.10.
(cid:3)

4. Renormalization

Let us consider a sphere map f : pS2, C, Dq Ñ pS2, A, Cq.
In this section we
assume D “ f ´1pCq rel C. In this case D naturally cuts f into exactly #D ` 1
sphere bisets which we call small bisets of the decomposition.
It easily follows from the assumption D “ f ´1pC q rel C that every non-essential
curve γ P f ´1pC q is either trivial or peripheral. Since B is a tree, every edge vertex
z P B disconnects B into exactly two connected components.
Lemma 4.1. Let z P B be a curve vertex. Then z is essential if and only if every
connected component of the graph Bztzu contains an object v with λpvq ‰ λpzq.
Proof. If z is a non-essential curve vertex, then Sz surrounds a disc D homotopic
rel C to a point. Therefore, all objects representing small spheres and curves within
D have the same image under λ as z. Conversely, suppose z is an essential curve

vertex. Then Az :“ i´1pSλpzqq “ŤvPλ´1pλpzqq Sv is an annulus (possibly a closed

curve) such that its boundary components are homotopic to Sz. Therefore, there
are Sv, Sw Ă S2zAz in diﬀerent components of S2zSz such that λpvq ‰ λpzq ‰
λpwq.
Corollary 4.2. Suppose that the underlying graph of B is not a singleton. Let
y P Y be a sphere vertex. Then λ´1pyq contains a unique z P B that neighbours at
least one essential curve vertex.
Proof. Clearly there is at least one sphere vertex in λ´1pyq neighbouring at least
one essential curve vertex. If there are two such sphere vertices v, w P λ´1pyq, then
they are separated by a non-essential curve vertex; this contradicts Lemma 3.6. (cid:3)
4.1. Essential spheres. We return to a sphere map f : pS2, C, Dq Ñ pS2, A, Cq,
keeping the convention D “ f ´1pCq rel C, and consider its decomposition as tree
of bisets. The curve vertices in Bpfq correspond to edges in the decomposition of
pS2, f ´1pAq, f ´1pC qq, and to connected components of f ´1pCq, while the sphere
vertices z P Bpfq correspond to small spheres Sz. We classify sphere vertices in
Bpfq as follows: a sphere vertex z P Bpfq is

(cid:3)

if Sz is homotopic rel C to a point in pS2, Cq;

trivial
annular if Sz is homotopic rel C to a curve in D;
essential otherwise.

A trivial vertex is thus a dynamically-irrelevant small sphere in S2zf ´1pC q: it gets
blown down to a point (marked or not) by projecting to pS2, Cq. We have the
following characterization in terms of the graph combinatorics:

Lemma 4.3. Suppose that the underlying tree of B is not a singleton. A sphere
vertex z P B is trivial if there is a non-essential curve vertex in B separating z from

SPHERE BISETS AND THEIR DECOMPOSITIONS

19

at least one essential curve vertex; it is annular if it separates two essential curve
vertices of B mapping to the same curve vertex of Y; and it is a sphere vertex if
λpzq is a sphere vertex and z is adjacent to an essential curve vertex.
Proof. A sphere vertex z P B is trivial if and only if Sz lies within a disc that is
contractible rel C and is surrounded by a non-essential curve in f ´1pC q; this is
equivalent to the condition stated in the lemma.
If a sphere vertex z P B is annular, then there are two components in BSz ho-
motopic rel C to a curve in D; namely Sz separates two homotopic rel C essential
curves in f ´1pCq; this is equivalent to the condition stated in the lemma. Con-
versely, if Sz separates two essential curves in f ´1pCq that are homotopic rel C,
then Sz is itself homotopic rel C to these curves.
By deﬁnition, if z P B is an essential sphere vertex, then λpzq is a sphere vertex.
Conversely, if z P B is a sphere vertex while λpzq is a curve vertex, then z is either
a trivial or an annular sphere vertex. By Corollary 4.2, for a vertex y P Y there
is a unique vertex z1 P λ´1pyq that neighbours an essential curve vertex of B. On
one hand, all sphere vertices in λ´1pyqztz1u are trivial (by the ﬁrst claim of this
lemma), on the other hand z1 is neither trivial not annular (by the ﬁrst two claims
of this lemma); i.e. z1 is an essential sphere vertex.
(cid:3)
Corollary 4.4. There is a computable bijection between the small spheres in S2zD
and the essential spheres in S2zf ´1pCq.
Proof. This follows from Lemma 4.3 and Corollary 4.2. All conditions are expressed
in terms of the map of ﬁnite graphs λ : B Ñ Y, so are computable.
(cid:3)
Let us remark that the classiﬁcation of small spheres in pS2, f ´1pAq, f ´1pCqq de-
pends only on the forgetful map pS2, f ´1pAq, f ´1pC qq
Ñ pS2, C, Dq; see Figure 1.
4.2. Epic-monic factorizations. Recall from [3, Lemma 2.7] that for a transitive
H-G-biset B there exist a group K and homomorphisms φ : K Ñ G, ψ : K Ñ H
such that B “ B_
Every group homomorphism factors as a composition of a surjective (“epic”)
morphism with an injective (“monic”) morphism. Let us apply this factorization to
φ and ψ; that is, set P :“ ψpKq, Q :“ φpKq, and view ψ and φ as homomorphisms
onto P and Q respectively, followed by natural inclusions. We get the factorization

ψ bK Bφ. Moreover, there is a minimal such K.

1

B “ H HP b B_

ψ bK Bφ b QGG.

Combining the last three terms into a biset P B1
ization

G we get the left epic-monic factor-

B “ H HP bP B1
G.

Below is a direct way how to calculate P and B1; its proof is immediate.
Lemma 4.5. Let B be a transitive H-G-biset. Choose b P B and let P be the
stabilizer of b b t¨u in B bG t¨u. Then B1 “ P bG and B “ H HP b P bG.
We remark that the left epic-monic decomposition of a sphere biset HBG is trivial
(i.e. P “ H) because the G-action is transitive. Let us now generalize Lemma 4.5
to the context of graph of bisets.

(cid:3)

Proposition 4.6. Let YBX be a graph of bisets and assume that every Bz is a
transitive Gλpzq-Gρpzq-biset. Let X˝ be the graph of groups obtained from X by

20

LAURENT BARTHOLDI AND DZMITRY DUDKO

trivial

trivial

trivial

essential

annular

annular

essential

i

i

i

i

‚B1
E12
‚B2
E23

‚B3

λ

‚G1

B4
‚

E45

‚B5

λ

E35

E67

B6
‚

λ

E56

xxy

‚ B7
λ

‚ G2.

Figure 1. Trivial, annular and essential small spheres, and the
corresponding tree of bisets (note that the actual graph of bisets
is a barycentric subdivision of the one shown on the picture)

replacing each group Gz with the trivial group. Denote by pX, X˝q the X-X˝-graph
of bisets with λ “ ρ “ 1 and bisets Bz “ Gzt¨u1 for all z P pX, X˝q.
Consider the graph of bisets B b pX, X˝q. For every z P B, choose bz P Bz. Let
Pλpzq ď Gλpzq be the stabilizer of bz b t¨u in Bpz,ρpzqq, with pz, ρpzqq viewed as an
object in B b pX, X˝q. As in Lemma 4.5, decompose Bz “ Gλpzq bPλpzq B1
z.
Let P be the graph of groups with underlying graph B and group Pz at every
z P P, and with morphisms Pz Ñ Pz´ given by g Ñ pg´qγz with γz chosen so that
γ´1
z pbpz,ρpzqqq´ “ bpz´,ρpz´qq.
z be the P-X-graph of bisets with biset PzpBzqGρpzq attached to each z P B1
Let B1
and biset congruences Bz Ñ Bz´ given by b Ñ γ´1
z b´. Let pY, Pq be the Y-P-
graph of bisets with underlying graph B and with biset Bz “ GλpzqGλpzqPz
attached
to z P pY, Pq with biset congruences Bz Ñ Bz´ given by g Ñ gγz.

Then B decomposes as

(11)

B “ pY, Pq b B1.

Proof. Follows directly from the construction and the deﬁnition of the tensor prod-
z “ Bz attached to
uct:
z P pY, Pq.

is B as a graph with GλpzqGλpzqPz b B1

pY, Pq b B1

(cid:3)

SPHERE BISETS AND THEIR DECOMPOSITIONS

21

4.3. Small sphere maps. The classiﬁcation of small spheres can be directly seen
at the algebraic level. Consider a sphere biset H BG, multicurves C , D in G, H
respectively such that D is contained in the B-lift of C , and consider the tree
of bisets decomposition B of B along C . Let X, Y denote the tree of groups
decompositions of G, H along C , D respectively.

We express algebraically the notions of trivial, annular and essential sphere ver-

tices using the epic-monic factorization from §4.2:

Deﬁnition 4.7 (Algebraically trivial, annular, essential sphere vertices). Let YBX
be a tree of sphere bisets. A sphere vertex of z P BX is

trivial

z for a sphere Pz-Gρpzq-biset B1

if Bz is of the form Gλpzq bPz B1

z and
a subgroup Pz ď Gλpzq generated by a representative of a peripheral in
π1pYq or trivial conjugacy class, so that the sphere structure of Pz is viewed
accordingly as either that of π1pS2q or as that of π1pS2zt0,8uq;
z and
a subgroup Pz ď Gλpzq generated by a representative of a class in D, so
that the sphere structure of Pz is viewed as that of π1pS2zt0,8uq;

annular if Bz is of the form Gλpzq bPz B1

z for a sphere Pz-Gρpzq-biset B1

essential

if Bz is a sphere biset.

Similarly, a curve vertex e P B is

non-essential

if Be is of the form Gλpeq bPe B1

e for a sphere Pe-Gρpeq-biset
B1
e and a subgroup Pe ď Gλpeq generated by a representative of a conjugacy
class that is peripheral or trivial in π1pYq, so that the sphere structure of
Pe is viewed accordingly as that of π1pS2q or as that of π1pS2zt0,8uq;
△

if Be is a sphere biset.

essential

Observe that all these cases are exclusive; for example, in the ﬁrst, second and
fourth cases the biset Bz is not a sphere biset.
Lemma 4.8. Let f : pS2, C, Dq Ñ pS2, A, Cq be a sphere map with associated tree
of bisets Bpfq. Then a small sphere vertex of Bpfq is trivial, annular or essential
if and only if the corresponding small sphere is respectively trivial, annular or es-
sential, and a curve vertex of Bpfq is essential or non-essential if and only if the
corresponding curve is respectively essential or non-essential.
Proof. If z P B is a trivial sphere vertex, then Pz :“ i˚π1pSzzf ´1pAqq is either
trivial or generated by a representative of a peripheral conjugacy class. Decompose
iÑ ipSzq ãÑ Sλpzq; so Bpi : Sz Ñ Sλpzqq_ factors as GλpzqbPz B2
i : Sz Ñ Sλpzq as Sz
z
for a sphere biset B2
z for a sphere biset B1
z . By (10), Bz is of the form GλpzqbPz B1
z.
If z P B is an annular sphere vertex, then Pz :“ i˚π1pSzzf ´1pAqq is generated by a
representative of a conjugacy class in D. As above, Bz is of the form Gλpzq bP B1
z.
Suppose that z P B is an essential sphere vertex. Observe i˚π1pSzzf ´1pAqq “
π1pSλpzqzCq because i´1pSλpzqqzSz consists of ﬁnitely many contractible rel C discs.
Since Gλpzq has at least three peripheral conjugacy classes, Bz does not factor as
Gλpzq bP B1 for a subgroup P ň Gλpzq and it follows that Bz is a sphere biset.

The characterization of essential curve vertices is veriﬁed similarly.

(cid:3)

Let S , T , U denote the collection of small spheres in the decomposition of
S2zC , S2zf ´1pCq, S2zD respectively. By Corollary 4.4, there is a well-deﬁned map,
still written f : U Ñ S , sending each small sphere Uw Ă S2zD to the image by f
of the unique essential sphere of S2zf ´1pC q contained in Uw. To avoid cumbersome

22

LAURENT BARTHOLDI AND DZMITRY DUDKO

indices, we write interchangeably fpUwq “ Sv and fpwq “ v, deﬁning by the latter
a map from the vertex set of Y to the vertex set of X.

a small sphere map of f .

Lemma-Deﬁnition 4.9. The induced map pf : xUw Ñ{Sf pwq is a sphere map, called

Proof. Let Tz be the essential sphere above Uw. By construction, i : Tz Ñ Uw is a
homeomorphism onto its image, and components of UwzipTzq are contractible.
disk D, along its boundary, to every S1-boundary component. The disk is marked

construction on Tz and on Sf pwq.

The space xUw can equivalently be constructed by attaching a copy of the unit
at its centre. In this manner, Uw is seen as a subset of xUw. We perform the same
The map f : Tz Ñ Sf pwq extends naturally to a branched covering g :xTz Ñ{Sf pwq
The map i : Tz Ñ Uw extends naturally to a homeomorphism j :xTz Ñ xUw: on
Tz it is deﬁned as i, while on disks D it is deﬁned as the identity. We set pf “ j´1g

with branched values in A Y tcentres of disksu: on Tz it is deﬁned as f , while on
a disk D with boundary curve C mapping by degree d to fpCq it is deﬁned as
zd : D Ñ D.

and note that it is a branched covering.

(cid:3)

These deﬁnitions admit direct analogues in the algebraic setting of a sphere tree
of bisets YBX. By Lemma 4.3, for every vertex w P Y there is a unique essential
vertex z P B in λ´1pwq, and ρpzq “ v for some sphere vertex v P X. We deﬁne a
map B˚ from the vertex set of Y to the vertex set of X by

B˚pwq :“ v if λpzq “ w and ρpzq “ v and z essential.

We may also extend B˚ into a map from the geometric realization of Y to that of
X. Recall that, for a graph X, its geometric realization X0 is the topological space

X0 “ X ˆ r0, 1s { tpx, tq “ p¯x, 1 ´ tq,px´, tq “ px, 0q@x P X,@t P r0, 1su.

The map

λ´1 : tsphere vertices of Yu Ñ tessential sphere vertices of Bu

extends into an essentially unique (up to isotopy rel sphere vertices) tree embedding
λ´1 : Y0 ãÑ B0. Indeed, any geodesic ℓ in Y0 lifts under λ into a unique geodesic
traveling through essential curve vertices, see Lemma 3.6. Composing with ρ, we
obtain the map B˚ : Y0 Ñ X0.
Example 4.10. The map B˚ is closely related to the self-map of the “Hubbard
tree” associated with a complex polynomial; we refer to [3, §5.2] and the original
references [11, 12].

Consider a complex polynomial p and let g :“ p Z p be the formal mating of
p with its complex conjugate. Let us denote by p : T ý the Hubbard tree of p;
the Hubbard tree p : T ý of p is obtained from p : T ý by applying complex
conjugation.

For every edge e P T there is a simple closed curve γe intersecting T once at e
and intersecting T once at e such that γe follows external rays of p and p away from
e and e. If the edge ei P T covers di,j times ej P T , then g´1pγejq has exactly di,j
components isotopic to γei and each of these components is a degree-one preimage
of γej . Therefore, CT :“ tγe : e P T u is an invariant multicurve with Thurston

SPHERE BISETS AND THEIR DECOMPOSITIONS

23

matrix pdi,jq; all the small maps in this decomposition are ﬁnite-order or monomial
rational maps, so CT is the canonical obstruction of g.
Let YBY be the graph of bisets encoding the decomposition of g relative to CT ,
and let XTX be the graph of bisets associated with p : T ý as in [3, §5.2]. Sphere
vertices of Y are in bijection with vertices of T and with non-edge vertices of X.
Curve vertices of Y are in bijection with edges of T . Essential sphere vertices of B
are in bijection with essential vertices of T 1.

At the graph level λ, ρ : B Ñ Y are the same as λ, ρ : T Ñ X. Furthermore,
there is a semiconjugacy π : YBY Ñ XTX given by identifying the northern and
southern hemisphere. More precisely, consider a sphere vertex y P Y. Its associated
group Gy maps to the corresponding group Gπpyq “ Z{ ordpπpyqq in X by sending
the peripheral generator in the northern and southern hemisphere to 1 and ´1
respectively and all other peripheral generators to 0.

4.4. Reﬁnement of sphere trees of groups. Recall from [3, §3.2] that the fun-
damental group of a graph of groups does not change under the operations “split
an edge” and “add an edge”. Recall also that, in a sphere tree of groups, a periph-
eral conjugacy class in a vertex group is vacant if it intersects no image of an edge
group.

If X is a stable sphere tree of groups, then we adjust these operations to respect

the sphere structure as follows:

(1) split a curve vertex: choose a curve vertex v P X. Let e0, ¯e0 and e1, ¯e1
be the pair of edges adjacent to v. Declare v to be a sphere vertex add
split e0, ¯e0 and e1, ¯e1 as follows. Add a curve vertex ℓ0 to X and replace
e0, ¯e0 by e00, ¯e00, e01, ¯e01 with e´
0 ; and make
a similar operation for the pair e1, ¯e1: replace it by edges e10, ¯e10, e11, ¯e11
and a new curve vertex ℓ1. Declare all groups to be equal to Gv with the
obvious maps between them;

00 “ ℓ0 “ e´

01 “ e`

01, e`

00 “ e´

0 , e`

(2) add an edge: choose a vertex v P V , and either trivial or a vacant pe-
ripheral class Γ of v. Let H be a (trivial or cyclic) subgroup of Gv generated
by a representative in h P Γ. Add a new sphere vertex w to X, add a new
curve vertex ℓ to X, and add new edges e0, e0 and e1, e1 with e´
0 “ ℓ
and e´
1 “ w. Deﬁne the new groups by Ge0 “ Gℓ “ Ge1 “ Gw “ H,
with the obvious maps between them. The peripheral conjugacy classes of
H form either empty set in case H is trivial or th, h´1u in case H is cyclic.
A reﬁnement of a graph of groups X is a graph of groups obtained from X by
applying ﬁnitely many times the above operations (1) and (2). An unstable sphere
tree of groups is a reﬁnement of a stable sphere tree of groups.

0 “ v, e`

0 “ ℓ, e`

Let P be a reﬁnement of X. Deﬁne a graph map λ : P Ñ X by sending vertex
v P P to the vertex of X from which v was reﬁned. Deﬁne the tree of bisets pX, Pq
to be P as a graph with λ as above, ρ :“ 1, and with Bz “ GλpzqGλpzqGρpzq
with
natural maps between them. Clearly, the fundamental biset of pX, Pq is isomorphic
to π1pXqπ1pXqπ1pXq.
Lemma 4.11. Let P be a sphere reﬁnement of a sphere tree of groups X. Then
for any vacant peripheral class Γ of X there is a unique vacant peripheral class of
Γ1 of P identiﬁed with Γ via pX, Pq.

24

LAURENT BARTHOLDI AND DZMITRY DUDKO

Proof. The tree of groups P is obtained from X via operations “split a curve vertex”
and “add an edge”; these operations clearly respect the set of vacant peripheral
classes in a sphere tree of groups.
(cid:3)

4.5. Sphere trees of bisets. We give in this section a characterization of those
trees of bisets that come from sphere maps with invariant multicurve. Combined
with Theorem 3.10, this extends Theorem 2.7 to branched coverings with multic-
urves.

is a sphere biset.

Deﬁnition 4.12. A tree of bisets YBX is a sphere tree of bisets if
(ST1) Y and X are stable sphere trees of groups;
(ST2) B is left-free, see [3, Deﬁnition 3.16], and Bz is transitive for all z P B;
write B “ pY, Pq b B1 as in (11);
(ST3) P has a sphere structure and is a sphere reﬁnement of Y, every biset in B1
△
Lemma 4.13. The tree of bisets Bpfq associated with a map f : pS2, C, Dq Ñ
pS2, A, Cq as in Deﬁnition 3.7 with D “ f ´1pCq rel C is a sphere tree of bisets.
Proof. Condition (ST1) is immediate. Condition (ST2) follows from [3, Proposi-
for every
tion 4.13] and Lemma 2.6. Condition (ST3) follows from Lemma 4.8:
z P B in the decomposition Bz “ Gλpzq bPz B1
z is
sphere with the group Pz either trivial or generated by a peripheral conjugacy class
in Bz.
(cid:3)

z as in Lemma 4.5 the biset B1

Theorem 4.14. The fundamental biset of a sphere tree of bisets YBX is a sphere
biset.
Proof. Let B be a sphere tree of bisets. We check that π1pBq satisﬁes Deﬁnition 2.5.
By [3, Corollary 3.21], the biset π1pBq is left free; and since each biset Bz is
right transitive so is π1pBq. This is (SB1).
Next we check (SB3). Write B “ pY, Pq b B1 as in (11). By Lemma 4.11 the
set of vacant conjugacy classes in X and in P are naturally identiﬁed. Let Γ be
a vacant conjugacy class in P, say in Pz. Since B1
z is a sphere biset, Γ appears
exactly once in the multiset of all lifts of all vacant peripheral conjugacy classes of
Gρpzq.

We check (SB3) by a counting argument. A cycle c as in (5) is critical of
multiplicity lengthpcq ´ 1 if lengthpcq ą 1. Let d be the degree (i.e. the number of
left orbits) of π1pBq. We show that the number, counting multiplicity, of all critical
cycles associated with vacant peripheral classes in B is 2d´ 2. Let n be the number
of sphere vertices in X and m be the number of sphere vertices in B. Then the
number of curve vertices in X and in B is n ´ 1 and m ´ 1 respectively. We also
note n ď m ă dn.
Consider a sphere vertex x P X. Then the number of critical cycles in \zPρ´1pxqBz
that are associated with all peripheral classes of Gx is equal to 2pd´#pρ´1pxqqq. By
taking the sum over all sphere vertices x P X we see that the number of all critical
cycles in B that are associated with all peripheral classes of all sphere groups in X
is equal to 2pdn´ mq. From this number we will now subtract the number of whose
critical cycle that are associated with non-vacant peripheral classes.
Consider a curve vertex x P X; in two neighbouring sphere vertices, say v and
v1, there are exactly two non-vacant peripheral conjugacy classes, say Γ and Γ1,

SPHERE BISETS AND THEIR DECOMPOSITIONS

25

deﬁned by embedding Gx into Gv and into Gv1 . The number of critical cycles in
\zPρ´1pxqBz that are associated with Γ and Γ1 is equal to 2pd´ #pρ´1pxqqq. Taking
the sum over all curve vertices x P X, we get 2pdpn ´ 1q ´ m ` 1q. Finally,

2pdn ´ mq ´ 2pdpn ´ 1q ´ m ` 1q “ 2d ´ 2,

(cid:3)

which is (SB3).

Corollary 4.15. Let YBX be a sphere tree of bisets. Write Y as the sphere tree of
groups associated with pS2, C, Dq and associate similarly X with pS2, A, Cq. Then
there exists a sphere map f : pS2, C, Dq Ñ pS2, A, C q, unique up to isotopy rel
C Y D, whose graph of bisets is isomorphic to B.
Proof. Follows from Theorems 4.14, 2.7 and 3.10.
4.6. The dynamical situation. In the dynamical situation in which A “ C and
C “ D, we have a Thurston map f : pS2, A, Cq ý with an invariant multicurve C .
We then also have dynamics f : S ý on the set S of small spheres of S2zC . We
deﬁne the set of return maps, also called small Thurston maps,

(cid:3)

Rpf, Cq :“ tf e : S ý | S P S , f epSq “ S with e minimalu.

Similarly algebraically, in the dynamical situation in which G “ H and C “ D,
we have a biset GBG with an invariant multicurve C . Let us denote by XBX the
tree of bisets decomposition of B, and by V the set of sphere vertices of X, with
essential biset Bv corresponding to v P V , as given by Lemma 4.3. We deﬁne the
set of return bisets, also called small Thurston bisets,
(12)
RpB, Cq :“ tBv b BB˚pvq b ¨¨¨ b BBe´1
˚pvq “ v with e minimalu,
namely the bisets obtained by following a cycle in the tree of bisets into which B
decomposes. By Lemma 4.8 all bisets in RpB, Cq are sphere bisets.
4.7. Distinguished conjugacy classes. Let pS2, Aq be a marked sphere, and let
C be a multicurve. It is often convenient to treat similarly the conjugacy classes
describing elements of A and of C . Consider X a sphere tree of groups. The set of
distinguished conjugacy classes X of X is the set of all peripheral conjugacy classes
of all vertex groups with two conjugacy classes identiﬁed if they are related by an
edge. Equivalently, if X is the tree of groups decomposition of pS2, A, Cq, then X
is in bijection with A Y C . Note that the set of geometric edges of X is naturally a
subset of the distinguished conjugacy classes.

ý | v P V, Be

˚ pvq

Algorithm 4.16. Given X and Y two sphere trees of groups with distinguished
conjugacy classes X and Y , and given a bijection h : X Ñ Y ,
Decide whether h : X Ñ Y promotes to a conjugator I from X to Y, and if so
construct I as follows:

(1) Check whether h restricts to an isomorphism between the geometric edge

sets of X and Y. If not return fail.

(2) Check whether the isomorphism between the edge sets promotes into a

graph-isomorphism h : X Ñ Y. If not, return fail.
(3) For a vertex v P X let Γv Ă X be the set of peripheral conjugacy classes
of Gv. Check whether hpΓvq “ Γhpvq for all vertices v P X. If not, return
fail.

26

LAURENT BARTHOLDI AND DZMITRY DUDKO

(4) For every vertex v P X choose an isomorphism φpvq : Gv Ñ Ghpvq compat-
ible with h : Γv Ñ Γhpvq. For every edge e P Y choose an isomorphism
φpeq : Ge Ñ Ghpeq.

(5) Set

I :“ X, λ :“ 1, ρ :“ h, Bz :“ Ghpzq

for z P I;

the left action of Gz on Bz is via φpzq, the right action is natural, and the
inclusion of Be into Be´ is via 1 ÞÑ g, for any g P Ghpzq with pqg ˝ φpeq “
φpe´q, if we identify Ge with a subgroup of Ge´ .

Let XBX and YCY be two sphere trees of bisets. If I be a conjugator between

X and Y, then

pCqI :“ I b C b I_

is an X-graph of bisets. Recall from §6.2 the notations ModpXq and MpBq.
Algorithm 4.17. Given XBX and XCX two X-graphs of bisets,
Decide whether C P MpBq, and if so construct M, N P ModpXq such that
C – M b B b N as follows:

(1) Try to construct an isomorphism of graphs h : B Ñ C mapping essential
vertices into essential vertices such that λpzq “ λ˝ hpzq and ρpzq “ ρ˝ hpzq
for every z P B.
If h does not exist, then return fail. Otherwise h is
uniquely deﬁned.

(2) For every essential vertex z P B try to ﬁnd Mλpzq P ModpGλpzqq and
Nρpzq P ModpGρpzqq such that MλpzqbBzbNρpzq – Cz. If such Mλpzq, Nρpzq
do not exist, return fail.

(3) Set M, N to be X as graphs. For all vertices v P M, w P N set

Bv :“ Mv and Bw :“ Nw.

(4) Adjust embeddings of edge bisets, as in Algorithm 4.16, such that C –

M b B b N.

5. Extensions of bisets

This section explains how algorithmic problems on bisets, and in particular,
conjugacy and computation of centralizers can be carried from sub-bisets to an
extension.

We place ourselves in an abstract setting of group actions. Since a G-H-biset is
nothing more than a pG ˆ Hq-set under the rule pg, hq ¨ b “ g ¨ b ¨ h´1, we consider
left G-sets in this section.
Let G be a group, let GB be a left G-set, and let φ : H Ñ G be a group homo-
morphism. The following two decision problems for pφ, GBq will be of importance
in this section:
The orbit problem: Given b1, b2 P B, does there exist h P H with hφ ¨ b1 “
The stabilizer problem: Given b P B, compute Hb :“ th P H | hφ ¨ b “ bu.
Typically, G and H will have ﬁxed generating sets, and B will be transitive, hence
of the form Gb0 for some b0 P B ﬁxed once and for all. We make this more precise
as follows: we are given a class Ω of groups, thought of as “computable” groups.
They should be ﬁnitely generated, and have solvable word problem, i.e. for each

b2? If so, ﬁnd one.

SPHERE BISETS AND THEIR DECOMPOSITIONS

27

G P Ω there is an algorithm that, given g, h P G as words in a generating set for G,
determines whether or not g “ h. We assume G and H belong to Ω.
We say that the orbit problem is solvable if there is an algorithm that, upon
receiving b1, b2 P B as input, answers whether there exists an h P H with hφb1 “ b2,
and if so produces one. The elements b1, b2 will be given as g1b0, g2b0 for words
g1, g2 in the generating set of G, and h, if it exists, will be returned as a word in
the generators of H.

We say that the stabilizer problem is solvable if there is an algorithm that, upon
receiving b P B as input, computes the stabilizer Hb as an element of Ω, with an
explicit embedding into the original H. The stabilizer problem is sub-solvable if
there is an algorithm that returns a group ˜H P Ω, an embedding ˜H ãÑ H, and
a homomorphism χ : ˜H Ñ A to a ﬁnitely generated abelian group A, such that
Hb “ kerpχq.
Note that the orbit problem could be reduced to the stabilizer problem as soon
as the class Ω is closed under taking products and ﬁnite extensions. More precisely,
consider an orbit problem D?h P H : hφ¨ b1 “ b2 on a G-set B. Consider the wreath
product G1 :“ G ≀2Ó. acting naturally on Bˆ B, with Gˆ G acting co¨ordinatewise on
BˆB and 2Ó. acting by permuting the factors of BˆB. Deﬁne φ1 : H 1 :“ H ≀2Ó. Ñ G1
pb1,b2q of pb1, b2q is computable in H 1, then original orbit
naturally. If the stabilizer H 1
problem is solvable: b1 and b2 are in the same orbit if and only if some generator of
H 1
pb1,b2q permutes both copies of B; and a witness h to the orbit problem is easily
obtained from this generator. We elected not to make use of this reduction, treating
the orbit problem as an illustrative step.

5.1. Extensions of G-sets. Let GB be a left G-set and let N be a normal sub-
group of G. We have a short exact sequence of groups

(13)

1 ÝÑ N ÝÑ G

πÝÑ G{N ÝÑ 1.

The N -set N B is deﬁned to be B as a set, with the restricted action of N .
Let us denote by NzpGBq the set of connected components of N B; namely, its

space of N -orbits:

NzpGBq :“ B{tb1 „ b2 if and only if b1 “ nb2 for some n P Nu.

We denote by π : GB ։ NzpGBq the induced quotient map. The action of G{N on
NzpGBq is given by

gπ ¨ bπ “ pgbqπ.

It is straightforward to verify that NzpGBq is a G{N -set. We will call the sequence
(14)

π

N B ãÑ GB

։ NzpGBq

an extension of G-sets.

5.2. Orbit and stabilizer problems in G-sets. We consider a class Ω of “com-
putable” groups as above. The main step in our programme to reduce decision
problems on extensions to decision problems on kernel and quotient is contained in
the following

Proposition 5.1. Let GB be a G-set, let N be a central subgroup of G, let

N

ι

ãÑ G

π

։ G{N

and

N B ãÑ GB

π

։ NzpGBq

28

LAURENT BARTHOLDI AND DZMITRY DUDKO

be the corresponding extensions of groups and sets respectively, and let φ : H Ñ G
be a group homomorphism. Assume that H, N, G all belong to Ω, and that the orbit
and stabilizer problems are solvable in pι, GBq.

Then there is an algorithm that, given
— elements b1, b2 P B such that bπ
— an element h P H such that bπ
— the stabilizer of bπ

1 and bπ
1 “ phφb2qπ;

1 as a subgroup of H that belongs to Ω,

2 are in the same orbit of NzpGBq;

determines whether b1, b2 belong to the same orbit of GB, and computes their sta-
bilizers as kernels of maps χ : ˜H Ñ A for ˜H ď H belonging to Ω and A a ﬁnitely
generated abelian group.
In particular, if the orbit and stabilizer problems are solvable in pφπ, NzpGBqq

and in pι, GBq, then they are sub-solvable in pφ, Bq.
Proof. We start by the orbit problem in pφ, GBq, and consider b1, b2 P B and h1 P H
1 “ pph1qφb2qπ. Since the orbit problem is solvable in pι, GBq, an element
with bπ
a1 P N is computable such that b1 “ a1ph1qφb2, and it remains to ﬁnd whether a1
may be chosen in H φ.
1 and the stabilizer
Nb1 “ ta P N | ab1 “ b1u of b1; both are computable. Consider the homomorphism

1 “ th P H | phφb1qπ “ bπ

Consider the stabilizer Hbπ

1u of bπ

χ : Hbπ

1 Ñ N Gb1{Gb1 – N{Nb1 .

It is computable: the quotient N{Nb1 is computable as a quotient of ﬁnitely gen-
erated abelian groups, and for each h P Hbπ
1 there is a computable a P N with
hφb1 “ ab1, for which hχ “ aNb1 .
We return to the equation b1 “ a1ph1qφb2. The orbit problem has a positive
1 with hχ “ a1Nb1, in which case b1 “
solution if and only if there exists h P Hbπ
phh1qφb2, and this is a decidable problem since it takes place in N{Nb1.
Furthermore, the stabilizer of b1 is the kernel of χ; so the stabilizer problem for
pφ, Bq is sub-solvable.
(cid:3)

We remark that the stabilizer cannot be better written than as kernel of map to
some abelian group; in particular, it can be inﬁnitely generated, and therefore not
directly describable by itself, see §8.3.

5.3. Extensions of left-free bisets. A G1-G2-biset is a pG1ˆG2q-set with a ﬁxed
decomposition of G1 ˆ G2 as a product of G1 and G2. Namely, if G1 BG2 is a biset,
then the associated pG1 ˆ G2q-set G1ˆG2 B is deﬁned by
(15)
In the inverse direction, if G1 ˆ G2 acts on B, then the G1- and G2-actions on B
commute and (15) deﬁnes a G1-G2-biset structure on B.
If N1, N2 are normal subgroups of G1, G2 respectively, then the N1-N2-biset
N1 BN2 and the quotient G1{N1-G2{N2-biset N1zpG1 BG2q{N2 are deﬁned as for
G-sets using (15).

pg1, g2q ¨ b “ g1bg´1
2 .

Deﬁnition 5.2 (Extensions of bisets). Let G1 BG2 be a G1-G2-biset and let N1, N2
be normal subgroups of G1 and G2 respectively, so that for i “ 1, 2 we have short
exact sequences

(16)

1 ÝÑ Ni ÝÑ Gi

πÝÑ Qi ÝÑ 1.

SPHERE BISETS AND THEIR DECOMPOSITIONS

29

If the quotient Q1-Q2-biset N1zB{N2, consisting of connected components of N1 BN2,
is left-free, then the sequence

(17)

N1 BN2 ãÑ G1 BG2
is called an extension of left-free bisets.

π

։ Q1pN1zB{N2qQ2

The following statement follows directly from Deﬁnition 5.2.

△

Proposition 5.3. Let G1 BG2 be a left-free G1-G2-biset and let N1, N2 be normal
subgroups of G1, G2 respectively.

Then the sequence (17) is an extension of left-free bisets if and only if the fol-

lowing property holds:

if g1 P G1, n2 P N2, b P B, and g1bn2 “ b, then g1 P N1.

(cid:3)

Example 5.4. A natural source of examples of bisets extensions appears as follows.
Consider for i “ 1, 2 path-connected topological bundles

(18)

Fi

Ei

pi

Xi

with path-connected ﬁbres; ﬁx basepoints ˚i P Fi Ď Ei, so Fi “ p´1
i ppip˚iqq.
Consider the fundamental groups Ni “ π1pFi,˚iq, Gi “ π1pEi,˚iq and Qi “
π1pXi, pip˚iqq. Then we have short exact sequences of groups Ni ãÑ Gi ։ Qi
provided that the connecting homomorphisms βi : π2pXiq Ñ Ni are trivial (alterna-
tively we may deﬁne Ni as π1pFi,˚iq{βipπ2pXiqq). Let there also be given a bundle
partially-deﬁned covering map pf : E1 99K E2, g : X1 99K X2q, with p2 ˝ f “ g ˝ p1.
Recall (as in (4))

(19)

Bpfq “ tβ : r0, 1s Ñ E1 | βp0q “ ˚1, fpβp1qq “ ˚2u{ «.

We then have a short exact sequence of bisets

N1 BpfqN2 ãÑ G1 BpfqG2

։ Q1pN1zBpfq{N2qQ2 ,

which are all left-free by Proposition 5.3, since for every loop in a ﬁbre F2 its f -lifts
are all conﬁned to ﬁbres. Furthermore,

Lemma 5.5. Suppose that p´1
2 pfpyqqq has a single path connected
component. Then the natural map β ÞÑ p1 ˝ β deﬁnes a Q1-Q2-biset isomorphism
–ÝÑ Bpgq.

1 pyq X f ´1pp´1

N1zBpfq{N2

Proof. Clearly, β ÞÑ p1 ˝ β deﬁnes an epimorphism; we need to show that is is also
injective. Consider β, β1 P Bpfq with p1 ˝ β « p1 ˝ β1. Then β, β1 ends at the same
ﬁber F 1 of p1 : E1 ։ X1. We may choose n P N2 such that β “ β1n2. Finally there
exists an n1 P N1 such that n1βn2 “ β1 (because p1 ˝ β « p1 ˝ β1).
Let GBG be a G-biset. We consider the following decision problems in B:

(cid:3)

g ¨ b1 “ b2 ¨ g? If so, ﬁnd one.

The conjugacy problem: Given b1, b2 P B, does there exist g P G with
The centralizer problem: Given b P B, compute
Zpbq :“ tg P G | g ¨ b “ b ¨ gu.

30

LAURENT BARTHOLDI AND DZMITRY DUDKO

Note that conjugacy and centralizer problems in bisets are special cases of the orbit
and stabilizer problems in G-sets, using (15) with H “ G and φ : H Ñ G ˆ G
given by gφ “ pg, gq. We will use the same conventions for conjugacy and stabilizer
problems in bisets as for orbit and stabilizer problems in G-sets.

6. Mapping class groups and mapping class bisets

First, we recall basic properties of mapping class groups (for more details, see [15]

and [18]) and the solution of the conjugacy problem in mapping class groups.
6.1. Mapping class groups. Consider a marked sphere pS2, Aq, with A the set
of marked points, and a multicurve C Ă pS2, Aq, see §3.1. Let
‚ ModpS2, Aq be the pure mapping class group of pS2, Aq; it is the set of
‚ ModpS2, A, Cq be the maximal subgroup of ModpS2, Aq that ﬁxes each
‚ eModpS2, A, C q be the subgroup of ModpS2, A, Cq generated by Dehn
‚ vModpS2, A, Cq be the pure mapping class group of pS2, AqzC .

homeomorphisms h : S2 ý which ﬁx A, considered up to isotopy rel A;

curve of C up to isotopy;

Their meaning is the following: Mod is the classical mapping class group, ﬁxing a
marked set and possibly a multicurve. We remark that ModpS2, Aq could equally
well have been deﬁned as homotopy classes of homeomorphisms, see [14, §6]. eMod
is the group of mapping classes that act only on edges of the decomposition of S2
along C . Similarly, vMod is the group of mapping classes that act disjointedly on
vertices of the decomposition of S2 along C .

twists around C ;

It is known [15, Lemma 3.11] that eModpS2, A, Cq is isomorphic to Z#C and is
in the center of ModpS2, A, Cq. Furthermore, there is a central exact sequence of
groups

(20)

1 ÝÑ eModpS2, A, C q

ιÝÑ ModpS2, A, C q πÝÑ vModpS2, A, C q ÝÑ 1

which is easily seen to be split, see [15, Proposition 3.20].
Theorem 6.1 (Nielsen [28], Thurston [32]). Every homeomorphism f : pS2, Aq ý
may be isotoped to a homeomorphism g : pS2, Aq ý that either

‚ is periodic;
‚ preserves a multicurve on pS2, Aq (in this case, g is called reducible); or
‚ is pseudo-Anosov.

A pseudo-Anosov homeomorphism is never periodic nor reducible.

(cid:3)

Furthermore, there are algorithms, such as “train track” technology (see [8]) that
determine to which class f belongs, and compute the multicurve along which f can
be reduced.

Let Cf be the minimal multicurve that is invariant by f and such that all periodic
components of f : pS2, AqzC ý are, up to isotopy, either pseudo-Anosov or of ﬁnite
order. The multicurve Cf is unique, so f belongs to ModpS2, A, Cfq because a
mapping class permuting non-trivially a multicurve must also permute the marked
points.

The following algorithm solves the conjugacy problem under ModpS2, Aq for
homeomorphisms f, g : pS2, Aq ý. The problem of combinatorial equivalence be-
tween homeomorphisms pS2, Aq ý reduces to the pure case because the non-pure

SPHERE BISETS AND THEIR DECOMPOSITIONS

31

mapping class group of pS2, Aq is a ﬁnite extension of ModpS2, Aq. The exten-
sion of this algorithm to non-invertible maps is the main outcome of this series of
articles.
Algorithm 6.2. Given homeomorphisms f, g : pS2, Aq ý,
Compute whether they are conjugate by ModpS2, Aq, and compute the central-
izer of f in ModpS2, Aq as follows:

(1) Compute the canonical multicurves Cf , Cg. They may be constructed e.g.

using the Bestvina-Handel “train track” algorithm [8].

(2) Check whether there is an h P ModpS2, Aq such that h conjugates g : Cg ý
to f : Cf ý.
If h does not exist, then f and g are not conjugate by
ModpS2, Aq. Otherwise choose one such h (all such h diﬀer by post-
composition by elements in ModpS2, A, Cfq) and replace g by gh. Then
Cf “ Cg “: C and the conjugacy problem for f, g under ModpS2, Aq and
under ModpS2, A, Cq are equivalent.
(3) Check whether the projections πpfq, πpgq P vModpS2, A, Cq are conjugate
under vModpS2, A, Cq. Every periodic component of πpfq and πpgq is
either of ﬁnite order or pseudo-Anosov; and in both of these cases the
conjugacy and centralizer problems are solvable, see [18].

If the projections are conjugate, choose an element q P ModpS2, A, Cq
such that πpfq “ πpgqq. Since eModpS2, Aq belongs to the centre of
ModpS2, A, Cq, the rotation parameter f ´1gq P eModpS2, A, Cq does not
depend on the choice of q.
(4) The maps f, g are conjugate under ModpS2, A, C q if and only if f ´1gq is
the identity in eModpS2, A, Cq, and a conjugator is for example q.
(5) The centralizer Zpfq is a subgroup of ModpS2, A, Cq, and we describe it
in terms of (20). Its intersection with eModpS2, A, Cq – ZC is easy to
it consists of those maps C Ñ Z that are constant on every
compute:
f -orbit in C .

then zfi

these is pure.

of f to the small spheres; they are all easily computable.

Elements of Zpfq must be constant on orbits of small spheres in the
i “ zi`1, indices again read modulo n. Compute the return map
of ﬁnite order or pseudo-Anosov, and this can be determined by checking
if pf 1qe “ 1 for the smallest e such that pf 1qe is pure. Suppose that f 1
with up to two extra punctures corresponding to the centres of rotation of

Consider next the image of Zpfq in vModpS2, A, Cq. Let pS0,pS1 :“
fppS0q, . . . ,pSn “ pS0 be a cycle of small spheres under πpfq; for simplicity,
write fi : pSi Ñ pSi`1, with indices computed modulo n, for the restrictions
sense that, if zi : pSi ý are the co¨ordinates of an element centralizing f ,
f 1 “ f0f1 . . . fn´1 : pS0 ý. Then, by our assumption, the map f 1 is either
is of ﬁnite order. Consider the quotient surface pS0{f 1; it is also a sphere,
f 1. Then Zpf 1q is isomorphic to a ﬁnite-index subgroup of ModppS0{f 1q:
every z0 P Zpf 1q projects via pS0 Ñ pS0{f 1 to an element in ModppS0{f 1q,
and conversely every h P ModppS0{f 1q lifts to e possibly non-pure mapping
classes commuting with f , namely rh, frh, . . . , f e´1rh, and at most one of
appear in [6]. Since f 1 preserves transverse foliations on pS0, its centralizer

Let us now brieﬂy consider the case that f 1 is pseudo-Anosov; details will

32

LAURENT BARTHOLDI AND DZMITRY DUDKO

coincides with its radical, ?f 1 “ tz P ModppS0q | Dk, ℓ ‰ 0 with zk “ pf 1qℓu.
dimensional submanifold with forks on pS0, such that f 1 and in fact all

The map f 1 admits a train track representation, namely there exists a 1-
elements of ?f 1 may be represented by non-negative integer labellings of
the train track subject to some arithmetic conditions. It follows that ?f 1
is a cyclic subgroup, and since the numbers on the train track increase
upon taking powers, a generator of ?f 1 may be found by enumerating all
labellings with numbers less than those of f 1 to ﬁnd a minimal root of f 1.
6.2. Mapping class bisets. We now turn to maps of degree ą 1. Kameyama
introduced in [20]§4 a semigroup containing ModpS2, Aq,

KpS2, Aq “ tThurston maps pS2, Aq ýu{ «

and derives some important properties. Clearly KpS2, Aq is a ModpS2, Aq-biset,
under pre- and post-composition of Thurston maps. It is a graded semigroup under
the map deg : KpS2, Aq Ñ N˚, and is ﬁnitely generated in every degree.
We will need the more general situation aﬀorded by non-dynamical maps, i.e.
maps with diﬀerent domain and range. Let therefore f : pS2, Cq Ñ pS2, Aq be a
sphere map, and let D, C be multicurves on S2zC, S2zA respectively with D Ď
f ´1pC q.
Deﬁnition 6.3 (Mapping class bisets). The ModpS2, Cq-ModpS2, Aq-biset Mpf, C, Aq
is deﬁned as

Mpf, C, Aq “ tm1f m2 | m1 P ModpS2, Cq, m2 P ModpS2, Aqu{ «.

It admits as a subbiset the ModpS2, C, Dq-ModpS2, A, Cq-biset

Mpf, C, A, D, C q “ tm1f m2 | m1 P ModpS2, C, Dq, m2 P ModpS2, A, C qu{ «.

The left and right actions are given by m1f m2 “ m2 ˝ f ˝ m1, in keeping with using
the algebraic order of operations in bisets.

△
In case G “ π1pS2zA,˚q is a sphere group, we write ModpGq for ModpS2, Aq;
by Theorem 2.3, it is a subgroup of the outer automorphism group of G, and is
deﬁned algebraically in terms of G and its peripheral conjugacy classes. If X be a
sphere tree of groups, we denote by ModpXq its group of pure self-congruences, so
that if C is a multicurve on pS2, Aq then ModpXq – ModpS2, A, Cq for the tree
of groups decomposition X of G along C . Similarly, we write

KpGq “ tG-G-bisetsu{ –

for the ModpGq-biset isomorphism classes of bisets of Thurston maps pS2, Aq ý,
which by Theorem 2.7 is in bijection with KpS2, Aq.
If B be a sphere H-G-biset, then by MpBq we denote the ModpHq-ModpGq-
biset

MpBq “ tBψ b B b Bφ | ψ P ModpHq, φ P ModpGqu{ –.

By Theorem 2.7, for a sphere map f : pS2, Cq Ñ pS2, Aq the bisets Mpf, C, Aq and
MpBpfqq are isomorphic, so Mpf, C, Aq can also be viewed as the biset of isomor-
phism classes of bisets of the form Bpm1qbBpfqbBpm2q with m1 P ModpS2, Cq, m2 P
ModpS2, Aq,

Similarly, if B be an Y-X-tree of bisets, we deﬁne

MpBq “ tN1 b B b N2 | N1 P ModpYq, N2 P ModpXqu{ –,

SPHERE BISETS AND THEIR DECOMPOSITIONS

33

and note that for a sphere map f : pS2, C, Dq Ñ pS2, A, C q the bisets Mpf, C, A, D, Cq
and MpBpfqq are isomorphic. This may be seen in a manner that makes more
explicit the tree of bisets decomposition of f : let YBX be the tree of bisets decom-
position of f . Every element b P Mpf, C, A, D, Cq is encoded by a well-deﬁned tree
of bisets YCX over the same trees of groups Y, X; so Mpf, C, A, D, Cq is the biset
of isomorphism classes of such trees of bisets.

6.2.1. Properties of Mapping class bisets.
Proposition 6.4 (An extension of [20, Proposition 4.1]). The bisets Mpf, C, Aq
and Mpf, C, A, D, C q are left-free.
Proof. The second claim obviously follows from the ﬁrst. Consider g P Mpf, C, Aq
and m P ModpS2, Cq with mg “ g. We use the same letters g, m to denote a
representative Thurston map and homeomorphism respectively; so g and g ˝ m are
isotopic along an isotopy ﬁxing C. Lifting the isotopy from g to g˝m gives g “ g˝m1
for some homeomorphism m1 isotopic to m. We wish to show that m1 is isotopic to
the identity.

Consider a path γ : r0, 1s Ñ S2zA with γp0q P A, possibly a critical value; and
consider its g-preimages γ1, . . . , γd. They are permuted by m1, in the sense that
m1 ˝ γi P tγ1, . . . , γdu, so there exists e P t1, . . . , du such that pm1qe ˝ γ1 “ γ1
and in particular pm1qepγ1p1qq “ γ1p1q. This continues to hold as γ1 is deformed,
and γ1p1q is arbitrary, so pm1qe “ 1, and m1 being of ﬁnite order is isotopic to a
M¨obius transformation by Theorem 6.1. If #C ě 3, we are done since a M¨obius
transformation ﬁxing three points is trivial, while if #C “ 2 then m1 is isotopic
to a rotation on a sphere with two marked points, and again is isotopic to the
identity.
(cid:3)

Example 6.5. Let us note that the non-pure version of the mapping class biset
needs not be left-free; here is the simplest example. Consider the sphere map fpzq “

z2 : ppC,t´1, 1uq Ñ ppC,t0, 1,8uq. The non-pure mapping class group Mod˚ppC,t´1, 1uq
of ppC,t´1, 1uq consists of two elements 1, z Ñ ´z. Since z2 ˝ rz Ñ ´zs “ z2 the
left action of Mod˚ppC,t´1, 1uq on tfu is trivial.

We extract, out of a left-free biset, relevant information from which a basis of

mapping class bisets can be constructed.

Deﬁnition 6.6 (Distillations). Let G be a sphere group with ﬁxed Hurwitz gener-
ators γ1, . . . , γn. Let H BG be a sphere biset, and choose a basis S of B. Consider
the wreath map associated with S, see [3, §2.5]: the map Φ : G Ñ H ≀ SÓ. such that
s ¨ g “ h ¨ t if Φpgq “ !¨¨¨ , h,¨¨¨"π with sπ “ t and the ‘h’ in position s.

is either trivial or a peripheral conjugacy class in H. We call the collection Φ “
Note that we consider distillations up to the diagonal action by conjugation by a
permutation of S, since the set S is not assumed ordered. Note also that there are
ﬁnitely many distillations, since there are ﬁnitely many choices for the permutations

Write Φpγiq “ !hi,1, . . . , hi,d"πi. For each cycle Ci,j of πi, let yhi,j be the
conjugacy class, in H, of the product of the hi,k along the cycle. Then each yhi,j
tπi,yhi,ju the distillation of Φ.
πi and the conjugacy classes yhi,j. Furthermore, all peripheral conjugacy classes
appear exactly once among the yhi,j, by Deﬁnition 2.5(SB3).

△

34

LAURENT BARTHOLDI AND DZMITRY DUDKO

Lemma 6.7. Let MpB0q be the mapping class biset of a sphere biset HpB0qG, and
consider a biset B P MpB0q, with wreath recursion Φ. Then the distillation Φ
depends only on B, and is called the distillation B of B.
Let B, C P MpB0q be bisets. Then B “ C if and only if B, C belong to the same

left orbit of MpB0q.
Proof. For the ﬁrst statement, the multiset of lifts, and the monodromy actions of
the Hurwitz generators, are invariants of B.

For the second claim, let Φ, Ψ be wreath recursions of B, C respectively. If Φ “ Ψ
then they have the same permutations πi, up to relabelling, and therefore the same
cycles Ci,j . Let h1
i,j be the product of the entries of Φpγiq along the cycle Ci,j and
let h2
i,j be the product of the entries of Ψpγiq along the same cycle Ci,j, in the same
order. Then h1
i,j extends
to an automorphism of H, because the only relation in H is that the product of
the h1
i,j, in the same order,
is also trivial. This automorphism is-deﬁned up to inner automorphisms. Since it
preserves the peripheral conjugacy classes, it deﬁnes an element m1 P ModpHq,
again by Theorem 2.3, and we have Ψ “ Φpm1 ˆ ¨¨¨ ˆ m1q, so B “ mC.

i,j, in some order, is trivial, and the product of the h2

i,j are conjugate for each i, j, and the map h1

i,j ÞÑ h2

i,j and h2

Conversely, if B “ mC for m P ModpHq then obviously B “ C.

(cid:3)

Proposition 6.8 (Essentially [22, Proposition 3.1]). The biset Mpf, C, Aq has
ﬁnitely many left ModpS2, Cq-orbits, and the biset Mpf, C, A, D, C q has ﬁnitely
many left ModpS2, C, Dq-orbits.
Proof. For the ﬁrst claim, choose a basis S of Bpfq, write G “ π1pS2zA,˚q and
H “ π1pS2zC,:q, and B0 “ Bpfq. The claim then follows from Lemma 6.7.
The second statement follows from the ﬁrst: since the right action of ModpS2, Aq
is transitive on 1 b Mpf, C, Aq, this last set is of the form NzModpS2, Aq for a
ﬁnite-index subgroup N ď ModpS2, Aq. Then 1 b Mpf, C, A, D, C q is isomor-
phic, qua right ModpS2, A, C q-set, to pN X ModpS2, A, CqqzModpS2, A, C q, and
rModpS2, A, C q : N X ModpS2, A, Cqs ď rModpS2, Aq : Ns ă 8.

(cid:3)

The biset Mpf, C, A, D, Cq restricts to an eModpS2, C, Dq-eModpS2, A, Cq-
biset, which furthermore encodes the Thurston matrix of f , namely the map Tf,C
from §3.2.
Proposition 6.9. Assume D “ f ´1pC q and consider g P Mpf, C, A, D, C q. If e P
eModpS2, A, Cq and m P ModpS2, C, Dq satisfy ge “ mg, then m P eModpS2, C, Dq.
Furthermore, identify eModpS2, A, Cq with ZC and eModpS2, A, Dq with ZD
by writing these groups as generated by Dehn twists. If ge “ mg, then we have
m “ Tf,Cpeq.
Proof. Suppose m R eModpS2, C, Dq. Then there is a small sphere U in S2zD

such that the restriction of m to pU , call it pm P ModppUq, is non-trivial. As in
Deﬁnition 4.9, denote bypg : pU Ñ pS the small sphere map induced by g. By Propo-
sition 6.4 we havepg ‰ pmpg, and this contradictspg “ pge.

Denote by d the degree of f . Clearly, m “ Tf,Cpeq if and only if md! “ Tf,Cped!q,
Consider a curve γ P C and its (possibly isotopic) preimages δ1, . . . , δm mapping
to γ with degrees d1, . . . , dm respectively. Then the d!-th power of a Dehn twist
about γ lifts to the product, for i “ 1, . . . , m, of d!{di-th powers of Dehn twists

since Tf,C is a linear operator on free abelian groups.

SPHERE BISETS AND THEIR DECOMPOSITIONS

35

about δi. For each peripheral or trivial curve δi, the corresponding Dehn twist is
trivial in eModpS2, C, Dq, while powers add for Dehn twists about isotopic curves.
We recover precisely (8).

(cid:3)

Consider two sphere maps f : pS2, Dq Ñ pS2, Cq and g : pS2, Cq Ñ pS2, Aq. Then
there is a natural epimorphism Mpfq b Mpgq ։ Mpf gq given by composition;
however this morphism needs not be injective, see §8.2.1.
Recall [3, §2] that to a group homomorphism φ : H Ñ G we associate the H-G-set

Bφ, which, qua right G-set, is plainly G; the left H-action is by

h ¨ b “ hφb.

Suppose that f : pS2, Cq Ñ pS2, Aq is a homeomorphism. Then it induces an iso-
morphism f˚ : ModpS2, Cq Ñ ModpS2, Aq and the biset Mpf, C, Aq is biprincipal
and is isomorphic to Bf˚ . A bit more general:
Lemma 6.10. Consider a sphere map f : pS2, Cq Ñ pS2, Aq of degree 1. Then
f induces the forgetful morphism f ˚ : ModpS2, Aq Ñ ModpS2, Cq so that f h “
f ˚phqf . The biset Mpf, C, Aq is isomorphic to B_
f ˚; it is a left principal and right
transitive biset.
(cid:3)

6.3. Computability of mapping class bisets. Propositions 6.4 and 6.8 point to
the fact that the mapping class biset Mpf, C, A, D, C q is computable. Let us make
this more precise.
Firstly, the group G “ π1pS2zA,˚q is computable, since it is a ﬁnitely generated
free group. The conjugacy problem is easy to solve in G — conjugacy classes
are just freely reduced words up to cyclic permutations — so multicurves C are
computable as collections of conjugacy classes.

Secondly, the biset Bpfq of a sphere map f : pS2, Cq Ñ pS2, Aq is computable,
since it is a left-free biset of degree d “ degpfq. All bisets of the form Bpfq will
be manipulated algorithmically by choosing a basis of cardinality d and working
with the wreath map Φ : G Ñ π1pS2zC,:q ≀ dÓ.. The decomposition of Bpfq along a
multicurve C is computable by Theorem 3.9.
Thirdly, the group ModpS2, Aq is computable, since by Theorem 2.3 it is a
subgroup of the outer automorphism group of G. Elements of ModpS2, Aq will be
manipulated algorithmically as maps G ý, by keeping track of their values on the
standard generators of G. The condition that a map on generators φ : γi ÞÑ wi, for
wi P G, deﬁnes an element of ModpS2, Aq is easy to check: since γ1 ¨¨¨ γn “ 1 we
must have w1 ¨¨¨ wn “ 1, and each wi must be conjugate to γi. It is equally easy
to check whether φ deﬁnes an element of a subgroup such as ModpS2, A, C q: the
corresponding automorphism of G must preserve the conjugacy classes in C .
Finally, the biset Mpf, C, Aq and its subbiset Mpf, C, A, D, C q are computable.

We express this, following Proposition 6.8, as an
Algorithm 6.11. Given f a sphere map pS2, C, Dq Ñ pS2, A, C q,
Compute the biset Mpf, C, A, D, C q as follows:

(1) Write G “ xγ1, . . . , γn | γ1 ¨¨¨ γny the fundamental group of S2zA, and
identify elements of C with conjugacy classes in G; similarly write H “
xδ1, . . . , δm | δ1 ¨¨¨ δmy.
(2) Choose a basis of Bpfq, and compute its wreath map Φ as a table with n
rows and d` 1 columns, with d “ degpfq, the 0th one being a permutation

36

LAURENT BARTHOLDI AND DZMITRY DUDKO

of t1, . . . , du and the remaining being the entries of Φpγiq, written as words
in the δj.
(3) Make a list of all distillations, see Deﬁnition 6.6: data structures consisting
of a list of n permutations π1, . . . , πn whose product is 1, up to the diagonal
action by conjugation by a permutation of t1, . . . , du, and for each cycle of
each πi of a conjugacy class P t1, δH
mu; for a wreath map Ψ, denote
by Ψ its distillation, obtained by computing the conjugacy class of product
of the entries along each cycle.

1 , . . . , δH

(4) View the mapping class group ModpS2, Aq as a group of automorphisms of
G, considered up to inner automorphisms. It is generated by Dehn twists
τi,j for all 1 ď i ă j ď n; the map τi,j conjugates γk by γi ¨¨¨ γj for all
k P ti, . . . , ju and ﬁxes the other generators.
(5) Start with X “ tΦu, the wreath map of f , and X “ tΦu. As long as there
exists a generator τi,j P ModpS2, Aq and a wreath map Ψ P X such that
τi,j Ψ R X, add τi,jΨ to X and add τi,jΨ R X to X.
(6) The set X is now a basis for Mpf, C, Aq, and the wreath map of Mpf, C, Aq
may be computed as follows. For each m P ModpS2, Aq and each Ψ P X,
let Ψ1 P X be such that Ψ1 “ mΨ. Write h1
i,j, for the
products of entries along the cycles of mΨ, Ψ1 respectively. Let m1 : H ý
be the automorphism of H deﬁned by h1
i,j ÞÑ h2
i,j; it may e.g. be normalized
by computing the images of the standard generators δk. Then the biset
Mpf, C, Aq is deﬁned by the equations Ψ ¨ m “ m1 ¨ Ψ1.
(7) The biset Mpf, C, A, D, C q is a subbiset of Mpf, C, Aq in the following way:
rather than saturating X under the action of all τi,j , only consider those
Dehn twists along simple closed curves that do not intersect C .

i,j, respectively h2

6.4. Extensions of mapping class bisets. Since we are mainly interested in the
dynamical situation of a Thurston map, let us abbreviate

Mpf, Aq :“ Mpf, A, Aq,

Mpf, A, Cq :“ Mpf, A, A, C , Cq.

Let us denote by eMpf, A, Cq the biset Mpf, A, C q with restricted actions, namely
the eModpS2, A, Cq-biset

eMpf, A, Cq :“ eModpS 2,A,C qMpf, A, C qeModpS 2,A,C q

and let us deﬁne the small mapping class biset vMpf, A, C q as the vModpS2, A, Cq-
biset of restrictions to S2zC as in Deﬁnition 4.9:
(21)

vMpf, A, C q :“ trestriction of g to pS2, AqzC : g P Mpf, A, Cqu.

It follows from Propositions 5.3, 6.4 and 6.9 that
(22)

π

eMpf, A, Cq ãÑ Mpf, A, C q

։ eModpS2, A, C qzMpf, A, Cq{eModpS2, A, C q

is an extension of left-free bisets. We describe it more concretely as follows. First,
we have the natural morphism

eModpS2, A, C qzMpf, A, Cq{eModpS2, A, C q Ñ vMpf, A, C q

(23)
which maps every g P Mpf, A, C q to its restriction to S2zC . This morphism is ﬁnite-
to-one, because both bisets are left-free and the source biset has ﬁnitely many left
orbits.

SPHERE BISETS AND THEIR DECOMPOSITIONS

37

Lemma 6.12. There is an algorithm with oracle that, out of a solution to the
conjugacy and centralizer problems in the range of (23), solves the conjugacy and
centralizer problems in the source of (23).
Proof. Let us denote by π the map (23). Consider g1, g2 P eModpS2, A, C qzMpf, A, Cq{eModpS2, A, C q
and their images gπ
are g1 and g2.

2 P vMpf, A, Cq. If gπ

2 are not conjugate, then neither

1 and gπ

1 , gπ

Otherwise, let h P vModpA, C q be such that hgπ

2 h. Then gh
1 . Furthermore, the centralizer of gπ

2 belongs to the
ﬁnite set F of π-preimages of gπ
1 is computable
and acts computably on F . The elements g1 and g2 are conjugate if and only if
they are in the same orbit under the action of Zpgπ
1 q, and the centralizer of g1
is the stabilizer of g1 in F under Zpgπ
1 q and is
computable.

1q, so it has ﬁnite index in Zpgπ

1 “ gπ

(cid:3)

Recall that Mpf, A, C q is naturally isomorphic to MpBq if B is the sphere tree
of bisets of f , see Deﬁnition 3.7. Similarly, eMpf, A, Cq and vMpf, A, C q can be
identiﬁed with eMpBq and vMpBq; for instance, (21) takes form
(24)

vMpBq :“ tessential bisets in Bu.

6.5. Decomposition of Mpfq. The operation implicit in (23) may be made more
explicit, both at the topological and algebraic levels; we return to the general (non-
dynamical) setting of f : pS2, C, Dq Ñ pS2, A, Cq with D “ f ´1pC q rel C. The
mapping class group Mod decomposes into a direct product of eMod and vMod,
see (20). Mapping class bisets encode non-invertible maps, and decompose similarly,
as we shall see below. Similarly to (21), (22), and (23) write

vMpf, C, A, D, C q :“ trestriction of g to pS2, AqzD : g P Mpf, C, A, D, C qu,
π : Mpf, C, A, C , Dq ։ eModpS2, C, DqzMpf, C, A, D, C q{eModpS2, A, C q,

(25)

σ : eModpS2, C, DqzMpf, C, A, D, C q{eModpS2, A, Cq Ñ vMpf, C, A, D, C q.

Lemma 6.13. With σ as in (25), there is a ﬁnite set S endowed with a right action
of vModpS2, A, Cq and there is a biset congruence

τ : eModpS2, C, DqzMpf, C, A, D, C q{eModpS2, A, C q Ñ 1SvModpS 2,A,C q

such that τ restricts to a bijection σ´1pbq Ñ S for every b P vMpf, C, A, D, C q. En-
dow S with the trivial left action of vModpS2, C, Dq. Then σˆτ is a vModpS2, C, Dq-
vModpS2, A, C q-biset isomorphism

eModpS2, C, DqzMpf, C, A, D, C q{eModpS2, A, C q – vMpf, C, A, D, C q ˆ S.

Proof. The set S is the set of restrictions of maps in eModpS2, C, DqzMpf, A, Cq{eModpS2, A, Cq
to all non-essential spheres of pS2, f ´1pAq, f ´1pC qq. More precisely, let YBpgqX be
the sphere tree of bisets of g P Mpf, C, A, D, C q, let τpBpgqq be B minus all its
essential sphere vertex bisets, and let σpBpgqq be the set of essential sphere bisets
in Bpgq.
rτpBpg1qq, σpBpg1qqs. We deﬁne S as the quotient of tτpBpgqq | g P Mpf, C, A, D, Cqu
by the right action of eModpS2, A, C q.

By construction, eModpS2, C, Dqg “ eModpS2, C, Dqg1 if and only if rτpBpgqq, σpBpgqqs “

(cid:3)

38

LAURENT BARTHOLDI AND DZMITRY DUDKO

Let

(26)

Hf :“ te P eModpS2, A, Cq | f e P eModpS2, C, Dqqfu

be the subgroup of liftable twists. Denote by Λ the biset of the virtual homomor-
phism Tf,C : eModpS2, A, Cq – ZC 99K ZD – eModpS2, C, Dqq with DompTf,Cq “
Hf ; the ZC -ZD -biset Λ may be viewed as the abelian group
Λ :“ ZD ˆ ZC{tpTf,Cpmq,´mq | m P Hfu

(27)
with natural actions. Since the action of eModpS2, C, Dq ˆ eModpS2, A, Cq on
Mpf, C, A, D, Cq commutes with the actions of vModpS2, C, Dq and of vModpS2, A, Cq,
the group Λ has a well deﬁned left action on Mpf, C, A, D, C q deﬁned by λ¨b “ mbn
if λ “ rpm, nqs with m P ZD – eModpS2, C, Dq and n P ZC – eModpS2, A, Cq.
We write the action of Λ on Mpf, C, A, D, C q as a left action because of the
Lemma 6.14. The action of Λ ˆ vModpS2, C, Dq on Mpf, C, A, D, C q is free.
Proof. The group Λ is deﬁned in such a manner that its action on Mpf, C, A, D, C q
is free. It follows from Proposition 6.9 that the combined action of ΛˆvModpS2, C, Dq
on Mpf, C, A, D, C q is free.
Remark 6.15. It may happen that Tf,Cpeq P ZD for some e P ZC that does not
correspond to a liftable element, i.e. e R Hf . In that case, there is no reason for the
equality Tf,Cpeqf “ f e to hold. However, some positive power of e is liftable: if f
have degree d, then Tf,Cped!qf “ f ed!.
It follows that the group Λ need not be free Abelian: the element pTf,Cpeq,´eq
has ﬁnite order in Λ if e P eModpS2, A, CqzHf and Tf,Cpeq P ZD .
Examples of maps for which this phenomenon occurs include maps f for which
Tf,C is integral but some curves in C have lifts of degree ą 1.

(cid:3)

Let

Gf :“ tm P vModpS2, A, Cq | f m P pΛ ˆ vModpS2, C, Dqqfu

(28)
be the group of liftable elements. Then for every m P Gf there is a unique
The group Λ as well as θf are computable using Algorithm 6.11; this is essentially
done in Proposition 6.17. We can also easily compute θf on the set of Dehn twists
in Gf by lifting the corresponding curves, see Example in §8.3. It is easy to see
that Gf is a subgroup of

pθfpmq,rmq P ΛˆvModpS2, C, Dq such that f m “ pθfpmq,rmqf holds in Mpf, C, A, D, C q.

tm P vModpS2, A, C q | σ ˝ πpfqm P vModpS2, C, Dqσ ˝ πpfqu.

Theorem 6.16. Consider a sphere map f : pS2, C, Dq Ñ pS2, A, C q, and the corre-
sponding mapping class bisets Mpf, C, A, D, Cq. Let vM0pfq :“ vModpS2, C, Dqσ˝
πpfqGf be the vModpS2, C, Dq-Gf -subbiset of vMpf, C, A, D, C q containing f ; let
Gf ď vModpS2, A, C q be the groups of liftable elements as in (28); and let Λ be the
eModpS2, C, Dq-eModpS2, A, C q ˆ Gf -Abelian biset of Tf,C : eModpS2, A, C q –
ZC 99K ZD – eModpS2, C, Dqq as above with the action of Gf given via θf .
Then Mpf, C, A, D, C q decomposes as

ModpS 2,C,DqpΛ ˆ vM0pfqqeModpS 2,A,C qˆGf b ModpS2, A, C q

by the map sending pm1, g1qfpm2, g2q to prpm1, m2qs, σpπpg1fqqq b g2. The actions
on pΛ ˆ vM0pfqq are given by

pm1, g1q ¨ pλ, gq ¨ pm2, g2q “ ppm1λm2θfpg2q, g1gg2q.

SPHERE BISETS AND THEIR DECOMPOSITIONS

39

Proof. View ﬁrst Mpf, C, A, D, C q as a pΛ ˆ vModpS2, C, Dqq-vModpS2, A, Cq-
biset. Since Mpf, C, A, D, C q is left-free, we have

Mpf, C, A, D, Cq – pΛ ˆ vModpS2, C, Dqqf Gf bGf vModpS2, A, Cq.

We then have a decomposition of Λ ˆ vModpS2, C, Dqf Gf as

eModpS 2,C,DqˆvModpS 2,C,DqpΛ ˆ vModpS2, C, DqπpfqGfqeModpS 2,A,C qˆGf

with vModpS2, C, DqπpfqGf viewed as a subbiset of eModpS2, C, DqzMpf, C, A, D, C q{eModpS2, A, Cq.
The biset vModpS2, C, DqπpfqGf is isomorphic to vM0pfq.
6.6. Conjugacy and centralizers in mapping class bisets. We are ready to
apply Proposition 5.1 to solving centralizer and conjugacy problems in Mpf, A, Cq.
We consider as class Ω of “computable” groups all ﬁnite direct products G1ˆ¨¨¨ Gn
of groups Gi which are all ﬁnite-index subgroups of modular groups ModpS2, Ai, Ciq.
Note that Ω contains pure mapping class groups, cyclic groups (as mapping class
groups of a sphere with four marked points separated by a curve) and SL2pZq (as
the mapping class group of a sphere with four marked points). Note in particular
that all groups in Ω are ﬁnitely presented and have solvable word and conjugacy
problem.

(cid:3)

Proposition 6.17. Consider the extension of bisets (22) and the natural mor-
phism (23). Then there is an algorithm, with oracle solving the conjugacy and
centralizer problems in vMpf, A, Cq, by which the conjugacy problem is solvable in
Mpf, A, Cq and the centralizer problem is sub-solvable in Mpf, A, Cq.
Proof. To apply Proposition 5.1 we need to verify the following two conditions:

‚ given b P eMpf, A, Cq, the stabilizer

Pb “ tpa1, a2q P eModpS2, A, C q ˆ eModpS2, A, Cq | a1b “ ba2u
is ﬁnitely generated and computable,

‚ given b1, b2 P eMpf, A, Cq,

eModpS2, A, C q with a1b1 “ b2a2.

it is decidable whether there exist a1, a2 P

For b P eMpf, A, Cq, consider the subgroup

Qb :“ ta2 P eModpS2, A, Cq | ba2 P ModpS2, A, Cqbu.

It has ﬁnite index in eModpS2, A, C q so is computable, since Mpf, A, Cq has ﬁnitely
many left orbits by Proposition 6.8. Furthermore, it follows from f ´1pC q Ă C that
Qb has a well-deﬁned image in eModpS2, A, Cq under

φb : a2 ÞÑ the element a1 P eModpS2, A, Cq such that a1b “ ba2.

Therefore, the stabilizer of b has the following description:

Pb “ tpφbpa2q´1, a2q P eModpS2, A, C q ˆ Qbu;

this shows that Pb is computable.

Consider b1, b2 P eMpf, A, Cq. It is decidable whether there exists a2 P eModpS2, A, Cq

with b2a2 “ g1b1 for some g1 P ModpS2, A, Cq. Then b1 and b2 are in the same
connected component of eMpf, A, Cq if and only if g1 P eModpS2, A, C q; this last
question is decidable.

(cid:3)

40

LAURENT BARTHOLDI AND DZMITRY DUDKO

6.7. The vertex mapping class biset of a Thurston map. We study further
the mapping class biset vMpf, A, C q, decomposing it as a product.

Deﬁnition 6.18 (Product bisets). Let pGiqiPI be a family of groups, let G “śi Gi

be their product, let f : I ý be a map, and let pBiqiPI be left-free Gi-Gf piq-bisets.
The product biset of the bisets Bi is the left-free G-G-biset

źi

Bi “ tpbiqiPI | bi P Biu

△

(cid:3)

with actions h ¨ pbiqiPI ¨ g “ phibigf piqqiPI .

Such a product of bisets appears naturally out of the following topological
data. Let us denote by pSiqiPI the connected components of the disconnection
pS2, AqzC , and by ModpSiq the pure mapping class group of Si. Then the group

vModpS2, A, C q is the direct productśi ModpSiq. For every b P vMpf, A, C q let
bi :xUi Ñ zSf piq be the small sphere map induced by b as in Deﬁnition 4.9 (note

that all b P vMpf, A, C q induce the same map on I). Denote by vMpf, A, Cqi the
restriction of vMpf, A, Cq to Si:

vMpf, A, Cqi :“ ModpSiqtbi | b P vMpf, A, C quModpSf piqq.
Lemma 6.19. The vModpS2, A, C q-biset vMpf, A, Cq is the product

vMpf, A, C q “źi

vMpf, A, C qi

of the ModpSiq-ModpSf piqq-bisets vMpf, A, Cqi.
Proposition 6.20. Consider a periodic cycle

Π “ ti, fpiq, . . . , f ptqpiq “ iu

(29)

biset

(31)

of f : I ý, and assume that an oracle solves the conjugacy and centralizer problems
in the vModpSiq-biset
(30)

vMpf, A, C qi bvModpSf piqq vMpf, A, Cqf piq b ¨¨¨ b vMpf, A, Cqf t´1piq.

Then the conjugacy and centralizer problems are solvable in theśjPΠ vModpSjq-

vMpf, A, C qΠ :“źjPΠ

vMpf, A, Cqj .

If for every periodic cycle as in (29) the conjugacy and centralizer problems
are solvable in (31), then the conjugacy and centralizer problems are solvable in
vMpf, A, Cq.

We will prove the proposition later, in the form of Algorithm 6.22; we start by
deriving some consequences. We remark that the bisets deﬁned by (30) are the ﬁrst
return maps of f on the system of small spheres pSiqiPI . As a corollary, we have:
Theorem 6.21. There is an algorithm with oracle that, given two g1, g2 P Mpf, A, Cq
solves the conjugacy problem between g1, g2 P Mpf, A, Cq and computes the cen-
tralizer of g1 as the kernel of a homomorphism from a ﬁnite-index subgroup of a
product of mapping class groups towards a ﬁnitely generated abelian group, pro-
vided that the oracle solves conjugacy problems between all small Thurston maps
of g1 and the associated small Thurston of g2 and provided that the oracle com-
putes the centralizer of all small Thurston maps of f .

SPHERE BISETS AND THEIR DECOMPOSITIONS

Proof. This follows directly from Propositions 6.17 and 6.20.

41

(cid:3)

We recall again that g1, g2 P Mpf, A, C q are typically given in terms of their
bisets. By Theorem 3.9 the sphere tree of bisets decomposing Bpg1q and Bpg2q
relatively to C are computable; so the projections of g1 and g2 in vMpf, A, Cq,
see (24), and the bisets of small Thurston maps of g1 and g2, see (12), are com-
putable.

Note that the centralizer of a homeomorphism is usually not very complicated.
For example, if h : pS2, A, Cq ý is a homeomorphism, then its centralizer is, up to
ﬁnite index, the direct product of the centralizers of the small Thurston maps. The
situation is much more intricate for non-invertible maps, see §8.3.

Algorithm 6.22. Given a multicurve C and a solution, for each periodic cycle
of small spheres, of the conjugacy and centralizer problems in the ﬁrst return biset,
Solve the conjugacy and centralizer problems in vMpf, A, C q as follows:
they are conjugate and for which we wish to compute Zpbq.

Consider two elements b, c P vMpf, A, Cq for which we wish to know whether

etc.

(1) We use the notation bi for the projection of b P vMpf, A, Cq to vMpf, A, Cqi,
Let Π1, Π2, . . . , Πn be all the periodic cycles of f : I ý, viewed as sub-
sets of I. To avoid hard-to-read subscripts, we introduce the notation
brΠ1s, . . . , brΠns for the images of b in vMpf, A, CqΠ1 , . . . , vMpf, A, CqΠn
respectively, and deﬁne crΠ1s, . . . , crΠns similarly.
(2) If for some cycle Πj the element brΠjs is not conjugate in vMpf, A, C qΠj
to crΠjs, then b and c are not conjugate, and we have solved the conjugacy
problem for b, c in the negative.

(3) For every X Ă I with fpXq Ă X, let us denote by

vMpf, A, C qi

ModX :“źiPX
vMpf, A, C qX :“źiPX

ModppSiq
the pure mapping class group ofŮiPX pSi, by
the mapping class biset over ŮiPX pSi, and by brXs and crXs the images
(4) Let X0 “ Ůj Πj be the union of the cycles in I. From the assumptions

of b and c in vMpf, A, C qX respectively. We denote also by ZpbrXsq the
centralizer of brXs in vMpf, A, CqX , and by hrXs an element of ModX that
conjugates brXs to crXs, namely satisﬁes brXs “ crXshrXs; or, if brXs, crXs
are not conjugate, we write hrXs “ fail.
of the proposition, hrX0s and ZpbrX0sq are computable, and we show now
how to compute the variables hrXs and ZpbrXsq for all X Ď I.
After all hrXs and ZpbrXsq have been computed, we will in particular
know whether b and c are conjugate: if hrIs ‰ fail, then it conjugates b
into c. The centralizer of b in ZpbrIsq.
(5) Assume that hrXs and ZpbrXsq have been computed, and consider i P IzX
with fpiq P X. This is how to compute hrX Y tius and ZpbrX Y tiusq.
If hrXs “ fail then set hrX Y tius :“ fail. Otherwise, compute the

action of ZpbrXsqrfpiqs ď ModppSf piqq on 1 b cihrfpiqs P 1 b vMpf, A, Cqi.

42

LAURENT BARTHOLDI AND DZMITRY DUDKO

Zpbrfpiqsq and hris P ModppSiq be such that hrisbi “ cihrfpiqsmrfpiqs; by

Since ZpbrXsq is computable and in particular ﬁnitely generated and it
acts on a ﬁnite set, the orbit of 1 b cihrfpiqs is computable. If this orbit
does not contain 1 b bi, then set hrX Y tius :“ fail. Otherwise, let m P
replacing hrXs with hrXsmrXs and deﬁning hris as above, we extend hrXs
to hrX Y tius.
Again we use the fact that the action of ZpbrXsq on the ﬁnite set 1 b
vMpf, A, C qi is computable; let H be the ﬁnite-index subgroup of ZpbrXsq
biarfpiqs; it is well-deﬁned by Proposition 6.4. Let then ZpbrX Y tiusq be

that stabilizes 1 b bi. Furthermore, let φ : H Ñ ModppSiq satisfy aφbi “
the diagonal image a ÞÑ pa, aφq of H in ZpbrXsq Y ModppSiq ď ModXYtiu.

Proof of Proposition 6.20. The second part is proven in Algorithm 6.22.

For the ﬁrst part, consider a new set Π1 “ ti, fpiq, . . . , f pt´1qpiq, f ptqpiq “ i1 “
fpi1qu. Set Si1 :“ Si and extend f to Si1 as f ptq. Then the biset vMpf, A, C qi1 is
given by (30), which by assumption has solvable conjugacy and centralizer problems.
Since this is the only cycle of Π1, we may apply the second part and deduce that
the conjugacy and centralizer problems are solvable for Π1.

Consider now two elements b, c P vMpf, A, C qΠ for which we wish to know
whether they are conjugate and for which we wish to compute Zpbq.
Write b “ pbi, bf piq, . . . , bf pt´1qpiqq and c “ pci, cf piq, . . . , cf pt´1qpiqq. Extend them
to elements b1, c1 P vMpf, A, C qΠ1 by setting bi1 “ bi b ¨¨¨ b bf pt´1qpiq and ci1 “
ci b ¨¨¨ b cf pt´1qpiq.
Then b, c are conjugate if and only if b1, c1 are conjugate in vMpf, A, CqΠ1 . If
h1 “ phi, hf piq, . . . , hi1q conjugates b1 to c1, then h “ phi, . . . , hf pt´1qpiqq conjugates
b to c. The centralizer Zpbq coincides with the centralizer Zpb1q. Therefore, both
problems are solvable.

(cid:3)

7. Orbispheres

All the previous considerations, on marked spheres, apply equally well to a
slightly more general situation, that of orbispheres. Consider a marked sphere
pS2, Aq, and let there also be given a function ord: A Ñ t2, 3, . . . ,8u, assign-
ing a positive or inﬁnite degree to each marked point. This describes an orbis-
if ordpaq “ 8, then the sphere is punctured at a P A, while if
pace structure:
ordpaq “ n then the space has a cone-type singularity of angle 2π{n at a. This
can be thought of as specifying a complex structure on S2: a small enough neigh-
bourhood of a point a P A with ordpaq “ 8 is identiﬁed with a neighbourhood
of 0 in C˚; while if ordpaq P N, a neighbourhood of a is modelled on a neighbour-
hood of 0 in C{xe2πi{ ordpaqy. The parabolic class Γi consists in elements of order
ordpΓiq :“ ordpaiq, see (32). For more details, consult [26, Appendix A].
Orbispheres are denoted pS2, A, ordq, or just pS2, Aq if the degree function is
implicit. To avoid degenerate cases, assume #A ­“ 1; and if #A “ 2, assume
furthermore that ord is constant on A. The Euler characteristic of pS2, A, ordq is
deﬁned as

χpS2, A, ordq “ 2 ´ ÿaPAˆ1 ´

1

ordpaq˙ .

Accordingly, pS2, A, ordq is called spherical, euclidean or hyperbolic if its Euler
If we endow S2 with a complex structure,
characteristic is ą 0, “ 0 or ă 0.

SPHERE BISETS AND THEIR DECOMPOSITIONS

43

with its usual complex structure [26, Theorem A.2]; in the sense that pS2, A, ordq “
with non-trivial stabilizers project then precisely to the marked points A; because
of the ambient complex structure, these stabilizers are perforce cyclic groups, and

then the universal cover ČpS2, A, ordq of pS2, A, ordq is respectively pC, C or Dp0, 1q
ČpS2, A, ordq{G for a group G of isometries acting with ﬁnite stabilizers. Those points
the order of Gra is ordpaq.
8. We have
(32)

The same loops γi as before generate G; but now, γordpaiq

“ 1 whenever ordpaiq ă

, . . . , γordpanq

G “ π1pS2, A, ord,˚q “ xγ1, . . . , γn | γordpa1q

1

i

n

, γ1 ¨¨¨ γny.

Indeed G is a group of isometries of ČpS2, A, ordq, with fundamental domain a

#A-sided polygon with angles 2π{ ordpaiq; so the presentation (32) follows from
Poincar´e’s Theorem, see e.g. [17, Theorem V.B.40].

Deﬁnition 7.1 (Orbisphere groups). An orbisphere group is a tuple pG, Γ1, . . . , Γnq
consisting of a group and n ­“ 1 conjugacy classes Γi in G, such that G admits a
presentation as in (32) for some choice of γi P Γi. The Euler characteristic of G is

χpGq “ 2 ´

nÿi“1ˆ1 ´

1

ordpaiq˙ .

Suppose that G1 “ π1pS2, A, ord1,˚q and G2 “ π1pS2, A, ord2,˚q are two orbi-
sphere groups and suppose that ord2paq | ord1paq for all a P A. Then the natural
homomorphism G1 Ñ G2 is called an inessential forgetful map.
△
It is convenient to extend ‘ord’ to S2 so that ordppq “ 1 ô p R A. Note again
that marked spheres are subsumed in the deﬁnition of orbispheres; namely, as those
for which ordpaq “ 8 for all a P A.
7.1. Pure homeomorphisms between orbispheres.
Deﬁnition 7.2 (Orbisphere maps). An orbisphere map f : pS2, C, ordCq Ñ pS2, A, ordAq
between orbispheres is a branched covering between the underlying spheres, with
fpCqYtcritical values of fu Ď A, that is locally modelled at p P S2 in oriented com-
plex charts by z ÞÑ zdegppf q for some integer degppfq ě 1, so that ordCppq degppfq |
ordApfppqq for all p P S2. A covering between orbispheres is an orbisphere map f
for which one has ordCppq degppfq “ ordApfppqq for all p P S2.
An anti-orbisphere map f : pS2, C, ordCq Ñ pS2, A, ordAq between orbispheres
is a branched covering satisfying the same condition as above except that f is
locally modelled in oriented charts at p P S2 by z ÞÑ ¯zdegppf q for some integer
degppfq ě 1.

△

In particular, if f is a covering then A “ fpC Y tcritical points of fuq.
For an orbisphere pS2, A, ordq we deﬁne the modular group consisting of orbi-

sphere and anti-orbisphere pure homeomorphisms as

Mod˘pS2, A, ordq “ th : pS2, A, ordq ý| degphq “ 1, h|A “ 1u,

and we denote by ModpS2, A, ordq the subgroup of order-preserving homeomor-
phisms in Mod˘pS2, A, ordq. Clearly, ModpS2, A, ordq and ModpS2, Aq are iso-
morphic.

44

LAURENT BARTHOLDI AND DZMITRY DUDKO

Choose ˚ P S2zA, write G “ π1pS2, A, ord,˚q, and set

i @i “ 1, . . . , nu.

Mod˘pGq “ tφ P OutpGq | Γφ

i “ Γ˘1
We have the following generalization of Theorem 2.3.
Theorem 7.3 (Dehn-Nielsen-Baer-Zieschang-Vogt-Coldewey). Let pS2, A, ordq be
an orbisphere with non-positive Euler characteristic. Then the natural map Mod˘pS2, A, ordq Ñ
Mod˘pπ1pS2, A, ordqq is an isomorphism.
Proof. This is essentially a direct consequence of [33, Theorems 5.8.3 and 5.14.1].
Since these theorems deal with groups that have only “ﬁnite order peripheral
classes” (such a set is always preserved by automorphisms), we need to make slight
adjustments.

the claim is easy to verify.

Let us a assume #A ě 4; if not, Mod˘pS2, A, ordq is a group of order two and
Deﬁne a new map ord1 : A Ñ t2, 3, . . .u by
ord1paq “#ordpaq

if ordpaq ă 8,
if ordpaq “ 8.

2016

We still have χpS2, A, ordq ď 0 because #A ě 4. Since the natural map Mod˘pS2, A, ordq “
Mod˘pS2, A, ord1q Ñ Mod˘pπ1pS2, A, ord1qq factors as

Mod˘pS2, A, ordq Ñ Mod˘pπ1pS2, A, ordqq Ñ Mod˘pπ1pS2, A, ord1qq,

it suﬃces to prove the theorem for the orbisphere pS2, A, ord1q.
Consider φ P Mod˘pπ1pS2, A, ord1qq. By [33, Theorem 5.8.3] there is a home-
omorphism hφ : pS2zAq ý inducing φ. By [33, Theorem 5.14.1] it is unique up to
φ is another such homeomorphism, then the lift of hφ˝h´1
isotopy rel A. Indeed, if h1
to the universal cover π1pS 2,A,ord1qU commutes with the action of π1pS2, A, ord1q;
and by [33, Theorem 5.14.1] hφ ˝ h´1
is isotopic to the identity relatively to
the action of π1pS2, A, ord1q. We get a homomorphism Mod˘pπ1pS2, A, ord1qq Ñ
Mod˘pS2, A, ord1q that is inverse to Mod˘pS2, A, ord1q Ñ Modpπ1pS2, A, ord1qq.

φ

φ

(cid:3)

For G “ π1pS2, A, ordq, deﬁne ModpGq to be the image in Mod˘pGq of ModpS2, A, ordq.
Corollary 7.4. Let G be an orbisphere group and let rG be a sphere group together
with an inessential forgetful map rG Ñ G. Then the natural map rG Ñ G induces
an isomorphism ModprGq Ñ ModpGq.
Proof. If χpGq ą 0, then ModprGq and ModpGq are trivial groups. The case

χpGq ď 0 follows from Theorem 7.3.
Since ModpGq is countable and its elements can be explicitly enumerated we also
have

(cid:3)

Corollary 7.5. Let rG Ñ G be as in Corollary 7.4. There is an algorithm that,
given h P ModpGq computes its preimage under the forgetful map ModprGq Ñ
product of Dehn twists, and then to lift each Dehn twist to ModprGq. This will be

ModpGq.
Remark 7.6. A more eﬀective algorithm is to decompose h P ModpGq into a
the developed in [6].

(cid:3)

SPHERE BISETS AND THEIR DECOMPOSITIONS

45

Proposition 7.7. Let G be an orbisphere group.

i´1¨¨¨γ´1

1

´γ´1
i

i “ γ

If χpGq ď 0, then ModpGq has index two in Mod˘pGq, and there is an algorithm
If G has at least one peripheral conjugacy class Γ with ordpΓq ą 2, then φ P

that, given φ P Mod˘pGq, determines whether φ belongs to ModpGq.
ModpGq if and only if Γφ “ Γ.
Proof. There exist anti-orbisphere maps, so ModpGq ‰ Mod˘pGq. This can
be seen algebraically, by considering the map φ given on generators γ1, . . . , γn
. By Theorem 7.3 we have rMod˘pGq :
with γ1 ¨¨¨ γn “ 1 by γφ
ModpGqs “ 2 if χpGq ď 0.
If φ is induced by an anti-orbisphere map, then φpΓq “ Γ´1 ‰ Γ; this proves the
last claim, and also gives an algorithm in case at least one peripheral conjugacy
class has order ą 2.
Suppose now that all peripheral conjugacy classes in G have order 2, and let us
give an algorithm deciding whether φ P Mod˘pGq is in ModpGq. Denote by Γi all
peripheral conjugacy classes in G, so G has presentation xγ1, . . . , γn | γ2
i , γ1 ¨¨¨ γny.
Consider the map G ։ Z{2 mapping generators γ1, . . . , γ4 to 1 pmod 2q and the
others to 0 pmod 2q, and let H denote the kernel of this map. Setting α “ γ2γ1 and
β “ γ1γ3 and δi “ γγ1γ2γ3
for n “ 5, . . . , n, we obtain by the Reidemeister-Schreier
theorem (see e.g. [24, §2.3]) the presentation

i

H “ xα, β, γ5, δ5, . . . , γn, δn | rα, βsδ5 ¨¨¨ δnγ5 ¨¨¨ γn, γ2

i , δ2
i y.

Consider φ P Mod˘pGq. Since φ preserves every Γi, it also preserves H, and
therefore induces an automorphism φ˚ of H{rH, Hs b Q – Q2, whose action on
generators can be explicitly computed. We have

ModpGq “ tψ P Mod˘pGq | detpψ˚q “ 1u,

0 1q in basis tα, βu.

so to determine whether φ P ModpGq it suﬃces to compute the action of φ˚ on
H{rH, HsbQ. Note that, for the orientation-reversing map φ given at the beginning
of the proof, we have φ˚ “ p ´1 2
Remark 7.8. In the above proof, the homomorphism G ։ Z{2 constructs a genus-
1 cover of the punctured sphere; it is on the cover that the orientation of a mapping
class can be read. More conceptually, if n is even then we may consider H “
kerpγi ÞÑ 1 pmod 2qq, corresponding to the hyperelliptic cover of the n-punctured
sphere, which is then a surface of genus n{2 ´ 1 without punctures; then φ˚ is the
action of φ on the homology of this cover.

(cid:3)

7.2. Orbisphere bisets. Let H, G be orbisphere groups. An orbisphere H-G-biset
B is deﬁned exactly as in Deﬁnition 2.5 — the only diﬀerence is that the acting
groups are orbisphere groups. As in Deﬁnition 2.5 the biset B induces a map
B˚ : C Ñ A from peripheral conjugacy classes of G indexed as pΓaqaPA to peripheral
conjugacy classes of H indexed as p∆cqcPC . In the dynamical case G “ H, then we
have a self-map B˚ : A ý called a critical portrait.
The same argument as in Lemma 2.6 shows that the biset of an orbisphere
map is an orbisphere biset. Moreover, if ordCpCq “ t2u, then the biset of an anti-
orbisphere map is an orbisphere biset. We are now ready to generalize Theorem 2.7.
We omit the case ordCpCq “ t2u and χpGq ą 0 from the theorem — this case will
be illustrated in Example 7.13.

46

LAURENT BARTHOLDI AND DZMITRY DUDKO

Theorem 7.9. Suppose that pS2, C, ordCq and pS2, A, ordAq are marked orbispheres
with #C ě 2; write H :“ π1pS2, C, ordC ,:q and G :“ π1pS2, A, ordA,˚q for choices
of : P S2zC and ˚ P S2zA.
Suppose ﬁrst ordCpCq ‰ t2u. Then orbisphere maps f0, f1 : pS2, C, ordCq Ñ
pS2, A, ordAq are isotopic if and only if Bpf0q – Bpf1q. Conversely, for every or-
bisphere H-G-biset B there exists an orbisphere map f : pS2, Cq Ñ pS2, Aq, unique
up to isotopy, such that B – Bpfq.
Suppose that ordCpCq “ t2u but χpGq ď 0. Then orbisphere or anti-orbisphere
maps f0, f1 : pS2, C, ordCq Ñ pS2, A, ordAq are isotopic if and only if Bpf0q –
Bpf1q. Conversely, for every orbisphere H-G-biset B there exists an orbisphere
or anti-orbisphere map f : pS2, Cq Ñ pS2, Aq, unique up to isotopy, such that
B – Bpfq.
The proof is essentially the same as that of Theorem 2.7; therefore we only sketch
the argument, underlining the diﬀerences.

Proof. Recall that the proof of Theorem 2.7 is based on Theorem 2.3, on Decompo-
sition (6) and on Lemmas 2.8 and 2.9. Theorem 2.3 is generalized by Theorem 7.3 —
see Corollary 7.4. Decomposition (6) holds for orbisphere bisets, while Lemma 2.8
is adjusted as follows, with a completely analogous proof:
Lemma 7.10. Suppose that H BG is the biset of an orbisphere map f : pS2, C, ordCq Ñ
pS2, A, ordAq with G “ π1pS2zA,˚q and H “ π1pS2zC,:q. If ordCpCq “ t2u, then
allow f to be an anti-orbisphere map.

Consider b P B and let ˚1 be the endpoint of b.

For p P S2 deﬁne ordrAppq :“ ordApfppqq{ degppfq and set rA :“ tp P S2 |
ordrAppq ą 1u so that f : pS2, rA, ordrAq Ñ pS2, A, ordAq is a covering of orbispheres.
Then π1pS2, rA, ordrA,˚1q is identiﬁed via f˚ : π1pS2, rA, ordrA,˚1q Ñ π1pS2, A,˚q
with Gb, and via this identiﬁcation the π1pS2, rA, ordrA,˚1q-G-biset of f : pS2, f ´1pAqq Ñ
Moreover, via the identiﬁcation of Gb with π1pS2, rA, ordrA,˚1q the peripheral con-

pS2, Aq is isomorphic to Gb GG while the H-π1pS2, f ´1pAq,˚1q-biset of pS2, Cq
pS2, f ´1pAqq is isomorphic to HbGb.
jugacy classes of Gb are pΞi,jqi,j constructed as follows. Let Γ1, . . . , Γn be the pe-
ripheral conjugacy classes of G. Then for each Γi there is a unique decomposition

Ñ

1

(33)

pΓ`

i zt1uq X Gb “ pΞ`

i,1zt1uq \ pΞ`

i,2zt1uq \ ¨¨¨ \ pΞ`

i,szt1uq

i,j

such that every Ξi,j is a non-trivial conjugacy class of Gb. Assuming Ξi,j is
generated by γdpi,jq
with γi,j P Γi and with minimal possible dpi, jq ě 1, we let
tpdpi, jq, Ξi,jqu be the multiset of lifts of Γi via GbGG.
Lemma 2.9, as well as its proof, holds for orbisphere bisets, as long as references to
Lemma 2.8 are replaced by references to Lemma 7.10.

(cid:3)

Now the proof copies that of Theorem 2.7 with the exception that in the case
ordCpCq “ t2u anti-orbisphere maps are indistinguishable from orbisphere maps.

(cid:3)

Corollary 7.11. Let rG Ñ G and rH Ñ H be as in Corollary 7.4. There is an

algorithm that, given B an H-G-biset, computes its preimage under the forgetful
map.

SPHERE BISETS AND THEIR DECOMPOSITIONS

47

Proof. Anti-sphere bisets are deﬁned in complete analogy with sphere bisets, see
Deﬁnition 2.5, except that the multisets of all lifts of Γi contain ∆´1
instead of ∆j.

j

Enumerate then all sphere and anti-sphere rH-rG-bisets ˜B, and return the ﬁrst one

that maps to B under the inessential forgetful maps.

(cid:3)

7.2.1. Orbisphere bisets and orientation. By Lemma 2.2, to every non-trivial sphere
group there is a uniquely associated oriented sphere. This is also true for orbisphere
groups, except if all peripheral conjugacy classes have order 2; in that case, it is
if A Ă R,
not possible to recover the orientation of the topological orbisphere:

the map z ÞÑ z : ppC, A, ordq ý has biset isomorphic to that of z ÞÑ z. Thus, in
Corollary 7.11, the choices of rG and rH amount to choices of orientations above the

orbispheres of G, H respectively.

Proposition 7.12. Suppose that in an orbisphere group H all peripheral conjugacy
classes have order 2 and χpHq ď 0.
Then there is an algorithm that decides whether the bisets H BG, H CG have the
same or diﬀerent orientation. In particular, there is an algorithm deciding whether
an orbisphere biset H BH corresponds to an orientation preserving map.

bisets.

Proof. Choose by Corollary 7.5 sphere groups rG, rH above G, H respectively. Using
Corollary 7.11, ﬁnd rH-rG-bisets rB,rC above B, C respectively. Then B, C have the
same orientation if and only if rB,rC are either both sphere or both anti-sphere

The second statement follows from the ﬁrst, by taking G “ H and C “ GGG. (cid:3)
Note that if H has four peripheral classes, so χpHq “ 0, there is a more eﬃcient
algorithm: consider indeed an orbisphere biset H BH . Since H has a unique sub-
group of index 2 isomorphic to Z2, the restriction of B to Z2 yields a 2 ˆ 2-integer
matrix MB, and B is orientation-preserving precisely when detpMBq ą 0. Details
will be given in [4].

Example 7.13 (Diﬀerent orbisphere bisets of the same map). Consider the follow-

ing post-critically ﬁnite rational map fpzq “´ z2´1
z2`1¯2
the post-critical set of f and write G :“ π1ppC, A,˚q “ xa, b, c | abcy so that a and c

. It has order-2 critical points
at ˘i,˘1, 0,8 with fp˘iq “ 8, fp˘1q “ 0, fp0q “ fp8q “ 1. Let A :“ t0, 1,8u be
are counterclockwise loops around 0 and 8 respectively intersecting once Rě0 while
b is a counterclockwise loop around 1 intersecting twice Rě0.
We compute Bpfq viewed as a sphere map. Suppose ˚ R Rě0 and let X :“
t1, 2, 3, 4u be the basis of Bpfq normalized so that 1, 2, 3, 4 are unique curves in
CzRě0 connecting ˚ to its unique preimage in tz | Repzq ą 0, Impzq ą 0u, tz |
Repzq ą 0, Impzq ă 0u, tz | Repzq ă 0, Impzq ă 0u, tz | Repzq ą 0, Impzq ă 0u
respectively. Then Bpfq is described by the recursion

(34)

a ÞÑ !a´1, 1, 1, ab"p1, 4qp2, 3q
b ÞÑ !c, 1, 1, a"p1, 3qp2, 4q
c ÞÑ !1, 1, 1, , 1"p1, 2qp3, 4q.

View next f as an orbisphere map pC Ñ ppC, A, ordq with ordpAq “ t2u. Then
« ppC, A, ordq. Write
f : pC Ñ ppC, A, ordq is a covering of orbifolds with pC{x´z, 1

zy

f

48

LAURENT BARTHOLDI AND DZMITRY DUDKO

zy. Then G1 is isomorphic to

G1 :“ π1ppC, A, ord,˚q “ xa, b, c | abc, a2, b2, c2y – x´z, 1
pZ{2q2 and the biset of f : pC Ñ ppC, A, ordq is
1 bG Bpfq bG G1 – 1pZ{2q2
Finally view f as an orbisphere map ppC, A, ordq Ñ ppC, A, ord˝q with ord˝paq “
ord˝pbq “ 4 and ord˝pcq “ 2. Write G˝ :“ π1ppC, A, ord˝,˚q “ xa, b, c | abc, a4, b4, c2y.
ppC, A, ordq Ñ ppC, A, ord˝q is

Then χpG˝q “ 0 and G˝ has an index 3-subgroup isomorphic to Z2. The biset of

G˝ “ G1 bG Bpfq bG G˝;

pZ{2q2 .

G1 B˝

If B is left-free of degree d then TpBq naturally has the structure of a d-regular
rooted tree: if S is a basis of B, then TpBq is in bijection with the set of words S˚,
which forms a #S-regular tree if one puts an edge between s1 . . . sn and s1 . . . sn`1

G˝.

as a set it has 16 “ #G1 ¨ #X elements transitively permuted by G˝. We note
that G1 B˝
G˝ uniquely determines f among all (orientation preserving) orbisphere

maps from ppC, A, ordq to ppC, A, ord˝q; however the biset of anti-orbisphere map
f ˝ ¯z : ppC, A, ordq Ñ ppC, A, ord˝q is also G1 B˝

ordfpaq “ l. c. m.  degzpf kq | k P N, z P f ´kpaq( P N Y t8u,

7.3. Inessential forgetful morphisms. Consider a Thurston map f : pS2, Aq ý.
There exist various orbispace structures on pS2, Aq, namely functions ord: A Ñ
t2, 3, . . . ,8u, that turn f into an orbisphere map. The minimal one is given by
(35)
and is denoted by pS2, Pf , degfq with Pf Ď A the post-critical set of f . The max-
imal one is given by deg8paq “ 8 for all a P A, and is denoted by pS2, A, deg8q.
The former is the usual one to consider when one is just given a map f ; the lat-
ter has the advantage of being deﬁned on a punctured sphere rather than on an
orbispace; but intermediate orbispace structures will be required, ﬁrstly because
sometimes the map f to consider is given by a previous construction that speciﬁed
its orbispace structure; secondly because periodic non-postcritical cycles are invisi-
ble in the fundamental group of the minimal orbispace structure (they correspond
to generators of order 1); and thirdly because the maximal structure will not satisfy
the required “contraction” properties in the next article [4] of the series. If periodic
cycles were marked is A, then degf can be extended to AzPf by taking a constant
value, for example 2, on non-post-critical points.
These notions have algebraic counterparts. Consider an orbisphere biset GBG. It
has a critical portrait B˚ : A ý induced by the map on peripheral conjugacy classes,
and a local degree degapBq. There is a minimal orbisphere quotient of G associated
with G, which is the quotient G of G by the additional relations ΓordB paq
“ 1, for

ordBpaq “ l. c. m.td | n ě 0 and Γa has a lift of degree d under Bbnu,

(36)
and clearly ordBpaq | ordGpaq. We call the quotient biset GbG BbG G the minimal
orbisphere biset of B.
There is an even smaller quotient of G than G, informally “the smallest for which
a quotient biset of B can be deﬁned”. Let GBG be an orbisphere biset; we then
naturally get a right action of G on

a

TpBq :“ ğně0t¨u bG Bbn.

SPHERE BISETS AND THEIR DECOMPOSITIONS

49

for all si P S. The action of G on TpBq need not be free; following [27, 5.1.1] we
denote by IMGBpGq the quotient of G by the kernel of this action.

Let rG and G be two orbisphere groups with a forgetful morphism ι : rG Ñ G
between them. Let rGrBrG be an orbisphere biset.
If the kernel of ι : rG Ñ G is
contained in the kernel of rG Ñ IMGrBprGq, then the biset
B :“ G brG rBrG b G

is an orbisphere G-G-biset. It is easy to see that the kernel of G Ñ G is contained
in the kernel of G Ñ IMGpGq.

(37)

Corollary 7.14. Suppose that rG Ñ G is an inessential forgetful morphism, and
denote by β : rB Ñ B be the natural map rb ÞÑ 1 brb b 1. Then β induces an
isomorphism between the mapping class bisets MprBq and MpBq.

Proof. Follows immediately from Theorems 7.3 and 7.9.

(cid:3)

7.4. Freely-oriented mapping class bisets. Consider f : pS2, Cq Ñ pS2, Aq and
as in (1) deﬁne the freely-oriented mapping class biset

M ˘pf, C, Aq “ tm1f m2 | m1 P Mod˘pS2, Cq, m2 P Mod˘pS2, Aqu.

Then M ˘pf, C, Aq is a crossed product of Z{2 and Mpf, C, Aq in the following way.
On the level of mapping class groups we have short exact sequences
1 ÝÑ ModpS2, Cq ÝÑMod˘pS2, Cq ÝÑ Z{2 ÝÑ 1,
1 ÝÑ ModpS2, Aq ÝÑMod˘pS2, Aq ÝÑ Z{2 ÝÑ 1.

(38)

In particular, we have a short exact sequence of bisets, see Deﬁnition 5.2,
(39)
ModpS 2,CqM ˘pf, C, AqModpS 2,Aq ãÑ Mod˘pS 2,CqM ˘pf, C, AqMod˘pS 2,Aq
։ Z{2.
The sequences in (38) split; ﬁx splittings σ : Z{2 Ñ Mod˘pS2, Cq and σ : Z{2 Ñ
Mod˘pS2, Aq. For example, we may choose σp1q “ ¯z after identifying S2 with pC
and realizing C and A as subsets of R. Then Z{2 acts on ModpS2, Cq, Mpf, C, Aq, ModpS2, Aq
by pmqa “ σpa´1qmσpaq and pbqa “ σpa´1qbσpaq for a in ModpS2, Cq or in
ModpS2, Aq and b P Mpf, C, Aq. Using these splitting we have semidirect products
Mod˘pS2, Cq “ Z{2 ˙σ ModpS2, Cq and Mod˘pS2, Aq “ Z{2 ˙σ ModpS2, Aq.
Deﬁne Z{2 ˙σ Mpf, C, Aq to be the pZ{2 ˙σ ModpS2, Cqq-pZ{2 ˙σ ModpS2, Aqq-
biset that is Z{2 ˆ Mpf, C, Aq as a set, endowed with the actions
m2q.
(40)
Lemma 7.15 (Cross product for (39)). The biset of M ˘pf, C, Aq is isomorphic to
the cross product Z{2˙Mpf, C, Aq by an isomorphism mapping σpaqg P M ˘pf, C, Aq
to pa, gq P Z{2 ˆ Mpf, C, Aq with g P Mpf, C, Aq.

pa1, m1q ¨ pa, gq ¨ pa2, m2q “ pa1aa2,pm1qaa2

pgqa2

(cid:3)

In the dynamical setting pS2, Cq “ pS2, Aq we may interpret (40) as a semidirect
product of bisets. Denote by K ˘pS2, Aq the set of isotopy classes of sphere and
anti-sphere maps f : pS2, Aq ý. It is naturally a semigroup under composition, and
we have a short exact sequence of semigroups

1 ÝÑ KpS2, Aq ÝÑ K ˘pS2, Aq ÝÑ Z{2 ÝÑ 1

50

LAURENT BARTHOLDI AND DZMITRY DUDKO

that splits. Fixing a splitting σ : Z{2 Ñ K ˘pS2, Aq we get K ˘pS2, Aq – Z{2 ˙σ
K ˘pS2, Aq. Of course M ˘pf, C, Aq is isomorphic to the algebraic associated freely-
oriented mapping class biset M ˘pBpfqq consisting of sphere and anti-sphere bisets;
thus we also have M ˘pBpfqq “ Z{2 ˙σ MpBpfqq once a splitting is ﬁxed.

We brieﬂy recall the application of Teichm¨uller theory to Thurston maps; see [2,

§0.3] and [31].

8. Examples

The Teichm¨uller space of pS2, Aq is the set TA of complex structures on pS2, Aq,
or equivalently Riemannian structures on S2zA of curvature ´1. We view it as the

to post-composition by M¨obius transformations. Teichm¨uller space is contractible,
while the fundamental group of MA is ModpS2, Aq; there is a natural map TA Ñ
covering map with group ModpS2, Aq.
Thurston associates with f : pS2, Cq Ñ pS2, Aq a map σf : TA Ñ TC deﬁned by
pulling back complex structures through f , see [13]: given h P TA represented by
atlas on S2zC, with erasable singularities at C; so there exists a homeomorphism

set of homeomorphisms pS2, Aq ÑpC up to isotopy rel A and post-composition by
M¨obius transformations. Moduli space MA is the set of embeddings A ãÑ pC up
MA, given by restricting homeomorphisms pS2, Aq ÑpC to A, which is a universal
a homeomorphism h : pS2, Aq Ñ pC, the composition h ˝ f deﬁnes a holomorphic
h1 : S2 ÑpC and a rational map fh making the following diagram commutative:

h1

(41)

pS2, Cq

f

pS2, Aq

h

fh

pC
pC.

Furthermore, h1 is uniquely deﬁned up to post-composition by a M¨obius transfor-
mation, and its class in TC depends only on the class of h in TA. The map σf is
deﬁned by σfphq “ h1. It is a contravariant functor from the category of spheres
pS2, Aq with sphere maps as morphisms to the category of Teichm¨uller spaces TA
with analytic maps as morphisms.
Unless f is a homeomorphism, the map σf : TA Ñ TC does not descend to a
map MA Ñ MC . However, deﬁne Hf ď ModpS2, Aq, the subgroup of liftable
classes, as

(42)

Hf “ th P ModpS2, Aq | Dh1 P ModpS2, Cq with h ˝ f “ f ˝ h1u.

By Proposition 6.8 or [22, Proposition 3.1], the subgroup Hf has ﬁnite index in
ModpS2, Aq, and Proposition 6.4 implies that the h1 in (42) is unique; see also [7].
Deﬁne then

Wf “ TA{Hf .

Then Wf is a ﬁnite covering of MA, say with covering map i, and the map σf
descends to a map σf : Wf Ñ MC. We therefore have a correspondence pσf , iq,
which we call modular correspondence, see [21],

(43)

MC

σfÐÝ Wf

iÝÑ MA

SPHERE BISETS AND THEIR DECOMPOSITIONS

51

with the associated biset (see [3, §4.1 and Equation (15)])
(44)
Bppσf , iq,:,˚q “ tpδ : r0, 1s Ñ MC, z P Wfq | δp0q “ :, δp1q “ σfpzq, ipzq “ ˚u{ «.

Choose r: P TC and r˚ P TA above :,˚ respectively; by deﬁnition they are
maps r: : pS2, Cq Ñ pC and r˚ : pS2, Aq Ñ pC. Using these choices we have identi-

ﬁcations π1pMC,:q – ModpS2, Cq and π1pMA,˚q – ModpS2, Aq. Indeed, every
γ P π1pMC ,:q determines an element of ModpS2, Cq as the composition
(45)

ÝÑ : r:´1
rγ
rγ
with : viewed as a marked Riemann sphere and :
ÝÑ : viewed as an isotopy of
marked Riemann spheres. Similarly, every γ P π1pMA,˚q determines an element of
ModpS2, Aq as the composition
(46)

C ãÑ pS2, Cq

ÝÑ pS2, Cq

r:
ÝÑ :

A ãÑ pS2, Aq

r˚ÝÑ ˚ rγ

ÝÑ ˚ r˚´1

ÝÑ pS2, Aq.

The following result identiﬁes biset elements b “ pδ, zq P Bppσf , iq,:,˚q with

branched coverings b : pS2, Cq Ñ pS2, Aq:

(47)

b : pS2, Cq

Proposition 8.1. Suppose thatr: P TC andr˚ P TA are ﬁxed as above and suppose

that π1pMC,:q – ModpS2, Cq and π1pMA,˚q – ModpS2, Aq are identiﬁed by (45)
and (46).
Then the biset of the modular correspondence (43) is isomorphic to the mapping
class biset Mpf, C, Aq, see Deﬁnition 6.3, by an isomorphism mapping pδ, zq P
Bppσf , iq,:,˚q given in the form of (44) to the following sphere map (47). Choose

any rz P TA above z. Then the sphere map
σf przq´1
ÝÑ pS2, Cq
ÝÑ pS2, Aq
is independent up to isotopy of the choice of rz. Here the map rδ : r0, 1s Ñ TC is
the lift of δ that ends at σfprzqpCqq, and represents the continuous deformation of
ppC,r:pCqq into ppC, σfprzqpCqq.
Proof. Suppose thatrz1 P TA is a diﬀerent choice of a point above z. Thenrz1 “ mrz
of σf , we have σfpmrzq “ m1σprzq; therefore substitution ofrz byrz1 does not change

for some m P Hf , see (42), and f m “ m1f for some m1 P ModpS2, Cq. By deﬁnition
the isotopy type of (42).

The map in question is a morphism of left-free transitive bisets; it is an isomor-
phism because the group of the bisets have the same group of liftable elements. (cid:3)

rzÝÑ ˚ r˚´1

rδÝÑ δp1q

ÝÑ pS2, Aq

r:
ÝÑ :

f

8.1. Twisted rabbits. We give now a few examples of calculations of the structure
of Mpf, C, Aq, following [1]. It was used in that article to solve “twisted rabbit”
problems, of the following kind: consider the “rabbit” polynomials fRpzq “ z2 ` c
for c « ´0.12256` 0.74486i, with post-critical set A “ t0, c, c2` c,8u. Let t denote
a Dehn twist about a simple closed curve surrounding c and c2 ` c (the “ears” of
the rabbit). By Thurston’s Theorem 3.5 characterizing rational maps, the “twisted
rabbit” tn˝ fR is combinatorially equivalent to a degree-two polynomial, which may
then be normalized in the form z2 ` c with pc2 ` cq2 ` c “ 0; so it is either fR,
fC :“ z2 ` c (the “corabbit”), or fA « z2 ´ 1.7549 (the “airplane”). The problem
is to determine which one.

52

LAURENT BARTHOLDI AND DZMITRY DUDKO

The reformulation of this question is the following. The biset MpfR, Aq is a
left-free ModpS2, Aq-biset of degree 2, and can be computed explicitly by Algo-
rithm 6.11. By Thurston’s Theorem 3.5, there are precisely 3 conjugacy classes (in
the sense of [3, §4.7]) in MpfR, Aq, containing respectively the rabbit, corabbit and
airplane polynomials. As we shall see in [5], the conjugacy problem is solvable in
MpfR, Aq.

The answer to the concrete question above is: to determine the conjugacy class

of tn ˝ fR, write n is base 4, as n “řiě0 ni4i with ni P t0, 1, 2, 3u; if n ě 0 then

almost all ni “ 0 while if n ă 0 then almost all ni “ 3. Then [1, Proposition 4.3]

(48)

tn ˝ fR „$’&’%

fR
fC
fA

if n ě 0 and all ni P t0, 3u,
if n ă 0 and all ni P t0, 3u,
if some ni P t1, 2u.

The equalities in (48) follow from an explicit computation of the structure of
MpfR, Aq. In this case, it is more direct to obtain it using Teichm¨uller theory, as
it is done in [1, §5], than to run our general algorithm. Moduli space MA may

be described as pCzt0, 1,8u by identifying A “ t0, c, c2 ` c,8u with its cross-ratio
the inverse of a rational map g : MA Ð MA. Indeed, consider h1 : pS2, Aq Ñ pC in

c ` 1. The correspondence MA Ð WfR Ñ MA from (43) descends in this case to
Teichm¨uller space, and its image σfRph1q “ h. Let t0, 1, w,8u be the image of h1
in moduli space. Then in (41) the rational function fh has degree 2, has critical
points at 0,8, and satisﬁes

fhp8q “ 8,

fhp0q “ 1,

fhpwq “ 0

so fhpzq “ 1 ´ z2{w2; and the image t0, 1, w1,8u of h1 in moduli space is given by
w1 “ fhp1q so we have

gpwq “ 1 ´

1
w2

.

π1ppCzt0, 1,8u, wq, by identifying the loop traced by w inpCzt0, 1,8u with the map-

The post-critical set of g is t0, 1,8u, and MpS2, Aq is naturally identiﬁed with
ping class of S2zA in which the non-critical preimage of the critical point is dragged
along the loop, keeping all other points in A ﬁxed. We write MpS2, Aq “ xs, t, u |
utsy, with s representing the positive Dehn twist about a curve surrounding c2 ` c
and 0.
We have MpfR, Aq – Bpgq, and may write its structure as follows, in basis

tfR, fRtu, see Figure 2:
(49)

fR ¨ t “ fRt,
fRt ¨ t “ u ¨ fR,

fR ¨ s “ t ¨ fR,
fRt ¨ s “ fRt,

fR ¨ u “ s ¨ fRt,
fRt ¨ u “ fR.

The claims in (48) then follow from the initial cases

which can be checked by hand, and the equations

t´1 ¨ fR „ fRt´1 „ fC,

t ¨ fR „ fRt „ fA

t4kfR „ fRt4k “ u2kfR „ fRu2k “ skfR „ fRsk

“ tkfR,
t4k`1fR „ fRt4k`1 “ u2kfRt „ fRtu2k “ skfRt „ fRtsk
“ fRt,
t4k`2fR „ fRt4k`2 “ u2k`1fR „ fRu2k`1 “ sk`1fRt „ fRtsk`1 “ fRt,
t4k`3fR „ fRt4k`3 “ u2k`1fRt „ fRtu2k`1 “ skfR „ fRsk
“ tkfR

SPHERE BISETS AND THEIR DECOMPOSITIONS

53

fR

˚1

t

s

1

u

fR ¨ t

0

´1

˚2

Figure 2. The biset of the map 1 ´ w´2

which directly follow from (49).

Similar calculations were performed in [1, §6] to study Mpz2 ` i, A, Aq with
A “ ti, i ´ 1,´i,8u. Again this biset is left-free of degree 2; and coincides with
the biset of the rational map gpwq “ p1 ´ 2{wq2 after MA has been identiﬁed
see [1, Corollary 6.11]: two classes corresponding to rational maps z2` i and z2´ i,
and a Z’s worth of conjugacy classes corresponding to obstructed maps fn with
n P Z, as described in [2, §7.2].

with pCzt0, 1,8u. There are inﬁnitely many conjugacy classes in Mpz2 ` i, A, Aq,

8.2. Belyi maps. We now describe a class of maps f for which the modular cor-
respondence (43), and the mapping class biset, can be quite explicitly understood:
sphere maps f : pS2, Cq Ñ pS2, Aq with #A “ 4 and such that only three values in
A are critical. Even though the data are purely topological, we write A “ t0, 1,8, vu
by abuse of notation. There is an underlying map f 1 : pS2, f ´1t0, 1,8uq Ñ pS2,t0, 1,8uq,
and f may be considered as a ‘decorated’ version of f 1 with the extra marked point
v.

In [4] we shall consider the more general situation of a map f : pS2, Cq Ñ pS2, Aq
and its restriction f : pS2, C1q Ñ pS2, A1q for C1 Ă C, A1 Ă A; the philosophy
being that Mpfq is an extension of Mpf 1q via the natural maps ModpS2, Cq ։
ModpS2, C1q, ModpS2, Aq ։ ModpS2, A1q and Mpfq ։ Mpf 1q, using which Mpfq
can be eﬃciently encoded using Mpf 1q and Bpf 1q. In our case Mpf 1q is trivial and
the considerations are much simpliﬁed.

We normalize all maps pS2, Aq Ñ pC so that 0 ÞÑ 0, 1 ÞÑ 1,8 ÞÑ 8, and in this
manner we identify MA with the image of v inpCzt0, 1,8u. We also identify f 1 with

a rational map; such maps with critical values in t0, 1,8u are called Belyi maps.

54

LAURENT BARTHOLDI AND DZMITRY DUDKO

Let us ﬁx a basepoint ˚ P S2zA, and write π “ π1pS2zA,˚q. It admits a presen-

tation as a sphere group

π “ xa, b, c, d | dcbay

generated by loops around the punctures 0, 1,8, v respectively. Then the covering
f : S2zf ´1pAq Ñ S2zA is described by an index-degpfq subgroup πf ď π: ﬁx
a preimage ˚0 of ˚, and let πf denote those loops in π that lift to a loop at ˚0.
Equivalently, S2zA – πzD and S2zf ´1pAq – πfzD with f : πfzD Ñ πzD the natural
map.
There is a natural map π “ π1pS2zA,˚q ։ π1pS2zt0, 1,8u,˚q “: G; let H denote
the image of πf in G. We have G “ π{xdyπ; and πf ě xdyπ since d lifts to d loops
at every preimage of ˚; so rG : Hs “ rπ : πfs “ degpfq, and we may also represent
f 1 as the quotient map HzD Ñ GzD.
By choosing a path from ˚ to v, we may also identify G with π1pS2zt0, 1,8u, vq.
Let tc1, . . . , cdu Ă f ´1pAq be the preimages of v. Then G acts by monodromy on
tc1, . . . , cdu, so that we have a transitive permutation representation ρ : G Ñ dÓ.. A
choice of c1 P f ´1pAq determines a choice of H as the stabilizer of c1 under ρ. The
pure modular group ModpS2, Aq is free of rank 2, and is identiﬁed with G: the
element of G represented by a simple loop of v turning respectively around 0, 1,8
corresponds to the Dehn twist in ModpS2, Aq in which v is dragged respectively
around 0, 1,8.

We may also present G as a sphere group,

(50)

G “ ModpS2, Aq “ xs, t, u | utsy.

It is the group of outer automorphisms of π that ﬁxes conjugacy classes of genera-
tors. The outer automorphisms s, t, u are, modulo interior automorphisms,

s : a ÞÑ aad,
a ÞÑ a,
t :
u : a ÞÑ a,

b ÞÑ b,
b ÞÑ bdb,
b ÞÑ b,

d ÞÑ dad,
c ÞÑ c,
c ÞÑ crd,bs, d ÞÑ ddb,
c ÞÑ cdc,
d ÞÑ ddc.

These generators are respectively Dehn twists about the curves ad, db, dc.

Lemma 8.2. The group of liftable elements Hf ď G is the kernel of ρ : G Ñ dÓ..
More precisely, denote by Mod˚pS2, Cq the group of not necessarily pure map-
ping classes of pS2, Cq that ﬁx 0, 1,8. Then Mod˚pS2, Cq extends the left action
of ModpS2, Cq on Mpfq and the new extended action is free and transitive. For
every h P G there is a uniquerh P Mod˚pS2, Cq such thatrhf “ f h. The element h
is liftable if and only ifrh P ModpS2, Cq.
Proof. We show that the action of Mod˚pS2, Cq on Mpfq is free; the other claims
then follow easily. Suppose that hf “ f in Mpfq for h P Mod˚pS2, Cq. There is
an e ě 1 such that he P ModpS2, Cq. We have hef “ f , so by Proposition 6.4 we
have he “ 1, so h is isotopic to a M¨obius transformation. Since h ﬁxes 0, 1,8 we
get h “ 1 in Mod˚pS2, Cq.

(cid:3)

Fix f 1-preimages 01, 11,81 of 0, 1,8 respectively, and write T 1 “ Tt01,11,81,c1,...,cdu
and M 1 “ Mt01,11,81,c1,...,cdu. Once 0, 1,8 and the points above them are ﬁxed, the
map fh in (41) is uniquely determined, so we may consider T 1, M 1 rather than the

SPHERE BISETS AND THEIR DECOMPOSITIONS

55

larger Tf ´1pAq, Mf ´1pAq. In the following diagram, vertical arrows are coverings:

(51)

T 1

M 1

Wf

TC

MC

TA

MA

The space M 1 is naturally a subset of aﬃne space:

(52)
and the embedding of Wf in M 1 is onto the curve

M 1 “ tpc1, . . . , cdq PpCd | ci ‰ 01, 11,81; ci ‰ cju,
Wf “ tpc1, . . . , cdq PpCd | fpc1q “ ¨¨¨ “ fpcdq ‰ 0, 1,8u.

The correspondence in then determined by the map M 1 Ñ MC , which encodes
how f ´1pAq corresponds to C.
8.2.1. Products of mapping class bisets. Write A “ t0, 1,8, vu, consider the map

fpzq “ z5 : ppC,t0, 1,8, f ´1pvquq Ñ ppC, Aq, and denote by tc1, . . . , c5u the ﬁve f -
preimages of v. Choose a homeomorphism i : ppC, Aq Ñ ppC,tc1, c2, c3, c4uq. De-
note also by k “ 1 : ppC,tc1, c2, c3, c4uq Ñ ppC,t0, 1,8, f ´1pvquq the map marking
0, 1,8, c5, and set j “ ik. Denote also ModppC, Aq by G. We shall compute Mpfq,

Mpjq and Mpjfq and note that the natural map Mpjq b Mpfq ։ Mpjfq is not an
isomorphism of G-G-bisets.
Since f is a Belyi map, we determine Mpfq using Lemma 8.2. Since ρpGq is
cyclic of order 5, the biset Mpfq is left-free of degree 5. Also, every mapping
class n P G is liftable by f , but possibly to an impure class: there exists n1 P
of the cycle p1, 2, 3, 4, 5q.
The maps i and k are homeomorphisms, so Mpjq is the dual of the forgetful
homomorphism j˚ induced on mapping class groups, see Lemma 6.10. In particular,
Mpjq is left-principal. The product Mpjq b Mpfq is therefore left-free of degree 5.
We claim that the biset Mpjfq is left-principal. Indeed, we may write jf “ gℓ

Mod˚ppC,t0, 1,8, f ´1pvquq with n1f “ f n, and n1 acts on tc1, . . . , c5u by a power

ℓ´1 is an erasing map.

with g “ z5˝ i : ppC, Aq Ñ ppC,t0,8, vuq and ℓ “ 1 : ppC,t0,8, vuq Ñ ppC, Aq. Consider
n P G; then we have jf n “ gℓn “ gℓ “ jf , since ModppC,t0,8, vuq is trivial and

We also remark that the pullback map σjf “ σgℓ is constant, because σℓ is
constant; so the modular correspondence Wjf coincides with MA, with induced
map σjf constant. Its image point is the cross-ratio of four ﬁfth roots of unity. The
diagram (51) becomes

TA

σj

T 1

M 1

σjf

MA

TA

σf

Wf

5:1

Wjf

MA.

56

LAURENT BARTHOLDI AND DZMITRY DUDKO

A5

A4

i

A3

A1

f

c

b

A2

A

a

d

Figure 3. Pilgrim’s “blowing up an arc” subdivision rule

8.2.2. Kevin Pilgrim’s “blowing up an arc” map. We consider another concrete
example illustrating §8.2: a degree-5 self-map g, due to Kevin Pilgrim, which is
obtained from a torus endomorphism by blowing up an arc; see [2, §7.6], repeated
for convenience in Figure 3 as the correspondence pi, fq. Note that we exchanged b
and c compared to [2, Figure 5].
The map g is non-dynamically modeled on the map fpzq “ z3pp4z ` 5q{p5z `
4qq2 viewed as a Belyi map ppC, Cq Ñ ppC, Aq with A “ t0, 1,8, vu and C “
t0, 1,8, f ´1pvqu; with such choices the map M 1 and MC are identical via the map
in Diagram (51). Recall that Pilgrim’s map is the map g : pS2, Aq ý obtained (topo-
logically) from f : ppC, Cq Ñ ppC, Aq by identifying A with four preimages c1, . . . , c4
of v. We thus have a map σ1 : MC « M 1 Ñ MA given by evaluating the cross-ratio
of the ﬁrst four coordinates of tc1, . . . , c5u P M 1, see Diagram (54).
iÝÑ MA be the correspondence obtained from MC Ð Wf Ñ
ÐÝ MC . The correspondence we

σgÐÝ Wf

Let MA

MA in Diagram (51) by precomposing with MA
obtain is explicitly given by the pair of maps
ipc1, . . . , c5q “ fpc1q,
σ1pc1, . . . , c5q “ pc1 ´ c3qpc2 ´ c4q

(53)

σ1

We shall see that it is the modular correspondence of g. On the other hand, we
shall also see that Wg is not the minimal correspondence above MA covered by the

pc1 ´ c4qpc2 ´ c3q “: x;

SPHERE BISETS AND THEIR DECOMPOSITIONS

57

map σg. Thus diagram (51) will become

TA

TC

σf

TA

(54)

MC

Wf “ Wg

σ1

σg

W

5!:1

30:1

MA

MA.

Let us compute the biset of the map g. With π “ π1ppCzAq, it is the following

π-π-biset Bpgq, in the basis X “ t1, 2, 3, 4, 5u:

(55)

a ÞÑ !a, 1, 1, 1, a´1"p1, 3, 5qp2, 4q
b ÞÑ !b´1, 1, 1, b, 1"p1, 4qp2, 5, 3q
c ÞÑ !1, 1, c, c´1, 1"p1, 2qp3, 4q
d ÞÑ !a, b, d, c, 1".

s ÞÑ p1, 3, 5qp2, 4q,

t ÞÑ p1, 4qp2, 5, 3q,

u ÞÑ p1, 2qp3, 4q.

Let us write G “ ModppC, Aq. To compute the monodromy representation ρ of

f , we simply consider the permutations in the biset Bpgq. We present G as a sphere
group xs, t, u | utsy; the twists s, t, u correspond to a motion of v around 0,8, 1
respectively. Therefore, ρ : G Ñ 5Ó. is given by

In particular, ρ is onto 5Ó. so the subgroup of liftables Hf “ kerpρq from (50) has
index 120, and both the mapping class biset Mpf, C, Aq and the modular corre-
spondence Wf have degree 120.
Let us consider the G-G-biset Mpg, Aq :“ tBpφgψqu{„ of isomorphism classes of
twists of the biset Bpgq. This biset is left-free, and a basis may be found by consider-
ing its distillations, see Deﬁnition 6.6. Since ρpGq “ 5Ó., its centralizer in 5Ó. is trivial,
so the permutations associated with the generators a, b, c in the biset Bpφgψq can in
a unique manner be brought respectively to p1, 3, 5qp2, 4q,p1, 4qp2, 5, 3q,p1, 2qp3, 4q.
The conjugacy classes on the ﬁve entries of d in Bpφgψq are then 1, a, b, c, d in some
order, and this order determines uniquely an element of 5Ó.. All such orderings may
appear, so Mpg, Aq is also left-free of degree 120.
Using a choice of distillations, Algorithm 6.11 lets us compute a presentation for
Mpg, Aq, and in this manner describe the correspondence. We shall not describe
Mpg, Aq in such a basis, but will content ourselves with giving, for illustration, the
results of the calculation in the form of the lifts of the conjugacy classes sG, tG, uG.
Since MA is a sphere punctured at t0, 1,8u, the modular correspondence is a
sphere correspondence. Recall from §2.1.1 that to each of the peripheral conjugacy
classes sG, tG, uG can be assigned the multiset tpdi, hG
i q | i “ 1, . . . , ℓu of its lifts.
Let us start with uG. The degrees di are all the same, and equal to the order of
ρpuq, so there are 60 cycles of length 2, given by the regular action of ρpuq on 5Ó..
The lifts are 16ˆ sG, 16ˆ tG, 16ˆ uG, 4ˆps2qG, 4ˆpt2qG, 4ˆpu2qG. Similarly, the
degrees of the lifts of sG and tG are all 6 since ρpsq and ρptq have order 6, and both
sG and tG lift to 8 ˆ 1G, 4 ˆ ps5qG, 4 ˆ pt5qG and 4 ˆ pu5qG. We deduce that the

58

LAURENT BARTHOLDI AND DZMITRY DUDKO

degree of the map σg : Wf Ñ MA is 16ˆ 1` 4ˆ 2` 4ˆ 5` 4ˆ 5 “ 64, counting the
number with degree and multiplicity of ‘psnqG’ that appear as lifts of sG, tG, uG.
In particular, the correspondence is not constant, and moreover is given by a pair
of branched coverings Wf Ñ MA.

In this example, there exists a correspondence MA Ð W Ñ MA which is a
quotient of MA Ð Wf Ñ MA, and which also covers σg : TA ý. In fact, we shall
give the minimal such W , and show that it has left-degree 30.
The variables c2, . . . , c5 may be eliminated from Wf , yielding a planar projection
of the correspondence. It is given by a polynomial equation Ppv, xq “ 0 of degree
30 in x and 16 in v, see (53); so that the degree of the map towards v “ fpc1q is 30,
and the degree of the map towards x “ rc1, c2; c3, c4s is 16. The polynomial Ppv, xq
may be computed using Gr¨obner bases as follows, in Maple using the package
FGb1:
with(FGb);
sys := [(c[1]-c[3])*(c[2]-c[4])-x*(c[1]-c[4])*(c[2]-c[3]),

coeff(16*product(z-c[i],i=1..5)-z^3*(4*z+5)^2+v*(5*z+4)^2,z,i)$i=0..4]:

fgb_gbasis_elim(sys,0,[c[i]$i=1..5], [x,v],{"verb"=3,"index"=2000000}):
P := simplify(%[1]/v):
lprint(P);
One can easily check that P is irreducible, so MA Ð W Ñ MA is indeed the
minimal correspondence covered by σg.
Here is the explanation of the existence of a smaller cover W , using group the-
ory. The minimality of W follows from the fact that the induced map on con-
jugacy classes admits an order-4 symmetry and no larger one. The cross-ratio
map σ1 from (53) admits symmetries: σ1pc1, c2, c3, c4, c5q “ σ1pc2, c1, c4, c3, c5q “
σ1pc3, c4, c1, c2, c5q “ σ1pc4, c3, c2, c1, c5q. We consider

V “ t1,p1, 2qp3, 4q,p1, 3qp2, 4q,p1, 4qp2, 3qu

the Klein group of order 4, so that σ1 is invariant under permutation of its arguments
by V . We deﬁne W “ TA{ρ´1pV q; then the map σg : Wg Ñ MA descends to a map
W Ñ MA. Thus V acts on Wg, and the quotient is W .
The Klein group V acts regularly on the set of distillations of bisets in Mpg, Aq;
this action combines with the left action of G on Mpg, Aq to give a left action
of V ˙ G on Mpg, Aq, by impure mapping classes, which is still free, but now of
degree 30. The quotient biset V zMpg, Aq is a left-free G-G-biset of degree 30, and
coincides with the biset BpMA Ð W Ñ MAq of the quotient correspondence.
Recall that the map g : pS2, Aq ý was obtained from the doubling map z ÞÑ 2z
on the torus C{Z ` Zi, by blowing up an arc. The Klein group V acts on the torus
by xz ÞÑ z ` 1
2y, and elements of the biset V zMpg, Aq can be identiﬁed
with orbits of V under this action.
We repeat the analysis of the action of peripheral elements on Mpg, Aq{V , and
derive information on W . It is readily checked that the elements s, t act on the
coset space 5Ó.{V as a product of ﬁve 6-cycles, each carrying the conjugacy classes
ps5qG,pt5qG,pu5qG, 1G, 1G; and that u acts as a product of twelve involutions (with
six ﬁxed points).
Therefore, the correspondence W has ﬁve degree-6 punctures above 0, mapping
respectively by degree 5 to 0, 1,8 and two other points (the sixth roots of unity); it

2 , z ÞÑ z ` i

1available from http://www-polsys.lip6.fr/~jcf/FGb/

SPHERE BISETS AND THEIR DECOMPOSITIONS

59

0

F

8

D

0

0

B

8

8

C

0

0

8

A

F

8

E

8

A

8

E

8

D

30 : 1

0

0

8

C

0

B

8

0

ζ6

ˆ

8

ˆ

1

ζ6
ˆ

0

1

ζ6
ˆ

ζ6
ˆ

8

0

ˆ

0

1

ˆ
ζ6

ζ6
ˆ

1

ˆ
ζ6

8

ˆ
ζ6

ζ6

ˆ

ζ6

ˆ

0

ζ6

ˆ

1

0

1 8

ˆ

8

8

ˆ

ζ6

0

16 : 1

ˆ
ζ6

Figure 4. The modular correspondence of g.

has similarly ﬁve degree-6 punctures above 8, mapping respectively by degree 5 to
0, 1,8 and the sixth roots of unity; and eighteen punctures above 1, twelve of degree
2 and six of degree 1, mapping by degree 1 to 0, 1,8 six times each. The surface W
has therefore 28 punctures and its Euler characteristic is 30 ¨ p2 ´ 3q “ ´30, so W
has genus 2. The correspondence is given in Figure 4, in the standard description
of holomorphic maps by shading the lower half plane.

The central component of the ﬁgure on the right is homeomorphic to a punctured
torus; it maps 4 : 1 to the disk, with the boundary mapping 4 : 1, one point (the
sixth root of unity ζ6) having two order-2 preimages, and three points having one
order-2 preimage (marked by a simple ˆ) and two regular preimages.
8.3. A Thurston map with inﬁnitely generated centralizer. Our last exam-
ple shows that centralizers of Thurston maps can be sometimes quite complicated,
and in particular not ﬁnitely generated (whence our notion of “sub-computable”).
We will also explicitly compute a biset of the form Mpf, A, Cq.
8.3.1. General construction. We consider a Thurston map f : pS2, A, Cq ý with
A “ A0 \ A1 \ A2. The map admits an annular obstruction C “ ts, tu, with s
separating A0 from A1 Y A2 and t separating A2 from A0 Y A1. The small spheres
S0, S1, S2 containing A0, A1, A2 respectively are ﬁxed by f , which acts on S0 and
S2 as the identity and acts on S1 as a rational map of degree 2.

All f -preimages of s and t map by degree 1. The curve s has a unique essential
preimage that is isotopic to s while t has 2ℓ ě 2 preimages isotopic to s and
2ℓ ` 1 ě 3 preimages isotopic to t. The Thurston matrix of f is therefore

Tf,C “ˆ1

0

2ℓ

2ℓ ` 1˙ .

60

LAURENT BARTHOLDI AND DZMITRY DUDKO

The case ℓ “ 1 is show in Figure 5.
We assume that all trivial f -preimages of S0, S1, S2 are of degree 1 and all an-
nular f -preimages of S1, S2 are of degree 2. (We remark that S0 has no annular
preimages.) The degree of f is thus 4ℓ ` 2.
The spheres S1 has ℓ annular preimages isotopic to s and ℓ annular preimages
isotopic to t. We denote them by U1, . . . , U2ℓ in order of increasing distance to S0.
Similarly, S2 has 2ℓ annular preimages isotopic to s or t, denoted T1, . . . , T2ℓ in
order of increasing distance to S0.

Let us next assume that #A1 “ 2 and that A1 is ﬁxed by f . Therefore, we

Recall that the restrictions of f to S0 and S2 are set to be the identity. We
assume #A2 ě 3 and we mark the points 8, x6, x7 P A2. For i ď ℓ we normalize

may normalize the restriction of f to S1 as z2 : ppC,t0,8, 1,´1uq ý so that 1 and
´1 correspond to curves t and s respectively. For i ą 1 we normalize f : pUi Ñ pS1
as z2 : ppC,t1,´1uq Ñ ppC,t0,8, 1,´1uq so that 1,´1 P pUi encode curves isotopic
to s if i ď ℓ, and isotopic to t if i ą ℓ. Finally we normalize f : pU1 Ñ pS1 as
z2 : ppC,t1, iuq Ñ ppC,t0,8, 1,´1uq so that 1, i P pUi encode curves isotopic to s.
f : pTi Ñ pS2 as z2`x6
: ppC,t1,´1uq Ñ ppC, A2Yt1uq so that x6,8 P A2 are the critical
values. The points 1,´1 P pTi encode curves isotopic to s while 1 P pS2 encodes the
curve t. For i ą ℓ we normalize f : pTi Ñ pS2 as z2`x7
: ppC,t1,´1uq Ñ ppC, A2 Y t1uq
so that x7,8 P A2 are the critical values. The points 1,´1 P pTi encodes curves
isotopic to t and 1 P pS2 encodes the curve t.

1`x6

1`x7

8.3.2. The mapping class biset Mpfq. We describe Mpf, A, Cq following the recipe
of §6.5. Write ModpS2, A, Cq “ eModpS2, A, CqˆvModpS2, A, Cq with eModpS2, A, Cq –

ÝÑ

1

Let us ﬁrst compute Gf ď vModpS2, A, C q, see (28). Write Gf “ Gf,0 ˆ Gf,1 ˆ

ial in ModpS2, A, Cq. Namely, a Dehn twist about a curve surrounding 1,´1
lifts to a Dehn twist around 1 which encodes t. By the same reasoning, every

ZC and vModpS2, A, Cq – ModppS0q ˆ ModppS1q ˆ ModppS2q.
Gf,2 with Gf,i ď ModppSiq. Since f : ppS1,t0,8, 1,´1uq ý factors as ppS1,t0,8, 1,´1uq z2
ÝÑ ppS1,t0,8, 1,´1uq, every element in ModppS1q is liftable through
ppS1,t0,8, 1uq
f : pS1,t0,8, 1,´1uq ý; the lift is trivial in ModppS1q but needs not be triv-
element in ModppS1q is liftable trough f : ppUi,t1,´1uq Ñ ppS1,t0,8, 1,´1uq for
i ą 1. On the other hand, the subgroup of liftable elements in ModppS1q under
f : ppU1,t1, iuq Ñ ppS2,t0,8, 1,´1uq has index two in ModppS1q: a Dehn twist about
a simple essential closed curve in ppS2,t0,8, 1,´1uq separating 1 from ´1 lifts to
a half twist about the simple closed curve in ppU1,t1, iuq separating 1 from i; this
gives an index two condition. Therefore, Gf,1 ď ModppS1q has index two.
Since f : ppTi,t1,´1uq Ñ ppS2, A2Yt1uq factors as ppTi,t0,8, 1,´1uq
ppS2, A2 Y t1uq, every element in ModppS2q is liftable trough f : ppTi,t1,´1uq Ñ
ppS2, A2Yt1uq. Since the restrictions of f to S0 and to S2 are the identity, every ele-
ment in ModppS0q and in ModppS2q is liftable through the global map f : pS2, A, Cq ý.
Therefore, Gf,0 “ ModppS0q and Gf,2 “ ModppS2q.

Since all f -preimages of s and t map by degree 1, the group Λ from (27) is
ZC with the actions of ZC given by n1 ¨ b ¨ n2 “ n1 ` b ` Tf,Cpn2q. The map

f

ÝÑ ppS2,tfp0q,8, 1uq

1

ÝÑ

SPHERE BISETS AND THEIR DECOMPOSITIONS

61

θf : Gf,0 ˆ Gf,1 ˆ Gf,2 Ñ Λ – ZC is computed as
(56)
θfpn0, n1, n2q “ pθ1
with θ1

1, θ1, θ2,s, θ2,t deﬁned as follows.

The map θ1

1pn1q`p2ℓ´1qθ1pn1q`2ℓθ2,spn2q,p2ℓ`1qθ1pn1q`2ℓθ2,tpn2qq P Zts,tu

If n be a Dehn twist about an essential simple closed curve

1pnq “ 0 if c does not separate 1 from ´1, and θ1

1pn2q “ 1 otherwise. (Recall

then θ1
that in the last case n R Gf,1).
the following way.

and 2ℓ ` 1 lifts isotopic to t. In the latter case none of the lifts of c is isotopic to a
curve in ts, tu.

1 : Gf,1 Ñ Z corresponds to lifting through f : ppU1,t1, iuq Ñ ppS1,t0,8, 1,´1uq.
If n be a positive Dehn twist about an essential simple closed curve c in ppS2,t0,8, 1,´1uq,
The map θ1 : Gf,1 Ñ Z is the restriction of θ1 : ModppS1q Ñ Z deﬁned in
c in ppS1,t0,8, 1,´1uq, then θ1pnq “ 1 if c is a peripheral curve around 1 in
ppS1,t0,8, 1uq, and θ1pnq “ 0 otherwise. In the former case c has exactly 2ℓ ´ 1
lifts isotopic to s (not counting lifting trough f : ppU1,t1, iuq Ñ ppS1,t0,8, 1,´1uq)
Suppose n is a Dehn twist about a curve c in ppS2, A2 Y t1uq. If c be a peripheral
curve in ppS2,tx6,8, 1uq around 1, then θ2,spnq “ 1; otherwise θ2,spnq “ 0. In the
in ppS2,tx7,8, 1uq around 1, then θ2,tpnq “ 1; otherwise θ2,spnq “ 0. In the former
Gf,1 the mapping class biset of f : pS1 ý with the right
Denote by ModppS1qM 1
Gf,1 – ModppS1qModppS1q1 b 1t¨uGf,1 .

action restricted to Gf,1. It was already shown that the action of Gf,1 on M 1 is
trivial; thus

former case c has exactly 2ℓ lifts isotopic to s. Similarly, if c is a peripheral curve

Then the decomposition in Theorem 6.16 takes the form

case c has exactly 2ℓ lifts isotopic to t.

ModppS1qM 1

ModpS 2,A,C qpZC ˙ ModppS0q ˆ M 1 ˆ ModppS2qqeModpS 2,A,C qˆGf b ModpS2, A, Cq.

8.3.3. Computation of the centralizer. Since the spectrum radius of C is greater
than 1, the canonical obstruction of f contains C ; but since C separates f into
rational and ﬁnite order maps, C is the canonical obstruction [29]. (Note that every
curve in S0 or S2 is a Levy cycle; but such curves are not part of the canonical
obstruction.) Therefore, Zpfq ﬁxes C and we may write

Zpfq ď ModpS2, A, Cq – ModppS0q ˆ ModppS1q ˆ ModppS2q ˆ ZC .

Furthermore, the projection of Zpfq into ModppS1q is trivial because the restriction
Consider an element pn0, n1, n2, vq P ModppS0q ˆ ModppS1q ˆ ModppS2q ˆ ZC .

of f to S1 is a rational self-map. Therefore, Zpfq is a subgroup of ModpS0q ˆ
ModpS2q ˆ ZC .
Then pn0, n1, n2, vq P Zpfq if and only if pn0, n1, n2, vq ¨ f “ f ¨ pn0, n1, n2, vq;
namely, if n1 “ 1 and v “ θpn0, n1, n2q ` Tf,Cpvq. Writing v “ pvs, vtq, we obtain
the equations θ2,spn2q “ θ2,tpn2q “ ´vt. Therefore, Zpfq is isomorphic to

ModppS0q ˆ Ztsu ˆ tn P ModppS2q | θ2,spn2q “ θ2,tpn2qu.

It is easy to see that the last factor is inﬁnitely generated, since it is the kernel of

an epimorphism from ModppS2q to Z. We compute it explicitly below in one case.

62

LAURENT BARTHOLDI AND DZMITRY DUDKO

x3

x4

z

x3

x4

z2

s

S0

8

0

8

x2

0

x5

8

0

x2

8

S1

0

x5

x18

x6

x7

z
x18

x6

x7

z2`x6
1`x6

z2`x7
1`x7

S2

t

Figure 5. A Thurston map with inﬁnitely generated centralizer

8.3.4. The case ℓ “ 1 and #A “ 7. These seem to produce the Thurston map of
smallest degree and size of critical set whose centralizer is inﬁnitely generated. The
map f has degree 6 and has 7 marked points, see Figure 5. They are labeled as
A0 “ tx3, x4u, A1 “ tx2, x5u and A2 “ tx1, x6, x7u.
compute some relations in its mapping class biset. We set

To compute the centralizer of f , we write down a presentation of Bpfq, and

G “ xx1, x2, x3, x4, x5, x6, x7 | x1x2x3x4x5x6x7y,

write s “ x3x4 and t “ x2x3x4x5, and in a basis tℓ1, . . . , ℓ7u we compute the
presentation

(57)

x1 “ !1, s, s´1, t, t´1, x1"p2, 3qp4, 5q,
x2 “ !1, 1, s´1, x2s, t´1, t"p1, 2qp3, 4qp5, 6q,
x3 “ !x3, 1, 1, 1, 1, 1",
x4 “ !x4, 1, 1, 1, 1, 1",
x5 “ !1, 1, x5, 1, 1, 1"p1, 2qp3, 4qp5, 6q,
x6 “ !1, 1, 1, 1, 1, x6"p2, 3q,
x7 “ !1, 1, 1, 1, 1, x7"p4, 5q,

SPHERE BISETS AND THEIR DECOMPOSITIONS

63

giving s “ !s, 1, 1, 1, 1, 1" and t “ !1, s, s´1, t, t´1, t". We write σ, τ, α, β for
Dehn twists about s, t, x1x6 and x6x7 respectively; their actions on G are given
respectively by

σ :

τ :

α :

β :

x3 ÞÑ xs
x2 ÞÑ xt
x1 ÞÑ xtx6t´1
x6 ÞÑ xx6x7

3, x4 ÞÑ xs
4,
3, x4 ÞÑ xt
2, x3 ÞÑ xt
, x6 ÞÑ xt´1x1tx6
, x7 ÞÑ xx6x7

,

1

6

6

7

4, x5 ÞÑ xt
5,

,

all other generators being ﬁxed. Naturally rσ, αs “ rτ, αs “ rσ, βs “ rτ, βs “ 1
while xα, βy is a free group of rank 2. We then compute

Bpfq ¨ σ – σ ¨ Bpfq,
Bpfq ¨ α – α ¨ σ2Bpfq,

Bpfq ¨ τ – σ2τ 3 ¨ Bpfq,
Bpfq ¨ β – β ¨ Bpfq.

For the second equality, the recursion of σ´2τ ´3¨Bpfq¨τ in basis ts2t3ℓ1, st3ℓ2, st3ℓ3, t2ℓ4, t2ℓ5, ℓ6u
coincides with (57), while for the third equality, the recursion of σ´2α´1 ¨ Bpfq ¨ α
in basis ts2ℓ1, s2ℓ2, ℓ3, . . . , ℓ6u coincides with (57).
Consider the homomorphism φ : xα, βy Ñ Z which counts the total exponent in
α of a word; it is the quotient by the normal closure of β. Then, for w P xα, βy, the
element wσmτ n belongs to the centralizer of f if and only if pm, nq “ pm ` 2n `
φpwq, 3nq, if and only if n “ 0 and w P kerpφq. Therefore,

Zpfq “ xσy ˆ kerpφq “ xσy ˆ xβ, βα, βαβ , . . .y – Z ˆ F8.

These calculations were checked using the computer algebra program Gap [16],
and its package Img, specially designed to manipulate wreath recursions. The
commands issued were:
gap> m := NewSphereMachine("x1=<,x3*x4,x4^-1*x3^-1,x2*x3*x4*x5,x5^-1*x4^-1*x3^-1*x2^-1,x1>(2,3)(4,5)",
"x2=<,,x4^-1*x3^-1,x2*x3*x4,x5^-1*x4^-1*x3^-1*x2^-1,x2*x3*x4*x5>(1,2)(3,4)(5,6)",
"x3=<x3,,,,,>","x4=<x4,,,,,>","x5=<,,x5,,,>(1,2)(3,4)(5,6)",
"x6=<,,,,,x6>(2,3)","x7=<,,,,,x7>(4,5)","x1*x2*x3*x4*x5*x6*x7");;
gap> g := StateSet(m);;
gap> AssignGeneratorVariables(g);; s := x3*x4;; t := x2*s*x5;;
gap> sigma := GroupHomomorphismByImages(g,[x1,x2,x3^s,x4^s,x5,x6,x7]);;
gap> tau := GroupHomomorphismByImages(g,[x1,x2^t,x3^t,x4^t,x5^t,x6,x7]);;
gap> alpha := GroupHomomorphismByImages(g,[x1^(t*x6/t),x2,x3,x4,x5,x6^(x1^t*x6),x7]);;
gap> beta := GroupHomomorphismByImages(g,[x1,x2,x3,x4,x5,x6^x7,x7^(x6*x7)]);;

gap> sigma*m = m*sigma;
true
gap> ChangeFRMachineBasis(tau*m/sigma^2/tau^3,[t^3*s^2,t^3*s,t^3*s,t^2,t^2,t^0]) = m;
true
gap> beta*m = m*beta;
true
gap> ChangeFRMachineBasis(alpha*m/alpha/sigma^2,[s^2,s^2,s^0,s^0,s^0,t^0]) = m;
true

References

[1] Laurent Bartholdi and Volodymyr V. Nekrashevych, Thurston equivalence of topological poly-
nomials, Acta Math. 197 (2006), no. 1, 1–51, DOI 10.1007/s11511-006-0007-3, available at
arXiv:math.DS/0510082. MR2285317 (2008c:37072)

[2] Laurent Bartholdi and Dzmitry Dudko, Algorithmic aspects of branched coverings (2015),

submitted, available at arXiv:cs/1512.05948.

64

[3]

[4]

[5]
[6]

LAURENT BARTHOLDI AND DZMITRY DUDKO

, Algorithmic aspects of branched coverings I. Van Kampen’s theorem for bisets (2015),

submitted, available at arXiv:cs/1512.08539.

, Algorithmic aspects of branched coverings III. Erasing maps and orbispaces, 2015,

in preparation.

, Algorithmic aspects of branched coverings IV. Expanding maps, 2015, in preparation.
, Algorithmic aspects of branched coverings V. Symbolic and ﬂoating-point algorithms,

2015, in preparation.

[7] Laurent Bartholdi and Xavier Buﬀ, Hurwitz space and its compactiﬁcation, 2015, preprint.
[8] Mladen Bestvina and Michael Handel, Train-tracks for surface homeomorphisms, Topology

34 (1995), no. 1, 109–140, DOI 10.1016/0040-9383(94)E0009-9. MR1308491 (96d:57014)

[9] Joan S. Birman and Caroline Series, An algorithm for simple curves on surfaces, J. Lon-
don Math. Soc. (2) 29 (1984), no. 2, 331–342, DOI 10.1112/jlms/s2-29.2.331. MR744104
(85m:57002)

[10] Marshall Cohen and Martin Lustig, Paths of geodesics and geometric intersection numbers. I,
Combinatorial group theory and topology (Alta, Utah, 1984), Ann. of Math. Stud., vol. 111,
Princeton Univ. Press, Princeton, NJ, 1987, pp. 479–500. MR895629 (88m:57016)

[11] Adrien Douady and John H. Hubbard, ´Etude dynamique des polynˆomes complexes. Par-
tie I, Publications Math´ematiques d’Orsay [Mathematical Publications of Orsay], vol. 84,
Universit´e de Paris-Sud, D´epartement de Math´ematiques, Orsay, 1984 (French). MR762431
(87f:58072a)

[12]

, ´Etude dynamique des polynˆomes complexes. Partie II, Publications Math´ematiques
d’Orsay [Mathematical Publications of Orsay], vol. 85, Universit´e de Paris-Sud, D´epartement
de Math´ematiques, Orsay, 1985 (French). With the collaboration of P. Lavaurs, Tan Lei and
P. Sentenac. MR812271 (87f:58072b)

[13]

, A proof of Thurston’s topological characterization of rational functions, Acta Math.

171 (1993), no. 2, 263–297. MR1251582 (94j:58143)

[14] David B. A. Epstein, Curves on 2-manifolds and isotopies, Acta Math. 115 (1966), 83–107.

MR0214087 (35 #4938)

[15] Benson Farb and Dan Margalit, A primer on mapping class groups, Princeton Mathematical

Series, vol. 49, Princeton University Press, Princeton, NJ, 2012. MR2850125

[16] The GAP Group, GAP — Groups, Algorithms, and Programming, Version 4.4.10, 2008.
[17] Pierre de la Harpe, Topics in geometric group theory, University of Chicago Press, Chicago,

IL, 2000. MR2001i:20081

[18] Geoﬀrey Hemion, On the classiﬁcation of homeomorphisms of 2-manifolds and the classiﬁ-
cation of 3-manifolds, Acta Math. 142 (1979), no. 1-2, 123–155, DOI 10.1007/BF02395059.
MR512214 (80f:57003)

[19] Adolf Hurwitz, Ueber Riemann’sche Fl¨achen mit gegebenen Verzweigungspunkten, Math.

Ann. 39 (1891), no. 1, 1–60, DOI 10.1007/BF01199469 (German). MR1510692

[20] Atsushi Kameyama, The Thurston equivalence for postcritically ﬁnite branched coverings,

Osaka J. Math. 38 (2001), no. 3, 565–610. MR1860841 (2002h:57004)

[21] Sarah Koch, Teichm¨uller theory and critically ﬁnite endomorphisms, Adv. Math. 248 (2013),

573–617, DOI 10.1016/j.aim.2013.08.019. MR3107522

[22] Sarah C. Koch, Kevin M. Pilgrim, and Nikita Selinger, Pullback invariants of Thurston maps,
Trans. Amer. Math. Soc., posted on 2015, DOI 10.1090/tran/6482, (to appear in print),
available at arXiv:math/1212.4568.

[23] Sergei K. Lando and Alexander K. Zvonkin, Graphs on surfaces and their applications, Ency-
clopaedia of Mathematical Sciences, vol. 141, Springer-Verlag, Berlin, 2004. With an appendix
by Don B. Zagier; Low-Dimensional Topology, II. MR2036721

[24] Wilhelm Magnus, Abraham Karrass, and Donald Solitar, Combinatorial group theory: Pre-

sentations of groups in terms of generators and relators, Interscience (New York), 1966.

[25] Dan Margalit and Jon McCammond, Geometric presentations for the pure braid group,
J. Knot Theory Ramiﬁcations 18 (2009), no. 1, 1–20, DOI 10.1142/S0218216509006859.
MR2490001 (2010a:20086)

[26] Curtis T. McMullen, Complex dynamics and renormalization, Annals of Mathematics Stud-

ies, vol. 135, Princeton University Press, Princeton, NJ, 1994. MR1312365 (96b:58097)

[27] Volodymyr V. Nekrashevych, Self-similar groups, Mathematical Surveys and Monographs,
vol. 117, American Mathematical Society, Providence, RI, 2005. MR2162164 (2006e:20047)

SPHERE BISETS AND THEIR DECOMPOSITIONS

65

[28] Jakob Nielsen, Surface transformation classes of algebraically ﬁnite type, Danske Vid. Selsk.

Math.-Phys. Medd. 21 (1944), no. 2, 89. MR0015791 (7,469c)

[29] Kevin M. Pilgrim, Combinations of complex dynamical systems, Lecture Notes in Mathemat-

ics, vol. 1827, Springer-Verlag, Berlin, 2003. MR2020454 (2004m:37087)

[30] Eliyahu Rips and Zlil Sela, Cyclic splittings of ﬁnitely presented groups and the canonical
JSJ decomposition, Ann. of Math. (2) 146 (1997), no. 1, 53–109, DOI 10.2307/2951832.
MR1469317 (98m:20044)

[31] Nikita Selinger, Topological characterization of canonical Thurston obstructions, J. Mod.

Dyn. 7 (2013), no. 1, 99–117, DOI 10.3934/jmd.2013.7.99. MR3071467

[32] William P. Thurston, On the geometry and dynamics of diﬀeomorphisms of surfaces, Bull.
Amer. Math. Soc. (N.S.) 19 (1988), no. 2, 417–431, DOI 10.1090/S0273-0979-1988-15685-6.
MR956596 (89k:57023)

[33] Heiner Zieschang, Elmar Vogt, and Hans-Dieter Coldewey, Surfaces and planar discontinuous
groups, Lecture Notes in Mathematics, vol. 835, Springer, Berlin, 1980. Translated from the
German by John Stillwell. MR606743 (82h:57002)

E-mail address: laurent.bartholdi@gmail.com

E-mail address: dzmitry.dudko@gmail.com

´Ecole Normale Sup´erieure, Paris and Mathematisches Institut, Georg-August Uni-

versit¨at zu G¨ottingen

