6
1
0
2

 
r
a

M
1

 

 
 
]
T
I
.
s
c
[
 
 

1
v
2
0
3
0
0

.

3
0
6
1
:
v
i
X
r
a

1

MIMO-NOMA Design for Small Packet Transmission in the

Internet of Things

Zhiguo Ding, Senior Member, IEEE, Linglong Dai, Senior Member, IEEE, and H. Vincent Poor, Fellow, IEEE

Abstract—A feature of the Internet of Things (IoT) is that some
users in the system need to be served quickly for small packet
transmission. To address this requirement, a new multiple-input
multiple-output non-orthogonal multiple access (MIMO-NOMA)
scheme is designed in this paper, where one user is served with its
quality of service (QoS) requirement strictly met, and the other
user is served opportunistically by using the NOMA concept. The
novelty of this new scheme is that it confronts the challenge that
most existing MIMO-NOMA schemes rely on the assumption
that users’ channel conditions are different, a strong assumption
which may not be valid in practice. The developed precoding and
detection strategies can effectively create a signiﬁcant difference
between the users’ effective channel gains, and therefore the
potential of NOMA can be realized even if the users’ original
channel conditions are similar. Analytical and numerical results
are provided to demonstrate the performance of the proposed
MIMO-NOMA scheme.

I. INTRODUCTION

The ﬁfth generation (5G) of mobile communications has
been envisioned to enable the future Internet of Things (IoT);
however, supporting the IoT functionality in 5G networks is
challenging since connecting billions of smart IoT devices
with diversiﬁed quality of service (QoS) requirements is not
a trivial task, given the constraint of scarce bandwidth [1].
Non-orthogonal multiple access (NOMA) provides an ideal
solution to provide massive connectivity by efﬁciently using
the available bandwidth resources [2], and has consequently
been included in 3GPP long term evolution (LTE) [3].

The key idea of NOMA is to ask the users to share
the same resources, such as frequency channels, time slots,
and spreading codes, whereas the power domain is used for
multiple access. The performance of NOMA in scenarios with
single-antenna users has been studied in [4] and [5]. Achieving
user fairness with different channel state information (CSI) in
NOMA systems has been addressed in [6], and the impact of
user pairing on NOMA has been investigated in [7].

Since the use of multiple-input multiple-output (MIMO)
techniques brings an extra dimension for further performance
improvements, the study of the combination of MIMO and
NOMA has received considerable attention recently. In [8]
and [9], the scenario in which users have a single antenna
has been considered, and various algorithmic frameworks for
optimizing the design of beamforming in the NOMA transmis-
sion system have been proposed. The sum rate has been used
as an objective function in [10] and [11] to formulate various
optimization problems in MIMO-NOMA scenarios. In [12] a

Z. Ding and H. V. Poor are with the Department of Electrical Engi-
neering, Princeton University, Princeton, NJ 08544, USA (email: {z.ding,
poor}@princeton.edu). Z. Ding is also with the School of Comput-
ing and Communications, Lancaster University, LA1 4WA, UK (email:
z.ding@lancaster.ac.uk). L. Dai is with the Tsinghua National Laboratory for
Information Science and Technology, Department of Electronic Engineering,
Tsinghua University, Beijing 100084, China (email: daill@tsinghua.edu.cn).

zero-forcing based MIMO-NOMA transmission scheme was
proposed without requiring the full CSI at the transmitter. A
signal alignment based precoding scheme was developed in
[13], and it requires fewer antennas at the users compared to
the scheme proposed in [12]. A more detailed literature review
can be found in [14].

In this paper, we consider a MIMO-NOMA downlink trans-
mission scenario with one transmitter sending data to two
users, e.g., an access point is serving two IoT devices. The
feature of the IoT that users have diversiﬁed QoS requirements
is utilized for the design of the MIMO-NOMA transmission.
Particularly, we consider that user 1 needs to be served quickly
for small packet transmission, i.e., with a low targeted data
rate, and user 2 is to be served with the best effort. Take
intelligent transportation as an example, where user 1 can be
a vehicle receiving the incident warning information which
is contained within a few bytes only. User 2 can be another
vehicle which is to perform some background tasks, such as
downloading multimedia ﬁles. The use of NOMA prevents the
drawback of conventional orthogonal multiple access (OMA)
that user 1 whose targeted data rate is small is served with a
dedicated orthogonal channel use. With NOMA, the users are
served at the same time/frequency/code, which means that the
bandwidth resources which are solely occupied by user 1 in
the case of OMA can be released to user 2 in NOMA.

Most existing NOMA schemes rely on a key assumption
that the users’ channel conditions are very different. Take
the MIMO-NOMA schemes proposed in [10] and [12] as
examples. Within the NOMA user pair, one user is assumed
to be deployed close to the base station, and the other is far
away from the base station. As shown in [7], this difference in
users’ channel conditions is crucial for realizing the potential
of NOMA. However, in practice, it is very likely that the
users who want to participate in NOMA have similar channel
conditions. Take our considered IoT scenario as an example,
where the two users are categorized by their QoS requirements,
not by their channel conditions. It is important to point out that
the situation in which users have similar channel conditions
can make the beneﬁts of implementing many existing NOMA
schemes very marginal.

The main contribution of this paper is to design two
sets of system parameters, precoding and power allocation
coefﬁcients, in order to ensure that the potential of NOMA can
be realized even if the users’ channel conditions are similar.
Firstly, the precoding matrix at the base station is designed
to degrade the effective channel gains at user 1 and improve
the effective channel gains at user 2, at the same time. As
a result, the users’ effective channel conditions become very
different, an ideal situation for the application of NOMA. The
reason to degrade user 1’s channel condition is that this user is
regarded as an IoT user to be served with a low data rate, and

2

design is to realize two goals simultaneously. One is to
meet the QoS requirement at user 1 strictly and the other is
to improve user 2’s experience in an opportunistic manner.
Alternatively, one can view the addressed NOMA scenario as
a special case of cognitive ratio networks, where user 1 is
a primary user whose QoS requirements need to be satisﬁed
strictly and user 2 is served opportunistically [7].

Assume that the QR decomposition of user 2’s channel

matrix, H2, is given by

HH

2 = Q2 ˜R2,

(3)

where Q2 is an M × M unitary matrix, and ˜R2 is an
M × N matrix obtained from the QR decomposition. Deﬁne
V2 as an M × N matrix collecting the N left columns of
Q2, and R2 is an N × N upper submatrix of ˜R2. From
the QR decomposition, we know that HH
2 = V2R2. The
precoding matrix P is set as P = V2, which is to improve the
signal strength at user 2. As can be seen from the following
subsection, this choice of the precoding matrix also degrades
the channel conditions at user 1, which makes user 1 analogous
to a cell edge user in a conventional NOMA setup.
User 2’s observation can be expressed as follows:

y2 = RH

2 s + n2,

(4)

where n2 is the noise vector. Since RH
2 is a lower triangu-
lar matrix, successive interference cancellation (SIC) can be
carried out to cancel inter-layer interference (between wi and
wj, i 6= j) and intra-layer interference (between si and wi).
Particularly, suppose that sj and wj from the previous layers,
j < i, are decoded successfully, whose outage probability will
be included for the calculation of the overall probability in the
next section. User 2 can decode the message intended for user
1 at the i-th layer, si, with the following signal-to-interference-
plus-noise ratio (SINR):

SINR2,i′ =

α2
β2
i [RH

i [RH
2 ]2

2 ]2
i,i + 1

i,i

ρ

,

(5)

where ρ denotes the transmit signal-to-noise ratio (SNR) and
[A]i,j denotes the element at the i-th row and the j-th column
of A. Denote the targeted data rate of user m at the i-th layer
by Rm,i. Provided that log(1 + SINR2,i′ ) > R1,i, user 2 can
successfully remove user 1’s message, si, from its i-th layer,
and its own message can be decoded with the following SNR:

SNR2,i = ρβ2

i [RH

2 ]2

i,i.

(6)

(7)

therefore, a weaker channel condition could still accommodate
this low data rate. Secondly, the power allocation coefﬁcients
are carefully designed to ensure that user 1’s QoS requirements
can be still met with its degraded channel conditions. Two
types of power allocation policies are developed in this paper.
One is to meet the user’s QoS requirements in the long term,
e.g., its targeted outage probability can be satisﬁed. The other
is to realize the user’s QoS requirements instantaneously, e.g.,
the power allocation coefﬁcients are designed to realize user
1’s targeted data rate for each channel realization.

Analytical results are developed to better demonstrate the
performance of the proposed MIMO-NOMA scheme. With the
long term power allocation policy, the developed analytical
results show that user 1’s targeted outage probability can be
strictly guaranteed, and the diversity gains at user 2 are the
same as in the case when user 2 is served alone. With the
short term power allocation policy, user 1’s outage experience
is the same as in the case when all the power is given to user
1, and the diversity gain achieved at user 2 is always one.
Therefore, between the two power allocation polices, user 2
prefers the long term one since the diversity gain it can obtain
is larger. However, the short term power allocation policy can
ensure that user 1’s QoS requirement is met instantaneously,
a property important to those safety-critical and real-time
applications in the IoT.

II. SYSTEM MODEL

Consider a MIMO-NOMA downlink transmission scenario
with one base station and two users, where the base station
is equipped with M antennas and each user is equipped with
N antennas. The N × M channel matrices of two users are
denoted by H1 and H2, respectively. Elements of the channel
matrices are identically and independent complex Gaussian
distributed with zero mean and unit variance. In this paper, we
focus on the scenario without path loss, i.e., two users have
similar channel conditions, which is a challenging situation
to realize the potential of NOMA. Furthermore, we assume
M ≥ N , a scenario in which existing MINO-NOMA schemes,
such as the ones in [12] and [13], cannot work properly.

Without loss of generality, we assume that user 1 needs to
be connected quickly to transmit small packets. For example,
this user can be an IoT device that needs to be served with a
small predeﬁned data rate. The base station will transmit the
following vector:

x = Ps,

(1)

where P is an M × N precoding matrix. The information
bearing vector s is constructed by using the NOMA approach
as follows:

User 1’s observation is given by

y1 = H1Ps + n1,

s =(cid:2)α1s1 + β1w1

· · · αN sN + βN wN(cid:3)T

where si is the i-th stream transmitted to user 1, αi is the
power allocation coefﬁcient for si, wi and βi are deﬁned
similarly, and α2

k + β2

k = 1.

As can be seen from (1) and (2), there are two sets of
parameters to be designed, the precoding matrix P and the
power allocation coefﬁcients αi (βi). The aim of the proposed

,

(2)

where n1 is an N ×1 noise vector. Analogously to the cell edge
user in a conventional NOMA network, user 1 is not to decode
wi, which means that the use of the QR based detection will
result in signiﬁcant performance loss, as discussed in Section
III-C. Therefore, zero forcing is applied at user 1. Particularly,
the system model at user 1 can be written as follows:

(H1V2)† y1 = s + (H1V2)† n1,

(8)

VH

2 HH

1 H1V2(cid:1)−1

where (H1V2)† = (cid:0)VH

1 . It is worth
pointing out that the dimension of V2 is M ×N , and therefore
H1V2 is an N × N square matrix, which means (H1V2)† =
(H1V2)−1. It is assumed here that the channel matrices are
full column rank. As a result, user 1 can decode its message
at the i-th layer with the following SINR:

2 HH

SINR1,i =

,

(9)

i zi

α2
i zi + 1
β2
.

ρ

where zi =

h(VH

2

HH
1

1

H1V2)−1ii,i

A. Impact of the Proposed Precoding Scheme

, (10)

The two users’ experiences with the proposed precoding
scheme are different. According to the previous discussions,
the reception reliability at user 2 is determined by the parame-
ter xi, where xi , [RH
i,i. Denote an M × (M − N ) complex
Gaussian matrix which is independent of H2 by B. The QR

2 ]2

decomposition of (cid:2)HH
2 B(cid:3) = Q2 ¯R2 =(cid:2)V2
(cid:2)HH

2 B(cid:3) is given by
¯V2(cid:3)(cid:20)
|

C

R2

0(M−N )×N D(cid:21)
}

{z

¯R2

2 ]2

i,i.

where ¯R is an M × M upper triangular matrix, ¯V2 is a
submatrix of Q2, C and D are the submatrices of ¯R2.
According to [15], the elements of ¯R are independent, and
the square of the i-th element on its diagonal follows the chi-
square distribution with 2(M − i + 1) degrees of freedom,
i.e., fxi(x) = xM −i
(M−i)! e−x. Therefore, more antennas at the
base station can improve the receive signal strength at user 2
which is a function of [RH

On the other hand, the reception reliability at user 1 is
degraded due to the use of the precoding matrix, P, as
explained in the following. Note that V2 is a unitary matrix
obtained from the QR decomposition based on H2. Because
H1 and H2 are independent, and also by using the fact that a
unitary transformation of a Gaussian matrix does not alter its
statistical properties, H1P is still an N ×N complex Gaussian
matrix, which means that the use of the proposed precoding
matrix shrinks user 1’s channel matrix from an M × N
complex Gaussian matrix to another complex Gaussian matrix
with smaller size. Note that the probability density function
, is
(pdf) of the effective channel gain,

1

given by

h(VH

2

HH
1

H1V2)−1ii,i

f

1

[(VH

2

HH
1

H1V2)−1]i,i

(z) = e−z,

(11)

which is no longer a function of M .

The impact of the proposed precoding scheme can be clearly
illustrated by using the following extreme example. Consider a
special case with N = 1, where the channel matrices become
1 × M vectors, denoted by h1 and h2, respectively. After
applying P,
the effective channel gain at user 2 is |h2|2
which becomes stronger by increasing M . On the other hand,
the effective channel gain at user 1 is always exponentially
distributed, and the use of more antennas at the base station
does not improve the transmission reliability at user 1.

3

B. Power Allocation Policies

Because the precoding matrix degrades user 1’s channel
conditions, the power allocation coefﬁcients αi (βi) needs to
be carefully designed to ensure that user 1’s QoS requirements
are met, which motivates the following two power allocation
policies.

1) Power allocation policy I: This approach is to meet user
1’s QoS requirements in the long term. Recall that the targeted
data rate for user 1 to decode its message at the i-th layer (si)
is denoted by R1,i. As a result, the outage probability for user
1 to decode si is given by

Po
1,i

, P (log(1 + SINR1,i) < R1,i) .

(12)

The power allocation coefﬁcients, αi and βi, are designed to
satisfy the following constraint:

Po

1,i ≤ P1,i,target,

(13)

where P1,i,target denotes the targeted outage probability. A
closed-form expression for the power allocation coefﬁcients
is given in Section III-A. The advantage of this type of power
allocation is that there is no need to update power allocation
coefﬁcients frequently, but
it cannot satisfy user 1’s QoS
requirements instantaneously.

2) Power allocation policy II: This approach is to meet
user 1’s QoS requirements instantaneously. This type of power
allocation is quite similar to the cognitive radio inspired
power allocation policy proposed in [7]. Particularly, the power
allocation coefﬁcients are deﬁned to ensure that the targeted
data rate of user 1 is met instantaneously, i.e.,

log(1 + SINR1,i) ≥ R1,i.

(14)

By deﬁning ǫk,i = 2Rk,i − 1, the above constraint yields the
following power allocation policy:

β2

i = max(0,

zi − ǫ1,i

zi(1 + ǫ1,i)) .

ρ

(15)

The above policy is sufﬁcient for those scenarios addressed
in [7] and [12], where users are ordered according to their
channel conditions. For the scenario addressed in this paper,
zi < xi does not always hold, and it is possible that the
effective channel gain of user 1 is stronger. If zi > xi, the
value of βi in (15) is a very poor choice for user 2, as it is
guaranteed that SIC at user 2 will fail. To ensure that SIC at
user 2 can be carried out successfully, we revise the power
allocation strategy as follows:

β 2

i = min(max(0,

ǫ1,i

zi −

zi(1 + ǫ1,i)) , max(0,

ρ

xi −

ǫ1,i

ρ

xi(1 + ǫ1,i)

,)) .

(16)

This is to ensure that user 1’s message can be decoded by
both users with the best effort. In an extreme case with xi → 0
and a ﬁxed zi, βi = 0, i.e., the cognitive radio user, user 2,
will not be admitted.

Note that it is also possible to reverse the decoding order
when zi > xi. In this case, we need to ensure that the

following two conditions are satisﬁed. One is to ensure that
user 1 can decode the message intended for user 2, wi,

log 1 +

ziβ2
i

ziαi + 1

ρ! ≥ R2,i,

(17)

and the other is to ensure user 1 can decode its own message,

log(cid:0)1 + ρziα2

i(cid:1) ≥ R1,i.

As a result, user 1’s outage experience becomes a function of
R2,i which is user 2’s targeted data rate, since user 1 needs
to decode user 2’s message ﬁrst. When user 2’s targeted data
rate is varying, there is an uncertainty as to whether user 1’s
QoS requirements can be met strictly. Therefore, this type of
reverse NOMA decoding is not considered in this paper.

(18)

III. OUTAGE PERFORMANCE AT USER 1

User 1’s outage performance will be studied in the follow-
ing two subsections with the two different power allocation
policies.

A. Power Allocation Policy I

Recall that the outage probability for user 1 to detect si can

be expressed as follows:

P0

1,i = P xi <

ǫ1,i
ρ

i ǫ1,i! ,

i − β2
α2

(19)

When power allocation policy I is adopted, the power alloca-
tion coefﬁcients are set to meet user 1’s QoS requirements
in the long term, which means that neither αi or βi
is a
function of instantaneous channel gains. Therefore, the outage
probability in this case is the cumulative distribution function
(CDF) of

.

1

h(VH

2

HH
1

H1V2)−1ii,i

By using the pdf in (11), the outage probability can be

expressed as follows:

P0

1,i = 1 − e

ǫ1,i

−

ρ
−β2
i

α2
i

ǫ1,i .

(20)

In order to ensure Po
coefﬁcients need to be set as follows:
ǫ1,i

1,i ≤ P1,i,target, the power allocation

1 +

β2
i =

ρ ln(1−P1,i,target)
1 + ǫ1,i

.

(21)

Note that 1−P1,i,target ≤ 1, which means ln(1−P1,i,target) ≤ 0.
Therefore, the choice of βi in (21) is always smaller than
or equal to one, i.e., βi ≤ 1. In order to ensure the choice
> 0,
of βi in (21) positive or equivalently
the following constraint is imposed on the targeted outage
probability:

ρ ln(1−P1,i,target )

1+ǫ1,i

ǫ1,i

1+

1 > P1,i,target > 1 − e−

ǫ1,i
ρ .

(22)

We ignore the choice of P1,i,target = 1, since this choice does
not consider user 1’s QoS requirements. The righthand side
of the above equation is a lower bound of the targeted outage
probability which is achieved by giving all the power to user 1.
Or in other words, if the targeted outage probability is smaller

4

ǫ1,i

than or equal to (cid:16)1 − e−

ρ (cid:17), we will have βi = 0 and the

addressed NOMA scenario is degraded to the case in which
only user 1 is served. Therefore, in the remainder of this paper,
it is assumed that the targeted outage probability is chosen to

be larger than (cid:16)1 − e−

ǫ1,i

ρ (cid:17) when power allocation policy I

is used, in order to avoid the trivial case of βi = 0.

B. Power Allocation Policy II

While the power allocation coefﬁcients are set to ensure
log(1 + SINR1,i) ≥ R1,i, outage can still occur at user 1 since
this ideal choice of power allocation might not be feasible due
to deep fading, i.e., a situation with very small channel gains
can result in βi = 0. Rewrite the expression of βi in (16) as
follows:

where

β2
i,z

=

β2

i,z, β2

i = min(cid:8)β2
max(cid:26)0,

i,x(cid:9) ,
zi(1+ǫ1,i)(cid:27),

zi−

ǫ1,i

ρ

(23)

β2
i,x

=

ρ

ǫ1,i

xi−

max(cid:26)0,

xi(1+ǫ1,i)(cid:27), αi,x and αi,z are deﬁned similarly.

Note that when xi > zi, βi,x ≥ βi,z, otherwise βi,x ≤ βi,z.
With these deﬁnitions, the outage probability for user 1 to
detect si can be expressed as follows:

(24)

P0

1,i = P (log(1 + SINR1,i) < R1,i)
ziα2
i,z
i,z + 1

ziβ2

= P xi > zi, log 1 +
|
{z
+ P zi > xi, log 1 +
{z
|

T1

T2

ziα2
i,x
i,x + 1

ziβ2

ρ! < R1,i!
}
ρ! < R1,i!
}

.

ziα2

First consider the case of xi > zi. If βi,z 6= 0, we have

log(cid:16)1 +

ρ(cid:17) = R1,i, which means that no outage

occurs. Therefore, the outage event when xi > zi is due to
βi = 0, and therefore, T1 can be simpliﬁed as follows:

i,z+ 1

ziβ2

i,z

T1 = P(cid:18)xi > zi, zi <

ǫ1,1

ρ (cid:19) .

The second factor T2 can be expressed as follows:

T2 = P xi < zi <
= P


xi < zi <

ǫ1,i
ρ

i,xǫ1,i!

i,x − β2
α2

1 − max(cid:26)0,

ǫ1,i
ρ

ρ

ǫ1,i

xi−

xi(1+ǫ1,i)(cid:27) (1 + ǫ1,i)

(25)

(26)

.




In order to explicitly show the outage events, the factor T2

the messages intended for user 2, the system model for the
i-th stream at user 1 can be rewritten as follows:

(27)

˜y1,i = [R1]i,iαisi + [R1]i,iβiwi

(30)

5

+

N

Xj=i+1

([R1]i,jαj sj + [R1]i,jβjwj) + n1,i.

where ˜y1,i is the i-th element of QH
1 y1 and n1,i is deﬁned
similarly. Consider an ideal case in which sj has been decoded
correctly. By using this assumption, the outage probability at
user 1 can be lower bounded as follows:

can be written as follows:

ǫ1,i
ρ

xi < zi <

T2 = P

min(cid:26)1,
= P(cid:18)xi < zi < max(cid:26) ǫ1,i
= P(cid:18)xi < zi <

ǫ1,i

ρ

ǫ1,i

ρ



xi (cid:27)
, xi(cid:27)(cid:19)

ρ (cid:19) + P(cid:18)xi < zi < xi,

ǫ1,i
ρ

< xi(cid:19) .

Since the second probability in the above equation is zero, the
overall outage probability can be calculated as follows:

P0

1,i = P(cid:18)xi > zi, zi <
= P(cid:18)zi <

ǫ1,1

ρ (cid:19) = 1 − e−

ǫ1,i
ρ ,

ǫ1,1

ρ (cid:19) + P(cid:18)xi < zi <

ǫ1,i

ρ (cid:19) (28)

which means that the diversity gain for user 1 to decode si is
one.

Remark 1: Consider a benchmark scheme with βi = 0, i.e.,
user 2 is not served at all. By using zero forcing detection at
user 1’s receiver, it is straightforward to show that the outage
probability achieved by this benchmark scheme is exactly the
same as the one in (28). The reason for this phenomenon
is that power allocation policy II is to ensure that the QoS
requirements of user 1 is met instantaneously, while user 2 is
served under the condition that the outage probability at user
1 is not degraded compared to the case with user 1 served
alone.

is straightforward to show that

using the zero forcing approach, i.e., P = (cid:0)HH

Remark 2: Another interesting benchmark scheme is to
consider that the precoding matrix is designed for user 1 by
1 .
HH
It
this benchmark scheme
achieves a diversity gain of (M − N + 1) for each stream,
by following steps similar to those in [12]. This diversity gain
loss is because the precoding matrix P proposed in this paper
shrinks user 1’s channel matrix from an N × M complex
Gaussian matrix to an N × N complex Gaussian matrix. This
degradation is caused on purpose in order to ensure that the
two users’ channel conditions become very different.

1 H1(cid:1)−1

C. When User 1 Adopts the QR Based Approach

Instead of zero forcing, user 1 can also use the QR based
approach for detection. In the following, we will show that
the performance of the QR based approach is worse than that
of the zero forcing one introduced in the previous section.

Suppose that the effective channel matrix at user 1 has the
QR decomposition as H1V2 = Q1R1, and therefore, the
observation at user 1 can be expressed as follows:

QH

1 y1 = R1s + QH

1 n1.

(29)

Recall that H1V2 is an N × N complex Gaussian matrix.
Therefore, [R1]2
i,i is chi-squared distributed with 2(N − i + 1)
degrees of freedom. Unlike user 2, user 1 needs to decode the
i-th stream ﬁrst before decoding the j-th stream, N ≥ i >
j ≥ 1, since R1 is an upper triangular matrix and RH
2 is a
lower triangular matrix. Since user 1 does not need to decode

PN

Po

1,i ≥ P 
≥ P 

[R1]2

i,iα2

i

i +PN

i,iα2

[R1]2

i

j=i+1[R1]2

i,jβ2

j + 1

ρ

[R1]2

i,iβ2

j=i+1[R1]2

i,jβ2

j + 1

ρ

< ǫ1,i! ,

< ǫ1,i! (31)

j=i+1[R1]2

βj = βi, for i 6= j. Deﬁne ui = PN

where 1 ≤ i < N . In order to obtain some insight, we
focus on the case with power allocation policy I, and assume
i,j. According
i,j with
to [15], the entries of R1 are independent, and [R1]2
i < j is exponentially distributed, which means ui is chi-
square distributed with 2(N − i) degrees of freedom, i.e.,
fui(u) = uN −i−1
(N −i−1)! e−u. It is straightforward to verify that user
1’s outage probability becomes a non-zero constant, regardless
of how large the SNR is. Since Po
1,i is lower bounded by
a non-zero constant, this means that, when the QR based
approach is used, the outage probability at user 1 never goes to
zero, even if the transmission power becomes inﬁnite. Recall
that the use of zero forcing can effectively cancel the inter-
layer interference at user 1. For this reason, only zero forcing
detection is considered at user 1 in this paper.

IV. OUTAGE PERFORMANCE AT USER 2

Since user 2 experiences differently with different power
allocation policies, two subsections are provided in the fol-
lowing to study the two scenarios.

A. Power Allocation Policy I

Recall that SIC is carried out at user 2 to remove both intra-
layer and inter-layer interference. The outage event for user 2
to decode its own message at the i-th layer can be expressed
as follows:

O2,i , [m∈{1,··· ,i}

˜O2,m,

where ˜O2,m denotes an event that user 2 cannot successfully
decode the messages at the m-th layer, sm and wm, while all
the messages in the previous layers, sn and wn, for 1 ≤ n <
m, can be decoded correctly. Note that ˜O2,m ∩ ˜O2,n = ∅, for
m 6= n.

Since there are two messages at each layer, the outage event

˜O2,m can be further expressed as follows:

where the two events are deﬁned as follows:

˜O2,m = ¯Em,1[ ¯Em,2,

• ¯Em,1: the event that user 2 cannot decode sm, but can
decode all the messages from the previous layers, sn and
wn, for 1 ≤ n ≤ (m − 1);

• ¯Em,2: the event that user 2 cannot decode wm, but can
decode sm, as well as sn and wn, for 1 ≤ n ≤ (m − 1) .

Note that ¯Em,1 ∩ ¯Em,2 = ∅.

By using the above deﬁnitions, the outage probability for
user 2 to decode its own message at the i-th layer can be
expressed as follows:

i

Po

2,i =

Xm=1(cid:0)P(cid:0) ¯Em,1(cid:1) + P(cid:0) ¯Em,2(cid:1)(cid:1) .

(32)

expressed as follows:

log (1 + SINR2,n′) > R1,n,
log (1 + SNR2,n) > R2,n, ∀ n ∈ {1, · · · , m − 1}) .

The ﬁrst type of the outage probability P(cid:0) ¯Em,1(cid:1) can be
P(cid:0) ¯Em,1(cid:1) = P (log (1 + SINR2,m′ ) < R1,m,
Similarly the outage probability P(cid:0) ¯Em,2(cid:1) can be expressed
P(cid:0) ¯Em,2(cid:1) = P (log (1 + SNR2,m) < R2,m,

log (1 + SINR2,m′) > R1,m,
log (1 + SINR2,n′) > R1,n,
log (1 + SNR2,n) > R2,n, ∀ n ∈ {1, · · · , m − 1}) .
above

case of m = 1,

as follows:

By using the SINR expression in (5) and the above deﬁni-

P (log (1 + SINR2,1′ ) < R1,1)
P (log (1 + SNR2,1) < R2,1, log (1 + SINR2,1′) > R1,1) .

outage probabilities can be simpliﬁed as P(cid:0) ¯E1,1(cid:1) =
tions, P(cid:0) ¯Em,1(cid:1) can be expressed as follows:
P(cid:0) ¯Em,1(cid:1) = P log 1 +

ρ! < R1,m,

α2
mxm + 1
β2

P(cid:0) ¯E1,2(cid:1)

mxm

Note

(33)

(34)

that

and

the

the

for

=

nxn

α2
nxn + 1
β2

ρ! > R1,n,

log 1 +
log(cid:0)1 + β2

nxn(cid:1) > R2,n, ∀ n ∈ {1, · · · , m − 1}(cid:1) .

Provided that power allocation policy I is used, the power
coefﬁcients are not a function of instantaneous channel gains,
which yields the following:

P(cid:0) ¯Em,1(cid:1) = P xm <
Yn=1

P xn >

m−1

α2

×

ǫ1,m

ρ
m − β2

α2

mǫ1,m!

ǫ1,n

ρ

n − β2

nǫ1,n

, xn >

ǫ2,n
ρβ2

n! .

i > β2

for α2
i ǫ1,i, ∀ i ∈ {1, · · · , m}, otherwise the probability
is one. Note that (35) follows from the fact that the elements
on the diagonal of R2, xm, are independent. It can be veriﬁed
that the choice of βi in (21) can always ensure α2
i ǫ1,i
since

i > β2

α2
i − β2

i ǫ1,i = 1 − β2

i (1 + ǫ1,i)

ǫ1,i

≥ −

ρ ln(1 − P1,i,target)

(36)

> 0,

where P1,i,target < 1 as deﬁned in (22).

By applying the pdf of xm, the above probability can be

obtained as follows:

6

m−1

P(cid:0) ¯Em,1(cid:1) =

Yn=1
1 −

×

γ(M − m + 1, ξm)

(M − m)!

(37)

no(cid:17)
γ(cid:16)M − n + 1, maxnξn, ǫ2,n

(M − n)!

ρβ2


 ,

ǫ1,m

where ξm =
ρ
m−β2
mǫ1,m
gamma function [16].

α2

and γ(·) denotes the incomplete

follows:

m−1

Similarly the probability of P(cid:0) ¯Em,2(cid:1) can be calculated as
no(cid:17)
γ(cid:16)M − n + 1, maxnξn, ǫ2,n


P(cid:0) ¯Em,2(cid:1) =
1 −

× hγ(cid:16)M − m + 1, ǫ2,m
m(cid:17) − γ(M − m + 1, ξm)i

ρβ2
(M − m)!

Yn=1

(M − n)!

(38)

ρβ2

,

if ǫ2,m
ρβ2
m
Hence, the outage probability for user 2 to decode its own

≥ ξm, otherwise P(cid:0) ¯Em,2(cid:1) = 0.

message at the i-th layer can be expressed as follows:

Po

2,i =

i

Xm=1
Yn=1

×

}(cid:17)

(39)

ρβ2
m

(M − m)!

γ(cid:16)M − m + 1, max{ξm, ǫ2,m

1 −

(M − n)!

no(cid:17)
γ(cid:16)M − n + 1, maxnξn, ǫ2,n


 .

ρβ2

m−1

At high SNR, i.e., ρ approaches inﬁnity, for a ﬁxed P1,i,target
which is constrained as in (22) and not a function of ρ, it
is straightforward to show that both ξm and ǫ2,m
approach
ρβ2
m
zero. Therefore, the outage probability can be approximated
as follows:

Po

2,i =




(40)

i

m−1

M−n

M−m

γj
m


1 − e−γm
j! 
Xm=1
Xj=0



j!

e−γn
Yn=1
Xj=0



Xm=1

(M − m + 1)!

γM−m+1
m

γj
n

×

≈

i

γM−i+1
m

(M − i + 1)!

,

where γm = max{ξm, ǫ2,m
}. By using this high SNR approx-
ρβ2
m
imation, one can ready ﬁnd that the diversity gain for user 2
to decode wi is (M − i + 1).

Remark 3: In Section V, we will also use another choice of
xǫ1,i
the targeted outage probability, i.e., P1,i,target = 1 − e−
,
where x is not a function of ρ and x > 1. This targeted
outage probability becomes a function of ρ. First note that
this choice of P1,i,target still ﬁts the range deﬁned in (22).
Although this choice of P1,i,target is a function of ρ, the
approximation developed in (40) is still applicable, as ex-
plained in the following. With P1,i,target = 1 − e−
, the
i = 1− 1
. When
power allocation coefﬁcient βi becomes β2

xǫ1,i

ρ

ρ

x
1+ǫ1,i

(35)

≈

ρ approaches inﬁnity, ξm = xǫ1,i
is approaching zero, and
the same conclusion can be made for ǫ2,m
. As a result, the
ρβ2
m
diversity order shown in (40) is also applicable to the case
with P1,i,target = 1 − e−

xǫ1,i

.

ρ

ρ

B. Power Allocation Policy II

2 HH

With this type of power allocation, the power allocation
coefﬁcients become functions of the instantaneous channel
gains, and this fact makes the evaluation of the outage prob-
ability very challenging, as explained in the following. First
. As a result, the power
allocation coefﬁcient for user 2 can be expressed as follows:

deﬁne yii = h(cid:0)VH
0, min
i = max


max(cid:26)0,
(1+ǫ1,i) (cid:27), a policy conventionally used in [7],

1 H1V2(cid:1)−1ii,i
ρ (cid:17)
yii(cid:16) 1

Even if we can reduce the expression of β to β2

the power allocation coefﬁcient βi is still a function of yii,
which means that the outage probability for user 2 to detect
wi can be written as follows:

,




xi(1 + ǫ1,i)

(1 + ǫ1,i)

yii(cid:16) 1

i =

ǫ1,i
ρ (cid:17)

xi −

(41)

β 2

ǫ1,i

ǫ1,i

yii

yii

−

,

.

ρ

−

Po

y11,··· ,yii

2,i =Z · · ·Z
Yn=1

m−1

×

M−m

i


1 − e−γm
Xm=1
Xj=0


j!

e−γn
Xj=0




M−n

γj
n

γj
m

j! 




× fy11,··· ,yii(y11, · · · , yii)dy11 · · · dyii,

(42)

where the outage probability expression in (40) is used,
and fy11,··· ,yii(y11, · · · , yii) is the joint pdf of (y11, · · · , yii).
Recall that yii is the i-th element on the diagonal of the inverse

Wishart matrix W−1 , (cid:0)VH

joint pdf can be obtained by calculating the marginal pdf of
W−1 as follows: [17]

1 H1V2(cid:1)−1. Note that the

2 HH

fy11,··· ,yii(y1, · · · , yi)

(43)

e−tr(W−1)dy12 · · · dyN (N −1)

Γ

yij ,∀i6=j (cid:0)det W−1(cid:1)2N
=Z · · ·Z
2 QN

N (N −1)

where Γ = π

j=1 Γ(N − j + 1).

Because of the correlation among yii shown in (43) and the
complicated form of the power allocation coefﬁcients in (41),
a closed-form expression for the outage probability for user 2
to decode wi cannot be found. In the following, we will focus
on the development of upper and lower bounds on the outage
probability, which will be used for the analysis of the diversity
gain achieved by the proposed MIMO-NOMA scheme at user
2.

1) Upper and lower bounds on the outage probability:

By using the deﬁnitions provided in Section IV-A, the outage
probability for user 2 to decode its own message at the i-th
layer can be expressed as follows:

Po

2,i =

i

Xm=1(cid:0)P(cid:0) ¯Em,1(cid:1) + P(cid:0) ¯Em,2(cid:1)(cid:1) .

(44)

7

In the following, we ﬁrst focus on the development of an upper

can be upper bounded as follows:

bound on the outage probability. The probability, P(cid:0) ¯Em,1(cid:1),
P(cid:0) ¯Em,1(cid:1) ≤ P (log (1 + SINR2,m′ ) < R1,m) .
Similarly we can upper bound P(cid:0) ¯Em,2(cid:1) as follows:
P(cid:0) ¯Em,2(cid:1) ≤ P (log (1 + SNR2,m) < R2,m,

log (1 + SINR2,m′) > R1,m) .

(45)

(46)

By using the SINR expression in (5), the upper bound on

α2

P(cid:0) ¯Em,1(cid:1) can be expressed as follows:
P(cid:0) ¯Em,1(cid:1) ≤ P zm < xm <
|
{z
+ P zm > xm, xm <
|
{z

Q2

Q1

ǫ1,m

ρ
m − β2

ǫ1,m

mǫ1,m!
}
mǫ1,m!
}

.

ρ
m − β2

α2

The reason to have the two probabilities, Q1 and Q2, is that the
power allocation coefﬁcient βi has different forms depending
on the relationship between xm and zm.

By substituting the expression for βi when zm < xm, the

(47)

ǫ1,m

ρ )

zm(1+ǫ1,m)(cid:27) (1 + ǫ1,m)

To simplify the outage probability, the max function needs to
be removed, and we have the following:

factor Q1 can be expressed as follows:

ǫ1,m

ρ

ǫ1,m

1 − β2

ρ
(zm−

zm < xm <

m(1 + ǫ1,m)!

1 − max(cid:26)0,

Q1 = P zm < xm <
= P

Q1 = P

min(cid:26)1,
= P(cid:18)zm < xm < max(cid:26) ǫ1,m
= P(cid:18)zm < xm <



zm (cid:27)
, zm(cid:27)(cid:19)
ρ (cid:19) + P(cid:18) ǫ1,m

zm < xm <

ǫ1,m

ǫ1,m

ǫ1,m

ρ

ρ

ρ

ρ

(48)

.




(49)

< zm < xm < zm(cid:19) .

Note that the second probability in the above equation is zero.
Since an upper bound is of interest, we have

Q1 ≤ P(cid:18)zm <

ǫ1,m

ρ (cid:19) ∼

1
ρ

.

The factor Q2 can be calculated as follows:

Q2 = P (zm > xm,

(50)

(51)

xm <

1 − max(cid:26)0,

= P(cid:18)zm > xm, xm < max(cid:26) ǫ1,m

ρ

ǫ1,m

ǫ1,m

ρ )

ρ
(xm−



xm(1+ǫ1,m)(cid:27) (1 + ǫ1,m)
, xm(cid:27)(cid:19) .

By using the two possible choices of xm, the above probability
can be further upper bounded as follows:

> xm(cid:19)

(52)

ǫ1,m

ρ

,

,

ρ

1

ǫ1,m

ǫ1,m

the ﬁrst

Q2 = P(cid:18)zm > xm, xm <
ρ (cid:19) ∼
≤ P(cid:18)xm <
ρ , xmo = xm for ǫ1,m
P(cid:18)zm > xm, xm < max(cid:26) ǫ1,m

equation follows

ρ

ρM−m+1

where

maxn ǫ1,m

user 2 can decode sm for sure, i.e.,

for ǫ1,m

ρ < xm.

from the

that
ρ < xm, a situation in which

fact

, xm(cid:27)(cid:19) = 0,

α2

ǫ1,m

< xm <

ρ
m − β2

On the other hand, P(cid:0) ¯Em,2(cid:1) can be calculated as follows:
mρ!
P(cid:0) ¯Em,2(cid:1) ≤ P zm < xm,
|
}
+ P zm > xm,
|

mρ!
}

The factor Q3 can be written as follows:

ρ
m − β2

ǫ2,m
β2

ǫ2,m
β2

< xm <

{z

{z

mǫ1,m

mǫ1,m

(53)

ǫ1,m

α2

Q4

Q3

.

Furthermore, the factor Q4 can be calculated as follows:

8

Q4 =P


1 − max(cid:26)0,

ǫ1,m

ρ
(xm−

<

(57)

,

ρ

ǫ1,m

ǫ1,m

ρ )

ρ )

ǫ1,m

ǫ2,m
(xm−

xm(1+ǫ1,m)(cid:27) ρ

xm(1+ǫ1,m)(cid:27) (1 + ǫ1,m)
, zm > xm

< xm, zm > xm(cid:19)
, zm > xm


 ,

xm <

(xm−
xm(1+ǫ1,m) ρ

(xm−
xm(1+ǫ1,m) ρ

ρ (cid:19) + P

ǫ2,m
ǫ1,m

ǫ2,m
ǫ1,m

, xm <

ρ )

ρ )

ρ

ρ

ǫ1,m

ǫ1,m

ǫ1,m

xm <

=
(a)

max(cid:26)0,
P(cid:18)xm <
+ P

≤ P(cid:18)xm <

xm >

where the step (a) is due to the fact that, when xm > ǫ1,m
and zm > xm, user 2 can always decode sm, since log(1 +
SINR2,m′) = R1,m.

ρ

According to (55), the factor Q4 can be upper bounded as

follows:

ǫ1,m

ρ
(zm−

ǫ1,m

ρ )

zm(1+ǫ1,m)(cid:27) (1 + ǫ1,m)
, zm < xm


< xm, zm < xm(cid:19)

ρ

< xm <

Q4 ≤ P(cid:18)xm <

1

∼

ρM−m+1

ǫ1,m

ρ (cid:19) + P(cid:18)xm <

.

ǫ1,m + ǫ2,m + ǫ1,mǫ2,m

ρ

(cid:19)

(58)

By combining (44), (50), (52), (56) and (58), we can conclude
that a lower bound on the diversity gain at user 2, obtained
from the upper bound on the outage probability, is 1.

A lower bound on the outage probability can obtained as

follows:

(54)

by focusing the case of m = 1. Following (54), the factor Q3
with m = 1 can be calculated as follows:

1 − max(cid:26)0,

ǫ2,m
(zm−

ǫ1,m

ρ )

zm(1+ǫ1,m)(cid:27) ρ

ǫ1,m

,

ǫ1,m

ρ

ǫ1,m

ρ

Q3 = P

max(cid:26)0,
= P(cid:18)zm <
+ P
zm >
≤ P(cid:18)zm <

, zm < xm <

ǫ2,m
ǫ1,m

(zm−
zm(1+ǫ1,m) ρ

ρ )

ǫ1,m

ρ (cid:19) + P


zm <

ǫ2,m
ǫ1,m

(zm−
zm(1+ǫ1,m) ρ

ρ )

, zm < xm




.

It is interesting to observe that the second probability in the
above equation can be rewritten as follows:

ǫ2,m
ǫ1,m

(zm−
zm(1+ǫ1,m) ρ

ρ )

zm <

P

= P(cid:18)zm <




ρ

ǫ1,m + ǫ2,m + ǫ1,mǫ2,m

(cid:19) .

(55)

Therefore, the factor Q3 can be upper bounded as follows:
ǫ1,m + ǫ2,m + ǫ1,mǫ2,m

ǫ1,m

Q3 ≤ P(cid:18)zm <

ρ (cid:19) + P(cid:18)zm <

ρ

(cid:19)

.

(56)

∼

1
ρ

Q3 ≥ P(cid:18)z1 <
= P(cid:18)z1 <
= P(cid:18)z1 <
ρ (cid:17) ∼ 1

Po

2,i ≥P(cid:0) ¯E1,2(cid:1) ≥ Q3,

,

ǫ1,1
ρ
ǫ1,1

ǫ1,1
ρ

< x1(cid:19)
ρ (cid:19) − P(cid:18)z1 <
ρ (cid:19)(cid:18)1 − P(cid:18)x1 <

ǫ1,1

ǫ1,1
ρ

(59)

(60)

ǫ1,1

, x1 <

ǫ1,1

ρ (cid:19)
ρ (cid:19)(cid:19) ∼
ρ (cid:17) ∼ 1

1
ρ

,

since z1 is independent of x1, P(cid:16)z1 < ǫ1,1
P(cid:16)x1 < ǫ1,1

Since both upper and lower bounds converge, we can
conclude that the diversity gain for user 2 to decode wi is
one, when power allocation policy II is used.

ρ and

ρM .

Remark 4: Note that the diversity gain obtained above is the
same as that at user 1, when power allocation policy II is used.
This is consistent with the conclusion made in [7], where the
diversity gain at the user with stronger channel conditions is
determined by the channel conditions of its partner, when the
cognitive radio inspired power allocation policy is applied.

V. NUMERICAL STUDIES

In this section, the performance of the proposed MIMO-
NOMA scheme is evaluated by using simulation results. We
will ﬁrst compare the proposed scheme with some existing
MIMO-NOMA and MIMO-OMA schemes. Then, additional
simulation results are provided to demonstrate the impact of
different choices of the system parameters, where analytical
results developed in the paper will also be veriﬁed.

A. Comparison to Benchmark Schemes

To simplify the simulation comparison, power allocation
policy I is used in this subsection. The targeted data rates for
two users are set as R1,i = 1 bit per channel user (BPCU)
and R2,i = 4 BPCU, for all 1 ≤ i ≤ N , respectively.
The targeted outage probabilities for the two users are set
2ǫ2,i
as P1,i,target = 1 − e−
,
respectively. Using these targeted outage probabilities and the
step in (21), the power allocation coefﬁcients can be obtained.
Note that these chosen Pk,i,target are still within the range
deﬁned in (22). Since the use of power allocation policy I
guarantees the QoS requirements at user 1, we will focus on
the outage performance at user 2 in this subsection.

, and P2,i,target = 1 − e−

2ǫ1,i

ρ

ρ

We ﬁrst compare the proposed scheme to those MIMO-
NOMA schemes developed in [12] and [13], which are termed
ZF-NOMA and SA-NOMA, respectively. Since both schemes
were proposed for scenarios with different system parameters,
they need be tailored to the scenario addressed in this paper as
explained in the following. Recall that ZF-NOMA proposed
in [12] requires N ≥ M , and SA-NOMA proposed in [13]
requires N > M
2 . In order to ensure that both schemes are
applicable, we focus on a scenario with N = M , but it is
important to point out that the scheme proposed in this paper
is applicable to a scenario with a small N .

For ZF-NOMA, the precoding matrix is set as an identity
matrix, i.e., P = IM , and both users use zero forcing for
detection. The SINR for user 2 to decode the message intended
to user 1 at the i-th layer can be written as SINRZF,i =

. If user 2 can decode its partner’s message

[(HH
2

α2
i
H2)−1]i,i
β2
i
H2)−1]i,i

+ 1
ρ

2

[(HH
successively, it can decode its own with the following SNR:
SNRZF,i =
. In order to have a fair comparison,

ρβ2
i
H2)−1ii,i

h(HH

2

for ZF-NOMA, the effective channel gains are ordered, i.e.,

1

h(HH

2

H2)−1i1,1

≥ · · · ≥

1

.

h(HH

2

H2)−1iM,M

are obtained from the equation(cid:2)HH

It is interesting to point out that for the case of M = N ,
SA-NOMA achieves the same performance as ZF-NOMA, as
shown in the following. For SA-NOMA, signal alignment is
used, where the two users’ detection matrices, U1 and U2,
=
0M×M , where both detection matrices are N ×N . As a result,
the users’ effective channel matrices become the same, i.e.,
U1H1 = U2H2. Therefore, the SINR for user 2 to decode the
message intended for user 1 at the i-th layer can be written as
= SINRZF,i,
SINRSA,i =
where both Hi and Ui are assumed to be invertible. Similarly,

2 (cid:3)(cid:2)U1 U2(cid:3)H

ρ [(U2H2)−1U2UH

2 (U2H2)−H]i,i

1 −HH

i + 1
β2

α2
i

9

provided that user 2 can decode its parter’s message,
it
can decode its own with the following SNR: SNRSA,i =
ρβ2
= SNRZF,i. Therefore, the two
i
[(U2H2)−1U2UH
schemes achieve the same outage performance in the addressed
scenario with M = N .

2 (U2H2)−H]i,i

In Fig. 1, the performance of these MIMO-NOMA schemes
is shown as a function of the transmit SNR. As can be seen
from the ﬁgure, for all MIMO-NOMA schemes considered,
the outage performance at the i-th layer is better than that
at the j-th layer, for i < j, which can be explained as
follows. For the proposed scheme, the effective channel gain
i,i, is statistically stronger than that
at the i-th layer, [RH
i,i is chi-square distributed with
at the j-th layer, since [RH
2(M −i+1) degrees of freedom. For the two existing MIMO-
NOMA schemes, we have ordered the effective channel gains
. Furthermore, it
as

≥ · · · ≥

2 ]2

2 ]2

1

1

h(HH

2

H2)−1i1,1

h(HH

2

H2)−1iM,M

is important to observe that at all layers, the proposed scheme
outperforms the existing MIMO-NOMA schemes. Particularly,
the ﬁgure demonstrates that for the proposed scheme, the slope
of the outage probability curves is changing, which means
change of the diversity gains. On the other hand, all the
outage probability curves for the existing schemes have the
same slope, which is mainly due to the correlation among the
effective channel gains,

.

1

h(HH

2

H2)−1ii,i

100

10−1

10−2

10−3

s
e

i
t
i
l
i

b
a
b
o
r
P
e
g
a

 

t

u
O

10−4

 
0

 

o
Proposed MIMO−NOMA, P
2,1
o
Proposed MIMO−NOMA, P
2,2
o
Proposed MIMO−NOMA, P
2,3
o
ZF−NOMA(SA−NOMA), P
2,1
o
ZF−NOMA(SA−NOMA), P
2,2
o
ZF−NOMA(SA−NOMA), P
2,3

5

10

15

SNR in dB

20

25

30

Fig. 1. Comparison to the existing MIMO-NOMA schemes. M = N = 3.

P1,i,target = 1 − e−
BPCU and R2,i = 4 BPCU, ∀ 1 ≤ i ≤ N.

ρ

, and P2,i,target = 1 − e−

2ǫ1,i

2ǫ2,i

ρ

. R1,i = 1

OMA is another important benchmark scheme. Recall that
in this paper, user 1 is viewed as a primary user in a
conventional cognitive radio network. If OMA is used, the
bandwidth resource allocated to user 1 cannot be reused. The
use of NOMA means that user 2, which can be viewed as a
secondary user, is admitted into the bandwidth occupied by
user 1. Because the proposed power allocation policies can
ensure that user 1’s QoS requirements are met, whatever can
be transmitted to user 2, such as R2,i(1 − Po
2,i), will be a net
performance gain over OMA. Or in other words, the beneﬁt
of the proposed MIMO-NOMA scheme over OMA is clear if

we ask user 2, a user with stronger channel conditions, to be
admitted into the bandwidth allocated to user 1.

In the following, we consider a comparison which is
more difﬁcult for NOMA. Particularly, consider that there are
two time slots (or frequency-channels/ spreading-codes). For
OMA, time slot i is allocated to user i. For NOMA, the
two users are served at the same time. Comparing NOMA
to this type of OMA is challenging, since user 1, a user
with weaker channel conditions, is admitted into the time slot
allocated to user 2 and user 2 cannot enjoy interference free
communications experienced in the OMA case. As a result, the
performance gain of NOMA over OMA becomes less obvious.
In Fig. 2, the performance of the proposed MIMO-NOMA
scheme is compared to the MIMO-OMA scheme described
above. Precoding for the considered MIMO-OMA scheme is
designed by using the same QR approach as discussed in
Section II. Particularly, during the second time slot, user 2
is served and the precoding matrix is designed according to
the QR decomposition of H2, which means that the data
rate for user 2 to decode its message at the i-th layer is
1
2 is due to the use of
2 log(1 + ρ[RH
OMA. As can be seen from the two sub-ﬁgures in Fig.2, the
proposed MIMO-NOMA scheme can achieve better outage
performance compared to MIMO-OMA, and the performance
gap between the two schemes can be increased by introducing
more antennas at the base station, i.e., increasing M . An in-
teresting observation is that the slope of the outage probability
curves for MIMO-NOMA is the same as that for MIMO-
OMA, which means that the diversity gains achieved by the
two schemes are the same. This phenomenon is expected since
for both schemes, the outage probabilities are determined by
the same effective channel gain, [RH

i,i), where the factor 1

2 ]2

2 ]2

i,i.

B. Impact of Different System Parameters on Users’ Outage
Performance

In Figs. 3 and 4, user 1’s outage performance achieved
by the proposed MIMO-NOMA scheme is shown with dif-
ferent choices of the targeted data rates. Particularly, when
power allocation policy I is used, Fig. 3 shows that
the
outage probability curves achieved by the proposed MIMO-
NOMA transmission scheme match perfectly with those for
the targeted outage probability, which demonstrates that the
proposed transmission scheme can strictly guarantee the QoS
requirements at user 1 in the long term. When power allocation
policy II is used, Fig. 4 demonstrates that the simulation results
match perfectly with the analytical results developed in (28).
Therefore, the use of power allocation policy II guarantees

that the outage probability at user 1 is (cid:16)1 − e−

is equivalent to the outage performance for the case in which
all the power is allocated to user 1.

ρ (cid:17), which

ǫ1,i

In Fig. 5, the outage probabilities at user 2 are shown as
functions of the transmit SNR, when power allocation policy
I is used. As can be observed from the ﬁgure, the curves for
the simulation results match perfectly with the ones for the
analytical result developed in (39), which demonstrates the
accuracy of this exact expression for the outage probability.
The curves for the approximation results developed in (40)

s
e
i
t
i
l
i

b
a
b
o
r
P
 
e
g
a
t
u
O

s
e

i
t
i
l
i

b
a
b
o
r
P
e
g
a

 

t

u
O

100

10−1

10−2

10−3

10−4

10−5
 
0

100

10−1

10−2

10−3

10−4
 
0

10

 

o
Proposed MIMO−NOMA, P
2,1
o
Proposed MIMO−NOMA, P
2,2
o
Proposed MIMO−NOMA, P
2,3

MIMO−OMA, P

MIMO−OMA, P

MIMO−OMA, P

5

o
2,1
o
2,2
o
2,3
10

15

SNR in dB

20

25

30

(a) M = N = 3

 

o
Proposed MIMO−NOMA, P
2,1
o
Proposed MIMO−NOMA, P
2,2
o
Proposed MIMO−NOMA, P
2,3

MIMO−OMA, P

MIMO−OMA, P

MIMO−OMA, P

5

o
2,1
o
2,2
o
2,3
10

15

20

25

30

SNR in dB

(b) M = 6 and N = 3

Fig. 2.

Comparison to MIMO-OMA. P1,i,target = 1 − e−

2ǫ1,i

ρ

, and

P2,i,target = 1 − e−
i ≤ N.

2ǫ2,i

ρ

. R1,i = 1 BPCU and R2,i = 4 BPCU, ∀ 1 ≤

match the simulation curves only at high SNR, which is due to
the fact that this approximation is obtained with the high SNR
assumption. Another important observation from this ﬁgure is
2,i is larger
that the slope of the outage probability curve for Po
than that of Po
2,j, for i < j. This is because a larger diversity
gain can be obtained at the i-th layer, compared to that at the
j-th layer, as discussed in Remark 3 in Section IV-A.

Fig. 6 demonstrates the outage performance at user 2 when
power allocation policy II is used. As shown in the ﬁgure, the
outage performance of user 2 can be improved by increasing
the number of antennas at the base station or decreasing the
targeted data rates. An important observation from this ﬁgure
is that at high SNR, the slope of all the curves is the same,
which means that the same diversity gain is achieved at all
layers, regardless of the choice of the number of antennas at
the base station. This conﬁrms the analytical results developed
in Section IV-B1, in which it is shown that the diversity

gain is one for all layers. In Fig. 7, the outage performance
experienced by user 2 with different power allocation policies
is compared. Particularly, this ﬁgure shows that the use of
power allocation policy I is preferable for user 2, since better
outage performance can be achieved. However, it is important
to point out that the use of power allocation policy II can
meet the QoS requirement of user 1 instantaneously as shown
in (14), whereas power allocation policy I can only meet the
long term QoS requirement.

100

s
e

i
t
i
l
i

b
a
b
o
r
P
e
g
a

 

t

u
O

10−1

10−2

10−3
 
0

 

P

1,i,target

=P
2

P

1,i,target

=P
1

 − simulation

 − simulation

 − simulation

Po
1,1
Po
1,2
Po
1,3
P

 
1,1,target
 
1,2,target
 
1,3,target

P

P

5

10

15

SNR in dB

20

25

30

Fig. 3. Outage performance at user 1 with power allocation policy I. M =

N = 3. P1 = 1 − e−
R1,2 = 1.5 BPCU, and R1,2 = 2 BPCU.

, and P2 = 1 − e−

ρ

2ǫ1,i

10ǫ2,i

ρ

. R1,1 = 1 BPCU,

100

10−1

10−2

10−3

s
e

i
t
i
l
i

b
a
b
o
r
P
e
g
a

 

t

u
O

10−4
 
0

R
R
R

1,1

1,2

1,3

 = 3    BPCU
 = 3.5 BPCU
 = 4    BPCU

R
R
R

1,1

1,2

1,3

 = 0.5 BPCU
 = 1    BPCU
 = 1.5 BPCU

Po
1,1
Po
1,2
Po
1,3
Po
1,1
Po
1,2
Po
1,3

 − simulation

 − simulation

 − simulation

 − analytical

 − analytical

 − analytical

5

10

15

20

25

30

SNR in dB

Fig. 4. Outage performance at user 1 with power allocation policy II. M =
N = 3. The analytical results are based on (28).

11

 

o , simulation
P
2,1
o , simulation
P
2,2
o , simulation
P
2,3
o , analtyical results in (39)
P
2,1
o , analtyical results in (39)
P
2,2
o , analtyical results in (39)
P
2,3
o , approximation results in (40)
P
2,1
o , approximation results in (40)
P
2,2
o , approximation results in (40)
P
2,3

5

10

15

20

25

30

SNR in dB

100

10−2

10−4

10−6

10−8

s
e
i
t
i
l
i

b
a
b
o
r
P
 
e
g
a
t
u
O

10−10
 
0

Fig. 5. Outage performance at user 2 with power allocation policy I. M =

N = 3, P1 = 1 − e−
R2,i = 2 BPCU. The analytical results are based on (39) and (40).

, P2 = 1 − e−

, R1,i = 1 BPCU, and

ρ

ρ

2ǫ1,i

10ǫ2,i

100

10−1

10−2

10−3

s
e

i
t
i
l
i

b
a
b
o
r
P
e
g
a

 

t

u
O

 

10−4
 
0

 

o , M=6, N=3, R
P
2,1
o , M=6, N=3, R
P
2,2
o , M=6, N=3, R
P
2,3
o , M=3, N=3, R
P
2,1
o , M=3, N=3, R
P
2,2
o , M=3, N=3, R
P
2,3

1,i

1,i

1,i

1,i

1,i

=R

=1 BPCU, 

=R

=1 BPCU, 

=R

=1 BPCU, 

=R

=2 BPCU, 

=R

=2 BPCU, 

=R

=2 BPCU, 

2,i

2,i

2,i

2,i

2,i

2,i

5

1,i
10

15

SNR in dB

20

25

30

Fig. 6. Outage performance at user 2 with power allocation policy II. M =
N = 3.

conditions are similar. Particularly, the precoding matrix has
been designed to degrade user 1’s effective channel gains while
improving the signal strength at user 2. Two types of power
allocation policies have been developed to meet user 1’s QoS
requirement in a long and short term, respectively. Analytical
and numerical results have also been provided to demonstrate
the advantages and disadvantages of the two power allocation
policies. The outage performance at user 2 has been analyzed
by using some bounding techniques, whereas an important
future direction is to ﬁnd a closed-form expression for this
outage probability by applying the order statistics of the
diagonal elements of an inverse Wishart matrix.

VI. CONCLUSIONS

REFERENCES

In this paper, we have considered a MIMO-NOMA down-
link transmission scenario, where a new precoding and power
allocation strategy was proposed to ensure that the potential of
NOMA can be realized even if the participating users’ channel

[1] “NGMN 5G white paper,” NGMN Alliance, Feb. 2015.
[2] “5G radio access: Requirements, concepts and technologies,” NTT

DOCOMO, Inc., Tokyo, Japan, 5G Whitepaper, Jul. 2014.

[3] 3rd Generation Partnership Project (3GPP), “Study on downlink mul-

tiuser superposition transmission for LTE,” Mar. 2015.

 

12

o , Policy II
P
2,1
o , Policy II
P
2,2
o , Policy II
P
2,3
o , Policy I
P
2,1
o , Policy I
P
2,2
o , Policy I
P
2,3

5

10

15

SNR in dB

20

25

30

100

10−1

10−2

10−3

s
e
i
t
i
l
i

b
a
b
o
r
P
 
e
g
a
t
u
O

10−4
 
0

R1,i = 1 BPCU, R2,i = 2 BPCU, P1 = 1 − e−

and P2 = 1 −

2ǫ1,i

ρ

Fig. 7. Comparison between the two power allocation policies. M = N = 3,

10ǫ2,i

e−

ρ

.

[4] Y. Saito, Y. Kishiyama, A. Benjebbour, T. Nakamura, A. Li, and
K. Higuchi, “Non-orthogonal multiple access (NOMA) for cellular
future radio access,” in Proc. IEEE Veh. Tech. Conference, Dresden,
Germany, Jun. 2013.

[5] Z. Ding, Z. Yang, P. Fan, and H. V. Poor, “On the performance of
non-orthogonal multiple access in 5G systems with randomly deployed
users,” IEEE Signal Process. Lett., vol. 21, no. 12, pp. 1501–1505, Dec.
2014.

[6] S. Timotheou and I. Krikidis, “Fairness for non-orthogonal multiple
access in 5G systems,” IEEE Signal Process. Lett., vol. 22, no. 10, pp.
1647–1651, Oct. 2015.

[7] Z. Ding, P. Fan, and H. V. Poor, “Impact of user pairing on 5G non-
orthogonal multiple access,” IEEE Trans. Veh. Tech., (to appear in 2016)
Available on-line at arXiv:1412.2799.

[8] J. Choi, “Minimum power multicast beamforming with superposition
coding for multiresolution broadcast and application to NOMA systems,”
IEEE Trans. Commun., vol. 63, no. 3, pp. 791–800, Mar. 2015.

[9] M. F. Hanif, Z. Ding, T. Ratnarajah, and G. K. Karagiannidis, “A
minorization-maximization method for optimizing sum rate in non-
orthogonal multiple access systems,” IEEE Trans. Signal Process.,
vol. 64, no. 1, pp. 76–88, Jan. 2016.

[10] Q. Sun, S. Han, C.-L. I, and Z. Pan, “On the ergodic capacity of MIMO
NOMA systems,” IEEE Wireless Commun. Lett., vol. 4, no. 4, pp. 405–
408, Aug. 2015.

[11] J. Choi, “On the power allocation for MIMO-NOMA systems with
layered transmissions,” IEEE Trans. Wireless Commun., (to appear in
2016).

[12] Z. Ding, F. Adachi, and H. V. Poor, “The application of MIMO to non-
orthogonal multiple access,” IEEE Trans. Wireless Commun., vol. 15,
no. 1, pp. 537–552, Jan. 2016.

[13] Z. Ding, R. Schober, and H. V. Poor, “On the design of MIMO-
NOMA downlink and uplink transmission,” in Proc. IEEE International
Conference on Communications, Kuala Lumpur, Malaysia, Jun. 2016.
[14] L. Dai, B. Wang, Y. Yuan, S. Han, C.-L. I, and Z. Wang, “Non-
orthogonal multiple access for 5G: solutions, challenges, opportunities,
and future research trends,” IEEE Commun. Magazine, vol. 53, no. 9,
pp. 74–81, Sept. 2015.

[15] A. M. Tulino and S. Verdu, Foundations and Trends in Commun. and
Inform. Theory: Random Matrix Theory and Wireless Communications.
Hanover, MA, US: Now Publishers, 2004.

[16] I. S. Gradshteyn and I. M. Ryzhik, Table of Integrals, Series and

Products, 6th ed. New York: Academic Press, 2000.

[17] D. Maiwald and D. Kraus, “Calculation of moments of complex Wishart
and complex inverse Wishart distributed matrices,” IEE Proc. Radar,
Sonar and Navigation, vol. 147, no. 4, pp. 162–168, Aug. 2000.

