6
1
0
2

 
r
a

 

M
8
1

 
 
]

.

O
C
h
p
-
o
r
t
s
a
[
 
 

1
v
1
1
9
5
0

.

3
0
6
1
:
v
i
X
r
a

Mon. Not. R. Astron. Soc. 000, 000–000 (0000)

Printed 21 March 2016

(MN LATEX style ﬁle v2.2)

Simulation tests of galaxy cluster constraints on chameleon
gravity

Harry Wilcox,1 Robert C. Nichol,1 Gong-Bo Zhao,1 David Bacon,1
Kazuya Koyama,1 A. Kathy Romer2
1 Institute of Cosmology and Gravitation, University of Portsmouth, Dennis Sciama Building, Portsmouth, PO1 3FX, UK
2 Dept. of Physics and Astronomy, University of Sussex, Falmer, Brighton, BN1 9QH

21 March 2016

ABSTRACT
We use two new hydrodynamical simulations of ΛCDM and f (R) gravity to test the
methodology used by Wilcox et al. 2015 (W15) in constraining the eﬀects of a ﬁfth
force on the proﬁles of clusters of galaxies. We construct realistic simulated stacked
weak lensing and X-ray surface brightness cluster proﬁles from these cosmological
simulations, and then use these data projected along various lines-of-sight to test the
spherical symmetry of our stacking procedure. We also test the applicability of the
NFW proﬁle to model weak lensing proﬁles of clusters in f (R) gravity. Finally, we test
the validity of the analytical model developed in W15 against the simulated proﬁles.
Overall, we ﬁnd our methodology is robust and broadly agrees with these simulated
data. We also apply our full Markov Chain Monte Carlo (MCMC) analysis from W15
to our simulated X-ray and lensing proﬁles, providing consistent constraints on the
modiﬁed gravity parameters as obtained from the real cluster data, e.g. for our ΛCDM
simulation we obtain |fR0|< 8.3 × 10−5 (95% CL), which is in good agreement with
the W15 measurement of |fR0|< 6 × 10−5. Overall, these tests conﬁrm the power of
our methodology which can now be applied to larger cluster samples available with
the next generation surveys.

Key words: Simulation: Gravitation

1 INTRODUCTION

Over the last century, General Relativity (GR) has provided
a robust theoretical framework for cosmology. However, a
major challenge for this framework is the discovery of ac-
celeration in the late-time expansion history of the Universe
(Riess et al. 1998; Perlmutter et al. 1999), leading to the
need for a cosmological constant in the Friedmann equa-
tions, and/or a possible modiﬁcation to GR on cosmological
scales (Clifton et al. 2012, Koyama 2015).

Modiﬁed theories of gravity typically require an addi-
tional scalar ﬁeld which couples to matter, giving rise to a
ﬁfth force (Jain et al., 2013). GR has been well tested on
terrestrial and Solar System scales (Wagner et al., 2012), so
if such an additional force did exist, it must be suppressed,
or “screened”, in dense environments to avoid detection.

A popular method for screening such a ﬁeld is the
chameleon mechanism (Khoury & Weltman, 2004). In this
theory, the coupling strength of the additional scalar ﬁeld
is dependent on the local gravitational potential. In regions
with deep gravitational potential wells, the ﬁeld is screened
and gravity behaves like GR, while in areas of shallow grav-

c(cid:13) 0000 RAS

itational potentials, gravity becomes modiﬁed and deviates
from GR (Lombriser, 2014).

The chameleon ﬁfth force obeys

Fφ = − β
MPl

∇φ,

(1)

where MPl is the Planck mass, φ is the scalar ﬁeld and β
is the scalar ﬁeld coupling strength to matter. The value of
the scalar ﬁeld on the cosmological background (φ∞) mea-
sures the eﬃciency of the screening (Terukina & Yamamoto,
2012). The chameleon mechanism is then characterised by
the parameters β and φ∞.

known as f (R) gravity, where β = (cid:112)1/6 (Chiba et al.,

There is a particular set of chameleon gravity models,

2007). In these models the ﬁfth force is mediated by an ad-
ditional degree of freedom, namely fR = df /dR, which at
z = 0 has a value of |fR0| (Sotiriou & Faraoni, 2010). We can
relate fR to the screening eﬃciency (φ∞ above) by (Joyce
et al., 2014)

2 Wilcox, Nichol, Zhao, Bacon, Koyama, Romer

(cid:114)

fR(z) = −

2
3

φ∞
MPl

.

(2)

In our previous paper (Wilcox et al. 2015, or W15 here-
after), we investigated a possible observational signature of
chameleon gravity using clusters of galaxies as ﬁrst stud-
ied by Terukina et al. (2014). These works postulate that
the additional ﬁfth force could be unscreened in the out-
skirts of groups and clusters of galaxies, leading to an ob-
served diﬀerence between the X-ray and gravitational weak
lensing proﬁles of the clusters. Therefore, constraints on the
modiﬁed gravity parameters can be obtained by comparing
measurements of both the X-ray and weak lensing cluster
proﬁles for a set of clusters. This was ﬁrst achieved for the
Coma cluster (Terukina et al., 2014), giving a constraint of
|fR0|< 6 × 10−5.

In W15, we applied the same technique to a stacked
proﬁle of 58 X-ray clusters taken from the XMM Clus-
ter Survey (XCS; Romer et al. 2001) with weak lensing
data from the Canada France Hawaii Telescope Lensing
Survey (CFHTLenS; Heymans et al. 2012). Using a multi-
parameter Monte Carlo Markov Chain (MCMC) analysis,
we constrained the values of the two chameleon gravity pa-
rameters (β and φ∞), ﬁnding the data was consistent with
GR, i.e., we did not require a ﬁfth force. In the case of f (R)

gravity (β =(cid:112)1/6), we constrained |fR0|< 6 × 10−5 (95%

conﬁdence), which is similar to the Coma cluster limit. These
constraints remain some of the strongest constraints on the
background ﬁeld amplitude on cosmological scales (for a re-
view see Lombriser (2014) and references therein).

The work of W15 made several simplifying assumptions,
including: i) All clusters were in hydrostatic equilibrium,
with no signiﬁcant additional non-thermal pressure aﬀect-
ing their proﬁles; ii) Stacking clusters produces a fair rep-
resentation of spherically-symmetrical proﬁles by minimis-
ing line-of-sight projection eﬀects; iii) Dark matter haloes
are well described by an NFW proﬁle in chameleon gravity
(Navarro et al., 1996).

The ﬁrst of these assumptions was tested in W15 where
we found that our cluster proﬁles were consistent with no
additional (non-thermal) pressure at, and beyond, the virial
radius of the stacked cluster proﬁles. The other assumptions
are tested in this paper, which also provides a conﬁrmation
of the analytical modelling presented in W15 for simultane-
ously describing changes to the X-ray and lensing proﬁles of
clusters due to modiﬁcations of gravity.

We achieve these tests using two new hydrodynamical
cosmological simulations; one evolved using the concordance
ΛCDM+GR model, and the other evolved using f (R) grav-
ity with a background ﬁeld amplitude of |fR0|= 10−5. This
value of |fR0| was chosen to be consistent with present ob-
servational limits on this parameter, as smaller values would
have resulted in a modiﬁcation to gravity that could not be
measured within these present simulations (due to an insuf-
ﬁcient number of haloes), nor with the data in W15.

In Section 2, we describe the cosmological simulations
used throughout this paper and the techniques used to gen-
erate suitable simulated data products. In Section 3, we
discuss the creation of the stacked X-ray and weak lensing
cluster proﬁles, and test the assumptions in W15 discussed
above. In Section 4, we present results from our MCMC

ﬁtting of the simulated stacked cluster proﬁles. We discuss
these results in Section 5.

2 SIMULATING CLUSTERS

2.1 Cosmological Simulations

In this paper we use two new hydrodynamical simulations
created using the MGENZO software; a variant of the ENZO1
software, but working with modiﬁed gravity theories (see
Zhao et al. in prep). We provide an overview of the theoret-
ical details of these simulations in Appendix A.
In particular, we use one available f (R) simulation with
|fR0|= 10−5 and n = 1 and, for comparison, a ΛCDM+GR
simulation. Both simulations have 2× 1283 particles of mass
4 × 1011M(cid:12) in a cubic box of 128 Mpc/h on a side. Both
simulations have identical initial conditions and background
cosmological parameters, namely Ωb = 0.044, Ωcdm = 0.226,
ΩΛ = 0.73 and H0 = 71kms−1Mpc−1. Each simulation is
evolved to z = 0.4, which is close to the median redshift of
the W15 cluster sample (¯zcluster = 0.33).

Each simulation provides the location and temperature
of all particles (assuming the equipartition of kinetic en-
ergy), which are then used to determine the density and
pressure of the gas (assuming the ideal gas law). Neither sim-
ulation includes any additional feedback processes (e.g. from
active galactic nuclei or supernovae) and therefore will not
include an additional non-thermal pressure component that
could aﬀect the temperature and density of gas in galaxy
clusters (Rasia et al. 2004, Ota & Yoshida 2015).

In Figures 1 and 2, we show the projected density
(baryons and dark matter) for the two simulations at z =
0.4.

2.2 Finding Dark Matter Haloes

To replicate the analysis of W15, we must ﬁnd clusters in
our simulations and stack their proﬁles. We therefore use the
“Rockstar” Friends-of-Friends (FOF) algorithm (Behroozi
et al., 2013) to locate the main dark matter haloes in both
simulations (Section 2.1). We use the default linkage length
of 0.28 times the mean particle separation. For each simula-
tion, we obtained a catalogue of the halo locations (centre-of-
mass) and their masses. All haloes are at z = 0.4 which again
is close to the median of the W15 clusters (¯zcluster = 0.33).
We impose a threshold on the halo mass of M >
1013M(cid:12). This is a compromise to ensure we have suﬃcient
haloes for our tests, while still containing the more massive
halos in the simulations which were closest to the typical
cluster masses used in W15. At redshifts below z = 0.4 (for
consistency with W15), the W15 sample has a typical mass
of (cid:39) 8 × 1013M(cid:12), which is higher than the typical mass
of the halos above our threshold ((cid:39) 4 × 1013M(cid:12)). This is
due to a few massive clusters in the W15 sample (Tx > 2.5
keV) that are not present in the simulations. The modes
of the mass (or X-ray temperature) distribution are similar
between the real and simulated samples. We return to this
point in Section 5 when discussing our results.

Above this threshold mass, we ﬁnd 103 clusters (or

1 Available at http://enzo-project.org/

c(cid:13) 0000 RAS, MNRAS 000, 000–000

Simulation tests of chameleon gravity

3

Figure 1. Snapshot of the total mass density for the ΛCDM+GR
simulation at z = 0.4. We highlight all halos above M > 1013M(cid:12).
The simulation has been projected along one side of the simulation
box (128 Mpc/h cube).

Figure 2. The same as Figure 1 but for the f (R) simulation.Some
text to give caption second line. More padding text, copy as needed.
More padding text, copy as needed. More padding text, copy as
needed.

haloes) in the ΛCDM+GR simulation and 113 clusters in the
f (R) simulation. Interestingly, it has been shown (Schmidt
et al. 2009, Lombriser et al. 2014) that the abundance of
massive clusters is enhanced in the presence of a ﬁfth force
(with |fR0|∼ 10−5), which is reﬂected in the halo numbers
in our samples.
We found (cid:39) 4% of the volume in our f (R) simulation
was contaminated by unrealistic particle velocities, leading
to an extremely low density (< 107M(cid:12)/Mpc−3), but ex-
ceptionally hot (> 5 × 108K), extended bubble surrounding
the most massive dark matter halo in the simulation. This
bubble is potentially caused by the lack of realistic feed-
back mechanisms (Section 2.1). The bubble aﬀects 14 nearby
clusters, which are enclosed by it, on average doubling their
temperature proﬁles at the virial radius. Therefore we re-
move these 14 haloes, leaving 99 clusters in total for the
f (R) simulation. This bubble is not visible in the density
map in Figure 2. In Figures 3 and 4, we show four typical
(randomly-selected) haloes from both simulations.

2.3 Creating X-ray images

To mimic W15, we need to produce X-ray proﬁles for our
simulated haloes or clusters. This was achieved using the
PHOX software (Biﬃ et al., 2012), as implemented in Python
(ZuHone et al., 2014). The software takes as primary in-
put the output particle parameters from our hydrodynam-
ical simulations, namely position, density, temperature and
velocity. For each cluster, we input the particle information
for a cube of size 2Mpc centred on each halo. As metallicity
is also required for PHOX, but unavailable from our simula-
tions, we assumed a constant value of 0.3Z(cid:12) for all clusters,
which is suitable for the outskirts of clusters (Simionescu
et al., 2011).

The PHOX software has three main steps. First, it gener-
ates a large Monte-Carlo sample of available photons (typi-

c(cid:13) 0000 RAS, MNRAS 000, 000–000

Figure 5. The distribution of exposure times (seconds) for the
real XMM cluster observations used in W15. We show the best-ﬁt
Gaussian distribution to these data.

cally ten times the amount expected from an observation) in
a three-dimensional volume surrounding the cluster. This is
achieved by converting the given density, temperature and
metallicity of each particle (or “gas element” as described in
Biﬃ et al. 2011) into a spectrum of photons using a model for
the emissivity of the intracluster medium, XSPEC (Arnaud,
1996) assuming a thermal APEC model (Smith et al., 2001),
which is suitable for such hot, low-density, fully-ionised plas-
mas. Our spectral model was created with a resolution of
2000 energy bins, between 0.5keV and 2.0keV. For each clus-
ter, we also created an array of diﬀerent photon samples
spanning a range of possible collecting areas and exposure
times to facilitate the generation of realistic XMM observa-
tions in stage three of PHOX (below).

The second stage of PHOX involves projecting the

3020100102030y(Mpc)3020100102030z(Mpc)10-410-310-2Projected Density(gcm2)3020100102030y(Mpc)3020100102030z(Mpc)10-410-310-2Projected Density(gcm2)01020304050607080Exposure time (ks)0.0000.0050.0100.0150.0200.0250.0300.0350.040Normalised Count4 Wilcox, Nichol, Zhao, Bacon, Koyama, Romer

Figure 3. A mosaic of four (projected) cluster proﬁles taken from
the ΛCDM+GR simulation at z = 0.4. The coloured contours are
the gas density, while the black contour lines are the gas temper-
ature. Here the redder contours denote higher temperatures and
bluer lower over a scale of 2keV to 0.5keV

Figure 4. The same four clusters as shown in Figure 3, but now
from the f (R) simulation shown in Figure 2 (The halos are the
same because the two simulations use identical initial conditions).

Some text to give caption second line. More padding text, copy as

needed. More padding text, copy as needed.

is drawn from the ﬁtted Gaussian distribution and used in
PHOX (we did not allow negative exposure times, but simply
drew from the Gaussian again). The redshift for our simu-
lated clusters is assumed to be z = 0.4 to be consistent with
the simulations.

Finally, stage two of PHOX corrects for the eﬀects of ab-
sorption by gas in the Milky Way. The software uses the wabs
absorption model (Morrison & McCammon, 1983), which is
implemented through XSPEC, and takes the galactic column
density (NH ) as an input. We assume a constant value of
1021cm−2 for all clusters, which is reasonable given the ob-
served galactic column density for the W15 sample (Kalberla
et al., 2005).

The third stage of PHOX involves adding realistic tele-
scope eﬀects to the simulated images. This is achieved using
simx, a convolution tool that contains the point-spread func-
tion (PSF), and detector response function, for a number of
well-known X-ray telescopes. For this paper, we select the
PN camera of XMM-Newton telescope. The simx tool also
adds a realistic background.

The simulated X-ray images look cosmetically similar
to real XMM data, including chip gaps and the same shape
as the real XMM ﬁeld-of-view. The only major diﬀerence
is the lack of additional X-ray sources serendipitously de-
tected in the outskirts of each XMM image. For compari-
son, a typical XCS image contains approximately ten bright
serendipitously-detected point-sources per observation, with
more fainter sources. We ignore this diﬀerence in our simula-
tions as the probability of having overlapping point sources
is still relatively small, and would have been corrected in
the real data by excluding ﬂux from that overlapping source
when constructing cluster proﬁles. We also assume all our
simulated clusters are observed on-axis, which is not true for
the real XCS cluster sample. We investigated the eﬀect of
moving our simulated clusters oﬀ-axis using simx and found
no signiﬁcant eﬀect on our results.

c(cid:13) 0000 RAS, MNRAS 000, 000–000

Figure 7. The normalised distribution of ellipticities for all clus-
ter realisations (see text) for both simulations (ΛCDM is blue
and f (R) is green). The (pink) shaded region shows the range of
measured ellipticities after stacking the clusters.

three-dimensional distribution of photons to obtain two-
dimensional maps for each cluster. We select a line-of-sight
for each cluster that is aligned with the z-axis in the main
cosmological simulations and project the data into the plane
perpendicular to this line-of-sight. This stage also corrects
for doppler shifts along the line-of-sight due to the motion
of the gas, and corrects for the cosmological redshift.

Next, PHOX simulates the observing time, which is esti-
mated using the distribution of exposure times for the real
clusters in W15 (see Figure 5). For simplicity, we ﬁt this dis-
tribution of exposure times with a Gaussian, giving a mean
time of 24, 591 seconds and a dispersion of 12, 745 seconds.
Then, for each simulated cluster, a random exposure time

1.00.50.00.51.0z(Mpc)1.00.50.00.51.0y(Mpc)1.00.50.00.51.0z(Mpc)1.00.50.00.51.0y(Mpc)10121013Projected Density(MﬂMpc2)1.00.50.00.51.0z(Mpc)1.00.50.00.51.0y(Mpc)1.00.50.00.51.0z(Mpc)1.00.50.00.51.0y(Mpc)10121013Projected Density(MﬂMpc2)0.00.10.20.30.40.50.60.7Ellipticity0.00.51.01.52.02.53.03.54.0Normalised CountSimulation tests of chameleon gravity

5

Figure 6. (Top) The stacked X-ray surface brightness proﬁles (left) and lensing proﬁles (right) for the ΛCDM simulation (distance
normalised by r200). (Bottom) Same but for the f (R) simulation. In each case, the stacked proﬁle is shown as black dots and is
accompanied by the individual proﬁles of the four randomly selected clusters presented in Figures 3 and 4 (red dashed lines).

2.4 Estimating the weak lensing signal around

clusters

We estimate the lensing shear signal around each of our sim-
ulated clusters, as our numerical simulations do not simulate
the eﬀects of gravitational lensing. We therefore calculate
the expected lensing convergence, κ, as detailed in Bartel-
mann & Schneider (2001), which can be approximated by

κ =

3H 2
0 Ωm
2c2

∆χiχi

(χclust − χi)

χclust

δi
ai

,

(3)

(cid:88)

i

along the line-of-sight, assuming a ﬂat universe and using
the Born approximation. The summation is over comoving
distance χi, using bins of width ∆χi, while H0 is the Hubble
constant, Ωm is the matter density, ai is the scale factor (in
bin i), and δi is the overdensity in that bin. This equation is
not modiﬁed in the chameleon case Terukina et al. (2014).

c(cid:13) 0000 RAS, MNRAS 000, 000–000

The lensing convergence is measured in the simulations
by ﬁrst determining r200 for each simulated cluster (i.e., the
radius at which the average density of the halo reaches two
hundred times the critical density). Then we extract a cylin-
der of radius 10 × r200, centred on each cluster, but the
length of the whole cosmological simulation (128 Mpc/h).
This cylinder is then divided into ten redshift slices (thick-
ness ∆z = 0.02), and each slice was pixelated into a 100×100
grid. The density in each pixel, ρ(zi) is determined, and the
overdensity in each pixel calculated as

δi =

ρ(zi) − ¯ρ(zi)

¯ρ(zi)

.

(4)

where ¯ρ(zi) is the mean pixel density in each redshift slice.
κ for each pixel is then calculated using equation (3),

with the error on κ (σκ) given by

10-1100r/r20010-610-510-4Sx(counts/cm2/s/arcmin2100101r/r20010-410-310-210-1γt10-1100r/r20010-610-510-4Sx(counts/cm2/s/arcmin2100101r/r20010-410-310-210-1γt))6 Wilcox, Nichol, Zhao, Bacon, Koyama, Romer

σ2
κ =

3H 2
0 Ωm
2c2

(cid:88)

i

∆χiχi

(χclust − χi)

χclust

δi
ai

1
¯ni

.

(5)

This pixellated map of convergence is converted into a shear
ﬁeld, from which tangential shear (γt) is then inferred, us-
ing the inversion technique given in Kaiser & Squires (1993).
To make the shear measurements more realistic, we added
a random shear noise component to the pixelated values
behind each cluster using a distribution of shear noise val-
ues constructed directly from the galaxy source catalogue of
CFHTLenS (Heymans et al., 2012).

3 TESTING OUR ASSUMPTIONS

3.1 Making stacked cluster proﬁles

We follow exactly the same prescription as used in W15 to
create stacked X-ray and lensing proﬁles for our simulated
clusters. To generate the stacked X-ray surface brightness
proﬁle, we ﬁrst extracted a square region of size r200 around
each individual simulated cluster and re-sampled the data,
via linear interpolation, to a common grid of 500 by 500
pixels. We then stack the images, ﬁrst re-scaling the overall
amplitude of the images by the mean to reduce covariances
(as discussed in W15). The mean value of each pixel was then
measured and binned into 19 logarithmic annuli out to r200.
As in W15, we use bootstrap re-sampling, with replacement,
to estimate the errors on our stacked proﬁles. We created 100
mock samples from the real 103 (99) clusters available in the
ΛCDM+GR (f (R)) simulation to replicate W15.

For the stacked lensing proﬁle, we ﬁrst estimate the
tangential shear (γt) for each cluster and its noise compo-
nent. The tangential shear in each pixel, around each clus-
ter (calculated about the X-ray centroid), was binned into 19
equally spaced logarithmic bins out to a distance of 10×rvir.
For consistency with W15, we exclude the central 0.1× rvir.
The shear in each bin was summed for all clusters and the
mean shear measured (McKay et al., 2001). This provides
our stacked weak lensing proﬁle. We measure errors on the
shear proﬁle using the same bootstrap re-sampling method
described above for the X-ray proﬁles.

3.2 Testing our stacked proﬁles

In Figure 6, we show the four stacked proﬁles (X-ray and
lensing proﬁles for both simulations) compared to the indi-
vidual proﬁles for the same four (randomly chosen) clusters
shown in Figures 3 and 4.

A key assumption in W15 was that stacking clusters
would produce a spherically symmetric proﬁle. We use these
simulations to explore if stacking clusters reduces possible
line-of-sight projection eﬀects which could hamper any anal-
ysis when applied to a single cluster (e.g. see Terukina et al.
2014 for a discussion of such problems for the Coma Clus-
ter). To test this, we generate ten additional realisations per
cluster, following the same methodology as given in Section
2.3, but now varying at random the line-of-sight direction
for the projection of the three-dimensional photon distribu-
tion. We then determine the ellipticity () for each individual
cluster realisation by ﬁtting a two-dimensional ellipse to the

Figure 8. We show the stacked lensing proﬁle for
the
ΛCDM+GR simulation (blue crosses) and the stacked lensing
proﬁle for the f (R) simulation (red points). The dashed (blue)
line is the best ﬁt NFW proﬁle to the ΛCDM+GR data, while
the dashed (red) line is the same for the f (R) proﬁle.

projected surface brightness distribution (we construct an
isophote where surface brightness falls to 20% of the central
pixel value).

In Figure 7, we show the distribution of ellipticities de-
termined across all realisations of all our clusters in both
simulations. We ﬁnd a mean  of 0.21 ± 0.13, which demon-
strates many of our simulated clusters are non-spherical. In-
terestingly, we see no diﬀerence in the distribution of ellip-
ticities between the two simulations (the mean ellipticity is
also the same).

We then create ten stacked two-dimensional proﬁles,
where each stack contained a single, diﬀerent realisation
of each cluster. We ﬁt an ellipse to each stack and com-
puted the best-ﬁt value of . Across the ten stacks, we ﬁnd
¯ = 0.04 ± 0.02, which shows these stacked proﬁles are close
to spherical (within a few percent) averaging out the ellip-
ticities seen in the individual clusters (Figure 7). As our
analytic model assumes spherical symmetry, knowing that
our stack is also spherical gives us conﬁdence that any con-
straints on f (R) are not degenerate with triaxiality of the
haloes.

3.3 NFW proﬁles

A key assumption made in the analysis of W15 is that the
NFW proﬁle is an appropriate model for our stacked weak
lensing cluster proﬁle. It is possible for deviations from an
NFW proﬁle to arise due to the modiﬁed dynamics dur-
ing the formation of structures. In Figure 8, we show the
simulated stacked weak lensing proﬁle out to 10 × rvir for
both the ΛCDM+GR and f (R) simulation, along with the
best-ﬁt analytical NFW proﬁles. We used MCMC to ﬁt the
NFW parameters c and M (as described in W15) running
the chains for 1000 time steps, removing the ﬁrst 200 steps
as the “burn in” phase. We obtain χ2 (cid:39) 10 (for 15 degrees
of freedom) for the f (R) simulation, conﬁrming the visual

c(cid:13) 0000 RAS, MNRAS 000, 000–000

100101r/r20010-410-310-210-1γtΛCDMf(R)Simulation tests of chameleon gravity

7

Figure 9. The stacked X-ray proﬁle for the ΛCDM simulation
(blue crosses) and the f (R) simulation in (red points). Also shown
is the best-ﬁt ΛCDM model (black line) and the best-ﬁt fR =
10−5 line (dashed black line).

Figure 10. The observed ratio between the two simulated stacked
X-ray surface brightness proﬁles shown in Figure 9 (blue line).
The dashed (black) line is the same ratio but now predicted using
the analytical models from Figure 9.

impression that the NFW model is a good representation of
these lensing proﬁles in both simulations.
We also ﬁnd the same best-ﬁt values of c = 7.4+0.64−0.65
and M = 1.2+0.13−0.13 × 1013M(cid:12) in both simulations. These val-
ues are reasonable for such dark matter haloes and consis-
tent with other ﬁts in the literature (Pourhasan et al. 2011,
Arnold et al. 2014). These results conﬁrm that an NFW pro-
ﬁle is a good representation of the lensing proﬁle of clusters
in f (R) models (as in the case of ΛCDM). We note that our
test is the ﬁrst time this assumption has been tested using
simulated lensing proﬁles for f (R) gravity.

3.4 Comparison with our analytic model

Our simulated cluster proﬁles provide an ideal test for the
analytical model we developed in W15 to explain the af-
fect of chameleon gravity on the X-ray surface brightness
proﬁles of clusters. In Figure 9, we show the X-ray surface
brightness proﬁles for both the ΛCDM+GR and f (R) sim-
ulations. For comparison, we also show the expected theo-
retical proﬁle using the model developed in W15 assuming
GR (black line) and f (R) gravity (dashed line). The latter
would present itself as an additional pressure term in the
hydrostatic equilibrium equation, resulting in a steeper pro-
ﬁle in the outskirts of the cluster. The agreement between
the analytic model and the simulated model is a good vali-
dation that our analytic model can accurately describe real
clusters.

In Figure 10, we show the ratio of the two simulated
proﬁles (as the solid line) and, as discussed above, they de-
viate from unity in the outskirts of the cluster (r/r200 > 0.5)
as the gas becomes unscreened and the feels the ﬁfth force.
We also show in Figure 10 our analytical prediction for this
eﬀect from W15 (assuming fR = 10−5 to be consistent with
our simulation). We see the two curves agree well at small

c(cid:13) 0000 RAS, MNRAS 000, 000–000

radii, while at large radii, the two are still in good agreement
(always within two sigma of each other). This demonstrates
that our analytical model can re-produce the overall eﬀect
of f (R) gravity on the X-ray surface brightness proﬁles of
clusters, but possibly under-estimates the amplitude of the
eﬀect at intermediate radii (with the caveat that we have
not included feedback in the simulations).

4 FULL MCMC ANALYSIS

A comprehensive test of our methodology is to ﬁt our sim-
ulated stacked proﬁles using the full MCMC approach de-
scribed in W15, and ensure we recover the underlying cos-
mological parameters for our two hydrodynamical simula-
tions (Section 2). We use the emcee code (Foreman-Mackey
et al., 2013) for our MCMC ﬁtting, which implements a
Metropolis-Hastings algorithm (MacKay, 2003).

We provide here a brief review of the ﬁtting technique
as used in W15. We simultaneously ﬁt our analytical model
to both the stacked X-ray and lensing cluster proﬁles. This
model is given in Equations 4 and 11 of W15, and de-
scribes both the NFW ﬁt to the lensing proﬁle, and the
modiﬁed hydrodynamic equilibrium equation for the X-ray
surface brightness proﬁle. Our combined model has 8 pa-
rameters, namely c, M200, n0, b1, r1, T0 and the two re-
scaled chameleon gravity parameters of β2 = β/(1 + β) and
φ∞,2 = 1 − exp(−φ∞/10−4MPl) (see W15 for details).

We also perform an extra ﬁt to the proﬁles including an
additional unknown non-thermal pressure component (e.g.,
Nagai et al. 2007, Lau et al. 2009) to mimic possible sys-
tematic eﬀects on the X-ray gas at large radii (e.g. infall of
cold gas onto the the cluster). As described in W15, this
additional pressure component is included in the model us-
ing a parametric function for the total pressure, such that
Ptotal = g−1Psys = (1− g)−1Pthermal, where P is the diﬀer-

10-1100r/r20010-710-610-510-4Surface BrightnessAnalytic ΛCDMAnalytic f(R)Sim stack ΛCDMSim stack f(R)10-1100r/r2000.50.60.70.80.91.0Surface Brightness Ratio8 Wilcox, Nichol, Zhao, Bacon, Koyama, Romer

Figure 11. The X-ray surface brightness (left) and weak lensing (right) proﬁles for the two simulations: ΛCDM+GR (top) and f (R)
(bottom). For each proﬁle, we present the best-ﬁt analytical model with (dashed line), and without (solid line), the additional non-
thermal pressure component. In most cases, these two ﬁts overlap. The best-ﬁt parameter values for the ΛCDM+GR simulation (top
row), assuming no additional non-thermal pressure, are T0 = 26.5 keV, n0 = 0.11 × 10−2cm−3, b1 = −2.0, r1 = 0.63 Mpc, M200 =
10.0 × 1014M(cid:12), c = 9.0, β = 3, φ∞ = 0.7 × 10−4MPl, which are consistent with W15 and marginalised over to get the MG parameter
constraints.

ent pressure components, and g is a function of the cluster
mass and radius.

We ﬁnd the best-ﬁt model parameters using a χ2 statis-
tic as described in Appendix A of W15. Our MCMC chains
were run in parallel using 128 walkers with 10000 time steps
(the ﬁrst 2000 iterations were removed as the “burn in”
phase). In the case of the weak lensing proﬁle, we assume
the covariance matrix is diagonal and compute it from the
proﬁle data following the technique of W15. For the X-ray
surface brightness proﬁles, we measure the covariance ma-
trix from the X-ray stack directly, once more following W15.

4.1 Results

In Figure 11, we show the stacked X-ray surface brightness
and weak lensing proﬁles from both our simulations. We also
show the best-ﬁt model to these data with, and without, the
inclusion of an additional non-thermal pressure component

(as discussed above). We present the X-ray surface bright-
ness proﬁles to the cluster virial radius (rvir), while we ex-
tend the lensing proﬁle to 10 × rvir (to be consistent with
W15).

For simplicity, we focus on the two chameleon gravity
parameters in our model (β2 and φ∞,2) and show in Figure
12 the marginalised joint constraint on these two parameters
using the simulated cluster proﬁles from our ΛCDM+GR
simulation. We also show the joint constraints obtained by
W15 for these two parameters, but using the real data.

In Figure 13, we show a similar marginalised joint con-
straint on β2 and φ∞,2, but now using data from our f (R)
gravity simulation. We again show the constraints from W15
but with the real data. We also mark the ﬁducial value
of these modiﬁed gravity parameters for our f (R) gravity
simulation. Figures 14 and 15 replicate these constraints,
but with the additional non-thermal pressure component in-
cluded (Section 4). It is interesting to note that the best-ﬁt

c(cid:13) 0000 RAS, MNRAS 000, 000–000

10-1100r/r20010-610-510-4Sx(counts/cm2/s/arcmin2100101r/r20010-410-310-210-1γt10-1100r/r20010-610-510-4Sx(counts/cm2/s/arcmin2100101r/r20010-410-310-210-1γt))Simulation tests of chameleon gravity

9

Figure 12. The 95% (light grey) and 99% (dark grey) conﬁdence
limits for the excluded region of the combined parameter space of
the two re-normalised modiﬁed gravity parameters discussed in the
text. The X-ray surface brightness and lensing proﬁles are from the
ΛCDM simulation. Also shown are conﬁdence limits on the same
parameters from W15 using the real data (dashed line is the 95
per cent, dot-dashed 99 per cent conﬁdence) The vertical line is

β =(cid:112)1/6, showing our constraint on f (R) gravity models.

Figure 13. Same as Figure 12 but for the chameleon gravity
simulation. The red circle indicates the position of the ﬁducial
model.Some text to give caption second line. More padding text,
copy as needed. More padding text, copy as needed. More padding
text, copy as needed. More padding text, copy as needed. More
padding text, copy as needed. More padding text, copy as needed.
More padding text, copy as needed. More padding text, copy as
needed. More padding text, copy as needed.

model for the additional non-thermal pressure component
in both simulations is consistent with zero, which is reas-
suring as neither simulation had such non-thermal physical
processes added (e.g. feedback mechanisms).

These ﬁgures show that we can obtain meaningful con-
straints on the modiﬁed gravity parameters at a level con-
sistent with W15. The size of the allowed regions for these
joint constraints depends on the underlying simulation, and
whether we include an additional pressure component or
not. The most realistic constraint is given in Figure 12,
which is for ΛCDM+GR with no additional non-thermal
pressure. Here our constraints are close to those found in
W15, which is reassuring (assuming the true cosmological
model is ΛCDM+GR).
These joint constraints can be used to place an upper
limit on |fR0|, which can then be compared to W15 and,
in the case of the f (R) simulation, the input value for that
simulation. Likewise, we can place an upper limit on f (R)
gravity by placing a constraint on φ∞ as such models are a

subset of the chameleon model with β =(cid:112)1/6 (shown as the

vertical line in Figures 12, 13, 14 and 15). These constraints
are shown in Table 1, for both simulations with, and with-
out, the extra non-thermal pressure. We note here that the
constraints recovered here are comparable to those present
in W15 of |fR0|< 6 × 10−5, discussed further in Section 5.
The time-evolution of fR(z) for a Hu-Sawicki model
with n = 1 (where n is an additional degree of freedom
of the model) follows (Li et al., 2013),

fR(z) = |fR0|[(1 + 3ΩΛ)/(ΩM(1 + z)3 + 4ΩΛ)]2.

(6)

This evolution leads to a reduction in the magnitude of fR
by 27% at the present day when compared with the redshift
at which the simulation was placed, z = 0.4, due to a higher

c(cid:13) 0000 RAS, MNRAS 000, 000–000

Without non-

With non-

thermal pressure

thermal pressure
ΛCDM - φ∞ < 8.7 × 10−5MPl < 1.1 × 10−4MPl
< 4.0 × 10−5MPl < 5.7 × 10−5MPl
f (R) - φ∞
ΛCDM - fR0 < 8.3 × 10−5
< 3.8 × 10−5
f (R) - fR0

< 1.1 × 10−4
< 5.5 × 10−5

Table 1. Summary of constraints on modiﬁed gravity parameters
from both simulations, with and without a non-thermal pressure
component (95% CL).

background energy density at higher redshifts. This eﬀect
has been taken into account for the values of |fR0| presented
in Table 1. When we have included ﬁtting for a systematic
error, our constraints are less stringent as the additional
pressure can be degenerate with a ﬁfth force, reducing the
signal.

5 DISCUSSION AND CONCLUSION

In this paper, we investigate the methodology presented in
W15 and test some of the assumptions made in that analy-
sis. This is achieved using two hydrodynamical simulations;
one evolved using ΛCDM+GR and the other evolved using
a modiﬁed gravity component of |fR0|= 10−5. Using these
simulations, we generated realistic stacked weak lensing and
X-ray surface brightness proﬁles.

We use these stacked proﬁles to test the assumptions
outlined in Section 1. We demonstrate that the stacking pro-
cess created representative, spherically symmetrical proﬁles,

0.20.40.60.8β20.00.20.40.60.8φ∞,2ExcludedAllowed0.00.20.40.60.8β20.00.20.40.60.8φ∞,2ExcludedAllowed10 Wilcox, Nichol, Zhao, Bacon, Koyama, Romer

Figure 14. Same as Figure 12 (ΛCDM+GR) but with a non-
thermal pressure component added. Some text to give caption sec-
ond line. More padding text, copy as needed.

Figure 15. Same as Figure 10 (chameleon gravity) but with a
non-thermal pressure component added. The red circle indicates
the position of the ﬁducial model.

thus reducing the possible bias caused by any ellipticity in
an individual cluster.

We also investigated the assumption that dark matter
haloes in chameleon gravity are well described by the same
NFW proﬁle as used in ΛCDM. We ﬁnd no diﬀerence be-
tween the ﬁtted NFW parameters for both our f (R) and
ΛCDM simulated stacked lensing proﬁles conﬁrming previ-
ous studies in the literature (Lubini et al. 2011,Arnold et al.
2014).

As a complete test of the methodology, we have com-
pared our simulations with analytical predictions used by
W15. The results of this test are summarised in Figure 9
which shows broad agreement between the analytical and
numerical (simulation) results, with the latter showing a
slight deviation from ΛCDM for the same value of |fR0|=
10−5. This deviation suggests that the constraints in W15
maybe under-estimated and a correction to the analytical
model could be determined using these simulations. Ideally,
one would compare the simulations directly to the data, but
it remains computationally-intensive to produce suﬃciently
large simulations for the next generation of cluster samples.
For now, the analytical model remains appropriate.

In Section 4, we have replicated the full MCMC analysis
from W15, but now using the simulated stacked cluster pro-
ﬁles instead of real data. We also include the possibility of
an additional unknown non-thermal pressure component in
the intracluster medium which would produce a signiﬁcant
systematic bias in our modelling. We present a summary of
our full MCMC results in Table 1.
For our ΛCDM+GR simulation, we ﬁnd |fR0|< 8.3 ×
10−5, which is in good agreement with the limit in W15
(|fR0|< 6 × 10−5). This validates the methodology in W15
and shows our technique can deliver competitive constraints
upon the chameleon gravity model, i.e., W15 still provides
one of the best constraints on |fR0| on cluster (Mpc) scales.
In the f (R) case, we are able to recover a value of |fR0|<
3.8×10−5, which is fully consistent with the ﬁducial value of

|fR0|= 10−5 for the simulation. In the presence of an initial
modiﬁcation to gravity, there is a genuine tension between
the hydrostatic and lensing proﬁles in the f (R) simulation.
In turn this leads to less parameter space which the model
can investigate before it becomes inconsistent with one or
other of the proﬁles. This therefore rules out more area in the
β2 versus φ∞,2 plane, leading to more powerful constraints
compared to ΛCDM.

We have also constrained our proﬁles from both simu-
lations including a non-thermal pressure component to ac-
count for unknown systematic uncertainties (in astrophysics
or the analysis). This obviously weakens the constraints as
such uncertainties are partially degenerate with any ﬁfth
force i.e., both aﬀect the shape of the proﬁle at large scales.
Our constraints with this extra pressure term are still con-
sistent with the ﬁducial model.

These simulations demonstrate that our methodology
in W15 is capable of constraining chameleon gravity. How-
ever, we note that the constraints recovered in this paper
are slightly less powerful than presented in W15. In W15, we
split our cluster sample into two separate bins based on their
X-ray temperature (Tx < 2.5keV and Tx > 2.5keV). We
found this split in temperature (mass) provided a stronger
constraint on |fR0| compared to a single mass bin. However,
we are unable to replicate such binning here as the distribu-
tion of cluster temperatures and masses in the simulations
is much narrower, missing the more massive (Tx > 2.5keV)
halos due to the ﬁnite volume of our simulation box, as dis-
cussed in Section 2.2. We will need larger simulations to ad-
dress this issue and allow us to test modiﬁed gravity eﬀects
as a function of both mass and environment (as discussed in
detail in W15). Future simulations should also include more
realistic feedback mechanisms.

We also conclude that we need a larger sample of clus-
ters (with both X-ray and lensing measurements) to create
higher signal-to-noise stacked proﬁles to further test the pos-
sibility of a ﬁfth force. Such samples of clusters should be

c(cid:13) 0000 RAS, MNRAS 000, 000–000

0.20.40.60.8β20.00.20.40.60.8φ∞,2ExcludedAllowed0.00.20.40.60.8β20.00.20.40.60.8φ∞,2ExcludedAllowedavailable soon from a number of ongoing, and future, ex-
periments like the Dark Energy Survey (The Dark Energy
Survey Collaboration 2005), the KIlo Degree Survey (KIDS,
de Jong et al. 2013), Euclid (Laureijs et al., 2011), eROSITA
and the Large Synoptic Survey Telescope (LSST Dark En-
ergy Science Collaboration 2012). These surveys should pro-
vide thousands of clusters for such tests pushing the limits
on |fR0| to 10−6, giving more robust constraints, which are
complementary to the constraints from dwarf galaxies (Jain
et al., 2013).

ACKNOWLEDGEMENTS

the ﬁnancial

HW acknowledges
support of SEPNet
(http://www.sepnet.ac.uk) and the ICG Portsmouth. RN,
GBZ, DB, KK supported by the UK Science and Technology
Facilities Council grants ST/K00090X/1 and AKR is sup-
ported by the UK Science and Technology Facilities Council
grants ST/L000652/1. KK, GBZ also acknowledge support
from the European Research Council grant through 646702
(CosTesGrav). Numerical computations were performed on
the Sciama High Performance Computing (HPC) cluster
which is supported by the ICG, SEPNet and the Univer-
sity of Portsmouth. All data from this paper is available on
request from the authors.

References

Arnaud K. A., 1996, in Jacoby G. H., Barnes J., eds, Astro-
nomical Data Analysis Software and Systems V Vol. 101
of Astronomical Society of the Paciﬁc Conference Series,
XSPEC: The First Ten Years. p. 17

Arnold C., Puchwein E., Springel V., 2014, MNRAS, 440,

833

Bartelmann M., Schneider P., 2001, PhysRep, 340, 291
Behroozi P. S., Wechsler R. H., Wu H.-Y., 2013, ApJ, 762,

109

Biﬃ V., Dolag K., Boehringer H., Lemson G.,

, 2011,
PHOX: X-ray Photon Simulator, Astrophysics Source
Code Library

Biﬃ V., Dolag K., B¨ohringer H., Lemson G., 2012, MN-

RAS, 420, 3545

Bryan G. L., et al., 2014, APJS, 211, 19
Capozziello S., 2002, Int.J.Mod.Phys., D11, 483
Chiba T., Smith T. L., Erickcek A. L., 2007, Phys. Rev. D,

75, 124014

Clifton T., Ferreira P. G., Padilla A., Skordis C., 2012,

Phys. Rep., 513, 1

de Jong J. T. A., Verdoes Kleijn G. A., Kuijken K. H.,

Valentijn E. A., 2013, Experimental Astronomy, 35, 25

Foreman-Mackey D., Hogg D. W., Lang D., Goodman J.,

2013, PASP, 125, 306

Heymans C., Van Waerbeke L., Miller L., Erben T., Hilde-

brandt H., 2012, MNRAS, 427, 146

Jain B., Vikram V., Sakstein J., 2013, ApJ, 779, 39
Joyce A., Jain B., Khoury J., Trodden M., 2014, ArXiv

e-prints

Kaiser N., Squires G., 1993, APJ, 404, 441
Kalberla P. M. W., Burton W. B., Hartmann D., Arnal

c(cid:13) 0000 RAS, MNRAS 000, 000–000

Simulation tests of chameleon gravity

11

E. M., Bajaja E., Morras R., P¨oppel W. G. L., 2005, AAp,
440, 775

Khoury J., Weltman A., 2004, Phys. Rev. Lett., 93, 171104
Koyama K., 2015, ArXiv e-prints
Lau E. T., Kravtsov A. V., Nagai D., 2009, ApJ, 705, 1129
Laureijs R., Amiaux J., Arduini S., Augu`eres J. ., Brinch-
mann J., Cole R., Cropper M., Dabin C., Duvet L., Ealet
A., et al. 2011, ArXiv e-prints

Li B., Hellwing W. A., Koyama K., Zhao G.-B., Jennings

E., Baugh C. M., 2013, MNRAS, 428, 743

Li B., Zhao G.-B., Teyssier R., Koyama K., 2012, JCAP,

1, 51

Lombriser L., 2014, Annalen der Physik, 526, 259
Lombriser L., Koyama K., Li B., 2014, JCAP, 3, 21
LSST Dark Energy Science Collaboration 2012, ArXiv e-

prints

Lubini M., Tortora C., N¨af J., Jetzer P., Capozziello S.,

2011, European Physical Journal C, 71, 1834

MacKay D. J. C., 2003, Information Theory, Inference and

Learning Algorithms. Cambrdige University Press

McKay T. A., et al., 2001, ArXiv e-prints
Morrison R., McCammon D., 1983, Apj, 270, 119
Nagai D., Kravtsov A. V., Vikhlinin A., 2007, ApJ, 668, 1
Navarro J. F., Frenk C. S., White S. D. M., 1996, ApJ, 462,

563

Noller J., von Braun-Bates F., Ferreira P. G., 2014, PRD,

89, 023521

Ota N., Yoshida H., 2015, ArXiv e-prints
Oyaizu H., 2008, PRD, 78, 123523
Perlmutter S., et al., 1999, ApJ, 517, 565
Pourhasan R., Afshordi N., Mann R. B., Davis A. C., 2011,

JCAP, 12, 005

Puchwein E., Baldi M., Springel V., 2013, MNRAS, 436,

348

Rasia E., Tormen G., Moscardini L., 2004, MNRAS, 351,

237

Riess A. G., et al., 1998, AJ, 116, 1009
Romer A. K., Viana P. T. P., Liddle A. R., Mann R. G.,

2001, ApJ, 547, 594

Schmidt F., Lima M., Oyaizu H., Hu W., 2009, PRD, 79,

083518

Simionescu A., Allen S. W., Mantz A., Werner N., Takei Y.,
Morris R. G., Fabian A. C., Sanders J. S., Nulsen P. E. J.,
George M. R., Taylor G. B., 2011, Science, 331, 1576

Smith R. K., Brickhouse N. S., Liedahl D. A., Raymond

J. C., 2001, ApJL, 556, L91

Sotiriou T. P., Faraoni V., 2010, Reviews of Modern

Physics, 82, 451

Terukina A., Lombriser L., Yamamoto K., Bacon D.,

Koyama K., Nichol R. C., 2014, JCAP, 4, 13

Terukina A., Yamamoto K., 2012, Phys. Rev. D, 86, 103503
The Dark Energy Survey Collaboration 2005, ArXiv e-

prints

Wagner T. A., Schlamminger S., Gundlach J. H., Adel-
berger E. G., 2012, Classical and Quantum Gravity, 29,
184002

Wilcox H., et al., 2015, MNRAS, 452, 1171
Zhao G.-B., Li B., Koyama K., 2011, PRD, 83, 044007
ZuHone J. A., Biﬃ V., Hallman E. J., Randall S. W., Foster

A. R., Schmid C., 2014, ArXiv e-prints

12 Wilcox, Nichol, Zhao, Bacon, Koyama, Romer

APPENDIX A: IMPLEMENTING F (R) MODEL
IN MGENZO

The action of the f (R) model is (Capozziello, 2002)

(cid:90) √−g

(cid:20) f (R)

16πG

(cid:21)

+ LM

d4x

(A1)

S =

where

f (R) = −m2 α1(−R/m2)n
α2(−R/m2)n + 1

,

(A2)

with m2 = H 2
0 ΩM. Under the quasi-static approximation,
the equation of motion of the scalar ﬁeld δfR can be obtained
as (Noller et al., 2014)

and it has to be solved numerically on a regular, or self-
adaptive, grid using iteration methods (Oyaizu, 2008; Zhao
et al., 2011; Li et al., 2012; Puchwein et al., 2013).

For the f (R) model, using block adaptive mesh reﬁne-
ment (block AMR), MGENZO solves the non-linear Poisson
equation of the scalar ﬁeld (Equation A3). The modiﬁed
Newton potential Φ can then be solved. Given Φ, the hy-
drodynamical system for baryons and dark matter particles
is numerically solved (Equations 1-4 in Bryan et al. 2014).

∇2δfR = − a2
3

(A3)
where δfR = fR(R) − fR( ¯R), δR = R − ¯R and δρM − ¯ρM.
One can invert Equation A2 to relate R to fR using

[δR(fR) + 8πGδρM],

fR = − α1
α2
2

n(−R/m2)n−1
[(−R/m2)n + 1]2 (cid:39) − nα1

α2
2

(cid:19)n+1

(cid:18) m2

−R

,

(A4)

where the approximation holds if the background cosmology
is close to a ΛCDM+GR model and, in this case, one can
approximate ¯R as

(cid:2)ΩM (1 + z)3 + 4ΩΛ

(cid:3) .

¯R (cid:39) 3H 2

0

At redshift z = 0,

¯R0 ≡ ¯R(z = 0) (cid:39) 3H 2

0 (1 + 3ΩΛ)

where a ﬂat universe is assumed. Combining Equations A4
and A6, one can rewrite Equation A4 in terms of fR0, which
is the background value of fR at redshift z = 0, as

(cid:20) 3H 2

(cid:21)n+1

fR (cid:39) fR0

0 (1 + ΩΛ)
−R

(A5)

(A6)

(A7)

and δR is given explicitly as

δR(fR) = 3H 2
0

(1 + 3ΩΛ)

(cid:40)

(cid:19) 1
n+1 −(cid:2)ΩM (1 + z)3 + 4ΩΛ

(cid:3)(cid:41)

.

(cid:18) fR0

fR

(A8)
The scalar ﬁeld fR can then be solved numerically by com-
bining Equation A3 with Equation A8, given the model pa-
rameters fR0 and n with background cosmological parame-
ters.

The modiﬁed Poisson equation for the gravitational po-
tential Φ can be obtained by summing the 00 and ii com-
ponent of the modiﬁed Einstein equation in the Hu-Sawicki
f(R) model (Hu & Sawicki 2007), namely

∇2Φ =

16πG

3

a2δρM +

a2
6

δR(fR).

(A9)

The dynamics of the system are determined by Equations
A3 and A9. Equation A3 is a non-linear Poisson equation,

c(cid:13) 0000 RAS, MNRAS 000, 000–000

