6
1
0
2

 

b
e
F
8
2

 

 
 
]

.

A
F
h
t
a
m

[
 
 

1
v
4
9
4
0
0

.

3
0
6
1
:
v
i
X
r
a

AN AVERAGING PRINCIPLE FOR FAST DIFFUSIONS IN

DOMAINS SEPARATED BY SEMI-PERMEABLE MEMBRANES

ADAM BOBROWSKI, BOGDAN KAZMIERCZAK, AND MARKUS KUNZE

Abstract. We prove an averaging principle which asserts convergence of dif-
fusions on domains separated by semi-permeable membranes, when the speed
of diﬀusion tends to inﬁnity while the ﬂux through the membranes remains
constant. In the limit, points in each domain are lumped into a single state of
a limit Markov chain. The limit chain’s intensities are proportional to mem-
branes’ permeability and inversely proportional to the domains’ sizes. Analyti-
cally, the limit is an example of a singular perturbation in which boundary and
transmission conditions play a crucial role. This averaging principle is strongly
motivated by recent signaling pathways models of mathematical biology, which
are discussed in the ﬁnal section of the paper.

1. Introduction

The main aim of this article is to establish an averaging principle saying that fast
diﬀusions on domains separated by semi-permeable domains may be approximated
by certain Markov chains. More speciﬁcally, if diﬀusion’s speed in each domain
increases while the ﬂux through the boundaries remains constant, in the limit, all
points in each domain are lumped together to form a single state, and the limit
process is a Markov chain with the state-space composed of these lumped states
(Theorems 5.5 and 5.6). The jump intensities in the chain are in direct proportion
to the total permeability of the membranes, and in inverse proportion to the sizes
of the domains (see eq. (5.3)). We note that the principle just described is akin to
the famous Freidlin–Wentzell averaging principle ([36, 38], see also [37]), though it
is motivated by biological rather than physical models. Moreover, in contrast to
Freidlin–Wentzell principle, in our case the crucial role is played by transmission
conditions.

Predecessors of our principle have been studied in [19] and [14], see also [40]. In
[19], in an attempt to reconcile two models of so-called neurotransmitters (a macro-
scopic one of Aristizabal and Glavinoviˇc [6], and a microscopic one of Bielecki and
Kalita [11]) it has been shown that fast diﬀusions in three domains, corresponding
to the so-called large, small, and immediately available pools, may be approxi-
mated by a Markov chain with three states, see Figure 1. In fact, in [19] merely a
one-dimensional variant of this limit theorem has been proved, in which the three
3-dimensional pools are replaced by three adjacent intervals. This result has later
been generalized to the case of fast diﬀusions on arbitrary ﬁnite graphs in [14]; in
both cases the limit theorems are stated as convergence theorems for semigroups in
Banach spaces of continuous functions. In [40], a related result has been proved in
a space of integrable functions. See also [7] for a generalization.

In this paper, we come back to the general, d-dimensional setting, and, in contrast
to the previous papers, focus on the analysis in Lp spaces (p ≥ 1). To this end,

2010 Mathematics Subject Classiﬁcation. 47A07, 47D07, 60J70, 92C45.
Key words and phrases. Convergence of sectorial forms and of semigroups of operators,
diﬀusion processes, boundary and transmission conditions, Freidlin–Wentzell averaging princi-
ple, singular perturbations, signaling pathways, kinase activity, intracellular calcium dynamics,
neurotransmitters.

1

2

ADAM BOBROWSKI, BOGDAN KAZMIERCZAK, AND MARKUS KUNZE

Small pool

fast diﬀusion
constant ﬂux

Large pool

Immediately available pool

Figure 1. Averaging principle in two models of neurotransmitters

we prove our main result in L2 ﬁrst (Theorem 5.5), using convergence theorems
for quadratic forms, and then extend the analysis to other Lp (Theorem 5.6) by
extrapolation and interpolation techniques – see Sections 4 and 5. In Section 6, three
contemporary models of biology, including two recent signaling pathways models
and the neurotransmitters model, are discussed as special cases of the principle so
established.

As already mentioned, the key role in this analysis is played by transmission
conditions (see (3.3)) describing permeability of membranes. In the context of heat
ﬂow, these conditions may be plausibly interpreted: according to Newton’s Law of
Cooling, the temperature at the membrane changes at a rate proportional to the
diﬀerence of temperatures on either sides of the membrane, see [21, p. 9]. In this
context, J. Crank uses the term radiation boundary condition. (Although, strictly
speaking, these are not boundary, but transmission conditions, see [25, 26, 27].)

In the context of passing or diﬀusing through membranes, analogous transmission
conditions were introduced by J. E. Tanner [59, eq. (7)], who studied diﬀusion of
particles through a sequence of permeable barriers (see also Powles et al.
[56, eq.
(1.4)], for a continuation of the subject).
In [3] (see e.g. eq. (4) there) similar
conditions are used in describing absorption and desorption phenomena. We refer
also to [34], where a compartment model with permeable walls (representing e.g.,
cells, and axons in the white matter of the brain in particular) is analyzed, and to
equation [42] there.

In the context of neurotransmitters, conditions of type (3.3) were (re)-invented in
[19] and [14], interpreted in probabilistic terms, and linked with Feller–Wentzell’s
boundary conditions [30, 31, 32, 33, 61] (see [47] for a more thorough stochastic
analysis).

A systematic study of semigroups and cosine families related to such transmis-
sion conditions has been commenced in [15]. We note also the recent paper [9],
where a heat problem for such transmission conditions is studied for quite irregular
boundaries, and the monograph [1] in which related transmission conditions are
analyzed.

2. Preliminaries

The main tools to prove our averaging principle come from the theory of sectorial
forms. In this section we brieﬂy recall the relevant deﬁnitions and results. For more
information we refer to the books by Kato [41] and Ouhabaz [55].

Let H be a Hilbert space. A sesquilinear form is a mapping h : D(h) × D(h) → C
which is linear in the ﬁrst component and antilinear in the second component. Here
D(h) is a subspace of H. If D(h) is dense in H we say that h is densely deﬁned. We
write h[u] := h[u, u] for the associated quadratic form at u ∈ D(h).

AN AVERAGING PRINCIPLE FOR FAST DIFFUSIONS

3

A sesquilinear form h is called sectorial if the numerical range

is contained in some sector

Θ(h) := (cid:8) h[u] : u ∈ D(h), kukH ≤ 1(cid:9)

Σγ(θ) := {z ∈ C : | arg(z − γ)| ≤ θ}.

Here θ ∈ [0, π
2 ) is called the angle of the sector and γ ∈ R is the vertex of the
sector. To emphasize θ we will say h is sectorial of angle θ. If Re h[u] ≥ 0 for all
u ∈ D(h) then h is called accretive. The numerical range of an accretive, sectorial
form is always contained in a sector with vertex 0. We will mainly be interested in
accretive forms. If the numerical range of a form is contained in Σγ(0), the form is
called symmetric.

The adjoint form of h is deﬁned as h∗ : D(h) × D(h) → C, h∗[u, v] := h[v, u]. If
h is sectorial (accretive, symmetric) then so is h∗. The real and imaginary parts of
2i (h − h∗), respectively. An easy
h are deﬁned by Re h := 1
computation shows that Re h and Im h are symmetric forms and that h[u, v] :=
Re h[u, v] + iIm h[u, v]. We point out that even if the quadratic forms associated
with Re h and Im h take only values in the real numbers, the forms themselves may
take values in the complex plane. It is easy to see that an accretive sesquilinear
form is sectorial of angle θ if and only if

2 (h + h∗) and Im h := 1

In this case

|Im h[u]| ≤ tan θRe h[u].

hu, vih := Re h[u, v] + hu, viH

deﬁnes an inner product on D(h). This is called the associated inner product. If
this inner product turns D(h) into a Hilbert space, h is called closed.

If h is a densely deﬁned sesquilinear form, we deﬁne the associated operator L

by setting

D(L ) := {u ∈ D(h) : ∃w ∈ H with h[u, v] = hw, vi for all v ∈ D(h)}, L u = −w.

Note that by the density of D(h) in H there exists at most one such w. We now
have the following result, see [41, Theorem VI.2.1] or [55, Section 1.4]

Theorem 2.1. Let h be an accretive, closed and densely deﬁned sectorial form of
angle θ. Then the associated operator L is closed and densely deﬁned, C \ Σ0(θ) is
contained in the resolvent set ρ(L ) and

kR(λ, L )k ≤

1

dist(λ, Σ0(θ))

for all λ ∈ C \ Σ0(θ).

In particular, L is sectorial of angle π
2 − θ in the sense of [28, Deﬁnition II.4.1] and
thus generates a bounded, analytic semigroup of operators in H by [28, Theorem
II.4.6]. This semigroup is contractive on [0, ∞).

H

If the form h is closed and sectorial but not densely deﬁned, there is no associated
operator in H. However, we may associate an operator L |H0 on the Hilbert space
H0 := D(h)
. We will also in this situation call L |H0 the operator associated
with h. As a consequence of Theorem 2.1, LH0 is a sectorial operator on H0 and
thus generates a bounded, analytic semigroup etLH0 on H0. Following Simon [57],
who treated the symmetric case, we extend each operator of the semigroup to H by
setting it to 0 on H ⊥
0 = H we deﬁne
the (degenerate) semigroup e−z h by setting

0 . In other words, for u = u0 + u1 ∈ H0 ⊕ H ⊥

and the pseudoresolvent (λ + h)−1 by setting

e−z hu := ezLH0 u0

(λ + h)−1u := R(λ, LH0)u0.

4

ADAM BOBROWSKI, BOGDAN KAZMIERCZAK, AND MARKUS KUNZE

With slight abuse of notation, we write

(2.1)

e−z h = ezLHh PH0

and (λ + h)−1 = R(λ, LH0 )PH0

where PH0 is the orthogonal projection onto H0. Note that the relationship between
e−z h and (λ + h)−1 is the same as in the case where h is densely deﬁned. Namely,
e−z h can be computed from (λ + h)−1 via an appropriate contour integral and, vice
versa, (λ + h)−1 is the Laplace transform of e−z h.

As in [57] the main motivation to consider forms which are not densely deﬁned
are convergence results for sectorial forms, where non densely deﬁned forms may
appear naturally in the limit, even if we consider a sequence of densely deﬁned
sectorial forms.
In fact, this is exactly what happens in our averaging principle.
To prove it, we make use of the following convergence result due to Ouhabaz [54]
which generalizes Simon’s theorem [57] concerned with symmetric forms. See also
the recent article [10] for related results.

Theorem 2.2. Let hn, n ≥ 1 be a sequence of accretive, closed and uniformly
sectorial forms in a Hilbertspace H. The latter means that all the numerical ranges
are contained in a common sector Σ0(θ). Moreover, assume that

(a) Re hn ≤ Re hn+1, i.e. D(hn+1) ⊂ D(hn) and hn[u] ≤ hn+1[u] for all u ∈

D(hn+1);

(b) we either have

(i) Im hn[u] ≤ Im hn+1[u] for all u ∈ D(hn+1) or
(ii) Im hn+1[u] ≤ Im hn[u] for all u ∈ D(hn+1).

Deﬁne h[u] := limn→∞ hn[u] with domain

D(h) := nu ∈ \n∈N

: sup
n∈N

hn[u] < ∞o.

Then h is an accretive, closed and sectorial form and hn converges to h in the strong
resolvent sense, i.e.

(λ + hn)−1u → (λ + h)−1u as n → ∞,

for all u ∈ H and λ ∈ C \ Σ0(θ).

Ouhabaz has proved this theorem only for densely deﬁned forms but inspection of
the proof shows that it generalizes also to non densely deﬁned forms. Indeed, besides
properties of analytic functions, the proof only makes use of Simon’s monotone
convergence theorem [57] which is valid also for non densely deﬁned forms.

An important consequence of Theorem 2.2 is the following.

Corollary 2.3. In the situation of Theorem 2.2 we have e−t hnu → e−t hu as n → ∞
for all u ∈ H and t ≥ 0.

Proof. To see this note that the degenerate semigroup e−t hn u can be computed
from the pseudoresolvent (λ + hn)−1u via a contour integral. By the strong resol-
vent convergence the integrands converge pointwise on the contour to (λ + h)−1u.
However, as our forms are uniformly sectorial, it follows from Theorem 2.1 that the
associated operators are uniformly sectorial. From this, we obtain an integrable
majorant for (λ + hn)−1u. The thesis now follows from the dominated convergence
theorem. See e.g. [12, Proposition 4] for details.
(cid:3)

The situation where degenerate semigroups (or, equivalently, non densely deﬁned
operators) appear in convergence results is quite common in applications and can
be studied in more generality in the framework of singular perturbation problems,
see [8] and [17]. We would like to point out that the situation in Corollary 2.3 is
rather special in that in general mere convergence of the resolvents does not imply
convergence of the related semigroups (see examples in e.g. [12] or [13, Chapter 8]).
What allows us to infer convergence of the semigroups from that of the resolvents is

AN AVERAGING PRINCIPLE FOR FAST DIFFUSIONS

5

Ω1

Ω2

Ω3

Ω6

Ω5

Ω4

Ω7

Figure 2. Partition of Ω0 (here, an ellipse in R2) into N = 7 parts.

the fact that the related semigroups are uniformly holomorphic. That this is helpful
in convergence results has been known for a time (see, e.g., [4, 12] and the seminal
paper [23]).

In the general situation where the semigroups considered are not uniformly holo-
morphic, more reﬁned techniques are needed to establish convergence of the semi-
groups. It is worth noticing that many singular perturbation problems which not
necessarily involve uniformly holomorphic semigroups, fall into an ingenious scheme
devised by T. G. Kurtz [29, pp. 39-42][45, 46]. In fact, relatives of our averaging
principle can also be deduced from Kurtz’s theorem, see [17, Chapter 42]; the same
is essentially true of the Freidlin–Wentzell principle [18].

3. Notation and Assumptions

3.1. Domains and their boundaries. We let Ω0 ⊂ Rd be a connected, bounded
open domain with Lipschitz boundary. Here, we say that an open set Ω ⊂ Rd has
Lipschitz boundary if it is locally the epigraph of a Lipschitz function, see, e.g., [1, p.
111]. More precisely, given z ∈ ∂Ω we may ﬁnd an open neighborhood V of z in ∂Ω
such that there is (a) a cylinder C = B × (a, b), where B is an open ball in Rd−1 and
(a, b) is an open subinterval of R, and (b) an isomorphism J of Rd, and (c) a Lipschitz
continuous functions g : B → R such that deﬁning φ(w, t) = t − g(w) for (w, t) ∈ C,
we have Ω ∩ C = J{φ < 0}, C \ Ω = J{φ > 0}, and V = J{φ = 0}. Our domain Ω0
is further partitioned (see Figure 2), i.e., we consider subsets Ω1, . . . , ΩN −1 ⊂ Ω0
that are pairwise disjoint and open with Lipschitz boundary. We set

ΩN := Int(cid:0)Ω0 \

N −1

[k=1

Ωk(cid:1).

We assume that also ΩN is a bounded open set with Lipschitz boundary. This
assumption excludes certain conﬁgurations of the sets Ω1, . . . , ΩN −1. For example,
it may not happen that we have two balls which touch in exactly one point. On the
other hand, it is no restriction to assume that the sets Ω1, . . . , ΩN are connected,
otherwise we consider the connected components of these sets.

The boundary of the set Ωk is denoted by Γk for k = 0, . . . , N . We write

Γk,ℓ := Γk ∩ Γℓ

for the common boundary of Ωk and Ωℓ (k, ℓ = 0, . . . , N, k 6= ℓ). To simplify some
formulas to be discussed later, we also agree that

Γk,k = ∅

6

ADAM BOBROWSKI, BOGDAN KAZMIERCZAK, AND MARKUS KUNZE

C+
k

C−
ℓ

C+
ℓ

C−
k

Figure 3. The set C+
solid line.

k ∩ C+

ℓ

is empty: V0 is the graph drawn with

for k = 1, . . . , n. Note that we may also well have that Γk,ℓ = ∅ for certain values
of k 6= ℓ. Below, we always endow the boundaries Γk with their natural surface
measure σk. Actually σk coincides with (d − 1)-dimensional Hausdorﬀ measure
H d−1 since all appearing domains have a Lipschitz boundary. As there is no
chance of confusion, we drop the index k and write σ for the surface measure on
any of the Γk.

Below, we make use of the following observation.

Lemma 3.1. If k, ℓ, m are distinct numbers between 0 and N , then the (d − 1)-
dimensional Hausdorﬀ measure of Γk ∩ Γℓ ∩ Γm is zero.

Proof. Since any set of non-zero Hausdorﬀ measure contains a non-empty open set,
it suﬃces to show that if there is a non-empty open set V ⊂ Γk,ℓ, then there is a
non-empty subset V0 of V which is open (in the relative topology) in Γk,ℓ and an
open subset U of Rd such that

(3.1)

V0 ⊂ U,

U \ V0 ⊂ Ωk ∪ Ωℓ.

To prove this claim, pick a point in V . Choosing a suitable coordinate system,
we may assume without loss of generality that there exists an open neighborhood
V0 ⊂ V of this point such that the following conditions hold (see Figure 3):

1. There are two cylinders Ci = Bi × (ai, bi), i = k, ℓ, where Bi’s are open balls

2.

in Rd−1 and (ai, bi)’s are open subintervals of R, and
there is an isomorphism J of Rd and Lipschitz continuous functions gi : Bi →
R such that deﬁning φi(w, t) = t − gi(w) for (w, t) ∈ Ci, we have
a. Ωk ∩ Ck = {φk < 0}, Ck \ Ωk = {φk > 0}, and V0 = {φk = 0},
b. Ωℓ ∩ Cℓ = J{φℓ < 0}, Cℓ \ Ωℓ = J{φℓ > 0}, and V0 = J{φℓ = 0}.

We note that continuity of gis implies continuity of φis as functions of two variables.
We claim that the neighborhood we look for is U = Ck ∩ Cℓ. Since V0 ⊂ Ck and
V0 ⊂ Cℓ, we clearly have V0 ⊂ U . Let us show that U \ V0 ⊂ Ωk ∪ Ωℓ. To this end,
we ﬁrst simplify our notations by putting

C+
C+

C−
k = {φk > 0},
ℓ = J{φℓ > 0}, C−

k = {φk < 0},
ℓ = J{φℓ < 0},

k ∪ C+
and then write U \ V0 = (C−
C−
k ∩ (C−

k ) ∩ (C−
ℓ ∪ C+

ℓ ∪ C+
ℓ ) ⊂ C−

k ⊂ Ωk

ℓ ) as the union of

and

C+

k ∩ (C−

ℓ ∪ C+

ℓ ) = (C+

k ∩ C−

ℓ ) ∪ (C+

k ∩ C+

ℓ ).

AN AVERAGING PRINCIPLE FOR FAST DIFFUSIONS

7

Since C+
Figure 3).

k ∩ C−

ℓ ⊂ C−

ℓ ⊂ Ωℓ, it suﬃces to show that C+

k ∩ C+

is empty (see again

ℓ

ℓ

ℓ . Then, there is ε > 0 such that (w, t0) ∈ C+

Suppose that, contrary to our claim, there is (w0, t0) ∈ Ck that belongs to
C+
k ∩ C+
for all w∈ B(w0, ε),
where B(w0, ε) denotes the ball in Rd−1 of radius ε centered at w0. Fix such a w, and
let I ⊂ Ck be the closed line segment with ends z1 = (w, gk(w)) and z2 = (w, t0).
Then ˜I := J −1I is also a line segment (since J is an isometry) and it is contained
in Cℓ (since Cℓ is a convex set containing J −1(z1) and J −1(z2)). Moreover, we have
φℓ ◦ J −1(z1) = 0 and φℓ ◦ J −1(z2) > 0.

k ∩ C+

We note that, φℓ is positive on ˜I \ J{z1}.

Indeed, otherwise we would have
φℓ(z) = 0 for some z in the interior of ˜I. But this implies that J(z) ∈ I and, since
JV0 = V0, also J(z) ∈ V0. This is a contradiction to the fact that, by the deﬁnition
of Ck, on I there is precisely one point, namely z1, of V0. Therefore, I does not
contain points of Ωℓ. On the other hand, by the deﬁnition of Ck, the open line
segment joining z0 = (w, ak) and z1 is contained in Ωk and thus cannot contain
points of Ωℓ, either.

Altogether we have showed that the cylinder

C = B(w0, ε) × (ak, t0)

has empty intersection with Ωℓ. But C contains V0. This clearly contradicts the
fact that V0 is a part of boundary of Γℓ, and hence our assumption that C+
k ∩ C+
is non-empty was false.

ℓ
(cid:3)

We note that the argument presented above does not require the boundary to be

Lipschitz: it suﬃces to assume that the boundary is continuous.

3.2. Diﬀusion and permeability of membranes. Let

N = {1, . . . , N }

and N0 = {0, 1, . . . , N }.

It is our aim to study diﬀusion on Ω0 with the sets Γk (for k ∈ N ) modeling semi-
permeable membranes (see below). As far as our diﬀusion coeﬃcients A = (aij ) ∈
L∞(Ω0; Rd×d) are concerned, we make the following assumptions.

(i) They are symmetric, i.e. aij = aji for i, j = 1, . . . , d.
(ii) They are uniformly elliptic, i.e. there exists a constant γ > 0 such that for

any vector ξ ∈ Cd we have

d

Xi,j=1

aij(x)ξi ¯ξj ≥ γkξk2 = γ

d

Xj=1

|ξj|2

for almost every x ∈ Ω0.

The diﬀerential operator we are interested in is formally given by

(3.2)

L u =

d

Xi,j=1

∂i(aij∂ju)−cu = div(A∇u)−cu,

where c ∈ L∞(Ω0) is a given non-negative function playing the role of a potential.
To deﬁne a suitable realization of L in L2(Ω0) we use form methods. The related
form is deﬁned on the space H ⊂ L2(Ω0):

H := {u ∈ L2(Ω0) : u|Ωk ∈ H 1(Ωk) ∀ k = 1, . . . , N }.

Obviously, H is a Hilbert space with respect to the inner product

hu, viH := ZΩ0

u¯v dλ +

N

Xk=1

ZΩk

∇u · ∇v dλ,

where λ denotes the d-dimensional Lebesgue measure, and z is the conjugate of a
complex number z.

8

ADAM BOBROWSKI, BOGDAN KAZMIERCZAK, AND MARKUS KUNZE

For u ∈ H the function u|Ωk has a trace in L2(Γk) as Ωk has a Lipschitz boundary.
We denote the trace of u|Ωk by u|k. Note that we can have u|k 6= u|ℓ on Γk,ℓ. Thus,
we should interpret u|k as ‘the values of u on the boundary Γk,ℓ when approached
from within Ωk’, whereas u|ℓ are ‘the values on the boundary when approached from
within Ωℓ’.

We imagine that a diﬀusing particle in any subdomain Ωk may permeate through
a semi-permeable membrane, i.e. through the boundary Γk,ℓ separating this sub-
domain from the neighboring subdomain Ωℓ. The membrane’s permeability may
change along the boundary.
In particular, the permeability may vary from Γk,ℓ
to Γk,ℓ′ . This is modeled by permeability functions τk deﬁned on Γk; we assume
τk ∈ L∞(Γk; R) with τk ≥ 0 almost everywhere. The value of τk at a point x of the
boundary should be thought of as the permeability coeﬃcient of the membrane at
this point, whose interpretation in probabilistic terms may be found in [14, 19, 47].
Roughly speaking, the larger τk(x), the less time it takes on average to permeate
through the membrane at x, when approaching from within Ωk (see also the dis-
cussion after (3.3)). Note that by Lemma 3.1, up to a set of measure zero, there is
only one adjacent set Ωℓ to which the particle may permeate.

Moreover, we are given measurable functions bk,ℓ : Γk,ℓ → [0, 1] for 1 ≤ k, ℓ ≤ N .
The quantity bk,ℓ(x) describes the possibility that a particle right after ﬁltering
from Ωk through the membrane Γk,ℓ at a point x, instead of starting diﬀusion in
Ωℓ, will be immediately killed and removed from the state-space. For bk,ℓ(x) = 1
all particles survive ﬁltering through the membrane at this point, for bk,ℓ(x) = 0
none of them does.

To formulate our transmission conditions, we need to deﬁne the conormal deriv-

ative associated with L on the domain Ωk. We do this in a variational sense.

Deﬁnition 3.2. Let u ∈ H be such that div(A∇u)|Ωk ∈ L2(Ωk). Then there exists
a unique function Nk(u) ∈ L2(Γk, σ) such that

ZΩk

div(A∇u)¯v dλ +ZΩk

(A∇u) · ∇v dλ = ZΓk

Nk(u)¯v|k dσ

for all v ∈ H 1(Ωk). We call Nk(u) the conormal derivative of u on Ωk.

To see that such a function Nk(u) exists, let Φ : L2(Γk) → H 1(Ωk) be a contin-
uous linear mapping such that Φ(g)|k = g. We can for example pick Φ(g) as the
unique solution of the Dirichlet problem

(cid:26) div(A∇u) = 0

u|∂Ωk = g.

If u ∈ H 1(Ωk) is such that div(A∇u) ∈ L2(Ωk) we can consider the map ϕu :
L2(Γk) → C deﬁned by

ϕu(g) := ZΩk

div(A∇u)Φ(g) dλ +ZΩk

(A∇u)∇Φ(g) dλ.

Since Φ is continuous ϕu is a continuous, antilinear functional on L2(Γk). Hence it
follows from the theorem of Riesz–Fr´echet that there exists a unique element Nk(u)
such that

ϕu(v) = ZΓk

Nk(u)¯v dσ.

In the situation where everything is smooth, it follows from the divergence theo-

rem that

Nk(u) =

d

Xi,j=1

aij∂juνj

where ν = (ν1, . . . , νd) is the outer normal to Ωk.

AN AVERAGING PRINCIPLE FOR FAST DIFFUSIONS

9

Our transmission conditions are:

(3.3)

Nk(u) = −τk(u|k − bk,ℓu|ℓ)

on Γk,ℓ

for all k, ℓ ∈ N

(see also (3.6), further down). These conditions may be interpreted as follows: a
particle diﬀusing in a region Ωk ‘bounces’ from the membrane separating it from Ωℓ,
similarly to the reﬂected Brownian motion, but the time it spends ‘at the membrane’
is measured, and after an exponential time with respect to this reference measure
elapses, the particle ﬁlters through to Ωℓ. The larger the τk at an inﬁnitely small
part of the membrane the larger the parameter in the exponential time, and the
shorter the time it takes to ﬁlter through that part of the membrane. Additionally,
as described above, functions bk,ℓ describe the possibility that a particle will be
killed after ﬁltering through the membrane Γk,ℓ.

For each k ∈ N , on the part Γk,0 of the outer boundary Γ0, we impose the Robin

boundary conditions

(3.4)

Nk(u) = −τku|k,

and note that this is reduces to (3.3) for ℓ = 0 when agreeing

bk,0 = 0,

i.e. that all particles ﬁltering from Ω0 to its complement are immediately killed, and
removed from the state-space.

3.3. The related quadratic form. Let us assume that u ∈ H is such that div(A∇u) ∈
L2(Ω0) and such that the transmission conditions (3.3) and the boundary condition
(3.4) are satisﬁed. Then for a function v ∈ H we have

div(A∇u)¯v dλ

−ZΩ0

div(A∇u)¯v dλ = − Xk∈N ZΩk
= Xk∈N (cid:16)ZΩk
= ZΩ0

(A∇u) · ∇v dλ −ZΓk
ZΓk,l

(A∇u) · ∇v dλ + Xk∈N

ℓ∈N0

Nk(u)¯v|k dσ(cid:17)

τk(u|k − bk,ℓu|ℓ)¯v|k dσ.

the set Ω0 \ SN

Here the ﬁrst equality uses the fact that the d-dimensional Lebesgue measure of
k=1 Ωk is zero, the second equality is the deﬁnition of the conormal
derivative (or the divergence theorem in the smooth case), the third one follows from
Lemma 3.1, the transmission conditions (3.3) and the boundary condition (3.4).

This calculation leads us to deﬁne the following forms on the Hilbert space

L2(Ω0).

Deﬁnition 3.3. For a parameter κ ≥ 0, we deﬁne the form aκ by setting

and the form q by

aκ[u, v] := ZΩ0

κ(A∇u) · ∇v + cu¯v dλ,

q[u, v] := Xk∈N

ℓ∈N0

ZΓk,l

τk(u|k − bk,ℓu|ℓ)¯v|k dσ

for u, v in the common domain D(q) = D(a) := H. We put hκ := aκ + q. The
adjoint q∗ of q is given by

(3.5)

q∗[u, v] = Xk∈N
Since a is symmetric we have h∗

ℓ∈N0
κ = aκ + q∗.

ZΓk,l

τku|k(¯v|k − bk,ℓ¯v|ℓ) dσ.

10

ADAM BOBROWSKI, BOGDAN KAZMIERCZAK, AND MARKUS KUNZE

Remark 3.4. Rearranging the terms in (3.5), we see that

q∗[u, v] = Xk∈N

ℓ∈N0

ZΓk,l

(τku|k − τℓbk,ℓu|ℓ)¯v|k dσ.

Repeating the computations from the beginning of this subsection, we conclude that
functions in the domain of the adjoint operator satisfy the following transmission
conditions:

(3.6)

Nk(u) = −(τku|k − τℓbk,ℓu|ℓ) on Γk,ℓ

for all k, ℓ ∈ N .

It should be noted, however, that in a sense both forms describe the same dynam-
ics. More speciﬁcally, if S2 is the semigroup to be introduced in the next section,
and ‘generated’ by h∗
κ, and if a non-negative u ∈ L2(Ω) is the initial distribution of
the underlying stochastic process (Xt)t≥0 in Ω0, then S2(t)u is the distribution of
this process at time t ≥ 0. On the other hand, the semigroup T2 of the next sec-
tion, ‘generated’ by hκ, speaks of the dynamics of expected values: for u ∈ L2(Ω0),
T2(t)u(x) is the expected value of u(Xt) conditional on X0 = x, x ∈ Ω0.

As we shall see in examples of Section 6, both (3.3) and (3.6) are used in practice,

depending on what is the quantity modeled.

4. Generation Results

In this section, we prove that for κ ≥ 1 the operator associated with hκ generates
a strongly continuous, analytic and contractive semigroup on L2(Ω0). Afterwards,
we extend these semigroups to the Lp-range. To simplify notation, we write h = h1
and a = a1 and prove the main results for this form. Note, however, that they also
apply to hκ for κ ≥ 1, as is seen by changing the diﬀusion coeﬃcients matrix A.
The following proposition is the key step towards a generation result on L2(Ω0).
Proposition 4.1. The forms h and h∗ are closed, accretive and sectorial.

Proof. Since A is symmetric and c is real valued with c ≥ 0, the form a is symmetric
and obviously we have a[u] ≥ 0 for all u ∈ H. Let M := supx∈Ω0 kA(x)k< ∞. We
then have

γ|∇u|2 ≤ hA∇u, ∇ui ≤ |A∇u||∇u| ≤ M |∇u|2

almost everywhere. Integrating this inequality over Ω0 and adding a suitable mul-
tiple of kuk2

L2(Ω0) we see that

min{1, γ}kuk2

H ≤ a[u] + kuk2

L2(Ω0) ≤ max{1 + kckL∞(Ω0), M }kuk2
H.

Thus, the inner product hu, via := a[u, v] + hu, viL2(Ω) is equivalent to the canonical
inner product in H, i.e., the related norms are equivalent. This yields the closedness
of a.

To prove that h is closed and sectorial we show that q is a-bounded with a-bound

0, i.e. for every ε > 0 there exists a constant C(ε) such that

| q[u]| ≤ ε a[u] + C(ε)kukL2(Ω).

For the proof, let a sequence un be given with un ⇀ 0 in H. It follows from the
compactness of the trace operator (which is a consequence of the Lipschitz nature
of the boundary, see [53, Theorem 2.6.2]) that we have un|k → 0 in L2(Γk, σ) for
k = 0, . . . , N . As the functions τ0, . . . , τn and bk,ℓ (1 ≤ k, ℓ ≤ N ) are bounded, it
follows from the Cauchy–Schwarz inequality that q[un] → 0. Since q is bounded on
D(a) (a consequence of the boundedness of the trace operator) it now follows from
[24, Lemma 7.4] that q is a-bounded with a-bound 0.

A perturbation result for sectorial forms [41, Theorem VI.1.33] yields that h is
a closed and sectorial form; moreover, the associated inner product is equivalent
to that associated to a and thus it is equivalent to the canonical inner product in

AN AVERAGING PRINCIPLE FOR FAST DIFFUSIONS

11

H, proving that h is closed. Finally, as the a-bound of q is 0, it follows that h is
accretive as well.

With the same reasoning we can show that h∗ is closed, sectorial and accretive.
(cid:3)

We denote by L2 the associated operator of h in L2(Ω0). From Theorem 2.1 we

obtain the following result.

Corollary 4.2. The operator L2 generates a strongly continuous, holomorphic
and contractive semigroup T2 = (T2(t))t≥0 on L2(Ω). The operator L ∗
2 generates
a strongly continuous, holomorphic and contractive semigroup S2 = (S2(t))t≥0 on
L2(Ω0). We have S2 = T ∗
2 .

Next we establish additional properties of the semigroups T2 and S2.

Proposition 4.3. The semigroup T2 has the following properties.

(a) T2 is real, i.e. if u ∈ L2(Ω0) is real-valued then so is T2(t)u for all t ≥ 0;
(b) T2 is positive, i.e. if u ≥ 0 almost everywhere then T2(t)u ≥ 0 almost

everywhere for all t ≥ 0;

(c) T2 is L∞-contractive, i.e. if u ∈ L∞(Ω0) then for every t ≥ 0 we have

T2(t)u ∈ L∞(Ω0) and kT2uk∞ ≤ kuk∞.

The semigroup S2 is also real, positive and L∞-contractive.

Proof. The proof of all three parts is based on Ouhabaz’ criterion [55, Theorem
2.2] and its corollaries. We do the necessary calculations for the form h. Similar
calculations for h∗ yield the corresponding properties for the semigroup S2.

(a) Obviously, if u ∈ D(h) = H then also Re u, Im u ∈ D(h). As all the coeﬃcients
in A, c, τ0, . . . , τn and bk,ℓ (1 ≤ k, ℓ ≤ N ) are real-valued, h[Re u, Im u] ∈ R for all
u ∈ D(h). Now part (a) follows from [55, Proposition 2.5].

(b) Since H is a lattice with respect to the usual ordering, it follows that if
u ∈ D(h) is real-valued then also u+ ∈ D(h) and u+u− = 0 almost everywhere.
Moreover, by Stampaccia’s Lemma [39, Lemma 7.6] we have ∂ju+ = (∂ju)1{u>0}
so that, in particular, we have (A∇u+) · ∇u− = 0 almost everywhere. Note that
we have (u|k)+ = (u+)|k for any k = 0, . . . , N , i.e. the trace of the positive part of
u is the positive part of the trace of u. From this it follows that u+
|k = 0 almost
everywhere for k = 0, . . . , N . Using this we see that for a real-valued u ∈ D(h) we
have

|ku−

h[u+, u−] = − Xk,ℓ∈N ZΓk,ℓ

τkbk,ℓu+

|ℓu−

|k dσ ≤ 0

as τkbk,ℓ ≥ 0 almost surely. It now follows from [55, Theorem 2.6] that T2 is positive.

(c) In view of [55, Theorem 2.13] for this part we have to show that if u ∈ D(h)

then we also have that (1 ∧ |u|) sgn u ∈ D(h) and that

(4.1)

Re h[(1 ∧ |u|) sgn u, (|u| − 1)+ sgn u] ≥ 0.

Here we have sgn z := z
|z| for a complex z 6= 0 and sgn 0 := 0. The condition that
(1 ∧ |u|) sgn u ∈ D(h) follows from standard properties of H 1-functions, see e.g. the
proof of [55, Theorem 4.6]. As in the proof of that result, we see that

Re a[(1 ∧ |u|) sgn u, (|u| − 1)+ sgn u] ≥ 0.

Let us now take care of q. Writing

Ik,ℓ := ZΓk,ℓ

τk(cid:0)(1 ∧ |u|k|) sgn u|k − bk,ℓ(1 ∧ |u|ℓ|) sgn u|ℓ(cid:1)(|u|k| − 1)+sgn u|k dσ,

12

ADAM BOBROWSKI, BOGDAN KAZMIERCZAK, AND MARKUS KUNZE

we have

Re q[(1 ∧ |u|) sgn u, (|u| − 1)+ sgn u] = Re Xk∈N

ℓ∈N0

Ik,ℓ.

Since the integrand in Ik,ℓ vanishes on the set {|u|k| < 1} we see that Ik,ℓ equals

ZΓk,ℓ∩{|u|k|≥1}
= ZΓk,ℓ∩{|u|k|≥1}

τk(cid:2)(1 ∧ |u|k|) sgn u|k − bk,ℓ(1 ∧ |u|ℓ|) sgn u|ℓ(cid:3) (|u|k| − 1)+sgn u|k dσ

τk(cid:2)1 − bk,ℓ(1 ∧ |u|ℓ|) sgn(u|ℓ u|k)(cid:3)(|u|k| − 1)+ dσ.

Since Re sgn(u|ℓu|k) ∈ [−1, 1] and 0 ≤ bk,ℓ ≤ 1, it follows that Re Ik,ℓ ≥ 0 so that,
alltogether, we have proved (4.1). This ﬁnishes the proof.
(cid:3)

We now obtain:

Corollary 4.4. There are consistent families Tp and Sp of contraction semigroups
on Lp(Ω0) for 1 ≤ p ≤ ∞. For 1 ≤ p < ∞ these semigroups are strongly continuous
whereas T∞ and S∞ are merely weak∗-continuous. Moreover, we have T ∗
p = Sq
where 1

q = 1 with the convention that 1

p + 1

∞ = 0.

Proof. As we have seen, T2 is a contraction semigroup and it follows from Proposi-
tion 4.3 (c) that it restricts to a contraction semigroup T∞ on L∞(Ω0). As a conse-
quence of the Riesz–Thorin interpolation theorem (see e.g. [35, Theorem 6.27]), T2
restricts to a contraction semigroup Tp on every Lp(Ω0) for 2 < p < ∞.

Let us prove that T∞ is weak∗-continuous. To that end, let u ∈ L∞(Ω0) and
tn → 0+. Since T2 is strongly continuous we have T2(tn)u → u in L2(Ω0). Passing
to a subsequence, we may (and shall) assume that T2(tn)u → u pointwise almost
everywhere. Since the sequence (T2(tn)u)n≥1 is bounded in the k·k∞-norm it follows
from the dominated convergence theorem that

ZΩ0

(T2(tn)u) ¯v dλ → ZΩ0

u¯v dλ

for every v ∈ L1(Ω0). This proves that T∞(tn)u = T2(tn)u converges in the weak∗-
topology to u, so that T∞ is weak∗-continuous. We note that T∞ is never strongly
continuous.
Indeed, a general result due to Lotz [48] shows that every strongly
continuous semigroup on L∞(Ω0) is automatically uniformly continuous and thus
has a bounded generator. In our situation this would yield L∞(Ω0) ⊂ H which is
absurd.

We now turn to continuity of the semigroups Tp for 2 < p < ∞. Let q be the
conjugate of p. Since Lq(Ω0) ⊂ L1(Ω0), and Tpu = T∞u for u ∈ Lp(Ω0) ∩ L∞(Ω0)
it follows from the above that Tp(t)u → u, as t → 0+, weakly in Lp(Ω0) for all
u ∈ Lp(Ω0) ∩ L∞(Ω0). As is well known a weakly continuous semigroup is strongly
continuous, see [28, Theorem I.5.8]. Actually, to use that theorem, we would need
to prove that t 7→ Tp(t)u is weakly continuous for every u ∈ Lp(Ω). However,
inspection of the proof shows that for a bounded semigroup it actually suﬃces to
prove weak continuity of the orbits for u in a dense subset. This shows that Tp is
strongly continuous.

The same argument yields consistent semigroups Sp for 2 ≤ p ≤ ∞ where Sp is

strongly continuous and S∞ is weak∗-continuous.

We next prove that T∞ is an adjoint semigroup. To that end, let u ∈ L2(Ω0)

and v ∈ L∞(Ω0). Since S∗

2 = T2 we ﬁnd

ZΩ0

(cid:12)(cid:12)(cid:12)

(S2(t)u)¯v dλ(cid:12)(cid:12)(cid:12)

= (cid:12)(cid:12)(cid:12)

ZΩ0

uT2(t)v dλ(cid:12)(cid:12)(cid:12)

≤ kuk1kT2(t)vk∞ ≤ kuk1kvk∞.

AN AVERAGING PRINCIPLE FOR FAST DIFFUSIONS

13

Taking the supremum over v ∈ L∞(Ω0) with kvk∞ ≤ 1, we see that S2(t)u ∈ L1(Ω0)
and kS2(t)uk1 ≤ 1. Thus, S2(t) can be extended to a contraction S1(t) on L1(Ω0).
Clearly, [S1(t)]∗ = T∞(t) which proves that T∞ consists of adjoint operators. It
follows from the weak∗-continuity of T∞ that the orbits of S1 are weakly continuous
hence, by [28, Theorem I.5.8], S1 is a strongly continuous semigroup. Similarly, T2
extends to a strongly continuous contraction semigroup T1 on L1(Ω0) with T ∗
1 = S∞.
q for 1 < p < 2 where
It follows that all semigroups Tp (and Sp),
(cid:3)

q ∈ (2, ∞) is such that 1
p ∈ (1, ∞) are weakly continuous, and hence also strongly continuous.

Finally, in an analogous way we get Sp = T ∗

p + 1

q = 1.

q and Tp = S∗

5. Convergence results for fast diffusion

5.1. Convergence in L2. In this section, we ‘speed up diﬀusion’ by considering
the forms hκ with index κ ≥ 1 again. Formally, this corresponds to replacing the
diﬀusion matrix A with κA. Applying the results of the previous section to hκ and
h∗
κ, we obtain consistent semigroups Tp,κ and Sp,κ for 1 ≤ p ≤ ∞; by Lp,κ and L ∗
p,κ
we denote their generators so that

eLp,κt = Tp,κ(t)

and

eL ∗

p,κt = Sp,κ(t).

We are interested in convergence of these semigroups as κ → ∞.

Note that in changing the diﬀusion matrix A we are also changing the co-normal
derivative which appears in our transmission conditions. Thus, such a change results
in speeding up the diﬀusion while keeping the ﬂux through the boundary constant.
With the help of Theorem 2.2 we prove the following result. Note that the space H0
appearing in the following theorem is closed in L2(Ω0), so that H0 coincides with
the closure of the form domain, considered in Section 2.

Theorem 5.1. As κ → ∞ the form hκ converges in the strong resolvent sense to
the restriction of a0 + q to the domain

H0 = {u ∈ L2(Ω0) : u|Ωk is constant for k = 1, . . . , N }.

Similarly, h∗
strong convergence

κ converges in the strong resolvent sense to a0 + q∗. Moreover, we have

T2,κ(t)u → e−t(a0 + q)u and S2,κ(t)u → e−t(a0 + q∗)u,

t > 0,

in L2(Ω0) as κ → ∞.

Proof. We have Re hκ[u] = aκ[u] + Re q[u] which is clearly increasing in κ. On the
other hand, Im hκ[u] = Im q[u] since a is symmetric. Thus Im hκ[u] is independent
of κ whence both contitions (b)(i) and (b)(ii) in Theorem 2.2 are satisﬁed. Next,
since h1 is sectorial we ﬁnd a constant C > 0 such that

|Im q[u]| ≤ C(a[u] + Re q[u]) ≤ C(κ a[u] + Re q[u]) = CRe hκ[u].

This shows that the forms hκ, κ ≥ 1 are indeed uniformly sectorial so that all
assumptions of Theorem 2.2 are satisﬁed, implying the strong resolvent convergence
of the forms and strong convergence of the semigroups.

Let us check that the limiting form is as claimed. Obviously, supκ Re hκ[u] < ∞

if and only if

(5.1)

ZΩ0

(A∇u) · ∇u dλ = 0

and in this case limκ→∞ hκ[u] = a0[u]+q[u]. Since the matrix A is uniformly elliptic
(as assumed throughout) Equation (5.1) implies that ∇u = 0 on Ωk for k = 1, . . . , N .
As each Ωk was assumed to be connected, u is constant on each of these sets. Since,
conversely, u ∈ H0 implies (5.1), we are done.
(cid:3)

14

ADAM BOBROWSKI, BOGDAN KAZMIERCZAK, AND MARKUS KUNZE

Remark 5.2. We can actually ‘speed up’ diﬀusion in a much more general way and
obtain the same convergence result. Indeed, let Aκ = (a(κ)
ij ) ∈ L∞(Ω0, Rd×d) be
such that

γkξk2 ≤

d

Xi,j=1

a(κ)
ij (x)ξi ¯ξj ≤

d

Xi,j=1

a(κ+1)
ij

(x)ξi ¯ξj

for every κ ≥ 1, every ξ ∈ Cd and almost all x ∈ Ω0 and such that

sup

κ

d

Xi,j=1

a(κ)
ij (x)ξi ¯ξj = ∞

for almost all x ∈ Ω0 and all ξ ∈ Cd \ {0}. If we deﬁne the form aκ as in Deﬁnition
3.3 with κA replaced with Aκ, then aκ is an increasing sequence of symmetric forms
and sup aκ[u] < ∞ if and only if a[u] = 0, and the conclusion in Theorem 5.5 remains
valid.

5.2. Interpretation of the result. In this section, we describe in more detail the
limiting form and the limit semigroup, and provide a probabilistic interpretation of
Theorem 5.5. As we have seen in Section 2, the limit semigroup basically operates
on the space H0, whereas everything in H ⊥
is immediately mapped to 0. The
0
orthogonal projection onto H0 is given by

(5.2)

PH0 u := Xk∈N

1

λ(Ωk) ZΩk

Let µ be the measure on N deﬁned by

u dλ · 1Ωk ,

u ∈ L2(Ω0).

µ(S) = Xk∈S

λ(Ωk),

for S ⊂ N .

We denote the associated Lp spaces by ℓp
identiﬁed with CN equipped with the norm

µ := Lp(N , 2N , µ). Clearly, ℓp

µ can be

kxkℓp := (cid:16) Xk∈N

|xk|pλ(Ωk)(cid:17)

1
p

for x = (x1, . . . , xN ) ∈ CN .

In particular, ℓ2

µ is a Hilbert space with respect to the scalar product

hx, yiℓ2

µ

= Xk∈N

xkykλ(Ωk).

We note that the norm k · kℓp
isomorphic to H0 viewed as a subspace of Lp(Ω0) via the isomorphism

µ is chosen in such a way that ℓp

µ is isometrically

Φ : x 7→ Xk∈N

xk 1Ωk .

Our goal is to identify the operator associated with the limiting form, or – more
µ. To this end, for k ∈ N , ℓ ∈ N0, ℓ 6= k, let

speciﬁcally – its isomorphic image in ℓ2

ρk,ℓ = ZΓk,ℓ

τk dσ.

For ℓ 6= 0 this is the total permeability of the membrane Γk,ℓ separating Ωk from Ωℓ
when approached from within Ωk. It may also be thought of as the average number
of particles that ﬁlter through Γk,l in a unit of time. Next, for k ∈ N ,

̺k,k = − Xℓ∈N0,ℓ6=k

ρk,ℓ

AN AVERAGING PRINCIPLE FOR FAST DIFFUSIONS

15

is (minus) the average number of particles that ﬁlter from Ωk to an adjacent Ωℓ in
a unit of time, i.e. the number of particles lost by Ωk. Finally, the quantity

̺k,ℓ = ZΓk,ℓ

bk,ℓτk dσ

k, ℓ ∈ N ,

may be thought of as the average number of particles that after ﬁltering from Ωk
to Ωℓ in a unit of time survive to continue their chaotic movement in Γℓ, i.e. the
number of particles gained by Ωℓ from Ωk. Finally, we deﬁne

(5.3)

qk,ℓ =

̺k,ℓ
λ(Ωk)

,

k, ℓ ∈ N

and let Q be the real n × n matrix of the coeﬃcients qk,ℓ, k, ℓ ∈ N .

In the case where τk,0 = 0 for all k ∈ N , i.e. when we impose Neumann boundary
conditions on the boundary of Ω0 and, additionally, bk,ℓ = 1 so that ̺k,ℓ = ρk,ℓ for
all k, ℓ ∈ N , i.e. when no loss of particles is possible in the process of ﬁltering
through the inward membranes, the diagonal entries in Q are non positive, the oﬀ-

diagonal entries are non negative and the row sums Pℓ∈N qk,ℓ are zero for every

k ∈ N . This shows that Q is the intensity matrix of a continuous time (honest)
Markov chain with N states.
In general, however, a loss of probability mass is
possible – this corresponds to the possibility for a particle to be killed after ﬁltering
through the inward or outward membrane in the approximating process. Hence, in
general the chain described by Q is not honest.

Proposition 5.3. The operator associated with q restricted to H0 is

ΦQΦ−1.

Proof. Let u = Φ(x), v = Φ(y) ∈ H0. Then

q[u, v] = Xk∈N

ℓ∈N0

ZΓk,ℓ

τk(xk − bk,ℓxℓ)¯yk dσ

xkykZΓk,ℓ

τk dσ − Xk∈N

ℓ∈N0

xℓykZΓk,ℓ

τkbk,ℓ dσ

ℓ∈N0

= Xk∈N
= − Xk∈N

̺k,kxkyk − Xk,ℓ∈N

k6=ℓ

̺kℓxℓyk

(recall bk,0 = 0 and Γk,k = ∅)

= − Xk,ℓ∈N

qk,ℓxℓykλ(Ωk) = −hQx, yiℓ2

µ

where Qx is the matrix product. It follows that

q[u, v] = −hQΦ−1u, Φ−1viℓ2 = −hΦQΦ−1u, viHr ,

where the last scalar product in Hr is that inherited from L2(Ω0). This completes
the proof.
(cid:3)

Let C := diag(Φ−1P c), where P is deﬁned by (5.2). In other words, C is the
diagonal matrix whose entries are the average values of c on the sets Ωk (1 ≤ k ≤ N ).
A straightforward computation shows that the operator related to a0 restricted
to H0 is −ΦCΦ−1. Combining this with Proposition 5.3, we obtain the following
corollary.

Corollary 5.4. The operator associated with the limiting form is

Φ(Q − C)Φ−1.

16

ADAM BOBROWSKI, BOGDAN KAZMIERCZAK, AND MARKUS KUNZE

Ω1
Ω2
Ω3

Ω6

Ω5

Ω4

Ω7

Ω1

Ω4

fast diﬀusion
constant ﬂux

Ω2

Ω7

Ω5

Ω3

Ω6

Figure 4. State-space collapse as fast diﬀusions on domains sep-
arated by semi-permeable domains converge to a Markov chain.
Intensity of jump between aggregated states Ωk and Ωℓ is qk,ℓ =
̺k,ℓ
λ(Ωk) .

From now on, we no longer distinguish between ℓ2

µ and its isometric image H0 =
Φ(ℓ2). Thus, with slight abuse of notation, we will consider the (matrix) semigroups
et(Q−C) and et(Q−C)∗
as semigroups on the space H0. With this convention, we can
now reformulate Theorem 5.1 as follows (see (2.1) and (5.2)).

Theorem 5.5. With the notation introduced above, we have for every u ∈ L2(Ω0)
and t > 0

lim
κ→∞

lim
κ→∞

T2,κ(t)u = et(Q−C)PH0 u and
S2,κ(t)u = et(Q∗−C)PH0 u.

To summarize: in probabilistic terms discussed in this subsection, Theorem 5.5
with c = 0 asserts that our diﬀusion processes converge to a continuous time Markov
chain with state space N which may be though of as being composed of N aggre-
gated states, each of them corresponding to one domain of diﬀusion (see Figure
4); c 6= 0 plays the role of a potential term. As advertised in the introduction,
the jump intensities in this chain (given by (5.3)) are in direct proportion to the
total permeability of the membranes, and in inverse proportion to the sizes of the
domains.

5.3. Convergence in Lp. The space H0 is contained in Lp(Ω0) for every 1 ≤ p ≤
∞. Moreover, the right hand side of (5.2) is well deﬁned also for u in Lp(Ω0) and
deﬁnes a projection on Lp(Ω0) with range H0. By slight abuse of notation, we denote
that projection still by PH0 . Thus, we may view et(Q−C)PH0 and et(Q∗−C)PH0 as
degenerate semigroups on Lp(Ω). The main result of this section (which, along with
Theorem 5.5, is the main result of the paper as well) extends Theorem 5.5 to the
setting of Lp spaces.

Theorem 5.6. For 1 ≤ p < ∞, t > 0 and u ∈ Lp(Ω0) we have

lim
κ→∞

Tp,κ(t)u = et(Q−C)PH0 u and lim
κ→∞

Sp,κ(t)u = et(Q∗−C)PH0 u

in the Lp(Ω) norm. Moreover, for u ∈ L∞(Ω0) we have

lim
κ→∞

T∞,κ(t)u = et(Q−C)PH0 u and

S∞,κ(t)u = et(Q∗−C)PH0 u

lim
κ→∞

in the weak∗ topology of L∞(Ω0).

Proof. Let u ∈ L∞(Ω0). By the previous theorem, T2,κ(t)u converges to et(Q−C)PH0 u
in the norm of L2(Ω0). Passing to a subsequence, we may and shall assume that
we have almost sure convergence. Since the sequence T2,κ(t)u is uniformly bounded

AN AVERAGING PRINCIPLE FOR FAST DIFFUSIONS

17

(by kuk∞) it follows from the dominated convergence theorem that T2,κ(t)u con-
verges to et(Q−C)PH0 u weak∗ in L∞(Ω0). Another consequence of the dominated
convergence theorem is that T2,κ(t)u = Tp,κ(t)u → et(Q−C)PH0 u in Lp(Ω0) for ev-
ery 1 ≤ p < ∞. Since L∞(Ω0) is dense in Lp(Ω0) for 1 ≤ p < ∞ and since
the operators Tp,κ(t), κ > 0 are uniformly bounded, a 3ε argument yields that
Tp,κ(t)u → et(Q−C)PH0 f in Lp(Ω0) for every u ∈ Lp(Ω0). The corresponding state-
ments for Sp,κ are obtained similarly.
(cid:3)

Remark 5.7. We stress again that the limit dynamics in Theorem 5.6 is that in
ℓp
µ, which is a natural choice for the semigroups Tp,κ. In describing the limits of
densities of approximating processes (dynamics of densities of these processes are
governed by the semigroups S1,κ), it is often more natural to consider CN equipped
with the standard norm:

kxkℓ1 := Xk∈N

|xk|

for x = (x1, . . . , xN ) ∈ CN ;

µ are isometrically isomorphic,

the latter space will be denoted ℓ1. Clearly, ℓ1 and ℓ1
with the isomorphism, say Φ1, mapping x ∈ ℓ1 to
xN

λ(ΩN )(cid:19) ∈ ℓ1

µ.

Φ1x = (cid:18) x1

λ(Ω1)

, . . . ,

As a bit of linear algebra shows, in the context of ℓ1 the limit dynamics is governed
by ˜Q = Φ−1
1 QΦ1, i.e. the matrix obtained from Q by ﬁrst multiplying the ith row
of Q by λ(Ωi) and then dividing its ith column by λ(Ωi) for each i ∈ N . In other
words, the entries of ˜Q are given by (compare (5.3))

(5.4)

˜qk,ℓ =

̺k,ℓ
λ(Ωℓ)

,

k, ℓ ∈ N ;

see Section 6.3 for an example.

(cid:3)

In our examples in the following section, we will also consider inhomogeneous

equations, i.e. equations of the form

z′(t) = Az(t) + f (t),

u(0) = u0

where A is the generator of a strongly continuous semigroup T on a Banach space
X and f ∈ L1((0, t0); X), for some t0 > 0. Most often, one uses the concept of
a mild solution for such equations. By [5, Proposition 3.1.6], the mild solution is
given through the variation of constants formula

(5.5)

for t ∈ [0, t0].

z(t) = T (t)u0 +Z t

0

T (t − s)f (s) ds

We now obtain the following corollary to Theorem 5.6.

Corollary 5.8. Fix p ∈ [0, ∞) and t0 > 0. Let [0, t0] ∋ t 7→ f (t) ∈ Lp(Ω0) be a
Bochner integrable function, and u0 be a ﬁxed element of Lp(Ω0). Then, as κ → ∞,
the mild solutions [0, t0] ∋ t 7→ zκ(t) ∈ Lp(Ω0) of the Cauchy problems

z′
κ(t) = Lp,κuκ(t) + f (t),

t ∈ [0, t0],

zκ(0) = u0,

converge in Lp(Ω0) and pointwise on (0, t0] to the function

et(Q−C)PH0 u0 +Z t

0

e(t−s)(Q−C)PH0 f (s) ds,

the solution of the Cauchy problem

z′(t) = (Q − C)z(t) + PH0 f (t)

t ∈ [0, t0],

z(0) = PH0 u0

on the space H0. An analogous result holds for L ∗

p,κ.

18

ADAM BOBROWSKI, BOGDAN KAZMIERCZAK, AND MARKUS KUNZE

Proof. This is immediate from Theorem 5.6, formula (5.5) and the dominated con-
vergence theorem.
(cid:3)

Remark 5.9. A related convergence result also holds for p = ∞. However, the
situation is slightly more complicated as we are dealing with a semigroup which is
not strongly continous. However, if we interpret the integral in (5.5) as a weak∗-
integral, then the integral is well-deﬁned whenever f is weak∗ measurable and kf k
is integrable. If we accept (5.5) as deﬁnition of a mild solution in the case of p = ∞,
then, in the situation of Corollary 5.8 we easily obtain pointwise weak∗-convergence
of mild solutions.

6. Examples

6.1. Kinase activity. Fast diﬀusion is a rich source of interesting singular per-
turbations, see e.g.
[16]. This is the case, for example, in the following model of
kinase activity from [42] (see also [22]). Let us recall that kinases are enzymes that
transport phosphate groups.
In doing this, protein kinases transmit signals and
control complex processes in cells. In [42], following [20], a cell is modeled as a unit
3d ball. All kinases, whether active (i.e. phosphorylated) or inactive, are diﬀusing
inside the ball. Binding a receptor located at the cell membrane (the sphere) by an
extracellular ligand is a signal which is to be conveyed to the cell. This is done by
the kinases which, when touching the boundary (the sphere) become activated by
their interaction with the ligand-bound receptors; such active kinases diﬀuse freely
into the interior of the cell. Simultaneously, they are randomly inactivated when
meeting phosphatases which are uniformly distributed over the cell.

In the no feedback case, where all receptors at the membrane are ligand-bound
almost simultaneously, reaching a uniform stable concentration C > 0, the master
equation for the concentration K ∗ of active kinases (after suitable rescaling) is a
diﬀusion-degradation equation
∂K ∗
∂t

= κ△K ∗ − K ∗,

(6.1)

t ≥ 0,

with boundary condition

(6.2)

aC(1 − K ∗

|0) = κ

∂K ∗
∂ν

.

Here, κ > 0 is a diﬀusion coeﬃcient and a > 0 is a reaction coeﬃcient. K ∗
|0 is the
value of K ∗ at the boundary, ∂K ∗
is the usual normal derivative at the boundary
and the term −K ∗ describes random dephosporylation of active kinases. We note
that condition (6.2) describes an inﬂow of active kinases from the boundary (this
b.c. is missing in [20] and was introduced in [42]).

∂ν

One of the aims of both [20] and [42] is to show that (perhaps somewhat surpris-
ingly) slow diﬀusion may facilitate signal transmission more eﬀectively than fast
diﬀusion. To show this, the authors of [42] study the case of inﬁnitely fast diﬀu-
sion and compare the properties of solutions of the limit equation with those of
the original one, showing that the inﬁnite diﬀusion case leads to less-eﬀective signal
transmission. To do this, they assume spherical symmetry and argue that the limit
equation has to be of the form

(6.3)

dK ∗
dt

= 3aC(1 − K ∗) − K ∗,

t ≥ 0.

This is interpreted as follows: As diﬀusion coeﬃcients increase to inﬁnity, the active
kinases’ distribution becomes uniform over the ball and may be identiﬁed with a
real function of time, whose dynamics is then described by (6.3). Nevertheless, the
form of the limit equation is quite curious, with particularly intriguing factor 3.

AN AVERAGING PRINCIPLE FOR FAST DIFFUSIONS

19

In [16] a convergence theorem for semigroups on continuous functions has been
proved asserting that, if spherical symmetry suggested in [42] is granted, the so-
lutions of (6.1)–(6.2) indeed converge to those to (6.3) equipped with appropriate
initial condition. Here we will show that this convergence for κ → ∞ is a special
case of our averaging principle.
In fact, we can also prove convergence in more
general situations, where the ball is replaced by an arbitrary bounded domain, the
Laplacian is replaced by a more general diﬀusion operator and we can consider more
general Robin boundary conditions. Note, however, that in our context we obtain
convergence in the sense of Lp spaces, and not in a space of continuous functions,
thus we do not obtain uniform convergence.

To ﬁt the above example into our framework, we only need the simplest situation
where Ω0 is not partitioned into subregions. Thus, we have N = 1 and ΩN = Ω0.
Strictly speaking, therefore, in this case we are not dealing with transmission condi-
tions, but merely with (Robin) boundary conditions. On the other hand, boundary
conditions may be seen as particular instances of transmission conditions. In other
words, the outer boundary of Ω0, i.e. the boundary of Ω0 with its complement, may
be thought of as a membrane that is permeable only in one direction.

Thus, let Ω0 be a bounded domain in R3 with Lipschitz boundary Γ0. We
replace the operator κ△ − I with Lp,κ, the Lp(Ω0) version of the elliptic operator
(3.2) with diﬀusion matrix A replaces by κA. Moreover, instead of the constant
aC in the boundary condition, we consider a non-negative function τ ∈ L∞(Γ0; R)
(playing the role of τ0 of Section 3.2). With these generalizations, equations (6.1)-
(6.2) become

(6.4)

and

(6.5)

∂K ∗
∂t

= Lp,κK ∗,

t ≥ 0,

τ (1 − K ∗

|0) = N0(K ∗).

Note that N0 is now the conormal derivative with respect to the matrix κA, and so
the constant κ is no longer visible on the right-hand side of the boundary condition.
As in [42], we are interested in the limit as κ → ∞.

To transform this system to a form suitable for application of Theorem 5.5 we

consider K ⋄, the concentration of inactive kinases, deﬁned as

A straightforward calculation shows that K ⋄ satisﬁes:

K ⋄ = 1Ω0 − K ∗.

and

∂K ⋄
∂t

= Lp,κK ⋄ + 1Ω0 ,

t ≥ 0,

−τ K ⋄

|0 = N0(K ⋄),

i.e., an equation of the type Corollary 5.8 is devoted to (with K ⋄ playing the role
of zκ).

Since in this case N = 1, the orthogonal projection onto H0 is just the orthogonal
u dλ. Also, the

projection onto the constant functions given by P u = 1
matrices Q and C are real numbers given by

λ(Ω0) RΩ0

(6.6)

− q := q1,1 = −

1

λ(Ω0) ZΓ0

τ0 dσ

and

c1,1 = 1,

respectively. Thus, Q − C = −(q + 1) and, as a consequence of Corollary 5.8, in the
limit as κ → ∞, K ⋄(t) converges (strongly or in the weak∗ topology, depending on
the choice of p) to k⋄(t)1Ω0 where k⋄ is the solution of

dk⋄
dt

= −(q + 1)k⋄ + 1,

t ≥ 0,

20

ADAM BOBROWSKI, BOGDAN KAZMIERCZAK, AND MARKUS KUNZE

with initial condition k⋄(0) = P (1Ω0 − K ∗
0 is the initial con-
centration of K ∗. Therefore, K ∗(t) converges to k∗(t)1Ω0 where k∗ is the solution
of

0 ) = 1 − P K ∗

0 , where K ∗

dk∗
dt

= q(1 − k∗) − k∗,

t ≥ 0,

k∗(0) = P K ∗
0 .

This indeed generalizes the results from [42] and [16] as in the case where Ω0 is the
3d unit ball and τ0 is the constant function equal to aC, we have by (6.6):

q = aC

unit ball’s surface area

unit ball’s volume

= 3aC.

6.2. Neurotransmitters. In modeling dynamics of synaptic depression, one often
adopts a widely accepted, if simpliﬁed, view that a secretory cell is divided into three
subregions, Ω1, Ω2 and Ω3 corresponding to the so-called immediately available,
small and large pools, where neurotransmitters are located. This is also the case
in the model of Bielecki and Kalita [11], in which a terminal bouton, playing the
role of our Ω0, is modeled as a 3d region (see Figure 1) and the concentration
of (vesicles with) neurotransmitters is described by functions on those subregions.
However, no clear distinction between the subregions is made; in particular, no
transmission conditions on the borders between pools are imposed, and it appears
as if diﬀusing vesicles with neurotransmitter may freely cross from one pool to the
other. For reasons explained in [19], such a model cannot be easily connected with
the older, and apparently better known model of Aristizabal and Glavinoviˇc [6]
where the situation is described by three scalars, evolving with time, i.e. by the
levels Ui, i = 1, 2, 3 of neurotransmitters in the pools Ω1, Ω2 and Ω3 respectively.
Arguably, to draw such a connection, specifying the way the particles may ﬁlter
from one region to the other is necessary, and it transpires that the appropriate
transmission conditions are of the form (3.3) with bk,ℓ ≡ 1. (One should note here,
however, that no physical membranes separating pools exist in the secretory cells,
and the interpretation similar to the Newton’s Law of Cooling seems to be more
suitable, for example the one provided by Fick’s law.)

To see that the connection in question is a particular case of our averaging prin-
ciple, we ﬁx p ≥ 0 and write the governing equation for the neurotransmitter level
u in Lp(Ω0) in the form (compare [11, eq. (1)]):

(6.7)

∂u
∂t

= Lp,κu + βu♯,

t ≥ 0,

where β is a measurable, bounded and non-negative function which vanishes every-
where but on Ω3, and is interpreted as neurotransmitter’s production rate (varying
in Ω3), Lp,κ is the Lp(Ω0) version of the elliptic operator (3.2) with c = β and
diﬀusion matrix κA, and u♯ ∈ Lp(Ω0) is a given function interpreted as a balance
concentration of vesicles.

Clearly this governing equation is of the form considered in Corollary 5.8 with
f (t) = βu♯ independent of t. In this case, the space H0 is composed of functions
that are constant on each of the three pools (separately), and the projection on
this space is a particular case of (5.2) with N = {1, 2, 3}. As explained in Section
5.2, H0 is isometrically isomorphic to C3 with suitable norm. In particular, since
β vanishes on Ω1 and Ω2, the function P βu♯ may be identiﬁed with the vector
e = (0, 0, e3) ∈ C3 where

e3 =

1

λ(Ω3) ZΩ3

βu♯ dλ.

Hence, identifying isomorphic objects, we see that Corollary 5.8 establishes conver-
gence of solutions of (6.7) to a C3-valued function u solving the equation:

u′(t) = (Q − C)u(t) + e.

AN AVERAGING PRINCIPLE FOR FAST DIFFUSIONS

21

In order to ﬁnd a more explicit form of the limit matrix Q we note that, because
of the special arrangement of pools, Ω3 borders only with Ω2, and Ω1 is the only
region having common border with the complement of Ω0. As a result (see (5.3)
and recall that we agreed on bk,ℓ ≡ 1)

Q = 


−q10 − q12

q21
0

q12

−q21 − q23

q32

0
q23
−q32


 ,

qk,ℓ = RΓk,ℓ

λ(Ωk)

τk dσ

.

λ(Ω3) RΩ3

Also, the matrix C has, as diagonal entries, the values of P β on the sets Ω1, Ω2
and Ω3 respectively, and since β vanishes on Ω1 and Ω2, it follows that C acts on
a vector in C3 as coordinate-wise multiplication with the vector (0, 0, c)T, where
c = 1

β dλ.

So, the limit equation is precisely of the form considered by Aristizabal and Glavi-
noviˇc for the levels Ui, i = 1, 2, 3 (which now may be thought of as coordinates of u).
Comparing the entries of the matrix Q − C with the coeﬃcients used by Aristizabal
and Glavinoviˇc, we may interpret the latter in new terms, see the discussion given
in [19] and compare with eq. (7) there. (The apparent discrepancy between our Q
and that given in the cited equation (7) is that the latter involves diﬀusion coeﬃ-
cients. To explain this, we note that transmission conditions in [19] are devised in
a slightly diﬀerent way than here. In particular, in [19] it is not the ﬂux but the
ratio ﬂux/diﬀusion coeﬃcient that is preserved.)

6.3. Intracellular calcium dynamics. The last example concerns calcium dy-
namics in eukaryotic cells. Calcium plays a crucial role in mediating and recognizing
signals from the extracellular space into various parts of the cell, in particular to the
nucleus. On the other hand, an elevated concentration of calcium ions inside the
cytosol is harmful and may induce the cell’s apoptosis. For that reason it is stored
also in intracellular compartments, like endoplasmic reticulum or mitochondria. (A
large amount of calcium is also bound to, so called, buﬀer protein molecules.) The
average concentration of free calcium inside the cytosol does not exceed 1 µM ,
while the average concentration of calcium inside endoplasmic reticulum and mi-
tochondria may be two orders of magnitude bigger [43]. This is possible due to
the action of special pumps, which by using diﬀerent forms of energy can push free
calcium into the regions of higher concentration, e.g. SERCA pumps (reticulum) or
mitochondrial sodium-calcium exchangers (MNCX). In this way, cells can transport
calcium against the diﬀusional ﬂux.

In some circumstances, oscillations of calcium concentration between the internal
stores and cytosol are observed. Such oscillations are usually described by means
of systems of ordinary diﬀerential equations (see e.g., [43, 52, 58]).
In these de-
scriptions, inhomogeneities in the spatial distribution of calcium inside the regions
corresponding to diﬀerent cell compartments are neglected. As we will argue, our
Theorem 5.6 justiﬁes such a simpliﬁed description, provided diﬀusion in the cell is
fast.

To begin with, we assume that the processes of binding and unbinding of calcium
ions by buﬀer molecules, characterized by certain parameters k+ > 0 and k− > 0,
respectively, are very fast. This allows applying the reduction method of Wagner
and Keizer [60], so that equations for buﬀer molecules are neglected. Moreover, for
further simplicity, we assume that the buﬀers are immobile, that is to say their
diﬀusion coeﬃcients are negligible and that they are uniformly distributed in the
space.

Let Ω0 ⊂ R3 model the spatial region occupied by the cell, with the exception
of its nucleus. Let Ω1 ⊂ Ω0 correspond to the region occupied by the endoplasmic
reticulum of the cell, and let Ω2 ⊂ Ω0, disjoint from Ω1, correspond to the mitochon-
dria inside the cell. (Usually, there is a number of mitochondria, but to simplify

22

ADAM BOBROWSKI, BOGDAN KAZMIERCZAK, AND MARKUS KUNZE

the model we combine the regions occupied by them into a single region.) Finally,

let Ω3 := Int(cid:0)Ω0 \S2

The concentration U of free calcium in Ω0 is governed by the following equation

k=1 Ωk(cid:1), correspond to the cytosolic region of the cell.

[60]:

(6.8)

∂U
∂t

= a(x)

1

1 + α(x, U )

△U

where the positive function a ∈ L∞(Ω0) describes the diﬀusivity of the free calcium
ions, i.e. of the ions which are not bound to buﬀer molecules. Since diﬀusivity does
i=1 ai1Ωi for some positive

not change within each region, we assume that a = P3

ai, i = 1, 2, 3.

1

In (6.8), the factor η(x, U ) =

1+α(x,U) where α is a non-negative function, de-
scribing the eﬀect of calcium buﬀering for suﬃciently large binding and unbinding
coeﬃcients k+ and k−, coming into play as a result of the Wagner and Keizer re-
duction method. Let us also note that due to the fact that the buﬀer molecules
are assumed to be immobile, the gradient quadratic term in equation (2.5a) in [60]
vanishes. For simplicity we conﬁne ourselves to the case of one representative kind
of buﬀers in each of the regions Ω1, Ω2 and Ω3. We allow the coeﬃcients k+ and
k− to diﬀer in the subregions of the cell, i.e.
for them to be functions of x. We set
K = k−/k+. Then, α is given by

α(x) = btot(x)K(x)(K(x) + U )−1,

where btot denotes the total concentration of buﬀering molecules. In general, also
btot depends on x . In some situations, however, it may be assumed that α does
not depend on U , and depends on x only via Ωi. Such an approximation can be
justiﬁed in the cytosolic region by the fact that for typical endogeneous buﬀers we
have k+ ≈ 50µM −1s−1, k− ≈ 500s−1, so that K ≈ 10µM , and the maximal value
of U of the order of 1µM . On the other hand, the calcium capacity of reticular and
mitochondrial subregions is very large, so the concentration of calcium U does not
change signiﬁcantly in these compartments in the non-apoptotic state of the cell.
To be able apply the theory developed in this paper, we further simplify the model
and assume that η < 1 is a constant.

We are thus lead to the following, reduced form of equation (6.8):

(6.9)

∂U
∂t

= ηa△U ;

in particular, the diﬀusion matrix A(x) is a 3 × 3 diagonal matrix with all entries
on the diagonal equal ηai in Ωi.

Turning to transmission conditions, we assume – in accordance with biological
reality – that neither the reticulum nor the mitochondria have common points with
the cell’s membrane Γ0, and that they do not communicate each other directly,
either. As a result, calcium may only permeate from the cytosol to reticulum or
mitochondria and back to cytosol, or from the cytosol to the extracellular matrix.
Secondly, we suppose that the functions describing the ﬂows through the separating
membranes are linear. (We note, however, that the process of calcium transmission
through the cell membrane, as well as that through the reticular and mitochondrial
boundaries is rather complicated and these functions are, in general, nonlinear. A
possible form of the functions modulo constant factors can be deduced from [52],
where a three-compartmental non-spatial model of calcium dynamics is proposed.
An extension of the main theorem of our paper to the case of nonlinear transmission
conditions is a very interesting topic for future research.) We thus suppose that the

AN AVERAGING PRINCIPLE FOR FAST DIFFUSIONS

23

transport of calcium through the membranes separating the reticular and mitochon-
drial subregions from the cytosol is governed by the transmission conditions:

τ3u|3 − τ1u|1 = a1

(6.10)

τ3u|3 − τ2u|2 = a2

∂u
∂ν
∂u
∂ν

,

,

τ3u|3 − τ1u|1 = a3

τ3u|3 − τ2u|2 = a3

∂u
∂ν
∂u
∂ν

,

,

on Γ1 = Γ1,3

and

on Γ2 = Γ2,3

respectively, where τ ’s are permeability functions, as in (3.6). Recall that τ ’s in
general depend on x.

Several remarks are here in order. First of all, we note that since (6.9) is to
describe distribution of calcium ions, we use transmission conditions akin to (3.6)
and not (3.3) (see Remark 3.4). Secondly, the ﬁrst of the equations in the ﬁrst line
describes the ﬂux of calcium from the cytosol to the reticulum, while the second
describes the ﬂux of calcium from the reticulum to the cytosol. Thirdly, in the ﬁrst
of these equations, ∂u
∂ν refers to the derivative of u in direction of the outer normal
of Ω1, whereas in the second it refers to the derivative of u in direction of the inner
normal of Ω1. Note that the inner normal of Ω1 is the outer normal of Ω3. The
other two equations are interpreted in the same way.

Additionally, we have the equation

(6.11)

− τ3u|3 = a3

∂u
∂ν

on Γ0 = Γ0,3,

governing the outﬂow of free calcium ions through the outer boundary of the cell
and through the membrane separating the cytosol from the cell’s nucleus. Since the
latter part of Ω0 is impermeable for the ions, we assume that τ3 vanishes there. We
note that condition (6.11) implies that we assume either that the local free calcium
concentration in the extracellular space is zero or the inﬂux of calcium from outside
the cell is blocked.

We stress that transmission conditions (6.10) are not yet of the form (3.6), be-
cause the right-hand sides are not yet the conormal derivatives for the operator ηa△
appearing in (6.9). Biologically, this is a reﬂection of the fact that only free calcium
ions can pass through the separating boundaries – the buﬀer molecules (either free
or with bound calcium ions) cannot do that. Mathematically, to make (6.10) com-
patible with (3.3) we need to multiply all equations by η < 1. This amounts to
introducing new permeability functions, equal to the old ones multiplied by η, and
so the intensity matrix Q of (5.3) becomes:

−

RΓ1

τ1 dσ

λ(Ω1)

0
τ3 dσ

RΓ1

Q = η




−

λ(Ω2)
τ3 dσ

RΓ2

λ(Ω3)

λ(Ω3)

0
RΓ2
τ2 dσ

RΓ1

τ1 dσ

λ(Ω1)

RΓ2

τ2 dσ

P2

λ(Ω2)
i=0 RΓi
λ(Ω3)

τ3 dσ

−

.




This means that in this approximation, buﬀer molecules’ inﬂuence reduces to slow-
ing down the process of communication between reticulum, mitochondria and cy-
tosol. Remarkably, more interesting phenomena are observed even for η dependent
on x merely via Ωi.

To proceed, we must take into account that the natural space for dynamics of
µ but ℓ1. Consequently, according to Remark 5.7, working in the

densities ui is not ℓ1
latter space, we should replace the matrix Q by the matrix ˜Q deﬁned as

−

RΓ1

τ1 dσ

λ(Ω1)

0
τ3 dσ

RΓ1

˜Q = η




−

λ(Ω2)
τ3 dσ

RΓ2

λ(Ω1)

λ(Ω2)

0
RΓ2
τ2 dσ

RΓ1

τ1 dσ

λ(Ω3)

RΓ2

τ2 dσ

P2

λ(Ω3)
i=0 RΓi
λ(Ω3)

τ3 dσ

−

.




24

ADAM BOBROWSKI, BOGDAN KAZMIERCZAK, AND MARKUS KUNZE

Theorem 5.5 (formulated in the ℓ1 space) asserts that if a is replaced by κa or if
(see Remark 5.2) a(κ) is a family of functions indexed by κ such that supκ a(κ)(x) =
∞ for almost all x ∈ Ω0, then as κ → ∞ solutions to (6.12) become more and more
uniform, i.e. ‘ﬂat’, in each of the regions Ω1, Ω2, Ω3. Moreover, if ui(t) denotes the
common value of the limit function at time t in Ωi then for the column vector u(t)
with coordinates ui(t) we have

(6.12)

u′(t) = ˜Q∗u(t).

Suppose that u(t) = P3

The form of the limit system (6.12) agrees with the following heuristic reasoning.
i=1 ui(t)1Ωi is a solution to (6.9) with transmission condi-
tions (6.10) and (6.11) and a replaced by κa. Then, using the Gauss theorem, we
see that

λ(Ω1)u′

ητ3 dσ u3(t),

1(t) = −ZΓ1

ητ1 dσ u1(t) +ZΓ1

and dividing by λ(Ω1) leads to the ﬁrst equation in (6.12). Similarly, we check that
the second and third equations of (6.12) agree with the result of formal integration
based on the Gauss theorem.

7. Discussion

In modeling biological processes one often needs to take into account diﬀerent
time-scales of the processes involved [8, 17]. This is in particular the case when
one of the components of the model is diﬀusion which in certain circumstances may
transpire to be much faster than other processes. For example, in the Alt and Lauf-
fenberger’s [2] model of leucocytes reacting to a bacterial invasion by moving up a
gradient of some chemical attractant produced by the bacteria (see Section 13.4.2
in [44]) a system of three PDEs is reduced to one equation provided bacterial diﬀu-
sion is much smaller than the diﬀusion of leukocytes or of chemoattractants (which
is typically the case). Similarly, in the early carcinogenesis model of Marcinak–
Czochra and Kimmel [16, 49, 50, 51], a system of two ODEs coupled with a single
diﬀusion equation (involving Neumann boundary conditions) is replaced by a so-
called shadow system of integro-diﬀerential equations with ordinary diﬀerentiation,
provided diﬀusion may be assumed fast.

In this context it is worth recalling that one of the fundamental properties of
diﬀusion in a bounded domain is that it ‘averages’ solutions (of the heat equation
with Neumann boundary condition) over the domain. As it transpires, it is this
homogenization eﬀect of diﬀusion, when coupled with other physical or biological
forces that leads to intriguing singular perturbations; this is exempliﬁed by a more
careful analysis of the models mentioned above (see also [16]).

In this paper we describe the situation in which fast diﬀusion in several bounded
domains separated by semi-permeable membranes is accompanied by low perme-
ability of the membranes. Assuming that the ﬂux through the membranes is of
moderate value, we show that such models are well-approximated by those based
on Markov chains. More speciﬁcally, because of the homogenization eﬀect, all points
in each domain of diﬀusion are lumped into a single state, and the non-negligible
ﬂux forces so-formed new states to communicate as the states of a Markov chain
(eq. (5.3) provides the entries in its intensity matrix).

Certainly, applicability of the theorem depends in a crucial way on whether and
to what extend diﬀusion involved in the model is faster than other processes. Never-
theless, the literature of the subject provides numerous examples of such situations.
Two of them: the model of intracellular dynamics and that of neurotransmitters
are discussed in detail above. Our third example is of slightly diﬀerent type:
its
main purpose is to show that diﬀusion of kinases in a cell cannot be too fast for
signaling pathways to work properly.

AN AVERAGING PRINCIPLE FOR FAST DIFFUSIONS

25

From the mathematical viewpoint, the established principle is a close relative of
the famous Freidlin-Wentzell averaging principle ([36, 38], see also [37]), but it diﬀers
from its more noble cousin in the crucial role played by transmission conditions,
which are of marginal or no importance in the latter. These conditions, sometimes
referred to as radiation boundary conditions, describe in probabilistic and analytic
terms the way particles permeate through the membranes, and thus, indirectly, the
ﬂux, which inﬂuences the model in a critical way (see eq. (5.3) again).

References

[1] M. S. Agranovich, Sobolev Spaces, Their Generalizations and Elliptic problems in Smooth
and Lipschitz Domains, Springer Monographs in Mathematics, Springer, Cham, 2015. Revised
translation of the 2013 Russian original.

[2] W. Alt and D. A. Lauffenburger, Transient behavior of a chemotaxis system modelling

certain types of tissue inﬂammation, J. Math. Biol, 24 (1987), pp. 691–722.

[3] S. S. Andrews, Accurate particle-based simulation of adsorption, desorption and partial

transmission, Phys. Biol., (2010), p. 046015.

[4] W. Arendt, Approximation of degenerate semigroups, Taiwanese J. Math., 5 (2001), pp. 279–

295.

[5] W. Arendt, C. J. K. Batty, M. Hieber, and F. Neubrander, Vector-valued Laplace
transforms and Cauchy problems, vol. 96 of Monographs in Mathematics, Birkh¨auser/Springer
Basel AG, Basel, second ed., 2011.

[6] F. Aristizabal and M. I. Glavinovic, Simulation and parameter estimation of dynamics

of synaptic depression, Biol. Cybern., 90 (2004), pp. 3–18.

[7] J. Banasiak, A. Falkiewicz, and P. Namayanja, Asymptotic state lumping in transport
and diﬀusion problems on networks with applications to population problems, Mathematical
Models and Methods in Applied Sciences, 26 (2016), pp. 215–247.

[8] J. Banasiak and M. Lachowicz, Methods of Small Parameter in Mathematical Biology,

Modeling and Simulation in Science, Engineering and Technology, Birkh¨auser, 2014.

[9] C. Bardos, D. Grebenkov, and A. Rozanova-Pierrat, Short-time heat diﬀusion in com-
pact domains with discontinuous transmission boundary conditions, Mathematical Models
and Methods in Applied Sciences, 26 (2016), pp. 59–110.

[10] C. J. K. Batty and A. F. M. ter Elst, On series of sectorial forms, J. Evol. Equ., 14

(2014), pp. 29–47.

[11] A. Bielecki and P. Kalita, Model of neurotransmitter fast transport in axon terminal of

presynaptic neuron, J. Math. Biol, 56 (2008), pp. 559–576.

[12] A. Bobrowski, Degenerate convergence of semigroups, Semigroup Forum, 49 (1994), pp. 303–

327.

[13]

[14]

[15]

[16]

[17]

[18]

, Functional Analysis for Probability and Stochastic Processes.An introduction, Cam-

bridge University Press, Cambridge, 2005.

, From diﬀusions on graphs to Markov chains via asymptotic state lumping, Ann. Henri

Poincare, 13 (2012), pp. 1501–1510.

, Families of operators describing diﬀusion through permeable membranes, in Operator
Semigroups Meet Complex Analysis, Harmonic Analysis and Mathematical Physics, Arendt,
W., Chill, R., Tomilov, Y., eds., vol. 250 of Operator Theory, Advances and Applications,
Birkh¨auser, 2015, pp. 87–105.

, Singular perturbations involving fast diﬀusion, J. Math. Anal. Appl., 427 (2015),

pp. 1004–1026.

, Convergence of One-Parameter Operator Semigroups. In Models of Mathematical

Biology and Elsewhere, Cambridge University Press, Cambridge, 2016.

, Emergence of Freidlin–Wentzell’s transmission conditions as a result of a singular

perturbation of a semigroup, Semigroup Forum, 92 (2016), pp. 1–22.

[19] A. Bobrowski and K. Morawska, From a PDE model to an ODE model of dynamics of

synaptic depression, Discr. Cont. Dyn. Syst. B, 17 (2012), pp. 2313–2327.

[20] G. C. Brown and B. N. Kholodenko, Spatial gradients of cellular phospho-proteins, FEBS

Letters, 457 (1999), pp. 452–454.

[21] J. Crank, The mathematics of diﬀusion, Clarendon Press, Oxford, second ed., 1975.
[22] E. Crooks, B. Ka´zmierczak, and T. Lipniacki, A spatially extended model of kinase-

receptor interaction, SIAM J. Appl. Math., 73 (2013), pp. 374–400.

[23] G. Da Prato and E. Sinestrari, Diﬀerential operators with nondense domain, Ann. Scuola

Norm. Sup. Pisa Cl. Sci. (4), 14 (1987), pp. 285–344.

[24] D. Daners, Principal eigenvalues for generalised indeﬁnite Robin problems, Potential Anal.,

38 (2013), pp. 1047–1069.

26

ADAM BOBROWSKI, BOGDAN KAZMIERCZAK, AND MARKUS KUNZE

[25] R. Dautray and J.-L. Lions, Mathematical Analysis and Numerical Methods for Science
and Technology. Vol. 2, Springer-Verlag, Berlin, 1988. Functional and variational methods,
With the collaboration of Michel Artola, Marc Authier, Philippe B´enilan, Michel Cessenat,
Jean Michel Combes, H´el`ene Lanchon, Bertrand Mercier, Claude Wild and Claude Zuily,
Translated from the French by Ian N. Sneddon.

[26]

, Mathematical Analysis and Numerical Methods for Science and Technology. Vol. 1,
Springer-Verlag, Berlin, 1990. Physical origins and classical methods, With the collaboration
of Philippe B´enilan, Michel Cessenat, Andr´e Gervat, Alain Kavenoky and H´el`ene Lanchon,
Translated from the French by Ian N. Sneddon, With a preface by Jean Teillac.

[27]

, Mathematical Analysis and Numerical Methods for Science and Technology. Vol. 3,
Springer-Verlag, Berlin, 1990. Spectral theory and applications, With the collaboration of
Michel Artola and Michel Cessenat, Translated from the French by John C. Amson.

[28] K.-J. Engel and R. Nagel, One-parameter semigroups for linear evolution equations,
vol. 194 of Graduate Texts in Mathematics, Springer-Verlag, New York, 2000. With contribu-
tions by S. Brendle, M. Campiti, T. Hahn, G. Metafune, G. Nickel, D. Pallara, C. Perazzoli,
A. Rhandi, S. Romanelli and R. Schnaubelt.

[29] S. N. Ethier and T. G. Kurtz, Markov Processes. Characterization and Convergence, Wiley,

New York, 1986.

[30] W. Feller, Diﬀusion processes in genetics, in Proceedings of the Second Berkeley Symposium
on Mathematical Statistics and Probability, 1950, Berkeley and Los Angeles, 1951, University
of California Press, pp. 227–246.

[31]
[32]

[33]

519.

, Two singular diﬀusion problems, Ann. Math., 54 (1951), pp. 173–182.
, Diﬀusion processes in one dimension, Trans. Amer. Math. Soc., 77 (1952), pp. 468–

, The parabolic diﬀerential equations and the associated semi-groups of transformations,

Ann. Math., 55 (1952), pp. 468–519.

[34] E. Fieremans, D. S. Novikov, J. H. Jensen, and J. A. Helpern, Monte Carlo study of a

two-compartment exchange model of diﬀusion, NMR in Biomedicine, (2010), pp. 711–724.

[35] G. B. Folland, Real analysis, Pure and Applied Mathematics (New York), John Wiley &
Sons, Inc., New York, second ed., 1999. Modern techniques and their applications, A Wiley-
Interscience Publication.

[36] M. I. Freidlin and A. D. Wentzell, Diﬀusion processes on graphs and the averaging prin-

ciple, Ann. Math., 21 (1993), pp. 2215–2245.

[37]

[38]

, Diﬀusion processes on an open book and the averaging principle, Stochastic Processes

and their Applications, 113 (2004), pp. 101–126.

, Random Perturbations of Dynamical Systems, vol. 260 of Grundlehren der Mathema-
tischen Wissenschaften [Fundamental Principles of Mathematical Sciences], Springer, Heidel-
berg, third ed., 2012. Translated from the 1979 Russian original by Joseph Sz¨ucs.

[39] D. Gilbarg and N. S. Trudinger, Elliptic partial diﬀerential equations of second order,

Classics in Mathematics, Springer-Verlag, Berlin, 2001. Reprint of the 1998 edition.

[40] A. Gregosiewicz, Asymptotic behaviour of diﬀusions on graphs, in Probability in Action,

Banek, T., Kozlowski, E., eds., Lublin University of Technology, 2014, pp. 83–96.

[41] T. Kato, Perturbation theory for linear operators, Classics in Mathematics, Springer-Verlag,

Berlin, 1995. Reprint of the 1980 edition.

[42] B. Ka´zmierczak and T. Lipniacki, Regulation of kinase activity by diﬀusion and feedback,

J. Theor. Biol., 259 (2009), pp. 291–296.

[43] J. Keener and J. Sneyd, Mathematical Physiology, vol. 8 of Interdisciplinary Applied Math-

ematics, Springer, New York, second ed., 2009.

[44]

, Mathematical Physiology. Vol. II: Systems Physiology, vol. 8 of Interdisciplinary Ap-

plied Mathematics, Springer, New York, second ed., 2009.

[45] T. G. Kurtz, A limit theorem for perturbed operator semigroups with applications to random

evolutions, J. Functional Analysis, 12 (1973), pp. 55–67.

[46]

, Applications of an abstract perturbation theorem to ordinary diﬀerential equations,

Houston J. Math., 3 (1977), pp. 67–82.

[47] A. Lejay, The snapping out Brownian motion. hal–00781447, Dec. 2013.
[48] H. P. Lotz, Uniform convergence of operators on L∞ and similar spaces, Math. Z., 190

(1985), pp. 207–220.

[49] A. Marciniak-Czochra, S. Harting, G. Karch, and K. Suzuki, Dynamical spike solutions

in a nonlocal model of pattern formation. arXiv:1307.6236, 2013.

[50] A. Marciniak-Czochra and M. Kimmel, Modelling of early lung cancer progression: inﬂu-
ence of growth factor production and cooperation between partially transformed cells, Math.
Mod. Meth. Appl. Sci., 17 (2007), pp. 1693–1719.

[51]

, Reaction-diﬀusion model of early carcinogenesis: the eﬀects of inﬂux of mutated cells,

Math. Model. Nat. Phenom., 3 (2008), pp. 90–114.

AN AVERAGING PRINCIPLE FOR FAST DIFFUSIONS

27

[52] M. Marhl, T. Haberichter, M. Brumen, and R. Heinrich, Complex calcium oscillations

and the role of mitochondria and cytosolic proteins, Biosystems, 57 (2000), pp. 75–86.

[53] J. Neˇcas, Direct methods in the theory of elliptic equations, Springer Monographs in Mathe-
matics, Springer, Heidelberg, 2012. Translated from the 1967 French original by Gerard Tronel
and Alois Kufner, Editorial coordination and preface by ˇS´arka Neˇcasov´a and a contribution
by Christian G. Simader.

[54] E. M. Ouhabaz, Second order elliptic operators with essential spectrum [0, ∞) on Lp, Comm.

Partial Diﬀerential Equations, 20 (1995), pp. 763–773.

[55]

, Analysis of heat equations on domains, vol. 31 of London Mathematical Society Mono-

graphs Series, Princeton University Press, Princeton, NJ, 2005.

[56] J. G. Powles, M. J. D. Mallett, G. Rickayzen, and W. A. B. Evans, Exact analytic
solutions for diﬀusion impeded by an inﬁnite array of partially permeable barriers, Proc. Roy.
Soc. London Ser. A, 436 (1992), pp. 391–403.

[57] B. Simon, A canonical decomposition for quadratic forms with applications to monotone

convergence theorems, J. Funct. Anal., 28 (1978), pp. 377–385.

[58] P. Szopa, M. Dyzma, and B. Ka´zmierczak, Membrane associated complexes in calcium

dynamics modelling, Physical Biology, 10(3) (2013), pp. 35004–35016.

[59] J. E. Tanner, Transient diﬀusion in a system partitioned by permeable barriers. Application
to NMR measurements with a pulsed ﬁeld gradient, The Journal of Chemical Physics, 69
(1978), pp. 1748–1754.

[60] J.-C. Tsai and J. Sneyd, Traveling waves in the buﬀered FitzHugh-Nagumo model, SIAM J.

Appl. Math., 71 (2011), pp. 1606–1636.

[61] A. D. Wentzell, On lateral conditions for multidimensional diﬀusion processes, Teor. Veroy-
atnost. i Primenen., 4 (1959), pp. 172–185. English translation: Theory Prob. and its Appl.
4, 164-177 (1959).

E-mail address: a.bobrowski@pollub.pl

Lublin University of Technology, Nadbystrzycka 38A, 20-618 Lublin, Poland

E-mail address: bkazmier@ippt.pan.pl

Institute of Fundamental Technological Research, PAS, Pawinskiego 5B, 02-106 War-

saw, Poland

E-mail address: markus.kunze@uni-konstanz.de

Universit¨at Konstanz, Fachbereich Mathematik und Statistik, 78467 Konstanz, Ger-

many

