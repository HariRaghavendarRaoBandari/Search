6
1
0
2

 
r
a

 

M
2
1

 
 
]

.

C
S
o
i
b
-
q
[
 
 

1
v
5
0
6
5
0

.

3
0
6
1
:
v
i
X
r
a

Multiscale modeling of diﬀusion in a crowded

environment
Lina Meinecke∗

Department of Information Technology, Uppsala University

March 18, 2016

Abstract

We present a multiscale approach to model diﬀusion in a crowded
environment and its eﬀect on the reaction rates. Diﬀusion in biological
systems is often modeled by a discrete space jump process in order to
capture the inherent noise of biological systems, which becomes impor-
tant in the low copy number regime. To model diﬀusion in the crowded
cell environment eﬃciently, we compute the jump rates in this mesoscopic
model from local ﬁrst exit times, which account for the microscopic posi-
tions of the crowding molecules, while the diﬀusing molecules jump on a
coarser Cartesian grid. We then extract a macroscopic description from
the resulting jump rates, where the excluded volume eﬀect is modeled
by a diﬀusion equation with space dependent diﬀusion coeﬃcient. The
crowding molecules can be of arbitrary shape and size and numerical ex-
periments demonstrate that those factors together with the size of the
diﬀusing molecule play a crucial role on the magnitude of the decrease
in diﬀusive motion. When correcting the reaction rates for the altered
diﬀusion we can show that molecular crowding either enhances or inhibits
chemical reactions depending on local ﬂuctuations of the obstacle density.

1

Introduction

Living cells are spatially organized, e.g. eukaryotic cells have a conﬁned nucleus
containing the DNA and reaction complexes are often bound to the cell mem-
brane. To simulate reaction networks accurately it therefore is important to
incorporate the molecules’ movement into the models and account for the time
it takes for a signal to transmit e.g. from the nucleus to the membrane.

Molecules move by diﬀusion through biological media such as the cytoplasm,
which is a non-solute medium, where an estimated 40% [48, 68] of the available
space is occupied by macromolecules, such as proteins, ribosomes, RNA and

∗lina.meinecke@it.uu.se

1

the cytoskeleton. The environment is called crowded, meaning that the space is
densely packed by molecules but individual species are only present at very low
concentrations. Macromolecular crowding is especially important on the cell
membrane [28], where attaching actin ﬁlaments [53] create barriers, that hinder
the displacement of membrane bound molecules [42, 44]. In mitochondria more
than 60% of the matrix can be occupied by enzymes and proteins [76] and also
the extracellular space between e.g. brain cells [39] is considered crowded.

The steric repulsions between molecules in a crowded environment force dif-
fusing molecules to move around obstacles, or ”crowders”, this slows down diﬀu-
sion. New techniques such as ﬂuorescence-ﬂuctuation analysis [11] have shown
that diﬀusion is not simply slowed down but that crowding can lead to anoma-
lous diﬀusion, where the mean square displacement (MSD) of the molecule is
no longer linear, but sublinear in time. As the crowder density increases, space
is divided into subdomains and becomes inhomogeneous. For this fractal space,
the dimension decreases to a non integer and the MSD no longer follows the
linear law applicable in integer dimensions [4, 35].

The change of the diﬀusion rate in a crowded environment is a hydrodynamic
eﬀect. The excluded volume eﬀect on the reaction rates is a thermodynamic con-
sequence [32] and can be both impeding and promoting. While diﬀusion limited
reaction rates are decreased due to the slower diﬀusion, transition state limited
reactions and dimerizations are accelerated [17] since intermediate products re-
side longer in the vicinity of reaction complexes and dimers occupy less volume
than two monomers. Hindered diﬀusion also leads to localized reactions and a
heterogeneous distribution of products, which increases intrinsic noise [33].

Scaled particle theory (SPT) has been used to describe the thermodynamic
eﬀect on the reaction rates in a crowded envrionment [29, 32, 66]. Another
approach is to perform Brownian dynamics (BD) simulations and ﬁt the reac-
tion rates to the microscopic results, [46, 71]. In [5], Michaelis-Menten reaction
dynamics are best ﬁtted by fractal kinetics and the results are veriﬁed by mi-
croscopic cellular automata (CA) simulations. The fractal kinetics are modiﬁed
in [68] to a Zipf-Mandelbrot distribution of the reaction rates.

To better understand the eﬀects of excluded volume on both diﬀusion and re-
actions, accurate reaction-diﬀusion simulations in the crowded cell environment
are needed. The microscopic approaches mentioned above are computationally
very expensive due to the high number of collisions in such a medium. In this
paper we present a novel multiscale approach to simulate diﬀusion of a spherical
particle surrounded by inert and inactive crowders of any size and shape. We
resolve the microscopic positions and shapes of the crowders initially to pre-
compute jump rates for the moving molecules. The molecule follows a random
walk on a coarse Cartesian grid that no longer resolves the multiple crowders for
computationally more eﬃcient simulations. With our approach we can connect
a given distribution of obstacles to a space dependent diﬀusion map which can
be used to recompute space dependent reaction rates representing reactions in
the crowded environment. The method can easily be extended to moving crow-
ders and an advantage over other techniques such as SPT is the versatility in
the shape of the crowders. The upscaling to a coarse grid makes the stochastic

2

simulations computationally much more eﬃcient than BD and CA simulations.
In the next section we present existing models of spatial simulations in sys-
tems biology and how they incorporate crowding eﬀects. We then present how
the microscopic motion of a molecule can be used to calculate its ﬁrst exit time
(FET) from domains, which provides the jump rates in a coarse grained dis-
crete jump process on the mesoscopic level. We continue by extending the FET
approach to include macromolecular crowders. In Section 4, we use the jump
coeﬃcients and compute a space dependent diﬀusion map for the macroscopic
level and show in Section 5 how that aﬀects the reaction rates in the crowded
environment. We conclude with numerical experiments in the ﬁnal section.

Vectors and matrices are written in boldface. A vector u has the components
ui and the elements of a matrix A are Aij. The derivative of a variable u with
respect to time t is written ut.

2 Spatial modeling in systems biology

In this section we ﬁrst present existing models of diﬀusion simulations in systems
biology and then describe how they can be adapted to include macromolecular
crowding.

2.1 Models of diﬀusion in dilute media

Molecules undergoing diﬀusion and reactions inside living cells are often modeled
by the reaction-diﬀusion equations. These are continuous, deterministic partial
diﬀerential equations (PDEs) describing the time evolution of the concentrations
of molecules. For a diﬀusing molecule the concentration u(x, t) is described by
the diﬀusion equation

ut(x, t) = γ0∆u(x, t), x ∈ Ω

(2.1)

with diﬀusion coeﬃcient γ0 and suitable boundary conditions on ∂Ω. To include
reactions corresponding terms are added. This macroscopic description is
accurate in the limit of large molecule numbers, when stochastic ﬂuctuations
are small and the mean value is the quantity of interest. Important molecules
such as DNA or transcription factors are, however, only present at very low
copy numbers inside living cells. It has been observed in experiments [18, 51,
56, 58, 64, 72] and shown theoretically [24, 52] that stochastic ﬂuctuations play
an important role and a discrete stochastic description is more accurate than
the deterministic equations.

We distinguish two levels of accuracy of stochastic models. In the meso-
scopic model the domain Ω is partitioned into N non-overlapping voxels Vi
with nodes xi at the center. The state vector y(t) contains the number of
molecules yi(t) in each voxel Vi at time t. The voxels are small enough that
the molecules can be considered well mixed inside so that reactions can occur
between molecules residing in the same voxel. An individual molecule can jump
from a voxel Vi to a neighboring voxel Vj to model diﬀusion. The diﬀusion

3

master equation (DME) describes the time evolution of the probability to be in
state y of a system with only diﬀusion

∂p(y, t)

=

N(cid:88)

N(cid:88)

i=1

j=1

∂t

λij(y − µij)p(y − µij, t) − λii(y)p(y, t),

where λij is the jump propensity from Vi to Vj and λii = (cid:80)N

j=1 λij is the
total propensity to leave voxel Vi. The transition vector µij is zero except for
µij,i = −1 and µij,j = 1. Let θij be the splitting probability, that a jump from
Vi goes to Vj, then
(2.3)

λij = θijλii.

(2.2)

By including reaction terms in a similar manner, the DME can be extended to
the reaction-diﬀusion master equation (RDME). In the presence of bimolecular
reactions there exists no analytical solution and a numerical solution is impos-
sible due to the high dimension of y. Instead, one samples trajectories of the
system with the stochastic simulation algorithm (SSA), ﬁrst presented by Gille-
spie [26] for only reactions and improved in [8, 25]. The algorithm was extended
to space dependent problems with a Cartesian partioning of the domain in [15]
implemented in [34]. The propensities λii are here used to generate random
numbers for the time until the next jump. To represent the complicated geome-
tries present in cells the algorithm was extended to curved boundaries in [40]
and adapted for unstructured meshes in [19] with software in [14, 38].

In the more accurate microscopic model the molecules are tracked along
their Brownian trajectories in a continuous space, continuous time Markov pro-
cess. One approach is called Green’s function reaction dynamics (GFRD), meth-
ods and software for this approach are found in [1, 12, 43, 77] with a review
in [69].
In [13, 61, 73] protective domains are constructed around individual
molecules in which they cannot interact with other molecules. The exit times
and exit positions from these domains are sampled to propagate the system un-
til molecules are close enough to interact without sampling all the intermediate
jumps.

2.2

Include macromolecular crowding

The macroscopic, mesoscopic and microscopic models presented above are de-
signed to simulate diﬀusion in a dilute medium. The microscopic model incor-
porates crowding eﬀects automatically since the molecules are modeled as hard
spheres with a given volume, but it becomes computationally very expensive
in a densely packed space of inactive crowders, because the protective domains
around molecules will be small and many short jumps will be simulated before
meeting a potential reaction partner.

Cellular automata (CA) have been used in [5, 9, 68, 74] to simulate diﬀusion
in a crowded environment. This is a lattice, or voxel, based microscopic ap-
proach, where each site can hold one molecule and crowders are represented as
already occupied lattice points. The jump length is here the size of a molecule

4

which also leads to expensive simulations with many short jumps and the shape
of the molecules corresponds to the shape of the chosen lattice. The choice of
the lattice, moreover, inﬂuences the excluded volume eﬀect [30]. A Cartesian
grid leads to a stronger crowding eﬀect than a hexagonal mesh in 2D and both
overestimate the eﬀect of crowding on the reaction rates compared to a BD
approach.

In [67] a mesoscopic approach is used where each voxel can hold more than
one molecule. After distributing immobile crowders it is decided which voxels
are accessible and which are full. The crowders can move in [21, 75] and the jump
propensity to an adjacent node is scaled by the number of available spaces in the
target voxel. Macroscopic nonlinear PDEs are then derived in [21] to model dif-
fusion in the crowded cell envrionment and the results are validated by physical
experiments in [20]. This approach is extended in [62] to derive nonlinear dif-
fusion equations modeling more complicated interactions than steric repulsion
between the molecules. Similarily, the averaged occupied volume in the whole
domain is used in [45] to rescale the jump propensities. These approaches at
most take the averaged occupied volume in the target voxel into account and ne-
glect the microscopic positions, the shape of the molecules and the surrounding
medium. Hence only an averaged behavior is observed and the MSD is linear
like for normal diﬀusion but with a reduced diﬀusion constant:

(cid:104)x2(t)(cid:105) = (1 − φ)γ0t,

(2.4)

where φ is the occupied volume fraction.

In this paper we present a novel multiscale approach to simulate molecular
crowding. We will use the microscopic information of the crowders’ positions
to recalculate the jump propensities on an overlying mesoscopic mesh. Instead
of simulating diﬀusion in the detailed environment, as in BD, we will have to
solve many PDEs on small subdomains resolving the microscopic positions of
the crowders. This is similar to homogenization techniques used e.g.
for ﬂow
simulations in porous media, [7, 49]. The crowding molecules can have any
shape and this approach is especially useful when the crowded environment is
stationary or evolves on a much slower time scale than the diﬀusing molecule,
so that the jump coeﬃcients can be precomputed and used for a long simulation
time. This is reasonable since the macromolecules responsible for the majority
of occupied volume are ribosomes, microtubules and actin ﬁlaments [17], which
are large and hence diﬀuse on a slower time scale than for example transcription
factors. Moreover, it was shown in [11] that anomalous behavior is most likely
to happen in a stationary environment, since otherwise averaging eﬀects simply
reduce the coeﬃcient of normal diﬀusion. But, it is important to mention that by
computing statistics our method can be made eﬃcient also for moving crowders.

3 Microscopic to mesoscopic: ﬁrst exit times

In this section we will use the methods developed for microscopic simulations of
Brownian motion with protective domains [61], to derive the jump propensities

5

λii and splitting probabilities θij for the mesoscopic model. For simplicity the
illustrations are given in dimension d = 2 but the method can be extended to
3D without modiﬁcation.

3.1 First exit times

Let c(x, t) be the probability distribution that a molecule in Brownian motion
is at x at time t and has not yet exited a domain ω. If x0 is the starting position
of the molecule diﬀusing with γ0, then c(x, t) fulﬁlls

ct(x, t) = γ0∆c(x, t),
c(x, t) = 0,
c(x, 0) = δx0.

x ∈ ω,
x ∈ ∂ω,

(3.1)

The homogeneous Dirichlet boundary condition here models that the particle
is removed once it hits the boundary. The survival probability of the particle
inside ω until time t is then

S(t) =

ω

c(x, t)dω.

(3.2)

(cid:90)

(cid:90)

∂ω

(cid:90) ∞

By Gauss’ formula the probability density pω(t) that the particle leaves ω at t
is

pω(t) = −

= −γ0

n · ∇c(x, t)ds,

(3.3)

where n is the outward normal. The expected time E for the molecule to leave
ω for the ﬁrst time is given by

∂S(t)

∂t

(cid:90) ∞

E =

tpω(t)dt =

S(t)dt.

(3.4)

0

0

We now use this FET approach to compute the jump propensities λii in the
space discrete mesoscopic model. We use a Cartesian grid with space discretiza-
tion h and N nodes xi in the domain Ω. The voxels Vi are here deﬁned by the
dual mesh, see Fig. 3.1(b). Since the molecules are considered well mixed inside
the voxels, the domain ω that diﬀusing particles have to leave to be well mixed
in the next voxel has to include the centers of the neighboring voxels. On a
Cartesian grid we showed in [47] that solving (3.1) on the circle ωi with center
xi and radius h (similarly a line of length 2h in 1D or a sphere with radius
h in 3D) and choosing x0 = xi gives the correct exit time from node i, see

Fig. 3.1(b). Observe that ωi (cid:41) Vi and ωi ∩ ωj (cid:54)= ∅ for neighboring nodes i and
j. Using (3.2) and (3.4) the expected exit time Ei from Vi is

Ei =

,

(3.5)

h2
2dγ0

see [23]. Since the jump propensity is the inverse of the exit time this agrees
with the mesoscopic rate on Cartesian grids

λii =

2dγ0
h2 = E−1

i

.

6

(3.6)

The probability to leave ωi through a given part of the boundary ∂ωij at time
t is given by the proportion of ﬂuxes

θij(t) =

∂ωij

∂ωi

n · ∇c(x, t)ds
n · ∇c(x, t)ds

,

(3.7)

and we can compute the expected probability to jump to a certain neighboring
voxel by

(cid:82)
(cid:82)

(cid:90) t

(cid:90)

(cid:90) ∞

0

θij =

θij(t)pωi(t)dt = −γ0

n · ∇c(x, t)dsdt.

(3.8)

0

∂ωij

Choosing ∂ωij to be the quarter segment of the boundary closest to xj, see the
blue line in Fig. 3.1(b), yields the splitting probability θij = 0.25 as expected
on a Cartesian grid. The method has been extended to a rectangular grid and
possible jumps to the diagonal neighbors in [55].

By conditioning on the ﬁrst step, these time dependent equations can be
converted to equations describing directly the expected quantities [65]. The
expected exit time for a molecule starting to diﬀuse in x from the domain ωi
fulﬁlls the Poisson’s equation

γ0∆E(x) = −1,
E(x) = 0,

x ∈ ωi,
x ∈ ∂ωi.

(3.9)

Equivalently, the expected splitting probability for this molecule to exit through
the boundary ∂ωij can be computed by the harmonic measure [60, Ch. 7], and
fulﬁlls the Laplace equation

∆θij(x) = 0,
θij(x) = 1,
θij(x) = 0,

x ∈ ω,
x ∈ ∂ωij,
x ∈ ∂ωi \ ∂ωij.

(3.10)

We solve equations (3.9) and (3.10) and evaluate them at xi instead of solving
the time-dependent equations and the integrals above. It is suﬃcient to solve

(3.10) three times for each node since(cid:80)4

j=1 θij = 1.

In the following, we will not simply use the circle ωi to compute the meso-
scopic rates, but we will prohibit the molecule from diﬀusing where the crowders
are located.

3.2

Include crowding molecules

The crowding molecules are represented as obstacles or holes in the domain ωi
with reﬂecting boundary conditions. Equations (3.1),(3.9) and (3.10) describe
the diﬀusion of point particles. To account for the volume of the diﬀusing
molecule its radius is added to the excluded volume for the center of mass, see
Fig 3.1(a). We depict the crowders as circles with radius R, but it is important

7

to mention that any shape is possible for the crowding molecules. The shape of
the small (as compared to crowders) diﬀusing molecule is, however, restricted
to circles or spheres with radius r.

(a)

(b)

(c)

Fig. 3.1: (a)Excluded volume (grey and red) for the center of mass of the dif-
fusing molecule (blue). (b) Cartesian mesh and protective domain ωi without
crowding. (c) Solution to (3.9) under molecular crowding.

Solving (3.9) and (3.10) numerically on the perforated domain ωi means that
the crowding molecules have to be resolved by a ﬁne mesh. But, we have divided
the global problem into N local subproblems (one protective domain ωi around
each node i), which is only solved once and can be parallelized. This is similar
to the approach in [7] where deterministic local equations are solved on media
with porous microstructures. The stochastic simulation of the spatial SSA is
then performed on the coarse mesh with N nodes no longer resolving the indi-
vidual obstacles. The boundary conditions on the global domain Ω (reﬂective
or absorbing) are implemented by posing these conditions on the secants of the
half or quarter circles, which are the protective domains for boundary nodes, see
Fig. 3.2(a). In Fig. 3.2(b) we brieﬂy illustrate how the ﬁrst exit time approach
can be further used to compute the jump rates for a Cartesian grid, discretizing
a domain Ω with a curved boundary. Here the part of ∂ωi originating from the
circle is imposed with the boundary conditions in (3.9) and (3.10) and the part
originating from ∂Ω with the boundary condition valid on Ω, which usually are
reﬂecting or (partially) absorbing. The circle is then divided in the same way as
before to compute the splitting probabilities to the neighboring nodes remaining
inside Ω.

The simultaneous interpretation of the moving molecules being well-mixed
inside the voxels Vi and jumping from node xi to xj leads to problems when
including crowders. Consider the case where just the center xi is blocked, but
voxel Vi is suﬃciently empty to be traversed, see Fig. 3.2(c). In this case the
jump into voxel Vi, is possible (λji > 0), but the expected time to leave Vi
is inﬁnity and hence the molecules get trapped inside Vi. This does not agree
with the microscopic situation, where molecules diﬀuse around xi. To avoid

8

Crowder	  r r R Excluded volume nh!i@!ijViVjxixj@Vijunrealistic trapping, all jump propensities λji to voxels whose vertex is isolated
are set to zero. Equations (3.9) and (3.10) cannot be evaluated in xi if the
node is covered by the excluded volume and setting all λji to zero would over
estimate the crowding eﬀect considerably so we distribute the crowders such
that xi remains inside ωi.

(a)

(b)

(c)

Fig. 3.2: (a) Boundary treatment.
(b) Using the ﬁrst exit time to compute
Cartesian jump rates for a curved domain Ω. (c) Model error when interpreting
molecules as well mixed and jumping between nodes.

By using the expected exit time from ωi around xi to calculate the jump
coeﬃcients in a crowded environment it is the crowder distribution inside the
whole circle ωi that aﬀects the coeﬃcients λii and θij. This diﬀers from other
approaches to simulate diﬀusion in a crowded environment with a discrete space
jump process. In [45, 67, 75] it is only the percentage of occupied volume in
the target voxel Vj and in [31] the diﬀerence in occupancy between Vj and the
origin Vi that aﬀect the jump rate λij = θijλii. In our approach the microscopic
positions of all crowding molecules inside ωi are resolved and inﬂuence the jump
coeﬃcients. In the case of non-spherical crowding molecules also the orientation
is taken into account and long thin molecules with small volume can have a
signiﬁcant eﬀect on λij and θij, see Fig. 3.3. Note that in contrast to normal
diﬀusion the jump propensities are no longer symmetric, i.e. in general λij (cid:54)= λji
and λij (cid:54)= λim for j (cid:54)= m.

9

⌦x0x1x2x3!2!0⌦	  	  !ixjxi@!ji!j(a)

(b)

Fig. 3.3: The eﬀect of the microscopic position and orientation of the crowding
molecules. (a) θij = 0. (b) θij > 0.25.

3.3 Statistics on the mesoscopic level

Solving N local problems where complicated geometries have to be resolved, see
Fig. 3.1(c) is computationally expensive and will be ineﬃcient if the crowding
molecules move and the coeﬃcients λii and θij have to be recomputed often.
Since the crowders’ exact location is generally unknown we can compute statis-
tics on a reference domain ωi for given a percentage of occupied volume, a given
shape and size of the molecules and h. Instead of solving N PDEs of type (3.9)
and 3N of type (3.10) at each time step, we can then sample the coeﬃcients λii
and θij from these precomputed distributions. This will be especially applicable
for moving crowders, where new coeﬃcients can be drawn from the distributions
on the time scale of their diﬀusion.

4 Mesoscopic to macroscopic: a space depen-

dent diﬀusion map

In this section we derive a macroscopic diﬀusion equation with a space depen-
dent diﬀusion coeﬃcient γ(x), representing the eﬀect of macromolecular crowd-
ing. We approximate the mesosocpic jump process by Fickian diﬀusion with a
constant diﬀusion coeﬃcient γi inside each voxel Vi. The mesoscopic expected
exit time Ei from a node xi or voxel Vi is connected via (3.5) to this diﬀusion
coeﬃcient γi. So we obtain a modﬁed version of the macroscopic deterministic
diﬀusion equation (2.1)

where

ut(x, t) = ∇ · (γ(x)∇u(x, t)), x ∈ Ω,

γ(x)|Vi = γi =

h2
2dEi

.

(4.1)

(4.2)

For transferring the mesoscopic jump rate to the less detailed macroscopic level
we only use λii and the random walk becomes symmetric in each voxel, i.e.

10

!ixixj@!ij!ixixj@!ijθij = θim = 0.25 for j (cid:54)= m, but the asymmetry between back and forth jumps
is preserved, i.e. λij (cid:54)= λji. Alternatively γ(x) can be deﬁned on the edges ∂Vij
(see Fig. 3.1(b)) of voxel Vj by γij = h2/2(λij + λji). This corresponds to a
mesoscopic jump process with symmetry in λij = λji and non-symmetric jumps
out of a box λij (cid:54)= λim for j (cid:54)= m.
The anomalous diﬀusion is here modeled by a space dependent diﬀusion
coeﬃcient. In [6] molecules change their internal state, i.e. their diﬀusion con-
stant, spontaneously in time. This correlates to our model when the crowding
macromolecules are moving and the diﬀusion constant hence also becomes time-
dependent: γ(x, t).

In the next section we will use the diﬀusion map γ(x) to derive space de-

pendent reaction rates.

5 Reactions

Approaches to correct the reaction rates for crowding eﬀects use either time
dependent reaction rates k(t) [5, 68] or a static modiﬁcation [17, 29, 31]. Simi-
larly to the latter we will use the space dependent diﬀusion coeﬃcient γ(x) from
the previous section to compute mesoscopic reaction rates ki inside each voxel
Vi. This static rate becomes time-dependent ki(t) if we model moving crow-
ders. According to [37] the dilute mesoscopic rate k0 for bimolecular reactions
in a three dimensional cube of volume h3 is linked to the eﬀective rate kCK by
Collins and Kimball [10] by

k0 = kCK/h3,

kCK =

4πσγ0kr

4πσγ0 + kr

,

(5.1)

where kr is the intrinsic reaction rate and σ the sum of the two reaction radii.
In 2D there is no equivalent formula but approximations are derived in [22, 36].
Assuming constant Fickian diﬀusion inside each voxel as in Sec. 4, we can
now compute mesoscopic reaction rates ki for each voxel by inserting the γi
from (4.2) into (5.1)

k(x) =

1
h3

4πσγ(x)kr

4πσγ(x) + kr

and

k(x)|Vi = ki.

(5.2)

In our macroscopic framework to model crowding by a space dependent diﬀusion
map, these reaction rates ki model reactions under excluded volume eﬀects and
can be used in a mesoscopic simulation, where reactions inside each voxel Vi
have their speciﬁc reaction rate or in a macroscopic simulation, where a space
dependent reaction term is included in the PDE (4.1).

In this model only bimolecular associations are aﬀected by macromolecular
crowding, since the hindered diﬀusion changes the hitting time for the reaction
partners.
In the internal states model [6] also birth-death processes and iso-
merizations become anomalous. It is, however, questionable if it is meaningful
to talk about birth-death processes, when considering excluded volume eﬀects,

11

since all reactants and products also occupy space. With scaled particle theory
[28] also dissociation events are aﬀected by the excluded volume which is due to
two spherical molecules having a diﬀerent activity coeﬃcient than one molecule
with the same total area. In our model, dissociaton is not aﬀected either since
the two products are assumed to occupy the same area.

In Section 6.4, we perform numerical experiments to examine for which pa-
rameters crowding molecules enhance or decrease the rate of biomolecular reac-
tions.

6 Numerical Experiments

In the following experiments we solve (3.9) and (3.10) in 2D with COMSOL
Multiphysics on ωi, i = 1 . . . N . To be able to evaluate the solutions at xi the
crowders are randomly distributed such that the nodes xi remain inside the
perforated domain ωi and are not cut out by the excluded volume.

6.1 Eﬀect of crowding on jump propensities

We ﬁrst investigate how the jump propensity λii changes in diﬀerent crowding
situations. We therefore compute λii on a reference domain ωi with h = 1
and diﬀerent crowders and sizes of the moving molecule r and compare it to
the jump rate λ0,ij in dilute medium. In Fig. 6.1, we compare the mean value
of the jump propensities E[λii] for diﬀerent distributions of crowders and an
increasing percentage of occupied volume φ with the jump propensities when
no crowders are present, where E[λ0,ii] = λ0,ii = 4. We test two diﬀerent sizes
of crowding molecules for both rectangles and spheres. The reference line is the
linear scaling where λii = (1 − φ)λ0,ii as in [45, 63].

12

(a) r = 0

(b) r = 1e − 4

(c) r = 1e − 2

(d) r = 3e − 2

(e) r = 1e − 1

(f) r = 2e − 1

Fig. 6.1: The mean value of the mesoscopic jump coeﬃcients in the crowded
environment E[λii] compared to E[λ0,ii] = 4 in dilute media. Averages are taken
over M = 100 diﬀerent crowder distributions. The obstacles are either small
spheres (blue)/rectangles (orange) or larger spheres (red)/rectangles (green).
The ratio of width to length is 20 for the rectangles. The spherical moving
molecule has radius r. In (e) we compare the mesoscopic coeﬃcients with the
results from a Brownian dynamics simulaion, where we generate 1e4 trajectories
for 10 diﬀerent crowder distributions with the software Smoldyn.

(a) r = 1e − 4

(b) r = 3e − 2

Fig. 6.2: Standard deviation σ(λii/λ0,ii) for M = 100 diﬀerent crowder distri-
butions for the obstacles in Fig. 6.1.

We observe that small obstacles (blue and orange in Fig. 6.1) hinder diﬀusion
more than big crowders for the same percentage of occupied volume, since they
have more reﬂecting surfaces than larger crowders. The same holds for elongated
rectangular crowders (green and orange in Fig. 6.1), as they create long barriers
without occupying a lot of volume. An increasing size r of the diﬀusing molecule

13

φ00.10.20.30.40.50.6E[λii]/E[λ0,ii]00.20.40.60.81R=0.05R=0.10.02×0.40.04×0.81−φφ00.10.20.30.40.50.6E[λii]/E[λ0,ii]00.20.40.60.81R=0.05R=0.10.02×0.40.04×0.81−φφ00.10.20.30.40.50.6E[λii]/E[λ0,ii]00.20.40.60.81R=0.05R=0.10.02×0.40.04×0.81−φφ00.10.20.30.40.50.6E[λii]/E[λ0,ii]00.20.40.60.81R=0.05R=0.10.02×0.40.04×0.81−φφ00.10.20.30.40.50.6E[λii]/E[λ0,ii]00.20.40.60.81R=0.05R=0.10.02×0.40.04×0.81−φSmoldynφ00.10.20.30.40.50.6E[λii]/E[λ0,ii]00.20.40.60.81R=0.05R=0.10.02×0.40.04×0.81−φφ00.10.20.30.40.50.6σ(λii/λ0,ii)00.050.10.15R=0.05R=0.10.02×0.40.04×0.8φ00.10.20.30.40.50.6σ(λii/λ0,ii)00.020.040.060.080.10.120.140.16R=0.05R=0.10.02×0.40.04×0.8leads to an increase in the crowding eﬀect, which is intuitive, since a bigger
molecule ﬁnds less holes through which to escape. These results agree with the
ﬁndings in [59] and [16]. We see that the averaged linear reduction of the jump
propensity can be a good model when the diﬀusing molecule is about a tenth
of the size of the crowders, but over- or underestimates the eﬀect of occupied
volume when the diﬀusing species is smaller or bigger, respectively. Since an
average protein has a radius of ca. 2nm [63] and the biggest macromolecules in
the cell, the ribosomes, have a radius of up to 15nm the linear correction is a good
approximation for many scenarios. The reduction in jump propensity, however,
starts to behave exponentially, as in [31], for large diﬀusing molecules. The
case r = 0 corresponds to a point particle which is irrelevant when simulating
excluded volume eﬀects, but we include it to show the limit for very small
particles. To conﬁrm these mesoscopic jump rates we compare them to the
inverse of the expected exit time computed by a Brownian dynamics simulation.
We simulate 1e4 trajectories with the open source software Smoldyn [1, 2] for 10
diﬀerent crowder distributions and equally sized crowding and moving molecules
with R = r = 1e − 1 and see in Fig. 6.1(e) that the computationally expensive
microscopic results agree well with the mesoscopic coeﬃcients.
In Fig. 6.2, the standard deviation σ(λii/λ0,ii) initially increases as more
and more crowders are added but converges towards zero when the system
approaches the state where no escape to the boundary is possible.

Simply rescaling the jump propensity λii for each node i by a constant
factor will lead to normal diﬀusion at reduced rate. To observe anomalous
diﬀusion in the crowded environment it is helpful to investigate the mean square
displacement (MSD).

6.2 The mean square displacement

As mentioned in Section 2.2 the MSD is linear in time for normal diﬀusion

but for anomalous diﬀusion the relation is no longer linear

(cid:104)x2(t)(cid:105) = 2dγ0t,

(cid:104)x2(t)(cid:105) = 2dγ0tα,

(6.1)

(6.2)

where α < 1 for subdiﬀusion.
In [11, 57] it was shown that diﬀusion in a
crowded environment can be modeled by a temporal change of the diﬀusion
constant. First the molecules diﬀuses normally with rate γ0 for very short time-
scales, before it undergoes a transient anomalous phase with a changing diﬀusion
coeﬃcient γ and ﬁnally stagnates into normal diﬀusion at a lower diﬀusion rate
γ∞. The initial normal diﬀusion represents the time the molecule diﬀuses in
the solution before it encounters the ﬁrst adjacent macromolecule and is slowed
down by collisions. On a large time scale the molecule appears to diﬀuse in a
denser medium instead of around obstacles, hence the reduced diﬀusion rate γ∞,
see Fig. 6.3. If the crowding macromolecules are distributed evenly the MSD
decays monotonically between γ0 and γ∞ (pale line), but due to stochastic

14

variations in the medium it ﬂuctuates before converging to γ∞ (dark line). In
Fig. 6.3(a) we only depict collisions with the macromolecules responsible for
excluded volume eﬀects, but note that there are many collisions with the much
smaller solvent molecules responsible for the Brownian motion.

Since we choose h > R a jump in the mesoscopic model spans a number of
macromolecules and the initial free diﬀusion phase is not resolved and we start
to observe diﬀusion after the ﬁrst jump of length h, that occurs after a critical
time tc which can be approximated by

tc ∼

h2
2dγ0

.

(6.3)

(a)

(b)

Fig. 6.3: (a) Diﬀusion in the crowded cell environment: Initial free diﬀusion
with γ0 (green). After colliding with the ﬁrst macromolecules the observed
diﬀusion is slowed down and the molecules diﬀusion coeﬃcient decays (orange).
Long time behavior of slower diﬀusion with constant γ∞ in a dense medium.
(b) MSD curve for diﬀusion in a crowded medium (solid line) and as reference
normal diﬀusion (dashed line). The pale line corresponds to an ideal well mixed
medium and the dark line to a realistic medium with stochastic ﬂuctuations in
the positions of the crowders.

In the following we will plot the (cid:104)x2(cid:105)/2dγ0t in log-log-scale for diﬀerent
crowding situations to examine when anomalous behavior occurs. Let p(t) ∈
RN be the probability vector for a diﬀusing molecule, such that pi(t) is the
probability that the molecule is in voxel Vi at time t. As described in Section 2,
p(t) evolves by the master equation

pt = Dp(t), p(0) = p0,

(6.4)

where Dij = λji for i (cid:54)= j and Dii = −λii. The initial probability distribution
p0 is (0, . . . , 1, . . . , 0)T with one at the starting node x0. We choose the dis-
cretization such that D is small enough to solve (6.4) numerically and compute
the mean square displacement by

(cid:104)(x(t) − x0)2(cid:105) =

pi(t)(xi − x0)2.

(6.5)

N(cid:88)

i=1

15

 1 0Free diffusion Intermediate regime Diffusion in dense medium thx2(t)i/2dttcIn the following experiments we discretize the square [0, 1] × [0, 1] into N = n2
voxels with space discretization h = 1/(n − 1).
If not mentioned otherwise
we release the molecules in [0.5, 0.5] at time t = 0 and choose n = 41. To
avoid boundary eﬀects we set homogeneous Dirichlet boundary conditions on
∂Ω and show the solutions as long as more than 99% of the mass is preserved,

i.e. (cid:80)N

i=1 pi(t) > 0.99.

6.2.1 The eﬀect of γ0 and φ

In Fig. 6.4(a) we plot M SD/(4γ0t) in the crowded environment for diﬀerent
distributions of crowders. Lines in the same color show diﬀusion in the same en-
vironment with starting positions [0.5, 0.5] (solid) and [0.5±h, 0.5±h] (dashed).
We clearly observe the anomalous behavior since M SD/(4γ0t) is not constant in
time and the ﬂuctuations due to the variations of the local environment around
the starting position, but for longer times they converge towards the same long
time behavior, before the boundary eﬀects become apparent.

We choose the distributions and starting positions of the curves highlighted
in grey to examine the eﬀect of γ0 and φ on the MSD. In Fig. 6.4(b) we observe
that the diﬀusion constant γ0 only aﬀects when the molecule undergoes anoma-
lous diﬀusion but the length of the anomalous phase and the long time behavior
are independent of γ0. The percentage of occupied volume φ on the other hand
changes both, the average diﬀusion constant in the long time behavior and the
duration of the transient regime of anomalous diﬀusion, as expected.

16

(a)

(b)

(c)

(d)

Fig. 6.4: The MSD on a mesoscopic grid with h = 0.025 for diﬀerent distri-
butions of spherical crowders with R = 5e − 3 and a moving molecule with
r = 5e − 4. (a) Diﬀerent crowder distributions (red and blue) and diﬀerent
starting positions (dashed lines) for φ = 0.4 and γ0 = 1. (b) Diﬀerent γ0 for the
distributions highlighted in grey in (a). (c) Diﬀerent φ for γ0 = 1. (d) Diﬀerent
h for the red distribution in (a) and x0 = [0.5, 0.5].

6.2.2 Dependence on the space discretization h

The mesoscopic model is designed for a voxel size h considerably larger than the
molecular radius in order to save computational eﬀort compared to a microscopic
simulation. For h → 0 the dilute and well-mixed assumptions in each voxel do no
longer hold and the mesoscopic model is known to break down for the simulation
of bimolecular reactions [41]. Diﬀerent corrections to the reaction rates have
been suggested [27] and the references therein, but a minimal hmin > R remains
and space cannot be resolved any ﬁner in the mesoscopic model. For a ﬁner
resolution one has to switch to microscopic models, such as BD or CA and we
examine the eﬀect of h only for h (cid:29) R. A larger h shifts the critical time tc
after which we start to observe the molecule’s motion to the right in Fig. 6.3(b)
, so for very large h we will only see the long time behavior. In Fig. 6.4(d) we
see that the initial faster diﬀusion with γ ∼ γ0 is less resolved for large h where
the trajectories start at a much later time, but that all discretizations converge
towards the same long time behavior.

17

t10-610-410-2MSD/(4γ0t)0.350.40.450.50.550.60.650.7t10-610-410-2MSD/(4γ0t)0.350.40.450.50.550.60.650.7γ0=2γ0=1γ0=0.5γ0=0.1t10-610-410-2MSD/(4γ0t)0.40.50.60.70.80.9φ=0.4φ=0.2t10-610-410-2MSD/(4γ0t)0.450.50.550.60.650.7h=0.1h=0.0256.3 Comparison of mesoscopic and macroscopic simula-

tions

The MSD is only one quantity of interest to examine, but since it is a mean not
all features are captured and we will now compare the distributions of molecules
resulting from either a mesoscopic or macroscopic simulation. Again, we dis-
cretize the square [0, 1]× [0, 1] with homogeneous Dirichlet boundary conditions
into 41 nodes in each direction and let molecules start diﬀusing in (0.5, 0.5) in
an environment with rectangles of diﬀerent sizes. We solve (6.4) once with the
mesoscopic D and once with ˜D, where the oﬀ-diagonal elements are all equal
to λii/4, corresponding to a ﬁnite diﬀerence approximation of the macroscopic
equation with the space dependent diﬀusion constant γ(x) derived from the
λiis. In Fig. 6.5 the macroscopic model agrees with the mesoscopic results for
small and evenly distributed crowding molecules , whereas for long barriers only
the mesoscopic approach simulates the expected behavior. This is due to the
symmetrization of ˜D, so that only D can capture the asymmetric diﬀusion close
to the barriers. The diagonal barriers are not completely impermeable in the
mesoscopic model since a small part of the boundary ∂ωij remains.

(a)

(b)

(c)

(d)

(e)

(f)

Fig. 6.5: Solution to (6.4) with diﬀerent sized rectangular crowders and a moving
molecule with radius r = 1e− 3. Results are shown for t = 0.5 with homogenous
Dirichlet boundary conditions. (a) Rectangles of size 5e−4×1e−2 and φ = 0.01.
(d) 5 rectangles of size 0.004 × 0.8. (b) & (e) Mesoscopic simulation. (c) & (f)
Symmetrized macroscopic simulation.

18

00.20.40.60.8100.20.40.60.8110.5000.5110.5000.5100.20.40.60.8100.20.40.60.8110.5000.5110.5000.516.4 Reaction rates

Due to the reduction of diﬀusion in a crowded environment and (5.2) the overall
reaction rate is decreased. It has, however, been shown [28, 68], that protein
associations can also be enhanced. We examine the mean time Er
j until the
bimolecular reaction (6.6)

kr−→ C

A + B

(6.6)
happens, where reactant A is conﬁned to voxel Vi, and molecule B starts dif-
fusing in voxel Vj at time t = 0, see Fig. 6.6(a). Due to molecular crowding we
assume a simpliﬁed space dependent diﬀusion map with γi < γ0 inside Vi and
γ < γ0 in the rest of the domain. With ki given by (5.2) and λii by (3.6) we
can use conditioning on the ﬁrst step to compute the expected time until the
reaction happens:

(cid:34)

(cid:88)

m

Er
i =

ki

1

ki + λii

+

(cid:80)

ki + λii
h2 + 4γi

Er
j = E(xj) +

m θimE(xm)

,

h2ki

λii

ki + λii

1

ki + λii

+

θimE(xm) + Er

i

(cid:35)

(6.7)

(6.8)

(6.9)

(6.10)

where E(xm) is the expected time it takes a molecule located in the neighboring
voxel Vm to jump into voxel Vi and can be computed by solving

pt(t) = (D − Ki)p(t), p(0) = p0,
E(xm) =

|Vk|pk(t)dt,

(cid:90) ∞

N(cid:88)

0

k=1

where Ki models a sink at node xi and is the zero matrix except for Ki,i = 109
and p0 is the zero vector except for p0,m = 1/h3, see [54] for a derivation.
We solve these equations numerically in 3D for a cube with length L = 1 and a
uniform discretization with h = 0.1 in space and reﬂecting boundary conditions.
The voxel Vi, where the reaction happens is chosen to be the center voxel, such
that E(xm) are equal for all 6 neighbors. The diﬀusing molecule B starts in
xj = (0.7, 0.5, 0.5). In Fig. 6.6 we compare the mean binding time in the crowded
Er
j environment with diﬀerent γi and γ to the time Er
j,0 it takes to react in a
dilute solution where γ(x) = γ0 = 1. The data points with scaled error bars
(±(
)) are from a SSA simulation of the reaction-diﬀusion process
with M = 200 trajectories for kr = 1e − 4 and kr = 1e − 3 and M = 500 for
kr = 5e − 3 and kr = 1e − 2.

+ σ0√MEr

σ√MEr

j,0

j

19

(a)

(b)

(c)

Fig. 6.6:
(a) Experimental setting where a B molecule starts diﬀusing in
xj = (0.7, 0.5, 0.5) and reacts with A that is conﬁned to voxel Vi with
xi = (0.5, 0.5, 0.5). Due to an uneven distribution of crowders we assume that
the diﬀusion rate is γi inside Vi and γ (vertical dashed line) in the rest of the
domain. The time it takes to react in this crowded environment Er
j is compared
to that in an uncrowded environment Er
j,0 with γ0 = 1. (b) γ = 0.7. (c) γ = 0.9.

An overall slower diﬀusion rate γ < γ0 as a result of obstacles reduces the
rate of bimoleculear reactions (5.2) in each voxel. But, due to an uneven distri-
bution of crowding agents compartmentalization with locally diﬀering diﬀusion
rates can occur inside the cells.
In Fig. 6.6 the overall reaction rate can be
increased for a compartmentalization where γi is smaller than γ, despite the
locally slower reaction. Because once the diﬀusing molecule enters Vi it escapes
slower and hence gets trapped close to its reaction partner, which increases the
chance of collisions. Like this, cells can boost their eﬃciency by locating im-
portant reaction complexes in areas of slower diﬀusion, which will be especially
productive for reaction cascades where intermediate products are already pro-
duced inside the compartment and have a low chance of escaping before being
In the limit when γi → 0 the binding time goes towards
processed further.
inﬁnity, since then both reactants are immobile inside Vi and never collide.

7 Conclusion

We have presented a multiscale framework to model diﬀusion and reactions in
a crowded environment, which is an important feature for realistic simulations
inside living cells and on their membranes. First, we solve a set of PDEs on
local domains resolving the microscopic positions and shapes of the crowding
molecules. This pre-computing step is embarrassingly parallelizable and yields
local ﬁrst exit times, which can be transformed into the jump rates on an over-
lying Cartesian grid at the mesoscopic level. We then use these local ﬁrst exit
times to compute a space dependent diﬀusion coeﬃcient for the macroscopic dif-
fusion equation, which corresponds to space dependent reaction rates according
to the formula by Colins and Kimball.

Our approach is general in the sense that the crowding molecules can have
arbitrary shapes and can be located anywhere inside the domain. We indicate

20

		 xixj iγi00.20.40.60.81Erj/Erj,000.511.5kr=1e−4kr=1e−3kr=5e−3kr=1e−2γi00.20.40.60.81Erj/Erj,000.511.5kr=1e−4kr=1e−3kr=5e−3kr=1e−2how to adapt our method to moving crowders by computing statistics which we
will further explore in the future. As the jump process is simulated on a coarse
Cartesian mesh, no longer resolving the numerous crowders, the stochastic sim-
ulation is computationally much more eﬃcient than a microscopic simulation
capturing all the collisions.

In numerical experiments we foremost observe that shape and size consider-
ably aﬀect how strongly diﬀusion is impeded: small crowders have more reﬂec-
tive surface and hence hinder diﬀusion more severely than bigger obstacles, so
do elongated crowders, which create long barriers. The eﬀect is also stronger
for larger diﬀusing molecules than for smaller ones, since the former need big-
ger gaps to pass through. This gives some new insight into how non-idealized
(non-spherical) macromolecules aﬀect the diﬀusion, since most existing models
either assume that all particles are spheres or only consider the percentage of
occupied volume.

Comparing the mesoscopic and macroscopic models for diﬀusion in the crowded

environment we note that the former captures the asymmetries created by long
barriers better and that they both behave similarly for small crowding molecules
compared to the grid size.

The space dependent diﬀusion rate can be interpreted as a compartmental-
ization eﬀect, which has been observed in cells. In a simpliﬁed example we see
that reactions located inside a compartment with high crowding/low diﬀusivity
can be enhanced since the reaction partners reside longer in the vicinity of each
other. Hence, the concentration of reaction complexes in an area with slow dif-
fusion as compared to the rest of the cytoplasm or cell membrane can increase
the reaction turn-over, an eﬀect that has been capitalized by cells through co-
localization of reaction complexes and scaﬀolding. Otherwise, reactions between
initially distant molecules are impeded by excluded volume since it takes longer
time for the reactants to ﬁnd each other.

Hard sphere reﬂections on obstacles are not the sole cause of anomalous
diﬀusion [66], but there are other interactions between macromolecules, such
as transient binding or electrostatic repulsion, which have been modeled by a
continous time random walk [3, 70] and fractional or multifractional Brownian
motion [50]. We can include these types of interactions, by modifying bound-
ary conditions on the crowders from reﬂecting to partially absorbing or adding
potential barriers.

Acknoledgements

This work was supported by the Swedish Research Council grant 621-2001-3148
and the NIH grant for StochSS with number 1R01EB014877-01. The author
would like to thank the Computational Systems Biology group at Uppsala Uni-
versity for fruitful discussions and Markus Eriksson for the Smoldyn simulations.

21

References

[1] S. S. Andrews, N. J. Addy, R. Brent, and A. P. Arkin. Detailed simulations
of cell biology with Smoldyn 2.1. PLoS Comput. Biol., 6(3):e1000705, 2010.

[2] S S Andrews and D Bray. Stochastic simulation of chemical reactions with
spatial resolution and single molecule detail. Phys. Biol., 1(3-4):137–151,
2004.

[3] Eli Barkai, Yuval Garini, and Ralf Metzler. Strange kinetics of single

molecules in living cells. Phys. Today, 65(8):29–35, 2012.

[4] Daniel Ben-Avraham and Shlomo Havlin. Diﬀusion and reactions in frac-

tals and disordered systems. Cambridge University Press, 2000.

[5] Hugues Berry. Monte carlo simulations of enzyme reactions in two dimen-
sions: fractal kinetics and spatial segregation. Biophys. J., 83(4):1891–1901,
2002.

[6] Emilie Blanc, Stefan Engblom, Andreas Hellander, and Per L¨otstedt. Meso-
scopic modeling of stochastic reaction-diﬀusion kinetics in the subdiﬀusive
regime. pages 1–30, 2015.

[7] D. L. Brown and D. Peterseim. A Multiscale Method for Porous Microstruc-

tures. ArXiv e-prints, November 2014.

[8] Y. Cao, D. T. Gillespie, and L. R. Petzold. The slow-scale stochastic

simulation algorithm. J. Chem. Phys., 122:014116, 2005.

[9] Claudia Cianci, Stephen Smith, and Ramon Grima. Molecular ﬁnite-size
eﬀects in stochastic models of equilibrium chemical systems. J. Chem.
Phys., 084101(144):1–35, 2016.

[10] F. C. Collins and G. E. Kimball. Diﬀusion-controlled reaction rates. J.

Colloid. Sci., 4:425–437, 1949.

[11] Carmine Di Rienzo, Vincenzo Piazza, Enrico Gratton, Fabio Beltram, and
Francesco Cardarelli. Probing short-range protein Brownian motion in the
cytoplasm of living cells. Nat. Commun., 5:5891, 2014.

[12] A. Donev, V. V. Bulatov, T. Oppelstrup, G. H. Gilmer, B. Sadigh, and
M. H. Kalos. A ﬁrst-passage kinetic Monte Carlo algorithm for complex
diﬀusion-reaction systems. J. Comput. Phys., 229:3214–3236, 2010.

[13] Aleksandar Donev, Vasily V. Bulatov, Tomas Oppelstrup, George H.
Gilmer, Babak Sadigh, and Malvin H. Kalos. A First-Passage Kinetic
Monte Carlo algorithm for complex diﬀusionreaction systems. J. Comput.
Phys., 229(9):3214–3236, may 2010.

22

[14] B. Drawert, S. Engblom, and A. Hellander. URDME: a modular frame-
work for stochastic simulation of reaction-transport processes in complex
geometries. BMC Syst. Biol., 6:76, 2012.

[15] J. Elf and M. Ehrenberg. Spontaneous separation of bi-stable biochemical
systems into spatial domains of opposite phases. Syst. Biol., 1:230–236,
2004.

[16] Adam J Ellery, Ruth E Baker, and Matthew J Simpson. Calculating the
Fickian diﬀusivity for a lattice-based random walk with agents and obsta-
cles of diﬀerent shapes and sizes. Phys. Biol., 12(6):066010, 2015.

[17] R. J. Ellis. Macromolecular crowding: An important but neglected aspect
of the intracellular environment. Curr. Opin. Struct. Biol., 11(1):114–119,
2001.

[18] M. B. Elowitz, A. J. Levine, E. D. Siggia, and P. S. Swain. Stochastic gene

expression in a single cell. Science, 297:1183–1186, 2002.

[19] S. Engblom, L. Ferm, A. Hellander, and P. L¨otstedt. Simulation of stochas-
tic reaction-diﬀusion processes on unstructured meshes. SIAM J. Sci. Com-
put., 31:1774–1797, 2009.

[20] D Fanelli, a J McKane, G Pompili, B Tiribilli, M Vassalli, and T Biancalani.
Diﬀusion of two molecular species in a crowded environment: theory and
experiments. Phys. Biol., 10(4):045008, 2013.

[21] Duccio Fanelli and Alan J. McKane. Diﬀusion in a crowded environment.

Phys. Rev. E - Stat. Nonlinear, Soft Matter Phys., 82(2):1–4, 2010.

[22] David Fange, Otto G Berg, Paul Sj¨oberg, and Johan Elf. Stochastic
reaction-diﬀusion kinetics in the microscopic limit. Proc. Natl. Acad. Sci.
U. S. A., 107(46):19820–5, nov 2010.

[23] C. W. Gardiner. Handbook of Stochastic Methods. Springer Series in Syn-

ergetics. Springer-Verlag, Berlin, 3rd edition, 2004.

[24] C. W. Gardiner, K. J. McNeil, D. F. Walls, and I. S. Matheson. Correlations
in stochastic theories of chemical reactions. J. Stat. Phys., 14(4):307–331,
1976.

[25] M. A. Gibson and J. Bruck. Eﬃcient exact stochastic simulation of chem-
J. Phys. Chem.,

ical systems with many species and many channels.
104(9):1876–1889, 2000.

[26] D. T. Gillespie. A general method for numerically simulating the stochastic
time evolution of coupled chemical reactions. J. Comput. Phys., 22(4):403–
434, 1976.

[27] Daniel T. Gillespie, Andreas Hellander, and Linda R. Petzold. Perspective:
Stochastic algorithms for chemical kinetics. J. Chem. Phys., 138(17), 2013.

23

[28] B Grasberger, a P Minton, C DeLisi, and H Metzger.

Interaction be-
tween proteins localized in membranes. Proc. Natl. Acad. Sci. U. S. A.,
83(17):6258–6262, 1986.

[29] R. Grima. Intrinsic biochemical noise in crowded intracellular conditions.

J. Chem. Phys., 132(18), 2010.

[30] R. Grima and S. Schnell. A systematic investigation of the rate laws valid

in intracellular environments. Biophys. Chem., 124(1):1–10, 2006.

[31] Ramon Grima and Santiago Schnell. A mesoscopic simulation approach for

modeling intracellular reactions. J. Stat. Phys., 128(1-2):139–164, 2007.

[32] Damien Hall and Allen P. Minton. Macromolecular crowding: Qualitative
and semiquantitative successes, quantitative challenges. Biochim. Biophys.
Acta - Proteins Proteomics, 1649(2):127–139, 2003.

[33] Maike M. K. Hansen, Lenny H. H. Meijer, Evan Spruijt, Roel J. M. Maas,
Marta Ventosa Rosquelles, Joost Groen, Hans A. Heus, and Wilhelm T. S.
Huck. Macromolecular crowding creates heterogeneous environments of
gene expression in picolitre droplets. Nat. Nanotechnol., 11(October):1–8,
2015.

[34] J. Hattne, D. Fange, and J. Elf. Stochastic reaction-diﬀusion simulation

with MesoRD. Bioinformatics, 21:2923–2924, 2005.

[35] Shlomo Havlin and Daniel Ben-Avraham. Diﬀusion in disordered media.

Adv. Phys., 51(1):187–292, 2002.

[36] Stefan Hellander, Andreas Hellander, and Linda Petzold. Reaction-
diﬀusion master equation in the microscopic limit. Phys. Rev. E - Stat.
Nonlinear, Soft Matter Phys., 85(4):1–5, 2012.

[37] Stefan Hellander, Andreas Hellander, and Linda Petzold. Reaction rates

for mesoscopic reaction-diﬀusion kinetics. Phys. Rev. E, 91(2), 2015.

[38] I. Hepburn, W. Chen, S. Wils, and E. De Schutter. STEPS: eﬃcient simula-
tion of stochastic reaction-diﬀusion models in realistic morphologies. BMC
Syst. Biol., 6:36, 2012.

[39] Jan Hrabe, Sabina Hrabetov´a, and Karel Segeth. A model of eﬀective
diﬀusion and tortuosity in the extracellular space of the brain. Biophys. J.,
87(3):1606–1617, 2004.

[40] S. A. Isaacson and C. S. Peskin. Incorporating diﬀusion in complex geome-
tries into stochastic chemical kinetics simulations. SIAM J. Sci. Comput.,
28(1):47–74, 2006.

[41] Samuel A Isaacson. The reaction-diﬀusion master equation as an asymp-
totic approximation of diﬀusion to a small target. SIAM Journal on Applied
Mathematics, 70(1):77–111, 2009.

24

[42] Songwan Jin and a. S. Verkman. Single particle tracking of complex diﬀu-
sion in membranes: Simulation and detection of barrier, raft, and interac-
tion phenomena. J. Phys. Chem. B, 111(14):3625–3632, 2007.

[43] R. A. Kerr, T. M. Bartol, B. Kaminsky, M. Dittrich, J.-C. J. Chang, S. B.
Baden, T. J. Sejnowski, and J. R. Stiles. Fast Monte Carlo simulation
methods for biological reaction-diﬀusion systems in solution and on sur-
faces. SIAM J. Sci. Comput., 30(6):3126–3149, 2008.

[44] Diego Krapf. Mechanisms Underlying Anomalous Diﬀusion in the Plasma

Membrane, volume 75. Elsevier Ltd, 2015.

[45] Kerry a. Landman and Anthony E. Fernando. Myopic random walkers and
exclusion processes: Single and multispecies. Phys. A Stat. Mech. its Appl.,
390(21-22):3742–3753, 2011.

[46] Byoungkoo Lee, Philip R. LeDuc, and Russell Schwartz. Stochastic oﬀ-
lattice modeling of molecular self-assembly in crowded environments by
Greens function reaction dynamics. Phys. Rev. E, 78(3):031911, 2008.

[47] Per L¨otstedt and Lina Meinecke. Simulation of stochastic diﬀusion via ﬁrst

exit times. J. Comput. Phys., 300:862–886, nov 2015.

[48] K Luby-Phelps. Cytoarchitecture and physical properties of cytoplasm:

volume, viscosity, diﬀusion, intracellular surface area., 2000.

[49] Axel M˚alqvist and Daniel Peterseim. Localization of elliptic multiscale

problems. Math. Comput., 83(290):2583–2603, 2014.

[50] T.T. Marquez-Lago, a. Leier, and K. Burrage. Anomalous diﬀusion and
multifractional Brownian motion: simulating molecular crowding and phys-
ical obstacles in systems biology. IET Syst. Biol., 6(4):134, 2012.

[51] H. H. McAdams and A. Arkin. Stochastic mechanisms in gene expression.

Proc. Natl. Acad. Sci. USA, 94:814–819, 1997.

[52] D. A. McQuarrie. Stochastic approach to chemical kinetics. J. Appl. Prob.,

4:413–478, 1967.

[53] Ohad Medalia, Igor Weber, Achilleas S Frangakis, Daniela Nicastro,
Gunther Gerisch, and Wolfgang Baumeister. Macromolecular architec-
ture in eukaryotic cells visualized by cryoelectron tomography. Science,
298(2002):1209–1213, 2002.

[54] Lina Meinecke, Stefan Engblom, Andreas Hellander, and Per L¨otstedt.
Analysis and design of jump coeﬃcients in discrete stochastic diﬀusion
models. SIAM J. Sci. Comput., 38(1):A55–A83, 2016.

[55] Lina Meinecke and Per L¨otstedt. Stochastic diﬀusion processes on Cartesian

meshes. J. Comput. Appl. Math., 294:1–11, mar 2016.

25

[56] R. Metzler. The future is noisy: The role of spatial ﬂuctuations in genetic

switching. Phys. Rev. Lett., 87:068103, 2001.

[57] Mario S Mommer and Dirk Lebiedz. Modeling subdiﬀusion using reaction
diﬀusion systems. SIAM Journal on Applied Mathematics, 70(1):112–132,
2009.

[58] B. Munsky, G. Neuert, and A. van Oudenaarden. Using gene expression

noise to understand gene regulation. Science, 336(6078):183–187, 2012.

[59] N Muramatsu and a P Minton. Tracer diﬀusion of globular proteins in
concentrated protein solutions. Proc. Natl. Acad. Sci. U. S. A., 85(9):2984–
2988, 1988.

[60] B. Øksendal. Stochastic Diﬀerential Equations. Springer, Berlin, 6th edi-

tion, 2003.

[61] T. Oppelstrup, V. V. Bulatov, A. Donev, M. H. Kalos, G. H. Gilmer,
and B. Sadigh. First-passage kinetic Monte Carlo method. Phys. Rev. E,
80:066701, 2009.

[62] Catherine J. Penington, Barry D. Hughes, and Kerry a. Landman. Building
macroscale models from microscale probabilistic models: A general proba-
bilistic approach for nonlinear diﬀusion and multispecies phenomena. Phys.
Rev. E, 84(4):041120, 2011.

[63] Rob Phillips, Jane Kondev, and Julie Theriot. Physical Biology of the Cell.

Garland Science, Taylor & Francis Group, New York, November 2008.

[64] A. Raj and A. van Oudenaarden. Nature, nurture, or chance: Stochastic

gene expression and its consequences. Cell, 135(2):216–226, 2008.

[65] S. Redner. A Guide to First-Passage Processes. Cambridge University

Press, Cambridge, 2001.

[66] Douglas Ridgway, Gordon Broderick, Ana Lopez-Campistrous, Melania
Ru’aini, Philip Winter, Matthew Hamilton, Pierre Boulanger, Andriy Ko-
valenko, and Michael J Ellison. Coarse-grained molecular simulation of
diﬀusion and reaction kinetics in a crowded virtual cytoplasm. Biophys. J.,
94(10):3748–3759, 2008.

[67] Elijah Roberts, John E. Stone, and Zaida Luthey-Schulten. Lattice mi-
crobes: High-performance stochastic simulation method for the reaction-
diﬀusion master equation. J. Comput. Chem., 34(3):245–255, 2013.

[68] S. Schnell and T. E. Turner. Reaction kinetics in intracellular environments
with macromolecular crowding: Simulations and rate laws. Prog. Biophys.
Mol. Biol., 85(2-3):235–260, 2004.

26

[69] Johannes Sch¨oneberg, Alexander Ullrich, and Frank No´e. Simulation tools
for particle-based reaction-diﬀusion dynamics in continuous space. BMC
Biophys., 7(1):11, 2014.

[70] Johannes H.P. Schulz, Eli Barkai, and Ralf Metzler. Aging Renewal Theory

and Application to Random Walks. Phys. Rev. X, 4(1):011028, 2014.

[71] Gregory R. Smith, Lu Xie, Byoungkoo Lee, and Russell Schwartz. Applying
Molecular Crowding Models to Simulations of Virus Capsid Assembly In
Vitro. Biophys. J., 106(1):310–320, 2014.

[72] P. S. Swain, M. B. Elowitz, and E. D. Siggia. Intrinsic and extrinsic con-
tributions to stochasticity in gene expression. Proc. Natl. Acad. Sci. USA,
99(20):12795–12800, 2002.

[73] Koichi Takahashi, Sorin Tanase-Nicola, and Pieter Rein ten Wolde. Spatio-
temporal correlations can drastically change the response of a MAPK path-
way. Proc. Natl. Acad. Sci. U. S. A., 107(6):2473–2478, 2010.

[74] Kouichi Takahashi, Satya Nanda Vel Arjunan, and Masaru Tomita. Space
in systems biology of signaling pathways - Towards intracellular molecular
crowding in silico. FEBS Lett., 579(8):1783–1788, 2005.

[75] P. R. Taylor, C. A. Yates, M. J. Simpson, and R. E. Baker. Reconciling
transport models across scales: The role of volume exclusion. Phys. Rev.
E, 92(4):040701, 2015.

[76] Alan S. Verkman. Solute and macromolecule diﬀusion in cellular aqueous

compartments. Trends Biochem. Sci., 27(1):27–33, 2002.

[77] J. S. van Zon and P. R. ten Wolde. Green’s-function reaction dynamics: A
particle-based approach for simulating biochemical networks in time and
space. J. Chem. Phys., 123:234910, 2005.

27

