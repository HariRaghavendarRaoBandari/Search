6
1
0
2

 
r
a

 

M
0
2

 
 
]
P
A
h
t
a
m

.

[
 
 

1
v
7
6
1
6
0

.

3
0
6
1
:
v
i
X
r
a

C1,α ESTIMATES FOR THE PARALLEL REFRACTOR

FARHAN ABEDIN, CRISTIAN E. GUTI ´ERREZ, AND GIULIO TRALLI

Abstract. We consider the parallel refractor problem when the planar radiating
source lies in a medium having higher refractive index than the medium in
which the target is located. We prove local C1,α estimates for parallel refractors
under suitable geometric assumptions on the source and target, and under local
regularity hypotheses on the target set. We also discuss existence of refractors
under energy conservation assumptions.

1. Introduction

Suppose we have a domain Ω ⊂ Rn and a domain Σ contained in an n dimen-
sional surface in Rn+1; here, Ω denotes the extended source, and Σ denotes the
target domain, receiver, or screen to be illuminated. Let n1 and n2 be the indices
of refraction of two homogeneous and isotropic media I and II, respectively. Sup-
pose from the extended source Ω, surrounded by medium I, radiation emanates
in the vertical direction en+1 with intensity f (x) for x ∈ Ω, and the target Σ is
surrounded by medium II. That is, all emanating rays from Ω are collimated. A
parallel refractor is an optical surface R, interface between media I and II, such that
all rays refracted byR into medium II are received at the surface Σ with prescribed
radiation intensity σ(p) at each point p ∈ Σ. Assuming no loss of energy in this
process, we have the conservation of energy equation

Ω f (x) dx =(cid:82)

σ(p) dp.

(cid:82)

Σ

When medium II is denser than medium I (i.e. n1 < n2), C1,α estimates are proved
in [GT15], and the existence of refractors is proved in [GT13]. The purpose of this
paper is to consider the case when n1 > n2. This has interest in the applications to
lens design since lenses are typically made of a material having refractive index
larger than the surrounding medium. In fact, if the material around the source is
cut out with a plane parallel to the source, then the lens sandwiched between that
plane and the constructed refractor surface will perform the desired refracting job.

Date: March 22, 2016.
C. E. G was partially supported by NSF grant DMS–1201401. G. T. wishes to thank the De-
partment of Mathematics of Temple University for the kind hospitality during his visit during the
Spring of 2015, when this work started.

1

2

F. ABEDIN, C. E. GUTI ´ERREZ, AND G. TRALLI

When n1 > n2 the geometry of the refractors is diﬀerent than when n1 < n2; in fact,
the geometry is determined by hyperboloids instead of ellipsoids. In addition,
in the case n1 > n2, total internal reﬂection can occur and one needs additional
geometric conditions on the relative conﬁguration between the source and the
target so that the target is reachable by the refracted rays. To obtain existence
and regularity of refractors when n1 > n2, the use of hyperboloids requires non-
trivial changes in some of the arguments used in [GT15] when n1 < n2. The main
diﬀerences are in the set up of the problem, in the arguments to obtain global
support from local support, Section 4, and in the proof of existence. Our results
are local; that is, we only need to assume local conditions in a neighborhood of
a point in the extended source and the target. The main result of the paper is
Theorem 5.4 where C1,α estimates are proved. We remark that most results do not
involve the energy distribution given in the source and target, and conservation
of energy is only used to prove existence in Theorem 6.1. For instance, the fact
that local refractors are global, Theorem 4.2, just follows from the geometric
assumptions in Section 3; see condition (AW).
In addition, Theorem 5.3 only
requires geometric assumptions. Properties of the target measure are necessary
only to obtain the H¨older estimates, Theorem 5.4. Our results are structural, in
the sense that they only depend on the geometric conditions assumed and do not
depend on the smoothness of the measures given in the source and target.

Problems of refraction have generated interest recently for the applications to
design free form lenses and also for the various mathematical tools developed to
solve them. For example, the far ﬁeld point source refractor problem is solved
in [GH09] using mass transport. The near ﬁeld point source refractor problem
is considered in [Gut08] and [GH14]. More general models taking into account
losses due to internal reﬂection are in [GM13]. Numerical methods have been
developed in [BHP15] and [CO08] for the actual calculation of reﬂectors, and
recently in [LGM16] for the numerical design of far ﬁeld point source refractors.
A signiﬁcant amount of work has also been done to obtain results on the regularity
of reﬂectors and refractors [CGH08, Loe11, KW10, Kar14, Kar16, GK15].

The organization of the paper is as follows. Section 2 contains results concerning
estimates of hyperboloids of revolution. The precise deﬁnition of refractor is in
Section 2.2, and the structural assumptions on the target that avoid total reﬂection
are in Section 2.3. The derivatives estimates needed for hyperboloids are in Section
2.4. Section 3 contains assumptions on the target modeled on the conditions
introduced by Loeper in the seminal work [Loe09, Proposition 5.1]. In Section 4,

C1,α ESTIMATES FOR THE PARALLEL REFRACTOR

3

using the geometry of the hyperboloids, we prove that if a hyperboloid supports
a parallel refractor locally, then it supports the refractor globally provided the
target satisﬁes the local condition (AW). This resembles the condition (A3) of
Ma, Trudinger and Wang [MTW05] introduced in the context of optimal mass
transport. The main results are in Section 5, in particular, Section 5.1 contains the
proof of the H¨older estimates. Finally in the Appendix, Section 6, we discuss and
establish the existence of refractors satisfying the energy conservation condition
(6.17).

2. Definitions and Preliminary Results

We brieﬂy review the process of refraction. Points in Rn+1 will be denoted by
X = (x, xn+1). We consider parallel rays traveling in the unit direction en+1. Let T
be a hyperplane with outward pointing unit normal N and X ∈ T. We assume
that medium I is located in the region below T and media II in the region above
T. In such a scenario, a ray of light emanated from Ω in the direction en+1 strikes
T at X and, by Snell’s Law of Refraction, gets refracted in the unit direction
1 + κ2 ((en+1 · N)2 − 1),

Λ = κ en+1 + δN, with δ = −κ en+1 · N +(cid:112)

−κ +(cid:112)

√

(cid:32)

−

, then δ =

where δ < 0 since κ > 1. The refracted ray is X + sΛ, for s > 0; see Figure 1.
In particular, if v ∈ Rn and the hyperplane T is so that the unit upper normal
N = (−v, 1)
1 + |v|2
and the refracted unit direction is
:= (Q(v)v,−Q(v) + κ),

1 − (κ2 − 1)|v|2
√
1 + |v|2
δ√
v,
1 + |v|2

(2.1)
with Q(v)2|v|2 + (Q(v) − κ)2 = 1. With this notation we have Q > 0.
Since medium I is more dense than medium II, total internal reﬂection can occur,
[BW59, Sect. 1.5.4]. To avoid this we assume en+1 · Λ(v) ≥ n2/n1, or equivalently,
en+1 · N ≥ √

1 − κ−2; see [GH09, Lemma 2.1] where n1 and n2 are reversed.

δ√
1 + |v|2

Λ(v) :=

(cid:33)

+ κ

2.1. Hyperboloids. Fix b > 0. A two-sheeted hyperboloid in Rn+1 with upper
focus at Y = (y, yn+1) and lower focus at Y

has equation

(cid:48) =

(cid:32)

xn+1 −

(cid:32)
(cid:32)

(cid:33)(cid:33)2

y, yn+1 − 2κ b
κ2 − 1
(cid:33)2
(cid:32)
− |x − y|2
b√
κ2 − 1

= 1.

κ b
(cid:33)2
κ2 − 1

yn+1 +

b
κ2 − 1

(cid:32)

(cid:33)

4

F. ABEDIN, C. E. GUTI ´ERREZ, AND G. TRALLI

Figure 1. Snell n1 > n2

b
κ2 − 1

(cid:32)

, the semi-axis with direction y is

(cid:32)
y, yn+1 − κ b
κ2 − 1

(cid:33)
y, yn+1 − b
κ − 1

. Moreover,

(cid:33)

.

, and the center of symmetry is the point

The semi-axis with direction yn+1 is
b√
κ2 − 1
the upper vertex is
Hence the distance between the foci is

y, yn+1 − b
κ + 1

(cid:32)

(cid:33)

and the distance between the vertices is

2c = 2κ b
κ2 − 1

,

, and the lower vertex is

2a = 2b
κ2 − 1

.

c
a

By deﬁnition, the eccentricity is
sheet (facing downwards) of the hyperboloid is given by

(cid:111) ,
X = (x, xn+1) ∈ Rn+1 : κ(yn+1 − xn+1) − |X − Y| = b

H(Y, b) :=

(2.2)

(cid:110)

, and so the eccentricity equals κ. The lower

which can be written as the graph of the function

(2.3)

φ(x) := φY,b(x) := yn+1 − κ b
κ2 − 1

−

b
κ2 − 1

|x − y|2
κ2 − 1

.

+

(cid:115)(cid:32)

(cid:33)2

n1n2NΛ(v)en+1TXu(x)C1,α ESTIMATES FOR THE PARALLEL REFRACTOR

5

Figure 2. Refraction in the hyperboloid

Suppose the region above H(Y, b) has refractive index n2, and the region below
H(Y, b) has refractive index n1, with κ = n1/n2 > 1. Then we have from [GH09,
Section 2.2] and the reversibility of optical paths that each ray with direction en+1
striking from below the graph of φ at the point X = (x, φ(x)) is refracted into a ray
passing through the upper focus Y; see Figure 2. Therefore, Y lies along the ray
X + sΛ(v) with v = Dφ(x), with Λ(v) given by (2.1). Conversely,

(2.4)

if X = (x, φ(x)) and the focus Y can be written as Y = X + s Λ(v)
for some s > 0 and v ∈ Rn, then v = Dφ(x);

a fact that will be used on multiple occasions throughout this paper.
Given X, Y ∈ Rn+1, let us deﬁne
(2.5)
If c(X0, Y) > 0, then H(Y, c(X0, Y)) is the unique lower sheet of a two-sheeted
hyperboloid with upper focus at Y passing through X0, and it is thus described
by

c(X, Y) := κ(yn+1 − xn+1) − |X − Y|.

(cid:115)

(2.6)

φ(x, Y, X0) = yn+1 − κ c(X0, Y)
κ2 − 1

−

c(X0, Y)2
(κ2 − 1)2

+

|x − y|2
κ2 − 1

.

Notice that φ(x, Y, X0) = φY,c(X0,y)(x).
2.2. Deﬁnition of refractor. We are given a source domain Ω ⊂ Rn = Rn × {0}
surrounded by medium n1 and a target Σ, a compact hypersurface in Rn+1
+ =

n1n2YΛ(v)en+1Y′ϕ(x)6

F. ABEDIN, C. E. GUTI ´ERREZ, AND G. TRALLI

{xn+1 > 0}, surrounded by medium n2, with n2 < n1. Informally, a parallel refractor
from Ω to Σ is the graph of a function u deﬁned on Ω that refracts all vertical rays
emanating from Ω into Σ. The hyperboloid H(Y, b) is said to support u at the
point (x0, u(x0)), x0 ∈ Ω, if there exist b > 0 and Y ∈ Σ such that u(x) ≥ φY,b(x) with
equality at x = x0. We will show that the existence of supporting hyperboloids
depends on the relative positions between Ω and Σ; this will lead to a precise
notion of refractor given in Deﬁnition 2.1.

Also from physical reasons, the refracting surface given by u must be above
the source Ω: u has thus to be positive in Ω. This means that the supporting
hyperboloids must satisfy

φY,b(x) > 0

for all x ∈ Ω and for all Y ∈ Σ,

which immediately imposes a condition on b. In fact, ﬁrst notice that from (2.3)
we have

x

max

φY,b(x) = φY,b(y) = yn+1 − b
κ − 1
(2.7)
If φY,b( ¯x) > 0 at some ¯x ∈ Ω, then we have φY,b(y) > 0 that is
(2.8)
Fix Y ∈ Σ and b satisfying (2.8). By calculation we get that

0 < b < (κ − 1) yn+1.

.

(cid:32)

(cid:113)(cid:0)b − κ yn+1

(cid:1)2 − y2

n+1

(cid:33)

.

Since we need all the φY,b’s to be positive in Ω, we want

y,

y,

(cid:33)

(cid:113)(cid:0)b − κ yn+1

{x ∈ Rn : φY,b(x) > 0} = B
(cid:32)
(cid:1)2 − y2
∆y ≤ (cid:113)(cid:0)b − κ yn+1

n+1

(2.9)

Ω ⊂ B

Notice that (2.8) implies that the quantity inside the last square root is positive.

Fixing Y = (y, yn+1) ∈ Σ and letting ∆y = diam(cid:0)Ω ∪ {y}(cid:1), (2.9) is equivalent to

for all Y = (y, yn+1) ∈ Σ.
(cid:1)2 − y2
which squaring imposes a condition on b, i.e.
b2 − 2 κ b yn+1 + (κ2 − 1) y2

≥ 0.

− ∆2

(2.10)

(2.11)

n+1

n+1

y

The corresponding quadratic equation in b has roots

r± = κ yn+1 ±(cid:113)

y2
n+1

y.
+ ∆2

C1,α ESTIMATES FOR THE PARALLEL REFRACTOR

7

First observe that r− > 0. Because there is x0 ∈ Ω such that ∆y = |x0 − y| and since
φY,b(x0) ≥ 0 we obtain

yn+1 >

∆y√
κ2 − 1

which is equivalent to r− > 0. So to have the inclusion (2.9) we must have from
(2.11) that

0 < b < r−

or

r+ < b.

But from (2.8) it is easy to see that r+ < b is impossible. So to have the inclusion
(2.9) we must have

that is,

(2.12)

(2.13)

0 < b < min{(κ − 1) yn+1, r−} = r−,

0 < b < κ yn+1 −(cid:113)

y2
n+1

y.
+ ∆2

∆ = max
y∈π(Σ)

∆y

0 < b < κ yn+1 −(cid:113)

+ ∆2.

y2
n+1

We now choose a uniform bound for b in y. Let

where π(Σ) is the projection onto Rn of the target Σ. We require that

For this to be well deﬁned we need the right hand side to be positive, which means

yn+1 >

∆√
κ2 − 1

for all (y, yn+1) ∈ Σ.

So we assume that the target satisﬁes the condition
∆√
κ2 − 1.

Y=(y,yn+1)∈Σ

yn+1 >

(2.14)

inf

We can now deﬁne refractor as follows.
Deﬁnition 2.1. Let ∆ be deﬁned by (2.12) and assume (2.14). The function u : Ω →
(0, +∞) is a refractor from Ω to Σ if for each x0 ∈ Ω there exists Y = (y, yn+1) ∈ Σ and
+ ∆2 such that u(x) ≥ φY,b(x) for all x ∈ Ω with equality at

0 < b < κ yn+1 − (cid:113)

y2
n+1

x = x0.

8

F. ABEDIN, C. E. GUTI ´ERREZ, AND G. TRALLI

2.3. Structural Assumptions on the Target. From here onwards, we will assume
that Ω is convex, and Σ ⊂ Rn × [τ1, τ1 + ω] for positive constants τ1, ω; with τ1 to
∆√
be chosen in a moment. Let τ2 = τ1 + ω. By (2.14), we require τ1 >
κ2 − 1
. We
assume that the graph of our refractor u is contained in the cylindrical region

CΩ = Ω × [0, τ0]
(cid:26)

for some 0 < τ0 < τ1, that is, u : Ω → [0, τ0]; see Figure 3 in the Appendix. Let us
also suppose the following compatibility condition:
κ∆
κ − 1

τ1 ≥ max

κτ0, τ0 +

(2.15)

(cid:27)

.

In Appendix 6, we show under this conﬁguration the existence of such a refrac-
tor. More precisely, we will prove that, for any κ > 1, ∆ > 0, ω > 0, one can choose
τ1 > 0, suﬃciently large, and 0 < τ0 < τ1, both depending only on κ, ∆ and ω, such
that (2.15) holds and there exists a refractor u in the sense of Deﬁnition 2.1; see
Theorem 6.1 and the comment afterwards. In addition, the refractor constructed
there satisﬁes the energy condition (6.17).

Since n1 > n2, total reﬂection can occur, [BW59, Section 1.5.4]. To avoid this, we

require that the target Σ satisﬁes

en+1 · Y − X

|Y − X| ≥ n2

∀X ∈ CΩ, Y ∈ Σ.

(2.16)
This means the following: if for each X ∈ CΩ we consider the upward cones CX
with vertex at X and opening φ := arccos(n2/n1), then (2.16) is equivalent to say
that Σ ⊂ ∩X∈CΩ
CX. If X = (x, xn+1) ∈ CΩ, then 0 ≤ xn+1 ≤ τ0, and since the cones are
vertical, we have C(x,τ0) ⊂ CX. Therefore

n1

∩x∈ΩC(x,τ0) ⊂ ∩X∈CΩ

CX.

If we assume Σ ⊂ ∩x∈ΩC(x,τ0) := S, then (2.16) holds choosing Ω appropriately. For
example, if Ω = Br(x0) and we look at the cones C(x,τ0) with x ∈ Br(x0), we see that
the set S is a cone with the same opening φ and vertex at the point (x0, τ0 + h), with
h = r tan(π/2− φ) = r
cos φ
. If we choose r suﬃciently small such that
sin φ
< τ1, then S intersected with the slab Rn × [τ1, τ1 + ω] is
1√
τ0 + h = τ0 + r
κ2 − 1
non-empty. Therefore, taking a target Σ ⊂ S ∩ Rn × [τ1, τ1 + ω], there is no total
reﬂection, that is, condition (2.16) holds and Σ satisﬁes the previous structural
assumptions.

1√
κ2 − 1

= r

C1,α ESTIMATES FOR THE PARALLEL REFRACTOR

9

2.4. Derivative Estimates for Hyperboloids. Let us ﬁrst observe that hyper-
boloids are uniformly Lipschitz hypersurfaces. Indeed, a direct calculation shows
that

Therefore,

Dxφ(x, Y, X0) =

(cid:12)(cid:12)(cid:12)Dxφ(x, Y, X0)

(cid:12)(cid:12)(cid:12) ≤ min

y − x

(cid:112)
c(X0, Y)2 + (κ2 − 1)|x − y|2
(cid:40) |y − x|

(cid:41)

.

≤

1√
κ2 − 1

.

(2.17)

1√
κ2 − 1
Hence, by the deﬁnition of refractor, we conclude that
(2.18) u(x2)−u(x1) ≤ φ(x2, Y, X2)−φ(x1, Y, X2) ≤

c(X0, Y)

,

1√
κ2 − 1

|x2−x1|

for all x1, x2 ∈ Ω.

If we interchange the roles of x1 and x2, we get a uniform Lipschitz bound for the
refractors.

The above argument suggests that obtaining higher derivative estimates for φ
will allow us to obtain higher derivative estimates for u. We calculate below the
relevant derivatives of φ that will be used. Fix (x, Y, X0) ∈ Ω × Σ × CΩ, and put
xn+1 = φ(x).

c(X, Y) = −κ − (xn+1 − yn+1)
|X − Y|

∂

∂xn+1

and

thus

∂φ
∂x0

n+1

For the derivative in x0

n+1, we notice that

−

∂x0

∂xn+1

κ2 − 1

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12) ≤ κ + 1. From (2.6)
(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)∂c(X, Y)
(cid:19) ∂c(X0, Y)
(x, Y, X0) = −(cid:18) κ
(cid:18) κ
(cid:32)c(X0, Y)2
(cid:19)
(cid:18) κ
(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12) ≤
≤(cid:20)(cid:18) κ

(κ2 − 1)2

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12) ∂φ

κ2 − 1

(x, Y, X0)

= −

(cid:19)
(cid:19)

∂x0

n+1

n+1

+

+

+

κ2 − 1
κ2 − 1

(cid:32)c(X0, Y)2
(cid:21)
(κ2 − 1)2
1
κ2 − 1

and so we get

(2.19)

(cid:32)c(X0, Y)2

(κ2 − 1)2
|x − y|2
κ2 − 1

+

(cid:33)− 1

+

|x − y|2
(cid:33)− 1
κ2 − 1
2 c(X0, Y)
(κ2 − 1)2
(cid:33)− 1

|x − y|2
κ2 − 1

+

2 c(X0, Y)
(κ2 − 1)2

(κ + 1) =

κ + 1
κ − 1

.

∂c(X0, Y)

n+1

∂x0

,

∂x0

2 c(X0, Y)
(κ2 − 1)2

 ∂c(X0, Y)
(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)∂c(X0, Y)

∂x0

n+1

n+1

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

10

F. ABEDIN, C. E. GUTI ´ERREZ, AND G. TRALLI

Next we calculate the second derivatives and get, for i, j = 1, . . . , n, that

(2.20)

∂2φ
∂xi∂xj
= − 1
κ2 − 1

This gives

+

(x, Y, X0) =

(κ2 − 1)2

(cid:32)c(X0, Y)2
(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12) ∂2φ

∂xi∂xj

(cid:33)− 3
2(cid:40)

(cid:32)c(X0, Y)2

+

δij

|x − y|2
κ2 − 1

(κ2 − 1)2

|x − y|2
κ2 − 1
(cid:112)
c(X0, Y)2 + (κ2 − 1)|x − y|2

2

≤

(2.21)

(x, Y, X0)

2

.

c(X0, Y)

(cid:33)

(cid:41)

.

− (xi − yi)(xj − yj)

κ2 − 1

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12) ≤
(cid:112)

∂2φ
∂xi∂yj

The mixed second derivatives in x and Y are, for i = 1, . . . n and j = 1, . . . , n + 1,

=

+

2

δij

∂
∂yj

(x, Y, X0) =

yi − xi

 =

c(X0, Y)2 + (κ2 − 1)|x − y|2
(cid:18)


(cid:0)c(X0, Y)2 + (κ2 − 1)|x − y|2(cid:1) 1
− (yi − xi)
(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12) ≤ c(X0, Y)2 + (κ + 1)|x − y|c(X0, Y) + 2(κ2 − 1)|x − y|2
c(X, Y) = κδj,n+1 − (yj−xj)
2 + 1

(cid:0)c(X0, Y)2 + (κ2 − 1)|x − y|2(cid:1) 3
|X−Y| , we have | ∂
(cid:0)c(X0, Y)2 + (κ2 − 1)|x − y|2(cid:1) 3
(cid:114)κ + 1


(cid:19)
c(X0, Y) + (κ2 − 1)(yj − xj)(1 − δj,n+1)

c(X, Y)| ≤ κ + 1. Therefore,

c(X0, Y) ∂
∂yj

(x, Y, X0)

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12) ∂2φ

∂xi∂yj

≤

∂yj

2

1

.

c(X0, Y)

κ − 1

2

2

.

Since ∂
∂yj

(2.22)

It is evident from the above calculations that in order to bound the derivatives
of φ in a uniform manner, we must obtain a positive lower bound for c(X, Y) when
X ∈ CΩ and Y ∈ Σ. For this, we will use the structural assumption (2.15). In fact,
c(X, Y) = κ(yn+1 − xn+1) − |X − Y| ≥ κ(yn+1 − xn+1) −(cid:113)
let X = (x, xn+1) ∈ CΩ and Y = (y, yn+1) ∈ Σ. Since |x − y| ≤ ∆, we ﬁrst have
Next, if we let ψ(t) = κt − √
≥
κ − 1 > 0. Thus, ψ(t) ≥ −∆ + (κ − 1)t for all t ≥ 0. It then follows that if γ > 0 is
given, we have

∆2 + (yn+1 − xn+1)2.
t√
∆2+t2

∆2 + t2, then ψ(0) = −∆ < 0 and ψ(cid:48)

(t) = κ −

(2.23)

inf

X∈CΩ,Y∈Σ

(yn+1 − xn+1) ≥ γ + ∆
κ − 1

⇒ inf
X∈CΩ,Y∈Σ

c(X, Y) ≥ γ.

C1,α ESTIMATES FOR THE PARALLEL REFRACTOR

11

From (2.15), we get

(2.24)

τ1 − τ0 ≥ κ∆
κ − 1

= (κ − 1)∆ + ∆

κ − 1

inf

X∈CΩ,Y∈Σ

(yn+1 − xn+1) ≥ τ1 − τ0, we then obtain that γ = (κ − 1)∆ is a lower
Since
bound for c(X, Y). Clearly, this bound yields uniform bounds in (2.21) and (2.22),
as well as for higher order derivatives.

We explicitly remark that the ﬁrst order derivative bound in (2.17) is indepen-
dent of the bounds for c, and thus independent of the compatibility assumptions.
It depends just on the fact that the relevant supporting objects in our problem are
hyperboloids, and it gives automatically global Lipschitz bounds for the refractor.
This is in strong contrast with the case κ < 1 considered in [GT15]. In fact, the
supporting objects in [GT15] are ellipsoids and to obtain global Lipschitz bounds
for them a condition between Ω and Σ is needed, see [GT15, Section 2.3].

The derivative bounds and the properties of hyperboloids also imply the fol-

lowing estimates, which will be used in Section 5.
Lemma 2.2. Let ¯X ∈ CΩ, Y ∈ Σ, x0 ∈ Ω. Let also X0 = (x0, φ(x0, Y, ¯X)), and assume
∗
X
0

= (x0, φ(x0, Y, ¯X) + h) ∈ CΩ for some positive h. Then

0 ≤ φ(x, Y, X

c(X0, Y) = −(cid:18)

Proof. We recall that c(X0, Y) = κ(yn+1 − x0
< 0. Therefore,
∂x0

κ − yn+1−x0
|Y−X0|

n+1

n+1

0) − φ(x, Y, X0) ≤ κ + 1
∗
κ − 1
(cid:19)
n+1) − |X0 − Y|. Since κ > 1 we have

for all x ∈ Ω.

h

− κ

(cid:32)c(X0, Y)2

−

(cid:33)− 1

|x − y|2
κ2 − 1

+

(κ2 − 1)2

κ2 − 1
c(X0, Y) > 0.
0)− φ(x, Y, X0) ≥ 0. For the upper bound we have, for some
∗

n+1

2 c(X0, Y)
(κ2 − 1)2

 ∂x0

∂x0

n+1

φ(x, Y, X0) =

It follows that φ(x, Y, X
˜X ∈ [X0, X

∗
0], that

φ(x, Y, X

0) − φ(x, Y, X0) = ∂x0
∗

n+1

φ(x, Y, ˜X)h ≤ κ + 1
κ − 1

h,

where in the last inequality we have used (2.19).

(cid:3)

The following lemma can be proved verbatim as in [GT15, Lemma 2.3].
Lemma 2.3. There exists C > 0 such that for all Y, ¯Y ∈ Σ and X0 ∈ CΩ, we have

|φ(x, Y, X0) − φ(x, ¯Y, X0)| ≤ C|x − x0||Y − ¯Y|.

12

F. ABEDIN, C. E. GUTI ´ERREZ, AND G. TRALLI

3. Regularity assumptions on the target

We assume the following assumptions on the target Σ.
3.1. Parametrization of the target. Let us assume that each Y ∈ Σ can be rep-
resented in the form Y = X + sX(Λ)Λ for each X ∈ CΩ, with |Λ| = 1 and sX(Λ)
Lipschitz as a function of Λ.
The Lipschitz character of sX, together with (2.4) and the estimate (2.22), implies
that for any X0 ∈ CΩ there exists C = C(X0) ≥ 1 such that
| ¯Y − ˆY| ≤ | ¯v − ˆv| ≤ C| ¯Y − ˆY|
(3.1)
for all ¯Y, ˆY ∈ Σ, ¯v, ˆv ∈ Rn, ¯s, ˆs > 0 satisfying ¯Y = X0 + ¯sΛ( ¯v) and ˆY = X0 + ˆsΛ( ˆv), see
[GT15, Lemma 2.1].
3.2. Regularity of the target. Given ¯Y, ˆY ∈ Σ and X0 ∈ CΩ, let ¯v = Dxφ(x0, ¯Y, X0),
ˆv = Dxφ(x0, ˆY, X0). Let us consider

1
C

C(X0, ¯Y, ˆY) = {X0 + sΛ(v(λ)) : s > 0, v(λ) = (1 − λ) ¯v + λ ˆv for λ ∈ [0, 1]} .

From (2.4), we know that if Y(λ) = X0 + sΛ(v(λ)) ∈ C(X0, ¯Y, ˆY), then v(λ) =
Dxφ(x0, Y(λ), X0). Deﬁne

[ ¯Y, ˆY]X0 := Σ ∩ C(X0, ¯Y, ˆY).

By the parametrization of the target and (3.1), each X0 + sΛ(v(λ)) ∈ C(X0, ¯Y, ˆY)
intersects Σ in at most one point for each λ ∈ [0, 1]. The points in [ ¯Y, ˆY]X0 have the
form Y(λ) = X0 + sX0(Λ(v(λ)))Λ(v(λ)) for λ ∈ [0, 1].
Deﬁnition 3.1. Fix X0 ∈ CΩ. We say the target Σ is regular from X0 if there exists
a neighborhood UX0 and C1, C2 > 0 depending on UX0 such that, for all ¯Y, ˆY ∈ Σ and
Z = (z, zn+1) ∈ UX0, we have
(3.2)
for all x ∈ Ω with |x − z| ≤ C2, λ ∈ [ 1
The following characterization of the regularity from a point in CΩ can be
proved exactly as in [GT15, Theorem 3.2].
Theorem 3.2. The target Σ is regular from X0 ∈ CΩ if and only if there exists a
neighborhood UX0 and C(X0) > 0 such that, for all Y0 ∈ Σ, Z ∈ UX0 and for all ξ, η ∈ Rn
with ξ ⊥ η, we have

(cid:110)φ(x, ¯Y, Z), φ(x, ˆY, Z)

(cid:111) − C1| ¯Y − ˆY|2|x − z|2

, 3
4] and YZ(λ) = Z + sZ(Λ(v(λ)))Λ(v(λ)).

φ(x, YZ(λ), Z) ≤ max

4

φ(x0, Y, X0)η, η(cid:69) ≥ C(X0)|ξ|2|η|2

(3.3)

d2
d2

(cid:68)

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)=0

D2
x

C1,α ESTIMATES FOR THE PARALLEL REFRACTOR

13

where Y = Z + sZ(Λ(v + ξ))Λ(v + ξ) and v = Dxφ(z, Y0, Z).

The theorem above follows from [GT15, Theorem 3.2] since the proof of that
theorem does not rely on the particular structure of the function φ nor on the size
of the refractive index κ. Indeed, the condition (3.2) is satisﬁed by the negative of
the function in [GT15, Theorem 3.2], and so the condition (3.3) has the opposite
sign as well.

Let us end this section with some clarifying remarks. The set [ ¯Y, ˆY]X0 mimics
the notion of a c-segment in the theory of optimal mass transport (cf. [Vil09]),
while the condition (3.3) is akin to the Ma-Trudinger-Wang condition (A3) in the
regularity theory of optimal transport maps (cf. [MTW05], [Vil09]). A watershed
for the regularity theory of mass transport is the result of Loeper [Loe09], which
shows the condition (A3) is equivalent to a maximum principle for c-support
functions. This forms the motivation for the regularity hypothesis (3.2) and the
theorem above is the analog of this characterization for the case of the parallel
refractor.

4. Local to Global

Loeper’s maximum principle allowed him to obtain a result which Kim and Mc-
Cann [KM10] refer to as the DASM (Double-Mountain Above Sliding-Mountain)
Theorem in the context of optimal mass transport. This in turn enabled Loeper
to obtain a local-implies-global result for c-support functions. This section is de-
voted to establishing the analog of this local-implies-global result in the setting
of the parallel refractor. We refer the reader to the end of this section for further
comments.
We say that the target Σ satisﬁes condition (AW) from X0 ∈ CΩ if for all Y0 ∈ Σ
written as Y0 = X0 + sX0(Λ(v))Λ(v), and for all ξ ⊥ η, we have
(AW)

(cid:68)

D2
x

where Y = X0 + sX0(Λ(v + ξ))Λ(v + ξ), and v = Dxφ(x0, Y0, X0). Equivalently, if
Y(v) = X0 + sX0(Λ(v))Λ(v), then the condition (AW) requires that for all ξ ⊥ η, we
have

Dv(cid:96),vk

Dxi,xj

φ(x0, Y(v), X0)ηiηj

d2
d2

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)=0
(cid:104)

(cid:88)

i,j,k,l

φ(x0, Y, X0)η, η(cid:69) ≥ 0,
(cid:105) ξkξ(cid:96) ≥ 0.
φ(x, Y, X)η, η(cid:69)

(cid:68)

D2
x

Let us put H(v, X) = sX(Λ(v))Q(v), where we recall that Λ(v) = (Q(v)v,−Q(v) + κ)
. By (2.20), for |η| = 1,
as deﬁned in (2.1). We denote J(Y, X, η) =

14

F. ABEDIN, C. E. GUTI ´ERREZ, AND G. TRALLI

2

+

(cid:33)− 3

(κ2 − 1)2

(κ2 − 1)2

|x − y|2
κ2 − 1

(cid:32) c(X, Y)2

 c(X, Y)2

 .
(cid:10)x − y, η(cid:11)2
−1 +(κ2−1)(cid:10)x − y, η(cid:11)2 (κ|X−Y|−(yn+1−xn+1))

we have
J(Y, X, η) = − 1
κ2 − 1
Since c(X, Y)2 + (κ2 − 1)|x − y|2 = (κ|X − Y| − (yn+1 − xn+1))2, we obtain
J(Y, X, η) = −(κ|X−Y|−(yn+1−xn+1))
If Y − X = sX(Λ(v))(Q(v)v,−Q(v) + κ), then |Y − X| = sX(Λ(v)), and so
κ|X − Y| − (yn+1 − xn+1) = κsX(Λ(v)) + sX(Λ(v))Q(v) − κsX(Λ(v)) = sX(Λ(v))Q(v).
Hence,

|x − y|2
κ2 − 1

κ2 − 1

−

+

−3.

(4.1)
sX(Λ(v))Q(v)
Now if v = v + ξ, then we can write Y − X = sX(Λ(v))(Q(v)v,−Q(v) + κ).
Recalling that |Y − X| = sX(Λ(v)), we therefore obtain

J(Y, X, η) = (κ2 − 1)(cid:10)v, η(cid:11)2 − 1
= (κ2 − 1)(cid:10)v, η(cid:11)2 − 1

.

H(v, X)

d2
d2

sX(Λ(v))Q(v)

F(v, X, η) ≥ 0.

J(Y, X, η) = (κ2 − 1)(cid:10)v, η(cid:11)2 − 1
(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)=0
(cid:16)
(κ2 − 1)(cid:10)v, η(cid:11)2 − 1
(cid:104)
(cid:105)
(κ2 − 1)(cid:10)v, η(cid:11)2 − 1
(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)=0
(cid:104)
(κ2 − 1)(cid:10)v, η(cid:11)2 − 1

F(v, X, η) =

F(v, X, η) =

d2
d2

d
d

(cid:17)

−1, we see that
G(v, X).

= 2(κ2 − 1)(cid:10)v, η(cid:11)(cid:10)ξ, η(cid:11) = 0.
vG(v, X)ξ, ξ(cid:69) .

(cid:105)(cid:68)

D2

On the other hand, by setting G(v, X) = H(v, X)

Notice that if ξ ⊥ η, then

It follows that

(4.2)
strictly less than 1). Thus, (κ2 − 1)(cid:10)v, η(cid:11)2 − 1 < 0 for all v and |η| = 1. Therefore,
By the derivative estimate (2.17) for φ(x, Y, X), we have |v| ≤ 1√
κ2−1
the condition (AW) implies G(·, X) is a positive concave function for each X.
Theorem 4.1. Suppose that the condition (AW) holds from some X0 ∈ CΩ. Let ¯Y, ˆY ∈ Σ
be given by ¯Y = X0 + sX0(Λ( ¯v))Λ( ¯v) and ˆY = X0 + sX0(Λ( ˆv))Λ( ˆv). For λ ∈ (0, 1),

(actually it is

The condition (AW) is then equivalent to

=: F(v, X, η).

C1,α ESTIMATES FOR THE PARALLEL REFRACTOR

15

(cid:110)
(cid:111)
let vλ = (1 − λ) ¯v + λ ˆv, and deﬁne Yλ = X0 + sX0(Λ(vλ))Λ(vλ). Denoting H(Y) =
X ∈ Rn+1 : c(X, Y) ≥ c(X0, Y)

In particular, for all x ∈ Ω,

, then
H(Yλ) ⊆ H( ¯Y) ∪ H( ˆY).

φ(x, Yλ, X0) ≤ max

(cid:110)φ(x, ¯Y, X0), φ(x, ˆY, X0)
(cid:111) .

Proof. Assume for simplicity X0 = 0. Let us ﬁrst make note of the following:

(4.3)

c(X, Z) ≥ c(0, Z) ⇔ κ(zn+1 − xn+1) − |X − Z| ≥ κzn+1 − |Z|

⇔ |X − Z| ≤ |Z| − κxn+1
⇒ |X|2 − 2X · Z + |Z|2 ≤ |Z|2 − 2κxn+1|Z| + κ2x2
⇒ |X|2 − κ2x2

≤ 2X · Z − 2κxn+1|Z|.

n+1

n+1

We notice that the set bdryH( ˆY) ∩ bdryH(Yλ) is contained in a hyperplane ˆT.
Indeed, if X ∈ bdryH( ˆY)∩ bdryH(Yλ), then c(X, ˆY) = c(0, ˆY) and c(X, Yλ) = c(0, Yλ).
Applying (4.3) in the case of equality with Z = ˆY and Z = Yλ, we obtain

Hence,

We can rewrite this as X · ˆη = 0, where

|X|2 − κ2x2
|X|2 − κ2x2

n+1

n+1

= 2X · ˆY − 2κxn+1| ˆY|;
= 2X · Yλ − 2κxn+1|Yλ|.

X · ˆY − κxn+1| ˆY| = X · Yλ − κxn+1|Yλ|.

ˆη = ( ˆY − κ| ˆY|en+1) − (Yλ − κ|Yλ|en+1).

In conclusion, X ∈ bdryH( ˆY) ∩ bdryH(Yλ) implies X · ˆη = 0. Analogously, if
X ∈ bdryH( ¯Y) ∩ bdryH(Yλ), then X · ¯η = 0 where

¯η = ( ¯Y − κ| ¯Y|en+1) − (Yλ − κ|Yλ|en+1).

Recall that any Y ∈ Σ is given by Y = s0(Λ(v))Λ(v). Denoting H(v) := H(v, 0) =
s0(Λ(v))Q(v), we may rewrite ˆη and ¯η as the (n + 1)-vectors

ˆη = (H( ˆv) ˆv − H(vλ)vλ, H(vλ) − H( ˆv)), ¯η = (H( ¯v) ¯v − H(vλ)vλ, H(vλ) − H( ¯v)).

This is because the ﬁrst n components of Y are given by the vector H(v)v, while
the (n + 1)-st component is given by Yn+1 = |Y|(−Q(v) + κ), since |Λ(v)| = 1.
Hence, Yn+1 − κ|Y| = −|Y|Q(v). Since H(v) = s0(Λ(v))Q(v) = |Y|Q(v), it follows that
Yn+1 − κ|Y| = −H(v). Let us now prove a couple of claims.

16

F. ABEDIN, C. E. GUTI ´ERREZ, AND G. TRALLI

(1) Suppose X ∈ H(Yλ). Then

X · ˆη ≥ 0 ⇒ X ∈ H( ˆY),
X · ¯η ≥ 0 ⇒ X ∈ H( ¯Y).

As a matter of fact, since X ∈ H(Yλ), we have c(X, Yλ) ≥ c(0, Yλ), which
implies by (4.3)

|X|2 − 2X · Yλ + 2κxn+1|Yλ| − κ2x2

≤ 0.

n+1

If X · ˆη ≥ 0, we then have

X · (Yλ − ˆY) − κxn+1(|Yλ| − | ˆY|) ≤ 0.

The last two inequalities give

|X|2 − 2X · ˆY + 2κxn+1| ˆY| − κ2x2

≤ 0.

n+1

In particular, this implies |X− ˆY|2 ≤ (| ˆY|− κxn+1)2. We want to conclude that
|X − ˆY| ≤ | ˆY| − κxn+1. This is possible thanks to the structural assumption
(2.15). In fact, for any Y ∈ Σ and X = (x, xn+1) ∈ CΩ, we have

|Y| − κxn+1 ≥ yn+1 − κxn+1 ≥ τ1 − κτ0 ≥ 0.

This gives |X − ˆY| ≤ | ˆY| − κxn+1, which implies c(X, ˆY) ≥ c(0, ˆY). Thus,
assuming X · ˆη ≥ 0, we have X ∈ H( ˆY), and the ﬁrst implication is proved.
The proof of the second implication we claimed is completely analogous.

Let us note that so far, we have not used the condition (AW), which we have
1
H(v). We will now use this fact in the
shown to be equivalent to the concavity of
proof of the following claim.

(2) If X · ˆη < 0 and X · ¯η < 0, then X (cid:60) H(Yλ).

Assume X · ˆη < 0 and X · ¯η < 0. Notice that

H(Yλ)\{0} ⊂(cid:110)
(cid:32)

1 − t

(cid:111) ,
(cid:33)

X ∈ Rn+1 : X · Nλ > 0
(cid:33)

(cid:32)

t

H( ˆv) − H(vλ)

ˆη.

Nλ =

H( ¯v) − H(vλ)

¯η +

where Nλ = (vλ,−1). Hence, it is enough to show that X · Nλ ≤ 0. First
assume H(vλ) − H( ¯v) (cid:44) 0 and H(vλ) − H( ˆv) (cid:44) 0. We will show that

C1,α ESTIMATES FOR THE PARALLEL REFRACTOR

17

1−t

≥ 0 for some t. By comparing the ﬁrst n
with
components of ¯η and ˆη, we ﬁnd that the above equality holds if and only if

H( ¯v)−H(vλ)

t

H( ˆv)−H(vλ)

≥ 0 and
vλ = (1 − t)(H( ¯v) ¯v − H(vλ)vλ)
(cid:32)
H( ¯v) − H(vλ)
vλ + H( ¯v)( ¯v − vλ)
(cid:40) (1 − t)λH( ¯v)
= (1 − t)
H( ¯v) − H(vλ)

⇔ ( ˆv − ¯v)

H(vλ) − H( ¯v)
Therefore, we choose t such that
(1 − t)λH( ¯v)
H(vλ) − H( ¯v)

(cid:33)

+ t

+ t(H( ˆv) ˆv − H(vλ)vλ)
(cid:33)
(cid:32)
H( ˆv) − H(vλ)
vλ + H( ˆv)( ˆv − vλ)
(cid:41)
H( ˆv) − H(vλ)
− t(1 − λ)H( ˆv)
H(vλ) − H( ˆv)
= 0.
= t(1 − λ)H( ˆv)
H(vλ) − H( ˆv)

.

t

t

Since Q(v) > 0, we have λH( ¯v) > 0 and (1 − λ)H( ˆv) > 0. It follows that
(1−t)
H(vλ)−H( ¯v) and
H(vλ)−H( ˆv) have the same sign. From the last identity, we also
obtain

H(vλ)−H( ˆv)

H(vλ) − H( ˆv)

≤ 0 and thus

{H(vλ)((1 − λ)H( ˆv) + λH( ¯v)) − H( ¯v)H( ˆv)} .

λH( ¯v) =
By the concavity of 1/H, we have H(vλ)((1−λ)H( ˆv) +λH( ¯v))−H( ¯v)H( ˆv) ≤ 0.
Hence,
Now consider the case H(vλ) − H( ˆv) = 0 and H(vλ) − H( ¯v) (cid:44) 0. From the
concavity of 1/H, we have H(vλ) < H( ¯v). If we write Nλ =
H(vλ)−H( ¯v) ¯η + t ˆη,
then t =
Finally, the last case to consider is H(vλ) = H( ¯v) = H( ˆv). In such case
¯η = λH( ¯v)( ˆv − ¯v, 0) and ˆη = (1 − λ)H( ¯v)( ¯v − ˆv, 0), and so both inequalities
X · ˆη < 0 and X · ¯η < 0 cannot hold simultaneously.

(H(vλ)−H( ¯v))(1−λ)H( ˆv), and so t < 0.

≤ 0 as well.

H(vλ)−H( ¯v)

(1−t)

λH( ¯v)

1

t

The above claims complete the proof of the theorem. Indeed, by the second
claim, if X ∈ H(Yλ), then either X · ˆη ≥ 0 or X · ¯η ≥ 0. Hence, it follows from the
ﬁrst claim that X ∈ H( ˆY) or X ∈ H( ¯Y).
(cid:3)
For a function u : Ω → [0, τ0], x0 ∈ Ω, X0 = (x0, u(x0)), the refractor-normal map
is deﬁned as

(cid:110)

(cid:111) .
Y ∈ Σ : u(x) ≥ φ(x, Y, X0) ∀x ∈ Ω

Fu(x0) =

(4.4)
By Deﬁnition 2.1, u is a parallel refractor if Fu(x0) (cid:44) ∅ for all x0 ∈ Ω.
The next result applies the previous theorem to show that a locally supporting
hyperboloid is in fact a globally supporting one under the condition (AW). The

18

F. ABEDIN, C. E. GUTI ´ERREZ, AND G. TRALLI

proof is similar to that of [GT15, Proposition 4.2]; we provide all the details for
the convenience of the reader.

Theorem 4.2. Suppose u is a parallel refractor in Ω that satisﬁes the condition (AW)
from X0 = (x0, u(x0)), with x0 ∈ Ω.
If there exists Y0 ∈ Σ and  > 0 such that
u(x) ≥ φ(x, Y0, X0) for all x ∈ B(x0), then u(x) ≥ φ(x, Y0, X0) for all x ∈ Ω.
Proof. Denote the refractor by R = {(x, u(x)) : x ∈ Ω}, and let Y(X, v) := X +
sX(Λ(v))Λ(v) where X ∈ R. Consider the local sub diﬀerential

∂u(x0) = {v ∈ Rn : u(x) ≥ u(x0) + v · (x − x0) + o(|x − x0|)} .

Notice that if u(x) ≥ φ(x, Y0, X0) for all x ∈ B(x0), then Y0 ∈ {Y(X0, v) : v ∈ ∂u(x0)}.
Indeed, by using the Taylor expansion of φ around x0, we obtain

u(x) ≥ φ(x, Y0, X0) = φ(x0, Y0, X0) + Dxφ(x0, Y, X0) · (x − x0) + o(|x − x0|)

= u(x0) + Dxφ(x0, Y, X0) · (x − x0) + o(|x − x0|).

(4.5)
It follows that v0 := Dxφ(x0, Y, X0) ∈ ∂u(x0). By (2.4), we recall that v = Dxφ(x, Y, X)
with Y ∈ Σ if and only if Y = Y(X, v). Therefore, Y0 = Y(X0, v0) with v0 ∈ ∂u(x0) as
claimed.

We will now show that under the condition (AW), we have the inclusion

(4.6)
This will immediately imply Y0 ∈ Fu(x0) and conclude the proof. Let us ﬁrst
observe that the above inclusion is equivalent to showing

{Y(X0, v) : v ∈ ∂u(x0)} ⊂ Fu(x0).
(cid:111)
Dxφ(x0, Y, X0) : Y ∈ Fu(x0)

∂u(x0) ⊂(cid:110)

=: Bx0

.

(4.7)

To this end, we are going to show that the extremal points of ∂u(x0) are contained
in Bx0 and that Bx0 is convex. The convexity of ∂u(x0) will then conclude the proof.
Let v0 ∈ ∂u(x0) be an extremal point. Then there exists a sequence xn → x0
with u diﬀerentiable at xn and vn = Du(xn) → v0. Let Xn = (xn, u(xn)), and let
Yn ∈ Fu(xn). Since u is diﬀerentiable at xn, it follows that Yn = Y(Xn, vn). By
compactness of Σ, we may assume Yn → Y0 ∈ Σ. We claim Y0 = Y(X0, v0).
Indeed, u(x) ≥ φ(x, Yn, Xn) for all x ∈ Ω with equality at x = xn, so by letting
n → ∞, we obtain u(x) ≥ φ(x, Y0, X0) for all x ∈ Ω, with equality at x = x0.
Note here that we are also using the continuity of u, since Xn = (xn, u(xn)) →
(x0, u(x0)) =: X0. Furthermore, vn = Du(xn) = Dxφ(xn, Yn, Xn), so since φ is smooth
(as a function of the variables (x, Y, X)) and vn → v0, it follows that v0 = lim
n→∞ vn =

C1,α ESTIMATES FOR THE PARALLEL REFRACTOR

19

n→∞ Dxφ(xn, Yn, Xn) = Dxφ(x0, Y0, X0). Combining all this, we conclude that Y0 ∈
lim
Fu(x0) and Dxφ(x0, Y0, X0) = v0, which shows Y0 = Y(X0, v0) and v0 ∈ Bx0.
On the other hand, to show that Bx0 is convex, let Y1, Y2 ∈ Fu(x0) and let
vi = Dxφ(x0, Yi, X0) for i = 1, 2. Consider vλ = (1− λ)v1 + λv2 and let Yλ = Y(X0, vλ).
Since vλ = Dxφ(x0, Yλ, X0), we have by the condition (AW) and Theorem 4.1 that
for all x ∈ Ω,

(cid:110)φ(x, Y1, X0), φ(x, Y2, X0)

(cid:111) ≤ u(x).

φ(x, Yλ, X0) ≤ max

Hence Yλ ∈ Fu(x0) and Bx0 is convex.
(cid:3)
The proof is thus complete.
Let us make another comparison with optimal mass transport. The set Bx0 is
the analog of the c-subdiﬀerential ∂cu(x0) (cf.
[Vil09]) in the theory of optimal
mass transport. The inclusion ∂cu(x0) ⊂ ∂u(x0) is immediate from the deﬁnition of
the c-subdiﬀerential. The equality of the sets is obtained only after assuming the
weak form of the condition (A3) and establishing Loeper’s DASM theorem. In
⊂ ∂u(x0) also follows from the
the case of the parallel refractor, the inclusion Bx0
deﬁnition of parallel refractor, as illustrated above in (4.5). The above analog of the
DASM theorem thus shows that under the condition (AW), we have the equality
∂u(x0) = Bx0 for all x0 ∈ Ω, which is the analog of the equality ∂cu(x0) = ∂u(x0)
under the weak (A3) condition in the theory of optimal mass transport.

5. Main results

Lemma 5.1. If u is a parallel refractor, then there exists a structural positive constant C
such that

u((1 − s) ¯x + s ˆx) ≤ (1 − s)u( ¯x) + su( ˆx) + Cs(1 − s)| ¯x − ˆx|2

for each ¯x, ˆx ∈ Ω, and s ∈ [0, 1].
Proof. It can be proved following the arguments in [GT15, Lemma 5.1] by exploit-
ing (2.21) and the lower bound (2.23). The constant C may be chosen dependent
(cid:3)
only on the bound for D2
x

φ(x, Y, X).

The following lemma is crucial for the regularity of refractors, assuming Σ
regular from a point with respect to Deﬁnition 3.1. We omit the proof since it can
be completed proceeding as in [GT15, Lemma 5.2]. The main needed ingredients
for the proof are: the concavity of φ, the estimates (2.18)-(2.22), Lemma 2.2, Lemma
2.3, and Lemma 5.1.

20

F. ABEDIN, C. E. GUTI ´ERREZ, AND G. TRALLI

∗ =
Lemma 5.2. Suppose u is a parallel refractor and the target Σ is regular from X
such that if ¯x, ˆx ∈
∗
∗, u(x
(x
) and ¯Y ∈ Fu( ¯x), ˆY ∈ Fu( ˆx), and | ¯Y − ˆY| ≥ | ¯x − ˆx|, then there exists x0 ∈ [ ¯x, ˆx] such
∗
Bδ(x
∗
that if X
0

)). There exist positive constants δ, C1, C2 depending on X

= (x0, u(x0)), then

u(x) − φ(x, Y, X

0) ≥ −C| ¯Y − ˆY|| ¯x − ˆx| − C|Y(λ) − Y||x − x0| + C1| ¯Y − ˆY|2|x − x0|2,
∗
0, λ ∈ [ 1
for all Y(λ) ∈ [ ¯Y, ˆY]X∗
depends only the derivatives bounds of φ.

4], Y ∈ Σ and x ∈ Ω ∩ BC2(x0). The constant C above

, 3

∗

4

The following theorem represents the ﬁrst regularity-type result for refractors
we show in this paper. Let us remark that our compatibility conditions (2.15) play
a key role in the proof.
Here and in what follows we denote by Nµ(S) the µ-neighborhood of a set S.
∗
∗, u(x
Theorem 5.3. Suppose u is a parallel refractor and Σ is regular from X
)).
Let C, C1, C2, δ be from the previous lemma. Then there exists a constant M = M(C, C1)
such that if ˆx, ¯x ∈ B δ

∗ = (x

(x

∗

2

2 .

√

| ¯Y− ˆY|

2 , and η = M

∗
where X
0

C2 + 4C1C
C1

2| ¯x − ˆx| 1
(cid:32) | ¯x − ˆx|
(cid:33) 1
and suppose ¯Y ∈ Fu( ¯x) and ˆY ∈ Fu( ˆx) satisfy (5.1)
Proof. Let M = C +
with this choice of M. Deﬁne µ = | ¯Y − ˆY| 3
(cid:16)(cid:110)
(cid:105)(cid:111)(cid:17) ∩ Σ. Then there
.
Since | ¯Y − ˆY| ≥ | ¯x − ˆx|, the Lemma 5.2 applies. Let x0 be the point in that lemma
∗
and let X
4] such that |Y(λ)− Y| < µ. We already know we
exists Y(λ) ∈ [ ¯Y, ˆY]X∗
0
have the estimate

= (x0, u(x0)). Fix Y ∈ Nµ

2 and η = Mµ
| ¯Y − ˆY|2

0 : λ ∈(cid:104) 1

Y(λ) ∈ [ ¯Y, ˆY]X∗

0 with λ ∈ [ 1

2| ¯x − ˆx| 1

| ¯Y − ˆY|

= M

, 3
4

, 3

4

4

2

u(x) − φ(x, Y, X

0) ≥ −C| ¯Y − ˆY|| ¯x − ˆx| − Cµ|x − x0| + C1| ¯Y − ˆY|2|x − x0|2,
∗

(cid:40)

(cid:19)2

), ¯Y ∈ Fu( ¯x) and ˆY ∈ Fu( ˆx) satisfy
(cid:19)2(cid:41)
(cid:18)2M
(cid:21)(cid:27)(cid:19) ∩ Σ ⊂ Fu(Bη(x0)),

(cid:18)2M
0 : λ ∈(cid:20)1

| ¯x − ˆx|

C2

1,

δ

,

, 3
4

4

(cid:16) | ¯x− ˆx|

(cid:17) 1

| ¯Y − ˆY| ≥ max
(5.1)
then there exists x0 ∈ [ ¯x, ˆx] such that

(cid:18)(cid:26)
Y(λ) ∈ [ ¯Y, ˆY]X∗
= (x0, u(x0)), µ = | ¯Y − ˆY| 3

Nµ

(5.2)

C1,α ESTIMATES FOR THE PARALLEL REFRACTOR

21

2C1| ¯Y − ˆY|2
2 and η ≤ δ

for all |x − x0| < C2. Observe that the right-hand side of the above expression is
positive for all x ∈ Ω satisfying |x − x0| ≥ η as long as η satisﬁes the lower bound

(cid:113)
C2µ2 + 4CC1| ¯Y − ˆY|3| ¯x − ˆx|

.

Cµ +

η >

(cid:111)

∗

(x

, Y) : X ∈ Gu

∗
0

2. Since x0 ∈ B δ

2

), it follows that
∗
0) for

) ⊂ Ω, by the choice of δ in Lemma 5.2. Thus, u(x) > φ(x, Y, X

Our choice of M ensures that η satisﬁes such inequality.
Next, observe that by (5.1), η ≤ C2
all x ∈(cid:0)Ω ∩ BC2(x0)(cid:1)\Bη(x0).
Bη(x0) ⊂ Bδ(x
∗
We have to prove that Y ∈ Fu(Bη(x0)). By deﬁnition of X
∗
(cid:110)
0, we have u(x0) =
0). Let Gu denote the graph of u on BC2(x0) ∩ Ω, and consider σ :=
∗
φ(x0, Y, X
c(X, Y) − c(X
, where c(X, Y) = κ(yn+1 − xn+1)−|X− Y|. Since X
∈
∗
sup
Gu, we must have σ ≥ 0. We claim c(X, Y) − c(X
, Y) < 0 if X ∈ Gu and |x − x0| ≥ η.
0
∗
For x (cid:60) Bη(x0), let X = (x, u(x)) and X
0) for
x (cid:60) Bη(x0), it follows that X lies above X
c(X0, Y) < 0, it follows
that c(X, Y) < c(X
, Y) by deﬁnition, and so
the claim follows. Thus, the supremum σ is attained at some ˜X = ( ˜x, u( ˜x)) ∈ Gu
with ˜x ∈ Bη(x0). To conclude the proof, we are going to show that Y ∈ Fu( ˜x).
To do this, we ﬁrst show that, for all x ∈ Ω,
(5.3)

(cid:48), Y). On the other hand, c(X

∗
0)). Since u(x) > φ(x, Y, X

. Hence, since ∂x0
(cid:48), Y) = c(X
∗
0

κ(yn+1 − u(x)) ≥ c( ˜X, Y),

yn+1 − u(x) ≥

(cid:48) = (x, φ(x, Y, X

c( ˜X, Y).

and

∗
0

(cid:48)

n+1

κ

κ2 − 1

Clearly, the second inequality implies the ﬁrst. We want to explicitly remark that
that the structural assumption (2.15) allows us to obtain the second inequality. As
a matter of fact, noticing that

c( ˜X, Y) = κ(yn+1 − ˜xn+1) − | ˜X − Y| ≤ (κ − 1)(yn+1 − ˜xn+1),

we have

κ

κ2 − 1

c( ˜X, Y) ≤ κ
κ + 1

(yn+1 − ˜xn+1).

κ

(yn+1 − ˜xn+1) ≤ yn+1 − u(x), which implies the second inequality in

We claim
(5.3). Now, a simple rearrangement shows

κ + 1

(yn+1 − ˜xn+1) ≤ yn+1 − u(x) ⇔ κ(u(x) − ˜xn+1) ≤ yn+1 − u(x).

κ

κ + 1

Recall that ˜xn+1 = u( ˜x). Since κ > 1 and |x − ˜x| ≤ ∆, it follows from (2.18) that

|u(x) − ˜xn+1| = |u(x) − u( ˜x)| ≤ |x − ˜x|
κ2 − 1

√

≤ ∆
κ − 1

.

22

F. ABEDIN, C. E. GUTI ´ERREZ, AND G. TRALLI

By (2.15) we have τ1 − τ0 ≥ κ∆
κ − 1

, which then implies

, 3
4

4

(cid:115)

≤ τ1 − τ0 ≤ yn+1 − u(x).

κ(u(x) − ˜xn+1) ≤ κ∆
κ − 1
Therefore, the relations (5.3) are satisﬁed.
To conclude the proof, we have that c( ˜X, Y) ≥ c(X, Y) for all X ∈ Gu, that is,

(cid:113)|x − y|2 + (yn+1 − u(x))2 ≥ κ(yn+1 − u(x)) − c( ˜X, Y)

for all x ∈ Ω ∩ BC2(x0). By (5.3), the right-hand side of the above inequality is
non-negative, and so we get

|x − y|2 + (yn+1 − u(x))2 ≥ κ2(yn+1 − u(x))2 − 2κ(yn+1 − u(x))c( ˜X, Y) + c( ˜X, Y)2
⇔ |x − y|2
κ2 − 1
⇔ |x − y|2
κ2 − 1

≥ (yn+1 − u(x))2 − 2(yn+1 − u(x))
yn+1 − u(x) − κ
+ c( ˜X, Y)2
(κ2 − 1)2
κ2 − 1
Again by (5.3) we infer

(cid:19)2
c( ˜X, Y) + c( ˜X, Y)2
κ2 − 1

≥(cid:18)

κ2 − 1

c( ˜X, Y)

κ

.

2

∗

+

c( ˜X, Y) −

c( ˜X, Y)2
(κ2 − 1)2

u(x) ≥ yn+1 − κ
κ2 − 1

|x − y|2
κ2 − 1
= φ(x, Y, ˜X)
for all x ∈ Ω ∩ BC2(x0), with equality at x = ˜x. Since η ≤ C2
2 and ˜x ∈ Bη(x0), we
( ˜x) ⊂ BC2(x0). Recall that by our choice of δ, we have the inclusions
have B C2
Bη(x0) ⊂ Bδ(x
) ⊂ Ω and so B( ˜x) ⊂ Ω for all  > 0 suﬃciently small. Hence, we
obtain the local estimate u(x) ≥ φ(x, Y, ˜X) for all x ∈ B( ˜x) for  > 0 suﬃciently
small. By Theorem 4.2, we obtain u(x) ≥ φ(x, Y, ˜X) for all x ∈ Ω, which shows
Y ∈ Fu( ˜x) and conclude the proof.
(cid:3)
5.1. H¨older regularity for refractors from growth conditions. In this subsection
we prove the C1,α-regularity result for refractors. We assume the regularity of the
target from a point (Deﬁnition 3.1), together with some growth conditions for the
target measure which we are now going to introduce precisely.
Let σ be a Radon measure on the target Σ and let X0 ∈ CΩ. Assume there exists
a neighborhood UX0 and a constant ˜C > 0 depending only on X0 such that for all
¯Y, ˆY ∈ Σ, Z ∈ UX0 and µ > 0 suﬃciently small (depending on X0), we have
(5.4)

(cid:18)(cid:26)
Y(λ) ∈ [ ¯Y, ˆY]Z : λ ∈(cid:20)1

(cid:21) ≥ ˜Cµn−1| ¯Y − ˆY|.

(cid:21)(cid:27)(cid:19) ∩ Σ

(cid:20)Nµ

σ

C1,α ESTIMATES FOR THE PARALLEL REFRACTOR

23

We will also assume that the measure σ satisﬁes
σ(Fu(Bη)) ≤ C0η n

q

(5.5)
for all balls Bη ⊂⊂ Ω and some constant C0 > 0 and 1 ≤ q < n
n−1.
∗ =
Theorem 5.4. Suppose u is a parallel refractor and the target Σ is regular from X
∗
∗, u(x
)). Suppose the target measure σ satisﬁes the growth conditions (5.4) and (5.5) at
(x
such that if ¯x, ˆx ∈ Bδ/2(x
∗
∗
. Then there exists δ, M > 0 and C2 > 0 depending on X
X
),
¯Y ∈ Fu( ¯x) and ˆY ∈ Fu( ˆx) satisfy

∗

(5.6)

| ¯Y − ˆY| ≥ max

1,

| ¯x − ˆx|,

(cid:40)

(cid:18)2M

(cid:19)2

δ

(cid:19)2(cid:41)

(cid:18)2M

C2

,

then there exist positive constants C1 = C1(C0, ˜C, M) and α = α(n, q) such that

| ¯Y − ˆY| ≤ C1| ¯x − ˆx|α.

Moreover,

u ∈ C1,α(Bδ/2(x
∗
The H¨older exponent can be obtained explicitly as
− n−1
2(n − 1) + n

n
2q
1 + 3

(5.7)

α =

)).

2

2q

.

Proof. In Theorem 5.3 we showed that under the assumption (5.6) (which is the
same as (5.1) from Theorem 5.3) there exists x0 ∈ [ ¯x, ˆx] such that if X
= (x0, u(x0)),
then we have the inclusion (5.2)

0 : λ ∈(cid:20)1
(cid:18)(cid:26)
Y(λ) ∈ [ ¯Y, ˆY]X∗
(cid:16) | ¯x− ˆx|
Nµ
where µ = | ¯Y − ˆY| 3
2| ¯x − ˆx| 1
Y(λ) ∈ [ ¯Y, ˆY]Z : λ ∈(cid:20)1
(cid:18)(cid:26)
and (5.5) that

(cid:21)(cid:27)(cid:19) ∩ Σ ⊂ Fu(Bη(x0)),
(cid:21)(cid:27)(cid:19) ∩ Σ

| ¯Y− ˆY|2 . It now follows from (5.4)

˜Cµn−1| ¯Y − ˆY| ≤ σ

2 , and η = M

(cid:20)Nµ

, 3
4

(cid:17) 1

2 = Mµ

| ¯Y− ˆY|

(cid:21)

∗
0

4

, 3
4

4

≤ σ[Fu(Bη(x0))] ≤ C0η n

q ,

which immediately implies | ¯Y − ˆY| ≤ C1| ¯x − ˆx|α. The value of α shown in (5.7) can
be obtained using the deﬁnitions of µ and η.
). Take ¯x ∈
Moreover, it follows that Fu(x) is single-valued for all x ∈ Bδ/2(x
). We ﬁrst show that u is diﬀerentiable at ¯x and Dxu( ¯x) = Dxφ( ¯x, ¯Y, ¯X),
Bδ/2(x

∗

∗

24

F. ABEDIN, C. E. GUTI ´ERREZ, AND G. TRALLI

where ¯X = ( ¯x, u( ¯x)) and ¯Y = Fu( ¯x). Indeed, for i = 1, . . . , n and h suﬃciently small,
we obtain from (2.21) and the deﬁnition of parallel refractor that
Diφ( ¯x, ¯Y, ¯X) −

(cid:32)φ( ¯x + hei, ¯Y, ¯X) − φ( ¯x, ¯Y, ¯X)

(cid:32)u( ¯x + hei) − u( ¯x)

(cid:33)

(cid:33)

h

≤ Diφ( ¯x, ¯Y, ¯X) −
h
= Diφ( ¯x, ¯Y, ¯X) − Diφ( ¯x + ˜hei, ¯Y, ¯X)
= −Diiφ( ¯x + ˆhei, ¯Y, ¯X)˜h ≤ C˜h ≤ Ch

for 0 ≤ ˆh ≤ ˜h ≤ h. For the reverse inequality, let ˆx = ¯x + hei, ˆX = ( ˆx, u( ˆx)) and
ˆY = Fu( ˆx). Once again, by the deﬁnition of parallel refractor,

(cid:32)u( ˆx) − u( ¯x)

(cid:33)

h

− Diφ( ¯x, ¯Y, ¯X) ≤

φ( ˆx, ˆY, ˆX) − φ( ¯x, ˆX, ˆY)

 − Diφ( ¯x, ¯Y, ¯X)

h

= Diφ( ˜x, ˆY, ˆX) − Diφ( ¯x, ¯Y, ¯X)

for some ˜x ∈ [ ¯x, ˆx]. By the ﬁrst part of the proof, we have also Fu(x) is a continuous
function of x and so ˆY → ¯Y as ˆx → ¯x. Thus, by letting h → 0, we obtain the
diﬀerentiability of u and the desired formula for Du.
Finally, we show that u ∈ C1,α(Bδ/2(x
have

)). As a matter of fact, for ¯x, ˆx ∈ Bδ/2(x

), we

∗

∗

|Du( ¯x) − Du( ˆx)| = |Dxφ( ¯x, ¯Y, ¯X) − Dxφ( ˆx, ˆY, ˆX)| ≤
≤ |Dxφ( ¯x, ¯Y, ¯X) − Dxφ( ˆx, ¯Y, ¯X)| + |Dxφ( ˆx, ¯Y, ¯X) − Dxφ( ˆx, ˆY, ¯X)| +
+|Dxφ( ˆx, ˆY, ¯X) − Dxφ( ˆx, ˆY, ˆX)| ≤
≤ C

(cid:16)| ¯x − ˆx| + | ¯Y − ˆY| + | ¯X − ˆX|(cid:17) ≤ C| ¯x − ˆx|α.

Here we have exploited the Lipschitz and the Hessian estimates for φ, together
with the facts that | ¯X − ˆX| ≤ C| ¯x − ˆx| and | ¯Y − ˆY| ≤ C max{| ¯x − ˆx|,| ¯x − ˆx|α}.
(cid:3)

6. Appendix

The purpose of this appendix is to show existence of parallel refractors assuming
an appropriate conﬁguration and location of the target Σ. In fact, we will show
existence of refractors for targets located within a slab of certain dimensions and so
that (2.15) holds, see Theorem 6.1 below. Therefore, the C1,α estimates proved in the
main body of this paper are applicable to actual refractors. A main diﬀerence with
the existence result in [GT13] is that the geometry is now given by hyperboloids,
then some estimates are diﬀerent and require explanation. We show explicit
estimates for the parameters in the conﬁguration that yield existence of parallel

C1,α ESTIMATES FOR THE PARALLEL REFRACTOR

25

refractors.
In particular, we seek refractors satisfying the energy conservation
condition.
Let us ﬁrst recall some notions. Given a refractor u and a point Y ∈ Σ, the
tracing mapping of u is deﬁned by

Tu(Y) =(cid:8)x ∈ Ω : H(Y, b) supports u from below at x for some b > 0(cid:9) .

If E ⊂ Σ, we put

(cid:91)

Y∈E

Tu(Y).

f (x) dx;

Tu(E)

Tu(E) =
(cid:90)

Mu(E) =

Given a nonnegative f ∈ L1(Ω), and assuming the visibility condition (6.16) below,
the refractor mapping induces a Borel measure, the refractor measure, given by

(cid:82)

this is proved as in [GT13, comment after Deﬁnition 2.3]. The function f represents
the intensity of the radiation emanating from Ω. The radiation intensity to be
received at Σ is given by a Radon measure µ. By assuming the energy conservation
Ω f (x) dx = µ(Ω), we will prove the existence of a parallel refractor u :
condition
Ω → [0, τ0] (in the sense of Deﬁnition 2.1) for which the compatibility conditions
(2.15) are satisﬁed, and such that
The main step is to prove this in the discrete case, i.e., when µ =(cid:80)N

i=1 aiδYi with
ai > 0 and Yi ∈ Σ. Once this is established, existence when µ is a general Radon
measure follows by an approximation argument, see, e.g., [GT13].

Mu(E) = µ(E)

∀E ⊆ Σ.

6.1. Geometric conﬁguration of the target for existence of refractors. Let us ﬁx
Yi = (yi, yi

n+1) ∈ Σ. Given b = (b1,··· , bN) with

−(cid:113)

(yi

n+1)2 + ∆2,

1 ≤ i ≤ N,

0 < bi < κ yi

n+1

we let

ub(x) = max
1≤i≤N

φYi,bi(x)

We will denote Mb(Yi) = Mub(Yi).
Step 1. We want to choose 0 < ¯b1 ≤ κ y1
κ yi

n+1)2 + ∆2 for 2 ≤ i ≤ N, then
(yi

−(cid:113)

n+1

n+1

φYi,bi(x) ≤ φY1, ¯b1(x)

max
2≤i≤N

x ∈ Ω.

− (cid:113)

(y1

n+1)2 + ∆2 such that if bi =

x ∈ Ω;

26

F. ABEDIN, C. E. GUTI ´ERREZ, AND G. TRALLI

that is, we will choose ¯b1 such that
φY1, ¯b1(x) ≥ φYi,bi(x)
(6.1)

We write

We have

ϕ(s) =

κ s
κ2 − 1

+

(cid:114)(cid:18)

(cid:19)2

for all x ∈ Ω and 2 ≤ i ≤ N.

s
κ2 − 1

.

∆2

κ2 − 1
(cid:33)2

+

+

(cid:115)(cid:32)
¯b1
κ2 − 1
(cid:33)2

¯b1
κ2 − 1

∆2

+

− κ ¯b1
κ2 − 1

−

(cid:115)(cid:32)

−

|x1 − y1|2
κ2 − 1

− ϕ(cid:16)¯b1

(cid:17) .

(yi

n+1)2 + ∆2

(cid:19)

(yi

n+1)2 + ∆2

,

n+1

= y1

κ2 − 1
(cid:19)
2 ≤ i ≤ N;∀x ∈ Ω.
(cid:19)

2 ≤ i ≤ N,
(cid:19)

(cid:113)

min
x∈Ω
for some x1 ∈ ¯Ω. So

φY1, ¯b1(x) = y1

n+1

φY1, ¯b1(x) ≥ y1

n+1

min
x∈Ω

On the other hand,

− κ ¯b1
κ2 − 1
(cid:18)

n+1

So (6.1) holds if we choose ¯b1 > 0 such that

φYi,bi(x) ≤ φYi,bi(yi) = yi
− 1
κ − 1

− bi
κ − 1

−(cid:113)

n+1

+

n+1

κ yi

= yi
n+1
= 1
κ − 1

(cid:113)
(cid:18)−yi
(cid:18)−yi
(cid:17) ≥ 1
− ϕ(cid:16)¯b1
(cid:17) ≥ max
− ϕ(cid:16)¯b1
(cid:26) 1
κ − 1
∗
> m

κ − 1

y1
n+1

so

1
κ − 1
(cid:18)
This is equivalent to choose ¯b1 such that

2≤i≤N

ϕ(cid:16)¯b1

(cid:17) ≤ y1

yi
n+1

n+1

(6.2)

+ min
2≤i≤N
notice that m < 0, and so y1
[0, +∞) and ϕ(0) =
∆√
κ2 − 1

(cid:113)
(cid:18)−yi
−(cid:113)

y1
n+1

+

n+1

(yi

n+1)2 + ∆2

+

n+1

(yi

n+1)2 + ∆2

.

(cid:19)(cid:27)

(yi

n+1)2 + ∆2

:= y1

n+1

∗
+ m := m

;

. Now the function ϕ is strictly increasing in

n+1
, so to get some ¯b1 > 0 satisfying (6.2), we need that

(6.3)

It is easy to see by calculation that the inverse function of ϕ is

ϕ−1(y) = κ y −(cid:113)

∆√
κ2 − 1

∗.
< m

(cid:32)

(cid:33)

y2 + ∆2;

ϕ−1

∆√
κ2 − 1

= 0;

(cid:33)
−(cid:113)

, +∞

∆√
(cid:18)
κ2 − 1
+ 1
κ − 1
yi
n+1

(cid:34)

ϕ−1 :

y1
n+1

(6.4)

C1,α ESTIMATES FOR THE PARALLEL REFRACTOR

27

→ R+. Since yi

(yi

n+1)2 + ∆2

n+1

≥ τ1 for 1 ≤ i ≤ N, we have
(cid:19)

(cid:19) ≥ τ1 + 1
(cid:18)
κ − 1

τ1 −(cid:113)
(cid:18)
κ τ1 −(cid:113)

+ ∆2

+ ∆2

(cid:19)

τ2
1

τ2
1

= 1
κ − 1
∆√
κ2 − 1

>

by choosing τ1 suﬃciently large,

= 1
κ − 1

ϕ−1(τ1)

− (cid:113)

so (6.3) holds. In addition, ¯b1 must satisfy that 0 < ¯b1 ≤ κ y1
n+1)2 + ∆2; so
we pick ¯b1 as large as possible in this interval and satisfying (6.2) (notice that from
(6.3), (2.14) always holds for all b > 0 suﬃciently small). That is, we deﬁne

(y1

n+1

∗(cid:27)
n+1)2 + ∆2 and ϕ(b) ≤ m
(y1

,

¯b1 = max

(6.5)

∗
with m

given in (6.2).

We then have

(cid:26)

−(cid:113)
−(cid:113)

n+1

b : 0 < b ≤ κ y1
(cid:26)
(cid:26)
∗ −(cid:112)

∗ −(cid:112)

∗
ϕ−1(m

κ m

n+1)2 + ∆2

−(cid:113)

n+1

), κ y1

(y1
(m∗)2 + ∆2, κ y1
n+1
(m∗)2 + ∆2 = ϕ−1(m
∗
),

(cid:27)

¯b1 = min

= min

(y1

n+1)2 + ∆2

(6.6)
since ϕ−1 is increasing and y1

= κ m

∗
> m

.

n+1

With the ¯b1 already chosen by (6.5), let
(b2,··· , bN) : 0 < bi ≤ κ yi

W =

(6.7)

(cid:26)

−(cid:113)

n+1

n+1)2 + ∆2 with
M(¯b1,b2,··· ,bN)(Yi) ≤ ai for 2 ≤ i ≤ N

(yi

−(cid:113)

n+1

The inequality (6.1) implies that the set W (cid:44) ∅, since M(¯b1,b2,··· ,bN)(Yi) = 0 for
bi = κ yi

n+1)2 + ∆2 for 2 ≤ i ≤ N.
(yi

Step 2. We prove that the vectors in the set W are bounded below by a positive
constant depending only on the constant τ1 in (2.14) (and (6.4)), the constant
τ2 concerning the location of the target, ∆, and κ. That is, we prove that if
(b2,··· , bN) ∈ W, then bi ≥ δ > 0, for all 2 ≤ i ≤ N with δ to be calculated; see
(6.12). Suppose that for some (b2,··· , bN) ∈ W there is 2 ≤ j0 ≤ N such that bj0
< δ.
We shall prove that this implies that

(6.8)

φYj0

,bj0 (x) ≥ φY1,¯b1(x)

∀x ∈ Ω,

(cid:27)

(cid:111) .

28

F. ABEDIN, C. E. GUTI ´ERREZ, AND G. TRALLI

which implies that M(¯b1,b2,··· ,bN)(Y1) = 0 contradicting the energy conservation con-
dition. We will prove that

,bj0 (x) ≥ max
x∈Ω

φYj0

min
x∈Ω

φY1,¯b1(x)
(6.9)
which clearly implies (6.8). We have for some x1 ∈ ¯Ω
(cid:33)2

− κ bj0
κ2 − 1

,bj0 (x1) = yj0

,bj0 (x) = φYj0

min
x∈Ω

φYj0

(cid:115)(cid:32) bj0

−

n+1

(cid:115)(cid:32) bj0

κ2 − 1

≥ yj0

n+1

− κ bj0
κ2 − 1

−

κ2 − 1

+

∆2

κ2 − 1

.

(cid:33)2

|2

|x1 − yj0
κ2 − 1

+

On the other hand,

φY1,¯b1(y1) = y1

− ¯b1
κ − 1
(cid:33)2
So to prove (6.9) it is enough to show that

(cid:115)(cid:32) bj0

n+1

yj0
n+1

− κ bj0
κ2 − 1

−

κ2 − 1

+

≥ max
x∈Ω

φY1,¯b1(x).

∆2

κ2 − 1

≥ y1

n+1

− ¯b1
κ − 1

if bj0

< δ. Since ϕ is strictly increasing, if we choose δ with

then

(6.10)

− ϕ(cid:16)

bj0

(cid:17) ≥ yj0

n+1

yj0
n+1

So we need to choose δ > 0 such that
≥ y1

¯b1
κ − 1

n+1

− ϕ (δ) ≥ y1

n+1

yj0
n+1

− ¯b1
κ − 1

− ϕ (δ) ≥ y1

n+1

− ¯b1
κ − 1

.

− yj0

n+1

+ ϕ (δ) .

We have ϕ(0) =
have

∆√
κ2 − 1

, so to ﬁnd δ > 0 satisfying the last inequality, we need to

¯b1
κ − 1

− y1

n+1

+ yj0
n+1

>

∆√
κ2 − 1

.

C1,α ESTIMATES FOR THE PARALLEL REFRACTOR

29

We have from (6.6)
− y1
¯b1
κ − 1
n+1
≥ 1
ϕ−1
κ − 1
≥ 1
κ − 1

(cid:18) 1
+ yj0
n+1
(cid:18) 1
κ − 1
κ − 1

ϕ−1

= 1
κ − 1
ϕ−1(τ1)
ϕ−1(τ1)

n+1

ϕ−1(M) − y1
+ yj0
n+1

(cid:19) − y1
(cid:19) − τ2 + τ1
(cid:18) 1
κ − 1

ϕ−1(τ1)

+ yj0
n+1

n+1

(from (6.4) since ϕ−1 is increasing)

(since τ1 ≤ yj

n+1

≤ τ2 for 1 ≤ j ≤ N).

If we choose τ1, τ2 suﬃciently large (τ1 satisfying also (2.14) and (6.4)) and satis-
fying

ϕ−1

1
κ − 1

(6.11)
(notice that w = τ2 − τ1 is the width of the slab containing the target, and (6.11))
and choose δ with

∆√
κ2 − 1

(cid:19) − τ2 + τ1 >

ϕ−1(τ1)

(cid:18) 1
κ − 1
(cid:18) 1
κ − 1

ϕ−1

(cid:19) − τ2 + τ1,
(cid:19)
(cid:19) − w

.

ϕ−1(τ1)

ϕ−1

ϕ(δ) = 1
κ − 1
(cid:18) 1
κ − 1

then (6.10) follows. That is,
δ = ϕ−1

(6.12)

Therefore all b’s in W are bounded below by δ.
In other words, given w, we can pick τ1 suﬃciently large so that (6.11) is

satisﬁed. We have then proved that

W ⊂ [δ, ϕ−1(τ1 + w)]N−1.

Step 3. We shall prove the following upper bound for each refractor

ub(x) = max
1≤i≤N

φYi,bi(x)
when b1 = ¯b1 from Step 1, and (b2,··· , bN) ∈ W:
(6.13)

x ∈ Ω,

ub(x) ≤ τ0 := τ1 + w − δ
κ − 1
(cid:27)

(cid:26)

κ ∆

τ1 ≥ max

with

κ τ0, τ0 +

(6.14)
where w = τ2 − τ1, for all τ1 is suﬃciently large where δ is given in (6.12).
First notice that from (2.7)
φYi,bi(x) ≤ yi

= τ1 + w − δ
κ − 1

≤ τ2 − δ
κ − 1

− bi
κ − 1

n+1

κ − 1

,

30

F. ABEDIN, C. E. GUTI ´ERREZ, AND G. TRALLI

for i = 2,··· , N; and

.

n+1

If we prove that

φY1,b1(x) ≤ y1

≤ τ2 − ¯b1
κ − 1

− ¯b1
κ − 1
¯b1 ≥ δ,
(cid:18) 1
then (6.13) holds. In fact, from (6.4) and (6.6)
κ − 1
1
κ − 1

(cid:19)
) ≥ ϕ−1
ϕ−1(τ1)
L − w, so L ≥ δ is equivalent to
since ϕ−1 is increasing. Now ϕ(δ) =
> 0 and w ≥ 0. Notice
ϕ(δ) − δ
κ − 1
that to obtain the bound (6.13) we must take τ1 suﬃciently large satisfying the
inequalities (2.14), (6.4), and (6.11).

+ w ≥ 0 which holds true since ϕ(δ) − δ
κ − 1

∗
¯b1 = ϕ−1(m

:= L

We shall prove now that we can take τ1 even larger so that (6.14) holds. We ﬁrst

show we can choose τ1 large so that

(cid:18)

This inequality is equivalent to
(6.15)
+

1 − 1

δ

(cid:19) ≤

κ

τ1.

τ0 ≤ 1
(cid:18) 1
(cid:19)2, Λ(τ1) = 1
κ − 1

ϕ−1

(cid:18) 1
(cid:18) 1
κ − 1
ϕ−1
κ − 1

(cid:19) − w
(cid:19)
(cid:19)
ϕ−1(τ1)

1

κ

=

= L(τ1).

ϕ−1

ϕ−1(τ1)

κ −

(cid:18)∆
(κ − 1) τ1

(cid:114)
(κ − 1) τ1

w
τ1
Writing ϕ−1(α) = α
, and notic-
ing that limτ1→+∞ ϕ−1(τ1) → +∞ and limτ1→+∞ Λ(τ1) − w → +∞, we see that
limτ1→+∞ L(τ1) = 1. Hence (6.15) holds for all τ1 suﬃciently large, since κ > 1. To
show that we can choose τ1 large so that
τ1 ≥ τ0 +

κ − 1

1 +

κ ∆

α

,

κ − 1

it is enough to show, since κ > 1, that we can choose τ1 large such that

τ0 +

κ ∆

κ − 1

≤ 1
κ

τ1.

(cid:19)

(cid:18)

1 − 1

w
τ1

The last inequality is equivalent to

(κ − 1) τ1
which as before holds true for all τ1 suﬃciently large.

(κ − 1) τ1

+

+

κ

κ ∆

≤

δ

= L(τ1)

C1,α ESTIMATES FOR THE PARALLEL REFRACTOR

31

Figure 3. Refraction conﬁguration

; where τ1 is large.

In summary, we can choose τ1 large depending on w, κ and ∆ such that (6.13)
and (6.14) hold true for any refractor with b1 = ¯b1, and (b2,··· , bN) ∈ W. That
is, the graph of the refractor is contained in the cylinder CΩ = Ω × [0, τ0], with
τ0 = τ1 + w − δ
κ − 1
Recall once again that assuming the visibility condition (6.16) below, Mu is a
Borel measure in Σ as in [GT13, comment after Deﬁnition 2.3]. In addition, the
continuity of the refractor measure follows as in [GT13, Lemmas 2.4 and 3.2]
implying that the set W in (6.7) above is closed. Then using the argument in
the last third of the proof of [GT13, Theorem 3.3] yields the following existence
theorem; see Figure 3.

Theorem 6.1. Let w > 0 be ﬁxed. For all τ1 suﬃciently large depending only on w,
κ and ∆, there is τ0, given in (6.13) and satisfying (6.14), such that for each target
Σ = {Y1,··· , YN} contained in the slab {(y, yn+1) : τ1 ≤ yn+1 ≤ τ1 + w} and satisfying
the visibility condition:

(6.16)

for all X ∈ Ω × [0, τ0] and for all m ∈ Sn−1,
the ray {X + tm : t > 0} intersects Σ in at most one point,

u(cid:83)(cid:87)(cid:68)Τ0Τ1Τ1(cid:43)w32

F. ABEDIN, C. E. GUTI ´ERREZ, AND G. TRALLI

(cid:90)

Tu(E)

(6.17)

there is a parallel refractor u : Ω → [0, τ0] satisfying
where µ = (cid:80)N
(cid:80)N

f (x) dx = µ(E)

i=1 ai.

i=1 aiδYi with ai > 0 and the energy conservation condition

∀E ⊂ Σ,

(cid:82)

Ω f (x) dx =

Using the last theorem and proceeding as in the proof of the existence [GT13,
Theorem 3.4], we obtain by discretization that Theorem 6.1 holds true for an
arbitrary Radon measure µ on a general target Σ satisfying (6.16) and the energy
conservation condition

Ω f (x) dx = µ(Σ).

(cid:82)

References

[BHP15] K. Brix, Y. Haﬁzogullari, and A. Platen, Designing illumination lenses and mirrors by
the numerical solution of Monge-Amp`ere equations, J. Opt. Soc. Am. A 32 (2015), no. 11,
2227–2236.

[BW59] M. Born and E. Wolf, Principles of optics: Electromagnetic theory of propagation, interference
and diﬀraction of light, seventh (expanded), 2006 ed., Cambridge University Press, 1959.
[CGH08] L. A. Caﬀarelli, C. E. Guti´errez, and Q. Huang, On the regularity of reﬂector antennas,

[CO08]

[GH09]

[GH14]

Ann. of Math. 167 (2008), 299–323.
L. A. Caﬀarelli and V. Oliker, Weak solutions of one inverse problem in geometric optics, J.
Math. Sci. (N. Y.) 154 (2008), no. 1, 39–49.
C. E. Guti´errez and Q. Huang, The refractor problem in reshaping light beams, Arch. Rational
Mech. Anal. 193 (2009), no. 2, 423–443.

, The near ﬁeld refractor, Annales de l’Institut Henri Poincar´e (C) Analyse Non

Lin´eaire 31 (2014), no. 4, 655–684.

[GK15] N. Guillen and J. Kitagawa, Pointwise inequalities in geometric optics and other generated

jacobian equations, preprint arXiv:1501.07332 (2015).

[GM13] C. E. Guti´errez and H. Mawi, The far ﬁeld refractor with loss of energy, Nonlinear Analysis:

[GT13]

[GT15]

Theory, Methods & Applications 82 (2013), 12–46.
C. E. Guti´errez and F. Tournier, The parallel refractor, Development in Mathematics 28
(2013), 325–334.

, Regularity for the near ﬁeld parallel refractor and reﬂector problems, Calc. Var. PDEs

54 (2015), no. 1, 917–949.

[Gut08] C. E. Guti´errez, The near ﬁeld refractor, Geometric Methods in PDE’s, Conference for
the 65th birthday of E. Lanconelli, Lect. Notes Semin. Interdiscip. Mat., vol. 7, Semin.
Interdiscip. Mat. (S.I.M.), Potenza, 2008, pp. 175–188.

[Kar14] A. Karakhanyan, Existence and regularity of the reﬂector surfaces in Rn+1, Arch. Rational

Mech. Anal. 213 (2014), 833–885.

[Kar16]

, An inverse problem for the refractive surfaces with parallel lighting, SIAM J. Math.

Anal. 48 (2016), no. 1, 740–784.

C1,α ESTIMATES FOR THE PARALLEL REFRACTOR

33

[KM10]

Y.H. Kim and R.J. McCann, Continuity, curvature, and the general covariance of optimal
transportation, J. Eur. Math. Soc. (JEMS) 12 (2010), no. 4, 1009–1040.

[KW10] A. Karakhanyan and X.J. Wang, On the reﬂector shape design, J. Diﬀ. Geom. 84 (2010),

561–610.

[LGM16] R. De Leo, C. E. Guti´errez, and H. Mawi, On the numerical solution of the far ﬁeld refractor

problem, Preprint, 2016.

[Loe09] G. Loeper, On the regularity of solutions of optimal transportation problems, Acta Math. 202

(2009), 241–283.

[Loe11]

, Regularity of optimal maps on the sphere: the quadratic cost and the reﬂector antenna,

Arch. Rational Mech. Anal. 199 (2011), no. 1, 269–289.

[MTW05] X.N. Ma, N. Trudinger, and X.J. Wang, Regularity of potential functions of the optimal

[Vil09]

transportation problem, Arch. Rational Mech. Anal. 177 (2005), no. 2, 151–183.
C. Villani, Optimal transport, old and new, Grundlehren der Mathematischen Wis-
senschaften, vol. 338, Springer-Verlag, Berlin, 2009.

