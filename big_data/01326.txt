6
1
0
2

 
r
a

M
4

 

 
 
]

.

A
Q
h
t
a
m

[
 
 

1
v
6
2
3
1
0

.

3
0
6
1
:
v
i
X
r
a

A generalization of intertwining operators for

vertex operator algebras

Kenichiro Tanabe∗

Department of Mathematics

Hokkaido University

Kita 10, Nishi 8, Kita-Ku, Sapporo, Hokkaido, 060-0810

Japan

ktanabe@math.sci.hokudai.ac.jp

Abstract

We generalize the notion of an intertwining operator to N-graded
weak modules over a vertex operator algebra and study their prop-
erties. We show a formula for the dimensions of these intertwining
operators in terms of modules over the Zhu algebras under some con-
ditions on N-graded weak modules.

1

Introduction

The purpose of this paper is to generalize the notion of an intertwining
operator to N-graded weak modules over a vertex operator algebra. In
the representation theory of groups or Lie algebras, the tensor prod-
uct of two modules is the tensor product vector space whose module
structure is deﬁned by means of a natural coproduct operation, and an
intertwining operator is deﬁned to be a module homomorphism from

∗Research was partially supported by the Grant-in-aid (No.

24540003 and No.

23224001 (S)) for Scientiﬁc Research, JSPS.

1

A generalization of intertwining operators

2

the tensor product of two modules to a third module. In contrast, in
the representation theory of vertex operator algebras, ﬁrst the notion
of an intertwining operator among an arbitrary triple of modules is
deﬁned in [8, Deﬁnition 5.4.1], and then the tensor product of two
modules is deﬁned by using intertwining operators. Note that the ex-
istence of the tensor product of two modules over a vertex operator
algebra is not guaranteed in general. The dimension of the space of
all intertwining operators among a triple of modules is called the fu-
sion rule. It is a natural problem to determine fusion rules for a given
vertex operator algebra. In [7, Theorem 1.5.3], Frenkel and Zhu give
a formula for the fusion rule among an arbitrary triple of irreducible
modules in terms of modules over the Zhu algebra as a generalization
of a result in [20] for WZW models. Here we have to be careful that [7,
Theorem 1.5.3] is correct for rational vertex operator algebras, how-
ever, is not correct for non-rational vertex operator algebras in general
as pointed out at the end of [13, Section 2]. A modiﬁed result is given
in [13, Theorem 2.11]. For many vertex operator algebras, fusion rules
among triples of irreducible modules have been determined by using
[7, Theorem 1.5.3] and [13, Theorem 2.11] (see for example [1],[2],[3],
[16], [18], and [19]).

The deﬁnition of an intertwining operator in [8, Deﬁnition 5.4.1]
makes sense even for weak modules, however, is no longer enough.
Actually based on logarithmic conformal ﬁled theories in physics, in
[14] a generalization of the notion of an intertwining operator, called
a logarithmic intertwining operator, is given among an arbitrary triple
of logarithmic modules by allowing logarithmic terms. Here a loga-
rithmic module is an N-graded weak module such that each homoge-
neous space is a generalized L(0)-eigenspace. A generalization of the
formula in [7, Theorem 1.5.3] and [13, Theorem 2.11] to logarithmic
intertwining operators is given in [11, Theorem 6.6].

The aims of this paper are to introduce a generalization of the no-
tion of an intertwining operator, which I call a Z-graded intertwining
operator (see Deﬁnition 3.2), among an arbitrary triple of general N-
graded weak modules and to study their properties. For logarithmic
modules, a Z-graded intertwining operator is essentially the same as a
logarithmic intertwining operator as we will see later in Section 4. To
explain the main idea, we recall a few facts about intertwining opera-
tors for (ordinary) modules over a vertex operator algebra (V, Y, 1, ω).
For three V -modules Wi = ⊕∞
j=0(Wi)λi+j with lowest weight λi ∈ C,
i = 1, 2, 3 and an intertwining operator I( , x) : W1 ⊗C W2 → W3{x},

A generalization of intertwining operators

3

i x−i−1 = xλ1+λ2−λ3I( , x),
which is already appeared in [7, (1.5.3)], [8, Remark 5.4.4], and [13,

we deﬁne an operator I o(u, x) = Pi∈C uo
(2.12)]. Here W3{x} = {Pα∈C wαxα | wα ∈ W3 (α ∈ C)}. Then,
I o(u, x) is a map from W1 ⊗C W2 to W3((x)) = {Pi∈Z wixi | wi ∈

W3 (i ∈ Z) and wi = 0, i ≪ 0} and I( , x) can be written as

I(u, x)v =Xi∈Z

xL(0)(x−L(0)u)o

i x−L(0)v

(1.1)

for u ∈ W1 and v ∈ W2. Here for the coeﬃcient L(0) of x−2 in each
YWi(ω, x), i = 1, 2, 3, we deﬁne

x±L(0)w = x±λw

(1.2)

for w ∈ Wi with L(0)w = λw, λ ∈ C and extend x±L(0)w for an arbi-
trary w ∈ Wi, i = 1, 2, 3 by linearity. We note that I o( , x) satisﬁes all
the conditions in the deﬁnition of intertwining operator [8, Deﬁnition
5.4.1] except the so called L(−1)-derivative property. For (ordinary)
V -modules, I o( , x) is nothing but a Z-graded intertwining operator as
we will see later in Proposition 3.3. The main idea is that we redeﬁne
x±L(0) to be formal variables such that

x

d
dx

x±L(0) = x±L(0)(±L(0)).

(1.3)

Since this deﬁnition of x±L(0) makes sense for N-graded weak modules,
we can deﬁne “intertwining operators”for N-graded weak V -modules
by using I o( , x) and (1.1). Moreover, applying xd/dx to both sides of
(1.1) and using Borcherds identity, we automatically get the L(−1)-
derivative property.

We expect that various results for intertwining operators can be
generalized to Z-graded intertwining operators. As the main result of
this paper I will show a formula for the fusion rules as a generalization
of [7, Theorem 1.5.3] and [13, Theorem 2.11] in Theorem 5.3. To
state the result precisely, we prepare following symbols. For a vertex
operator algebra V and a weak V -module W , A(V ) is the Zhu algebra
deﬁned in [21, Section 2.1] and A(W ) is the A(V )-bimodule deﬁned in
[7, Theorem 1.5.1]. For a left A(V )-module U , S(U ) = ⊕∞
j=0S(U )(j)
is the generalized Verma module with S(U )(0) = U given in [5], U ∗ =
HomC(U, C), S(U )′ = ⊕∞

j=0 HomC(S(U )(j), C)Cand IZ(cid:0) S(Ω∗
the space of all Z-graded intertwining operators of type (cid:0) S(Ω∗

Now we state the main result:

(3))′

W1 S(Ω(2))(cid:1) is
W1 S(Ω(2))(cid:1).

(3))′

A generalization of intertwining operators

4

Theorem 5.3 For an N-graded weak V -module W1 and two left A(V )-
modules Ω(2) and Ω(3), the map

IZ(cid:18) S(Ω∗

W1 S(Ω(2))(cid:19) → HomA(V )(A(W1) ⊗A(V ) Ω(2), Ω(3))

(3))′

Φ( , x) 7→ oΦ

(5.46)

is a linear isomorphism.

Here we deﬁne oΦ(u) = Φ(u; deg u − 1) for homogeneous u ∈ W1
and extend oΦ(u) for an arbitrary u ∈ W1 by linearity(see (5.45)).
To show the main result, we will modify the proofs of [11, Theorem
6.6], [13, Theorem 2.11], and [21, Theorem 2.2.1] so as not to use
the L(−1)- derivative property. For some vertex operator algebras
and their modules, we can compute the right-hand side of (5.46).
For instance, let us consider Verma modules Mc,h, c, h ∈ C over the
Virasoro vertex operator algebra Mc where we use the notation in
[7, Section 4]. In this case, the same computation as in [13, Section
2] shows that the right-hand side of (5.46) reduces to the following
simple form:

HomA(Mc)(A(Mc,h) ⊗A(Mc) Ω(2), Ω(3)) ∼= HomC(Ω(2), Ω(3)).

The organization of the paper is as follows. In Section 2 we recall
some basic properties of the Zhu algebras, bimodules over the Zhu
algebras, and N-graded weak modules. In Section 3 we recall some
basic facts about intertwining operators and introduce the notion of
a Z-graded intertwining operator. In Section 4 for an arbitrary triple
of logarithmic modules Wi, i = 1, 2, 3, we construct a linear isomor-
phism from the space of all logarithmic intertwining operators of type

W1 W2(cid:1) to the space of all Z-graded intertwining operators of the same
(cid:0) W3

type. In Section 5 we will show the main result. In Section 6 we list
some notations.

2 Preliminary

We assume that the reader is familiar with the basic knowledge on
vertex algebras as presented in [4], [5], and [12]. Throughout this pa-
per, N denotes the set of all non-negative integers, x, y, x0, x1, x2, . . .
are commutative formal variables, and (V, Y, 1, ω) is a vertex opera-
tor algebra. For the Virasoro element ω of V and a weak V -module

A generalization of intertwining operators

5

(M, YM ), we write

YM (ω, x) =Xi∈Z

L(i)x−i−2.

(2.1)

We recall some properties of the Zhu algebra A(V ) of V and the
A(V )-bimodules associated with weak modules from [21, Section 2]
and [7, Section 1], and [13, Section 2]. Let M be a weak V -module.
For homogeneous a ∈ V and u ∈ M , we deﬁne

a ◦ u = Resx(1 + x)wt ax−2YM (a, x)u ∈ M

(2.2)

and

a ∗ u = Resx(1 + x)wt ax−1YM (a, x)u ∈ M,
u ∗ a = Resx(1 + x)wt a−1x−1YM (a, x)u ∈ M.

Here, Resx is deﬁned by

Resx f (x) = f−1

(2.3)

(2.4)

(2.5)

for f (x) = Pi∈Z fixi ∈ M [[x, x−1]]. We extend (2.2)–(2.4) for an

arbitrary a ∈ V by linearity. We also deﬁne

O(M ) = SpanC{a ◦ u | a ∈ V, u ∈ M }

(2.6)

and take the following quotient space:

A(M ) = M/O(M ).

(2.7)

If one takes M = V , then A(V ) is an associative C-algebra, called the
Zhu algebra of V , with multiplication (2.3) by [21, Theorem 2.1.1]. It
follows from [7, Theorem 1.5.1] that A(M ) is an A(V )-bimodule under
the actions (2.3) and (2.4). It follows from the proof of [21, Lemma
2.1.2] that for homogeneous a ∈ V and u ∈ M ,

Resx(1 + x)wt axkYM (a, x)u ∈ O(M ) for k ≤ −2.

(2.8)

We shall use elements of M to represent elements of A(M ). For a left
A(V )-module U and a ∈ A(V ), we denote the action of a on U by
o(a):

A(V ) → EndC(U )

a 7→ o(a).

(2.9)

A generalization of intertwining operators

6

A weak V -module M is called N-graded if M admits a decomposi-

tion M = ⊕∞

j=0M (j) such that

akM (j) ⊂ M (wt a + j − k − 1)

(2.10)

for homogeneous a ∈ V , j ∈ N, and k ∈ Z. For an N-graded weak
j=0 M (j) and u ∈ M (j), j ∈ N, we deﬁne the degree

V -module M =L∞

of u by

deg u = j.

(2.11)

Following [5], an N-graded weak V -module M = ⊕∞
i=0M (i) is called a
generalized Verma V -module if M is generated by M (0) and for every
N-graded weak V -module W and every A(V )-module homomorphism

f : M (0) → {w ∈ W | aiw = 0 for homogeneous a ∈ V and i ≥ wt a},
(2.12)

there exists a unique V -module homomorphism F : M → W such
that F |M (0) = f . For an arbitrary A(V )-module U , [5, Theorem 6.2]
shows there exists a unique generalized Verma V -module S(U ) with
S(U )(0) = U up to isomorphism, where S(U ) is denoted by ¯M (U ) in
[5].

3 Z-graded intertwining operators

In this section we ﬁrst recall the deﬁnition of an intertwining operator
from [8, Deﬁnition 5.4.1] and then introduce the notion of a Z-graded
intertwining operator as a generalization of an intertwining operator.
For a vector space M over C and p, q ∈ Z, we deﬁne

M [x, x−1][p,q] = {

uixi | up, up+1, . . . , uq ∈ M },

qXi=p
M {x} = {Xα∈C
M ((x)) = {Xi∈Z
∞Xi,j=0

uαxα | uα ∈ M (α ∈ C)},

uixi | ui ∈ M (i ∈ Z) and ui = 0, i ≪ 0}, and

M [[x, y]] = {

uijxiyj | uij ∈ M (i, j ∈ N)}.

(3.1)

A generalization of intertwining operators

7

Deﬁne three linear injective maps

ιx,y :M [[x, y]][x−1, y−1, (x − y)−1] → M ((x))((y)),
ιy,x :M [[x, y]][x−1, y−1, (x − y)−1] → M ((y))((x)), and
ιx,y−x :M [[x, y]][x−1, y−1, (x − y)−1] → M ((x))((y − x))

(3.2)

determined by

ιx,y(cid:0)xjyk(x − y)l(cid:1) =
ιy,x(cid:0)xjyk(x − y)l(cid:1) =
ιx,y−x(cid:0)xjyk(x − y)l(cid:1) =

∞Xi=0
∞Xi=0
∞Xi=0

(cid:18)l
i(cid:19)(−1)ixj+l−iyk+i,
(cid:18)l
i(cid:19)(−1)l−iyk+l−ixj+i, and
(cid:18)k
i(cid:19)xj+k−i(−1)l(y − x)l+i

(3.3)

for j, k, l ∈ Z and ιx,y(u) = ιy,x(u) = ιx,y−x(u) = u for u ∈ M .

We recall the deﬁnition of an intertwining operator from [8, Deﬁ-

nition 5.4.1].

Deﬁnition 3.1. Let W1, W2, and W3 be three V -modules. An inter-

W1 W2(cid:1) is a linear map

twining operator of type (cid:0) W3
I(u, x)v = Xα∈C

I( , x) : W1 ⊗C W2 → W3{x}

uαvx−α−1,

u ∈ W1, v ∈ W2, and uα ∈ HomC(W2, W3), (3.4)

such that the following conditions are satisﬁed:

(1) For u ∈ W1, v ∈ W2, and α ∈ C,

uα+mv = 0 for suﬃciently large m ∈ N.

(3.5)

(2) For u ∈ W1 and a ∈ V ,

x1 − x2

x−1
0 δ(

)Y (a, x1)I(u, x2) − x−1

0 δ(

x2 − x1

x0

)I(u, x2)Y (a, x1)

)I(Y (a, x0)u, x2).

(3.6)

= x−1

1 δ(

x0
x2 + x0

x1

A generalization of intertwining operators

8

(3) (L(−1)-derivative property) For u ∈ W1,

I(L(−1)u, x) =

d
dx

I(u, x).

(3.7)

W1 W2(cid:1) the space of all intertwining operators of
We denote by I(cid:0) W3
W1 W2(cid:1).
W1 W2(cid:1) and call its dimension the fusion rule of type (cid:0) W3
type (cid:0) W3

A formula for the fusion rule among an arbitrary triple of irreducible
modules is given in [7, Theorem 1.5.3] and [13, Theorem 2.11].

For a vector space U , we deﬁne a subspace U ⌊{x}⌋ of U {x} by

U ⌊{x}⌋ =nXα∈C

uαxα (cid:12)(cid:12)(cid:12)

uα ∈ U (α ∈ C) and for any α ∈ C,

wα+i = 0 for suﬃciently small i ∈ Z o.

(3.8)

Standard arguments (cf. [12, Sections 3.2–3.4] and [17, Lemma 2.4])
show that the condition (2) in Deﬁnition 3.1 is equivalent to the fol-
lowing condition: For u ∈ W1, v ∈ W2 and a ∈ V , there exists

I(a, u, v|x, y) ∈ W3[[y]]⌊{x}⌋[y−1, (x − y)−1]

(3.9)

such that

ιx,yI(a, u, v|x, y) = I(u, x)YW2 (a, y)v,
ιy,xI(a, u, v|x, y) = YW3(a, y)I(u, x)v,

and

ιx,y−xI(a, u, v|x, y) = I(YW1(a, y − x)u, x)v.

(3.10)

Let I( , x) : W1 ⊗C W2 → W3{x} be an intertwining operator. For
α ∈ C, by taking a to be the Virasoro element ω ∈ V in (3.6) and
comparing the coeﬃcients of x−1

in both sides, we have

2

0 x−2

1 x−α−1

(L(−1)u)α+1 = L(0)uα − (L(0)u)α − uαL(0)

(3.11)

and therefore the L(−1)-derivative property (3.7) can be replaced by
the following condition:

x

d
dx

I(u, x) = L(0)I(u, x) − I(L(0)u, x) − I(u, x)L(0).

(3.12)

Suppose Wi, i = 1, 2, 3 admit decompositions

Wi =

∞Mj=0

(Wi)λi+j

(3.13)

A generalization of intertwining operators

9

where (Wi)λi+j is the eigenspace for L(0) with eigenvalue λi +j, j ∈ N.
It follows by (3.12) that

uαv = 0 for α 6∈ λ1 + λ2 − λ3 + Z

(3.14)

and

uλ1+λ2−λ3+k(W2)λ2+j ⊂ (W3)λ3+i+j−k−1

(3.15)

for u ∈ (W1)λ1+i, j ∈ N, and k ∈ Z. The properties (3.14) and (3.15)
are essentially used in the proof of the formula for the fusion rules
given in [7, Theorem 1.5.3] and [13, Theorem 2.11].

The deﬁnition of an intertwining operator in [8, Deﬁnition 5.4.1]
makes sense even for weak V -modules, however, the condition (3.12)
seems to be too strong for weak V -modules as explained below. Let
Wi, i = 1, 2, 3 be three weak V -modules and I( , x) : W1 ⊗ W2 →
W3{x} a linear map which satisﬁes all the conditions in Deﬁnition
3.1. Despite the action of L(0) on a weak V -module is not necessarily
semisimple, for u ∈ W1 and v ∈ W2, (3.12) forces that each coeﬃcient
of

L(0)I(u, x)v − I(L(0)u, x)v − I(u, x)L(0)v

(3.16)

is a scalar multiple of the corresponding coeﬃcient of I(u, x)v. More-
over, we can not expect a generalization of the formula for the fusion
rules given in [7, Theorem 1.5.3] and [13, Theorem 2.11] because sim-
ilar conditions like (3.14) and (3.15), which are essential for these
results, do not follow from (3.12). Thus, we need to modify the con-
dition (3.12).

To do that, we return to the case of intertwining operators I( , x)
among a triple of V -modules W1, W2 and W3 as in (3.13). We deﬁne
a map

I o( , x) = xλ1+λ2−λ3I( , x) : W1 ⊗C W2 → W3((x))
i x−i−1,
uo

u ⊗ v 7→Xi∈Z

(3.17)

which is already appeared in [7, (1.5.3)], [8, Remark 5.4.4], and [13,
(2.12)], and we denote (Wi)λi+j by Wi(j) for i = 1, 2, 3 and j ∈ N.
Then, we have

I(u, x)v = x−λ1−λ2+λ3I o(u, x)v
xL(0)(x−L(0)u)o

i x−L(0)v

=Xi∈Z

(3.18)

A generalization of intertwining operators

10

for u ∈ W1 and v ∈ W2. Here we deﬁne

x±L(0)w = x±λw

(3.19)

for w ∈ Wi, i = 1, 2, 3 with L(0)w = λw, λ ∈ C and extend x±L(0)w for
an arbitrary w ∈ Wi, i = 1, 2, 3 by linearity. The map I o( , x) satisﬁes
(3.5), (3.6), and

uo
kW2(j) ⊂ W3(i + j − k − 1)

(3.20)

for u ∈ W1(i), j ∈ N, and k ∈ Z by (3.15). Based on the properties
(3.5), (3.6), and (3.20) of I o( , x), we introduce the following notion:

Deﬁnition 3.2. Let W1, W2 and W3 be three N-graded weak V -

modules and Φ( , x) =Pn∈Z Φ( ; n)x−n−1 a linear map from W1⊗CW2
to W3((x)). We call Φ a Z-graded intertwining operator of type(cid:0) W3
W1 W2(cid:1)

if

(1) For i, j ∈ N, k ∈ Z, and u ∈ W1(i),

Φ(u; k)W2(j) ⊂ W3(i + j − k − 1).

(3.21)

(2) For u ∈ W1, v ∈ W2, and a ∈ V , there exists

Φ(a, u, v|x, y) ∈ W3[[x, y]][x−1, y−1, (x − y)−1]

(3.22)

such that

ιx,yΦ(a, u, v|x, y) = Φ(u, x)YW2(a, y)v,
ιy,xΦ(a, u, v|x, y) = YW3(a, y)Φ(u, x)v,

and

ιx,y−xΦ(a, u, v|x, y) = Φ(YW1(a, y − x)u, x)v.

(3.23)

Standard arguments (cf.

[12, Sections 3.2–3.4] and [17, Lemma
2.4]) show that the condition (2) in Deﬁnition 3.2 is equivalent to
the following Borcherds identity:
for a ∈ V , u ∈ W1, v ∈ W2, and
l, m, n ∈ Z, we have

(cid:18)m
i(cid:19)Φ(al+iu; m + n − i)v
∞Xi=0
(−1)i(cid:18)l
∞Xi=0

=

i(cid:19)(cid:0)am+l−iΦ(u; n + i)v + (−1)l+1Φ(u; m + i)an+l−iv(cid:1).

(3.24)

A generalization of intertwining operators

11

We denote by IZ(cid:0) W3
ators of type (cid:0) W3

W1 W2(cid:1) the space of all Z-graded intertwining oper-
W1 W2(cid:1). The following result shows that for V -modules

a Z-graded intertwining operator is essentially the same as an inter-
twining operator.

Proposition 3.3. For three V -modules W1, W2, and W3, the map

I(cid:18) W3
W1 W2(cid:19) → IZ(cid:18) W3

W1 W2(cid:19)

I( , x) 7→ I o( , x)

(3.25)

is a linear isomorphism.

Proof. We may assume that W1, W2, and W3 admit decompositions as
in (3.13). We have already shown before Deﬁnition 3.2 that I o( , x) is
a Z-graded intertwining operator for an intertwining operator I( , x).
For a Z-graded intertwining operator Φ( , x) : W1 ⊗C W2 → W3((x)),
x−λ1−λ2+λ3Φ( , x) satisﬁes (3.5) and (3.6). The same argument as in
(3.11) shows

Φ(L(−1)u; i + 1) = L(0)Φ(u; i) − Φ(L(0)u; i) − Φ(u; i)L(0)

(3.26)

for u ∈ W1 and i ∈ Z, which implies

d
dx

(x−λ1−λ2+λ3Φ(u, x)) = x−λ1−λ2+λ3Φ(L(−1)u, x)

(3.27)

by (3.21). Therefore x−λ1−λ2+λ3Φ(u, x) is an intertwining operator
and this completes the proof.

As we will see later in Proposition 4.3, the isomorphism (3.25)
is generalized to the case of logarithmic intertwining operators intro-
duced in [14].

We note that the L(−1)-derivative property (3.7), or equivalently
(3.12), is not required for Z-graded intertwining operators. However,
the following modiﬁcations of Z-graded intertwining operators satisfy
(3.12). We redeﬁne xL(0) and x−L(0) to be two formal variables and
let CxL(0) (resp. Cx−L(0)) be a vector space with a basis xL(0) (resp.
x−L(0)). For a L(0)-module W , we deﬁne vector spaces

xL(0)W = CxL(0) ⊗C W,
x−L(0)W = Cx−L(0) ⊗C W

(3.28)

A generalization of intertwining operators

12

and a linear map

x

d
dx

: x±L(0)W → x±L(0)W

x±L(0) ⊗ u 7→ x±L(0) ⊗ L(0)u,

u ∈ W.

(3.29)

If W is a weak V -module, then so are x±L(0)W by deﬁning

Yx±L(0)W (a, y)(x±L(0) ⊗ u) = x±L(0) ⊗ YW (a, y)u

(3.30)

for a ∈ V and u ∈ W . Clearly x±L(0)W are isomorphic to W . For
three L(0)-modules Wi, i = 1, 2, 3 and a linear map f : x−L(0)W1 ⊗C
x−L(0)W2 → xL(0)W3, we deﬁne a map

x

d
dx

f : x−L(0)W1 ⊗C x−L(0)W2 → xL(0)W3

(3.31)

by

(x

d
dx

f )(p ⊗ q)

= x

d
dx

(f (p ⊗ q)) + f ((x

d
dx

p) ⊗ q) + f (p ⊗ x

d
dx

q)

(3.32)

for p ∈ x−L(0)W1 and q ∈ x−L(0)W2. For three N-graded weak V -
modules W1, W2, and W3, a Z-graded intertwining operator Φ : W1 ⊗C
W2 → W3((x)), and i ∈ Z, we deﬁne a map

ˆΦi : x−L(0)W1 ⊗C x−L(0)W2 → xL(0)W3
(x−L(0) ⊗ u) ⊗ (x−L(0) ⊗ v) 7→ xL(0) ⊗ Φ(u; i)v.

(3.33)

Then the sequence ( ˆΦi)i∈Z satisﬁes (3.24) and

ˆΦk((x−L(0) ⊗ u) ⊗ (x−L(0) ⊗ v)) ∈ xL(0)W3(i + j − k)

(3.34)

for k ∈ Z, u ∈ W1(i), and v ∈ W2(j), which is an analogue of (3.21).
By (3.32), we automatically have the following analogue of the L(−1)-
derivative property (3.7) (or (3.12)).

Lemma 3.4. For i ∈ Z, u ∈ W1, and v ∈ W2, we have

(x

d
dx

ˆΦi)(u ⊗ v) = L(0) ˆΦi(u ⊗ v) − ˆΦi(L(0)u ⊗ v) − ˆΦi(u ⊗ L(0)v).
(3.35)

A generalization of intertwining operators

13

4 A relation between logarithmic in-
tertwining operators and Z-graded in-
tertwining operators

In this section we will show that for logarithmic modules, a Z-graded
intertwining operator is essentially the same as a logarithmic inter-
twining operator introduced in [14]. Throughout this section we as-
sume all weak V -modules M satisfy the following condition: there
exists λ ∈ C such that M admits a decomposition

M =

∞Mi=0

Mλ+i,

Mh = {u ∈ M | (L(0) − h)nu = 0 for some n ∈ Z>0}
with dimC Mh < ∞ for h ∈ λ + Z.

(4.1)

Finite direct sums of weak V -modules satisﬁes the condition above
are called logarithmic V -modules in [14]. We recall the deﬁnition of
logarithmic intertwining operators from [14, Deﬁnition 1.3] and [10,
Deﬁnition 3.7].

Deﬁnition 4.1. Let Wi = ⊕∞
j=0(Wi)λi+j, i = 1, 2, 3 be three weak
V -modules which satisfy (4.1). A logarithmic intertwining operator is
a linear map

I( , x) : W1 ⊗C W2 → W3[log x]{x}

I(u, x)v = Xα∈C

∞Xn=0

uα,nvx−α−1(log x)n,

u ∈ W1, v ∈ W2, and un,α ∈ HomC(W2, W3) (4.2)

such that the following conditions are satisﬁed:

(1) For u ∈ W1, v ∈ W2, and α ∈ C,

uα+m,kv = 0 for suﬃciently large m ∈ N.

(4.3)

(2) For u ∈ W1 and a ∈ V ,

x1 − x2

x−1
0 δ(

)Y (a, x1)I(u, x2) − x−1

0 δ(

= x−1

1 δ(

x0
x2 + x0

x1

x2 − x1

x0

)I(u, x2)Y (a, x1)

)I(Y (a, x0)u, x2).

(4.4)

A generalization of intertwining operators

14

(3) For u ∈ W1,

I(L(−1)u, x) =

d
dx

I(u, x).

(4.5)

We denote by Ilog(cid:0) W3
operators of type (cid:0) W3

W1 W2(cid:1) the space of all logarithmic intertwining
W1 W2(cid:1). We recall some basic properties about

logarithmic intertwining operators from [10],[14], and [15]. The same
argument as in (3.14) shows

uα,nv = 0 for α 6∈ λ1 + λ2 − λ3 + Z.

(4.6)

For a logarithmic intertwining operator I( , x) : W1⊗CW2 → W3[log x]{x},
we write

I( , x) =

∞Xi=0

I (i)( , x)(log x)i,

I (i)( , x) : W1 ⊗C W2 → W3{x} (4.7)

and deﬁne

I o( , x) =Xi∈Z

I o( ; i)x−i−1, I o( ; i) ∈ EndC(W1 ⊗C W2, W3)

= xλ1+λ2−λ3I (0)( , x) ∈ (EndC(W2, W3))[[x, x−1]].

(4.8)

Note that

I o(u; i) = ui+λ1+λ2−λ3,0

(4.9)

for u ∈ W1 and i ∈ Z. It follows by (4.5) that

xI (i)(L(−1)u, x) = x

d
dx

I (i)(u, x) + (i + 1)I (i+1)(u, x)

(4.10)

for all i ∈ N and therefore I( , x) is uniquely determined by I (0)( , x),
or I o( , x).

For a weak V -module M = L∞

i=0 Mλ+i as in (4.1), M is an N-
graded weak V -module with M (i) = Mλ+i for i ∈ N and one can take
the Jordan decomposition

L(0) = S + N

(4.11)

of L(0) on M where S is the semisimple part of L(0) and N is the
nilpotent part of L(0). For u ∈ M such that Su = λu, λ ∈ C, we
deﬁne

xSu = xλu.

(4.12)

A generalization of intertwining operators

15

We extend xS for an arbitrary u ∈ M by linearity. For u ∈ M we
deﬁne

xN u = eN log xu =

xL(0)u = xSxN u.

∞Xi=0

(log x)iN i

i!

u and

(4.13)

We also deﬁne x−L(0)u by the same manner. For u ∈ M we clearly
have

x

d
dx

x±L(0)u = x±L(0)(±L(0))u.

(4.14)

Although the following generalization of (3.18) seems to be well known,
we give a proof.

Lemma 4.2. Let Wi, i = 1, 2, 3 be as above. For a logarithmic inter-
twining operator I( , x) : W1 ⊗C W2 → W3[log x]{x}, we have

I(u, x)v =Xi∈Z

xL(0)I o(x−L(0)u; i)x−L(0)v

(4.15)

for u ∈ W1 and v ∈ W2, where the actions of x±L(0) on Wi, i = 1, 2, 3
are deﬁned by (4.13).

Proof. For u ∈ W1 and v ∈ W2, we denote by J(u, x)v the right-hand
side of (4.15). By (4.13), J(u, x)v can be written as

J(u, x)v =Xi∈Z

eN log xI o(e−N log xu; i)e−N log xvxλ3−λ1−λ2−i−1

∈ W3[log x]{x}.

(4.16)

and therefore J(u, x)v satisﬁes (4.3).

Since N is a V -module homomorphism by [10, Proposition 2.2],

J( , x) satisﬁes (4.4). By (4.14), we have (4.5) as follows:

x

d
dx

J(u, x)v

=Xi∈Z(cid:0)xL(0)L(0)I o(x−L(0)u; i)x−L(0)v − xL(0)I o(x−L(0)L(0)u; i)x−L(0)v
− xL(0)I o(x−L(0)u; i)x−L(0)L(0)v(cid:1)
=Xi∈Z

xL(0)I o(x−L(0)L(−1)u; i + 1)x−L(0)v.

(4.17)

A generalization of intertwining operators

16

Thus, J( , x) is a logarithmic intertwining operator. If we wright

J( , x) =

∞Xi=0

J (i)( , x)(log x)i,

J (i)( , x) : W1 ⊗C W2 → W3{x},

(4.18)

then we have J (0)( , x) = I (0)( , x) by (4.16) and therefore I( , x) =
J( , x) by the comment right after (4.10).

For a logarithmic intertwining operator I( , x) : W1 ⊗C W2 →
W3[log x]{x}, I o( , x) : W1 ⊗CW2 → W3((x)) is a Z-graded intertwining
operator since I o( , x) satisﬁes (3.6). Conversely, the proof of Lemma
4.2 shows that for a Z-graded intertwining operator Φ( , x) : W1 ⊗C
W2 → W3((x)), the map

W1 ⊗C W2 → W3[log x]{x}

u ⊗ v 7→Xi∈Z

xL(0)Φ(x−L(0)u; i)x−L(0)v

(4.19)

is a logarithmic intertwining operator. Thus we have the following
result.

Proposition 4.3. Let W1, W2, and W3 be three weak V -modules which
satisfy (4.1). Then, the map

Ilog(cid:18) W3

W1 W2(cid:19) → IZ(cid:18) W3

W1 W2(cid:19)

I( , x) 7→ I o( , x)

(4.20)

is a linear isomorphism.

5 The main theorem

Throughout this section Ω(2) and Ω(3) are two left A(V )-modules and
W1 is an N-graded weak V -module.
In this section we establish a
one-to-one correspondence between HomA(V )(A(W1) ⊗A(V ) Ω(2), Ω(3))

and IZ(cid:0) S(Ω∗

W1 S(Ω(2))(cid:1) as a generalization of [7, Theorem 1.5.3] and [13,

Theorem 2.11]. Here for a left A(V )-module U , S(U ) = ⊕∞
j=0S(U )(j)
is the generalized Verma V -module with S(U )(0) = U deﬁned in Sec-
tion 2, U ∗ = HomC(U, C), and S(U )′ = ⊕∞
j=0 HomC(S(U )(j), C). We

(3))′

A generalization of intertwining operators

17

will show this result by modifying the proofs of [11, Theorem 6.6], [13,
Theorem 2.11], and [21, Theorem 2.2.1] so as not to use the L(−1)-
derivative property.

For a vector space U , T (U ) denotes the tensor algebra of U . For
an N-graded weak V -module W1, T (W1, Ω(2)) denotes the tensor al-
gebra T ((V ⊕ W1 ⊕ Ω(2))[t, t−1]) and F (W1, Ω(2)) denotes the sub-
space T (V [t, t−1]) ⊗C W1[t, t−1] ⊗C T (V [t, t−1]) ⊗C Ω(2) of T (W1, Ω(2)).
For simplicity we shall omit the tensor product symbol. For a ∈
V ⊕ W1 ⊕ Ω(2) and i ∈ Z, a(i) denotes a ⊗ ti. For a ∈ V ⊕ W1 ⊕ Ω(2),
we deﬁne a map

YT (W1,Ω(2))(a, x) : T (W1, Ω(2)) → T (W1, Ω(2))

u 7→Xi∈Z

a(i)ux−i−1.

(5.1)

We note that for a ∈ V

YT (W1,Ω(2))(a, x)(T (V [t, t−1]) ⊗C Ω(2)) ⊂ (T (V [t, t−1]) ⊗C Ω(2))[[x, x−1]],

YT (W1,Ω(2))(a, x)(F (W1, Ω(2))) ⊂ F (W1, Ω(2))[[x, x−1]]

(5.2)

and for u ∈ W1

YT (W1,Ω(2))(u, x)(T (V [t, t−1]) ⊗C Ω(2)) ⊂ F (W1, Ω(2))[[x, x−1]]. (5.3)

For homogeneous a1, . . . , an−2 ∈ V , homogeneous u ∈ W1, v ∈ Ω(2),
m1, . . . , mn−2, i ∈ Z, and s ∈ {1, . . . , n − 2}, we deﬁne the degree of

H = a1(m1) · · · as(ms)u(i)as+1(ms+1) · · · an−2(mn−2)v ∈ F (W1, Ω(2))
(5.4)

by

deg H =

n−2Xj=1

(wt aj − mj − 1) + (deg u − i − 1).

(5.5)

For n ∈ Z, we denote by F (W1, Ω(2))(n) the set of all elements in
F (W1, Ω(2)) with degree n. Then, we have

F (W1, Ω(2)) =Mn∈Z

F (W1, Ω(2))(n).

(5.6)

Deﬁnition 5.1. Let J(W1, Ω(2)) be the subspace of F (W1, Ω(2)) gen-
erated by the following elements:

A generalization of intertwining operators

18

(1) all elements in ⊕n<0F (W1, Ω(2))(n).
(2) For homogeneous a, b ∈ V , p ∈ T (V [t, t−1]), homogeneous q ∈

F (W1, Ω(2)), and l, m, n ∈ Z,

(cid:18)m
i(cid:19)(al+ib)(m + n − i)

p(cid:16) ∞Xi=0
wt b−n−1+deg qXi=0

−

− (−1)l+1

(−1)i(cid:18)l
wt a−m−1+deg qXi=0

i(cid:19)a(m + l − i)b(n + i)

(−1)i(cid:18)l

i(cid:19)b(n + l − i)a(m + i)(cid:17)q.

(3) For p ∈ T (V [t, t−1]), q ∈ F (W1, Ω(2)), and n ∈ Z,

p(1(n) − δn,−1)q.

(5.7)

(5.8)

(4) For homogeneous a ∈ V , v ∈ Ω(2), and p ∈ T (V [t, t−1]) ⊗C

W1[t, t−1] ⊗C T (V [t, t−1]),

p(a(wt a − 1) − o(a))v.

(5.9)

(5) For homogeneous a, b ∈ V , homogeneous q ∈ T (V [t, t−1]) ⊗ Ω(2),

p ∈ T (V [t, t−1]) ⊗C W1[t, t−1] ⊗C T (V [t, t−1]), and l, m, n ∈ Z,

(cid:18)m
i(cid:19)(al+ib)(m + n − i)

p(cid:16) ∞Xi=0
wt b−n−1+deg qXi=0

−

− (−1)l+1

(−1)i(cid:18)l
wt a−m−1+deg qXi=0

i(cid:19)a(m + l − i)b(n + i)

(−1)i(cid:18)l

i(cid:19)b(n + l − i)a(m + i)(cid:17)q.

(5.10)

(6) For p ∈ T (V [t, t−1])⊗CW1[t, t−1]⊗CT (V [t, t−1]), q ∈ T (V [t, t−1])⊗

Ω(2), and n ∈ Z,

p(1(n) − δn,−1)q.

(5.11)

A generalization of intertwining operators

19

(7) For homogeneous a ∈ V , homogeneous u ∈ W1, homogeneous

q ∈ T (V [t, t−1]) ⊗ Ω(2), p ∈ T (V [t, t−1]), and l, m, n ∈ Z,

p(cid:16) ∞Xi=0
deg u−n−1+deg qXi=0

−

− (−1)l+1

(cid:18)m
i(cid:19)(al+iu)(m + n − i)

(−1)i(cid:18)l
wt a−m−1+deg qXi=0

i(cid:19)a(m + l − i)u(n + i)
(−1)i(cid:18)l

i(cid:19)u(n + l − i)a(m + i)(cid:17)q.

Since J(W1, Ω(2)) is generated by homogeneous elements, we have

J(W1, Ω(2)) =Mn∈Z

(J(W1, Ω(2)) ∩ F (W1, Ω(2))(n)).

(5.13)

(5.12)

We set

and

S(W1, Ω(2)) = F (W1, Ω(2))/J(W1, Ω(2))

(5.14)

S(W1, Ω(2))(n) = F (W1, Ω(2))(n) + J(W1, Ω(2))

(5.15)

for n ∈ Z. We have S(W1, Ω(2))(n) = 0 for n < 0 by Deﬁnition 5.1 (1)
and

S(W1, Ω(2)) =

∞Mn=0

S(W1, Ω(2))(n).

(5.16)

We shall use elements of T (W1, Ω(2)) to represent elements of S(W1, Ω(2)).
For a ∈ V , YS(W1,Ω(2))(a, x) denotes the map S(W1, Ω(2)) → S(W1, Ω(2))((x))
induced by YT (W1,Ω(2))( , x), namely

YS(W1,Ω(2))(a, x) : S(W1, Ω(2)) → S(W1, Ω(2))((x))
a(i)ux−i−1.

u 7→Xi∈Z

(5.17)

By deﬁnition, S(W1, Ω(2)) is an N-graded weak V -module.

A generalization of intertwining operators

20

For a vector space U , we deﬁne

U{y1,...,yn} = U [[yi − yj | 1 ≤ i < j ≤ n]][(yi − yj)−1 | 1 ≤ i < j ≤ n].
(5.18)

For distinct i, j ∈ {1, . . . , n}, let

ι(i,j) : U{y1,...,yn} → U{y1,..., byi,...,yn}((yi − yj))

(5.19)

be a linear map, where byi denotes the omission of the term yi, deﬁned

by ι(i,j)(u) = u for u ∈ U and

ι(i,j)(yk − yl)m =




(yk − kl)m,

∞Ps=0(cid:18)m
∞Ps=0(cid:18)m

s(cid:19)(yj − yl)m−s(yi − yj)s,
s(cid:19)(yk − yj)m−s(−yi + yj)s,

if k, l 6= i,

if k = i, and

if l = i

(5.20)

for distinct k, l ∈ {1, . . . , n} and m ∈ Z. For i1, j1, i2, j2 ∈ {1, . . . , n}
such that i1 6= j1, i2 6= j2, and j1 6= i2, we deﬁne a map

ι(i1,j1),(i2,j2) : U{y1,...,yn} → U{y1,..., cyi1 ,..., cyi2 ,...,yn}((yi1 − yj1))((yi2 − yj2))
(5.21)

as follows: for f ∈ U{y1,...,yn}, writing

ι(i2,j2)f =Xk∈Z

fk(yi2 − yj2)k, fk ∈ U{y1,..., cyi2 ,...,yn}

∈ U{y1,..., cyi2 ,...,yn}((yi2 − yj2)),

(5.22)

we deﬁne

ι(i1,j1),(i2,j2)f =Xk∈Z

(ι(i1,j1)fk)(yi2 − yj2)k

∈ U{y1,..., cyi1 ,..., cyi2 ,...,yn}((yi1 − yj1))((yi2 − yj2)).

(5.23)

By the same manner we inductively deﬁne a map

ι(i1,j1),...,(ik ,jk) : U{y1,...,yn} → U{y1,..., cyi1 ,..., cyik

,...,yn}((yi1 − yj1)) · · · ((yik − yjk))

(5.24)

for i1, j1, . . . , ik, jk ∈ {1, . . . , n} such that im 6= jm and jm 6∈ {im+1, . . . , ik}
for all m = 1, . . . , k. We note that for distinct i1, . . . , in ∈ {1, . . . , n}

A generalization of intertwining operators

21

ι(i1,j1),(i2,j2),...,(in,jn) and ι(i2,j2),...,(in,jn) are the same maps on U{y1,...,yn}
by deﬁnition.

Let U be a vector space over C and h ∈ Z. we say p ∈ U [[(yi −
yj)±1 | 1 ≤ i < j ≤ n]] is homogeneous of total degree h if all the terms
appearing in it with nonzero coeﬃcients have the same total degree
h. We note that for every distinct i, j ∈ {1, . . . , n}, p ∈ U{y1,...,yn} is
homogeneous of total degree h if and only if so is ι(i,j)p.

We write

V =

∞Mi=∆

Vi

(5.25)

where Vi = {a ∈ V | L(0)a = ia}. Let M be a weak V -module. For
homogeneous a1, . . . , an−1 ∈ V and homogeneous u ∈ M , standard
arguments (cf. [12, Sections 3.2–3.4] and [17, Lemma 2.4]) show that
there exists

ˆYM (a1, . . . , an−1, u|y1, . . . , yn)

∈ Y1≤s<t≤n−1

(ys − yt)− wt as−wt at+∆ Y1≤m<n

× M [[yi − yj | 1 ≤ i < j ≤ n]]

⊂ M{y1,...,yn}

such that

(ym − yn)− wt am−deg u

(5.26)

ˆYM (a1, a2, . . . , an−1, u|y1, . . . , yn)

ι(1,n),(2,n)...,(n−1,n)
= YM (a1, y1 − yn)YM (a2, y2 − yn) · · · YM (an−1, yn−1 − yn)u
∈ M ((y1 − yn))((y2 − yn)) · · · ((yn−1 − yn)).

(5.27)

We note that

ˆYM (a, u|y1, y2) = YM (a, y1 − y2)u

(5.28)

for a ∈ V and u ∈ M . Standard arguments (cf. [12, Sections 3.2–3.4]
and [17, Lemma 2.4]) also show that

ˆYM (aσ(1), . . . , aσ(n−1), u|yσ(1), . . . , yσ(n−1), yn)
= ˆYM (a1, . . . , an−1, u|y1, . . . , yn)

(5.29)

for an arbitrary permutation σ of {1, . . . , n − 1},

ι(i,i+1)

ˆYM (a1, . . . , an−1, u|y1, . . . , yn)

= ˆYM (a1, . . . , ai−1, Y (ai, yi − yi+1)ai+1, ai+2, . . . , an−1, u|y1, . . . ,byi, . . . , yn)

∈ M{y1,..., byi,...,yn}((yi − yi+1))

(5.30)

A generalization of intertwining operators

22

for i = 1, . . . , n − 2, and

ˆYM (a1, . . . , an−1, u|y1, . . . , yn)

ι(n−1,n)
= ˆYM (a1, . . . , an−2, YM (an−1, yn−1 − yn)u|y1, . . . , yn−2, yn)
∈ M{y1,...,yn−2,yn}((yn−1 − yn)).

(5.31)

For n ∈ N, V ×n denotes the n times direct product of V . Let

fn :V ×n−2 × W1 × Ω(2) → U{y1,...,yn}, n = 2, 3, . . .

(5.32)

be a sequence of maps which satisﬁes the following conditions:
a1, . . . , an−2 ∈ V , u ∈ W1, and v ∈ Ω(2).
(1) For an arbitrary permutation σ of {1, . . . , n − 2},

let

fn(a1, . . . , an−2, u, v|y1, . . . , yn−2, yn−1, yn)
= fn(aσ(1), . . . , aσ(n−2), u, v|yσ(1), . . . , yσ(n−2), yn−1, yn). (5.33)

(2) For i = 1, . . . , n − 3,

ι(i,i+1)fn(a1, . . . , an−2, u, v|y1, . . . , yn)

= fn−1(a1, . . . , Y (ai, yi − yi+1)ai+1, . . . , an−2, u, v|y1, . . . ,byi, . . . , yn)
∈ U{y1,..., byi,...,yn}((yi − yi+1)).

(5.34)

(3)

ι(n−2,n−1)fn(a1, . . . , an−3, an−2, u, v|y1, . . . , yn)
= fn−1(a1, . . . , an−3, YW1(an−2, yn−2 − yn−1)u, v|y1, . . . , yn−3, yn−1, yn)
∈ U{y1,...,yn−3,yn−1,yn}((yn−2 − yn−1)).

(5.35)

(4) If an−2 is homogeneous, then the coeﬃcient of (yn−2−yn)− wt an−2

in

ι(n−2,n)fn(a1, . . . , an−3, an−2, u, v|y1, . . . , yn)

is equal to

fn−1(a1, . . . , an−3, u, o(an−2)v|y1, . . . , yn−3, yn−1, yn).

(5.36)

A generalization of intertwining operators

23

We deﬁne a map Φ : F (W1, Ω(2)) → U by

Φ(YT (W1,Ω(2))(a1, y1 − yn) · · · YT (W1,Ω(2))(as, ys − yn)

× YT (W1,Ω(2))(u, yn−1 − yn)
× YT (W1,Ω(2))(as+1, ys+1 − yn) · · · YT (W1,Ω(2))(an−2, yn−2 − yn)v)
= ι(1,n),...,(s,n),(n−1,n),(s+1,n),...,(n−2,n)fn(a1, . . . , an−2, u, v|y1, . . . , yn)
(5.37)

for a1, . . . , an−2 ∈ V, u ∈ W1, v ∈ Ω(2), and s = 1, . . . , n − 2.

Lemma 5.2. With the notation above, Φ(J(W1, Ω(2))) = 0 and there-
fore the map Φ : T (W1, Ω(2)) → U induces a map S(W1, Ω(2)) → U
which denoted by the same symbol:

Φ :

S(W1, Ω(2)) → U

u 7→ Φ(u).

(5.38)

Proof. We simply write Y = YT (W1,Ω(2)). We only show that the
images of elements of the forms (5.7) and (5.8) in Deﬁnition 5.1 vanish.
We can show the images of the other elements in Deﬁnition 5.1 vanish
in the same manner.

For i, s = 1, . . . , n − 3 with i + 1 < s, deﬁning

P = Y (a1, y1 − yn) · · · Y (ai−1, yi−1 − yn),
Q = Y (ai+2, yi+2 − yn) · · · Y (as, ys − yn)Y (u, yn−1 − yn)

× Y (as+1, ys+1 − yn) · · · Y (an−2, yn−2 − yn)v,

ι1 = ι(1,n),...,(i−1,n), and
ι2 = ι(i+2,n),...,(s,n),(n−1,n),(s+1,n),...,(n−2,n),

(5.39)

we have

ι1 ◦ ι(i,n),(i+1,n) ◦ ι2(fn(a1, . . . , an−2, u, v|y1, . . . , yn))
= f2(P Y (ai, yi − yn)Y (ai+1, yi+1 − yn)Q),
ι1 ◦ ι(i+1,n),(i,n) ◦ ι2(fn(a1, . . . , an−2, u, v|y1, . . . , yn)
= f2(P Y (ai+1, yi+1 − yn)Y (ai, yi − yn)Q),
and
ι1 ◦ ι(i+1,n),(i,i+1) ◦ ι2(fn(a1, . . . , an−2, u, v|y1, . . . , yn)
= f2(P Y (Y (ai, yi − yi+1)ai+1, yi+1 − yn)Q).

(5.40)

A generalization of intertwining operators

24

Let p be an arbitrary coeﬃcient of P and q an arbitrary coeﬃcient of
Q. Taking ai = a and ai+1 = b in (5.40), we have (5.7) by standard
arguments (cf. [12, Sections 3.2–3.4] and [17, Lemma 2.4]).

For i = 1, . . . , n − 3, we have

ι(i,i+1)(fn(. . . , ai−1, 1, ai+1, . . . |y1, . . . , yn))

= fn−1(. . . , ai−1, Y (Y (1, yi − yi+1)ai+1, . . . |y1, . . . ,byi, . . . , yn)
= fn−1(. . . , ai−1, ai+1, . . . |y1, . . . ,byi, . . . , yn)
∈ T (W1, Ω(2)){y1,..., byi,...,yn}.

(5.41)

Since T (W1, Ω(2)){y1,..., byi,...,yn} ⊂ T (W1, Ω(2)){y1,...,yn} and ι(i,i+1) is in-
jective, we have

fn(. . . , ai−1, 1, ai+1, . . . |y1, . . . , yn)

= fn−1(. . . , ai−1, ai+1, . . . |y1, . . . ,byi, . . . , yn)

and therefore (5.8) by (5.37).

(5.42)

For Φ( , x) ∈ IZ(cid:0) W3

W1 W2(cid:1) and homogeneous u ∈ W1, we denote

Φ(u; deg u − 1) by oΦ(u) and extend oΦ(u) for an arbitrary u ∈ W1 by
linearity. The map

oΦ : W1 ⊗ W2(0) → W3(0)
u ⊗ v 7→ oΦ(u)v

(5.43)

induces an A(V )-module homomorphism A(W1)⊗A(V )W2(0) → W3(0)
which denoted by the same symbol:

oΦ : A(W1) ⊗A(V ) W2(0) → W3(0)
u ⊗ v 7→ oΦ(u)v.

We get a map

IZ(cid:18) W3

W1 W2(cid:19) → HomA(V )(A(W1) ⊗A(V ) W2(0), W3(0))

Φ( , x) 7→ oΦ.

The following is the main result.

(5.44)

(5.45)

A generalization of intertwining operators

25

Theorem 5.3. For an N-graded weak V -module W1 and two left
A(V )-modules Ω(2) and Ω(3), the map

IZ(cid:18) S(Ω∗

W1 S(Ω(2))(cid:19) → HomA(V )(A(W1) ⊗A(V ) Ω(2), Ω(3))

(3))′

Φ( , x) 7→ oΦ

(5.46)

is a linear isomorphism.

Proof. The same argument as in the proof of [13, Proposition 2.10]
shows the map (5.46) is injective. Let ϕ : A(W1) ⊗A(V ) Ω(2) → Ω(3)
be an A(V )-module homomorphism. For homogeneous u ∈ W1 and
v ∈ Ω(2), we deﬁne

ϕ(u, v|y1, y2) = ϕ(u ⊗ v)(y1 − y2)− deg u

(5.47)

and extend ϕ(u, v|y1, y2) for an arbitrary u ∈ W1 by linearity. For
a1, . . . , an−2 ∈ V , u ∈ W1, v ∈ Ω(2), and i, j ∈ {1, . . . , n} with i < j,
as temporary notation let us put

Γij =




and

g = Y1≤i<j≤n

wt ai + wt aj − ∆,
wt ai + deg u,
wt ai,
deg u,

if 1 ≤ i < j ≤ n − 2,
if 1 ≤ i ≤ n − 2 and j = n − 1,
if 1 ≤ i ≤ n − 2 and j = n,
if i = n − 1 and j = n

(5.48)

(yi − yj)Γij ϕ( ˆYW1(a1, . . . , an−2, u|y1, . . . , yn−2, yn−1), v|yn−1, yn)

(5.49)

where ∆ is deﬁned in (5.25). Since

Y1≤i<j≤n−1

(yi − yj)Γij ˆYW1(a1, . . . , an−2, u|y1, . . . , yn−2, yn−1)

∈ W1[[yi − yj | 1 ≤ i < j ≤ n − 1]]

(5.50)

by (5.26), we have

g ∈ (Ω(3)((yn−1 − yn)))[[yi − yj | 1 ≤ i < j ≤ n − 1]]

× [(y1 − yn)±1, . . . , (yn−2 − yn)±1].

(5.51)

A generalization of intertwining operators

26

We note that g is homogeneous of total degree

Γ = X1≤i<j≤n

Γij −

n−2Xi=1

wt ai − deg u.

(5.52)

For an arbitrary permutation σ of {1, . . . , n − 2}, by (5.50) and

ι(1,n−1),...,(n−2,n−1)

n−1Yi=1

(yi − yn)Γin

= ι(σ(1),n−1),...,(σ(n−2),n−1)

n−1Yi=1

(yi − yn)Γin ,

(5.53)

we have

ι(1,n−1),...,(n−2,n−1)g = ι(σ(1),n−1),...,(σ(n−2),n−1)g

(5.54)

and therefore

(yi − yj)Γij

ι(1,n−1),...,(n−2,n−1)(cid:16) Y1≤i<j≤n
× ϕ(YW1(a1, y1 − yn−1) · · · YW1(an−2, yn−2 − yn−1)u, v|yn−1, yn)(cid:17)
= ι(σ(1),n−1),...,(σ(n−2),n−1)(cid:16) Y1≤i<j≤n
× ϕ(YW1(aσ(1), yσ(1) − yn−1) · · · YW1(aσ(n−2), yσ(n−2) − yn−1)u, v|yn−1, yn)(cid:17)

(yi − yj)Γij

(5.55)

by (5.27) and (5.29).

Let i1, . . . , in−2, in be a sequence of integers such that

0 6= Resyn−1−yn Resy1−yn−1 · · · Resyn−2−yn−1

× (yn−1 − yn)in(y1 − yn−1)i1 · · · (yn−2 − yn−1)in−1
× ι(1,n−1),...,(n−2,n−1)g.

(5.56)

By (5.52), we have

i1 + · · · + in−2 + in = −Γ − n + 1.

(5.57)

A generalization of intertwining operators

27

By (5.55), we may assume that i1 is the smallest element in {i1, . . . , in−2}.
Since

(yi − yj)Γij

∞Xk1n,...,kn−2,n=0(cid:16) Y1≤i<j≤n−2

kij(cid:19)(cid:17)(cid:16) n−2Yi=1
(cid:18)Γij

kin(cid:19)(cid:17)
(cid:18)Γin

m=1 Γmn−Pn−2

m=1 kmn

m=1 kmj (yj − yn−1)kjn+Pj−1

m=1 kmj +Pn−1

m=j+1 Γjm−Pn−2

m=j+1 kjm

×

=

ι(1,n−1),...,(n−2,n−1) Y1≤i<j≤n
∞Xk12,k13,...,kn−3,n−2=0
× (yn−1 − yn)Pn−1
n−2Yj=1
(−1)Pj−1
∞Xk12,k13,...,kn−3,n−2=0
∞Xk1n=0
× (y1 − yn−1)k1n+Pn−1
n−2Yj=2
(−1)Pj−1

=

×

×

∞Xk2n,...,kn−2,n=0(cid:16) Y1≤i<j≤n−2

kij(cid:19)(cid:17)(cid:16) n−2Yi=2
(cid:18)Γij

kin(cid:19)(cid:17)
(cid:18)Γin

k1n(cid:19)(yn−1 − yn)Γ1n−k1n+Pn−1
(cid:18)Γ1n

m=2 Γmn−Pn−2

m=2 kmn

m=2 Γ1m−Pn−2

m=2 k1m

m=1 kmj (yj − yn−1)kjn+Pj−1

m=1 kmj +Pn−1

m=j+1 Γjm−Pn−2

m=j+1 kjm,

the right-hand side of (5.56) can be written as a linear combination
of the following elements:

(5.58)

Resyn−1−yn Resy1−yn−1

× (y1 − yn−1)i1+Pn−1

(cid:18)Γ1n
k1n(cid:19)(yn−1 − yn)Γ1n−k1n+d

∞Xk1n=0

m=2 Γ1m−l+k1nϕ(Y (a1, y1 − yn−1)w, v|yn−1, yn)
(5.59)

where l ∈ N, d ∈ Z, and w is a homogeneous element of W1. We see

A generalization of intertwining operators

28

that (5.59) becomes

Resyn−1−yn

∞Xk1n=0

(cid:18)Γ1n
k1n(cid:19)ϕ(a1

i1+Pn−1

m=2 Γ1m−l+k1n

w, v|yn−1, yn)

× (yn−1 − yn)Γ1n−k1n+d

(cid:18)Γ1n
k1n(cid:19)ϕ(a1

∞Xk1n=0

= Resyn−1−yn

i1+Pn−1
× (yn−1 − yn)− wt a1−deg w+i1+Pn−1

m=2 Γ1m−l+k1n

w ⊗ v)

m=2 Γ1m−l+1+Γ1n+d

= Resyn−1−yn ϕ(Resx(1 + x)Γ1nxi1+Pn−1

m=2 Γ1m−lYW1(a1, x)w ⊗ v)

× (yn−1 − yn)− wt a1−deg w+i1+Pn−1

n=2 Γ1m−k+1+Γ1n+d.

(5.60)

(5.61)

By (2.8), (5.48), (5.56), and (5.60), we have

i1 ≥ −

n−1Xm=2

Γ1m − 1.

Since i1 is the smallest element of {i1, . . . , in−2}, we have

i1 + · · · + in−2 + in ≥ −(n − 2)(

n−1Xm=2

Γ1m + 1) + in

(5.62)

and therefore

in ≤ −Γ − n + 1 + (n − 2)(

n−1Xm=2

Γ1m + 1)

(5.63)

by (5.57). Thus by (5.51), we have

g ∈ Ω(3)[[yi − yj | 1 ≤ i < j ≤ n]][(y1 − yn)−1, . . . , (yn−1 − yn)−1].

(5.64)

Since g is homogeneous of total degree Γ, we have

g ∈ Ω(3)[(y1 − yn)±1, . . . , (yn−1 − yn)±1]

(5.65)

and therefore there exists

ϕ(a1, . . . , an−2, u, v|y1, . . . , yn) ∈ Ω(3)[(yi − yj)±1 | 1 ≤ i < j ≤ n]

(5.66)

A generalization of intertwining operators

29

such that

ι(n−1,n)ϕ(a1, . . . , an−2, u, v|y1, . . . , yn)
= ϕ( ˆYW1(a1, . . . , an−2, u|y1, . . . , yn−2, yn−1), v|yn−1, yn)

(5.67)

by the deﬁnition (5.49) of g. If one put

fn(a1, . . . , an−2, u, v|y1, . . . , yn)
= ϕ(a1, . . . , an−2, u, v|y1, . . . , yn), n = 2, 3, . . .

(5.68)

for a1, . . . , an−2 ∈ V, u ∈ W1 and v ∈ Ω(2), then fn (n = 2, 3, . . .)
satisfy (5.33)–(5.36) by (5.67). It follows from Lemma 5.2 that there
exists a map Φ : S(W1, Ω(2)) → Ω(3) such that
Φ(YS(W1,Ω(2))(a1, y1 − yn) · · · , YS(W1,Ω(2))(as, ys − yn)

× YS(W1,Ω(2))(u, yn−1 − yn)
× YS(W1,Ω(2))(as+1, ys+1 − yn) · · · YS(W1,Ω(2))(an−2, yn−2 − yn)v)
= ι(1,n),...,(s,n),(n−1,n),(s+1,n),...,(n−2,n)ϕ(a1, . . . , an−2, u, v|y1, . . . , yn)

(5.69)

for a1, . . . , an−2 ∈ V, u ∈ W1, v ∈ Ω(2), and s = 1, . . . , n − 2.

We deﬁne an A(V )-module homomorphism µ′ : Ω∗

(3) → S(W1, Ω(2))′(0)

by

hµ′(w′

(3)), ui = hw′

(3), Φ(u)i

(5.70)

(3) ∈ Ω∗

for w′
eralized Verma module S(Ω∗

3 and u ∈ S(W1, Ω(2))(0). By the universality of the gen-
(3)), we have a V -module homomorphism
(3)) → S(W1, Ω(2))′

µ′ : S(Ω∗

(5.71)

and therefore its dual

µ′′ : S(W1, Ω(2))′′ → S(Ω∗

(3))′.

Restricting µ′′ to S(W1, Ω(2)), we have

µ : S(W1, Ω(2)) → S(Ω∗

(3))′.

Then the map

W1 ⊗C S(Ω2) → S(Ω∗

u ⊗ v 7→Xi∈Z

(3))′((x))
µ(u(i)v)x−i−1.

(5.72)

(5.73)

(5.74)

A generalization of intertwining operators

30

is the desired Z-graded intertwining operator by the deﬁnition of µ.

The following result is a direct consequence of Theorem 5.3.

Corollary 5.4. Let Wi = ⊕∞
weak V -modules such that W2 and W ′
and dimC W3(j) < ∞ for all j ∈ N. Then, the map

j=0Wi(j), i = 1, 2, 3 be three N-graded
3 are generalize Verma V -modules

IZ(cid:18) W3

W1 W2(cid:19) → HomA(V )(A(W1) ⊗A(V ) W2(0), W3(0))

Φ( , x) 7→ oΦ

is a linear isomorphism.

(5.75)

Remark 5.5. For arbitrary c, h ∈ C, Mc,h denotes the Verma module
for the Virasoro algebra of central charge c with lowest weight h and
Mc denotes the quotient space of M (c, 0) by the submodule generated
by L(−1)1 where 1 is a lowest weight vector of weight 0 for M (c, 0).
Then, Mc is a vertex operator algebra and Mc,h is an Mc-module (cf.
[12]).
If V = Mc and W1 = Mc,h in Theorem 5.3, then using the
same computation as in [13, Section 2], we can describe the right-
hand side of (5.46) as follows. It is shown in [7, Section 4] (see also
[6, Proposition 3.1]) that

A(Mc) → C[t]

(L(−2) + L(−1))n 7→ tn, n ∈ N

(5.76)

and

A(Mc,h) → C[t1, t2]

(L(−2) + 2L(−1) + L(0))m((L(−2) + L(−1))nvh 7→ tm

1 tn

2 , m, n ∈ N
(5.77)

are isomorphisms where vh is a non-zero element of M (c, h) with
weight h and the C[t]-bimodule structure on C[t1, t2] is given by

tn · f (t1, t2) = tn
f (t1, t2) · tn = tn

1 f (t1, t2) and
2 f (t1, t2)

for n ∈ N and f (t1, t2) ∈ C[t1, t2]. Thus, we have

HomA(Mc)(A(Mc,h) ⊗A(Mc) Ω(2), Ω(3))
∼= HomC[t](C[t1, t2] ⊗C[t] Ω(2), Ω(3))
∼= HomC(Ω(2), Ω(3)).

(5.78)

(5.79)

A generalization of intertwining operators

31

6 Notation

M [x, x−1][p,q]
A(V )
A(M )
Resx f (x)

W1 W2(cid:1)
I(cid:0) W3
W1 W2(cid:1)
Ilog(cid:0) W3
IZ(cid:0) W3
W1 W2(cid:1)

Ω(2), Ω(3)
∆
T (U )
T (W1, Ω(2))
F (W1, Ω(2))
S(U ) = ⊕∞

j=0S(U )(j)

J(W1, Ω(2))
S(W1, Ω(2))
U{y1,...,yn}
ι(i,j)
ι(i1,j1),...,(ik,jk)
W ∗
W ′

i=∆ Vi.

i=p uixi | up, up+1, . . . , uq ∈ M }.

the Zhu algebra of a vertex operator algebra V .
the A(V )-bimodule associated with a weak V -module M .

= {Pq
= f−1 for f (x) =Pi∈Z fixi.
W1 W2(cid:1).
the space of all intertwining operators of type (cid:0) W3
W1 W2(cid:1).
the space of all logarithmic intertwining operators of type (cid:0) W3
the space of all Z-graded intertwining operators of type (cid:0) W3
W1 W2(cid:1).
V =L∞

left A(V )-modules.

the tensor algebra of a vector space U .
= T ((V ⊕ W1 ⊕ Ω(2))[t, t−1]).
= T (V [t, t−1]) ⊗C W1[t, t−1] ⊗C T (V [t, t−1]) ⊗C Ω(2).
the generalized Verma module with S(U )(0) = U
where U is a left A(V )-module.
Deﬁnition 5.1.
= F (W1, Ω(2))/J(W1, Ω(2)), (5.14).
= U [[yi − yj | 1 ≤ i < j ≤ n]][(yi − yj)−1 | 1 ≤ i < j ≤ n], (5.18).
a linear map U{y1,...,yn} → U{y1,..., byi,...,yn}((yi − yj)) deﬁned by (5.19).
(5.23) and (5.24).
= HomC(W, C).
= ⊕∞

i=0 HomC(W (i), C) for W = ⊕∞

i=0W (i).

Acknowledgements

I thank Haisheng Li for useful comments.

References

[1] T. Abe, Fusion rules for the free bosonic orbifold vertex operator

algebra, J. Algebra 229 (2000), 333–374.

[2] T. Abe, Fusion rules for the charge conjugation orbifold, J. Al-

gebra 242 (2001), 624–655.

[3] T. Abe, C. Dong and H. Li, Fusion rules for the vertex operator
L . Comm. Math. Phys. 253 (2005), 171–

algebras M (1)+ and V +
219.

A generalization of intertwining operators

32

[4] R. Borcherds, Vertex algebras, Kac-Moody algebras, and the

Monster, Proc. Nat. Acad. Sci. U.S.A. 83 (1986), 3068–3071.

[5] C. Dong, H.S. Li and G. Mason, Twisted representations of vertex

operator algebras, Math. Ann. 310 (1998), 571–600.

[6] C. Dong, G. Mason and Y. Zhu, Discrete series of the Virasoro
algebra and the moonshine module, Algebraic groups and their
generalizations: quantum and inﬁnite-dimensional methods (Uni-
versity Park, PA, 1991), 295–316, Proc. Sympos. Pure Math., 56,
Part 2, Amer. Math. Soc., Providence, RI, 1994.

[7] I. B. Frenkel and Y. Zhu, Vertex operator algebras associated to
representations of aﬃne and Virasoro algebras. Duke Math. J. 66
(1992), 123–168.

[8] I. B. Frenkel, Y. Huang and J. Lepowsky, On axiomatic ap-
proaches to vertex operator algebras and modules, Mem. Amer.
Math. Soc. 104, 1993.

[9] I. B. Frenkel, J. Lepowsky and A. Meurman, Vertex Operator
Algebras and the Monster, Pure and Applied Math., Vol. 134,
Academic Press, 1988.

[10] Y. Z. Huang, J. Lepowsky and L. Zhang, A logarithmic general-
ization of tensor product theory for modules for a vertex operator
algebra, Internat. J. Math. 17 (2006), 975–1012.

[11] Y. Z. Huang and J. Yang, Logarithmic intertwining operators
and associative algebras, J. Pure Appl. Algebra 216 (2012), 1467–
1492.

[12] J. Lepowsky and H. S. Li, Introduction to Vertex Operator Al-
gebras and their Representations, Progress in Mathematics, 227,
Birkhauser Boston, Inc., Boston, MA, 2004.

[13] H. S. Li, Determining fusion rules by A(V )-modules and bimod-

ules, J. Algebra 212 (1999), 515–556.

[14] A. Milas, Weak modules and logarithmic intertwining operators
for vertex operator algebras, Recent developments in inﬁnite-
dimensional Lie algebras and conformal ﬁeld theory (Char-
lottesville, VA, 2000), 201–225, Contemp. Math., 297, Amer.
Math. Soc., Providence, RI, 2002.

[15] A. Milas, Logarithmic intertwining operators and vertex opera-

tors, Comm. Math. Phys. 277 (2008), 497–529.

A generalization of intertwining operators

33

[16] K. Tanabe, On intertwining operators and ﬁnite automorphism
groups of vertex operator algebras, J. Algebra 287 (2005), 174–
198.

[17] K. Tanabe, A generalization of twisted modules over vertex al-
gebras, Journal of the Mathematical Society of Japan 67 (2015),
1109–1146.

[18] K. Tanabe and H. Yamada, The ﬁxed point subalgebra of a lat-
tice vertex operator algebra by an automorphism of order three,
Paciﬁc Journal of Mathematics 230 (2007), 469–510.

[19] K. Tanabe and H. Yamada, Fixed point subalgebras of lattice ver-
tex operator algebras by an automorphism of order three, Journal
of the Mathematical Society of Japan 65 (2013), 1169–1242.

[20] A. Tsuchiya and Y. Kanie, Vertex operators in conformal ﬁeld
theory on P1 and monodromy representations of briad group,
Conformal Field Theory and Solvable Lattice Models, Advanced
Studies in Pure Math., 16, Kinokuniya, Tokyo, (1988), 297–372.

[21] Y. Zhu, Modular invariance of characters of vertex operator al-

gebras, J. Amer. Math. Soc. 9 (1996), 237–302.

