Noname manuscript No.
(will be inserted by the editor)

Adjoint Multi-Start Based Estimation of Cardiac
Hyperelastic Material Parameters using Shear Data

Gabriel Balaban · Martin S. Alnæs ·
Joakim Sundnes · Marie E. Rognes

6
1
0
2

 
r
a

 

M
1
1

 
 
]

.

O
T
o
i
b
-
q
[
 
 

1
v
6
9
7
3
0

.

3
0
6
1
:
v
i
X
r
a

Abstract Cardiac muscle tissue during relaxation is commonly modelled as a
hyperelastic material with strongly nonlinear and anisotropic stress response.
Adapting the behavior of such a model to experimental or patient data gives
rise to a parameter estimation problem which involves a signiﬁcant number
of parameters. Gradient-based optimization algorithms provide a way to solve
such nonlinear parameter estimation problems with relatively few iterations,
but require the gradient of the objective functional with respect to the model
parameters. This gradient has traditionally been obtained using ﬁnite diﬀer-
ences, the calculation of which scales linearly with the number of model param-
eters, and introduces a diﬀerencing error. By using an automatically derived
adjoint equation, we are able to calculate this gradient more eﬃciently, and
with minimal implementation eﬀort. We test this adjoint framework on a least
squares ﬁtting problem involving data from simple shear tests on cardiac tis-
sue samples. A second challenge which arises in gradient-based optimization
is the dependency of the algorithm on a suitable initial guess. We show how
a multi-start procedure can alleviate this dependency. Finally, we provide es-
timates for the material parameters of the Holzapfel and Ogden strain energy
law using ﬁnite element models together with experimental shear data.

G. Balaban, M. S. Alnæs, J. Sundnes, M. E. Rognes
Simula Research Laboratory
P.O. Box 134 1325 Lysaker, Norway
Tel.: +47 67 82 82 00
Fax: +47 67 82 82 01
E-mail: gabrib@simula.no

G. Balaban, J. Sundnes
Department of Informatics
University of Oslo
P.O. Box 1080 Blindern 0316 Oslo, Norway

M. E. Rognes
Department of Mathematics
University of Oslo
P.O. Box 1053 Blindern 0316 Oslo, Norway

2

Gabriel Balaban et al.

Keywords cardiac mechanics · adjoint equation · parameter estimation ·
hyperelasticity · multi-start optimization

1 Introduction

The personalization of computational models in cardiology is a key step to-
wards making models useful in clinical practice and cardiac surgery. A compu-
tational model, once properly calibrated, has the potential to forecast cardiac
function and disease, and can aid in planning treatments and therapies. To
describe the mechanical function of the heart, the passive elasticity of the mus-
cle tissue needs to be represented. Personalizing the eﬀects of this elasticity in
a computational model is typically accomplished by tuning a set of material
parameters so that the output of the model ﬁts observed data. Gradient-based
optimization algorithms have successfully been used in the past to automati-
cally perform the parameter tuning at an organ scale [2, 29]. In these studies,
the gradient of the objective functional is approximated using one-sided ﬁnite
diﬀerences.

Compared to using a global optimization method, local gradient-based
methods have the advantage of using relatively few optimization iterations.
This is an important consideration when optimizing organ scale ﬁnite element
models, for which running a single forward model can take hours or days.
On the other hand, a disadvantage of using local optimization methods is the
fact that they can converge to local, globally suboptimal, minima. One way
to combine the speed of a local optimization with the robustness of a global
optimization is to use the multi-start method. In this method, many local op-
timizations are run starting from various points in parameter space and the
best ﬁtting solution of the group is taken to be the global optimum.

Another popular approach to parameter ﬁtting is the reduced order un-
scented Kalman ﬁlter. This approach was successfully used to ﬁt a transversely
isotropic passive mechanics model to synthetic data [31], to partially calibrate a
multi-physics model [21], and to estimate regional contractility parameters [5].
Note however that the use of both unscented Kalman ﬁltering and ﬁnite dif-
ferences carries a computational cost that increases with the number of model
parameters.

Assuming there are k parameters to be estimated, an unscented Kalman
ﬁlter with a minimal sigma-point conﬁguration requires k + 1 model evalua-
tions at a single time level for each assimilated data point. An evaluation of a
ﬁnite diﬀerence derivative on the other hand requires k + 1 runs of the model
throughout the full span of model conﬁgurations considered.

In contrast to these two techniques, the adjoint approach computes the
objective functional gradient via the solution to an adjoint equation, which
involves only a single solve of a linearized system for any number of model
parameters. Thus, for models involving many parameters, either due to model
complexity or spatiotemporal parameter variation, the adjoint approach oﬀers
a computationally attractive approach for parameter estimation.

Adjoint-based multi-start cardiac parameter estimation

3

There are some previous results involving adjoint equations and cardiac
elasticity. Sundar et al. (2009) developed a framework for the estimation of wall
motion based on cine-MRI images and adjoint inversion [26], and Delingette
et al. (2012) used an adjoint equation to estimate contractility parameters [7].
However, both of these studies involve linear and isotropic elasticity mod-
els, which represent a signiﬁcant simpliﬁcation of the orthotropic and highly
nonlinear behavior reported in the contemporary cardiac mechanics litera-
ture [6, 8, 15].

One reason why it is diﬃcult to use an adjoint equation with modern
nonlinear anisotropic models is the complexity required in deriving and imple-
menting code for the solution of the adjoint problem. In order to resolve this
issue, we make use of an automatic framework for generating adjoint code [9].
Here, we use this adjoint framework to estimate the material parameters of an
invariant-based orthotropic myocardial strain energy law (the Holzapfel-Ogden
model) [15]. This law is embedded here in an incompressible ﬁnite element
framework, and we use the raw data from a simple shearing experiment [8]
as a target for optimization. These data have previously been used to esti-
mate material parameters for a variety of other strain energy functions using
a ﬁnite element framework, but with a gradient obtained using ﬁnite diﬀer-
ences [24, 25]. The material parameters of the particular strain energy density
that we are using have also been previously estimated using digitized data
based on Figure 6 of [8], and a homogeneous deformation model [12, 15, 28].
Our study is however the ﬁrst to use the adjoint approach for the estima-
tion of cardiac hyperelasticity parameters and the ﬁrst to provide optimized
material parameters for the incompressible Holzapfel-Ogden model for non-
homogeneous shear deformations.

The rest of this paper is organized as follows. In Section 2 we describe
the variational formulation of the elasticity model, the optimization problem
for identifying the material parameters, and how the adjoint gradient formula
can be used to calculate a functional gradient. In Section 3 we describe the
veriﬁcation of the forward and inverse solvers, present timings to show the ef-
ﬁciency of the adjoint method, and show the results of parameter estimations.
Finally, we test a multi-start optimization method in order to reduce the de-
pendence of the gradient-based algorithm on the choice of initial parameter
set. We conclude by discussing our ﬁndings in Section 4, and drawing some
conclusions in Section 5.

2 Mathematical models and methods

We shall use the notion of the directional derivative frequently throughout.
For a functional f : Y → R for some vector space Y , we deﬁne the directional
derivative of f with respect to the argument named y in the direction δy

Dyf (y)[δy] ≡ ∂
∂

f (y +  δy)

(cid:12)(cid:12)(cid:12)=0

.

4

Gabriel Balaban et al.

Furthermore we denote the total derivative by the usual notation Df
the derivative of f with respect to all arguments depending on y.

Dy to mean

2.1 Hyperelasticity model
Let Ω ⊂ R3 be an open and bounded domain with coordinates X and bound-
ary ∂Ω, occupied by an incompressible hyperelastic body. We consider the
quasi-static regime of a body undergoing a large deformation x = x(X) and
are interested in ﬁnding the displacement u = u(X) = x − X and the hy-
drostatic pressure p = p(X) that minimize the incompressible strain energy
Π = Π(u, p, m):

Π(u, p, m) =

ψ(C, m) + p(J − 1) dx

(1)

(cid:90)

Ω

over the space of admissible displacements and pressures satisfying any given
Dirichlet boundary conditions. In (1), m is a set of material parameters,
J = det F, where F = ∇ x = ∇ u + I denotes the deformation gradient, I
is the identity tensor in R3, C = J− 2
3 FT F denotes a volume-preserving right
Cauchy-Green strain tensor, and ψ denotes an isochoric strain energy density.
The incompressible Holzapfel and Ogden hyperelasticity model [15] de-
scribes large deformations and stresses in cardiac tissue via the following en-
ergy density ψ:

ψ(C, m) =

a
2b

+

+

(cid:0)exp(cid:2)b(I1(C) − 3)(cid:3) − 1(cid:1)
(cid:88)
(cid:0)exp(cid:2)bi(I4i(C) − 1)2(cid:3) − 1(cid:1)
8f s(C)(cid:3) − 1(cid:1) .
(cid:0)exp(cid:2)bf sI 2

h(I4i(C))ai

2bi

i=f,s
af s
2bf s

(2)

Here f, s denote ﬁber and sheet directions, respectively; h(x) is a Heaviside
function with a jump at x = 1, and the material parameters are

m = (a, b, af , bf , as, bs, af s, bf s).

Moreover, I1, I4s, I4f , I 2

8f s are rotation invariant functions given by

I1(C) = tr C
I4i(C) = ei· Cei
I8f s(C) = es· Cef

i = f, s

(3)

(4)

where tr denotes the tensor trace and ef , es denote unit vectors pointing in
the local myocardial ﬁber and sheet directions [15]. The strain energy density
ψ is rotation-invariant, and polyconvex if m > 0 [15].

Adjoint-based multi-start cardiac parameter estimation

5

The Euler-Lagrange equations for the minimizing displacement u and pres-

sure p of (1) read: for given m, ﬁnd w = (u, p) such that

R(w, m; δw) ≡ Du,pΠ(u, p, m)[δu, δp] = 0,

(5)

for all admissible virtual variations δw = (δu, δp). Inserting the total potential
energy from (1) and taking the directional derivatives, we obtain

(cid:19)

dx.

(6)

Du,pΠ(u, p, m)[δu, δp] =

+ pJF−T

: ∇ δu + (J − 1)δp

(cid:90)

(cid:18)(cid:18) ∂ψ(C, m)

Ω

∂F

(cid:19)

2.2 Parameter estimation as a PDE-constrained optimization problem

In the general case, the passive material parameters m entering the consti-
tutive relationship (2) are not known. In order to estimate these parameters
from data, we propose to use a numerical approximation in combination with
a gradient-based optimization algorithm in which the gradients are computed
via an adjoint model. The optimization algorithm seeks to minimize the mis-
ﬁt between model output and observations. Denoting the misﬁt functional by
I = I(w(m), m), the optimization problem reads:

min
m

I(w(m), m)

subject to

R(w, m; δw) = 0 ∀δw ∈ W,

(7)

together with suitable Dirichlet boundary conditions on w. We also require
that m > 0 to ensure the functional (1) is polyconvex [15]. For notational con-
venience we will sometimes use the reduced formulation of the misﬁt functional
and its gradient with respect to the material parameters m. In particular, we
introduce the reduced functional ˆI

ˆI(m) ≡ I(w(m), m).

(8)

In our numerical experiments we use Sequential Least Squares Programming
(SLSQP) as implemented in [18] and wrapped in the package SciPy [17] in
order to solve (7).

2.3 Multi-start Optimization

A common challenge with gradient-based algorithms is that the solution ob-
tained depends on the choice of initialization point for the algorithm. More-
over, the optimized solution may be a local minimum only and not necessarily
a global minimum. One way to attack these issues is to run many optimiza-
tions from randomly chosen initial parameter points, and to chose the resulting
optimized material parameter set that gives the best ﬁt. This method is of-
ten referred to as multi-start optimization [4] and is an example of combining
global and local optimization.

6

Gabriel Balaban et al.

Due to the presence of exponential functions in the strain energy (2), it is
possible for calculated stresses to become very large, which may result in con-
vergence issues for the numerical solution of the Euler-Lagrange equation (5).
This can easily occur if several material parameters have large values. In order
to minimize this problem we have designed a procedure to generate random
initial guesses which limits the number of large material parameter values while
still allowing for a large range of initial possible values for each parameter. The
procedure works as follows: ﬁrst set a maximum parameter value Pmax. Then
choose N (with N = 8 in our case) points pi, i ∈ {1, 2, 3...n}, from a uniform
distribution deﬁned over the interval [0, Pmax] and let p0 = 0. The parameter
values mi are then set to be the distances between successive randomly drawn
points, that is mi = pi − pi−1.

2.4 Computing the functional gradient via the adjoint solution

Gradient-based optimization algorithms in general, and the SLSQP algorithm
in particular, rely on the total derivative of the objective functional (8). By
introducing an adjoint state variable, this derivative may be computed eﬃ-
ciently. We summarize this result below. Our presentation is based on [14],
and is adapted here to the solid mechanics setting.

We deﬁne three abstract spaces W , M , and Φ, where W is the space of all
possible solutions to the variational equation (5) which also satisfy any given
Dirichlet boundary conditions, M is the material parameter vector space, and
Φ is the space of virtual variations. The Lagrangian L : W × M × Φ → R is
deﬁned as:

L(w, m, φ) = I(w, m) − R(w, m; φ).

(9)

For all m ∈ M , w ∈ W solving the state equation (5), we have

D
Dm

R(w(m), m; φ) = 0,

such that the total derivatives of I and L coincide,

D
Dm

I(w(m), m) =

If we choose φ ∈ Φ such that

D
Dm

L(w(m), m, φ).

(10)

DwL(w, m, φ)[δw] = 0

(11)
for all δw ∈ W , which in particular includes δw = Dmw(m)[δm], the total
derivative of L with respect to m in the direction δm simpliﬁes as follows
using the chain rule:

D
Dm

L(w(m), m, φ) = DwL(w, m, φ)[Dmw(m)[δm]] + DmL(w, m, φ)[δm]

= DmL(w, m, φ)[δm]

(12)

Adjoint-based multi-start cardiac parameter estimation

7

Then, for any inﬁnitesimal variation in the material parameters δm, combin-
ing (10), (12), and (9) yields an eﬃcient evaluation formula, not requiring
derivatives of the state variable w with respect to the material parameters m,
for the total derivative of I:

I(w(m), m) = DmI(w, m)[δm] − DmR(w, m, φ)[δm].

(13)

D
Dm

We still need to compute φ. By deﬁning the form Rw and its adjoint R∗
w,

Rw(w, m; δw, φ) ≡ DwR(w, m; φ)[δw],
w(w, m; φ, δw) ≡ Rw(w, m; δw)[φ],
R∗

we can rewrite (11) as

DwL(w, m, φ)[δw] = DwI(w, m)[δw] − R∗

w(w, m; φ, δw) = 0,

and thus recognize the adjoint equation: given m, w, ﬁnd φ ∈ Φ such that

R∗
w(w, m; φ, δw) = DwI(w, m)[δw]

(14)

for all δw ∈ W .

In summary, the adjoint-based gradient evaluation formula is: given m, ﬁrst
compute w by solving the state equation (5), next compute φ by solving (14),
and ﬁnally evaluate (13).

2.5 Description of shearing experiments

We aim to optimize the material parameters of the Holzapfel-Ogden model (2)
with respect to target experimental data, in particular data resulting from an
earlier set of simple shearing experiments [8]. In these experiments, 6 pig hearts
were extracted. From each heart, three adjacent 3mm × 3mm × 3mm cubic
blocks were cut in such a way that the sides of the cubes were aligned with
the local myocardial ﬁber and sheet directions. A device held two opposing
faces of each cube between two plates using an adhesive. The top plate was
displaced in order to put each specimen in simple shear. For each specimen
6 diﬀerent modes of shear were tested. These modes are described using the
F, S, N coordinate system, which refer to the myocardial ﬁber, sheet and sheet
normal directions, respectively. Each mode is denoted by two letters, where
the ﬁrst deﬁnes the normal of the face of the cube that is being displaced,
and the second refers to the direction of displacement. These 6 modes are
F S, F N, SF, SN, N F, N S.

In order to remove the eﬀects of strain softening, preliminary displacements
were applied to the tissue samples until no further softening was observed.
After that, displacements were once again applied, and the forces in the shear
direction were measured on the top plate. These measurements were taken for
circa 200 − 250 various states of shear per mode.

8

Gabriel Balaban et al.

In Figure 1 we display the stress-strain relations for positive displacements
that were obtained from the shearing experiments [8]. As can be seen in Figures
4 and 6 of [8] the experimentally obtained curves contain a high degree of
symmetry through the line y = −x. We can expect the same symmetry in the
stresses computed by ﬁnite element models which use the strain energy (2)
since changing the sign of the displacement map will change the sign of the
resulting stresses but preserve their magnitude. In the previous studies [15],
[12], and [28], only the data for positive shear displacements were used. For
the sake of comparability, we restrict our data in the same way.

In our numerical experiments we use two data sets with reference to the
numbering of [8]. The ﬁrst is Data Set 6, and the second data is Data Set 2
with the SF and SN curves swapped. This swap and the choice of data sets
are discussed further in Section 4. For clarity, we shall refer to Data Set 6 as
”transversely isotropic” and Data Set 2 with the swap as ”orthotropic”, as the
respective stress-strain curves are typical of materials of these types. For each
mode, the prescribed shear displacement is modelled as a Dirichlet boundary
condition for the displacement on the respective top and bottom faces in the
respective direction.

2.6 Choice of objective functional

In order to estimate the passive material parameters of the Holzapfel-Ogden
model, we make use of a least squares objective functional. This functional
deﬁnes a distance from the model output to the data points of the shearing
experiment, and we seek the material parameter set m that minimizes this.
Before introducing our objective functional, we deﬁne the set of directions
D = {F, S, N}, referring to ﬁber, sheet and sheet normal directions. We also
use the notation (i, j) to refer to a mode, with the index i referring to the
normal of the face that is shifted, and j to the direction in which the shift
occurs.

Our ﬁt function is similar to that used in [23], and is given by

ˆI(m)2 =

ωk

model(ck, m) − ti,j
ti,j

exper(ck)

(15)

(cid:88)

(cid:88)

G(cid:88)

i∈D

j∈D

k=1

(cid:16)

(cid:17)2

exper is the force measured during the experiment, and ti,j

In (15), ti,j
model is the
force generated by the ﬁnite element model at each prescribed shear displace-
ment ck ∈ [0, C i,j], where C i,j is the maximal prescribed displacement of the
mode (i, j) in the experiment. Each ck is chosen to be a Gauss point of a
G-point Gauss integration rule deﬁned over [0, C i,j], and ωk is the value of the
Gauss weight related to ck. Explicitly, for mode (i, j) with top face ∂Ωi, ti,j
is given by

model

(cid:90)

ti,j
model(ck, m) =

∂ψ(u(ck), m)

∂Ωi

∂Fi,j

dS,

(16)

Adjoint-based multi-start cardiac parameter estimation

9

Fig. 1 Stress-strain relations, numbered 1 through 6, obtained from simple shearing exper-
iments performed on 3mm × 3mm × 3mm cubes of myocardium extracted from 6 porcine
hearts. The modes are ordered from highest to lowest stiﬀness in each experiment. The data
originates from the study [8], but were not published in the subsequent article. In Experi-
ment 4 the data for one of the NS-NF curves was copied into the other before we received
it, so the two curves lie here on top of one another.

where Fi,j = ei· Fej is a shear component of the deformation gradient. Eval-
uating the inner loop of ˆI requires solving (5) once for each given shear dis-
placement ck. The motion given by the calculated displacements is then a
quasi-static approximation of the motion undergone by the corresponding tis-
sue in the shearing experiment.

Following [23], we evaluate the least squares ﬁt (15) at G Gauss integration
points, rather than for all 250 recorded points for each shear mode, in order to

10

Gabriel Balaban et al.

greatly reduce the computational expense of evaluating ˆI. At each Gauss point
we obtain the corresponding shear stress by linearly interpolating between the
two neighbouring stresses which were recorded in the experiments of Dokos et
al. [8].

The use of Gauss integration is based on the observation that ˆI(m) is an

approximation to the following expression

(cid:88)

(cid:90) Ci,j

(cid:16)

(cid:88)

j∈D

i∈D

0

(cid:17)2

 1

2

ti,j
model

(c, m) − ti,j

exper(c)

dc

.

(17)

By setting ti,j

= 0 and approximating the integral by the midpoint
rule applied to the full dataset we can determine the quality of the Gauss
approximation. In order to do this we deﬁne the relative error

model

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12) ˆI − ˆImid

ˆImid

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12) ,

rel =

(18)

where Imid is the midpoint rule approximation of (17) evaluated over the full
data, and I, given by (15), is evaluated at a reduced set of Gauss points.
We noticed that 9 Gauss points are suﬃcient to reduce rel to less than 0.01.
However, in our numerical experiments we use G = 40 Gauss points as this
guaranteed small enough changes in the solution of the Euler-Lagrange equa-
tion (5) from one Gauss point to the next, so that our Newton’s method
solution of (5) always converged.

2.7 Finite element discretization of the hyperelasticity equations

We represent each tissue sample of the shearing experiments by a three-
dimensional cube Ω = [0, 3]3 (mm3). An N × N × N mesh of this cube was
constructed by uniformly dividing the mesh into N × N × N boxes and then
subdividing the boxes into tetrahedra. The local myocardial ﬁber and sheet
orientations were represented as spatially constant vectors aligned with the
coordinate axes.

On these geometries, we solve (5) and its adjoint, using a Galerkin ﬁnite
element method with the Taylor-Hood ﬁnite element pair [16]; e.g. a contin-
uous piecewise quadratic vector ﬁeld for the displacement and a continuous
piecewise linear scalar ﬁeld for the pressure. For the solution of the nonlinear
system of equations, we use a Newton trust region method. The absolute tol-
erance of the nonlinear solver was set to 10−10 in the numerical experiments
below. Linear systems are solved by LU factorization.

Additionally, we model the case of a homogeneous deformation which cor-
responds to a linear displacement with a constant shear angle throughout the
domain. Such a model can be represented by discretizing the cubes with a
single layer of linear ﬁnite elements: the resulting displacement is completely

Adjoint-based multi-start cardiac parameter estimation

11

Fig. 2 Finite element representation of cubes of cardiac tissue undergoing simple shear in
the NS mode. The bottom of the cube is ﬁxed and the top displacement is given. Left:
homogeneous deformation with a constant shear angle. Right: ﬁnite element solution on a
6 × 6 × 6 mesh. The plot shows the value of the NS-component of the right Cauchy Green
strain tensor C.

determined by the prescribed boundary conditions. Figure 2 illustrates the
two kinds of deformations on cube meshes.

The discrete variational formulation of the Euler-Lagrange equations is
implemented using the FEniCS Project software [1, 20] and dolﬁn-adjoint [9].
From a FEniCS forward model, dolﬁn-adjoint automatically generates the
symbolic adjoint system of equations and computes the functional gradient (13)
using the adjoint solution. The FEniCS framework automatically generates
and compiles eﬃcient C++ code for the assembly of the relevant linear sys-
tems from the symbolic representations of both forward and adjoint equations,
and solves the nonlinear and linear systems using e.g. PETSc [3]. With this
setup, we observed that a typical solution of the Euler-Lagrange equation (5)
takes 6 Newton iterations.

3 Numerical Results

3.1 Veriﬁcation

Each of the ﬁnite element, adjoint, and optimization solvers have been carefully
veriﬁed, separately and combined, as follows:

(i) The ﬁnite element solver was veriﬁed by the method of manufactured
solutions [22]. Following this method we chose an analytic expression for the
displacement and pressure ﬁelds

(cid:16)

(cid:17)
3tx2+1 − 1

1

(cid:17)

, 0

(cid:16)

tx3, y

u =
p = 0.

(19)

0.10.20.30.40.5Shear Strain0.003590.54512

Gabriel Balaban et al.

Here x, y refer to Cartesian coordinates and t is a scaling parameter which we
set to t = 0.2. Using this analytic expression we derived Dirichlet boundary
conditions over a unit cube, and a loading term f which satisﬁed a pointwise
form of equation (6)

∂ψ(C, m)

∂F

+ pJF−T = f

inΩ.

(20)

Note that the chosen displacement ﬁeld satisﬁes the incompressibility con-
straint J − 1 = 0. We then computed ﬁnite element approximations to (19)
and observed the expected second-order convergence of the displacement gra-
dient to the analytical displacement gradient [16].

(ii) We veriﬁed the computation of stresses in the ﬁnite element model by
prescribing a homogeneous deformation and comparing the resulting numeri-
cally integrated top face shear stress values to analytically computed values.
The analytic values were based on the calculations found in [15, Section 5a]
and the numerical values were observed to match closely.

(iii) We conﬁrmed the correctness of the adjoint gradients by considering
the linearization of the functional ˆI(m) around m with perturbation ∆m and
using Taylor’s theorem: the expression
ˆI(m) − ˆI(m + ∆m) +

(21)
converged to 0 at a rate of 2 as ∆m −→ 0, which can only be expected if
D ˆI(m)
Dm is computed accurately.

(∆m) = O(∆m2)

D ˆI(m)

Dm

3.2 Parameter estimation with synthetic data

Additionally, we veriﬁed the optimization solver by performing a synthetic
data test. In this test we chose a target set of material parameters, Table 1,
2nd line, and used them to compute synthetic integrated stress values for
all 6 shear modes of the tissue experiment [8]. These synthetic stresses were
then matched by an optimization starting from material parameter values 25%
higher than the target.

We performed this test using our two models for deformation. The ﬁrst
model assumed a homogeneous shear angle through the material and the sec-
ond model was a ﬁnite element model with a 1×1×1 mesh. Since the displace-
ment ﬁeld of the ﬁnite element model was element-wise quadratic, it allowed
for more ﬂexibility in the deformation ﬁeld. The results of this synthetic data
test are presented in Table 1 and show that the optimization algorithm was
able to closely match the target material parameters.

3.3 Parameter estimation with experimental stress data

In the following, we present the results of ﬁtting the Holzapfel-Ogden strain
energy law (2) using the objective function (15) and a SLSQP optimizer with

Adjoint-based multi-start cardiac parameter estimation

13

Table 1 Synthetic data test results. The ﬁrst row (Initial) contains the material parameter
values used to initialize the algorithm, while the second row (Target) contains the parameters
that were used to generate the synthetic stresses. The rows marked ’Homogeneous’ and
’Finite Element’ contain optimized parameter values coming from homogeneous deformation
and ﬁnite element models. These optimized values are matched perfectly by the optimized
homogeneous model and very closely by the ﬁnite element model.

a
(kPa)

0.059
0.047
0.047
0.047

b

8.023
6.418
6.418
6.406

af
(kPa)

18.472
14.778
14.778
14.778

bf

16.026
12.821
12.821
12.821

as
(kPa)

2.481
1.985
1.985
1.983

bs

11.120
8.896
8.896
8.938

af s
(kPa)

0.216
0.173
0.173
0.173

bf s

11.436
9.149
9.149
9.155

I
(mN)

4.611 ×10−8
0.00082

Initial
Target (80%)
Homogeneous
Finite Element

bound constraints. The SLSQP algorithm makes use of the gradient of the
objective functional which we obtain using the adjoint gradient formula (13).
As the numerical solution of the nonlinear Euler-Lagrange equation (5)
easily fails to converge when a material parameter becomes too small, we
set a lower bound of 1.0 × 10−2 on the components of m while optimizing
ﬁnite element models. This bound was not necessary for the homogeneous
deformation models as no Euler-Lagrange equation is solved. All optimizations
were carried out until the optimizer was unable to further reduce the objective
functional or an absolute tolerance of 1.0×10−6 in the 2-norm of the functional
gradient was reached.

3.3.1 Material parameter estimation using a priori knowledge

The material parameters of the Holzapfel-Ogden model have previously been
estimated using a homogeneous deformation model (Table 1, 2nd row in [15]).
We ﬁrst used these values as the initial values for optimization of our homo-
geneous model targeting the transversely isotropic and orthotropic data sets.
The optimized results are listed in Table 2 with the label Homogeneous.
We next consider ﬁnite element models that allow for heterogeneous shear
displacements. Beginning with a 1 × 1 × 1 cube and the optimal material pa-
rameters from the homogeneous model as initial values, we computed optimal
values for the 1× 1× 1 case. This procedure was repeated for N × N × N cubes
with N = 2, 4, 6, 8, using the results of the previous optimization as the ini-
tial condition for the next case. The resulting parameter values are presented
in Table 2, and the corresponding optimal stress-strain curves are shown in
Figure 3.

We note that going from N = 8 to N = 10 using both the transversely
isotropic and the orthotropic data does not change the material parameters
rounded to two 2 signiﬁcant digits, and therefore consider our ﬁnite element
models to be suﬃciently reﬁned at this resolution. We also note that the ﬁt
values, I, decreased with mesh reﬁnement up to about 2 digits accuracy. We
expect this decrease since increased mesh reﬁnement gives more ﬂexibility in
the deformation ﬁeld of the ﬁnite element model.

14

Gabriel Balaban et al.

a
(kPa)

b

af
(kPa)

bf

as
(kPa)

bs

af s
(kPa)

bf s

I
(mN)

Ev. Grad
Ev.

Transversely Isotropic
Homogeneous
N = 1
N = 2
N = 4
N = 6
N = 8
N = 10

Orthotropic
Homogeneous
N = 1
N = 2
N = 4
N = 6
N = 8
N = 10

0.544
0.593
0.732
0.807
0.794
0.784
0.778

0.556
0.766
1.040
0.979
0.961
0.962
0.959

6.869
6.841
6.818
6.737
6.859
6.973
7.048

7.940
6.857
6.557
7.364
7.495
7.510
7.542

23.220
23.209
22.110
21.349
21.212
21.149
21.112

33.366
31.640
29.375
28.882
28.762
28.649
28.565

39.029
38.826
39.946
40.468
40.537
40.584
40.585

14.224
15.210
15.979
15.813
15.783
15.806
15.813

0.0001
0.010
0.010
0.010
0.010
0.010
0.010

2.804
2.069
1.742
2.058
2.088
2.044
2.017

0.172
0.010
0.010
0.010
0.010
0.010
0.010

0.0001
0.010
0.010
0.010
0.010
0.010
0.010

0.248
0.243
0.183
0.122
0.129
0.145
0.150

0.588
0.352
0.118
0.107
0.114
0.122
0.123

5.310
9.531
13.614
17.936
17.462
16.401
16.036

8.216
15.243
23.296
24.039
23.549
23.027
22.750

3.291
3.173
3.010
2.819
2.802
2.815
2.819

6.804
5.880
4.565
3.952
3.899
3.899
3.981

41
44
24
25
22
21
24

31
29
39
28
21
20
25

21
37
18
18
15
14
17

20
19
24
16
13
11
12

Table 2 Material parameters ﬁtted to the orthotropic and transversely isotropic datasets
for the Homogeneous and N × N × N ﬁnite element models. I refers to the value of the
objective functional. The number of functional evaluations (Ev.) and functional gradient
evaluations (Grad Ev.) are given in the two rightmost columns.

3.3.2 Material parameter estimation using multi-start optimization

In this section, we present the results of using the multi-start method to es-
timate the optimal material parameters, rather than relying on a good initial
guess. For the calculation of random initial guesses we set Pmax = 40, cf. Sec-
tion 2.3. This value is close to the largest material parameter found in Table 2.
Note that this choice gives a conservative set of initial parameters for the opti-
mization algorithm (low initial values) which in turn enhances the robustness
of the procedure. We also set 60 as an upper bound for each material parame-
ter value during the optimization. Without this upper bound we observed that
many optimizations crashed or converged to suboptimal local minima.

In each multi-start experiment, 30 random starting points were used. The
mesh ﬁneness was set to the level of N = 8, which was suﬃcient to give con-
verged material parameter sets when using a priori knowledge in Section 3.3.1.
In Table 3 we present the best ﬁtting results of the multi-start experiments
and note that they are very close to those obtained with a priori knowledge in
Table 2.

3.3.3 Objective functional values for alternative material parameters

Several other studies [12, 15, 28] have used of the Dokos et al. 2002 shear
data [8] to calibrate the Holzapfel and Ogden strain energy (2). These studies

Adjoint-based multi-start cardiac parameter estimation

15

Fig. 3 Comparison of optimized model stress-strain curves with experimental data. The
dots are interpolated experimental data at Gauss points, the solid lines show the output of
the ﬁnite element models with N = 8 elements per edge of the cube.

16

Gabriel Balaban et al.

Table 3 Results of ﬁtting material parameters to the transversely isotropic and orthotropic
data sets using the multi-start method. The rows labeled ’Multistart Best Fit’ correspond
to the optimizations with the lowest misﬁt value I. The rows labeled ’N = 8’ are copied
from Table 2 for reference.

a
(kPa)

b

af
(kPa)

bf

as
(kPa)

bs

af s
(kPa)

bf s

I
(mN)

Transversely Isotropic

N = 8
Multistart Best Fit

Orthotropic

N = 8
Multistart Best Fit

0.784
0.795

6.973
6.855

21.149
21.207

40.584
40.545

0.010
0.010

0.010
0.010

0.145
0.130

16.401
17.446

2.815
2.802

0.962
0.964

7.510
7.510

28.649
28.654

15.806
15.791

2.044
2.051

0.010
0.010

0.122
0.118

23.027
23.230

3.899
3.959

Table 4 Holzapfel-Ogden law parameter estimates from this and previous studies. If em
indicates the value of the ﬁt function (15) with model stresses from a ﬁnite element model
(N = 8), and Ihom the value of the same ﬁt function but with model stresses computed
with a homogeneous deformation model. The material parameters of the last two rows
originate from homogeneous and ﬁnite element model ﬁts respectively in Table 2. Note that
objective functional (I-) values for parameter sets from other studies are obtained using
the orthotropic data used in this study (experimental data), and not the data used in the
studies the parameter sets originate from (digitized data).

Source

Holzapfel et al 2009
Goektepe et al 2011
Wang et al 2013
Current (hom)
Current (fem)

a
(kPa)

0.059
0.496
0.2362
0.556
0.962

b

8.023
7.209
0.810
7.940
7.510

af
(kPa)

18.472
15.193
20.037
33.366
28.649

bf

16.026
20.417
14.154
14.224
15.806

as
(kPa)

2.481
3.283
3.7245
2.804
2.044

bs

11.120
11.176
5.1645
0.0001
0.010

af s
(kPa)

0.216
0.662
0.4108
0.587
0.122

bf s

11.436
9.466
11.300
8.216
23.027

Ihom
(mN)

36.143
28.583
33.271
6.804
41.622

If em
(mN)

36.825
29.480
34.195
9.653
3.899

used homogenized deformation models for the optimization. In Table 4 we list
the computed objective functional value of parameter sets originating from
previous studies using the orthotropic dataset and ﬁnite element model (N =
8). The results indicate that our parameter set ﬁts these data better than the
previously computed ones.

We also note that our ﬁnite element parameter set with ﬁnite element
model has a better ﬁt value than the homogeneous parameter set with the ho-
mogeneous model. Indeed we expect the ﬁnite element ﬁt to be at least as good
as the homogeneous ﬁt, as the ﬁnite element model allows for greater ﬂexibil-
ity in the the deformation ﬁeld, above and beyond that of the homogeneous
model.

3.4 Computational eﬃciency of the adjoint-based functional gradient

Adjoint solver eﬃciency may be measured by comparing the runtime of the
adjoint and forward solves. Here, we examine the overall gradient eﬃciency in

Adjoint-based multi-start cardiac parameter estimation

17

Fig. 4 Gradient eﬃciency: ratio of gradient evaluation runtime over single Newton iteration
runtime for increasing linear system sizes.

a similar manner. We consider the evaluation of the gradient of the objective
functional (15), though in a reduced case with only a single shear mode in-
cluded in the sum and a reduced forward solve consisting of a single nonlinear
solver iteration. In this case, the forward and adjoint models each consist of a
single linear solve in addition to a number of residual evaluations. For larger
linear system sizes, the runtime of a linear solve is expected to dominate the
runtime of assembly, and thus these forward and adjoint models are of roughly
the same computational expense.

For this reduced case, we evaluated the adjoint-based gradient for a range
of linear system sizes. For each system size, we calculated the gradient runtime
ratio; that is, the runtime used by the evaluation of the gradient divided by the
runtime of the forward solve. The resulting ratios are plotted in Figure 4. The
curve indicates that the gradient run-time ratio gets close to the theoretically
optimal value of 1 as we increase the system size.

010000200003000040000500006000070000Linearsystemsize1.01.52.02.53.03.5Runtimeratio18

4 Discussion

4.1 Choice of shearing experiment datasets

Gabriel Balaban et al.

Of the six shearing experiment datasets, cf. Figure 1, we have used two for
parameter estimation. One of the reasons for this choice is an incompatibility
of most of the datasets with assumptions made in the design of the strain
energy functional (2). In particular, the strain energy (2) dictates an ordering
of the shear mode stiﬀnesses in the case of a homogeneous shear displacement.
We can see this by adapting the analysis that leads to equations (5.23) – (5.28)
of [15]. In this analysis a parameter γ is introduced to represent the amount of
simple shear displacement present in a homogeneous deformation. For example
for the FS mode

 .

1 γ 0

0 1 0
0 0 1

F =

(22)

Using this deformation gradient, and the respective deformation gradients of
the other modes, the shear component of the Cauchy stress σ in the shearing
direction can be calculated for each mode. If we consider the same invariants
as in (2), that is I1, I4f , I4s, I8f s, and use the notation ψi = ∂ψ
, we arrive at
∂Ii
the following equations for shear stress as a function of shear displacement

(FS): σF S = 2(ψ1 + ψ4f )γ + ψ8f s,
(FN): σF N = 2(ψ1 + ψ4f )γ,
(SF): σSF = 2(ψ1 + ψ4s)γ + ψ8f s,
(SN): σSN = 2(ψ1 + ψ4s)γ,
(NF): σN F = 2ψ1γ,
(NS): σN S = 2ψ1γ.

(23)

For further details regarding the derivation of these equations we refer the
reader to [15]. The simple shear stresses (23) reveal two assumptions built
into the design of (2), namely for homogeneous simple shear deformations

σF S ≥ σF N ≥ σN F ,
σSF ≥ σSN ≥ σN F .

(24)

Out of the six datasets, only one is consistent with these orderings, namely
the 6th one, which was used here under the label transversely isotropic. In
this dataset the stress-strain relationship is typical of a transversely isotropic
material with a stiﬀer ﬁber direction. In several other cardiac mechanics sim-
ulation studies [10, 11, 19], the Holzapfel and Ogden energy functional (2) has
been simpliﬁed to model transversely isotropic behavior by removing the terms
involving the invariants I4s, I8f s. For such a simpliﬁed model one could use
the parameter estimates for a, b, af , bf that we obtained from the Transversely
Isotropic dataset.

Adjoint-based multi-start cardiac parameter estimation

19

However, the Holzapfel and Ogden model was originally proposed to model
orthotropic behavior. This motivates also targeting a dataset displaying fully
orthotropic properties. In particular, dataset 2 in Figure 1 is such and compares
well with Figure 6 of [8] and Figure 2 of [15]. By switching the SF and SN
curves of Dataset 2 we were able to reinterpret this data in a way that is
consistent with the interpretation in [15], and the shear stiﬀness orderings (24).

4.2 Discussion of optimal material parameter values

We have obtained two sets of material parameters: one corresponding to an
orthotropic case and one corresponding to a transversely isotropic case. We
observe that for both sets of material parameters, the bs parameter essentially
vanishes. For the Transversely Isotropic case, both as and bs essentially vanish,
which is in excellent agreement with the transversely isotropic stress-strain
pattern. Furthermore we note that the magnitude of both as and bs parameters
in the best ﬁtting parameter sets presented in Table 3 are very small. In light
of the shear stress calculations (23) we can see that the as and bs parameters
are related to the degree of extra stiﬀness in the sheet direction over the sheet
normal direction. Indeed when we examine the shear data, Figure 3, we can
see that the SN −SF curves are only slightly stiﬀer than the N F −N S curves,
which explains why the optimal values of as and bs are so small.

Comparing the orthotropic material parameter values to the previously
published values in Table 4, we observe that the ﬁt of our material parame-
ters is signiﬁcantly better, as expected. By using a ﬁnite element model we
have been able to relax the homogeneous shearing angle assumption and more
realistically model the motion of the cubes in the shearing experiment. We
note that our material parameters diﬀer from those previously published, and
also that there is a signiﬁcant variability in the parameter values previously
reported. Some of this variability is most likely due to the diﬀerences in the
selection of points during the digitization of [Figure 2 of [15]], which was done
in the studies whose material parameter sets we compare in Table 4. By us-
ing original data from the shearing experiment, we were able to remove the
uncertainty due to digitization in our parameter estimates. Finally we note
that even after the SF-SN curves are swapped in Dataset 2 of Figure 1, there
are still minor diﬀerences when compared to [Figure 7 of [15]] and [Figure 3
of [12]] and [Figure 4 of [28]]. This also explains why our parameter sets diﬀer
from those calculated in the previous studies.

4.3 Computing functional gradients in cardiac mechanics

Figure 4 demonstrates that the computational cost of the adjoint gradient
computation is comparable to that of a single iteration of the nonlinear so-
lution algorithm of (5) for larger system sizes. For smaller system sizes, the
cost of symbolic computation and the cost of residual and Jacobian assem-
bly contribute signiﬁcantly yielding higher ratios – as expected. Wang et al.’s

20

Gabriel Balaban et al.

2013 simulations of a human left ventricle in diastole use system sizes of ap-
proximately 100 000 degrees of freedom [28]. Given the trend in Figure 4, we
can expect that the adjoint method and solver implemented in this work will
continue to be eﬃcient at this scale and beyond.

Comparatively, assuming the use of Newton’s method for the solution of
nonlinear systems, the evaluation of a ﬁnite diﬀerence gradient requires a lin-
ear system assembly and solve for each Newton iteration, and one nonlinear
solve is required per component of the gradient. Counting the 8 parameters
in the Holzapfel-Ogden model (2), and assuming a typical solution of the
Euler-Lagrange equation (5) takes 6 Newton iterations, we can expect the
computational cost of ﬁnite diﬀerence gradient evaluation to be circa 48 times
greater than that of the adjoint method.

In the optimization results of Table 2, we observed iteration counts of up
to 44 for the optimization of 8 parameters using our gradient-based method.
This compares favorably with the circa 7000 iterations needed to estimate 9
parameters using a global method in [Figure 5 of [30]].

4.4 Implications for organ-scale image-based parameter estimation with
spatially resolved material parameters

Although we have tested our adjoint-based multi-start optimization method on
the 2002 shear data of Dokos et al [8], we believe our methods will provide the
biggest advantage in the case of optimizing cardiac model parameters in high
spatial resolution at the organ scale to MRI or echocardiographic image data.
In this case the high spatial resolution would allow for detailed modelling of
regional diﬀerences in tissue stiﬀness, which is for example present in patients
with post-infarct ﬁbrosis.

In such an application a model parameter could be represented as a ﬁnite
element function similarly to the displacement or hydrostatic pressure ﬁelds
(u, p). Doing this would increase the number of components of the gradient
D ˆI
Dm by the number of degrees of freedom needed to spatially represent the
parameter of interest. Using a ﬁnite diﬀerence or reduced order Kalman ﬁlter
approach in this case would require an additional evaluation of the Euler-
Lagrange equation (5) for each degree of freedom introduced, whereas the
adjoint gradient formula (13) only needs to be calculated once regardless of
the number of additional degrees of freedom. In the current study the adjoint
gradient is estimated to be

(number of model parameters) × 6 = 48

times faster than ﬁnite diﬀerencing. In the case of a spatially varying model
parameter the speedup is potentially a lot more signiﬁcant.

When ﬁtting material parameters to the Dokos experiment data, we were
able to generate good initial guesses for the local optimization by progressively
reﬁning the mesh and using the optimal results from the previous coarser
reﬁnement level as an initial guess in the successive ﬁner level. It would be more

Adjoint-based multi-start cardiac parameter estimation

21

challenging to apply this technique using image based ventricular geometries,
due to the problem of accurately representing the geometry with few elements.
As an alternative we propose the multi-start approach, which we have shown
here to be accurate and viable using the Dokos experiment data.

One issue that would arise in using the multi-start approach with image
based geometries would be the choice of the number of multi-start points; using
less points is more computationally eﬃcient, while using more is potentially
more robust. Possible solutions are the use of optimal stopping criteria [4] or
more sophisticated local-global searches [13, 27].

5 Conclusions

In this work, we have presented a new application of eﬃcient gradient-based
optimization methods in the context of estimating cardiac hyperelastic mate-
rial parameters from experimental data. In particular, we have demonstrated
how an adjoint solution can greatly speed up the evaluation of functional
gradients. These methods have produced two new sets of material parameter
values that yield simulated stress-strain curves that ﬁt closely to orthotropic
and transversely isotropic shear data. For future parameter estimation studies
using image based geometries and a local search algorithm, multi-start or a
similar method should be used in order to avoid suboptimal minima.

Acknowledgements The authors would like to thank Socrates Dokos, Holger Schmid
and Ian LeGrice, for making the experimental data available. Our work is supported by
The Research Council of Norway through a Centres of Excellence grant to the Center for
Biomedical Computing at Simula Research Laboratory, project number 179578, and also
through the Center for Cardiological Innovation at Oslo University Hospital project number
203489. Alnæs has been supported by the Research Council of Norway through grant number
209951. Computations were performed on the Abel supercomputing cluster at the University
of Oslo via NOTUR project NN9316k.

References

1. Alnæs, M.S., Logg, A., Ølgaard, K.B., Rognes, M.E., Wells, G.N.: Uniﬁed form language:
A domain-speciﬁc language for weak formulations of partial diﬀerential equations. ACM
Transactions on Mathematical Software (TOMS) 40(2), 9 (2014)

2. Augenstein, K.F., Cowan, B.R., LeGrice, I.J., Nielsen, P.M., Young, A.A.: Method and
apparatus for soft tissue material parameter estimation using tissue tagged magnetic
resonance imaging. Journal of biomechanical engineering 127(1), 148–157 (2005)

3. Balay, S., Brown, J., Buschelman, K., Gropp, W., Kaushik, D., Knepley, M., McInnes,
L.C., Smith, B., Zhang, H.: Petscc web page (2015). URL http://www.mcs.anl.gov/
petsc

4. Boender, C.G.E., Kan, A.R.: Bayesian stopping rules for multistart global optimization

methods. Mathematical Programming 37(1), 59–80 (1987)

5. Chabiniok, R., Moireau, P., Lesault, P.F., Rahmouni, A., Deux, J.F., Chapelle, D.:
Estimation of tissue contractility from cardiac cine-mri using a biomechanical heart
model. Biomechanics and modeling in mechanobiology 11(5), 609–630 (2012)

6. Costa, K.D., Holmes, J.W., McCulloch, A.D.: Modelling cardiac mechanical properties
in three dimensions. Philosophical transactions of the Royal Society of London. Series
A: Mathematical, physical and engineering sciences 359(1783), 1233–1250 (2001)

22

Gabriel Balaban et al.

7. Delingette, H., Billet, F., Wong, K.C.L., Sermesant, M., Rhode, K., Ginks, M., Rinaldi,
C.A., Razavi, R., Ayache, N.: Personalization of Cardiac Motion and Contractility From
Images Using Variational Data Assimilation. Biomedical Engineering, IEEE Transac-
tions on 59(1), 20–24 (2012). DOI 10.1109/TBME.2011.2160347

8. Dokos, S., Smaill, B.H., Young, A.A., LeGrice, I.J.: Shear properties of passive ventric-
ular myocardium. American Journal of Physiology-Heart and Circulatory Physiology
283(6), H2650–H2659 (2002)

9. Farrell, P.E., Ham, D.A., Funke, S.W., Rognes, M.E.: Automated derivation of the
adjoint of high-level transient ﬁnite element programs. SIAM Journal on Scientiﬁc
Computing 35(4), C369–C393 (2013)

10. Finsberg, H.N., Balaban, G., Sundnes, J., Odland, H.H., Rognes, M., Wall, S.T.:
Mechanical imaging of dynamic patient stress patterns (2015). URL http://www.
malt-meeting.net/2015/abstracts/balaban.pdf

11. Gjerald, S., Hake, J., Pezzuto, S., Sundnes, J., Wall, S.T.: Patient–speciﬁc parameter
estimation for a transversely isotropic active strain model of left ventricular mechanics.
In: Statistical Atlases and Computational Models of the Heart-Imaging and Modelling
Challenges, pp. 93–104. Springer (2015)

12. G¨oktepe, S., Acharya, S., Wong, J., Kuhl, E.: Computational modeling of passive my-
International Journal for Numerical Methods in Biomedical Engineering

ocardium.
27(1), 1–12 (2011)

13. Goldberg, D.E., Voessner, S.: Optimizing global-local search hybrids. Urbana 51, 61,801

(1999)

14. Gunzburger, M.D.: Perspectives in ﬂow control and optimization, vol. 5. Siam (2003)
15. Holzapfel, G., Ogden, R.W.: Constitutive modelling of passive myocardium: a struc-
turally based framework for material characterization. Philosophical transactions. Se-
ries A, Mathematical, physical, and engineering sciences 367(1902), 3445–75 (2009).
DOI 10.1098/rsta.2009.0091. URL http://www.ncbi.nlm.nih.gov/pubmed/19657007

16. Hood, P., Taylor, C.: Navier-stokes equations using mixed interpolation. Finite element

methods in ﬂow problems pp. 121–132 (1974)

17. Jones, E., Oliphant, T., Peterson, P., et al.: SciPy: Open source scientiﬁc tools for

Python (2001–). URL http://www.scipy.org/. [Online; accessed 2014-12-09]

18. Kraft, D.: A software package for sequential quadratic programming. Tech. Rep.
Institute for Flight Mechanics,

DFVLR-FB 88-28, DLR German Aerospace Center
Koln, Germany (1988)

19. Krishnamurthy, A., Villongco, C.T., Chuang, J., Frank, L.R., Nigam, V., Belezzuoli, E.,
Stark, P., Krummen, D.E., Narayan, S., Omens, J.H., et al.: Patient-speciﬁc models of
cardiac biomechanics. Journal of computational physics 244, 4–21 (2013)

20. Logg, A., Mardal, K.A., Wells, G.N., et al.: Automated Solution of Diﬀerential Equations

By the Finite Element Method. Springer (2011)

21. Marchesseau, S., Delingette, H., Sermesant, M., Sorine, M., Rhode, K., Duckett, S.G.,
Rinaldi, C.a., Razavi, R., Ayache, N.: Preliminary speciﬁcity study of the Bestel-
Cl´ement-Sorine electromechanical model of the heart using parameter calibration from
medical images. Journal of the mechanical behavior of biomedical materials 20, 259–
71 (2013). DOI 10.1016/j.jmbbm.2012.11.021. URL http://www.ncbi.nlm.nih.gov/
pubmed/23499249

22. Salari, K., Knupp, P.: Code veriﬁcation by the method of manufactured solutions. Tech.
rep., Sandia National Labs., Albuquerque, NM (US); Sandia National Labs., Livermore,
CA (US) (2000)

23. Schmid, H., Nash, M., Young, A., R¨ohrle, O., Hunter, P.: A computationally eﬃcient
optimization kernel for material parameter estimation procedures. Journal of biome-
chanical engineering 129(2), 279–283 (2007)

24. Schmid, H., OCallaghan, P., Nash, M., Lin, W., LeGrice, I., Smaill, B., Young, A.,
Hunter, P.: Myocardial material parameter estimation-a nonhomogeneous ﬁnite element
study from simple shear tests. Biomechanics and modeling in mechanobiology 7(3),
161–173 (2008)

25. Schmid, H., Wang, Y., Ashton, J., Ehret, A., Krittian, S., Nash, M., Hunter, P.: Myocar-
dial material parameter estimation-a comparison of invariant based orthotropic consti-
tutive equations. Computer methods in biomechanics and biomedical engineering 12(3),
283–295 (2009)

Adjoint-based multi-start cardiac parameter estimation

23

26. Sundar, H., Davatzikos, C., Biros, G.: Biomechanically-constrained 4d estimation of
myocardial motion. In: Medical Image Computing and Computer-Assisted Intervention–
MICCAI 2009, pp. 257–265. Springer (2009)

27. Tsai, F.T.C., Sun, N.Z., Yeh, W.W.G.: Global-local optimization for parameter struc-
ture identiﬁcation in three-dimensional groundwater modeling. Water resources research
39(2) (2003)

28. Wang, H., Gao, H., Luo, X., Berry, C., Griﬃth, B., Ogden, R., Wang, T.: Structure-
based ﬁnite strain modelling of the human left ventricle in diastole. International journal
for numerical methods in biomedical engineering 29(1), 83–103 (2013)

29. Wang, V.Y., Lam, H.I., Ennis, D.B., Cowan, B.R., Young, A.a., Nash, M.P.: Modelling
passive diastolic mechanics with quantitative MRI of cardiac structure and function.
Medical image analysis 13(5), 773–84 (2009). DOI 10.1016/j.media.2009.07.006. URL
http://www.ncbi.nlm.nih.gov/pubmed/19664952

30. Wong, K.C., Sermesant, M., Rhode, K., Ginks, M., Rinaldi, C.A., Razavi, R., Delingette,
H., Ayache, N.: Velocity-based cardiac contractility personalization from images using
derivative-free optimization. Journal of the mechanical behavior of biomedical materials
43, 35–52 (2015)

31. Xi, J., Lamata, P., Lee, J., Moireau, P., Chapelle, D., Smith, N.: Myocardial trans-
versely isotropic material parameter estimation from in-silico measurements based on a
reduced-order unscented kalman ﬁlter. Journal of the mechanical behavior of biomedical
materials 4(7), 1090–1102 (2011)

