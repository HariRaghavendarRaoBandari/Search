6
1
0
2

 
r
p
A
4

 

 
 
]

.

R
P
h
t
a
m

[
 
 

2
v
5
0
6
3
0

.

3
0
6
1
:
v
i
X
r
a

The common ancestor type distribution of a

Λ-Wright-Fisher process with selection and mutation

Ellen Baake∗

Ute Lenz†

Anton Wakolbinger†

Abstract

Using graphical methods based on a ‘lookdown’ and pruned version of the ances-
tral selection graph, we obtain a representation of the type distribution of the ancestor
in a two-type Wright-Fisher population with mutation and selection, conditional on
the overall type frequency in the old population. This extends results from [17], now
including the case of heavy-tailed oﬀspring, directed by a reproduction measure Λ.
The representation is in terms of the equilibrium tail probabilities of the line-counting
process L of the graph. We identify a strong pathwise Siegmund dual of L, and char-
acterise the equilibrium tail probabilities of L in terms of hitting probabilities of the
dual process.

Keywords: common ancestor type distribution; ancestral selection graph; lookdown
graph; pruning; Λ-Wright-Fisher diﬀusion; selection; mutation; strong pathwise Sieg-
mund duality; ﬂights

1

Introduction
We consider a Wright-Fisher process with two-way mutation and selection. This is a
classical model of mathematical population genetics, which describes the evolution, forward
in time, of the type composition of a population with two types. Individuals reproduce and
change type, and the reproduction rate depends on the type (the beneﬁcial type reproduces
faster than the less favourable one).

In a previous paper [17], we have presented a graphical construction, termed the pruned
lookdown ancestral selection graph (p-LD-ASG), which allows to identify the common an-
cestor of a population in the distant past, and to represent its type distribution. This
construction keeps track of the collection of all potential ancestral lines of an individual.
As the name suggests, the p-LD-ASG combines elements of the ancestral selection graph
(ASG) of Krone and Neuhauser [16] and the lookdown construction of Donnelly and Kurtz
[6], which here leads to a hierarchy that encodes who is the true ancestor once the types
have been assigned to the lines. In addition, a pruning procedure is applied to reduce the
graph.

A key quantity is the process L, which counts the number of potential ancestors at
any given time. The ancestral type distribution is expressed in terms of the stationary
distribution of L together with the overall type distribution in the past population. The
two distributions may be substantially diﬀerent. This mirrors the fact that the true ancestor
is an individual that is successful in the long run; thus, its type distribution is biased towards
the favourable type. Explicitly, the ancestral type distribution is represented as a series in

ebaake@techfak.uni-bielefeld.de

∗Faculty of Technology, Bielefeld University, Box 100131, 33501 Bielefeld, Germany.
E-mail:
†Institut für Mathematik, Goethe-Universität Frankfurt, Box 111932, 60054, Frankfurt am Main, Ger-

many. E-mail: lenz@math.uni-frankfurt.de, wakolbinger@math.uni-frankfurt.de

1

terms of the frequency of the beneﬁcial type in the past, where the coeﬃcients are the tail
probabilities of the stationary distribution of L and are known in terms of a recursion.

The results obtained so far referred to Wright-Fisher processes. These arise as scaling
limits of processes in which an individual that reproduces has a single oﬀspring that replaces a
randomly chosen individual (thus keeping population size constant); in the ancestral process,
this corresponds to a coalescence event of a pair of individuals. Here we will consider a
natural generalisation, the so-called Λ-Wright-Fisher processes. These include reproduction
events where a fraction z > 0 of the population is replaced by the oﬀspring of a single
individual; this leads to multiple merger events in the ancestral process.

The Λ-Wright-Fisher processes belong to the larger class of Λ-Fleming-Viot processes
(which also include multi-(and inﬁnite-)type generalisations). These, together with their
ancestral processes, the so-called Λ-coalescents, have become objects of intensive research in
the past two decades. Although less is known for the case with selection, progress has been
made in this direction as well (see for example [1, 5, 6, 7, 10]).

Besides deriving our main result on the common ancestor type distribution of a Λ-Wright-
Fisher process (stated in Sec. 2), the purpose of our paper is twofold: First, we will extend
the p-LD-ASG to include multiple-merger events; this will lead to the p-LD-Λ-ASG. Second,
in the footsteps of Cliﬀord and Sudbury [3], we will construct a Siegmund dual of the line-
counting process L of the p-LD-Λ-ASG. In line with a classical relation between entrance
laws of a monotone process and exit laws of its Siegmund dual (discovered by Cox and
Rösler [4]), the tail probabilities of L at equilibrium correspond to hitting probabilities of
the Siegmund dual. This Siegmund dual is a new element of the analysis: In [17], the
recursions for the tail probabilities were obtained from the generator of L, in a somewhat
technical manner. The duality provides a more conceptual approach, which is interesting
in its own right, and yields the recursion in an elegant way, even in the more involved case
including multiple mergers. It will also turn out that the Siegmund dual of L is a natural
generalisation (to the case with selection) of the so-called ﬁxation line (or ﬁxation curve),
introduced by Pfaﬀelhuber and Wakolbinger [19] for Kingman coalescents and investigated
by Hénard [13] for Λ-coalescents.

The paper is organised as follows.

In Section 2, we recapitulate the Λ-Wright-Fisher
model with mutation and selection, and the corresponding ancestral process, the Λ-ASG;
we also provide a preview of our main results. In Section 3, we extend the p-LD-ASG to the
case with multiple mergers. Section 4 is devoted to the Siegmund dual. The dynamics of
this dual process is identiﬁed via a pathwise construction and thus yields a strong duality.
Once the dual is identiﬁed, it leads to the tail probabilities of L with little eﬀort.

2 Model and main result

We will consider a population consisting of individuals each of which is either of dele-
terious type (denoted by 1) or of beneﬁcial type (denoted by 0). The population evolves
according to random reproduction, two-way mutation, and fertility selection (that is, the
beneﬁcial type reproduces at a higher rate), with constant population size over the genera-
tions. The parameters of the model are

• the reproduction measure Λ, which is a probability measure on [0, 1], and whose mean-

ing will be explained along with that of the generator GX below Eq. (2.1),

• the selective advantage σ (a non-negative constant that quantiﬁes the reproductive

advantage of the beneﬁcial type and is scaled with population size),

• the mutation rates θν0 and θν1, where θ, ν0, and ν1 are non-negative constants with
ν0 + ν1 = 1. Thus, νi, i ∈ {0, 1}, is the probability that the type is i after a mutation
event; note that this includes silent events, where the type remains unchanged.

2

We will work in a scaling limit in which the population size is inﬁnite and time is scaled
such that the rate at which a ﬁxed pair of individuals takes part in a reproduction event is
1. The process X := (Xt)t∈R describing the type-0 frequency in the population then has
the generator (cf. [7, 10])

(cid:90)

GX g(x) =

(cid:2)x(g(x + z(1 − x)) − g(x)) + (1 − x)(g(x − zx) − g(x))(cid:3) Λ(dz)
x(1 − x)g(cid:48)(cid:48)(x) + (cid:2)σx(1 − x) − θν1x + θν0(1 − x)(cid:3)g(cid:48)(x).

z2

(0,1]

+ Λ({0}) · 1
2

(2.1)

The ﬁrst and second terms of this generator describe the neutral part of the reproduction.
In the case Λ = δ0 (to which we refer as the Kingman case), the ﬁrst term vanishes and X is a
Wright-Fisher diﬀusion with selection and mutation. Concerning the part of Λ concentrated
on (0, 1], the measure dt Λ(dz)/z2 ﬁgures as intensity measure of a Poisson process, where
a point (t, z), t ∈ R, z ∈ (0, 1], means that at time t a fraction z of the total population is
replaced by the oﬀspring of a randomly chosen individual. Consequently, if the fraction of
type-0 individuals is x at time t−, then at time t the frequency of type-0 individuals in the
population is x + z(1− x) with probability x and x(1− z) with probability 1− x. The third
term of generator (2.1) describes the systematic (logistic) increase of the frequency x due to
selection, and the type ﬂow due to mutation.

In the absence of both selection and mutation (i.e. when σ = θ = 0), the moment dual of
the Λ-Wright-Fisher process is the line-(or block-)counting process of the Λ-coalescent. The
latter was introduced independently by Pitman [20], Sagitov [21], and Donnelly and Kurtz
[18], see [2] for an introductory review.

The rate at which any given tuple of j out of b blocks merges into one is

(cid:90) 1

λb,j :=

zj(1 − z)b−jz−2Λ(dz),

j ≤ b.

(2.2)

b

0

(cid:0)

(cid:1)λb,b−c+1. Note that Λ = δ0 corresponds to Kingman’s coalescent; here, λb,j = δ2,j

Thus the transition rate of the line-counting process from state b to state c < b is given by
b−c+1
for all b ≥ 2. The measure Λ is said to have the property CDI if the Λ-coalescent comes
down from inﬁnity, i.e. ∞ is an entrance boundary for its line counting process.

When selection is present (i.e. σ > 0), an additional component of the dynamics of the
genealogy must be taken into account. In this case, in addition to the (multiple) coalescences
just described, the lines (or blocks) may also undergo a binary branching at rate σ per line.
The resulting branching-coalescing system of lines is a straightforward generalisation of the
ancestral selection graph (ASG) of Krone and Neuhauser [16] to the multiple-merger case;
we will call it the Λ-ASG. The Λ-ASG belonging to a sample of n individuals taken from
the population at time t = 0 describes all potential ancestors of this sample at times t < 0.
Throughout we use the variables t and r for forward and backward time, respectively.

We denote the line-counting process of the Λ-ASG by K = (Kr)r≥0. The generator of

K is

GKg(b) =

b

b − c + 1

λb,b−c+1 [g(c) − g(b)] + bσ [g(b + 1) − g(b)] .

(2.3)

The process K is the moment dual of the Λ-Wright-Fisher process with selection coeﬃcient σ
and mutation rate θ = 0, see e.g. [7, Thm 4.1].

Throughout we will work under the

Assumption 2.1. 0 ≤ σ < σ∗ := −(cid:82) 1

0 log(1 − x) Λ(dx)

x2

.

Remark 2.2. a) It is proved in [12] that σ∗ = limk→∞ log k
Ek[T1], where T1 is the ﬁrst time at
which the line counting process of the Λ-coalescent hits 1. In particular, if the measure Λ

3

(cid:19)

(cid:18)

b−1(cid:88)

c=1

there only in the case when(cid:80)∞
also for the case(cid:80)∞
(cid:80)∞

has the property CDI, then σ∗ = ∞ and hence Assumption 2.1 is satisﬁed for all σ ≥ 0.
b) Under Assumption 2.1 the process K has the property Ek[T1] < ∞ for all k ∈ N, where
now T1 is the ﬁrst time at which K hits 1. Indeed, the proof of [9, Lemma 2.4], though stated
k=2 1/δ(k) = ∞ (with δ(k) deﬁned in [9], (2.1)), works literally
k=2 1/δ(k) < ∞. To see this, note that in this proof the assumption that
k=2 1/δ(k) is inﬁnite is only required to guarantee the non-explosiveness of K. The latter
property, however, is automatic because K is dominated by a pure birth process with birth
rate bσ, b ∈ N, which is non-explosive.

In view of Remark 2.2b), under Assumption 2.1 the process K has a unique equilibrium
distribution and a corresponding time-stationary version indexed by r ∈ R. Similarly, there
exists a time-stationary version of the Λ-ASG, which we call the equilibrium Λ-ASG, and
which will be a principal object in our analysis.

Mutations can be superimposed as independent point processes on the lines of the Λ-
ASG: On each line, independent Poisson point processes of mutations to type 0 come at rate
θν0 and to type 1 at rate θν1.

For t < t and for a given frequency x of type-0 individuals in the population at time t,
the Λ-ASG may be used to determine the types in a sample taken at time t, together with its
ancestry between times t and t, by the following generalisation of the procedure in [16]. Each
line of the Λ-ASG at time t is assigned type 0 with probability x and type 1 with probability
1− x, in an iid fashion. Let the types then evolve forward in time along the lines: after each
beneﬁcial or deleterious mutation, the line takes type 0 or 1, respectively. At each neutral
reproduction event (which is a coalescence event backward in time), the descendant line
inherits the type of the parent. This is also true for the (potential) selective reproduction
events (the branching events backward in time), but here one ﬁrst has to decide which of
the two lines is parental. The rule is that the incoming branch (the line that issues the
potential reproduction event) is parental if it is of type 0; otherwise, the continuing branch
(the target line on which the potential oﬀspring is placed) is parental. When all selective
events have been resolved this way, the lines that are not parental are removed, and one is
left with the true genealogy.

For a given assignment of types to the lines of the stationary Λ-ASG at time 0, there is
exactly one true ancestral line between the times t = 0 and t = ∞. The line of this ancestor
throughout time is called the immortal line or line of the common ancestor. Our main result
is a characterisation of its type distribution at time 0, conditional on the type frequency in
the population at that time. For the following deﬁnition, let It be the type of the immortal
line in the stationary Λ-ASG at time t.

Deﬁnition 2.3 (Common ancestor type distribution). In the regime of Assumption 2.1,
and for x ∈ [0, 1], let h(x) := P(I0 = 0 | X0 = x) be the probability that the immortal line
in a stationary Λ-ASG with two-way mutations carries type 0 at time 0, given the type-0
frequency in the population at time 0 is x.

By shifting the time interval [0, t] back to [−t, 0], it becomes clear that h(x) is also the
limiting probability (as t → ∞) that the ancestor at the past time −t of the population at
time 0 is of the beneﬁcial type, given that the frequency of the beneﬁcial type at time −t
was x.

Theorem 2.4. The probability h(x) has the series representation

(cid:88)

n≥0

h(x) =

x(1 − x)nan,

(2.4)

where the coeﬃcients an in (2.4) are monotone decreasing, and the unique solution to the

4

system of equations

 (cid:88)

n+1<c≤∞

(cid:18)c − 1

c − n

(cid:19)

λc,c−n

1
n

a0 = 1,

a∞ := lim

n→∞ an = 0,

with the convention(cid:18) ∞ − 1

(cid:19)

∞ − d + 1

:=

 (an − ac−1) + (σ + θ)an = σan−1 + θν1an+1, n ≥ 1,
(cid:40)

, and λ∞,∞ := Λ({1}).

(2.5)

(2.6)

In the Kingman case the system of equations (2.5) simpliﬁes to

+ σ + θ

an =

an+1 + σan−1 + θν1an+1, n ≥ 1,

(2.7)

and we immediately obtain
Corollary 2.5 (Fearnhead’s recursion). In the Kingman case, the coeﬃcients in (2.4) satisfy

0
1

if d = 1
if d ≥ 2

(cid:18)n + 1

(cid:19)

1
n

2

(cid:20) 1

2

(cid:21)

(cid:21)

(cid:21)

(cid:20) 1

(cid:18)n + 1

(cid:19)

n

2

the recursion(cid:20) 1

2

(n + 1) + σ + θ

an =

(n + 1) + θν1

an+1 + σan−1, n ≥ 1,

(2.8)

with a0 = 1 and limn→∞ an = 0.

Recursion (2.8) appears in [8] in connection with a time-stationary Wright-Fisher dif-
fusion (with selection and mutation).1 In [23], the representation (2.4) together with (2.8)
was derived by analytic methods. In [17], again for the Kingman case, we gave a new, more
probabilistic proof, interpreting the coeﬃcients an as equilibrium tail probabilities of the
line-counting process of the pruned lookdown ASG (see Sec. 3). In the present paper we give
a twofold extension: (i) we include the case of multiple mergers, and (ii) we use a strong
Siegmund duality (and thus a fully probabilistic method) in order to derive the recursion
(2.5).

for k ∈ {0, 1, . . . , N}, let hN

An analogue of the quantity h(x) can also be deﬁned for a Moran model with ﬁnite
population size N:
be the probability that the individual
whose oﬀspring will take over the whole population at some later time is of type 0 at time 0,
given the number of type-0 individuals in the population at time 0 is k. In [15] it is shown
converges to h(x) as N → ∞ and k/N → x. Here, we work
(for the Kingman case) that hN
in the inﬁnite-population limit right away, in order to carve out some important features of
the underlying mathematical structure.

In order to determine h(x), it turns out to be helpful to remove certain lines from the
ASG. Indeed, as the mutations convey information on the types of lines, some lines in the
Λ-ASG can be deleted from the set of potential ancestors. This way, the Λ-ASG may be
pruned, according to the ideas presented in [17] for the Kingman case.
In the following
section we review the p-LD-ASG [17] and extend it to the p-LD-Λ-ASG.

k

k

3 The pruned lookdown-Λ-ancestral selection graph

At each time r, the pruned lookdown Λ-ASG G consists of a ﬁnite number Lr of lines,
numbered by the integers 1, . . . , Lr, to which we refer as levels. The evolution of the lines as
1Note that there is a diﬀerence of a factor 1/2 in the scaling of (2.8) in comparison to [8, 17, 23]. This
is because these papers use the diﬀusion part of the Wright-Fisher generator (see (2.1)) without the factor
1/2. This corresponds to a pair coalescence rate of 2 in the Kingman case, while in the present paper we
assume pair coalescence rate 1 throughout.

5

r increases is determined by a point conﬁguration on(cid:0)R×P(N)(cid:1)∪(cid:0)R×N×{∗,×,◦}(cid:1), where

P(N) is the set of subsets of N. Each of the points (r, τ ) stands for a transition element τ
occurring at time r, that is, a merger, a selective branching, a deleterious mutation, or a
beneﬁcial mutation at time r. One of the lines, called the immune line, is distinguished; its
level at time r is denoted by Mr. The role of this line will become clear from Proposition
3.1. The reason why we call it immune is because it is not killed by mutations.

Let us now detail the transition elements and their eﬀects on G (see Figs. 1 and 2):
• A merger at time r is a pair (r, η), where η is a subset of N. If

|{1, . . . , Lr−}∩ η| ≤ 1,
then G is not aﬀected. If, however, {1, . . . , Lr−} ∩ η = {j1, . . . , jκ} with j1 < ··· < jκ
and κ ≥ 2, then the lines at levels j2, . . . , jκ merge into the line at level j1. The
remaining lines in G are relocated to ‘ﬁll the gaps’ while retaining their original order;
this renders Lr = Lr− − κ + 1. The immune line simply follows the line on level Mr−.
• A selective branching at time r is a triple (r, i,∗), with i ∈ N. If Lr− < i, then G is not
aﬀected. If Lr− ≥ i, then a new line, namely the incoming branch, is inserted at level
i and all lines at levels k ≥ i (including the immune line if Mr− ≥ i) are pushed one
level upward to k + 1, resulting in Lr = Lr− + 1. In particular, the continuing branch
is shifted from level i to i + 1.

• A deleterious mutation at time r is a triple (r, i,×), with i ∈ N. If Lr− < i, then G
is not aﬀected. If Lr− ≥ i and i (cid:54)= Mr−, then the line at level i is killed, and the
remaining lines in G (including the immune line) are relocated to ‘ﬁll the gaps’ (again
in an order-preserving way), rendering Lr = Lr− − 1. If, however, i = Mr−, then the
line aﬀected by the mutation is not killed but relocated to the currently highest level,
i.e. Mr = Lr−. All lines above i are shifted one level down, so that the gaps are ﬁlled,
and in this case Lr = Lr−.

• A beneﬁcial mutation at time r is a triple (r, i,◦), with i ∈ N. If Lr− < i, then G is
not aﬀected. If Lr− ≥ i, then all the lines at levels > i are killed, rendering Lr = i,
and the immune line is relocated to Mr = i.

Proposition 3.1. Assume that for some r0 < 0 we have Lr0 = 1, and assume there are
ﬁnitely many transition elements that aﬀect G between times r0 and 0. Consider an arbitrary
assignment of types to the L0 lines at time r = 0. Then the level of the immortal line at
time 0 is either the lowest type-0 level at time 0 or, if all lines at time 0 are of type 1, it is
the level M0 of the immune line at time 0. In particular, the immortal line is of type 1 at
time 0 if and only if all lines in G at time 0 are assigned type 1.
Proof. In the absence of multiple mergers (i.e.
if all mergers have exactly two elements),
this is Theorem 4 in [17]. In its proof, the induction step for binary mergers directly carries
over to multiple mergers.

The transition elements arrive via independent Poisson processes: For each i ∈ N, the
‘stars’, ‘crosses’, and ‘circles’ at level i come as Poisson processes with intensities σ, θν1
and θν0, respectively. For each 2-element subset η of N, the ‘η-mergers’ come as a Poisson
process with intensity Λ({0}). In addition, we have a Poisson process with intensity measure
z2 Λ(dz) dr, where each z generates a random subset H(z) := {i : Vi = 1} ⊂ N,
1{z>0} 1
with (Vi)i∈N being a Bernoulli(z)-sequence, and the point (r, z) gives rise to the merger
(r, H(z)). All these Poisson processes are independent. The points (r, τ ) constitute a Poisson
conﬁguration Ψ, whose intensity measure we denote by µ ⊗ ρ, where µ is Lebesgue measure
on R. With the transition rules described above, this induces Markovian jump rates upon
Lr and (Lr, Mr). With the help of (2.2), it is easily checked that the generator GL of L is

6

Figure 1: Transitions of the pruned lookdown Λ-ASG. Since the graph evolves ‘into the past’,
time r runs from right to left in the ﬁgure. The value of L is 6 before the jump; the immune
line is marked in bold. From left to right: A ‘merger’ of the lines on levels 1, 3, and 5 (indicated
by bullets); a ‘star’ at level 3; a ‘cross’ at level 3, outside the immune line; a ‘cross’ on the
immune line at level 3; a ‘circle’ at level 3.

Figure 2: A cut-out of a realisation of the pruned lookdown Λ-ASG. The immune line is
marked in bold.

given by

(cid:96)−1(cid:88)

c=1

GLg((cid:96)) =

(cid:19)

(cid:18)

(cid:96)

(cid:96) − c + 1

λ(cid:96),(cid:96)−c+1 [g(c) − g((cid:96))] + (cid:96)σ [g((cid:96) + 1) − g((cid:96))]

(cid:96)−1(cid:88)

θν0 [g((cid:96) − k) − g((cid:96))] .

(3.1)

+ ((cid:96) − 1)θν1 [g((cid:96) − 1) − g((cid:96))] +

Due to Assumption 2.1 and Remark 2.2b), and because L is stochastically dominated by

K, the process L obeys

k=1

E(cid:96)[T1] < ∞,

(cid:96) ∈ N.

Thus L has a time-stationary version (cid:101)L (which is (cid:101)L ≡ 1 if σ = 0), and likewise the pruned
lookdown Λ-ASG has an equilibrium version as well. We now set Leq := (cid:101)L0 and denote
realisations of (cid:101)L, there exists an r0 < 0 such that (cid:101)Lr0 = 1. Hence, arguing as in [17, proof

the tail probabilities of Leq by αn := P(Leq > n), n ∈ N0. Because of (3.2), for almost all

of Theorem 5], we conclude from Proposition 3.1 the following

(3.2)

Corollary 3.2. Given the frequency of the beneﬁcial type at time 0 is x, the probability that
the immortal line in the equilibrium p-LD-Λ-ASG at time 0 is of beneﬁcial type is

h(x) =

x(1 − x)nαn.

(3.3)

(cid:88)

n≥0

In order to further evaluate the representation (3.3), we need information about the
equilibrium tail probabilities αn. This is achieved in the following sections via a process D
which is a Siegmund dual for L.

7

325146r325146r4 An application of Siegmund duality
4.1 Tail probabilities and hitting probabilities

It is clear that L is stochastically monotone, that is, Pn(Lr ≥ i) ≥ Pm(Lr ≥ i) for n ≥ m
and for all i ∈ S (where the subscript refers to the initial value of the process). It is well
known [22] that such a process has a Siegmund dual, that is, there exists a process D such
that

P(cid:96)(Lu ≥ d) = Pd(Du ≤ (cid:96))

(4.1)

for all u ≥ 0, (cid:96), d ∈ N.
Lemma 4.1. The tail probabilities of the stationary distribution of L are hitting probabilities
of the dual process D. To be speciﬁc,

αn = Pn+1(∃t ≥ 0 : Dt = 1) ∀n ≥ 0.

(4.2)

Proof. This is a special case of [4, Thm. 1] for entrance and exit laws.
In our case the
entrance law is the equilibrium distribution of L, the exit law is a harmonic function (in
terms of hitting probabilities), and the proof reduces to the following elementary argument.
Namely, evaluating the duality condition (4.1) for (cid:96) = 1 and d = n + 1, n ≥ 0, gives

P1(Lu ≥ n + 1) = Pn+1(Du = 1)

(4.3)
Taking the limit u → ∞, the left-hand side converges to P(Leq > n) = αn by positive
recurrence and irreducibility. Setting (cid:96) = d = 1 in (4.1), we see that 1 is an absorbing state
for D. Hence we have for the right-hand side of (4.3)

for all u ≥ 0, n ≥ 0.

Pn+1(Du = 1) = Pn+1(∃t ≥ 0 : Dt = 1) ∀n ≥ 0,

lim
u→∞

and the lemma is proven.

Next we want to show that the (shifted) hitting probabilities
αn = Pn+1(∃t ≥ 0 : Dt = 1), n ≥ 0,

(4.4)

satisfy the system of equations (2.5). More precisely, (2.5) will emerge as a ﬁrst-step de-
composition of the hitting probabilities. For this purpose, we ﬁrst have to identify the jump
rates of D. This can be done via a generator approach that translates the jump rates of the
process L (which appear in (3.1)) into their dual jump rates, see, for instance, formula (12)
in [3] or in [22]. For the jump rates coming from the mergers this is somewhat technical, see
the calculations in the appendix in [13].

Inspired by [3] we will therefore take a ‘strong pathwise approach’ that consists in de-
composing the dynamics of L into so-called ﬂights, which can be ‘dualised’ one by one.
While Cliﬀord and Sudbury, starting from the generator of a monotone process, in [3, Thm
1] construct a special Poisson process of ﬂights for which they form the duals ([3, Thm
2]), in our situation the Poisson process of ﬂights is naturally given (being induced by the
transition elements for G deﬁned in Sec. 3, see Sec. 4.3 below). Consequently, we will show
in Proposition 4.3 that the approach of [3, Thm 2] works also when starting from a more
general Poisson process of ﬂights.

4.2 Flights and their duals

In [3], Cliﬀord and Sudbury introduced a graphical representation that allows to con-
struct a monotone homogeneous Markov process L together with its Siegmund dual D on

8

one and the same probability space. The method requires that the state space S of the
processes L and D be (totally) ordered. We restrict ourselves to the case S := N ∪ {∞},
which is the relevant one in our context (and which is prominent in [3] as well).

The basic building blocks of Cliﬀord and Sudbury’s construction are so-called ﬂights. A
ﬂight f is a mapping from S into itself that is order-preserving, so f (k) ≤ f ((cid:96)) for all k < (cid:96)
with k, (cid:96) ∈ S; let us add that each ﬂight leaves state ∞ invariant, so f (∞) = ∞. By the
construction described below, a ﬂight f that appears at time r will induce the transition to
Lr = f ((cid:96)), given Lr− = (cid:96). This way, transitions from diﬀerent initial states will be coupled
on the same probability space. A ﬂight f is graphically represented as a set of simultaneous
arrows pointing from (cid:96) to f ((cid:96)), for all (cid:96) ∈ S, so that the process simply follows the arrows.
Examples are shown in Fig. 3.
We denote the set of all ﬂights by F, and consider a Poisson process Φ on R × F whose
intensity measure is of the form µ ⊗ γ, where µ is again Lebesgue measure on R, and the
measure γ has the property

(cid:96) ∈ N.

γ({f ∈ F : f ((cid:96)) (cid:54)= (cid:96)}) < ∞,

(4.5)
Property (4.5) implies that with probability 1, for all (cid:96) ∈ N and r ∈ R, among all the points
(s, f ) in Φ with s > r and f ((cid:96)) (cid:54)= (cid:96), there is one whose s is minimal. We denote this time
by v(r, (cid:96)). For r ∈ R and (cid:96) ∈ N, we deﬁne inductively a sequence (s0, (cid:96)0), (s1, (cid:96)1), . . . with
r =: s0 < s1 < ··· , (cid:96) =: (cid:96)0, (cid:96)1, (cid:96)2, . . . ∈ S, by setting si := v(si−1, (cid:96)i−1), (cid:96)i := f ((cid:96)i−1), with
(si, f ) ∈ Φ. (Note this procedure will terminate if (cid:96)i = ∞ for some i ∈ N.)
With the notation just introduced, Φ induces a semi-group (a ﬂow) of mappings, indexed
by r < s ∈ R, and deﬁned by

Fr,s((cid:96)) :=

if si ≤ s < si+1,
(cid:96)i
∞ if limi→∞ si ≤ s

(4.6)

(cid:40)

for (cid:96) ∈ N, with Fr,s(∞) := ∞.
Assuming property (4.5), we say that Φ represents the process L if for all s > 0 the
distribution of F0,s((cid:96)) is a version of the conditional distribution of Ls given {L0 = (cid:96)},
(cid:96) ∈ N. Equivalently, for all r ∈ R and u > 0,

P(cid:96)(Lu ∈ (.)) = P(Fr,r+u((cid:96)) ∈ (.)).

(4.7)

d ∈ S,

We now describe, in the footsteps of Cliﬀord and Sudbury [3], the construction of a
strong pathwise Siegmund dual D, based on the same realisation of the ﬂights as for the
original process L. For examples, see Fig. 3, and note that we insinuate r = −t.

Deﬁnition 4.2 (Dual ﬂights). a) For a ﬂight f : S → S, its dual ﬂight (cid:98)f is deﬁned by

with the convention min(∅) = ∞.

(cid:98)f (d) = min(f−1({d, d + 1, . . .})),
b) For a Poisson process Φ on R × F, we deﬁne (cid:98)Φ as the result of Φ under the mapping
(r, f ) (cid:55)→ (−r,(cid:98)f ) =: (t,(cid:98)f ). Moreover, under the assumption
γ({f ∈ F : (cid:98)f (d) (cid:54)= d}) < ∞,
we deﬁne (cid:98)F in terms of (cid:98)Φ in the same way as F was deﬁned in terms of Φ by (4.6).
It is clear that (cid:98)f is order preserving. Since f is monotone increasing by assumption,
(4.8) is equivalent to (cid:98)f (d) = max(f−1({1, . . . , d − 1})) + 1,

d ∈ N,

d ∈ S,

(4.8)

(4.9)

(4.10)

9

with the convention max(∅) = 0. Note further that (4.9) is implied by (4.5) together with
(4.11)

γ({f ∈ F : ∃k > (cid:96) s.t. f (k) ≤ (cid:96)}) < ∞,

(cid:96) ∈ N.

The following proposition is an adaptation of [3, Theorem 2] to our setting. Compare

also [14, Section 4.1].
Proposition 4.3. Assume (4.5) and (4.11), and assume that ∞ is unattainable for the
process L represented by the Poisson process Φ with intensity measure µ ⊗ γ. Then the
following strong pathwise duality relation is valid: For all s > 0; (cid:96), d ∈ N,

1{F−s,0((cid:96))≥d} = 1{(cid:98)F0,s(d)≤(cid:96)},

almost surely.

Proof. Let Y := (Yr)r∈[−s,0] := (F−s,r((cid:96)))r∈[−s,0], and (cid:98)Y := ((cid:98)Yt)t∈[0,s] := ((cid:98)F0,t(d))t∈[0,s], for
ﬁnitely many jumps; let us denote the jump times by −r1, . . . ,−rn. We write (cid:98)J for the
union of {r1, . . . , rn} and the set of jump times of (cid:98)Y . Because of (4.9), (cid:98)J has a smallest

given (cid:96), d, and s. Due to (4.5) and the assumption that ∞ is unattainable, Y has a.s only

element, a second-smallest element, and so on. We denote these elements by u1 < u2 < . . .,
and show that

(4.12)

(4.13)

(4.14)

Proceeding by induction, for (4.13) it is suﬃcient to show

Y0 ≥ (cid:98)Y0 if and only if Y(−ui)− ≥ (cid:98)Yui,
1{f (j)≥k} = 1{(cid:98)f (k)≤j}

i = 1, 2, . . .

for all ﬂights f, and j, k ∈ N. Let f ∈ F. On the one hand, f (j) ≥ k yields

(cid:98)f (k) ≤ (cid:98)f(cid:0)f (j)(cid:1) = min(cid:0)f−1({f (j), f (j) + 1, . . .})(cid:1) = min(cid:0)f−1(f (j))(cid:1) ≤ j,

where we have used order preservation of (cid:98)f and f as well as (4.8). On the other hand,
(cid:98)f (k) ≥ (cid:98)f(cid:0)f (j + 1)(cid:1) = max(cid:0)f−1({1, . . . , f (j)})(cid:1) + 1 = max(cid:0)f−1(f (j))(cid:1) + 1 ≥ j + 1 > j.

f (j) < k is equivalent to f (j) + 1 ≤ k. By order preservation and (4.10), this entails

We have thus shown (4.14), and hence also (4.13).
If (ui) has no accumulation point, then it has a maximal element, say um. Choosing
i = m in the r.h.s. of (4.13) yields (4.12) (since um (cid:54)= s with probability 1). If (ui) has an
accumulation point, say τ, then, because of (4.9), we have

limt↑τ (cid:98)Yt = limi→∞(cid:98)Yui = ∞.
Because Y remains bounded by assumption, this together with (4.13) enforces that Y0 < (cid:98)Y0.
r.h.s of (4.12), since ∞ = (cid:98)Yτ = (cid:98)Ys > (cid:96).
Corollary 4.4. In the situation of Proposition 4.3, let D be a process represented by (cid:98)Φ.

This means that the l.h.s. of (4.12) takes the value 0. However, this is the case also for the

In view of (4.7) we immediately obtain the following

Then L and D satisfy the duality relation (4.1), with L and D replaced by L and D.

4.3 A Siegmund dual for the process L

Let us now turn to our case where L = L. With each of the transition elements η, (i,∗),

(i,×), (i,◦) introduced in Sec. 3 we associate a ﬂight deﬁned as follows ((cid:96) ∈ S, i ∈ N):

(cid:40)

fη((cid:96)) = (cid:96) − |{1, ...., (cid:96)} ∩ ˜η|,

fi,∗((cid:96)) =

(cid:96),
(cid:96) + 1,

(cid:96) < i,
(cid:96) ≥ i,

(cid:40)

where ˜η := η \ {min(η)},
(cid:96) ≤ i,
(cid:96) > i,

(cid:96),
(cid:96) − 1,

fi,×((cid:96)) =

(cid:40)

(cid:96),
i,

fi,◦((cid:96)) =

(4.15)

(cid:96) ≤ i,
(cid:96) > i,

10

compare also Fig. 3. The ﬂights are indeed order preserving. The structure of fη, fi,∗,
and fi,◦ is clearly inherited from that of the corresponding transition elements. The ﬂights
fi,×((cid:96)) forget about the position (but not about the existence) of the immune line within the
p-LD-Λ-ASG. Indeed, recall that the downward jump rate of L due to deleterious mutations
is ((cid:96)− 1)θν1; this reﬂects the fact that crosses arrive at rate θν1 per line, but are ignored on
the immune line, no matter where it is located. This is taken into account in the deﬁnition
of the ﬂight fi,× by setting f(cid:96),×((cid:96)) = (cid:96).
Let us now start from the Poisson conﬁguration Ψ (of points (r, τ ) with intensity measure
µ ⊗ ρ), as described in Sec. 3. Let γ be the image of the measure ρ under the mapping
τ (cid:55)→ fτ , where fτ is the ﬂight belonging to the transition element τ as deﬁned in (4.15), and
let Φ be the Poisson conﬁguration with intensity measure µ ⊗ γ. It is readily checked that
γ has property (4.5) and that Φ represents the process L (because the jump rates match
those appearing in the generator (3.1)).

fη (with η ∩ {1, . . . , 6} = {1, 3, 5}), f3,∗, f3,×, f3,◦; and (cid:98)fη, (cid:98)f3,∗, (cid:98)f3,×, (cid:98)f3,◦. The ﬂight (cid:98)f3,◦

Figure 3: Graphical representation of the four types of ﬂights deﬁned in (4.15) (light
brown arrows) and their dual ﬂights as deﬁned in (4.18) (dark green arrows), together
with the resulting paths of L (light brown) and D (dark green). The ﬂights displayed are
maps all states d > 3 to the absorbing state ∞. The paths of L and D follow the arrows
in the direction of backward and forward time, respectively.
In addition, γ satisﬁes assumption (4.11). To see this we write γ = γm + γ∗ + γ× + γ◦,
where the 4 summands describe the intensity measures of the ﬂights stemming from the
mergers, the selective branchings, the deleterious mutations and the beneﬁcial mutations. It
is straightforward that γ∗, γ× and γ◦ obey (4.11). To see that also γm obeys (4.11), we note
that for k ≥ 2(cid:96) + 2 and η ⊂ N the inequality fη(k) ≤ (cid:96) implies that |η ∩ {1, . . . , (cid:96) + 1}| ≥ 1
and |η ∩ {(cid:96) + 2, . . . , 2(cid:96) + 2}| ≥ 1. For each ﬁxed pair of levels i ≤ j, their coalescence rate
z2 z2 + Λ({0}) = 1; equivalently, the intensity measure of the set {η : {i, j} ⊂ η}
equals 1. Hence we conclude by subadditivity that γm({f ∈ F : ∃k ≥ 2(cid:96) + 2 s.t. f (k) ≤
Following Deﬁnition 4.2, we can now consider a process D represented by (cid:98)Φ. According
(cid:96)}) < ((cid:96) + 1)2. In view of (4.5), this shows that γm (and hence also γ) obeys (4.11).

to Corollary 4.4, L and D then obey the duality relation (4.1). It remains to read oﬀ the
jump rates of D from the intensities of the (dual) ﬂights.
Lemma 4.5. The generator GD of the process D is given by

is(cid:82)

Λ(dz)

(0,1]

GDg(d) =

λc,c−d+1 [g(c) − g(d)] + (d − 1)σ [g(d − 1) − g(d)]

(cid:88)

(cid:19)

(cid:18) c − 1

c − d + 1

d<c≤∞
+ (d − 1)θν1 [g(d + 1) − g(d)] + (d − 1)θν0 [g(∞) − g(d)] ,

d ∈ N, g : S → R.
(4.16)

where we again use the convention (2.6).
Proof. We claim that the ﬂights that are dual to those in (4.15) are of the form
again with ˜η = η \ {min(η)},

(cid:98)fη(d) = min{(cid:96) : |{1, . . . , (cid:96)} ∩ (N \ ˜η)| = d},

(4.17)

11

325146tr8(cid:40)

(cid:40)

(cid:40)

(4.18)

with (4.17).

(cid:98)fi,◦(d) =

(cid:98)fi,×(d) =

d ≤ i,
d,
∞, d > i,

d ∈ S, i ∈ N (see Fig. 3).

d ≤ i,
d,
d + 1, d > i

d ≤ i,
d,
d − 1, d > i

The expressions in (4.18) are obvious consequences of (4.8) and (4.15). To verify (4.17),
η (d)), since fη is surjective

(cid:98)fi,∗(d) =
we ﬁrst note that, due to Deﬁnition 4.2, we have (cid:98)fη(d) = min(cid:0)f−1
and monotone increasing. Consequently, in the case |{1, . . . , d} ∩ η| ≤ 1 we have (cid:98)fη(d) = d,
whereas otherwise we have (cid:98)fη(d) = min{(cid:96) : |{1, ...., (cid:96)} ∩ ˜η| = (cid:96) − d} > d, both in accordance
we have to compute γ({f : (cid:98)f (d) = c}). It is clear that the contributions from γ∗, γ× and

Let us now consider the contribution of the various types of ﬂights to GD. For c (cid:54)= d ∈ N
γ◦ yield the last 3 summands in (4.16). For the contribution coming from γm, we have for
d < c < ∞

Integrating this with respect to 1

γm({f : (cid:98)f (d) = c}) = ρ({η : c /∈ η,|{1, . . . , c − 1} ∩ η| = c − d + 1}).

if c = d + 1, and 0 otherwise. For z > 0, the probability that a z-merger does not aﬀect

The contribution from the Kingman mergers to the right-hand side of of (4.19) is Λ({0})(cid:0)c−1
(cid:1)
level c but does aﬀect c − d + 1 out of the levels 1, . . . , c − 1 is (cid:0) c−1
(cid:1)zc−d+1(1 − z)d−1.
(cid:1)λc,c−d+1. These are the jump rates from d to c < ∞
right-hand side of (4.19) equals(cid:0) c−1
(cid:98)f (d) = 1 if d = 1 and (cid:98)f (d) = ∞ if d ≥ 2. These ﬂights appear at rate Λ({1}), and thus for

z2 Λ(dz) and adding the Kingman component shows that the
c−d+1
that appear in the ﬁrst sum on the r.h.s. of (4.16). It remains to take into account the
jump rate of D from d to ∞. For this we note that fN((cid:96)) = 1, (cid:96) = 1, 2, . . ., and consequently
d ≥ 2 add the term (g(∞) − g(d))Λ({1}) to the generator.
Remark 4.6. In the case without selection and mutation (that is, σ = θ = 0), our process
D shifted by one, that is, D − 1, is equal to the so-called ﬁxation line in [13]. In this case
one has no pruning, and the line counting process K has generator (2.3) (with σ = 0). The
(Siegmund) duality between K and D is stated in [13, Lemma 2.4]. See also [11, Thm 2.3]
for a corresponding statement on the still more general class of exchangeable coalescents.

(4.19)

We now come to the

Proof of Theorem 2.4. The hitting probabilities ω(n) := αn−1, 2 ≤ n < ∞, constitute a
GD-harmonic function, that is,

2

c−d+1

A direct check shows that (4.20) is equivalent to the system

GDω(n) = 0, n ≥ 2.

(cid:35)

λc,c−n + nσ + nθν1 + nθν0

αn

(cid:34) (cid:88)

c>n+1

=

(cid:18)c − 1
(cid:88)

c − n

(cid:19)
(cid:18)c − 1

(cid:19)

c − n

c>n+1

λc,c−nαc−1 + nσαn−1 + nθν1αn+1, n ≥ 1,

(4.20)

(4.21)

again using the convention (2.6). The quantities αn, n ≥ 0, are tail probabilities (of the
distribution of Leq), thus they are monotone, with α0 = 1, and α∞ := limj→∞ αj = 0.
Together with these boundary conditions, Eq. (4.21) divided by n gives the system (2.5)
with an replaced by αn.
To prove uniqueness, let bn := an−1 − αn−1. Then we have the boundary conditions
b1 = 0 and bn → 0 for n → ∞. In addition, since both (αn−1)2≤n<∞ and (an−1)2≤n<∞
are GD-harmonic, (bn)2≤n<∞ is GD-harmonic as well. Let T (k) := min{t ≥ 0 : Dt ∈

12

{1, k, k+1, . . .}}. Note that T (k) is ﬁnite a.s. for every k > 1. Since, given D0 = (cid:96), (bDt)t≥0 is
a bounded martingale, due to the optional stopping theorem we have b(cid:96) = E[bDT (k) | D0 = (cid:96)]
for all k > 1. Because bDT (k) → 0 as k → ∞, this implies b(cid:96) = 0 for all (cid:96), and hence the
desired uniqueness.

Acknowledgements

We thank Martin Möhle for a valuable hint that helped to include the star-shaped coa-
lescent into Theorem 2.5. We are also grateful to Fernando Cordero and Sebastian Hummel
for fruitful discussions. This project received ﬁnancial support from Deutsche Forschungs-
gemeinschaft (Priority Programme SPP 1590 Probabilistic Structures in Evolution, grants
no. BA 2469/5-1 and WA 967/4-1).

References
[1] B. Bah and E. Pardoux, The Λ-lookdown model with selection, Stoch. Proc. Appl. 125

(2015), 1089–1126.

[2] N. Berestycki, Recent progress in coalescent theory, Ensaios Mat. 16 (2009).
[3] P. Cliﬀord and A. Sudbury, A sample path proof of the duality for stochastically mono-

tone Markov processes, Ann. Probab. 13 (1985), 558–565.

[4] J. T. Cox and U. Rösler, A duality relation for entrance and exit laws for Markov

processes, Stoch. Proc. Appl. 16 (1984), 141–156.

[5] A. Depperschmidt, A. Greven, and P. Pfaﬀelhuber, Tree-valued Fleming-Viot dynamics

with mutation and selection, Ann. Appl. Probab. 22 (2012), 2560–2615.

[6] P. Donnelly and T. G. Kurtz, Genealogical processes for Fleming-Viot models with

selection and recombination, Ann. Appl. Probab. 9 (1999), 1091–1148.

[7] A. M. Etheridge, R. C. Griﬃths, and J. E. Taylor, A coalescent dual process in a
Moran model with genic selection, and the Lambda coalescent limit, Theor. Popul. Biol.
78 (2010), 77–92.

[8] P. Fearnhead, The common ancestor at a nonneutral locus, J. Appl. Probab. 39 (2002),

38–54.

[9] C. Foucart, The impact of selection in the Λ-Wright-Fisher model, Electron. Commun.

Probab. 18 (2013), 1–10.

[10] R. C. Griﬃths, The Λ-Fleming-Viot process and a connection with Wright-Fisher dif-

fusion, Adv. Appl. Probab. 46 (2014), 1009–1035.

[11] F. Gaiser and M. Möhle, On the block counting process and the ﬁxation line of ex-

changeable coalescents, preprint available at arXiv:1603.09077 [math.PR].

[12] Ph. Herriger and M. Möhle, Conditions for exchangeable coalescents to come down from

inﬁnity, ALEA Lat. Am. J. Probab. Math. Stat. 9 (2012), 637–665.

[13] O. Hénard, The ﬁxation line in the Λ-coalescent, Ann. Appl. Probab. 25 (2015), 3007–

3032.

[14] S. Jansen and N. Kurt, On the notion(s) of duality for Markov processes, Probab. Surv.

11 (2014), 59–120.

13

[15] S. Kluth, T. Hustedt, and E. Baake, The common ancestor process revisited, Bull. Math.

Biol. 75 (2013), 2003–2027.

[16] S. M. Krone and C. Neuhauser, Ancestral processes with selection, Theor. Popul. Biol.

51 (1997), 210–237.

[17] U. Lenz, S. Kluth, E. Baake, and A. Wakolbinger, Looking down in the ancestral selec-
tion graph: A probabilistic approach to the common ancestor type distribution, Theor.
Popul. Biol. 103 (2015), 27–37.

[18] P. Donnelly and T. G. Kurtz, Particle representations for measure-valued population

models, Ann. Probab. 27 (1999), 166–205.

[19] P. Pfaﬀelhuber and A. Wakolbinger, The process of most recent common ancestors in

an evolving coalescent, Stoch. Proc. Appl. 116 (2006), 1836–1859.

[20] J. Pitman, Coalescents with multiple collisions, Ann. Probab. 27 (1999), 1870–1902.
[21] S. Sagitov, The general coalescent with asynchronous mergers of ancestral lines, J. Appl.

Probab. 36 (1999), 1116–1125.

[22] D. Siegmund, The equivalence of absorbing and reﬂecting barrier problems for stochas-

tically monotone Markov processes, Ann. Probab. 4 (1976), 914–924.

[23] J. E. Taylor, The common ancestor process for a Wright-Fisher diﬀusion, Electron. J.

Probab. 12 (2007), 808–847.

14

