The Langevin Approach:

An R Package for Modeling Markov Processes

Philip Rinn

Pedro G. Lind

Universit¨at Oldenburg

Universit¨at Oldenburg

Matthias W¨achter
Universit¨at Oldenburg

Joachim Peinke

Universit¨at Oldenburg

Abstract

We describe an R package developed by the research group Turbulence, Wind energy
and Stochastics (TWiSt) at the Carl von Ossietzky University of Oldenburg, which ex-
tracts the (stochastic) evolution equation underlying a set of data or measurements. The
method can be directly applied to data sets with one or two stochastic variables. Exam-
ples for the one-dimensional and two-dimensional cases are provided. This framework is
valid under a small set of conditions which are explicitly presented and which imply sim-
ple preliminary test procedures to the data. For Markovian processes involving Gaussian
white noise, a stochastic diﬀerential equation is derived straightforwardly from the time
series and captures the full dynamical properties of the underlying process. Still, even
in the case such conditions are not fulﬁlled, there are alternative versions of this method
which we discuss brieﬂy and provide the user with the necessary bibliography.

Keywords: R, stochastic processes, data analysis.

1. Introduction

When dealing with stochastic series of data measurements, standard statistical tools, such as
mean and centered moments, are able to catch the essential features of the distribution of
observed values. Last end, suﬃcient high-order moments will retrieve a good approximation
of the probability density function (PDF) associated with the stochastic process. However,
PDFs are not able to fully characterize the dynamics underlying the process. A typical
example is the Gaussian distribution: if the stochastic variable assumes values according to
a Gaussian distribution, the dynamics producing such distribution of values can be as simple
as an Ornstein-Uhlenbeck process (Risken 1996) but it may also be the result of a much
more complicated dynamics, as we exemplify below. Thus, while knowing the distribution
of observed values is important as a ﬁrst approach to the data, uncovering the complete
dynamics of the process provides a much deeper insight into the system, which cannot be
accessed through standard statistical tools.

Starting from a stochastic diﬀerential equation, a process can be statistically reconstructed
through simple stochastic integration. The inverse problem however is much more compli-
cated: would a set of measurements be enough for a bottom-up approach to infer the under-
lying dynamics of the process? The short answer is yes, there are cases where this is possible.
In this paper we present the long answer implemented as a package for R (see R Core Team
2015), which can be easily used, composing a method which we call the Langevin Approach.
This approach was introduced by Peinke and Friedrich in the late 1990s (Friedrich and Peinke

6
1
0
2

 
r
a

M
 
7
 
 
]
n
a
-
a
t
a
d

.
s
c
i
s
y
h
p
[
 
 

1
v
6
3
0
2
0

.

3
0
6
1
:
v
i
X
r
a

2

The Langevin Approach:

An R Package for Modeling Markov Processes

1997; Siegert et al. 1998) and further developed in the last decades. For a review see Friedrich
et al. (2011).

We start in Section 2 by describing the mathematical background on which our method is
based. Here we also discuss the necessary conditions for the method to be applicable. The R
functions implementing our approach are presented in Section 3 together with two examples
for one and for two stochastic variables. Additional remarks on our method are discussed
in Section 4, providing the user with supplementary issues and suggestions for more general
situations, in particular those where the conditions supporting our mathematical background
do no longer hold. A selected bibliography is also provided. Finally, Section 5 concludes the
paper.

2. Stochastic equations: from data to models and back

2.1. The Langevin model

A wide range of dynamical systems can be described by a stochastic diﬀerential equation,
the (non-linear) Langevin equation (cf. Risken 1996; H¨anggi and Thomas 1982; Van Kampen
2007).

Consider a general stochastic trajectory X(t) in time t. The time derivative of the system’s
trajectory dX
dt can be expressed as the sum of two complementary contributions: one being
purely deterministic and another one being stochastic, governed by a stochastic “force” Γ(t),
deﬁned as a δ-correlated Gaussian white noise, i.e., (cid:104)Γ(t)(cid:105) = 0 and (cid:104)Γ(t)Γ(t(cid:48))(cid:105) = 2δ(t − t(cid:48)).
While the deterministic term is deﬁned by a function, D(1)(X) the stochastic contribution is
weighted by another function, D(2)(X), yielding the evolution equation of X

(cid:113)

dX
dt

= D(1)(X) +

D(2)(X) Γ(t) ,

(1)

where the square root is taken for consistency, as will be clear below. We assume stationary
time series here, so D(1) and D(2) are not time dependent but we show brieﬂy how non-
stationary time series can be treated in Section 4.

The Langevin equation should be interpreted as follows: for every time t where the system
meets an arbitrary but ﬁxed point X in phase space, X(t + τ ) with small τ is deﬁned by the

deterministic function D(1)(X) and the stochastic function (cid:112)D(2)(X)Γ(t), through trivial

(Euler) stochastic integration (Friedrich et al. 2011):

X(t + τ ) = X(t) + D(1)(X)τ +

(cid:113)

D(2)(X)τ η(t) ,

(2)

where η(t) is a normally distributed random variable. Here we use the Itˆo picture of stochastic
integrals, for further details see Gardiner (2004).
Functions D(1)(X) and D(2)(X) are usually called drift and diﬀusion coeﬃcients respectively
and they can be as simple as constants or linear functions of X, as e.g., the Ornstein-Uhlenbeck
process, as well as more complicated nonlinear functions, typically polynomials up to a given
order. In particular if D(2) is explicitly depending on x, the case is called multiplicative noise.
In all cases, through substitution of the selected functions into Equation 2 one is able to
generate samples of series having the same statistical features and obeying the same dynamics.

Philip Rinn, Pedro Lind, Matthias W¨achter, Joachim Peinke

3

Figure 1: (a) Sketch of a stochastic process in time governed by a cubic drift and quadratic
diﬀusion contributions and (b) its corresponding probability density function (PDF). Though
the series shows a bistable dynamics (cubic drift) the PDF follows a Gaussian function,
equivalent to an Ornstein-Uhlenbeck process (see text).

Figure 1a shows an illustration of a time series obtained through integration of Equation 2 for
a cubic drift D(1)(X) = −X 3 + X, and a quadratic diﬀusion, D(2)(X) = X 2 + 1. Notice that
these drift and diﬀusion coeﬃcients describe a non-trivial dynamics, namely the underlying
deterministic process, i.e., D(2) ≡ 0, has two attractive ﬁxed points at X = ±1. The processes
tends to converge to one of two stable states being at the same time perturbed by a stochastic
ﬂuctuation (D(2) (cid:54)= 0) which is able to push the system from one stable ﬁxed point to the
other. As shown in Figure 1b, despite this non-trivial dynamics, the PDF is a Gaussian
distribution with zero mean and unit standard deviation, the same PDF as for a simple
Ornstein-Uhlenbeck process with D(1) = −X and D(2) = 1.
This is one of many possible examples that illustrates the deep insight, which an evolution
equation like in Equation 1 can provide and which is not obtained by looking at a density
distribution, see Appendix A for further details.

2.2. From stochastic data to the Langevin model

As explained previously, it is easy to generate data through the integration of a stochastic
equation, such as Equation 2. More diﬃcult is the inverse problem, to derive functions D(1)
and D(2) from given data.
A condition to derive the drift and diﬀusion numerically is that the time-steps τ of the set
of X-values are small enough (see Honisch and Friedrich (2011) for details). If the system is
at time t in the state x = X(t) the drift can be calculated for small τ by averaging over the
diﬀerence, X(t + τ ) − X(t), of the system state at t + τ and the state at t. Check Equation 2
above. This average is the ﬁrst conditional moment of the series and it can be mathematically
proven that its time derivative yields the drift coeﬃcient. Similarly, computing the second

4

The Langevin Approach:

An R Package for Modeling Markov Processes

Figure 2: One-dimensional Langevin Approach: (a) drift coeﬃcient, D(1)(x) = −x3 + x, and
(b) diﬀusion coeﬃcient, D(2)(x) = x2 + 1. Circles indicate the numerical results while the
red dashed line indicates the theoretical coeﬃcient, used when generating the synthetic data.
Here 107 data points from the series illustrated in Figure 1a, were used for computing the
averaged conditional moments.

conditional moment, i.e., the average squared diﬀerences between X(t + τ ) and x, yields the
diﬀusion coeﬃcient (Risken 1996).

Therefore, having a series of data, one estimates the drift and diﬀusion by computing the
averages of the ﬁrst and second power of the diﬀerences between X(t + τ ) and x:

M (n)(x, τ ) = (cid:104)(X(t + τ ) − X(t))n(cid:105)|X(t)=x,

(3)
where (cid:104)·(cid:105) represents the average over time t. Mathematically the drift and diﬀusion coeﬃcients
are deﬁned as (Risken 1996)

D(n)(x) = lim
τ→0

1
n!τ

M (n)(x, τ ),

(4)

which means that they are given by derivatives of the corresponding conditional moments
M (n)(x, τ ) with respect to τ . In many cases, for a ﬁxed x, the conditional moments depend
linearly on τ for the smallest range of τ values and consequently the drift and the diﬀusion
coeﬃcients at this state x are estimated solely by the quotient between the corresponding
conditional moment and τ in this range.

Figures 2a and 2b show respectively the drift and diﬀusion coeﬃcients of the series integrated
in the previous section and sketched in Figure 1. The theoretical expressions of the coeﬃcients
used when generating the synthetic data through integration of Equation 1 are indicated as
red dashed lines, while the estimated values of the coeﬃcients at each selected bin are plotted
with bullets.

−4−2024−50050x [a.u.]Drift coefficient D(1)(x) [1s]lllllllllllllllllllllllllllllllll(a)−4−20245101520x [a.u.]Diffusion coefficient D(2)(x) [1s2]lllllllllllllllllllllllllllllllll(b)Philip Rinn, Pedro Lind, Matthias W¨achter, Joachim Peinke

5

2.3. Back to the data

The Langevin Approach summarized previously is applied under a few conditions, though, as
we discus afterwards, when such conditions are not fulﬁlled in many cases it is still possible to
overcome that and apply an alternative approach which also retrieves the dynamics underlying
the stochastic process. For the completeness of this paper and for the consistency of the
application of our R functions, we advise the user to brieﬂy test the data. Three conditions
should in general be tested as a preliminary checking procedure and two further conditions
can afterwards be tested as cross-checking.

The ﬁrst condition is that the data series is stationary. Indeed, the averages for computing
the conditional moments have to be taken over all t = ti where X(ti) = x (see Equation 3).
If the series is non-stationary these averages are in principle not meaningful.

The second condition is that the process should be Markovian, i.e., the present state should
depend on the previous state solely. Mathematically it means an equivalence between two-
point statistics, p(X(t + τ ), X(t)), and any higher-order statistics, p(X(t + τ ), X(t), ..., X(t −
nτ )). This equivalence leads to the following equality between conditional probabilities of
ﬁnding a value of X(t + τ ) under the condition that X(t), X(t− τ ), ..., X(t− nτ ) have selected
values:

p(X(t + τ )|X(t)) = p(X(t + τ )|X(t), ..., X(t − nτ )) .

(5)

This should hold for any positive integer n. In practice, one tests the equality for three-point
statistics (n = 1) only and assumes that if the equality holds it will also hold for higher-order
statistics, since all correlations shall decrease monotonically with time.

To test if the process is Markovian one can also use alternatively the Wilcoxon test (Wilcoxon
1945), in case one is dealing with single variable stochastic processes. For details see Renner
et al. (2001, Appendix A).

The third condition to be tested comes from a mathematical result called Pawula Theorem
(Risken 1996), from which it follows a necessary condition for Equation 1 to be valid: the
fourth conditional moment must be constant, i.e., D(4) = 0. To test that one computes its
derivative with respect to the time-lag, the fourth coeﬃcient

D(4)(x) = lim
τ→0

1
4!τ

(cid:104)(X(t + τ ) − X(t))4(cid:105)|X(t)=x

(6)

and check if it vanishes, i.e., if it is small compared to the diﬀusion coeﬃcient: D(4)(x) (cid:28)
(D(2)(x))2 ∀x. This coeﬃcient is also useful for computing the numerical error of the diﬀusion
coeﬃcient (Lind et al. 2010).

The tests whether conditions two and three hold ensure that Γ(t) (see Equation 1) is δ-
correlated and Gaussian distributed.

If all these conditions are fulﬁlled the Langevin Approach can be carried out and the two
functions, drift coeﬃcient D(1) and diﬀusion coeﬃcient D(2), can be derived from the given
data. With the derived coeﬃcients two additional cross-checking tests can be done.

The ﬁrst one is to check if the stochastic force in Equation 1 fulﬁlls the two conditions of a
δ-correlated Gaussian white noise. To that end, one substitutes in Equation 2 the derived

6

The Langevin Approach:

An R Package for Modeling Markov Processes

D(1)(X) and D(2)(X) and solves it with respect to η(t):

X(t + τ ) − X(t) − D(1)(X)τ

(cid:112)D(2)(X)τ

η(t) =

.

(7)

Taking τ as the time-step of the observed time-series and substituting in X(t + τ ) and X(t)
successive values of that series one re-obtains a series for η(t) which should be normally
distributed.
The second cross-checking test is to substitute in Equation 2 the derived D(1)(X) and D(2)(X)
coeﬃcients, generate synthetic series and compare if its increments

∆τ (t) = X(t + τ ) − X(t)

(8)

have the same distribution as the original series for a ﬁxed τ spanning from the time-step of
the original series up to two or more orders of magnitude larger.
Some extra care should be taken if the derived D(1)(X) and D(2)(X) coeﬃcients show linear
drift and quadratic diﬀusion forms as this is also the case for every Langevin process if the
sampling interval is large compared to the relaxation time of the process. Riera and Anteneodo
(2010) presented a method for cross-checking in this case.

Notice that, though the fulﬁllment of all such conditions through the proposed preliminary
tests and cross-checking tests guarantees that the Langevin Approach can be applied, the
rejection of one or more of these tests is still no reason for avoiding this approach. In Section 4
we will come back to this issue.

3. Implementation and examples

In this section we present the implementation of the Langevin Approach describing the two
available R functions, Langevin1D and Langevin2D. The function Langevin1D deals with
single time-series while Langevin2D should be used for two-dimensional cases, when one has
two stochastic variables to be analyzed simultaneously.

The one-dimensional case deals with an evolution equation similar to Equation 1 and the
two-dimensional case comprehends two stochastic variables, X1(t) and X2(t), governed by:

leading to:(cid:20) X1(t + τ )

(cid:21)

X2(t + τ )

(cid:21)

(cid:20) X1(t)

X2(t)

=

(cid:35)

+ τ
√

+

τ

D(1)
D(1)

1 (X1, X2)
2 (X1, X2)

(cid:20) g11(X1, X2) g12(X1, X2)

(cid:21)(cid:20) η1(t)

(cid:21)

(10)

g21(X1, X2) g22(X1, X2)

η2(t)

(cid:34)

(cid:21)

(cid:20) X1

X2

d
dt

=

D(1)
D(1)

1 (X1, X2)
2 (X1, X2)

(cid:21)(cid:20) Γ1(t)

(cid:21)

Γ2(t)

(cid:20) g11(X1, X2) g12(X1, X2)
ij =(cid:80)

g21(X1, X2) g22(X1, X2)

(9)

where clearly now the drift function D(1) = (D(1)
2 ) is a two-dimensional vector and the
diﬀusion coeﬃcient is a 2 × 2-matrix given by D(2) = ggT , i.e., D(2)
k gikgjk. Similar to
the one-dimensional case the integration of Equation 9 follows from a simple Euler scheme

1 , D(1)

(cid:35)

+

(cid:34)

Philip Rinn, Pedro Lind, Matthias W¨achter, Joachim Peinke

7

where η1(t) and η2(t) are two independent normally distributed random variables.
In our implementation the conditional moments M (n)(x, τ ), Equation 3, are estimated by
dividing the state space of x in N intervals, or bins, (I1, ..., IN ) and calculating the mean
values for each interval Ii:

M (n)(x, τ ) = (cid:104)(X(t + τ ) − X(t))n(cid:105)|X(t)∈Ii .

(11)

For estimating the drift and diﬀusion coeﬃcients from the conditional moments we insert
Equation 2 into Equation 11 and apply the conditional averages for n = 1, 2 leading to:

M (1)(x, τ ) ≈ D(1)(x)τ ,
M (2)(x, τ ) ≈ 2D(2)(x)τ + (D(1)(x)τ )2 .

(12)

(13)

Important to notice is that for M (2)(x, τ ), Equation 13, a term quadratic in D(1)(x) and τ
has to be considered. We estimate drift and diﬀusion coeﬃcients from the slope of a weighted
linear regression of Equations 12 and 13.

The implementation of the functions heavily relies on the C++ linear algebra library Armadillo
(Sanderson 2010) for which RcppArmadillo and Rcpp provide the integration with R (Ed-
delbuettel and Fran¸cois 2011; Eddelbuettel and Sanderson 2014). We choose Armadillo as
it results in fast code especially for large data sets and has an easy readable syntax. The
functions Langevin1D and Langevin2D use OpenMP (Dagum and Menon 1998) if available to
take advantage of shared memory multiprocessing. Here we parallelize the evaluation of the
drift and diﬀusion coeﬃcients for the bins as their evaluation is independent for each bin.

In the following subsections we present one- and two-dimensional examples of Langevin pro-
cesses and walk through the analysis based on the framework described in the previous section.

3.1. Langevin1D: analyzing one-dimensional data sets

As an example we integrate the Langevin equation illustrated in Figure 1a with cubic drift
and quadratic diﬀusion, namely

(cid:112)

= x(t) − x3(t) +

dx
dt

x2(t) + 1 Γ(t) .

(14)

The presented package provides the function timeseries1D to do the integration using an
Euler integration scheme:

R> library("Langevin")
R> sf <- 1000
R> set.seed(4711)
R> x <- timeseries1D(N = 1e7, d11 = 1, d13 = -1, d22 = 1, d20 = 1, sf = sf)

Extracting drift and diﬀusion coeﬃcients from the generated time series is done by the function
Langevin1D. Here two parameters that are important for the estimation have to be given as
arguments.

8

The Langevin Approach:

An R Package for Modeling Markov Processes

The ﬁrst one is the number of bins dividing the variable space x in discrete bins at which
drift and diﬀusion are estimated. This integer should not be so large that each bin does no
longer include a signiﬁcant number of points (typically ∼ 100) and also not so small that no
dependence of the drift and diﬀusion on the state variable can be observed.

The second parameter is the vector steps to calculate the conditional moments for diﬀerent
τ values (Equation 3). The conditional moments will be computed for each bin and for each
step. For each bin, a linear ﬁt is computed for all steps in steps. Typically a vector of up to
ten steps is given in samples (= τ · sf).

R> bins <- 40
R> steps <- c(1:3)

R> ests <- Langevin1D(x, bins, steps)

From the resulting list ests, plots of the estimated drift and diﬀusion coeﬃcients can be
generated (see Figure 2). Here we use plotrix (Lemon 2006) to add errorbars.

ylab = expression(paste("Drift coefficient ", D^(1), "(x) [a.u.]")),
cex = 2, pch = 20)

R> library("plotrix")
R> attach(ests)
R> par(mfrow = c(1, 2))
R> plotCI(mean_bin, D1, uiw = eD1, xlab = "x [a.u.]",
+
+
R> lines(mean_bin, mean_bin - mean_bin^3, col = "red", lwd = 3, lty = 2)
R> plotCI(mean_bin, D2, uiw = eD2, xlab = "x [a.u.]",
+
+
R> lines(mean_bin, mean_bin^2 + 1, col = "red", lwd = 3, lty = 2)

ylab = expression(paste("Diffusion coefficient ", D^(2), "(x) [a.u.]")),
cex = 2, pch = 20)

We now want to walk through some of the remarks given in Section 2.3 to check if the
conditions under which we applied the Langevin Approach are fulﬁlled. We do not check if
the time series is stationary and fulﬁlls the Markovian properties, since here we already know
this (as we are using synthetic data).

Therefore we concentrate on cross-checking the estimated drift and diﬀusion coeﬃcients. For
checking if D(4)(X) is small compared to D(2)(X) (Pawula Theorem) we use the function
summary which also computes the ratio between D(4) and (D(2))2:

R> summary(ests)

Number of bins: 40
Population of the bins:

Min. : 3
Median: 32034
Mean : 250000
Max. : 1053446

Number of NA's for D1: 7

Philip Rinn, Pedro Lind, Matthias W¨achter, Joachim Peinke

9

Number of NA's for D2: 7
Ratio between D4 and D2^2:

Min. : 0.002004
Median: 0.002102
Mean : 0.002385
Max. : 0.004487

The result shows that D(4)(X) is smaller than 0.5% of the squared diﬀusion coeﬃcient, indi-
cating the necessary condition of the Pawula Theorem holds.

As a second cross-check we compare the increments, as deﬁned in Equation 8, of the original
time series with the ones computed from the reconstructed time series based on the estimated
drift and diﬀusion functions.

To this end we ﬁt a cubic function to the estimated drift coeﬃcient and a quadratic function
to the diﬀusion coeﬃcient:

R> estD1 <- coef(lm(D1 ~ mean_bin + I(mean_bin^2) + I(mean_bin^3), weights = 1/eD1))
R> estD2 <- coef(lm(D2 ~ mean_bin + I(mean_bin^2), weights = 1/eD2))

The resulting coeﬃcients are used to generate a new time series with timeseries1D:

R> rec_x <- timeseries1D(N = 1e7, d10 = estD1[1], d11 = estD1[2], d12 = estD1[3],
+

d13 = estD1[4], d20 = estD2[1], d21 = estD2[2], d22 = estD2[3], sf = sf)

We want to emphasize here that the Langevin Approach does not require the drift and the
diﬀusion coeﬃcients to be of any particular functional form, from the estimated coeﬃcients
one could directly integrate a stochastic time series which can be used to calculate the incre-
ments. We ﬁt the estimated coeﬃcients to polynomials only to be able to use the function
timeseries1D for the integration.

From the original and the reconstructed time series we now calculate PDFs of the increments
for diﬀerent τ and plot them to inspect their agreement visually:

R> plot(1,1, log = "y", type = "n", xlim = c(-11, 12), ylim = c(1e-17, 5),
+

xlab = expression(Delta[tau]/sigma[Delta[tau]]), ylab = "density")

R> tau <- c(1,10,100,1000)
R> for(i in 1:4) {
+
+
+
+
+
+
+
+
+ }

delta <- diff(Ux, lag = tau[i])
rec_delta <- diff(rec_x, lag = tau[i])
den <- density(delta)
den$x <- den$x/sd(delta, na.rm = TRUE)
rec_den <- density(rec_delta)
rec_den$x <- rec_den$x/sd(rec_delta, na.rm = TRUE)
lines(den, lwd = 2, col = i)
lines(rec_den, lwd=2, lty = 2, col = i)

10

The Langevin Approach:

An R Package for Modeling Markov Processes

Figure 3: PDFs of the increments for τ = 1, τ = 10, τ = 100 and τ = 1000 time lags (from
top to bottom). Solid lines show the results for the original time series, broken lines the result
for the reconstructed time series.

Figure 3 shows the output: there is indeed good agreement of both increment PDFs for a wide
range of τ values. Therefore we can assume that our estimated drift and diﬀusion coeﬃcients
describe the process suﬃciently.

Notice once again that while the PDF of the series generated by Equation 14 is the same as
the one of the simple Ornstein-Uhlenbeck process, dx
is able to uncover the correct dynamics with a bistable drift and a non-constant diﬀusion. See
Appendix A.

dt = −x(t) + Γ(t), our Langevin Approach

3.2. Langevin2D: analyzing two-dimensional data sets

As a two-dimensional example we integrate the coupled Langevin equations in Equations 9
for a particular choice of the drift and diﬀusion coeﬃcients, namely (Siegert et al. 1998)

X1
dt
X2
dt

= X2 + aΓ1(t)
= 0.02X1 + 0.03X2 − X 3

1 − X 2

1 X2 + aΓ2(t) ,

(15a)

(15b)

where a is a constant. Figure 4a shows the integrated trajectory (X1, X2) for a = 0, a
case where no stochastic contribution is present, whereas in Figure 4b the same trajectory is
plotted now with stochastic forces having a constant amplitude of a = 0.05.

The integration is performed by timeseries2D. Drift and diﬀusion functions are full cubic
and quadratic polynomials respectively and the elements aij of the matrices are deﬁned by
the corresponding equations for the drift and diﬀusion terms (see Equations 9 and 10):

−10−505101e−081e−061e−041e−021e+00DtsDtdensityPhilip Rinn, Pedro Lind, Matthias W¨achter, Joachim Peinke

11

Figure 4: (a) Trajectory (X1(t), X2(t)) from Equations 15 with a = 0 and (b) the same
trajectory integrating the same equations with non-zero stochastic terms (a = 0.05). For
plotting 106 resp. 105 data points where used.

4(cid:88)

5−i(cid:88)

i=1

j=1

D(1)

1,2 =

aijx(i−1)

1

x(j−1)

2

and g11,12,21,22 =

3(cid:88)

4−i(cid:88)

i=1

j=1

aijx(i−1)

1

x(j−1)

2

.

Estimating the drift and diﬀusion coeﬃcients is done by Langevin2D, here the same rules for
bins and steps apply as for the one-dimensional case.
The results shown in Figure 5 are generated by the following command lines:

R> D1_1 <- matrix(0, nrow = 4, ncol = 4)
R> D1_1[1, 2] <- 1
R> D1_2 <- matrix(0, nrow = 4, ncol = 4)
R> D1_2[2, 1] <- 0.02
R> D1_2[1, 2] <- 0.03
R> D1_2[4, 1] <- -1
R> D1_2[3, 2] <- -1

R> g_11 <- matrix(0, nrow = 3, ncol = 3)
R> g_12 <- matrix(0, nrow = 3, ncol = 3)
R> g_21 <- matrix(0, nrow = 3, ncol = 3)
R> g_22 <- matrix(0, nrow = 3, ncol = 3)
R> g_11[1, 1] <- 0.0025
R> g_22[1, 1] <- 0.0025

R> set.seed(4711)
R> x <- timeseries2D(N = 1e8, 0.145, 0.0002, D1_1, D1_2,

12

The Langevin Approach:

An R Package for Modeling Markov Processes

Figure 5: Drift coeﬃcient of (a) the X1 component, D(1)
together with all diﬀusion coeﬃcients, namely (c) D(2)
Equation 9. Estimated with added noise, i.e., a = 0.05 in Equation 15.

1 , and (b) the X2 component, D(1)
2 ,
11 , (d) D(2)
21 . See

22 , (e) D(2)

12 = D(2)

+

g_11, g_12, g_21, g_22, sf = sf)

R> ests <- Langevin2D(x, bins, steps)

The numerical results can be properly ﬁtted through the functions used for the integration in
Equations 15, namely: D(1)
22 = 0.052
and D(2)
21 = 0. Notice that the large deviations in the boundaries are due to the ﬁnite
length of the time series and thus the lower population in the boundary bins resulting in a
poorer estimation of the drift and the diﬀusion.

2 = 0.02X1 +0.03X2−X 3

1 = X2, D(1)

12 = D(2)

1 −X 2

1 X2, D(2)

11 = D(2)

4. A glimpse beyond the Langevin package

The two examples exposed above show cases where all conditions are fulﬁlled. When analyzing
real empirical data sets this is often not the case: one or more of the conditions under which
the Langevin Approach is applied are not met. Still, in the last years we developed diﬀerent
alternatives and extensions to this approach to overcome speciﬁc situations in stochastic data
analysis. In this section we brieﬂy describe these alternatives and extensions.

One ﬁrst problem that researchers face is the non-stationary character often appearing in
real data. Here, one of two approaches may be possible. One is to ascertain if for “shorter”

−0.50.00.5−0.50.00.5−0.50.00.51.0X1X2Dx(1)(a)−0.50.00.5−0.50.00.5−1.0−0.50.00.51.0X1X2Dy(1)(b)−0.50.00.5−0.50.00.50.00150.00200.00250.0030X1X2Dxx(2)(c)−0.50.00.5−0.50.00.50.00200.00250.00300.00350.0040X1X2Dyy(2)(d)−0.50.00.5−0.50.00.5−5e−040e+005e−041e−03X1X2Dxy(2)(e)Philip Rinn, Pedro Lind, Matthias W¨achter, Joachim Peinke

13

time-windows of the data series stationarity may be assumed.
In case the data set can
be decomposed in a series of time-windows which may overlap, each one having more or
less constant statistical moments of the observable, the Langevin approach can be applied
separately to each one of them, yielding a set of drift and diﬀusion coeﬃcients, one for each
time-window. In the end one extracts one drift and one diﬀusion coeﬃcient, both functions
of the observable and also of time.

Another possibility to handle non-stationary data sets is to check if they can be conditioned
to other observables.
In that case, considering the periods of the data sets associated to
a particular value of the conditioning observable may be itself stationary. This is the case
of the stochastic series measured of wind turbines (W¨achter et al. 2011; Lind et al. 2014).
The power output of one wind turbine or the loads applied to it by the wind ﬁeld are two
observables whose measurement series are by themselves non-stationary. The wind velocity is
the observable driving those properties and it is also non-stationary. However, we have shown
that both wind power production (W¨achter et al. 2011) and instantaneous loads (Lind et al.
2014) can be analyzed through the Langevin Approach if we conditioned both the drift and
the diﬀusion coeﬃcients to each particular admissible value of the wind speed.

The second condition listed above is the Markov property. When the series of measurements
fails to fulﬁll the Markov tests described above, it cannot be reconstructed through stochastic
Euler integration since the next state cannot be estimated from the present state alone (see
Equation 2). This happens, for instance, when a Markov process is spoiled by additional
additive noise when a measurement is taken (see Kleinhans et al. 2007). While the process
alone, X(t), is Markovian, the actual measurement, which retrieves X(t) + Y (t), does not
fulﬁll the Markov property. In such cases the limits computed for the coeﬃcients D(1) and
D(2) diverge (see Equation 4): when τ → 0 the conditional moment for the measured values
(numerator) does not vanish. Still, it is frequently possible to obtain the correct drift and
diﬀusion coeﬃcients for the Markov process X(t) through simple changes of their estimates
(B¨ottcher et al. 2006; Lehle 2011, 2013; Scholz et al. 2015). In cases of correlated noise where
(cid:104)˜Γ(t)(cid:105) = 0 holds the drift coeﬃcient D(1)(X) can still be reconstructed correctly.
A third problem that may appear during preliminary tests of empirical data is the non-
vanishing fourth coeﬃcient D(4). As stated above in Section 2.3, according to Pawula Theorem
(Risken 1996) the fourth conditional moment must be independent of the time-lag τ . If not,
one cannot assume that the stochastic process is governed by a Langevin equation, Equation 1.
However, in such cases, although no evolution equation can be extracted and therefore the
estimated functions D(1) and D(2) have not the meaning of drift and diﬀusion contributions,
one can still use both to provide valuable insight about the system being analyzed. One
example is the work of Rinn et al. (2012) on in-situ analysis of the elastic features of a
mechanical beam structure for realistic excitations with correlated noise as it appears in real-
world situations. They could show that the slope of the drift coeﬃcient D(1) is a sensitive
indicator of the damage and compared to frequency based approaches, like power spectra,
which estimate changes of the eigenfrequency of the structure, it is even more sensitive to
small damages.

Finally, it is also important to stress that, while the functions of the presented package were
prepared for analyzing data series as processes in time, the Langevin Approach can be adapted
for analyzing processes in scale. In fact, when the process is not Markovian in time, violating
Equation 5, there is the possibility that it is Markovian in “scale”. What does this mean?
It means that the increments ∆τ introduced above follow a Markovian process in τ i.e., in

14

The Langevin Approach:

An R Package for Modeling Markov Processes

time-lags but are instationary. Such analysis in scale is able to reproduce e.g., turbulence
energy cascades (Friedrich and Peinke 1997; Stresing and Peinke 2010) or ocean rogue waves
(Hadjihosseini et al. 2014).

More details on all these extensions and alternatives to the Langevin Approach can be found
in Friedrich et al. (2011).

5. Discussion and conclusions

In this paper we present an R package for stochastic data analysis that is able to extract the
stochastic evolution equations of physical properties from sets of their measurements.

The introduced functions serve as a framework to analyze one- and two-dimensional time
series. They provide estimation of drift and diﬀusion coeﬃcients describing the deterministic
and the stochastic part of the analyzed process respectively. Integrating Langevin processes
numerically enables one for cross-checking the obtained result and for generation of synthetic
data sets.

Through illustrative examples we have shown that the Langevin evolution equation is able to
uncover complex dynamics, even in cases when the associated statistics is identical to many
other stochastic processes.

The presented package can be straightforwardly applied by R-users and it implies only a few
preliminary tests to ascertain if all conditions on which the Langevin Approach is built are
fulﬁlled. In case they are not, we brieﬂy explain how to overcome them with simple extensions
to the method that were already successfully applied in several applications (Friedrich et al.
2011).

Still, additional improvements of the presented functions are possible. For instance, instead
of using the common average bin value when performing the binning of the data, one can
incorporate a kernel-based regression of such values (Lamouroux and Lehnertz 2009) or a
maximum likelihood framework (Kleinhans 2012) for estimating the drift and diﬀusion func-
tions. Moreover, the approach can also be applied to data having low sampling rates (Honisch
and Friedrich 2011).

Acknowledgments

The authors thank Constantino Garcia Mart´ınez (University of Santiago de Compostela,
Spain) for useful discussions about our methods and motivating in sharing their implemen-
tation with a broader audience during his visit to our group. PGL thanks the German
Environment Ministry as part of the research project “Probabilistic loads description, moni-
toring, and reduction for the next generation oﬀshore wind turbines (OWEA Loads)” under
grant number 0325577B.

A. Diﬀerent stochastic dynamics, same stationary distribution

In this appendix we show that a large family of two-point statistical distributions, each one
univocaly deﬁning one Langevin equation, Equation 1, corresponds to a one-point statistics

Philip Rinn, Pedro Lind, Matthias W¨achter, Joachim Peinke

15

given by the standard normal distribution

P0(X) ∝ exp

(cid:18)

− X 2
2

(cid:19)

,

i.e., a Gaussian distribution with zero mean and unit variance.

(16)

To that end, we start with one important remark concerning the evolution equation of one
stochastic variable X, Equation 1: this equation is related to an another evolution equation,
namely the one of the probability density function (PDF) of X, so-called Fokker-Planck
Equation (Risken 1996):

∂P (X)

∂t

=

− ∂
∂X

D(1)(X) +

P (X) .

(17)

The stationary solution ( ∂P
(1996):

∂t = 0) of the one-dimensional Fokker-Planck is given by Risken

(cid:18)

(cid:19)
∂2
∂X 2 D(2)(X)

(cid:32)(cid:90)

(cid:33)

P (X) ∝

1

D(2)(X)

exp

D(1)(x)
D(2)(x)

X

dx

.

(18)

For the simple Ornstein-Uhlenbeck process, governed by Equation 1 with D(1) = −x and
D(2) = 1, the stationary PDF reduces to P0 in Equation 16.
One could, however, consider a much more complex dynamics such as the one exempliﬁed in
this paper, with a bistable (cubic) drift coeﬃcient and a non-constant diﬀusion, depending
quadratically on the stochastic variable X:

D(1)(X) = aX(b − X)(b + X) ,
D(2)(X) = c + dX 2 .

(19a)

(19b)

Here, D(1) has two stable ﬁxed points at ±b, with a maximum amplitude between them
proportional to a, while D(2) has a minimum value c and a broadness proportional to 1/d.
Substituting the cubic drift and the quadratic diﬀusion, given in Equations 19, into the
stationary solution, Equation 18, and integrating, yields the stationary solution:

(cid:18)(cid:90)
+ X 2(cid:17) a

(cid:16) c

c + dX 2 exp
1
d

1

d

X

2d (b2+ c

(cid:19)

(cid:32)

ab2x − ax3
c + dx2 dx
d )−1
− X 2
2 d
a

exp

P (X) ∝

=

(cid:33)

.

(20)

As one sees, the solution in Equation 20 has, in general, not only a Gaussian part, like
Ornstein-Uhlenbeck processes, but also a polynomial part with an exponent depending on all
parameters of D(1) and D(2). However, if the exponent is exactly zero,

(cid:16)

a
2d

b2 +

c
d

(cid:17) − 1 = 0

(21)

16

The Langevin Approach:

An R Package for Modeling Markov Processes

the polynomial part vanishes and the stationary solution reduces to the Gaussian distribution.
In the example used in Section 3.1 with a = b = c = d = 1, this is the case (see Figures 1 and
2 and Equation 14).

In general, the one-point statistic in the stationary regime given by Equation 18 yields Gaus-
sian distributions even in more complex dynamics than the one here chosen. One only needs
to have a drift coeﬃcient given by one polynomial of odd degree n > 0 and simultaneously
have a diﬀusion coeﬃcient given by a polynomial of degree n − 1. In that case, whatever
general expression both coeﬃcients have, it is always possible to ﬁnd a combination of their
parameter values for which the quotient D(1)/D(2) in the stationary solution reduces to a
linear function in x yielding the PDF of a Gaussian distribution. The two-point statistic,
P (X(t)|X(t − τ )), however is able to distinguish between sets of (D(1), D(2)) yielding the
same one-point statistic.

The ambiguity of one-point statistics in characterizing the dynamics of stochastic processes
in general, motivates the Langevin Approach implemented in our R package. Our approach
has the advantage of being parameter free: since it computes numerically D(1) and D(2)
without any given Ansatz, it can easily distinguish between higher-order drift and diﬀusion
coeﬃcients.

References

B¨ottcher F, Peinke J, Kleinhans D, Friedrich R, Lind PG, Haase M (2006). “Reconstruction
of Complex Dynamical Systems Aﬀected by Strong Measrement Noise.” Physical Review
Letters, 97, 090603. doi:10.1103/PhysRevLett.97.090603.

Dagum L, Menon R (1998). “OpenMP: An Industry Standard API for Shared-memory Pro-
gramming.” Computational Science & Engineering, IEEE, 5(1), 46–55. doi:10.1109/99.
660313.

Eddelbuettel D, Fran¸cois R (2011). “Rcpp: Seamless R and C++ Integration.” Journal of

Statistical Software, 40(8), 1–18. URL http://www.jstatsoft.org/v40/i08/.

Eddelbuettel D, Sanderson C (2014). “RcppArmadillo: Accelerating R with High-performance
C++ Linear Algebra.” Computational Statistics and Data Analysis, 71, 1054–1063. doi:
10.1016/j.csda.2013.02.005.

Friedrich R, Peinke J (1997). “Description of a Turbulent Cascade by a Fokker-Planck Equa-

tion.” Physical Review Letters, 78, 863–866. doi:10.1103/PhysRevLett.78.863.

Friedrich R, Peinke J, Sahimi M, Reza Rahimi Tabar M (2011). “Approaching Complexity
by Stochastic Methods: From Biological Systems to Turbulence.” Physics Reports, 506(5),
87–162. ISSN 0370-1573. doi:10.1016/j.physrep.2011.05.003.

Gardiner CW (2004). Handbook of Stochastic Methods. Third edition. Springer Verlag, Berlin.

Hadjihosseini A, Peinke J, Hoﬀmann N (2014). “Stochastic Analysis of Ocean Wave States
With and Without Rogue Waves.” New Journal of Physics, 16(5), 053037. doi:10.1088/
1367-2630/16/5/053037.

Philip Rinn, Pedro Lind, Matthias W¨achter, Joachim Peinke

17

H¨anggi P, Thomas H (1982). “Stochastic Processes: Time-Evolution, Symmetries and Linear

Response.” Physics Reports, 88, 207–319. doi:10.1016/0370-1573(82)90045-X.

Honisch C, Friedrich R (2011). “Estimation of Kramers-Moyal Coeﬃcients at Low Sampling

Rates.” Physical Review E, 83(6), 066701. doi:10.1103/PhysRevE.83.066701.

Kleinhans D (2012). “Estimation of Drift and Diﬀusion Functions from Time Series Data:
A Maximum Likelihood Framework.” Physical Review E, 85(2), 026705. ISSN 1550-2376.
doi:10.1103/physreve.85.026705.

Kleinhans D, Friedrich R, W¨achter M, Peinke J (2007). “Markov Properties in Presence
of Measurement Noise.” Physical Review E, 76(4), 041109. doi:10.1103/PhysRevE.76.
041109.

Lamouroux D, Lehnertz K (2009). “Kerner-based Regression of Drift and Diﬀusion Coeﬃcients
of Stochastic Processes.” Physics Letters A, 373, 3507–3512. doi:10.1016/j.physleta.
2009.07.073.

Lehle B (2011). “Analysis of Stochastic Time Series in the Presence of Strong Measurement
Noise.” Physical Review E, 83(2), 021113. ISSN 1550-2376. doi:10.1103/physreve.83.
021113.

Lehle B (2013). “Stochastic Time Series with Strong, Correlated Measurement Noise: Markov
Analysis in N Dimensions.” Journal of Statistical Physics, 152(6), 1145–1169. ISSN 1572-
9613. doi:10.1007/s10955-013-0803-z.

Lemon J (2006). “Plotrix: A Package in the Red Light District of R.” R-News, 6(4), 8–12.

URL https://cran.r-project.org/doc/Rnews/Rnews_2006-4.pdf.

Lind PG, Haase M, B¨ottcher F, Peinke J, Kleinhans D, Friedrich R (2010). “Extracting
Strong Measurement Noise from Stochastic Time Series: Applications to Empirical Data.”
Physical Review E, 81, 041125. doi:10.1103/PhysRevE.81.041125.

Lind PG, Herr´aez I, W¨achter M, Peinke J (2014). “Fatigue Loads Estimation Through a

Simple Stochastic Model.” Energies, 7, 8279–8293. doi:10.3390/en7128279.

R Core Team (2015). R: A Language and Environment for Statistical Computing. R Founda-

tion for Statistical Computing, Vienna, Austria. URL http://www.R-project.org/.

Renner C, Peinke J, Friedrich R (2001). “Experimental Indications for Markov Properties
of Small-scale Turbulence.” Journal of Fluid Mechanics, 433, 383–409. doi:10.1017/
S0022112001003597.

Riera R, Anteneodo C (2010). “Validation of Drift and Diﬀusion Coeﬃcients from Experimen-
tal Data.” Journal of Statistical Mechanics: Theory and Experiment, 2010(04), P04020.
doi:10.1088/1742-5468/2010/04/P04020.

Rinn P, Heißelmann H, W¨achter M, Peinke J (2012). “Stochastic Method for In-situ Damage
Analysis.” The European Physical Journal B, 86, 1–5. ISSN 1434-6028. doi:10.1140/
epjb/e2012-30472-8.

Risken H (1996). The Fokker-Planck Equation. Springer-Verlag.

18

The Langevin Approach:

An R Package for Modeling Markov Processes

Sanderson C (2010). “Armadillo: An Open Source C++ Linear Algebra Library for Fast
Prototyping and Computationally Intensive Experiments.” Technical report, NICTA. URL
http://arma.sourceforge.net/armadillo_nicta_2010.pdf.

Scholz T, Raischel F, Lopes V, Lehle B, W¨achter M, Peinke J, Lind P (2015). “Parameter-
free Resolution of the Superposition of Stochastic Signals.” submitted. URL http://arxiv.
org/abs/1510.07285.

Siegert S, Friedrich R, Peinke J (1998). “Analysis of Data Sets of Stochastic Systems.” Physics

Letters A, 243, 275–280. doi:10.1016/S0375-9601(98)00283-7.

Stresing R, Peinke J (2010). “Towards a Stochastic Multi-point Description of Turbulence.”

New Journal of Physics, 12(10), 103046. doi:10.1088/1367-2630/12/10/103046.

Van Kampen N (2007). Stochastic Processes in Physics and Chemistry. North-Holland Per-

sonal Library, third edition. Elsevier, Amsterdam.

W¨achter M, Milan P, M¨ucke T, Peinke J (2011). “Power Performance of Wind Energy Con-
verters Characterized as Stochstic Process: Applications of the Langevin Power Curve.”
Wind Energy, 14, 711–717. doi:10.1002/we.453.

Wilcoxon F (1945). “Individual Comparisons by Ranking Methods.” Biometrics, 1, 80–83.

doi:10.2307/3001968.

Aﬃliation:

Philip Rinn,
Institute of Physics and
ForWind – Center for Wind Energy research
C.v.O. Universit¨at Oldenburg
26111 Oldenburg, Germany
E-mail: philip.rinn@uni-oldenburg.de
URL: http://www.uni-oldenburg.de/twist

