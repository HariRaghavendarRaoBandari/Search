Exactly realizable desired trajectories

Jakob Löber

Institut für Theoretische Physik, Hardenbergstraße 36, EW 7-1, Technische Universität Berlin, 10623 Berlin

Abstract

Trajectory tracking of nonlinear dynamical systems with aﬃne open-loop controls is investigated. The control task is to
enforce the system state to follow a prescribed desired trajectory as closely as possible. We introduce exactly realizable
desired trajectories as these trajectories which can be tracked exactly by an appropriate control. Exactly realizable
trajectories are characterized mathematically by means of Moore-Penrose projectors constructed from the input matrix.
The approach leads to diﬀerential-algebraic systems of equations and is considerably simpler than the related concept of
system inversion. Furthermore, we identify a particularly simple class of nonlinear aﬃne control systems. Systems in this
class satisfy the so-called linearizing assumption and share many properties with linear control systems. For example,
conditions for controllability can be formulated in terms of a rank condition for a controllability matrix analogously to
the Kalman rank condition for linear time-invariant systems.

6
1
0
2

 
r
a

M
2

 

 
 
]

.

C
O
h
t
a
m

[
 
 

1
v
1
1
6
0
0

.

3
0
6
1
:
v
i
X
r
a

1. Introduction

A common approach to control is concerned with states
as the object to be controlled [1, 2]. Suppose a controlled
system, often called a plant in this context, has a certain
point x1 in state space, sometimes called the operating
point, at which the system works eﬃciently. The control
task is then to bring the system to the operating point x1,
and keep it there.
In contrast to that, here we develop an approach to con-
trol which centers on the state trajectory over time, x (t),
as the object of interest. We distinguish between the
controlled state trajectory x (t) and the desired trajec-
tory xd (t). The former is the trajectory which the time-
dependent state x (t) traces out in state space under the
action of a control signal, also called an input signal. The
latter is a ﬁctitious reference trajectory for the state over
time. It is prescribed in analytical or numerical form by
the experimenter. Depending on the choice of the desired
trajectory xd (t), the controlled state x (t) may or may not
exactly follow xd (t).
Of course, both approaches to control are closely related.
A single operating point in state space at which the sys-
tem is to be kept is nothing more than a degenerate state
trajectory. Equivalently, any state trajectory can be ap-
proximated by a succession of working points.
Trajectory tracking aims at enforcing, via a control signal
u (t), a system state x (t) to follow a prescribed desired
trajectory xd (t) as closely as possible within a time inter-
val t0 ≤ t ≤ t1. The distance between x (t) and xd (t) in
function space can be measured by the functional

J =

t1

1
2

ˆ

t0

dt (x (t) − xd (t))2 .

(1)

The smallest possible value J = 0 is attained if and only
if the state x (t) follows the desired trajectory exactly, i.e.,

x (t) = xd (t)

(2)

for all times t0 ≤ t ≤ t1. We call a desired trajectory
xd (t) for which Eq. (2) holds an exactly realizable desired
trajectory. Clearly, not every desired trajectory xd (t) can
be exactly realized. The question addressed in this article
is how, for a given aﬃne control system, exactly realizable
desired trajectories can be characterized mathematically.
Tracking and regulation of desired outputs are common
problems in applications and have a long history of re-
search. The linear quadratic regulator [3] is a cornerstone
of control theory. Further notable achievements are the so-
lution of the linear time-invariant (LTI) regulator problem
by Francis [4] and its generalization to nonlinear systems,
the Byrnes-Isidori regulator [5]. These regulators track
desired trajectories asymptotically and can deal with ex-
ternal disturbances and perturbations of initial conditions.
In contrast to that, here we consider the exact tracking of
desired trajectories in undisturbed systems by open-loop
control.
A concept closely related to our work is that of an inver-
sion of control systems. The idea there is to ﬁnd a second
controlled dynamical system which takes the desired out-
put of the original system as the input and outputs the
input of the original system. A control system is invert-
ible when the corresponding input-output map is injective.
The resulting control signal is open-loop and often referred
to as feed-forward control. Stabilization of potential in-
stabilities can be accomplished by an additional feedback
control. Early work investigated the invertibility of LTI
systems [6, 7, 8]. Hirschorn analyzed invertibility of non-
linear systems for single [9] and multivariable [10] input

March 3, 2016

signals. Inversion is commonly investigated by generating
and analyzing a hierarchy of auxiliary dynamical systems.
Newer works focus on the stability of inversion-based out-
put tracking by combining system inversion with feedback
[11, 12].
The formalism necessary for the mathematical characteri-
zation of realizable trajectories is introduced in Section 2.
Section 3 deﬁnes the notion of exactly realizable trajecto-
ries while Section 4 introduces output realizability. Sec-
tion 5 proposes a basic assumption, called the linearizing
assumption. This assumption deﬁnes a class of nonlinear
control systems which, to a large extent, behave like linear
systems. We demonstrate how controllability can be recov-
ered in our approach for systems satisfying the linearizing
assumption in Sections 6 and 7. Section 8 concludes with
a discussion and outlook.

2. Formalism

Consider the aﬃne control system for the state x ∈ Rn

with output y ∈ Rm and control signal u ∈ Rp,

˙x (t) = R (x (t)) + B (x (t)) u (t) , y (t) = h (x (t)) . (3)

The time derivative is denoted by ˙x (t) = d
dt x (t). The dy-
namical system (3) is supplemented with the initial con-
dition x (t0) = x0. The n × p input matrix B (x) may be
state dependent and is assumed to have full rank,

rank (B (x)) = p,

(4)

for all x ∈ Rn. The main elements of the formalism intro-
duced below are two complementary projection matrices
deﬁned in terms of the input matrix B (x).

Deﬁnition 1. The Moore-Penrose pseudo inverse [13] of
B (x), denoted by B+ (x), is deﬁned as the p × n matrix

B+ (x) =(cid:16)BT (x) B (x)(cid:17)−1

BT (x) .

(5)

The Moore-Penrose projectors P (x) and Q (x) are n × n
matrices deﬁned as

P (x) = B (x) B+ (x) , Q (x) = 1 − P (x) .

(6)

Remark 1. Note that the p × p matrix BT (x) B (x) has
full rank p because B (x) is assumed to have full rank.
Therefore, BT (x) B (x) is a quadratic symmetric non-singular
matrix and its inverse exists. From the deﬁnitions (6) fol-
low idempotence

P (x) P (x) = P (x) , Q (x) Q (x) = Q (x) ,

(7)

and complementarity

and their ranks are

rank (P (x)) = p,

rank (Q (x)) = n − p,

(10)

independent of x. Furthermore, multiplying P (x) and
Q (x) from the right with the input matrix B (x) yields
the important relations

P (x) B (x) = B (x) ,

Q (x) B (x) = 0.

(11)

Equation (11) shows that the p linearly independent columns
of B (x) are eigenvectors of P (x) to eigenvalue one and
eigenvectors of Q (x) to eigenvalue zero. Alternatively,
due to the idempotence of the projectors, the p eigen-
vectors of P (x) to eigenvalue one are given by the j ∈
{1, . . . , p} linearly independent columns pj (x) of P (x).
The remaining n − p eigenvectors are given by the i ∈
{1, . . . , n − p} linearly independent columns qi (x) of Q (x).

Remark 2. Using 1 = P (x) + Q (x), any state vector x
can be split up as

x = P (x) x + Q (x) x = v + w.

(12)

Because P (x) has rank p, only p ≤ n of the n components
of v = P (x) x are independent. Similarly, only n− p com-
ponents of w = Q (x) x are independent. p independent
components ˆv ∈ Rp of v and n − p independent compo-
nents ˆw ∈ Rn−p of w can be obtained as ˆv = ˆP
(x) x
and ˆw = ˆQ
(x) x, respectively. Here, the n × p matrix
ˆP (x) and the n × (n − p) matrix ˆQ (x) are constructed
from the linearly independent columns pi (x) of P (x) and
qi (x) of Q (x) as

T

T

ˆP (x) =(cid:0)p1 (x) | . . . |pp (x)(cid:1) ,
ˆQ (x) =(cid:0)q1 (x) | . . . |qn−p (x)(cid:1) .

(13)

(14)

If the projectors P (x) = P and Q (x) = Q are indepen-
dent of the state x, the vectors v = P x and w = Qx
are simply linear combinations of the original state com-
If P (x) and therefore Q (x) = 1 − P (x)
ponents x.
depends on x, both vectors v and w are nonlinear func-
tions of the state x. However, a state transformation can
be found such that v and w attain a particularly simple
form. Being a projector, Q (x) can be diagonalized by a
nonsingular n × n matrix T (x), resulting in a diagonal
n × n matrix QD,

QD = T −1 (x) Q (x) T (x) .

(15)

The ﬁrst p entries on the diagonal of QD are zero while
the remaining n − p entries on the diagonal of QD are one.
The same matrix T (x) diagonalizes the projector P (x)
as well. Deﬁning the transformed state vector ˜x as

˜x = T −1 (x) x,

(16)

Q (x) P (x) = P (x) Q (x) = 0.

(8)

the separation of the state can be seen to attain the par-
ticularly simple form

The projectors are symmetric,

˜x = T −1 (x) P (x) x + T −1 (x) Q (x) x

P T (x) = P (x) ,

QT (x) = Q (x) ,

(9)

= P D ˜x + QD ˜x = ˜v + ˜w

(17)

2

with

˜v = P D ˜x = (˜x1, . . . , ˜xp, 0, . . . , 0)T ,
˜w = QD ˜x = (0, . . . , 0, ˜xp+1, . . . , ˜xn)T .

(18)

(19)

The matrix T (x) can be constructed from the eigenvectors
of Q (x) in the usual manner. The state transformation
T −1 (x) leads to a new aﬃne control system for ˜x. This
new system may be viewed as a normal form of the aﬃne
control system (3) [14].

In the following theorem, we use the Moore-Penrose pro-
jectors to separate the controlled state equation in two
equations. The ﬁrst one provides a relation for the con-
trol signal, while the second equation is independent of the
control.

Theorem 1. Every aﬃnely controlled state equation (3)
can be split in two separate equations. The ﬁrst equation

Q (x) ( ˙x − R (x)) = 0,

(20)

is independent of the control signal u and is called the con-
straint equation. The second equation yields an expression
for the control u in terms of the controlled state x,

Deﬁnition 2. The Moore-Penrose pseudo inverse of C (x),
denoted by C+ (x), is the n × m matrix

C+ (x) = CT (x)(cid:16)C (x) CT (x)(cid:17)−1

.

(26)

The Moore-Penrose projectors M (x) and N (x) are n×n
matrices deﬁned by

M (x) = C+ (x) C (x) , N (x) = 1 − M (x) .

(27)

Remark 3. The ranks of M (x) and N (x) are

rank (M (x)) = m,

rank (N (x)) = n − m,

(28)

and they satisfy

M (x) CT (x) = CT (x) , N (x) CT (x) = 0.

(29)

With the help of M (x) and N (x) the state vector x (t)
can be split up as

x = M (x) x + N (x) x = C+ (x) y + N (x) x.

(30)

Thus the part M (x) x can be expressed in terms of the
output y while the part N (x) x remains undetermined.

u = B+ (x) ( ˙x − R (x)) .

(21)

3. Exactly realizable desired trajectories

Proof of Theorem 1. The controlled state equation (3)
can be written as

d
dt

(P (x) x + Q (x) x) = (P (x) + Q (x)) R (x)

+ (P (x) + Q (x)) B (x) u. (22)

Multiplying with Q (x) from the left and using Eq. (11)
yields Eq. (20). Multiplying Eq. (3) by BT (x) from the
left yields

BT (x) ˙x = BT (x) R (x) + BT (x) B (x) u.

(23)

Not every desired trajectory xd can be realized by con-
trol. Here, we formulate a condition which has to be sat-
isﬁed by a desired trajectory to be exactly realizable.

Theorem 2. The controlled state trajectory x (t) follows
the desired trajectory xd (t) exactly,

x (t) = xd (t) ,

(31)

if and only if

1. xd (t) satisﬁes the constraint equation

Q (xd (t)) ( ˙xd (t) − R (xd (t))) = 0,

(32)

Multiplying with (cid:16)BT (x) B (x)(cid:17)−1

Eq. (21) for the control.

from the left yields

2. the initial value xd (t0) equals the initial value x0 of

(cid:3)

the controlled state equation

A formalism based on Moore-Penrose projectors can be
introduced for the output as well. We assume an output
of the form

xd (t0) = x0,

(33)

3. the control signal enforcing xd (t) is given by

y (t) = C (x (t)) x (t) + a (t) .

(24)

u (t) = B+ (xd (t)) ( ˙xd (t) − R (xd (t))) .

(34)

The vector a (t) is independent of the state and can be
absorbed in the function y (t). We drop a (t) in the fol-
lowing. The m × n matrix C (x) with m ≤ n is assumed
to have full rank for all x,

Proof of Theorem 2. From Theorem 1 and x (t) = xd (t)
follows the necessity of conditions (32), (33) and (34). For
suﬃciency, expression (34) for the control is used in the
controlled state equation (3) to obtain

rank (C (x)) = m.

(25)

˙x = R (x) + B (x) B+ (xd) ( ˙xd − R (xd)) .

(35)

3

Note that B depends on the actual system state x while
B+ depends on the desired state xd. We introduce the
diﬀerence ∆x (t) between true and desired state as

∆x (t) = x (t) − xd (t) .

(36)

Using Eq. (35), the ODE for ∆x reads

∆ ˙x = R (∆x + xd) − ˙xd

+ B (∆x + xd) B+ (xd) ( ˙xd − R (xd)) ,

∆x (t0) = x (t0) − xd (t0) .

(37)

(38)

If the desired trajectory xd satisﬁes initially Eq. (33), the
If
initial condition for Eq.
condition (32) is satisﬁed, then ∆x (t) = 0 is a stationary
point of Eq. (37),

(37) vanishes, ∆x (t0) = 0.

∆ ˙x = R (xd) − ˙xd + P (xd) ( ˙xd − R (xd))

= Q (xd) ( ˙xd − R (xd)) = 0,

(39)

and so x (t) = xd (t) remains a solution to Eq. (35) for all
times.
(cid:3)

Remark 4. Because the control signal u (t) consists of
p ≤ n independent components, at most p one-to-one re-
lations between state components and control components
can be found. Thus, maximally p components of xd (t)
can be prescribed by the experimenter, while the remain-
ing n − p components are free. The time evolution of these
n − p components is ﬁxed by the constraint equation (32).
This motivates the name constraint equation: for an ar-
bitrary desired trajectory xd (t) to be exactly realizable,
it is constrained by Eq. (32). One possibility to obtain
n − p linearly independent equations from the constraint
equation is to use the matrix ˆQ deﬁned in Eq. (14) as

ˆQ (xd) ( ˙xd − R (xd)) = 0.

(40)

Remark 5. The necessity to satisfy the initial conditions
xd (t0) = x (t0) = x0, Eq. (33), leaves us with two possi-
bilities. Either the initial state x (t0) = x0 of the system
can be prepared such that it equals the initial value xd (t0)
of a given desired trajectory xd. Or the desired trajectory
xd must be designed such that it starts from the observed
initial state x0 of the system. The control signal as given
by Eq. (34) does neither depend on the current nor on
the previous state x of the system and is an open-loop
control signal. Only the initial state x0 of the actual con-
trolled system enters via the initial condition Eq. (33) for
the constraint equation. In general, the controlled system
may suﬀer from instability. For example, it is impossible
to prepare a real systems exactly in the initial state x0.
Furthermore, a mathematical model must be viewed as an
approximation of a real system. Disturbances which are
not taken into account in the model aﬀect the time evolu-
tion of the state. An additional feedback control may be
suﬃcient to stabilize unstable desired trajectories. How-
ever, a thorough discussion of these issues is outside the
scope of this article.

Equation (34) employs the Moore-Penrose pseudo in-
verse B+ (x) to obtain the control signal in terms of the
desired trajectory. This choice for a generalized inverse
matrix is not unique. Note that any p × n matrix Bg sat-
isfying BBgB = B is called a generalized inverse of the
n × p matrix B. Indeed, any p × n matrix K (x) with the
property

rank (K (x) B (x)) = p

(41)

for all x can be used to construct a generalized inverse
p × n matrix Bg (x) of B (x) as

Bg (x) = (K (x) B (x))−1 K (x) .

(42)

With the choice K (x) = BT (x), Bg (x) becomes the
Moore-Penrose pseudo inverse B+ (x). We demonstrate
the uniqueness of the control solution Eq. (34) and its in-
dependence of the choice of K (x) in the following theorem.
In principle, any generalized inverse constructed as in Eq.
(42) may be used to formulate the constraint equation and
the control solution.

Theorem 3. Let Ki (x) with i ∈ {1, 2} be two p × n ma-
trices with the property

rank (Ki (x) B (x)) = p.

(43)

Deﬁne two generalized inverses as

Bg

i (x) = (Ki (x) B (x))−1 Ki (x) ,

(44)

and corresponding projectors

P g

i (x) = B (x) Bg

i (x) , Qg

i (x) = 1 − P g

i (x) .

(45)

The control signals expressed in terms of the desired tra-
jectory are

ui (t) = Bg

i (xd (t)) ( ˙xd (t) − R (xd (t))) ,

(46)

with desired trajectory xd constrained by

0 = Qg

i (xd (t)) ( ˙xd (t) − R (xd (t))) .

(47)

Then both control signals are identical,

u1 (t) = u2 (t) .

(48)

Proof of Theorem 3. Multiplying the diﬀerence u1 −
u2 by B (xd) and exploiting the deﬁnitions of the projec-
tors as well as the constraint equations yields

B (xd) (u1 − u2)

1 (xd) − B (xd) Bg

2 (xd)) ( ˙xd − R (xd))

= (B (xd) Bg
= (P g
= (Qg

1 (xd) − P g
2 (xd) − Qg

2 (xd)) ( ˙xd − R (xd))
1 (xd)) ( ˙xd − R (xd)) = 0.

(49)

Thus u1 − u2 lies in the null space of the input matrix
B (xd). Because B (xd) has full rank p by assumption, its
null space contains only 0 and so u1 (t) = u2 (t).
(cid:3)

4

4. Output realizability

The constraint equation does not dictate which state
components are prescribed and which are ﬁxed by the con-
straint equation. In general, we have the freedom to choose
an output y = h (x) with m components such that under
the action of control, a prescribed desired output yd (t) is
exactly realized, yd (t) = y (t).

Theorem 4. Let xd (t) be an exactly realizable trajectory,
i.e., it satisﬁes the constraint equation (32) and the initial
condition Eq. (33). If xd (t) additionally satisﬁes

yd (t) = h (xd (t)) ,

then the output yd (t) is realized exactly, i.e.,

y (t) = yd (t) .

(50)

(51)

Proof of Theorem 4. Let ∆y (t) be deﬁned as

∆y (t) = yd (t) − y (t) = h (xd (t)) − h (x (t))

= h (xd (t)) − h (∆x (t) + xd (t)) ,

(52)

with ∆x (t) = x (t) − xd (t). For an exactly realizable
trajectory we have ∆x (t) = 0 and so y (t) = yd (t).
(cid:3)

The solution to a control problem consists of a solution
x to the controlled state equation (3) and a solution u
for the control signal. Within the framework of exactly
realizable trajectories, these are given by

u = B+ (xd) ( ˙xd − R (xd)) ,

x = xd.

(53)

For x = xd to hold, xd must satisfy the constraint equa-
tion (32). For output realizability, xd additionally has to
satisfy the output relation (50). Thus the only equations
which remain to be solved is the system of n − p + m in-
homogeneous diﬀerential-algebraic equations (DAE) given
by

conditions can be distinguished as follows. First, evaluat-
ing the output relation at t = t0 imposes m conditions on
the desired output as

yd (t0) = h (x0) .

(55)

Second, r initial conditions are accommodated by the con-
stants of integration arising in the constraint equation.
Third, in case that n− m− r = l > 0, l additional relations
between yd (t0) and x0 must be satisﬁed. The latter con-
ditions also involve the time derivative of yd at the initial
time t = t0. They ensure that the constraint equation is
satisﬁed also at t = t0,

Q (xd (t0)) ( ˙xd (t0) − R (xd (t0))) = 0.

(56)

We illustrate output realizability with the help of two ex-
amples.

Example 1. Consider the system

˙x1 (t) = x2 (t) ,
˙x2 (t) = R (x1 (t) , x2 (t)) + B (x1 (t) , x2 (t)) u (t) ,

(57)
(58)

with state vector x = (x1, x2)T , nonlinearity R (x) =
(x2, R (x1, x2))T , and input matrix B (x) = (0, B (x1, x2))T .
The initial condition is x (t0) = x0 = (x1,0, x2,0)T . The as-
sumption of full rank of B (x) for all x implies B (x1, x2) 6=
0. The system represents Newton’s equation of motion for
a point particle with unit mass. The particle moves with
position x1 and velocity x2 in one spatial dimensional un-
der the inﬂuence of an external force R and a control force
Bu. The Moore-Penrose pseudo inverse of the input ma-
trix B and the corresponding projectors are

B+ (x) = B (x1, x2)−2 (0, B (x1, x2)) ,

0 1 (cid:19) ,

P (x) = P =(cid:18) 0 0
Q (x) = Q = 1 − P =(cid:18) 1 0

0 0 (cid:19) .

(59)

(60)

(61)

yd = h (xd) ,

Q (xd) ( ˙xd − R (xd)) = 0.

(54)

The constraint equation and the control signal are

The desired output yd (t) represents an inhomogeneity and
renders Eqs. (54) a non-autonomous DAE. Equations (54)
have to be solved for n − p + m components of xd together
In principle,
with the n initial conditions xd (t0) = x0.
solutions can exist as long as m ≤ p.
If m < p, p − m
components of xd may be freely chosen as long as they
do not violate the initial conditions. We expect a solution
xd (t) to Eqs. (54) to depend on the entire history of the
output yd from the initial time t0 up to the current time
t. In a ﬁnal step, the solution for xd obtained from Eqs.
(54) is used in the control signal u, Eq. (34), to eliminate
n − p + m components of xd. In general, u (t) depends on
the entire history of yd up to the current time t.

Being a system of DAEs, Eqs. (54) cannot accommo-
date all n initial conditions. Consequences of the initial

˙x1,d (t) = x2,d (t) , u (t) =

˙x2,d (t) − R (x1,d (t) , x2,d (t))

B (x1,d (t) , x2,d (t))

,

(62)

respectively.

Let us ﬁrst assume that the output y is given by the
velocity x2, y (t) = x2 (t). The control task is then to
enforce a velocity over time prescribed by the experimenter
in form of the desired output yd. The system of DAEs for
output realizability (54) becomes

x2,d (t) = yd (t) ,

˙x1,d (t) = x2,d (t) .

(63)

The constraint equation is a diﬀerential equation for the
position x1,d and yields

x1,d (t) = x1,d (t0) +ˆ t

t0

dτ yd (τ ) .

(64)

5

To satisfy the initial condition xd (t0) = x0, we must have

The control signal in terms of the desired trajectory is

u (t) =

˙x2,d (t) − x3

1,d (t) + 3x2,d (t)

2 + sin2 (x4,d (t))

.

(71)

Equations (54) becomes

x1,d (t0) = x1,0,

x2,d (t0) = x2,0 = yd (t0) .

(65)

Thus, for a given desired output yd, the system has to
be prepared in the state x0 = (x1,0, yd (t0))T , with x1,0 a
free parameter. Or, for a given system with initial state
x0, the desired output must be chosen such that initially
yd (t0) = x2,0. The control signal becomes an expression
depending only on the desired output yd and the initial
value x1,0,

u (t) =

˙yd (t) − R(cid:16)x1,0 +´ t

t0

dτ yd (τ ) , yd (t)(cid:17)

B(cid:16)x1,0 +´ t

t0

dτ yd (τ ) , yd (t)(cid:17)

The context of a mechanical control system allows the
following interpretation of our approach. The constraint
equation can be viewed as the deﬁnition of the velocity of
a point particle. Neither an external force R nor a control
force Bu can change that deﬁnition. With only a single
control force, position x1 and velocity x2 over time cannot
be controlled independently from each other.

Instead of choosing the velocity x2 as the output, we
may choose the position y (t) = x1 (t) as well. The DAE
(54) becomes

x1,d (t) = yd (t) ,

˙x1,d (t) = x2,d (t) .

(67)

Here, the constraint equation is an algebraic equation for
the desired velocity x2,d, x2,d (t) = ˙yd (t), which is used
eliminate x2,d (t) from the control signal. We obtain an
expression which depends on the desired output only,

u (t) =

¨yd (t) − R (yd (t) , ˙yd (t))

B (yd (t) , ˙yd (t))

.

(68)

To satisfy the initial condition xd (t0) = x0, the desired
output yd (t) must satisfy the two initial conditions

x1,d (t0) = x1,0 = yd (t0) , x2,d (t0) = x2,0 = ˙yd (t0) .

yd (t) = x1,d (t) − 3x3,d (t) ,
˙x1,d (t) = −x1,d (t) + x2,d (t) ,
˙x3,d (t) = x1,d (t) − 2x3,d (t) ,
˙x4,d (t) = x2

3,d (t) − x4,d (t) ,

.

(66)

which must be solved for xd (t). We obtain

x1,d (t) = 3ˆ t

t0

dτ et−τ yd (τ ) + yd (t)

+ et−t0 (x1,d (t0) − yd (t0)) ,

x2,d (t) = ˙x1,d (t) + x1,d (t) ,

x3,d (t) =

1
3

(x1,d (t) − yd (t)) ,

(72)

(73)
(74)

(75)

(76)

(77)

(78)

x4,d (t) = et0−tx4 (t0) +

with

1

9 ˆ t

t0

dτ eτ +t−2t0 (f (τ ))2 ,

(79)

f (t) = x1 (t0) − yd (t0) + 3ˆ t

t0

dτ et0−τ yd (τ ) .

(80)

Enforcing the initial condition xd (t0) = x0 yields two ad-
ditional relations for the initial desired output,

x2,d (t0) = x2,0 = 2 (x1,0 + yd (t0)) + ˙yd (t0) ,

x3,d (t0) = x3,0 =

1
3

(x1,0 − yd (t0)) ,

(81)

(82)

while two values of the initial conditions are free parame-
ters,

x1,d (t0) = x1,0,

x4,d (t0) = x4,0.

(83)

(69)

5. Linearizing assumption

In this case, the initial desired output has to satisfy two
conditions because the constraint equation is a purely al-
gebraic equation which does not allow for an initial condi-
tion. Equation (68) is known as a variant of the so-called
computed torque formula and has found widespread appli-
cation in robotics [15, 16, 17].

Example 2. We consider the example from [11] with n =
4 and p = 1. The output is y = x1 − 3x3, and the nonlin-
earity R and input matrix B are given by

R (x) =


x2 − x1
x3
1 − 3x2
x1 − 2x3
x2
3 − x4




, B (x) =


0

2 + sin2 (x4)

0
0

.




(70)

Instead of having to solve the controlled dynamical sys-
tem (3) with the control signal acting as an inhomogene-
ity, the approach of exactly realizable trajectories leads to
Eqs. (54) with the desired output yd acting as an inhomo-
geneity. As the examples of the last section demonstrate,
Eqs. (54) are often considerably simpler than the origi-
nal controlled dynamical system. In both cases, no simple
analytical solution in closed form can be found for the
controlled dynamical system. In general, if the constraint
equation as well as the output relation is linear, the en-
tire controlled system can be regarded, in some sense and
to some extent, as being linear, even though the original
system (3) is nonlinear. Three conditions must be met for
Eqs. (54) to be linear.

Assumption 1. Linearizing assumption.

6

1. The projectors P (x) and Q (x) must be indepen-

dent of the state x,

P (x) = P = 1 − Q = const,

(84)

2. the nonlinearity R (x) must be linear with respect

to the input matrix B (x) in the sense that

QR (x) = QAx + Qb

(85)

with n × n matrix A and n-component vector b in-
dependent of the state x,

3. the output relation must be linear,

Remark 8. Systems satisfying the linearizing assumption
are feedback linearizable [2] without a state transform.
This can be seen as follows. Let the feedback-controlled
system be

˙x (t) = R (x (t)) + B (x (t)) u (x (t)) .

(90)

The control signal u ∈ Rp is transformed to the new con-
trol signal v ∈ Rp with the help of the n × p matrix H
as

u (x) = −B+ (x) (R (x) − Hv (x))

(91)

y (t) = Cx (t) .

(86)

to obtain

˙x (t) = QAx (t) + Qb + PHv (x (t)) ,

(92)

Employing these three assumptions together with the state
separation Eq. (30) yields

QN ˙xd = QAN xd + Qb + QAC+yd − QC+ ˙yd.

(87)

This is a system of n − p − r algebraic and r diﬀeren-
tial equations for the n − m independent components of
N xd (t). The number r is given by the rank of the matrix
product QN ,

where the linearizing assumption has been applied. Let the
projector P with rank p be rank-decomposed as P = F G
with constant n × p matrix F and constant p × n matrix
G. We introduce the new control signal ˜v (x) = GHv (x)
to get a linear feedback-controlled system,

˙x (t) = QAx (t) + Qb + F ˜v (x (t)) .

(93)

r = rank (QN ) ≤ min (rank (Q) , rank (N ))

6. Controllability

= min (n − p, n − m) .

(88)

Being an inhomogeneous linear diﬀerential-algebraic equa-
tion, closed form solutions for Eq. (87) can be obtained,
see [18, 19, 20]. However, a complete discussion is outside
the scope of this article and reserved for later investiga-
tions. Equation (87) assumes a particularly simple form
if m = p and r = n − p. This is the case for the out-
put C = ˆP
, or, as long as the input matrix is constant,
C = BT . These outputs imply M = P and N = Q, and
Eq. (87) becomes a system of n − p diﬀerential equations
for the n − p independent components of Qxd,

T

Q ˙xd = QAQxd + QAPxd + Qb.

(89)

Remark 6. Note that assumption (84) does neither imply
that the input matrix B (x) nor its Moore-Penrose pseudo
inverse B+ (x) is independent of x. Furthermore, while
the constraint equation is linear, the control signal u =
B+ (xd) ( ˙xd − R (xd)) may still depend nonlinearly on the
desired state xd.

Remark 7. Condition (85) is very restrictive. It enforces
n − p components to depend only linearly on the state.
However, some important models of nonlinear dynamics
satisfy the linearizing assumption. Among these are all
one-dimensional mechanical control systems discussed in
Example 1. Another prominent example is the FitzHugh-
Nagumo model [21], a prototype model for excitable sys-
tems as e.g. the neuron, with a control acting on the acti-
vator variable [14].

A system is called controllable, or full state control-
lable, if it is possible to achieve a transfer from an initial
state x (t0) = x0 at time t = t0 to a ﬁnal state x (t1) = x1
at the terminal time t = t1 [22]. Along which trajectory
the transfer is achieved is irrelevant. While for LTI sys-
tems conditions for controllability are easily expressed in
terms of a Kalman rank condition, these conditions are
more diﬃcult for nonlinear control systems [2, 23]. Here,
we derive a similar rank condition within the framework
of exactly realizable trajectories. This rank condition also
applies to systems satisfying the linearizing assumption 1.
We consider the controlled state equation (3) together with
the linearizing assumption Eq. (85). This implies a linear
constraint equation (32),

Q ˙xd = QAQxd + QAP xd + Qb.

(94)

Because the trajectory in between x0 and x1 is irrelevant,
we may assume that the state components Pxd (t) are pre-
scribed while the components Qxd (t) are governed by Eq.
(94). Equation (94) is an inhomogeneous linear dynami-
cal system for Qxd (t). Its solution with initial condition
Qxd (t0) = Qx0 yields

Qxd (t) = ˆ t

t0

dτ exp (QAQ (t − τ )) Q (APxd (τ ) + b)

+ exp (QAQ (t − t0)) Qx0.

(95)

Theorem 5. Controllability.
A nonlinear system Eq. (3) which satisﬁes the linearizing

7

assumption 1 is controllable if the n × n2 controllability
matrix

K =(cid:16)QAP|QAQAP| · · · | (QAQ)n−1 QAP(cid:17) .

satisﬁes the rank condition

rank (K) = n − p.

(96)

(97)

Proof of Theorem 5. Achieving a transfer from an ini-
tial to a ﬁnite state means the desired trajectory xd (t) has
to satisfy xd (t0) = x0 and xd (t1) = x1. Consequently,
P xd and Qxd have to satisfy the initial and terminal con-
ditions

Pxd (t0) = Px0,
Qxd (t0) = Qx0,

Pxd (t1) = Px1,
Qxd (t1) = Qx1.

(98)
(99)

The part Pxd is prescribed by the experimenter such that
(98).
it satisﬁes the initial and terminal conditions Eq.
Consequently, all initial and terminal conditions except
Qxd (t1) = Qx1 are satisﬁed. Enforcing this remaining
(95) of the constraint
condition onto the solution Eq.
equation yields

Qx1 = Qxd (t1) = exp (QAQ (t1 − t0)) Qx0

(100)

+ˆ t1

t0

dτ exp (QAQ (t1 − τ )) Q (APxd (τ ) + b) .

This can actually be viewed as a condition for the part
P xd. The transfer from x0 to x1 is achieved as long as
P xd satisﬁes Eq. (100).

Similarly to the proof of the Kalman rank condition in
[1], conditions on the state matrix A and the projectors
P and Q can be given such that Eq. (100) is satisﬁed.
Due to the Cayley-Hamilton theorem [24], any power of
matrices with i ≥ n can be expanded in terms of lower
order matrix powers as

n−1

(QAQ)i =

dik (QAQ)k .

(101)

Xk=0

The term involving Pxd (τ ) in Eq. (100) can be simpliﬁed,

dτ exp (QAQ (t0 − τ )) QAPxd (τ )

dτ  (t0 − τ )k

k!

+

dik

∞

Xi=n

(t0 − τ )i

i!

! P xd (τ ) ,

(102)

such that Eq. (100) becomes a truncated sum

exp (−QAQ (t1 − t0)) Qx1

dτ exp (QAQ (t0 − τ )) Qb

t0

n−1

− Qx0 −ˆ t1
Xk=0

=

(QAQ)k QAP αk (t1, t0) .

(103)

8

=

(QAQ)k QAP

t0

n−1

ˆ t1
Xk=0
×ˆ t1

t0

We deﬁned the n × 1 vectors αk for k ∈ {0, . . . , n − 1} as

αk (t1, t0)

= ˆ t1

t0

dτ  (t0 − τ )k

k!

+

dik

∞

Xi=n

(t0 − τ )i

i!

! P xd (τ ) .

(104)

The right hand side of Eq. (103) can be written with the
help of the n2 × 1 vector

α (t1, t0) = (α0 (t1, t0) , . . . , αn−1 (t1, t0))T

(105)

as

exp (−QAQ (t1 − t0)) Qx1 − Qx0

−ˆ t1

t0

dτ exp (QAQ (t0 − τ )) Qb = Kα (t1, t0) . (106)

We deﬁned the n × n2 controllability matrix K as given
by Eq. (96). The left hand side of Eq. (106) can be any
point in QRn = Rn−p. The mapping from Qx1 to α is
surjective, i.e., every element on the left hand side has a
corresponding element on the right hand side, if K has full
rank n − p.
(cid:3)

Remark 9. Using the complementary projectors P and
Q, the state matrix A can be split up in four parts as

A = PAP + PAQ + QAP + QAQ.

(107)

Note that the controllability matrix ˜K, Eq.
(96), does
only depend on the parts QAP and QAQ, but not on
PAP and PAQ. Consequently, only knowledge of the
parts QAP and QAQ is required to decide if a system is
controllable. This might be advantageous for applications
with incomplete knowledge about the underlying dynam-
ics.

7. Output controllability

Theorem 6. Output controllability.
The system (3) satisfying the linearizing assumption 1 is
output controllable if the output controllability matrix

KC =(cid:16)CP|CQAP| · · · |C (QAQ)n−1 QAP(cid:17)

satisﬁes the rank condition

(108)

rank (KC) = m.

(109)

Proof of Theorem 6. Using Eq. (95), the solution for
the linear output reads

yd (t) = CPxd (t) + C exp (QAQ (t − t0)) Qx0

+ Cˆ t

t0

dτ exp (QAQ (t − τ )) QAP xd (τ ) . (110)

Exploiting the Cayley-Hamilton theorem, Eq. (110) be-
comes

yd (t) − C exp (QAQ (t − t0)) Qx0

= CPxd (t) + C

n−1

Xk=0

(QAQ)k QAPβk (t, t0) .

(111)

The remainder of the proof proceeds analogously to the
proof of Theorem 5 for full state controllability.
(cid:3)

Remark 10. For C = 1 and m = n, output controllabil-
ity should reduce to full state controllability.
Indeed, if
the controllability matrix K, Eq. (96), satisﬁes the rank
condition rank (K) = n − p, then the matrix ˜K = (P|K)

satisﬁes rank(cid:16) ˜K(cid:17) = n, and KC reduces to ˜K for C = 1

and m = n.

Remark 11. Similar as for controllability, we can use the
Moore-Penrose projectors M and N constructed from the
output matrix C in Deﬁnition 2 to express observability in
terms of a rank condition for an observability matrix [14].

8. Conclusions and outlook

Exactly realizable desired trajectories are the subset of
desired trajectories xd (t) for which a control exists such
that the state over time x (t) follows the desired trajectory
exactly, x (t) = xd (t). By means of the Moore-Penrose
projectors deﬁned in Eqs. (6), we propose a separation of
the state equation (3) in two parts. The ﬁrst part, called
the constraint equation (32), is independent of the control
signal u. The second part Eq. (34) establishes a one-to-
one relationship between the p-dimensional control signal
u (t) and p out of n components of the desired trajectory
xd (t). The constraint equation ﬁxes those n − p compo-
nents of the desired trajectory xd (t) for which no one-to-
one relationship with the control signal exists. A desired
trajectory is exactly realizable if and only if it satisﬁes the
constraint equation.
We can distinguish 3 classes of desired trajectories xd:

(A) desired trajectories xd which are solutions to the un-

controlled system,

(B) desired trajectories xd which are exactly realizable,
(C) arbitrary desired trajectories xd.

Desired trajectories of class (A) satisfy the uncontrolled
state equation

˙xd (t) = R (xd (t)) .

(112)

This constitutes the most speciﬁc class of desired trajec-
tories. Because of Eq. (112), the constraint equation (32)
is trivially satisﬁed and the control signal given by Eq.
(34) vanishes, u (t) = 0. Class (A) encompasses several
important control tasks, as e.g. the stabilization of un-
stable stationary states and periodic orbits [25, 26]. Only

for desired trajectories of class (A) it is possible to ﬁnd
non-invasive controls. Non-invasive control signals vanish
upon achieving the control target. The open-loop control
approach developed here cannot be employed to trajec-
tories of class (A). Instead, the stabilization of unstable
solutions to uncontrolled systems requires feedback con-
trol.
Desired trajectories of class (B) satisfy the constraint equa-
tion (32) and yield a non-vanishing control signal u (t) 6=
0. The approach developed here applies to this class. Sev-
eral other techniques developed in mathematical control
theory as e.g. feedback linearization and diﬀerential ﬂat-
ness, also work with this class of desired trajectories [2, 27].
Class (B) contains the desired trajectories from class (A)
as a special case. For desired trajectories of class (A) and
class (B), the solution of the controlled state is simply
given by x (t) = xd (t).
Finally, class (C) is the most general class of desired tra-
jectories and contains class (A) and (B) as special cases.
In general, these desired trajectories do not satisfy the
constraint equation,

0 6= Q (xd (t)) ( ˙xd (t) − R (xd (t))) ,

(113)

such that the approach developed here cannot be applied
to all desired trajectories of class (C). A general expres-
sion for the control signal in terms of the desired trajectory
xd (t) is not available. Furthermore, the solution for the
controlled state trajectory x (t) is usually not simply given
by xd (t), x (t) 6= xd (t). A solution to control problems
deﬁned by class (C) does not only consist in ﬁnding an
expression for the control signal, but also involves ﬁnd-
ing a solution for the controlled state x (t). One possible
method to solve such control problems is optimal trajec-
tory tracking. This technique is concerned with minimiz-
ing the distance between x (t) and xd (t) in function space
as measured by the functional

J =

1
2

t1

ˆ

t0

dt (x (t) − xd (t))2 +

ǫ2
2

t1

ˆ

t0

dt (u (t))2 .

(114)

The functional J is to be minimized subject to the con-
straint that x (t) is given as the solution to the controlled
dynamical system (3). The regularization term with small
coeﬃcient 0 < ǫ ≪ 1 ensures the existence of solutions for
x (t) and u (t) within appropriate function spaces [3]. For
ǫ → 0, the state as well as the control may diverge [14] and
the optimization procedure becomes a so-called singular
optimal control problem [3]. However, because exactly re-
alizable desired trajectories satisfy x (t) = xd (t), they can
be viewed as bounded solutions to unregularized (ǫ = 0)
optimal trajectory tracking problems.

The linearizing assumption deﬁnes a class of nonlinear
control systems which essentially behave like linear con-
trol system. Systems satisfying the linearizing assumption
allow exact analytical solutions in closed form even if no
analytical solutions for the uncontrolled system exist. The

9

[14] J. Löber, Optimal trajectory tracking, Ph.D. thesis, Technical

University Berlin (2015).

[15] F. L. Lewis, C. T. Abdallah, D. M. Dawson, Control of Robot

Manipulators, 1st Edition, Macmillan Coll Div, 1993.

[16] C. C. de Wit, B. Siciliano, G. Bastin (Eds.), Theory of Robot
Control, 1st Edition, Communications and Control Engineering,
Springer, 2012.

[17] J. Angeles, Fundamentals of Robotic Mechanical Systems: The-
ory, Methods, and Algorithms, 4th Edition, no. 124 in Mechan-
ical Engineering Series, Springer, 2013.

[18] S. L. Campbell, Singular Systems of Diﬀerential Equations I,
Chapman & Hall/CRC Research Notes in Mathematics Series,
Pitman Publishing, 1980.

[19] S. L. Campbell, Singular Systems of Diﬀerential Equations II,
Chapman & Hall/CRC Research Notes in Mathematics Series,
Pitman Publishing, 1982.

[20] P. Kunkel, V. Mehrmann, Diﬀerential-Algebraic Equations:
Analysis and Numerical Solution, European Mathematical So-
ciety, 2006.

[21] R. FitzHugh, Mathematical models of threshold phenomena in
the nerve membrane, Bull. Math. Biophysics 17 (4) (1955) 257–
278.

[22] R. Kalman, On the general theory of control systems, IEEE

Trans. Autom. Control 4 (3) (1959) 110–110.

[23] A. Isidori, Nonlinear Control Systems, 3rd Edition, Communi-

cations and Control Engineering, Springer, 1995.

[24] S. Axler, Linear Algebra Done Right, 3rd Edition, Springer,

2014.

[25] E. Ott, C. Grebogi, J. A. Yorke, Controlling chaos, Phys. Rev.

Lett. 64 (1990) 1196–1199.

[26] E. D. Sontag, Stability and feedback stabilization, in: R. A.
Meyers (Ed.), Mathematics of Complexity and Dynamical Sys-
tems, Springer New York, 2011, pp. 1639–1652.

[27] H. Sira-Ramírez, S. K. Agrawal, Diﬀerentially Flat Systems, 1st
Edition, no. 17 in Automation and Control Engineering, CRC
Press, 2004.

[28] J. Löber, H. Engel, Controlling the position of traveling waves in
reaction-diﬀusion systems, Phys. Rev. Lett. 112 (2014) 148305.
[29] J. Löber, S. Martens, H. Engel, Shaping wave patterns in reac-

tion-diﬀusion systems, Phys. Rev. E 90 (2014) 062911.

[30] J. Löber, Stability of position control of traveling waves in re-

action-diﬀusion systems, Phys. Rev. E 89 (2014) 062904.

[31] J. Löber, R. Coles, J. Siebert, H. Engel, E. Schöll, Control of
chemical wave propagation, in: A. S. Mikhailov, G. Ertl (Eds.),
Engineering of Chemical Complexity II, World Scientiﬁc Lec-
ture Notes in Complex Systems, World Scientiﬁc, 2014, pp.
185–207.

linearizing assumption uncovers a hidden linear structure
underlying nonlinear open-loop control systems. Similarly,
feedback linearization deﬁnes a huge class of nonlinear con-
trol systems possessing an underlying linear structure [2].
The class of feedback linearizable systems contains the
systems satisfying the linearizing assumption as a trivial
case. However, the linearizing assumption deﬁned here
goes much further than feedback linearization. We were
able to apply the relatively simple notion of controllabil-
ity in terms of a rank condition to systems satisfying the
linearizing assumption. This is a direct extension of the
properties of linear control systems to a class of nonlin-
ear control systems. Furthermore, we may combine the
linearizing assumption with the viewpoint that exactly re-
alizable trajectories solve an unregularized optimal con-
trol problem. This reveals the possibility of linear struc-
tures underlying nonlinear optimal trajectory tracking in
the limit of vanishing regularization parameter ǫ → 0 [14].
Finally, we mention a possible extension of the ideas
expounded here to spatio-temporal systems. While gener-
alizing the notion of controllability to spatiotemporal sys-
tems encounters diﬃculties due to an inﬁnite-dimensional
state space, generalizing the notion of an exactly realizable
trajectory is straightforward [14]. We applied these ideas
in a slightly diﬀerent form to control the position, orien-
tation, and shape of wave patterns in reaction-diﬀusion
systems in [28, 29, 30, 31].

References

[1] C.-T. Chen, Linear System Theory and Design, 3rd Edition,
Oxford Series in Electrical and Computer Engineering, Oxford
University Press, 1998.

[2] H. K. Khalil, Nonlinear Systems, 3rd Edition, Prentice Hall,

2001.

[3] J. A. E. Bryson, Y.-C. Ho, Applied Optimal Control: Opti-
mization, Estimation and Control, Revised Edition, CRC Press,
1975.

[4] B. A. Francis, The linear multivariable regulator problem, SIAM

Journal on Control and Optimization 15 (3) (1977) 486–505.

[5] A. Isidori, C. I. Byrnes, Output regulation of nonlinear systems,

IEEE Trans. Autom. Control 35 (2) (1990) 131–140.

[6] P. Dorato, On the inverse of linear dynamical systems, Systems
Science and Cybernetics, IEEE Transactions on 5 (1) (1969)
43–48.

[7] L. M. Silverman, Inversion of multivariable linear systems, Au-
tomatic Control, IEEE Transactions on 14 (3) (1969) 270–276.
[8] M. K. Sain, J. L. Massey, Invertibility of linear time-invariant
dynamical systems, Automatic Control, IEEE Transactions on
14 (2) (1969) 141–149.

[9] R. M. Hirschorn, Invertibility of nonlinear control systems,
SIAM Journal on Control and Optimization 17 (2) (1979) 289–
297.

[10] R. M. Hirschorn, Invertibility of multivariable nonlinear control

systems, IEEE Trans. Autom. Control 24 (6) (1979) 855–865.

[11] S. Devasia, D. Chen, B. Paden, Nonlinear inversion-based out-
put tracking, IEEE Trans. Autom. Control 41 (7) (1996) 930–
942.

[12] Q. Zou, Optimal preview-based stable-inversion for output
tracking of nonminimum-phase linear systems, Automatica
45 (1) (2009) 230–237.

[13] S. L. Campbell, C. D. Meyer Jr., Generalized Inverses of Linear

Transformations, Dover Publications, 1991.

10

