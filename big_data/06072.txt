Astronomy & Astrophysics manuscript no. DiﬀPol-v5-nobf
March 22, 2016

c(cid:13) ESO 2016

6
1
0
2

 
r
a

 

M
9
1

 
 
]

M

I
.

h
p
-
o
r
t
s
a
[
 
 

1
v
2
7
0
6
0

.

3
0
6
1
:
v
i
X
r
a

Dual diﬀerential polarimetry. A technique to recover polarimetric

information from dual polarization observations.

I. Mart´ı-Vidal1, W. H. T. Vlemmings1, and S. Muller1

Department of Earth and Space Sciences, Chalmers University of Technology, Onsala Space Observatory, SE-43992
Onsala, Sweden

Submitted to A&A. First comments of referee incorporated

ABSTRACT

Current mm/submm interferometers, like the Atacama Large mm/submm Array (ALMA), use receivers that register
the sky signal in a linear polarization basis. In the case of observations performed in full-polarization mode (where the
cross-correlations are computed among all the polarization channels) it is possible to reconstruct the full-polarization
brightness distribution of the observed sources, as long as a proper calibration of delay oﬀsets and leakage among
polarization channels can be performed. Observations of calibrators, preferably with some linear polarization, with a
good parallactic angle coverage are usually needed for such a calibration. In principle, dual-polarization observations
only allow us to recover the Stokes I intensity distribution of the sources, regardless of the parallactic angle coverage of
the observations. In this paper, we present a novel technique of dual diﬀerential polarimetry that makes it possible to
obtain information related to the full-polarization brightness distribution of the observed sources from dual-polarization
observations. This technique is inspired in the Earth-rotation polarization synthesis and can be applied even to sources
with complex structures.

Key words. instrumentation: interferometers – techniques: interferometric – techniques: polarimetric

1. Introduction

Polarization is an essential source of information in the
study of astronomical objects. Polarization can be recorded
in two diﬀerent ways, either using receivers with circular-
or with linear-polarization feeds. At mm/submm wave-
lengths, new generation interferometers like ALMA are be-
ing equipped with linear polarization feeds, which decouple
the sky signal into two streams of linear polarization, one
being horizontal (with respect to either the antenna axis or
the frame of the receiver’s feed), called X, and one vertical,
called Y . These receivers have a high polarization purity,
which does not degrade for wide bandwidths. This is not
the case for circular-polarization receivers.

There are, however, some disadvantages of

linear-
polarization receivers used in interferometric observations,
like a more complex parallactic-angle correction when the
baselines involved are very long, or some degeneracies in
the calibration when the calibrators are linearly polarized
and the parallactic-angle coverage is not good enough (this
limitation is also present in circular-polarization feeds, al-
though to a lower extent).

An ordinary calibration and analysis of interferomet-
ric observations in a linear-polarization basis only provides
full-polarization information of the source structure if the
observations are performed in the so-called full-polarization
mode. In this mode, cross-correlations among all the polar-
ization channels of the antennas are performed: XX, XY ,
Y X, and Y Y . In principle, dual-polarization observations
(where only the cross-products XX and Y Y are performed)

Send oﬀprint requests to: I. Mart´ı-Vidal
e-mail: mivan@chalmers.se

would not be suﬃcient to extract polarization information
of the observed sources, as long as we use an ordinary data
reduction approach.

Nevertheless, it is still possible to get some polarimetry
information from dual-polarization data. This information
is subtly encoded in the relative values of the visibilities
in XX and Y Y , as well as in the time dependence of the
parallactic angle, ψ, of the antennas. The Earth rotation
changes ψ and allows us to synthesize the source polar-
ization distribution, due to the changing projection of the
source polarization angle, φ on the receiver’s axes, X and
Y .

In this paper, we present the new dual diﬀerential polar-
ization technique, which makes use of the ψ dependence of
the XX and Y Y visibilities. The performance of the tech-
nique on simulations and real observations is also discussed.

2. The dual diﬀerential polarimetry technique

The Stokes parameters, I, Q, U , and V , encode all the in-
formation about the polarization state of light. I is the total
intensity (polarized plus unpolarized), Q and U encode the
information about the linear polarization, and V is related
to the circular polarization. Full-polarization interferomet-
ric observations allow us to reconstruct the sky brightness
distribution of each one of the four Stokes parameters, from
which we can derive all the polarimetric information about
the observed sources. When linear-polarization feeds are
used, the cross-correlations XX, XY , Y X, and Y Y are
related to non-redundant linear combinations of I, Q, U ,
and V , being XX and Y Y only aﬀected by I, Q, and U .
In particular, the XX visibilities are related to the Fourier

1

Mart´ı-Vidal et al. (2015): Dual diﬀerential polarimetry in interferometric observations

transform of the brightness distribution of the sum of Stokes
parameters I + Q (see, e.g. Smirnov, 2011a). In a similar
way, the Y Y visibilities are related to the brightness distri-
bution of I − Q. The Stokes parameter Q in these expres-
sions is given in the frame of the receiver (i.e., horizontal
and vertical, with respect to the receiver’s frame), which
shall not be confused with the equatorial sky frame (i.e.,
referred to the celestial meridian crossing over the source).
As a consequence, we must apply a parallactic angle correc-
tion to the visibility matrix (Smirnov, 2011a), in order to
get the correct relationship between visibilities and bright-
ness distribution of the Stokes parameters. If the baselines
of our interferometer are not very long (so we can assume
the same parallactic angle, ψ, for all antennas), we can write

Vyx Vyy(cid:19) = P (cid:18)V c
(cid:18)Vxx Vxy

xx V c
xy
V c
yx V c

yy(cid:19) P H ,

(1)

where P is the parallactic-angle matrix (e.g. Smirnov,
2011a),

− sin ψ cos ψ(cid:19) ,
P =(cid:18) cos ψ sin ψ

(2)

P H is the Hermitian of P , Vkl are the visibility products
between polarizations k and l, and V c
kl are the visibilities
properly corrected for parallactic angle. In regard of the
brightness matrix, we have

U − iV I − Q (cid:19) = P (cid:18) I + Q′ U ′ + iV
(cid:18) I + Q U + iV

U ′ − iV I − Q′ (cid:19) P H ,

(3)

where the Stokes parameters Q′ and U ′ are measured in
the frame of the sky (i.e., corrected for parallactic angle),
whereas the Q and U are given in the frame of the antenna
receivers. If there are no direction-dependent calibration
eﬀects in the data (this is especially true at mm/submm
wavelengths), we also have (Smirnov, 2011a)

xx V c
xy
yx V c
V c

(cid:18)V c

yy(cid:19) =Zσ(cid:18) I + Q′ U ′ + iV

U ′ − iV I − Q′ (cid:19) exp (−2π

B⊥σ

λ

)dσ,

(4)
where σ is a unit vector that runs over the source brightness
distribution (i.e., I, Q, U , and V are functions of σ) and
B⊥ is the projection of the baseline vector into the uv-plane
(i.e., the plane perpendicular to the source direction). We
assume that the visibilities are already calibrated for band-
pass and amplitude/phase gains (the eﬀect of polarization
leakage is studied in Sect. 2.7).

From the equations above, it is straightforward to show

that

and

Vxx =Zσ

Vyy =Zσ

(I + Qψ) exp (−2π

B⊥σ

λ

)dσ

(I − Qψ) exp (−2π

B⊥σ

λ

)dσ,

(5)

(6)

where Qψ = Q′ cos (2ψ) − U ′ sin (2ψ) = Q. According to
these equations, and for small ﬁelds of view, the Fourier
transform of Vxx, for a constant parallactic angle, ψ, is re-
lated to the brightness distribution of I+Q, being Q deﬁned

2

in the frame of the antenna receiver. In a similar way, the
Fourier transform of Vyy is related to the brightness distri-
bution of I − Q.

2.1. Case 1. Perfect amplitude calibration

Let us now assume that we have a set of interferometric
observations in dual-polarization mode, for which the par-
allactic angles of all antennas, ψ, are equal and constant.
We can reconstruct the brightness distribution of I + Qψ
and I − Qψ by solving the inverse Fourier equation for Vxx
and Vyy, respectively. Let us call I ψ
yy the sky bright-
ness distributions corresponding to Vxx and Vyy. If φ is the
position angle of the polarization vector (in the frame of the
sky) and p is the fractional polarization (both quantities are
assumed to vary throughout the extent of the source), we
have

xx and I ψ

I ψ
xx
I ψ
yy

=

1 + p cos (2(φ − ψ))
1 − p cos (2(φ − ψ))

,

(7)

since Qψ = I p cos (2(φ − ψ)). In this equation, I is the
brightness distribution of the Stokes I parameter. If the
visibility amplitudes are perfectly calibrated, the bright-
ness distribution I can be obtained by just inverting the
Fourier equation for the sum of visibilities Vxx + Vyy. Then,
the ratio in Eq. 7, together with I, will provide information
on the sky distribution of p and φ throughout the source.
In principle, this is an underdetermined problem, since, for
each source component in I, we have one constraint (Eq. 7)
and two parameters (p and φ). However, if we have observa-
tions of the same source under diﬀerent parallactic angles,
we can apply Eq. 7 to diﬀerent values of ψ. Hence, we can
recover the p and φ distribution by means of a least squares
minimization applied to each individual component of the
source brightness distribution.

2.2. Case 2. Amplitude bias between Vxx and Vyy

A more realistic case is that of imperfect calibration of the
absolute ﬂux scale and/or bandpass for X and Y signals. As
a consequence, frequency-dependent global amplitude oﬀ-
sets may appear between the XX and Y Y visibilities. This
is specially true for dual-polarization observations, since all
the amplitude calibration is performed in a completely in-
dependent way for the X and Y polarization channels. In
these cases, we can still use Eq. 7, but without computing
I from the mere sum of visibilities in XX and Y Y .

xx0 and I ψ

Let us select a ﬁducial component in the source bright-
ness distribution (for instance, the phase center, or the
peak intensity). We call this source component our “ﬁdu-
cial source element”, FSE. Let us compute the total ﬂux
density of the FSE in the XX and Y Y images (we call
these values I ψ
yy0, respectively) and divide the I ψ
xx
and I ψ
yy brightness distributions by these values. It is obvi-
ous that the ratios I ψ
yy0 are independent
of the absolute ﬂux calibration (and also of the amplitude
bandpass), since they are related to relative changes in the
brightness distribution of the source. These quantities are
indeed very robust against calibration artifacts, since their
values are mainly encoded in the phase and amplitude clo-
sures, which are independent of the antenna gains. The in-

xx0 and I ψ

xx/I ψ

yy/I ψ

Mart´ı-Vidal et al. (2015): Dual diﬀerential polarimetry in interferometric observations

tensity ratios are related to the brightness distribution of
Stokes parameters in the following way,

and

I ψ
xx
I ψ
xx0

=

I + Qψ
I0 + Qψ

0

I ψ
yy
I ψ
yy0

=

I − Qψ
I0 − Qψ

0

,

(8)

(9)

where I0 and Qψ
0 are referred to the FSE. We can now
construct a ratio of ratios that depends on ψ, which we call
polarization ratio, Rψ

pol, in the form

Rψ

pol =

1

2  I ψ

xx/I ψ
I ψ
yy/I ψ

xx0

yy0

− 1! .

(10)

Using Eqs. 8 and 9, we obtain

2Rψ

pol + 1 =

I + Qψ
I − Qψ

×

I0 − Qψ
I0 + Qψ

0

0

.

(11)

If the polarization percentage is small (i.e., Q << I) we

can simplify Eq. 11 and write

Rψ

pol ∼ p cos (2(φ − ψ)) − p0 cos (2(φ0 − ψ)).

(12)

In this case, Rψ
pol encodes information related to the dif-
ference between the polarization of any component in the
source structure and the polarization in the ﬁducial source
element, FSE.

2.3. Dual diﬀerential polarimetry based on Earth rotation

synthesis

Equation 11 (or Eq. 12, if Q is not much smaller than I)
is the heart of our dual diﬀerential polarimetry technique.
Given a set of interferometric observations, with baselines
short enough to assume that ψ is the same for all antennas,
we can split the data in snapshots of constant ψ. For each
snapshot, we reconstruct images of the observed source us-
ing the Vxx and Vyy visibilities. Then, we can compute the
sky distribution of Rψ
pol for each parallactic angle, using Eq.
10. From Eq. 12, the value of Rψ

pol follows the expression

with

and

Rψ

pol = pdif cos (2(φ − α − ψ)),

α =

1
2

arctan(cid:18) p0 sin ∆

p − p0 cos ∆(cid:19) ,

pdif =qp2 + p2

0 − 2p0p cos ∆,

∆ = 2(φ0 − φ).

(13)

(14)

(15)

(16)

From Eq. 13, we see that Rψ

pol is a sinusoidal function
of the parallactic angle ψ. The amplitude of the sinusoid is
related to the parameter pdif and the argument is related to
the parallactic angle and to the source-dependent quantity

φ − α. All these parameters depend on the diﬀerence of
the source polarization between any source component and
the FSE. We can derive the sky distribution of diﬀerential
polarization in a source (i.e., the distribution of pdif and
φ − α) by means of a least-squares minimization of Rψ
pol as
a function of ψ, applied individually to each component of
the source structure.

The ﬁtted values of pdif and φ − α at each source com-
ponent can then be compared to model predictions of the
source, as it is usually done in the case of full-polarization
observations.

2.3.1. Implementation of diﬀerential polarimetry in Fourier

space

In the previous section, we have formulated the equations
of diﬀerential polarimetry based on the relative values of
intensity among diﬀerent source components in the im-
age plane. We notice, though, that the limited coverage
of Fourier space by the interferometer’s baselines at each
snapshot (which determines the shape of the point-spread
function, PSF, at each parallactic angle ψ), as well as the
shorter (snapshot) integration time, may limit the dynamic
range (and ﬁdelity) in the images substantially.

There is, however, the possibility of using the complete
baseline coverage of the observations (i.e., the PSF corre-
sponding to the full set of observations) in the diﬀerential
polarimetry analysis, by means of image parametrization
techniques. Basically, the Stokes I image of the source can
be reconstructed using all the available visibilities (i.e., tak-
ing advantage of the best possible PSF from the observa-
tions). Then, the diﬀerential polarization among the com-
ponents of the (deconvolved) Stokes I source structure can
be performed by means of least-squares visibility ﬁtting.

This is the strategy that we have followed in the
tests reported in this paper (Sect. 3): we deconvolved the
source structures (applying the CLEAN algorithm) using
the complete set of observations. Then, we estimated the
ﬂux density of each source component, at each parallac-
tic angle, using the visibility-ﬁtting software uvmultifit
(Mart´ı-Vidal et al. 2014). This strategy is similar to per-
forming a compressed sensing analysis at each parallactic
angle (see, e.g., Li et al. 2011), but with a null norm-1 nor-
malization Lagrange parameter (since the sparsity in the
image model has already been provided by the CLEAN de-
convolution of Stokes I).

This strategy optimizes the ﬁdelity of the source struc-
ture being analyzed (given the optimum PSF used in the
CLEAN deconvolution) and gives us a robust estimate of
the diﬀerential polarimetry signal, since only the ﬂux den-
sities of the source components are ﬁtted at each snapshot
(so the ﬁtted source model is fully linear in visibility space).

2.4. Eﬀects of Faraday rotation

If the rotation measure, RM , varies across the source, it is
possible to measure these variations using Rψ
pol, provided
that the observed fractional bandwidth is wide enough1.
This strategy was used by Mart´ı-Vidal et al. (2015) to de-
termine the RM in the jet base of a distant active galactic

1 The actual value would depend on the signal-to-noise ratio

of the data.

3

Mart´ı-Vidal et al. (2015): Dual diﬀerential polarimetry in interferometric observations

nucleus, AGN, at submm wavelengths using ALMA obser-
vations.

If the rotation measures are diﬀerent between any pixel
of the image and the ﬁducial source element, Eq. 16 takes
the form

size of the ALMA antennas, the maximum observable ﬁeld
for a reliable diﬀerential polarimetry would be from ∼20′′
(for Band 3, i.e. ∼ 100 GHz) to ∼3′′ (for Band 9, i.e. ∼
650 GHz).

∆ = 2(φ0 − φ) + 2(RM0 − RM )λ2,

(17)

2.7. Eﬀects of polarization leakage

(see appendix of Mart´ı-Vidal et al., 2015) and Eq. 13 be-
comes

Rψ

(18)

pol = pdif cos(cid:0)2(φ + λ2 RM − α − ψ)(cid:1),

where λ is the wavelength and RM0 is the rotation measure
at the ﬁducial source element. Note that, in this case, the
“synthesis” of Rψ
pol is not only performed by the diﬀerent
parallactic angles, but also by the diﬀerent wavelengths of
observation. However, it is still required to have a minimum
coverage of parallactic angles, regardless of the observed
fractional bandwidth, to obtain reliable ﬁts of Rψ
pol using
Eq. 18. Mart´ı-Vidal et al. (2015) did observe each epoch
under diﬀerent parallactic angles. This was crucial for them
to recover the sinusoidal behaviour of Rψ
pol as a function of
λ2 and ψ.

2.5. Eﬀect of feed rotation at the antennas

There are cases where the X and Y axis of the receivers are
rotated with respect to the antenna frame. In such cases,
Eq. 13 (and all the equations that follow in the next sec-
tions) is still valid by just adding the feed rotation angle (let
us call it β) to the parallactic angle ψ. That is, ψ → ψ + β.
Then, Eq. 13 becomes

Rψ

pol = pdif cos (2(φ − α − ψ − β)),

(19)

where the eﬀect of β is that of a constant angle added to
the cosine. Hence, the dependence of Rpol on the intrinsic
source polarization (given by both α and pdif ) is unaﬀected
by β. In Sect. 4, we discuss on how the feed rotation in the
ALMA antennas aﬀected the results recently reported in
Mart´ı-Vidal et al. (2015).

2.6. Eﬀect of an oﬀ-axis receiver

If the receiver horns are not aligned with the axis of the an-
tenna mounts, each polarization channel will have a slightly
diﬀerent beam pattern on the sky. This is related to the
well-known beam squint eﬀect, and is present in all the
ALMA antennas. Hence, for the observations of extended
sources, the oﬀ-axis receivers of ALMA could introduce a
fake diﬀerential polarimetry signal accross the source struc-
ture.

According to the ALMA Technical Handbook2 (Section
8.7), the eﬀect of an oﬀ-axis instrumental polarization shall
be negligible within the inner 1/3 fraction of the antenna
primary beams. Observations of sources contained within
the inner 1/3 of the primary beam can be calibrated in
full polarization by using an ordinary D-term matrix (i.e.,
without accounting for direction-dependent eﬀects) up to a
polarimetric accuracy of a few 0.1%. Hence, and given the

2 https://almascience.eso.org/proposing/call-for-

proposals/technical-handbook

4

The estimate of Rψ
is, by construction, insensitive to
pol
bandpass and/or gain diﬀerences among the X and Y sig-
nals. The only calibration eﬀect that can change the value
of Rpol is the polarization leakage in the antenna receivers,
as well as any cross-polarization delay or phase. However,
the eﬀect of polarization leakage and cross-delays on the
XX and Y Y products is very small (second-order correc-
tions), compared to the eﬀect on the XY and Y X products
(ﬁrst-order corrections). Indeed, from Smirnov (2011a), the
Jones matrix for the correction of leakage and cross-phase
(or cross-delay) among the X and Y signals in an antenna
is

J =(cid:20)1 0

0 K(cid:21) ×(cid:20) 1 Dx

Dy 1 (cid:21) =(cid:20) 1 Dx
DyK K(cid:21) ,

(20)

where K is a phase-like factor and Dx and Dy are the com-
plex D-terms that model the polarization leakage in the
antenna receivers. Since we do not have cross-polarization
products in dual-polarization observations, it is not possi-
ble to solve for K in the calibration (i.e., to separate it from
the phase gains), but, in any case, its eﬀects on the dual-
polarization visibilities will not be diﬀerent from a phase
added to the Y Y product. The observed XX and Y Y visi-
bilities, for the baseline formed by a pair of antennas A and
B, will be:

V obs
xx = (DA

x Vyy + Vxy)(D∗)B

y + DA

x Vyx + Vxx

(21)

and

y Vxx + Vyx)(D∗)B

x + DA

V obs

yy =(cid:0)(DA

y Vxy + Vxx(cid:1) K A(K ∗)B.

(22)
It is clearly seen that Eq. 21 and 22 are basically sym-
metric one to the other, with the exception of a global
phase-like factor, K A(K ∗)B (i.e., the diﬀerence of X-Y
cross-delays among antennas A and B) that will be fully
absorbed in the ordinary phase-gain calibration of the Y Y
visibilities.

We have simulated ALMA observations of two compact
polarized sources, located in the same ﬁeld of view, and
checked the robustness of Rψ
pol against polarization leakage
in the antenna receivers. The two sources are separated by
two synthesized beams, their intensity ratio is set to 1.4,
and their linear polarizations are 1% (with position angle,
φ1, of either 0 or 45 degrees) and 1.7% (with position an-
gle, φ2, from 0 to 90 degrees, in steps of 10 degrees), re-
spectively. No Faraday rotation has been introduced in the
sources. We have simulated 10 antennas with leakages of
similar amplitudes and random phases. The amplitude leak-
age used is 1% (for ALMA, the leakage level in the antenna
receivers is of the order of 1%, according to the ALMA tech-
nical handbook). All simulated results are shown in Fig. 1.
It can be seen that all measured values of Rψ
pol follow the

Mart´ı-Vidal et al. (2015): Dual diﬀerential polarimetry in interferometric observations

l
o
p

R

3
0
1

30

20

10

0

−10

−20

φ1  = 45 deg.
φ1  =  0 deg.

r
o
r
r
E
 

l
o
p

R

3
0
1

0.5
0.4
0.3
0.2
0.1
0.0

0

20

40
φ2  (deg)

60

80

Fig. 1. Simulated Rψ
pol, taking into account eﬀects from po-
larization leakage in the antenna receivers. Top panel, ﬁtted
Rpol values (circles) and the model predictions computed
from Eq. 11 (solid lines). Bottom, diﬀerence in Rψ
pol between
the ﬁtted values and the model predictions.

prediction of Eq. 11. It is also clear that Rψ
pol is quite insen-
sitive to the antenna leakage. All errors are below 5×10−4.
The maximum errors are obtained when the Stokes U signal
is maximum in both sources (i.e., the polarization angles of
both sources are close to 45 degrees). This is an expected
result, since the leakage from Vxy and Vyx into Vxx and Vyy
is larger for a higher signal in Stokes U .

In these simulations, we have used a random phase dis-
tribution for the D-terms, between 0 and 45 degrees, also
adding a correlation between the phases of Dx and Dy for
each antenna. It is expected that the phase of one should
be 180 degrees shifted with respect to that of the other. We
notice that even lower errors in Rψ
pol would be obtained if
the phase distribution of D-terms were wider and/or there
were no correlations between Dx and Dy in each antenna.

3. Testing the techique

3.1. Simulations

We have tested the performance of our dual diﬀeren-
tial polarimetry technique using synthetic data with re-
alistic noise and potential calibration artifacts. In all
our simulations, we have used the Common Astronomy
Software Applications (CASA) package of the National
Radio Astronomy Observatory (NRAO)3. The synthetic
data have been generated with an in-house modiﬁed ver-
sion of the CASA task simobserve. In this version, full-
polarization synthetic datasets can be created for sources
with a generic polarization structure. The parallactic angle
correction, as well as eﬀects of polarization leakage in the
antenna receivers, are taken into account.

Our simulation is based on the ALMA full array conﬁgu-
ration “alma.out04.cfg”, given in the CASA database. The
observing frequency is set to 100 GHz, with a bandwidth
of 10 GHz. An arbitrary source, located at a declination

of −21 degrees, is observed from an hour angle of −0.84 h
to 0.84 h, resulting in a parallactic angle coverage between
100 and 260 degrees. The synthesized beam (using natural
weighting) is 2.86×2.50 arcsec, with a position angle, PA, of
89 degrees. The largest rcoverable scale (LRS) is estimated
to be ∼ 60′′. In these simulations, we account for thermal
noise at the receivers, random amplitude errors of up to 5%
in each antenna (and independent for X and Y ), random
phase oﬀsets of up to 10 degrees between X and Y , and
random leakage of up to 2% with random phases of up to
20 degrees.

We have simulated two cases: 1) an extended unpolar-
ized brightness distribution with a compact polarized com-
ponent on top of it and 2) an extended polarized structure.
We discuss on these two simulations in the next subsections.

3.1.1. Extended unpolarized plus compact polarized emission

In this case, the dual diﬀerential polarimetry has been
performed on the compact polarized component, and we
have used the whole unpolarized brightness distribution
as our ﬁducial source element. To simulate the unpo-
larized extended emission, we used the FITS image of
galaxy M 51 called “M51ha.ﬁts”, commonly used in CASA-
related simulations4. The brightness peak of the model was
set to 1 mJy/pixel, which maps into a peak intensity of
1.35 Jy/beam in the convolved image. The overall size of
the source was set to ∼ 20′′ × 30′′. The compact polarized
component was located at about 6′′ south of the galaxy
center, with a ﬂux density of 1 Jy, a fractional polarization
of 8%, and a polarization angle of −80 degrees.

A full-polarization image, shown in Fig. 2, was ob-
tained using an standard CLEAN deconvolution with no
self-calibration. The polarized source is clearly detected,
together with a weak spurious polarization signal close to
the galaxy center, likely due to the polarization leakage.

As it is explained in Sect. 2.3.1, we made use of the
uvmultifit program for CASA, a tool to ﬁt source models
to interferometric visibilities (Mart´ı-Vidal et al., 2014). We
ﬁtted a source consisting of two model components to the
data. One of the components corresponds to the complete
set of CLEAN points found in the deconvolution, but re-
moving those within 1′′ from the compact polarized source.
The second component consists of the set of CLEAN points
removed from the ﬁrst component.

In our modelling, we left the positions of all the CLEAN
points ﬁxed, and only ﬁtted the total ﬂux density of each
model component (i.e., the overall unpolarized ﬂux, for the
ﬁrst component, and the overall polarized ﬂux, for the sec-
ond component) in both XX and Y Y . We separate the
data into scans of constant parallactic angle. From the ﬁt-
ted ﬂux densities at each parallactic angle, we compute Rpol
as a function of time during the whole extent of the exper-
iment. We show the resulting Rpol measurements in Fig. 3,
together with the prediction using Eq. 13. The agreement is
excellent. Indeed, given that the extended structure is un-
polarized, we can recover the full polarization state of the
compact source from our measured Rpol. In this case, p0 in
Eq. 12 is exactly zero, so Rpol vs. ψ encodes the informa-
tion about the absolute (i.e., not diﬀerential) polarization,
p and φ.

3 http://casa.nrao.edu

4 http://casaguides.nrao.edu/

5

Mart´ı-Vidal et al. (2015): Dual diﬀerential polarimetry in interferometric observations

 
 
 

25

20

15

10

5

0

-5

-10

-15

-20

s
d
n
o
c
e
s

 

c
r
A

-25

20

15

10

5

Arc seconds

Center at RA 18 30 00.00000  DEC -21 10 00.0000
 Cont peak flux =  1.35 Jy/beam
Levs = 0.135 x (0.5, 1, 2, 4, 8)
 Pol line (E vector): 1 arcsec =  5 mJy/beam

0

-5

-10

-15

-20

 

Fig. 2. CLEANed full-polarization image of our M51 simu-
lation. Notice the compact polarized component at the cen-
ter of the relative coordinates in the image. Due to leakage
eﬀects, there is also a marginal spurious polarization close
to the center of the galaxy.

3.1.2. Extended polarized emission

An extended polarized source was generated using four el-
liptical Gaussian intensity distributions. One, with a full
width at half maximum (FWHM) of 25′′ × 8′′, accounted
for the unpolarized emission. Another one, with a FWHM
20′′ × 6.5′′, accounted for the Stokes U emission, and the
other two, with FWHM of 20′′ × 6.5′′, accounted for Stokes
Q (we notice that the LRS is ∼ 60′′). All the position angles
were set to 90 degrees (i.e., major axis in the East-West di-
rection). The Gaussians for Stokes I and U were centered
at the same position and the Gaussians for Stokes Q were
oﬀset by 5 arcsec, one to the East and the other to the West.
We applied an ordinary deconvolution to the whole full-
polarization dataset and obtained the image shown in Fig.
4 (top). It can be seen how the polarization angle swings by
∼90 degrees in the East-West direction, with a minimum of
polarized intensity corresponding to the peak intensity of
Stokes I. At the peak intensity, the polarization angle is
about 45 degrees.

The analysis of dual diﬀerential polarimetry for this
source was also performed with the uvmultifit program.
We CLEANed Stokes I (with no polarization calibration

6

0.10

0.05

l
o
p

R

0.00

−0.05

−0.10

160

180

200
ψ (deg.)

220

240

260

Fig. 3. Rpol between the total unpolarized intensity and the
compact polarized source in our modiﬁed model of M51.
The points are measurements obtained with our software
uvmultifit. The line is the model prediction of Rpol for
this source.

applied) and took each CLEAN delta component as an in-
dependent model component for the ﬁt. The positions of
all the components were ﬁxed and we only ﬁtted the ﬂux
densities. All the CLEAN components were simultaneously
ﬁtted at each scan (i.e., for each parallactic angle). The ﬁts
were performed separately for the XX and Y Y visibilities.
The initial ﬂux-density values used in the ﬁt were set to
those obtained by CLEAN in the deconvolution of Stokes
I.

xx0 and I ψ

The ﬁt provided us with a set of ﬂux densities for each
CLEAN component, polarization product (XX and Y Y )
and parallactic angle. Then, for each parallactic angle, we
convolved the best-ﬁt models for XX and Y Y with the
CLEAN restoring beam, and scaled the resulting images to
their peak intensities (i.e., I ψ
yy0 in Eq. 10). Then,
we computed Rψ
pol pixel by pixel for each parallactic angle,
and ﬁtted the results at each pixel to the model given in
Eq. 13. We show some example results of these ﬁts in Fig.
5. From these ﬁts, we obtained the value of pdif and φ − α
for each pixel. These results are shown in Fig. 4 (bottom
right). Using the model Gaussians for Stokes I, Q, and U ,
we can also compute the true dual diﬀerential polarimetry
of the source (Fig. 4, bottom left), and compare it to our
image reconstruction. The swing in the polarization angle is
clearly seen in both, the image reconstruction and the true
model. The fractional polarization (gray scale) in our recon-
struction is also very similar to the model, demonstrating
the robustness of our diﬀerential polarization method.

3.2. Test with ALMA Science Veriﬁcation data

The ﬁrst released Science Veriﬁcation (SV) full-polarization
ALMA dataset consists of observations of source 3C 286 in
band 6 (hereafter, we just refer to the central frequency in
the observations, 225 GHz). The full description of the data
and the calibration procedure can be found in the CASA

Mart´ı-Vidal et al. (2015): Dual diﬀerential polarimetry in interferometric observations

Full polarization CLEAN image

 
 
 

15

10

5

0

-5

-10

-15

s
d
n
o
c
e
s

 

c
r
A

40

30

20

10

-10

-20

-30

-40

0

Arc seconds

Center at RA 18 30 00.00000  DEC -21 10 00.0000
Cont peak flux =  50.52 mJy/beam
Levs = 1.01 x (0.5, 1, 2, 4, 8, 16, 32)
 
Pol line 1 arcsec =  0.7 mJy/beam

 
 

0

True differential polarization

1

2

3

4

 
 

0

Reconstructed differential polarization

1

2

3

4

8

6

4

2

0

-2

-4

-6

-8

s
d
n
o
c
e
s
 
c
r
A

15

10

5

Center at RA 18 30 00.00000  DEC -21 10 00.0000
Grey scale flux range= 0 - 5 mJy/beam
Pol line 1 arcsec =  2 mJy/beam
 

0

Arc seconds

8

6

4

2

0

-2

-4

-6

-8

s
d
n
o
c
e
s
 
c
r
A

-5

-10

-15

15

10

5

Center at RA 18 30 00.00000  DEC -21 10 00.0000
Grey scale flux range= 0 - 5 mJy/beam
Pol line 1 arcsec =  2 mJy/beam
 

0

Arc seconds

-5

-10

-15

Fig. 4. Top, full-polarization CLEANed image from our simulated dataset of a source with extended polarization. Bottom
left, distribution of diﬀerential polarization, computed from the source model used in the simulation convolved with the
CLEAN restoring beam. Bottom right, reconstruction of the diﬀerential polarization from the dual-polarization data,
using our ﬁtting approach (see text).

Guides database5. We have used these SV observations to
test our technique, by comparing our results to those pub-
lished in the CASA Guide.

Given that source 3C 286 is only barely resolved with
ALMA, a ﬁrst impression is that it should not be possi-
ble to test the diﬀerential polarization algorithm with this
dataset. However, we can still use this technique to derive
the absolute source polarization if we use one extra assump-
tion, which we describe below.

Instead of using a given portion of the target source as
the ﬁducial source element, FSE, we use the absolute ﬂux
calibrator (Ceres). Assigning the role of the FSE to a dif-
ferent source requires that either the parallactic angles of
both sources (reference and target) are the same during the
whole extent of the observations (which is unlikely to hap-
pen for any pair of sources on the sky) or that the reference
source is unpolarized (so that the XX and YY visibilities
are always the same, no matter the parallactic angle).

The absolute ﬂux calibrator is used to scale the XX and
YY visibilities to their correct amplitude values. Thus, if
we assume that the overall ratio of gain amplitudes in the
array does not change signiﬁcantly throughout the obser-
vations, we can derive the Rpol of the target from a simple

5 https://casaguides.nrao.edu/index.php/3C286 Polarization

visibility ﬁtting of the target ﬂux densities in XX and YY
(as a function of the parallactic angle). The details of this
analysis are given in the next paragraph.

We performed the bandpass and gain calibration as de-
scribed in the CASA Guide of this SV dataset, with the
exception that we applied the same amplitude solution to
the two polarizations, thus ensuring that any polarization
signal from the phase calibrator is not transferred to the
target (gain type “T” in the CASA task gaincal). Once
the absolute ﬂux calibrator (Ceres) was used to scale the
amplitude gains to their respective values, our calibration
strategy diverged from what is described in the Guide. We
applied the phase and amplitude gains of the phase cal-
ibrator to the target, and splitted the data for imaging.
Obviously, no parallactic angle correction was applied in
the calibration.

We notice that, at this stage, no polarization-related
calibration was applied to the data (neither X-Y crossphase
nor leakage). Two iterations of phase self-calibration, plus
one iteration of amplitude self-calibration (in “T” gain type
mode) were applied to the target, using Stokes I for the
imaging. Finally, we used uvmultifit to estimate the ﬂux
density of the source for each scan and polarization product
(XX and YY), using a point source (ﬁxed at the ﬁeld center)

7

Mart´ı-Vidal et al. (2015): Dual diﬀerential polarimetry in interferometric observations

Selected CLEAN components.

# 43-50
# 51-50
# 58-50

0.15

0.10

0.05

0.00

−0.05

−0.10

l
o
p

R

100

150

200

250

ψ (deg.)

Fig. 5. Rpol, as a function of parallactic angle for three
selected pixels in the source image with extended polar-
ization. Each color corresponds to a diﬀerent pixel. The
numbers given in the legend are the X and Y pixel coordi-
nates in the image. The Rpol values were obtained with our
software uvmultifit. Lines are ﬁts using Eq. 13.

as ﬁtting model. The resulting Rpol values, together with
the ﬁt to a cosine function, are shown in Fig. 6.

3C286 - ALMA B6

0.18

0.16

0.14

l
o
p

R

0.12

0.10

0.08

0.06

170

180

190

200

ψ (deg.)

Fig. 6. Rpol of 3C 286 at 225 GHz, from ALMA SV obser-
vations. The error bars are smaller than the symbol sizes.

Our best-ﬁt fractional polarization is p = 0.189 ± 0.001,
which is similar to the one reported in the CASA Guide
(p = 0.1645 ± 0.0002). We notice that our true uncertainty
may be larger than the uvmultifit estimate, since we are
assuming a constant overall gain amplitude ratio during
the whole extent of the observations, and there could be
systematics related to the uncertainty in the absolute ﬂux
density calibration over the two polarization products.

In regard to the polarization angle, we must notice
that the Band 6 feeds at ALMA are rotated −45 degrees

8

with respect to the antenna axes (this information is pro-
vided in the metadata of the observations). Adding this
feed rotation to our angle budget (see Eq. 19), we get a
source polarization angle of φ = 37.04 ± 0.12 deg., which
is consistent with the value reported in the CASA Guide
(38.30 ± 0.02 deg.).

We have thus shown that our method can be used even
on compact sources, as long as an unpolarized source is
also observed and the overall amplitude ratio of the an-
tenna gains does not change signiﬁcantly throughout the
observations (or between consecutive observations of an un-
polarized source).

4. Reanalysis of Mart´ı-Vidal et al. (2015)

Mart´ı-Vidal et al. (2015) report the ﬁrst practical applica-
tion of the dual diﬀerential polarimetry technique. Their
analysis was performed on the images of the gravitation-
ally lensed blazar, PKS 1830−211 ( with a separation of
1′′). Using one of the lensed images as the polarization ref-
erence, the authors found clear signatures of a frequency
dependence of Rpol, for each epoch and for each parallactic
angle. For a subset of epochs close by in time (a maximum
diﬀerence of two days was allowed) where the spectral cov-
erage was wide enough, we successfully ﬁtted Eq. 18 to the
data at Bands 6 and 7, ﬁnding large values of RM (∼ 107 in
the observer’s frame). Such values were indicative of strong
magnetic ﬁelds in the region close to the jet base.

of

the

At

the

(2015),

observations

reported in
time
Mart´ı-Vidal et al.
the corresponding metadata
provided by the ALMA observatory did not contain
correct information about the feed rotation of each ALMA
receiver. In addition to this, the true rotation angle of the
Band 7 receivers, currently provided by the observatory,
contradicts the information that can be extracted from the
currently available documentation related to the antenna
optics (ALMA Memo #362). In the former, a value of
−53.5 degrees is obtained, while in the latter a value of
0 degrees is expected.

The fact that the feed angles are diﬀerent between
Bands 6 and 7 could eventually introduce a bias in the RM
reported in Mart´ı-Vidal et al. (2015). Fortunately, that bias
is rather small and does not aﬀect the main scientiﬁc re-
sults. In Fig. 7, we show the results of a reanalysis of the
data reported in Mart´ı-Vidal et al. (2015), but using the
correct feed angles. We notice that the large RM s found by
Mart´ı-Vidal et al. (2015) imply a lower eﬀect of the paral-
lactic angle ψ (and hence the feed angle β), compared to
that of the spectral coverage λ2. Indeed, the eﬀect of the
RM in the observations of PKS 1830−211 is large enough
to be observable already within the spectral windows of
each individual ALMA tunning.

The new RM s determined for epochs 10 April 2012
and 23 May 2012 are (2.0 ± 1.0) × 106 rad/m2 and
(3.7 ± 0.5) × 106 rad/m2 (observer’s frame), respectively.
These are 4.5 and 2.5 times lower than those reported in
Mart´ı-Vidal et al. (2015), although these new results do
not aﬀect the main scientiﬁc conclusions of that paper.
Regarding epoch 5 May 2014, all the observations were
performed in Band 7, so the diﬀerent feed rotation be-
tween the two bands does not aﬀect the result reported
in Mart´ı-Vidal et al. (2015).

Mart´ı-Vidal et al. (2015): Dual diﬀerential polarimetry in interferometric observations

15

10

5

0

−5

−10

l
o
p

R

3
0
1

Band 7
Band 6
23 May 2012
10 Apr 2012

10

5

0

−5

l
o
p

R

3
0
1

Band 7
Band 6
5 May 2014

−3.5

−2.5

−3.0
−2.0
λ2 −ψ/RM (mm2 )

−1.5

−2.4

−2.3

−2.2

−2.1
λ2 −ψ/RM (mm2 )

−2.0

Fig. 7. Rpol between the lensed images of PKS 1830−211. Data taken from Mart´ı-Vidal et al. (2015), but applying the
feed rotation angles of the ALMA receivers, as currently provided by the observatory in the ALMA metadata.

In the future, this technique will be useful to retrieve
polarization information, for instance, from the growing
amount of ALMA archival observations that were not de-
signed a-priori for polarization purposes.

References

Li, F., Cornwell, T. J., & de Hoog, F. 2011, A&A, 528, A31
Mart´ı-Vidal, I., Vlemmings, W. H. T., Muller, S., & Casey, S. 2014,

A&A, 563, A136

Mart´ı-Vidal, I., Muller, S., Vlemmings, W. H. Y., et al. 2015, Science,

348, 311

Readhead, A. C. S., & Wilkinson, P. N. 1978, ApJ, 223, 25
Smirnov, O. M. 2011a, A&A, 527, A106
Smirnov, O. M. 2011b, A&A, 527, A107

5. Conclusions

We present the technique of dual diﬀerential polarimetry,
suitable for interferometers whose antennas are equipped
with linear-polarization receivers. This technique allows us
to obtain polarimetric information from dual-polarization
observations, where only the XX and Y Y cross-products
are computed among antennas. The limitations due to the
lack of cross-polarization data, XY and Y X, can be par-
tially overcome thanks to the Earth rotation synthesis, as
long as the baselines of the interferometer are short enough
to ensure that all telescopes observe under the same paral-
lactic angle at any time.

Using Earth rotation, we show that the polarization ra-
tio observable, Rpol, deﬁned for each pixel in the source
image, is a sinusoidal function of the parallactic angle.
The amplitude and phase of this sinusoid encodes infor-
mation about the diﬀerence in polarization states between
any point in the source and what we call a ﬁducial source el-
ement, FSE (i.e., a reference in the source structure). If the
FSE is unpolarized, Rpol encodes information about the ab-
solute polarization state of all other regions in the image.
If the FSE is polarized, then Rpol gives only diﬀerential
polarization information. For observations with wide frac-
tional bandwidths, Rpol also encodes information about the
rotation measure across the image. In this case, Rpol is also
a sinusoidal function of the observing wavelength squared,
λ2.

We have tested our technique with realistic simulations
of ALMA observations for two case studies: 1) an extended
unpolarized source with a compact polarized feature and
2) an extended polarized source. In both simulations, we
are able to reconstruct the sky distribution of diﬀerential
polarization using the dual-polarization data.

We have also tested our

technique using real
Science Veriﬁcation ALMA observations (source 3C 286 at
225 GHz) in full-polarization mode. In this case, our tech-
nique also shows to be useful in cases of compact sources,
as long as an unpolarized source (or an absolute ﬂux cal-
ibrator) has been observed and the overall ratio of gain
amplitudes for all the antennas remains stable throughout
the extent of the observations.

9

