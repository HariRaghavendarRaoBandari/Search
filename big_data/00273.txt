Component Based Modeling of Ultrasound Signals

Yael Yankelevsky, Zvi Friedman, and Arie Feuer, Fellow, IEEE

1

6
1
0
2

 
r
a

M
1

 

 
 
]
T
I
.
s
c
[
 
 

1
v
3
7
2
0
0

.

3
0
6
1
:
v
i
X
r
a

Abstract—This work proposes a component based model for
the raw ultrasound signals acquired by the transducer elements.
Based on this approach, before undergoing the standard digital
processing chain, every sampled raw signal is ﬁrst decomposed
into a smooth background signal and a strong reﬂectors compo-
nent. The decomposition allows for a suited processing scheme
to be adjusted for each component individually. We demonstrate
the potential beneﬁt of this approach in image enhancement by
suppressing side lobe artifacts, and in improvement of digital
data compression. Applying our proposed processing schemes to
real cardiac ultrasound data, we show that by separating the two
components and compressing them individually, over twenty-fold
reduction of the data size is achieved while retaining the image
contents.

Index Terms—biomedical ultrasound, sparse representation,
signal modeling, beamforming, digital compression, side lobe
suppression.

I. INTRODUCTION

Medical ultrasound imaging allows visualization of internal
body structures by radiating them with acoustic energy and
analyzing the returned echoes. The two-dimensional image
typically comprises of multiple one-dimensional scan lines,
each constructed by integrating the data collected by the
transducer elements following the transmission of an acoustic
pulse along a narrow beam. As the transmitted pulse prop-
agates through the body, echoes are scattered by acoustic
impedance perturbations in the tissue. These back-scattered
echoes are detected by the transducer elements and combined,
after aligning them with the appropriate time delays, in a
process referred to as beamforming, which results in Signal-to-
Noise Ratio (SNR) enhancement. Each resulting beamformed
signal forms a line in the image.

The processing of ultrasound signals or images is often
based on an underlying signal model. Resulting from inter-
ferences of randomly spaced scatterers, the ultrasonic echoes
have a stochastic nature which is manifested in the result-
ing image as speckle noise. In the context of denoising or
despeckling, various statistical models for speckle have been
proposed that are inspired by the physical process underlying
speckle formation. A commonly used model for the ultrasonic
echo assumes that any range cell contains a large number
of randomly located scatterers, hence the envelope of the
echo obeys a Rayleigh distribution [1]. When the number of
scatterers is not large enough or the scatterers are not randomly
located, deviations from the Rayleigh model may occur. To
account for such deviations, other models have been proposed,
such as the Rician distribution [2], [3], K-distribution [4], and
others.

Beyond the statistical models, several works (e.g. [5], [6])
are based on parametric spectral analysis and model
the
ultrasonic radio frequency (RF) signal as an autoregressive

process (AR), i.e. as an output of a linear ﬁlter driven by a
white Gaussian noise.

Another suggested model [7], [8] considers the ultrasound
RF image to be a result of the convolution of the tissue
reﬂectivity function with the two-dimensional point-spread
function (PSF) of the imaging system.

Some other less common models have also been proposed,
such as a local polynomial representation of the ultrasonic
pulse log-spectrum [9] or modeling of the RF echo as a power-
law shot-noise process [10].

ˆx = arg min

A more popular approach is based on a sparsity assumption,
i.e. considering the signals to be sparse under some basis or
dictionary. Explicitly, one seeks an approximation ˆy = Dˆx of
the signal y ∈ RN that obeys
(cid:107)y − Dx(cid:107)2

(1)
where x ∈ RK is the sparse representation vector, (cid:107)x(cid:107)0 is the
(cid:96)0 pseudo-norm counting the non-zero entries in the vector x,
and the matrix D ∈ RN×K is the representation dictionary.
This dictionary may be either predetermined or learned from
the data itself, in a process referred to as dictionary learning.
The underlying idea is an adaptive adjustment of the dictionary
to observed signal characterizations, by solving

(cid:107)x(cid:107)0 ≤ T0

subject to

x

2

(cid:107)Y − DX(cid:107)2

(cid:107)xi(cid:107)0 ≤ T0 ∀i

F

subject to

arg min
D,X

(2)
where Y ∈ RN×M is a data matrix having the observed
its columns, and xi
signals at
is the i-th column of the
coefﬁcients matrix X ∈ RK×M .

Based on the sparsity model, Quinsac et al. [11], [12]
suggested using Fourier or wavelets as the representation basis.
Friboulet et al. [13], [14] used a dictionary of directional wave
atoms, which shows good properties for sparsely representing
warped oscillatory patterns. The authors showed that following
random sparse sampling, reconstruction using the wave atoms
dictionary yields better results compared with the Fourier or
Wavelets bases.

Another set of works

[15], [16] assumed sparsity by
modeling the ultrasonic echo as a ﬁnite stream of strong
pulses. This model suggested that the echo consists of L pulses
that are replicas of a known-shape pulse with unknown time-
shifts and amplitudes:

L(cid:88)

y(t) =

alh(t − tl)

(3)

l=1

Few works attempted to select the representation basis for
the ultrasound images (or image patches) using dictionary
learning methods [17], [18], [19]. To our knowledge, no
similar attempts were made to apply dictionary learning
approaches to one-dimensional ultrasound signals.

2

In this work, we propose a new model for raw ultrasonic
signals as the sum of two components, both carrying valuable
information: the strong reﬂectors, that are highly important for
tracking purposes in cardiac ultrasound imaging [20], [21], and
the speckle, also referred to in this work as the background
component, that characterizes the microscopic structure of the
tissue [1].

For the strong reﬂectors we assume a stream of pulses
model, similar to the one proposed by [15], [16]. For the
background component, we learn a suitable dictionary using
the K-SVD method [22]. As we show next, the decomposition
at an early stage allows for a suited processing scheme to be
adjusted for each component individually. We demonstrate
the potential beneﬁts of this approach in addressing two of
the issues that stand as disadvantages of ultrasound imaging,
particularly the large amount of data needed to be stored and
processed and the inherent side lobes artifacts.

Throughout

this paper, we use the term raw signal

to
refer to a signal acquired and sampled by a single transducer
element for a single given scan line, i.e. before combining
them in the digital beamforming process.

The rest of the paper is organized as follows: In Section II
we describe two proposed methods for decomposing the raw
signals into the strong reﬂectors and background components.
We then demonstrate the advantage of this model for data
compression. In Section III and Section IV we describe the
modiﬁed processing chain of the background components,
consisting of their sparse representation over a trained dictio-
nary followed by their integration in a modiﬁed beamforming
process that is applied directly at the representation domain.
In Section V we present a slightly modiﬁed decomposition
approach that achieves better suppression of the side lobes
artifacts. Section VI then presents simulation and experimental
results. We summarize the paper in Section VII with some
concluding remarks.

II. SIGNAL DECOMPOSITION

As stated in the introductory section, our model assumes
each raw signal to be composed of a background signal and
a strong reﬂectors component. We shall therefore begin by
decomposing each such signal to its individual components,
denoted yb, ys respectively. The decomposition algorithm is
based on a greedy detection of the strong reﬂectors followed
by their separation from the original signal. We here propose
two methods for performing the decomposition: one in the
time-frequency domain and the other using the in-phase and
quadrature representation.

A. Strong Reﬂectors Removal via Short-Time Fourier Trans-
form

Modeling the strong reﬂectors component, we mostly adopt
the ”stream of pulses” model given by Equation (3), according
to which this component is composed of a limited number
of strong pulses, that are ampliﬁed and delayed replicas of a

known-shape pulse. This pulse has the form of a sinusoid sig-
nal oscillating at the transmission frequency f0 in a Gaussian
envelope.

As an extension to the previously proposed model, we
suggest that the returning pulse shape is somewhat corrupted
with respect to the transmitted pulse. This corruption may
be manifested in either a frequency shift, resulting from the
frequency dependent attenuation [23], or a phase shift formed
between the carrier wave and the Gaussian envelope.

In order to account for those possible corruptions, we
propose to represent the strong reﬂectors in a time-frequency
domain, using the Short-Time Fourier Transform (STFT). This
will allow simultaneous optimization of both the time-delay
and frequency shift.

Denoting the STFT of y(t) by Y(t, ω), the STFT decom-

position is

L(cid:88)

Y(t, ω) = Yb(t, ω) + Ys(t, ω)

= Yb(t, ω) +

akH(t − tk, ω − ωk)

(4)

k=1

The proposed algorithm for STFT-based separation of the
strong reﬂectors is described in Algorithm 1. Upon reaching
the stopping condition, we are left with two separate signals
in the time-frequency domain. By applying inverse STFT, the
time-domain components can be reconstructed.

Algorithm 1 STFT-based Decomposition

the STFT signa-
the pulse model H(t, ω) centered such that
|H(t, ω)| = (0, 0), the maximal number of pulses

Task: Decompose a given signal y into the strong reﬂec-
tors and background components (ys, yb respectively)
Inputs: The signal’s STFT Y(t, ω),
ture of
arg max
(t,ω)
L, and an error threshold 0.
Initialization: Set the initial residual r0 = Y(t, ω)
Main Iteration: for k = 1, ..., L perform the following:
• Locate the strongest reﬂection (tk, ωk) with magni-

tude ak:

|Y(t, ω)|

;

(tk, ωk) = arg max
(t,ω)

ak = Y(tk, ωk)
• Residual update: rk = rk−1 − akH(t − tk, ω − ωk)
(cid:17)
• Stopping Rule: If (cid:107)rk(cid:107)∞ < 0, stop. Otherwise, apply
another iteration.
j=1 ajH(t − tj, ω − ωj)

(cid:16)(cid:80)k

,

Output: ys(t) = IST F T
yb(t) = IST F T (rk).

In the presented algorithm, the strong reﬂectors are detected
as the maximal magnitude peaks of the STFT. In practice,
the detection can be improved by matching the known pulse
pattern in a narrow region around each peak. The maximal
number of pulses L and error threshold 0 are chosen empir-
ically.

It can be observed that

the strong reﬂectors are natu-
rally compressed by saving only the pulse model parameters
{ak, tk, ωk}L
k=1 along the decomposition process. This may
be thought of as sparse coding over a very large dictionary

whose atoms represent all the possible time and frequency
shifts of the known pulse. However, due to the high sampling
rate of the signals and the enormous dimensions of such
dictionary, standard pursuit
techniques like OMP are not
feasible and an alternative amplitude-based pulse matching
was here performed.

B. Strong Reﬂectors Removal in I/Q

The ultrasonic RF signal may be modeled as a complex,
low-frequency baseband signal, modulated by a carrier wave
that oscillates at the much higher transmission frequency ω0 =
2πf0. The resulting RF signal takes the form

yRF (t) = I(t) cos(ω0t) − Q(t) sin(ω0t)

and the baseband signal is assumed to be of the form

yIQ(t) = I(t) + jQ(t)

(5)

(6)

where I(t), Q(t) are slowly varying (in comparison with
f0) In-phase and Quadrature components, and t is the time
along the beam. IQ demodulation is therefore the process of
extracting the IQ signal (6) from the measured physical RF
signal (5).

Since the baseband components I/Q change slowly, they can
be sampled at a lower frequency, thus reducing the amount of
data to be saved. Utilizing this fact, modern ultrasound systems
sample the complex baseband signal after IQ demodulation
instead of directly sampling the received RF signal. Besides
the advantage of a lower sampling rate, identifying the strong
reﬂections at signals of lower frequency is less bound to errors
such as time inaccuracies or phase shifts. Consequently, it
would be beneﬁcial to accommodate the proposed decompo-
sition to such systems and detect the strong reﬂectors at the
I/Q components.

Working in baseband, there is no longer a need to match
the full pulse model (including the frequency and phase
estimation) and only a Gaussian envelope should be adjusted
with the appropriate delay and amplitude.

The algorithm performed for each raw signal independently
is generally similar to the one implemented in STFT, with
few differences: The inputs are the baseband signal ϕIQ(t)
and the modeled pulse envelope g(t), instead of the STFT of
the signal and pulse. Respectively, the residual is initialized
with r0 = ϕIQ(t) and updated by subtracting the adjusted
envelope from I and Q individually:

I,Q = rk−1
rk

I,Q − ak

I,Qg(t − tk)

3

transducer elements and the number of lines in an image, the
amount of data needed to be transferred and processed is very
large, motivating methods to reduce the amount of needed data
without compromising the reconstructed image quality and its
diagnostic credibility.

In state-of-the-art ultrasound systems, an initial reduction of
data size is already made possible by exploiting the fact that
the detected signals are modulated onto a carrier and occupy
only a portion of the entire baseband bandwidth. Therefore
by demodulating the received signals, the sampling rate, and
consequently the data size, may be reduced. Nevertheless, this
reduction is far from fulﬁlling the compression potential.

To further reduce the amount of data, several approaches
were proposed in the literature. Several works have recently
adapted compressed sensing (CS) methods to ultrasound sig-
nals (e.g. [11], [12], [24], [13], [25], [14], [26], [18]). Other
works (e.g. [27]) treat the collection of raw signals detected
by the transducer elements for a single scan line as a two-
dimensional image, and attempt to compress it using standard
techniques such as JPEG compression.

Another work attempting to reduce the amount of sampled
data in ultrasound signals, based on complementary ideas
arising from the Finite Rate of Innovation (FRI) framework
[28], [29], was carried out by Tur et al. [15]. The authors
consider the returning echo to be a stream of pulses that
are replicas of a known-shape pulse with unknown time-
shifts and amplitudes. Assuming that overall L pulses were
reﬂected back to the transducer from the pulse’s propagation
path, the detected signal is completely deﬁned by 2L degrees
of freedom, corresponding to the unknown time delays and
amplitudes of these pulses. Based on the FRI framework,
these 2L parameters are estimated and the signal recovered
from a minimal subset of 2L of the signal’s Fourier series
coefﬁcients. The needed coefﬁcients are recovered from low
rate samples of the analog signals, as the sampling frequency
is now determined by the number of pulses L, which is rather
small compared with the bandwidth of the transmitted pulse,
leading to a substantial sample rate reduction.

This result was extended by Wagner et al. [16], that applied
concepts of the CS framework in order to directly reconstruct
the beamformed signals from low rate samples of the individ-
ual signals detected by the different transducer elements.

These works achieve an almost eight-fold reduction of
sample rate, however the reconstructed data is partial as
it only contains the macroscopic reﬂections and does not
include the speckle.

Additionally, the saved parameters for the strong reﬂectors
now contain only the time delays {tj}k
j=1 and respective
amplitudes, and the ﬁnal residual rk represents the baseband
background component.

III. DATA COMPRESSION

According to the Shannon-Nyquist sampling theorem, the
sampling rate at each transducer element should be at least
twice the bandwidth of the detected signal. Taking into account
the high frequency used for ultrasound imaging, the number of

A different approach used in radar is based on the CLEAN
algorithm [30]. This algorithm performs an iterative search
of the strong reﬂections, where at each iteration the maximal
amplitude of the returned signal is located and the signal
is then attenuated around this detected maxima using some
attenuation function. This process is repeated until
the
residual signal reaches a predeﬁned threshold, after which the
strong reﬂectors could be reconstructed from their locations
and amplitudes collected across iterations. Like the previous
methods, the main shortcoming of this approach is that it
disregards speckle and only reconstructs the strong targets.

4

In the following, we demonstrate how the proposed de-
composition approach may be utilized for improving digital
compression of ultrasound signals by altering the processing
scheme.

To motivate the decomposition based compression, we ﬁrst
note that the strong reﬂectors are readily compressible since
their number is limited and they can be fully characterized by a
few pulse model parameters. Resulting from intereferences of
weak ultrasonic reﬂections, speckle is typically characterized
by a statistical model with few parameters, indicating that
it could also be easily sparsiﬁed. Therefore, while a joint
compressible model may be hard to obtain, a decomposition
based approach results in two components that are each highly
compressible.

The proposed processing scheme is illustrated in Figure 1.

Raw Signals

Detection and Separation
of the Strong Reﬂectors

Background

{ym[n]}

Strong Reﬂectors

Background
Compression
{cm}
Representation

Domain

Beamforming

Background
Dictionary
Learning

D

Φ[n]

{am, tm}

Image Reconstruction

Background

Image

Combined

Image

Strong

Reﬂectors

Image

Fig. 1: The proposed processing scheme. ym[n] is the back-
ground signal obtained from the m-th sensor, {am, tm} are
the estimated strong reﬂectors parameters, cm are the repre-
sentation coefﬁcients of ym[n] over the dictionary D, and Φ[n]
is the beamformed background component, composed of all

sensor coefﬁcients(cid:0){cm}M

(cid:1).

m=1

A. Learning a Dictionary for the Background Data

Having separated the two components, we next want
to compress
them. The strong reﬂectors were already
compressed by saving only the pulse model parameters along
the decomposition process presented in Section II. As for
the speckle (background) component, each such signal will
be sparsely represented over an optimized dictionary that
is trained ofﬂine from prototype examples of background
signals. It should be emphasized that this training process is
only performed once for every imaging system settings, and
need not be repeated for every analyzed signal or even for
every imaged frame.

For the purpose of dictionary learning, we shall use the K-
SVD algorithm [22]. We chose the training set to be a subset of
the signals constituting a single frame of real cardiac imaging
data. Although our goal is to compress raw signals, i.e. signals
detected by each sensor prior to receive beamforming, the
training set signals are chosen to be beamformed scan lines,
since those were shown to have improved SNR [31].

The input frame consists of 120 scan lines, out of which 10
scan lines were randomly chosen for the training set. Each of
these signals contains 3328 samples and was divided into one-
dimensional, non-overlapping patches of 100 samples each.
The dictionary size is 100×400, having a redundancy factor of
4. Initializing the dictionary with a random matrix, the training
process was limited to 10 iterations.

that

It should be noted that the chosen training set is relatively
small. Moreover, overlapping patches are commonly used due
to the fact
the different sparse approximations could
eventually be averaged at the overlapping segments, which
could lower the representation error and smooth the overall
signal reconstruction. Despite this apparent advantage, we
chose to reduce the amount of patches (and thus the runtime
of both training and representation) by using non-overlapping
patches.

However, as we show later, by training a dictionary with
a small subset of beamformed signals of a single frame, one
can get a good representation for the raw echoes of all the
sensors and all the scan lines in the frame, as well as of raw
signals from other frames obtained with the same system (for
the same settings).

We emphasize that the proposed algorithm is applied to the
raw one-dimensional signals, as acquired by the individual
sensors, immediately after their sampling. The scope of this
work is therefore limited to the digital domain and does not
attempt to perform compressed sensing.

Assuming each component on its own is compressible,
we derive the suitable representation bases. Thereafter, the
compressed background signals are integrated in a modiﬁed
beamforming process, applied directly at the representation
domain. To conclude the proposed algorithm, the strong reﬂec-
tors are reconstructed from their sparse coefﬁcients obtained
during the decomposition stage, combined with the beam-
formed background signals and processed to form an image.

B. Sparse Representation of the Background Data

Having the dictionary trained ofﬂine, let us return to the
online processing cycle. After decomposition, the separated
background component undergoes further processing, starting
with compression.

Due to computational

limitations of the K-SVD algo-
rithm,
the dictionary is learned for small one-dimensional
patches. Thus each background signal is ﬁrst divided into non-
overlapping patches, similarly to the division of the training set
signals described in the previous section. Using the Orthogonal
Matching Pursuit (OMP) algorithm, each patch is then sparsely
represented over the trained dictionary.

Denote the patch length by Q and the trained dictionary by

D ∈ RQ×K, then using OMP we solve for each patch
(cid:107)y − Dx(cid:107)2 ≤ 

(7)
where y is the Q×1 extracted patch and x is its corresponding
K × 1 sparse coefﬁcients vector.

subject to

(cid:107)x(cid:107)0

arg min

x

Having obtained the sparse representations of all the in-
dividual patches of a given RF signal, the signal could be
reconstructed. For that matter, each patch is recovered from
its sparse coefﬁcients by ˆy = Dx. The recovered patches
are then plugged back to the locations from which they
were extracted, to reassemble the full signal. This process is
repeated for each of the raw signals detected by the differ-
ent transducer elements for the same scan line. Afterwards,
standard beamforming techniques can be applied to generate
the beamformed background signal, which could then be
further processed to form the image. However, we propose
an alternative reconstruction scheme based on performing the
beamforming in the representation domain, thus constructing
the beamformed signal directly from the sparse coefﬁcients
vectors of all the individual patches, rather than reconstructing
each of the sensor echoes separately. The formulation of the
representation domain beamforming is presented in the next
section.

IV. BEAMFORMING IN THE REPRESENTATION DOMAIN

A. Conventional Delay and Sum Beamforming

Modern ultrasound transducers are comprised of multiple
elements. This inherent redundancy can be utilized by averag-
ing the signals detected by the different sensors after aligning
them with the appropriate time delays. This process, referred to
as receive beamforming, allows both dynamic control over the
focus of the receiving array (and thus better localization of the
scattering structures) and improvement of the Signal-to-Noise
Ratio (SNR) [32]. In order to achieve dynamic focusing, the
focal point is swept along the beam direction, where at each
coordinate the appropriate delays can be computed assuming
a point reﬂector exists at that point. For simplicity, let us
assume that the transducer lies along the ˆx axis, centered at
the origin (ˆx = 0), and comprised of M elements, as depicted
in Figure 2. A reference receiver denoted m0 is set centered
at the origin, and δm denotes the distance measured from the
origin to the center of the m-th receiver.

5

The imaging cycle starts at time t0 = 0, when the array
transmits an acoustic pulse into the tissue at some direction
θ. The pulse propagates through the tissue at velocity c (the
speed of sound) such that at time t ≥ 0 its coordinates are
(ˆx, ˆz) = (ct sin θ, ct cos θ). Consider a potential reﬂection,
originating at this coordinate and arriving at the m-th element.
The distance traveled by such a reﬂection is:

dm(t, θ) =(cid:112)(ct cos θ)2 + (ct sin θ − δm)2

(8)

The time it takes this reﬂection to cross that distance is

dm(t, θ)/c, so it reaches the m-th element at time:

Plugging (8) into (9):

τm(t, θ) =t +

τm(t, θ) = t +

dm(t, θ)

c

(cid:112)(ct cos θ)2 + (ct sin θ − δm)2
(cid:115)

1
c

(cid:18) δm

(cid:19)

(cid:18) δm

(cid:19)2 − 2

t sin θ

c

c

=t +

t2 +

(9)

(10)

Echoes are then reﬂected from density and propagation-
velocity perturbations in the radiated medium, and detected
by the transducer elements. Denote by ϕm(t, θ) the signal
detected by the m-th element. In order to compensate the
differences in arrival time, an appropriate delay should be
applied to ϕm(t, θ) before these echoes could be averaged.
Let us denote the delayed signal detected by the m-th element
by ˆϕm(t, θ).

It is readily seen that τm0(t, θ) = 2t. Hence, in order to
align the echo received by the m-th element with the one
received by the reference element, we require:

ˆϕm(2t, θ) = ϕm(τm(t, θ), θ)

(11)

Therefore the time-aligned signal received by the m-th element
is:

(cid:18)

(cid:19)
(cid:18) δm

c

2

, θ

, θ

(cid:19)
(cid:18) t
(cid:19)2 − 4
(cid:18) δm
(cid:18) t
(cid:19)

(cid:18)

c

(cid:19)

(12)

(cid:19)

t sin θ

ˆϕm(t, θ) = ϕm

τm

where using (10):

(cid:19)

(cid:18) t

2

τm

, θ

=

+

t
2

1
2

(cid:115)

t2 + 4

(13)
Finally, the beamformed signal is the average of the indi-

vidual time-aligned echoes, i.e.

Φ(t, θ) =

1
M

ϕm

τm

, θ

, θ

2

(14)

M(cid:88)

m=1

In the sequel, to simplify the notation, we will drop the

dependence on θ.

So far we have assumed continuous time signals. However,
in modern ultrasound systems the receive beamforming pro-
cess is performed digitally. Hence, the signals at the elements
are sampled and we have ϕm[n] = ϕm(nT ) where T is the
sampling interval. Using the sampled data for our beamform-
ing raises a new problem, as we are now constrained to signal
values on the grid nT . So, if the delay we need to apply

Fig. 2: Imaging setup

is not an integer multiple of T , we approximate by linear
interpolation

(cid:18)

(cid:18) nT

2

ϕm[n] = ϕm

τm

≈ (1 − αm[n]) ϕm[τm[n]] + αm[n]ϕm[τm[n] + 1]

6

where

and

τm[n] =

αm[n] =

(cid:2)1 − αm[n]

M(cid:88)

m=1

Φ[n] =

1
M

τm

(cid:1)

(cid:37)

(cid:19)(cid:19)
(cid:36)
(cid:0) nT
(cid:1)
(cid:0) nT
, αm[n](cid:3)(cid:20)

τm

T

T

2

2

− τm[n]

(15)

(16)

(17)

(cid:21)

(18)

where el is the l-th column of the N × N identity matrix IN
and bm[n] ∈ RKP , and we recall that τm[n] are indices from
(1, 2, ..., N ).

Finally, denote:

Bm =(cid:2)bm[1] bm[2]
Z =(cid:2)zT

1
M

H =

. . . bm[N ](cid:3)T ∈ RN×P K
(cid:2)B1 B2

. . . BM

(cid:3)

(cid:3)T

. . . zT
M
Then the beamformed signal is given by

zT
2

1

Φ = HZ

(23)

(24)

(25)

(26)

It is readily seen that H depends solely on the imaging
settings and the learned dictionary. This result indicates that
beamforming in the representation domain is manifested as a
weighted combination of the representation coefﬁcients, where
the weight matrix H is data independent and can be computed
apriori for each scan line direction θ. Therefore, only the
sparse coefﬁcients should be transferred to the beamformer,
leading to a much simpliﬁed computation of the beamformed
signal.

C. Strong Reﬂectors Reconstruction

So far we discussed the processing and reconstruction of
the background component. The strong reﬂectors may be
reconstructed from their sparse coefﬁcients obtained during
the decomposition stage, and combined with the beamformed
background signals to form an image, without going through
a beamforming process.

this

reconstruction process

Assuming a known pulse shape,

the strong reﬂectors
reconstruction is straightforward. The estimated coefﬁcients
could be directly plugged into the parametric pulse model,
thus recovering the time samples of the strong reﬂectors
component. These recovered signals could then undergo
the standard beamforming and image formation stages.
Nonetheless,
is unnecessary,
and as point reﬂectors are concerned, their location could
be derived from the measurements of all
the elements.
Having an estimated time-delay in each element, this delay
deﬁnes a circle of possible locations whose radius is the
reﬂection’s distance from that element. The spatial location
of the strong reﬂector can therefore be extracted from the
intersection of each two such circles. All in all, the strong
reﬂectors could be reconstructed directly into the beamformed
signal, saving the need for an additional beamforming process.

V. SIDE LOBES SUPPRESSION

One of the imaging artifacts resulting from the receive
beamforming process is the side lobes artifact. Though as-
piring to transmit a narrow beam, the actual transmission is
not solely concentrated in the main axis, but rather radiates
a wide region according to a sinc-shaped beam-proﬁle, such
that the beam has maximal energy on the axis but some of the
energy is dispersed in side lobes.

Then, the received beamforming in its digital form is

ϕm[τm[n]]

ϕm[τm[n] + 1]

B. Representation Domain Beamforming

As previously discussed in Section III, each sampled data
vector from each element has been divided into one dimen-
sional patches (sub-vectors) and for each we have found its
sparse representation over the dictionary we learned.
Let us denote by ϕm ∈ RN the background component of
the signal received by the m-th sensor. Each such component
is divided into P patches ym,p ∈ RQ of length Q:

. . . ϕm[N − 1](cid:3)T ∈ RN

ϕm =(cid:2)ϕm[0] ϕm[1]
=(cid:2)yT

m,1 yT

m,2

. . . yT

m,P

(cid:3)T

(19)

For simplicity here we assume that the patches do not overlap.
However, we note that a similar derivation can be made for
overlapping patches.
Let D ∈ RQ×K, K > Q denote the learned dictionary, then
using OMP we solve for each patch (∀1 ≤ m ≤ M, 1 ≤ p ≤
P ):



(cid:107)zm,p(cid:107)0

subject to (cid:107)ym,p − Dzm,p(cid:107)2 ≤ ε0 (20)
arg min
zm,p
where zm,p ∈ RK but (cid:107)zm,p(cid:107)0 << Q (namely, the number of
non-zero entries of all zm,p is considerably smaller than the
patch size). Following, each patch is reconstructed by ˆym,p =
Dzm,p. Using (19) we can write



. . .
D 0
0 D . . .
...
. . . D

zm,1
zm,2
...
zm,P


(cid:2)1 − αm[n] αm[n](cid:3)(cid:34)

where (cid:101)D (cid:44) IP ⊗ D and ⊗ denotes the Kronecker tensor
(cid:35)(cid:101)Dzm

product, namely A ⊗ B = [aijB]i,j for matrices A and B.
Substituting in (18) we obtain for the beamformed signal

 = (cid:101)Dzm

ϕm =

Φ[n] =

(21)

0
0

...

...

...

0

0

eT
τm[n]
eT
τm[n]+1

M(cid:88)
M(cid:88)

m=1

1
M

=

1
M

bm[n]T zm

m=1

(22)

The beamforming process concentrates the received beam
by assuming that all the received reﬂections originated from
the main axis. Consequently, echoes from a scatterer in the
side lobe pathway are erroneously perceived coming from
the main beam, resulting in image artifacts, manifested as
smeared out echoes. These artifacts not only degrade the
contrast of the image and impair its visual quality, but may
also compromise its diagnostic credibility [31]. Side lobes
suppression is usually treated by apodization, which degrades
the lateral resolution, or by adaptive beamforming [33].

7

Algorithm 2 Modiﬁed Decomposition Algorithm for the l-th
scan line (example given for the STFT-based method)

for each sensor m = 1, ..., M

• run Algorithm 1 and obtain the background rk and
strong reﬂectors parameters {tj, ωj, aj}k
• for each identiﬁed pulse, adjust its time delay to all

j=1.

sensors and to adjacent scan lines:
for pulse j = 1, ..., k

for line q = l − 1, l, l + 1
for sensor s = 1, ..., M

As the side lobe artifacts result from the presence of strong
reﬂectors during the beamforming process, we could utilize
the decomposition approach so as to perform beamforming
only for the background component, after separating the strong
reﬂectors.

When evaluating the ability of our decomposition methods
to reduce side lobes artifacts, we note that the success of
these methods depends on the gain of the side lobe reﬂections
with respect to its surroundings. Recall that both proposed
decomposition methods are based on an amplitude threshold
as a stopping criterion. Therefore, if the side lobe reﬂection is
weak compared with speckle reﬂections along the same beam,
no amplitude threshold will enable its detection as a strong
reﬂector.

In order to account for such cases as well, we propose the
following alteration to our decomposition methods. A greedy
search similar to the one previously described is applied to
each of the raw signals. In each iteration, the best match for the
strong pulse that is above the amplitude threshold is detected
and subtracted using either the STFT of IQ based method.
Unlike the previous methods, before proceeding to the next
iteration, the time-delay of the detected pulse is here adjusted
for all the other sensors and for the adjacent scan lines. For
these other signals, a pulse will be matched and subtracted if a
local maxima occurs at the adjusted expected time, regardless
of the predeﬁned threshold. The time adjustment is calculated
similarly to the delay computed for the purpose of receive
beamforming (see Section IV-A).

Explicitly, if a point reﬂector is placed at distance r and
direction θ from the array center (see Figure 2), then its
distance from the m-th sensor, positioned along ˆz = 0 at
ˆx = δm, is:

rm =

(r cos θ)2 + (r sin θ − δm)2

(27)

(cid:113)

and the echo reﬂected from it arrives to the m-th sensor at
c . From tm we can
time tm = tT X + rm
extract:

c , where tT X = r

(28)

r =

m − δ2

m

c2t2

2(ctm − δm sin θ)

(cid:113)

Then, the expected time of arrival to the k-th sensor is:

tk = tT X +

(r cos θ)2 + (r sin θ − δk)2 (29)
The modiﬁcation of the decomposition algorithm as applied

rk
c

1
c

r
c

=

+

to the l-th scan line is summarized in Algorithm 2.

The modiﬁed method here presented has a signiﬁcant impact
in cases where the strong reﬂectors are placed in a speckled

– compute tj
– if tj

s using (29)

s is a local maxima for line q and sensor s, with
amplitude aq,s, subtract aq,sH(t− ts, ω− ωj) from
the relevant residual

region and have visible side lobe artifacts, such as the synthetic
cyst phantom example described in Section VI-B.

VI. SIMULATION AND RESULTS

We have conducted experiments using simulated data and
real cardiac data. In the following, we describe in some detail
the setup and information pertaining to these experiments.

A. 1D Simulation Results

To evaluate the decomposition algorithms, both the STFT
and IQ based methods for removing the strong reﬂectors were
ﬁrst tested on a single scan line simulated using the FieldII
simulation program [34].

We created an aperture comprising 64 transducer elements,
with central frequency f0 = 3.5M Hz. The width of each
element, measured along the ˆx axis, was 1
=
0.22mm, and its height, measured along the ˆy axis, was
5mm. The elements were arranged along the ˆx axis, with a
0.055mm inter-element spacing (kerf). The transmitted pulse
was simulated by exciting each element with two periods of a
sinusoid of frequency f0, where the delays were adjusted such
that the transmission focal point was at depth r = 70mm. No
apodization was used.

2 λ = c
2f0

The simulation parameter settings are summarized in Table

I.

The simulation setup is illustrated in Figure 3.

Parameter

Value

c (Speed of Sound)

f0 (Central Frequency)
fs (Sampling Frequency)

Element Width
Element Height

Kerf

Number of Elements

Apodization
TX Focus

1540 m/sec
3.5 MHz
16 MHz
0.22 mm

5 mm

0.055 mm

64
none
70 mm

TABLE I: FieldII simulation parameters for the point reﬂectors
phantom

A single scan line was simulated for a steering angle θ = 0◦.

8

B. Cyst Phantom Results

Fig. 3: FieldII simulation setup for the point reﬂectors phantom

The simulated phantom consists of speckled background
with 4 strong reﬂectors positioned 5mm apart along the ˆz
axis (θ = 0◦).

was

The

point

reﬂectors

constructed

region
105

three dimensional

by
distributed
region given by

speckled
randomly
drawing
uniformly in the
{(x, y, z) : |x| ≤ 9mm, |y| ≤ 5mm, |z − 70| ≤ 14mm}.
The corresponding amplitudes were also drawn at random
according to a Normal distribution with zero-mean and
unit-variance. Then, the strong reﬂectors were added along
the ˆz axis at depths 65mm, 70mm, 75mm, 80mm. The
strong reﬂectors amplitudes were set
to be 50 times the
variance of the speckle reﬂectors amplitudes.

Figure 4 depicts the RF echo received by one of the
transducer elements with its decomposition results using both
STFT and IQ approaches.

These decomposition results are compared with a ground
truth obtained by individual simulation of the two components.
Comparing the two approaches, it appears that the IQ based
method gives a better separation of the two components, where
less of the background component is removed with the strong
reﬂectors. The visual superiority is also reﬂected by the Mean
Square Error (MSE) and Peak Signal-to-Noise Ratio (PSNR)
calculated with respect to the ground truth components, as
summarized in Table II.

This result is consistent with our formerly mentioned expec-
tations, since using lower frequencies and relieving the need
for phase optimization makes the estimation less bound to
errors.

(cid:16) I 2

(cid:17)

(cid:20)(cid:16)

Recall that PSNR is deﬁned as P SN R = 10 log10

max
M SE

where Imax is the maximal possible value of the compared
signals or images (for images spanning the full 8-bit gray-
scale, Imax = 255) and M SE = E
with I and ˆI
being the compared signals or images.

I − ˆI

(cid:17)2(cid:21)

STFT

IQ

PSNR
MSE

30.231
3.79e-40

34.204
1.52e-40

Original
Signal 4a
18.714
5.37e-39

TABLE II: PSNR (in [dB]) and MSE results for the point
reﬂectors phantom. Results are relative to the ground truth
components 4f-4g

Our four proposed methods for identifying and removing
the strong reﬂectors (STFT, IQ, modiﬁed STFT and modiﬁed
IQ) have been tested on a synthetic phantom simulated using
the FieldII program [34]. The data acquisition setup is similar
to the previous phantom as summarized in Table I.
During this simulation, a 24◦ sector was imaged using 48
scan lines in Single Line Acquisition mode (SLA), i.e. a single
reception line was computed for each transmission.

was

The

point

reﬂectors

constructed

three dimensional

by
distributed
region given by

The phantom comprises of a large cyst in a speckled back-
ground, with a single strong reﬂector placed in the speckled
region right besides the cyst.
region
105

speckled
randomly
drawing
uniformly in the
{(x, y, z) : |x| ≤ 9mm, |y| ≤ 5mm, |z − 70| ≤ 14mm}.
The corresponding amplitudes were also drawn at random
according to a Normal distribution with zero-mean and
unit-variance. The cyst was then created by removing all
point reﬂectors from a circle of radius 8.5mm centered at
(x, y, z) = (0, 0, 70mm). Finally, a single strong reﬂector
was added at (x, y, z) = (8.6mm, 0, 70mm), i.e. at a depth
of r = 70.5mm at an angle of 7◦, such that it lies exactly
along the main direction of the 39-th scan line. The strong
reﬂector’s amplitude was set to be 100 times the variance of
the speckle reﬂectors amplitudes.

The reﬂector was intentionally placed very close to the cyst
(0.1mm from its boundary). While the beam focus is aimed
at the cyst, side lobes might insonify the strong reﬂector that
is positioned outside it, and its reﬂection would be interpreted
as if it originated from within the cyst. This causes undesired
artifacts in the resulting image, as previously mentioned in
Section V. Had the strong reﬂector been placed in a speckled
region, its reﬂections might have blended with other weak
reﬂections in its speckled surroundings, but in our example,
due to the low echogenicity of the cyst, the side lobe reﬂections
are expected to be easily observed.

Using this phantom, we would like to show that our meth-
ods, operating at the sensor level, are able to remove the side
lobe reﬂections, such that these artifacts no longer exist, or
are signiﬁcantly decreased, in the output image.

A ground truth image was generated by repeating the
simulation without the strong reﬂector, thus obtaining a clean
background image.

The background estimation results obtained for the cyst
phantom are depicted in Figure 5. Corresponding PSNR and
SSIM [35] values compared with the ground truth image are
presented in Table III.

The reconstructed combined images, obtained after adding
the estimated strong reﬂectors to the beamformed background
signals, are depicted in Figure 6. These results show that both
our modiﬁed decomposition methods (based on either STFT
or IQ) yield good quality images, in which the smearing of
the strong reﬂector due to side lobes artifacts is removed and
replaced with the actual point reﬂector, such that the cyst
boundary is no longer obscured.

9

(a)

(c)

(e)

(g)

(b)

(d)

(f)

Fig. 4: Point reﬂectors RF signal with its decomposition: (a) Received RF signal, (b) Background component (STFT
decomposition), (c) Strong reﬂectors (STFT decomposition), (d) Background component (IQ decomposition), (e) Strong
reﬂectors (IQ decomposition), (f) Background component (ground truth), (g) Strong reﬂectors (ground truth)

Orig.
Image

5a

34.56
0.9925

STFT

5c

33.28
0.9848

PSNR
SSIM

Modiﬁed

STFT

5d

40.08
0.9947

IQ
5e

36.03
0.9901

Modiﬁed

IQ
5f

43.27
0.9957

TABLE III: PSNR (in [dB]) and SSIM results for the cyst
phantom. Results are relative to the ground truth image 5b

(a)

(b)

(c)

Fig. 6: Cyst phantom combined image results: (a) Original
image, (b) Combined image using modiﬁed STFT decompo-
sition, (c) Combined image using modiﬁed IQ decomposition.

Based on these results, the modiﬁed decomposition method
presented in Section V therefore seems better in terms of
removing side lobes. Nevertheless, this modiﬁcation has its
down-side. Now depending on adjacent lines, this method can
no longer run in parallel for all the sensor echoes of all the
scan lines, but should rather run on a collection of such lines,

707580859095100105110115−1−0.8−0.6−0.4−0.200.20.40.60.81Original SignalAmplitudeTime [usec]707580859095100105110115−1−0.8−0.6−0.4−0.200.20.40.60.81STFT BackgroundAmplitudeTime [usec]707580859095100105110115−1−0.8−0.6−0.4−0.200.20.40.60.81STFT Strong ReflectorsAmplitudeTime [usec]707580859095100105110115−1−0.8−0.6−0.4−0.200.20.40.60.81IQ BackgroundAmplitudeTime [usec]707580859095100105110115−1−0.8−0.6−0.4−0.200.20.40.60.81IQ Strong ReflectorsAmplitudeTime [usec]707580859095100105110115−1−0.8−0.6−0.4−0.200.20.40.60.81Original BackgroundAmplitudeTime [usec]707580859095100105110115−1−0.8−0.6−0.4−0.200.20.40.60.81Original Strong ReflectorsAmplitudeTime [usec]Original ImageSTFT (iterative) Combined ImageIQ (iterative) Combined Image10

(a)

(c)

(e)

(b)

(d)

(f)

Fig. 5: Cyst phantom background estimation results: (a) Original image, (b) Original image without strong reﬂectors (ground
truth), (c) STFT background image, (d) Modiﬁed STFT background image, (e) IQ background image, (f) Modiﬁed IQ
background image.

thus dictating a longer runtime compared with the independent
removal methods.

It should be emphasized that this simulated example rep-
resents the worst-case scenario. In some cases, a suitable
amplitude threshold, i.e. one that separates the side lobe re-
ﬂections from the background, may exist for the non-modiﬁed
methods as well. Additionally, in more typical cases the strong
reﬂectors are placed within echogenic tissues, such that the
side lobe reﬂections themselves, or any minor errors in their
detection, are within the standard deviation of the surrounding
speckle and thus unidentiﬁable in the resulting image. Our
chosen example is therefore less tolerant to errors.

Another source of difﬁculty arises from our underlying
assumption of the pulse shape. The assumed pulse model was
developed for the main lobe reﬂection of the pulse, yet for
more distant lines, representing side lobe echoes, the pulse
shape is not guaranteed to remain undistorted.

Despite these limitations, our methods are successful at

suppressing the side lobe artifacts.

C. Cardiac Data Results

In addition to synthetic phantoms, our methods were tested
on several sets of consecutive frames of cardiac ultrasound
data provided by GE Healthcare.

In this section we examine the results obtained by applying
our methods to raw RF data acquired and stored for cardiac
images of a healthy consenting volunteer. The acquisition was
performed using a breadboard ultrasonic scanner employing a
64-element phased array probe. Operating in second harmonic

imaging mode, pulses were transmitted at 1.7M Hz, and the
corresponding second harmonic signal, centered at 3.4M Hz,
was then acquired. Data from all acquisition channels was
sampled at 16M Hz and collected along 120 beams, forming
a 75◦ sector. The maximal imaging depth was z = 16cm,
implying a cycle time of T = 208µsec. The imaging settings
are summarized in Table IV.

Parameter

Value

c (Speed of Sound)

f0 (Central Frequency)
fs (Sampling Frequency)

Element Width

Number of Elements
Number of Scan Lines

1540 m/sec
3.423 MHz

16 MHz
0.29 mm

64
120

Sector Size

75 degrees

TABLE IV: Cardiac imaging parameters

First we want to evaluate the decomposition results. For
this purpose, we compare the images reconstructed for the
separated background components (without compression).

The results obtained for 2 different frames are illustrated
in Figure 7, where each frame is presented along with
its background estimations using the STFT and IQ based
decomposition methods. These images indicate that our
proposed decomposition methods successfully detect and
remove the strong reﬂections, thus producing a background
image with relatively homogeneous
two
evaluated decomposition methods produce very similar
results.

regions. The

Original ImageOriginal Image without Strong ReflectorsSTFT Background ImageSTFT (iterative) Background ImageIQ Background ImageIQ (iterative) Background Image11

(a)

(d)

(b)

(e)

(c)

(f)

Fig. 7: Background estimation results. The ﬁrst row corresponds to frame 1, and the second row corresponds to frame 2. (a),(d)
Original image. (b),(e) STFT background image. (c),(f) IQ background image.

Following decomposition, background compression was
conducted according to the algorithm described in Section III.
Non-overlapping patches of length Q = 100 were used, the
number of sensors is M = 64 and the RF signal length
is N = 3328 samples. It should also be noted that in this
experiment, apodization was applied to each raw signal before
summing them up, which is not reﬂected in the theoretical
formulation of representation domain beamforming presented
in Section IV-B. The results are depicted in Figure 8, that
presents the background image obtained using STFT based
decomposition alongside its 24-fold compressed version, as
applied to frame 1, whose data was used as the training
set. Figure 9 then displays the compression results obtained
for frame 2, which indicate that although the dictionary was
trained based on signals from a single frame, it is suitable for
representing data of other frames as well. Similar results were
obtained for other sets of cardiac ultrasound frames acquired
using the same imaging settings.

In Section III-A we pointed out a few challenges to the
background compression process, namely the small size of
the dictionary training set, the use of non-overlapping patches
and the fact that training was performed using beamformed
signals while intended to represent raw signals.

Observing

the

our

images,

compressed

proposed
compression scheme seems to produce visually good images
that preserve even the subtle image features. These results
were obtained despite the formerly mentioned challenges, and
while achieving an average compression ratio of 24, implying
that the number of coefﬁcients needed for reconstruction was
only 4% of the number of time samples in the received RF
signal.

(a)

(b)

Fig. 8: Frame 1 background compression results: (a) STFT
background image, (b) Compressed STFT background image
(PSNR=29.16[dB])

(a)

(b)

Fig. 9: Frame 2 background compression results: (a) STFT
background image, (b) Compressed STFT background image
(PSNR=29.41[dB])

Original Image (High Rate Beamformed)STFT Background (sensor level separation)IQ Background (sensor level separation)Original Image (High Rate Beamformed)STFT  BackgroundIQ BackgroundSTFT  BackgroundCompressed STFT BackgroundSTFT  BackgroundCompressed STFT Background12

To further demonstrate the superiority of our chosen com-
pression scheme, let us return to our initial conjecture motivat-
ing the raw signals decomposition, which was that individually
compressing each component may lead to better compression
ratios compared with a direct compression of the complete
raw signal. In order to prove this hypothesis, we conducted a
dictionary learning process using the same methods previously
applied for the background signals, now using the original
beamformed signals as the training set, without removing the
strong reﬂectors. We then used this new dictionary for sparsely
representing each of the detected raw signals.

For the sake of comparison, the same error threshold was
used for the dictionary learning process, and the learning set
also consisted of 10 beamformed signals, taken from the same
frame dataset.

The compression results obtained for the original frame
data (without decomposition) over this speciﬁcally trained
dictionary, are presented in Figure 10. The resulting image is
of comparable quality to that of the compressed background
in terms of the visible
images displayed in Figures 8-9,
amount of saved features. The beneﬁt
though is in the
achieved compressed ratio, which is over 2-fold better when
utilizing decomposition.

(a)

(b)

Fig. 10: Compression results for frame 1 without decomposi-
tion: (a) Original image, (b) Compressed image.

Since the original

image contains the strong reﬂectors
information as well, a fair comparison of the compression
ratios demands that the amount of coefﬁcients needed for
representing the strong reﬂectors is added to those used for
representing the background signal. When the strong reﬂectors
are considered, a slightly reduced compression ratio of 21.4
is achieved. Nonetheless, this achieved compression ratio is
still twice as high as the one achieved for the original raw data.

The comparison of achieved compression ratios is sum-
marized in Table V. The ﬁrst line presents information for
the compression of the background only, the second presents
information combined from separate compression of the back-
ground and the strong reﬂectors, and the third line presents
information for the direct compression of the raw signals
without decomposition.

It is readily seen that the individual compression of the
background and strong reﬂectors components outperforms the
direct compression of the raw data, in accordance with our

background
background

+ strong reﬂectors

full raw signal

% of coefﬁcients

compression factor

4.07
4.67
9.10

24.56
21.40
10.99

TABLE V: Comparison of the achieved compression ratios

predictions.

In this regard, it should be pointed out that the compression
ratio considering both the background signal and strong
reﬂectors, is relevant for analyzing the total amount of saved
data. However, in terms of the data needed to be employed
in beamforming computations, the higher compression factor
(that only considers the background)
is still applicable,
as our proposed processing scheme suggests
the
strong reﬂectors need not undergo beamforming for their
reconstruction. Moreover, recall that the beamforming process
itself was simpliﬁed by conducting it in the representation
domain, thus achieving further reduction of the computational
load besides the use of a smaller amount of coefﬁcients.

that

VII. CONCLUSIONS

In this work, we extended previous models proposed in [15],
[16] by integrating the speckle reﬂections and assembling a
direct sum of two components, each of which carries valuable
information and could be characterized by a limited amount
of parameters. In accordance with this model, we developed a
processing scheme for raw ultrasound signals that exploits the
inherent redundancy of the data, and achieves an improved
compression ratio as well as a signiﬁcant reduction of side
lobes artifacts, while preserving the image information.

At the heart of the proposed processing scheme stands a
sparse decomposition stage, that detects the strong reﬂections
and separates them from the background signal. The ﬁrst
approach for doing so is based on the Short-Time Fourier
Transform (STFT), such that decomposition is carried out in a
time-frequency domain. A second approach, adapted to state-
of-the-art ultrasound systems in which IQ demodulation is
performed prior to sampling, applies decomposition directly to
the I/Q components. We next provided slightly altered versions
of both these approaches, that improve their ability to suppress
reﬂections originating from side lobes.

After the signal decomposition stage, the separated back-
ground component undergoes further processing. First, it is
sparsely represented over a suitable dictionary, that was trained
ofﬂine from background signal examples. Afterwards,
the
compressed background signals are integrated in a modiﬁed
beamforming process, applied at the representation domain.

Finally, the strong reﬂectors could be reconstructed from
their sparse coefﬁcients directly into the beamformed signal,
and combined with the reconstructed background component
in order to construct the complete signal.

The novelty of this model

lies in the component-based
approach, especially as it concerns the raw signals rather than
the beamformed ones or the resulting image.

Original Image (High Rate Beamformed)Sparse reconstruction (sensor level separation) An important application that gains from this model and
the derived processing scheme, is the reduction of the amount
of data needed to be transferred from the system front-end
and processed by the beamformer. Applying our processing
schemes to real cardiac ultrasound data, we successfully re-
construct the image contents while achieving over twenty-fold
reduction of the data size. For comparison, this compression
rate is twice as high as the one achieved by an equivalent
compression of the raw signal without decomposition.

We point out that designed for the raw signals, the online
algorithm may be applied at the sensors immediately after
sampling, and does not require the full frame to be acquired.
Moreover, it is clearly desirable to compress the data as
early in the processing chain as possible. As far as digital
compression is concerned, our approach operates on raw
signals ”close to the source”, i.e. immediately after sampling.
Though not yet attempted in the scope of our work, we believe
that utilizing the proposed two-component model and learned
dictionary, a low rate sampling scheme can be established,
such that our algorithm may be extended to the compressed
sensing framework. Doing so, our results could be compared
with other ultrasound compression techniques currently em-
ployed in the analog domain.

An additional contribution of our work relates to the result-
ing suppression of side lobes. We show that by separating the
strong reﬂectors at early stages of the imaging cycle, before
the receive beamforming, side lobes artifacts are signiﬁcantly
reduced alongside the data size reduction, thus improving the
contrast of the reconstructed image and its diagnostic value.
Finally, we note that the component-based modeling may
open more possibilities for analyzing ultrasonic signals. While
we identiﬁed two main components, other decomposition ideas
may be investigated, such as separating the ﬁrst- and second-
harmonic echoes, or detecting more than two components
related to various artifacts which require special processing.

REFERENCES

[1] C. B. Burckhardt, “Speckle in Ultrasound B-Mode Scans,” IEEE Trans.

Sonics Ultrason., vol. 25, no. 1, pp. 1–6, Jan. 1978.

[2] R. F. Wagner, S. W. Smith, J. M. Sandrik, and H. Lopez, “Statistics of
Speckle in Ultrasound B-Scans,” IEEE Trans. Sonics Ultrason., vol. 30,
no. 3, pp. 156–163, May 1983.

[3] M. F. Insana, R. F. Wagner, B. S. Garra, D. G. Brown, and T. H.
Shawker, “Analysis of Ultrasound Image Texture Via Generalized Rician
Statistics,” Proc. SPIE, Intl. Conference on Speckle, vol. 556, pp. 153–
159, Nov. 1985.

[4] E. Jakeman and R. J. A. Tough, “Generalized K Distribution: A
Statistical Model for Weak Scattering,” J. Opt. Soc. Am. A, vol. 4, no. 9,
pp. 1764–1772, September 1987.

[5] J. Girault, F. Ossant, A. Ouahabi, D. Kouame, and F. Patat, “Time-
Varying Autoregressive Spectral Estimation for Ultrasound Attenuation
in Tissue Characterization,” IEEE Trans. Ultrason. Ferroelec. Freq.
Control, vol. 45, no. 3, pp. 650–659, May 1998.

[6] O. V. Michailovich and D. Adam, “A Novel Approach to the 2-D
Blind Deconvolution Problem in Medical Ultrasound,” IEEE Trans. Med.
Imaging, vol. 24, no. 1, pp. 86–104, Jan. 2005.

[7] T. Taxt, “Restoration of Medical Ultrasound Images using Two-
Dimensional Homomorphic Deconvolution,” IEEE Trans. Ultrason. Fer-
roelec. Freq. Control, vol. 42, no. 4, pp. 543–554, July 1995.

[8] O. V. Michailovich and A. Tannenbaum, “Despeckling of Medical
Ultrasound Images,” IEEE Trans. Ultrason. Ferroelec. Freq. Control,
vol. 53, no. 1, pp. 64–78, Jan. 2006.

[9] D. Adam and O. V. Michailovich, “Blind Deconvolution of Ultrasound
Sequences using Nonparametric Local Polynomial Estimates of the
Pulse,” IEEE Trans. Biomed. Eng., vol. 49, no. 2, pp. 118–131, 2002.

13

[10] M. Kutay, A. Petropulu, and C. Piccoli, “On modeling Biomedical
Ultrasound RF Echoes Using a Power-Law Shot-Noise Model,” IEEE
Trans. Ultrason. Ferroelec. Freq. Control, vol. 48, no. 4, pp. 953–968,
2001.

[11] C. Quinsac, A. Basarab, J.-M. Girault, and D. Kouame, “Compressed
Sensing of Ultrasound Images: Sampling of Spatial and Frequency
Domains.” in IEEE Workshop on Signal Processing Systems (SiPS), Oct.
2010.

[12] C. Quinsac, A. Basarab, and D. Kouame, “Frequency Domain Com-
pressive Sampling for Ultrasound Imaging,” Advances in Acoustics and
Vibration, vol. 12, pp. 1–16, 2012.

[13] D. Friboulet, H. Liebgott, and R. Prost, “Compressive Sensing for
Raw RF Signals Reconstruction in Ultrasound,” in IEEE Ultrasonics
Symposium (IUS), 2010, pp. 367–370.

[14] H. Liebgott, R. Prost, and D. Friboulet, “Pre-Beamformed RF Signal
Reconstruction in Medical Ultrasound Using Compressive Sensing,”
Ultrasonics, vol. 53, no. 2, pp. 525 – 533, 2013.

[15] R. Tur, Y. C. Eldar, and Z. Friedman, “Innovation Rate Sampling of
Pulse Streams with Application to Ultrasound Imaging,” IEEE Trans.
Signal Proc., vol. 59, no. 4, pp. 1827–1842, 2011.

[16] N. Wagner, Y. C. Eldar, A. Feuer, and Z. Friedman, “Compressed
Beamforming Applied to B-Mode Ultrasound Imaging,” in Proc. 9th
IEEE International Symposium on Biomedical Imaging (ISBI), 2012.

[17] I. Tosic, I. Jovanovic, P. Frossard, M. Vetterli, and N. Duric, “Ultrasound
Tomography with Learned Dictionaries,” in Proceedings of the IEEE
International Conference on Acoustics, Speech, and Signal Processing
(ICASSP), March 2010, pp. 5502–5505.

[18] O. Lorintiu, H. Liebgott, O. Bernard, and D. Friboulet, “Compressive
Sensing Ultrasound Imaging using Overcomplete Dictionaries,” in IEEE
International Ultrasonics Symposium (IUS), July 2013, pp. 45–48.

[19] O. Lorintiu, H. Liebgott, M. Alessandrini, and O. Bernard, “Compressed
Sensing Reconstruction of 3D Ultrasound Data using Dictionary Learn-
ing,” in Proc. of IEEE International Conference on Image Processing
(ICIP), 2014, pp. 1317–1321.

[20] G. E. Trahey, J. W. Allison, and O. T. Von Ramm, “Angle Independent
Ultrasonic Detection of Blood Flow,” IEEE Trans. Biomed. Eng., vol.
BME-34, no. 12, pp. 965–967, 1987.

[21] L. N. Bohs and G. E. Trahey, “A Novel Method for Angle Independent
Ultrasonic Imaging of Blood Flow and Tissue Motion,” IEEE Trans.
Biomed. Eng., vol. 38, no. 3, pp. 280–286, 1991.

[22] M. Aharon, M. Elad, and A. Bruckstein, “K-SVD: An Algorithm for
Designing Overcomplete Dictionaries for Sparse Representation,” IEEE
Trans. Signal Proc., vol. 54, no. 11, pp. 4311–4322, Nov. 2006.

[23] H. Azhari, Basics of Biomedical Ultrasound for Engineers. Wiley,

2010.

[24] A. Basarab, H. Liebgott, O. Bernard, D. Friboulet, and D. Kouame,
“Medical Ultrasound Image Reconstruction using Distributed Compres-
sive Sampling,” in IEEE 10th International Symposium on Biomedical
Imaging (ISBI), April 2013, pp. 628–631.

[25] H. Liebgott, A. Basarab, D. Kouame, O. Bernard, and D. Friboulet,
“Compressive Sensing in Medical Ultrasound,” in IEEE International
Ultrasonics Symposium (IUS), Oct 2012, pp. 1–6.

[26] M. F. Schiffner and G. Schmitz, “Fast Pulse-Echo Ultrasound Imaging
Employing Compressive Sensing,” in IEEE International Ultrasonics
Symposium (IUS), Oct 2011, pp. 688–691.

[27] Y. F. Li and P. C. Li, “Ultrasound Beamforming using Compressed
Data,” IEEE Trans. Inf. Technology in Biomedicine, vol. 16, no. 3, pp.
308–313, 2012.

[28] M. Vetterli, P. Marziliano, and T. Blu, “Sampling Signals With Finite
Rate of Innovation,” IEEE Trans. Signal Proc., vol. 50, no. 6, pp. 1417–
1428, 2002.

[29] T. Blu, P. L. Dragotti, M. Vetterli, P. Marziliano, and L. Coulot, “Sparse
Sampling of Signal Innovations: Theory, Algorithms and Performance
Bounds,” IEEE Signal Processing Magazine, vol. 25, no. 2, pp. 31–40,
2008.

[30] L. T. Chira, J.-M. Girault, T. Mateo, S. M´enigot, and C. Rusu, “Ul-
trasound Medical Image Deconvoluion using CLEAN Algorithm,” in
Acoustic, 2012.

[31] T. L. Szabo, Diagnostic Ultrasound Imaging: Inside Out, ser. Academic
Elsevier Academic Press,

Press Series in Biomedical Engineering.
2004.

[32] J. A. Jensen, “Linear Description of Ultrasound Imaging Systems,” Notes
for the International Summer School on Advanced Ultrasound Imaging,
Technical University of Denmark, 1999.

[33] F. Vignon and M. R. Burcher, “Capon Beamforming in Medical Ultra-
sound Imaging With Focused Beams,” IEEE Trans. Ultrason. Ferroelec.
Freq. Control, vol. 55, no. 3, pp. 619–628, 2008.

14

[34] J. A. Jensen, “FIELD: A Program for Simulating Ultrasound Systems,”
in Medical & Biological Engineering & Computing, vol. 34, Supplement
1, 1996, pp. 351–353.

[35] Z. Wang, A. C. Bovik, H. R. Sheikh, and E. P. Simoncelli, “Image
Quality Assessment: From Error Visibility to Structural Similarity,”
IEEE Trans. Image Proc., vol. 13, no. 4, pp. 600–612, 2004.

