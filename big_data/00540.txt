6
1
0
2

 
r
a

M
2

 

 
 
]
P
A
h
t
a
m

.

[
 
 

1
v
0
4
5
0
0

.

3
0
6
1
:
v
i
X
r
a

A GRADIENT FLOW APPROACH TO THE BOLTZMANN

EQUATION

MATTHIAS ERBAR

Abstract. We show that the spatially homogeneous Boltzmann equa-
tion (with constant collision kernel) evolves as the gradient ﬂow of the
entropy with respect to a suitable geometry on the space of probability
measures. This geometry is given by a new notion of distance between
probability measures, which takes the collision process into account. As
a ﬁrst application, we obtain a novel time-discrete approximation scheme
for the homogeneous Boltzmann equation.

1. Introduction

Since the pioneering work of Otto [10] it is well know that many diﬀu-
sion equations can be cast as gradient ﬂows of entropy functionals in the
space of probability measures. The relevant geometry is induced by the L2
Wasserstein distance. Otto’s approach has been used as a powerful and ver-
satile tool in the study of the trend to equilibrium, stability questions and
construction of solutions. Prototypical examples that admit such a gradient
ﬂow formulation are Fokker–Planck and porous medium type equations, but
many new instances have been exhibited by now. In each case –as a direct
consequence of the gradient ﬂow structure– the driving entropy functional
is non-decreasing along the solution.
One of the most emblematic dissipative evolution equations is the Boltzmann
equation modeling the evolution of a dilute gas under elasic collisions of the
particles. Boltzmann’s famous H-theorem asserts that the entropy is non-
increasing along its solutions. Nevertheless, a gradient ﬂow description of
this equation has been out of reach so far.
In this article we remedy this fact and present a characterization of the
spatially homogeneous Boltzmann equation as a gradient ﬂow of the entropy.
The crucial new insight is the identiﬁcation of a novel geometry on the space
of probability measures. It is induced by a new kind of distance between
probability measures that takes the collision process between particles into
account.
Let us describe the setting and the main results in more detail. We consider
the spatially homogeneous Boltzmann equation

∂tf = Q(f, f ) ,

(1.1)

Key words and phrases. Boltzmann equation, gradient ﬂow, entropy.

1

2

MATTHIAS ERBAR

where f : RN → R+ is a probability density and Q denotes the Boltzmann
collision operator given by

Q(f, f ) =ZRNZSN −1(cid:2)f ′f ′

∗ − f f ′(cid:3)B(v − v∗, ω)dv∗dω ,

Here B is the collision kernel and v, v∗ and v′, v′
collisional velocities respectively which are related according to

∗ denote the pre- and post-

(1.2)

v′ = v − hv − v∗, ωi ω ,

v′
∗ = v∗ + hv − v∗, ωi ω , ω ∈ SN −1 .

(1.3)

We will often use the abbreviated notation

f = f (v), f∗ = f (v∗), f ′ = f (v′), f ′

∗ = f (v′

∗) .

Boltzmann’s H-theorem assert that the entropy H(f ) = R f log f is non

increasing along solutions to the Boltzmann equation, more precisely, we
have d

dtH(ft) = −D(ft) ≤ 0 , where
(f ′f ′

D(ft) =

1

4Z log

f ′f ′
∗
f f∗

∗ − f f∗)B(v − v∗, ω)dωdv∗dv .

(1.4)

(1.6)

The gradient ﬂow structure for the Boltzmann equation rests on a novel
geometry on the space of probability measures. We will deﬁne a distance
WB between probabilities µ and ν by setting

0 Z | ¯∇ψt|2Λ(ft)B(v − v∗, ω)dωdv∗dvdt(cid:27) ,
WB(µ, ν)2 = inf(cid:26) 1
4Z 1
where the inﬁmum runs over all curves of probability measures t 7→ ftdv
connecting µ and ν and all functions ψ : [0, 1] × RN → R related via

(1.5)

∂tft(v) +

1

4Z ¯∇ψtΛ(ft)B(v − v∗, ω)dωdv∗ = 0 .

∗ − ϕ − ϕ∗ and Λ(f ) is shorthand for

∗(cid:1), where Λ(s, t) = (s − t)/(log s − log t) denotes the logarithmic

Here, we have set ¯∇ϕ = ϕ′ + ϕ′
Λ(cid:0)f f∗, f ′f ′
mean.
Note that the deﬁnition of WB resembles the dynamic formulation of the
L2-Wasserstein distance, known as the Benamou–Brenier formula [3]. Here,
the collision rate equation (1.6) takes over the role of the usual continuity
equation. Roughly speaking, the potential ψ governs the evolution of the
density f by prescribing the rate at which collisions happen between the
particles.
To motivate this approach, note that in analogy to the Otto calculus for
the Wasserstein distance, the function ¯∇ψ should be regarded as the tan-
gent vector to the curve (ft)t. The formal metric tensor on the space of
probability measures which gives rise to the distance WB is then given by

h ¯∇ψ, ¯∇ϕif =

1

4Z ¯∇ψ ¯∇ϕΛ(f )B(v − v∗, ω)dωdv∗dv .

If ft is a solution to the Boltzmann equation, it satisﬁes (1.6) with ψt = log ft
and we ﬁnd formally the gradient ﬂow relation

d
dtH(ft) = −| ¯∇ log ft|2

ft = −|grad H(ft)|2 .

A GRADIENT FLOW APPROACH TO THE BOLTZMANN EQUATION

3

This novel gradient ﬂow structure bears some analogy with work of Maas
[8] and Mielke [9], where gradient ﬂow structures for the evolution of ﬁnite
Markov chains and reaction-diﬀusion equations have been found. Formally,
the homogeneous Boltzmann equation could be seen as a binary reaction
equation with a continuum of species indexed by the velocity.
We will ﬁrst construct the distance WB by a suitable relaxation of the min-
imization problem (1.5), (1.6) to a measure-valued framework. Here, we
restrict ourselves to considering collision kernels B which are integrable in
the angular variable and bounded and continuous in the velocity variable,
see Assumption 2.1 for the precise conditions we require. However, we belief
that the approach is robust and ﬂexible enough to deal also with singular
kernels. Our ﬁrst result is the following (see Theorem 3.19 below).

Theorem 1.1. Assume that B satisﬁes Assumption 2.1. Then WB deﬁnes
an extended (i.e. potentially taking the value +∞), separable and complete
distance on the set P∗(RN ) of probability measures with zero mean and unit
variance. Each pair µ, ν with WB(µ, ν) < ∞ can be joined by a geodesic.
Under the assumption that the collision kernel B is constant, we rigorously
characterize the spatially homogeneous Boltzmann equation (1.1) as the
gradient ﬂow of the entropy w.r.t. the distance WB in the framework of
gradient ﬂows in metric spaces. More precisely, we show the following (see
Proposition 4.1 and Theorem 4.3 below).

Theorem 1.2. Assume that B is constant. Then pD(f ) is a strong up-
per gradient for the entropy H on (P∗(RN ),WB), i.e. for any absolutely
continuous curve (ft)t, we have

H(fs) − H(ft) ≤Z t

s pD(fr)|f ′

r|dr ,

r| denotes the metric speed w.r.t. WB. Moreover, given f0 ∈ P∗(RN )
where |f ′
with H(f0) < ∞, the solution (ft)t≥0 to the Boltzmann equation (1.1) with
initial datum f0 is the unique gradient ﬂow of H in the sense of the Energy
Dissipation Equality starting from f0, i.e. satisfying

H(fs) − H(ft) =

1

2Z t

s

D(fr) + |f ′

r|2dr .

In this sense, the Boltzmann equation is a steepest descent, decreasing the
entropy “as fast as possible”. The assumption that the collision kernel is
constant is of purely technical convenience here and is imposed to have
regularization techniques involving the Ornstein–Uhlenbeck semigroup at
our disposal. We believe that this gradient ﬂow structure should be present
for much more general kernels.
As a ﬁrst application, we obtain a novel time-discrete variational approxima-
tion scheme for the Boltzmann equation. In fact, we show that the so-called
minimizing movement scheme, i.e. the implicit Euler scheme for the gradient
ﬂow equation, converges to the solution to (1.1) (see Theorem 5.1 below).

f τ
0 = f0 ,

f τ
n ∈ argmin

g

Deﬁne a piece-wise constant interpolation ( ¯f τ

¯f τ
0 = f0 ,

¯f τ
t = f τ

n−1)2i .

hH(g) +
1
2τ WB(g, f τ
t )t≥0 via
n if t ∈(cid:0)(n − 1)τ, nτ ] .

4

MATTHIAS ERBAR

Given a time step τ > 0 and an initial datum f0 ∈ P∗(RN ) with H(f0) < ∞
let (µτ

n)n be deﬁned recursively via

Theorem 1.3. As τ goes to zero, we have that ¯f τ
t converges weakly to ft
for all t, where (ft)t is the solution to the Boltzmann equation with initial
datum f0.

Organization. In Section 2 we collect necessary preliminaries, in particu-
lar we recall regularizing properties of the Ornstein–Uhlenbeck semigroup
in the context of the Boltzmann equation and the basic framework of gra-
In Section 3 we present the construction of
dient ﬂows in metric spaces.
the distance WB and establish various properties. The characterization of
the Boltzmann equation as entropic gradient ﬂow is obtained in Section 4.
Finally, in Section 5 the variational approximation scheme is considered.

Acknowledgment. The author wishes to thank Andr´e Schlichting for fruitful dis-
cussion on this work and related topics. The author gratefully acknowledges support
by the German Research Foundation through the Collaborative Research Center
1060 The Mathematics of Emergent Eﬀects and the Hausdorﬀ Center for Mathe-
matics

2. Preliminaries

2.1. Homogeneous Boltzmann equation, entropy and dissipation.
Throughout the paper we make the following assumption on the collision
kernel unless stated otherwise.

ZSN −1

Assumption 2.1. There exists a constant CB such that
B(k, ω)dω ≤ CB ∀k ∈ RN .
k 7→ZSN −1

Moreover, the map

B(k, ω)dω

is continuous on RN .

(2.1)

We recall well known existence and uniqueness results for the homogeneous
Boltzmann equation in this setting going back to [2].
Theorem 2.2. Let f0 : RN → R+ be such that

Then there exists a unique classical solution (ft)t≥0 to the homogeneous
Boltzmann equation (1.1). It conserves mass, momentum and energy, i.e.

(1 + |v|2)f0(v)dv < ∞ ,

Z f0(v) log f0(v)dv < ∞ .
ZRN
Z (cid:0)1, v,|v|2(cid:1)ft(v)dv =Z (cid:0)1, v,|v|2(cid:1)f0(v)dv ∀t ≥ 0 .

A GRADIENT FLOW APPROACH TO THE BOLTZMANN EQUATION

5

We denote by P(RN ) the space of Borel probability measures on RN . More-
over, we denote by P∗(RN ) the set of probability measures satisfying

Z vdµ(v) = 0 ,

Z |v|2dµ(v) = 1 .

If µ has a density f w.r.t. the Lebesgue measure L on RN we write also
f ∈ P∗(RN ). Theorem 2.2 asserts in particular, that ft ∈ P∗(RN ) for all t
provided f0 ∈ P∗(RN ).
We denote by H(µ) the Boltzmann–Shannon entropy deﬁned for µ ∈ P(RN )
by

H(µ) =Z f (v) log f (v)dv ,

provided µ = fL is absolutely continuous and max(f log f, 0) is integrable,
otherwise H(µ) = +∞.
Let M denote the standard Maxwellian distribution in RN , i.e.

M (v) =

1

(2π)N/2

exp(cid:18)−|v|2
2 (cid:19) .

The relative entropy w.r.t. M of a probability measure µ = gML is deﬁned
by

H(µ|M ) =Z g(v) log g(v)M (v)dv .

By Jensen’s inequality we have H(·|M ) ≥ 0. Thus for any µ ∈ P∗(RN ) we
obtain the bound

H(µ) = H(µ|M ) −

1

2Z |v|2µ(dv) −

N
2

log(2π) ≥ −

1
2 −

N
2

log(2π) .

(2.2)

The ﬁrst identity also shows that H is lower semicontinuous on P∗(RN )
w.r.t. weak convergence, i.e. in duality with bounded continuous functions.
This follows from the corresponding property of H(·|M ).
Boltzmann’s H-theorem asserts that the entropy is non-increasing along the
solution ft of the Boltzmann equation. More precisely, in the setting of
Theorem 2.2 we have (see [2]):

d
dtH(ft) = −D(ft) ≤ 0 ,

f ′f ′
∗

f f∗(cid:2)f ′f ′

(2.3)

(2.4)

where

D(f ) :=ZR2NZSN −1

log

∗ − f f∗(cid:3)B(v − v∗, ω)dvdv∗dω .

The quantity D(f ) is called the entropy dissipation. More generally, we
deﬁne the entropy dissipation D(µ) for a probability measure µ by setting
D(µ) = D(f ), provided µ = fL is absolutely continuous and +∞ otherwise.

6

MATTHIAS ERBAR

2.2. Ornstein–Uhlenbeck regularization. We recall that the (adjoint)
Ornstein–Uhlenbeck semigroup (St)t≥0 can be deﬁned as a rescaled convo-
lution with the standard Maxwellian distribution M . For f ∈ L1(RN ) and
t ≥ 0 we have

Stf = fe−2t ∗ M1−e−2t ,

(2.5)

(2.6)

with the notation gλ(v) = 1
to the Fokker–Planck equation ∂tf = ∇ · (∇f + f v), f0 = f . We note that
for any f ∈ L1, Stf is C ∞ with the Gaussian bound
| log Stf|(v) ≤ Ct(1 + |v|2) ,

λ(cid:17). Recall that ft := Stf is the solution

λN/2 g(cid:16) v

for a suitable constant Ct, see for instance [5].
For ﬁxed ω ∈ SN −1 we will denote by Tω the transformation (v, v∗) 7→ (v′, v′
∗)
with v′, v′
∗ given by (1.3). Note that Tω is involutive and has unit Jacobian
determinant. We will set

X = (v, v∗), X ′ = (v′, v′

∗) = TωX .

(2.7)

By abuse of notation we denote the standard Maxwellian distribution and
the Ornstein–Uhlenbeck semigroup in R2N again by M and St. Note that
M (X) := M (v)M (v∗). For a function F : RN × RN → R we will set

TωF (X) := F (TωX) .

(2.8)

It is readily checked that the operations of scaling, convolution and the semi-
group St behave well under tensorization. More precisely, if for a function
f : RN → R we set F = f ⊗ f , i.e. F (X) = f f∗, then we have
Fλ = fλ ⊗ fλ , F ∗ Mδ = (f ∗ Mδ) ⊗ (f ∗ Mδ) , StF = (Stf ) ⊗ (Stf ) . (2.9)
The following commutation relation with the pre-post-collision change of
variables will be crucial in the sequel. It can be found in [11, Prop. 4]. For
the reader’s convenience we will give the short proof.
Lemma 2.3. Let F : R2N → R. Then, we have that for each ω ∈ SN −1
and any λ, δ > 0:

(TωF )λ = Tω(Fλ) ,

(TωF ) ∗ Mδ = Tω(F ∗ Mδ) .

(2.10)

In particular, for each t ≥ 0 we have that:

St(TωF ) = Tω(StF ) .

(2.11)

If F = f f∗ we have for short St(f ′f ′

∗) = (Stf )′(Stf )′
∗.

Proof. Since StF can be written as a composition of scaling of F and a
convolution with (a scaling of) M , the commutation (2.11) is a direct con-
sequence of (2.10). Commutation of Tω with the scaling operation is readily
checked. It remains to check commutation with convolution. First note that
Mδ(TωX) = Mδ(X), since the relation between pre- and post-collisional ve-
∗|2. Using also the fact that Tω is
locities is such that |v|2 + |v∗|2 = |v′|2 + |v′

A GRADIENT FLOW APPROACH TO THE BOLTZMANN EQUATION

7

involutive with unit determinant, we ﬁnd

(TωF ) ∗ Mδ(X) = ZR2N
= ZR2N
= ZR2N

F (TωY )Mδ(X − Y )dY

F (Y )Mδ(X − T −1

ω Y )dY

F (Y )Mδ(TωX − Y )dY

= (F ∗ Mδ)(TωX) .

(cid:3)

It will be important to note that the entropy dissipation is non-increasing
along the Ornstein–Uhlenbeck semigroup for constant collision kernels. In
fact, this property holds more generally for so called Maxwellian kernels,
where B(z, ω) = b(hz, ωi/|z|) for a suitable function b. For convenience we
include the simple proof in the case of constant kernels.
Lemma 2.4. Let B be a constant collision kernel and µ ∈ P(RN ), then for
t > 0 we have D(Stµ) < ∞ and

D(Stµ) ≤ D(µ) .

(2.12)

Proof. Finiteness of D(Stµ) follows immediately from the smoothing prop-
erties of St, more precisely Stµ is absolutely continuous, and Stf has the
Gaussian bound (2.6). To prove (2.12), without restriction, let µ = fL be
absolutely continuous and assume B ≡ 1. It suﬃces to show monotonicity
of D under scaling and convolution with a Maxwellian. The ﬁrst prop-
erty is readily checked. To check the latter property, deﬁne g : R2
+ → R+
by g(a, b) := 1/4(a − b)(log a − log b) and note that g is convex. We set
F (X) = f f∗ and calculate using Lemma 2.3 and Jensen’s inequality:

D(M ∗ f ) =Z g(cid:0)Tω(M ∗ F ), M ∗ F(cid:1)dXdω =Z g(cid:0)M ∗ (TωF ), M ∗ F(cid:1)dXdω

≤Z Z g(cid:0)(TωF )(X − Y ), F (X − Y )(cid:1)M (Y )dY dXdω
=Z g(cid:0)TωF (X), F (X)(cid:1)dXdω = D(f ) .

(cid:3)

2.3. Truncated moment estimate. We will make use of the following
estimate which is in the spirit of the Povzner inequalities. Given R > 0 we
write

ϕR(v) = |v| ∧ R .

Lemma 2.5. There is a constant C such that for all v, v∗ ∈ Rn and σ ∈
Sn−1 and R > 0 we have

(cid:12)(cid:12)ϕR(v′)2 + ϕR(v′

where as usual v′, v′

∗)2 − ϕR(v)2 − ϕR(v∗)2(cid:12)(cid:12) ≤ Ch|v| |v∗| +(cid:12)(cid:12)v′(cid:12)(cid:12)(cid:12)(cid:12)v′

∗ are given by (1.3).

∗(cid:12)(cid:12)i , (2.13)

Case 4: Exactly three points lie in BR(0). Without restriction let v, v∗, v′ ∈

since |v∗| ≥ |v| and |v′
BR(0). We have

∗(cid:12)(cid:12) + |v||v∗| ,

∗| ≥ |v′|.

LHS = (cid:12)(cid:12)(cid:12)(cid:12)(cid:12)v′(cid:12)(cid:12)2 − |v|2(cid:12)(cid:12)(cid:12) ≤ (cid:12)(cid:12)v′(cid:12)(cid:12)(cid:12)(cid:12)v′
LHS = (cid:12)(cid:12)(cid:12)(cid:12)(cid:12)v′(cid:12)(cid:12)2 + R2 − |v|2 − |v∗|2(cid:12)(cid:12)(cid:12) .

8

MATTHIAS ERBAR

Proof. We divide the proof of this into several cases.
Case 1: None of the four points v, v∗, v′, v′

∗ lies in BR(0). Here the LHS of

(2.13) is 0.

Case 2: Exactly one point lies in BR(0). Without restriction let v ∈ BR(0).

Then we have

LHS = R2 − |v|2 ≤ (cid:12)(cid:12)v′(cid:12)(cid:12)(cid:12)(cid:12)v′
∗(cid:12)(cid:12) ,

∗| ≥ R.

since |v′| ,|v′
Case 3: Exactly two points lie in BR(0). Then without restriction we have
either a) v, v∗ ∈ BR(0) or b) v, v′ ∈ BR(0).
In case a) we have
LHS = 2R2 − |v|2 − |v∗|2 and we argue as in case 2. In case b) we
have

We make a further distinction of cases.
a) v′ /∈ BR/2(0) or v, v∗ /∈ BR/2(0). Then |v| |v∗| + |v′||v′
b) v′, v ∈ BR/2(0) and v∗ /∈ BR/2(0). Write v′ = v + n, v′

∗| ≥ R2/4
while LHS ≤ 2R2.
∗ =
v∗ − n with n = v − v′ = (v − v∗)/2 + σ |v − v∗| /2. By energy
conservation we have

LHS = (cid:12)(cid:12)v′

∗(cid:12)(cid:12)2 − R2 ≤ |v∗|2 + 2|v∗| |n| + |n|2 − R2

≤ 2|v∗|(cid:0)|v| +(cid:12)(cid:12)v′(cid:12)(cid:12)(cid:1) + 2|v|2 + 2(cid:12)(cid:12)v′(cid:12)(cid:12)2
≤ 4(cid:0)|v| |v∗| +(cid:12)(cid:12)v′(cid:12)(cid:12)(cid:12)(cid:12)v′
∗(cid:12)(cid:12)(cid:1) ,

since |v| ≤ |v∗| and |v′| ≤ |v′
∗|.
writing v′ = v∗ + m, v′

c) v′, v∗ ∈ BR/2(0) and v /∈ BR/2(0). Here we argue as in b) by
These are all sub-cases of 4, since v, v∗, v′ ∈ BR/2(0) would contradict
v′
∗ /∈ BR(0).
Case 5: All four points are in BR(0). Here again the LHS is 0 by energy
conservation.

∗ = v − m for suitable m.

(cid:3)

2.4. Gradient ﬂows in metric spaces. In this section we brieﬂy recall
the basic theory of gradient ﬂow in metric spaces. For a detailed account
we refer the reader to [1].
Let (X, d) be a complete and separable metric space and let E : X →
(−∞,∞] be a function with proper domain, i.e. the set D(E) := {x : E(x) <
∞} is non-empty.

A GRADIENT FLOW APPROACH TO THE BOLTZMANN EQUATION

9

A curve (xt)t∈(a,b) in (X, d) is called p-absolutely for p ≥ 1 if there exists
m ∈ Lp((a, b)) such that

d(xs, xt) ≤ Z t

s

m(r)dr ∀ a ≤ s ≤ t ≤ b .

(2.14)

In this case we write x ∈ AC P(cid:0)(a, b); (X, d)(cid:1). For p = 1 we simply we drop p

in the notation. Similarly, one deﬁnes locally p-absolutely continuous curves.
For a locally absolutely continuous curve the metric derivative deﬁned by

(cid:12)(cid:12)x′
t(cid:12)(cid:12) := lim

h→0

d(xt+h, xt)

|h|

exists for a.e. t and is the minimal m in (2.14), see [1, Thm.1.1.2].
The following notion plays the role of the modulus of the gradient in a metric
setting.
Deﬁnition 2.6 (Strong upper gradient). A function g : X → [0,∞] is called
g ◦ x is Borel and

a strong upper gradient of E if for any x ∈ AC(cid:0)(a, b); (X, d)(cid:1) the function

|E(xs) − E(xt)| ≤ Z t

s

g(xr)|x′

r|dr ∀ a ≤ s ≤ t ≤ b .

(2.15)

Deﬁnition 2.7 (Curve of maximal slope). A locally 2-absolutely continuous
curve (xt)t∈[0,∞ is called a curve of maximal slope of E w.r.t. its strong upper
gradient g if t 7→ E(xt) is non-increasing and

E(xs) − E(xt) ≥

g(xr)2 + |x′

r|2dr ∀ 0 ≤ s ≤ t .

(2.16)

1

2Z t

s

Note that in the setting of the previous deﬁnition, by the deﬁnition of strong
upper gradient, and Young’s inequality ab ≤ 1
2 (a2 + b2), we have that the
opposite inequality in (2.16) always holds. Thus, we have in fact equality
for a curve of maximal slope.
We ﬁx a strong upper gradient of g of E. We can now deﬁne what we mean
by a gradient ﬂow curve of E (relative to g).

Deﬁnition 2.8 (gradient ﬂow). A locally 2-absolutely continuous curve
(xt)t∈[0,∞) is called an gradient ﬂow of E starting from ¯x ∈ X if it is a
curve of maximal slope w.r.t. the strong upper gradient g and x0 = ¯x. In
other words, it satisﬁes the the Energy Dissipation Equality (for short EDE)

E(xs) − E(xt) =

1

2Z t

s

g(xr)2 + |x′

r|2dr ∀ 0 ≤ s ≤ t .

Finally, we deﬁne the (descending) metric slope of E as the function |∂E| :
D(E) → [0,∞] given by

|∂E|(x) = lim sup

y→x

max(E(x) − E(y), 0)

d(x, y)

.

(2.17)

The metric slope is in general only a weak upper gradient E, see [1, Thm. 1.2.5].
In our application to the homogeneous Boltzmann equation, we will show
that the square root of the dissipation D provides a strong upper gradient
for the entropy H.

10

MATTHIAS ERBAR

3. The collision distance

In this section, we present a new type of distance between probability mea-
sures on RN . It will be constructed by minimizing an action functional over
curves in the space of probability measures.

3.1. The action functional. In this section we introduce an action func-
tional that will be used later to construct a new distance between probability
measures on RN .
First we need to introduce some notation. We let
G = RN × RN × SN −1

and denote by M(G) the space of signed Radon measures on G equipped
with the weak* topology in duality with continuous functions with compact
support in G. Recall that P(RN ) denotes the space of Borel probability
measures on RN equipped with the topology of weak convergence in duality
with bounded continuous functions.
We introduce a function Λ : R+ × R+ → R+ given by
s − t

sαt1−αdα =

(3.1)

,

Λ(s, t) = Z 1

0

log s − log t

the latter expression being valid for positive s 6= t. This is called the log-
arithmic mean of s and t. It will be useful to note that Λ is concave and
positively homogeneous, i.e. Λ(αs, αt) = αΛ(s, t) for all α ≥ 0. Moreover it
is easy to check that

s + t

∀s, t ≥ 0 .
Given a function f : RN → R+ we will often write
Λ(f )(v, v∗, ω) = Λ(f f∗, f ′f ′

Λ(s, t) ≤

2

∗) .

(3.2)

We can now deﬁne a function α : R × R+ × R+ → R+ ∪ {∞} by setting

α(u, s, t) :=

u2

4Λ(s,t) , Λ(s, t) 6= 0 ,
0 ,
+∞ ,

Λ(s, t) = 0 and u = 0 ,
θ(s, t) = 0 and u 6= 0 .

The following observation will be useful.

Lemma 3.1. The function α is lower semicontinuous, convex and positively
homogeneous, i.e.

α(ru, rs, rt) = rα(u, s, t) ∀u ∈ R , s, t ≥ 0 , r ≥ 0 .

Proof. This is easily checked using homogeneity and concavity of Λ and the
convexity of the function (u, y) 7→ u2
(cid:3)
We will now deﬁne an action functional on pairs of measures (µ,U ) where
µ ∈ P(Rd) and U ∈ M(G). To µ we associate two measures in M(G) by
setting:

y on R × (0,∞).

µ1(dv, dv∗, dω) := B(v − v∗, ω)µ(dv)µ(dv∗)dω , µ2 := T#µ1 ,

(3.3)

A GRADIENT FLOW APPROACH TO THE BOLTZMANN EQUATION

11

where T is the change of variables (v, v∗, ω) 7→ (Tω(v, v∗), ω) between pre-
and post-collisional variables deﬁned in (1.3). We can always choose a mea-
sure τ ∈ M(G) such that µi = f iτ, i = 1, 2 and U = U τ are all absolutely
continuous with respect to τ , for instance by taking the sum of the total

variations τ :=(cid:12)(cid:12)µ1(cid:12)(cid:12) +(cid:12)(cid:12)µ2(cid:12)(cid:12) + |U|. We can then deﬁne the action functional

by

A(µ,U ) := Z α(cid:0)U, f 1, f 2(cid:1)dτ .

Note that this deﬁnition is independent of the choice of τ since α is positively
homogeneous. Another way to write the action functional is

A(µ,U ) = Z α(cid:18) dλ1

d|λ|

,

,

dλ2
d|λ|

dλ3

d|λ|(cid:19) d|λ| ,

where λ is the vector valued measure given by λ = (U , µ1, µ2).
If the measure µ is absolutely continuous w.r.t. the Lebesgue measure L on
RN , the next lemma shows that the action takes a more intuitive form. For
this we denote by B ∈ M(G) the measure given by

B(dv, dv∗, dω) = B(v − v∗, ω)dvdv∗dω .

Lemma 3.2. Let µ ∈ P(Rd) be absolutely continuous w.r.t. L with density
f . Further, let U ∈ M(G) be such that A(µ,U ) < ∞. Then there exist a
function U : G → R such that U = U Λ(f )B and we have

A(µ,U ) =

1

4Z |U (v, v∗, ω)|2 Λ(f f∗, f ′f ′

∗)B(dv, dv∗, dω) .

(3.4)

(3.5)

conclude

Proof. Choose λ ∈ M(G) such that B = hλ and U = eU λ are both absolutely
continuous w.r.t. λ. Note that µi = ρiB, i = 1, 2 with ρ1(v, v∗, ω) =
∗). Further, we denote byeρi the density
f (v)f (v∗) and ρ2(v, v∗, ω) = f (v′)f (v′
of µi w.r.t λ. Now by deﬁnition,
Let A ⊂ G be such thatRA θ(ρ1, ρ2)dB = 0. From the homogeneity of Λ we

A(µ,U ) = Z α(cid:0)eU ,eρ1,eρ2(cid:1)dλ < ∞ .
0 = ZA
Λ(eρ1,eρ2)dλ ,

i.e. Λ(eρ1,eρ2) = 0 λ-a.e. on A. Now the ﬁniteness of the integral in (3.5)
implies that eU = 0 λ-a.e. on A. In other words U (A) = 0 and hence U is
absolutely continuous w.r.t. the measure Λ(f )B. Formula (3.4) now follows
immediately from the homogeneity of α.
In view of the previous lemma, given a pair of functions f : RN → R+ and
U : G → R we will deﬁne their action via
A(f, U ) :=Z α(U, f f∗, f ′f ′
with µ = fL, U = Λ(f )eB .

Λ(ρ1, ρ2)dB = ZA

∗)dB = A(µ,U ) ,

Next, we establish lower semicontinuity of the action w.r.t. convergence of
µ and U .

(3.6)

(cid:3)

12

MATTHIAS ERBAR

Lemma 3.3 (Lower semicontinuity of the action). A is lower semicon-
tinuous w.r.t. weak convergence of measures. More precisely, assume that
µn ⇀ µ weakly in P(RN ) and Un ⇀∗ U weakly* in M(G). Then

A(µ,U ) ≤ lim inf

n A(µn,Un) .

Proof. Note that by the Assumption 2.1 on the collision kernel B, the weak
convergence of µn to µ implies the weak* convergence of µi
n to µi in M(G)
for i = 1, 2. Now the claim follows immediately from a general result on
integral functionals, Proposition 3.4.
(cid:3)

Proposition 3.4 ([4, Thm. 3.4.3]). Let Ω be a locally compact Polish space
and let f : Ω × Rd → [0, +∞] be a lower semicontinuous function such that
f (ω,·) is convex and positively 1-homogeneous for every ω ∈ Ω. Then the
functional

F (λ) = ZΩ

f(cid:18)ω,

(ω)(cid:19)|λ| (dω)

dλ
d|λ|

is sequentially weak* lower semicontinuous on the space of vector valued
signed Radon measures M(Ω, Rd).
The next estimate will be crucial for establishing compactness of families of
curves with bounded action in Section 3.2.
Lemma 3.5. For any measurable function Ψ : R2N × SN −1 → R+ and
µ ∈ P(RN ), U ∈ M(G) we have:
Z Ψd|U| ≤ 2A(µ,U )
Proof. Let us write µi = ρiτ, U = U τ for a suitable measure τ . We can
assume that A(µ,U ) < ∞ as otherwise there is nothing to prove. Hence,
the set A = {(v, v∗, ω) | α(U, ρ1, ρ2) = ∞} has zero measure with respect to
τ . We can now estimate:

2(cid:18)1
2Z (Ψ2 + Ψ2 ◦ T )(v, v∗, ω)B(v − v∗, ω)dωdµ(v)dµ(v∗)(cid:19) 1

1

2

.

ΨpΛ(ρ1, ρ2)pα(w, ρ1, ρ2)dτ

Z Ψd|U| ≤ Z Ψ|U| dτ = 2ZAc
≤ 2(cid:18)Z α(w, ρ1, ρ2)dτ(cid:19) 1

1

2(cid:18)Z Ψ2Λ(ρ1, ρ2)dτ(cid:19) 1

2

≤ 2A(µ,U )
The last inequality follows from the estimate (3.2):

2(cid:18) 1
2Z (Ψ2 + Ψ2 ◦ T )(v, v∗, ω)B(v − v∗, ω)dωdµ(v)dµ(v∗)(cid:19) 1
Z Ψ2Λ(ρ1, ρ2)dτ ≤ Z Ψ2 1
2Z hΨ(v, v∗, ω)2 + Ψ(cid:0)T (v, v∗, ω)(cid:1)2iB(v, v∗, ω)dωdµ(v)dµ(v∗)

(ρ1 + ρ2)dτ

=

1

2

2

.

(cid:3)

A GRADIENT FLOW APPROACH TO THE BOLTZMANN EQUATION

13

For the collision kernel which is constant, i.e.
B(k, ω) ≡ const ,

the action functional enjoys useful monotonicity properties under convolu-
tion with Maxwellian distributions and the action of the Ornstein–Uhlenbeck
semigroup.
Given µ ∈ P(RN ), we deﬁne its convolution with the Maxwellian M as
usual as the measure µ ∗ M ∈ P(RN ) given by

(µ ∗ M )(dv) =ZRN

M (v − w)µ(dw)dv .

(3.7)

The action of the Ornstein–Uhlenbeck semigroup is then given by Stµ =
µe−2t ∗ M1−e−2t , where µλ is the image of µ under the map v 7→ λv. Of
course, if µ = fL, we have that µλ = fλL as well as µ ∗ M = (f ∗ M )L and
Stµ = (Stf )L.
Given U ∈ M(R2N × SN −1) we deﬁne its convolution U ∗ M with the
Maxwellian M in R2N as the measure given by

(U ∗ M )(dX, dω) =ZR2N

M (X − Y )U (dY, dω)dX .

(3.8)

The action of the semigroup St is deﬁned via StU = Ue−2t∗M1−e−2t , where Uλ
is the image of U under the map (X, ω) 7→ (λX, ω). Again, if U (dX, dω) =
U (X, ω)dXdω for a suitable function U , then Uλ, U ∗ M and StU have
densities Uλ, U ∗ M and StU respectively, where the operations on U are
deﬁned as above, considering U for ﬁxed ω as a function on R2N .
Lemma 3.6. Assume that B is constant. Then we have for all t ≥ 0:

A(Stµ, StU ) ≤ A(µ,U ) .

(3.9)
Proof. Without restriction we can assume that B ≡ 1 and that A(µ,U ) is
ﬁnite. It is suﬃcient to check monotonicity of the action under scaling and
convolution with M . Let us ﬁrst give the proof in the case where µ = fL
is absolutely continuous since the argument is more transparent there. By
Lemma 3.2 we can assume that U (dX, dω) = U (X, ω)Λ(F (X), F (Tω X))dXdω
for a suitable function U , where we put F (X) = f f∗. Then the action takes
the form

A(µ,U ) = A(f, U ) =Z α(U, F, TωF )dXdω .

By the homogeneity of α, it is readily checked that A(fλ, Uλ) = A(f, U ). To
check monotonicity under convolution, we use (2.10) as well as the convexity
of α and Jensen’s inequality:

A(µ ∗ M,U ∗ M ) =Z α (U ∗ M, F ∗ M, Tω(F ∗ M ))
=Z α (U ∗ M, F ∗ M, (TωF ) ∗ M )
≤Z Z α (U (X − Y, ω), F (X − Y ), TωF (X − Y )) M (Y )dY dXdω
=Z Z α (U (X, ω), F (X), Tω F (X)) dXdω .

14

MATTHIAS ERBAR

Let us now consider the general case, where µ is not necessarily absolutely
continuous. First, note that (µλ)i = (µi)λ for i = 1, 2. From this it is easy to
check that A(µλ,Uλ) = A(µ,U ). To show monotonicity under convolution,
one ﬁrst checks that (µ∗M )i = (µi)∗M for i = 1, 2. Introduce the maps τX :
(Y, ω) 7→ (Y + X, ω) and deﬁne for a measure ν ∈ M(R2N × SN −1) the push
forward νX := (τX)#ν. With this notation we have ν ∗ M =R νY M (Y )dY .
Considering A(µ,U ) = eA(µ1, µ2,U ) as a function of the measures µ1, µ2,U ,
the convexity of α implies that eA is jointly convex w.r.t. linear interpolation.
This together with the lower semicontinuity of eA given by Prop. 3.4 yields

that

A(µ ∗ M,U ∗ M ) = eA((µ1) ∗ M, (µ2) ∗ M,U ∗ M )

Y , µ2

Y ,UY )M (Y )dY

≤Z eA(µ1
=Z A(µY ,UY )M (Y )dY .

To ﬁnish it suﬃces to check that A(µY ,UY ) = A(µ,U ) holds for all Y . We
omit the details.

(cid:3)

3.2. The collision rate equation. In this section we will consider an ana-
logue of the continuity equation for a curve of measures on RN . Instead of
being driven by a vector ﬁeld, the evolution will be governed by measures U
that prescribe the rate at which collisions happen between the particles.
More precisely, we introduce the collision rate equation
on (0, T ) × RN .

(3.10)
Here (µt)t∈[0,T ] and (Ut)t∈[0,T ] are Borel families of measures in M+(RN )
and M(G) respectively such that

∂tµt + ¯∇ · Ut = 0

|Ut| (G)dt < ∞ .

µt(RN )dt < ∞ ,

Z T
Z T
We suppose that (3.10) holds in the sense of distributions. More precisely,
c ((0, T ) × RN ) :
we require that for all ϕ ∈ C ∞
Z T
0 Z ∂tϕ(v)µt(dv)dt +
4Z T
0 Z ¯∇ϕ(v, v∗, ω)dUt(v, v∗, ω)dt = 0 , (3.13)
with the notation ¯∇ϕ = ϕ(v′) + ϕ(v′
∗) − ϕ(v) − ϕ(v∗). Note that the inte-
grability condition (3.12) ensures that the second term is well-deﬁned. The
measures Ut will be called collision rates.
The following is an adaptation of [1, Lemma 8.1.2].

(3.11)

(3.12)

1

0

0

Lemma 3.7. Let (µt)t∈[0,T ] and (Ut)t∈[0,T ] be Borel families of measures in
M+(RN ) and M(G) satisfying (3.10) and (3.11), (3.12). Then there exists
a unique weakly* continuous curve (eµt)t∈[0,T ] such that eµt = µt for a.e.
c ([0, T ]× RN ) and all 0 ≤ t0 ≤ t1 ≤ T
t ∈ [0, T ]. Moreover, for every ϕ ∈ C ∞

A GRADIENT FLOW APPROACH TO THE BOLTZMANN EQUATION

15

we have :

Z ϕt1 deµt1 −Z ϕt0deµt0 = Z t1

Proof. Let us set

t0 Z ∂tϕdµtdt +

1

t0 Z ¯∇ϕdUtdt . (3.14)
4Z t1

V (t) := |Ut| (G) .

By assumption the function t 7→ V (t) belongs to L1(0, T ). Fix ξ ∈ C ∞
Using test functions of the form ϕ(t, x) = η(t)ξ(x) with η ∈ C ∞
(3.13), one can show that the map t 7→ µt(ξ) :=R ξdµt belongs to W 1,1(0, T ).
More precisely, the distributional derivative of µt(ξ) is given by

c (RN ).
c (0, T ) in

1

˙µt(ξ) =

4Z ¯∇ξdUt
4Z (cid:12)(cid:12) ¯∇ξ(cid:12)(cid:12) d|Ut| ≤

1

for a.e. t ∈ (0, T ) and we can estimate

| ˙µt(ξ)| ≤

1
4 kξk∞ A(t) .

(3.15)

Based on (3.15) we can argue as in [1, Lemma 8.1.2] to obtain existence of

a weakly* continuous representative t 7→eµt and the validity of (3.14). (cid:3)
Now, we show that the collision rate equation conserves mass and under
additional assumptions on the collision rates also momentum and energy.
Let us deﬁne the momentum m(µ) and the energy E(µ) of a measure µ ∈
M+(RN ) via

m(µ) :=ZRN

vdµ(v) , E(µ) :=ZRN |v|2 dµ(v) .

Lemma 3.8. Let (µt)t∈[0,T ] and (Ut)t∈[0,T ] be Borel families of measures in
M+(RN ) and M(G) satisfying (3.10) and (3.11), (3.12) and assume that
(µt) is weakly* continuous. Then we have

Assume moreover that the following stronger integrability condition holds.

µt(RN ) = µ0(RN ) ∀t ∈ [0, T ] .

Z T
0 Z (cid:0)|v| |v∗| +(cid:12)(cid:12)v′(cid:12)(cid:12)(cid:12)(cid:12)v′

∗(cid:12)(cid:12)(cid:1)dUt(v, v∗, ω)dt < ∞ .

m(µt) = m(µ0) , E(µt) = E(µ0) ∀t ∈ [0, T ] .

(3.16)

(3.17)

(3.18)

Then we have

1

c (RN ) and any t ∈ [0, 1]:

Proof. From Lemma 3.7 we have that (3.14) holds and we infer that for any
ξ ∈ C ∞

Z ξdµt = Z ξdµ0 +
4Z t
0 Z ¯∇ξdUsds .
c (RN ) with 0 ≤ ξ ≤ 1, ξ = 1 on
For R > 0 we choose functions ξR ∈ C ∞
BR and kξkC 1 ≤ 1. Since ¯∇ξR → 0 pointwise, we infer from the bound
(cid:12)(cid:12) ¯∇ξR(cid:12)(cid:12) ≤ 1and the integrability assumption (3.12) that
(cid:12)(cid:12)(cid:12)(cid:12)Z t
0 Z ¯∇ξRdUsds(cid:12)(cid:12)(cid:12)(cid:12) → 0 .

(3.19)

16

MATTHIAS ERBAR

1

Since µs(ξR) converges to µs(RN ), this together with (3.19) implies that
µt(RN ) = µ0(RN ). Let us now show conservation of energy. Consider the
compactly supported function ϕR(v) = (|v|∧ R)2 − R2. After a molliﬁcation
argument we obtain from (3.19) that

(3.20)

integrability assumption (3.17) we obtain

Z ϕRdµt = Z ϕRdµ0 +

The diﬀerence of the ﬁrst two terms converges to E(µt)− E(µ0) as R → ∞.
Indeed,
Thus it suﬃce to show that the last term vanishes in the limit.

4Z t
0 Z ¯∇ϕRdUsds .
from the estimate (cid:12)(cid:12) ¯∇ϕR(cid:12)(cid:12) ≤ C(cid:0)|v||v∗| + |v′| |v′
∗|(cid:1) from Lemma 2.5 and the
(cid:12)(cid:12)(cid:12)(cid:12)Z t
0 Z ¯∇ϕRdUsds(cid:12)(cid:12)(cid:12)(cid:12) → 0 .

Conservation of momentum follows by a similar argument.
Remark 3.9. In the situation of Lemma 3.7, if we require µt ∈ P(RN ) for
all t, then following the argument in [1, Lemma 8.1.2] shows that the unique
continuous representative (eµt)t is even continuous w.r.t. weak convergence.

In view of the previous results it makes sense to deﬁne solutions to the
continuity equation in the following way.
Deﬁnition 3.10 (Collision rate equation). We denote by CRE T the set of
all pairs (µ,U ) satisfying the following conditions:

(cid:3)

(i)
(ii)

µ : [0, T ] → P(RN ) is weakly continuous ;
(Ut)t∈[0,T ] is a Borel family of measures in M(G) ;
0 |Ut| (G)dt < ∞ ;
∂tµt + ¯∇ · Ut = 0 .

(iv) We have in the sense of distributions:

(iii) R T

(3.21)



Moreover, we will denote by CRE T (¯µ0, ¯µ1) the set of pairs (µ, ν) ∈ CRE T
satisfying in addition: µ0 = ¯µ0, µ1 = ¯µ1.

Remark 3.11. The continuity equation can also be tested against more gen-
eral test functions. For instance, let (µ,U ) ∈ CRE 1 and let ϕ : RN → R be
bounded and continuous. Approximating ϕ with functions in C ∞
c (RN ) that
are uniformly bounded and using the integrability assumption (iii) in (3.21)
to pass to the limit in (3.14) we obtain

Z ϕdµ1 −Z ϕdµ0 =

1

4Z 1
0 Z ¯∇ϕdUtdt .

A similar reasoning will often be used later on.

In view of Lemma 3.8 it makes sense to consider a stronger notion of collision
rate equation imposing the conservation of momentum and energy.
Deﬁnition 3.12 (Collision rate equation with moments). For m ∈ RN and
E > 0 we denote by CRE m,E
the set of of pairs (µ,U ) satisfying (i),(ii) and
(iv) of Deﬁnition 3.10 as well as
0 R(cid:0)|v||v∗| + |v′||v′
R vdµt(v) = m ,

∗|(cid:1)d|Ut| (v, v∗, ω)dt < ∞ ;
R |v|2dµt(v) = E ∀t ∈ [0, T ] .

(cid:26) (iii′) R T

(3.22)

(v)

T

A GRADIENT FLOW APPROACH TO THE BOLTZMANN EQUATION

17

T as a short hand for the class CRE 0,1
T .

We write CRE ∗
We note that being a solution to the collision rate equation is invariant under
the action of the Ornstein–Uhlenbeck semigroup. Recall the deﬁnition of the
action of St on µ ∈ P(RN ) and U ∈ M(G) deﬁned in the previous section.
Lemma 3.13. Let (µ,U ) ∈ CRE T and set µt
s := StUs for t ≥ 0
and s ∈ [0, T ]. Then we have (µt,U t) ∈ CRE T . The same holds, when
CRE T is replaced with CRE m,E
Proof. Again it suﬃces to check that being a solution to the collision rate
equation is stable under scaling and convolution with M . Using the weak
formulation (3.13) one readily checks that (µλ,Uλ) ∈ CRE T for all λ ≥ 0.
To check stability under convolution ﬁx a test function ϕ and set Φ(X) :=
ϕ(v) + ϕ(v∗). Then, using (2.10), we ﬁnd
d

s := Stµs, U t

T

.

d

dtZ (ϕ ∗ M )dµt =Z ¯∇(ϕ ∗ M )dUt
=Z (Φ ∗ M )(TωX) − (Φ ∗ M )(X)dUt(X, ω)
=Z ((TωΦ) ∗ M )(X) − (Φ ∗ M )(X)dUt(X, ω)
=Z Φ(TωX) − Φ(X)d(Ut ∗ M )(X, ω) =Z ¯∇ϕd(Ut ∗ M ) ,

dtZ ϕd(µt ∗ M ) =

which shows that (µ∗ M,U ∗ M ) ∈ CRE T . The corresponding statement for
CRE m,E
follows in the same way, noting that St preserves momentum and
energy.
(cid:3)

T

The following result will allow us to extract subsequential limits from se-
quences of solutions to the continuity equation which have bounded action.

Proposition 3.14 (Compactness of solutions with bounded action). In ad-
dition to Assumption 2.1, assume that

(3.23)

(3.24)

sup

k ZA

B(k, ω)dω → 0 when |A| → 0 .

Let (µn,U n) be a sequence in CRE T such that (µn
t )dt < ∞ .

n Z T
0 A(µn

t ,U n

sup

0 )n is tight and

Then there exists a couple (µ,U ) ∈ CRE T such that up to extraction of a
subsequence

Moreover, along this subsequence we have :

t ⇀ µt weakly in P(RN ) for all t ∈ [0, T ] ,
µn
U n ⇀∗ U weakly* in M(G × [0, T ]) .
Z T

Z T
0 A(µn

0 A(µt,Ut)dt ≤ lim inf

t )dt .
Finally, if we assume in addition that (µn,U n) ∈ CRE m,E
|v|2 is uniformly integrable w.r.t. µn

t ,U n

n

and that v 7→
0 , then the conclusion holds also without

T

18

MATTHIAS ERBAR

.

T

the assumption (3.23) and we have that the subsequential limit pair (µ,U )
belongs to CRE m,E
Proof. Deﬁne the measure U n ∈ M(G × (0, T )) given by dU n(X, ω, t) =
U n
t (dX, dω)dt. By Lemma 3.5 and (3.24), we obtain that for every measur-
able function Ψ on R2N × SN −1 × [0, T ] that is symmetric under the change
of variables T we have

sup

n Z Ψd|U n|
√A sup

≤

n (cid:18)Z Ψ(X, ω, t)2B(v − v∗, ω)dωdµn

t (v)dµn

2

t (v∗)dt(cid:19) 1

(3.25)

,

(3.26)

c (RN ). We claim that

t dt n→∞−→ Z t1

t0 Z ¯∇ξdUtdt .

where A denotes the supremum in (3.24). Choosing Ψ as indicator functions
of sets G × I and using Assumption 2.1, we obtain that U n has uniformly
bounded total variation and more precisely we have |U n| (G × I) ≤ CBA ·
Leb(B). Hence, we can extract a subsequence (still indexed by n) such that
U n ⇀∗ U in M(G × [0, T ]). Moreover, the same argument shows that U
can be disintegrated w.r.t. Lebesgue measure on [0, T ] and we can write
U =R T
0 Utdt for a Borel family (Ut). Applying (3.25) with Ψ ≡ 1 shows that
Ut still satisﬁes (3.12).
Let 0 ≤ t0 ≤ t1 ≤ T and ξ ∈ C ∞
t0 Z ¯∇ξdU n
Z t1
¯∇ξ is not continuous and not compactly supported in G×
Note, that 1(t0,t1)
[0, T ]. Thus, we argue by approximation. The convergence (3.26) holds if
¯∇ξ by the continuous and compactly supported function
we replace 1(t0,t1)
¯∇ξ(v, v∗, ω) where ζR is any continuous compactly
ζR(t)ϕR(v, v∗) · 1(t0,t1)
supported function such that 0 ≤ ζR ≤ 1 and ζR = 1 on [t0 + R−1, t1 − R−1]
and ϕR is a continuous compactly supported function such that 0 ≤ ϕR ≤ 1
and ϕR = 1 on BR ⊂ R2N . We ﬁnd
(cid:12)(cid:12)(cid:12)(cid:12)Z t1
t0 Z (1 − ζRϕR) ¯∇ξdU n
R × SN −1 and S2
where S1
R2N × SN −1. The integral over S2
taking into account Assumption 2.1 by

t dt(cid:12)(cid:12)(cid:12)(cid:12) ≤ ZS 1
R =(cid:0)[t0, t1] \ [t0 + R−1, t1 − R−1](cid:1) ×
t (v∗)dt

√AZS 2

R

kξk∞ |U n| (S2

R) ≤ kξk∞

≤ kξk∞

√ACB

2
R

.

R can be estimated arguing as before and

B(v − v∗, ω)dωdµn

R = [t0, t1] × Bc

| ¯∇ξ|d|U n| ,

t (v)dµn

1

2

,

R∪S 2
R

which vanishes as R → ∞. To estimate the integral over S1
R, let WR denote
R with ¯∇ξ(v, v∗, ω) 6= 0.
the set of ω ∈ SN −1 such that there exist (v, v∗) ∈ Bc
Note that since ξ is compactly supported, the measure of WR goes to zero

A GRADIENT FLOW APPROACH TO THE BOLTZMANN EQUATION

19

as R → ∞. We obtain a bound

ZS 1

R

| ¯∇ξ|d|U n| ≤ kξk∞ |U n|([t0, t1] × Bc

R × WR)

≤ kξk∞

≤ kξk∞

√A(cid:18)Z t1
t0 ZR2NZWR
√A√t1 − t0(cid:18)sup
z ZWR

B(v − v∗, ω)dωdµn
B(z, ω)dω(cid:19) 1

.

2

t (v)dµn

2

t (v∗)dt(cid:19) 1

By (3.23) the last expression goes to zero as R → ∞.
After extraction of another subsequence we can assume µn
0 ⇀ µ0 weakly for
some µ0 ∈ P(RN ). Using this, the convergence (3.26) and the collision rate
equation in the form (3.14) for the choice ϕ(t, v) = ξ(v) and t0 = 0, t1 = t
we infer that µn
t converges weakly* to some ﬁnite non-negative measure
µt ∈ M+(RN ) for every t ∈ [0, T ]. From Lemma 3.8 we infer that µt is a
probability measure for all t ∈ [0, T ]. It is now easily checked that the couple
(µ,U ) belongs to CRE T . As in Lemma 3.3 the lower semicontinuity follows
from Proposition 3.4 by consideringR T
0 A(µt,Ut)dt as an integral functional
on the space M(G × [0, T ]).
Finally, let us assume that (µn,U n) ∈ CRE E
T and v 7→ |v|2 is uniformly
integrable w.r.t. µn
E(µ0) =Z |v|2dµ0(v) = lim

n Z |v|2dµn

0 . The latter implies that

0 (v) = E .

Similarly, m(µ0) = limn m(µn
by arguing as before, exept that we estimate the integral over S1

0 ) = m. Existence of a limit curve is obtained

R by

B(v − v∗, ω)dωdµn

t (v)dµn

2

t (v∗)dt! 1

ZS 1

R

| ¯∇ξ|d|U n| ≤ kξk∞ |U n|([t0, t1] × Bc

R × SN −1)

√A Z t1
t0 ZBc
√A√t1 − t0CB

≤ kξk∞

≤ kξk∞

RZSN −1
√E
R
t ({|v| ≥ R}) ≤R |v|2

,

R2 dµn

where we have used that µn
t (v) = E/R2.
We use once more (3.25), this time with Ψ = (|v||v∗| + |v′||v′
∗|). Since µn
t
has constant second moment E and thus uniformly bounded ﬁrst moment
0 R (|v||v∗| +
we deduce, taking into account Assumption 2.1, that supnR T
|v′||v′
∗|)dUt(v, v∗, ω)dt < ∞. By lower semicontinuity of moments we have
that the limit U satisﬁes (iii′) of Deﬁnition 3.12. Using Lemma 3.8, we
conclude that m(µt) = m(µ0) = m and E(µt) = E(µ0) = E for all t ∈ [0, T ].
Thus, (µ,U ) ∈ CRE m,E

(cid:3)

T

.

3.3. Construction and properties of the collision distance. In this
section we deﬁne the distance WB on P∗(RN ). We will establish various
properties, in particular existence of geodesics. Moreover, we will charac-
terize absolutely continuous curves in the metric space (P∗(RN ),WB).

20

MATTHIAS ERBAR

Deﬁnition 3.15. For µ0, µ1 ∈ P∗(RN ) we deﬁne
WB(µ0, µ1)2 := inf(cid:26)Z 1

0 A(µt,Ut)dt :

(µ,U ) ∈ CRE ∗

1(µ0, µ1)(cid:27) . (3.27)

Remark 3.16. In the same way one could construct a (smaller) distance on
full space P(RN ) by dropping the moments conditions and minimizing over
(µ,U ) ∈ CRE 1 instead of CRE ∗
1. We will not consider this possibility here.
Let us give an equivalent characterization of the inﬁmum in (3.27).
Lemma 3.17. For any T > 0 and µ0, µ1 ∈ P∗(RN ) we have :
WB(µ0, µ1) = inf(cid:26)Z T
(µ,U ) ∈ CRE ∗

T (µ0, µ1)(cid:27) .

0 pA(µt,Ut)dt :

(3.28)

Proof. This follows from a standard reparametrization argument. See [1,
Lem. 1.1.4] or [6, Thm. 5.4] for details in similar situations.
(cid:3)

The next result shows that the inﬁmum in the deﬁnition above is in fact a
minimum.
Proposition 3.18. Let µ0, µ1 ∈ P∗(RN ) be such that W := WB(µ0, µ1) is
ﬁnite. Then the inﬁmum in (3.27) is attained by a curve (µ,U ) ∈ CRE ∗
1(µ0, µ1)
satisfying A(µt,Ut) = W 2 for a.e. t ∈ [0, 1].
Proof. Existence of a minimizing curve (µ,U ) ∈ CRE ∗
1(µ0, µ1) follows imme-
diately by the direct method taking into account Proposition 3.14. Invoking
Lemma 3.17 and Jensen’s inequality we see that this curve satisﬁes

2

(cid:3)

0 A(µt,Ut)dt(cid:19) 1

0 pA(µt,Ut)dt .

0 pA(µt,Ut)dt ≥ W = (cid:18)Z 1
≥ Z 1
Z 1
Hence we must have A(µt,Ut) = W 2 for a.e. t ∈ [0, T ].
We have the following properties of the function WB.
Theorem 3.19. WB deﬁnes a (pseudo-) metric on P∗(RN ). The topology
it induces is stronger than the weak topology and bounded sets w.r.t. WB
are weakly compact. Moreover, the map (µ0, µ1) 7→ WB(µ0, µ1) is lower
semicontinuous w.r.t. weak convergence. For each τ ∈ P∗(RN ) the set
Pτ := {µ ∈ P∗(RN ) : WB(µ, τ ) < ∞} equipped with the distance WB is
a complete geodesic space.
Proof. Symmetry of WB is obvious from the fact that α(w,·,·) = α(−w,·,·).
Equation (3.14) from Lemma 3.7 shows that two curves in CRE ∗
1 can be
concatenated to obtain a curve in CRE ∗
2. Hence the triangle inequality
follows easily using Lemma 3.17. To see that WB(µ0, µ1) > 0 whenever
µ0 6= µ1 assume that WB(µ0, µ1) = 0 and choose a minimizing curve (µ,U ) ∈
CRE ∗
1(µ0, µ1). Then we must have A(µt,Ut) = 0 and hence Ut = 0 for a.e.
t ∈ (0, 1). From the continuity equation in the form (3.14) we infer µ0 = µ1.
The compactness assertion and lower semicontinuity of WB follow immedi-
ately from Proposition 3.14. These in turn imply that the topology induced
by WB is stronger than the weak one.

A GRADIENT FLOW APPROACH TO THE BOLTZMANN EQUATION

21

Let us now ﬁx τ ∈ P∗(RN ) and let µ0, µ1 ∈ Pτ . By the triangle inequality
we have WB(µ0, µ1) < ∞ and hence Proposition 3.18 yields existence of
a minimizing curve (µ,U ) ∈ CRE ∗
1(µ0, µ1). The curve t 7→ µt is then a
constant speed geodesic in Pτ since it satisﬁes

WB(µs, µt) =

tZs pA(µr,Ur)dr = (t − s)WB(µ0, µ1) ∀0 ≤ s ≤ t ≤ 1 .

To show completeness let (µn)n be a Cauchy sequence in Pτ .
In partic-
ular the sequence is bounded w.r.t. WB and we can ﬁnd a subsequence
(still indexed by n) and µ∞ ∈ P∗(RN ) such that µn ⇀ µ∞ weakly.
In-
voking lower semicontinuity of WB and the Cauchy condition we infer that
WB(µn, µ∞) → 0 as n → ∞ and that µ∞ ∈ Pτ .
It is yet unclear when precisely the distance WB is ﬁnite. However, we will
see in the next section that the distance is ﬁnite for instance along solution
to the Boltzmann equation. The following result shows that the distance
WB can be bounded from below by the L1-Wasserstein distance. Recall that
the L1-Wasserstein distance is deﬁned for µ0, µ1 ∈ P(RN ) by

(cid:3)

W1(µ0, µ1) := inf

π Z |x − y|π(dx, dy) ,

where the inﬁmum is taken over all probability measures π ∈ P(RN × RN )
whose ﬁrst and second marginal are µ0 and µ1 respectively.
Proposition 3.20. For any µ0, µ1 ∈ P(RN ) we have the bound

W1(µ0, µ1) ≤ r CB

2 WB(µ0, µ1) .

Proof. We can assume that WB(µ0, µ1) < ∞. Take a minimizing curve
(µ, ν) ∈ CRE ∗
1(µ0, µ1) and let ϕ : RN → R be a bounded 1-Lipschitz func-
tion. This implies that | ¯∇ϕ| ≤ |v − v∗|. Taking into account Remark 3.11
and using Lemma 3.5, we estimate

1

1

=

(cid:12)(cid:12)(cid:12)(cid:12)Z ϕdµ1 −Z ϕdµ0(cid:12)(cid:12)(cid:12)(cid:12)
4(cid:12)(cid:12)(cid:12)(cid:12)Z 1
0 Z ¯∇ϕdUtdt(cid:12)(cid:12)(cid:12)(cid:12)
4Z 1
0 Z |v − v∗|d|Ut| (v, v∗, ω)dt
0 A(µt,Ut)dt(cid:19) 1
2(cid:18)Z 1
≤ r CB

2 WB(µ0, µ1) .

≤

≤

1

2(cid:18)Z 1

0 Z |v − v∗|2B(v − v∗, ω)µt(dv)µt(dv∗)dt(cid:19) 1

2

Here we have also used (2.1) and the fact that µt has unit variance in the
last inequality. Taking the supremum over all bounded 1-Lipschitz functions
ϕ yields the claim by Kantorovich–Rubinstein duality (see [12, Thm. 5.10,
5.16]).
(cid:3)

22

MATTHIAS ERBAR

We now give a characterization of absolutely continuous curves with respect
to WB.
Proposition 3.21 (Metric velocity). A curve (µt)t∈[0,T ] is absolutely contin-
uous with respect to WB if and only if there exists a Borel family (Ut)t∈[0,T ]
such that (µ,U ) ∈ CRE ∗

Z T
0 pA(µt,Ut)dt < ∞ .
t|2 ≤ A(µt,Ut) for a.e.
In this case, the metric derivative is bounded as |µ′
t ∈ [0, T ]. Moreover, there exists a unique Borel family eUt with (µ,eU ) ∈
CRE ∗

T such that

T and

for a.e. t ∈ [0, T ] .

(3.29)

Proof. The proof follows from the very same arguments as in [6, Thm. 5.17].
(cid:3)

(cid:12)(cid:12)µ′
t(cid:12)(cid:12)2 = A(µt,eUt)

1

4ZG

We can describe the optimal velocity measures eUt appearing in the preceding

proposition in more detail. We deﬁne Tµ to be the set of all U ∈ M(G) such
that A(µ,U ) < ∞ and A(µ,U ) ≤ A(µ,U + η) for all η ∈ M(G) satisfying

c (G) .

∀ξ ∈ C ∞

¯∇ξdη = 0
Corollary 3.22. Let (µ,U ) ∈ CRE ∗
T such that the curve t 7→ µt is absolutely
continuous w.r.t. WB. Then U satisﬁes (3.29) if and only if Ut ∈ Tµt for
a.e. t ∈ [0, T ].
If µ is absolutely continuous with respect to Lebesgue measure L we can
give an explicit description of Tµ.
Proposition 3.23. Let µ = f m ∈ P∗(RN ). Then we have U ∈ Tµ if and
only if U = U Λ(f )eB is absolutely continuous w.r.t. the measure Λ(f )B and

L2(Λ(f )B)

=: Tf .

U ∈ { ¯∇ϕ | ϕ ∈ C ∞

c (RN )}

Proof. If A(µ,U ) is ﬁnite we infer from Lemma 3.2 that U = U Λ(f )B for
some density U : G → R and that A(µ,U ) = kUk2
L2(Λ(f )B). Now the opti-
mality condition in the deﬁnition of Tµ is equivalent to

kUkL2(Λ(f )B) ≤ kU + V kL2(Λ(f )B)

∀V ∈ Nf ,

where Nf := {V ∈ L2(Y )
c (RN )}. This
implies the assertion of the proposition after noting that Nf is the orthogonal
complement in L2 of Tf .
(cid:3)

R ¯∇ξV Λ(f )B = 0 ∀ξ ∈ C ∞

:

In the light of the formal Riemannian interpretation of the distance WB one
should view Tµ as the tangent space to P∗(RN ) at the measure µ. This is
reminiscent of Otto’s Riemannian interpretation of the L2-Wasserstein space
[10].

A GRADIENT FLOW APPROACH TO THE BOLTZMANN EQUATION

23

4. The homogeneous Boltzmann equation as a gradient flow

In this section we will show that the homogeneous Boltzmann equation is
the gradient ﬂow of the entropy w.r.t. the collision distance WB. We work in
the framework of metric gradient ﬂows outlined in Section 2.4. Throughout
this section we assume that B is constant, without restriction B ≡ 1. The
relevant metric space will by (Pτ ,WB) for a suitable τ and the functional
we consider is the Boltzmann–Shannon entropy H.
Recall from Proposition 3.21 that the metric derivative of an absolutely
continuous curve in (µt)t in (P∗(RN ),WB) is given by

t| =pA(µt,Ut) ,
|µ′

for a.e. t, where Ut is the optimal collision rate.
We ﬁrst esablish a chain rule allowing to take derivatives of the entropy
along suitable absolutely continuous curves.
Proposition 4.1 (Chain rule). Let µ ∈ AC 2((0, T ), (P∗(RN ),WB)) such
that H(µt) is ﬁnite for some t ∈ [0, T ] and

t|dt < ∞ .
Then H(µt) < ∞ for all t ∈ [0, T ] and we have that

Z T
0 pD(µt)|µ′
4Z ¯∇ log frdUrdr ∀0 ≤ s ≤ t ≤ T ,
H(µt) − H(µs) =Z t

1

s

(4.1)

(4.2)

where fr is the density of µr and Ur is the optimal collision rate for the
curve (µt)t. In particular, the map t 7→ H(µt) is absolutely continuous and
we have

d
dtH(µt) =

1

4Z ¯∇ log ftdUt

for a.e. t .

(4.3)

ε(r) = log(cid:0)ε + max(r, ε−1)(cid:1).

Proof. We perform a three-fold regularization procedure. First, introduce
the regularized entropy functional Hε deﬁned as follows. For ε > 0, deﬁne
eε : [0,∞) → R by setting eε(0) = 0 and e′
Then, we deﬁne
Hε(µ) =Z eε(f )dL ,
provided that µ = fL is absolutely continuous and Hε(µ) = +∞ else. Let
Ut be collision rates such that (µ,U ) ∈ CRE ∗
t| = A(µt,Ut) for a.e. t.
We regularize the curve by the Ornstein–Uhlenbeck semigroup. For δ > 0 we
set µδ
t (X, ω)dXdω
for a suitable function U δ
t . Finally, we perform a convolution in time. For a
standard molliﬁer η on R and γ > 0 we deﬁne

t L, and U δ
t =Z η(t′)µδ
(For this the curves are assumed to be extended trivially by µδ
[−γ, 0].) The functions f δ,γ
sponding densities. By Lemma 3.13 we have that (µδ,U δ) ∈ CRE ∗
linearity of the collision rate equation also (µδ,γ,U δ,γ) ∈ CRE ∗
T .

0,U δ
0 on
are deﬁned accordingly and are the corre-
T and by

T and |µ′
t = SδUt. We have dU δ

t =Z η(t′)U δ

t−γt′ dt′ , U δ,γ

t = Sδµt = f δ

t (X, ω) = U δ

t−γt′dt′ .

, U δ,γ

t

t

µδ,γ

24

MATTHIAS ERBAR

Note that the function v 7→ gδ,γ,ε
Thus, we can use the collision rate equation to calculate
r ) =ZRN
¯∇gδ,γ,ε

d
drHε(µδ,γ

4ZG

(v) := e′

e′
ε(f δ,γ

)∂rf δ,γ

ε(f δ,γ

r =

1

r

r

r

r U δ,γ

r

,

)(v) is bounded and smooth.

where the integral over G is w.r.t. the measure dXdω. Integrating between
s and t we obtain

Hε(f δ,γ

t

) − Hε(f δ,γ

t

r U δ,γ

¯∇gδ,γ,ε

r dr .

) =Z t

s

1

4ZG

We will now pass to the limit in this identity to obtain (4.2) letting γ → 0,
ε → 0 and δ → 0 in this order. Consider ﬁrst the right hand side. Since
gδ,γ,ε is uniformly bounded for ﬁxed ε and U δ,γ satisﬁes uniform Gaussian
bounds by the Ornstein–Uhlenbeck regularization, we can pass to the limit
as γ → 0 and obtain

Z t

s

1

4ZG

r U δ

¯∇gδ,ε

r dr .

r

converges pointwise to ¯∇ log f δ

Note that ¯∇gδ,ε
r as ε → 0 and has a uniform
quadratic (in X) bound by the Gaussian bounds on f δ. Appealing again to
the Gaussian bound on U δ we can pass to the limit as ε → 0 and obtain

Z t

s

1

4ZG

¯∇ log f δ

r U δ

r dr .

(4.4)

r U δ

r converges pointwise to ¯∇ log frUr as δ → 0 at every r
Note that ¯∇ log f δ
where the densities of µr,Ur exist. To pass to the limit in the integral over
G it suﬃces to exhibit a sequence of majorants converging in L1(G). We
estimate (dropping the time parameter r in the notation

| ¯∇ log f δU δ|(X, ω) ≤q| ¯∇ log f δ|2Λ(f δ)q|U δ|2/Λ(f δ)(X, ω)
=slog

(Tω(SδF ) − SδF )p|SδU|2/Λ(SδF, Tω(SδF ))(X) ,

Tω(SδF )

SδF

where we have set again F (X) = f f∗. Sδ acts as a rescaled convolution.
Using the commutation relation Tω(SδF ) = Sδ(TωF ) from Lemma 2.3 and
Jensen’s inequality on the convex functions (x, y) 7→ log(x/y)(x − y) as
well as (u, x, y) 7→ |u|2/Λ(x, y), it is not hard to obtain from the previous
estimate that

| ¯∇ log f δU δ|(X, ω) ≤p(SδL1)(X, ω)p(SδL2)(X, ω) ,

where we set

TωF

L1(X, ω) = log
L2(X, ω) = |U (X, ω)|2/Λ(F (X), Tω F (X)) .

(TωF − F )(X) ,

F

Note that RG L1 = 4D(µr) and RG L2 = 4A(µr,Ur). By assumption these
quantities are ﬁnite for a.e. r ∈ [0, T ]. Thus, for a.e. r we have that SδLi
converges to Li in L1(G). Hence, also our majorant √SδL1SδL2 converges
to √L1L2 in L1(G).

A GRADIENT FLOW APPROACH TO THE BOLTZMANN EQUATION

25

Finally, to pass to the limit in the time integral, we use the already es-
tablished almost everywhere in time convergence of the space integral and
exhibit a majorant using the bound

1

4ZG

¯∇ log f δ

r U δ

r dr ≤(cid:18) 1

4ZG | ¯∇ log f δ
r )qA(f δ

=qD(f δ

2(cid:18) 1
r )(cid:19) 1
r )(cid:19) 1
4ZG
r |2
|U δ
r |2Λ(f δ
Λ(f δ
r ) ≤pD(µr)pA(µr,Ur)
r , U δ

2

and the fact that the last expression is in L1(s, t) by assumption.
Let us turn to show convergence of the left hand side. Appealing again to
the uniform Gaussian bounds on f δ,γ we can pass to the limit as γ → 0 and
then ε → 0 and we are left with

s ) − H(f δ

(cid:12)(cid:12)(cid:12)H(f δ

t )(cid:12)(cid:12)(cid:12) .

(4.5)

(4.6)

(4.7)

Assume ﬁrst that H(µs) is ﬁnite. Recall that entropy is decreasing along the
Ornstein–Uhlenbeck semigroup and lower semicontinuous. As δ → 0 we thus
have that H(f δ
r ) increases to H(µr). The expression (4.5) converges to the
left hand side of (4.2) and H(µt) is ﬁnite due to the boundedness of the right
hand side in the limit. The whole argument presented so far starting ﬁrst
with s being the point where H(µs) < ∞ that is given by the assumption
shows that H(µt) < ∞ for all t ∈ [0, T ]. Thus (4.2) is established.
Finally, using the estimate

1

4ZG

¯∇ log frdUr ≤s 1

4ZG | ¯∇ log fr|2Λ(fr)s 1

4ZG |Ur|2/Λ(fr)

=pD(µr)pA(µr,Ur) ,

we see that t 7→ H(µt) is absolutely continuous and (4.3) follows.
As a corollary we obtain that the sqare root of the dissipation functional
D is a strong upper gradient for the entropy. More precisely, we have the
following.

(cid:3)

Corollary 4.2. √D is a strong upper gradient for H on (P∗(RN ),WB),
i.e. for any curve µ ∈ AC 2((0, T ), (P∗(RN ),WB) we have

|H(µs) − H(µt)| ≤Z t

s pD(µr)|µ′

r|dr ∀0 ≤ s ≤ t ≤ T .

(4.8)

Proof. Without restriction we can assume that R t

r|dr < ∞, as
otherwise there is nothing to prove. This implies that µr has a density fr
(and hence by Lemma 3.2 Ur has a density Ur) for a.e. r. We can also
assume that one of the measures µs, µt has ﬁnite entropy, say µs. Then, the
claim follows immediately from Proposition 4.1 together with the estimate
(4.6).
(cid:3)

spD(µr)|µ′

We can now state our ﬁrst main result giving a characterization of the ho-
mogeneous Boltzmann equation as the gradient ﬂow of the entropy. Here
gradient ﬂow is deﬁned as in Section 2.4, i.e. as a curve of maximal slope
w.r.t. the strong upper gradient √D.

1

2Z t

0

Z T

0

H(µ0) − H(µt) =

D(µr) + |µ′

r|2dr ∀t ≥ 0 .

(ii) (ft)t is a weak solution to the homogeneous Boltzmann equation sat-

isfying the integrability assumptions

Z T

0

|v|2ft(v)dvdt < ∞ ,

D(ft)dt < ∞ ∀T ≥ 0 .

(4.11)

In the present setting and under the assumption (4.10) on the initial datum,
it is well-known that there exists a unique classical solution (ft)t to the
homogeneous Boltzmann equation starting from f0. It satisﬁes (4.10) for all
t ≥ 0 and moreover

26

MATTHIAS ERBAR

Recall that by a weak solution the homogeneous Boltzmann equation we
mean a family of probability densities (ft)t≥0 such that we have for all
ϕ ∈ C ∞

∂tϕftdt = −

¯∇ϕ(f ′f ′

∗ − f f∗)dt .

(4.9)

1

4Z ZG

Theorem 4.3. Let (ft)t≥0 be a weakly continuous family of probability den-
sities such that

Z |v|2f0(v)dv = 1 , H(f0) < ∞ .

(4.10)

c ((0,∞) × RN ):
Z ZRN
Z vf0(v)dv = 0 ,

Then the following assertions are equivalent:

(i) (µt)t with µt = ftL is a gradient ﬂow of the entropy H w.r.t. WB

starting from µ0, i.e.

Z T

0

D(ft)dt = H(f0) − H(ft) .

In particular, (4.11) holds. Thus, the conclusion of the previous theorem
can be reformulated as:

Corollary 4.4. Under the assumptions of the previous theorem, there exists
a unique gradient ﬂow of the entropy starting from f0 and it coincides with
the unique solution to the Boltzmann equation.
Proof of Theorem (4.3). We ﬁrst show that (ii) implies (i): Setting µt = ftL
and

Ut = ¯∇ log ftΛ(ft) = (f ′)t(f ′

∗)t − ft(f∗)t ,

we see by (4.9) that (µ,U ) satisﬁes the collision rate equation (3.10). From
the bound on the second moment of f we infer that U satisﬁes the integra-
bility condition (3.17) and Lemma 3.8 implies that momentum and energy
of ft are conserved, i.e. ft ∈ P∗(RN ) for all t. Thus (µ,U ) belongs to CRE ∗.
Moreover, we have that A(µt,Ut) = D(ft) and thus by (4.11) µ is absolutely
t| ≤pD(ft). In fact, since Ut is of gradient form, it is the
continuous with |µ′
t| =pD(ft) by Corollary 3.22 and Proposition
optimal collision rate, i.e. |µ′
3.23. Finally, the chain rule (4.2) yields that for all s ≤ T
H(µs) − H(µt) =Z t
D(fr) + |µ′

2Z t

r|2dr ,

D(fr)dr =

1

s

s

A GRADIENT FLOW APPROACH TO THE BOLTZMANN EQUATION

27

i.e. (µt)t is a gradient ﬂow.
Conversely, let us show that (i) implies (ii): From the deﬁnition of gradi-
ent ﬂow and (4.10) we obtain that (µt)t is locally 2-absolutely continuous.
Moreover, µt ∈ P∗(RN ) and H(µt) < ∞ for all t and for all s ≤ t:

H(µs) − H(µt) ≥

D(µr) + |µ′

r|2dr .

(4.12)

1

2Z t

s

In particular, (4.11) holds. By Lemma 3.2 the measure Ut has a density
UtΛ(ft). From the chain rule (4.2) we and the Cauchy–Schwartz and Young
inequalities we infer that

s

1

¯∇ log frUrΛ(fr)dr

H(µs) − H(µt) =Z t
4ZG
s s 1
4ZG | ¯∇ log fr|2Λ(fr)s 1
≤Z t
2Z t
4ZG | ¯∇ log fr|2Λ(fr) +
2Z t
D(fr) + |µ′

r|2dr .

≤

=

1

1

1

s

s

4ZG |Ur|2Λ(fr)dr
4ZG |Ur|2Λ(fr)dr

1

(4.13)

(4.14)

(4.15)

(4.16)

Comparing with (4.12), we see that the two inequalities have to be identities.
But equality in Cauchy–Schwartz and Young (applied in the Hilbert space
Tµr

P(RN ) with the inner product hU, V i = 1

4RG U V Λ(fr)) implies that

for a.e. r .

Ur = ¯∇ log fr

Thus, the collision rate equation for (µ,U ) turns into the weak formulation
of the Boltzmann equation.

(cid:3)

5. Variational approximation scheme

In this short section, we consider a novel time-discrete variational approxi-
mation scheme for the homogeneous Boltzmann equation, relying on the gra-
dient ﬂow structure. This is reminiscent of the results by Jordan–Kinderlehrer–
Otto [7] for the heat equation. The scheme is the natural implicit Euler
scheme for the gradient ﬂow. Here we assume that B is constant.
Given a time step τ > 0 and an initial datum µ0 ∈ P∗(RN ) ∩ D(H), we
consider a sequence (µτ

n)n deﬁned recursively via

0 = µ0 , µτ
µτ

n ∈ argmin

ν

hH(ν) +

1
2τ WB(ν, µτ

n−1)2i .

Then we build a discrete gradient ﬂow trajectory as the piecewise constant
interpolation (¯µτ

t )t≥0 given by
¯µτ
¯µτ
t = µτ

0 = µ0 ,

n if t ∈(cid:0)(n − 1)τ, nτ ] .

Then we have the following result.
Theorem 5.1. For any τ > 0 and µ0 ∈ P∗(RN ) ∩ D(H) the variational
scheme (5.1) admits a solution (µτ
n)n. As τ → 0, for any family of discrete

(5.1)

(5.2)

28

MATTHIAS ERBAR

solutions there exists a sequence τk → 0 and a locally 2-absolutely continuous
curve (µt)t≥0 such that

¯µτk
t ⇀ µt ∀t ∈ [0,∞) .

(5.3)

Moreover, any such limit curve is a gradient ﬂow of the entropy, i.e. a weak
solution to the Boltzmann equation satisfying (4.11).

With the knowledge that the Boltzmann equation in our setting has a unique
solution, we obtain the following
Corollary 5.2. For any f0 ∈ P∗(RN ) ∩ D(H) and any sequence of time
steps τ → 0 any discrete trajectory ¯µτ
t given by (5.1) and (5.2) converges to
the unique solution to the homogeneous Boltzmann equation starting from
f0.
With the work we have done so far, Theorem 5.1 follows basically from
standard results for metric gradient ﬂows where (5.1) is known as the min-
imizing movement scheme, see [1, Sec. 2,3]. Thus, we shall only sketch the
arguments below.
First, we need two small additional ingredients. We note the entropy dis-
sipation is a lower semicontinuous functional w.r.t. weak convergence of
probability measures.
Lemma 5.3. For any sequence (µn) in P(RN ) converging weakly to µ we
have that

D(µ) ≤ lim inf

n

D(µn) .

(5.4)

Proof. We will rewrite D as an integral functional with convex integrand.
To this end, consider the lower semicontinuous, convex and 1-homogeneous
function G : R+ × R+ → R+ deﬁned by G(x, y) = 1
4 (x − y)(log x − log y)
if x, y > 0 and +∞ otherwise. As in the construction of the action, we
associate to µ ∈ P(RN ) two measures µ1, µ2 given by (3.3). Then we have
dλ(cid:19) dλ ,

D(µ) =Z G(cid:18) dµ1

where λ is any measure such that µi ≪ λ. Recall that weak convergence of
µn to µ implies weak∗ convergence of µi
n to µi. Now the claim follows from
Proposition 3.4.
(cid:3)
Now, we relate the dissipation D to the metric slope |∂H| of the entropy in
the metric space (P∗(RN ),WB).
Lemma 5.4. For any µ ∈ P∗(RN ) with H(µ) < ∞ we have that

,

dλ

dµ2

pD(µ) ≤ |∂H(µ)| .

Proof. Let f0 be the density of µ and consider the solution (ft) to the homo-
geneous Boltzmann equation with initial datum f0. Setting µt = ftL and
observing that

D(f ) = lim
tց0

H(µ) − H(µt)

t

= lim
tց0

H(µ) − H(µt)

W(µt, µ)

≤ |∂H(µ)||µ′

0| ≤ |∂H(µ)|pD(µ)

yields the claim.

W(µt, µ)

t

(cid:3)

A GRADIENT FLOW APPROACH TO THE BOLTZMANN EQUATION

29

Proof of Theorem 5.1. We verify that the present situation is consistent with
the abstract setting considered in [1, Sec. 2].
We consider the metric space (Pµ0(RN ),WB) and endow it with the weak
topology σ. By Theorem 3.19, (Pµ0 (RN ),W) is separable and complete,
WB is lower semicontinuous w.r.t. σ and induces a stronger topology.
Recall from Section 2 that the entropy H is bounded below on P∗(RN )
and lower semicontinuous w.r.t. weak convergence. Moreover, P∗(RN ) is
compact w.r.t. weak convergence. Indeed, for any µ ∈ P∗(RN ) we have the
trivial bound

µ(Bc

R) ≤Z |v|2

R2 dµ(v) =

1
R2 ,

which yields tightness of P∗(RN ) and thus compactness by Prokhorov’s
theorem. In particular Assumptions 2.1.a,b,c of [1] are satisﬁed. From here
we only sketch the argument, for details we refer to [1, Sec. 2,3].
Existence of solutions to the variational scheme follows immediately by the
direct method taking into account compactness of P∗(RN ), the lower bound
on H and lower semicontinuity of H and WB. Then one introduces the De
Georgi interpolation of the discrete scheme deﬁned for t = (n − 1)τ + δ ∈
((n − 1)τ, nτ ] by

hH(ν) +

1
2δWB(ν, µτ

n−1)2i .

t ∈ argmin

ν

eµτ

(5.5)

Set for t ∈ ((n − 1)τ, nτ ]
1
τ WB(µτ
|(µτ )′|(t) :=
1
sup{WB(ν, µτ
Gτ (t) :=
δ

n, µτ

n−1) ,

n−1)} ,

t = (n − 1)τ + δ ,

t )| ≥ pD(eµτ
2Z t
H(µ0) − H(eµτ

t ) ≥

1

0

where the supremum is over all minimizers in (5.5). One can check that
t ), where the last inequality is due to Lemma
5.3. Then one obtains a discrete version of the energy dissipation inequality
reading

Gτ (t) ≥ |∂H(eµτ

G2

τ (r) + |(eµτ )′|2(r)dr ∀r ≥ 0 .

(5.6)

2τ (n − m)

nXi=m−1
m)2 ≤
t )2 ≤ 4τ(cid:0)H(µ0) + C(cid:1) .

Moreover, it is not hard to deduce from the variational scheme and the lower
bound (2.2) on H the following a prior iestimates:
1
i−1)2 ≤
2WB(µτ

WB(µτ

n, µτ

i , µτ

1

1

2τ (n − m)(cid:0)H(µ0) + C(cid:1) ,

t , ¯µτ

Recall that WB is bounded below by W1 up to a constant. In particular,
t )t are uniformly equicontinuous on [0, T ] w.r.t. W1. Since
(P∗(RN ), W1) is compact the Arzela–Ascoli theorem yields the existence of

WB(eµτ
the curves (eµτ
a subsequential limit curve (µt)t as τ → 0. Moreover, one has that |(eµτ )′|

loc to a function A and (µt)t is locally 2-absolutely

converges weakly in L2

30

MATTHIAS ERBAR

continuous with |µ′
lower semicontinuity obtaining
2Z t
0 |µ′

1

t| ≤ A(t). Now, one can pass to the limit in (5.6) by

r|2 + D(µr)dr + H(µt) ≤ H(µ0) .

Thus, (µt)t is a curve of maximal slope for the strong upper gradient √D.
The reverse inequality follows from the strong upper gradient property. (cid:3)

References

[1] L. Ambrosio, N. Gigli, and G. Savar´e. Gradient ﬂows in metric spaces and in the space

of probability measures. Lectures in Mathematics ETH. Birkh¨auser, Z¨urich, 2008.

[2] L. Arkeryd. On the Boltzmann equation. I. Existence. Arch. Rational Mech. Anal.,

45:1–16, 1972.

[3] J.-D. Benamou and Y. Brenier. A computational ﬂuid mechanics solution to the

Monge-Kantorovich mass transfer problem. Numer. Math., 84(3):375–393, 2000.

[4] G. Buttazzo. Semicontinuity, relaxation and integral representation in the calculus of
variations. Pitman Research Notes in Mathematics Series. Longman Scientiﬁc and
Technical, Harlow, 1989.

[5] E. A. Carlen and M. C. Carvalho. Strict entropy production bounds and stability of
the rate of convergence to equilibrium for the Boltzmann equation. J. Statist. Phys.,
67(3-4):575–608, 1992.

[6] J. Dolbeault, B. Nazaret, and G. Savar´e. A new class of transport distances between

measures. Calc. Var. Partial Diﬀerential Equations, 34(2):193–231, 2009.

[7] R. Jordan, D. Kinderlehrer, and F. Otto. The variational formulation of the Fokker-

Planck equation. SIAM J. Math. Anal., 29(1):1–17, 1998.

[8] J. Maas. Gradient ﬂows of the entropy for ﬁnite Markov chains. J. Funct. Anal.,

261(8):2250 – 2292, 2011.

[9] Alexander Mielke. A gradient structure for reaction-diﬀusion systems and for energy-

drift-diﬀusion systems. Nonlinearity, 24(4):1329–1346, 2011.

[10] F. Otto. The geometry of dissipative evolution equations: the porous medium equa-

tion. Comm. Partial Diﬀerential Equations, 26(1-2):101–174, 2001.

[11] G. Toscani and C. Villani. Sharp entropy dissipation bounds and explicit rate of trend
to equilibrium for the spatially homogeneous Boltzmann equation. Comm. Math.
Phys., 203(3):667–706, 1999.

[12] C. Villani. Optimal transport, Old and new, volume 338 of Grundlehren der Mathe-

matischen Wissenschaften. Springer-Verlag, Berlin, 2009.

Institut f¨ur angewandte Mathematik, Universit¨at Bonn, Endenicher Allee
60, 53115 Bonn, Germany
E-mail address: erbar@iam.uni-bonn.de

