6
1
0
2

 
r
a

M
2

 

 
 
]

V
C
.
s
c
[
 
 

1
v
6
1
8
0
0

.

3
0
6
1
:
v
i
X
r
a

A Nonlinear Weighted Total Variation
Image Reconstruction Algorithm for
Electrical Capacitance Tomography

Kezhi Li, Daniel Holland ∗

March 3, 2016

Abstract

Based on the techniques of iterative soft thresholding on total varia-
tion penalty and adaptive reweighted compressive sensing, a new iterative
reconstruction algorithm for electrical capacitance tomography (ECT) is
proposed. This algorithm encourages sharp changes in the ECT image
and overcomes the disadvantage of the l1 minimization by equipping the
total variation an adaptive weighted depending on the reconstructed im-
age. Moreover, the nonlinear eﬀect is also partially reduced due to the
adoption of the updated accurate sensitivity matrix. Simulation results
show that it recovers ECT images more precisely and therefore suitable for
the imaging of multiphase systems in industrial or medical applications.

1

Introduction

The electrical capacitance tomography (ECT) technique belongs to the big fam-
ily of tomography approaches. Similar ideas include computerised tomography
(CT) and Electrical impedance tomography (EIT), etc., which have been famil-
iar to people. Literally, the word tomography is derived from “tomo-” meaning
“to slice” and “graph” having a meaning of “image”. So it means to see the
object we are interested in by having its images slice by slice.

The technique of ECT has been developed for decades, and still attracts lots
of attentions from both scientiﬁc researchers and experts from industry. The
great interests in ECT for applications have been motivated by its high speed,
high safety and low cost. It also suits for vessels of diﬀerent sizes. A typical
ECT system consists of three main parts: a multi-electrode sensor, an acquisi-
tion hardware and a computer for hardware control and image processing. Ap-
parently, it is non-invasive and non-intrusive. Speciﬁcally, the multi-electrode
hardware in ECT typically has n electrodes surrounding the wall of the process
vessel as illustrated, and the number of independent capacitance measurement
in such a conﬁguration is N = 1/2 · n(n − 1) due to the independent number of
sensor pairs within n sensors. The ﬁnal objective is to recover the cross section

∗Magnetic Resonance Research Centre (MRRC), University of Cambridge, UK. Email:

{kl431,djh79}@cam.ac.uk

1

or even 3D images by using these measurements. This problem is underdeter-
mined, since number of measurements is far fewer than the number of pixels
in the reconstructed image, and the highest recorded resolution normally does
not exceed 3% of the imaging domain [1]. Various reconstruction algorithms
are developed to cope with this diﬃculty, such as direct algorithms including
the classic linear back projection (LBP), approaches based on Singular Value
Decomposition (SVD) and Tikhonov regularization [2]. Afterwards, many iter-
ative algorithms are proposed, eg. the celebrated Landweber iterations (LI) [3]
and iterative Tikhonov methods [4]. Recent years, the eﬀectiveness of sparse
total variation regulation has been proved in image recovery and thus many
reconstruction algorithms are developed making use of the novel compressive
sensing (CS) theory [5–7]. Though CS cannot be applied strictly to ECT im-
age reconstruction due to the nonliear nature and the non-restricted isometry
property (RIP) of the sensitivity matrix, however we can adopt the idea of CS
as well as the adaptive weights [8] to improve the preliminary studies of ECT
with an l1-norm penalty by introducing new image reconstruction algorithms.
In this paper we propose a comprehensive Reweighted Total Variation Fast
Iterative Shrinkage Thresholding (TV-FIST) Algorithm for nonlinear ECT im-
age reconstruction by minimizing the least squares errors and the total varia-
tion at the same time. After explaining the ECT physical model, we modify
the conventional TV-IST accordingly to develop the TV-IST for ECT and its
fast version with auxiliaries. To make the algorithm more robust and over-
come the barrier of l1 penalty, we introduce the reweighted iterative technique
combining two nonlinear frameworks of sensitivity matrices to the TV-IST and
ﬁnally generate the Reweighted TV-IST algorithm for nonlinear ECT. The al-
gorithm has been examined using simulated measurements of phantoms to show
its superiorly comparing with other existing algorithms.

2 Fundamentals of Electrical Capacitance To-

mography

ECT provides a unique way of non-intrusive probes.
It allows for a detailed
analysis of multiphase ﬂow morphology. Here, the permittivity distribution
inside a pipe or vessel of interest, corresponding to the material distribution,
is calculated from measured capacitances between all pairs of sensors located
around the pipe’s periphery. The relationship between the spatial distribution of
the permittivity and the measured capacitances can be derived from Maxwell’s
equations and Gauss’ law as

∇ · D(r) = ρv(r),

(1)

where D(r) is the electric ﬂux density, ρv(r) represents the volume charge den-
sity, and ∇· is the divergence operator. Denoted the spatial permittivity distri-
bution ǫ(r), the electric ﬁeld intensity E(r) and the electric potential distribu-
tion φ(r), because D = ǫ(r)E(r) and E(r) = −∇φ(r) where ∇ is the gradient
operator, then we have
(2)

D = −ǫ(r)∇φ(r).

2

C =

ǫ(x, y)∇φ(x, y)ds,

(4)

Q
Vc

= −

1

Vc IS

Since the total electric ﬂux over all the electrodes surfaces is equal to zero, we
have the Poisson’s equation:

∇ · [ǫ(r)∇φ(r)] = 0,

(3)

and the boundary conditions are φ = Vc for excited electrode and φ = 0 for other
electrodes. For the two-dimensional case r = (x, y), the relationship between
the capacitance and permittivity distribution can be expressed by the following
equation:

where Q is the total charge, S denotes the closed line of the electrical ﬁeld,
ǫ(x, y) is the permittivity distribution in the sensing ﬁeld, and Vc is the potential
diﬀerence between two electrodes forming the capacitance.

Equation (4) can be simpliﬁed in some circumstances. If an ideal parallel-

plate sensor with homogeneous permittivity distribution, it becomes

C = ǫ0ǫr

A
d

,

(5)

where ǫ0 is the permittivity of vacuum, ǫr is the relative permittivity of the
material inside the sensor, A represents the area of the plates and d is the
distance between the two plates. However, the geometry distribution of ECT
sensors is more complicated. In (4) φ(x, y) is also a function of ǫ. Therefore the
capacitance between electrode combinations can be considered as a function of
permittivity distribution ǫ:

C = f (ǫ),

(6)

where f is a non-linear function, and elements of C are not redundant elements of
electrode pairs [C1,2, C1,3,··· , C1,n, C2,3 ··· CN −1,N ]. If we take the diﬀerential
on both sizes, the change will be

△C =

df
dǫ

(△ǫ) + O((△ǫ)2).

(7)

due to the Taylor expansion, where df
dǫ is the sensitivity of the capacitance versus
permittivity distribution, and O((△ǫ)2) represents the higher order terms of
(△ǫ)2. Because △ǫ is usually small, the high order term is often neglected.
Then (7) can be linearized in a matrix form:

△C = J△ǫ,

(8)

where △C ∈ RM , J ∈ RM×N is a Jacobian/sensitivity matrix denoting the sen-
sitivity distribution for each electrode pair, and △ǫ ∈ RN , N ≫ M . As a result,
the non-linear forward problem has been formulated to a linear approximation.
Generally in ECT, (8) can be written in a normalized form

λ = Sx,

(9)

where λ ∈ RM is the normalized capacitance vector, S ∈ RM×N is the Jacobian
matrix of the normalized capacitance with respect to the normalized permittivi-
ties, which gives a sensitivity map for each electrode pair, and x ∈ RN , N ≫ M
is the normalized permittivity vector, which can be visualized by the colour

3

density of the image pixels. The conventional optimization problem of ECT
becomes

x = arg min

x ||λ − Sx||2.

(10)

Because there are n electrode pairs, M should be 1/2 · n(n − 1). The objective
of the reconstruction algorithm of ECT is to recover ǫ(x, y) from measured
capacitance vector C. While in the discrete linear model, it is to estimate x
given λ, and K is seen as a constant matrix determined in advance for simplicity.
There are several diﬃculties of the reconstruction problem. Firstly, (9) is
under-determined so the solution is not unique. Secondly, (4) is even harder to
solve since it is ill posed and not linear, its linear form (9) is very sensitive to
disturbances of λ. At last, S is not always constant in practice. It varies for
diﬀerent permittivity distributions.

In this paper, we propose a Nonlinear Weighted Total Variation Image Re-

construction Algorithm to overcome these diﬃculties.

3

Iterative Shrinkage Thresholding Algorithm
Meets Total Variation

3.1

Iterative Shrinkage Thresholding Algorithm

To recover the permittivity distribution image x, many reconstruction algo-
rithms for ECT have been developed. Generally the reconstruction algorithms
can be categorized in two groups: direct algorithms and iterative algorithms.
Among them, Landwater Iteration and Steepest Descent Method (LWSDM) is
considered as one of the best algorithms with good eﬃciency. It minimizes the
cost function 1

2, e.g. to minimize

2||Sx − λ||2
f (x) =

=

The gradient of f (x) is

1
2
1
2

(Sx − λ)T (Sx − λ)
(xT ST Sx − 2xT ST λ + λT λ).

(11)

(12)

∇f (x) = ST Sx − ST λ = ST (Sx − λ),

which means we choose the direction that f (x) decreases most quickly due to
the gradient descent method used here. Therefore the new image will be

xk+1 = xk − αk∇f (xk) = xk − αkST (Sxk − λ),

(13)

where αk is a positive value determining the step size.

In fact, LWSDM can be derived from the Iterative Shrinkage Thresholding
Algorithm (ISTA) as a special case with ECT constraints. Here we introduce
and explain the general model of ISTA on which our algorithm also is based.

The ISTA is to solve a class of optimization problems with convex diﬀeren-

tiable cost functions and convex regularization.

Theorem 1 [9] Consider the general formulation:

x = arg min

x {F (x) ≡ f1(x) + f2(x)}, x ∈ RN

(P0)

(14)

and the following assumptions are satisﬁed:

4

• f1: a smooth convex function which is also continuously diﬀerentiable with

Lipschitz continuous gradient L(f1):

||∇f1(x) − f1(y)|| ≤ L(f1)||x − y||

for every x, y ∈ RN ,

(15)

where L(f1) > 0 is the Lipschitz constant of ∇f1.

• f2: a continuous convex function mapping RN → R
• Problem (P0) is solvable.

Then basic ISTA converges to its true solution by running iteration xk = pL(xk−1), k =
{1, 2,···}, where its iteration:

pL(y) = arg min

x (cid:8)f2(x) + L/2||x − (y − 1/L∇f1(y)) ||2
2(cid:9)

(16)

For example, LWSDM is actually a special instance of problem (P0) by
substituting f1 := 1
2||λ − Sx||2 and f2 := 0 as a smooth quadratic minimiza-
tion problem with the Lipschitz constant of the gradient ∇f1 being L(f1) =
2λmax(AT A). Then according to (16) we have

xk+1 = arg min

x (cid:8)L/2||x − (xk − 1/L∇f1(xk))||2
2(cid:9)
= xk − α∇f1(xk) = xk − αST (Sxk − λ),

(17)

which is equivalent to the LWSDM, where α = 1/L. Theorem 1 is very useful to
construct the cost function that ﬁts for the practical circumstances and provides
the theoretical convergence of the algorithm based on it. We will leverage its
advantages to develop our algorithm.

3.2 Total Variation Minimization

Total variation (TV) norm of the image has been used to penalize the cost func-
tion from early time [10]. It also has been veriﬁed that the TV norm can be
utilized to address the under-determined image reconstruction and reproduce
ECT [11] or other tomography images [12] with sharp transitions in intensity.
Diﬀerent from the conventional techniques for iterative reconstruction, we ad-
ditionally assume that there are merely sharp changes in intensity that can be
sparsely represented by their spatial gradients. In this case the cost function is
suppose to minimize the least squares error and the sparsity of intensity changes
at the same time:

x = arg min

x ||λ − Sx||2 + α||x||T V ,

(18)

where ||x||T V is the discrete TV of the two dimensional X = reshape(x, n1, n2) ∈
Rn1×n2 deﬁned by [13]:

||x||T V =

n2−1

n1−1

Xj=1 q(Xi,j − Xi+1,j)2 + (Xi,j − Xi,j+1)2
Xi=1
Xi=1
|Xn1,j − Xn2,j+1|
|Xi,n1 − Xi+1,n1| +

Xj=1

n1−1

n2−1

+

(19)

5

with the boundary conditions Xn2+1,j − Xn2,j = 0,∀j and Xi,n1+1 − Xi,n1 =
0,∀i. (18) belongs to linear inverse problems with nonquadratic regularizers.
Nonquadratic regularizers include wavelet representations [14], sparse regression
[15] and total variation, etc. These problems can be solved by a signal processing
technique called compressive sensing (CS) in the literature [5, 16]. ISTA is very
convenient to solve CS problems with l1 norm regularizaiton and the nonlinear
shrinkage operation, or called the soft thresholding is widely utilized

Tα = arg min

x ||b − x||2 + α||x||1
= (|b| − min(α,|b|)) · sgn(b).

(20)

For instance, the ISTA and its derivative versions along with the shrinkage
operation have been veriﬁed eﬃciently in solving wavelet-based reconstruction
for magnetic resonance imaging (MRI) [14]. In the next section we will explain
how to implement ISTA to ECT image reconstruction using TV regularization
and prove its eﬀectiveness.

4 TV-IST for ECT

In this section we will present an iterative reconstruction technique for ECT. As
in IST, the iterative soft thresholding is applied to penalize the total variation
of the ECT image. Some of the contents have been introduced in our conference
paper [7]. Here we provide the full theoretical analysis of this algorithm and
prove its convergence rate explicitly.

In the ECT model, the permittivity distribution we are interested inside the
pipe can usually be formulate as the 2D image/matrix X, and x is a column
vector of X. Xi,j denotes the pixel of the position (i, j) in the imaging region.
Its magnitude is proportional to the permittivity diﬀerence △ǫ and 0 outside
of the imaging region. We use g1, g2 to represent the gradients of the image
respectively which correspond to the horizontal and vertical ﬁnite diﬀerences.
In detail, the gradient transforms are used to calculate the gradients:

g1 = G1x,

g2 = G2x,

(21)

where G1, G1 are transform matrices. Each element of g1i, g2i also corresponds
to the same ith element in x. Likewise, given g1, g2, an inverse transform can
be carried out by solving a least squares (LS) problem of

x(g1, g2) = arg min

x (cid:8)||g1 − G1x||2 + ||g2 − G2x||2(cid:9) .

Use linear algebra we can obtain the standard LS solution:

x = L−1(GT

where L = GT

1 g1 + GT

2 g2),
1 G1 + GT

2 G2.

(22)

(23)

L approximates the Laplacian operator for the image. It is an approximation of
the Fourier transform version [17] but allows to only consider the pixels within
the imaging region.

To consider an isotropic form of TV, a single vector g is used to represent the
integral gradient magnitude. g can be calculated element-wise from the vector

6

pair (g1.g2). Then (18) can be reformulated to

x = arg min

x ||λ − SL−1(GT

1 g1 + GT

2 g2)||2 + α||g||1,

(24)

Apparently (24) is diﬀerent from the conventional l1 minimization problem.
However, we can still use the iterative update idea to pursue the solution. In-
stead of updating xk in iterations, here we calculate g1 and g2 by updating it
to their steepest descent. Following the second step in (17), the residuals are
calculated and projected to the g1 and g2 directions, respectively

∇f1(g1)1 = G1L−1ST (Sxk − λ),
∇f1(g2)2 = G2L−1ST (Sxk − λ),

(25)

where {L−1}T = L−1 due to the symmetry of matrix L. As a result, according
to the IST algorithm the gradients g1, g2 can be updated:
ˆg1k+1 = g1k − αG1L−1ST (Sxk − λ),
ˆg2k+1 = g2k − αG2L−1ST (Sxk − λ),

(26)

where α ≤ 1/λmax({SL−1Gi}T{SL−1Gi}) due to the requirements of Lipschitz
continuous, and ˆgk+1 are the iterative gradient solution that can be derived from
ˆg1k+1, ˆg2k+1 if we only consider the least squares error.

The next step is to optimize the g with

gk+1 = arg min

g ||g − ˆgk+1||2 + α′||g||1,

(27)

where α′ is equal to α multiply some constant. Similar to (20), a shrinkage
operator can be used. While here the diﬀerence to the conventional shrinkage
is that rather than set a soft thresholding on ˆg1, ˆg2 directly, we decrease the
magnitudes of ˆg1, ˆg2 by making it proportional to the magnitudes of ˆg after a
soft thresholding on ˆg to reduce the total variation. The magnitude vector ˆg
can be calculated element-wisely by

So for the ECT TV-IST, the soft thresholding process can be carried out

ˆg =qˆg2

1 + ˆg2
2.

g1k+1 = Tα′ (ˆgk+1)
g2k+1 = Tα′ (ˆgk+1)

gk+1

gk+1

ˆg1k+1

ˆg2k+1

(28)

(29)

is the shrinkage operator deﬁned in (20). By using this new soft
where Tα′
thresholding process we are able to eliminate small variation and meanwhile
reduce the large variation in ˆg1, ˆg2 directions. Finally, the new reconstructed
image can be updated by (23), and the new gradients of the image are updated
by multiplying the transform matrices

gik+1 = Gix, i ∈ 1, 2,

(30)

which returns to the beginning of the section and completes one iteration in the
algorithm. Algorithm 1 sums up the Total Variation-Iterative Soft Thresholding
algorithm in the following.

7

Algorithm 1: TV-IST
Input: normalized sensitivity matrix S, normalized capacitance λ,
transform matrices G1, G2.
Set: max loop kmax, shrinkage parameter α, α′.
Initialize: g1, g2, x0 are zero vectors.
Iteration: for k = 0, 1,··· , kmax do
1. (25) \\ calculate the steepest descent increment
2. (26) \\ update g1, g2
3. (28) \\ update g element-wisely
4. (29) \\ soft threshloding g1, g2 according to g
5. (23) \\ update new image
6. (30) \\ calculate new g1, g2
Output: x or X.

In the Algorithm 1, the iterative soft thresholding involves iterating with al-
ternating the updates in (26), (29) and (30). These procedures are performed for
isotropic total variation to reduce the image artifacts. Because the conservative
property of gradient vector ﬁeld might be destroyed by the soft thresholding,
(30) is enforced in the end of each iteration [17].

In addition, we also can accelerate the convergence rate of the algorithm by
adding the auxiliary vectors in iterations [9]. The auxiliary h1, h2 are updated
based on g1, g2. This technique is mature and has been used eﬃciently in
various image processing areas [6, 17, 18], called the Fast Iterative Shrinkage-
Thresholding Algorithm (FISTA). It can be obtained from Algorithm 1 with
several additional steps accordingly.
Algorithm 2: TV-FIST
Input: normalized sensitivity matrix S, normalized capacitance λ,
transform matrices G1, G2.
Set: max loop kmax, shrinkage parameter α, α′.
Initialize: g1, g2, h1, h2 are zero vectors, t0 = 1.
Iteration: for k = 0, 1,··· , kmax do
1. xk+1 = L−1(GT
2. (25) \\ calculate the steepest descent increment
3. ˆg1k+1 = h1k − α′∇f11, ˆg2k+1 = h2k − α′∇f12, \\
4. (28), (29),(23),(30)

1 h1 + GT

2 h2), \\ update the image according to auxiliary vectors

5. tk+1 =

1+√1+4t2

k

2

, \\ calculate t

6. hik+1 = gik + 1 +(cid:16) tk−1

Output: x or X.

tk+1(cid:17) (gik+1 − gik), i ∈ {1, 2}, \\ calculate h1, h2

Algorithm 2 for TV-FIST is a advanced version of TV-IST. It has been
proved that FIST algorithm can achieve a better rate of convergence of O(1/k2)
versus the IST algorithm’s rate of O(1/k) [6, 9]. Speciﬁcally, let {xn},{yn} be
the sequence generated by Algorithm 1 and 2 with α satisfying the conditions
in Theorem 1. Then for any k ≥ k′ ∈ N, we have

c(α)

k − k′||xk − x∗||2,
F (xk) − F (x∗) ≤
k + 1 (cid:19)2
F (yk) − F (y∗) ≤(cid:18) c(α, α′)

||xk − x∗||2,

8

(31)

f2

f2

f is not sparse

f is sparse

f1

f1

(a)

(b)

Figure 1: An illustrative example indicating the advantage of l1 minimization
over l2 minimization in ﬁnding a sparse point in the line y = Θf ′.

where c() is a constant which only depends on the parameter in the bracket.
The proofs are given in [9] for the case k′ = 0. For the case when k′ ∈ N > 0,
the result can be easily derived if we deﬁne a new sequence starting with k′.
From an optimization point of view, some advance optimization approaches
can also be implemented, such as alternating direction method of multipliers
[19] and Bregman Iteration [20]. However, in order to make sure that the
algorithm is simple and fast for real-time ECT, we makes a tradeoﬀ between
the computational burden and accuracy of the reconstructed image.

5 Weighted/Reweighted Compressed Sensing for

Nonlinear ECT

5.1 Weighted/Reweighted Compressed Sensing

In ECT image reconstruction, we used the l1 penalty on the total variation
to achieve a better recovery. The recovery technique belongs to compressive
sensing, which enables to reconstruct sparse signals exactly form what appear
to be highly incomplete sets of linear measurements. Generally these problems
can be solved by constrained l1 minimization instead of the original l0 penalty
when the sensing scheme is appropriate. This is the theoretical foundation of
the image reconstruction algorithm.

However in many cases the l1 minimization cannot achieve the exact sparse
result that we want to pursue. The reason comes from the relationships between
l0, and l1 and l2 norm. To understand why an l1 but not l2 minimization can
achieve the same result of an l0 minimization and the limitation of l1, we can
illustrate the optimization process as in Fig. 1 and Fig. 2, respectively.

In Fig. 1, the yellow lines represent the the solutions for the certain l2 or l1
norm, and the red lines are the solutions satisfy the constraints. As a result, the
meeting point of the yellow and red lines are the solution to this optimization
problem. Comparing to the l2 norm, the solution to l1 norm is much more likely
lying on the axis, which implies it is a sparse solution.

While in many complex problem dealing with high dimensional reconstruc-
tion, sometimes l1 minimization leads to a non-sparse solution. A simple 3-D

9

Figure 2: An illustrative example indicating the advantage of weighted l1 mini-
mization over conventional l1 minimization in ﬁnding a sparse point in the line
y = Θx′.

example is illustrated in Fig. 2 [8], where x0 = [0 1 0]T and Φ = (cid:20) 2 1 1
1 1 2 (cid:21).
To recover x0 from y = Φx0 = [1 1]T , the real x0 is shown in (a). However,
the l1 will give the wrong solution x′ = [1/3 0 1/3]T 6= x0 when the inte-
rior of the l1 ball intersects the feasible set Φx = y in (b), since |x′|1 < |x|0
In this case, instead of
and of course x is not the sparse solution we need.
optimizing minx{y − Φx + α|x|1}, we can optimize the weighted l1 norm as
minx{y − Φx + αPi wi|xi|} where w ∈ RN is a weight vector over x. If the
weighting matrix W = diag(w) = diag([3 1 3]T ), (c) shows the weighted l1 ball
of radius |Wx|1 = 1 centered at the origin and consequently we will ﬁnd the
correct solution x′ = x0. People have shown that the same statements would
hold true for any positive weighting matrix under certain conditions [8], and the
weighted l1 norm approach has been widely implemented [8, 12, 14].

In order to solve the weighted l1 problem, we modify the ISTA accord-
ingly by adding a ﬁxed weighting term W inside the l1 norm and see Wx
as the solution needs to be calculated. Then the least squares term becomes
||y − ΦW−1(Wx)||. We follows the ISTA to perform the updates. Yet here
a reweighted algorithm will be proposed. The reweighted algorithm changes
the weighting matrix W adaptively due to x and encourage the nonzero entries
of x In [8], the authors proposed a simple but eﬀective iterative algorithm on
which our algorithm based. Originally it alternatingly updates x and reﬁne the
weights W. The algorithm consists of only 2 steps.
Algorithm 3: Iterative Reweighted Algorithm
Input: y, Φ, ρ,
Set: max loop kmax.
Initialize: wi = 1, i = 1,··· , N .
Iteration: for k = 0, 1,··· , kmax do
1. xk = arg minx ||Wkx||1 s.t. y = Φx \\ solve the weighted l1 minimization
2. w(i)
|x
Output: x .

k |+ρ \\ update the weighted for every w(i)

k , i = 1,··· , N

k =

1
(i)

10

The parameter ρ > 0 is introduced to aim for providing stability and ensuring
a zero-valued component in xk can also be modiﬁed as a nonzero estimate at
the next step.

5.2 Reweighted TV-IST for ECT

Similar to the weighted l1 minimization, it is natural to incorporate the reweighted
technique in the total variation constraints. Then the TV optimization problem
is transformed to

x = arg min

x (||λ − Sx||2 + αXi

{wi(||x||T V )i}) .

For the ECT model, the conversional equation (24) becomes

x = arg min

2 g2)||2 + α||Wg||1.

x ||λ − SL−1(GT

1 g1 + GT

(32)

(33)

In the following steps, (25) and (26) remain the same for reweighted TV-IST
in each iteration. The diﬀerence occurs in the soft thresholding step. Because
we want to pursue the minimal l1 norm of the weighted TV, the thresholding
process needs to be changed adaptively:

g1k+1 = Tα′ (Wˆgk+1)

Wgk+1

g2k+1 = Tα′ (Wˆgk+1)

Wgk+1

ˆg1k+1

ˆg2k+1.

(34)

It is a weighted version of the 2D soft threshold update. By using the weighted
Wg for thresholding, the l1 norm behaves more like a l0 norm. It is because all
the non-zero entries of g above the threshold will be calculated more equally in
the norm, similar to the deﬁnition of the l0 norm which see all non-zero entries
equally. Finally, the weights w vary depending on g. Speciﬁcally, the weights
can be updated element by element as the second step of Algorithm 3:

w

(i)
k+1 =

1
|g(i)
k | + ρ

,

(35)

where ρ > 0 is a parameter that is set slightly smaller that the expected nonzero
magnitudes of g which can be determined from experiences. This algorithm also
corresponds to minimizing a sequence of linearizations of a log-sum function

P log(||g||1 + ρ). Moreover, in practice since the reconstructed result x and its

TV g evolves gradually after each iteration, we insert the weights updating step
into the TV-IST algorithm every v iterations. Hence the weights can be updated
every v iterations and we can use the parameter v to make a tradeoﬀ between
calculation speed and weights update. Meanwhile, the auxiliary vectors h1, h2
can also be adopted to accelerate the convergence and the Reweighted TV-IST
becomes Reweighted TV-FIST.

5.3 Reweighted TV-FIST Algorithm for Nonlinear ECT

Before summarizing the Reweighted TV-FIST algorithm, we explain two tech-
niques that can be utilized to compensate the nonlinear eﬀect in our algorithm.

11

In the ECT model, the nonlinear eﬀects mainly appear in two aspects. The
ﬁrst one is the approximation of the linear model in (8). The second nonlin-
ear eﬀect lies on the accuracy of the measurements of the sensitivity matrix S.
Two techniques are introduce here to deal with the corresponding two eﬀects,
respectively [21, 22].

From (7) to (8) the quadratic term has been neglected to simplify the ECT
model from nonlinear to linear. However it causes errors due to the neglected
high order terms. To oﬀset this bias a ﬁtting curve is proposed to approach the
real measurements [21]:

△ml ≈ △ǫ · 2ǫSlV
△ǫ + 2ǫ

,

l = 1,··· , N (N − 1)/2,

(36)

where ml denotes the measurement at electrode i when electrode j is under the
voltage V while other electrodes are grounded, l = (i − 1)N + j, i < j. This
setting is to make sure that △ml = 2ǫSlV when △ǫ tends to inﬁnity and the
slope is SlV at △ǫ → 0. This approach may reduce the nonlinear error around
10% [21]. To implement it in our model, since the nonlinear sensitivity matrix
ˆS can also be generally deﬁned as

Combining (36) and (37) we have

ˆSl =

Sl,

ˆSlV = △ml/△ǫ.

2ǫ

△ǫ + 2ǫ

(37)

(38)

which adjusts S to a nonlinear sensitivity matrix ˆS, where the permittivity of
the interested area is assumed that can vary from ǫ to △ǫ whose values can be
determined before the experiments.
An adaptive sensitivity matrix model depending on the reconstructed image
also reveals its advantages in dealing with complicated distributions of nonlin-
ear ECT. A nonlinear Landweber iteration with an updated sensitivity matrix
method has been proposed [22] and we may introduce this feedback iteration to
our Reweighted TV-IST algorithm. The sensitivity map is calculated from the
potential distribution. The potential value of each pixel can be computed after
iterations using the ﬁnite diﬀerence method (FDM) depending on the potential
values of the surrounding four pixels:

P1 = φi−1,j ǫi−1,j; P2 = φi+1,j ǫi+1,j;
P3 = φi,j−1ǫi,j−1; P4 = φi,j+1ǫi,j+1;

φi,j =

P1 + P2 + P3 + P4

ǫi−1,j + ǫi+1,j + ǫi,j−1 + ǫi,j+1

.

(39)

where i, j are the location indexes. Then each sensitivity map for an electrode
pair can be expressed by

Si,j (r, c) = −I(r,c)(cid:18) ∂φi
∂r ·

∂φj
∂r

+

∂φi
∂c ·

∂φj

∂c (cid:19) drdc,

(40)

where ∂φi
the row and column vectors, respectively.

∂r , ∂φi

∂c are the gradient values of the potential value with electrode i in

Now we are able to summarize the Reweighted TV-FIST for nonlinear ECT

in Algorithm 4:

12

Algorithm 4: Reweighted TV-FIST for nonlinear ECT
Input: normalized sensitivity matrix S, normalized capacitance λ,
transform matrices G1, G2, permittivity range △ǫ, weight updating step v.
Set: max loop kmax, shrinkage parameter α, α′, weighted parameter ρ.
Initialize: g1, g2, h1, h2 are zero vectors, t0 = 1, w = 1 ∈ RN .
Iteration: for k = 0, 1,··· , kmax do
1. xk+1 = L−1(GT
2. (38) or (40), \\ update sensitivity matrix to reduce nonlinear eﬀect
3. (25) \\ calculate the steepest descent increment
4. ˆg1k+1 = h1k − α′∇f11, ˆg2k+1 = h2k − α′∇f12, \\
5. (28), (34),(23) within △ǫ threshold,(30)
6. tk+1 =
7. hik+1 = gik + 1 +(cid:16) tk−1

tk+1(cid:17) (gik+1 − gik), i ∈ {1, 2}, \\ calculate h1, h2

, \\ calculate t

1+√1+4t2

k

1 h1 + GT

2

2 h2), \\ update the image according to auxiliary vectors

8. Every v iteration, w(i)
Output: x or X.

k =

1
(i)

k |+ρ \\ update the weights

|x

This algorithm uses the TV penalties in the cost function to pursue the opti-
mal solution iteratively and meanwhile makes use of the superiority of updated
reweighted norms and auxiliary method’s fast convergence. It is distinct from
conventional FISTA for total variation minimization and designed suitable for
ECT reconstruction speciﬁcally.

6 Experiments

To test the proposed algorithm numerical simulation of recovering permittivity
distribution was performed in a ECT model. The results of reweighted TV-FIST
algorithm are compared with the performances of several widely used algorithms
in practice, which include LBP, ART (relaxed Kacmarz iteration) and SIRT
(relaxed Cimmino iteration) algorithm. All reconstructions are carried out on a
standard desktop PC with an AMD Phenom(tm) 3.0 GHz processor and 7.8 GB
RAM. The simulations are run in MATLAB 2009b and 500 iterations were run
throughout for each of these algorithms. The ECT system (normally with 8 or 12
electrodes here) was modeled using the Comsol Multiphysics software package,
and the sensitivity matrix was generated from Comsol for all reconstructions.
As in [23], the normalised capacitance was used to help minimise the eﬀect of
non-linearity introduced by the wall of the sensor [3](Yangetal.,1999).

Firstly, we implement various algorithms on a phantom consisting of an arc-
shaped part and a circular object in a 64 × 64 pixel image. In the ECT system
we use 8 electrodes, which can provide 28 independent capacitance measure-
ments.The smaller object has image intensity (a.u.) of 0.6 and the larger object
has an intensity of 1; black and white in Fig. 1 correspond to intensities of 0
and 1, respectively. From Fig. 3 we can see that the two objects can be recov-
ered by the LBP reconstruction, however the shape is signiﬁcantly smoothed
and broadened comparing with the true image in (a). The Landwever, ART
and SIRT show a similar recovered result in (c-e) with diﬀerent obvious errors
in terms of permittivity distribution. that makes precise identiﬁcation of the
boundary of the objects challenging. While in (f) using reweighted TV-FIST,
people can clearly tell the boundaries of both arc-shape and circular objects. In

13

Original

(a)

1

0.9

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0.1

0

1

0.9

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0.1

0

(b)

1

0.9

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0.1

0

1

0.9

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0.1

0

(c)

Weighted TVIST

1

0.9

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0.1

0

1

0.9

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0.1

0

(d)

(e)

(f)

Figure 3: Simulation illustrating ECT reconstruction of the ’two bubbles’ phan-
tom. (a) The original phantom image. The reconstructions are based on the
capacitance measurements with Gaussian noise added , the signal-to-tnoise ratio
is 35 dB. Reconstructions of the phantom are shown for (b) LBP reconstruction,
(c) Landweber (d) ART, (e) SIRT, (f) Reweighted TV-FIST.

addition, the intensity of permittivity inside of the objects is a constant value
but not a gradually varied value as in other algorithms. This feature consists
with the fact and makes the proposed algorithm more attractive.

In the second simulation, the ECT system consists of 12 electrodes, which
can provide 66 independent capacitance measurements. The test permittivity
distributions are the ’two bubbles’ image as shown in Fig. 4 (a). It is a phantom
image consisting of two circular objects in a 64 × 64 pixel image. The relative
permittivity of the cylindrical wall and circular object were set to 3.3 and 1,
respectively, in the simulation. (a) is diﬀerent from the normal ECT permittivity
distributions since the background is with a high permittivity material while the
two bubbles with low permittivity, which might cause technically diﬃculty for
some algorithms, such as LBP in Fig. 4 (b). Moreover, the two bubbles in
(a) are very close to each other, which makes them not easy to be distinguished
using conventional Landweber iteration, as in Fig. 4 (c). However, the proposed
reweighted TV-FIST can still recovery the permittivity distribution with better
accuracy, as shown in (g) and (h), where in (g) Gaussian-distributed noise was
added to the simulated measurements such that the peak signal-to-noise ratio
in the measurements was 40 dB.

7 Conclusion

In this paper, a nonlinear Reweighted Total Variation Image Reconstruction
Algorithm for reconstruction of images obtained from ECT measurements has
been proposed and analyzed. Not only does it penalty the l1-norm of the spatial
ﬁnite diﬀerences of the image (total variation) by using an iterative threshold-
ing approach, but also uses a varying weighted calculated in each iteration to

14

(a)

(b)

(c)

(d)

(e)

(f)

(g)

(h)

Figure 4: Simulation illustrating ECT reconstruction of the ’two bubbles’ phan-
tom. (a) The original phantom image. The reconstructions are based on the
capacitance measurements with Gaussian noise added , the signal-to-tnoise ratio
is 35 dB. Reconstructions of the phantom are shown for (b) LBP reconstruction,
(c) Landweber (d) ART, (e) SIRT, (f) TV-IST, (g) Reweighted TV-FIST with
noise, (h) Reweighted TV-FIST for Nonlinear ECT.

make sure that result converges towards to direction as same as the l0-norm. In
addition, the nonlinear eﬀect is also in consideration and we derived a straight-
forward approach to update the sensitivity matrix accordingly. The proposed
algorithm was veriﬁed on several simulated permittivity distributions with ex-
perimental phantoms and it is shown that it has a better reconstruction per-
formance than many other methods, including the conventional TV-IST. It was
shown that the new algorithm provides a substantial improvement in the demar-
cation of the boundary between regions of high and low permittivity within the
ﬂuidised bed. Simulation results demonstrated that the nonlinear Reweighted
TV-IST is able to capture the size of gas bubbles in a ﬂuidised bed accurately.

Acknowledgement

This work was partially supported by the EPSRC Grant Reference: EP/K008218/1.
Appreciate T.C. Chandrasekera and Yi Li providing partial codes in simulations
for comparison purpose.

References

[1] Q. Marashdeh, “Advances in electrical capacitance tomography,” Ph.D.

dissertation, Ohio State University, 2006.

[2] W. Q. Yang and L. Peng, “Image reconstruction algorithms for electrical
capacitance tomography,” Measurement Science and Technology, vol. 14,
no. 1, pp. R1–R3, 2003.

15

[3] W.Yang, D. Spink, T. York, and H. McCann, “An image-reconstruction
algorithm based on landweber’s iteration method for electrical-capacitance
tomography,” Measurement Science and Technology, vol. 10, no. 11, p.
1065, 1999.

[4] L. H. Peng, H. Merkus, and B. Scarlett, “Using regularization methods
for image reconstruction of electrical capacitance tomography,” Part. Part.
Syst. Charact., vol. 17, pp. 96–104, 2000.

[5] D. L. Donoho, “Compressed sensing,” IEEE Trans. Inf. Theory, vol. 52,

pp. 1289–1306, Jul. 2006.

[6] A. Beck and M. Teboulle, “Fast gradient-based algorithms for constrained
total variation image denoising and deblurring problems,” IEEE Transac-
tions on Image Processing, vol. 18, no. 11, pp. 2419–2434, Nov. 2009.

[7] T. Chandrasekera, Y. Li, J. Dennis, and D. Holland, “Total variation im-
age reconstruction for electrical capacitance tomography,” in IEEE Inter-
national Conference on Imaging Systems and Techniques (IST),, Jul. 2012,
pp. 584–589.

[8] E. Cands, M. Wakin, and S. Boyd, Journal of Fourier Analysis and Appli-

cations, vol. 14, no. 5-6, pp. 877–905, 2008.

[9] A. Beck and M. Teboulle, “A fast iterative shrinkage-thresholding algo-
rithm for linear inverse problems,” SIAM Journal on Imaging Sciences,
vol. 2, no. 1, pp. 183–202, 2009.

[10] L. I. Rudin, S. Osher, and E. Fatemi, “Nonlinear total variation based noise
removal algorithms,” Physica D: Nonlinear Phenomena, vol. 60, no. 14, pp.
259 – 268, 1992.

[11] M. Soleimani and W. R. B. Lionheart, “Nonlinear image reconstruction for
electrical capacitance tomography experimental data using,” Measurement
Science & Technology, vol. 16, no. 10, pp. 1987–1996, 2005.

[12] Y. Liu, J. Ma, Y. Fan, and Z. Liang, “Adaptive-weighted total variation
minimization for sparse data toward low-dose x-ray computed tomography
image reconstruction,” Phys. Med. Biol., vol. 57, no. 23, pp. 7923–7956,
2012.

[13] A. Chambolle, “An algorithm for total variation minimization and applica-
tions,” Journal of Mathematical Imaging and Vision, vol. 20, no. 1-2, pp.
89–97, 2004.

[14] M. Guerquin-Kern, M. Haberlin, K. Pruessmann, and M. Unser, “A fast
wavelet-based reconstruction method for magnetic resonance imaging,”
IEEE Transactions on Medical Imaging, vol. 30, no. 9, pp. 1649–1660, Sept
2011.

[15] D. L. Donoho and M. Elad, “Optimally sparse representation in general
(nonorthogonal) dictionaries via l1 minimization,” Proc. Nat. Acad. Sci.,
vol. 100, no. 5, pp. 2197–2202, Mar. 2003.

16

[16] E. Cand`es and J. Romberg, “Sparsity and incoherence in compressive sam-

pling,” Inverse Problems, vol. 23, pp. 969–985, June 2007.

[17] O. Michailovich, “An iterative shrinkage approach to total-variation image
restoration,” IEEE Transactions on Image Processing, vol. 20, no. 5, pp.
1281–1299, May 2011.

[18] Y. Wang, J. Yang, W. Yin, and Y. Zhang, “A new alternating
minimization algorithm for total variation image reconstruction,” SIAM
Journal on Imaging Sciences, vol. 1, no. 3, pp. 248–272, 2008. [Online].
Available: http://dx.doi.org/10.1137/080724265

[19] S. Boyd, N. Parikh, E. Chu, B. Peleato, and J. Eckstein, “Distributed
optimization and statistical learning via the alternating direction method
of multipliers,” Foundations and Trends in Machine Learning, vol. 3, no. 1,
pp. 1–22, 2011.

[20] M. Benning, C. Brune, M. Burger, and J. Mller, “Higher-order TV meth-
odsenhancement via bregman iteration,” Journal of Scientiﬁc Computing,
vol. 54, no. 2-3, pp. 269–310, 2013.

[21] G. Villares, L. Begon-Lours, C. Margo, Y. Oussar, J. Lucas, and S. Hole,
“A non-linear model of sensitivity matrix for electrical capacitance tomog-
raphy,” in Proceedings of the 2012 Electrostatics Joint Conference, Jun.
2010.

[22] Y. Li and W. Yang, “Image reconstruction by nonlinear landweber itera-
tion for complicated distributions,” Measurement Science and Technology,
vol. 19, no. 9, p. 094014, 2008.

[23] T. Chandrasekera, Y. Li, D. Moody, M. Schnellmann, J. Dennis, and
D. Holland, “Measurement of bubble sizes in ﬂuidised beds using electrical
capacitance tomography,” Chemical Engineering Science, vol. 126, pp. 679
– 687, 2015.

17

