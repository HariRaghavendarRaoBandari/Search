6
1
0
2

 
r
a

M
1

 

 
 
]
i
c
s
-
l
r
t

m

.
t
a
m
-
d
n
o
c
[
 
 

1
v
2
1
5
0
0

.

3
0
6
1
:
v
i
X
r
a

Improved Band Gaps from Meta-Generalized Gradient Approximations: Only in a

Generalized Kohn-Sham Scheme

Zeng-hui Yang,1 Haowei Peng,1 Jianwei Sun,1 and John P. Perdew1
1Department of Physics, Temple University, Philadelphia, PA 19122, USA

(Dated: March 3, 2016)

Unlike the local density approximation (LDA) and the generalized gradient approximation (GGA),
calculations with meta-generalized gradient approximations (meta-GGA) are usually done according
to the generalized Kohn-Sham (gKS) formalism. The exchange-correlation potential of the gKS
equation is non-multiplicative, which prevents systematic comparison of meta-GGA bandstructures
to those of the LDA and the GGA. We implement the optimized eﬀective potential (OEP) of the
meta-GGA for periodic systems, which allows us to carry out meta-GGA calculations in the same
KS manner as for the LDA and the GGA. We apply the OEP to several meta-GGAs, including
the new SCAN functional [Phys. Rev. Lett. 115, 036402 (2015)]. We ﬁnd that the KS gaps and
KS band structures of meta-GGAs are close to those of GGAs. They are smaller than the more
realistic gKS gaps of meta-GGAs, but probably close to the gaps in the exact KS band structure.
The well-known grid sensitivity of meta-GGAs is much more severe in OEP calculations.

PACS numbers: 71.15 Mb, 31.15 es

I.

INTRODUCTION

Semiconductor devices play an important role in mod-
ern technologies, and the rapid development of electronic
structure theory methods has made computational de-
sign of such devices possible. The band gap and the band
structure are undoubtly the most important properties of
semiconductors, since these are the properties that dis-
tinguish semiconductors from other periodic systems1.
Computational evaluation of the band gap and the band
structure is thus a topic of active research.

The fundamental band gap is a ground-state property,
and it is deﬁned as Eg = I − A, where I is the ioniza-
tion energy, and A is the electron aﬃnity. Eg is also an
excited-state property since it is the unbound limit of the
exciton series. Eg is very diﬃcult to calculate for peri-
odic systems, since the number of electrons approaches
inﬁnity. Many-body methods such as the GW method2
calculate Eg and the quasiparticle band structure accu-
rately, but the computational cost is high.

The density-functional theory (DFT)3–5 is a formally
exact electronic structure method for the ground-state
energy and electron density with an excellent balance of
accuracy and computational eﬃciency, which is achieved
by mapping the real interacting system to a ﬁctitious
Kohn-Sham (KS) system of non-interacting electrons
with a multiplicative eﬀective exchange-correlation (xc)
potential. Though the exact energy functional of the
DFT is unknown, there exists a plethora of approxima-
tions, which has been ordered into the ‘Jacob’s ladder’6
hierarchy. The ﬁrst and the second rungs of the Jacob’s
ladder are the local density approximation (LDA) and
the generalized gradient approximation (GGA), and they
severely underestimate the fundamental gap in periodic
systems. For periodic systems, KS DFT cannot calcu-
late Eg from its deﬁnition, and one commonly approxi-
mates Eg with the KS gap EKS
HOMO, where

LUMO −ǫKS

g = ǫKS

HOMO and ǫKS
ǫKS
LUMO are the KS orbital energies of the high-
est occupied orbital and of the lowest unoccupied orbital,
respectively. However, EKS
is not equal to Eg even with
the exact functional, due to the derivative discontinuity
(DD)7. The band gap problem has been an obstacle in
the application of DFT to periodic systems.

g

g

= ǫgKS

LUMO − ǫgKS

The generalized Kohn-Sham (gKS)8 scheme is a dif-
ferent formulation of the DFT, which allows a non-
multiplicative but still Hermitian xc potential operator.
The gKS gap EgKS
HOMO can be a better
approximation to Eg than is the KS gap9. The third rung
of the Jacob’s ladder, the meta-generalized gradient ap-
proximation (meta-GGA), is commonly implemented in
the gKS scheme according to the method of Neumann,
Nobes and Handy (NNH)10. The gKS meta-GGA band
gap of periodic systems improves11 over the KS GGA
gaps as expected. In this work we ﬁnd that, with the re-
cently proposed SCAN functional12, the gKS meta-GGA
gap corrects about 20%∼50% of the diﬀerence between
the experimental fundamental gap and the GGA KS gap.

Due to the restriction in the functional form of GGA,
a GGA cannot perform well for ﬁnite systems and pe-
riodic systems at the same time.13 On the other hand,
the functional form of meta-GGA can satisfy more ex-
act conditions and have a wider range of applicability
than the GGA form. The SCAN functional is a non-
empirical functional that satisﬁes all known exact con-
straints appropriate to a semilocal functional, and is ex-
pected to perform well for systems with very diﬀerent
kinds of bonds. The computational accuracies of the
SCAN functional for many properties improve over those
of the GGAs, with only marginal increase of computa-
tional cost.12 We ﬁnd that SCAN also improves band
gaps, but the comparsion is between meta-GGA gKS
gaps and GGA KS gaps, which are not the same quan-
tity. It is unclear whether the KS gap itself is improved,
or just the gKS gap is improved. One needs to do meta-

GGA calculations in the KS scheme to be able to have
a systematic comparsion of the KS band gaps between
meta-GGA and GGA.

In the gKS formalism for an orbital functional such as
a meta-GGA or hybrid functional, we ﬁnd the “optimal
variational potential”, a non-multiplicative self-adjoint
operator that minimizes the energy functional with re-
spect to the orbitals. This potential is a diﬀerential
operator for a meta-GGA and an integral operator for
a hybrid functional.
In the KS formalism for an or-
bital functional, we ﬁnd the optimized eﬀective poten-
tial (OEP)14,15, the multiplicative xc potential that min-
imizes the energy. The OEP meta-GGA yields the KS
gap of the meta-GGA, which can be compared directly
with the GGA KS gap. With the OEP, the meta-GGA
xc potential also becomes comparable with that of the
GGA. The OEP meta-GGA has been studied only in ﬁ-
nite systems previously.16,17

In this work, we provide the ﬁrst study of the OEP
meta-GGA in periodic systems. We ﬁnd that the meta-
GGA KS gap is not signiﬁcantly improved over the GGA
KS gaps, and the band structure of the OEP meta-GGA
is very close to that of the GGA (and presumably to that
of the exact KS potential). The xc potential of the meta-
GGA has more details than that of the GGA, but the
change is not as big as the change between the LDA and
the GGA. Though the NNH meta-GGA is known to be
sensitive to the real-space grid used in the calculation, we
ﬁnd that the OEP meta-GGA has worse grid sensitivity.
The reason for the grid sensitivity is discussed in this
work.

2

The OEP of the meta-GGA is deﬁned by the functional
derivative of the xc energy with respect to the density,
which is

vXC,σ(r) =

δEXC
δnσ(r)

=

∂eXC
∂nσ

(r) − ∇ ·(cid:20) ∂eXC

∂∇nσ

(r)(cid:21) +Z d3r′ ∂eXC

∂τσ

(r′)

.

δτσ(r′)
δnσ(r)
(4)

Eq. (4) can be partitioned into a GGA-like part and a
τ -dependent part:

vXC,σ(r) = vGGA

XC,σ (r) + vτ −dep

XC,σ (r).

XC,σ is a multiplicative potential, but vτ −dep
vGGA
have a closed form. vτ −dep

XC,σ
can be written as

XC,σ

(5)

does not

vτ −dep
XC,σ (r) =

d3r′d3r′′ ∂eXC
∂τσ

(r′)

(6)

d3kZZVcell

1

ΩBZ Xi ZBZ
×(cid:20) δτσ(r′)

δψikσ(r′′)

δψikσ(r′′)

δnσ(r)

+ c.c.(cid:21) .

On one hand, the NNH meta-GGA potential operator
is obtained by multiplying both side of Eq.
(6) by
δnσ(r)/δψik′σ′ (r1) + c.c and integrating over r:

vτ −dep
XC,σ (r)ψikσ(r) = −

∇ ·(cid:20) ∂eXC

1
2
∂τσ
XC,σ ψikσ(r).

≡ ˆvNNH

(r)∇ψikσ(r)(cid:21)

(7)

II. OEP META-GGA IN PERIODIC SYSTEMS

On the other hand, inserting

A. Theory

The meta-GGA xc energy functional has the form

EXC[n↑, n↓, ∇n↑, ∇n↓, τ↑, τ↓] =Z d3reXC(r),

δψikσ(r′′)

δnσ(r)

= ZVcell

d3r1

δψikσ(r′′)
δvS,σ(r1)

δvS,σ(r1)
δnσ(r)

,

(8)

(1)

where vS is the KS potential, into Eq. (6) yields the OEP
integral equation for vτ −dep
XC,σ :

where eXC is the xc energy density, and nσ and τσ are
the spin density and the kinetic energy density of spin σ
respectively. nσ and τσ are

nσ(r) =

τσ(r) =

1

ΩBZ Xi ZBZ
2ΩBZ Xi ZBZ

1

d3k θiσ(k) |ψikσ(r)|2 ,

(2)

d3k θiσ(k) |∇ψikσ(r)|2 ,

(3)

where ΩBZ is the volume of the ﬁrst Brillouin zone (BZ),
i is the band index, ψikσ is the KS orbital normalized in
one unit cell, and θiσ(k) = θ[EF − ǫikσ] is the Heaviside
step function, with EF being the Fermi energy, and ǫikσ
being the KS orbital energy. The non-interacting kinetic
energy density of the Kohn-Sham orbitals is, like the or-
bitals themselves, a functional of the electron density.

d3r vτ −dep

XC,σ (r)

δnσ(r)
δvS,σ(r1)

+ c.c.

ZVcell
ΩBZ Xi ZBZ

1

=

d3kZZVcell

d3r′d3r′′ ∂eXC
∂τσ

(r′)

δτσ(r′)

δψikσ(r′′)

δψikσ(r′′)
δvS,σ(r1)

+ c.c..

(9)

Though a direct solution for the OEP is possible18, it
is both computationally expensive and numerically un-
stable. The common practice is to approximate the
solution of Eq.
16 and 17 employ the
local-Hartree-Fock (LHF)19 and the Krieger-Li-Iafrate
(KLI)20 approximations, respectively, to derive approx-
imated vτ −dep
of meta-GGA for ﬁnite systems. Here
we do the derivation with the eﬀective local potential
(ELP)21,22 approximation. The ELP is equivalent to the

(9). Refs.

XC,σ

LHF and the common-energy-denominator approxima-
tion (CEDA)23,24, and the KLI approximation is their
simpliﬁcation.

The ELP minimizes the matrix norm of the commu-
XC,σ , and

ΩBZ PiR d3k θiσ(k) |ψikσi hψikσ| is the spin den-

tator Sσ = [ ˆDσ, ˆρσ], where ˆDσ = vτ −dep
ˆρσ = 1
sity matrix.
ˆρσ becomes valid for both the KS and
the gKS system when Sσ = 0. Sσ is minimized when
δSσ/δvτ −dep
XC,σ (r) = 0, which yields the ELP approxima-
tion of vτ −dep
XC,σ :

XC,σ − ˆvNNH

θiσ(k)ψ∗

ikσ(r)ˆvNNH

XC,σ ψikσ(r)

d3knXi

θiσ(k)θjσ(k′)ψ∗

ikσ(r)ψjk′σ(r)

(10)

vτ ELP
XC,σ (r) =

IBZ

1

1

+

vτ ELP
XC,σ (r) =
1

2ΩBZnσ(r) ZBZ
ΩBZ ZBZ
×Dψjk′σ(cid:12)(cid:12)(cid:12)

d3k′Xij
ˆDσ(cid:12)(cid:12)(cid:12)

ψikσEo + c.c.

The ELP approximates the OEP in a least-squares
sense22.

Ref. 22 shows that the ELP approximation is equiv-
alent to the CEDA, which reduces to the KLI approxi-
mation by setting i = j in Eq. (10)23. If only the ﬁrst
term of Eq. (10) is kept, one obtains the so-called Slater
approximation25.

B.

Implementation in the BAND code

The most eﬃcient methods for calculating periodic sys-
tems are pseudopotential methods with planewave basis
sets, such as the PAW method26,27, but the OEP is hard
to implement in such codes. The sum over bands in Eq.
(10) also includes the core bands, which are not directly
available in pseudopotential codes. Furthermore, the
OEP is inherently incompatible with the PAW formalism.
The charge density in the PAW formalism is composed
of the pseudo-charge-density, the on-site all-electron den-
sity, and the on-site pseudo-charge-density26,27, and the
xc energy and potential are partitioned into three parts
accordingly, with each part only depending on the cor-
responding part of the density. However, the OEP of
meta-GGA is hard to partition this way. Due to these ob-
stacles, we implement the OEP meta-GGA in the BAND
code28–32.

BAND is an all-electron DFT code for periodic sys-
tems. It uses atom-centered numerical functions as the
basis set. All the real-space integrations are done numer-
ically on a Becke fuzzy-cell grid33. The BZ is discretized
with the commonly used Monkhorst-Pack grid34, so the
k-integrations of Eq. (10) become sums over k-points in

3

w˜kfi˜kσgiσ( ˆR−1 ˜k)

the irreducible Brillouin zone (IBZ):

1

ΩBZ Z d3k giσ(k)θiσ (k) =

1
NG

IBZ

X˜k XˆS

(11)
where giσ(k) is the contribution to the integral from
the orbital ψikσ, fi˜kσ is the occupation number, w˜k is
the weight of the k-point times the k-space integration
weight in BAND29, NG is the total number of symme-
try operations, ˆS = { ˆR, t} is the space-group symmetry
operator, and ˆR is the rotational part of ˆS.

The ˆDσ matrix elements in Eq. (10) vanish for k 6= k′,
since ˆDσ has the perodicity of the unit cell. Eq. (10) is
implemented in the BAND code as

NGnσ(r)

× ℜ( −

+

∂eXC
∂τσ

1
2

ψ∗

w˜kfi˜kσ

∂eXC
∂τσ

(r) · ˆR−1∇r′ ψi˜kσ(r′)|r′= ˆSr

X˜k XˆS Xi
i˜kσ(r)(cid:20)∇r
(r) tr n ˆR−1 ·(cid:2)∇r′ ⊗ ∇r′ ψi˜kσ(r′)(cid:3) · ˆRo(cid:12)(cid:12)(cid:12)r′= ˆSr(cid:21)
i˜kσ( ˆSr)ψj ˜kσ( ˆSr)(Iij ˜kσ − Jij ˜kσ)),

fj ˜kσψ∗

+Xj

(12)

(13)

where I and J are

Iij ˜kσ = ZVcell
2 ZVcell

Jij ˜kσ =

1

d3r ψ∗

i˜kσ(r)vτ ELP

XC,σ (r)ψj ˜kσ(r),

d3r

∂eXC
∂τσ

(r)∇ψ∗

i˜kσ(r) · ∇ψj ˜kσ(r),

(14)

and ∇r′ ⊗∇r′ψi˜kσ(r′) denotes the Hessian matrix of ψi˜kσ.
The integrals are done as discrete sums on the real-space
grid. The Iij ˜kσ depend on vτ ELP
XC,σ , which is unknown
beforehand. They can be determined by solving linear
equations16, but this is costly for perodic systems. In-
stead, we determine the I integrals and vτ ELP
XC,σ iteratively
by the following steps:

1. Set the I integrals to 0.

2. Calculate vτ ELP

XC,σ with Eq. (12) using the I integrals

of the last iteration.

3. Calculate the I integrals using the new vτ ELP
XC,σ .

4. Repeat

if
> T , where
is the iteration count, and T is the error

step
(r) − vτ ELP(i−1)

vτ ELP(i)
XC,σ

and

XC,σ

2

3

R d3r(cid:12)(cid:12)(cid:12)

i
tolerance.

(r)(cid:12)(cid:12)(cid:12)

vτ ELP
XC,σ is only determined up to an additive constant c,
since vτ ELP
XC,σ + c yields the same band structure. c has to
be ﬁxed for determining the convergence. The I integrals
contain vτ ELP
XC,σ , so their values include c. We ﬁx c by re-
quiring that the term of vτ ELP
XC,σ containing the I integrals
averages to 0, i.e. the constant c is determined by

1

Vcell ZVcell

d3r

1

NGnσ(r)

IBZ

X˜k XˆS Xi

w˜kfi˜kσXj

fj ˜kσ

× ψ∗

i˜kσ( ˆSr)ψj ˜kσ( ˆSr)(cid:16)Iij ˜kσ + cδij(cid:17) = 0

(15)

In practice, the iterative procedure converges after 200
iterations on average for T = 10−10.

Ref. 24 ﬁnds that the total energies and orbital en-
ergies obtained from CEDA and KLI are very close for
atoms and molecules. We ﬁnd that the same is true for
periodic systems. The ELP is equivalent to the CEDA22,
and its total energy is always lower than that of the KLI,
but the total energy diﬀerences and the KS gap diﬀer-
ences of the materials in Table I between that of the
ELP and that of the KLI are at most 1 meV. Since the
improvement of the ELP over the KLI is insigniﬁcant, we
only report the KLI results in the following.

III. RESULTS

We calculate the KS and gKS gaps of 20 semiconduc-
tors and insulators with the SCAN, MS235,36, MVS37
and TPSS38 meta-GGAs and the PBE39 GGA, and the
results are collected in Table I. Ge, CdO, and InN are
not listed since their calculated gaps vanish. All the cal-
culations are done with the TZ2P basis set40. A 9 × 9 × 9
Monkhorst-Pack k-grid34 is used for most of the mate-
rials except InN, CdS and CdSe, for which a 9 × 9 × 5
k-grid is used. We ﬁnd that the OEP meta-GGA is sen-
sitive to the real-space grid, and large grids are used to
ensure convergence. The details of the grid problem are
discussed in Section IV. Though GGA and NNH meta-
GGA converge properly with smaller grids, we use the
same grid as the OEP meta-GGA, so that the results are
comparable.

The scalar relativistic eﬀect is included in the calcula-
tions by the ZORA41 method. We ignore the spin-orbit
coupling since the eﬀect is small (0.03 eV for InP). The
relativistic eﬀect is implicitly included through the pseu-
dopotential in planewave codes, but it needs to be explic-
itly included in BAND. We ﬁnd that the scalar relativis-
tic eﬀect has a big impact on the KS and gKS gaps, since
it shifts down the orbital energies of s-type bands, such
as the lowest conduction band of GaAs42. The change in
the KS and gKS gaps due to the scalar relativistic eﬀect
can be as big as 0.7 eV (GaAs).

Figs. 1 and 2 compare the OEP of SCAN meta-GGA
and the LDA and the PBE xc potentials for the Ne atom
and bulk Si, respectively. The exact xc potential of the

4

Ne atom43 is plotted as a reference. The exact xc poten-
tial of Ne has a bump between the two shells of the charge
density. The vXC of LDA does not have this feature. The
vXC’s of PBE and SCAN both have this bump, and they
are roughly in the same position as that of the exact vXC,
but these vXC’s are shallower than the exact vXC. The
vXC’s of SCAN also have a few small bumps that are not
in the exact vXC. In the asymptotic region, the exact vXC
decays as −1/r, and the vXC’s of all the semi-local func-
tionals decay exponentially. Fig. 1 shows that the vXC of
SCAN has the same decay as that of LDA and PBE. For
periodic systems, there is no asymptotic region, and the
approximated vXC’s of bulk Si in Fig. 2 can be expected
to be closer to the exact vXC than those in Fig. 1. In
Fig. 2, the vXC of SCAN are similar to the vXC of PBE,
and they only diﬀer in small details. Similar to Fig. 1,
the vXC’s of SCAN for bulk Si also have small bumps.
Though the meta-GGA is a higher rung functional on
the Jacob’s ladder than the GGA, the improvement in
vXC is small going from GGA to meta-GGA, unlike go-
ing from LDA to GGA. The diﬀerences between the KS
meta-GGA gaps and the PBE gaps in Table I are small
as a consequence.

 0

−1

−2

)
.

u
.
a
(
 

c
x

v

exact
LDA
PBE
ELP SCAN

 1

 0

 0.5

r (Å)

FIG. 1. Comparison of vXC’s of the Ne atom for SCAN, LDA,
and GGA. The exact vXC is from Ref. 43.

The band structures of Si and GaAs calculated with
PBE and SCAN are plotted in Figs. 3 and 4. The
KLI SCAN band structure is very close to the PBE band
structure, due to the corresponding vXC being similar to
the PBE vXC. The NNH SCAN band structure has the
same overall shape as that of the PBE and the KLI, and
the main diﬀerence is in the band gap.

Though the NNH meta-GGA band gaps improve over
the PBE gaps in general, it is disappointing that NNH
meta-GGA gaps for Ge, InN, and CdO still vanish. How-
ever, it is possible for meta-GGAs to open the gap for
gapless materials in GGA. NNH SCAN has52 a 0.4 eV
gap for β-MnO2, which is gapless in GGA, and the value
is close to the experimental value 0.3 eV. The M06L
metaGGA was reported to open the gap of Ge at 0.14
eV.11

The improvement of the band gap occurs since the
NNH meta-GGA band gap is a gKS gap instead of a

solid Ar LiF NaCl MgO CaO BN Cc

ZnS β-GaN CdS GaP BP CdSe BAs GaAs

InP

Si

5

Material
1. ∆E = EKLI
Nr
∆E(eV)

Nr
∆E(eV)

SCAN
69
0.06
537

169
0.09
705

SCAN − EPBE orb.

of diﬀerent number of radial grid points Nr.

137
0.10
571
-0.003 -0.01 -0.005 -0.002 -0.01 -0.02 -0.02 -0.006 -0.03 -0.0007 -0.002 -0.02 -0.05 -0.02 -0.01 -0.001 -0.02

74
0.27 0.17 0.0008
571

87
169
0.01 0.03
672
672

87
0.54
672

74
0.59
571

96
0.14
739

91
0.05
705

177
0.06
739

209
0.03
873

96
0.17
739

82
0.22
638

74
0.03
571

504

638

65

153

2. Band gaps and derivative discontinuities. ∆XC = ENNH
6.2
Exp. gap(eV)
5.5
4.53 4.17
PBE(eV)
HSE(eV)
5.39 4.94

8.97
13.6
9.04
5.08
11.40 6.42

14.3
8.92
10.33

6.93
3.75
5.30

7.9
4.74
6.46

g

g

− EKLI

.

3.72
2.12
3.32

3.17
1.69
2.97

NNH SCAN(eV)
KLI SCAN(eV)
SCAN ∆XC(eV)
NNH MS2(eV)
KLI MS2(eV)
MS2 ∆XC(eV)
NNH MVS(eV)
KLI MVS(eV)
MVS ∆XC(eV)
NNH TPSS(eV)

4.29
3.78
0.50
4.13

5.86
9.97
5.25
9.11
0.86
0.61
9.50a 5.85
9.84
6.51

2.03
2.63
5.04 4.58
5.62
9.91
1.84
2.16
4.73 4.26
4.80
8.89
0.20
0.47
0.30 0.32
0.82
1.02
1.69
2.52
5.20
5.01 4.79
9.95
5.47 N/Ab 4.56 4.16
9.36
1.70
2.08
-0.01
0.45
0.58 N/A -0.66 -0.27 N/A 0.45 0.62
2.50
5.14 4.15
10.98
3.35
4.58 4.06 N/Ab
1.89
9.19
0.56 0.09 N/A 0.62
1.80
9.56
4.54 4.20
1.60

10.64 6.61
4.68
8.77
1.93
1.86
9.19
5.43

6.05
4.58
1.47
4.86

4.56
3.51
1.05
3.89

2.30

2.48
1.23
2.27

1.62
1.20
0.42
1.60
1.27
0.33
2.39
1.50
0.88
1.43

2.35
1.69
2.09

1.94
1.72
0.21
1.97
1.73
0.24
2.23
1.74
0.49
1.74

2.1
1.43
1.79

1.73
0.71
1.66

1.6d
1.52
1.26 0.53
1.71 1.41

1.42
0.72
1.52

1.10
0.76
0.33
1.06

1.06
1.51 0.80
1.74
0.77
1.32 0.45
1.52
0.29
0.19 0.34
0.22
1.14
1.94
1.63 0.94
1.49 N/Ab 1.33 0.48
0.81
0.34
0.46 N/A 0.30 0.46
1.56 2.15a
1.99
1.64
1.16 1.26
1.42
1.09
0.40 N/A 0.89
0.22
1.48
1.26 0.68
0.86

2.14
0.50
1.64
0.92

MAE

1.17
0.71 1.90
1.11 0.82

0.97 1.41
0.78 1.84
0.19
1.20 1.28
0.80 1.63
0.41
1.04 1.13
0.72 1.89
0.32
0.80 1.76

a converged to the wrong ground state
b not converged
c diamond
d GW gap

TABLE I. The total energy diﬀerences between KLI SCAN and SCAN with PBE orbitals of diﬀerent grids, and calculated
KS/gKS gaps and the derivative discontinuities. The experimental gaps are from Ref. 44. The BAs GW gap is from Ref. 45.
The mean absolute errors (MAE) for the band gaps are listed. HSE46,47 gaps calculated with the VASP27,48–51 code are also
listed for reference. The PBE and SCAN gaps of Ge, CdO, and InN are vanishing, so they are not listed. Their experimental
gaps are 0.74 eV, 0.84 eV, and 1.95 eV, respectively. Their HSE gaps are 0.65 eV, 0.94 eV, and 0.77 eV, respectively. The KLI
TPSS results are not listed as most calculations fail to converge.

)
.

u
.
a
(
 

c
x

v

−0.5

−1

−1.5

−2

−2.5

LDA
PBE
KLI SCAN

 0

 1

 2

r (Å)

 3

FIG. 2. Comparison of vXC’s of bulk Si along the Si-Si bond
for SCAN, LDA, and GGA. The Si atoms are located at r = 0
and r = 2.35˚A. The vertical dashed line is a numerical artifact
and does not aﬀect the band structure.

KS gap, and the gKS gap is an approximation to the
fundamental gap of the meta-GGA. A Janak-type53 the-
orem has been proven for the OEP9, and it states that
the gKS gap approximately equals the fundamental gap
for the same functional, assuming ﬁxed orbitals. This as-
sumption does not apply to ﬁnite systems, but it is true

for periodic systems, since the charge density and the or-
bitals of a periodic system undergo only an inﬁnitesimal
change when the number of electrons changes by one.

GGA band gaps should be compared with the OEP
meta-GGA band gaps for a fair comparison between ap-
proximated functionals, since the OEP meta-GGA band
gap is the KS gap. The SCAN functional is the only
functional that satisﬁes all the known exact conditions,
but the KLI SCAN gaps do not have signiﬁcant improve-
ments over the PBE gaps. This is probably due to the
fact that the GGA and SCAN OEP gaps closely approx-
imate the exact KS gap, which underestimates the fun-
damental gap.

Some of the NNH band gaps of MS2 and TPSS are
smaller than the corresponding OEP band gaps. We do
not ﬁnd this behavior in other functionals. Many of the
KLI TPSS calculations fail to converge. This is probably
a numerical issue in the calculation of ∇(∂eXC/∂τσ), due
to the complicated funcitonal form of TPSS.

The energy functional of the exact DFT has derivative
discontinuities ∆XC at integer electron numbers7, where
∆XC = Eg − EKS
g . The exact KS potential jumps up by
the positive constant ∆XC as the electron number crosses
the value that makes the solid electrically neutral. LDA
and GGA miss much or all of the derivative disconti-

)

V
e
(
 
E

 8

 4

 0

−4

−8

L

PBE
NNH SCAN
KLI SCAN

X U,K

k

FIG. 3. The band structure of Si calculated with PBE, NNH
SCAN, and KLI SCAN.

)

V
e
(
 
E

 8

 4

 0

−4

−8

L

PBE
NNH SCAN
KLI SCAN

X

U,K

k

FIG. 4. The band structure of GaAs calculated with PBE,
NNH SCAN, and KLI SCAN.

nuity due to the convexity of the approximated energy
functional54, and they underestimate the gap as a conse-
quence. In periodic systems, such discontinuities are only
visible at band gaps. Though the derivative discontinuity
has been thoroughly studied for atoms and molecules, it
is diﬃcult to obtain for periodic systems, since I and A
cannot be calculated directly.

With the OEP meta-GGA provided in this work, we
are able to estimate the ∆XC of solids. Eg can be ap-
proximated by the derivative gap Ederiv
= ∂E/∂N |N+ −
∂E/∂N |N−, which is equal to the NNH meta-GGA
gap9,54,55. EKS
is the OEP meta-GGA gap. The results
are shown in Table I.

g

g

Comparison of the ∆XC’s of meta-GGAs with the exact
∆XC is impossible for periodic systems, since no exact KS
potential is available. However, Ref. 56 provides an OEP
of the GW method of bulk Si, and its ∆XC can be seen
as a good approximation to the exact ∆XC. The ∆XC of
bulk Si in Ref. 56 is 0.58 eV, which is larger than that
of all the meta-GGAs in Table I. This is not unexpected
because the meta-GGA’s tested in this work are not exact

for I − A in a solid.

6

IV. REAL-SPACE GRID DEPENDENCY

The NNH meta-GGA requires a larger real-space in-
tegration grid than GGA57, and this is caused by the
sharp variation in regions far away from nuclei of quan-
tities containing τ , such as z = τ W /τ used in TPSS, and
α = (τ − τ W )/τ0 used in SCAN, MS2 and MVS, where
τ W = |∇n|2 /(8n) is the von Wiezs¨acker kinetic energy
density, and τ0 = (3/10)(3π2)2/3n5/3 is the kinetic energy
density of the uniform electron gas. The Becke fuzzy-cell
grid is used as the real-space integration grid in most of
the DFT codes.
It is constructed by combining atom-
centered spherical grids. The radial part of the spherical
grid is dense near the nuclei, and is sparse away from
the nuclei. The integration weights for the grid points
in the sparse region would be larger than those in the
dense region. Therefore a function with sharp features in
regions away from the nuclei cannot be properly repre-
sented on the grid, and the error of integrations involving
this function would be large. One needs larger grids in
NNH meta-GGA calculations than those used in GGA
calculations.

We ﬁnd that the OEP meta-GGA is more sensitive to
the real-space integration grid than the NNH meta-GGA.
In the NNH case, the sensitivity to the grid shows up in
the potential energy surface57,58 as spurious oscillations,
but the sensitivity is not obvious in a single-point cal-
culation. In the OEP case, a single-point calculation is
enough to demonstrate the grid sensitivity by comparing
the total energy. The total energy of the OEP meta-GGA
is variationally minimized with respect to the charge den-
sity, but the total energy of the NNH meta-GGA is varia-
tionally minimized with respect to the orbitals. Since the
NNH has bigger variational degrees of freedom, the NNH
total energy should always be lower than the OEP total
energy, and both should be lower than the meta-GGA to-
tal energy evaluated with non-variational orbitals. How-
ever, though the built-in integration grids in the BAND
code are good enough for NNH calculations, they are not
suﬃcient for an OEP calculation: the OEP total energy
calculated with these grids is always higher than the to-
tal energy evaluated with PBE orbitals. For example, the
best built-in grid in BAND for the Ne atom has 120 ra-
dial points, but at least 266 radial points are required for
the SCAN OEP total energy to be lower than the SCAN
total energy evaluated with PBE orbitals, and 504 ra-
dial points are required for the SCAN OEP total energy
to converge with respect to the grid (error<0.01 meV).
The total energy is not sensitive to the number of angu-
lar grid points. Table I lists the total energy diﬀerences
using diﬀerent grids.

The OEP vXC of the Ne atom, Ar2 dimer, and bulk Si
(along the Si-Si bond) are plotted in Figs. 5, 6, and 7.
The OEP vXC develops unnatural peaks close to nuclei
when too few grid points are used. These peaks have a

L
G
D
S
G
L
G
D
S
G
strong eﬀect on the KS band gap and the total energy.
For bulk Si with 134 points (dashed line in Fig. 7), the
system becomes gapless.

The grid-dependence of the OEP meta-GGA is caused
by ∇∂eXC/∂τσ in Eq. (12). Figs. 5, 6, and 7 show that
∇∂eXC/∂τσ has very sharp oscillations both close to and
away from the nucleus. The dots in these plots show the
grid point locations when the calculation is done with a
built-in grid in BAND. These grid points are suﬃcient
for an NNH meta-GGA calculation since they are dense
enough to properly describe the oscillations in α, but
they are insuﬃcient for an OEP meta-GGA calculation
since the peaks in ∇∂eXC/∂τσ are much narrower than
those of α.

 2

 1

 0

−1

−2

−3

−4

(¶ /¶ r)(¶ exc/¶
(¶ /¶ r)(¶ exc/¶

vxc (Nr=65)
vxc (Nr=504)
) (Nr=65)
) (Nr=504)
 (Nr=65)
 (Nr=504)

 0

 0.5

 1

 1.5

 2

 2.5

r (Å)

FIG. 5. The ELP SCAN vXC (a.u.), the radial component
of ∇∂eXC/∂τ (a.u.), and α of the Ne atom evaluated with
two diﬀerent grids. The solid lines are results obtained by
using 504 radial grid points, and the dots and dashed lines
are results obtained by using 65 radial grid points.

 4

 3

 2

 1

 0

−1

−2

−3

−4

(¶ /¶ x)(¶ exc/¶
(¶ /¶ x)(¶ exc/¶

vxc (Nr=134)
vxc (Nr=806)
) (Nr=134)
) (Nr=806)
 (Nr=134)
 (Nr=806)

 0

 1

 2

 3

 4

 5

x (Å)

FIG. 6. The KLI SCAN vXC (a.u.), the x component of
∇∂eXC/∂τ (a.u.), and α of the Ar dimer evaluated with two
diﬀerent grids, plotted along the Ar-Ar axis. The Ar atoms
are located at x = ±1.88˚A, so that comparison with Ref. 57
is possible. Since the system is symmetric, only the x ∈ [0, 4]
part is plotted. The solid lines are results obtained by us-
ing 806 radial grid points, and the dots and dashed lines are
results obtained by using 134 radial grid points.

7

 2

 1

 0

−1

−2

−3

−4

(¶ /¶ x)(¶ exc/¶
(¶ /¶ x)(¶ exc/¶

vxc (Nr=134)
vxc (Nr=806)
) (Nr=134)
) (Nr=806)
 (Nr=134)
 (Nr=806)

 0

 1

 2

r (Å)

 3

FIG. 7. The KLI SCAN vXC (a.u.), the x component of
∇∂eXC/∂τ (a.u.), and α of bulk Si evaluated with two diﬀerent
grids, plotted along the Si-Si bond. The Si atoms are located
at r = 0 and r = 2.35˚A. The solid lines are results obtained
by using 571 radial grid points, and the dots and dashed lines
are results obtained by using 134 radial grid points.

Fig. 8 shows ∇∂eXC/∂τ of the Ne atom for SCAN,
TPSS, MS2, and MVS functionals. Though ∇∂eXC/∂τ
of all functionals have oscillations, the sharpness of the
peaks is diﬀerent, and consequently the numbers of grid
points required for convergence are also diﬀerent: SCAN
has very sharp peaks, and it requires 352 points to con-
verge the total energy within 1% error; The peaks in MVS
are broader, and it only requires 252 points to converge
with the same error criterion.

The oscillations in ∇∂eXC/∂τ for SCAN, MS2 and
MVS are centered at or close to α = 1 in Fig. 8. All
these functionals use α to incorporate the kinetic energy
density into the functional, and their energy densities all
have the form eXC = exc,1 + f (α)(exc,0 − exc,1), where exc,0
and exc,1 are eXC constructed for α = 0 and α = 1, and
f (α) is an interpolation function that decreases mono-
tonically with α from 1 at α = 0 to 0 at α = 1 to nega-
tive values for α > 1. The oscillation in ∇∂eXC/∂τ then
implies a peak in df (α)/dα. α = 1 corresponds to the
uniform electron gas limit, and the f (α) of SCAN and
MS2 are constructed to have d2f (α)/dα2 = 0 there to re-
cover the gradient expansion approximation35. Therefore
df (α)/dα has a ﬂat- or linearly-topped peak at α = 1,
which explains the oscillation. For MVS, d2f (α)/dα2
vanishes at α = 0.77, and its oscillation in ∇∂eXC/∂τ oc-
curs there. By choosing other functional forms for f (α),
it is possible to get rid of the oscillations and the grid
sensitivity. TPSS does not have this feature since it uses
z instead of α.

Even though a small grid cannot properly represent
the oscillations in ∇∂eXC/∂τ , Fig. 9 shows that the vXC
of the Slater approximation (which contains ∇∂eXC/∂τ
explicitly) evaluated on a small grid is already similar to
the KLI vXC evaluated on a big grid. The KLI approxi-
mation is supposed to be an improvement over the Slater
approximation, but it introduces big errors in vXC when
using a small grid. The grid sensitivity actually enters

t
t
a
a
t
t
a
a
t
t
a
a
 2

 1

 0

)
.
u
.
a
(
 
)

/

c
x

e

(
)
r

/

(¶

−1

−2

 0

SCAN
MS2
MVS
TPSS

 0.5

 1

 1.5

r (Å)

FIG. 8. The radial component of ∇∂eXC/∂τ of the Ne atom of
diﬀerent functionals. α’s of diﬀerent functionals are similar,
so only that of SCAN is plotted.

the OEP indirectly through the I integrals of Eq. (14).
Since the Slater term contains ∇∂eXC/∂τ , the I integrals
cannot be done accurately with a small grid.

The NNH meta-GGA potential operator in Eq.

(7)
also contains ∇∂eXC/∂τ , but the grid sensitivity of NNH
is much lower than that of OEP. There is no contradiction
since ∇∂eXC/∂τ does not have to be evaluated directly in
NNH meta-GGA. Using integration by parts, the matrix

elements (cid:10)ψikσ(cid:12)(cid:12)ˆvNNH

−

1

2Z d3rψ∗

XC,σ(cid:12)(cid:12) ψjkσ(cid:11) becomes
ikσ(r)∇ ·(cid:20) ∂eXC
2Z d3r

∂eXC
∂τσ

(r)∇ψ∗

∂τσ

1

(r)∇ψjkσ(r)(cid:21)

=

ikσ(r) · ∇ψjkσ(r),

(16)

and ∂eXC/∂τ is less sensitive to the grid than ∇∂eXC/∂τ .
The grid sensitivity of the OEP is also expected to
show up in the time-dependent density-functional theory
(TDDFT)59 with a meta-GGA xc kernel.

)
.

u

.
a
(
 

c
x

v

 0

−1

−2

−3

−4

 0

KLI (Nr=134)
KLI (Nr=806)
Slater (Nr=134)

 1

 2

r (Å)

 3

FIG. 9. KLI SCAN vXC of bulk Si along the Si-Si bond. The
Si atoms are located at r = 0 and r = 2.35˚A.

Aside from the grid problem, we ﬁnd that the OEP
meta-GGA in general needs more self-consistent-ﬁeld
(SCF) cycles to reach convergence than the NNH meta-

8

GGA. For small gap materials, the OEPs of some meta-
GGA functionals do not converge, while the correspond-
ing NNH calculations converge normally. We tested
SCAN, MS2, MVS, and TPSS functionals, and SCAN
has the least convergence problem.

V. CONCLUSION

In conclusion, we implemented the ELP and the KLI
approximations for the OEP meta-GGA of periodic sys-
tems, with which we study the meta-GGA band gaps
of 20 semiconductors and insulators. Comparing with
the GGA band gaps, the new SCAN meta-GGA in a
generalized Kohn-Sham (NNH) scheme is found to im-
prove the band gaps over the GGA band gaps. The
non-empirical SCAN meta-GGA outperforms the non-
empirical PBE GGA, not only for diversely-bonded ma-
terials near equilibrium12, but also for the band gaps of
solids. The improvement is achieved without using the
expensive exact exchange, as in fourth-rung hybrid func-
tionals. For materials wrongly predicted to be gapless
in GGA, the result52 of β-MnO2 with SCAN shows that
meta-GGAs can open the gap.

Consider the ratio of the calculated to the experimental
energy gap. For the 17 solids of Table I, this ratio varies
from 0.35 to 0.79 with an average of 0.60 for the PBE
GGA, from 0.53 to 0.94 with an average of 0.73 for the
SCAN meta-GGA, and from 0.72 to 1.07 with an average
of 0.89 for the HSE hybrid functional. The ratio improves
uniformly from PBE to SCAN to HSE. While the hybrid
functional is more accurate for the gap than SCAN is, it is
also more empirical and more computationally expensive.

For periodic systems, the OEP or ungeneralized Kohn-
Sham vXC’s of meta-GGAs are close to the GGA vXC’s,
and they only diﬀer in small details. Consequently the
OEP meta-GGA gaps are not improved signiﬁcantly over
the GGA gaps, and the band structures of OEP meta-
GGAs are similar to those of GGAs. We think it is likely
that the band gap and band structure in the exact Kohn-
Sham potential are close to those of GGA and OEP meta-
GGA in periodic systems. Aside from the band gap, the
NNH meta-GGA band structures are also similar to the
GGA band structures.

Due to the sharp features in ∇∂eXC/∂τσ, the OEP
meta-GGA is sensitive to the real-space grid used in com-
putation, more so than the NNH meta-GGA. Diﬀerent
meta-GGAs have diﬀerent requirements for the minimal
grid, and in general SCAN needs the biggest grid to con-
verge in the meta-GGAs tested in this work. TDDFT
with meta-GGA xc kernels is also expected to show this
grid sensitivity. It is possible to avoid the grid sensitivity
in the design of the functional, although this may inter-
fere with the satisfaction of some exact conditions.

¶
¶
¶
t
a
ACKNOWLEDGEMENTS

ZY, JS and JPP are supported by the National Science
Foundation(Grant No. DMR-1305135). HP, JS, and JPP
are also supported by the Center for the Computational

Design of Functional Layered Materials, an Energy Fron-
tier Research Center (EFRC) funded by the U.S. Depart-
ment of Energy, Oﬃce of Science, Basic Energy Sciences
under Award No. DE-SC0012575. The EFRC grant con-
tributed to the computational aspects of this work.

9

1 P. Y. Yu and M. Cardona, Fundamentals of semiconduc-
tors: physics and materials properties (Springer, Berlin,
2010).

2 L. Hedin, Phys. Rev. 139, A796 (1965).
3 P. Hohenberg and W. Kohn, Phys. Rev. 136, B864 (1964).
4 W. Kohn and L. J. Sham, Phys. Rev. 140, A1133 (1965).
5 C. Fiolhais, F. Nogueira, and M. Marques, eds., A primer
in density functional theory, Lecture notes in physics
(Springer, Berlin, 2003).

6 J. P. Perdew and K. Schmidt, in Density functional theory
and its application to materials, edited by V. van Doren,
C. van Alsenoy, and P. Geerlings (AIP Press, New York,
2001).

7 J. P. Perdew, R. G. Parr, M. Levy, and J. L. J. Balduz,

Phys. Rev. Lett. 49, 1691 (1982).

8 A. Seidl, A. G¨orling, P. Vogl, J. A. Majewski, and M. Levy,

Phys. Rev. B 53, 3764 (1996).

9 M. E. Casida, Phys. Rev. B 59, 4694 (1999).
10 R. Neumann, R. H. Nobes, and N. C. Handy, Mol. Phys.

87, 1 (1996).

11 Y. Zhao and D. G. Truhlar, J. Chem. Phys. 130, 074103

(2009).

29 G. Wiesenekker and E. J. Baerends, J. Phys.: Cond. Matt.

3, 6721 (1991).

30 M. Franchini, P. H. T. Philipsen, and L. Visscher, J. Com-

put. Chem. 34, 1818 (2013).

31 M. Franchini, P. H. T. Philipsen, E. van Lenthe,

and

L. Visscher, J. Chem. Theory Comput. 10, 1994 (2014).

32 P. H. T. Philipsen, G. te Velde, E. J. Baerends, J. A.
Berger, P. L. de Boeij, M. Franchini, J. A. Groen-
eveld, E. S. Kadantsev, R. Klooster, F. Kootstra, P. Ro-
maniello, D. G. Skachkov, J. G. Snijders, C. J. O.
Verzijl, G. Wiesenekker,
and T. Ziegler, “Band2014
(a modiﬁed version is used),” SCM, Theoretical Chem-
istry, Vrije Universiteit, Amsterdam, The Netherlands,
http://www.scm.com.

33 A. D. Becke, J. Chem. Phys. 88, 2547 (1988).
34 H. J. Monkhorst and J. D. Pack, Phys. Rev. B 13, 5188

(1976).

35 J. Sun, B. Xiao, and A. Ruzsinszky, J. Chem. Phys. 137,

051101 (2012).

36 J. Sun, R. Haunschild, B. Xiao, I. W. Bulik, G. E. Scuseria,

and J. P. Perdew, J. Chem. Phys. 138, 044113 (2013).

37 J. Sun, J. P. Perdew, and A. Ruzsinszky, Proc. Nat. Amer.

12 J. Sun, A. Ruzsinszky, and J. P. Perdew, Phys. Rev. Lett.

Sci. 112, 685 (2014).

115, 036402 (2015).

13 J. P. Perdew, A. Ruzsinszky, G. I. Csonka, O. A. Vydrov,
G. E. Scuseria, L. A. Constantin, X. Zhou, and K. Burke,
Phys. Rev. Lett. 100, 136406 (2008).

14 R. T. Sharp and G. K. Horton, Phys. Rev. 90, 317 (1953).
15 J. D. Talman and W. F. Shadwick, Phys. Rev. A 14, 36

(1976).

38 J. Tao, J. P. Perdew, V. N. Staroverov, and G. E. Scuseria,

Phys. Rev. Lett. 91, 146401 (2003).

39 J. P. Perdew, K. Burke, and M. Ernzerhof, Phys. Rev.

Lett. 77, 3865 (1996).

40 E. van Lenthe and E. J. Baerends, J. Comput. Chem. 24,

1142 (2003).

41 P. H. T. Philipsen, E. van Lenthe, J. G. Snijders, and E. J.

16 A. V. Arbuznikov and M. Kaupp, Chem. Phys. Lett. 381,

Baerends, Phys. Rev. B 56, 13556 (1997).

495 (2003).

42 G. B. Bachelet and N. E. Christensen, Phys. Rev. B 31,

17 F. G. Eich and M. Hellgren, J. Chem. Phys. 141, 224107

879 (1985).

(2014).

43 I. G. Ryabinkin and V. N. Staroverov, J. Chem. Phys. 137,

18 S. Ivanov, S. Hirata, and R. J. Bartlett, Phys. Rev. Lett.

164113 (2012).

83, 5455 (1999).

44 O. Madelung, Semiconductors: Data Handbook (Springer,

19 F. Della Sala and A. Goerling, J. Chem. Phys. 115, 5718

2004).

(2001).

45 M. P. Surh, S. G. Louie, and M. L. Cohen, Phys. Rev. B

20 J. B. Krieger, Y. Li, and G. J. Iafrate, Phys. Rev. A 45,

43, 9126 (1991).

101 (1992).

46 J. Heyd, G. E. Scuseria, and M. Ernzerhof, J. Chem. Phys.

21 V. N. Staroverov, G. E. Scuseria, and E. R. Davidson, J.

118, 8207 (2003).

Chem. Phys. 125, 081104 (2006).

22 A. F. Izmaylov, V. N. Staroverov, G. E. Scuseria, E. R.
Davidson, G. Stoltz, and E. Canc`es, J. Chem. Phys. 126,
084107 (2007).

23 O. V. Gritsenko and E. J. Baerends, Phys. Rev. A 64,

47 J. Heyd, G. E. Scuseria, and M. Ernzerhof, J. Chem. Phys.

124, 219906 (2006).

48 G. Kresse and J. Hafner, Phys. Rev. B 47, 558 (1993).
49 G. Kresse and J. Hafner, Phys. Rev. B 49, 14251 (1994).
50 G. Kresse and J. Furthm¨uller, Comput. Mat. Sci. 6, 15

042506 (2001).

24 M. Gr¨uning, O. V. Gritsenko,
Chem. Phys. 116, 6435 (2002).

and E. J. Baerends, J.

51 G. Kresse and J. Furthm¨uller, Phys. Rev. B 54, 11169

(1996).

(1996).

25 J. C. Slater, Phys. Rev. 81, 385 (1951).
26 P. E. Bl¨ochl, Phys. Rev. B 50, 17953 (1994).
27 G. Kresse and D. Joubert, Phys. Rev. B 59, 1758 (1999).
28 G. te Velde and E. J. Baerends, Phys. Rev. B 44, 7888

52 D. A. Kitchaev, H. Peng, Y. Liu, J. Sun, J. P. Perdew,

and G. Ceder, Phys. Rev. B 93, 045132 (2016).

53 J. F. Janak, Phys. Rev. B 18, 7165 (1978).
54 P. Mori-S´anchez, A. J. Cohen, and W. Yang, Phys. Rev.

(1991).

Lett. 100, 146401 (2008).

55 W. Yang, A. J. Cohen, and P. Mori-S´anchez, J. Chem.

58 E. R. Johnson, R. A. Wolkow, and G. A. DiLabio, Chem.

Phys. 136, 204111 (2012).

Phys. Lett. 394, 334 (2004).

56 R. W. Godby, M. Schl¨uter, and L. J. Sham, Phys. Rev.

59 E. Runge and E. K. U. Gross, Phys. Rev. Lett. 52, 997

Lett. 56, 2415 (1986).

57 E. R. Johnson, A. D. Becke, C. D. Sherrill, and G. A.

DiLabio, J. Chem. Phys. 131, 034111 (2009).

(1984).

10

