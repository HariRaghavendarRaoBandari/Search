6
1
0
2

 
r
a

 

M
7
1

 
 
]
P
A
h
t
a
m

.

[
 
 

1
v
5
9
3
5
0

.

3
0
6
1
:
v
i
X
r
a

Eﬀective acoustic properties of a meta-material

consisting of small Helmholtz resonators

A. Lamacz, B. Schweizer∗

March 18, 2016

Abstract

We investigate the acoustic properties of meta-materials that are in-
spired by sound-absorbing structures. We show that it is possible to con-
struct meta-materials with frequency-dependent eﬀective properties, with
large and/or negative permittivities. Mathematically, we investigate solu-
tions uε : Ωε → R to a Helmholtz equation in the limit ε → 0 with the help
of two-scale convergence. The domain Ωε is obtained by removing from
an open set Ω ⊂ Rn in a periodic fashion a large number (order ε−n) of
small resonators (order ε). The special properties of the meta-material are
obtained through sub-scale structures in the perforations.

Keywords: Helmholtz equation, homogenization, resonance, perforated do-

main, frequency dependent eﬀective properties

MSC: 78M40, 35P25, 35J05

1

Introduction

In this article, we are interested in the acoustic properties of a particular meta-
material, inspired by sound absorbing structures. We deﬁne a complex geome-
try, consisting of many small cavities, and study the Helmholtz equation in this
geometry. The acoustic properties of the meta-material are determined by the
Helmholtz equation since the acoustic pressure p of a time-harmonic sound wave
of ﬁxed frequency ω is of the form p(x, t) = u(x)eiωt, where u solves a Helmholtz
equation.

In standard homogenization settings, nothing special can be expected concern-
ing the acoustic properties of a meta-material (e.g. large or negative coeﬃcients).
Instead, in this contribution, we introduce a setting where the small inclusions
∗Technische Universit¨at Dortmund, Fakult¨at f¨ur Mathematik, Vogelpothsweg 87, D-44227

Dortmund, Germany.

1

2

A. Lamacz, B. Schweizer

are resonators and where the eﬀective behavior of the meta-material introduces
new features.
Let us describe these statements in a more mathematical language: We con-
sider a domain Ωε ⊂ Rn, n = 2 or n = 3, which is obtained by removing small
obstacles of typical size ε > 0 from a domain Ω ⊂ Rn. For a ﬁxed frequency
ω ∈ R, we study solutions uε ∈ H 1(Ωε) to the Helmholtz equation

−∆uε = ω2uε
∂nuε = 0
uε = g

in Ωε ,
on ∂Ωε \ ∂Ω ,
on ∂Ω .

(1.1)

The ﬁrst boundary condition expresses that the obstacles are sound-hard (homo-
geneous Neumann condition, n denotes the exterior normal at ∂Ωε), the second
boundary condition prescribes a pressure at the external boundary, g ∈ H 1(Ω) is
responsible for the generation of a sound wave in the domain.

When Ωε is obtained from Ω by a standard periodic perforation procedure, then
the homogenization of equation (1.1) is well-established. One ﬁnds an eﬀective
coeﬃcient A∗ and a volume correction factor λ ∈ (0,∞) such that, for small
ε > 0, the solution uε looks essentially like the solution u∗ of the eﬀective equation
−∇ · (A∗∇u∗) = ω2λu∗. In this eﬀective system, neither A∗ nor λ are frequency
dependent.

In contrast to such a standard approach we investigate (1.1) for a domain Ωε,
where every single inclusion (perforation) has the shape of a small resonator. This
is possible by introducing a three-scale problem: The macro-scale is diam(Ω) =
O(1), the micro-scale of the single inclusion is O(ε), and the single inclusion
contains a subscale feature of either size O(ε2) (in dimension n = 3) or O(ε3) (in
dimension n = 2). In this three-scale domain Ωε, the solutions uε exhibit a more
interesting behavior. We perform the homogenization procedure and ﬁnd that,
for small ε > 0, the solution uε to (1.1) looks essentially like the solution v to the
eﬀective system

− ∇ · (A∗∇v) = ω2Λ v

in Ω .

(1.2)

The form of this system is as in the standard homogenization setting, two eﬀective
coeﬃcients A∗ and Λ ∈ R modify the original equation when describing the system
with a macroscopic equation on Ω. But, due to the more complex geometry, we
obtain a parameter Λ = Λ(ω), which is frequency dependent. It can change sign
and it can be arbitrarily large due to a resonance eﬀect in the single cavity. The
resonance frequency is given by the well-known formula for Helmholtz resonators,

ω∗ =(cid:112)A/(LV ), where the real numbers A, L, and V characterize the geometric

properties of the resonators (area of a channel cross section, length of the channel,
volume of the resonator).

Usually, small inclusions correspond to a high resonance frequency, and not to
some ﬁnite frequency ω∗. But, as was shown in [30], a ﬁnite resonance frequency
can be obtained when a singular structure is included in the geometry: We con-
sider a setting where, in every periodicity cell Y ⊂ Rn, a resonator region RY ⊂ Y

Eﬀective Helmholtz Equation in a geometry with small resonators

3

Y ⊂ Y ,
is separated from an exterior region QY ⊂ Y by the sound-hard obstacle Σε
cp. Figure 1. But the separation is not complete, the obstacle leaves open a
small channel that connects RY and QY . The scaling of the channel depends
on the dimension. In two space dimensions (n = 2), the relative scaling of the
k ⊂ Ω
opening is εp with p = 2, hence the channel width of the single inclusion Σε
(where k ∈ Zn is the index of the k-th inclusion) is of order ε3. In dimension
n = 3 the exponent is p = 1, the channel opening diameter of the single inclusion
k ⊂ Ω is therefore of order ε2. In both cases, the scaling is such that the quan-
Σε
tity Aε/(LεVε) is of order 1, where Aε is the channel opening, Lε is the channel
length and Vε is the volume. Let us check this condition: For n = 2 we have
Aε/(LεVε) ∼ εp+1/(ε1εn) = 1, for n = 3 we have Aε/(LεVε) ∼ (εp+1)2/(ε1εn) = 1.

1.1 Main result
We investigate a large domain Ω ⊂ Rn that contains meta-material in some region
k, with k ∈ Zn such that
D ⊂ Ω. The single small resonator is denoted as Σε
k ⊂ D
ε (k + Y ) ⊂ D, where Y := (− 1
deﬁnes the perforated domain Ωε := Ω \ Σε. In order to analyze the eﬀect of the
resonator region D, we study solutions uε to the Helmholtz equation (1.1) and
investigate their behavior inside and outside of D in the limit ε → 0.

2)n. The union of all resonators Σε =(cid:83)

2, 1

k Σε

Figure 1: Sketch of the scattering problem. Left: The sub-region D ⊂ Ω contains
the small Helmholtz resonators, given by Σε ⊂ D. The number of resonators in
the region D is of order ε−n. We are interested in the eﬀective properties of the
meta-material in D. Right: The microscopic geometry with the single resonator
RY . The channel width inside Y is of the order εp.

We derive an eﬀective Helmholtz equation with the tool of two-scale conver-
gence. Essentially, the eﬀective system is given by (1.2). In this equation, the
eﬀective permittivity Λ : Ω → R is Λ(x) = 1 for x ∈ Ω \ D (outside the region

xxΩΣεD21YQYΣεYεRYYK4

A. Lamacz, B. Schweizer

that contains the resonators) and Λ(x) = Λeﬀ for x ∈ D, where the real number

(cid:18)

(cid:19)−1

Λeﬀ := Q − A
L

ω2 − A
LV

(1.3)

is determined by the positive real numbers A, L, V and Q which characterize
the geometric properties of the resonators (area of a channel cross section, length
of the channel, volume of the resonator, volume of the exterior), cf. Section 1.3
below. The number Λeﬀ represents the permittivity of the eﬀective medium. Due
to resonance properties of Σε
Y , it can be negative and it can be large in absolute

value (with both signs). The resonance frequency ω∗ =(cid:112)A/(LV ) is determined

by the geometry.

The ellipticity matrix is A∗(x) = 1Rn for x ∈ Ω \ D, whereas for x ∈ D it is

given as a cell problem integral:

(A∗)ij (x) := (Aeﬀ)ij :=

[δij + ∂yiχj(y)] dy

for i, j ∈ {1, ..., n} ,

(1.4)

(cid:90)

QY

where δij denotes the Kronecker Delta and χj is the solution to the cell problem
(2.11). The set QY ⊂ Y is the part of the periodicity cell Y that is exterior to the
obstacle and Q := |QY | is its volume.

Let us formulate here our main result in a condensed form. Theorem 1.1
characterizes the eﬀective inﬂuence of the scattering region D on waves in Ω.
Theorem 1.1 is a consequence of the stronger result in Theorem 3.1, which includes
a characterization of uε in D.
Theorem 1.1 (Eﬀective Helmholtz equation). Let Ω ⊂ Rn be a domain and
let D ⊂ Ω contain the obstacle set Σε ⊂ D as described in Section 1.3. Let
uε ∈ H 1(Ωε) be a sequence of solutions to (1.1) satisfying

(cid:107)uε(cid:107)L2(Ωε) ≤ C .

(1.5)

Let Λeﬀ and Λ be deﬁned by the algebraic relation (1.3), which uses the geometric
constants A, L, V, Q > 0. Let A∗ be deﬁned by (1.4) with the help of cell problems.
Let v ∈ H 1(Ω) be a solution to the eﬀective Helmholtz equation

−∇ · (A∗∇v) = ω2Λ v

v = g

in Ω ,
on ∂Ω .

(1.6)
(1.7)

If the solution v to the eﬀective system is unique, then there holds

uε|Ω\D → v|Ω\D

in L2(Ω \ D) .

(1.8)
Remark 1.2. For almost every ω ∈ R the solution to (1.6)-(1.7) is unique, since
the generalized Eigenvalue-problem (1.6) has a discrete set of Eigenvalues ω2.

The result of Theorem 1.1 yields that the ﬁeld uε is determined outside the
resonator region D by the eﬀective system (1.6)–(1.7). Inside D, the solutions uε
are oscillatory due to the micro-structure. We describe the two-scale limit of uε
in D in Subsection 1.4.

Eﬀective Helmholtz Equation in a geometry with small resonators

5

1.2 Literature

Homogenization theory is concerned with the derivation of eﬀective equations.
The most elementary task is to consider a sequence uε of solutions to a family
of partial diﬀerential equations that contains a small parameter ε, very often the
periodicity of the geometry or the periodicity of a coeﬃcient. The goal is to ﬁnd
an equation that characterizes the weak limit u∗ of the sequence uε. Our result is
of that form. The general theory has origins in [29] and it was greatly simpliﬁed
by introducing the notion of two-scale convergence [1, 26]. The theory was later
extended in several directions, e.g. to stochastic problems [21], to problems with
multiple scales [2], and to problems with measure valued limits [8, 14].

Perforated media. Our result treats perforated media in the sense that an
equation with constant coeﬃcients is considered on a domain Ωε which is obtained
by removing many small subdomains from a macroscopic domain Ω. A simple
boundary condition is imposed on the boundary ∂Ωε \ ∂Ω. Perforated media
have been studied with Dirichlet boundary conditions in [16] and with Neumann
boundary conditions in [17], the scattering problem has been analyzed in [15].
For perforations along a lower dimensional manifold see e.g. [19]. Periodically
perforated domains can also be treated with the tool of two-scale convergence,
which shortens the proofs of some of the original results. The diﬀerence between
our result and those mentioned above is that we introduce a sub-scale structure
in the perforation to allow for resonances. This leads to more interesting terms in
the eﬀective equation.

Resonances in Maxwell’s equations. Resonances in the single periodicity
cell can create interesting eﬀects in the homogenization limit. One of the fascinat-
ing examples is the construction of negative index materials for light as suggested
in [27, 28] with its possible applications to cloaking (see [23] and the references
therein). The meta-material for the Maxwell’s equations has qualitatively new
features, namely a negative eﬀective permittivity and a negative eﬀective per-
meability. The astonishing properties of such a material had been anticipated
in [31], but the mathematical analysis of negative index meta-materials is much
younger. Model equations have been studied in [22], non-rigorous results appeared
in [13, 20]. The mathematical theory that conﬁrmed negative eﬀective permeabil-
ity appeared in [11, 24] for metals and in [7] for dielectrics. The full result on the
negative eﬀective index meta-material can be found in [25].

Generation of resonances. At ﬁrst sight, a resonance eﬀect in a structure of
order ε seems impossible when the frequency ω is kept ﬁxed: One expects that an
object of order ε has a resonance at wave-length of order ε and hence a resonance
frequency of order ε−1. Indeed, in order to obtain interesting features in the limit
ε → 0, one has to introduce some singular behavior of the micro-structure.

(a) Large contrast. The simplest setting uses a large contrast, e.g. a parameter
aε that is of order 1 outside the structure and ε2 in the structure [7, 12, 13, 25]. In
many cases, the large contrast must be combined with one of the features (b)-(d)
below.

6

A. Lamacz, B. Schweizer

(b) Fibers. Interesting eﬀects within the framework of homogenization can be
obtained when ﬁbers are present in the structure [4, 5, 6, 13]. On the one hand
a ﬁber can be regarded as a classical periodic micro-structure (ε-periodic in each
direction). On the other hand, the exterior of the ﬁber (in the single cell) is not a
simply connected set, which makes some standard two-scale limit characterizations
impossible. Other eﬀects are related to the fact that the length of a single ﬁber
is of order O(1). For implications in Maxwell equations see e.g. [9, 10, 13, 25].

(c) Split rings. More complicated is the three-dimensional construction of a
split ring: For ε > 0, the ring is simply connected, but the slit closes in the limit
ε → 0 such that the limiting object is no longer simply connected. This change
of topology is exploited in [11, 24].

(d) Disconnected subregions. In the work at hand we use a diﬀerent construc-
tion, based on the Helmholtz resonator that has been studied mathematically in
[30]. Again, a topological eﬀect plays a role: Every cell has an interior part RY
(the resonator) and an exterior part QY . For every ε > 0, the two subdomains
are connected by a thin channel, but since the channel gets thinner and thinner,
the limiting object for ε → 0 is no longer connected, it has the two disconnected
components RY and QY .

In both settings (c) and (d) it is the change of the topology that makes the
resonance in the small object at ﬁnite frequency possible. We note that the
analysis of spectral properties in perforated domains require other methods if
the low- and high-frequency parts of the spectrum are studied separately, see
[3, 21, 32].

1.3 Geometry
Let Ω ⊂ Rn be open and bounded and let D ⊂ Ω be an open set with Lipschitz
boundary such that ¯D ⊂ Ω. The set D contains the periodic perforations, it is
the scatterer in the eﬀective equations.

Microscopic geometry. We start the construction from the periodicity cube
2)n. Since we will always impose periodicity conditions on the cube Y ,

Y := (− 1
we may identify it with the torus Tn. We assume that Y is the disjoint union

2, 1

Y = RY ∪ ¯ΣY ∪ QY ,

Channel construction. The channel

each of the three sets RY , ΣY , QY is open and connected with Lipschitz boundary,
¯RY , ¯ΣY ⊂ (− 1
2)n do not touch the boundary, and RY ∪ QY is not connected,
2, 1
see Figure 1.
is constructed starting from a one-
dimensional line-segment ΓY ⊂ ΣY that connects ∂RY with ∂QY . We may write
the segment with its tangential vector τΓY ∈ Rn as ΓY = {γ0 + tτΓY : t ∈ (0, L)}
with L denoting the length of the segment. For ease of notation we assume in
the following that the line segment has the tangential vector τΓY = e1 and that
ΓY ⊂ R × {0} ⊂ Rn. In this case, we have γ0 = (yR, 0) and ΓY = (yR, yQ) × {0}
with yQ := yR + L < 1/2.

Eﬀective Helmholtz Equation in a geometry with small resonators

7

We now construct the channel as K ε

For technical reasons in the study of the asymptotic behavior of cell solutions,
we assume that the boundaries ∂RY and ∂QY are ﬂat in the vicinity of (yR, 0)
and (yQ, 0): For some δ > 0 there holds ∂RY ∩ Bδ((yR, 0)) ⊂ {yR} × Rn−1 and
similarly for ∂QY .
Y := Bαεp(ΓY ) ∩ ΣY , where α > 0 is ﬁxed
In our simpliﬁed setting,
αεp (0) is the
Y is deﬁned as
(1.9)

and Bαεp denotes the generalized ball around a set.
the channel is the cylinder K ε
n− 1-dimensional ball with radius αεp. The Helmholtz resonator Σε

Y = Y \(cid:0) ¯RY ∪ ¯K ε

αεp (0) ⊂ Y , where Bn−1

Y = (yR, yQ) × Bn−1

Y := ΣY \ ¯K ε
Σε

Y ∪ ¯QY

(cid:1) .

In the following, three geometric quantities will be crucial: (i) The length L of
the channel. (ii) The relative cross section area A of the channel, A = 2α for
n = 2 and A = α2π for n = 3. (iii) The volume V = |RY | of the inner connected
component RY . We will see that in the eﬀective equation resonances appear at
frequencies ω2 that are close to the ratio A/(LV ).
Macroscopic geometry. In order to deﬁne the domain Ωε, we use indices
k ⊂
k ∈ Zn and shifted small cubes Y ε
D} the set of indices k such that the small cube Y ε
k is contained in D. Here and
in the following, in summations or unions over k, the index k takes all values in
the index set K. The number of relevant indices is of the order |K| = O(ε−n).
Y ⊂ Y we deﬁne the union Σε of scaled obstacles and

k := ε(k+Y ). We denote by K := {k ∈ Zn | Y ε

Using the local subset Σε
the perforated domain Ωε by
Σε

Σε :=

(cid:91)

k :=

k∈K

ε(k + Σε

Y ) ,

Ωε := Ω \ ¯Σε .

(1.10)

(cid:91)

k∈K

(cid:91)

k∈K

Also the other microscopic quantities have their counterpart in the macroscopic
domain: The union Kε of the channels, the union Qε of exterior components and
the union Rε of interior components are

Kε :=

ε(k + K ε

Y ) , Qε :=

ε(k + QY ) , Rε :=

ε(k + RY ) .

(1.11)

(cid:91)

k∈K

(cid:91)

k∈K

1.4 Characterization of solutions in D

Outside the scatterer region D, the function v of the eﬀective system (1.6)–(1.7)
is the weak limit of uε. In the following, we want to describe the meaning of v in
the scatterer region D.
If we denote by ˜uε ∈ L2(Ω) the trivial extension of uε by zero, then the
uniform bound (1.5) implies the existence of a subsequence and of a two-scale
limit u0 = u0(x, y) such that ˜uε 2s(cid:42) u0 (for the deﬁnition of two-scale convergence
we refer to [1]). Proposition 2.1 below yields that the two-scale limit for x ∈ D is
of the form

u0(x, y) =

(1.12)

v(x)

w(x)
0

for y ∈ QY ,
for y ∈ RY ,
for y ∈ ΣY .

8

A. Lamacz, B. Schweizer

This characterization clariﬁes the meaning of v. Outside the perforated region
D ⊂ Ω, there is no micro-structure and the sequence uε converges strongly to v.
Instead, for x ∈ D, the function v describes the value of u0 in the exterior QY
of the Helmholtz resonator. Outside D, the limit function v is comparable to uε,
while inside D the function v stands for the values of uε outside the scatterers.
This ﬁts with the result v ∈ H 1(Ω) from Lemma 2.2 below: It is the function v
that has a weak continuity property across the boundaries of D.

2 Two-scale limits

We will always work with the assumption that the sequence uε is uniformly
bounded in L2(Ωε) as demanded in (1.5). We remark that (1.5) implies also a
uniform H 1-bound,

(cid:107)uε(cid:107)H 1(Ωε) ≤ C

(2.1)

for some ε-independent constant C > 0. Since the boundary values are given
by g ∈ H 1(Ω) and since the domain Ω is bounded, the estimate (2.1) follows
immediately from (1.5) by testing (1.1) with the solution uε.
we provide a characterization for the two-scale limit of the gradients ∇uε.

In this section we derive Relation (1.12) for the two-scale limit u0. Moreover,

2.1 The two-scale limit u0

The following proposition provides a ﬁrst characterization of u0. We use the
sequence ˜uε ∈ L2(Ω) of trivial extensions of uε (obtained by setting ˜uε(x) := 0 for
x ∈ Σε).
Proposition 2.1 (The two-scale limit u0). Let uε ∈ H 1(Ωε) be a sequence of
solutions to (1.1). We assume that the sequence satisﬁes the uniform bound (1.5)
and that ˜uε ∈ L2(Ω) converges in two scales to some limit function u0 ∈ L2(Ω×Y ).
Then there exist v ∈ L2(Ω) and w ∈ L2(D) such that

1. For x ∈ Ω \ D one has u0(x, y) = v(x).
2. For x ∈ D one has

v(x)

w(x)
0

for y ∈ QY ,
for y ∈ RY ,
for y ∈ ΣY .

u0(x, y) =

(2.2)

fore, we consider localized test functions ϕε(x) := θ(x)Ψ(cid:0) x

Proof. We start with the characterization of u0(x, y) for (x, y) ∈ D × ΣY . There-
c (D)

(cid:1) with θ ∈ C∞

ε

Eﬀective Helmholtz Equation in a geometry with small resonators

9

and Ψ ∈ C∞(Y ) with supp(Ψ) ⊂ ΣY . On the one hand we ﬁnd, exploiting the
two-scale convergence of ˜uε,

˜uε(x)ϕε(x) dx →

θ(x)

u0(x, y)Ψ(y) dy dx .

D

ΣY

On the other hand one obtains, using the fact that supp(ϕε) ⊂ (Σε ∪ ¯Kε), the
deﬁnition of ˜uε, the L2(Ω)-bound for ˜uε and the vanishing volume fraction of the
channels Kε,

˜uε(x)ϕε(x) dx =

˜uε(x)ϕε(x) dx → 0 .

(cid:90)

Ω

(cid:90)

Ω

(cid:90)

(cid:90)

(cid:90)

Kε

Since the test functions were arbitrary, we conclude u0(x, y) = 0 for (x, y) ∈
D × ΣY .
(cid:1) with θ ∈ C∞
We next show that u0(x, y) is independent of y for (x, y) ∈ D × QY . As before
c (D) and
per(Y, Rn) with supp(Ψ) ⊂ QY . Multiplying ∇uε by εϕε and integrating by
(cid:17) · ∇xθ(x)
(cid:105)

we consider localized test functions ϕε(x) := θ(x)Ψ(cid:0) x
(cid:90)
(cid:17)

∇uε(x) · ϕε(x) dx = −

Ψ ∈ C∞
parts gives

(∇y · Ψ)

(cid:16) x

(cid:16)x

θ(x) + εΨ

uε(x)

(cid:90)

(cid:104)

dx .

ε

ε

ε

ε

Ωε

Ωε

(2.3)

Note that no boundary terms appear due to the compact support of θ and Ψ. We
can now pass to the limit ε → 0. Due to the uniform L2-bound of ∇uε, cf. (2.1),
the left hand side of (2.3) vanishes in the limit as ε → 0. On the right hand side
we exploit the two-scale convergence of ˜uε to ﬁnd

(cid:90)

Ωε

(cid:90)

(cid:104)
(cid:90)

Ω

=
ε→0→

uε(x)

(∇y · Ψ)

(cid:104)
(cid:90)

(cid:16) x

(cid:17)

ε

(cid:16)x

ε

(cid:17) · ∇xθ(x)
(cid:16) x

(cid:105)
(cid:17) · ∇xθ(x)
(cid:105)

dx

θ(x) + εΨ

ε

θ(x) + εΨ

(cid:16)x

(cid:17)

ε

dx

˜uε(x)

(∇y · Ψ)

θ(x)

u0(x, y)(∇y · Ψ)(y) dy dx .

D

QY

Since the test functions θ, Ψ were arbitrary, this implies that ∇yu0(x, .) = 0 in
the sense of distributions in QY for almost every x ∈ D. Therefore u0 does not
depend on y for (x, y) ∈ D × QY . We may therefore write u0(x, y) = v(x) for
some v ∈ L2(D).
For the domains (Ω \ D) × Y and D × RY one proceeds analogously to show

that u0(x, .) does not depend on y.

2.2 Two-scale convergence of the gradients

Due to the uniform bound (2.1) we can ﬁnd also a two-scale limit of the sequence
∇uε (upon extending by zero). The subsequent Lemma provides a ﬁrst charac-
terization of the two-scale limit. We use the space H 1
per(QY ) of those functions in
H 1(QY ) for which also their periodic extension to Rn is locally of class H 1.

10

A. Lamacz, B. Schweizer

Lemma 2.2. Let uε ∈ H 1(Ωε) be a sequence of solutions to (1.1) that satisﬁes the
uniform bound (1.5). Let ξε ∈ L2(Ω; Rn) be the trivial extension of ∇uε by zero
and let v be the exterior ﬁeld of Proposition 2.1. We assume that ξε converges in
two scales to some limit function ξ0 ∈ L2(Ω × Y )n. Then the following holds:

1. The exterior ﬁeld v is of class H 1(Ω).
2. For x ∈ Ω \ D one has ξ0(x, y) = ∇xv(x).
3. There exists v1 ∈ L2(D; H 1

per(QY )) such that for x ∈ D one has

(cid:40)∇xv(x) + ∇yv1(x, y)

ξ0(x, y) =

0

for y ∈ QY ,
for y ∈ RY ∪ ΣY .

(2.4)

We note that the lemma implies for the interior of the resonators

∇uε 1Rε

2s(cid:42) 0

as ε → 0 .

(2.5)
Proof. Step 1. Regularity of v. We consider the domain ˆΩε := Ω\ ( ¯Σε ∪ ¯Kε ∪ ¯Rε),
which is obtained from Ω by removing the union of obstacles Σε, slits Kε and
interior regions Rε. In particular, the perforation of ˆΩε in each periodicity cell is a
Lipschitz domain without substructure. We construct a sequence ˆvε ∈ H 1(Ω) by
setting ˆvε := uε in ˆΩε and extending to Ω. Actually, it is well known that there
exists a family of extension operators Pε : H 1( ˆΩε) → H 1(Ω) such that

(cid:107)Pεuε(cid:107)H 1(Ω) ≤ C(cid:107)uε(cid:107)H 1( ˆΩε)

for some C > 0 independent of ε, see [18], Chapter 1. Essentially, Pε is deﬁned by
using in each perforation the harmonic extension of the boundary values. Hence,
ˆvε := Pεuε is uniformly bounded in H 1(Ω). We therefore ﬁnd, up to a subsequence,
a limit function ˆv ∈ H 1(Ω) such that ˆvε converges in two scales and strongly in
L2(Ω) to the (y-independent) function ˆv = ˆv(x).
in the exterior of the resonators, i.e. ˆv = v. This proves v ∈ H 1(Ω).

Since ˆvε = uε in ˆΩε, the strong limit ˆv coincides with the two-scale limit of uε

Step 2. Characterization outside D. Outside of D, the elliptic equation for uε
implies that the solution sequence is locally H 2-bounded. Therefore, the distri-
butional convergence ∇uε → ∇v is locally a strong L2-convergence. In this case
the two-scale limit of gradients coincides with the strong limit.

Step 3. Characterization in D: The case y ∈ QY ∪ ΣY . Concerning the
characterization for (x, y) ∈ D × QY we refer to a standard argument, which can
be found e.g. in the proof of Theorem 2.9 in [1]. It provides the existence of a
two-scale function v1 ∈ L2(D; H 1

per(QY )) such that

ξ0(x, y) = ∇xv(x) + ∇yv1(x, y)

for (x, y) ∈ D × QY .

(2.6)

(cid:1) and integrating by parts one ﬁnds
(cid:17) ∧ ∇xθ(x)
(cid:105)

(cid:16)x
(cid:17)
(cid:17)
(cid:16)x

θ(x) − εΨ

(cid:16) x

θ(x) dx

ε

curlyΨ

dx

ε

ε
ξ0(x, y) · curlyΨ(y)θ(x) dy dx .

curl(∇uε)(x) · εΨ

curl(∇uε) = 0 with ε θ(x)Ψ(cid:0) x
∇uε(x) ·(cid:104)
(cid:90)

(cid:90)
(cid:90)

(cid:90)

0 =

Ωε

Ωε

ε

=
ε→0→

D

RY

Since θ ∈ C∞
C∞

c (RY , R3) there holds (cid:90)

c (D) was arbitrary we conclude that for a.e. x ∈ D and every Ψ ∈

Eﬀective Helmholtz Equation in a geometry with small resonators

11

We emphasize that characterization (2.6) heavily relies on the fact that the union
of exterior domains is connected.
The claim for y ∈ ΣY follows as in the proof of Proposition 2.1: We exploit
the vanishing volume fraction of the channels and the uniform bound for ∇uε.

Step 4. Characterization in D: The case y ∈ RY . For y ∈ RY we argue
as follows: Let θ ∈ C∞
c (RY , Rn) be arbitrary. In three space
dimensions, n = 3, we exploit the relation curl(∇uε) = 0, while in two space
dimensions the curl-operator has to be replaced by a rotated divergence. In the
following, we perform the calculations only for n = 3. Multiplying the identity

c (D) and Ψ ∈ C∞

ξ0(x, y) · curlyΨ(y) dy = 0 .

RY

We obtained that the (distributional) curl of ξ0 vanishes. Since the interior domain
RY is simply connected, ξ0(x,·) must be a gradient: There exists a potential w1 ∈
L2(D; H 1(RY )) such that ξ0(x,·) = ∇yw1(x,·) for a.e. x ∈ D. With an analogous
calculation the same result can be obtained also in two space dimensions, n = 2.
We next show that w1(x,·) is constant for a.e. x ∈ D. This implies ξ0(x, y) =
∇yw1(x, y) = 0; with that, the lemma is proven.
We consider microscopic test-functions ψ ∈ C∞( ¯RY ) with vanishing values at
Y =
Y we deﬁne, for δ > 0

the entrance of the channel. More precisely, denoting by Γε,R
{yR}× Bn−1
ﬁxed, the set

αεp (0) the interface between RY and the channel K ε

Aδ(RY ) :=(cid:8)ψ ∈ C∞( ¯RY )| ψ = 0 on {yR} × Bn−1

(2.7)
Note that for δ > 0 ﬁxed and ε suﬃciently small each ψδ ∈ Aδ(RY ) satisﬁes
c (D) and ψδ ∈ Aδ(RY ) be arbitrary. We multiply
ψδ = 0 on Γε,R
−∆uε with ε θ(x)ψδ

:= ¯RY ∩ ¯K ε

(0)(cid:9) .

Y

δ

Y . Let now θ ∈ C∞
(cid:90)

ε

(−∆uε)(x) θ(x)ψδ

(cid:1) and integrate by parts to ﬁnd
∇uε ·(cid:104)

ε∇xθ(x)ψδ

(cid:16) x

(cid:16) x

(cid:17)

(cid:17)

dx

ε

Ωε

=

ε

(cid:0) x
(cid:90)

Rε

+ θ(x)∇yψδ

ε

(cid:16)x

(cid:17)(cid:105)

ε

dx .

(2.8)

12

A. Lamacz, B. Schweizer

Note that no boundary terms appear due to the Neumann boundary conditions of
uε and the fact that the test function Ψδ vanishes at the interface between RY and
the channel. We next pass to the limit in (2.8). Exploiting that ∆uε is uniformly
bounded in L2(Ωε) we ﬁnd that the left hand side of (2.8) vanishes in the limit
as ε → 0. On the right hand side we use the uniform boundedness of ∇uε to
conclude that the ﬁrst term vanishes in the limit, while for the second term we

obtain(cid:90)

(cid:16) x

(cid:17)

ε

∇uε · θ(x)∇yψδ

Ωε

(cid:90)

(cid:90)

dx ε→0→

(cid:90)

(cid:90)

D

=

D

RY

RY

ξ0(x, y) · ∇yψδ(y)θ(x) dy dx
∇yw1(x, y) · ∇yψδ(y)θ(x) dy dx .

In the last line we used the characterization ξ0(x, y) = ∇yw1(x, y). Since θ was
arbitrary we conclude, for a.e. x ∈ D and every test function ψδ(y) ∈ Aδ(RY ),

∇yw1(x, y) · ∇yψδ(y) dy = 0 .

RY

(2.9)
In the above equality the test functions ψδ are restricted to the set Aδ(RY ). We
claim that (2.9) holds for all functions ψ ∈ C∞( ¯RY ). Indeed, in the limit δ → 0
the set {yR} × Bn−1
(0) shrinks to a set of vanishing H 1-capacity. In particular,
for every ψ ∈ C∞( ¯RY ) there exists an approximating sequence ψδ ∈ Aδ(RY ) with
ψδ → ψ in H 1(RY ) as δ → 0. We therefore conclude that for every ψ ∈ C∞( ¯RY )

δ

(cid:90)

(cid:90)

∇yw1(x, y) · ∇yψ(y) dy = 0 .

We obtain that w1(x,·) is a solution to

RY

−∆yw1(x,·) = 0
∂nw1(x,·) = 0

in RY ,
on ∂RY .

All solutions to this elliptic problem are constant functions, as can be shown by
testing with w1. We obtain ξ0(x, y) = ∇yw1(x, y) = 0 for (x, y) ∈ D × RY , which
concludes the proof.

In the next lemma we relate, via cell problems, the two-scale function v1 (the
exterior two-scale corrector) to the ﬁeld v (which represents average values outside
the resonators). The procedure follows the standard arguments, our interest is
to show rigorously that the channels do not aﬀect the equations for the exterior
corrector function v1. As before, n denotes exterior normal vectors on boundaries.

Lemma 2.3 (Characterization of v1). Let v and v1 be as in Proposition 2.1 and
Lemma 2.2. Then the microscopic function v1 can be written as

v1(x, y) =

χi(y)∂xiv(x) ,

(2.10)

n(cid:88)

i=1

Eﬀective Helmholtz Equation in a geometry with small resonators

13

per(QY ) with i ∈ {1, ..., n} satisfy the following
where the shape functions χi ∈ H 1
cell problem with Neumann boundary conditions on ∂QY \ ∂Y and periodicity
boundary conditions on ∂Y :

∆yχi = 0
∂nχi = −ei · n on ∂QY \ ∂Y .
Proof. For an arbitrary microscopic test function ψ ∈ H 1
there holds, for a.e. x ∈ D,

in QY ,

(cid:90)

(2.11)

per(QY ) we will prove that

[∇xv(x) + ∇yv1(x, y)] · ∇yψ(y) dy = 0 .

(2.12)

QY

Equation (2.12) implies the claim of the lemma. Indeed, (2.12) is the weak for-
mulation of the Neumann problem

−∆yv1(x, y) = −∇y · [∇xv(x) + ∇yv1(x, y)] = 0 in QY ,

(∇xv(x) + ∇yv1(x, y)) · n = 0 on ∂QY \ ∂Y ,

supplemented with periodicity boundary conditions on ∂Y . By linearity of this
problem, v1 depends linearly on ∇xv. This yields the representation formula
(2.10).

Derivation of (2.12):

In the following we ﬁx a small parameter δ > 0 in
such a way that the δ-neighbourhood of QY in Y does not intersect the interior
domain RY , i.e. Bδ(QY ) ∩ RY = ∅. Let θ ∈ C∞
c (D) be arbitrary. We consider
per(Y ) with supp(ψ) ⊂ Bδ(QY ). We emphasize
microscopic test-functions ψ ∈ H 1
that all H 1
per(QY )-functions are admissible, we do not prescribe any boundary
conditions on the channel opening. We multiply the Helmholtz equation (1.1)

θ(x) + ε∇xθ(x)ψ

dx = εω2

uε(x)θ(x)ψ

dx .

(cid:16)x

(cid:17)(cid:105)

ε

(cid:90)

Ωε

(cid:16)x

(cid:17)

ε

(2.13)

(cid:1) to ﬁnd

with ϕε(x) := εθ(x)ψ(cid:0) x
(cid:90)
(cid:17)
∇uε(x) ·(cid:104)∇yψ
(cid:16)x

ε

ε

Ωε

Ωε ∩ supp(cid:0)ψ(cid:0) ·
(cid:90)

(cid:90)

Ωε

ε

(cid:1) θ(cid:1) ⊂ (Qε ∪ Kε),
(cid:16)x

(cid:16) x

∇uε(x) · ∇yψ

(cid:17)

ε

θ(x) dx

(cid:17)

∇uε(x) · ∇yψ

(cid:90)

Qε

(cid:90)

=

ε→0→

D

QY

Due to the uniform H 1-bound on uε the second term on the left hand side of
(2.13) and the right hand side vanish in the limit ε → 0. Concerning the ﬁrst
term on the left hand side we calculate, using that supp(ψ) ⊂ QY ∪ ΣY and thus

(cid:90)

(cid:17)

θ(x) dx

(cid:16) x

ε

θ(x) dx +

∇uε(x) · ∇yψ
(∇xv(x) + ∇yv1(x, y)) · ∇yψ(y)θ(x) dy dx .

Kε

ε

14

A. Lamacz, B. Schweizer

(cid:90)

(cid:90)

In the last line we exploited the uniform H 1-bound of uε and the vanishing volume
fraction of the channels Kε. Moreover, we used characterization (2.4) for the two-
scale limit of ∇uε. We obtain

(∇xv(x) + ∇yv1(x, y)) · ∇yψ(y)θ(x) dy dx = 0

D

QY

and hence, since θ ∈ C∞

c (D) was arbitrary, the claim (2.12).

3 Proof of the main result

In this section we prove that the external ﬁeld v of Proposition 2.1 satisﬁes the
eﬀective Helmholtz equation (1.6). Let us start by formulating the strong version
of our main result.
Theorem 3.1 (Characterization of two-scale limits of solutions). Let uε ∈ H 1(Ωε)
be as in Theorem 1.1: For every ε, the function uε solves the Helmholtz equation
(1.1) in a domain Ωε, which is obtained by removing from Ω ⊂ Rn a family of
small resonators. We assume that the family uε satisﬁes the uniform bound (1.5).
Due to this boundedness, we can extract a two-scale convergent subsequence and
study v ∈ L2(Ω) of Proposition 2.1.
Then the ﬁeld v is of class v ∈ H 1(Ω) and it is a solution to the eﬀective

Helmholtz equation

−∇ · (A∗∇v) = ω2Λ v

(3.1)
(3.2)
The eﬀective coeﬃcients are Λ(x) = 1 and A∗(x) = 1Rn for x ∈ Ω \ D, whereas
for x ∈ D the factor Λ(x) = Λeﬀ and the matrix A∗(x) = Aeﬀ are deﬁned in (1.3)
and (1.4).

in Ω ,
on ∂Ω .

v = g

In order to prove Theorem 3.1 we have to introduce an additional quantity,
namely the current j∗. To deﬁne this additional eﬀective quantity, we ﬁrst observe
that a rescaled ﬂux in the channels is bounded in L1(Ω): The sequence

jε(x) := − 1
Lε

1Kε(x)∂x1uε(x) ,

(3.3)

where 1Kε is the characteristic function of the channels, satisﬁes

(cid:90)

(cid:90)

|jε| =

Ω

Kε

|∂x1uε| ≤ |Kε| 1

2

Lε

1
Lε

(cid:18)(cid:90)

Kε

(cid:19) 1

|∂x1uε|2

2 ≤ C,

where C is independent of ε. In the last inequality we exploited that the volume
of the channels is of order ε2 (opening area times length times number is ε3εε−2
for n = 2 and (ε2)2εε−3 for n = 3), and that uε is uniformly bounded in H 1(Ωε).
In view of this estimate we ﬁnd a subsequence ε → 0 and a limit j∗ ∈ M( ¯Ω)
such that jε → j∗ weakly star in the space of Radon measures along the subse-
quence.

Eﬀective Helmholtz Equation in a geometry with small resonators

15

Deﬁnition 3.2 (The current j∗). We deﬁne the current j∗ ∈ M( ¯Ω) as the weak
star limit of jε in the space of Radon measures, i.e. through

− 1
Lε

Kε

∂x1uε(x)θ(x) dx

ε→0→

θ(x) dj∗(x)

(3.4)

(cid:90)

¯Ω

(cid:90)

for all test-functions θ ∈ C( ¯Ω).

At a later stage, cf. Proposition 3.3, we will see that the measure j∗ ∈ M(Ω) is
absolutely continuous with respect to the Lebesgue measure and that its density
coincides, up to a prefactor, with the interior ﬁeld w(·) from characterization (2.2).
In particular, the limit j∗ does not depend on the choice of the subsequence ε → 0.
Note that, by deﬁnition of the set Kε, the current j∗ vanishes outside the
perforated region ¯D. The integral on the right hand side of (3.4) may be replaced
by an integral over ¯D:

θ(x) dj∗(x) =

θ(x)dj∗(x)

for all θ ∈ C( ¯Ω) .

(3.5)

(cid:90)

¯Ω

(cid:90)

¯D

The proof of Theorem 3.1 consists of three steps: (1) Establish a relation
between the current j∗ and the interior ﬁeld w. This is achieved in Proposition
3.3. (2) Derivation of a geometric ﬂow rule, which relates the current j∗ to the
diﬀerence v − w between exterior ﬁeld v and interior ﬁeld w. This is the result of
Proposition 3.4. (3) Derivation of a Helmholtz equation for v, cf. Proposition 3.6.

3.1 Relation between current and the interior ﬁeld

In this subsection we prove that the current j∗ can be expressed in terms of the
interior ﬁeld w. We recall that V = |RY | is the relative volume of the single
resonator domain.

Proposition 3.3 (Relation between the current and the interior ﬁeld). In the
situation of Theorem 3.1, let the current j∗ ∈ M( ¯Ω) be as in Deﬁnition 3.2 and
let w ∈ L2(D) be the interior ﬁeld of Proposition 2.1. Then for every function
θ ∈ C∞

c (Ω) there holds(cid:90)

(cid:90)

θ(x) dj∗(x) = V ω2

Ω

D

θ(x)w(x) dx .

(3.6)

In particular, taking into account (3.5), one obtains that j∗ = j dx, where j is the
L2(Ω)-function

j(x) =

V ω2w(x)
0

for x ∈ D ,
for x ∈ Ω \ D .

(3.7)

(cid:40)

16

A. Lamacz, B. Schweizer

where Y ε := (cid:83)

Proof. Let θ ∈ C∞
(1.1) with an oscillatory test function of the form ϕε(x) := θ(x)Φε
resonator region D. The function Φε : Y \ ¯Σε

(cid:0) x
Y → R is deﬁned as follows:

c (Ω) be arbitrary. Our aim is to multiply the Helmholtz equation

k denotes the union of ε-cubes that are contained in the

(cid:1) 1Y ε(x),

k∈K Y ε

ε

L

0
Φ(y1)

Φε(y) =

for y ∈ RY (interior),
for y ∈ QY (exterior),
for y ∈ K ε
Y (channel),

(3.8)

where L is the length of the channel and Φ(·) is aﬃne on the interval (yR, yQ)
with Φ(yR) = L and Φ(yQ) = 0. In particular, Φε ∈ H 1(Y \ ¯Σε

Y ) with

∇yΦε(y) = −e1 1Kε

(y) ,

Y

where e1 denotes the ﬁrst unit vector. We note that the oscillatory test function
ϕε is of class H 1(Ωε), since the jump set ∂Y ε of the function 1Y ε is contained
in the set where Φε
with ϕε and integrate by parts to ﬁnd

(cid:1) vanishes. We now multiply the Helmholtz equation (1.1)

(cid:0) ·

ε

∇uε(x) · ∇ϕε(x) dx = ω2

Ωε

Ωε

uε(x)ϕε(x) dx .

(3.9)

(cid:90)

Concerning the left hand side of (3.9) we calculate

∇uε(x) · ∇ϕε(x) dx

(cid:16) x

(cid:17)

∇uε(x) · ∇θ(x)Φε
ε
∇uε(x) · ∇θ(x) dx +

(cid:90)

1Y ε(x) dx − 1
ε

∇uε(x) · ∇θ(x)Φε

dx

∂x1uε(x)θ(x) dx

(cid:16)x

(cid:17)

ε

Kε

∂x1uε(x)θ(x) dx .

(cid:90)

Kε

(cid:90)

(cid:90)

Ωε

=

(cid:90)

(cid:90)

Ωε

= L

(cid:90)

Kε

Rε

− 1
ε

(cid:90)

Ωε

In the limit ε → 0, the ﬁrst term vanishes due to (2.5). The second term vanishes
due to the uniform bound (2.1) and the vanishing volume fraction of the channels.
In the third term we use the deﬁnition of j∗ in (3.4). Together, we ﬁnd

∇uε(x) · ∇ϕε(x) dx

ε→0→ L

θ(x) dj∗(x) .

Concerning the right hand side of (3.9) we calculate, using the properties of the
microscopic test-function Φε,

(cid:90)

(cid:90)

Ωε

uε(x)ϕε(x) dx = Lω2
ε→0→ Lω2

uε(x)θ(x) dx + ω2

uε(x)ϕε(x) dx

w(x)θ(x) dy dx = LV ω2

D

RY

D

Kε

w(x)θ(x) dx .

(cid:90)

¯Ω

(cid:90)

(cid:90)

(cid:90)

ω2

(cid:90)

Rε

Eﬀective Helmholtz Equation in a geometry with small resonators

17

In the second line we again exploited the vanishing volume fraction of the channels
and characterization (2.2) of the two-scale limit u0.
Our calculations show that (3.9) provides, in the limit ε → 0 and upon dividing

by L, relation (3.6). This concludes the proof of the proposition.

3.2 Geometric ﬂow rule: A second relation for the current

In this section we establish the geometric ﬂow rule, which relates the current j∗
to the diﬀerence between the exterior ﬁeld v and the interior ﬁeld w.

Proposition 3.4 (Geometric ﬂow rule). In the situation of Theorem 3.1, let
j∗ = j dx be the current from Deﬁnition 3.2, let w be the interior ﬁeld and v the
exterior ﬁeld of Proposition 2.1. Then there holds, for x ∈ D,

j(x) = −A
L

(v(x) − w(x)) .

(3.10)

We call (3.10) a geometric ﬂow rule, since it establishes a relation between a
suitable average of gradients ∂x1uε on the left hand side with an averaged slope
(v− w)/L, that is to be expected by the values near the end-points of the channel.
The geometric ﬂow rule together with Proposition 3.3 provides already a rela-

tion between the exterior ﬁeld v and the interior ﬁeld w.

Remark 3.5. Combining the ﬂux relation (3.7) with the geometric ﬂow rule (3.10)
we obtain that, for almost every x ∈ D:

(cid:18)

(cid:19)

− A
V L

v(x) =

ω2 − A
V L

w(x) .

(3.11)

In particular, resonances of the system occur for frequencies ω2 that are close to
the ratio A/(V L).

Proof of the geometric ﬂow rule, Proposition 3.4. We will prove that for arbitrary
Lipschitz domains E ⊂ D the limit measure j∗ = j dx satisﬁes

j(x) dx = −A
L

E

(v(x) − w(x)) dx .

(3.12)

(cid:90)

(cid:90)

E

Once this is shown, we have veriﬁed (3.10) and hence the proposition. We will
use essentially the same test-function as in the proof of Proposition 3.3. But
while in Proposition 3.3 we concluded results from the Helmholtz equation, we
use the test-functions here in a more elementary way: We want to compare values
of functions with averages of derivatives.

Φε : Y \ ¯Σε

Step 1. The two-scale test function. We use the microscopic test-function
Y ) with

Y → R that was deﬁned in (3.8). In particular, Φε ∈ H 1(Y \ ¯Σε

∇yΦε(y) = −e1 1Kε

Y

(y) .

18

A. Lamacz, B. Schweizer

k ⊂ E}, the
To construct a macroscopic test-function, we deﬁne Iε := {k ∈ Zn|Y ε
k is contained in the test-set E ⊂ D. The
set of all indices k such that the cell Y ε
number of elements of Iε is of order Mε := |Iε| = O(ε−n). As a slightly smaller
k ⊂ E, the union of ε-cells that are contained in
test-set we use Y ε
Y ε
E. With the characteristic function Θε
E and
E(x) = 0 for x (cid:54)∈ Y ε
Θε

E(x) = 1 for x ∈ Y ε

E : Ω → [0, 1], Θε

E := (cid:83)

E, we set

k∈Iε

ϕε(x) := Θε

E(x)Φε

(3.13)

We note that ϕε is of the class H 1, since the jump set ∂Y ε
contained in the set where the function Φε

E of the function Θε

E is

Step 2. First calculation of Bε. The proof of the proposition consists of

calculating, in two diﬀerent ways, the following expression Bε:

(cid:17)
(cid:16)x
(cid:1) vanishes.

ε

.

(cid:0) ·

ε

On the one hand, we can calculate with the deﬁnition of j∗ = j dx:
∇uε(x) · ∇yΦε

∇uε(x) · ∇yΦε

Bε =

dx +

(cid:16) x

(cid:17)

ε

dx

Bε :=

∇uε(x) · ∇ϕε(x) dx .

(cid:90)

Ωε

(cid:16) x

(cid:90)

(cid:17)

1
ε

dx

(cid:17)
(cid:16)x
(cid:90)

ε

E

ε
∇uε(x) · ∇yΦε

E∩Kε
Y ε

∂1uε(x) dx → L

j(x) dx .

(cid:90)

1
ε

(cid:90)

E∩Rε
Y ε
1
ε

(cid:90)

+

E∩Qε
Y ε

= −1
ε

E∩Kε
Y ε

In the ﬁrst equality we decomposed the integral and in the second equality we
exploited that ∇yΦε is either 0 or −e1. In the last step we used the deﬁnition of
the limit measure j∗ = j dx and the fact that the volume of E \ Y ε
E vanishes in
the limit ε → 0.

Step 3. Second calculation of Bε. In order to prepare the second calculation of
Bε (which is based on an integration by parts), we have to deﬁne the interface sets:
αεp (0) ⊂ Y ,
We recall that the channel in the periodicity cell is K ε
:= ¯K ε
the interface to the inner set RY is therefore Γε,R
αεp (0).
Y ∩ ¯QY = {yQ} ×
Analogously, the interface to the outer set QY is Γε,Q
Bn−1
αεp (0).
The function Φε has the gradients 0 and −e1 on the two sides of Γε,R
it has the gradients −e1 and 0 on the two sides of Γε,Q
(always right trace minus left trace) are given by

Y = (yR, yQ)× Bn−1
Y ∩ ¯RY = {yR} × Bn−1
:= ¯K ε

Y , and
Y . Therefore, the jumps

Y

Y

[∇Φε]Γε,R

Y

= −e1 ,

[∇Φε]Γε,Q

Y

= e1 .

(3.14)

We now calculate the number Bε by performing an integration by parts in
E ∩ Kε. Since the test-function is

E ∩ Qε, and Y ε

E ∩ Rε, Y ε

all the three integrals, Y ε

Eﬀective Helmholtz Equation in a geometry with small resonators

harmonic, ∆ϕε = 0, in all the three sets, we obtain, denoting by Γε
Γε,R
Y ) and by Γε

Y ) the union of interfaces,

R :=(cid:83)

19

k∈Iε

ε(k +

Q :=(cid:83)
(cid:90)
(cid:90)

Γε
R

=

1
ε

Γε
R

Bε = −

ε(k + Γε,Q

k∈Iε
(cid:90)
uε e1 · [∇ϕε]Γε
uε dHn−1 − 1
ε

R

dHn−1 −

uε e1 · [∇ϕε]Γε

Q

dHn−1

Γε
Q

uε dHn−1 .

Γε
Q

(cid:90)

(cid:90)

(cid:90)

E

(cid:90)

1
ε

In the remainder of this proof we want to compare the ﬁrst integral with the values
of uε inside the resonators, i.e. with w, and the second integral with the values
outside the resonators, i.e. with v. More precisely, we claim that

uε dHn−1 → A

Γε
R

E

w

and

1
ε

uε dHn−1 → A

Γε
Q

E

v

(3.15)

as ε → 0. Once (3.15) is shown, the proof of the proposition is complete: In
combination with Step 2 we have found

(cid:90)

(cid:90)

(cid:90)

L

j(x) dx = lim
ε→0

Bε = A

(w − v)(x) dx

E

and hence (3.12).

Step 4. Veriﬁcation of (3.15). In order to verify the limits (3.15) we want to
construct an averaged function, rescale and use Lemma A.1 in the appendix. We
consider the following function Uε on Y \ ¯Σε
Y (we recall that Mε = |Iε| denotes
the number of considered cells)

(cid:88)

k∈Iε

Uε(y) :=

1
Mε

uε(ε(k + y)) .

(3.16)

Linearity of the Helmholtz equation implies that the rescaled function Uε satisﬁes
−∆Uε = ω2ε2Uε on Y \ Σε
Y . The (weak) two-scale convergence of uε(x) to u0(x, y)
with u0(x, y) = w(x) for y ∈ RY and u0(x, y) = v(x) for y ∈ QY implies the weak
L2-convergence of U ε to constant functions,

(cid:90)
Uε|RY (cid:42) −

(cid:90)
Uε|QY (cid:42) −

w

and

v .

(3.17)

E

E

Since also the homogeneous Neumann boundary conditions on ∂Σε
Y are satisﬁed,
the sequence Uε satisﬁes all assumptions of Lemma A.1 in the appendix. Assertion
(A.5) of the lemma provides

Uε(y) dHn−1(y) → −

w and −

Uε(y) dHn−1(y) → −

v .

(3.18)

(cid:90)

E

(cid:90)

Γε,Q

Y

(cid:90)

−

Γε,R

Y

(cid:90)

E

20

A. Lamacz, B. Schweizer

It remains to relate inlet averages of Uε (which live in the unit cell Y ) with inlet
averages of uε (which live on Ω). With the number of resonators in E satisfying
Mεεn → |E| we calculate

Uε(y) dHn−1(y) = −

uε(ε(k + y)) dHn−1(y)

(cid:90)

−

Γε,R

Y

(cid:90)

1
Mε

Γε,R

Y

=

=

=

1
Aε2

1
Mε

1
Mε

1
Aε2

(cid:18) 1

A|E|ε

(cid:88)
(cid:90)
(cid:88)
(cid:90)

k∈Iε

k∈Iε
1
εn−1

+

Γε,R

Y

(cid:19)(cid:90)

Γε
R
o(1)

ε

Γε
R

uε(ε(k + y)) dHn−1(y)

uε(x) dHn−1(x)

uε(x) dHn−1(x) .

The convergence result (3.18) thus implies

(cid:90)

1
Aε

Γε
R

uε(x) dHn−1(x) →

(cid:90)

E

w(x) dx ,

as ε → 0, which was the ﬁrst claim in (3.15). The second claim follows analogously
from the second convergence in (3.18).

3.3 Eﬀective equation

In this section we derive the eﬀective equation for the exterior ﬁeld v. We recall
that we denoted interior and exterior volume as V = |RY | and Q = |QY |.

Proposition 3.6 (Eﬀective equation for the exterior ﬁeld). In the situation of
Theorem 3.1, let v be the exterior ﬁeld and w the interior ﬁeld of Proposition 2.1.
Then there holds

−∇ · (A∗∇v) = Ξv,w

in Ω

(3.19)

in the sense of distributions with the eﬀective coeﬃcient matrix A∗, see (1.4). On
the right hand side, we used the abbreviation

(cid:40)

Ξv,w(x) :=

v(x)
Qv(x) + V w(x)

for x ∈ Ω \ D,
for x ∈ D.

(3.20)

c (Ω) be arbitrary. The weak form of the Helmholtz equation

Proof. Let θ ∈ C∞
(1.1) provides

(cid:90)

(cid:90)

∇uε(x) · ∇θ(x) dx = ω2

Ωε

Ωε

uε(x)θ(x) dx .

(3.21)

Eﬀective Helmholtz Equation in a geometry with small resonators

21

On the left hand side of (3.21) we can directly pass to the limit ε → 0. Exploiting
the characterization from Lemma 2.2 one obtains

∇uε(x) · ∇xθ(x) dx

(cid:90)

(cid:90)
(cid:90)
(cid:90)

Ω

Y

D

QY

D

QY

(cid:34)

(cid:90)

n(cid:88)

i=1

ξ0(x, y) · ∇xθ(x) dy dx
[∇xv(x) + ∇yv1(x, y)] · ∇xθ(x) dy dx +

(cid:90)

Ω\D

∇xv(x) · ∇xθ(x) dx

(cid:35)

∇xv(x) +

∇yχi(y)∂xiv(x)

· ∇xθ(x) dy dx

∇xv(x) · ∇xθ(x) dx

+

Ω\D

(cid:90)

Ω\D

A∗(x)∇xv(x) · ∇xθ(x) dx ,

Aeﬀ∇xv(x) · ∇xθ(x) dx +

∇xv(x) · ∇xθ(x) dx

(cid:90)

Ωε

ε→0→

(cid:90)
(cid:90)

=

=

=

=

(cid:90)
(cid:90)

D

Ω

(cid:90)

where in the fourth line we exploited the representation formula (2.10) for v1 and
in the last two lines the deﬁnitions of Aeﬀ and A∗ from (1.4).
2.1 to ﬁnd, in the limit ε → 0,

On the right hand side of (3.21) we use the characterization from Proposition

ω2

uε(x)θ(x) dx

(cid:90)
(cid:18)(cid:90)

Y

Ω

(cid:90)
(cid:90)
(cid:90)
(cid:90)

D

D

Ω

Ωε

→ ω2

= ω2

= ω2

= ω2

(cid:90)

Ω

Ξv,w(x)θ(x) dx .

To sum up, we obtain

u0(x, y)θ(x) dy dx

(cid:90)

v(x)θ(x) dy +

w(x)θ(x) dy

QY

RY

(Qv(x) + V w(x)) θ(x) dx + ω2

(cid:90)

(cid:19)

dx + ω2

(cid:90)

Ω\D

v(x)θ(x) dx

v(x)θ(x) dx

Ω\D

A∗(x)∇xv(x) · ∇xθ(x) dx = ω2

(cid:90)

Ω

Ξv,w(x)θ(x) dx .

Since θ was arbitrary, this provides the claim (3.19).

Proof of Theorem 3.1. Theorem 3.1 is a direct consequence of Proposition 3.6. In-
deed, by exploiting the Relation (3.11) between v and w one immediately obtains,
for x ∈ Ω,

Ξv,w(x) = Λ(x)v(x) .

22

A. Lamacz, B. Schweizer

The eﬀective equation (3.19) is therefore identical to the one of Theorem 3.1.

A Averages on channel interfaces

The proof of Proposition 3.4 is based on the following auxiliary lemma. It shows
that, in the limit ε → 0, averages on interfaces coincide with bulk averages — on
the volume side of the interface.

Lemma A.1 (Averages on thin channel interfaces). We consider the obstacle
Y ⊂ Y that separates, inside the unit cell, the resonator RY from the outer
Σε
domain QY , but leaves a thin channel K ε
Y that connects RY and QY (as introduced
in Section 1.3). Let Uε : Y \ Σε
Y be a sequence of H 1-functions that is L2-bounded
and that solves the Helmholtz equation

−∆Uε = ω2ε2Uε
∂nUε = 0

in Y \ Σε
Y ,
on ∂Σε
Y .

(A.1)
(A.2)

Note that we impose no boundary condition on ∂Y . The only additional assump-
tion is, for two numbers ξR, ξQ ∈ R, the weak convergence

Uε|RY (cid:42) ξR
Uε|QY (cid:42) ξQ

in L2(RY ) ,
in L2(QY ) ,

(A.3)
(A.4)

Y = {yR}×Bn−1

as ε → 0. We denote the interface between RY and channel K ε
¯RY ∩ ¯K ε
αεp and, accordingly, the outer interface by Γε,Q
{yQ} × Bn−1
convergence of interface averages:

:=
Y =
αεp . Under the above assumptions we obtain, in the limit ε → 0, the

Y by Γε,R
:= ¯QY ∩ ¯K ε

Y

Y

Uε(y) dHn−1(y) → ξR

and

Uε(y) dHn−1(y) → ξQ .

(A.5)

(cid:90)

−

Γε,Q

Y

(cid:90)

−

Γε,R

Y

Remark A.2. It is easy to obtain local H 1-estimates for the solution sequence Uε
(as we will show in Step 1 of the proof ). The assertion of the lemma is interesting
since the channels degenerate in the limit ε → 0.
Indeed, let us imagine the
channels had a constant cross-section which does not degenerate in the limit ε → 0.
In that case, the trace theorem provided that the traces of Uε along Γε
R converge
to the trace of the limit function, i.e. the trace of the constant function ξR, which
is ξR. The average of that function over Γε,R

is ξR, hence (A.5) follows.

Y

The subsequent proof is a sketch in so far as technical details in Step 2 are

omitted.
Sketch of proof. Step 1. Local H 1 estimate. We choose a cut-oﬀ function θ ∈
c (Y ) which is identical to 1 in RY ∪ Σε
C∞
Y and use θ2Uε as a test function
in equation (A.1) to obtain

Y ∪ K ε

|∇Uε|2θ2 = −2

θ∇Uε · ∇θ Uε + ω2ε2

|Uε|2θ2 .

(cid:90)

Y \Σε

Y

(cid:90)

Y \Σε

Y

(cid:90)

Y \Σε

Y

Eﬀective Helmholtz Equation in a geometry with small resonators

23

Figure 2: Sketch of the geometry around the end-point of the channel.

With Youngs inequality we conclude from the L2-boundedness of Uε the L2-
boundedness of θ∇Uε.

Step 2. Estimates for ∂1Uε. We now want to obtain estimates for higher
derivatives of the solution sequence. We recall that the lateral boundaries of the
channel are straight and aligned with e1. Furthermore, in a neighborhood of Γε,R
Y ,
the boundary ∂RY was assumed to be contained in a hypersurface with normal
e1.

We examine the solution in the ball Bδ := Bδ((yR, 0)), where δ > 0 is chosen so
Y ∩ Bδ consists of two pieces, a subset of the cylinder
small that the boundary ∂Σε
Y and a subset of the plane {yR} × Rn−1.
∂K ε
We study the function Vε := ∂1Uε in Bδ. The function Vε solves the Helmholtz
−∆Vε = ω2ε2Vε (in the distributional sense) in Bδ \ Σε
Y . On the plane part of the
Y ∩ ({yR} × Rn−1) ∩ Bδ, it satisﬁes the Dirichlet condition Vε = 0
boundary, ∂Σε
(since Uε satisﬁes the homogeneous Neumann condition). On the cylindrical part
Y ∩Bδ, it satisﬁes the homogeneous Neumann condition
of the boundary, ∂K ε
(∂νVε = ∂1∂νUε = 0).

Y ∩∂Σε

The homogeneous boundary conditions allow to derive an estimate for Vε:
Multiplication of the Helmholtz equation for Vε with the solution Vε (multiplied
with a cut-oﬀ function) provides local H 1-estimates for Vε.

The above is not a rigorous proof: A priori, the function Vε is only of class
L2 (as a derivative of Uε), hence testing the equation with Vε is not allowed. To
obtain a rigorous proof, one has to proceed as follows: (a) Localize the problem
and formulate boundary value problems for Uε and Vε in Bδ (or, better, for their
truncated counterparts).
(b) Show with the help of the Lax-Milgram lemma
that the Vε problem posesses a solution Vε of class H 1. (c) Prove that the y1-
integrated solution solves the Uε-problem and conclude from the uniqueness of the
Uε-problem that the H 1-function Vε coincides with ∂1Uε. We omit these technical
details.

Step 3. Full high order estimate. In two space dimensions, we have obtained

YεΣYεδYKBRY24

A. Lamacz, B. Schweizer

local H 2 estimates at this point: The second derivatives in the second direction
1Uε − ε2ω2Uε ∈ L2. We conclude that all second
can be expressed as ∂2
derivatives are bounded, (cid:107)ΘD2Uε(cid:107)L2 ≤ C for a cut-oﬀ function Θ.
In space dimension n = 3 we consider, for ﬁxed ζ ∈ R, slices Sζ := {y =
(y1, y2, y3)| y1 = ζ}. In every slice Sζ the function Uε|Sζ solves the two-dimensional
1Uε − ε2ω2Uε ∈ L2(Sζ) for almost every ζ.
problem ∆2Uε := (∂2
This provides estimates for all second spatial derivatives in L2, locally around the
interface.

3)Uε = −∂2

2Uε = −∂2

2 + ∂2

Step 4. Sobolev embedding and conclusion. From the compact embedding
H 2(RY ) ⊂ C 0(RY ) we conclude that, up to a subsequence, the solution sequence
Uε|RY converges not only weakly in H 2(RY ) to ξR, but also strongly in C 0(RY ).
This implies the ﬁrst claim of (A.5). The second claim is shown by exactly the
same calculation for Γε,Q
Y .

Acknowledgements

Support of both authors by DFG grant Schw 639/6-1 is greatfully acknowledged.

References

[1] G. Allaire. Homogenization and two-scale convergence. SIAM J. Math. Anal.,

23(6):1482–1518, 1992.

[2] G. Allaire and M. Briane. Multiscale convergence and reiterated homogeni-

sation. Proc. Roy. Soc. Edinburgh Sect. A, 126(2):297–342, 1996.

[3] G. Allaire and C. Conca. Bloch wave homogenization and spectral asymptotic

analysis. J. Math. Pures Appl. (9), 77(2):153–208, 1998.

[4] M. Bellieud and G. Bouchitt´e. Homogenization of elliptic problems in a ﬁber
reinforced structure. Nonlocal eﬀects. Ann. Scuola Norm. Sup. Pisa Cl. Sci.
(4), 26(3):407–436, 1998.

[5] M. Bellieud and I. Gruais. Homogenization of an elastic material reinforced
by very stiﬀ or heavy ﬁbers. Non-local eﬀects. Memory eﬀects. J. Math. Pures
Appl. (9), 84(1):55–96, 2005.

[6] G. Bouchitt´e and M. Bellieud. Homogenization of a soft elastic material

reinforced by ﬁbers. Asymptot. Anal., 32(2):153–183, 2002.

[7] G. Bouchitt´e, C. Bourel, and D. Felbacq. Homogenization of the 3D Maxwell
system near resonances and artiﬁcial magnetism. C. R. Math. Acad. Sci.
Paris, 347(9-10):571–576, 2009.

Eﬀective Helmholtz Equation in a geometry with small resonators

25

[8] G. Bouchitt´e and D. Felbacq. Low frequency scattering by a set of parallel
metallic rods. In Mathematical and numerical aspects of wave propagation
(Santiago de Compostela, 2000), pages 226–230. SIAM, Philadelphia, PA,
2000.

[9] G. Bouchitt´e and D. Felbacq. Homogenization near resonances and artiﬁcial
magnetism from dielectrics. C. R. Math. Acad. Sci. Paris, 339(5):377–382,
2004.

[10] G. Bouchitt´e and D. Felbacq. Homogenization of a wire photonic crystal: the
case of small volume fraction. SIAM J. Appl. Math., 66(6):2061–2084, 2006.

[11] G. Bouchitt´e and B. Schweizer. Homogenization of Maxwell’s equations in a

split ring geometry. Multiscale Model. Simul., 8(3):717–750, 2010.

[12] G. Bouchitt´e and B. Schweizer. Plasmonic waves allow perfect transmission
through sub-wavelength metallic gratings. Netw. Heterog. Media, 8(4):857–
878, 2013.

[13] Y. Chen and R. Lipton. Tunable double negative band structure from non-

magnetic coated rods. New Journal of Physics, 12(8):083010, 2010.

[14] K. D. Cherednichenko, V. P. Smyshlyaev, and V. V. Zhikov. Non-local ho-
mogenized limits for composite media with highly anisotropic periodic ﬁbres.
Proc. Roy. Soc. Edinburgh Sect. A, 136(1):87–114, 2006.

[15] V. Chiad`o Piat and M. Codegone. Scattering problems in a domain with
small holes. RACSAM Rev. R. Acad. Cienc. Exactas F´ıs. Nat. Ser. A Mat.,
97(3):447–454, 2003.

[16] D. Cioranescu and F. Murat. A strange term coming from nowhere.

In
Topics in the mathematical modelling of composite materials, volume 31
of Progr. Nonlinear Diﬀerential Equations Appl., pages 45–93. Birkh¨auser
Boston, Boston, MA, 1997.

[17] D. Cioranescu and J. Saint Jean Paulin. Homogenization in open sets with

holes. J. Math. Anal. Appl., 71(2):590–607, 1979.

[18] D. Cioranescu and J. Saint Jean Paulin. Homogenization of reticulated struc-
tures, volume 136 of Applied Mathematical Sciences. Springer-Verlag, New
York, 1999.

[19] C. D¨orlemann, M. Heida, and B. Schweizer. Transmission conditions for
the Helmholtz equation in perforated domains. Preprint 2015-02 of the TU
Dortmund, 2015. http://hdl.handle.net/2003/34074.

[20] S. Guenneau, F. Zolla, and A. Nicolet. Homogenization of 3D ﬁnite photonic
crystals with heterogeneous permittivity and permeability. Waves Random
Complex Media, 17(4):653–697, 2007.

26

A. Lamacz, B. Schweizer

[21] V. V. Jikov, S. M. Kozlov, and O. A. Ole˘ınik. Homogenization of diﬀerential
operators and integral functionals. Springer-Verlag, Berlin, 1994. Translated
from the Russian by G. A. Yosiﬁan [G. A. Iosifyan].

[22] R. Kohn and S. Shipman. Magnetism and homogenization of micro-

resonators. Multiscale Modeling & Simulation, 7(1):62–92, 2007.

[23] R. V. Kohn, J. Lu, B. Schweizer, and M. I. Weinstein. A variational per-
spective on cloaking by anomalous localized resonance. Comm. Math. Phys.,
328(1):1–27, 2014.

[24] A. Lamacz and B. Schweizer. Eﬀective Maxwell equations in a geometry with

ﬂat rings of arbitrary shape. SIAM J. Math. Anal., 45(3):1460–1494, 2013.

[25] A. Lamacz and B. Schweizer.

Maxwells equations.
http://hdl.handle.net/2003/34176.

for
Preprint 2015-06 of the TU Dortmund, 2015.

A negative index meta-material

[26] G. Nguetseng. A general convergence result for a functional related to the

theory of homogenization. SIAM J. Math. Anal., 20(3):608–623, 1989.

[27] S. O’Brien and J. Pendry. Magnetic activity at infrared frequencies in struc-
tured metallic photonic crystals. J. Phys. Condens. Mat., 14:6383 – 6394,
2002.

[28] J. Pendry. Negative refraction makes a perfect lens. Phys. Rev. Lett.,

85(3966), 2000.

[29] E. S´anchez-Palencia. Nonhomogeneous media and vibration theory, volume

127 of Lecture Notes in Physics. Springer-Verlag, Berlin, 1980.

[30] B. Schweizer. The low-frequency spectrum of small Helmholtz resonators.

Proc. A., 471(2174):20140339, 18, 2015.

[31] V. Veselago. The electrodynamics of substances with simultaneously negative

values of ε and µ. Soviet Physics Uspekhi, 10:509–514, 1968.

[32] V. V. Zhikov. Two-scale convergence and spectral problems of homogeniza-

tion. Tr. Semin. im. I. G. Petrovskogo, (22):105–120, 333, 2002.

