6
1
0
2

 
r
a

 

M
1
2

 
 
]

.

R
T
n
i
f
-
q
[
 
 

1
v
8
5
5
6
0

.

3
0
6
1
:
v
i
X
r
a

Universal trading under proportional

transaction costs

Richard J. Martin∗

March 22, 2016

Abstract

The theory of optimal trading under proportional transaction costs
has been considered from a variety of perspectives.
In this paper,
we show that all the results can be interpreted using a universal law,
illustrating the results in trading algorithm design.

First published in RISK 27(8):54–59, 2014.

1

Introduction

In this paper we consider how to ‘optimally’ deal with proportional 1 trans-
action costs when trading a single asset that follows an arbitrary diﬀusion
process. Many of the superﬁcial diﬀerences between the various strands of
research are unimportant, and there is a universal law (eq. 1) which we
formally publish here. Although the literature on the subject is reasonably
large, there is very little on applications in systematic trading algorithm de-
sign, so the purpose of this paper is to demonstrate it, with speciﬁc emphasis
on the Sharpe ratio objective and variants of it, as these are the most often
used in practice but have not been considered in the literature.

A systematic trading algorithm is a function that, given previous price
history and/or the prices of other instruments, gives a ‘target position’ ˆθt in
the instrument to be traded. From the dynamics of these prices, which we

∗Dept. of Mathematics, Imperial College London, SW7 2AZ, UK; Apollo Global Man-

agement International, 25 St George St, London W1S 1FS, UK

1The term ‘linear’ costs often refers to the presence of ﬁxed per-ticket cost and also a
proportional part generated by a bid-oﬀer independent of the trade size. As we are not
considering a ﬁxed part, we use the term ‘proportional’, whereas in [8] the term ‘linear’
was used for the same thing.

1

assume diﬀusive, is inherited the dynamics of ˆθt. The susceptibility of the
strategy to transaction costs therefore depends principally on its volatility
. As the target position changes by O(dt1/2) over a time period dt, money
σˆθt
will be lost at an inﬁnite rate. It is well known (see initially [5]) that the
optimal strategy is to draw a ‘buﬀer’ around the target position, deﬁning
a no-trade (NT) zone in which the position is held unchanged and on each
side a discrete-trade (DT) zone in which one trades immediately to the
edge of the NT zone: see Figure 1. This prevents the strategy constantly
trading backwards and forwards: typically the action is to restrict trading
to a succession of small trades in one direction only, subsequently reversing.
The question we are to address is, what is the optimal buﬀer width? Too
narrow, and one loses too much in costs by overtrading; too wide, and the
so-called ‘displacement loss’, as a result of having a non-optimal position
on, is excessive (in option delta-hedging problems the delta would be too far
from zero).

 150

 100

 50

 0

-50

s
t
o
l
/
 

n
o
i
t
i
s
o
p

-100

-150

 0

target
buffered

 50

 100

 150

 200

 250

time /days

Figure 1: Eﬀect of buﬀering in example used later.

Optimality

We should ﬁrst deﬁne what optimality means. Essentially, there are two
types of problem, which we call Type I/II:

I Traditional expected utility maximisation of terminal wealth with or
without consumption, such as the so-called ‘Merton problem’ of rebal-

2

ancing a portfolio of a stock and riskfree bond, or the delta-hedging
of options;

II Local utility maximisation [2], as applied in systematic trading algo-
rithms [8, 6]. This means that incremental rather than terminal P&L
variation is being penalised.

There are two diﬀerent methods of solution: maximise the expected utility
with respect to the buﬀer width, and understand how the utility depends
on ε at leading order; or obtain the exact boundary and then consider how
that depends on ε.

The optimal buﬀering formula, and dependencies

In a working-paper [6], dealing with Type II, we state that the optimal
half-width, in the limit of small costs, depends on only four quantities: the
volatility of the target position ˆθt and the (absolute, $) volatility of the
underlying asset X, the ratio of these being denoted ˆΓ0; the proportionality
coeﬃcient of cost, ε; and a parameter pertaining to the degree of absolute
risk aversion, denoted G and having monetary units. The formula for the
half-width δθ is

δθ ∼  3εGˆΓ2

2 !1/3

0

,

ˆΓ2

0 =

σ2
ˆθ
σ2
X

.

(1)

The same result is obtained in a working-paper of Kallsen & Muhle-Karbe
[3] (an excellent discussion of the subject and its literature), using Type I.
The optimal buﬀer is also displaced from the no-cost position, reﬂecting the
fact that if one needs to buy more of the asset to reach the target position,
but yet the target position is predicted to decrease, then one should buy less
now. This result is not universal and as the displacement is typically small
we ignore it in this paper.

The application of this results is simple because the parameters are easily
attributable to obvious characteristics of the trading strategy; we give a
couple of calculations in a moment.

The ratio ˆΓ2

0, which in option delta-hedging problems is just the square
of the option’s gamma, is understood as an attempted trading speed: the
higher it is, the wider the buﬀer. The cube-root dependence on ε is impor-
tant. For single-period problems it is immediate that the law is actually
a proportional one; but this ignores the fact that when many trades are
done, at potentially very small time intervals, the frequency of trading has
to be taken into account, with more trades causing more loss. By wrongly

3

using a proportional law, one ends up overtrading cheap markets, incurring
excessive losses through transaction cost, and undertrading expensive ones,
causing excessive displacement loss.

Only G, which has dollar units and is application-dependent, requires
further explanation. In Type I problems, G is the scaling constant in the
utility function and speciﬁes what variability of terminal wealth is accept-
able. In Type II problems, the target position is proportional to the instan-
taneous rate of return of the asset and inversely proportional to the square of
its volatility: it is in fact G the desired dollar P&L volatility per unit Sharpe
of the strategy [6, Eq.6], the idea being that one allocates a ‘risk budget’
proportional to one’s ﬁnancial means and to the expected Sharpe ratio, and
the eﬀect of changing G is simply to rescale the position: ˆθ = GµX /σ2
X .

As an example, take the trading of the front Treasury note futures con-
tract TY1, about which we assume the following: spot price 127, bid-oﬀer
0.02, 1pt = $1000, Black-Scholes ATM vol 5%. So then σX = $400 (=
typical $ daily move of one contract), and ε = $10 (=half the bid-oﬀer of
one contract, in $). Now let the strategy be geared at G = $1,000,000 and
suppose that its daily position changes by typically 35 contracts. Then

δθ =(cid:18) 3

2 × $10 × $106 ×

352

($400)2(cid:19)1/3

= 49 contracts.

Notice the need to convert everything to consistent units: X is written in
dollars, θ is a number of contracts, time in business days (necessitating
conversion from annualised to daily vol).

As a second example, take the trading of a CDS index contract, spread
80bp, vol 35%, 5Y duration, bid-oﬀer 0.75bp. One lot (θ = 1) means a
notional of $1,000,000. Then σX = $875 (daily) and ε = $190. Let the
strategy be geared at G = $500,000 and suppose that its daily position
change is typically $4,000,000. Then

δθ =(cid:18) 3

2 × $190 × $500 · 103 ×

42

($875)2(cid:19)1/3

= 14 ($M notional).

Universality

The most important thing is what gives rise to instantaneous variation of
the target position, which is why ˆΓ0 enters: that is what directly gives rise
to transaction losses. Many ingredients in the setup do not signify, because
they do not convey information beyond that of ˆΓ0, for example:

4

• whether the objective function is utility-based or Sharpe-based (we

explain this in more detail presently);

• the utility function, or the risk measure;
• whether the objective function pertains to a ﬁnite or inﬁnite horizon;
• whether the asset is ‘cash-like’ (like a stock following a geometric Brow-
nian motion), or ‘synthetic’ (as in for example the PV of a swap,
hence written down as an arithmetic Brownian motion with possibly
non-constant volatility);

• the origin of the problem, e.g. option hedging, systematic trading;
• the number of factors used to describe the asset dynamics.

Thus (1) is universal, with the proviso that the symbols may need reinter-
pretation from case to case: for example in equity trading, deciding whether
θ means the $ notional of a stock, or whether it means the number of shares.
This is just a question of ensuring consistency.

To put these into context, and to justify universality, here is a brief

overview of published and unpublished results that links everything up:

Option delta-hedging: [11, 12] (Type I)

Generally the objective function is utility of terminal wealth and the horizon
is the option expiry. As the terminal P&L can be negative, CARA i.e.
negative-exponential utility is used. Their formula [12, Eq.12] is as stated
in (1), if we substitute ε = ε′S, σ2
0 = Γ2,
ˆθ
explaining our choice of notation), with S the stock price, σ the Black-
Scholes volatility, Γ the option gamma, and ε′ the transaction cost as a
fraction of the stock price. We also write G in terms of their risk aversion
coeﬃcient γ via G = e−r(T −t)/γ, the discounting coming from the fact that
G pertains to time t (today) and 1/γ to time T (expiry). The resulting
formula δθ is the width of the NT zone in delta units, as opposed to a $
notional of stock.

X = σ2S2Γ2/σ2S2 (thus ˆΓ2

/σ2

Systematic trading with ‘zero-factor’ model: [8] (Type II)

(See also [9].) We formulate systematic trading models by expressing the
dynamics of the traded asset as functions of ‘factors’, ~Z:

dXt = µX( ~Zt) dt + σX( ~Zt) dWX,t;

5

these factors may be exogenous (e.g. coming from analyst views, or market
prices of other instruments) or endogenous (e.g. momentum). By zero-factor
we mean a one-factor model in which the factor Z1,t is actually the asset
Xt being traded: Z1 ≡ X. (A general one-factor model therefore has two
moving parts: the factor and the traded asset.) The objective function
is not utility of terminal wealth, but utility of changes in wealth—the so-
called local utility functions, in which the objective is U (θt dXt) summed,
with U a smooth concave function. Without loss of generality we can impose
U (0) = 0, U ′(0) = 1, U ′′(0) = −1/G, and for diﬀusive dynamics it boils down
to a quadratic objective. The objective (value function) is

Vt = Et(cid:20)Z ∞
= Et"Z ∞

s=t

s=t

e−r(s−t)U (θs dXs)(cid:21)
e−r(s−t)(cid:18)θsµXs −

θ2
sσ2
Xs

2G (cid:19) ds# ,

(2)

so the target position is ˆθt = µXtG/σ2
Xt . The inﬁnite horizon causes the
value function to obey an ordinary diﬀerential equation in X rather than a
parabolic PDE in (t, X). Although this particular model has limited appli-
cation, it has the remarkable consequence of a reasonably explicit solution
for the NT boundary, obtained in [8], though the equations are unwieldy;
also, it forms the basis for the discussion of multifactor models which are
very general. Note that [8] gives a non-heuristic derivation of the cube-root
law, because it drops out of a Taylor series expansion of the solution2: thus
one does not need to ‘know in advance’ that expansion in powers of ε1/3
was necessary. The simplest case is where X follows Ornstein-Uhlenbeck
dynamics dXt = −bXt dt + σ dWt:
ˆθ = −bXG/σ2,

δθ ∼ (3εb2/2σ4)1/3G.

Bouchaud and co-workers corroborate this by diﬀerent techniques [4].

Systematic trading with multifactor model: [6] (Type II)

When many factors cause the target position to vary, the position is still
ˆθt = µX( ~Zt)G/σX ( ~Zt)2 which is a function of ~Z ∈ Rm, but despite the higher
dimensionality, eq. (1) still holds. This is because of ‘locality’ again. In the
(m − 1)-dimensional space perpendicular to the gradient vector ∇ˆθ( ~Z), the
target position does not change for small changes in ~Z, and so no transaction

2It balances the two leading order terms, which turn out to be O(δθ)3 and O(ε).

6

costs occur: one only needs to study the direction of greatest variation in ˆθ,
which is ∇ˆθ( ~Z), reducing everything to a one-dimensional problem.
CRRA utility (Type I)

Constant relative risk aversion is applicable to what might be described as
cash strategies, such as the rather academic ‘Merton problem’ of rebalancing
a portfolio of stock and bond [1, 10]. It only makes sense when the portfolio
value is always ≥ 0 (as the utility function is singular at 0). As pointed out
by Kallsen & Muhle-Karbe [3], one replaces the gearing G with W/γ, where
W > 0 is the current wealth and γ the coeﬃcient of constant relative risk
aversion. That G is no longer constant does not matter: this variability is
not a local eﬀect. It simply says that in the future, when I have made or
lost money, I will want higher or lower gearing, but that is irrelevant to the
question of how to mitigate the transaction costs associated with trading
occurring now.

Utility of terminal wealth vs Local utility (Type I/II)

Utility of terminal wealth (with or without a consumption term) just about
makes sense in investment problems, but not in systematic trading, for two
reasons. First, there is no well-deﬁned time horizon, and investors are typi-
cally worried about short-term variation in P&L, particularly as that gives
rise to drawdowns. Secondly, although such strategies can be tested with
simulated data (as can the option-hedging problems) by running many sim-
ulations, they cannot legitimately be backtested on real data as there is only
one trajectory from which to form the expected utility. On the other hand,
with a couple of decades’ data, one can form an opinion about the Sharpe
ratio if risk is taken as variation in P&L, or again the so-called local utility
functions (q.v.): these are natural in the trading world, as they relate easily
to a ‘daily VaR limit’. Nonetheless, the buﬀering law is the same, and again
this is an argument about ‘locality’: whatever the objective function, the
important thing is the variability of the target position.

Sharpe ratio vs local utility; diﬀerent risk measures (Type II)

It is easily established (see e.g. [6]) that the classic Markowitz optimisation
problem of maximising expected return subject to an upper bound on the
risk, to be interpreted as quadratic variation of P&L, is equivalent to (2)
above; the proof is a simple exercise in Lagrange multipliers, with G in (2)

7

being the reciprocal of the Lagrange multiplier. Therefore, Sharpe ratio op-
timisation, in which we maximise mean ÷ square root of quadratic variation,
is equivalent to the local quadratic utility formulation of (2).
If the market is diﬀusive, and our estimate of volatility ˆσXt is correct,
there is no diﬀerence between using standard deviation of daily returns (to
compute the local utility) or some other risk measure such as VaR or short-
fall. In practice, these assumptions are dubious, but in the absence of any
theoretical results for non-diﬀusive markets, we may as well attempt to use
(1). The numerical results that we presently show suggest that this is jus-
tiﬁable. This is unsurprising, because losses from transaction costs largely
arise from the diﬀusive component of the market returns, not from occa-
sional jumps.

2 Numerical demonstration

We demonstrate eq. (1), choosing Sharpe ratio as a performance measure.
In principle we must test against all other buﬀering schemes; and another
diﬃculty is that the buﬀer width is generally time-varying, so we cannot
simply plot Sharpe ratio vs buﬀer width (there is no unique buﬀer width
to plot on the horizontal axis). What we can do, though, is multiply δθ in
eq. (1) by some ﬁxed amount λ, and plot the time-average of the buﬀer width
on the horizontal axis, and on the vertical axis the Sharpe ratio. Repeating
for diﬀerent values of λ causes a curve to be described, and we highlight the
point corresponding to λ = 1. Finally, we repeat for diﬀerent transaction
cost parameters to give a family of curves.

Consider what this curve should look like, as a function of λ.

If the
buﬀer width is too small (λ → 0) then too much value will be lost, and in
continuous time it would drop to −∞: the drop will be severe if ε is high. If
the buﬀer is too wide, the displacement loss takes over and the performance
should drop. Indeed, in the limit λ → ∞ the NT zone will become so large
that no trading takes place at all, and then the Sharpe ratio will become
undeﬁned. At some intermediate point there should be a maximum and
ideally the result for λ = 1—which we mark in the Figures—will be exactly
there, indicating that no improvement can be made by scaling (1) up or
down by a ﬁxed amount; though it does not rule out the possibility that the
buﬀer is suboptimal by virtue of being at some times too wide and at other
times too narrow. However, if the costs are high enough, the value function
will always be negative and there will be no hump: then the strategy is
worthless, irrespective of how well ‘optimised’ the buﬀer is.

8

For these models the gearing plays no useful role because it simply scales
the position, the buﬀer width, the expected P&L, and the risk, all in direct
proportion, so it has no eﬀect on the Sharpe ratio. We therefore set G to $1M
throughout. We are going to use VaR and shortfall (ESF) as well as standard
deviation in the Sharpe ratio calculation. We ﬁx the tail probability as
p = 0.01, and for convenience we divide the VaR by Φ−1(1 − p) and the
ESF by φ(Φ−1(p))/p so that3 for Normal distributions of zero mean all these
measures are identical. Fat-tailed return distributions thereby produce lower
VaR-Sharpe and ESF-Sharpe—as is seen here, though the eﬀect is slight.

Note incidentally that the alternative method of ﬁnding the optimal
buﬀer width is dynamic programming. This is impractical unless the number
of factors is small: in real trading algorithms one may well have ten or so
factors, requiring an optimisation in ten dimensions.

Examples using synthesised data

Synthesised models allow arbitrarily much data to be generated, with all
parameters known. We consider the one-factor linear model,

dXt = βσX Z1,t dt + σX dW0,t

dZ1,t = −κZ1,t dt + √2κ dW1,t

(3)

with Type II optimisation. The factor Z1 follows a standardised OU process
and is understood as a sort of bull-or-bear indicator: when positive, X drifts
upwards, and when negative, downwards. It is immediate that

ˆθt =

βZ1,tG

σX

,

ˆΓ2

0 =

2β2κG2

σ4
X

,

and that the Sharpe ratio for T -period trading returns is |β|T 1/2, with which
simulation should agree (and does). Thus

δθ ∼(cid:18) 3εκ

σX|β|(cid:19)1/3 G|β|

σX

=(cid:18) 3ˆεκ

|β| (cid:19)1/3

(cid:0)θ2(cid:1)1/2

where ˆε = ε/σX is the cost per unit volatility of the tradable and (θ2)1/2 =
Gβ/σX is the root mean square position (not the same as σˆθ which pertains
to changes in position). Notice that in this simple case ˆΓ2
0 and hence δθ are
constant—though they are not if the coupling is nonlinear, i.e. in the drift

3Φ, φ denote as usual the standard Normal cdf and pdf.

9

of dXt we replace Z1 by a function ψ(Z1)—and that correlation between
dWX,t and dWZ1,t does not play a part. Notice also that the buﬀer width
and position are both inversely proportional to σ, provided one ﬁxes ˆε. (If
the volatility of the underlying increases with ε ﬁxed, then the asset has
actually become cheaper to trade and the buﬀer width drops as a fraction
of the typical position.) Thus the only factors that link the buﬀer width
to the r.m.s. target position are ˆε1/3 and an extra quantity κ/|β| that has
dimensions time−1/2; this is necessary for dimensional agreement (because ˆε
has dimensions time1/2) and can be thought of as the trading speed, because
the higher κ is the more rapidly the factor is changing direction. Finally, if
β → 0 then the buﬀer width becomes large as a fraction of the r.m.s. position
(not in absolute terms because the r.m.s. position reduces too): the expla-
nation for this is that the asset price has in eﬀect become less predictable,
or that the trading signal is of lower quality: as expected, therefore, the NT
zone becomes relatively wide and cuts down the amount of trading.

Figure 2(a) shows results with4 κ = 0.02, β = 0.04, σ = 0.5, ρ01 = 0, for
transaction cost ε = 0.02, 0.05, 0.1, 0.2, 0.5. The appearance of the graphs
is as expected and the postulated rule (1) appears to be optimal. For low
costs the impact of getting the buﬀer wrong is quite small, but for high
costs it is much bigger: being out by a factor of 2 makes a huge diﬀerence in
performance. As returns are Normally distributed here, the results for VaR
and ESF are identical and hence are omitted.

Extensions to nonlinear coupling, multiple factors and stochastic volatil-
ity are given in [6]: the results are all pretty much the same, suggesting that
the above model contains all the important ingredients.

Examples using real data

The model of the previous section is most easily interpreted as an exogenous
factor driving the tradable asset, and the model parameterisation can be
determined by observation, subject of course to estimation error. Here the
construction is diﬀerent and there is the additional problem that once does
not know the underlying model: but as it turns out, that does not matter.
In momentum models, the factors are implicit, and estimated using mov-
ing averages of the asset being traded. Using integration by parts, a moving

4Dimensions of κ, β, σ are respectively time−1, time−1/2, $/time1/2, where units of
time need to be consistent throughout: we are having them as business days. 10,000 data
points were used.

10

)
v
e
d
t
s
:
n
a
e
m

(
 
e
p
r
a
h
S

 0.8

 0.6

 0.4

 0.2

 0

-0.2

-0.4

 0

0.02
0.05
0.1
0.2
0.5
theor. opt.

 0.05

 0.1

 0.15

 0.2

 0.25

average buffer halfwidth

Figure 2: Performance vs buﬀer size for synthesised model. Cost multipliers (ε) are
indicated on graph. Buﬀer size is as notional in $M. Theoretical optimum marked
in each case.

average of prices can be reexpressed as a weighted sum of returns,

Zt =Z t

τ =−∞

K(t − τ ) dXτ /σXτ .

For the commonly-used exponentially-weighted moving average crossover,

K(τ ) = p2(Ts + Tf)
|Ts − Tf|

(cid:0)e−τ /Ts − e−τ /Tf(cid:1)

where Tf and Ts are the ‘periods’, so for example a 5:10 day moving average
has Tf = 5, Ts = 10. The prefactor normalises Z 2 = 1. It is also advan-
tageous [7] to transform the normalised signal using a ‘response function’
ψ rather than simply having a position proportional to Z. By combining
ﬁlters of diﬀerent speeds, one obtains a prediction of dXt, and thence the
target position:

ˆθt =

β1ψ(Z1,t) + ··· + βmψ(Zm,t)

σXt

.

The factor weights (βj ) are ﬁtted by regression or by optimising the back-
tested performance, or can be set manually. For these purposes we use 2:4,
4:8, 8:16, 16:32 day crossovers and the response function is ψ(z) = ze−z2/2.
Now, it is diﬃcult to get ˆΓ2
0 theoretically, but very simple to estimate it

11

empirically from the observed quadratic variation of ˆθ and X in the natural
way:

(ˆΓ2

32 ).

n=0 αn(ˆθt−n δt − ˆθt−(n+1) δt)2
0)t ≈ P∞
n=0 αn(Xt−n δt − Xt−(n+1) δt)2 ,
P∞
with α being the ‘forgetting-factor’ (we used an eﬀective ‘period’ of 32 days
in simulation, so α = 1 − 1
In the example we have considered here the time series of the traded
asset Xt is given by stitching together the time series of the individual
futures contracts5. The time series is assumed to exhibit trending to some
extent, which should result in P&L generation from a momentum strategy.
Two contracts are used: TY1 (front US Treasury note futures) and RR1
(rough rice). Positions and buﬀer sizes are expressed in $M notional; for
TY, costs are as a fraction of par6 and for RR they are a proportion of the
current futures price7. Again we ﬁx G =$1M. The position and the buﬀer
size are expressed as notional amounts in $M: to express them as a number
of contracts, just divide by the contract size8 in $M.

The results are shown in Figure 3. The theoretical optimum is reasonably
optimal in practice too, and again the eﬀect of getting the buﬀer width wrong
by a factor of 2 is substantial, except for very low costs. The same picture
is seen for diﬀerent risk measures. For low transaction costs, the Sharpe
ratio does not go negative in the limit of no buﬀering. This is because
the simulations are being done in discrete time, an issue requiring further
research. For rice, which has historically trended less well than bonds, notice
that trading generates no value for high transaction costs, rendering the
strategy ineﬀective.

5This can be done automatically in Bloomberg (GFUT <Go>). We adjust ﬁxed-income

contracts by diﬀerence and everything else by ratio.

×

1

64 /100 ≈ 0.0001. US Treasuries are

2

6e.g. if market is 128-03/128-03+ then ε = 1

quoted in 1

32 s with + denoting 1
64 .

7e.g. if market is 20.16/20.18 then ε = 1
× 0.02/20.17 ≈ 0.0005.
8e.g. TY: this is $100,000. Thus θ = $32M means 320 contracts.

2

12

(a)

(b)

)
v
e
d
t
s
:
n
a
e
m

(
 
e
p
r
a
h
S

)

:

R
a
V
n
a
e
m

(
 
e
p
r
a
h
S

)

:

F
S
E
n
a
e
m

(
 
e
p
r
a
h
S

 0.6

 0.5

 0.4

 0.3

 0.2

 0.1

 0

-0.1

-0.2

 0.6

 0.5

 0.4

 0.3

 0.2

 0.1

 0

-0.1

-0.2

 0.6

 0.5

 0.4

 0.3

 0.2

 0.1

 0

-0.1

-0.2

0.0001
0.0002
0.0005
0.001
0.002
theor. opt.

 0

 5

 10

 15

 20

 25

(d)

0.0001
0.0002
0.0005
0.001
0.002
theor. opt.

 0

 5

 10

 15

 20

 25

(e)

0.0001
0.0002
0.0005
0.001
0.002
theor. opt.

)
v
e
d
t
s
:
n
a
e
m

(
 
e
p
r
a
h
S

)

:

R
a
V
n
a
e
m

(
 
e
p
r
a
h
S

)

:

F
S
E
n
a
e
m

(
 
e
p
r
a
h
S

 0.5

 0.4

 0.3

 0.2

 0.1

 0

-0.1

-0.2

-0.3

-0.4

0.0005
0.001
0.002
0.005
0.01
theor. opt.

 0

 1

 2

 3

 4

 5

 6

average buffer halfwidth

 0.5

 0.4

 0.3

 0.2

 0.1

 0

-0.1

-0.2

-0.3

-0.4

 0.5

 0.4

 0.3

 0.2

 0.1

 0

-0.1

-0.2

-0.3

-0.4

0.0005
0.001
0.002
0.005
0.01
theor. opt.

 0

 1

 2

 3

 4

 5

 6

average buffer halfwidth

0.0005
0.001
0.002
0.005
0.01
theor. opt.

 0

 5

 10

 15

 20

 25

 0

 1

 2

 3

 4

 5

 6

(c)

average buffer halfwidth

(f)

average buffer halfwidth

Figure 3: Performance vs buﬀer size for momentum strategy, with diﬀerent ob-
jective functions and markets. Cost multipliers (ε) are indicated on graph. Buﬀer
size is as notional in $M. Theoretical optimum marked in each case. Objective
functions: (a,d) Stdev, (b,e) VaR, (c,f) Shortfall. Markets: (a,b,c) US Treasury
note TY1, (d,e,f) Rough rice (RR).

13

3 Conclusions

We have demonstrated a rule (1) for the optimal buﬀer, or NT, width to
be applied to a diﬀusive factor model in the presence of proportional trans-
action costs and it seems to work well. For low costs9 it seems to slightly
overestimate the optimal width in the ‘real’ examples we showed, and we
think this is due in part to the time discretisation in the simulation (the
theory is continuous-time).

Clearly it is important to know whether a strategy can make money after
costs, even if it is proﬁtable in theory. Knowing how to correctly buﬀer a
strategy is important when the transaction cost is high, as we have seen.
If, despite optimising the model parameters and incorporating the buﬀer
rule, the strategy’s simulated expected return is still negative, then one
knows to avoid it. One can also see even before simulating whether costs
are infeasibly high: the buﬀer gets so big that the model exhibits too much
hysteresis, getting stuck in the same position for perhaps months or years,
and is eﬀectively inoperable.

Acknowledgement

The author thanks all of the following: Torsten Sch¨oneborn (Deutsche
Bank), Chris Rogers (University of Cambridge), Jean-Philippe Bouchaud,
J´erˆome de Lataillade and Rapha¨el B´enichou (CFM, Paris), Mete Soner and
Johannes Muhle-Karbe (ETH Z¨urich), Boris Gnedenko (Modern Investment
Technologies Ltd), and an anonymous referee.

References

[1] M. H. A. Davis and A. R. Norman. Portfolio selection with transaction

costs. Math. Oper. Research, 15(4):676–713, 1990.

[2] J. Kallsen. A utility maximisation approach to hedging in incomplete

markets. Math. Meth. Oper. Res., 50(2):321–338, 1999.

[3] J. Kallsen and J. Muhle-Karbe. The general structure of optimal
arXiv,

investment and consumption with small transaction costs.
1303.3148v1, 2013.

[4] J. de Lataillade, C. Deremble, M. Potters, and J.-P. Bouchaud. Optimal

trading with linear costs. arXiv:1203.5957, 2012.

9Strictly, this means lower transaction cost per unit volatility

14

[5] M. J. P. Magill and G. M. Constantinides. Portfolio selection with

transaction costs. J. Econ. Theory, 13:245–263, 1976.

[6] R. J. Martin. Optimal multifactor trading under proportional transac-

tion costs. arXiv.org/pdf/1204.6488, 2012.

[7] R. J. Martin and A. Bana. Nonlinear momentum strategies. RISK,

25(11):60–65, 2012.

[8] R. J. Martin and T. Sch¨oneborn. Mean reversion pays, but costs. RISK,

24(2):84–89, 2011. Full vsn at arxiv.org/pdf/1103.4934.

[9] A. Rej, R. Benichou, J. de Lataillade, G. Z´erah, and J.-P.
Bouchaud. Optimal trading with linear and (small) non-linear costs.
arXiv.org/pdf/1511.07359v2, 2015.

[10] S. E. Shreve and H. M. Soner. Optimal investment and consumption

with transaction costs. Ann. Appl. Prob., 4(3):609–692, 1994.

[11] A. E. Whalley and P. Wilmott. An asymptotic analysis of an optimal
hedging model for option pricing with transaction costs. Math. Fin.,
7(3):307–324, 1997.

[12] V. I. Zakamouline. European option pricing and hedging with both
ﬁxed and proportional transaction costs. J. Econ. Dyn. & Control,
30:1–25, 2006.

15

