General immunity and superadditivity of two-way Gaussian quantum cryptography

Department of Computer Science & York Centre for Quantum Technologies, University of York, YO10 5GH, UK

Carlo Ottaviani∗ and Stefano Pirandola

(Dated: March 7, 2016)

We consider two-way continuous-variable quantum key distribution, studying its security against
general eavesdropping strategies. Assuming the asymptotic limit of many signals exchanged, we
prove that two-way Gaussian protocols are immune to coherent attacks. More precisely we show
the general superadditivity of the two-way security thresholds, which are proven to be higher than
the corresponding one-way counterparts in all cases. We perform the security analysis ﬁrst reduc-
ing the general eavesdropping to a two-mode coherent Gaussian attack, and then showing that the
superadditivity is achieved by exploiting the random on/oﬀ switching of the two-way quantum com-
munication. This allows the parties to choose the appropriate communication instances to prepare
the key, accordingly to the tomography of the quantum channel. The random opening and closing
of the circuit represents, in fact, an additional degree of freedom allowing the parties to convert, a
posteriori, the two-mode correlations of the eavesdropping into noise. The eavesdropper is assumed
to have no access to the on/oﬀ switching and, indeed, cannot adapt her attack. We explicitly prove
that this mechanism enhances the security performance, no matter if the eavesdropper performs
collective or coherent attacks.

PACS numbers: 03.67.Dd, 03.65.-w, 42.50.-p, 89.70.Cf

Introduction

Quantum Key Distribution (QKD) [1] is today one of
the most advanced quantum technologies among those
emerged from the fundamental research in quantum in-
formation. Rapidly progressing towards practical im-
plementations [2], the interest in QKD is motivated by
the promise of achieving eﬃcient distribution of cryp-
tographic keys over insecure channels. In fact its main
goal is to provide an information-theoretic secure strat-
egy to share cryptographic keys in order to replace the
current computationally-secure solution [4], which has
been proved to be vulnerable [3] to attacks by quantum
computers.

The typical scenario involves two parties, Alice and
Bob, who want to share a secret message over an insecure
channel [5] . To achieve this goal they encode classical
information in non-orthogonal quantum states, which are
sent over a noisy quantum channel under control of an
eavesdropper, Eve. The standard assumptions to analyze
the security of QKD protocols are the following: Eve
is computationally unbounded, but has no-access to the
parties’ private spaces [2, 5] and, most importantly, she is
restricted by the no-cloning theorem [6]. The distribution
of private keys is possible because any attempt to extract
the encoded information unavoidably introduces noise on
the quantum states. Monitoring this noise the parties can
quantify how much Eve has learnt on the secret key and,
consequently, apply classical error correction and privacy
ampliﬁcation protocols reducing Eve’s information to a
negligible amount. Once they have distilled such a key,
the parties can safely use the one-time pad protocol. In

∗Electronic address: Carlo.Ottaviani@york.ac.uk

case the level of noise is too high, above the security
threshold, they can abort the protocol (denial of service).
The ﬁrst theoretical proposals for QKD protocols have
been designed for discrete variables (DV) [1] systems.
Today several remarkable implementation of DV-QKD
have been achieved in both ﬁbers [7] and free space [8].
Beside this approach, several protocols exploiting quan-
tum continuous-variable (CV) systems have been put for-
ward [9–14]. In CV-QKD [15] the information is encoded
in quantum systems with continuous spectra (inﬁnite-
dimensional Hilbert space), and a special attention has
been devoted to Gaussian CV systems [16].

Gaussian CV-QKD has been achieved in in-ﬁeld imple-
mentations [17], with practical performances comparable
to those of DV-QKD, despite the latter appears to be
more robust for long-distances. The result of Ref. [17]
has been possible combining eﬃcient reconciliation pro-
tocols [11], post-selection [18] techniques and eﬃcient
classical compression codes [19]. The interest in opti-
cal CV systems, for quantum information purposes, is
now growing, boosted mainly by the natural properties of
these systems: relatively cheap experimental implemen-
tation, higher rates, broadband detection techniques [20],
and the possibility of exploiting a wide range of frequen-
cies [21, 22]. These natural properties make CV-QKD a
promising candidate for future practical real-world imple-
mentations, especially in the mid-range distances like the
metropolitan areas where high rates are desirable [23].

Today, many theoretical eﬀorts are devoted to the de-
sign of device independent (DI) QKD protocols [24, 25].
Despite recent remarkable results, the practical imple-
mentation of this approach remains still diﬃcult [26–28].
Very likely the next generation of end-to-end quantum
networks will use the recently introduced [29, 30] mea-
surement device independent QKD (MDI-QKD) which
allows the distribution of cryptographic keys preserving
the protection against the most typical side-channel at-

6
1
0
2

 
r
a

M
3

 

 
 
]
h
p
-
t
n
a
u
q
[
 
 

1
v
0
7
2
1
0

.

3
0
6
1
:
v
i
X
r
a

tacks, without the need to pass a Bell test (see Ref. [29]
for a general security analysis). Recently a very high-rate
CV-MDI QKD protocol has been proposed and tested in
a proof of principle experiment [23, 31, 32].

Alongside the study of end-to-end QKD, it is also of
great interest the design of more robust point-to-point
QKD schemes improving the security performances of
CV-QKD in noisier environments [14] or able to exploit
trusted noise [33] to implement QKD at diﬀerent frequen-
cies [21]. In this regard, the two-way protocols [14], where
the parties make a double use of the quantum channel
to improve the tolerance to noise, show higher security
thresholds than the one-way counterparts. This idea has
been also extended to thermal QKD [34]. Also note that
the two-way protocols have been developed for DV-QKD
[35, 36] and can be used for direct quantum communica-
tion [37, 38].

The main result in this work is the explicit study
of the asymptotic security of two-way Gaussian proto-
cols against coherent attacks, and the proof that these
schemes are in fact immune to this eavesdropping. The
general strategy to achieve this goal follows a previous in-
sight [14] and can be summarized as follows (see Fig. 1):
The parties randomly switch ON or OFF the two-way
communication line, and they post-select the OFF in-
stances if they detect the presence of coherent attacks,
otherwise they use the ON instances. We explicitly study
the security threshold of the OFF conﬁguration against
two-mode coherent attacks, which are the residual eaves-
dropping after de Finetti reduction. Our approach al-
lows us to prove that the superadditivity of the two-way
thresholds is a general feature. This result can also be
understood noting that the ON/OFF switching activates
an additional degree of freedom, exclusive to the parties,
which can be used to convert (a-posteriori) Eve’s corre-
lations into a noise on which Eve has no control.

Results

The Scheme

In Fig. 1 we describe a two-way quantum communi-
cation protocol. We focus on use of coherent states, for
the encoding, and heterodyne detections for the decod-
ing [10, 14]. Bob prepares a Gaussian-modulated refer-
ence coherent state with density matrix ρ(β), and use
the quantum channel to transmit it to Alice who, ran-
domly, decides to close (case ON) or open (case OFF)
the quantum communication. Let discuss the two cases
in detail.

Case ON : Alice encoding is performed by applying a
Gaussian-modulated displacement ˆD(α) on the reference
state ρ(β), obtaining a new coherent state with density
matrix ρ(α + β). This is sent back to Bob who performs
heterodyne detection on the received state ρ(α + β), and
applies classical post-processing in order to subtract the
reference variable β and derive Bob’s estimate ˜β of Alice’s

2

Alice 

Eve 

Bob
ρ(β)

ON 

OFF 

α

D(α)

ρ(α+ β)

ρ( ′α )

Eve 

′β

(OFF) 

γ

(ON) 

FIG. 1: Two-way CV-QKD protocol. Steps:
forward, Bob
prepares coherent states of amplitude β and density matrix
ρ(β) and sends them through the noisy channel. Using the
circuit in ON conﬁguration, Alice applies a random displace-
ment D(α) on ρ(β) encoding information in the amplitude α.
Backward, Alice then sends the quantum state ρ(α+β) to Bob
who applies heterodyne detection with outcome γ ≃ α + β,
and applies classical post-processing to subtract the reference
amplitude β to recover α. In OFF conﬁguration, the circuit
is opened at Alice’s station. She applies heterodyne detection
on the reference state, obtaining the variable α. She then pre-
pares a new coherent state ρ(α′) which is sent back to Bob
who heterodynes this state obtaining the variable β ′. During
the quantum communication Eve, as well as Bob, does not
know which setup of the circuit has been adopted. For this
reason, she is forced to attack both communication steps, and
cannot adapt her attack to the ON/OFF setup.

variable α.

Case OFF. Alice applies heterodyne detection on the
reference state ρ(β) with outcome α. Then, she prepares
a new Gaussian-modulated coherent state ρ(α′) which is
sent back to Bob, who heterodynes it with outcome β′.
After this, the parties can use the two pairs of variables
{α, β} and {α′, β′} to prepare the key.
We note that, during the quantum communication,
both Bob and Eve do not know the conﬁguration
adopted. This information is shared during the phase
of parameter estimation and is part of the classical com-
munication performed by Alice over the public channel.
In the following we focus on the use of reverse reconcil-
iation (RR) [11, 16] (direct reconciliation is discussed in
the supplemental material). With the quantum commu-
nication in ON, the RR corresponds to Alice inferring
Bob’s ﬁnal outcome variable ˜β. With the circuit in OFF,
the RR corresponds to Bob estimating Alice’s variable
α during the forward stage, followed by Alice estimating
Bob’s detection variable β′.

As described in Ref. [14] the advantage of having the
ON/OFF switching is that this degree of freedom can be
used to post-select the data in order to prepare the key.
After the channel tomography they can determine which
attack has been performed and in which status of the

circuit. Then they keep data from case ON when they
detect a collective attack, while they use data exchanged
with the circuit in OFF when the attack is coherent.

Security analysis and attack reduction

We study the security of the scheme assuming the
asymptotic limit of many uses of the quantum channel,
N ≫ 1. In the worst-case scenario the eavesdropper at-
taches ancillary quantum systems, Ek, to each exchanged
signal, and process the Ek’s by a global coherent unitary
operation. The ancillary output modes are stored in a
quantum memory (QM), and coherently measured after
the classical communication between Alice and Bob at
the end of the protocol. Such an eavesdropping deﬁnes a
general coherent attack.

The parties can now reduce the complexity of the pre-
vious scenario, by applying symmetric random permuta-
tions [41] of their classical data. This allows them to get
rid of all the correlations between distinct instances of
the protocol. It is then clear that, in the case of two-way
communication, the de Finetti symmetrization provides
a residual two-mode coherent attack, where the only sur-
viving correlations are those between E1 and E2, used by
Eve in each single round-trip. These ancillary modes are
mixed with the forward and backward signals by means
of beam splitters. Note that we can rid of additional
modes e because we work in the asymptotic limit and
we bound Eve’s accessible information using the Holevo
function [39]. Finally, a further simpliﬁcation comes from
the extremality of Gaussian states [16], which means that
we can restrict Eve’s input ρE1E2 to be a Gaussian state.
The Gaussian attack is collective, when E1, E2 are
uncorrelated, or two-mode coherent when they are corre-
lated. Studying this second case with the circuit in ON
and in DR, Ref. [40] found that optimal two-mode attacks
exist which can reduce the security performances of the
two-way protocol below the one-way threshold. Here we
show that, using the scheme with the ON/OFF switch-
ing, and post-selecting the optimal key-rate accordingly
to the attack detected, the parties can overcome this
problem. The security analysis is performed according
to the setup shown in Fig. 2, where Fig. 2(a) refers to
collective attacks, while Fig. 2(b) refers to two-mode co-
herent attacks. In the latter case, the security analysis
is performed in the entanglement based (EB) representa-
tion [11, 16].

Description of the two-mode Gaussian attack in the EB

representation

In EB representation both Bob and Alice remotely pre-
pare coherent states on the travelling modes B′
1 and A′
2
by using two-mode squeezed vacuum states, described by

covariance matrices (CMs) of the following form

3

(1)

(2)

pµ2
pµ2

B − 1Z
µB I
A − 1Z
µAI

(cid:19) ,
(cid:19) ,

VB1B ′

VA2A′

1 =(cid:18)
2 =(cid:18)

µB I
B − 1Z
µAI
A − 1Z

pµ2
pµ2

on which they apply heterodyne detections on the respec-
tive local modes B1 and A2. The parameters µA = µ + 1,
and µB = µ+1 describe the variance of the thermal state
injected by Alice and Bob, respectively. The two travel-
ling modes, B′
2, are mixed with Eve’s modes, E1
and E2, on two identical beam splitters, with transmissiv-
ity T . Eve’s input state ρE1E2 is a zero mean, two-mode
correlated thermal state, with CM

1 and A′

VE1E2 =(cid:18) ωI G

G ωI(cid:19) , with G =(cid:18) g

g′(cid:19) ,

(3)

where ω ≥ 1 gives the variance of the thermal noise in-
jected, while g and g′ describe the correlations between
the two ancillas.

Note that the double use of the channel corresponds to
a sequential use of the same communication line (optical
ﬁbre), so it is reasonable to consider a symmetric channel
(T and ω are the same during the forward and backward
communication). The correlation parameters g and g′
must fulﬁll the following constraints

|g| < ω, |g′| < ω, ω2 + gg′ − 1 ≥ ω |g + g′| ,

(4)

in order to certify that VE1E2 is a bona ﬁde CM. If g′ = g,
we must have 1 − ω ≤ g ≤ ω − 1, with the two extremal
conditions corresponding to E1 and E2 sharing maximal
If g′ = −g the ancillas
separable correlations [42, 43].
share non-separable correlations. The Eq. (4) provides
the bound −√ω2 − 1 ≤ g ≤ √ω2 − 1, with the extremal

values corresponding to maximally entangled states. Fi-
nally, if g = g′ = 0, the two ancillas are not correlated,
and the two-mode attack collapses to a standard collec-
tive one, based on two independent entangling cloners.

Key-rates and security thresholds

We compute now the secret-key rate R := I−IE, where
I is Alice-Bob mutual information, and IE is Eve’s ac-
cessible information. In the asymptotic case N ≫ 1, IE
can be replaced by the Holevo information χ. Hence we
write

R := I − χ.

(5)

The goal of the security analysis is the computation of
the bound χ, which is deﬁned as

χ := SE − SE|x.

(6)

The functional SE is the von Neumann entropy, relative
to Eve’s quantum state ρE, and SE|x is that correspond-
ing to ρE|x, which describes Eve’s sate conditioned on the
outcomes of the measurements performed by the parties.

!"

Alice 

A
1

D(α)

QM 

B
1

T,ω

QM 

′ ′ E 

1

′ E 

1

E
1

E

2

′ E 

2

#"

QM 

Bob 

Alice 

A
1

′ E 

1

′ B 

1

Bob 
B
1

4

B = B

2 − TB

1

T,ω

E
1

E

2

A
2

′ ′ E 

2

T,ω

B
2

A
2

′ A 

2

′ E 

2

T,ω

B
2

QM 

QM 

FIG. 2: Panel (a) shows the two-way scheme in ON conﬁguration. This is used against collective Gaussian attacks, typically
implemented by means of two independent entangling cloners. Each beam-splitter has transmissivity T , and Eve mixes the
ancillas E ′
2 with the signals modes B1 and A2 Panel (b) describes the OFF conﬁguration, whose security is studied
against two-mode Gaussian attacks. In this case we study the security of the scheme in the entanglement based representation.

1 and E ′

Against collective attacks, the parties use the protocol

in ON, and we have the following ON key-rate
RON := ION (α : ˜β) − χON (ε : ˜β).

(7)

By contrast, against coherent attacks, they use the circuit
in OFF, for which we have the following OFF key-rate

ROF F = IOF F − χOF F ,

where

IOF F =

IOF F (α : β) + IOF F (α′ : β′)

2

(8)

(9)

Ref. [16]. From the knowledge of the CM describing the
total and conditional states, we can compute the von
Neumann entropies and ﬁnally the key rates. For the
protocol with coherent states and heterodyne detection
we ﬁnd the following key-rates

RON = log

ROF F = log

2T (1 + T )

e(1 − T )(1 + Λ)

2T

e(1 − T )(1 + ˜Λ)

+

3Xi=1
+Xj=±

h(¯νi) − 2h(ω), (12)
h(¯ν′

j) − h(νj)

,

2

(13)

is the mutual information averaged over the forward and
backward use, and

where

χOF F := SAB − SAB|α,β ′

(10)

is computed on Alice and Bob’s output state ρAB.

Thus, for collective attacks we select the ON key-rate
RON , while for coherent attacks we select the OFF key-
rate ROF F . Both these key-rates are function of chan-
nel parameters, i.e., transmissivity T and excess noise
N := (1 − T )(ω − 1)/T (which gives the extra noise on
the channel with respect the vacuum shot-noise). The
OFF key-rate, ROF F , is also function of the correlation
parameters g and g′. Therefore, once we have R, we ﬁnd
the security thresholds solving the following equation

R(T, N, g, g′) = 0.

(11)

This condition provides threshold curves of the type N =
N (T, g, g′) which simpliﬁes to N = N (T ) for collective
attacks.

h(x) :=

x + 1

2

log

x + 1

2 −

x − 1

2

log

x − 1

2

.

In the previous formulas, the symplectic eigenvalues
¯νi are computed numerically and we deﬁne Λ := T 2 +
(1 − T 2)ω and ˜Λ := T + (1 − T )ω.
It is of particular
interest the OFF key-rate of Eq. (13), from which we
notice that one can recover the one-way key-rate in the
case of collective attacks (g = g′ = 0). The expressions of
the total and conditional symplectic eigenvalues can be
computed analytically for large modulation, being equal
to

ν± →p(ω ± g)(ω ± g′),
± → p[λ± + 1 − T ][λ′
where λ± = T +(ω±g)(1−T ) and λ′

¯ν′

T

± + 1 − T )]

(14)

(15)

,

± = T +(ω±g′)(1−T ).

Formulas for the key-rates

detection

Protocol with coherent states and homodyne

The computation of the secret-key rates can be
performed using the mathematical tools described in

Here we give the key-rate ˜R for the two-way protocol
with coherent states and homodyne detection. The only

change with respect to the previous scheme is clearly the
use of homodyne detection for decoding. With the circuit
in ON, Bob prepares coherent states, randomly displaced
by Alice and ﬁnally homodyned by Bob. With the proto-
col in OFF, Bob prepares coherent states and Alice per-
forms homodyne detection. Then she sends back newly
prepared coherent states which are homodyned by Bob.
After some algebra, we obtain the following analytical
expressions for the key-rates

1.0

0.8

0.6

0.4

0.2

N

N

10.

1.

0.1

5

( a)

( b)

( c)

( d)

0.0

0.0

0.2

0.4

T

0.6

0.8

1.0

0.0

0.2

0.4

0.6

0.8

1.0

T

˜RON =

˜ROF F =

1
2

1
2

log

log

T 2 + ω + T 3(ω − 1)

(1 − T )Λ

+ h(˜ν) − h(ω),

4p(ω2 − g2)(ω2 − g′2)

(1 − T )˜Λ

−Xi=±

(16)

h(νi)

2

. (17)

In the ON key-rate of Eq. (16), used against collective
attacks, the asymptotic symplectic eigenvalue ˜ν can be
computed analytically as

˜ν :=s ω[1 + T 2ω(1 − T ) + T 3]

T 2 + ω + T 3(ω − 1)

.

By contrast, the OFF key-rate of Eq. (17) is exploited
under coherent attacks, and the total symplectic eigen-
values νi are the same as given in Eq. (14). The details
to obtain Eqs. (16) and (17) can be found in the sup-
plemental material, where we also include the secret-key
rates computed in DR.

Discussion

The security analysis of the thresholds coming from
Eqs. (12) and (13) is summarized in Fig. 3. In partic-
ular, the security threshold for the ON conﬁguration is
conﬁrmed [14] to be superadditive in Fig. 3(top-left). The
black-solid line corresponds to the ON threshold, which
is clearly above the threshold of the one-way protocol
(dashed line). This comparison is done against collec-
tive attacks. The top-right panel of Fig. 3, shows the
security threshold for the OFF conﬁguration in the pres-
ence of several two-mode attacks with diﬀerent values of
the correlation parameters g = g′. The curves labeled
(a)-(d) corresponds to the points in Fig. 3 (bottom-left).
For example, the red curve (a) describes coherent attacks
performed with maximally entangled states. The curve
(b) describes attacks with g′ = g = ±(ω − 1), and the
curve (c) corresponds to g′ = −g = ±(ω − 1). Finally,
the dashed curve (d) corresponds to the center of the cor-
relation plane, where the OFF threshold coincides with
the one-way threshold. Thus, we see that for any value
of Eve’s correlation parameters, g and g′, Alice and Bob
can always post-select an instance of the two-way proto-
col (ON or OFF) whose threshold is strictly greater than
that of the corresponding one-way protocol.

g'

0.4

0.2

0.0

-0.2

-0.4

0.4

0.3

0.4

0.2
0.15

0.2

0.2

0.1

0.1

0.1

( b)

( c)

( d)

-0.4 -0.2

0.0
g

( a)

0.2

0.4

g'

0.0

-0.2

-0.4

0.05

0.05

-0.4 -0.2

0.0
g

0.2

0.3

0.4

0.2
0.4

0.1

0.15

0.2

FIG. 3: This ﬁgure summarizes the results for the protocol
with coherent states and heterodyne detection, whose rates
are given in Eqs. (12) and (13). The top panels describe the
security thresholds, in terms of tolerable excess noise N versus
transmissivity T . In the top-left panel, we consider collective
attacks and we compare the ON two-way threshold RON = 0
(black solid line) with the threshold of the one-way protocol
(dashed line).
In the pink region the two-way protocol is
secure, while the one-way counterpart is not.
In the top-
right panel, we consider coherent attacks and we compare the
OFF two-way threshold (a)-(c) with respect to the one-way
threshold (d).
In particular, curve (a) is obtained for g =

±√ω2 − 1, i.e., Eve using maximally entangled states; curve
(b) considers the case g ′ = g with g = ±(ω − 1); and curve
(c) refers to g ′ = −g and g = ±(ω − 1). Note that curve (d)
coincides with the OFF threshold against collective attacks, in
which case the protocol is used in ON. The same labels (a)-(d)
are used in the bottom-left panel, which describes the various
attacks on the correlation plane (g, g ′), obtained setting ω ≃
1.097 in the constraint of Eq. (4). Finally, in the bottom-right
panel, we plot the OFF key-rate against coherent attacks (red
lines), compared to the quantum mutual information (black
lines) describing the correlations of Eve’s ancillas. We set
T = 0.3 and ω ≃ 1.097, so that the one-way rate is ≃ zero.
We see that the OFF key-rate is always strictly positive and
it increases for increasing correlations in the attack.

Finally, Fig. 3 (bottom-right) describes the connection
between the OFF key rate and the amount of correlations
in Eve’s ancillas, as quantiﬁed by the quantum mutual
information. We can see that the OFF key rate not only
is positive (while the one-way rate is always zero) but
it also increases with Eve’s correlations, which are con-
verted into noise by the OFF conﬁguration. Thus, the
ON/OFF switching, together with the post-selection of
the correct instances, allows one to implement two-way
CV-QKD in a way which is not only secure, but also more
robust to excess noise with respect to one-way protocols

under completely general attacks.

Methods

A detailed description of the methods can be found in
the supplementary material. The security analysis of the
protocol has been performed in the entanglement based
representation for the case OFF, so that we could com-
pute the Holevo bound from the study of Alice-Bob CM.
For the case ON in RR, we started from the output co-
variance matrix of Eve, to compute the total von Neu-
mann entropy. We then computed the conditional von
Neumann entropy completing Eve’s covariance matrix
with the Bob’s mode on which we applied the hetero-
dyne or the homodyne measurement, accordingly with
the case studied.

6

a complete study for direct point-to-point two-way pro-
tocols. Our security analysis is obtained assuming the
asymptotic limit, i.e., large number of signals exchanged
and large modulation. This allowed us to ﬁnd closed for-
mulas for the secret-key rates, from which we have proved
that the two-way Gaussian protocols are more robust to
excess noise than their one-way counterparts in both col-
lective and coherent attacks.

For this property, it is crucial the random ON/OFF
switching of the protocol, so that the eavesdropper’s cor-
relations are under control of the parties and they are
transformed, if needed, into useless noise. Our analysis
contributes to the general understanding of the security
properties of two-way protocols and is useful to extend
CV-QKD to regime with high excess noise. Future devel-
opments could involve the study of this ON/OFF switch-
ing strategy in more complex quantum communication
scenarios.

Conclusions

Acknowledgments

In this work we have studied the security of two-way
CV-QKD addressing, explicitly, the superadditivity of its
security threshold against coherent attack. To the best
of our knowledge this represents the ﬁrst attempt of such

We acknowledge ﬁnancial support from the EPSRC
via the ‘UK Quantum Communications HUB’ (Grant no.
EP/M013472/1).

[1] Bennet, C.H. & Brassard G. Quantum cryptography: pub-
lic key distribution and coin tossing, Proceedings of the
IEEE International Conference on Computers, Systems,
and Signal Processing, Bangalore, p. 175 (1984)

[2] Scarani, V., et al. The security of practical quantum key

distribution, Rev. Mod. Phys. 81, 1301 (2009).

[3] Shor, P.W. Polynomial-time algorithms for prime fac-
torization and discrete logarithms on a quantum com-
puter, SIAM J. Sci. Statist. Comput. 26, 1484, (1997),
quant-ph/9508027

[4] Rivest, R., Shamir, A., Adleman,L. A method for obtain-
ing digital signatures and public-key cryptosystems, Com-
munications of the ACM 21 (2): 120–126, (1978)

[5] Gisin N. et al. Quantum cryptography, Rev. Mod. Phys.

74, 145–195 (2002).

[6] Wootters, W. & Zurek, W. A single quantum cannot be

cloned, Nature 299: 802–803, (1982).

[7] Korzh, B. et al. Provably secure and practical quantum
key distribution over 307 km of optical ﬁbre, Nature Phot.
9, 163–168, (2015).

[8] Ursin, R.et al. Entanglement-based quantum communica-

tion over 144 km, Nature Phys, 3, 481 - 486 (2007).

[9] Grosshans, F. & Grangier, P. Continuous variable quan-
tum cryptography using coherent states, Phys. Rev. Lett.
88, 057902 (2002).

[10] Weedbrook, C., et al. Quantum cryptography without

switching, Phys.Rev.Lett. 93 (17), 170504 (2004).

[11] Grosshans, F., et al. Virtual entanglement and reconcilia-
tion protocols for quantum cryptography with continuous
variables, Quantum Information & computation (2003).

[12] Garcia-Patron, R., Cerf, N.J., Continuous-variable quan-
tum key distribution protocols over noisy channels, Phys.

Rev. Lett. 102, 130501 (2009)

[13] Grosshans, F. et al. High-rate quantum cryptography
using Gaussian-modulated coherent states, Nature 421,
238–241 (2003).

[14] Pirandola, S. et al. Continuous variable quantum cryp-
tography using two-way quantum communication, Nature
Phys., 4, 726, (2008).

[15] Diamanti, E., & Leverrier, E. Distributing secret keys
with quantum continuous variables: principle, security
and implementations, Entropy, 17, 6072, (2015).

[16] Weedbrook, C., et al. Gaussian quantum information,

Rev. Mod. Phys., 84, 621, (2012).

[17] Jouguet, P., et al. Experimental demonstration of long-
distance continuous-variable quantum key distribution,
Nature Photonics 7, 378–381 (2013).

[18] Silberhorn, C. et al. Continuous variable quantum cryp-
tography: beating the 3 dB Loss Limit, Phys. Rev. Lett.
89, 167901 (2002).

[19] Leverrier, A., et al. Multidimensional reconciliation for a
continuous-variable quantum key distribution, Phys. Rev.
A, 77, 042325, (2008).

[20] Braunstein, S.L. & van Lock, P. Quantum information
with continuous variables, Rev.Mod.Phys. 77, 513, (2005).
[21] Weedbrook, C., et al. Quantum cryptography approach-
limit, Phys. Rev. Lett. 105, 110501

ing the classical
(2010).

[22] Weedbrook, C., et al. Continuous-variable quantum key
distribution using thermal states, Phys. Rev. A 86, 022318
(2012).

[23] Pirandola, S. et al. Reply to ‘Discrete and continuous
variables for measurement-device-independent quantum
cryptography’, Nature Phot. 9, 773, (2015).

[24] Ekert, A., Quantum cryptography based on the Bell’s

theorem, Phys. Rev. Lett. 69, 1293, (1992).

Supplemental Material for “General immunity and

superadditivity of two-way Gaussian quantum

7

[25] Gisin N. et al. Proposal

implementing device-
independent quantum key distribution based on a heralded
qubit ampliﬁer, Phys. Rev. Lett. 105, 070501 (2010).

for

[26] Vazirani, U. & Vidick, T. Fully device-independent quan-
tum key distribution, Phys. Rev. Lett.113, 140501 (2014).
[27] Colbeck, R., Victory for the quantum code maker?,

Physics 7 , 99 (2014).

[28] Hensen, B., et al. Experimental loophole-free violation of
a Bell inequality using entangled electron spins separated
by 1.3 km, arXiv 1508.05949, (2015).

[29] Braunstein, S.L. & S. Pirandola, Side-channel-free quan-
tum key distribution, Phys. Rev. Lett. 108, 130502 (2012).
[30] Lo, H.-K., Curty, M. & Qi, B. Measurement-device-
independent quantumkey distribution, Phys. Rev. Lett.
108, 130503 (2012).

[31] Pirandola, S. et al. High-rate measurement-device-
independent quantum cryptography, Nature. Phot. 9, 396
(2015). See also arXiv.1312.4104 (2013).

[32] Ottaviani, C., Spedalieri G., Braunstein S.L. & Piran-
dola S. Continuous-variable quantum cryptography with
an untrusted relay: Detailed security analysis of the sym-
metric conﬁguration,Phys. Rev. A 91, 022320 (2015).

[33] Pirandola, S. Quantum discord as a resource for quantum

cryptography, Sci. Rep. 4, 6956 (2014).

[34] Weedbrook, C., Ottaviani, C. & Pirandola, S. Two-way
quantum cryptography at diﬀerent wavelengths, Phys.
Rev. A, 89, 012309, (2014).

[35] Bostr¨om, K., Felbinger, T. Deterministic secure direct
communication using entanglement, Phys. Rev. Lett. 89,
187902, (2002).

[36] Lucamarini, M., & Mancini S. secure deterministic com-
munication without entanglement, Phys. Rev. Lett. 94,
140501 (2005).

[37] Shapiro, J.H., Defeating passive eavesdropping with

quantum illumination, Phys. Rev. A 80, 022320 (2009).

[38] Zhang, Z., et al. Entanglement’s beneﬁt survives an
entanglement-breaking channel, Phys. Rev. Lett. 111,
010501 (2013).

[39] Pirandola, S., Braunstein, S.L. and Lloyd, S., Charac-
terization of collective gaussian attacks and security of
coherent-state quantum cryptography, Phys. Rev. Lett.
101, 200504, (2008).

[40] Ottaviani, C., Mancini S. and Pirandola, S. Two-way
Gaussian quantum cryptography against coherent attacks
in direct reconciliation, Phys. Rev. A, 92, 062323, (2015).
[41] Renner, R. & Cirac, J.I. de Finetti representation theo-
rem for inﬁnite-dimensional quantum systems and appli-
cations to quantum cryptography, Phys. Rev. Lett. 102,
110504 (2009).

[42] Pirandola, S. Entanglement reactivation in separable en-

vironments, New J. Phys. 15, 113046, (2013).

[43] Pirandola, S., Seraﬁni, A., Lloyd, S., Correlation matri-
ces of two-mode bosonic systems, Phys. Rev. A 79, 052327
(2009).

cryptography”

This supplemental material gives the details of the cal-
culations for the security analysis of the protocols de-
scribed in this work, and includes also the key-rates cal-
culated for two-way protocol used in direct reconciliation
(DR), which has not been discussed in the main body.
We underline that compared to the one-way protocol, the
two-way presents a richer number of cases which need to
be analyzed. The protocols are named with respect to
the preparation and detection scheme adopted. Here we
discuss the protocol with coherent states and heterodyne
detection, and with coherent states and homodyne detec-
tion. Each one of previous cases can be implemented in
DR as well as reverse reconciliation (RR), and here we
give the results for both reconciliation schemes.

Secret-Key Rate and symplectic analysis

The secret-key rate quantiﬁes the gap between Al-
ice and Bob’s mutual information and the information
shared between Eve and the parties. Which parties’ vari-
able(s) has(have) to be considered depends on the setup
of the protocol (one-way, two-way, ON or OFF) and, in
general, from the reconciliation protocol employed.

For instance consider the one-way protocol. We as-
sume that Alice sends a modulated coherent state with
amplitude α to Bob, who receives a noisy version of this
state, whose amplitude is β. The parties can then obtain
two distinct secret-key rates deﬁned as follows

R◮ := I(α : β) − χ(ε : α),
R◭ := I(α : β) − χ(ε : β).

(S1)

(S2)

The ﬁrst describes the key-rate in DR, while the second
the RR. The function I is the classical mutual informa-
tion quantifying correlations between Alice’s variable, α,
and Bob’s variable, β. For each quadrature measured,
and used to encode information, the mutual information
is given by the following general signal-to-noise ratio

I =

1
2

log

V
VC

,

(S3)

where V is the variance of the variable used to prepare the
key, and VC the conditioned variance of this statistical
variable after the measurement performed by the parties.
In the asymptotic limit of many uses of the quantum
channel we can bound Eve’s accessible information by
the Holevo function, which is given by

χ(ε : x) := S(ε) − S(ε|x).

(S4)

The function S(.) describes the von Neumann entropy
which, for Gaussian quantum systems, has a simple form

given by

Case ON

8

S =Xk

h(νk),

(S5)

with the entropic function h(.) is deﬁned as follows

h(νk) :=

νk + 1

2

log

νk + 1

2 −

νk − 1

2

log

νk − 1

2

,

(S6)

and where the νk’s are the symplectic eigenvalues of the
CM which describes the dynamics of the studied Gaus-
sian quantum system [S1].

The expression of the von Neumann entropy of Eq. (S6)
can be further simpliﬁed exploiting the limit of large sig-
nal modulation, in which case we can write [S1]

h(νk) = log

e
2

νk(cid:19) .
νk + O(cid:18) 1

(S7)

The computation of the symplectic spectra can be done in
prepare and measure conﬁguration, in which case the νk’s
are obtained from the symplectic analysis of Eve’s output
CM or, in case we use the equivalent EB representation,
from Alice-Bob’s CM. This second approach is used in the
following, to study the OFF conﬁgurations, i.e., when we
consider coherent attacks.

To compute the symplectic spectrum, we ﬁrst compute

the appropriate CM V and then, from matrix

Bob sends modulated coherent states to Alice provid-
ing, on average, a thermal state with variance µB = µ+1,
where µ accounts for the classical Gaussian modulation
on the top of the vacuum shot-noise. Alice applies an
additional random displacement, D(α), on the states re-
ceived from Bob with modulation variance µON = µ ≥ 0.
information
can be computed from the expression of the variance of
post-processed mode hB2i, given by

information Alice-Bob mutual

Mutual

hB2i = [T 2 + T µON + (1 − T 2)ω]I,

(S8)

from which, in the limit of large modulation µON = µ →
∞, we obtain the signal variance
V = T µ.

(S9)

We then compute the conditional variance from Eq. (S8)
by setting Alice modulation µON = 0, obtaining

VC = T 2 + (1 − T 2)ω.

(S10)

Finally, using Eqs. (S9) and (S10) with the expression of
the mutual information in case of heterodyne detection

I := log

V + 1
VC + 1

,

(S11)

M = iΩV,

we obtain the following Alice-Bob mutual information in
the limit of large modulation

where Ω = ⊕n
form given by

i=1

˜ωi, with ˜ωi the single-mode symplectic

−1 0(cid:19) ,
˜ωi =(cid:18) 0 1

we compute the ordinary eigenvalues, which come in
pairs. The symplectic spectrum is obtained taking their
absolute value.

Protocol with coherent states and heterodyne

detection

where

1 , E2, E′′

We start showing how we obtain the ON key-rate for
the protocol with coherent states and heterodyne detec-
tion, which is described in Fig. 2 (a) of the main text. The
security analysis is performed using Eve’s CM, obtained
from the outputs {E1, E′′
2}. From this we obtain
the total von Neumann entropy and, by simple condition-
ing procedure, one can also compute Eve’s conditional
CM. This describes the conditional state ρE1,E ′′
2 |α,
for the protocol in DR. By contrast, to study the pro-
tocol in RR, we complete Eve’s output CM with Bob’s
post-processed output mode B, on which we apply the
heterodyne detection in order to obtain the conditional
CM for this case.

1 ,E2,E ′′

ION = log

T µ

1 + T 2 + (1 − T 2)ω

.

(S12)

Total Covariance Matrix We compute now the CM
2 . We arrange

of Eve’s output quantum state ρE ′
it in the following normal form

1,E ′′

2,E ′′

1 ,E ′

VE =(cid:18) A C
CT B(cid:19) ,
pT (ω2 − 1)Z
pT (ω2 − 1)Z

˜ΨI

ΨI

ωI

A: =(cid:18)
pT (ω2 − 1)Z
B: =(cid:18)
pT (ω2 − 1)Z
0 ΦZ(cid:19) ,
C: =(cid:18) 0 ΞZ

ωI

(S13)

(S14)

(cid:19) ,
(cid:19) ,

with
˜Ψ = [T ω + (1 − T )2ω + T (1 − T )µB] + (1 − T )µON ,
Ψ = T (ω − µB) + µB,
Φ = (1 − T )√T (µB − ω),
Ξ = −(1 − T )p(ω2 − 1).

(S15)

9

From Eq. (S13) we easily obtain the total symplectic
spectrum by taking the limits for µON = µ → ∞ and
µb = µ + 1 → ∞

{ν1, ν2, ν3ν4} → {ω, ω, (1 − T )2µ2}.

(S16)

The latter, used with Eqs. (S5) and (S7), gives the total
von Neumann entropy

SE = log

e2
4

(1 − T )2µ2 + 2h(ω).

(S17)

Conditional CM and Key-rate in Direct Reconcilia-
tion For the DR the conditional CM can be obtained
straightforwardly from Eq. (S13) setting µON = 0 on
both quadratures in the block describing Eve’s output
2 , i.e., ˜Ψ in Eq. (S15). The resulting conditional CM
E′′
has the following asymptotic symplectic spectrum

We then apply the formula for heterodyne detection [S1]
obtaining the following conditional CM

V◭

C = VE + ¯C( ¯B + I)

−1 ¯CT ,

(S22)

which gives the following conditional symplectic spec-
trum

{¯ν1, ¯ν2, ¯ν3, ¯ν4} → {¯ν1, ¯ν2, ¯ν3, (1 − T 2)µ}.

(S23)

Notice that the eigenvalues ¯ν1, ¯ν2, ¯ν3 are asymptotically
depending only on the channel parameters (ω, T ), and
are related by the following expression

¯ν1 ¯ν2 ¯ν3 =

[1 + T 3 + (1 − T )(1 + T 2)ω]ω

T (1 + T )

.

{¯ν1, ¯ν2, ¯ν3, ¯ν4} → {1, 1, ω, (1 − T 2)µ}.

(S18)

From the eigenvalues of Eq. (S23), used with Eqs. (S4),
(S5) and (S7) we obtain the Holevo bound for the RR

Using Eq. (S18) with Eq. (S5) and (S7), we compute the
conditional von Neumann entropy

SE|α = log

e
2

(1 − T 2)µ + h(ω).

(S19)

Now, using Eqs. (S17) and (S19) in Eq. (S4), one obtains
the expression of the Holevo bound

χ◭

ON = log

e
2

(1 − T 2)µ + h(¯ν1) + h(¯ν2) + h(¯ν3),

which, used with Eq. (S12) in the deﬁnition of Eq. (7) in
the main text, gives the secret-key rate for the protocol
used in RR given in Eq. (12) of the main text.

χ◮

ON = log

e
2

(1 − T )
(1 + T )

µ.

(S20)

Case OFF

Finally, by subtracting the Holevo function of Eq. (S20)
from the mutual information of Eq. (S12) we get the ON
key-rate in DR

R◮

ON = log

2
e

T (1 + T )

(1 − T )[1 + T 2 + (1 − T 2)ω] − h(ω).

Reverse Reconciliation To study the security of the
protocol in RR, we need to re-compute the conditional
von Neumann entropy for this case. We complete the
CM of Eq. (S13) adding the blocks describing Bob’s out-
put mode B and its correlations with the rest of Eve’s
modes. Then we apply a heterodyne detection on B ob-
tain Eve’s conditional CM after Bob’s measurements. We
then write

V◭ =(cid:18) VE

¯CT ¯B(cid:19) ,

¯C

where

¯B=[T 2 + T µ + (1 − T 2)ω]I,
pT (ω2 − 1)Z
p(ω2 − 1)Z
√T [T (ω − 1) − µ]I

¯C=√1 − T

T (ω − 1)I

(S21)

 .

We now describe the details of the calculations for the
protocol used in OFF, as described in Fig. 2-(b) of the
main text.
In this case we perform the security anal-
ysis considering two-mode coherent attacks, in the EB
representation.

Total Covariance Matrix and von Neumann entropy

Bob starts from a two-mode squeezed vacuum state,
described by the CM of Eq. (1) in the main text. Apply-
ing a local heterodyne detection on mode B1, he projects
the traveling mode B′
1 in a coherent state. In the same
way, Alice applies a local heterodyne detection on mode
A2, projecting the traveling mode A′
2 in a coherent state.
Finally, we assume that Eve injects the general Gaussian
state described by Eq. (3) in the main text. Since the
total state of Alice, Bob and Eve is pure, we can reduce
ourselves to compute Alice and Bob’s state (having the
same entropy of Eve’s). We then order Alice’s and Bob’s
the output modes as follows {B1, A2, A1, B2}, and obtain
the following expression

VOF F

˜CT ˜B(cid:19) ,
AB =(cid:18) ˜A ˜C

(S24)

where the matrix blocks have been deﬁned as follows,

˜δI

˜τ (µB)I ,

˜δI

µAI

µB I

˜B = ˜τ (µA)I,
0
˜δI

˜A=
˜C =
(1 − T )G ,
g′(cid:19) ,
G :=(cid:18) g

where

the coeﬃcientseδ and ˜τ (y) have been deﬁned as follows,

˜δ :=pT [µB

2 − 1],
˜τ (y) := (1 − T )ω + T y.

(S25)

We compute the symplectic spectrum of CM (S24) and
taking the asymptotic limit, µA = µB → ∞, we obtain
the following analytical expressions

{ν±, ν3, ν4} → {p(ω ± g)(ω ± g′), (1 − T )µ, (1 − T )µ},

(S26)
which gives the total von Neumann entropy for the case
OFF

SAB = log(cid:16) e
2(cid:17)2

(1 − T )2µ2 + h(ν−) + h(ν+).

(S27)

Conditional covariance matrix and Alice-Bob mutual

information

To obtain the conditional CM in DR we set µA = µB =
It is easy to verify that the

1, in modes B1 and A2.
resulting CM has the following symplectic spectrum

+,qλ−λ′
{¯ν1, ¯ν2, ¯ν+, ¯ν−} → {1, 1,qλ+λ′
± = T +(ω±g′)(1−
where, λ± = T +(ω±g)(1−T ) and λ′
T ). Using these eigenvalues, we compute the following
conditional von Neumann entropy

−},

(S28)

SAB|α′,β = h(¯ν+) + h(¯ν−).

The previous equation and Eq. (S27) are then used to
obtain the asymptotic expression of the Holevo function
in DR, which is given by

χ◮

OF F :=

SAB − SAB|α,β ′

2

= log

e
2

(1 − T )µ +

.

1

2 Xk=±

(S29)

[h(νk) − h(¯νk)] . (S30)

10

mode B2 and then we apply another heterodyne detec-
tion on mode A2 (the order of these two local measure-
ments is of course irrelevant). The resulting conditional
CM has the symplectic spectrum

± → p[λ± + 1 − T ][λ′

T

¯ν′

± + 1 − T )]

.

These are used to compute the Holevo bound which is
given by

χ◭

OF F = log

e
2

(1 − T )µ +

1

2 Xk=±

[h(νk) − h(¯ν′
k).

(S31)

Alice-Bob Mutual Information and Secret-key rate.

Alice-Bob mutual information is easily computed from
the coeﬃcient ˜τ , given in Eq. (S25). Taking the limit of
large modulation, using the formula deﬁning the mutual
information for heterodyne detections (S11), and averag-
ing over the double use of the quantum channel we obtain
the following expression

IOF F = log

T µ
1 + ˜Λ

,

(S32)

where ˜Λ = T + (1 − T )ω. Notice that, diﬀerently from
the Holevo bound, the mutual information is independent
from the correlation parameters described by the matrix
G.

Using Eq. (S30) and Eq. (S32), and after some simple
algebra, we get the analytical expression of the key-rate
in DR

2T

R◮

OF F = log

e(1 − T )(1 + ˜Λ)

[h(¯νk) − h(νk)],
(S33)
The key-rate in RR of Eq. (13) in the main text, is ob-
tained using previous Eq. (S31) and Eq. (S32).

+

1

2Xk=±

Protocol with coherent states and homodyne

detection

In contrast to the protocol analysed in previous sec-
tion, here the decodings are performed by means of ho-
modyne detections. This modiﬁes the expression of the
mutual information and these of the conditional von Neu-
mann entropies.

Case ON

The conditional CM corresponding to the RR, is ob-
tained by applying two consecutive heterodyne detec-
tions, starting from CM of Eq. (S24). We ﬁrst measure

Direct Reconciliation: conditional covariance matrix
The conditional CM in DR is obtained as before. We
start from the total CM of Eq. (S13) and we apply the

1.0

0.8

0.6

0.4

0.2

N

N

10.

1.

0.1

( a)

( b)

( c)

( d)

0.0

0.0

0.2

0.4

T

0.6

0.8

1.0

0.0

0.2

0.4

0.6

0.8

1.0

T

g'

0.3

0.2

0.1

0.0

-0.1

-0.2

-0.3

( d)

( b)

( c)

g'

0.25

0.2

0.1
0.08

0.06

1„
5

0.1

0.04

0.05

0.02

0.05

0.1

0.3

0.2

0.1

0.0

-0.1

-0.2

-0.3

-0.3 -0.2 -0.1 0.0
g

0.1

0.2

( a)
0.3

-0.3 -0.2 -0.1 0.0
g

0.04

0.06

0.15
0.2

0.08

0.1

0.1

0.2

0.3

Figure S1: This ﬁgure summarize the results for the pro-
tocol with coherent states and homodyne detection, whose
rates are given in Eqs. (S39) and (S42) which are the same
of Eqs. (16) and (17) in the main text. The top panels give
the security thresholds in terms of tollerable excess noise N
versus transmissivity T .
In the top-left panel, we consider
collective attacks and we compare the ON two-way threshold
˜RON = 0 (black solid line) with the threshold of the one-way
protocol (dashed line). In the pink region the two-way pro-
tocol is secure, while the one-way counterpart is not. In the
top-right panel, we consider coherent attacks and we compare
the OFF two-way threshold (a)-(c) with respect to the one-
way threshold (d).
In particular, curve (a) is obtained for

g = ±√ω2 − 1, i.e., Eve using maximally entangled states;
curve (b) considers the case g ′ = g with g = ±(ω − 1); and
curve (c) refers to g ′ = −g and g = ±(ω − 1). Note that
curve (d) coincides with the OFF threshold against collective
attacks, in which case the protocol is used in ON. The same la-
bels (a)-(d) are used in the bottom-left panel, which describes
the various attacks on the correlation plane (g, g ′), obtained
setting ω ≃ 1.049 in the constraint of Eq. (4) in the main
text. Finally, in the bottom-right panel, we plot the OFF
key-rate against coherent attacks (red lines), compared to the
quantum mutual information (black lines) describing the cor-
relations of Eve’s ancillas. We set T = 0.2 and ω ≃ 1.049, so
that the one-way rate is ≃ zero. We see that the OFF key-
rate is always strictly positive and it increases for increasing
correlations in the attack.

following conditioning procedure

¯µq
ON = 1/µ
¯µp
ON = µ,

µ→∞

→ 0,

(S34)

which describes Alice’s eﬀective modulation in order to
describe the measurement of only one quadrature during
the decoding stage (homodyne detection).

Direct Reconciliation: mutual

information, Holevo
bound and key-rate The conditioning procedure, de-

11

scribed by Eqs. (S34), can clearly also used to determine
Alice-Bob mutual information. In the present case only
one-quadrature is used to encode the key so Alice-Bob
mutual information is given by the following expression

˜ION =

1
2

log

T µ

T 2 + (1 − T 2)ω

.

(S35)

Eve’s conditional CM is obtained from Eq. (S13) ap-
plying recipe of Eqs. (S34). One easily obtains the con-
ditional symplectic spectrum which, in the asymptotic
limit, is given by

1 , ν◮

2 , ν◮

{ν◮

4 } → {1, ω,p(1 − T )2(1 − T 2)ωµ3}.

(S36)
After some algebra we obtain the following Holevo bound

3 ν◮

˜χ◮

ON =

1
2

log

(1 − T )2µ
(1 − T 2)ω

+ h(ω),

which, used with Eq. (S35), provides the ON key-rate for
the protocol in DR

˜R◮

ON =

1
2

log

T (1 + T )ω

(1 − T )[T 2 + (1 − T 2)ω] − h(ω).

(S37)

It is interesting to note that plotting the security thresh-
old of the key-rate of Eq. (S37), one ﬁnds that it provides
a positive key-rate even below 3 dB, which sets the limit
performance of the one-way version of this protocol in
DR.

Reverse Reconciliation: conditional covariance matrix
The security of the protocol is performed repeating the
steps described in previous sections, replacing the het-
erodyne detections with homodyne measurements on B.
Indeed, we apply the following formula
C = A − C(Π ¯BΠ)CT ,
˜V◭

to Eq. (S21). Note that Π :=diag(1, 0) (diag(0, 1)) for
heterodyne on quadrature ˆq (ˆp). We then compute the
symplectic spectrum of CM ˜V◭
C , which we rewrite here
in the following form

T 2 + ω + T 3(ω − 1)

˜ν →s ω[1 + T 2ω − T 3(ω − 1)]
4 →r (1 − T )3[T 2 + ω + T 3(ω − 1)]µ3

ν◭
2 → ω,

T

,

ν◭
3 ν◭

(S38)

.

We then obtain the Holevo bound ˜χ◭

ON

˜χ◭
ON = h(ω) − h(˜ν) +

1
2

log

T (1 − T )µ

,

T 2 + ω + T 3(ω − 1)

which combined with the mutual information of Eq. (S35)
gives the ON key-rate in RR of Eq. (16) of the main text,
i.e.,

˜R◭

ON =

1
2

log

T 2 + ω + T 3(ω − 1)

(1 − T )Λ

+ h (˜ν) − h(ω),

(S39)

with Λ := T 2 + (1 − T 2)ω.

Case OFF

and the key-rate in direct reconciliation is given by

12

This case is studied in the EB representation, following
the same steps of the previous OFF case, for both the DR
and RR, replacing the ﬁnal heterodyne with homodyne
detections. The mutual information is computed aver-
aging over the double use of the quantum channel, i.e.,
using the following deﬁnition of the mutual information

˜IOF F :=

1

2 1
2 Xi=A,B

µi=µ→∞

=

log

1
2

T µi

(1 − T )ω + T µi

(S40)

log

T µ
˜Λ

,

where ˜Λ := T + (1 − T )ω.

Direct Reconciliation

The steps to compute the conditional CM have been
discussed previously, so here we just provide the analyt-
ical expressions of the conditional symplectic spectra

˜ν◮

± =p(1 − T )Γ±µ,
± =s (ω ± g′)[T + (ω ± g)(1 − T )]

Γ±

˜η◮

,

where we deﬁne

Γ± := 1 − T + T (ω ± g′).

Notice that, in previous spectra, the role of the corre-
lation parameters depends on the quadrature measured
by the homodyne detection of the decoding stage. We
obtain the following Holevo bound for the DR

˜χ◮

OF F =

1
2

log

(1 − T )µ

p[1 + t(ω − 1)]2 − T 2g2

,

[1] Weedbrook, C., et al. Gaussian quantum information,

Rev. Mod. Phys. 84, 621 (2012).

Tp[1 + T (ω − 1)]2 − T 2g2

(1 − T )[T + (1 − T )ω]
k ) − h (νk)

,

h(˜η◮

2

˜R◮

OF F =

1
2

log

−Xk=±

where the eigenvalues ν± are deﬁned in Eq. (S26).

Reverse Reconciliation

For the RR, when the homodyne detection is per-
formed on the quadrature ˆq, we obtain the following con-
ditional symplectic eigenvalues

± =r (1 − T )(ω ± g)µ

˜ν◭

(S41)
By contrast, in case of homodyne detection on ˆp, the cor-
responding eigenvalues can be obtained from Eq. (S41)
by exchanging g ←→ g′. Averaging over the two detec-
tions, we ﬁnd the following Holevo bound

T

.

˜χ◭

OF F = Xk=±

h(νk)

2

+

1
2

log

T (1 − T )µ

4p(ω2 − g′2)(ω2 − g2)

,

which subtracted to the mutual information of Eq. (S40)
gives the key-rate of Eq. (17) of the main text, i.e.,

˜R◭

OF F =

1
2

log

4p(ω2 − g2)(ω2 − g′2)

(1 − T )˜Λ

−Xk=±

h(νk)

2

.

(S42)

