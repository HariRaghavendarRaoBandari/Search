6
1
0
2

 
r
p
A
4

 

 
 
]
T
R
h
t
a
m

.

[
 
 

2
v
6
9
7
5
0

.

3
0
6
1
:
v
i
X
r
a

FRENKEL-GROSS’ IRREGULAR CONNECTION AND

HEINLOTH-NG ˆO-YUN’S ARE THE SAME

XINWEN ZHU

Abstract. We show that the irregular connection on Gm constructed by Frenkel-
Gross ([FGr]) and the one constructed by Heinloth-Ngˆo-Yun ([HNY]) are the
same, which conﬁrms Conjecture 2.16 of [HNY].

Contents

Introduction

§ 1. Kac-Moody chiral algebras
§ 2. Hecke eigensheaves
§ 3. Some geometry of the local Hitchin map
§ 4. Endomorphisms of some vacuum modules
§ 5. Proof of a conjecture in [HNY]

References

Introduction

We show that the irregular connection on Gm constructed by Frenkel-Gross ([FGr])
and the one constructed by Heinloth-Ngˆo-Yun ([HNY]) are the same, which conﬁrms
Conjecture 2.16 of [HNY].

The proof is simple, modulo the big machinery of quantization of Hitchin’s in-
tegrable systems as developed by Beilinson-Drinfeld ([BD2]). The key idea is as
follows:
instead of directly showing that the two connections constructed in [FGr]
and [HNY] are isomorphic, we go the opposite direction by showing that their corre-
sponding automorphic sheaves under the Langlands correspondence are isomorphic.
More precisely, Let E be the irregular connection on Gm as constructed by Frenkel-
Gross. It admits a natural oper form. We apply (a variant of) Beilinson-Drinfeld’s
machinery to produce an automorphic D-module on the corresponding moduli space
of G-bundles, with E its Hecke eigenvalue. We show that this automorphic D-module
is equivariant with respect to the unipotent group I(1)/I(2) (see [HNY] or below
for the notation) against a non-degenerate additive character Ψ. By the uniqueness
of such D-modules on the moduli space, the automorphic D-module constructed
using Beilinson-Drinfeld’s machinery is the same as the automorphic D-module ex-
plicitly constructed by Heinloth-Ngˆo-Yun. Since the irregular connection on Gm
constructed in [HNY] is by deﬁnition the Hecke-eigenvalue of this automorphic D-
module, it must be the same as E. We emphasize here that the simple nature of
the proof is due to the existence of the “Galois-to-automorphic” direction for the
Langlands correspondence over C. Similarly, the existence of such direction over
ﬁnite ﬁelds (which remains conjectural) would imply the unicity of the Kloosterman
sheaves as conjectured in [HNY].

1

2

XINWEN ZHU

Let us brief describe the main new ingredients needed in the proof of the conjec-
ture. Let X be a smooth projective curve over C and let G be a smooth aﬃne group
scheme over X. Let BunG denote the moduli stack of G-torsors on X. Assume that
there is some dense open subset U ⊂ X such that G|U = G × U for some reductive
group G over C. Then there is the usual Hitchin map

hcl : T ∗BunG → Hitch(U ),

where Hitch(U ) is the Hitchin base for U (which is not ﬁnite dimensional if U is
aﬃne, see (2.4)). The map factors through a ﬁnite dimensional closed subscheme
Hitch(X)G ⊂ Hitch(U ).

The new diﬃculty is that, unlike the case when G = G × X is constant, in general
hcl is not a completely integrable system, and in particular C[Hitch(X)G ] does not
provide a maximal Poisson commuting subalgebra of the ring of regular functions
on T ∗BunG. For every x ∈ X \ U , let Kx := G(Ox) and let Px be the normalizer
of Kx in G(Fx), where Ox denotes the complete local ring at x and Fx denotes
the fractional ﬁeld of Ox (in the note, G(Ox) will be a Moy-Prasad subgroup so
Px will be a parahoric subgroup of G(Fx)). Then Qx := Px/Kx acts on BunG by
translations and therefore there is the moment map µx : T ∗BunG → q∗
x where qx is
the Lie algebra of Qx := Px/Kx. Then one has the enhanced Hitchin map

hcl ×Yx

µx : T ∗BunG → Hitch(X)G ×Yx

q∗
x.

Our observation is that in some nice cases (e.g. Kx is the pro-unipotent radical of
a pararhoric or Kx is a subgroup of G(Fx) considered in [RY], see § 3), one can
obtain a maximal Possion commuting subalgebra of the ring of regular functions
on T ∗BunG from this enhanced system. Then we can quantize this system by (a
generalization of) Beilinson-Drinfeld’s machinery to obtain an aﬃne scheme Spec A
and Hecke eigensheaves parameterized by it. A new feature is that points on Spec A
do not parameterize opers in general, but by construction there is a map from Spec A
to the space of opers. E.g., in the case considered in § 5, Spec A paramterizes linear
forms on Lie (I(1)/I(2)).

Let us summarize the contents of the note. We ﬁrst review of the main results of
[BD2] in § 1-§ 2. We take the opportunity to describe a slightly generalized version
of [BD2] in order to deal with the level structures (in particular see Corollary 9).
These results are probably known to experts but seem not to exist in literature yet.
In § 3, we study some geometry of the local Hitchin map by relating the invariant
theory of simple Lie algebras over local ﬁelds with the invariant theory of Vinberg’s
theta groups. In particular, we determine the images of the dual of some subalgebras
of a loop algebra under this map. Then we quantize these results in § 4 to get some
information of the endomorphism algebras of some modules of an aﬃne Kac-Moody
algebra at the critical level. These two sections contain results more than needed in
the proof of the main theorem. It may be useful to relate the subsequent works [Yu]
and [Ch]. The main result is proved in § 5.

In the note, X will be a smooth projective curve over C. For every
Notations.
closed point x ∈ X, let Ox denote the complete local ring of X at x and let Fx
denote its fractional ﬁeld. Let Dx = Spec Ox and D×
x = Spec Fx. For a scheme T of
ﬁnite type over Ox, we denote by T (Ox) the jet space T . For an aﬃne scheme T of
ﬁnite type over Fx, we denote by T (Fx) the ind-scheme of the loop space of T .

FRENKEL-GROSS’ IRREGULAR CONNECTION AND HEINLOTH-NG ˆO-YUN’S ARE THE SAME3

In the note, unless otherwise speciﬁed, G is a (ﬁberwise) connected smooth aﬃne
group scheme over X such that G = G ⊗ C(X) is reductive. We denote by BunG the
stack of G-bundles on X. This is a smooth algebraic stack over C.

In the note, a presheaf means a covariant functor from the category of commuta-

tive C-algebras to the category of sets.

Let F → F ′ be a morphism of presheaves and let u : Spec R → F ′ be morphism.

We use F ⊗ R, or FR to denote F ×F ′ Spec R if no confusion is likely to arise.

For an aﬃne (ind-)scheme T , we denote by Fun T or C[T ] the (pro-)algebra of

regular functions on T .

Acknowledgement. The author thanks the referee for careful reading and critical
questioning of the early version of the note. The author also thanks T.-H. Chen and
M. Kamgarpour for very useful comments. The work is partially supported by NSF
grant DMS-1001280/1313894 and DMS-1303296/1535464 and the AMS Centennial
Fellowship.

1. Kac-Moody chiral algebras

In the following two sections, we review the main results of the work [BD2], with

some generalizations in order to deal with level structures.

1.1. Beilinson-Drinfeld Grassmannians. We refer to [Zh2, § 3] for a general
introduction. For x ∈ X, let GrG,x denote the aﬃne Grassmannian of G at x. This
is a presheaf that assigns to every C-algebra R the pairs (F, βx), where F is a G-
torsor on X ⊗ R and βx is a trivialization of F away from the graph Γx of x. Then
GrG,x is represented by an ind-scheme over C, ind of ﬁnite type, and we can write

GrG,x ≃ G(Fx)/Kx,

where Kx = G(Ox), regarded as a pro-algebraic group over C. By forgetting βx, we
get a map

ux : GrG,x → BunG.

By allowing multiple points and allowing points to move, one obtain the Ran
version of the Beilinson-Drinfeld Grassmannian GrG,Ran(X), which is a presheaf1
that assigns to every C-algebra R, the triples ({xi}, F, β), where {xi} ⊂ X(R) is a
ﬁnite non-empty subset, F is a G-torsor on X ⊗ R, and β is a trivialization of F
away from the union of the graphs ∪iΓxi of {xi}. There is a natural projection

q : GrG,Ran(X) → Ran(X),

to the Ran space Ran(X) of X, which assigns to every C-algebra R, the ﬁnite
If U ⊂ X is an open subset, we have the Ran
non-empty subsets of X(R).
space Ran(U ) of U , which is an open sub-presheaf of Ran(X). Let GrG,Ran(U ) :=
GrG,Ran(X) ×Ran(X) Ran(U ) denote the base change. There is the (ad`elic version)
uniformization map

by forgetting ({xi}, β), and a unit section

uRan : GrG,Ran(U ) → BunG,

eRan : Ran(U ) → GrG,Ran(U )

given by the canonical trivialization of the trivial G-torsor. In the sequel, if G and
U are clear from the context, we write Ran(U ) by Ran and GrG,Ran(U ) by GrRan for
brevity.

1Note that it is not a sheaf.

4

XINWEN ZHU

A salient feature of the Beilinson-Drinfeld Grassmannian is its factorizable prop-
[BD1, § 3.10.16]). First, the Ran space Ran = Ran(U ) has a semi-group

erty (cf.
structure given by union of points

union : Ran × Ran → Ran,

({xi}, {xj }) 7→ {xi, xj}.

Let (Ran × Ran)disj denote the open sub presheaf consisting of those {xi} and {xj}
with {xi} ∩ {xj} = ∅. Then the factorization property amounts to a canonical
isomorphism

GrRan ×Ran (Ran × Ran)disj ≃ GrRan × GrRan|(Ran×Ran)disj ,

compatible with the unit section e : Ran → GrRan and satisfying a natural cocycle
condition over (Ran × Ran × Ran)disj.

Next, we recall a factorizable line bundle on GrRan. Let ωBunG be the canonical
sheaf of BunG. This is in fact a line bundle that can be described as follows. Let
E denote the universal G-torsor on X × BunG and ad E = E ×G Lie G be the adjoint
bundle. Then ωBunG is isomorphic to the determinant line bundle det(ad E) for ad E.
Its ﬁber over the trivial bundle is det(Lie G). Therefore, we can normalize ωBunG to
a rigidiﬁed line bundle as

ω♯
BunG

= ωBunG ⊗ det(Lie G)−1.

Let L2c,x = u∗

xω♯

BunG

∈ Pic(GrG,x), and let L2c,Ran = u∗

Ranω♯

BunG

.

Lemma 1. The line bundle L2c,Ran admits a natural factorizable structure, compat-
ible with the factorizable structure of GrRan.

Proof. Let G′ = GL(Lie G). This is an inner form of GLn on X. Let Ldet denote the
determinant line bundle on BunG ′ as well as its pullback to GrG ′,Ran(X). Then L2c is
just the pullback of Ldet along the natural morphism Ad : GrG,Ran(X) → GrG ′,Ran(X),
sending a G-torsor to its adjoint bundle. Note that ad is compatible with the natural
factorizable structures on GrG,Ran(X) and on GrG ′,Ran(X). Therefore, it is enough to
show that Ldet admits a natural (graded) factorizable structure, which is well-known
(e.g. see [Zh2, Remark 3.2.8]).
(cid:3)

1.2. Kac-Moody chiral algebras. Let F = C(X). We assume that G is a smooth,
aﬃne ﬁberwise connected group scheme over X with G := G ⊗ F simple and simply-
connected. Let us brieﬂy discuss the Kac-Moody chiral algebra attached to G,
generalizing the usual Kac-Moody chiral algebra for the constant group scheme over
X.

Let q : GrG := X ×Ran(X) GrG,Ran(X) → X be the Beilinson-Drinfeld Grassman-
nian over X, and e : X → GrG the unit section given by the trivial G-torsor. Let
L2c be the pullback of the line bundle L2c,Ran to GrG. Let δe be the L1/2
2c -twisted
delta right D-module along the unit section2. Let us deﬁne

VacX := q∗(δe),

the push-forward of δe as a quasi-coherent sheaf.

Lemma 2. The sheaf VacX is ﬂat as an OX-module.

2Recall that given a line bundle L on an algebraic variety X, it makes sense to talk about

Lλ-twisted D-modules on X for any λ ∈ C.

FRENKEL-GROSS’ IRREGULAR CONNECTION AND HEINLOTH-NG ˆO-YUN’S ARE THE SAME5

Indeed, let L+G (resp.
Proof. First note that π : GrG → X is formally smooth.
LG) be the global jet (resp. loop) group of G, which classiﬁes (x, γ), where x ∈ X
x → G) is a section. Then L+G and LG are formally
and γ : Dx → G (resp. γ : D×
smooth. As GrG = LG/L+G, it is formally smooth.

Then one can argue as [BD2, § 7.11.8] to show that the tangent space TeGrG
of GrG along e : X → GrG is a ﬂat OX -module, and δe admits a ﬁltration whose
associated graded is Sym TeGrG. Therefore, VacX is ﬂat.
(cid:3)

We refer to [BD1] for the generalities of chiral algebras.

Lemma 3. VacX has a natural chiral algebra structure over X.
Proof. For each ﬁnite non-empty set I, we have GrG,X I → X I and therefore the sim-
ilarly deﬁned VacX I . Using the dictionary between chiral algebras and factorization
algebras [BD1, Chap. 2, Sect. 4], the lemma is equivalent to saying that there is a
natural factorization structure on the collection {VacX I ⊗ ω−1
X I }. This follows from
Lemma 1.
(cid:3)

We call VacX the Kac-Moody chiral algebra associated to G.

1.3. Vacuum modules. By ﬂatness, the ﬁber of VacX over a point x ∈ X is

Vacx := Γ(GrG,x, δe|GrG,x).

We need a more representation theoretical description of Vacx in some cases. For
the purpose, we need to ﬁx a few notations.

We write gx = Lie G ⊗ Fx, regarded as an inﬁnite dimensional Lie algebra over C.
Let ˆgx be the “level one” Kac-Moody central extension of gx (i.e., the completion of
the derived subalgebra of one of those in [Ka, Theorem 7.4, 8.3]). We ﬁx an Iwahori
subgroup I ⊂ G(Fx), and let Λi, i = 0, . . . , ℓ be the fundamental weights of ˆgx (with

respect to I). Let ρaﬀ =P Λi. For a standard parahoric subgroup P ⊃ I of G(Fx),

let ρP denote the half sum of aﬃne roots in P/I. As before, we write Kx = G(Ox),
and let kx denote its Lie algebra. Its pre-image in ˆgx is denoted by ˆkx.
Lemma 4. Assume that Kx = P is a standard parahoric subgroup. Then as a
representation of ˆgx,

Vacx = Indˆgx
ˆkx

(C−ρaﬀ +ρP ),

where C−ρaﬀ +ρP is the 1-dimensional representation of ˆkx given by the character
−ρaﬀ + ρP .
Proof. The the lemma follows from the calculation of [Zh1, § 4.1]. Note that the
line bundle L2c,x here corresponds to L−1
(cid:3)

2c in loc. cit..

As explained in [Zh1, § 4.1], the restriction of −ρaﬀ + ρP to the center of ˆgx
is always given by multiplication by −h∨, the dual Coxeter number of (the split
form of) G. Therefore, it is customary to consider Vacx as a module of the critical
extension ˆgc,x of gx, i.e. (−h∨)-multiple of the “level one” central extension ˆgx, so
that the center of ˆgc,x acts on Vacx by identity. In the sequel, we adapt this latter
point of view. Let 1x (or 1 for simplicity) denote the central element in ˆgc,x that
acts on Vacx by identity.

When Hom(Kx, Gm) = 1, e.g. Kx is a maximal parahoric or a pro-unipotent
group, there is another expression of Vacx, which might justify the notation. Namely,
in this case, there is a unique splitting of the Lie algebra ˆkx ≃ C1 ⊕ kx coming from
the splitting at the group level. Then

(1.1)

Vacx = Ind

ˆgc,x
C1⊕kx

(C),

6

XINWEN ZHU

where 1 acts on C by identity and kx acts trivially. That is, Vacx is a “vacuum”
module.

Remark 1.1. However, if Hom(Kx, Gm) is non-trivial, there is no “natural” splitting
of ˆkx. For example, if Kx = I is the Iwahori subgroup, by embedding I into diﬀerent
maximal parahorics one obtains diﬀerent splittings of ˆkx, and if one writes Vacx
as the form Ind
(Cχ) using these splittings, kx will act on Cχ via diﬀerent
characters χ.

ˆgc,x
C1⊕kx

1.4. The center. For any chiral algebra A over a curve, one can associate the
algebra of its endomorphisms, denoted by End(A). As a sheaf of OX -modules on
X, it is deﬁned as

End(A) = HomA(A, A),

where HomA is taken in the category of chiral A-modules. If A is OX -ﬂat, which
is the case we will be considering, it is quasi-coherent. Obviously, End(A) is an
algebra by composition. Less obviously, there is a natural chiral algebra structure
on End(A) ⊗ ωX which is compatible with the algebra structure. In fact, the natural
map End(A) ⊗ ωX → A identiﬁes End(A) ⊗ ωX with the center z(A) of A.

Therefore, End(A) is a commutative DX-algebra. There is a natural injective
mapping End(A)x → End(Ax) which is not necessarily an isomorphism in general,
where End(Ax) is the endomorphism algebra of Ax as a chiral A-module. However,
this is an isomorphism if there is some open neighborhood U containing x such that
A|U is constructed from a vertex algebra (in the sense of [FB, Chap. 19]). We
refer to [Ro] for details of the above discussion. We apply the above discussion to
End(VacX ). In particular, if G is unramiﬁed at x, End(VacX )x ≃ End(Vacx).

To continue, we assume that G = G ⊗ F is split, i.e.

it is the base change of
simple complex Lie group G0 from C to F . The reason we make this assumption is
that the relevant theory for twisted aﬃne algebras has not been fully developed. We
denote by g the Lie algebra of G and Lg the Langlands dual Lie algebra, equipped
with a Borel subalgebra Lb. Following the usual convention, we consider Lg and Lb
as ﬁnite dimensional Lie algebras over C (while g is a Lie algebra over F ).

x ). Let ALg(Dx) (resp. ALg(D×

Recall the deﬁnition of opers (cf. [BD2, § 3]). Let OpLg(Dx) (resp. OpLg(D×

x ))
be the scheme (resp. ind-scheme) of Lg-opers on the disc Dx (resp. punctured disc
D×
x )) denote the ring of its regular functions. Let
ˆUc(gx) denote the completed universal enveloping algebra of ˆgc,x, and let Zx denote
the center of ˆUc(gx). Then the Feigin-Frenkel isomorphism ([BD2, § 3.7.13], [Fr])
asserts that there is a canonical isomorphism
ϕx : ALg(D×

(1.2)

x ) ≃ Zx,

satisfying certain compatibility conditions (one of which will be reviewed in § 4).
Then we obtain

If G is unramiﬁed at x, this map factors as

ALg(D×

x ) ≃ Zx → End(Vacx).

ALg(D×

x ) ։ ALg(Dx) ≃ zx := End(Vacx).

Let U ⊂ X be an open subscheme such that G|U ≃ G0 × U . Let OpLg |U be the
DU -scheme over U , whose ﬁber over x ∈ U is the scheme of Lg-opers on Dx. Then
by the above generality, the Feigin-Frenkel isomorphism gives rise to

Spec End(VacU ) ≃ OpLg |U .

FRENKEL-GROSS’ IRREGULAR CONNECTION AND HEINLOTH-NG ˆO-YUN’S ARE THE SAME7

Recall that for a commutative DU -algebra B, one can take the algebra of its
horizontal sections H∇(U, B) (or so-called conformal blocks) [BD2, § 2.6], which is
usually a topological commutative algebra. For example,

Spec H∇(U, OpLg) = OpLg(U )

is the ind-scheme of Lg-opers on U ([BD2, § 3.3]). As the map

H∇(U, End(VacU )) → H∇(X, End(VacX ))

is surjective, we have a closed embedding

Spec H∇(X, End(VacX )) → OpLg(U ).

Let OpLg(X)G denote the image of this closed embedding. This is a subscheme
(rather than an ind-scheme) of OpLg(U ).

We recall the characterization OpLg(X)G .

Lemma 5. Let X \ U = {x1, . . . , xn}. Assume that the support of Vacxi (as an
Zxi-module) is Zxi ⊂ OpLg(D×
xi) → End(Vacxi)).
Then

xi), i.e. Fun(Zxi) = Im(ALg(D×

OpLg(X)G ≃ OpLg(U ) ×Qi OpL g

(D×

xi )Y Zxi.

Proof. Note that VacX is ﬂat, and therefore by Lemma 2, End(VacX )xi → End(Vacxi)
is injective. Recall that Spec End(VacX )xi is identiﬁed with the scheme of horizon-
tal sections of End(VacX ) on the disc Dxi. On the other hand, the ind-scheme of
horizontal sections of End(VacX ) on D×
xi) →
End(VacX )xi is surjective. Therefore,

xi). Therefore ALg(D×

xi is just OpLg(D×

End(VacX )xi = Im(ALg(D×

xi) → End(Vacxi)).

Then the lemma follows from the last paragraph of [BD1, § 2.4.12] applied to the
commutative chiral algebra End(VacX ).
(cid:3)

In § 4, we will give an explicit description of Zxi in some cases.

2. Hecke eigensheaves

BunG

. In order to construct the Hecke eigensheaves, it is

2.1. Square root of ω♯
important to have a square root ω1/2
In the case
BunG
considered in § 5, the existence of such a square root is very easy (see Remark 5.1).
But in general, this is subtle. The case when G is a constant semisimple group
scheme is discussed in [BD2, § 4]. Here, we describe a result for the case when G is
non-constant, but G = G ⊗ C(X) is simple and simply-connected. The readers can
skip this subsection.

as a line bundle.

of ω♯

BunG

We write F = C(X). We make the following assumptions on G.

(i) G = G ⊗ F is absolutely simple and simply-connected;
(ii) for every x ∈ X, either G|Ox is a parahoric group scheme or the ﬁber of G at

x is a unipotent group.

Recall the line bundle L2c,x = u∗

xω♯

BunG

.

Proposition 6. Assumptions are as above. Then a square root of ω♯
exists as
a line bundle if and only if for every x such that G|Ox is a parahoric group, the line
bundle L2c,x admits a square root as a line bundle. In addition, such a square root
is unique.

BunG

8

XINWEN ZHU

We denote the unique square root, rigidiﬁed at the trivial G-torsor, by ω1/2
BunG
The “only if” part is trivial. Note that there are examples of parahorics of G(Fx)
such that L2c,x does not admit a square root (cf. [Zh1, Remark 6.1]). The “if” part
and the uniqueness is based on the following proposition.

.

Proposition 7. Let U ⊂ X be an open subset such that for every x ∈ X \ U , the
ﬁber of G at x is unipotent. Then the pullback functor u∗
Ran induces an equivalence
of categories between rigidiﬁed line bundles on BunG and on GrG,Ran(U ).

This statement is a slight variant/generalization of [BD2, 4.3.14] or [BD1, 4.9.1].
It allows us to reduce the problem to construct a square root of L2c,Ran. Then using
the factorization property, we can work ´etale locally around a point. We omit the
details (but see [Zh2, § 4.2]) since we do not really use Proposition 6 in § 5.

2.2. Construction of Hecke eigensheaves. We further assume that G := G⊗F =
G0 ⊗C F , where G0 is a simple, simply-connected complex Lie group.

Now we assume that BunG is “good” in the sense of Beilinson-Drinfeld, i.e.

dim T ∗BunG = 2 dim BunG.

In this case one can construct the D-module of the sheaf of critically twisted (a.k.a.
ω1/2
-twisted) diﬀerential operators on the smooth site (BunG)sm of BunG, denoted
BunG
by D′. Let D′ = (EndD′)op be the sheaf of endomorphisms of D′ as a twisted D-
module. Then D′ is a sheaf of associative algebras on (BunG)sm and D′ ≃ (D′)op.
For more details, we refer to [BD2, § 1].

Let BunG,x be the scheme classifying pairs (F, β), where F is a G-torsor on X
and β is a trivialization of F on Dx = Spec Ox. It admits a (ˆgc,x, Kx)-action, and
BunG,x/Kx ≃ BunG. Now applying the standard localization construction to the
Harish-Chandra module Vacx (cf. [BD2, § 1]) gives rise to

Loc(Vacx) ≃ D′

as critically twisted D-modules on BunG. It induces a natural ring homomorphism

hx : Zx → End(Vacx) → Γ(BunG, D′).

In fact, the mappings hx can be organized into a horizontal morphism h of DX-
algebras over X (we refer to [BD2, § 2.6] for the generalities of DX -algebras and
[BD2, § 2.8] for the horizontality of h),

(2.1)

h : End(VacX ) → Γ(BunG, D′) ⊗ OX .
By taking the horizontal sections, one obtains a mapping

(2.2)

h∇ : H∇(X, End(VacX )) → Γ(BunG, D′).

Therefore, (2.2) can be rewrite as a mapping

(2.3)

h∇ : Fun OpLg(U ) ։ Fun OpLg(X)G → Γ(BunG, D′).

The mapping (2.3) is a quantization of a classical Hitchin system. Namely, as
explained in [BD2, §3.1.13] (or see § 4 for a review), there is a natural ﬁltration on
the algebra Fun OpLg(U ) whose associated graded is the algebra of functions on the
classical Hitchin space

(2.4)

Hitch(U ) = Γ(U, c∗ ×Gm ω×

U ).

Here, using the fact that G is unramiﬁed over U , we regard

c∗ = g∗//G = Spec F [g∗]G

FRENKEL-GROSS’ IRREGULAR CONNECTION AND HEINLOTH-NG ˆO-YUN’S ARE THE SAME9

as a scheme over U . On the other hand, there is a natural ﬁltration on Γ(BunG, D′)
coming from the order of the diﬀerential operators. Then (2.3) is strictly compatible
with the ﬁltration and the associated graded map gives rise to the classical Hitchin
map

hcl : T ∗BunG → Hitch(U ).

Its image is the closed subscheme Hitch(X)G ⊂ Hitch(U ) whose algebra of functions
is the associated graded of Fun OpLg(X)G .

Let LG be the Langlands dual group of G, which is of adjoint type. The following

theorem summarizes the main result of [BD2].
Theorem 8. Assume that the line bundle ω1/2
BunG
OpLg(U ) be a closed point, which gives rise to a Lg-oper E on U . Let

exists. Let χ ∈ OpLg(X)G ⊂

be the corresponding homomorphism of C-algebras. Then

ϕχ : Fun OpLg(X)G → C

AutE := (D′ ⊗L

Fun OpL g

(X)G ,ϕχ

C) ⊗ ω−1/2
BunG

is a Hecke-eigensheaf on BunG with respect to E (regarded as a LG-local system).
Remark 2.1. The statement of the about theorem is weaker than the main theorem
in [BD2], where G is the constant group scheme (the unramiﬁed case). In this case
Beilinson-Drinfeld proved that OpLg(X)G = OpLg(X) is the space of Lg-opers on
X, that Fun OpLg(X) ≃ Γ(BunG, D′), and that D′ is ﬂat over Fun OpLg(X). It then
follows that in the deﬁnition of AutE , the derived tensor product can be replaced by
the underived tensor product, and that AutE is a non-zero holonomic D-module.

The proof of these assertions relies on the fact that the classical Hitchin map
is a completely integrable system. However, for general level structures, we do
not know whether D′ is always ﬂat over Fun OpLg(X)G . In addition, the automor-
phic D-modules constructed as above will not be holonomic, as Fun OpLg(X)G ⊂
Γ(BunG, D′) might be too small. For example, this will be the case for the group
scheme G = G(0, 2) introduced in § 5.

Sometimes, we can remedy the situation by replacing Fun OpLg(X)G by a larger
commutative subalgebra in Γ(BunG, D′). To state our result, we ﬁrst give a brief
review of the local ingredient needed in the proof of Theorem 8. Let x ∈ U ⊂ X, so
G is unramiﬁed at x. Then GrG,x is the usual aﬃne Grassmannian GrG0,x of G0 at
x. Let Sphx = D -mod(GrG0,x)G0(Ox) be the Satake category of G0(Ox)-equivariant
D-modules on GrG0,x, and let Sx : Rep(LG) → Sphx denote the geometric Satake
equivalence. As explained in [BD2, § 7.8], there is a convolution action ⋆ of Sphx
on the derived category of Harish-Chandra (ˆgc,x, G0(Ox))-modules. The local Hecke
eigen property of Vacx (see [BD2, § 5.5]) asserts that for every V ∈ Rep(LG) there
is a canonical isomorphism of Harish-Chandra (ˆgc,x, Kx)-modules,
(2.5)
where Ex is the ﬁber over x ∈ Dx of the universal LG-torsor on OpLg(Dx) ˆ×Dx,
and (Ex)V is its twist by V , regarded as a ﬁnite projective zx ≃ ALg(Dx) mod-
ule. In particular, the isomorphism commutes with the actions of zx on both sides.
The localization functor intertwines the action of Sphx on the derived category of
(ˆgc,x, G0(Ox))-modules and on the derived category of D-modules on BunG. Then
by letting x move in U , one obtains a canonical isomorphism

Sx(V ) ⋆ Vacx ≃ (Ex)V ⊗zx Vacx,

(2.6)

SU (V ) ⋆ D′ ≃ EV ⊗AL g

(U ) D′,

10

XINWEN ZHU

of D-modules on BunG × X, compatible with the actions of ALg(U ) on both sides.
Here SU is the family version of Sx over U .

Now let y ∈ X \ U , and let Ay ⊂ End(Vacy) be a commutative subalgebra. We
regard Vacx ⊗ Vacy as the representation of ˆgc,x,y := ˆgc,x ⊕ ˆgc,y/(1x − 1y). Then
by tensoring with Vacy, (2.5) induces a canonical isomorphism of Harish-Chandra
(ˆgc,x,y, Kx × Ky)-modules,

Sx(V ) ⋆ Vacx ⊗ Vacy ≃ (Ex)V ⊗zx Vacx ⊗ Vacy,

compatible with the Ay ⊗zx-module structures. By the (two-points version) localiza-
tion functor and allowing x to move in U (but ﬁxing y), we see that the isomorphism
(2.6) is compatible with the Ay ⊗ ALg(U )-module structures on both side.

Now for every y ∈ X \ U , let Ay be a commutative subalgebra End(Vacy) con-
taining the image of Zy → End(Vacy). Then the map in (2.3) can be upgraded to a
map

ALg(U ) ⊗Yy

Ay → Γ(BunG, D′).

Let A denote its image. Then A is a commutative subalgebra of Γ(BunG, D′) con-
taining Fun OpLg(X)G . Let π : Spec A → OpLg(X)G denote the corresponding map
of schemes induced by this inclusion.

Corollary 9. Assume that D′ is A-ﬂat. Then for every χ ∈ Spec A, the correspond-
ing D-module

AutE := ω−1/2
BunG

⊗ (D′ ⊗A,ϕχ

C)

is a Hecke eigensheaf with eigenvalue E, where ϕχ : A → C is the homomorphism
corresponding to χ, and E is the LG-local system on U corresponding to the oper
π(χ) ∈ OpLg(X)G ⊂ OpLg(U ).

Proof. As explained as above, the isomorphism (2.6) is compatible with the A-
module structure on both sides. Then ω−1/2
C) is a Hecke eigensheaf with
BunG
C = D′ ⊗A,ϕ C by the ﬂatness, giving the corollary. (cid:3)
eigenvalue E. Finally D′ ⊗L

⊗(D′ ⊗L

A,ϕ

A,ϕ

3. Some geometry of the local Hitchin map

This section is purely local. We ﬁx a point x ∈ X on the curve. To simplify the
notation, we denote the local ﬁeld Fx by F , and its ring of integers by O, its maximal
ideal m. Likewise, we use D (resp. D×) to denote the disc (resp. the punctured
disc) around x. After choosing a uniformizer t ∈ m, we have F ≃ C((t)). For a line
bundle L on D = Spec O, let L(m) denote L(m · x) where x ∈ D is the closed point.

3.1. The space of invariant polynomials. Let g be a simple Lie algebra over
a ﬁeld k of characteristic zero, and let G (resp. Gad denote the corresponding
simply-connected (resp. adjoint) algebraic group. Let

χ : g∗ → c∗

denote the usual Chevalley map, where c∗ := g//G = Spec k[g∗]G is the GIT quotient
of g∗ under the adjoint action of G. For our purpose, we need to recall some ﬁner
structures on c∗.

Let Lg be the dual Lie algebra over k, and let cLg = k[Lg]

LG denote its space of
characteristic polynomials. Let Out(Lg) be the group of outer automorphisms of Lg.

FRENKEL-GROSS’ IRREGULAR CONNECTION AND HEINLOTH-NG ˆO-YUN’S ARE THE SAME11

Then the Lie algebra g gives a homomorphism ψ : Gal(k/k) → Out(gk) = Out(Lg)
up to conjugacy. Then we have the canonical isomorphism

c∗ ≃ (cLg ⊗ k)Gal(k/k).

Now we give another description of cLg with the action of Out(Lg).

Let VLg be the Lie algebra of the universal unipotent regular centralizer of Lg,
let

equipped with a canonical Gm-action. Let us recall its deﬁnition. Namely,
JLg → cLg denote the universal centralizer group scheme `a la Ngˆo [Ng, § 2]. Then

VLg := Lie JLg|0,

where 0 ∈ cLg corresponds to the regular nilpotent conjugacy class. By deﬁnition, for
a regular nilpotent element e, there is a canonical Gm-equivariant isomorphism VLg ≃
Lge, and after ﬁxing a principal sl2-triple {e, h, f } of Lg, there are the isomorphisms

(3.1)

VLg ≃ f + Lge ≃ cLg.

This isomorphism is independent of the choice of the sl2-triple, and therefore en-
dows cLg with a vector space structure. In addition, if we ﬁx a pinning (Lg, Lb, Lt, e),
Aut(Lg, Lb, Lt, e) will act on Lge by linear transformations. By transport of struc-
ture, we obtain an action of Out(Lg) on VLg, which is independent of the choice of
the pinning and commutes with the Gm-action. In addition, the isomorphism (3.1)
is Out(Lg)-equivariant. If we deﬁne a graded k-vector space as

LVg := (VLg ⊗ k)Gal(k/k),

we get a canonical Gm-equivariant isomorphism

(3.2)
giving c∗ a graded vector space structure.

LVg ≃ c∗,

3.2. The local Hitchin map. Now we apply the above discussion to k = F so g
be a simple Lie algebra over F . Then VLg has a natural Gm-stable O-structure. and
therefore LVg admits a Gm-stable O-lattice

LVg,O := (VLg ⊗ O)Gal(F /F ).

Similarly there is a canonical Gm-stable integral structure on c∗, denoted by c∗
isomorphism (3.2) is compatible with the integral structures.

O. The

Let

LVg,O =Mi

LVg,di

denote the grading under the action of Gm. We arrange the weights appearing
in the above decomposition into a non-decreasing sequence {d1, . . . , dℓ} such that
di appears in the sequence dim L(Vg,di ⊗ F ) times. These positive numbers are
sometimes called the (fundamental) degrees of g. By (3.2), for a 1-dimensional
vector space over F (or an invertible O-module) L,

c∗ ×Gm L× ≃Mi

Ldi ⊗ LVg,di.

Now we regard the Chevalley map χ as a map of C-indschemes.

It induces the

local Hitchin map of ind-schemes

x : g∗ ⊗ ωF → c∗ ×Gm ω×
hcl

ωdi
F ⊗ LVg,di.

F =Mi

12

XINWEN ZHU

We will be interested in the image of certain O-lattices of g∗ under the local Hitchin
map.

3.3. Local Hitchin maps for Moy-Prasad subgroups. Let P ⊂ G(F ) be a
parahoric subgroup. It admits a ﬁltration by normal subgroups (the Moy-Prasad
ﬁltration)

where LP := P (0)/P (1) is the Levi quotient of P . Let

P = P (0) ✄ P (1) ✄ P (2) ✄ · · ·

g ⊃ p = p(0) ⊃ p(1) ⊃ p(2) ⊃ · · · ,

denote the corresponding ﬁltration on Lie algebras. Then the exponential map
induces isomorphisms

p(i)/p(i + 1) ≃ P (i)/P (i + 1),

i ≥ 1.

We denote p(1)/p(2) ≃ P (1)/P (2) by VP .

There is an integer m such that mp(i) = p(i + m). Therefore, we can extend the

above ﬁltration of p to a ﬁltration of g by O-lattices given by

p(i) = m−N p(i + N m), N ≫ 0.

Note that for i < 0, p(i) is not a subalgebra. Let p(i)∨ be the O-dual of p(i) in g∗,
and let p(i)⊥ = p(i)∨ ⊗O ωO. We have the chain of O-submodules in g∗ ⊗ ωF

· · · ⊂ p(0)⊥ ⊂ p(1)⊥ ⊂ p(2)⊥ · · · .

Proposition 10. The following diagram is commutative

p(n)⊥

−−−−→

g∗ ⊗ ωF

y
m ⌉)) ⊗ LVg,di −−−−→ Li ωdi

x

yhcl

F ⊗ LVg,di.

Li ωdi

O ((di − ⌈ di(1−n)

Remark 3.1. For n ≥ 1, one shall regard this proposition as a classical limit of the
main theorem of [CK].

Proof. The proof is a simple application of [RY, Theorem 4.1] in our set-up, which
generalizes Kac’s work (cf. [Ka, Ch. 8]) on the realization of (twisted) aﬃne algebras
via loop algebras. We will give a relatively self-contained account of Reeder-Yu’s
result. However, we shall warn the readers from the beginning that our notations
are diﬀerent from Reeder-Yu’s.

We choose a pinning (g, b, t, e) of g. Let (g0, b0, t0, e0) be a split form of g together

with a pinning deﬁned over C. We ﬁx once and for all an isomorphism

(3.3)

(g, b, t, e) ⊗F F ≃ (g0, b0, t0, e0) ⊗C F ,

where F is an algebraic closure of F . It induces a map

(3.4)

ψ : Gal(F /F ) → Aut(g0, b0, t0, e0) ≃ Out(g0)

such that the natural action of γ ∈ Gal(F /F ) on the left hand side corresponds to
the action ψ(γ) ⊗ γ on the right hand side. These data determine:

(1) an apartment A corresponding to t in the building of g;
(2) a special point x0 ∈ A corresponding to the parahoric algebra (g0⊗O)Gal(F /F );
(3) a set of simple aﬃne roots {α0, . . . , αℓ} such that α1(x0) = · · · = αℓ(x0) = 0
and that the vector parts of αi, i = 1, . . . , ℓ form the set of simple roots of g
with respect to b.

FRENKEL-GROSS’ IRREGULAR CONNECTION AND HEINLOTH-NG ˆO-YUN’S ARE THE SAME13

Explicitly, we can identify A with the R-span of the Gal(F /F )-invariant sub-
space of the cocharacter group X•(T0,ad ) = Homk(Gm, T0,ad ), where T0,ad is the
adjoint torus with Lie algebra t0. We can also identify x0 with the origin of
X•(T0,ad )Gal(F /F ). If g = g0 ⊗C F and if (3.3) arises as the base change (i.e. the
split case), then {α1, . . . , αℓ} are the set of simple roots of g0 with respect to b0
(regarded as aﬃne functions on A), and α0 = 1 − θ, where θ is the highest root.

Let {ai} be Kac’s labels of the aﬃne Dynkin diagram of g (cf.

[Ka, Ch. 4]
TABLE Aﬀ 1,2), and r = 1, 2, 3 be the order of the image of ψ : Gal(F /F ) →
Aut(g0, b0, t0, e0). We regard aﬃne roots as aﬃne functions on A. Under the (usual)
normalization

Let C be the (closed) alcove in A deﬁned by {x ∈ A | αi(x) ≥ 1}. Clearly, we can
prove the proposition just for standard parahorics, i.e. those corresponding to facets
of C. For such a parahoric P , let xP denote the barycenter of the corresponding
facet. We can write the aﬃne coordinates with respect to {α0, . . . , αℓ} (a.k.a. the
Kac coordinates) of xP as

rX aiαi = 1.

(

s0
m

, . . . ,

sℓ
m

),

where si ∈ {0, 1} and m = rP aisi.

Note that m(xP −x0) pairing with any root of g is an integer and therefore deﬁnes

a cocharacter

ηP : Gm → Tad ,

where Tad ⊂ Gad is the torus whose Lie algebra is t. The isomorphism (3.3) induces
an isomorphism HomF (Gm, Tad ) ≃ Homk(Gm, T0,ad )Gal(F /F ), and therefore we may
regard ηP as a cocharacter Gm → T0.

Let E/F be the (unique) Galois extension of degree m inside F . Then ψ factors
through Gal(E/F ) → Aut(g0, b0, t0, e0), and the isomorphism (3.3) descends to E.
Following Kac, we deﬁne a torsion automorphism of g0 as

θP : Gal(E/F ) → Aut(g0),

θP (γ) = ψ(γ)Ad(ηP (ζ)−1),

where ζ ∈ µm corresponds to γ under the canonical identiﬁcation Gal(E/F ) = µm.
We can write

g0 = Mi∈Z/mZ

g0(i),

where g0(i) is the weight space of θ corresponding to i ∈ Z/mZ = µ∗
g0(i) is the ζ −i-eigenspace of θP (γ).

m. Explicitly,

We endow g0⊗E with an action of Gal(E/F ) given by θP (γ)⊗γ for γ ∈ Gal(E/F ).
Explicitly, let u be a uniformizer of E such that t = um is a uniformizer of F . Then
ζ = γ(u)/u so γ acts on g0 ⊗ ui as ψ(γ)ηP (ζ −1) ⊗ ζ i. In particular, for a generator

γ of Gal(E/F ), (g0 ⊗ E)θP (γ)×γ is the u-adic completion of Li∈Z g0(i) ⊗ ui.

Note that as F -automorphisms of g0 ⊗ E,

ψ(γ) × γ = Ad(ηP (u−1))(θP (γ) × γ)Ad(ηP (u)).

Combining with (3.3), we obtain the isomorphism constructed by Kac ([Ka, Theorem
8.5])

(3.5)

K : g = (g ⊗F E)γ ≃ (g0 ⊗k E)ψ(γ)×γ Ad(ηP (u))

≃

(g0 ⊗k E)θP (γ)×γ,

for any choice γ of the generator of Gal(E/F ). By abuse of notation, we also use K
to denote the induced embedding g ≃ (g0 ⊗k E)θP (γ)×γ → g0 ⊗ E.

14

XINWEN ZHU

Let us have a more detailed analysis of the isomorphism K. First,

K(mnt) = tθP (γ)

0

tψ(γ)
0 ⊗ umj.

⊗ mn =Xj≥n

Next, let α be an aﬃne root of g and let gα denote the corresponding aﬃne root
space (which is one-dimensional over C). Let {bi} be the set of roots of g0 that
restrict to the linear part ˙α of α, and {g0,bi} be the corresponding root spaces. Then

K(gα) =Xi

g0,bi ⊗ uhηP ,bii+mα(x0) ⊂ g0(j) ⊗ uj

for j = hηP , bii + mα(x0). Note that we can also rewrite this number as

m ˙α(xP − x0) + mα(x0) = mα(xP ).

Now recall that by the deﬁnition of the Moy-Prasad ﬁltration, p(n) is the subalgebra
of g generated by m⌊ n
m ⌋t, and all the aﬃne root subspaces gα such that α(xP ) ≥ n
m .
Therefore, K restricts to an isomorphism

K : p(n) ≃ (g0 ⊗k mn

g0(j) ⊗ uj,

E)θP (γ)×γ = Yj≥n

which is [RY, Theorem 4.1]

Note that by replacing g by g∗ in the above paragraphs, we obtain an isomorphism

K ∗ : g∗ ≃ (g∗

0 ⊗ E)θP (γ)×γ and therefore we obtain

DK : g∗ ⊗ ωF ≃ (g∗

0 ⊗k ωE)θP (γ)×γ ⊂ g∗

0 ⊗k ωE,

ξ(t)

dt
t

7→ mK ∗(ξ(t))

du
u

.

We need two properties of DK: (i) the following diagram is commutative,

(3.6)

g∗ ⊗ ωF

DK−−−−→ g∗

0 ⊗ ωE

c∗ ×Gm ω×

F −−−−→ c∗

0 ×Gm ω×
E .

y

y

(ii) K ⊗ DK commutes with the pairings induced by the residue up to the scalar m.
I.e., for X ∈ g, ξ dt

t ∈ g ⊗ ωF ,

(3.7)

ResF (ξ, X)

dt
t

= mResE(K ∗(ξ), K(X))

du
u

= mResE(DK(ξ

du
u

), K(X)).

Since under the residue pairings, the orthogonal complement of (g0 ⊗ mn
0 ⊗ m−n
(g∗
(3.7) that

E) is
E ωOE ), and the orthogonal complement of p(n) is p(n)⊥, we obtain from

(3.8)

p(n)⊥ = DK −1(g∗ ⊗ ωF ∩ m−n

E (g∗

0 ⊗ ωOE )).

Note that under the map g0 ⊗ ωE → c0 ⊗ ωE, the closed subscheme m−n

0 ⊗ ωOE )
(ndi). This is clear for n = 0 and therefore for all n. On

E (g∗

maps surjectively toL ωdi

the other hand,

OE

Lemma 11. Inside ωd
E,

Proof. Let f (t)( dt

t )d ∈ ωd

F , then f (um)md( du

(n) if and only if

(d − n)

⌉).

ωd
OE (n) ∩ ωd

F = ωd

OF (⌈

m
u )d ∈ ωd
OE
m ordt(f ) − d ≥ −n.

So ordt(f ) ≥ ⌈ (d−n)

m ⌉.

(cid:3)

FRENKEL-GROSS’ IRREGULAR CONNECTION AND HEINLOTH-NG ˆO-YUN’S ARE THE SAME15

Now the proposition follows easily from (3.6) (3.8) and the above lemma.

(cid:3)

Remark 3.2. When studying harmonic analysis on g, it is customary to regard the
(local) Hitchin map as a map g ⊗ ωF → c ×Gm ωF , and it’s natural to describe
the image of p(n) under this map. But this reduces the study the image of p(n)⊥
under hcl
x by the following reason. Note that the isomorphism g∗ ≃ g induced by
the Killing form intertwines K and K ∗. Therefore,

p(n)⊥ = p(1 − n) ⊗O ωO(1) = p(1 − n − m) ⊗O ωO.

We consider a few well-known special cases of Proposition 10. If n = 0, it says

that the local Hitchin map restricts to a map

p(0)⊥ →Mi

In particular,

ωdi

O ((cid:22) (m − 1)di

m

(cid:23)) ⊗ LVg,di

• if m = 1, so p ≃ g0 ⊗k O is hyperspecial, then we have the unramiﬁed local

Hitchin map

p(0)⊥ →Mi

ωdi
O ⊗ LVg,di = c∗

O ×Gm ω×
O.

• If m is the (twisted) Coxeter number of g, then p must be an Iwahori subal-

gebra and the local Hitchin map restricts to the map

p(0)⊥ →Mi

ωdi
O (di − 1) ⊗ LVg,di.

It’s known that in both cases the maps are surjective.

If n = 1, it says that the local Hitchin map restricts to a map

(3.9)

p(1)⊥ →Mi

ωdi
O (di) ⊗ Vg,di ≃ cO ×Gm ωO(1)× =: Hitch(D)RS,

which is known to be surjective if p is an Iwahori subalgebra (so p(1) = [p(0), p(0)]).
Since for a general parahoric subalgebra p, p(1)⊥ contains the orthogonal comple-
ment of the pro-nilpotent radical of some Iwahori subalgebra, we see that

Corollary 12. The map (3.9) is surjective for every p.

Now we consider the special case when θP : µm → Aut(g0) corresponding to the
parahoric P constructed above is principal (or called N -regular as in [Pa]). This
means that θP is conjugated by an inner automorphism to

θ′
m = ψρ : µm → Aut(g0),

where ρ as usual denotes the half sum of positive roots of g0 (with respect to b0).
In this case, there exists a regular nilpotent element e′ of g0 (maybe diﬀerent from
e0 we ﬁxed before) in g0(1).

Clearly, m = 1 (so that p is hyperspecial) is the case. In addition, it is proved in
[RY, Corollary 5.1] that if m is a regular elliptic number of g0, then θP is principle.
In particular, if P = I is an Iwahori subgroup, then θI is principal.

Assume that θP is principal. Let us denote

Hitch(D)p(n) =Mi

ωdi
O (di − ⌈

di(1 − n)

m

⌉) ⊗ LVg,di ⊂ Hitch(D×) := c∗ ×Gm ω×
F .

16

XINWEN ZHU

Proposition 13. Assume that θP is principle. Then the map

p(2)⊥ → Hitch(D)p(2)

is surjective. In particular, the map Fun Hitch(D)p(2) → Fun p(2)⊥ is injective.

Remark 3.3. There are only a few parahorics p of g such that θP is principal. It will
be interesting to describe the precise image of p(n)⊥ under the local Hitchin map
for a general parahoric p and general n. We are informed that D. Baraglia and M.
Kamgarpour have made some progress in this direction.

Proof. It is convenient to identify g∗
0 with g0 using the Killing form. We can choose
a principal sl2-triple {e′, h′, f ′} of g0 where e′ ∈ g0(1), h′ ∈ g0(0), f ′ ∈ g0(−1). Then
the Kostant section

κ : c0 ×Gm ω×
associated to {e′, h′, f ′} maps the element

E → g0 ⊗ ωE

(t−⌊ d1

m ⌋c1(t)(

dt
t

)d1 ⊗ v1, . . . , t−⌊

dℓ
m ⌋cℓ(t)(

dt
t

)dℓ ⊗ vℓ) ∈ Hitch(D)p(2)

to

(3.10)

(f ′ +Xi

u−di−m⌊ di

m ⌋ci(um)pi)du,

i ∈ ge′

where p′
G0. Then after conjugating by Ad(h′(u)), the element (3.10) becomes

0 such that χ(f ′ + pi) = vi. Let us regard h′ as a cocharacter h′ : Gm →

(u−1f ′ +Xi

udi−m⌊ di

m ⌋−1ci(um)pi)

du
u

.

As pi ∈ g0(di − 1), the pre-image under DK of the above element belongs to p(2)⊥.
This implies the proposition.
(cid:3)

There is the following map

(3.11)

Hitch(D)p(2) →Mdi|m

ωdi

O (di +

di
m

)/ωdi

O (di +

di
m

− 1) ⊗ LVg,di,

which ﬁts into the commutative diagram

p(2)⊥

−−−−→

0(−1) ⊗ ωOE (2)|0 = p(2)⊥/p(1)⊥
g∗

y

y

O (di + di

m )/ωdi

O (di + di

m − 1) ⊗ LVg,di.

Hitch(D)p(2) −−−−→ Ldi|m ωdi

In addition, the right vertical map factors through
(3.12)
g∗
0(−1)⊗ωOE (2)|0 → (g∗

0(−1)//LP )×GmωOE (2)|0 → Mdi|m
0 ) ∩ g0(−1) = {f +Xm|di

(f ′ + ge′

cipi} → g0(−1)//LP

Since θP is principal, the map

ωdi
O (di+

di
m

)/ωdi

O (di+

di
m

−1)⊗LVg,di.

is an isomorphism by [Pa, Theorem 3.5]. Therefore the last map in (3.12) is an
isomorphism.

FRENKEL-GROSS’ IRREGULAR CONNECTION AND HEINLOTH-NG ˆO-YUN’S ARE THE SAME17

Note that the pairing ResF : p(2)⊥ × p(1) → C identiﬁes g∗

P of g0(1) = VP , and therefore we naturally identify (g∗

0(−1) ⊗ ωOE (2)|0 with
0(−1)//LP ) ×Gm

the dual V ∗
ωOE (2)|0 with V ∗

P //LP . We therefore obtain

Proposition 14. Assume that θP is principal. Then there is the following commu-
tative diagram

p(2)⊥

−−−−→ V ∗
P

y

Hitch(D)p(2) −−−−→ V ∗

P //LP ,

y

y

with all arrows surjective.

Remark 3.4. We will not make use of this remark. One should compare the above
proposition with the following commutative diagram, which holds for any p,

p(1)⊥

−−−−→ (Lie LP )∗ ≃ p(1)⊥/p(0)⊥

y

Hitch(D)RS −−−−→ (c∗

O ×Gm ωO(1)×)|0.

Note that the bottom arrow in the diagram is the classical limit of the residue map
studied in [BD2, FGa].

4. Endomorphisms of some vacuum modules

We continue to ﬁx a point x ∈ X, and for simplicity write Fx by F , etc.

4.1. Endomorphisms of some vacuum modules. Let us quantize the picture
discussed in the previous section. As in § 1.3, we restrict to the case when g is a
split Lie algebra. Without loss of generality we can assume that g = g0 ⊗k F . Also
we denote by ˆgc the critical central extension of g as in § 1.3, and let ˆUc(g) be the
corresponding completed universal enveloping algebra.

Let P ⊂ G(F ) be a parahoric subgroup and P = P (0) ✄ P (1) ✄ P (2) ✄ · · · be the
corresponding Moy-Prasad ﬁltration. As P (n) for n > 0 is a pro-unipotent group,

we have a natural splitting dp(n) = p(n) ⊕ C1, where dp(n) denotes the preimage of

p(n) in ˆgc.

Now for n > 0, we deﬁne

(4.1)

Vacp(n) = Indˆgc

p(n)⊕C1(C),

where p(n) acts trivially on C and 1 acts as the identity.

Let Z be the center of ˆUc(g) endowed with the natural ﬁltration. By [BD2,

Theorem 3.7.8], the natural map

(4.2)

is an isomorphism.

gr Z → Fun Hitch(D×)

We write

Z → Zp(n) ֒→ EndVacp(n) ≃ VacP (n)

p(n) ⊂ Vacp(n).

All the maps are strictly compatible with the ﬁltrations so that taking the associated
graded gives

Fun Hitch(D×) ։ Fun Hitch(D)p(i) ⊂ Fun(p(i)⊥).

As

Vacp(2) = Indˆgc

p(2)+C1

C = Indˆgc

p(1)+C1 U (VP ),

18

XINWEN ZHU

we obtain an injective algebra homomorphism

U (VP ) ≃ Endp(1)U (VP ) ⊂ End(Vacp(2)).

Proposition 15. Assume that θP is principal. Then there is the following natural
commutative diagram

U (VP )LP −−−−→

Zp(2)

U (VP ) −−−−→ End(Vacp(2))

y

y

In fact, Zp(2) ∩ U (VP ) = U (VP )LP .

Proof. Let W be the intersection of Zp(2) and U (VP ) inside End(Vacp(2)). Under the
following natural maps,

End(Vacp(2)) ≃ Vacp(2)

p(2) ⊂ Vacp(2),

the subalgebra Zp(2) ⊂ End(Vacp(2)) is in fact contained in VacP
p(2) ⊂ Vacp(2), and
U (VP ) is just the subspace in Vacp(2) generated from the vacuum vector by p(1).
Therefore W is contained in U (VP )LP = U (VP ) ∩ VacP
p(2). The ﬁltrations on all
the above spaces are induced from the natural ﬁltration on ˆUc(g). Therefore gr W
is the intersection of gr Zp(2) = Fun Hitch(D)p(2) and gr U (VP ) = Fun(V ∗
P ) inside
gr Vacp(2) = Fun p(2)⊥. Therefore by Proposition 14, we have inclusions

(Fun V ∗

P )LP ⊂ gr W ⊂ gr(U (VP )LP ) ⊂ (Fun V ∗

P )LP .

Clearly, the composition of these inclusions is just the identity map. Therefore
gr W = gr(U (VP )LP ). Together with W ⊂ U (VP )LP , it implies that W = U (VP )LP .
(cid:3)

Remark 4.1. (i) In the case when P is an Iwahori subgroup, T.-H. Chen (private
communication) proved this proposition by a diﬀerent (and more direct) argument.
He then in turn deduced Proposition 14 from it in this case.

(ii) It is easy to see that the subalgebras U (VP ) and Zp(2) in End(Vacp(2)) commute

with each other, and therefore induces a map

U (VP ) ⊗U (VP )LP Zp(2) → End(Vacp(2)).

This is probably an isomorphism.

4.2. Endomorphism algebras and opers. Recall that we denote by Lg the Lang-
lands dual Lie algebra of g, equipped with a Borel subalgebra Lb. As we assume
that g is split, LVg = VLg and we will following [BD2] to use the later notation in this
subsection. Recall that there is a natural VLg ⊗ωF -torsor structure on OpLg(D×) (cf.
[BD2, 3.1.9]), which induces a natural ﬁltration on ALg(D×) (cf.
[BD2, § 3.1.13])
with a canonical isomorphism

gr ALg(D×) ≃ Fun VLg ⊗ ωF ≃ Fun cLg ×Gm ω×

F = Fun Hitch(D×).
One of the properties of the Feigin-Frenkel isomorphism (1.2) is that it is compat-
ible with the ﬁltration such that the associated graded gives (4.2). Then we may
regard Spec Zp(n) =: OpLg(D)p(n) as a closed subscheme of OpLg(D×), which we now
describe for n = 2.

F ≃ Fun c∗ ×Gm ω×

FRENKEL-GROSS’ IRREGULAR CONNECTION AND HEINLOTH-NG ˆO-YUN’S ARE THE SAME19

Let OpLg(D) be the scheme (of inﬁnite type) of Lg-opers on D. As before, it has
a natural VLg ⊗ωO-torsor structure. We have the natural inclusions of pro-unipotent
groups

VLg ⊗ ωO ⊂M ωdi

O (di +(cid:22) di

m(cid:23)) ⊗ VLg,di.
O (di + j di

Then

mk) ⊗ VLg,di)-torsor

Lemma 16. The scheme OpLg(D)p(2) is the (Li ωdi

induced from the VLg ⊗ ωO-torsor OpLg(D).
Proof. Let us temporarily denote by OpLg(D)′
p(2) this induced torsor. Since OpLg(D×)
is also induced from OpLg(D) via VLg ⊗ ωO ⊂ VLg ⊗ ωF , OpLg(D)′
p(2) is a closed
subscheme of OpLg(D×) and the ﬁltration on Fun OpLg(D)′
p(2) is the quotient ﬁl-
tration on ALg(D×). Therefore, it is enough to show that the associated graded of
Fun OpLg(D)′
p(2) and of Fun OpLg(D)p(2) coincide in Hitch(D×), which is clear. (cid:3)
More explicitly, we can describe OpLg(D)p(2) as follows. We ﬁx a uniformizer
t ∈ F , and a principal sl2-triple {e, h, f } of Lg with e ∈ Lb, then it is well-known
(e.g. [BD2, § 3.5.6] or [Fr, § 4.2.4]) that OpLg(D×) can be identiﬁed with
(4.3) {∇ = d + (f + u)dt | u ∈ Lb(F )}/LU (F ) ≃ {∇ = d + (f + v)dt | v ∈ VLg ⊗ F },
where LU is the unipotent radical of the LB. Then OpLg(D)p(2) is the subspace of
operators as above such that

(4.4)

v ∈Mi

O (di +(cid:22) di

m(cid:23)) ⊗ VLg,di.

ωdi

Remark 4.2. There is the notion of the slope of a Lg-local system on the punctured
disc D× (e.g. [FGr, § 5] or [CK, § 2]). It is not hard to see that OpLg(D)p(2) is the
(reduced) subscheme of OpLg(D×) such that the underlying local system has slope
≤ 1

m . We do not use this fact in the sequel.

5. Proof of a conjecture in [HNY]

Now we specialize the group scheme G over X = P1. Let G0 be a simple, simply-
connected complex Lie group, of rank ℓ. Let us ﬁx B0 ⊂ G0 a Borel subgroup
an opposite Borel subgroup. The unipotent radical of B0 (resp. Bopp
and Bopp
)
is denoted by U0 (resp. U opp
). Following [HNY], we denote by G(0, 1) the group
scheme on P1 obtained from the dilatation of the constant group scheme G0 × P1
along Bopp

0 × {0} ⊂ G0 × {0} and along U0 × {∞} ⊂ G0 × {∞}. Explicitly,

0

0

0

G(0, 1)(O0) = ev−1

0 (Bopp

0

), G(0, 1)(O∞) = ev−1

∞ (U0),

where ev0 : G0(O0) → G0 (resp. ev∞ : G0(O∞) → G0) is the evaluation map.
Following loc. cit., we denote I(1) = G(0, 1)(O∞).

Let G(0, 2) → G(0, 1) be the dilatation of G(0, 1) at ∞, such that it is an isomor-

phism away from ∞, and that at ∞ it induces

G(0, 2)(O∞) = I(2) := [I(1), I(1)] ⊂ I(1) = G(0, 1)(O∞).

To simplify notations, in the sequel, G(0, 1) is denoted by G′ and G(0, 2) is denoted
by G.

Note that we can apply all the results in § 3 to the standard Iwahori subgroup
I = I(0) ⊂ G(F∞). Following notations in that section, let V = VI = I(1)/I(2),

20

XINWEN ZHU

which is isomorphic to Qℓ

i=0 Uαi, where αi are simple aﬃne roots, and Uαi are
the corresponding aﬃne root groups. We identify V with its Lie algebra via the
exponential map as explained before. Let T = LI = I(0)/I(1), which is the Cartan
torus acting on V by conjugation.

As explained in loc. cit., there is an open substack ∗ ⊂ BunG ′ corresponding to
trivializable G′-torsors. Its pre-image in BunG is isomorphic to V , denoted by ˚BunG.

Lemma 17. The stack BunG is good in the sense of [BD2, § 1.1.1].

Proof. Since BunG is a principal bundle over BunG ′ under the group V , it is enough
to show that BunG ′ is good. But this follows from the fact that BunG ′ has a stratiﬁ-
cation by elements in the aﬃne Weyl group of G such that the stratum corresponding
to w has codimension ℓ(w) and the stabilizer group has dimension ℓ(w).

Indeed, by [HNY, Proposition 1],

BunG ′ = G′

out\GrG ′,0,

out = G′(P1 \ {0}) is the ind-group representing sections of G′ over P1 \ {0}.
where G′
By [HNY, Corollary 3], dim BunG ′ = 0. Note that GrG ′,0 is just the usual aﬃne ﬂag
variety for G0(F0). By [Fa, Theorem 7], for every w in the aﬃne Weyl group Waﬀ,
the double quotient

Cw := G′

out\G′

out

· w · G′(O0)/G′(O0)

is represented by an Artin stack, locally closed in BunG ′. In addition, dim Cw =
−ℓ(w). This proves the claimed fact.
(cid:3)

Remark 5.1. Again, according to [Fa, Theorem 7], the closure C s of Cs for a simple
reﬂection s is a divisor on BunG ′. Together with the calculation in [Zh1, § 4.1], we
see twice of the sum of all these divisors gives the line bundle ω−1
BunG′ . In particular,
the square root ω1/2
is isomorphic to
ω1/2
BunG

BunG′ exists. Note that the pullback of ω1/2
BunG′
is canonically trivialized over ˚BunG .

, and therefore ω1/2
BunG

Now we consider the Hitchin map

hcl : T ∗BunG → Hitch(X)G ⊂ Hitch(U ).

Applying results in § 3 and the similar argument of Lemma 5, it is easy to calculate
Hitch(X)G in this case

Mi<ℓ

Γ(X, ωdi

X ((di − 1)·0+ di ·∞)⊗ Vg0,diM Γ(X, ωdℓ

X ((dℓ − 1)·0+ (dℓ + 1)·∞)⊗ Vg0,dℓ,

which is isomorphic to A1.

Let µ : T ∗BunG → V ∗ be the moment map for the action of V on BunG.

Lemma 18. The moment map µ : T ∗BunG → V ∗ is ﬂat.

Proof. Consider the Hamiltonian reduction µ−1(0)/V ≃ T ∗BunG ′. By the proof
of Lemma 17, BunG ′ is good, so T ∗BunG ′ is of dimension zero. This implies that
dim µ−1(0) = dim V . Therefore, µ is ﬂat.
(cid:3)

We also need a global version of Proposition 14 in this case.

y

y

y

y

FRENKEL-GROSS’ IRREGULAR CONNECTION AND HEINLOTH-NG ˆO-YUN’S ARE THE SAME21

Lemma 19. There is the following commutative diagram, with all arrows surjective.

T ∗BunG

µ

−−−−→ V ∗

Hitch(X)G −−−−→ V ∗//T.

In addition, the bottom arrow is an isomorphism.

Proof. By restricting to the formal neighbourhood of ∞, the global Hitchin map
embeds into the local Hitchin map, and therefore Proposition 14 gives the commu-
tative diagram. To see the bottom arrow is an isomorphism, it is enough to observe
that in our special case the composition

Hitch(X)G → Hitch(D)p(2) →Mdi|m

ωdi

O (di+

di
m

)/ωdi

O (di+

di
m

−1)⊗LVg,di = ωdℓ

O (dℓ+1)/ωdℓ

O (dℓ)

is an isomorphism.

(cid:3)

Remark 5.2. The above discussions can be generalized. Namely, given any simple,
simply-connected group G over C((t)) and a parahoric subgroup P ⊂ G(C((t))),
one can construct the corresponding group scheme G = G(0, 2)P over P1, unramiﬁed
over P1 \ {0, ∞}, and G(O0) ≃ P opp and G(O∞) = P (2), generalizing G(0, 2). Then
Lemma 17 and 18 generalize in this case. In addition, if θP is principal, Lemma 19
generalizes as well, i.e. we have

T ∗BunG

µ

−−−−→ V ∗
P

Hitch(X)G −−−−→ V ∗

P //LP .

To prove this, applying Proposition 10, we conclude that Hitch(X)G → V ∗
is a closed embedding. But T ∗BunG → V ∗
Hitch(X)G ≃ V ∗

P //LP
P //LP is clearly surjective, so

P //LP if θP is principal.

P → V ∗

Now we quantize the above picture. Let us describe OpLg(X)G in this case.
At 0 ∈ P1, K0 = G(O0) = I opp := ev−1

0 (Bopp). We use the inclusion K0 ⊂ G0(O0)
to split ˆk0 ≃ k0 ⊕ C1 (see Remark 1.1 for the subtlety). Then Lemma 4 specializes
to

ˆgc,0
Lie I opp+C1(Cρ),
which is just the Verma module Mopp
for I opp. Here ρ is half sum of roots of B, so
is anti-dominant w.r.t. Bopp. It is known ([FGa, Corollary 13.3.2] or [Fr, Theorem
9.5.3]) that Fun OpLg(D×

) induces an isomorphism

Vac0 = Ind

ρ

0 ) → End(Mopp
Fun OpLg(D0)̟(0) ≃ End(Mopp

ρ

ρ

),

where OpLg(D0)̟(0) is the scheme of Lg opers on D0 with regular singularities and
residue ̟(0). In fact, in loc. cit., this is proved for the Verma module M−ρ of I.
But if we choose an element ˜w0 ∈ G(C), conjugation by which switches B and Bopp,
and deﬁne the new action of ˆgc,0 on M−ρ by X · v = Ad ˜w0(X)v, then the resulting
module M ˜w0
. Therefore the central supports of M−ρ and
Mopp

−ρ is isomorphic to Mopp

ρ
We refer to [FGa, § 2] for the precise deﬁnition of OpLg(D0)̟(0) as a moduli
scheme. Here, we describe this space in concrete terms following the style as in § 4.

coincide.

ρ

22

XINWEN ZHU

Let {e, h, f } be a principal sl2-triple as with with e ∈ Lb. Then after choosing a
uniformizer t of the disc D0, OpLg(D0)̟(0) is the space of operators

(5.1)

{∂t +

f
t

+ Lge ⊗ O0}.

Indeed, it is known from [Fr, § 9.1] that the space of opers with regularities can be
identiﬁed with the space of operators of the form

{∂t +

1
t

(f + Lb ⊗ O0)}/LU (O0) ≃ {∂t +

1
t

(f + Lge ⊗ O0)}.

The condition of the residue cuts out the subspace (5.1). It is also explained in loc.
cit. that after a gauge transformation, (5.1) embeds into (4.3) as a closed subscheme.

At ∞ ∈ P1, K∞ = G(0, 2)(O∞) = I(2), so

Vac∞ = Vacp(2),

as introduced in § 4. As in this case p is the Iwahori subalgebra so m = h is
the Coxeter number, we also write OpLg(D)p(2) as deﬁned in § 4 by OpLg(D∞)1/h.
Choose a uniformizer t ∈ F∞. Recall from (4.3) and (4.4) that OpLg(D∞)1/h ⊂
OpLg(D×

∞) is the space of operators of the form

∂t + f +Xi<ℓ

t−diVLg,di ⊗ O∞ + t−dℓ−1VLg,dℓ ⊗ O∞.

After a gauge transformation, this space is identiﬁed with

{∂t +

f
t

+

1
t

Lb ⊗ O∞ +

1
t2

Lgθ ⊗ O∞}/LU (O∞),

where Lgθ is the root subspace for the highest root θ of Lg (with respect to Lb).

Therefore, by Lemma 5, OpLg(X)G is isomorphic to

OpLg(X)(0,̟(0)),(∞,1/h) := OpLg(D∞)1/h×OpL g
As observed in [FGr, § 5],

(D×

∞)OpLg(Gm)×OpL g

(D×

0 )OpLg(D0)̟(0).

Lemma 20. There is a (non-canonical) isomorphism OpLg(X)(0,̟(0)),(∞,1/h) ≃ A1.

Proof. Indeed, any LB-torsor on Gm is trivial. If we ﬁx the sl2-triple {e, h, f } as
above, then after choosing a coordinate z on Gm, the space of opers on Gm is the
space of operators of the form

∇ = ∂z +

f
z

+ v,

where v(z) ∈ Lge[z, z−1]. The condition at 0 implies that v(z) ∈ Lge[z]. At the ∞,
the local coordinate is t = 1/z so such an operator becomes

∇ = ∂t +

f
t

+

1
t2 v(

1
t

).

The condition at ∞ then implies that v ∈ Lgθ is constant. Choosing a root vector
eθ ∈ Lgθ, Then the space OpLg(X)(0,̟(0)),(∞,1/h) is the space of opers of the form

f
z
with a ∈ C. So it is isomorphic to Spec C[a].

∇ = ∂z +

+ aeθ,

Now combining Proposition 15 and Lemma 19 we obtain

(cid:3)

FRENKEL-GROSS’ IRREGULAR CONNECTION AND HEINLOTH-NG ˆO-YUN’S ARE THE SAME23

Lemma 21. The following diagram is commutative.

U (V )T

≃−−−−→ Fun OpLg(X)(0,̟(0)),(∞,1/h)

y

U (V ) −−−−→

Γ(BunG, D′).

yh∇

Now we can apply Corollary 9, where A is replaced by U (V ) in the current
situation. Given χ ∈ Spec U (V ), corresponding to the character ϕχ : U (V ) → C,
the point π(χ) on OpLg(X)(0,̟(0)),(∞,1/h) then can be represented by the trivial
LB-torsor on Gm with the connection given by

(5.2)

∇ = ∂z +

f
z

+ ϕχ(g)eθ,

where g ∈ U (V )T is the generator of this algebra corresponding to a under the
isomorphism U (V )T ≃ Fun OpLg(X)(0,̟(0)),(∞,1/h), and
⊗ (D′ ⊗U (V ),ϕχ

AutE = ω−1/2
BunG

C)

is a Hecke-eigensheaf for this connection E. Note that since µ−1(0) is a Lagrangian,
AutE is holonomic.

We specialize to the case when the character ϕχ : U (V ) → C is induced by an
additive character Ψ : V → Ga. We use LΨ to denote the pullback via Ψ of the
exponential D-module on Ga, which is a rank one local system on V . Since the
map U (V ) → Γ(BunG, D′) geometrically comes from the action of V on BunG, AutE
is in fact (V, LΨ)-equivariant on BunG. Let ˚BunG ⊂ BunG be the open substack
introduced before Lemma 17, on which V acts simply-transitively. Since ω−1/2
is
BunG
canonically trivialized over this open substack (Remark 5.1), the restriction of AutE
to ˚BunG is just LΨ.

We further specialize to the case when Ψ is generic (see [HNY, § 1.3] for the
meaning). Then as argued in [HNY, Lemma 2.3] (which works in the D-module
sitting without change), any (V, LΨ)-equivariant holonomic D-module supported on
BunG \ ˚BunG is zero (in fact, holonomicity is unnecessary for this statement). There-
fore, AutE is isomorphic to the immediate (in fact, clean) extension of AutE | ˚BunG
.
As the Kloosterman D-module constructed in [HNY] is the eigenvalue of AutE , it
coincides with the connection (5.2). On the other hand, Ψ is generic if and only
if the induced character ϕχ : U (V ) → C takes non-zero value on g. Therefore the
connection (5.2) for generic Ψ also coincides with the one constructed in [FGr]. We
are done.

Remark 5.3. Note that even Ψ is non-generic, AutE is still a Hecke eigensheaf, but
for a tame local system on Gm (since in this case ϕχ(g) = 0). However, in this case
it is not easy to express AutE as an extension of the local system on ˚BunG by sheaf
theoretical operations.

References

[BD1] Beilinson, A., Drinfeld, V.: Chiral Algebras, American Mathematical Society Colloquium

Publications 51. Providence, RI: American Mathematical Society, 2004.

[BD2] Beilinson, A., Drinfeld, V.: Quantization of Hitchin’s integrable system and Hecke eigen-

sheaves, www.math.uchicago.edu/~mitya/langlands.

[Ch] Chen, T.-H.: Vinberg’s θ-groups and rigid connection, http://arxiv.org/abs/1409.3517.
[CK] Chen, T.-H., Kamgarpour, M.: Preservation of depth in local geometric Langlands correspon-

dence, to appear in Transactions of the AMS.

24

XINWEN ZHU

[Fa] Faltings, G.: Algebraic loop groups and moduli spaces of bundles, J. Eur. Math. Soc., 5, 41-68

(2003).

[Fr] Frenkel, E.: Langlands correspondence for loop groups, Cambridge University Press, 2007.
[FB] Frenkel, E., Ben-Zvi, D.: Vertex Algebras and Algebraic Curves, 2nd ed. Mathematical Surveys

and Monographs 88. Providence, RI: AMS, 2004.

[FGa] Frenkel, E., Gaitsgory, D.: Local geometric Langlands correspondence and aﬃne Kac-Moody
algebras, Algebraic Geometry and Number Theory, Progress in Mathematics 253, 2006, pp
69-260.

[FGr] Frenkel, E., Gross, B.: A rigid irregular connection on the projective line, Ann. Math., 1469-

1512, Volume 170-3 (2009).

[HNY] Heinloth, J., Ngˆo, B.C., Yun, Z.: Kloosterman sheaves for reductive groups, Ann. Math.,

241-310, Volume 177-1 (2013).

[Ka] Kac, V.: Inﬁnite dimensional Lie algebras, Cambridge University Press, 3 edition, 1994.
[Ng] Ngˆo, B.C.: Le lemme fondamental pour les alg`ebres de Lie, Publ. Math. Inst. Hautes ´Etud.

Sci. No. 111 (2010), 1-169.

[Pa] Panyushev, D. :On invariant theory of θ-groups, Jour. Algebra, 283 (2005), pp. 655-670.
[RY] Reeder, M., Yu, J.-K.: Epipelagic representations and invariant theory, J. Amer. Math. Soc.

27 (2014), 437-477.

[Ro] Rozenblyum, N.: Introduction to chiral algebras, http://math.northwestern.edu/~nrozen.
[Yu] Yun, Z.: Epipelagic representation and rigid local systems, to appear in Selecta Mathematica.
[Zh1] Zhu, X.: On the coherence conjecture of Pappas and Rapoport, Ann. Math. 180, Issue 1,

(2014), pp. 1-85.

[Zh2] Zhu, X.: An introduction to aﬃne Grassmannians and the geometric Satake equivalence,

http://arxiv.org/abs/1603.05593.

Xinwen Zhu: Department of Mathematics, California Institute of Technology,

Pasadena, CA, 91125, USA.

E-mail address: xzhu@caltech.edu

