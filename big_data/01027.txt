6
1
0
2

 
r
a

M
3

 

.

 
 
]
E
P
o
i
b
-
q
[
 
 

1
v
7
2
0
1
0

.

3
0
6
1
:
v
i
X
r
a

A STOCHASTIC MODEL FOR SPECIATION BY MATING

PREFERENCES

CAMILLE CORON, MANON COSTA, H´EL`ENE LEMAN, AND CHARLINE SMADI

Abstract. Mechanisms leading to speciation are a major focus in evolutionary biology.
In this paper, we present and study a stochastic model of population where individuals,
with type a or A, are equivalent from ecological, demographical and spatial points of view,
and diﬀer only by their mating preference: two individuals with the same genotype have a
higher probability to produce a viable oﬀspring. The population is subdivided in several
patches and individuals may migrate between them. We show that mating preferences by
themselves, even if they are very small, are enough to entail reproductive isolation between
patches, and consequently speciation, and we provide the time needed for this isolation to
occur. Our results rely on a ﬁne study of the stochastic process and of its deterministic limit
in large population, which is given by a system of coupled nonlinear diﬀerential equations.
Besides, we propose several generalisations of our model, and prove that our ﬁndings are
robust for those generalisations.

Keywords: birth and death process with competition, mating preference, reproductive isola-
tion, dynamical systems.

AMS subject classiﬁcation: 60J27, 37N25, 92D40.

Introduction

Understanding and modeling speciation mechanisms is a very important stake in ecology.
However, exact causes of speciation are often unknown [33]. Our motivation is to introduce
and study rigorously a stochastic model for speciation by assortative mating. Assortative
mating, or mating preference, is a form of sexual selection in which individuals with sim-
ilar genotypes have a higher reproductive success when they mate among themselves than
individuals with diﬀerent genotypes. As presented in [30, 27], this form of selection plays
a very important role in speciation. We are interested in the particular case of sympatric
speciation which is the process through which new species evolve from a single ancestral
species while sharing the same space and resources. In this case, it has been observed that
”non-random mating is a prerequisite for evolutionary branching” [12]. What is more, bio-
logical examples of speciation that involve well studied mechanisms of sexual selection are
numerous [29, 34, 26, 4, 32]. However, as raised by recent reviews on speciation [15, 19],
mathematical models allowing to theoretically account for this phenomenon are still needed,
and existing models are studied using numerical simulations: for instance in [23] and [27], the
authors obtain speciation scenarios under strong mating preference and constant population
size hypotheses, and for reduced range of parameters; in [36] the authors get speciation by
combining sexual and ecological selection; or in [14, 12] in addition to assortative mating,
individuals vary in their ability to consume the resource.

In this paper, we consider a population of haploid individuals characterized by their geno-
type at one multi-allelic locus, and by their position on a space that is divided in several
patches. This population is modeled by a multi-type birth and death process with competi-
tion, which is ecologically neutral in the sense that individuals with diﬀerent genotypes are
not characterized by diﬀerent adaptations to environment or by diﬀerent resource prefer-
ences. However, individuals reproduce sexually according to mating preferences that depend

1

2

CAMILLE CORON, MANON COSTA, H´EL`ENE LEMAN, AND CHARLINE SMADI

on their genotype: two individuals having the same genotype have a higher probability of
mating success. Besides, individuals can migrate from one patch to another, at a rate de-
pending on the number of individuals carrying the other genotype and living in the same
patch. Such stochastic individual-based models with competition and varying population
size have been introduced in [3, 13] and made rigorous in a probabilistic setting in the semi-
nal paper of Fournier and M´el´eard [17]. Then they have been studied notably in [5, 6, 11, 25].
Initially restricted to asexual populations, such models have evolved to incorporate the case
of sexual reproduction, in both haploid [35] and diploid [9, 10] populations. To our knowl-
edge, there exist few individual-based models that take into account a component of sexual
preference. In [31] the authors considered both random and assortative mating in a pheno-
typically structured population. The main diﬀerence with our approach is that we consider
assortative mating for ecologically equivalent populations.

We study both the stochastic individual-based model and its deterministic limit in large
population. We give a complete description of the equilibria of the limiting deterministic
dynamical system, and prove that the stable equilibria are the ones where only one genotype
survives in each patch. We use classical arguments based on Lyapunov functions ([24, 7]) to
derive the convergence at exponential speed of the solution to one of the stable equilibria,
depending on the initial condition. Our theoretical results hold for small migration rates
but we conjecture using simulations that they hold for all the possible migration rates. This
ﬁne study of the large population limit is essential to derive the behavior of the stochastic
process. Using coupling techniques with branching processes, we derive bounds for the time
needed for speciation to occur in the stochastic process. These bounds are explicit functions
of the individual birth rate and the mating preference parameter. Besides, we propose several
generalisations of our model, and prove that our ﬁndings are robust for those generalisations.
In Section 1 we describe the model and
present the main results. In Sections 2 and 3 we state properties of the deterministic limit
and of the stochastic population process, respectively. They are key tools in the proofs of
the main results, which are then completed. In Section 4 we illustrate our ﬁndings and make
conjecture on a more general result with the help of numerical simulations. Section 5 is
devoted to some generalisations of the model. Finally, we state in the Appendix technical
results needed in the proofs.

The structure of the paper is the following.

1. Model and main results

We consider a sexual haploid population with Mendelian reproduction ([20], chap. 3).
Each individual carries an allele belonging to the genetic type space A := {A, a}, and lives
in a patch i in I = {1, 2}. We denote by E = A × I the type space, by (eα,i, (α, i) ∈ E) the
canonical basis of RE , and by ¯α the complement of α in A. The population is modeled by a
multi-type birth and death process with values in NE . More precisely, if we denote by nα,i
the current number of α-individuals in the patch i and by n = (nα,i, (α, i) ∈ E) the current
state of the population, then the birth rate of an α-individual in the patch i writes
(1.1)

nα,i

nα,i + n ¯α,i

+

1
2

nα,i

n ¯α,i

nα,i + n ¯α,i

+

1
2

n ¯α,i

nα,i

nα,i + n ¯α,i

= bnα,i

βnα,i + n ¯α,i
nα,i + n ¯α,i

.

(cid:18)

λα,i(n) = b

nα,iβ

(cid:19)

The parameter b > 0 scales the individual birth rate while the parameter β > 1 represents
the ”mating preference” and can be interpreted as follows: two mating individuals have a
probability β times larger to give birth to a viable oﬀspring if they carry the same allele α.
This modeling of mating preferences (that are directly determined by the genome of each
individual) is biologically relevant, considering [22] or [21] for instance. In the same way, the

SPECIATION BY MATING PREFERENCES

3

death rate of α-individuals in the patch i writes

(1.2)

dK
α,i(n) =

(nα,i + n ¯α,i)

nα,i,

(cid:16)

d +

c
K

(cid:17)

where K is an integer accounting for the quantity of available resources or space. This
parameter is related to the concept of carrying capacity, which is the maximum population
size that the environment can sustain indeﬁnitely, and is consequently a scaling parameter
for the size of the community. The individual intrinsic death rate d is assumed to be non
negative and less than b:

(1.3)

0 ≤ d < b.

The death rate deﬁnition (1.2) implies that all the individuals are ecologically equivalent: the
competition pressure does not depend on the alleles α and α(cid:48) carried by the two individuals
involved in an event of competition for food or space. The competition intensity is denoted
by c > 0. Last, the migration of α-individuals from patch ¯i = I \ {i} to patch i occurs at a
rate

(cid:18)

(cid:19)

(1.4)

ρα,¯i→i(n) = p

1 −

nα,¯i

nα,¯i + n ¯α,¯i

nα,¯i = p

nα,¯in ¯α,¯i

nα,¯i + n ¯α,¯i

,

(see Figure 1). The individual migration rate of α-individuals is proportional to the fre-

Figure 1. Migrations of A- and a-individuals between the patches.

quency of ¯α-individuals in the patch.
It reﬂects the fact that individuals prefer being in
an environment with a majority of individuals of their own type. In particular, if all the
individuals living in a patch are of the same type, there is no more migration outside this
patch. Remark that the migration rate from patch ¯i to i is equal for α- and ¯α-individuals,
hence to simplify notation, we denote

ρ¯i→i(n) = ρα,¯i→i(n) = ρ ¯α,¯i→i(n).

The community is therefore represented at all time t ≥ 0 by a stochastic process with

Extensions of this model are presented and studied in Section 5.
values in RE :

whose transitions are, for n ∈ NE and (α, i) ∈ E:

(NK(t), t ≥ 0) = (N K

α,i(t), (α, i) ∈ E, t ≥ 0),

n −→ n + eα,i
at rate λα,i(n),
−→ n − eα,i
at rate dK
α,i(n),
−→ n + eα,i − eα,¯i at rate ρ¯i→i(n).

4

CAMILLE CORON, MANON COSTA, H´EL`ENE LEMAN, AND CHARLINE SMADI

As originally done by Fournier and M´el´eard [17], it is convenient to represent a trajectory
of the process NK as the unique solution of a system of stochastic diﬀerential equations
driven by Poisson point measures. We introduce twelve independent Poisson point measures
(Rα,i, Mα,i, Dα,i, (α, i) ∈ E) on R2
+ with intensity ds dθ. These measures represent respec-
tively the birth, migration and death events in the population N K
α,i. We obtain for every
t ≥ 0,

(cid:88)

(α,i)∈E

(cid:90) ∞
(cid:104)(cid:90) t
(cid:90) t
(cid:90) ∞
(cid:90) ∞
(cid:90) t

−

0

0

0

0

+

0

0

eα,i1{θ≤λα,i(NK (s−))}Rα,i(ds, dθ)

α,i(NK (s−))}Dα,i(ds, dθ)

eα,i1{θ≤dK
(eα,¯i − eα,i)1{θ≤ρ¯i→i(NK (s−))}Mα,i(ds, dθ)

(cid:105)

.

NK(t) = NK(0) +

(1.5)

In the sequel, we will assume that the initial population sizes (N K
order K. As a consequence, we consider a rescaled stochastic process

α,i(0), (α, i) ∈ E) are of

(ZK(t), t ≥ 0) = (ZK

α,i(t), (α, i) ∈ E, t ≥ 0) =

, t ≥ 0

,

(cid:18) NK(t)

K

(cid:19)



which will be comparable to a solution of the dynamical system
− d − c(zA,1 + za,1) − p
− d − c(zA,1 + za,1) − p
− d − c(zA,2 + za,2) − p
− d − c(zA,2 + za,2) − p

d
dt zA,1(t) = zA,1
d
dt za,1(t) = za,1
d
dt zA,2(t) = zA,2
d
dt za,2(t) = za,2

b βzA,1+za,1
zA,1+za,1
b βza,1+zA,1
zA,1+za,1
b βzA,2+za,2
zA,2+za,2
b βza,2+zA,2
zA,2+za,2

(1.6)

za,1

zA,1+za,1

zA,1

zA,1+za,1

za,2

zA,2+za,2

zA,2

zA,2+za,2

+ p zA,2za,2
zA,2+za,2
+ p zA,2za,2
zA,2+za,2
+ p zA,1za,1
zA,1+za,1
+ p zA,1za,1
.
zA,1+za,1

(cid:104)
(cid:104)
(cid:104)
(cid:104)

(cid:105)
(cid:105)
(cid:105)
(cid:105)

More precisely, let us denote by

(z(z0)(t), t ≥ 0) = (z(z0)

α,i (t), (α, i) ∈ E)t≥0

the unique solution to (1.6) starting from z(0) = z0 ∈ RE
+. The uniqueness derives from the
fact that the vector ﬁeld is locally lipschitz and that the solutions do not explode [7]. We
have the following classical approximation result which will be proven in Appendix A:
Lemma 1.1. Let T be in R∗
probability when K goes to inﬁnity to a deterministic vector z0 ∈ RE

+. Assume that the sequence (ZK(0), K ≥ 1) converges in

+. Then

(1.7)
where (cid:107).(cid:107) denotes the L∞-Norm on RE .

K→∞ sup
lim
s≤T

(cid:107)ZK(s) − z(z0)(s)(cid:107) = 0

in probability,

When K is large, this convergence result allows one to derive the global behaviour of the
population process NK from the behaviour of the diﬀerential system (1.6). Therefore, a ﬁne
study of (1.6) is needed. To this aim, let us introduce the parameter

(1.8)

ζ :=

βb − d

,

c

which corresponds to the equilibrium of the α-population size for the dynamical system (1.6),
in a patch with no ¯α-individuals and no migration. Let us also deﬁne the parameters

b2(β2 − 1) + 2p(b − d) − 2bd(β − 1)

4c(b(β − 1) + p)

and ∆ := ζ

ζ − 2p

b(β − 1) + p

> 0

(cid:32)

(cid:33)

(cid:101)ζ

(1.9) (cid:101)ζ :=

SPECIATION BY MATING PREFERENCES

5

(see (2.7) for the positivity of ∆). We derive in Section 2 the following properties of the
dynamical system (1.6):

Theorem 1.

(i) The dynamical system (1.6) has the following non-null and non-negative

equilibria:

• Equilibria for which only one type remains, in only one patch

(ζ, 0, 0, 0)

(0, ζ, 0, 0)

(0, 0, ζ, 0)

(0, 0, 0, ζ)

• Equilibria for which each type is present in exactly one patch

• Equilibria for which only one type remains present, in both patches

(ζ, 0, 0, ζ),

(0, ζ, ζ, 0)

• Equilibria with both types remaining in both patches

(ζ, 0, ζ, 0),

(0, ζ, 0, ζ)

b(β + 1) − 2d

b(β + 1) − 2d

b(β + 1) − 2d

,

(cid:18) b(β + 1) − 2d
(cid:16) ζ +
(cid:16)(cid:101)ζ,(cid:101)ζ,

2
ζ +
2

4c
√

∆

ζ − √
,
√

2

4c

(cid:17)
,(cid:101)ζ,(cid:101)ζ
(cid:17)
ζ − √

∆

∆

∆

,

,

,

2

,

4c

(cid:16) ζ − √
(cid:16)(cid:101)ζ,(cid:101)ζ,

2

,

√

∆

,

ζ − √

∆

ζ +
2
ζ +
2

∆

,

2

4c

(cid:17)
,(cid:101)ζ,(cid:101)ζ
(cid:17)

√

∆

,

.

(cid:19)

(1.10)

(1.11)

(1.12)

(1.13)

(1.14)

(1.15)

(ii) The only stable equilibria of the dynamical system (1.6) are those deﬁned in Equation
(1.11), for which each of the two alleles is present in exactly one patch, and those
given in Equation (1.12) for which only one type remains.

The equilibria (1.11) and (1.12) correspond to the case where reproductive isolation oc-
curs since the gene ﬂow between the two patches ends to be null. Recall that we assumed
assortative mating, that is to say β > 1.
If β = 1, the dynamics of the solutions are
completely diﬀerent. In particular depending on the initial condition, the solution will con-
verge to diﬀerent equilibria with a nonzero migration rate, that is without reproductive
In this case, the equilibria of the system which lay in D are exactly the line
isolation.
L = {u(x) = (ζ − x, x, x, ζ − x), x ∈ [0, ζ/2)}. For any x ∈ [0, ζ], the Jacobian matrix at the
equilibrium u(x) admits 0 as an eigenvalue (associated with the eigenvector (1,−1,−1, 1),
direction of the line L) and three negative eigenvalues. The following Proposition states that
for each x, we can construct particular trajectories of the system which converge to u(x).
Proposition 1.1. Let us introduce for any w ∈ (0, +∞) and x ∈ [0, w] the vector

v(w, x) = (w − x, x, x, w − x).

The solution z(v(w,x)) of the system (1.6) with β = 1 such that z(v(w,x))(0) = (w−x, x, x, w−x)
converges when t → ∞ to the equilibrium u(ζx/w).

In particular, the equilibria (1.11) are not asymptotically stable since solutions starting

in any neighborhood of (1.11) can converge to diﬀerent equilibria.

As a consequence, we assume β > 1 in the sequel. The following theorem gives the long-
time convergence of the dynamical system (1.6) toward a stable equilibrium of interest, when
starting from an explicit subset of RE
+. To state this latter, we need to deﬁne the subset of
RE

+

(1.16)

D := {z ∈ RE

+, zA,1 − za,1 > 0, za,2 − zA,2 > 0},

6

CAMILLE CORON, MANON COSTA, H´EL`ENE LEMAN, AND CHARLINE SMADI

and the positive real number

(1.17)

p0 =

(cid:112)b(β − 1)[b(3β + 1) − 4d] − b(β − 1)

2

.

Notice that under Assumption (1.3) and as β > 1,

p0 < b(β + 1) − 2d.

Finally, for p < b(β + 1) − 2d, we introduce the set
(1.18) Kp :=
z ∈ D, {zA,1 + za,1, zA,2 + za,2} ∈

(cid:26)

(cid:20) b(β + 1) − 2d − p

2c

(cid:21)(cid:27)

.

2bβ − 2d + p

2c

,

Then we have the following result:

Theorem 2. Let p < p0. Then

• Any solution to (1.6) which starts from D converges to the equilibrium (ζ, 0, 0, ζ).
• If the initial condition of (1.6) lies in Kp, there exist two positive constants k1 and

k2, depending on the initial condition, such that for every t ≥ 0,

(cid:107)z(t) − (ζ, 0, 0, ζ)(cid:107) ≤ k1e−k2t.

Symmetrical results hold for the equilibria (0, ζ, ζ, 0), (ζ, 0, ζ, 0) and (0, ζ, 0, ζ).

Notice that the limit reached depends on the genotype which is in the majority in each
patch, since the subset D is invariant under the dynamical system (1.6). Secondly, when
p = 0, the results of Theorem 2 can be proven easily since the two patches are independent
from each other. The diﬃculty is thus to prove the result when p > 0. Our argument allows
us to deduce an explicit constant p0 under which we have convergence to an equilibrium
with reproductive isolation between patches. However, we are not able to deduce a rigorous
result for all p. Indeed, when p increases, there are more mixing between the two patches
which makes the model diﬃcult to study. Nevertheless simulations in Section 4 suggest that
the result stays true.

Let us now introduce our main result on the probability and the time needed for the

stochastic process NK to reach a neighborhood of the equilibria deﬁned in (1.11).

Theorem 3. Assume that ZK(0) converges in probability to a deterministic vector z0 be-
A,2) (cid:54)= (0, 0). Introduce the following bounded set depending on
longing to D, with (z0
ε > 0:

a,1, z0

Bε := [(ζ − ε)K, (ζ + ε)K] × {0} × {0} × [(ζ − ε)K, (ζ + ε)K].

Then there exist three positive constants ε0, C0 and m, and a positive constant V depending
on (m, ε0) such that if p < p0 and ε ≤ ε0,

(cid:32)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12) T KBε

P

−

1

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12) ≤ C0ε, NK(cid:0)T KBε + t(cid:1) ∈ Bmε ∀t ≤ eV K

(cid:33)

(1.19)
lim
K→∞
where T KB , B ⊂ RE
Symmetrical results hold for the equilibria (0, ζ, ζ, 0), (ζ, 0, ζ, 0) and (0, ζ, 0, ζ).

+ is the hitting time of the set B by the population process NK.

b(β − 1)

log K

= 1,

The assumption on the initial state is necessary to get the lower bound in (1.19). Indeed,
A,2) = (0, 0), the set Bε is reached faster, and thus only the upper bound still holds.
if (z0
a,1, z0
Secondly, observe that the time needed to reach a reproductive isolation is inversely propor-
tional to β − 1 which, as studied previously, suggests that the system behaves diﬀerently for
β = 1. Finally, Theorem 3 gives not only an estimation on the time to reach a neighborhood
of the limit, but also it proves that the dynamics of the population process stays a long time
in the neighborhood of equilibria (1.11) after this time.

SPECIATION BY MATING PREFERENCES

7

2. Studies of the dynamical system

In this section, we study the dynamical system (1.6) in order to prove Theorems 1 and 2.
In the ﬁrst subsection, we are concerned with the equilibria of (1.6) and their local stability
(Theorem 1). In the second subsection, we look more closely at the case where the migration
rate p is lower than p0 and prove the convergence of the solution to (1.6) toward one of the
equilibria with an exponential rate once the trajectory belongs to Kp (Theorem 2).

2.1. Fixed points and stability. First of all, we prove that all nonnegative and non-zero
stationary points of (1.6) are given in Theorem 1. Let us write the four equations deﬁning
equilibria (zA,1, za,1, zA,2, za,2) of the dynamical system (1.6):
za,1

zA,2za,2

(2.1)

zA,1

b

(2.2)

za,1

b

(2.3)

zA,2

b

(2.4)

za,2

b

βzA,1 + za,1
zA,1 + za,1
βza,1 + zA,1
zA,1 + za,1
βzA,2 + za,2
zA,2 + za,2
βza,2 + zA,2
zA,2 + za,2

− d − c(zA,1 + za,1) − p
− d − c(zA,1 + za,1) − p
− d − c(zA,2 + za,2) − p
− d − c(zA,2 + za,2) − p

zA,1 + za,1

zA,1 + za,1

zA,1

za,2

zA,2

zA,2 + za,2

+ p

+ p

+ p

+ p

zA,2 + za,2
zA,2za,2

zA,2 + za,2
zA,1za,1

zA,1 + za,1
zA,1za,1

zA,1 + za,1

= 0,

= 0,

= 0,

= 0.

(cid:104)
(cid:104)
(cid:104)
(cid:104)

(cid:105)
(cid:105)
(cid:105)
(cid:105)

By subtracting (2.1) and (2.2), and (2.3) and (2.4) we get

(zA,i − za,i)

bβ − d − c(zA,i + za,i)

i ∈ I.

Therefore equilibria are deﬁned by the four following cases:

(cid:16)

 zA,1 = za,1

or
zA,1 + za,1 = (bβ − d)/c

and

or
zA,2 + za,2 = (bβ − d)/c.

zA,2 + za,2

= 0,

(cid:17)
 zA,2 = za,2
(cid:105)

(cid:105)

,

.

(cid:105) − 2cX 2,

1st case: zA,1 = za,1 and zA,2 = za,2.
From (2.1) and (2.3) we derive

(cid:104)

zA,1

b

(β + 1)

2

− d − 2czA,1 − p
2

= − zA,2p
2

and

− zA,1p
2

= zA,2

b

(β + 1)

2

− d − 2czA,2 − p
2

(cid:104)

(cid:104)

By summing, we get P (zA,1) = P (zA,2) where P is the polynomial function deﬁned by:

P (X) = X

b

(β + 1)

2

− d − p

whose roots are 0 and

b(β + 1) − 2d − 2p

4c

.

Then, either zA,1 = zA,2 or zA,1 and zA,2 are symmetrical with respect to the maximum of
P which leads to

b(β + 1) − 2d − 2p

zA,1 =

4c

− zA,2.

In the ﬁrst case zA,1 = zA,2, Equation (2.1) implies that either zA,1 = 0, which gives the null
equilibrium or

zA,1 =

b(β + 1) − 2d

,

4c

8

CAMILLE CORON, MANON COSTA, H´EL`ENE LEMAN, AND CHARLINE SMADI

which gives equilibrium (1.13). In the second case, we inject the expression of zA,2 in (2.1)
to obtain that zA,1 satisﬁes:

with A = b(β + 1)/2 − d − p. The discriminant of this degree 2 equation is A(A + 2p).
Therefore, either

−2cX 2 + AX +

p
4c

A = 0,

A +(cid:112)A(A + 2p)
A −(cid:112)A(A + 2p)

4c

4c

A −(cid:112)A(A + 2p)
A +(cid:112)A(A + 2p)

4c

,

.

and zA,2 =

and zA,2 =

or

zA,1 =

zA,1 =

4c

(cid:17)
(cid:17)

,

.

− 1

− 1

However, these equilibria are not positive.
2nd case : zA,1 + za,1 = (bβ − d)/c = ζ = zA,2 + za,2.
As previously, we obtain

and

pzA,1

− 1

= (b(β − 1) + p)zA,2

By summing these equalities, we get Q(zA,1) = Q(zA,2) with

(b(β − 1) + p)zA,1

(cid:16) zA,1

ζ

(cid:17)

Q(X) = X

(cid:16) zA,1

ζ

− 1

(cid:16) X
(cid:16) zA,1

ζ

zA,1

ζ

− 1

ζ

(cid:17)

= pzA,2

(cid:16) zA,2
(cid:16) zA,2
(cid:17)(cid:0)b(β − 1) + 2p(cid:1).
(cid:17)

ζ

− 1

= 0,

Then, either zA,1 = zA,2 and (2.1) gives that

which gives equilibrium (1.12), or zA,1 = ζ − zA,2 which implies zA,1(zA,1/ζ − 1) = 0 and
gives equilibrium (1.11).
3rd case : zA,1 = za,1, and zA,2 + za,2 = (bβ − d)/c = ζ.
Substituting in Equations (2.1) and (2.4) we get that

(cid:104)

2

(cid:104) b

β + 1

zA,1

b

− d − 2czA,1 − p
2

and

2 ) − d − cζ − p
Therefore, since ζ = (bβ − d)/c, these equations become

(βζ + (1 − β)zA

(ζ − zA,2)

ζ

(cid:105)

= 0,

zA,1

2

= 0.

+ p

zA,2(ζ − zA,2)

+ p

ζ

zA,2

(cid:105)
(cid:104) b(1 − β) − p
(cid:105)

ζ

,

ζ

(2.5)

and
(zA,2 − ζ)zA,2

ζ

(cid:110) 2

p

zA,1 =

(zA,2 − ζ)zA,2

2
p

(cid:104)

[b(1 − β) − p]

b

β + 1

2

− d − p
2

− 4c
p

(zA,2 − ζ)zA,2

b(1 − β) − p

ζ

(cid:105) − p

(cid:111)

= 0.

This last equation provides the following possible cases:

• zA,2 = 0, which implies za,2 = ζ, and from (2.5) zA,1 = za,1 = 0 (Equilibrium (1.10)),
• zA,2 = ζ, which implies za,2 = 0, and from (2.5) zA,1 = za,1 = 0 (Equilibrium (1.10)),

SPECIATION BY MATING PREFERENCES

9

• zA,2 solution of
(b(1 − β) − p)

(cid:104)

b

β + 1

2

− d − p
2

− 4c
p

(zA,2 − ζ)zA,2

b(1 − β) − p

ζ

(cid:105) − p2

2

= 0,

which can be summarized as

(2.6)

where

(zA,2 − ζ)zA,2 + C = 0,

(cid:2)b2(β2 − 1) + 2p(b − d) − 2bd(β − 1)(cid:3) .

C =

pζ

8c(b(β − 1) + p)2

The discriminant ∆ of the degree 2 Equation (2.6) was introduced in Equation (1.9).
A simple computation gives the sign of ∆:

∆ = ζ 2 − 4C

= ζ 2 −

pζ

2c(b(β − 1) + p)2

=

ζ

2c(b(β − 1) + p)2

(cid:104)

(cid:2)b2(β2 − 1) + 2p(b − d) − 2bd(β − 1)(cid:3)
(cid:105)

+ 2bp(β − 1)[bβ − d + p] + b2(β − 1)2p

2b2(β − 1)2(bβ − d)

> 0.

(2.7)

ζ − √

Thus (2.6) has two distinct solutions:

√

∆

z+
A,2 =

ζ +
2
Since C > 0, both roots z−
A,2 and z+
We ﬁnally deduce from (2.5) and (2.6) that in both cases zA,2 = z−
then

A,2 are strictly positive.

and z−

A,2 =

> 0

∆

.

2

b2(β2 − 1) + 2p(b − d) − 2bd(β − 1)

zA,1 = za,1 =

4c(b(β − 1) + p)

.

A,2 and zA,2 = z+

A,2

This gives equilibrium (1.14), by symmetry between patches 1 and 2.

The end of this subsection provides a detailed exposition of the stability of ﬁxed points of
(1.6). We consider separately each equilibrium and use symmetries of the dynamical system
between patches 1 and 2 and between alleles A and a.
Equilibrium (1.10): By subtracting (2.2) from (2.1), we obtain:

(2.8)

d
dt

(zA,1 − za,1) = (zA,1 − za,1)

bβ − d − c(zA,1 + za,1)

.

(cid:16)

(cid:17)

0
0
0



This equation provides the asymptotic instability since for this equilibrium, zA,1 + za,1 = 0.

Equilibrium (1.11): We consider the equilibrium (ζ, 0, 0, ζ). The Jacobian matrix of the
dynamical system at this ﬁxed point is:

−(bβ − d)

0
0
0

b(1 − 2β) + d − p

b(1 − β) − p

p
p

p
p

b(1 − β) − p

b(1 − 2β) + d − p −(bβ − d)

This matrix admits four negative eigenvalues: −b(β − 1), −b(β − 1) − 2p, and an eigenvalue
with multiplicity two −(bβ − d). The equilibrium is therefore asymptotically stable.

 b(1 − β) − p

 2(d − b) − p

2(d − bβ) − p

1
4

p
p

p
p





10

CAMILLE CORON, MANON COSTA, H´EL`ENE LEMAN, AND CHARLINE SMADI

Equilibrium (1.12): We consider the equilibrium (0, ζ, 0, ζ). The Jacobian matrix of the
dynamical system at this ﬁxed point is:

b(1 − 2β) + d − p −(bβ − d)

p
p

0

0
0

b(1 − β) − p

b(1 − 2β) + d − p −(bβ − d)

0
0
0

The eigenvalues of this matrix are all negative: −b(β − 1), −b(β − 1)− 2p, and the eigenvalue
with multiplicity two −(bβ − d). The equilibrium is therefore asymptotically stable.
Equilibrium (1.13): The Jacobian matrix of the dynamical system at this ﬁxed point is:

2(d − bβ) − p
2(d − b) − p

p
p

p
p

2(d − b) − p
2(d − bβ) − p

p
p

2(d − bβ) − p
2(d − b) − p

This matrix admits two negative eigenvalues −(b(β + 1)/2 − d), −(b(β + 1)/2 − d + p) and
a positive eigenvalue with multiplicity two b(β − 1)/2. The equilibrium is thus unstable.

Equilibrium (1.14): Recall the deﬁnition of(cid:101)ζ in (1.9) and assume that zA,1 = za,1 =(cid:101)ζ. We

ﬁrst prove that at this ﬁxed point,

(2.9)

which is equivalent to

zA,1 + za,1 = 2(cid:101)ζ < ζ,

b2(β2 − 1) + 2p(b − d) − 2bd(β − 1) < 2(b(β − 1) + p)(bβ − d).

A straightforward computation leads to
b2(β2 − 1) + 2p(b − d) − 2bd(β − 1) − 2(b(β − 1) + p)(bβ − d) = −b(β − 1)(2p + b(β − 1)),
which is negative and thus proves the inequality. From (2.9) we deduce that near the equi-
librium (1.14), bβ − d − c(zA,1 + za,1) > 0. The instability then derives from Equation (2.8).
This ends the proof of Theorem 1.

2.2. The case β = 1. This subsection is devoted to the proof of Proposition 1.1.
Let us ﬁrst notice that the equilibria (1.11) are no longer hyperbolic. Moreover, following a
similar reasoning to the one in Section 2.1, we obtain that the equilibria of the system which
lay in D are exactly the line L = {u(x) = (ζ − x, x, x, ζ − x), x ∈ [0, ζ/2)}. The idea for the
rest of the proof is to ﬁnd a solution of the form

ψ(t) = γ(t)v(w, x) with γ(0) = 1,

where v(w, x) = (w − x, x, x, w − x) has been introduced in Proposition 1.1. Assuming that
ψ is solution to the system (1.6) with β = 1, we deduce that for all (α, i) ∈ E:

d
dt

ψα,i(t) =

d
dt

γ(t)vα,i(w, x)

= ψα,i(t)(b − d − c(ψα,i(t) + ψ ¯α,i(t))) + p
= γ(t)vα,i(w, x)(b − d − cwγ(t)).

ψα,i(t)ψ ¯α,i(t)

ψα,i(t) + ψ ¯α,i(t)

− p

ψα,¯i(t)ψ ¯α,¯i,(t)

ψα,¯i(t) + ψ ¯α,¯i,(t)

Thus γ(t) satisﬁes the logistic equation

γ(t) = γ(t)(b − d − cwγ(t)),

d
dt

SPECIATION BY MATING PREFERENCES

11

whose solution starting from 1 is given by

et(b−d)

γ(t) =

b−d (et(b−d) − 1)
(2.10)
.
In particular γ(t) converges to (b − d)/cw = ζ/w as t → ∞.
A standard computation proves that ψ(t) = γ(t)v(w, x) with γ chosen according to (2.10)
is the solution to (1.6) starting from v(w, x) and converges to ζv(w, x)/w = u(ζx/w). This
ends the proof.

1 + cw

2.3. Containment and Lyapunov function for a small migration rate. In this sub-
section, we are mainly interested in Equilibrium (1.11). Recall the deﬁnition of D in (1.16)

D := {z ∈ RE

+, zA,1 − za,1 > 0, za,2 − zA,2 > 0}.

First, we prove that we can restrict our attention to the bounded set Kp ⊂ D deﬁned in
(1.18). For the sake of readability, we introduce the two real numbers

≤ ζ ≤ ζ +
(2.11)
which allows one to write the set Kp deﬁned in (1.18) as

zmin :=

2c

b(β + 1) − 2d − p

p
2c

=: zmax,

Kp := {z ∈ D, {zA,1 + za,1, zA,2 + za,2} ∈ [zmin, zmax]} .

Lemma 2.1. Assume that p < b(β + 1) − 2d. The set Kp is invariant under the dynamical
system (1.6). Moreover, any solution to (1.6) starting from the set D reaches Kp after a
ﬁnite time.

Proof. First, Equation (2.8) and the symmetrical equation for the patch 2 are suﬃcient to
prove that the subset D is invariant under the dynamical system.
Second, we prove that the trajectory reaches the bounded set Kp in a ﬁnite time and third
that Kp is stable. The dynamics of the total population size n = zA,1 + za,1 + zA,2 + za,2
satisﬁes
dn
dt
Since (a + b)2 ≤ 2(a2 + b2) for every real numbers (a, b),

− c((zA,1 + za,1)2 + (zA,2 + za,2)2).

(cid:18) zA,1za,1

= n(βb − d) − 2b(β − 1)

zA,2 + za,2

zA,1 + za,1

zA,2za,2

+

(cid:19)
(cid:17)

(cid:16)

≤ n

dn
dt

βb − d − c
2

n

.

Using classical results on logistic equations, we deduce that

t→+∞ n(t) ≤ 2ζ.

(2.12)
Let ε be positive, and suppose that for any t > 0, (zA,1 + za,1)(t) ≤ ζ − ε, then using (2.8)
we have for t ≥ 0,
(2.13)

zA,1(t) ≥ (zA,1 − za,1)(t) ≥ (zA,1 − za,1)(0)ecεt →

lim sup

t→+∞ +∞.

This contradicts (2.12). As a consequence,

∃ t < ∞,

(zA,1 + za,1)(t) ≥ ζ − ε.

(2.14)
In particular, this result holds for ζ − ε0 = zmin where ε0 = (p + b(β − 1))/2c.
Furthermore, the dynamics of the total population size in the patch 1 satisﬁes the following
equation:

d
dt

(2.15)

(zA,1 + za,1) =(zA,1 + za,1)(bβ − d − c(zA,1 + za,1))

− 2(b(β − 1) + p)

zA,1za,1

zA,1 + za,1

+ 2p

zA,2za,2

zA,2 + za,2

.

12

CAMILLE CORON, MANON COSTA, H´EL`ENE LEMAN, AND CHARLINE SMADI

By noticing that zA,1za,1 ≤ (zA,1 + za,1)2/4, we get

d
dt

(2.16)

(zA,1 + za,1) ≥ (zA,1 + za,1) (bβ − d − c(zA,1 + za,1)) − (b(β − 1) + p)

zA,1 + za,1

2

≥ c(zA,1 + za,1) (zmin − (zA,1 + za,1)) .

The last term becomes positive as soon as zA,1 + za,1 ≤ zmin. As a consequence, once the
total population size in the patch 1 is larger than zmin, it stays larger than this threshold.
Using symmetrical arguments, the same conclusion holds for the patch 2. Using additionaly
(2.14), we ﬁnd tmin > 0 such that ∀t ≥ tmin,
zA,i(t) + za,i(t) ≥ zmin,
(2.17)
We now focus on the upper bound of the set Kp by bounding from above the total population
size in the patch i, for all t ≥ tmin,

∀i ∈ I, and n(t) ≤ 2ζ + 1.

(2.18)

d
dt

(zA,i + za,i) ≤ (2ζ + 1)(cζ − c(zA,i + za,i)) +
p
2
≤ c(2ζ + 1) (zmax − (zA,i + za,i)) .

(2ζ + 1)

This implies that, if α > 0 is ﬁxed, there exists tα ≥ tmin such that zA,i(t)+za,i(t) ≤ zmax +α
for all i ∈ I and t ≥ tα.
Finally, we use a proof by contradiction to ensure that the trajectory hits the compact Kp.
Let us assume that for any t ≥ tα,
(2.19)
From (2.8), and choosing an α < p/2c, we deduce that zA,1 − za,1 converges to 0. In addition
with (2.19), we ﬁnd t(cid:48)

zA,1(t) + za,1(t) ≥ zmax − α.

α ≥ tα such that for any t ≥ t(cid:48)
α,
(zmax − 2α) .

zA,1(t)za,1(t)

≥ 1
4

(2.20)
We insert (2.20) in the equation (2.15) to deduce that, for all t ≥ t(cid:48)
α,

zA,1(t) + za,1(t)

d
dt

(zA,1 + za,1)

≤ c (2ζ + 1) (ζ − (zA,1 + za,1)) − b(β − 1) + p
≤ c (2ζ + 1) (zmax − 2α − (zA,1 + za,1)) + 2αc(2ζ + 1) − b(β − 1) + p

(zmax − 2α) +

p
2

2

(2ζ + 1) .

(zmax − 2α) .

2

The ﬁrst term of the last line is negative under Assumption (2.19), thus, if α is suﬃciently
small,

d
dt

(2.21)

(zA,1 + za,1) ≤ − 1
2
≤ − 1
4

[(b(β − 1) + p)zmax] + α
[(b(β − 1) + p)zmax] .

b(β − 1) +

p
2c

(2ζ + 1)

This contradicts (2.19). Thus, the total population size of the patch 1 is lower than zmax − α
after a ﬁnite time. Moreover, (2.18) ensures that once the total population size of the patch
1 has reached the threshold zmax, it stays smaller than this threshold. Reasoning similarly
for the patch 2, we ﬁnally ﬁnd a ﬁnite time such that the trajectory hits the compact Kp
(cid:3)
and remains in it afterwards. This ends the proof of Lemma 2.1.
As D is invariant under the dynamical system (1.6), we can consider the function V : D →

(cid:104)

(cid:105)

R:

(2.22)

V (z) = ln

+ ln

(cid:18) zA,1 + za,1

zA,1 − za,1

(cid:19)

(cid:18) za,2 + zA,2

za,2 − zA,2

(cid:19)

.

SPECIATION BY MATING PREFERENCES

13

It characterizes the dynamics of (1.6) on Kp. Indeed, as proved in the next lemma, V is a
Lyapunov function if p is suﬃciently small. This will allow us to prove that the solutions
to (1.6) converge to (ζ, 0, 0, ζ) exponentially fast as soon as their trajectory hits the set Kp.
Before stating the next lemma, we introduce the positive real number:

(2.23)

C1 :=

1
2

(cid:18) 2b(β − 1) + 2p

zmin

(cid:19)

,

− 2p
zmax

where zmin and zmax have been deﬁned in (2.11). Then we have the following result:

Lemma 2.2. Assume that p < p0 deﬁned in (1.17). Then V (z(t)) is non-negative and
non-increasing on Kp, and satisﬁes

d
dt

V (z(t)) ≤ −C1(za,1(t) + zA,2(t)),

t ≥ 0.

(2.24)
Proof. For i ∈ I and z ∈ Kp, zαi,i−z ¯αi,i ≤ zαi,i +z ¯αi,i, where α1 = A, α2 = a and ¯αi = A\αi.
Thus, V (z) ≥ 0. Now,
− ˙za,2(t) − ˙zA,2(t)
za,2(t) − zA,2(t)

˙zA,2(t) + ˙za,2(t)
zA,2(t) + za,2(t)

V (z(t)) =

d
dt

+

˙zA,1(t) + ˙za,1(t)
zA,1(t) + za,1(t)
zA,iza,i

= −(cid:88)

zA,i + za,i

i=1,2

(2.25)

(cid:21)

,

2p

zA,¯i + za,¯i

− ˙zA,1(t) − ˙za,1(t)
(cid:20) 2b(β − 1) + 2p
zA,1(t) − za,1(t)
−
(cid:26) zA,1 + za,1

zA,i + za,i

(cid:27)

from (2.8) and (2.15). Thus, dV (z(t))/dt is nonpositive if

b(β − 1)

(2.26)
.
Since z belongs to Kp, the r.h.s of (2.26) can be bounded from above by

zA,2 + za,2

> max

p

− 1,

zA,2 + za,2
zA,1 + za,1

− 1

−

≥ 2C1,

z ∈ Kp,

i ∈ I.

zA,i + za,i

zA,¯i + za,¯i

Moreover, as the set D is invariant under the dynamical system (1.6), zA,1 stays larger that
za,1, and

In the same way,

za,2

zA,1

zA,1 + za,1

≥ 1
2

.

zA,2 + za,2

≥ 1
2

.

As a consequence, the ﬁrst derivative of V satisﬁes (2.24) for every t ≥ 0.

(cid:3)

We now have all the ingredients to prove Theorem 2.

− 1 =

zmax
zmin

b(β − 1) + 2p

b(β + 1) − 2d − p

.

b(β − 1)

b(β − 1) + 2p

p

>

b(β + 1) − 2d − p

(cid:112)b(β − 1)[b(3β + 1) − 4d] − b(β − 1)

,

= p0,

Therefore, the condition (2.26) is satisﬁed if

that is, if

p <

and under this condition,

2b(β − 1) + 2p

2

2p

14

CAMILLE CORON, MANON COSTA, H´EL`ENE LEMAN, AND CHARLINE SMADI

2.4. Proof of Theorem 2. Lemma 2.1 states that any solution to (1.6) starting from the
set D reaches Kp after a ﬁnite time. Let us show that because of Lemma 2.2, any solution
to (1.6) which starts from Kp converges exponentially fast to (ζ, 0, 0, ζ) when t tends to
inﬁnity. To do this, we need to introduce some positive constants

C2 := z2

mine−V (z(0)), C3 :=

2
C2

zmax

C4 :=

zmax

2

V (z(0)), C5 := z(4bβ − 2d + 3p)C4,

where we recall that zmin and zmax have been deﬁned in (2.11).

First, we prove that the population density diﬀerences zA,1 − za,1 and za,2 − zA,2 cannot

be too small. To do this, we use the decay of the function V stated in Lemma 2.2:

V (z(0)) ≥ V (z(t)) = ln

≥ ln

This implies that

(cid:18) zA,1(t) + za,1(t)
(cid:18)

za,2(t) + zA,2(t)
za,2(t) − zA,2(t)
zA,1(t) − za,1(t)
z2
min

(zA,1(t) − za,1(t))(za,2(t) − zA,2(t))

(cid:19)

(cid:19)

.

(2.27)
Now, from the inequality ln x ≤ x − 1 for x ≥ 1 we deduce for z in Kp,

(zA,1(t) − za,1(t))(za,2(t) − zA,2(t)) ≥ C2.

(cid:18) zA,1 + za,1

zA,1 − za,1

(cid:19)

(cid:18) za,2 + zA,2

(cid:19)

− 1

− 1

+

(2.28) V (z) ≤

za,2 − zA,2
za,1(za,2 − zA,2) + zA,2(zA,1 − za,1)

≤ C3(za,1 + zA,2),
where we have used that z ∈ Kp and inequality (2.27). Then combining (2.24) and (2.28),
we get

(zA,1 − za,1)(za,2 − zA,2)

= 2

(2.29)
which implies for every t ≥ 0:

d
dt

V (z(t)) ≤ − C1
C3

V (z(t)),

(2.30)
Now, from the inequality ln x ≥ (x − 1)/x for x ≥ 1 we deduce for z in Kp,

V (z(t)) ≤ V (z(0))e−C1t/C3.

(cid:18) zA,1 + za,1

zA,1 − za,1

− 1

(cid:19) zA,1 − za,1

zA,1 + za,1

=

+

(cid:18) za,2 + zA,2

za,2 − zA,2
2za,1
+

(cid:19) za,2 − zA,2

za,2 + zA,2
≥ 2
zmax

− 1

2zA,2

zA,1 + za,1

za,2 + zA,2

(za,1 + zA,2).

V (z) ≥

(2.31)

Hence,

(2.32)

za,1(t) + zA,2(t) ≤ C4e−C1t/C3,

and the exponential convergence of za,1 and zA,2 to 0 is proved. Let us now focus on the
two other variables, zA,1 and za,2. From the deﬁnition of the dynamical system in (1.6), and

SPECIATION BY MATING PREFERENCES

15

noticing that |zA,1(t) − ζ| ≤ ζ as z ∈ Kp, we get

(zA,1(t) − ζ)2 = − 2czA,1(t) (zA,1(t) − ζ)2 + 2pza,2(t)(zA,1(t) − ζ)

d
dt

− 2za,1(t)(zA,1(t) − ζ)

czA,1(t) + (p + b(β − 1))

(cid:18)

zA,2(t)

zA,2(t) + za,2

zA,1(t)

(cid:19)

zA,1(t) + za,1(t)

≤ − czmin (zA,1(t) − ζ)2 + 2pζzA,2(t) + 2ζza,1(t) (czmax + p + b(β − 1))
≤ − czmin (zA,1(t) − ζ)2 + ζ(4bβ − 2d + 3p)(za,1(t) + zA,2(t))
≤ − czmin (zA,1(t) − ζ)2 + C5e−C1t/C3.

Hence, a classical comparison of nonnegative solutions of ordinary diﬀerential equations
yields

(zA,1(t) − ζ)2 ≤

(zA,1(0) − ζ)2 −

C5

czmin − C1/C3

e−czmint +

C5

czmin − C1/C3

e−C1t/C3,

(cid:18)

(cid:19)

which gives the exponential convergence of zA,1 to ζ. Reasoning similarly for the term za,2
ends the proof of Theorem 2.

3. Stochastic process

In this section, we study properties of the stochastic process (NK(t), t ≥ 0). We derive an
approximation for the extinction time of subpopulations under some small initial conditions,
and then combine the results of this section with these on dynamical system (Section 2) to
prove Theorem 3.

3.1. Approximation of the extinction time. Let us ﬁrst study the stochastic system
(ZK(t), t ≥ 0) around the equilibrium (ζ, 0, 0, ζ) when K is large. The aim is to estimate the
time before the loss of all a-individuals in the patch 1 and all A-individuals in the patch 2,
which we denote by

0 = inf{t ≥ 0, ZK
T K

a,1(t) + ZK

A,2(t) = 0}.

(3.1)
Recall that ζ = (bβ − d)c−1 > 0 and that the sequence of initial states (ZK(0), K ≥ 1) con-
verges in probability when K goes to inﬁnity to a deterministic vector z0 = (z0
A,2, z0
RE
+.
Proposition 3.1. There exist two positive constants ε0 and C0 such that for any ε ≤ ε0, if
there exists η ∈]0, 1/2[ such that max(|z0
A,2 ≤ ε/2,
then

a,2 − ζ|) ≤ ε and ηε/2 ≤ z0
for any C > (b(β − 1))−1 + C0ε,
P(T K
for any 0 ≤ C < (b(β − 1))−1 − C0ε, P(T K

0 ≤ C log(K)) →
0 ≤ C log(K)) →

A,1 − ζ|,|z0

A,1, z0

a,1, z0

a,1, z0

K→+∞ 1,
K→+∞ 0.

a,2) ∈

Remark that the upper bound on T K
A,2 = 0. Moreover, if
0
z0
a,1 = z0
A,2 = 0, then the upper bound is satisﬁed with C0 = 0. In the case where η = 0,
the upper bound of the extinction time still holds but not the lower bound. Indeed, as the
initial conditions z0

A,2 go to 0, the extinction time is faster.

a,1 = 0 or z0

still holds if z0

a,1 and z0

Proof. The proof relies on several coupling arguments. Our ﬁrst step is to prove that the
population sizes ZK
In a second step,
we couple the processes ZK
A,2 with subcritical branching processes whose extinction

a,2 remain close to ζ on a long time scale.

A,1 and ZK

a,1 and ZK

16

CAMILLE CORON, MANON COSTA, H´EL`ENE LEMAN, AND CHARLINE SMADI

times are known. We begin with introducing some additional notations: for any γ, ε > 0
and (α, i) ∈ E,
(3.2)

α,i = inf{t ≥ 0,|ZK
RK,γ

α,i(t) − ζ| ≥ γ},

and

(3.3)

Step 1: The ﬁrst step consists in proving that as long as the population processes ZK
ZK
A,2 have small values, the processes ZK
the system on the time interval

a,1 and
a,2 stay close to ζ. To this aim, we study

α,i(t) ≥ ε}.

α,i = inf{t ≥ 0, ZK
T K,ε
(cid:104)

A,1 and ZK

(cid:105)

:=
where a ∧ b stands for min(a, b).
Let us ﬁrst bound the rates of the population process ZK

I K,ε
1

0, RK,ζ/2

A,1 ∧ RK,ζ/2

a,2 ∧ T K,ε

a,1 ∧ T K,ε

A,2

,

A,1.

• We start with the birth rate of A-individuals in the patch 1. Let us remark that as
β > 1, the ratio (βx + y)/(x + y) ≤ β for any x, y ∈ R+. Moreover, the function
x (cid:55)→ (βx+y)/(x+y) increases with x, for any y ∈ R+. Combining these observations
deduce that the birth rate of A-individuals in the patch 1, K(cid:101)λA,1(ZK(t)), deﬁned in
A,1(t) ≥ ζ/2, we
with the fact that for any t < T K,ε

a,1(t) ≤ ε and ZK

A,1

, 0 ≤ ZK

a,1 ∧ RK,ζ/2
A,1(t) ≤ K(cid:101)λA,1(ZK(t)) ≤ bβKZK

A,1(t).

(A.1) can be bounded:

(cid:18) ζ

(cid:19)

bβ

ζ + 2ε

KZK

• The migration rate of A-individuals from the patch 2 to the patch 1 is sandwiched

as follows for any t < T K,ε

a,1 ∧ RK,ζ/2
0 ≤ K(cid:101)ρ2→1(ZK(t)) ≤ Kpε.

A,1

:

• The death rate of A-individuals in the patch 1 and the migration rate from patch 1

to patch 2 are bounded as follows:

(d + cZK

A,1(t))KZK

A,1(t) ≤ K(cid:101)dA,1(ZK(t)) ≤ (d + cε + cZK

0 ≤ K(cid:101)ρ1→2(ZK(t)) ≤ Kpε.

A,1(t))KZK

A,1(t),

Hence, using an explicit construction of the process ZK
as in (1.5), we deduce that on the time interval I K,ε
(cid:52) Y K
sup,

(cid:52) ZK

Y K

A,1

inf

1

where Y K

inf is a N/K-valued Markov jump process with transition rates
(i + 1)

(cid:18)

A,1 by means of Poisson point measures
, ZK

A,1 is stochastically bounded by

and initial value ZK
rates

sup is a N/K-valued Markov jump process with transition

1 − 2ε
ζ + 2ε

Kbβ

(cid:18)(cid:18)
K
d + cε + c
(cid:18)
A,1(0), and Y K
(cid:18)

bβ

K

i
K

K

d + c

K

(cid:19) i
(cid:19)
(cid:19) i

K

i
K

i
K

+ pε

(cid:19) i
(cid:19)

K

from

i
K
i
K

to

to

,

,

K

(i − 1)

K

+ pε

from

from

from

i
K
i
K

to

to

(i + 1)

K

(i − 1)

K

,

.

SPECIATION BY MATING PREFERENCES

17

A,1(0).

and initial value ZK
Let us focus on the process Y K
that since the sequence (Y K
z0
A,1,

inf . Using a proof similar to the one of Lemma 1.1, we prove
inf (0), K ≥ 1) converges in probability to the deterministic value

K→+∞sup
lim
s≤t

|Y K
inf (s) − Φinf (s)| = 0

a.s

for every ﬁnite time t > 0, where Φinf is the solution to

Φ(cid:48)(t) = bβ(1 − 2ε/(ζ + 2ε))Φ(t) − pε − (d + cε + cΦ(t))Φ(t)

(3.4)
with initial value z0
r.h.s. of (3.4) has two roots

Φ±
inf =

1
2c

(3.5)

A,1. Let us study the trajectory of Φinf . The polynomial in Φ(t) on the

bβ
(cid:18)
(cid:18) 2bβ

1 − 2ε
ζ + 2ε

(cid:19)
(cid:19)

− d − cε ±

(cid:115)(cid:18) ζ

(cid:115)(cid:18)
(cid:18)
(cid:18) 2bβ

bβ

− d − cε

(cid:19)
(cid:19)(cid:19)2 − pε

.

c

1 − 2ε
ζ + 2ε

(ζ + 2ε)c

+ 1


(cid:19)2 − 4pcε

=

ζ
2

− ε
2

− ε
2
As a consequence, Φ(cid:48) > 0 if and only if Φ ∈]Φ−
inf , Φ+
small ε,
Φ−
inf ∼ pcε.

(ζ + 2ε)c

+ 1

±

2

Hence, if ε0 is chosen suﬃciently small and for any ε < ε0,

Φ−
inf ≤ 2pcε0 < z0

A,1.

inf [. Deﬁnition (3.5) implies that for

Thus, we observe that any solution to (3.4) with initial condition Φinf (0) ∈ [2pcε0, +∞[ is
monotonous and converges to Φ+
inf . Similarly, we obtain that if ε0 is suﬃciently small, then
there exists M(cid:48) > 0 such that for any ε < ε0, |Φ+
inf − ζ| ≤ M(cid:48)ε. We deﬁne the stopping time

= inf(cid:8)t ≥ 0,Y K

inf (cid:54)∈ [ζ − (M(cid:48) + 1)ε, ζ + (M(cid:48) + 1)ε](cid:9) .

RK,M(cid:48)
Y K

inf

As in the proof of Theorem 3/(c) in [5], we can construct a family of Markov jump processes
inf with transition rates that are positive, bounded, Lipschitz and uniformly bounded away
from 0, for which we can ﬁnd the following estimate (Chapter 5 of Freidlin and Wentzell [18]):
there exists V (cid:48) > 0 such that,
P(RK,M(cid:48)
Y K

(cid:101)Y K
) = P(RK,M(cid:48)

> eKV (cid:48)

inf

(cid:101)Y K

> eKV (cid:48)
sup similarly and ﬁnd M(cid:48)(cid:48) > 0 and V (cid:48)(cid:48) > 0 such that
P(RK,M(cid:48)(cid:48)

) →
K→+∞ 1.

> eKV (cid:48)(cid:48)

inf

) →
K→+∞ 1,

Y K

sup

(cid:111)
sup(t) (cid:54)∈ [ζ − (M(cid:48)(cid:48) + 1)ε, ζ + (M(cid:48)(cid:48) + 1)ε]
∧RK,M1
Y K

sup

.
> eKV1) →

K→+∞

(cid:110)

with

RK,M(cid:48)(cid:48)
Y K

sup

= inf

t ≥ 0,Y K

Finally, for M1 = M(cid:48)∨M(cid:48)(cid:48) and V1 = V (cid:48)∧V (cid:48)(cid:48), we deduce that P(RK,M1
Y K
1. Moreover, if RK,(M1+1)ε
A,2 , then

≤ RK,ζ/2

A,1

inf

A,1 ∧ RK,ζ/2
RK,(M1+1)ε

a,2 ∧ T K,ε
≥ RKY K

a,1 ∧ T K,ε
∧ RKY K

A,1

sup

inf

.

We can deal with the process Y K

Thus

(3.6)

P(RK,ζ/2

A,1 ∧ RK,ζ/2

a,2 ∧ T K,ε

a,1 ∧ T K,ε

A,2 ∧ eKV1 > RK,(M1+1)ε

A,1

) →
K→+∞ 0.

18

CAMILLE CORON, MANON COSTA, H´EL`ENE LEMAN, AND CHARLINE SMADI

Using symmetrical arguments for the population process ZK
such that

a,2, we ﬁnd M2 > 0 and V2 > 0

P(RK,ζ/2

A,1 ∧ RK,ζ/2

a,2 ∧ T K,ε

a,1 ∧ T K,ε

A,2 ∧ eKV2 > RK,(M2+1)ε

(3.7)
Finally, we set M = M1 ∨ M2 and V = V1 ∧ V2. Limits (3.6) and (3.7) are still true with M
and V . Thus we have proved that, as long as the size of the a-population in Patch 1 and
the size of the A-population in Patch 2 are small and as long as the time is smaller than
a,2 stay close to ζ, i.e. they belong to [ζ−(M +1)ε, ζ+(M +1ε)].
eKV , the processes ZK

A,1 and ZK

) →
K→+∞ 0.

a,2

Note that if ε0 is suﬃciently small, RK,(M +1)ε
ε < ε0. So we reduce our study to the time interval

A,1

(cid:104)

I K,ε
2

:=

0, RK,(M +1)ε

A,1

∧ RK,(M +1)ε

a,2

∧ T K,ε

a,1 ∧ T K,ε

A,2

.

(cid:105)

≤ RK,ζ/2

A,1

and RK,(M +1)ε

a,2

≤ RK,ζ/2

a,2

a.s. for all

A,2(t), t ≥ 0). We recall that there exists η ∈]0, 1/2[ such that ηε/2 ≤ z0

Step 2: In the sequel we study the extinction time of the stochastic processes (ZK
and (ZK
a,1, z0
Bounding the birth and death rates of (ZK
deduce that the sum (ZK
time interval I K,ε

a,1(t), t ≥ 0)
A,2 ≤ ε/2.
A,2(t), t ≥ 0) as previously, we
A,2(t), t ≥ 0) is stochastically bounded as follows, on the
N K
inf
K

a,1(t), t ≥ 0) and (ZK

a,1(t) + ZK

inf is a N-valued binary branching process with birth rate b + p ζ−(M +1)ε
ζ−M ε

where N K
d + cζ + c(M + 2)ε + p and initial state (cid:98)ηεK(cid:99), and N K
process with birth rate

, death rate
sup is a N-valued binary branching

(cid:52) N K

a,1 + ZK
A,2

(cid:52) ZK

sup
K

2

.

:

ζ + ε(β − M − 1)

b

ζ − M ε

+ p,

death rate

d + cζ − c(M + 1)ε + p

ζ − (M + 1)ε

ζ − M ε

,

and initial state (cid:98)εK(cid:99) + 1.
It remains to estimate the extinction time for a binary branching process (Nt, t ≥ 0) with a
birth rate B and a death rate D > B. Applying (A.2) with i = (cid:98)ηεK(cid:99), we get:

∀C < (D − B)−1, P(SN
∀C > (D − B)−1, P(SN

K→+∞ 0,
K→+∞ 1.
(cid:98)εK(cid:99) denotes the ﬁrst time before N reaches a size (cid:98)εK(cid:99),

0 ≤ C log(K)) →
0 ≤ C log(K)) →

Moreover, if SN

P(cid:16)

(cid:17) →

K→+∞ 0

(3.8)

P(T K

(cf. Theorem 4 in [5]). Thus
≤ P(cid:16)
0 < C log(K)) − P
(cid:18)

0 > T K,ε
T K
N K
S
0

N K
0

(cid:18)
S
(cid:19)
A,2 ∧ K
a,1 ∧ T K,ε
N K
(cid:98)εK(cid:99) ∧ K

≤ P

> S

sup

sup

inf

(cid:98)εK(cid:99)

0 > K ∧ SN
SN
(cid:19)
a,1 ∧ T K,ε
T K,ε
a,1 ∧ T K,ε
T K,ε

(cid:17)
+ P(cid:16)
+ P(cid:16)

< C log(K)

A,2 ∧ K > RK,(M +1)ε

A,1

∧ RK,(M +1)ε

a,2

A,2 ∧ K > RK,(M +1)ε

A,1

∧ RK,(M +1)ε

a,2

.

(cid:17)

(cid:17)

SPECIATION BY MATING PREFERENCES

19

K→+∞
We prove similarly that

The last term of the last line converges to 0 when K tends to 0 according to (3.6) and

(3.7). The ﬁrst one also tends to 0 according to (3.8). Thus,
N K
S
0

lim

P

inf

< C log(K)

.

P(cid:0)T K
0 < C log(K)(cid:1) ≤ lim
P(cid:0)T K
0 < C log(K)(cid:1) ≥ lim

K→+∞

(cid:18)
(cid:18)

P

N K
0

sup

lim

K→+∞

.
We conclude the proof by noticing that the growth rates of the processes N K
inf and N K
equal to −b(β − 1) up to a constant times ε.
3.2. Proof of Theorem 3. We can now prove our main result:

< C log(K)

K→+∞

S

sup are
(cid:3)

Let ε be a small positive number. Applying Lemma 1.1 and Theorem 1 we get the existence

of a positive real number sε such that

(cid:19)
(cid:19)

lim
K→∞

P(cid:0)(cid:107)NK(sε) − (ζK, 0, 0, ζK)(cid:107) ≤ εK/2(cid:1) = 1.
(cid:32)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12) T KBε

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12) ≤ C0ε

(cid:33)

log K

P

1

lim
K→∞

Using Proposition 3.1 and the Markov property yield that there exists C0 > 0 such that

where by deﬁnition, we recall that T KBε
rates are equal to zero for any t ≥ T KBε
a,1(t) = ZK
ZK

b(β − 1)

−
is the hitting time of Bε. Moreover, the migration
, so

= 1,

A,2(t) = 0,

for any t ≥ T KBε.

After the time T KBε
, the A-population in the patch 1 and the a-population in the patch 2
evolve independently from each other according to two logistic birth and death processes with
birth rate bβ, death rate d and competition rate c. Using Theorem 3(c) in Champagnat [5],
we deduce that for any m > 1, there exists V > 0 such that

which ends the proof.

inf
X∈Bε

PX (T KBmε ≥ eKV ) →

K→+∞ 1,

4. Influence of the migration parameter p: mumerical simulations

In this section, we present some simulations of the deterministic dynamical system (1.6).
We are concerned with the inﬂuence of the migration rate p on the time to reach a neigh-
borhood of the equilibrium (1.11).
For any value of p, we evaluate the ﬁrst time Tε(p) such that the solution (zA,1(t), za,1(t),
zA,2(t), za,2(t)) to (1.6) belongs to the set

Sε =(cid:8)(zA,1, za,1, zA,2, za,2) ∈ R4

A,2 + (za,2 − ζ)2 ≤ ε2(cid:9) ,

+, (zA,1 − ζ)2 + z2

a,1 + z2

which corresponds to the ﬁrst time the solution enters an ε−neighborhood of (ζ, 0, 0, ζ).

In the following simulations, the demographic parameters are given by:

β = 2,

b = 2,

d = 1

and

c = 0.1.

For these parameters,

ζ = 30

and

p0 =

√

5 − 1 (cid:39) 1.24.

The migration rate as well as the initial condition varies.
Description of the ﬁgures: Figure 2 presents the plots of p (cid:55)→ Tε(p)− Tε(0). The simula-
tions are computed with ε = 0.01 and with initial conditions (zA,1(0), za,1(0), zA,2(0), za,2(0))

20

CAMILLE CORON, MANON COSTA, H´EL`ENE LEMAN, AND CHARLINE SMADI

such that za,1(0) = zA,1(0)−0.1 with zA,1(0) ∈ {0.3, 0.5, 1, 2, 3, 5, 10, 15} and (zA,2(0), za,2(0)) ∈
{(1, 30), (15, 16)}. Figure 3 presents the trajectories of some solutions to the dynamical sys-
tem (1.6) in the two phase planes which represent the two patches. We use the same pa-
rameters as in Figure 2 and the initial conditions are given in the captions. For each initial
condition, we plot the trajectories for three diﬀerent values of p: 0, 1 and 20.

Conjecture: First of all, we observe that for all values under consideration, the time Tε(p)
to reach the set Sε is ﬁnite even if p > p0. Therefore, we make the following conjecture:
Conjecture 1. For any initial condition (z1,A(0), z1,a(0), z2,A(0), z2,a(0)) ∈ D, where D is
deﬁned by (1.16),

(z1,A(t), z1,a(t), z2,A(t), z2,a(t)) −→

t→+∞ (ζ, 0, 0, ζ).

(a) (zA,2(0), za,2(0)) = (1, 30)

(b) (zA,2(0), za,2(0)) = (15, 16)
For diﬀerent values of the initial condition, we plot p (cid:55)→
Figure 2.
Tε(p) − Tε(0). The initial condition is (zA,1(0), zA,1(0) − 0.1, zA,2(0), za,2(0)) where
zA,1(0) ∈ {0.3, 0.5, 1, 2, 3, 5, 10, 15} as represented by the colors of the legend; and
(zA,2(0), za,2(0)) = (1, 30) on the left, and (zA,2(0), za,2(0)) = (15, 16) on the right.

Inﬂuence of p when the initial condition in patch 2 is close to the equilibrium:
Figure 2(a) presents the results for (zA,2(0), za,2(0)) = (1, 30), that is if the initial condition
in the patch 2 is close to its equilibrium (recall that ζ = 30 with the parameters under study).
Observe that for any value of (zA,1(0), za,1(0) = zA,1(0)− 0.1), the time for reproductive iso-
lation to occur is reduced when the migration rate is large. Hence, the migration rate seems
here to strengthen the homogamy. This is conﬁrmed by Figure 3(a) and (b) where examples
of trajectories with the same initial conditions as in Figure 2(a) are drawn. The two Fig-
ures 3(a) and (b) present similar behaviors: when p increases, the number of a-individuals
in patch 1 decreases at any time whereas the number and the proportion of a-individuals in
patch 2 remain almost constant. These behaviors derive from two phenomena. On the one
hand, the a-individuals are able to leave patch 1 faster when p is large. On the other hand,
the value of p does not aﬀect the migration outside patch 2 which is almost zero in view of
the small proportion of A-individuals in the patch 2.

Inﬂuence of p when a- and A-population sizes are initially similar in patch 2:
On Figure 2(b) we are interested in the case where the A- and a- initial populations in
patch 2 have a similar size and the sum zA,2(0) + za,2(0) is close to ζ. Observe that for
zA,1(0) ∈ {5, 10, 15}, the time Tε(p) decreases with respect to p but not as fast as previously.
By plotting some trajectories when zA,1(0) = 10 on Figure 3(c), we note that the dynamics

0.30.512351015-2.5-2.0-1.5-1.0-0.5-0.00.00.51.01.52.02.53.0shifted time to reach the equilibriummigration rate ptime0.30.512351015-1.0-0.8-0.6-0.4-0.20.00.20.40.60.00.51.01.52.02.53.0shifted time to reach the equilibriummigration rate ptimeSPECIATION BY MATING PREFERENCES

21

is not the same as for the previous case (Fig. 3(a)). Here, a large migration rate aﬀects the
migration outside the two patches in such a way that the equilibrium is reached faster.
Finally, Figure 2(b) also presents behaviors that are essentially diﬀerent for zA,1(0) ∈
{0.3, 0.5, 1, 2, 3}.
In these cases, the migration rate does not strengthen the homogamy.
We plot some trajectories from this latter case in Figure 3(d) where zA,1(0) = 1. Observe
that a high value of p favors the migration outside patch 2 for the two types a and A since
the proportions of the two alleles in patch 2 are almost equal at time t = 0. This is not
the case in the patch 1 where the value of p does not aﬀect signiﬁcantly the initial migra-
tion outside patch 1 since the population sizes are smaller. Hence, patch 1 is ﬁlled by the
individuals that ﬂee patch 2 where the migration rate is high. Therefore, both a- and A-
populations increase at ﬁrst, but the A-individuals remain dominant in patch 1 and thus the
a-population is disadvantaged. Finally, the a-individuals that ﬂee the patch 2, ﬁnd a less
favorable environment in patch 1 and therefore the time needed to reach the equilibrium is
extended because of the dynamics in patch 1.

(a) (10,9.9,1,30)

(c) (10,9.9,15,16)

(b) (1,0.9,1,30)

(d) (1,0.9,15,16)

Figure 3. For four diﬀerent initial conditions, we plot the trajectories in the phase
planes which represent the patch 1 (left) and the patch 2 (right) for t ∈ [0, 10] and
for three values of p: p = 0 (red), p = 1 (blue), p = 20 (green). The initial condition
is given under each pair of plots in the format (zA,1(0), za,1(0), zA,2(0), za,2(0)). Note
that the initial conditions on (a) and (c) (resp. (b) and (d)) corresponds to the dark
green (resp. light green) curve on Figure 2(a) and 2(b).

As a conclusion, similarly to the case of selection-migration model (see e.g. [1]) migration
can have diﬀerent impacts on the population dynamics. On the one hand, a large migration
rate helps the individuals to escape a disadvantageous habitat [8] but there are also risks to
move through unfamiliar or less suitable habitat. Thus, a trade-oﬀ between the two phe-
nomena explains the inﬂuence of p on the time to reach the equilibrium.

5. Generalisations of the model

Until now we studied a simple model to make clear the important properties allowing to get
spatial segregation between patches. We now prove that our ﬁndings are robust by studying
some generalisations of the model and showing that we can relax several assumptions and
still get spatial segregation between patches.

0510152025303505101520253035z_1A(t)z_1a(t)0510152025303505101520253035z_2A(t)z_2a(t)0510152025303505101520253035z_1A(t)z_1a(t)0510152025303505101520253035z_2A(t)z_2a(t)0510152025303505101520253035z_1A(t)z_1a(t)0510152025303505101520253035z_2A(t)z_2a(t)0510152025303505101520253035z_1A(t)z_1a(t)0510152025303505101520253035z_2A(t)z_2a(t)22

CAMILLE CORON, MANON COSTA, H´EL`ENE LEMAN, AND CHARLINE SMADI

(cid:105)
(cid:105)
(cid:105)
(cid:105)



(5.1)

(cid:104)
(cid:104)
(cid:104)
(cid:104)

5.1. Diﬀerences between patches. We assumed that the patches were ecologically equiv-
alent in the sense that the birth, death and competition rates b, d and c, respectively, did
not depend on the label of the patch i ∈ I. In fact we could make these parameters depend
on the patch, and denote them bi, di and ci, i ∈ I. In the same way, the sexual preference βi
and the migration rate pi could depend on the label of the patch i ∈ I. As a consequence,
the dynamical system (1.6) becomes

d
dt zA,1(t) = zA,1
d
dt za,1(t) = za,1
d
dt zA,2(t) = zA,2
d
dt za,2(t) = za,2

b1

b1

b2

b2

β1zA,1+za,1
zA,1+za,1
β1za,1+zA,1
zA,1+za,1
β2zA,2+za,2
zA,2+za,2
β2za,2+zA,2
zA,2+za,2

− d1 − c1(zA,1 + za,1) − p1
− d1 − c1(zA,1 + za,1) − p1
− d2 − c2(zA,2 + za,2) − p2
− d2 − c2(zA,2 + za,2) − p2

za,1

zA,1+za,1

zA,1

zA,1+za,1

za,2

zA,2+za,2

zA,2

zA,2+za,2

+ p2

+ p2

+ p1

+ p1

zA,2za,2
zA,2+za,2
zA,2za,2
zA,2+za,2
zA,1za,1
zA,1+za,1
zA,1za,1
.
zA,1+za,1

The set D is still invariant under this new system and the solutions to (5.1) with initial
conditions in D hit in ﬁnite time the invariant set

(cid:20) bi(βi + 1) − 2di − pi

(cid:26)

z ∈ D, zA,i + za,i ∈

(cid:21)(cid:27)

,

, ζi +

, i ∈ I

p¯i
2ci

K(cid:48)
p :=

where

2ci
biβi − di

.

ci

ζi :=

As D is an invariant set under (5.1), we can deﬁne the function V as in (2.22) for every
solution of V with initial condition in D. Its ﬁrst order derivative is

V (z(t)) = −(cid:88)

d
dt

zA,iza,i

zA,i + za,i

i=1,2

(cid:20) 2bi(βi − 1) + 2pi

zA,i + za,i

(cid:21)

.

−

2pi

zA,¯i + za,¯i

As a consequence, we can prove similar results to Theorems 2 and 3 under the assumption
that p1 and p2 satisfy

pic¯i(2ciζi + p¯i) < ci(bi(βi − 1) + pi)(b¯i(β¯i + 1) − 2d¯i − p¯i), for i ∈ I.

5.2. Migration. The migration rates under consideration increase when the genetic diver-
sity increases. Indeed, let us consider

(cid:34)(cid:18)

(cid:19)2

(cid:18)

(cid:19)2(cid:35)

T := 1 −
H (i)

nA,i

nA,i + na,i

+

na,i

nA,i + na,i

T ∈ [0, 1/2] is known
as a measure of the genetic diversity in the patch i ∈ I. Note that H (i)
as the ”total gene diversity” in the patch i (see [28] for instance) and is widely used as a
measure of diversity. When we express the migration rates in terms of this measure, we get

ρα,¯i→i(n) = p

nA,ina,i

nA,i + na,i

=

p
2

(nA,i + na,i)H (i)
T .

Hence we can consider that the migration helps the speciation. Let us show that we can get
the same kind of result when we consider an arbitrary form for the migration rate if this
latter is symmetrical and bounded. We thus consider a more general form for the migration
rate. More precisely,

ρα,¯i→i(n) = p(nA,¯i, na,¯i),

and we assume

p(nA,¯i, na,¯i) = p(na,¯i, nA,¯i)

and p(nA,¯i, na,¯i)

nA,¯i + na,¯i

nA,¯ina,¯i

< p0,

where p0 has been deﬁned in (1.17). Note that the second condition on the function p imposes
that as one of the population sizes goes to 0, then so does the migration rate. In particular,

SPECIATION BY MATING PREFERENCES

23

this condition ensures that the points given by (1.11) and (1.12) are still equilibria of the
system. Theorems 2 and 3 still hold with this new deﬁnition for the migration rate.

5.3. Number of patches. Finally, we restricted our attention to the case of two patches,
but we can consider an arbitrary number N ∈ N of patches. We assume that all the patches
are ecologically equivalent but that the migrant individuals have a probability to migrate
to an other patch which depends on the geometry of the system. Moreover, we allow the
individuals to migrate outside the N patches. In other words, for α ∈ A, i ≤ N , j ≤ N + 1
and n ∈ (NA)N ,

ρα,i→j(n) = pij

nA,ina,i

nA,i + na,i

,

where the ”patch” N + 1 denotes the outside of the system.
As a consequence, we obtain the following limiting dynamical system for the rescaled process,
when the initial population sizes are of order K in all the patches: for every 1 ≤ i ≤ N ,

dzA,i(t)

dt

= zA,i

βzA,i + za,i
zA,i + za,i

− d − c(zA,i + za,i) − (cid:88)

za,i

pij

zA,i + za,i

j(cid:54)=i,j≤N +1

(5.2)

dza,i(t)

dt

= za,i

βza,i + zA,i
zA,i + za,i

zA,jza,j

+

pji

j(cid:54)=i,j≤N

zA,j + za,j

− d − c(zA,i + za,i) − (cid:88)

pij

zA,i

zA,i + za,i

j(cid:54)=i,j≤N +1




b
(cid:88)
b

(cid:88)

For the sake of readability, we introduce the two following notations:

pi→ :=

pij

and pi← :=

pji.

+

j(cid:54)=i,j≤N

zA,jza,j

zA,j + za,j

pji

(cid:88)

j(cid:54)=i,j≤N +1

(cid:88)

j(cid:54)=i,j≤N

Let NA be an integer smaller than N which gives the number of patches with a majority of
individuals of type A. We can assume without loss of generality that

zA,i(0) > za,i(0), for 1 ≤ i ≤ NA,
+)N

Let us introduce the subset of (RA

and zA,i(0) < za,i(0), for NA + 1 ≤ i ≤ N.

DNA,N := {z ∈ (RA

+)N , zA,i − za,i > 0 for i ≤ NA,

and za,i − zA,i > 0 for i > NA},

We assume that the sequence (pij)i,j∈{1,..,N} satisfy : for all i ∈ {1, .., N},
pij

b(β − 1) + pi→

pi→ < b(β + 1) − 2d and

− (cid:88)

(5.3)

2cz + pi←

j(cid:54)=i,j≤N +1

b(β + 1) − 2d − pj→

> 0.

Then we have the following result:

Theorem 4. We assume that Assumption (5.3) holds. Let us assume that ZK(0) converges
A,2) (cid:54)= (0, 0). In-
in probability to a deterministic vector z0 belonging to DNA,N with (z0
(cid:17)N−NA
troduce the following bounded set depending on ε > 0:

[(ζ − ε)K, (ζ + ε)K] × {0}(cid:17)NA ×(cid:16){0} × [(ζ − ε)K, (ζ + ε)K]

a,1, z0

(cid:16)

BNA,N,ε :=

.

24

CAMILLE CORON, MANON COSTA, H´EL`ENE LEMAN, AND CHARLINE SMADI

Then there exist three positive constants 0, C0 and m, and a positive constant V depending
on (m, ε0) such that if ε ≤ ε0,

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12) ≤ C0ε, NK(cid:16)

−

1

b(β − 1)

T KBNA,N,ε

+ t

(cid:17) ∈ BNA,N,mε ∀t ≤ eV K

(cid:33)

= 1,

(cid:32)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12) T KBε

P

lim
K→∞

log K
where T KB , B ⊂ RE

+ is the hitting time of the set B by the population process NK.

The proof is really similar to the one for the two patches. To handle the deterministic
part of the proof, we ﬁrst show that for every initial condition on DNA,N , the solution of
(5.2) hits the set
KNA,N :=

, {zA,i + za,i} ∈

∀i ≤ N

∩DNA,N .

(cid:26)

(cid:27)

(R∗

+)A(cid:17)N

z ∈(cid:16)
z ∈ KNA,N (cid:55)→ (cid:88)

ln

i≤NA

(cid:20) b(β + 1) − 2d − pi→
(cid:19)

(cid:21)
(cid:19)
(cid:18) za,i + zA,i

pi←
2c

(cid:88)

, ζ +

2c

+

NA<i≤N

ln

za,i − zA,i

.

(cid:18) zA,i + za,i

zA,i − za,i

in ﬁnite time, and that this set is invariant under (5.2). Then, we conclude with the Lyapunov
function

As a conclusion, several generalisations are possible and a lot of assumptions can be relaxed
in the initial simple model. We can also combine some of the generalisations for the needs of
a particular system. However, observe that the mating preference inﬂuences the time needed
to reach speciation in the same way.

Appendix A. Technical results

This section is dedicated to some technical results needed in the proofs. We ﬁrst prove the
convergence when K goes to inﬁnity of the sequence of rescaled processes ZK to the solution
of the dynamical system (1.6) stated in Lemma 1.1.

Proof of Lemma 1.1. The proof relies on a classical result of [16] (Chapter 11). Let z be in
NE /K. According to (1.1)-(1.4), the rescaled birth, death and migration rates

(cid:101)dα,i(z) =

1
K

dK
α,i(Kz) = [d + czA,i + cza,i] zα,i,

(cid:101)λα,i(z) =

1
K

(A.1)

and

λα,i(Kz) = λα,i(z),

(cid:101)ρ¯i→i(z) =

1
K

ρ¯i→i(Kz) = ρ¯i→i(z),

(α, i) ∈ E

α,i , Y (ρ)

α,i , Y (d)

are Lipschitz and bounded on every compact subset of NE , and do not depend on the car-
α,i , (α, i) ∈ E) be twelve independent standard Poisson
rying capacity K. Let (Y (λ)
processes. From the representation of the stochastic process (NK(t), t ≥ 0) in (1.5) we see
(cid:16)(cid:90) t
(cid:17)(cid:105)
that the stochastic process ( ¯ZK(t), t ≥ 0) deﬁned by
K(cid:101)dα,i( ¯ZK(s))ds
(cid:16)(cid:90) t
(cid:17)
K(cid:101)ρα,i( ¯ZK(s))ds

K(cid:101)λα,i( ¯ZK(s))ds

(cid:17) − Y (d)

(eα,i − eα,¯i)

¯ZK(t) = ZK(0) +

(cid:16)(cid:90) t

(cid:88)

(cid:88)

eα,i
K

(α,i)∈E

Y (λ)
α,i

Y (ρ)
α,i

(cid:104)

+

α,i

0

0

,

(α,i)∈E

K

0

has the same law as (ZK(t), t ≥ 0). Moreover, a direct application of Theorem 2.1 p 456 in
[16] gives that ( ¯ZK(t), t ≤ T ) converges in probability to (z(z0)(t), t ≤ T ) for the uniform
norm. As a consequence, (ZK(t), t ≤ T ) converges in law to (z(z0)(t), t ≤ T ) for the same
norm. But the convergence in law to a constant is equivalent to the convergence in probability
(cid:3)
to the same constant. The result follows.

SPECIATION BY MATING PREFERENCES

25

Lemma A.1.

We now recall a well known fact on branching processes which can be found in [2] p 109.
• Let Z = (Zt)t≥0 be a birth and death process with individual birth and
death rates b and d. For i ∈ Z+, Ti = inf{t ≥ 0, Zt = i} and Pi is the law of Z when
Z0 = i. If d (cid:54)= b ∈ R∗

+, for every i ∈ Z+ and t ≥ 0,
(cid:16) d(1 − e(d−b)t)

Pi(T0 ≤ t) =

b − de(d−b)t

(cid:17)i

.

(A.2)

Acknowledgements: The authors would like to warmly thank Sylvie M´el´eard for her
continual guidance during our respective (past and present) thesis works. The authors would
also like to thank Pierre Collet for his help on the theory of dynamical systems and Sylvain
Billiard for many fruitful discussions on the biological relevance of our model. C. C. and C.
S. are grateful to the organizers of ”The Helsinki Summer School on Mathematical Ecology
and Evolution 2012: theory of speciation” which motivated this work. This work was par-
tially funded by the Chair ”Mod´elisation Math´ematique et Biodiversit´e” of VEOLIA-Ecole
Polytechnique-MNHN-F.X.

References

[1] A. Akerman and R. B¨urger. The consequences of gene ﬂow for local adaptation and diﬀerentiation: a

two-locus two-deme model. Journal of mathematical biology, 68(5):1135–1198, 2014.

[2] K. B. Athreya and P. E. Ney. Branching processes. Springer-Verlag Berlin, Mineola, NY, 1972. Reprint

of the 1972 original [Springer, New York; MR0373040].

[3] B. Bolker and S. W. Pacala. Using moment equations to understand stochastically driven spatial pattern

formation in ecological systems. Theoretical population biology, 52(3):179–197, 1997.

[4] K. E. Boul, W. C. Funk, C. R. Darst, D. C. Cannatella, and M. J. Ryan. Sexual selection drives speciation
in an amazonian frog. Proceedings of the Royal Society of London B: Biological Sciences, 274(1608):399–
406, 2007.

[5] N. Champagnat. A microscopic interpretation for adaptive dynamics trait substitution sequence models.

Stochastic Processes and their Applications, 116(8):1127–1160, 2006.

[6] N. Champagnat, R. Ferri`ere, and S. M´el´eard. Unifying evolutionary dynamics: from individual stochastic

processes to macroscopic models. Theoretical population biology, 69(3):297–321, 2006.

[7] C. Chicone. Ordinary Diﬀerential Equations with Applications. Number 34 in Texts in Applied Mathe-

matics. Springer-Verlag New York, 2006.

[8] J. Clobert, E. Danchin, A. A. Dhondt, and J. D. Nichols. Dispersal. Oxford University Press Oxford,

2001.

[9] P. Collet, S. M´el´eard, and J. A. Metz. A rigorous model study of the adaptive dynamics of mendelian

diploids. Journal of Mathematical Biology, pages 1–39, 2011.

[10] C. Coron. Slow-fast stochastic diﬀusion dynamics and quasi-stationarity for diploid populations with

varying size. Journal of Mathematical Biology, pages 1–32, 2015.

[11] M. Costa, C. Hauzy, N. Loeuille, and S. M´el´eard. Stochastic eco-evolutionary model of a prey-predator

community. Journal of mathematical biology, 72(3):573–622, 2015.

[12] U. Dieckmann and M. Doebeli. On the origin of species by sympatric speciation. Nature, 400(6742):354–

357, 1999.

[13] U. Dieckmann, R. Law, et al. Relaxation projections and the method of moments. The Geometry of
Ecological Interactions: Symplifying Spatial Complexity (U Dieckmann, R. Law, JAJ Metz, editors).
Cambridge University Press, Cambridge, pages 412–455, 2000.

[14] M. Doebeli. A quantitative genetic competition model for sympatric speciation. Journal of evolutionary

biology, 9(6):893–909, 1996.

[15] Doorn, U. Dieckmann, and F. J. Weissing. Sympatric Speciation by Sexual Selection : A Critical Reeval-

uation. The American Naturalist, 163(5), 2004.

[16] S. Ethier and T. Kurtz. Markov processes: Characterization and convergence, 1986, 1986.
[17] N. Fournier and S. M´el´eard. A microscopic probabilistic description of a locally regulated population and

macroscopic approximations. The Annals of Applied Probability, 14(4):1880–1919, 2004.

[18] A. D. Freidlin, Mark Iand Wentzell. Random perturbations of dynamical systems, volume 260. Springer,

1984.

[19] S. Gavrilets. Models of speciation: Where are we now? Journal of heredity, 105(S1):743–755, 2014.

26

CAMILLE CORON, MANON COSTA, H´EL`ENE LEMAN, AND CHARLINE SMADI

[20] A. Griﬃths, J. Miller, D. Suzuki, R. Lewontin, and W. Gelbart. An Introduction to Genetic Analysis.

W.H. Freeman, New-York, 7th ed. edition, 2000.

[21] M. P. Haesler and O. Seehausen. Inheritance of female mating preference in a sympatric sibling species
pair of lake victoria cichlids: implications for speciation. Proceedings of the Royal Society of London B:
Biological Sciences, 272(1560):237–245, 2005.

[22] H. Hollocher, C.-T. Ting, F. Pollack, and C.-I. Wu. Incipient speciation by sexual isolation in drosophila
melanogaster: variation in mating preference and correlation between sexes. Evolution, pages 1175–1181,
1997.

[23] A. S. Kondrashov and M. Shpak. On the origin of species by means of assortative mating. Proceedings

of the Royal Society of London B: Biological Sciences, 265(1412):2273–2278, 1998.

[24] J. P. LaSalle. Some extensions of liapunov’s second method. Circuit Theory, IRE Transactions on,

7(4):520–527, 1960.

[25] H. Leman. Convergence of an inﬁnite dimensional stochastic process to a spatially structured trait

substitution sequence. arXiv preprint arXiv:1509.02022, 2015.

[26] T. C. Mendelson and K. L. Shaw. Sexual behaviour:

rapid speciation in an arthropod. Nature,

433(7024):375–376, 2005.

[27] L. K. M’Gonigle, R. Mazzucco, S. P. Otto, and U. Dieckmann. Sexual selection enables long-term coex-

istence despite ecological equivalence. Nature, 484(7395):506–509, 2012.

[28] M. Nei. Molecular population genetics and evolution. North-Holland Publishing Company., 1975.
[29] D. Otte. Speciation in hawaiian crickets. Speciation and its Consequences, pages 482–526, 1989.
[30] M. G. Ritchie. Sexual selection and speciation. Annual Review of Ecology, Evolution, and Systematics,

38(1):79–102, 2007.

[31] R. Rudnicki and P. Zwole´nski. Model of phenotypic evolution in hermaphroditic populations. Journal of

mathematical biology, 70(6):1295–1321, 2015.

[32] O. Seehausen, Y. Terai, I. Magalhaes, K. Carleton, H. Mrosso, R. Miyagi, I. van der Sluijs, M. Schneider,
M. Maan, H. Tachida, H. Imai, and N. Okada. Speciation through sensory drive in cichlid ﬁsh. Nature,
455(7213):620–626, 2008.

[33] O. Seehausen and J. Van Alphan. Can sympatric speciation by disruptive sexual selection explain rapid

evolution of cichlid diversity in Lake Victoria ? Ecology Letters, pages 262–271, 1999.

[34] K. L. Shaw and Y. M. Parsons. Divergence of mate recognition behavior and its consequences for genetic

architectures of speciation. The American Naturalist, 159(S3):S61–S75, 2002.

[35] C. Smadi. An eco-evolutionary approach of adaptation and recombination in a large population of varying

size. Stochastic Processes and their Applications, 125(5):2054–2095, 2015.

[36] G. Van Doorn, A. Noest, and P. Hogeweg. Sympatric speciation and extinction driven by environ-
ment dependent sexual selection. Proceedings of the Royal Society of London B: Biological Sciences,
265(1408):1915–1919, 1998.

Laboratoire de Math´ematiques d’Orsay, Univ. Paris-Sud, CNRS, Universit´e Paris-Saclay,

91405 Orsay, France

E-mail address: camille.coron@math.u-psud.fr

Institut de Math´ematiques de Toulouse. CNRS UMR 5219, Universit´e Paul Sabatier, 118

route de Narbonne, F-31062 Toulouse cedex 09

E-mail address: manon.costa@math.univ-toulouse.fr
CMAP, ´Ecole Polytechnique CNRS, Universit´e Paris-Saclay, Route de Saclay, 91128 Palaiseau,

France

E-mail address: leman@cmap.polytechnique.fr

IRSTEA UR LISC, Laboratoire d’ing´enierie des Syst`emes Complexes, 9 avenue Blaise-Pascal

CS 20085, 63178 Aubi`ere, France

E-mail address: charline.smadi@polytechnique.edu

