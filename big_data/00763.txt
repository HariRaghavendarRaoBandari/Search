6
1
0
2

 
r
a

M
2

 

 
 
]
T
N
h
t
a
m

.

[
 
 

1
v
3
6
7
0
0

.

3
0
6
1
:
v
i
X
r
a

AN ALGORITHM FOR COMPUTING THE

REDUCTION OF 2-DIMENSIONAL CRYSTALLINE

REPRESENTATIONS OF Gal(Qp/Qp)

SANDRA ROZENSZTAJN

Abstract. We describe an algorithm to compute the reduction
modulo p of a crystalline Galois representation of dimension 2 of
Gal(Qp/Qp) with distinct Hodge-Tate weights via the semi-simple
modulo p Langlands correspondence. We give some examples com-
puted with an implementation of this algorithm in SAGE.

1. Introduction and notation

Let V be an irreducible crystalline representation of Gal(Qp/Qp),
with distinct Hodge-Tate weights. Our goal is to give an algorithm to
compute the semi-simpliﬁcation V ss of the reduction modulo p of V .
There are several ways to approach this problem. The ﬁrst is to
use global methods, using congruences between modular forms. This
method has already been used extensively by Savitt-Stein and Buz-
zard, see for example [11, Paragraph 6.2]. Another way is to use local
methods coming from p-adic Hodge theory. One such algorithm is de-
scribed in [5] and uses (φ, Γ) modules, another one is described in [14]
and makes use of Breuil-Kisin modules. Both these methods have the
drawback that they require to work with complicated objects, and they
have not yet been implemented.

The algorithm we describe requires only to do linear algebra in sim-
ple rings such as Z/pnZ. For this we use the modulo p Langlands
correspondence, and its compatibility with the p-adic Langlands corre-
spondence. The representation V we are interested in can be described
(up to twist) by an integer k ≥ 2, which is such that V has Hodge-Tate
weights 0 and k − 1, and an element ap of Qp with positive valua-
tion. We denote by Vk,ap this irreducible crystalline representation of
Gal(Qp/Qp). By the modulo p Langlands correspondence, the reduc-
tion V ss
k,ap we are looking for is determined by a smooth representation
ss
Θ
k,ap
in terms of k and ap. So the problem is to compute the isomorphism
class of Θ

ss
k,ap of GL2(Qp) over Fp, and we can give an explicit formula for Θ

ss
k,ap from this formula.

The idea of using this correspondence to compute reduction modulo
p of Galois representations has already been used several times (see
[12, 13, 15, 8, 9, 1]) to do computations in small slope. They can

1

2

SANDRA ROZENSZTAJN

in fact be used to compute the reduction in any slope. We describe
the general method, and how it can be implemented on a computer.
ss
One diﬃculty is that the representation Θ
k,ap is of inﬁnite dimension,
so we have to understand how to compute it from ﬁnite-dimensional
data. This gives rise to the main limitation of this algorithm, which
is that only very small values of the prime p, and not too large values
of the weight k, allow for manageable dimensions for the vector spaces
we manipulate. We also give some examples computed thanks to an
implementation of the algorithm using SAGE ([18]).

1.1. Notation. Denote by G the group GL2(Qp), Z its center, and K
the subgroup GL2(Zp).

We write GQp for the group Gal(Qp/Qp). Let ap be in Qp with
positive valuation, and k ≥ 2 be an integer. We denote by Vk,ap be
the irreducible crystalline representation of GQp of dimension 2 with
Hodge-Tate weights {0, k − 1} and such that the trace of φ on the
associated ﬁltered φ-module is ap.
Let ω be the mod p cyclotomic character, or the character of Q×
p
corresponding to it via local class ﬁeld theory. For any λ ∈ F
p , let
unr(λ) be the unramiﬁed character of Q×
p such that unr(λ)(p) = λ.
We also denote by ω2 a Serre fundamental character of level 2 on the
inertia subgroup.

×

Let v be the valuation on Qp normalized by v(p) = 1.

Let A by any Zp-algebra. For any non-negative integer s, let Syms A2
be the representation of K coming from the standard action of K on
A2. For any representation V of GL2(Zp), let V (i) = V ⊗ deti. For
a ≥ 0 and b ∈ Z/(p − 1)Z, let σa(b) = Syma F2
p ⊗ detb. Then the σa(b)
for 0 ≤ a ≤ p − 1 are exactly the irreducible representations of K with
coeﬃcients in Fp, and any irreducible representation of K on a ﬁeld
of characteristic p comes from these representations by base change.
We will also denote by σa(b) the base change of this representation to
another ﬁeld of characteristic p, or σa(b)E if it is necessary to indicate
the ﬁeld E.

If n is an integer, [n] denotes the unique integer in {1, . . . , p − 1}

that is congruent to n modulo p − 1.

2. Irreducible representations of G in characteristic p
2.1. The tree. Let T be the tree of SL2(Qp). Its vertices are indexed
by the homothety classes of lattices in Q2
p, and there is an edge between
[L] and [L′] if an only if there are representatives with L′ ⊂ L and
[L : L′] = p. The vertices are also indexed by G/KZ, and G acts on
the tree by left translation.

AN ALGORITHM

3

n,µ =  pn µ

0

0

cardinality pn.

We give a system of representatives of G/KZ. Let I0 = {0}, I1 =
{0} ∪ µp−1, and for any n ≥ 1, In = {Pn−1
i=0 λipi, λi ∈ I1}. Then In has
pµ pn+1!. Then
1!, and g1
If µ ∈ In, we let g0
the set of the gε
n,µ for ε ∈ {0, 1}, n ≥ 0, µ ∈ In form a system of
representatives of G/KZ and so is naturally in bijection with the set
of vertices of T .
Moreover, g0
n,µ is at distance
n + 1 from 1. We denote by Cn the circle of radius n with center in 1,
and Bn the ball of radius n.

n,µ is at distance n from 1 = g0

n,µ =   1

0,0, and g1

2.2. Compact induction. Let (ρ, V ) be a ﬁnite-dimensional repre-
sentation of KZ with coeﬃcients in some ring. We denote by I(V ) the
compact induction indG
KZ V . We denote by [g, v], g ∈ G and v ∈ V ele-
ments of this module, where [g, v] is the function that send γ to ρ(γg)v
if γg ∈ KZ, and sends γ to 0 if γg 6∈ KZ. The action of G on these
elements is given by γ[g, v] = [γg, v], and moreover for all κ ∈ KZ we
have that [gκ, v] = [g, ρ(κ)v].
Let X be a subset of the set of vertices of T . We say that f ∈ I(V )
has support in X if it can be written as a (ﬁnite) sum P[gi, vi] with
0 p!
Let V be a representation of K of the form σr(s). We let  p 0

the class of gi in X.

act trivially on V , so that it becomes a representation of KZ. There
is a G-equivariant Hecke operator T acting on I(V ), deﬁned in [2] (see
Paragraph 6.2 for an explicit description of this operator).

2.3. Irreducible representations of G over Fp. In this Paragraph
all representations have coeﬃcients in Fp.

×

If r is an integer in {0, . . . , p − 1}, χ a smooth character of Q×

p , and
λ ∈ F
p , we denote by π(r, λ, χ) the representation (I(σr)/(T − λ)) ⊗
(χ ◦ det). Note that I(σa(b))/(T − λ) = π(a, λ, ωb).
We can make the list of irreducible smooth admissible representations
of G with coeﬃcients in Fp, following [2], [3] and [10]. The irreducible
representations are:

(1) π(r, 0, χ)
(2) π(r, λ, χ) for λ ∈ F
(3) St⊗ (χ ◦ det)
(4) χ ◦ det

×

p and (r, λ) 6∈ {(0,±1), (p − 1,±1)}.

Moreover, π(r, 0, χ) = π(r, 0, χ unr(−1)) = π(p−1−r, 0, χωr), π(0, λ, χ) =
π(p − 1, λ, χ) ; for any λ 6= ±1, π(r, λ, χ) = π(r,−λ, χ unr(−1)) ; and
π(0, λ, χ)ss = π(p − 1, λ, χ)ss = St⊗ (χ unr(λ) ◦ det) ⊕ (χ unr(λ) ◦ det)
if λ = ±1. There are no other isomorphims between the irreducible

4

SANDRA ROZENSZTAJN

representations than the ones coming from the previous list. In partic-
ular, any irreducible representation is a quotient of an I(σr)⊗ (χ ◦ det)
for some r and χ, and r and χ are almost entirely determined by the
quotient itself.

Proposition 2.3.1. Let Q be a ﬁnite length quotient of I(σa(b)). Then
the Jordan-Hoelder factors of Q are of the form π(a, λ, ωb) for some
λ ∈ Fp if a 6∈ {0, p− 1}. If a ∈ {0, p− 1}, the Jordan-Hoelder factors of
Q are of the form π(a, λ, ωb) for λ 6∈ {±1}, or St ⊗(cid:16)ωb unr(±1) ◦ det(cid:17)
or (cid:16)ωb unr(±1) ◦ det(cid:17).

Here is a slightly more precise statement, which follows immediatly

the results of [2, 3, 10] although it is not stated explicitely there:

Proposition 2.3.2. Let Q be an irreducible representation of G, and
π a nonzero map I(σa(b)) → Q. Then there exists a unique λ such that
π is zero on (T − λ)I(σa(b)), and then Q is isomorphic to π(a, λ, ωb) if
(a, λ) 6∈ {(0,±1), (p−1,±1)}, or Q is isomorphic to St ⊗(cid:16)ωb unr(λ) ◦ det(cid:17)
if a = p − 1 and λ = ±1, or Q is isomorphic to (cid:16)ωb unr(λ) ◦ det(cid:17) if
a = 0 and λ = ±1.
The point is any non-zero map I(σa(b)) → Q where Q is irreducible

is (a scalar multiple of) the obvious map, and not something else.

Proof. By Frobenius reciprocity we have:

HomG(I(σa(b)), Q) = HomK(σa(b), Q|K) = HomK(σa(b), socK(Q))

But we know that for any irreducible Q, every representation that
appears in socK(Q) appears with multiplicity one (this is a standard
computation for the principal series case, and [10, Théorème 3.2.4] for
the supersingular case). So the dimension of HomG(I(σa(b)), Q) is at
most one.
(cid:3)

2.4. Deﬁnition over a subﬁeld. Let E be a ﬁnite extension of Fp.
It follows from the deﬁnition of π(r, λ, 1) in [2] that:

Proposition 2.4.1. The representation π(r, λ, 1) has a model over E
if and only if λ ∈ E.

3. Modulo p and p-adic Langlands correspondence

3.1. The correspondence modulo p. The semi-simple modulo p
Langlands correspondence, deﬁned in [10], relates semi-simple repre-
sentations of dimension 2 of GQp over Fp with some ﬁnite length smooth
admissible semi-simple representations of G over Fp. Note that semi-
simple representations of dimension 2 of GQp are of two kinds: either
they are reducible, or they are isomorphic to some (ind ωa
2) ⊗ χ, where
2 is the unique representation with determinant ωa and restriction
ind ωa
to inertia isomorphic to ωa

2 ⊕ ωpa
2 .

AN ALGORITHM

5

More precisely, if V is a representation of dimension 2 of GQp with
coeﬃcients in Fp, we denote by Π(V ) the attached representation of G:

Theorem 3.1.1. The semi-simple modulo p Langlands correspondence
is as follows:

2

• If V = (ind ωr+1
• If V = (unr(λ)ωr+1 ⊕ unr(λ−1)) ⊗ χ then Π(V ) = π(r, λ, χ)ss ⊕
π([p − 3 − r], λ−1, ωr+1χ)ss

) ⊗ χ then Π(V ) = π(r, 0, χ).

3.2. Rationality questions. In fact, the semi-simple modulo p Lang-
lands correspondences attaches representation of G with coeﬃcients in
E to representations of GQp deﬁned over E, but their irreducible com-
ponents are not necessarily deﬁned over E.

Let ρ a 2-dimensional semi-simple representation of GQp over Fp,
with determinant equal to a power of the cyclotomic character ω. If
ρ is irreducible, it as a model over Fp. Otherwise, it is isomorphic to
some ωa unr(λ) ⊕ ωb unr(λ−1).
p . Suppose that ωa unr(λ)⊕ ωb unr(λ−1)
Proposition 3.2.1. Let λ ∈ F
has a model over E. Then λ + λ−1 ∈ E. If a 6= b modulo p − 1, then
λ ∈ E.
Proof. Consider the traces of the image by ρ of some elements of GQp.
(cid:3)

×

The analogue of Proposition 3.2.1 on the side of representations of

×

G is:
Proposition 3.2.2. Let λ ∈ F
p , and χ a power of ω. Suppose that
π(r, λ, χ)ss ⊕ π([p − 3 − r], λ−1, ωr+1χ)ss is deﬁned over E. Then λ +
λ−1 ∈ E.
If p > 2 and r 6= p − 2, then λ ∈ E, and in particular each Jordan-
Hoelder factor of π(r, λ, χ)ss ⊕ π([p − 3 − r], λ−1, ωr+1χ)ss is deﬁned
over E.
Moreover, if λ 6∈ E then π(r, λ, χ) ⊕ π([p − 3 − r], λ−1, ωr+1χ) is

irreducible over E.

Proof. We can deduce the ﬁrst two parts from Proposition 3.2.1 via the
semi-simple Langlands correspondence modulo p (or we could prove it
directly).

Suppose now that λ 6= ±1, so that π(r, λ, χ) and π([p−3−r], λ−1, ωr+1χ)

are both irreducible. Suppose that π(r, λ, χ)⊕ π([p− 3− r], λ−1, ωr+1χ)
is reducible over E, then π(r, λ, χ) and π([p − 3 − r], λ−1, ωr+1χ) are
both deﬁned over E, so by Proposition 2.4.1 we have that λ ∈ E. (cid:3)
3.3. Jordan-Hoelder factors. If Π is a ﬁnite length representation
of G deﬁned over E, we denote by JH(Π) the set of the irreducible
representations that appear as its Jordan-Hoelder factors (taking into
account multiplicities) as a representation with coeﬃcients in E.

6

SANDRA ROZENSZTAJN

Let J H be the set of sets that can appear as JH(Π(V )) for some
2-dimensional Galois representation V deﬁned over E such that det V
is a power of the cyclotomic character. We can describe J H explicitly
using Proposition 3.1.1 and Proposition 3.2.2:

Proposition 3.3.1. In what follows, χ always denotes a power of the
cyclomotic character. J H contains exactly the following sets:

(1) The singleton {π(r, 0, χ)} for any r and any χ
(2) The set {π(r, λ, χ), π([p − 3 − r], λ−1, χωr+1)} for any χ, any
λ ∈ E × and any r such that either r is diﬀerent from 0, p − 3,
p − 1 or λ 6∈ {±1}.
(3) The singleton {π(p − 2, λ, χ) ⊕ π(p − 2, λ−1, χ)} for any χ, and
any λ ∈ Fp \ E such that λ + λ−1 ∈ E.
(4) For p > 3 and λ = ±1 and any χ, the set {St⊗ (unr(λ)χ ◦ det) , (unr(λ)χ ◦ det) , π(p−
3, λ−1, χω)}.
(5) For p = 3 and λ = ±1 and any χ, the set {St⊗ (unr(λ)χ ◦ det) , (unr(λ)χ ◦ det) , St⊗ (unr
(6) For p = 2 and any χ, the set {St ⊗ (χ ◦ det) twice, (χ ◦ det) twice}
Note that in case (2) the set can be twice the same representation,
when r = p − 2 and λ = ±1. Except in this case and case (6), the sets
are in fact made of distinct representations.

The important point here is:

Proposition 3.3.2. JH(Π(V )) is uniquely determined by any of the
Jordan-Hoelder factors that is contains.

Fact 3.3.3.

We can also extract from Proposition 3.3.1 the following remarks:
(1) For any (r, λ, χ) there exists a unique S ∈ J H con-
taining one Jordan-Hoelder factor of π(r, λ, χ), and then it con-
tains all of them.

(2) For any µ ∈ E, all the Jordan-Hoelder factors of I(σp−2(b)E)/(T 2−
(3) If p = 2 and any µ ∈ E, all the Jordan-Hoelder factors of

µT + 1) are in the same S ∈ J H.
I(σ1,E)/(T 2 − µT + 1) are in the same S ∈ J H.

3.4. The p-adic correspondence in the crystalline case.

3.4.1. The correspondence. The p-adic Langlands correspondence at-
taches to a representation V of dimension 2 of GQp over some ﬁnite
extension of Qp a unitary Banach representation of G over the same
ﬁeld.
In the case where the Galois representation is irreducible and
crystalline with distinct Hodge-Tate weights, this unitary Banach rep-
resentation has an explicit description, as was conjectured in [11] and
proved in [6]. Let Vk,ap be such a crystalline representation. We denote
Π(Vk,ap) by Πk,ap.

If ap 6∈ {±(1+p)pk/2−1}, we can describe Πk,ap as follows. Let r = k−
2. Let K be a ﬁnite extension of Qp containing ap, with ring of integers
R and residue ﬁeld E, so that the Galois representation Vk,ap has a

AN ALGORITHM

7

model over K. The representation I(Symr K2)/(T−ap)I(Symr K2) of G
has a natural G-invariant lattice which is the image Θk,ap of I(Symr R2).
Then Πk,ap is the completion of I(Symr K2)/(T − ap)I(Symr K2) with
respect to this lattice.
Moreover, this correspondence is compatible with reduction modulo
p by [4]. This means that, for ap 6∈ {±(1+p)pk/2−1}, the semi-simpliﬁed
ss
reduction Θ
k,ap
by the semi-simple Langlands correspondence modulo p. So the com-
putation of Θ

ss
k,ap is the semi-simple representation of G attached to V

k,ap is equivalent to the computation of V ss

ss

k,ap.

3.4.2. A special case. When ap is in {±(1+p)pk/2−1}, we can still deﬁne
the G-representation Θk,ap but it is not related to V ss
k,ap. However we
can still compute V ss
k,ap using the fact that for a ﬁxed k it is locally
constant in ap with an explicit radius of constancy. Indeed, the results
ss
of [7] show that if v(ap) > ⌊(k − 2)/(p − 1)⌋ then V
k,ap is isomorphic
to V ss
k,0. So except when p = 2, or p = 3 and k is even, if ap is in
{±(1 + p)pk/2−1} we can compute V ss
k,0 (for which we actually
know the value, see [11, Proposition 6.1.2]). In any case, we also know
p) > 2v(ap) + ⌊p(k − 1)/(p − 1)2⌋
by [5, Theorem A] that if v(ap − a′
then V ss
k,ap is isomorphic to V ss
p close enough
k,a′
p
to ap to compute the reduction.

. So we can choose an a′

k,ap as V ss

3.4.3. Notation. Let Mk,ap be the submodule (T − ap)I(Symr K) ∩
I(Symr R2) of I(Symr K2). It is G-invariant and is a free submodule of
I(Symr R2), and Θk,ap = I(Symr R2)/Mk,ap. We denote by Mk,ap the
image in I(Symr E2) of Mk,ap so that Θk,ap = I(Symr E2)/Mk,ap.
3.5. Identifying V k,ap from Jordan-Hoelder factors of Θk,ap.

Proposition 3.5.1. Let V be a representation of GQp of dimension
2. Suppose that we have a surjection Π′ → Π(V ) where Π′ is a ﬁnite
length representation of G. Suppose that there exists a unique S ∈ J H
such that S ⊂ JH(Π′). Then JH(Π(V )) = S.

In the situation that interests us, Π(V ) = Θk,ap = I(σk−2,E)/Mk,ap,
and we will try to ﬁnd a subspace M ′ of Mk,ap with Π′ the quotient of
I(σk−2,E) by the subspace generated by M ′.

4. Computing the reduction from a set of relations
In this Section we write Θ for Θk,ap and r = k − 2. We will explain
how to obtain information on JH(Θ) using subspaces of ﬁnite dimension
of Mk,ap. We denote by E a ﬁnite ﬁeld containing the residue ﬁeld of
Qp(ap).

8

SANDRA ROZENSZTAJN

4.1. Use of a ﬁltration. Suppose that we are given a decreasing ﬁl-
tration (Vi) of σr,E, with V0 = σr,E and such that Vi/Vi+1 = Ji is an
irreducible representation of K. Then Ji is isomorphic to σai(bi)E for
some ai ∈ {0 . . . , p − 1} and some bi ∈ Z/(p − 1)Z. We describe such
a ﬁltration in Section 5.

Let Λ = I(σr,E). Then we have a ﬁltration (Λi) of sub-G-representations

by setting Λi = I(Vi). Let Qi = Λi/Λi+1 = I(Ji). It is endowed with a
Hecke operator Ti as in Paragraph 2.2.

From the ﬁltration (Λi) we get a ﬁltration (π(Λi)) on Θ, and we let
Fi = π(Λi)/π(Λi+1), so that Fi is a quotient of Qi. Let πi be the map
Qi → Fi. Note that each Fi is deﬁned over E.
Theorem 4.1.1. For each i, at least one of the following is true:

(1) Fi = 0.
(2) πi((Ti − λ)Qi) = 0 for some λ ∈ E.
(3) πi((T 2

i − µTi + 1)Qi) = 0 for some µ ∈ E.

Moreover, we can be in case (3) but not (2) only for ai = p − 2, or
p = 2.

Proof. Each Fi is of ﬁnite length, and JH(Θ) = ∪i JH(Fi).
most 2. If p = 2 then Fi is of length at most 4.

From Proposition 3.3.1, we see that if p > 2, each Fi is of length at

Suppose ﬁrst that Fi is irreducible. Then it is a quotient of Qi/(Ti −
λ)Qi for some λ ∈ E, by Proposition 2.3.2. So we are in case (2).
Suppose now that Fi has length at least 2. It can happen only in the
cases where ai is 0, p− 1 or p− 2. We treat these cases in the following
lemmas, and we see that: either p > 2 and ai = 0 or p − 1, and then
we are in case (2), or ai = p − 2 and we are in case (3), or p = 2, and
then we are in case (2) or (3) depending on the length of Fi.
As each Fi is deﬁned over E, then by Proposition 2.4.1, if we are in
case (2) then λ ∈ E. If we are in case (3) but not (2), then µ ∈ E. In
particular, if the set of Jordan-Hoelder factors is as in (3) of Proposition
3.3.1, then there exists only one i such that Fi 6= 0 and it is in the case
(3) but not (2).

(cid:3)

Lemma 4.1.2. Suppose p > 2. Let F be a quotient of I(σp−2) and
JH(F ) = {π(p−2, λ, 1), π(p−2, λ−1, 1)}. Then the given map I(σp−2) →
F is zero on (T 2− (λ + λ−1)T + 1)I(σp−2) and induces an isomorphism
from I(σp−2)/(T 2 − (λ + λ−1)T + 1) to F .
Proof. Suppose we have a surjective map π : F → π(p − 2, λ, 1), and
let α be the given surjection I(σp−2) → F . Then π ◦ α is zero on
(T − λ)I(σp−2) by Proposition 2.3.2. Let β = α ◦ (T − λ). Then
im β ⊂ ker π, and in fact im β = ker π otherwise β = 0 and F =
I(σp−2)/(T − λ). So im β is isomorphic to π(p− 2, λ−1, 1), and β is zero
on (T − λ)−1I(σp−2). So α is zero on (T 2 − (λ + λ−1)T + 1)I(σp−2),

AN ALGORITHM

9

and F is a quotient of I(σp−2)/(T 2 − (λ + λ−1)T + 1), and so is equal
to it.

(cid:3)

Lemma 4.1.3. Suppose p = 2, i = 0 or 1 and F is a quotient of I(σi)
with JH(F ) ⊂ {1, 1, St, St}. Then the map α : I(σi) → F is zero on
(T 2 + 1)I(σi).

Proof. Suppose i = 0. Only St can be a quotient of I(σ0), so there
exists a surjective map π : F → St. Then by Proposition 2.3.2, π ◦ α
is zero on (T − 1)I(σ0). Let β = α ◦ (T − 1). Let F ′ = im β, then
F ′ ⊂ ker π so JH(F ′) ⊂ {1, 1, St}. As before, there exists a surjection
π′ : F ′ → St and so a surjection π′ ◦ β : I(σ0) → St, so π′ ◦ β is
zero on (T − 1)I(σ0). Let γ = β ◦ (T − 1), then im γ ⊂ ker π′, so
JH(im γ) ⊂ {1, 1}, and so in fact γ = 0. So α ◦ (T − 1)2 is zero.
For i = 1 the proof is the same but with the role of 1 and St reversed.
(cid:3)

We state the following lemmas without proof, as their proofs are very

similar to the previous ones:
Lemma 4.1.4. Let F be a quotient of I(σ0) and JH(F ) = {St, 1}.
Then F is the quotient of I(σ0) by (T − 1).
Lemma 4.1.5. Let F be a quotient of I(σp−1) and JH(F ) = {St, 1}.
Then F is the quotient of I(σp−1) by (T − 1).
Lemma 4.1.6. Suppose p = 2, i = 0 or 1 and F is a quotient of I(σi)
with JH(F ) = {π(0, λ, 1), π(0, λ−1, 1)} for some λ 6∈ {0, 1}. Then F is
the quotient of I(σi) by (T 2 − (λ + λ−1)T + 1)I(σi).
4.2. Computing JH(Θ). Suppose now that in addition to the ﬁltra-
tion, we are given for each i an element vi ∈ Λi such that the image of
vi in Qi generates it as a G-representation, and elements w1,i and w2,i
in Λi whose image in Qi is equal to Tivi and T 2

i vi respectively.

Suppose moreovoer that we are given a subspace M ′ of Mk,ap. Then

we can answer the following questions:

(1) is vi in M ′ + Λi+1 ?
(2) is w1,i − λvi in M ′ + Λi+1 for some λ ∈ E ?
(3) is w2,i − µw1,i + 1 in M ′ + Λi+1 for some µ ∈ E ?
If the answer to the ﬁrst question is positive, then Fi = 0. If the
answer to the second question is positive, then Fi is a quotient of
If the answer to the third question
Qi/(Ti − λ)Qi for the given λ.
is positive, then Fi is a quotient of Qi/(T 2
i − µTi + 1)Qi for the given
µ.

Proposition 4.2.1. Let M ′ be a ﬁnite-dimensional subspace of Mk,ap.
Suppose that: for each i, we can answer positively to one of the three
questions above, and moreover, the Jordan-Hoelder factors of the rep-
resentations Qi/(T − λ)Qi or Qi/(T 2− µT + 1)Qi that appear are all in

10

SANDRA ROZENSZTAJN

the same S ∈ J H. Then M ′ contains enough information to compute
JH(Θ).

Proof. This is a reformulation of Proposition 3.5.1, as Θ is a quotient
of I(σr,E) by E[G]M ′.
(cid:3)

Corollary 4.2.2. There exists a ﬁnite-dimensional subspace M ′ of
Mk,ap that contains enough information to determine the value of JH(Θ).

Remark 4.2.3. This does not mean that for this M ′ we know exactly
which Fi contributes which Jordan-Hoelder factor of Θ. For example
in the case where Qi/(Ti − λ)Qi is reducible, we are not able to say
using only this information if Fi is equal to all of Qi/(Ti − λ)Qi or if it
is a strict quotient of it. However this is not necessary to know this to
determine JH(Θ).

5. Description of the filtration on Symr E2

We describe an explicit ﬁltration on Symr E2 that can be used in the
computations of the previous section, which has interesting properties
with respect to these computations.

We identify Symr E2 with the space E[X, Y ]r of homogeneous poly-

nomials of degree r with coeﬃcients in E. Let θ = X pY − XY p.
Let m = ⌊r/(p + 1)⌋. If u < m, we set ηu,v = θuX vY r−u(p+1)−v if
0 ≤ v ≤ p − 1, and ηu,p = θuX r−u(p+1). If 0 ≤ v ≤ r − m(p + 1) we set
ηm,v = θmX vY r−m(p+1)−v.

5.1. Start of the ﬁltration.

5.1.1. Subspace generated by θ. Let V0 = E[X, Y ]r.

We see easily that for all g ∈ K, we have g · θ = det(g)θ. So the
subspace of V0 generated by θ is invariant under the action of K, we
call it V2.

A basis of V0/V2 is given by the classes of X r, Y r and the elements
X iY r−i for 1 ≤ i ≤ p − 1, as X iY r−i = X p−1+iY r−i−p+1 mod θ. That
is, a basis of V0/V2 is given by the η0,v for 0 ≤ v ≤ p (or v ≤ r if r ≤ p).
5.1.2. Reﬁning the ﬁltration. Let V1 the subspace of V0 generated by
V2 and X r. Let J0 = V0/V1 and J1 = V1/V2. Then J1 is generated by
the elements (uX + vY )r for (u : v) ∈ P1(Fp). Another generating set
is also given by X r, Y r and the elements Si for 0 ≤ i ≤ p − 2, where
Si = Pj≥0(cid:16)
j(p−1)+i(cid:17)X j(p−1)+iY r−j(p−1)−i (some of these sums can be
zero).
Lemma 5.1.1. Let 0 ≤ i ≤ p − 2. Then Si,r := Pj(cid:16)
j(p−1)+i(cid:17) is equal
to (cid:16)[r]
i (cid:17) modulo p, except in the case [r] = p − 1 and i = 0 where the

sum equals 2 modulo p.

r

r

AN ALGORITHM

11

Proof. Let f (X) = X −i(1 + X)r = Pj≥i(cid:16)r
j! = −Xj≥0 
Xx∈F∗
Moreover the value of f (x) for x ∈ F×

f (x) = − Xj=i mod p−1 r

p

j(cid:17)X j−i. We have
j(p − 1) + i! = −Si,r

r

p depends only on r modulo
p − 1, that is [r]. So we only need to compute the sum when r = [r],
and then there is only one term, or 2 when [r] = p − 1 and i = 0. (cid:3)
Corollary 5.1.2. J1 is of dimension [r] + 1, and a basis of J1 is given
by the elements η0,v for 0 ≤ v < [r] and v = p. A basis of J0 is given
by the elements η0,v for [r] ≤ v ≤ p − 1.
Proof. Modulo V2, X j(p−1)+iY r−j(p−1)+i and X j ′(p−1)+iY r−j ′(p−1)+i are
equal, except when one of these terms is either X r or Y r. So Lemma
5.1.1 allows us to compute Si modulo V2, which gives the results for
J1.
(cid:3)

Proposition 5.1.3. The representation J1 is isomorphic to σ[r], and
J0 to σp−1−[r]([r]). This extension is split if and only if [r] = p − 1.
Proof. It is well known that V0/V2 is an extension of σp−1−[r]([r]) by
σ[r] (see for example [16]). The fact that this extension is split if and
only if [r] = p − 1 is a consequence of Proposition 5.1.4 below. So J1
is the unique subrepresentation of dimension [r] + 1 of V0/V2, which is
σ[r].
(cid:3)

We write a0 = p − 1 − [r], a1 = [r], b0 = [r], b1 = 0, so that Ji is

isomorphic to σai(bi) for i = 0, 1.

5.1.3. Generating elements. A simple computation shows:

Proposition 5.1.4. Let σa(b) be identiﬁed with the vector space E[x, y]a.
If a < p− 1, then Exa is the line of elements on which the matrix ( u 0
0 v )
acts by ua+bvb, and moreover xa is invariant by the matrix ( 1 1
0 1 ). If
0 v ) acts by ubvb,
a = p − 1, Exp−1 is the line on which the matrix ( u 0
and which is invariant by the matrix ( 1 1

0 1 ).

We set e0 = η0,p−1 and e1 = η0,p.
Then for i = 0, 1, ei generates Ji as a GL2(Zp)-representation. More-
over, in the isomorphism Ji = σai(bi) = E[x, y]ai, the image of ei cor-
responds to xai (up to some scalar) by Proposition 5.1.4.
5.2. Filtration by powers of θ. For all 0 ≤ i ≤ m, the multiplication
by θi induces a linear map E[X, Y ]r−i(p+1) → E[X, Y ]r, and the image
is a subrepresentation isomorphic to σr−i(p+1)(i)E. We denote it by V2i.
By considering the analogue of V1 for E[X, Y ]r−i(p+1), and consider-
ing the multiplication by θi from E[X, Y ]r−i(p+1) to E[X, Y ]r for i ≤ m,
we reﬁne the ﬁltration (V2i) into a ﬁltration (Vi). Let Ji = Vi/Vi+1.
We set a2i+1 = [r − 2i], and b2i+1 = i, and a2i = p − 1 − [r − 2i], and

b2i = r − i. We get that Ji is isomorphic to σai(bi).

12

SANDRA ROZENSZTAJN

5.3. End of the ﬁltration. The subspace V2m is the smallest we can
obtain via powers of θ, but it is not necessarily irreducible. Let t be
the remainder of the Euclidean division of r by p + 1, so that r =
m(p + 1) + T . Then V2m = Et(m).

b2m = m.

If t ≤ p − 1 then V2m is irreducible. We set V2m+1 = 0, a2m = t,
If t = p then V2m is reducible. We denote by V2m+1 the subrep-
resentation generated by θmX p. Let V2m+2 = 0. Set a2m = p − 2,
b2m = m + 1, a2m+1 = 1, b2m+1 = m.
With these notations we have that Ji is isomorphic to σai(bi) as

before.

5.4. Basis and generators. We summarize here the explicit descrip-
tion of the elements of the ﬁltration.

5.4.1. A basis of Ji. The description of a basis of J0 and J1 generalizes
to all i: If i < m, J2i has a basis given by the ηi,v for [r−2i] ≤ v ≤ p−1,
and J2i+1 has a basis given by the ηi,v for 0 ≤ v < [r − 2i] and v = p.
If V2m+1 = 0, then J2m has a basis given by the ηm,v, 0 ≤ v ≤
r − m(p + 1).
If r = m(p+1)+p then J2m has a basis given by ηm,v for 1 ≤ v ≤ p−1,
and J2m+1 has a basis given by ηm,0 and ηm,p.

5.4.2. A generating element. If i < m we set e2i = ηi,p−1 and e2i+1 =
ηi,p.

If V2m+1 = 0 we set e2m = ηm,t.
If V2m+1 6= 0 we set e2m = ηm,p−1 and e2m+1 = ηm,p.
Then ei generates Ji = Vi/Vi+1 as a GL2(Zp)-representation. More-
over, in the isomorphism Ji = σai(bi) = E[x, y]ai, the image of ei
corresponds to xai (up to some scalar).

5.4.3. Elements vi. Let Λi = I(Vi), and denote by Ti the Hecke opera-
tor as in Paragraph 2.2 acting on Λi. We set vi = [1, ei].

if ai = 0. Then wi,1 = Tivi.

Let wi,1 = Pu∈I1[g0
Let wi,2 = Pu∈I2[g0
Pu∈I1[g1

1,u, ei] if ai > 0, and wi,1 = Pu∈I1[g0
2,u, ei] if ai > 0, and wi,2 = Pu∈I2[g0

i vi.

1,u, ei] + [1, ei] if ai = 0. Then wi,2 = T 2

1,u, ei] + [g1

0,0, ei]

2,u, ei] +

5.5. Properties of the ﬁltration. We summarize here some inter-
esting properties of this particular ﬁltration with respect to the com-
putations of Section 4. These facts come from [12, Remark 4.4]. They
allow us to know without computation the value of Fi for some steps
of the ﬁltration.

Lemma 5.5.1. If r ≥ d(p + 1), and f is homogeneous of degree r −
d(p + 1) and integral, then for all g, p−dT [g, θdf ] is integral.

AN ALGORITHM

13

Corollary 5.5.2. Suppose that v(ap) < d and r ≥ d(p + 1), then for
any f that is homogeneous of degree r − d(p + 1) and integral, θdf is
in Mk,ap. In particular, Fi = 0 for any i > 2⌈ap⌉.
Proposition 5.5.3. The element [g, X r] is in Mk,ap for any k and ap.

Corollary 5.5.4. For this ﬁltration, F1 = 0 for any k and ap.

6. Computing relations

In this section, we explain how to obtain ﬁnite-dimensional subspaces

of Mk,ap, in order to apply the results of Section 4.

6.1. Elementary divisors of submodules. In this paragraph we
study some general results. We denote by R any discrete valuation
ring, with uniformizer ̟, valuation v, residue ﬁeld E, and fraction
ﬁeld K. Let M be a submodule of Rn. We denote by m its dimension
as a free module over R.
Let π be the reduction modulo ̟ map from R to E, or Rn to En.

6.1.1. Elementary divisors. From the theory of elementary divisors, we
know that there exists a uniqueley determined list {d1, . . . , dm} of non-
negative integers, such that there exists a basis {e1, . . . , en} of Rn,
such that the set {̟diei}1≤i≤m is an R-basis of M. We call the dis the
elementary divisors of M in Rn. We denote by δM the maximum of the
di.

It is clear that:

Proposition 6.1.1. In Kn we have: ∪d(̟−dM ∩ Rn) = ̟−δM M ∩ Rn,
and δM is the smallest integer with this property.

For later use we reformulate the statement as:

Corollary 6.1.2. Suppose that M is the image of an injective linear
map t : Rm → Rn, which we extend to a map Km → Kn by linearity.
Then δM is the smallest of the integers d satisfying: for all w ∈ Km, if
t(w) ∈ Rn then w is in ̟−dRm.
6.1.2. Good bases of M. Let (ei)1≤i≤n a basis of Rn, we denote by λi
the i-th coordinate function, so that v = Pi λi(v)ei for all v ∈ Rn.
If x ∈ Rn is a non-zero vector, we deﬁne its valuation v(x) to be
inf 1≤i≤n v(λi(x)), and its normalization to be ˜x = ̟−v(x)x ∈ Rn.
Deﬁnition 6.1.3. Let (w1, . . . , wm) be a family of vectors of M. We
say that it is a good basis of M if: after reordering if necessary the
elements of the basis (ei), we have that λi(wi) 6= 0, v(λi(wi)) = v(wi),
and for all j < i, λj(wi) = 0.

Proposition 6.1.4. If (w1, . . . , wm) is a good basis of M, then it is a
basis of M and the elementary divisors of M are the v(wi) for 1 ≤ i ≤
m.

14

SANDRA ROZENSZTAJN

Proof. Consider the matrix of the coordinates of the wi in the basis of
the (ei) (reordered if necessary). After elementary operations on the
columns we get a diagonal matrix with diagonal elements the λi(wi).
(cid:3)

6.1.3. Finding a good basis. In order to ﬁnd a good basis of M, we
can use a variant of the Gauss algorithm. We start with a generating
family V for M, an empty list of indices I, and an empy list of vectors
V0.

(1) Find an element w ∈ V, and an index i ∈ I, such that we have
simultaneously v(λi(w)) = v(w) and v(λi(w)) = inf w′∈V v(λi(w′)).
If we can not do this, it means that the only vectors left in V
are zero, and we stop.
(2) Use (w, i) as a pivot, that is, for all other elements w′ ∈ V,
(3) Remove w from V and put it in an auxiliary list V0, and put i

replace w′ by w′ − (λi(w′)λi(w)−1) w.
at the end of the ordered list I. Then go back to step (1).

At the end of this process, we reorder {1, . . . , n} by putting ﬁrst the
elements of I in order, and then all remaining elements of {1, . . . , n}
in any order. Then the elements of V0 form a good basis of M.
Remark 6.1.5. Note that we still have many options as to how we select
a vector in step (1) of the algorithm.

6.1.4. Good bases up to ̟d.

Deﬁnition 6.1.6. Let d > 0 be an integer. A family (w1, . . . , ws) of
vectors of M is a good basis up to ̟d if (after reordering if necessary
the elements (ei)) we have that λi(wi) 6= 0, v(λi(wi)) = v(wi) ≤ d,
and for all j < i, v(λj(wi)) > d, and M is generated by the (wi) and
̟d+1Rn ∩ M.
Proposition 6.1.7. Let (w1, . . . , ws) be a good basis up to ̟d of M.
Then there exists a good basis (w′
m) of M such that v(wi) =
v(w′

i) and π( ˜wi) = π( ˜wi

1, . . . , w′

′) for all i ≤ s, and v(w′

i) > d for all i > s.

i = wi+(λ1(wi)λ1(w1)−1) w1.

Proof. First we replace each wi for i > 1 by w′
Then for all i > 1, we have λ1(w′
i) = 0, and moreover the coeﬃcients
of w′
i diﬀer from the coeﬃcients of wi by elements of valuation at least
′).
d + 1. In particular v(w′
We iterate this construction until we get a family of vectors (w′
i)1≤i≤s
that are a good basis up to ̟d satisfying moreover that for all j < i,
λj(w′
i) = 0, so they are part of a good basis of M. Then we take a
family of vectors in ̟d+1Rn ∩ M such that M is generated by the (w′
i)
and this family, and we apply the Gauss algorithm to it in order to get
a good basis of M.
(cid:3)

i) = v(wi) = v(λi(wi)) and π( ˜wi) = π( ˜wi

AN ALGORITHM

15

Proposition 6.1.8. Let d > 0 be an integer. Starting from a gener-
ating family for M, we can obtain the image of (R/̟d+1R)n of a good
basis up to ̟d by working only in (R/̟d+1R)n.

Proof. Start with a generating family for M, and consider its image in
(R/̟d+1R)n. We want to apply the same algorithm as described in
Paragraph 6.1.3, which needs some adaptations. We deﬁne the valua-
tion of a non-zero element of R/̟d+1R as the valuation of any of its
lifts to R. If a, b are two elements of R/̟d+1R with v(a) ≥ v(b), we
denote by ab−1 a choice of an element u of R/̟dR satisfying a = ub
(equivalently, the reduction modulo ̟d+1 of ˆaˆb−1 for a choice of lifts
ˆa, ˆb of a, b). With these deﬁnitions, we can apply the algorithm. In
step (2), note that the vector (λi(w′)λi(w)−1) w′ is not independant of
the choices made if v(w′) < v(w), but the new vector still has its i-th
coordinate equal to 0 in R/̟d+1R independently of the choices.

At the end of this algorithm, we get (after a reordering of the co-
ordinates if necessary) a family (wj) of vectors in (R/̟d+1R)n satis-
fying the properties: there exists s such that for j ≤ s, λj(wj) 6= 0,
v(λi(wj)) = v(wj), and for all i < j, λi(wj) = 0, and for j > s, wj = 0.
We need now to show that the set of the ﬁrst s vectors of this family
is the image in (R/̟d+1R)n of a good basis up to ̟d of M. For this,
we do to the family of vectors of M the same operations as we did
modulo ̟d+1, choosing in step (2) any choice of lift of the coeﬃcient
λi(w′)λi(w)−1. Then when we stop the algorithm for the vectors mod-
ulo ̟d+1, what we get for the original vectors in Rn is a family of s
vectors that is a good basis of M up to ̟d, and the rest is a family of
vectors with coeﬃcients in ̟d+1Rn.
(cid:3)

Corollary 6.1.9. Suppose that we start from a generating family that
is in fact a basis of M, and that in the process we do not obtain the
zero vector of (R/̟d+1R)n. Then the family we obtain at the end is
the reduction modulo ̟d+1 of a good basis up to ̟d of M which is also
a basis of M.

Corollary 6.1.10. Suppose that we start from a basis of M. Then in
the process we do not obtain the zero vector of (R/̟d+1R)n if and only
if δM ≤ d.
Proof. Both properties are equivalent to the fact that, for the basis
given by Proposition 6.1.7, we have s = m.
(cid:3)

6.1.5. Computing some reductions modulo ̟. We consider all modules
here as submodules of Kn.
Proposition 6.1.11. Let d > 0 be an integer and let (wi)1≤i≤s be a
good basis of M up to ̟d. Then π(̟−dM ∩ Rn) is generated by the
π( ˜wi), 1 ≤ i ≤ s.
Suppose that moreover d ≥ δM . Then π(∪t(̟−tM∩Rn)) is generated
by the π( ˜wi).

16

SANDRA ROZENSZTAJN

Let now (w′

Proof. Let wi be an element of the basis such that v(wi) ≤ d. Then
there exists µ ∈ R with v(µ) = d − v(wi), and then ̟−dµwi is in
̟−dM ∩ Rn and reduces in E to a non-zero multiple of π( ˜wi). So all
the π( ˜wi) with v(wi) ≤ d are in π(t(̟−dRm) ∩ Rn)
i)1≤i≤m be a good basis of M as in Proposition 6.1.7. Let
x ∈ ̟−dM. We can write x = P ̟−dµiw′
i for some elements µi ∈ R.
Then x = P µi̟v(w′
i. By looking at the coeﬃcients of x in the
basis (ei) we see that x ∈ Rn if and only if ̟v(w′
i)−dµi ∈ R for all i.
Then π(x) = Pi π(̟v(w′
′), and this is the same as taking the
sum over only the indices i for which v(w′
i) ≤ d, that is i ≤ s. So π(x)
is in the subspace of En generated by the π( ˜wi

i)−dµi)π( ˜wi

i)−d ˜w′

′) = π( ˜wi) for i ≤ s.

(cid:3)

The last statement follows from Proposition 6.1.1.

Corollary 6.1.12. Let d be an integer. Starting from a generating
family for M, we can compute a generating family for π(̟−dM ∩ Rn)
by doing computations in (R/̟d+1R)n.
Let d be an integer larger than or equal to δM . Then we can compute
a generating family for π(∪t(̟−tM ∩ Rn)) by doing computations in
(R/̟d+1R)n.
6.1.6. Computing locally. Let V be a family of vectors that generates
M, I a subset of {1, . . . , n}, VI ⊂ V the subset of V of vectors with
support in I. Suppose that we have J ⊂ I such that for all w ∈ V, w
not in VI, the intersection of the support of w with I is contained in
J. Then we can compute a good basis of M (or the reduction modulo
̟d+1 of a good basis of M up to ̟d) is two steps as follows:

(1) use a partial Gauss algorithm: apply the Gauss algorithm for
vectors in VI, but allowing only the use of pivots that are in
I \ J.
(2) when we can not do anything anymore, we have obtained a
family VI,0 of vectors that were used at pivots, and a remainder
V ′
I.

have obtained a family V ′

(3) apply the Gauss algorithm to the family (V \ VI) ∪ V ′
I.
(4) when the only vectors left in the family are zero vectors, we
0 of vectors that were used at pivots.
0 is a list of vectors obtained using the Gauss algorithm
on the whole family V. We call VI,0 the set of extracted vectors for this
partial Gauss algorithm, and the coordinates in J are the excluded
coordinates.

Then VI,0∪V ′

6.2. Description of the operator T . We know come back to the
study of Θk,ap. We give an explicit description of the G-equivariant
operator T .

Let f = [g, v], with v a polynomial with coeﬃcients in K or E. Then

T f = Xu∈I1

[gg0

1,u, v(X, pY − uX)] + [gg1

0,0, v(pX, Y )]

AN ALGORITHM

17

For f = [g, v], we denote by T +f the part of T f with support farther
from the origin than g, and T −f with support closer to the origin.
So if g = g0
1,u, v(X, pY − uX)] and
0,0, v(pX, Y )]. When g = 1 by convention we set T +f =
T −f = [gg1
0,0, v(pX, Y )]. We extend the

n,λ, we get that T +f = Pu∈I1[gg0

Pu∈I1[g0

deﬁnition of T + and T − by linearity to I(Symr).

1,u, v(X, pY − uX)] and T −f = [g1
n,µ, i) = [g0
n,λw, where w =  0 1

We introduce the notation (g0

1 0! and β =

n,µ, X r−iY i], and (g1

n,λ = g1

n,µ, i) =

[g1

n,µX iY r−i]. We have βg0
p 0!, so β(gε
 0 1

n,µ, i) = (g1−ε
n,pµ = g1

(g1

We also have wg0
n−1,µ, i).
We give an explicit formula for T f for n > 0:

n,µ , i) for ε ∈ {0, 1}.
n−1,µw for all µ ∈ In−1, and so w(g0

n,pµ, i) =

T +(gε

n,λ, i) = Xu∈I1

i

Xj=0

and

pj i

j!(−u)i−j(gε

n+1,λ+upn, j)

T −(gε

n,λ, i) = pr−i

i

Xj=0 i

j!(λ′)i−j(gε

n−1,λ, j)

where we set λ = λ + pn−1λ′, with λ′ ∈ I1 and λ ∈ In−1.

We also have:

T (gε

0,0, i) = Xu∈I1

i

Xj=0

pj i

j!(−u)i−j(gε

1,u, j) + pr−i(g1−ε

0,0 , r − i)

Proposition 6.2.1. For any a ∈ R, the operator (T − a) is injective
on I(Symr K2).

We say that f ∈ I(Symr K2) is integral if f ∈ I(Symr R2). It is clear

that if f is integral, then so is T f .
6.3. Denominators. Let Θ = Θk,ap = I(Symr R2)/ ((T − ap)I(Symr K2) ∩ I(Symr R2)).
It is a free R-module. Let M = Mk,ap be the submodule ((T −
ap)I(Symr K2) ∩ I(Symr R2)).

We recall the following result from [11, Proposition 3.3.3]:

Proposition 6.3.1. Suppose r ≤ p − 1. Let f ∈ I(Symr K2) such that
(T − ap)f is integral. Then f is integral.

We give a generalization of this result for larger values of r. Let

Nr = max(0,⌊(r − 1)/(p − 1)⌋).
Proposition 6.3.2. Suppose r ≥ p. Let f ∈ I(Symr K2) with support
in Bn such that (T − ap)f is integral. Write f = Pn
i=0 fi with fi having
support in Ci. Then p(n+1−i)Nr fi is integral.

18

SANDRA ROZENSZTAJN

Corollary 6.3.3. Let f ∈ I(Symr K2) with support in Bn such that
(T − ap)f is integral. Then p(n+1)Nr f is integral.

In order to prove Proposition 6.3.2, we start by a special case:

i=a+j

(mod p−1)

i=0(−1)ici(gε

n,µ, v] ∈ I(Symr K2) with
n,µ, i). Then ci ∈ p− min(i,Nr)R.
j(cid:17)ui−j ∈ R.

Lemma 6.3.4. Suppose r ≥ p. Let f = [gε
T +f integral. Write f = Pr
Proof. We set ci = 0 if i < 0 or i > r, and αj,u = pj Pi≥0 ci(cid:16)i
Then T +f = Pr
gral if and only if for all j and for all u ∈ I1, αj,u ∈ R
Looking at α0,0 we see that c0 ∈ R, and more generally looking at αi,0
we see that ci ∈ p−iR. For a ∈ Z/(p−1)Z, let βj,a = (Pu∈µp−1 u−aαj,u)/(p−
1), except for β0,0 = (Pu∈µp−1 u−aα0,u)/(p − 1) − c0.
j!
ci i

j=0Pu∈I1 pj(−1)jαj,u(gε

n+1,µ+pnu, j). So this is inte-

Then

βj,a = pj

Xi>0
and for all j, a, we get that βj,a ∈ R.
We ﬁx now b ∈ {1, . . . , p − 1}, and consider only the elements
cb+ℓ(p−1), ℓ ≥ 0. Let n be the largest integer such that b + ℓ(p − 1) ≤ r,
so we have (n+1) unknowns x0, . . . , xn with xi = cb+i(p−1). We consider
the (n + 1) equations for 0 ≤ j ≤ n:
Xm=0 b + m(p − 1)

!xm = p−jβj,b−j
Using Lemma 6.3.5, we get that xm ∈ p−nR for all m.
Now we compute the value of n. Write r = Nr(p − 1) + a with
1 ≤ a ≤ p − 1. Then n = Nr for b ≤ a, and n = Nr − 1 for b > a. So
in any case n ≤ Nr.
Lemma 6.3.5. For all b ∈ Z and n ≥ 0, the determinant δb,n of the
matrix with coeﬃcients ((cid:16)b+m(p−1)
Proof. Let zm,j = Qj−1
By linearity det((zm,j)0≤j,m≤n) = det((z′
m,j = (b +
m(p − 1))j. But the latter is the Vandermonde determinant on the
b + m(p − 1), 0 ≤ m ≤ n, so is equal to Q0≤i<j≤n(b + j(p − 1) − b −
i(p − 1)) = (p − 1)n(n+1)/2Qn
i=0(i!). So ﬁnally δb,n = (p − 1)n(n+1)/2. (cid:3)
Proof of Proposition 6.3.2. Write f = Pn
i=0 fi with fi having support
We see ﬁrst from Lemma 6.3.4 that pNrfn is integral. Indeed, T +fn
is integral, as it is exactly the part of (T − ap)f with support in Cn+1.
The part of (T − ap)f with support in Cn is −apfn + T +fn−1. As
(pNr )(−apfn) is integral, we see that pNr T +fn−1 is integral, and then
so is p2Nr fn−1.

i=0 (b+m(p−1)−i). Then δb,n = (Qn

(cid:17))0≤j,m≤n is invertible in R.

m,j)0≤j,m≤n) where z′

in Ci.

(cid:3)

n

j

j

i=0(i!))−1 det((zm,j)0≤j,m≤n).

AN ALGORITHM

19

Let i < n− 1, and consider the part of (T − ap)f with support in Ci.
It is T −fi+1−apfi+T +fi−1. If p(n+1−i)Nr (T −fi+1−apfi) is integral, then
so is p(n+1−i)Nr (T +fi−1), and so is p(n+2−i)Nr fi−1 by Lemma 6.3.4. (cid:3)

6.4. Finite dimensional subspaces of Mk,ap. Recall that Mk,ap is
the reduction modulo p of Mk,ap
Let S be a ﬁnite subset of the vertices of the tree of GL2(Qp). For
any representation V of K, we denote by IS(V ) the subspace of I(V )
of vectors whose support in the tree is included in S. For example we
can take for S the set Bn of vertices at distance at most n from the
origin, in this case we write In for IBn.

For any non-negative integer d and S as above, let Md,S = (T −
ap)p−dIS(Symr R2) ∩ I(Symr R2). It is clear that Mk,ap = ∪d,SMd,S,
and so Mk,ap = ∪d,SMd,S where Md,S is the image of Md,S in Mk,ap.
We also write MS = ∪dMd,S.

From Proposition 6.3.3 , we deduce that:

Proposition 6.4.1. If S ⊂ Bn, the maximum of the elementary divi-
sors of (T −ap)IS(Symr R2) inside In+1(Symr R2) is at most (n+ 1)Nr.
Remark 6.4.2. From the computations, it seems that this bound is far
from optimal.

And so, using Corollary 6.1.2:

Proposition 6.4.3. Suppose that S ⊂ Bn. Then
∪d≥0(cid:16)̟−d(T − ap)IS(Symr R2) ∩ I(Symr R2)(cid:17) = p−(n+1)Nr (T−ap)IS(Symr R2)∩I(Symr R2)
Corollary 6.4.4. Suppose that S ⊂ Bn, and that we can compute Θ
by using only elements of Md,S for some d. Then we can compute Θ
by using only elements of Mδ,S for δ = (n + 1)Nr.
Corollary 6.4.5. For a ﬁxed S, we need only work with ﬁnite precision
determined explicitly in terms of S.

ss
k,ap
ss
k,ap

6.5. An explicit algorithm for the computation. Consider now
the following problem: we ﬁx some n ≥ 0, and we want to compute
a good basis (or a good basis up to ̟d for some d) for the module
Mn = (T − ap)In(Symr R2). The elements of Mn have support in
Bn+1, so this means doing the Gauss algorithm as in Paragraph 6.1.3
with a family of size (r+1)#Bn in a module of dimension (r+1)#Bn+1.
We now explain how to take into account the structure of the tree to
speed up signiﬁcantly the computation.

We take as basis vectors of the ambient space the elements [gε

m,µ, X r−iY i]

for m + ε ≤ n + 1, µ ∈ Im, 0 ≤ i ≤ r. Denote by Bm the set of elements
of the form [gε
m−ε,µ, X r−iY i] for 0 ≤ i ≤ r, so Bm is a basis of ICm(R).
i=0Bi, and

The module Mn is generated by the (T − ap)f for f ∈ ∪n
these elements for in fact a basis of Mn by Proposition 6.2.1.

20

SANDRA ROZENSZTAJN

6.5.1. Subdivising the tree. For m ≤ n, let Sm the subtree of Bn+1
containing the element [g0
n+1−m,0] and all classes [g] of Bn+1 that are
farther than [g0
0,0] to [g]
goes through [g0

0,0] (that is, the path from [g0

n+1−m,0] from [g0
n+1−m,0]).

We denote by Bm

the subset of elements f of Bi such that (T − ap)f
has support in Sm. This is empty if i ≤ n + 1− m, and if i > n + 1− m
this is the same as the set of f ∈ Bi with support in Sm.
0 1 ). Then note that Sm+1 is the
disjoint union of {[g0
and wSn.

If x ∈ Zp, let t(x) be the matrix ( 1 x
Moreover, Bn+1 is the disjoint union of {[g0

n−m,0]} and the t(upn−m)Sm for u ∈ I1.

0,0]}, the t(u)Sn for u ∈ I1,

i

6.5.2. Computing locally. We now make use the remark of Paragraph
6.1.6, and obtain the following algorithm:

n, excluding the coordinates [g0

• Do the partial Gauss algorithm the family of vectors (T − ap)f
for f ∈ B2
s,µ, X r−iY i] for s = n−1
or s = n. We get a list V2,0 of extracted vectors and a list of
remaining vectors V ′
2.
• For m from 3 to n: do the partial Gauss algorithm for vectors
in the list

∪u∈I1t(upn−m+1)V ′

m−1 ∪ {(T − ap)f, f ∈ Bm

n+2−m}

excluding the coordinates [g0
s,µ, X r−iY i] for s = n + 1 − m or
s = n + 2 − m. We get a list Vm,0 of extracted vectors, and a
list of remaining vectors V ′
m.

• Do the Gauss algorithm for the list

∪u∈I1t(u)V ′

n ∪ wV ′

n ∪ {(T − ap)f, f ∈ B1 ∪ B0}

We get a list Vn+1,0 of extracted vectors.

m=2 ∪µ∈In+1−m t(µ)Vm,0).

In the end, we get a list V0 of extracted vectors which is equal to

m=2 ∪µ∈In+1−m t(µ)Vm,0) ∪ w(∪n

Vn+1,0 ∪ (∪n
Remark 6.5.1. The advantage of this method is that we do most of
our computations in modules that are of dimension much smaller than
the dimension of In+1(Symr R2), as ISm(Symr R2) is of dimension (r +
1)(pm+1 − 1)/(p − 1). The ﬁnal computation in In+1(Symr R2) is still
the longest part, but at this stage the number of vectors that we have to
take into account is much smaller that the dimension of In(Symr R2),
which is the number we would have to consider otherwise.

6.6. A local constancy result.

ss
Theorem 6.6.1. Suppose that we are able to compute Θ
k,ap by using
only elements of Md,S for some d and S as above. Then for all a such
that v(a − ap) > d, we have that , and so V ss

∼−→ V ss
k,a.

k,ap

AN ALGORITHM

21

ss

ss
k,ap

∼−→ Θ

Proof. Suppose a 6∈ {±(1 + p)pk/2−1}. If v(a − ap) > d then Md,S(a) =
Md,S(ap) and so Θ
k,a, which implies the result. For a ∈
ss
{±(1 + p)pk/2−1} we use the local constancy of the value of Θ
k,a. (cid:3)
ss
Corollary 6.6.2. Suppose that we are able to compute Θ
k,ap by using
only elements of Md,S for some d and S. Let δS be the maximal valua-
tion of the elementary divisors of (T − ap)IS(Symr R2) ⊂ I(Symr R2).
ss
Then for all a such that v(a − ap) > δS, we have that Θ
k,a,
and so V ss
k,ap

ss
k,ap

∼−→ Θ

∼−→ V ss
k,a.

ss

Proof. It follows from Proposition 6.1.1 that we can in fact compute
Θ
k,ap by using only elements of MδS,S.
(cid:3)
When we apply the Gauss algorithm as in Paragraph 6.5, the value
of δS appears automatically as a byproduct. So even if we started by
a non-optimal d, we still get a bound for local constancy that is closer
to the optimal one. In particular, as we see in the examples of Section
8, we often obtain a better bound than the one given by [5, Theorem
A].

7. Summary of the algorithm

7.1. The algorithm. We summarize the algorithm to compute V k,ap.
Let K = Qp(ap) with ring of integers R and uniformizer ̟. Let e
denote the ramiﬁcation index of K, so that computing modulo pd in R
is the same as computing modulo ̟ed.
(1) For some n ≥ 0 and d ≥ 0, compute the reduction modulo pd+1
of a good basis up to pd for the submodule (T − ap)In(Symr R2)
of In+1(Symr R2), by the method of Paragraph 6.5.
(2) Deduce from this a generating family for the subspace Md,Bn of

Mk,ap, via Proposition 6.1.11.

(3) Using the elements given in Paragraph 5.4 and the method of
Paragraph 4.2, get information on the graded parts Fi of the
ﬁltration of I(σr,E)/Mk,ap described in Section 4.

(4) If we have enough information on the Fi to deduce JH(Θk,ap),
stop here. If we do not have enough information, try again with
a larger value of n or of d.

The algorithm will give enough information to deduce JH(Θk,ap) for

some ﬁnite value of n.

Remark 7.1.1. By Corollary 6.1.10, it is easy to check during step (1)
of the algorithm if trying the computation with the same n but a larger
value of d would add any new information.

Remark 7.1.2. As a byproduct of the computation, we can take note
of the largest of the elementary divisors that appeared and deduce a
local constancy result via Corollary 6.6.2.

22

SANDRA ROZENSZTAJN

7.2. Remarks on the choice of d and n.

7.2.1. Choice of d. The ﬁrst problem is how to best choose the value of
d for a given n. We would like to take d large enough that we get reduc-
tion of all the elements in ∪t≥0 (̟−t(T − ap)IBn(Symr R2) ∩ I(Symr R2))
(so that we do not have to try again with the same value of n but a
larger d). By Proposition 6.4.1, we could take d = (n + 1)Nr to ensure
that this property is veriﬁed. However, this choice is probably not opti-
mal: indeed we do not want to take d too large as the computation time
would be much longer. In fact, from the examples, the largest elemen-
tary divisor that appears for (T − ap)IBn(Symr R2) inside I(Symr R2)
seems to be much smaller than (n + 1)Nr. So it is probably better to
choose d based on an estimation of the size of the largest elementary
divisor, for example using the value obtained from a computation with
a smaller value of n.

7.2.2. Choice of n. From a theoretical point of view, it would be very
interesting to have a bound for the value of n necessary for this com-
putation. However, from a computational point of view, having such
a bound is quite useless unless we know in fact exactly the smallest
necessary value of n. Indeed, let dn be the dimension of the R-module
In(Symr R2). Then, for ﬁxed r, dn grows as pn. The computation time
grows at least as fast as dα
n for some α ≥ 1, so it grows at least as
fast as xn for some x > 2. So in particular, if n0 is the smallest value
that allows us to compute the reduction, then doing the computation
for some n > n0 is expected to take actually more time than doing the
computation successively for n = 1, 2 . . . n0.

8. Examples

We give here some examples of reductions computed thanks to our
implementation of the algorithm (which can be found in [17]), with
some guesses as to the form of some reductions.

The tables give the value of p; k; ap; the steps Fi of the ﬁltration
as described in Section 4 that can be non-zero, and their value; the
semi-simpliﬁcation of the reduction; the largest elementary divisor δ
that appeared in the computation that led to the result (so we get a
radius for the local constancy result of Proposition 6.6.2); and ﬁnally
the value of n that allowed to determine the reduction.

8.1. Examples in slope 1. The case where v(ap) = 1 has been studied
in [9] for p > 3. In this article, a complete description of the reduction is
given for p ≥ 5, except in the case where k is equal to 4 modulo p(p−1)
p−(cid:16)k−2
and v(a2
p close
to p(cid:16)k−2
2 (cid:17). We recall that in the case where k is equal to 4 modulo
2 (cid:17)p2) = 2 then V k,ap is irreducible, isomorphic
p(p − 1) and v(a2

2 (cid:17)p2) > 2. We give some results for this case, for a2

p −(cid:16)k−2

AN ALGORITHM

23

to ind ω3
2, and more precisely Θk,ap is isomorphic to π(p − 3, 0, ω2),
which is the F0-part of the ﬁltration as described in Sections 4 and 5
(beware that the numerotation of the ﬁltration is not the same in this
article and in [9]).

We can try to guess what the situation is based on our computations,
by trying the simplest possible description. Suppose that p > 2, k is
equal to k modulo p(p− 1), and k > 2. There exists an integer i(k) > 1
such that:
2 (cid:17)p2) < i(k) then V k,ap is isomorphic
• if v(ap) = 1 and v(a2
2 (cid:17)p2) = i(k) then V
• if v(ap) = 1 and v(a2
to ω6 unr(λ) ⊕ ω unr(λ−1) for some λ ∈ E ×.
2 (cid:17)p2) > i(k) then V k,ap is isomorphic
• if v(ap) = 1 and v(a2
to ind ω7
2.

p −(cid:16)k−2
p −(cid:16)k−2
p −(cid:16)k−2

ss
k,ap is isomorphic

to ind ω3
2.

It would be interesting also to give a conjecture for the value of i(k)
in termes of p and k, and for the value of λ in terms of k, p, ap. From
the computations of [9], Section 6, we can think that i(k) = 2+v(k−4).
V ss
k,ap
ind ω3
2
ind ω7
2

F0: quotient of I(σ2(2))

F3: π(4, 0, ω)

non-zero Fis

8.2. Examples in slope 3/2. To describe the reduction modulo p in
this case, we introduce a notation: let In,c be the representation ρ of
GQp with restriction to inertia isomorphic to ωn⊕ωn, with determinant
equal to ω2n, and such that the Frobenius acting on ω−nρ has trace c.
The case where 1 < v(ap) < 2 was computed for p > 2 in [8], except

for the special case where k = 5 mod p−1 and v(a2
3. We give some examples of what happens in this special situation.

p−(k−4)(cid:16)k−3

2 (cid:17)p3) >

8.2.1. First case. The ﬁrst case is a situation that looks very similar
to what happens in slope 1/2 for k = 3 mod (p − 1), as described in
[13]. It seems that when p does not divise k − 5, then the only step of
the ﬁltration that is non-zero is F2, and we have an integer i(k) such
that:

p − (k − 4)(cid:16)k−3
• if 1 < v(ap) < 2 and v(a2
is isomorphic to π(p − 2, 0, ω2), and so V
ind ω1+3p

.

2

2 (cid:17)p3) < i(k) then Θ

ss
k,ap
ss
k,ap is isomorphic to

ap
2.5
5√231

k
p
5 24
5 24
5√231 + 52
5 24
5 24 5√231 + 2.52
5 24 5√231 + 3.52
5 24 5√231 + 4.52
5 44
5 44 5√21.41 + 52

5√21.41

F3: π(4, 4, ω) and F0: π(2, 4, ω2)
F3: π(4, 3, ω) and F0: π(2, 2, ω2)
F3: π(4, 2, ω) and F0: π(2, 3, ω2)
F3: π(4, 1, ω) and F0: π(2, 1, ω2)

F3: quotient of I(σ4(1)) and F2: π(0, 0, ω)

F3: π(4, 2, ω) and F0: π(2, 3, ω2)

δ n
2 2
3 3
ω unr(−1) ⊕ ω2 unr(−1) 3 3
ω unr(2) ⊕ ω2 unr(3)
3 3
ω unr(3) ⊕ ω2 unr(2)
3 3
3 3
3 2
3 3

ω ⊕ ω2
ind ω7
2

ω unr(3) ⊕ ω2 unr(2)

24

SANDRA ROZENSZTAJN

• if 1 < v(ap) < 2 and v(a2

is isomorphic to I(σp−2(2)/(T 2 − cT + 1) for some c ∈ E ×, that
is, V

ss
k,ap is isomorphic to I2,c.

p − (k − 4)(cid:16)k−3

2 (cid:17)p3) = i(k) then Θ

ss
k,ap

p − (k − 4)(cid:16)k−3

2 (cid:17)p3) > i(k) then Θ

ss
k,ap is
k,ap is isomorphic

• if 1 < v(ap) < 2 and v(a2

ap

isomorphic to I(σp−2(2))/(T 2 + 1), that is, V ss
to I2,0.
k
p
5 17
5 17

5√5.13√7
5√5.13√7 + 52 F2: I(σ3(2))/(T 2 − 4T + 1)
5 17 5√5.13√7 + 2.52 F2: I(σ3(2))/(T 2 − 3T + 1)
5 17 5√5.13√7 + 3.52 F2: I(σ3(2))/(T 2 − 2T + 1)
5 17 5√5.13√7 + 4.52 F2: I(σ3(2))/(T 2 − T + 1)

F2: I(σ3(2))/(T 2 + 1)

non-zero Fis

ss
V
k,ap
I2,0
I2,4
I2,3
I2,2
I2,1

n
δ
5/2 3
5/2 3
5/2 3
5/2 3
5/2 3

8.2.2. Second case. The previous situation can not happen when p di-
vides k− 5, as in this case the results of [9] show that when v(a2
p − (k −
4)(cid:16)k−3
2, not ind ω1+3p
. So we
can expect the situation to be a little diﬀerent here. It seems that we
have two integers i(k) < j(k) such that:

2 (cid:17)p3) = 3 the reduction is equal to ind ω4

2

• if 1 < v(ap) < 2 and v(a2
isomorphic to ind ω4
2.
• if 1 < v(ap) < 2 and v(a2
isomorphic to ω3 unr(λ) ⊕ ω unr(λ−1) for some λ ∈ E ×.
• if 1 < v(ap) < 2 and i(r) < v(a2
V ss
k,ap is isomorphic to ind ω1+3p

p − (k − 4)(cid:16)k−3
p − (k − 4)(cid:16)k−3

p − (k − 4)(cid:16)k−3

2

• if 1 < v(ap) < 2 and v(a2
• if 1 < v(ap) < 2 and v(a2

p − (k − 4)(cid:16)k−3
is isomorphic to I2,c for some c ∈ E ×.
p − (k − 4)(cid:16)k−3

is isomorphic to I2,0.

2 (cid:17)p3) < i(k) then V k,ap is
2 (cid:17)p3) = i(k) then V k,ap is
2 (cid:17)p3) < j(k) then
2 (cid:17)p3) = j(k) then V k,ap
2 (cid:17)p3) > j(k) then V ss
V ss
k,ap
I2,0
I2,1

k,ap

ap

5√5.21√11

5√5.21√11 + 53
5√5.21√11 + 52

k
p
5 25
5 25
5 25 5√5.21√11 + 52√5√11
5 25
7 47
7 47
7 47 7√7.43√22 + 72√7√22
7 47

7√7.43√22 + 73
7√7.43√22 + 72

7√7.43√22

δ

non-zero Fis

F2: π(3, 0, ω2)

F2: I(σ3(2))/(T 2 + 1)

F3: π(1, 1, ω) and F0: π(1, 1, ω3)

F2: I(σ3(2))/(T 2 − T + 1)

n
7/2 3
7/2 3
7/2 3
7/2 3
7/2 3
7/2 3
7/2 3
F3: π(1, 6, ω) and F0: π(3, 6, ω3) ω3 unr(−1) ⊕ ω unr(−1) 7/2 3

F2: I(σ5(2))/(T 2 − 3T + 1)

ind ωp+3
ω3 ⊕ ω
I2,0
I2,3

F2: I(σ5(2))/(T 2 + 1)

F2: π(5, 0, ω2)

ind ω22
2

2

8.3. Examples in slope 5/2. We can expect that this case behaves
like the cases of slope 1/2 and 3/2, that is: for some values of k modulo

AN ALGORITHM

25

p − 1, the reduction depends on the valuation of a2
integer f (k).

p − f (k)p5 for some

ap

We can ﬁnd examples behaving in a way similar to 8.2.1:
ss
V
p
k
k,ap
I3,0
7 31
I3,4

7 31 72√7.44 + 73 F4: I(σ5(3))/(T 2 − 4T + 1)

F4: I(σ5(3))/(T 2 + 1)

non-zero Fis

72√7.44
72√7
72 3√7

7 31
7 31

F4: π(5, 0, ω3)
F4: π(5, 0, ω3)

ind ω30
2
ind ω30
2

δ

n
7/2 3
7/2 3
3
2
8/3 2

non-zero Fis

δ

ap

52√5.51

We can also ﬁnd examples behaving in a way similar to 8.2.2:
p
k
5 27
52√5.51 + 54
5 27
5 27 52√5.51 + 53√5
52√5.51 + 53
5 27
52√5.51 + 2.53 F5: π(1, 2, ω2) and F2: π(1, 3, 1) ω2 unr(3) ⊕ unr(2) 9/2 3
5 27
5 27

F4: I(σ3(3))/(T 2 − T + 1)

n
9/2 3
9/2 3
9/2 3
9/2 3

F5: π(1, 1, ω2) and F2: π(1, 1, 1)

F4: I(σ3(3))/(T 2 + 1)

ind ω22
2
ω2 ⊕ 1
ind ω8
2

V ss
k,ap
I3,0
I3,1

F4: π(3, 0, ω3)

F2: π(1, 0, 1)

4

3

52√10

References

[1] Bodan Arsovski. Reduction modulo p of two-dimensional crystalline represen-

tations of GQp of slope less than three. Preprint, 2015, arXiv:1503.08309.

[2] L. Barthel and R. Livné. Irreducible modular representations of GL2 of a local

ﬁeld. Duke Math. J., 75(2):261–292, 1994.

[3] L. Barthel and R. Livné. Modular representations of GL2 of a local ﬁeld: the

ordinary, unramiﬁed case. J. Number Theory, 55(1):1–27, 1995.

[4] Laurent Berger. Représentations modulaires de GL2(Qp) et représentations

galoisiennes de dimension 2. Astérisque, (330):263–279, 2010.

[5] Laurent Berger. Local constancy for the reduction mod p of 2-dimensional

crystalline representations. Bull. Lond. Math. Soc., 44(3):451–459, 2012.

[6] Laurent Berger and Christophe Breuil. Sur quelques représentations poten-

tiellement cristallines de GL2(Qp). Astérisque, (330):155–211, 2010.

[7] Laurent Berger, Hanfeng Li, and Hui June Zhu. Construction of some families
of 2-dimensional crystalline representations. Math. Ann., 329(2):365–377, 2004.
[8] Shalini Bhattacharya and Eknath Ghate. Reductions of Galois representations

for slopes in (1, 2). Doc. Math., 20:943–987, 2015.

[9] Shalini Bhattacharya, Eknath Ghate, and Sandra Rozensztajn. Reductions of

Galois representations of slope 1. Preprint, 2015, arXiv:1504.03838.

[10] Christophe Breuil. Sur quelques représentations modulaires et p-adiques de

GL2(Qp). I. Compositio Math., 138(2):165–188, 2003.

[11] Christophe Breuil. Sur quelques représentations modulaires et p-adiques de

GL2(Qp). II. J. Inst. Math. Jussieu, 2(1):23–58, 2003.

[12] Kevin Buzzard and Toby Gee. Explicit reduction modulo p of certain two-
dimensional crystalline representations. Int. Math. Res. Not. IMRN, (12):2303–
2317, 2009.

[13] Kevin Buzzard and Toby Gee. Explicit reduction modulo p of certain 2-
dimensional crystalline representations, II. Bull. Lond. Math. Soc., 45(4):779–
788, 2013.

[14] Xavier Caruso and David Lubicz. Semi-simpliﬁée modulo p des représentations

semi-stables: une approche algorithmique. Preprint, 2013, arXiv:1309.4194.

26

SANDRA ROZENSZTAJN

[15] Abhik Ganguli and Eknath Ghate. Reductions of Galois representations via
the mod p local Langlands correspondence. J. Number Theory, 147:250–286,
2015.

[16] D. J. Glover. A study of certain modular representations. J. Algebra, 51(2):425–

475, 1978.

[17] Sandra Rozensztajn. Script available at http://perso.ens-lyon.fr/sandra.rozensztajn/software/.
[18] William Stein et al. SAGE mathematical software, version 7.0, 2016,

http://www.sagemath.org.

UMPA, ÉNS de Lyon, UMR 5669 du CNRS, 46, allée d’Italie, 69364

Lyon Cedex 07, France

E-mail address: sandra.rozensztajn@ens-lyon.fr

