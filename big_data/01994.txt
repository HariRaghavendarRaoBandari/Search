6
1
0
2

 
r
a

M
7

 

.

 
 
]
E
P
o
i
b
-
q
[
 
 

1
v
4
9
9
1
0

.

3
0
6
1
:
v
i
X
r
a

SCOTTI: Efficient Reconstruction of Transmission within
Outbreaks with the Structured Coalescent

Nicola De Maio1,2,*, Chieh-Hsi Wu2, Daniel J Wilson1,2,3

1 Institute for Emerging Infections, Oxford Martin School, University of
Oxford , Oxford, United Kingdom
2 Nuffield Department of Medicine, University of Oxford, Oxford, United
Kingdom
3 Wellcome Trust Centre for Human Genetics, University of Oxford,
Oxford, United Kingdom

* E-mail: nicola.demaio@ndm.ox.ac.uk

Abstract

Exploiting pathogen genomes to reconstruct transmission represents a powerful tool in
the fight against infectious disease. However, their interpretation rests on a number of
simplifying assumptions that regularly ignore important complexities of real data, in
particular within-host evolution and non-sampled patients.

Here we propose a new approach to transmission inference called SCOTTI

(Structured COalescent Transmission Tree Inference). This method is based on a
statistical framework that models each host as a distinct population, and transmissions
between hosts as migration events. Our computationally efficient implementation of this
model enables the inference of host-to-host transmission while accommodating
within-host evolution and non-sampled hosts. SCOTTI is distributed as an open source
package for the phylogenetic software BEAST2.

We show that SCOTTI can generally infer transmission events even in the presence

of considerable within-host variation, can account for the uncertainty associated with
the possible presence of non-sampled hosts, and can efficiently use data from multiple
samples of the same host, although there is some reduction in accuracy when samples
are collected very close to the infection time.

We illustrate the features of our approach by investigating transmission from genetic

and epidemiological data in a Foot and Mouth Disease Virus (FMDV) veterinary
outbreak in England and a Klebsiella pneumoniae outbreak in a Nepali neonatal unit.
Transmission histories inferred with SCOTTI will be important in devising effective
measures to prevent and halt transmission.

Author Summary

We present a new tool, SCOTTI, to efficiently reconstruct transmission events within
outbreaks. Our approach combines genetic information from infection samples with
epidemiological information of patient exposure to infection. While epidemiological
information has been traditionally used to understand who infected whom in an
outbreak, detailed genetic information is increasingly becoming available with the steady
progress of sequencing technologies. However, many complications, if unaccounted for,
can affect the accuracy with which the transmission history is reconstructed. SCOTTI

1

efficiently accounts for several complications, in particular within-patient genetic
variation of the infectious organism, and non-sampled patients (such as asymptomatic
patients). Thanks to these features, SCOTTI provides accurate reconstructions of
transmission in complex scenarios, which will be important in finding and limiting the
sources and routes of transmission, preventing the spread of infectious disease.

Introduction

Understanding the dynamics of transmission is fundamental for devising effective
policies and practical measures that limit the spread of infectious diseases. In recent
years, the introduction of affordable whole genome sequencing has provided
unprecedented detail on the relatedness of pathogen samples [1–4]. As a result, inferring
transmission between hosts with accuracy is becoming more and more feasible. However,
this requires robust, and computationally efficient methods to infer past transmission
events using genetic information. Many complications, such as within-host pathogen
genetic variation and non-sampled hosts, obscure the relationship between pathogen
phylogenies and the history of transmission events, affecting the accuracy of such
methods. Here, we present a new approach, SCOTTI, that accounts for these
complexities in a computationally feasible manner.

A number of approaches have been developed that reconstruct transmission from

genetic data. One method, based on pathogen genetic data, rules out direct
transmission if isolates from different hosts are separated by a number of substitutions
above a fixed threshold [5–7]. This approach cannot generally distinguish direct
transmission from transmission through one or more intermediate hosts, or infer its
direction. Alternatively, the phylogenetic tree of the pathogen samples is often used as a
proxy for the transmission history [8, 9]. While phylogenetic signal can be very
informative of transmission, it can also be misleading [10, 11]. The main cause of this
problem is within-host variation that can generate discrepancies between the
phylogenetic and epidemiological relatedness of hosts, and can bias estimates of
infection times [12]. One problem arising from within-host diversity is that the
pathogen isolates transmitted by a host are not necessarily genetically identical to those
sampled from the same host. This phenomenon can be mathematically modelled using
population genetics approaches such as the coalescent [13], to describe within-host
evolution (Figure 1A). Other factors that can cause disagreement between phylogeny
and transmission history are: (i) Incomplete transmission bottlenecks, where some of
the within-host genetic variation is transmitted from donor to recipient through a
non-negligibly small inoculum; this means lineages from the same host may not have
shared a common ancestor since long before the time of infection of the host
(Figure 1B). (ii) Non-sampled hosts, such that a sampled patient is not necessarily
linked by direct transmission to its most closely related sampled patient, but can have a
non-sampled intermediate (Figure 1C) [14]. (iii) Multiply infected hosts, that can cause
patients to be erroneously excluded from some transmission chains, in particular if
multiple samples from the same patient are not collected (Figure 1D).

Several methods emerged in recent years explicitly modelling both the transmission

process and genetic evolution to perform inference of the history of transmission
events [11, 14–26]. These methods generally make use of epidemiological dating
information (such as the date of sampling, the interval of exposure of a host to an
outbreak, or the likely duration of infectiousness), but they usually ignore within-host
variation and other causes of phylogenetic discordance with transmission
history [14–20, 22, 23]. The methods of Ypma and colleagues [21], Didelot and
colleagues [24], and Hall and colleagues [25] account for within-host diversity, but
assume that all hosts in the outbreak have been detected and sequenced, which may be

2

Figure 1. Examples of transmission complexities. Reconstruction of
transmission can be hindered by several complexities causing disagreement between the
actual transmission history and the phylogeny of the sampled pathogen. Here we show
four examples of these complexities: A) Within-host evolution (the incomplete lineage
sorting problem), B) Incomplete transmission bottlenecks (or large transmission
inocula), C) Non-sampled hosts (such as unknown or asymptomatic hosts), D) Multiple
infections of the same host (or mixed infections). Different hosts (named H1, H2, and
H3) are represented as black rectangles, and the rectangle with a dashed border
represents a non-sampled host (a host for which no pathogen sample has been collected
and sequenced, and for which there is no exposure time information). The top and
bottom edge of each rectangle indicate the introduction and removal times, that is, the
beginning and the end of the time interval within which a host is either infective or can
be infected (e.g., arrival and departure time from the contaminated ward). Red dots
represent pathogen sequence samples (respectively S1, S2, and S3), and red lines are
lineages of the pathogen phylogeny. Blue tubes represent transmission/bottleneck
events, where the contained lineages are transferred between hosts. Below each “nested”
tree plot (representing phylogeny and transmission tree simultaneously, see Figure A in
S1 Text), the corresponding transmission history is represented with black “beanbags”,
and, in red, the phylogenetic tree of the sequences.

3

TimeWithin-host coalescentIncomplete bottleneckNon-sampled hostMultiple infectionsABCDS1S2S3S1S1S1S2S2S3S3S3TimeTimeTimeH1H1H1H1H2H2H2H2H3H3H3H3H1H2H3H3H1H2H1H2H3H1H3H2S1S2S3S1S2S3S1S3S3S1S2H4H4incorrect or uncertain in practical settings.

Here, we propose a new Bayesian approach called SCOTTI (Structured COalescent
Transmission Tree Inference) that not only accounts for diversity and evolution within a
host, but also for other sources of bias, namely non-sampled hosts and multiple
infections of the same host. This new method builds on our recent progress in efficiently
modelling migration between populations using an approximation to the structured
coalescent [27]. Formally, we model each host as a separate pathogen population, and
we model transmission as migration between hosts. SCOTTI has a broad range of
applicability as it relaxes the typical assumptions that every host is sampled and that
there is no within-host variation (see Figure B in S1 Text). A limitation of our method
is that we do not model transmission bottlenecks. This can be a disadvantage with
strong bottlenecks at transmission (due to small inocula), but on the other hand it may
be an advantage with large transmission inocula. SCOTTI is implemented as an
open-source package for the Bayesian phylogenetic software BEAST2 [28], and as such,
it can be freely installed and used. We compare the performance of SCOTTI and the
popular software Outbreaker [22] (version 1.1-5) on simulated data and on real datasets
of Foot and Mouth Disease Virus (FMDV [29]) and Klebsiella pneumoniae [30]. These
applications highlight how the two methods usually provide very different
interpretations of outbreak dynamics, with SCOTTI showing typically higher accuracy
on simulated data. By combining epidemiological and genetic information, and by
implementing a general and computationally efficient model, SCOTTI can accurately
infer transmission in a broad range of settings, providing important information to
understand and limit the spread of infectious disease.

Results

SCOTTI: A new Approach to Reconstructing Transmission
Events

Many methods that infer transmission from pathogen genetic data assume that the
pathogen population within a host is genetically homogeneous, thereby overlooking
within-host variation. A popular example is Outbreaker [22], where pathogen genetic
mutations are assumed to happen during transmission between hosts, and not within
hosts (Figure 2C). The simplicity of this model allows estimation of transmission events
for pathogens with short and regular incubation and recovery times, and with negligible
within-host variation. However, within-host evolution and overlapping infection
intervals are often not negligible for most pathogens, particularly for bacterial infections
and chronic viral infections. If unaccounted for, these complexities can lead to
misleading inference concerning transmission events [11, 12].

A natural way to account for within-host evolution is via an extension of the

multi-species coalescent model [31] including transmission bottlenecks. In this model,
each host constitutes a separate pathogen population, and with a transmission event
some isolates are transmitted to, and colonize, a new host, instantaneously growing to a
full and constant-size pathogen population (see e.g. [24] and Figure 2A). While this
multispecies model is advantageous in several respects, it is usually too computationally
demanding to be useful for inference. So while we base SCOTTI on a simplified model,
we simulate pathogen evolution (to assess and compare methods performance) under
the multispecies model. In these simulations, we fix the host-to-host transmission
history, and simulate evolution of pathogen lineages within hosts. We use two distinct
transmission histories inferred from the literature [8, 15]. We simulate under a broad
range of scenarios: different transmission bottleneck severities (weak vs. strong), one vs.
two samples per host, different numbers of non-sampled hosts, different amounts of

4

Figure 2. Graphical representation of models of transmission and evolution.
In the present work we consider three different models of pathogen evolution within an
outbreak: A) The multispecies coalescent model with transmission bottlenecks, used for
simulations, B) The structured coalescent (SCOTTI) model used for inference, C) The
Outbreaker model also used for inference. The pictures highlight some key parameters
and features of the models. Different hosts (H1, H2, H3, and H4) are represented as
black rectangles. The top and bottom edge of each rectangle are the introduction and
removal times of the respective hosts in A and B. The hosts with a dashed border are
non-sampled. Red dots represent samples (only one per host allowed by Outbreaker),
red vertical lines are lineages of the phylogeny. Smaller black dots represent coalescent
events. Red arrows are transmissions/migrations in B and C. Blue tubes are
transmissions with bottlenecks in A, and transmitted lineages are contained within
them. In A, a transmission bottleneck from host H1 to H2 causes two lineages in H2 to
coalesce (find a common ancestor backwards in time) at the same time of transmission.
This does not happen at the transmission from H3 to H4, where the two lineages in H4
do not coalesce (incomplete bottleneck) and are both inherited from H3 to H4 at a
single transmission event.

5

Multispecies (simulated history)ASCOTTI (optimal inference)BOutbreaker(optimal inference)CTimeH1H2H1H3H1H2H2H3H3H4H4H4S1.1S1.2S2.1S2.2S4.1S4.2S2.1S2.2S1.1S1.2S4.1S4.2S4.1S1.1S2.1genetic information, and different times of sampling (early, vs. late, vs. randomly
within a host infection). We give further details on the simulation scenarios in the
Materials and Methods.

While we simulate outbreak data under the multispecies model, to infer transmission

we propose a model based on the structured coalescent, SCOTTI. In the structured
coalescent multiple distinct populations are present at the same time, lineages in the
same population can coalesce (find a common ancestor), and lineages can migrate
between populations at certain rates. In SCOTTI, each host represents a distinct
pathogen population, and migration of a lineage represents a transmission event
(Figure 2B). Lineages are only allowed to evolve within, and migrate to, hosts that are
exposed at a given time, and exposure times are informed by epidemiological data.
Under this model, we perform estimation using a new implementation of BASTA
(BAyesian STructured coalescent Approximation), an efficient approximation to the
structured coalescent [27], adapted to this epidemiological setting. The use of the
approximations in BASTA substantially reduces computational demand, in particular
when many populations are considered. More details on SCOTTI are provided in the
Materials and Methods.

Accuracy of Inference on Simulated Data

To test the accuracy of our new method SCOTTI in inferring the origin of transmission,
and to compare it to the accuracy of the software Outbreaker, we simulated pathogen
evolution within two distinct, fixed transmission histories. We measure the accuracy of
the method as the frequency of correct point estimates of transmission source. As the
point estimate we take the transmission donor with the highest posterior probability. In
the base simulation scenario (random sampling times, low genetic variation, every host
sampled) SCOTTI performs well in the first transmission history (65% and 85% mean
accuracy with respectively one or two samples per host), and less well on the second
transmission history (40% and 73% accuracy, see Figure 3 and Figure C in S1 Text). In
fact, while in the first transmission history transmission events are quite homogeneously
distributed through time, in the second history they happen very early, with samples
collected much later. Bottleneck size seems to have a limited effect on inference,
although we did not simulate extremely weak bottleneck. Looking at all other
simulation scenarios, we observe that the accuracy of SCOTTI remains consistently
high, with the noticeable exception of the case in which sampling occurs very early in
infection (Figure 4). One likely reason for this is that SCOTTI does not model
transmission bottlenecks. With early sampling, coalescent events are likely to happen in
the limited time interval between infection (corresponding to the transmission
bottlenecks) and sampling. Because it is not constrained, SCOTTI often places such
coalescent events in the wrong host.

Overall, SCOTTI shows higher accuracy than Outbreaker across scenarios (Figure 4).

Generally Outbreaker has poor accuracy in estimating the source of transmission for
most links in our base scenario, with an average of 49% in transmission history 1 and
35% in transmission history 2 (Figure 3 and Figure C in S1 Text). Its limited
performance can be largely explained by the fact that Outbreaker does not account for
within-host variation. This showcases the utility of an approach of broader applicability
such as SCOTTI. SCOTTI generally outperforms Outbreaker even with a single sample
per host, and as more samples are included, it achieves greater accuracy (85% and 73%
mean accuracy, vs. 49% and 35% of Outbreaker). The only instance of inaccuracy of
SCOTTI is the transmission from host P5 to host P6 (Figure C in S1 Text), probably
due to the limited phylogenetic evidence supporting it. Outbreaker, on the other hand,
shows acceptable accuracy when the order of transmission is largely reflected by the
order of sampling, and low accuracy otherwise, as for example for the transmissions

6

Figure 3. Accuracy of SCOTTI vs. Outbreaker in the base simulation
scenario. In our base simulation setting, SCOTTI has higher accuracy than
Outbreaker, in particular when provided multiple samples per host. The coloured
“Maypole” tree (see Figure A in S1 Text) represents the first transmission history used
for simulations, with one colour associated to each host, internal nodes corresponding to
infection events and times, and tips representing infection clearance times. The pie
charts refer to the accuracy of transmission estimation in the base scenario with strong
bottleneck. The coloured slice in each pie chart is the proportion of replicates (out of a
total of 100) for which the correct origin of transmission has been correctly inferred. Pie
charts are plotted below the branch corresponding to the transmission they refer to,
while the pie charts for the index host K are plotted next to the root.

7

8.0GBLJOIMPKFDCEDKGKKLOIOKFOSCOTTI,'1'sample'(52%)'SCOTTI,'2'samples'(79%)'OUTBREAKER'(42%)'Mean'accuracy'of'transmission'source'inference'hostBCDEFGIJKLMOP8.0JBFDECKGIMLOPIDOKKLFOOKGKFigure 4. Summary of transmission inference accuracy. SCOTTI shows higher
accuracy than Outbreaker in all scenarios except with early sampling, while Outbreaker
credible sets are poorly calibrated. Pathogen sequence evolution was simulated under
transmission history 1, used in A and C, and transmission history 2, used in B and D.
In A and B bars represent proportions, expressed as percentages, of correct inferences
of transmission origin (i.e. donor host) over 100 replicates and all transmission events
for each method (differentiated by colour as in legend). On the X axis are different
simulation scenarios. In C and D bars represent average posterior supports, again
expressed as percentages, for the correct sources over all patients and replicates. In E
and F bars represent proportions (expressed as percentages) of 95% posterior credible
sets that contain the simulated (true) origin. The 95% posterior credible set for a host
is the minimum set of origins with cumulative probability ≥ 95%, and such that all
origins in the set have higher posterior probability than all origins outside of it.

8

Transmission)history)2)Accuracy)of)the)point)es4mate)Posterior)support)for)the)truth)C)D)B)Transmission)history)1)Simula4on)scenarios)Simula4on)scenarios)A)Calibra4on)of)the)95%)credible)intervals)E)F)from host P1 to host P8 and from host P1 to host P5 (Figure C in S1 Text).

Another difference between the two methods is that Outbreaker tends to infer a
posterior distribution supporting a narrower range of origins. This, paired with its
limited accuracy, leads the method to exclude a true origin from 95% credible sets in
about half of the simulations. SCOTTI is instead much better calibrated, with 95%
credible sets containing the true origin between 90% and 100% of the time (Figure 4 E
and F). Also, most of the inaccurate inference of SCOTTI derives from assigning the
source of transmission to non-sampled hosts, i.e., SCOTTI is tentative in naming
sampled hosts as transmission donors. While it is possible to inform SCOTTI of the
absence of non-sampled hosts by specifying a strong prior on the corresponding
parameter, we prefer not to do so, since in general this information is not available for
real outbreaks. In Outbreaker, inference errors often involve misattributing the source
of infection source to one of the sampled hosts (Figure D in S1 Text). This considerably
affects estimation when genetic and epidemiological data from some hosts is withheld
(one host in the “few missing” scenario and three hosts in the “many missing” scenario).
In these settings the accuracy of SCOTTI often increases (as non-sampled hosts are
correctly attributed to be the source), while it decreases for Oubreaker (since infection
source is wrongly attributed to sampled hosts, see Figure E in S1 Text).

In most of our scenarios the amount of genetic information available to distinguish

different transmission histories is rather limited, with 2-3 SNPs per sampled host on
average. From such data a single phylogenetic tree relating the sequenced samples
cannot be inferred unambiguously. When we increase phylogenetic signal, either by
simulating longer infection times (“long infection” scenario) or with longer genetic
sequences (“abundant genetic”), the accuracy of the methods substantially increases
(Figure F in S1 Text).

SCOTTI and Outbreaker require distinct formats for epidemiological information.

Outbreaker requires as input a probability distribution over the possible durations and
intensity of infectivity, and sampling times. In contrast, SCOTTI requires the user to
specify an exposure interval for each host. In simulations where the exposure intervals
provided for each host were doubled in length compared to the true ones (“inaccurate
epi” scenario) SCOTTI appeared relatively robust (Figure 4 and Figure G in S1 Text).

Furthermore, we investigated the effect of sampling times on the two methods.

Outbreaker has higher accuracy when sampling times are close to the start of infection
(“early sampling” scenario). Indeed this is the one setting in which Outbreaker
outperforms SCOTTI in inference accuracy (Figure 4). In this case SCOTTI is overly
tentative in identifying sampled hosts as the source of transmission, and is overly
conservative in its quantification of uncertainty (as in the second transmission tree with
two samples per host, Figure D in S1 Text). A contributory factor to this behaviour is
that SCOTTI does not model transmission bottlenecks, and so a sampled lineage is not
readily inferred to have coalesced (to have found a common ancestor with another
lineage) in the short time between sampling and infection, and therefore infers too great
a contribution of non-sampled hosts. In situations where a single host transmits
multiple times in close succession (as patient P1 in the second transmission history),
lineages from its recipients will tend to coalesce within P1 in random order before
coalescing with the samples from P1. This means that phylogenetic trees are relatively
uninformative of the transmission history, and this inflates uncertainty in the
identification of the transmission source. In contrast, Outbreaker is less accurate when
sampling times are close to clearance times (“late sampling” scenario), see Figure H in
S1 Text.

9

Analysis of FMDV and Klebsiella pneumoniae outbreaks

To investigate the impact of our method on the study of real outbreaks, we examined
the transmissions inferred by SCOTTI and Outbreaker in two real outbreaks of FMDV
in 2007 [29] and K. pneumoniae in 2011-2012 [30].

FMDV infects cloven-hoofed animals, and is an economically devastating disease for

the farming sector. The 2007 FMDV outbreak occurred in the South England as two
distinct transmission clusters, one in August and one in September (Figure I in S1
Text), at an estimated cost to the economy of more than 100 million pounds [29].
Among the questions facing investigators were the source of the outbreak, and the
connection between the August and September clusters. Following previous
investigations of this outbreak, we studied transmission at the farm-to-farm level, rather
than at the scale of individual animals, by taking farms or other geographically
delimited premises as the unit of transmission. Based on previously published whole
genome FMDV data [29], Outbreaker estimated transmission events with high certainty
(100% posterior probability, Figure 5A). Yet, some of these inferred events are
inconsistent with exposure data and with the transmission events inferred in [29] using
genetic and epidemiological data (Figure I in S1 Text). For example, Outbreaker infers
IP 1b → IP 3b and IP 3b → IP 4b instead of IP 4b → IP 3b and IP 5 → IP 4b [29]. This
is in part because Outbreaker does not make use of host-specific exposure data, and
that its model of genetic evolution does not account for the fact that a host sampling
time can be distant from its infection time, as is probably the case for host IP5 here,
which was possibly subject to infection for a longer time than other hosts. SCOTTI
instead considers a much broader range of possible transmission events (Figure 5B). The
transmission origins with highest posterior probability inferred by SCOTTI correspond
to those inferred in [29], consistent with the fact that both methods use exposure data.
Another reason to believe that SCOTTI is more reliable in this case is the sampling
scheme, which is very close to our simulated “late sampling” scenario, where we
observed SCOTTI to be more accurate (Figure 4). As shown in simulations, much of
the uncertainty in SCOTTI is attributed to the possible presence of non-sampled hosts,
which could be reduced by modifying the prior on the number of non-sampled hosts.
Regarding the connection between the August and the September clusters, Cottam and
colleagues identified IP5 as a possible link in the transmission chain, but did not exclude
the possibility of alternative, transient, unobserved infections between the two clusters.
SCOTTI adds weight to the notion of unobserved and non-sampled intermediate
infections; the posterior probability of non-sampled intermediates was ≈ 66%, suggesting
that it is likely that some important transmission links might not have been sampled.
Secondly, we investigated an antimicrobial resistant K. pneumoniae outbreak in a

Nepali neonatal intensive care unit between August 2011 and June 2012. K.
pneumoniae antimicrobial resistant strains are a major health concern particularly for
neonatal clinical care. In this outbreak, there were 16 neonate deaths out of 25
infections, representing a very high case fatality rate (64%) [30]. Of major importance
to the outbreak investigation was the role of transmission within the unit, vs recurrent
introduction from outside. In this outbreak, Outbreaker inferred just one transmission
event to be indirect (through a non-sampled host, from host PMK9 to PMK10, with
probability ≈ 91%). All other transmission events were inferred to be between sampled
hosts with posterior probability above 85% (although this probability was often
distributed over multiple possible sampled sources). Two patients were inferred to
represent novel introductions (index cases): PMK1 and H30. While most infections
were attributed to a single patient with greater than 99% probability, the source of
infection of many patients was considerably uncertain (PMK3-9, PMK14, PMK20 and
PMK22, see Figure 6A). SCOTTI, in complete contrast, inferred a non-sampled source
as the most likely for the majority of sampled patients (Figure 6B). Direct transmission

10

Figure 5. Reconstruction of transmission events in a FMDV outbreak.
Outbreaker (A) and SCOTTI (B) provide different interpretations of the 2007 South of
England FMDV outbreak. A) “Beanbag” tree (see Figure A in S1 Text) of
Transmission events inferred with Outbreaker. The two numbers on each transmission
arrow represent respectively the number of nucleotide substitutions separating two
hosts, and the inferred posterior support of the event (in this case always 1, meaning
100% support). All transmissions are inferred to be direct with more than 95% posterior
probability. B) “Beanbag” tree of transmission events inferred with SCOTTI. Numbers
within host circles represent the posterior probabilities of the corresponding host being
the index host (the root) of the considered outbreak. Numbers on arrows represent the
inferred posterior probabilities of the corresponding direct transmission events. Colour
intensity is proportional to posterior probability.

11

0.230.440.620.210.160.200.190.370.430.540.230.150.250.300.110.390.150.130.160.260.420.220.370.160.110.160.160.170.13IP1b 0.53IP5 0.01IP3b 0.00IP3c 0.00IP8 0.00IP7 0.00IP6b 0.00IP4b 0.00IP2b 0.25IP2c 0.15A"B"1/16/15/13/110/13/12/12/12/1IP3cIP5IP8IP1bIP7IP3bIP4bIP2cIP2bIP6bbetween sampled hosts was only inferred with high confidence for a small number of
pairs, the most likely being P M K18 → P M K21, P M K22 → P M K24,
P M K22 → P M K25. Overall, SCOTTI inferred sampled patients to constitute a small
portion of the total outbreak, forming separated (Figure 6B), and yet related
(Figure 6C), sub-outbreaks (respectively PMK3-7, PMK9-13, PMK14-26, and the two
relatively isolated cases PMK1 and H30) within a larger outbreak. This is consistent
with, and informed by, the presence of four time intervals not covered by any host
exposure, requiring the presence of non-sampled infected intermediate hosts, recurrent
introductions, or environmental contamination [30] (Figure J in S1 Text). SCOTTI also
inferred most of the common ancestors of the sampled patients to be non-sampled
(Figure 6C). This conclusion cannot be reached by Outbreaker, which assumes that the
most recent common ancestor of two sampled cases (within outbreaks with a single
index case) is also sampled.

Discussion

Methods to infer transmission events within outbreaks are essential to determine the
causes and patterns of transmission, and therefore to inform policies preventing and
limiting transmission. Genomic data from pathogen samples give the opportunity to
investigate, at an unprecedented level of detail, the relatedness of pathogens from
different hosts. However, common real life complexities such as within-host variation (in
particular for bacterial and chronic viral infections [10–12]), or hosts that have not been
sampled (e.g. unknown or asymptomatic patients) can hinder the reconstruction of
transmission events. Therefore, methods that efficiently infer transmission from
genomic data while accounting for within-host variation and non-sampled hosts are
essential if we want to determine specific transmission events within outbreaks, or even
general patterns of transmission which might inform policies and recommendations for
prevention of infection.

Here we have presented SCOTTI, a novel method of host-to-host transmission

inference (who infected whom) that is built around a computationally efficient model of
pathogen evolution based on the structured coalescent. By modelling each host as a
distinct pathogen population, and transmission as migration of lineages between hosts,
we have shown that it is possible to model within-host evolution and estimate
transmission events with good accuracy, even in the presence of non-sampled hosts. We
compared the accuracy of SCOTTI with that of the similar software Outbreaker [22] in
a broad range of simulation scenarios: different epidemics (FMDV or HIV), transmission
bottleneck sizes, numbers of samples per host, numbers of non-sampled hosts, genome
sizes, SNPs per transmission, and sampling times. Overall, SCOTTI has better
accuracy, in particular when benefitting from multiple samples from each host, which
Outbreaker does not allow. SCOTTI, in fact, explicitly models within-host evolution,
and multiple samples from the same host can be particularly informative regarding the
within-host coalescent rate, and, in theory, the proportion of mixed infections. While it
is common to sample and sequence only one haplotype from each host, this clearly
shows that transmission inference benefits greatly from within-host variation data. Also,
SCOTTI explicitly uses epidemiological data in the form of exposure times of the hosts
to inform plausible direct transmission events, or equivalently to rule out impossible
direct transmissions due to non-overlapping exposure times. Inaccurate epidemiological
data, and even more so the absence of such data, can consequently lead to a decrease in
accuracy. In our simulations, we have observed that partial inaccuracy in
epidemiological data has a modest effect on the accuracy of SCOTTI; yet, we expect
that in the complete absence of exposure time information, differently from Outbreaker,
the accuracy of SCOTTI would be more deeply compromised. Further, SCOTTI

12

Figure 6. Reconstruction of Transmission events in a K. pneumoniae
outbreak. Outbreaker (A) and SCOTTI (B and C) provide different interpretations
of the K. pneumoniae outbreak. A) “Beanbag” tree of transmission events inferred
with Outbreaker. Each circle represents a host, with “PMK” removed from their name.
The number on transmission arrows represents the inferred posterior probability of the
event. All arrows represent direct transmissions (without intermediate non-sampled
hosts, with more than 85% support) except the one from PMK9 to PMK10 which is
inferred to be through at least one intermediate host. B) “Beanbag” tree of
transmission events inferred with SCOTTI. Numbers on arrows represent the inferred
posterior probabilities of the corresponding direct transmission events. Colour intensity
is proportional to posterior support. C) “Maypole” maximum clade credibility tree (see
Figure A in S1 Text) inferred with SCOTTI, annotated and coloured with the highest
posterior probability hosts for internal nodes. “NS” represents all non-sampled hosts.
Branch width indicates the posterior probability of the inferred host at the node at the
right end of the considered branch. Branches are annotated with 95% posterior intervals
of the number of transmissions. For non-annotated branches, the interval is [0, 1].

13

hostH30NSPMK1PMK10PMK11PMK12PMK13PMK14PMK15PMK16PMK17PMK18PMK19PMK20PMK21PMK22PMK23PMK24PMK25PMK26PMK3PMK4PMK5PMK6PMK7PMK960.0PMK5PMK25PMK17PMK26PMK21PMK24PMK26PMK16PMK22PMK4PMK21PMK3PMK1PMK4PMK20PMK5PMK13PMK23PMK10PMK13PMK14PMK15PMK11PMK21PMK21H30PMK12PMK19PMK18PMK9PMK7PMK21PMK6NSNSPMK21PMK21NSPMK26NSPMK22NSNSNSNSPMK21NSNSNSNSNSPMK11PMK21PMK21PMK5PMK21NSNSNSNSNSNSPMK4PMK13PMK460.0PMK4PMK13PMK3PMK18PMK26PMK20PMK11PMK5PMK19PMK1PMK21PMK4PMK21H30PMK15PMK21PMK5PMK14PMK13PMK16PMK23PMK21PMK6PMK21PMK12PMK9PMK22PMK24PMK7PMK17PMK26PMK10PMK25NSNSPMK21PMK5PMK11NSPMK21NSNSPMK21NSNSNSNSPMK4NSPMK22NSNSPMK13PMK26NSPMK4NSNSNSPMK21NSNSPMK21PMK21NS60.0PMK9PMK26PMK4PMK3PMK21PMK11PMK6PMK13PMK20PMK1H30PMK17PMK4PMK5PMK5PMK10PMK14PMK21PMK15PMK23PMK22PMK26PMK25PMK21PMK16PMK12PMK19PMK18PMK7PMK13PMK24PMK21PMK21PMK21NSNSNSPMK5PMK5NSNSPMK4NSNSNSPMK21NSPMK11NSNSPMK22NSNSNSPMK21PMK21PMK21NSNSNSNSPMK21NSNS[0,2]&[0,2]&[0,4]&[1,2]&[0,2]&[0,9]&[1,13]&[0,2]&[0,2]&[1,2]&[0,2]&[0,2]&[0,2]&[1,2]&[0,2]&[0,2]&[1,2]&[1,2]&[0,2]&[0,2]&[0,2]&[0,2]&[0]&[1,2]&[1,2]&[0,2]&[0]&[1,2]&[1,2]&0.060.120.240.130.230.200.280.270.060.240.310.060.110.520.070.070.660.300.330.460.45PMK1H30PMK3PMK4PMK7PMK5PMK6PMK9PMK10PMK12PMK13PMK11PMK14PMK19PMK23PMK26PMK20PMK15PMK16PMK18PMK21PMK22PMK25PMK24PMK170.060.120.240.130.230.200.280.270.060.240.310.060.110.520.070.070.660.300.330.460.45PMK1H30PMK3PMK4PMK7PMK5PMK6PMK9PMK10PMK12PMK13PMK11PMK14PMK19PMK23PMK26PMK20PMK15PMK16PMK18PMK21PMK22PMK25PMK24PMK170.060.120.240.130.230.200.280.270.060.240.310.060.110.520.070.070.660.300.330.460.45PMK1H30PMK3PMK4PMK7PMK5PMK6PMK9PMK10PMK12PMK13PMK11PMK14PMK19PMK23PMK26PMK20PMK15PMK16PMK18PMK21PMK22PMK25PMK24PMK170.060.120.240.130.230.200.280.270.060.240.310.060.110.520.070.070.660.300.330.460.45PMK1H30PMK3PMK4PMK7PMK5PMK6PMK9PMK10PMK12PMK13PMK11PMK14PMK19PMK23PMK26PMK20PMK15PMK16PMK18PMK21PMK22PMK25PMK24PMK170.060.120.240.130.230.200.280.270.060.240.310.060.110.520.070.070.660.300.330.460.45PMK1H30PMK3PMK4PMK7PMK5PMK6PMK9PMK10PMK12PMK13PMK11PMK14PMK19PMK23PMK26PMK20PMK15PMK16PMK18PMK21PMK22PMK25PMK24PMK170.060.120.240.130.230.200.280.270.060.240.310.060.110.520.070.070.660.300.330.460.45PMK1H30PMK3PMK4PMK7PMK5PMK6PMK9PMK10PMK12PMK13PMK11PMK14PMK19PMK23PMK26PMK20PMK15PMK16PMK18PMK21PMK22PMK25PMK24PMK170.060.120.240.130.230.200.280.270.060.240.310.060.110.520.070.070.660.300.330.460.45PMK1H30PMK3PMK4PMK7PMK5PMK6PMK9PMK10PMK12PMK13PMK11PMK14PMK19PMK23PMK26PMK20PMK15PMK16PMK18PMK21PMK22PMK25PMK24PMK170.060.120.240.130.230.200.280.270.060.240.310.060.110.520.070.070.660.300.330.460.45PMK1H30PMK3PMK4PMK7PMK5PMK6PMK9PMK10PMK12PMK13PMK11PMK14PMK19PMK23PMK26PMK20PMK15PMK16PMK18PMK21PMK22PMK25PMK24PMK170.060.120.240.130.230.200.280.270.060.240.310.060.110.520.070.070.660.300.330.460.45PMK1H30PMK3PMK4PMK7PMK5PMK6PMK9PMK10PMK12PMK13PMK11PMK14PMK19PMK23PMK26PMK20PMK15PMK16PMK18PMK21PMK22PMK25PMK24PMK170.060.120.240.130.230.200.280.270.060.240.310.060.110.520.070.070.660.300.330.460.45PMK1H30PMK3PMK4PMK7PMK5PMK6PMK9PMK10PMK12PMK13PMK11PMK14PMK19PMK23PMK26PMK20PMK15PMK16PMK18PMK21PMK22PMK25PMK24PMK170.060.120.240.130.230.200.280.270.060.240.310.060.110.520.070.070.660.300.330.460.45PMK1H30PMK3PMK4PMK7PMK5PMK6PMK9PMK10PMK12PMK13PMK11PMK14PMK19PMK23PMK26PMK20PMK15PMK16PMK18PMK21PMK22PMK25PMK24PMK170.060.120.240.130.230.200.280.270.060.240.310.060.110.520.070.070.660.300.330.460.45PMK1H30PMK3PMK4PMK7PMK5PMK6PMK9PMK10PMK12PMK13PMK11PMK14PMK19PMK23PMK26PMK20PMK15PMK16PMK18PMK21PMK22PMK25PMK24PMK17B	  C	  A	  hostH30NSPMK1PMK10PMK11PMK12PMK13PMK14PMK15PMK16PMK17PMK18PMK19PMK20PMK21PMK22PMK23PMK24PMK25PMK26PMK3PMK4PMK5PMK6PMK7PMK960.0PMK5PMK25PMK17PMK26PMK21PMK24PMK26PMK16PMK22PMK4PMK21PMK3PMK1PMK4PMK20PMK5PMK13PMK23PMK10PMK13PMK14PMK15PMK11PMK21PMK21H30PMK12PMK19PMK18PMK9PMK7PMK21PMK6NSNSPMK21PMK21NSPMK26NSPMK22NSNSNSNSPMK21NSNSNSNSNSPMK11PMK21PMK21PMK5PMK21NSNSNSNSNSNSPMK4PMK13PMK4hostH30NSPMK1PMK10PMK11PMK12PMK13PMK14PMK15PMK16PMK17PMK18PMK19PMK20PMK21PMK22PMK23PMK24PMK25PMK26PMK3PMK4PMK5PMK6PMK7PMK960.0PMK5PMK25PMK17PMK26PMK21PMK24PMK26PMK16PMK22PMK4PMK21PMK3PMK1PMK4PMK20PMK5PMK13PMK23PMK10PMK13PMK14PMK15PMK11PMK21PMK21H30PMK12PMK19PMK18PMK9PMK7PMK21PMK6NSNSPMK21PMK21NSPMK26NSPMK22NSNSNSNSPMK21NSNSNSNSNSPMK11PMK21PMK21PMK5PMK21NSNSNSNSNSNSPMK4PMK13PMK40.50.50.50.50.50.50.510.490.260.250.490.330.350.990.98110.410.550.9611110.230.7710.480.520.980.980.980.9813456791011121314151617181920212223242526H30explicitly models non-sampled hosts, and this helps inference when the outbreak is only
partially sampled, as we show in simulations and in the K. pneumoniae outbreak. We
showed in particular that not only do SCOTTI and Outbreaker have different accuracy,
but also differ with respect to the inferred contribution of non-sampled hosts. It is
therefore important to carefully select the most appropriate software to investigate
transmission, and looking at the degree of concordance of different methods might
reveal transmission events of difficult attribution.

Although SCOTTI has broad applicability, it has important limitations to be

considered that we will address in future work. One problem is that SCOTTI ignores
transmission bottlenecks, that is, the rapid growth in pathogen population size within a
host following transmission. This might cause biases with strong transmission
bottlenecks and early samples, as we showed in the simulation setting involving early
sampling times. On the other hand, due to this feature SCOTTI is likely to suit
outbreaks with frequent mixed infections and large transmission inocula (see e.g. [32]),
like many gut and environmental bacteria which have high prevalence and low
pathogenicity. The model could also be extended in the future to allow different types
of epidemiological data (such as a prior on the time of each infection, while we now only
allow a fixed older bound); or also compartmental epidemiological models [33], and
geographic distance or structure of different hosts.

In conclusion, we have presented a new method to reconstruct transmission events,

SCOTTI, that addresses the urgent need for software to analyse genomic and
epidemiological data while accommodating for incomplete or patchy host sampling,
mixed infections, and within-host variation. For these reasons, our method can help to
reconstruct transmission histories in a broad range of outbreaks, both bacterial and
viral. This information will in turn be essential for devising effective strategies to fight
the spread of infectious disease.

Software Availability

SCOTTI is distributed as an open source package for the Bayesian phylogenetic
software BEAST2. It can be downloaded from https://bitbucket.org/nicofmay/scotti/
or via the BEAUti interface [34] of BEAST2.

Materials and Methods

Approximate Structured Coalescent Model

Recently, we proposed a BAyesian STructured coalescent Approximation (BASTA) that
uses the structured coalescent framework (also known as the coalescent with migration)
to infer migration rates and events between populations [27]. BASTA requires
substantially less computational time than the exact structured coalescent, particularly
when more than just a few populations are considered, by using approximations
similarly to [35, 36]. Here, we use the modelling approximations of BASTA in an
epidemiological setting, where we model each host as a distinct pathogen population
and transmissions as migration events (see Figure 2B). A list of the symbols used
hereafter is given in Table A in S1 Text.
To allow the inclusion of epidemiological data, each population (host) d ∈ D is
associated with an exposure interval limited by an introduction time di ∈ (−∞, +∞]
and a removal time dr ∈ [−∞, +∞), with dr < di (we consider time backward as typical
in coalescent theory). The interval [dr, di] represents the exposure interval for
population d, outside of which d cannot host any pathogen lineage. di and dr represent
respectively the times at which first it was possible for the host to have been infected,

14

and last to have been infectious. For example, in a nosocomial outbreak, di and dr
would represent respectively the time of arrival and departure of host d into and from
the infected hospital or ward. We assume that di and dr are provided by the user and
are therefore hereby treated as auxiliary data (we do not model host exposure, and
exposure times are always conditioned on). In the worst case scenario where no
information on host d exposure is provided, it is assumed that d is exposed for the
whole outbreak (di = +∞ and dr = −∞). We will denote as E the collection of
exposure times. The number of populations nD is not fixed, but is estimated within a
range specified by the user. In the remainder of this work, we will assume that
non-sampled demes have unlimited exposure times, but we also provide the option in
SCOTTI of specifying regularly distributed introduction and removal times. Here, nD
does not necessarily correspond to the number of non-sampled intermediate hosts in the
outbreak, as each host can be infected multiple times, so a non-sampled host due to its
infinite exposure time can model more than one non-sampled intermediate host. An
additional important difference to [27] is that we assume that the migration (or
infection) rate m is the same between each pair of hosts for the time that they are both
exposed. Also, all demes are assumed to have the same effective population size Ne.
This means that we assume that transmission is a priori equally likely between any pair
of exposed hosts, and that all hosts have equal, and constant, within-host pathogen
evolution dynamics. These assumptions of equal population sizes and migration rates
simplify the model and distinguish it from classical structured coalescent methods. In
fact, rather than focusing on estimating differences in migration rates and population
sizes as in typical structured coalescent methods, we focus on the inference of migration
(that is, transmission) events. Yet, these assumptions could be relaxed for example to
account for geographically structured hosts or for known contact network. For the time
that a host d is not exposed, migration rate into or out of d is 0.
We assume that a set of samples I is provided, where each sample i ∈ I comes with
an aligned sequence si ∈ S, a sampling date ti ∈ tI , and a sampled host li ∈ L. We
allow any number of samples from any host, including none (for non-sampled hosts). In
this study, we assume that the molecular evolution process follows a time-homogeneous
and site-homogeneous HKY model [37], with parameters µ. However, it could be as
general as allowed by BEAST2. We denote T the bifurcating tree that elucidates the
phylogenetic relationships of the samples, and M the migration history of all lineages
(the collection of all migration/transmission events).

To infer the transmission history in a Bayesian statistical framework, we aim to

approximate the following joint posterior distribution:

P (T, M, nD, µ, m, Ne,|S, tI , L, E) ∝

∝ P (S|T, tI , µ)P (T, M|tI , L, m, Ne, E, nD)P (µ, m, Ne, nD).

(1)

The first term on the right hand side is the likelihood of the sequences given the
genealogy and substitution model. It assumes that sequences evolves down the tree
according to a continuous time Markov chain and it can be generally calculated with
Felsenstein’s pruning algorithm [38]. The second term is the probability density of the
genealogy and migration history. The third term represents the joint prior distribution
on the parameters of the nucleotide substitution model and the migration model.
Generally, exploring the space of all possible migration histories is computationally
demanding even for moderate numbers of populations [27]. For this reason, we integrate
over all migration histories by approximating the following posterior distribution as in
BASTA [27]:
P (T, nD, µ, m, Ne|S, tI , L, E) ∝ P (S|T, tI , µ)P (T|tI , L, m, Ne, E, nD)P (µ, m, Ne, nD).
(2)

15

To approximate P (T|tI , L, m, Ne, E, nD) in Eq 2, we consider the probability

density of each time interval between successive events (coalescence, sampling,
population introduction, or population removal events). The steps below are very
similar to those in BASTA, the main differences being that here we assume equal
migration rates and population sizes, and we account for population introductions and
removals. Denoting each interval Ai = [αi−1, αi], where αi is the older event time of Ai
and αi−1 the more recent, the probability density of interval Ai can be written as

−

(cid:90) αi

(cid:88)

(cid:88)

1
2

(cid:88)

αi−1

d∈D

l∈Λi

l(cid:48)∈Λi,l(cid:48)(cid:54)=l

 Ei,

P (dl = d, dl(cid:48) = d|t)

1
Ne

dt

(3)

Li = exp

(cid:80)



Ei =

where Λi is the set of all extant lineages during interval Ai, dl is the host to which
lineage l belongs, and P (dl = d, dl(cid:48) = d|t) is the probability that lineages l and l(cid:48) are in
the same host d at time t. Ei is the contribution of the particular event:

d∈D Pl,αi,dPl(cid:48),αi,d

1

1
Ne

if it is a coalescence between l and l(cid:48),

(4)

otherwise.

To approximate Li we substitute P (dl = d, dl(cid:48) = d|t) with P (dl = d|t)P (dl(cid:48) = d|t),
which corresponds to modelling lineages as migrating independently of each other within
an interval between events. This is an approximation in general, but as shown in [27] it
has limited effect on estimation. As shorthand, we define Pl,t to be the vector whose
dth element is Pl,t,d = P (dl = d|t). Next, we split each interval Ai into two sub-intervals
of equal length Ai1 = [αi−1, (αi + αi−1)/2] and Ai2 = [(αi + αi−1)/2, αi], and replace
Pl,t with Pl,αi−1 for all t in Ai1 and Pl,αi for all t in Ai2. We also call τi := αi − αi−1.
The approximated probability density contributions of Ai1 and Ai2 become:

1
Ne


 E(cid:48)

i.

(5)

(6)

1
2

1
2

2

d∈D

l∈Λi

l(cid:48)∈Λi,l(cid:48)(cid:54)=l

(cid:88)

(cid:88)

(cid:88)

− τi
− τi
P (T|tI , L, m, Ne, E, nD) ≈(cid:89)

(cid:88)

l∈Λi

l(cid:48)∈Λi,l(cid:48)(cid:54)=l

(cid:88)

(cid:88)

2

d∈D

˜Li1 = exp

Pl,αi−1,dPl(cid:48),αi−1,d

and

˜Li2 = exp

Pl,αi,dPl(cid:48),αi,d

1
Ne

The probability density of the genealogy under the structured coalescent, integrated

over migration histories, is finally approximated as

˜Li1 ˜Li2.

(7)

i

The probability distribution of lineages among demes is updated iteratively starting

from the most recent event toward the past as

Pl,αi,d = Pl,αi−1,d(

1
Di

+

Di − 1
Di

e−τim) + (1 − Pl,αi−1,d)(

1
Di

− 1
Di

e−τim)

(8)

for any host d exposed during the considered interval, where Di is the number of hosts
(sampled or non-sampled) exposed during interval Ai. This comes from the assumption
that any lineage migrates away from the current host at total rate m, and uniformly
towards all other extant hosts. For a lineage l sampled from deme d at time t, Pl,t is a

16

vector whose dth element equals one and all other entries equal zero. If lineages l1 and
l2 coalesce to an ancestral lineage l at time t, then

(cid:80)nD

d=1 Pl1,t,dPl2,t,d

(Pl1,t,1Pl2,t,1, . . . , Pl1,t,nD Pl2,t,nD )

Pl,t =

,

(9)

which is the normalised entrywise product (element by element product) of the
distributions of the coalescing lineages. If instead αi = di is the introduction time for a
deme, all remaining lineages in host d are forced to migrate out of host d. First, ∀l ∈ Λi
we update the probabilities as in Eq. 8. Then, ∀l ∈ Λi, Pl,αi,d is set to 0, and its value
is distributed uniformly over all other hosts. If the considered event is a removal of host
d, Eq. 8 is used again, and ∀l ∈ Λi Pl,αi,d is initiated with the value 0.

Samples from the posterior distribution in Eq. 2 are simulated via a Monte Carlo

Markov Chain (MCMC). For each of the MCMC samples we simulate hosts at the
internal nodes of T , and numbers of transmission events along branches, using the same
technique as in [27]: first, starting from the root of T and progressing towards the tips,
a host for each internal node is sampled according to its posterior probability (Eq. 9)
and conditional on the host sampled at its parent node. Secondly, the numbers of
transmission events on each branch are sampled under a Poisson distribution depending
on the migration rate m and conditional on if the previously sampled hosts at the
extremities of the considered branch are the same or not.

SCOTTI allows a large number of populations to be investigated, as the assumption

of uniformity of migration rates and effective population sizes greatly reduces the
computational demand and parameter space compared to [27]. Also, all non-sampled
hosts with the same exposure interval are de facto identical, so usually nD has no effect
on the computational demand of SCOTTI. Example files and data from the analyses
described hereby can be found in Supplementary Dataset S1.

Simulations of Pathogen Evolution

We test the performance in transmission inference of SCOTTI and Outbreaker using a
broad range of simulation scenarios. We simulate within-outbreak pathogen evolution
using the transmission events observed in two example real-life outbreaks. For half of
simulations we use a subset of the FMDV transmission history inferred in [15] (hereby
referred to as “transmission history 1”) including 20 UK farms infected during the 2001
outbreak. For the other half of the simulations we use the HIV transmission history
described in [8] (hereby referred to as “transmission history 2”) of an outbreak occurred
between 1981 and 1983, where a male contracted HIV in 1980 and spread it to six
females who subsequently infected two male sexual partners and two children. A
description of the transmission history of both scenarios is depicted in Figure C in S1
Text.

While we simulate the coalescent process randomly, the transmission process is fixed
a priori, so that always the same transmission events at the same time are considered,
and only within-host evolution of lineages is varied in different replicates. We use a
variant of the multi-species coalescent [31] which is similar to the model used recently in
comparable simulations [12, 24]. The model used for simulations is considerably different
to both the SCOTTI and Outbreaker models of pathogen evolution (see Figure 2).
Hereby each host, during its time of infection, is modelled as a pathogen population
with constant effective population size Ne, which is the same for all hosts. Lineages
within a host can freely coalesce back in time as in the standard coalescent.

In addition to within-host evolution, we want to simulate a typical transmission: a
small proportion of the pathogen population passed on at transmission (due to limited
inoculum size), followed by rapid growth in the recipient (see e.g. [39, 40]). Therefore,

17

we simulate transmission as a backward in time instantaneous bottleneck in the
recipient, followed back in time by the merge of the donor and recipient populations
into the donor host. The bottlenecks simulated can have two effect sizes: either
equivalent to the drift of Ne generations (a weak bottleneck through which two lineages
have a probability of ≈ 63% of coalescing), or 100 Ne generations (a strong bottleneck
through which two lineages almost surely coalesce). For half of the simulation scenarios
we use a weak bottleneck, for the other half a strong one. In the population merger
after the bottleneck all lineages remaining in the recipient host are moved to the donor
host. Transmission bottlenecks are neither modelled in SCOTTI, nor in Outbreaker
(Figure 2).

Finally, half of the simulations are performed providing one sample per host, the

other half providing two samples per host, although Outbreaker is only used with one
sample per host as it is the only permitted scenario. In summary we have 2 × 2 × 2 = 8
groups of simulations:

• Weak vs strong bottleneck
• First vs second transmission history
• One vs two samples per host.

For each of the aforementioned eight groups, eight different scenarios (or subgroups)
are simulated, for a total of 64 distinct simulation settings. We define a basic subgroup
(called “base”), and seven variants, in each of which one aspect of the base subgroup is
modified. In “base”, sampling times are picked uniformly at random and independently
within host exposure times, the average time of infection is 2 Ne generations, host is
sampled, the alignment length is 1500 bp, and the epidemiological data provided to
SCOTTI is accurate (introduction and removal times correspond to infection and
recovery time of hosts). The seven variant settings are:

• Long infection - the intervals of infection are five times longer (on average 10 Ne

generations).

• Abundant genetic - the alignment is 10 times longer (15000 bp).
• Early sampling - samples are collected very early in infection, that is, 5% of the

total infection time after infection.

• Late sampling - samples are collected at recovery time for each host.
• Few missing - one host in the outbreak is not sampled (host O for transmission

history 1 and host P5 for transmission history 2).

• Many missing - three hosts are not sampled (O, G, and H for transmission

history 1, and P1, P5, and P8 for transmission history 2).

• Inaccurate epi - SCOTTI is provided with an exposure interval that is broader
than the interval of infection of each host. In particular, if ¯Li is the average length
of infection among hosts, then introduction and removal times are respectively
¯Li/2 earlier than infection and ¯Li/2 later than recovery time.

For each of the total 64 subgroups, 100 datasets are simulated under an HKY
substitution model [37] with κ = 3, 10−3 substitution rate per base per Ne generations,
and uniform nucleotide frequencies.

For each simulated dataset we infer transmission with Outbreaker under the HKY
substitution model and with 106 MCMC iterations. Each analysis is initiated with a
random starting tree and with uniform prior infection and sampling probabilities over
the maximum observed infection time interval. We run SCOTTI with an HKY
substitution model, between 0 and 2 non-sampled hosts, and 106 MCMC iterations. For
both methods we assess the performance by checking how often the correct origin of

18

infection of each sampled host is recovered, and with what posterior probability. If
transmission from host 1 to host 2 is inferred (either by SCOTTI or Outbreaker), then
the infection origin of host 2 is inferred to be host 1. If an indirect transmission to host
2 is inferred, or host 2 is inferred to be an index host or an imported host, then the
infection origin of host 2 is inferred to be non-sampled. Lastly, if SCOTTI infers
multiple origins of the same host, then, if more than one origin is a sampled host, we
always consider the inference as wrong; otherwise we consider the only sampled origin.
We use two metrics to define the accuracy of an origin inference: (i) the number of
replicates in which the simulated origin is the one with the highest posterior probability
(ii) the average posterior probability of the simulated origin across replicates.

Foot and Mouth Disease Virus and K. Pneumoniae data

We apply and compare SCOTTI and Outbreaker on two real datasets: one from the
2007 FMDV outbreak in UK [29] and one from a K. pneumoniae outbreak in a Nepali
hospital in 2011-2012 [30]. In both cases we use alignments, sampling dates and
exposure times as provided in the respective studies. All hosts have a single sample,
except IP1b (two samples) for FMDV and PMK4, PMK5, PMK13, PMK26 (two
samples) and PMK21 (five samples) for K. pneumoniae. When multiple samples are
present for the same host, only the oldest sample is provided to Outbreaker (which only
allows one sample per host). Outbreaker is run for 2 × 106 MCMC iterations on FMDV,
and 109 iterations on K. pneumoniae, with initial transmission tree inferred with
SeqTrack, an HKY substitution model, and prior infectivity and sampling distributions
uniform over the maximum exposure interval observed. SCOTTI is run for 108 MCMC
iterations under an HKY substitution model and with between zero and two
non-sampled hosts. In all cases we checked MCMC convergence with the likelihood
trace and effective sample size. These datasets are provided in S1 Data, and can also be
downloaded from https://bitbucket.org/nicofmay/scotti/. From the same link, SCOTTI
source files and executables can be freely downloaded.

Supporting Information

S1 Text

Supplementary Text. The supplementary text contains further details of the
methods and analyses, in particular all supplementary figures and tables.

S1 Data

Supplementary Data. File containing information to replicate results.

Acknowledgments

We thank Xavier Didelot, David Eyre, Thibaud Jombart, Erik Volz and Nicole Stoesser
for comments and suggestions on early versions of the manuscript.

References

1. Didelot X, Bowden R, Wilson DJ, Peto TE, Crook DW. Transforming clinical

microbiology with bacterial genome sequencing. Nature Reviews Genetics.
2012;13(9):601–612.

19

2. Wilson DJ. Insights from genomics into bacterial pathogen populations. PLoS

Pathog. 2012;8(9):e1002874.

3. K¨oser CU, Ellington MJ, Cartwright E, Gillespie SH, Brown NM, Farrington M,
et al. Routine use of microbial whole genome sequencing in diagnostic and public
health microbiology. PLoS Pathog. 2012;8(8):e1002824.

4. Le V, Diep BA. Selected insights from application of whole-genome sequencing

for outbreak investigations. Current opinion in critical care. 2013;19(5):432–439.

5. Eyre DW, Cule ML, Wilson DJ, Griffiths D, Vaughan A, O’Connor L, et al.

Diverse sources of C. difficile infection identified on whole-genome sequencing.
New England Journal of Medicine. 2013;369(13):1195–1205.

6. Walker TM, Ip CL, Harrell RH, Evans JT, Kapatai G, Dedicoat MJ, et al.

Whole-genome sequencing to delineate Mycobacterium tuberculosis outbreaks: a
retrospective observational study. The Lancet infectious diseases.
2013;13(2):137–146.

7. Walker TM, Lalor MK, Broda A, Ortega LS, Morgan M, Parker L, et al.

Assessment of Mycobacterium tuberculosis transmission in Oxfordshire, UK,
2007–12, with whole pathogen genome sequences: an observational study. The
Lancet Respiratory Medicine. 2014;2(4):285–292.

8. Leitner T, Escanilla D, Franzen C, Uhlen M, Albert J. Accurate reconstruction of
a known HIV-1 transmission history by phylogenetic tree analysis. Proceedings of
the National Academy of Sciences. 1996;93(20):10864–10869.

9. Harris SR, Feil EJ, Holden MT, Quail MA, Nickerson EK, Chantratita N, et al.

Evolution of MRSA during hospital transmission and intercontinental spread.
Science. 2010;327(5964):469–474.

10. Pybus OG, Rambaut A. Evolutionary analysis of the dynamics of viral infectious

disease. Nature Reviews Genetics. 2009;10(8):540–550.

11. Worby CJ, Lipsitch M, Hanage WP. Within-host bacterial diversity hinders

accurate reconstruction of transmission networks from genomic distance data.
PLoS Comput Biol. 2014;10:e1003549.

12. Romero-Severson E, Skar H, Bulla I, Albert J, Leitner T. Timing and order of

transmission events is not directly reflected in a pathogen phylogeny. Molecular
biology and evolution. 2014;31(9):2472–2482.

13. Kingman JFC. The coalescent. Stoch Proc Appl. 1982;13(3):235–248.

14. Volz EM, Frost SD. Inferring the source of transmission with phylogenetic data.

PLoS Comput Biol. 2013;.

15. Cottam EM, Th´ebaud G, Wadsworth J, Gloster J, Mansley L, Paton DJ, et al.
Integrating genetic and epidemiological data to determine transmission pathways
of foot-and-mouth disease virus. Proceedings of the Royal Society of London B:
Biological Sciences. 2008;275(1637):887–895.

16. Aldrin M, Lyngstad T, Kristoffersen A, Storvik B, Borgan Ø, Jansen P.

Modelling the spread of infectious salmon anaemia among salmon farms based on
seaway distances between farms and genetic relationships between infectious
salmon anaemia virus isolates. Journal of The Royal Society Interface.
2011;8(62):1346–1356.

20

17. Jombart T, Eggo R, Dodd P, Balloux F. Reconstructing disease outbreaks from

genetic data: a graph approach. Heredity. 2011;106(2):383–390.

18. Lieberman TD, Michel JB, Aingaran M, Potter-Bynoe G, Roux D, Davis Jr MR,

et al. Parallel bacterial evolution within multiple patients identifies candidate
pathogenicity genes. Nature genetics. 2011;43(12):1275–1280.

19. Morelli MJ, Th`ebaud G, Chadœuf J, King DP, Haydon DT, Soubeyrand S. A

Bayesian Inference Framework to Reconstruct Transmission Trees Using
Epidemiological and Genetic Data. PLoS Comput Biol. 2012 11;8(11):e1002768.

20. Ypma R, Bataille A, Stegeman A, Koch G, Wallinga J, Van Ballegooijen W.
Unravelling transmission trees of infectious diseases by combining genetic and
epidemiological data. Proceedings of the Royal Society of London B: Biological
Sciences. 2012;279(1728):444–450.

21. Ypma RJ, van Ballegooijen WM, Wallinga J. Relating phylogenetic trees to

transmission trees of infectious disease outbreaks. Genetics.
2013;195(3):1055–1062.

22. Jombart T, Cori A, Didelot X, Cauchemez S, Fraser C, Ferguson N. Bayesian

reconstruction of disease outbreaks by combining epidemiologic and genomic data.
PLoS computational biology. 2014;10(1).

23. Mollentze N, Nel LH, Townsend S, Le Roux K, Hampson K, Haydon DT, et al. A

Bayesian approach for inferring the dynamics of partially observed endemic
infectious diseases from space-time-genetic data. Proceedings of the Royal Society
of London B: Biological Sciences. 2014;281(1782):20133251.

24. Didelot X, Gardy J, Colijn C. Bayesian inference of infectious disease

transmission from whole-genome sequence data. Molecular biology and evolution.
2014;31(7):1869–1879.

25. Hall M, Woolhouse M, Rambaut A. Epidemic Reconstruction in a Phylogenetics

Framework: Transmission Trees as Partitions of the Node Set. PLoS Comput
Biol. 2015;11(12):e1004613.

26. Romero-Severson EO, Bulla I, Leitner T. Phylogenetically resolving epidemiologic

linkage. Proceedings of the National Academy of Sciences. 2016;p. 201522930.

27. De Maio N, Wu CH, O’Reilly KM, Wilson D. New Routes to Phylogeography: A

Bayesian Structured Coalescent Approximation. PLoS Genet.
2015;11(8):e1005421.

28. Bouckaert R, Heled J, K¨uhnert D, Vaughan T, Wu CH, Xie D, et al. BEAST 2:

a software platform for Bayesian evolutionary analysis. PLoS Comput Biol.
2014;10(4):e1003537.

29. Cottam EM, Wadsworth J, Shaw AE, Rowlands RJ, Goatley L, Maan S, et al.

Transmission pathways of foot-and-mouth disease virus in the United Kingdom in
2007. PLoS Pathog. 2008;4(4):e1000050.

30. Stoesser N, Giess A, Batty E, Sheppard A, Walker A, Wilson D, et al. Genome

sequencing of an extended series of NDM-producing Klebsiella pneumoniae
isolates from neonatal infections in a Nepali hospital characterizes the extent of
community-versus hospital-associated transmission in an endemic setting.
Antimicrobial agents and chemotherapy. 2014;58(12):7347–7357.

21

31. Rannala B, Yang Z. Bayes estimation of species divergence times and ancestral

population sizes using DNA sequences from multiple loci. Genetics.
2003;164(4):1645–1656.

32. Murcia PR, Baillie GJ, Daly J, Elton D, Jervis C, Mumford JA, et al. Intra-and

interhost evolutionary dynamics of equine influenza virus. Journal of virology.
2010;84(14):6943–6954.

33. Brauer F. Compartmental models in epidemiology. In: Mathematical

epidemiology. Springer; 2008. p. 19–79.

34. Drummond AJ, Suchard MA, Xie D, Rambaut A. Bayesian phylogenetics with

BEAUti and the BEAST 1.7. Mol Biol Evol. 2012;29(8):1969–1973.

35. Volz EM. Complex population dynamics and the coalescent under neutrality.

Genetics. 2012;190(1):187–201.

36. Rasmussen DA, Volz EM, Koelle K. Phylodynamic Inference for Structured

Epidemiological Models. PLoS Comput Biol. 2014;10(4):e1003570.

37. Hasegawa M, Kishino H, Yano Ta. Dating of the human-ape splitting by a

molecular clock of mitochondrial DNA. J Mol Evol. 1985;22(2):160–174.

38. Felsenstein J. Evolutionary trees from DNA sequences: a maximum likelihood

approach. J Mol Evol. 1981;17(6):368–376.

39. Salazar-Gonzalez JF, Salazar MG, Keele BF, Learn GH, Giorgi EE, Li H, et al.

Genetic identity, biological phenotype, and evolutionary pathways of
transmitted/founder viruses in acute and early HIV-1 infection. The Journal of
experimental medicine. 2009;206(6):1273–1289.

40. Bull RA, Luciani F, McElroy K, Gaudieri S, Pham ST, Chopra A, et al.

Sequential bottlenecks drive viral evolution in early acute hepatitis C virus
infection. PLoS Pathog. 2011;7(9):e1002243.

22

S1 Text

23

Figure A. Different representations of transmission events and phylogeny.
In our manuscript and software, we use several graphical representations to emphasize
different aspects of the transmission and evolutionary histories of pathogens A) To
jointly show the evolutionary history of pathogen lineages and transmission events, we
adopt “nested” trees. Black boxes represent different hosts (here H1, H2, and H3) and
their exposure intervals, limited by the top and bottom edges of each box. Transmission
between hosts is represented by blue tubes. Red dots are sequence samples, and red
lines represent the pathogen phylogeny. B) To focus on the transmission events only, we
use “beanbag” trees. Each host is represented as a circle, with arrows from donor to
recipient host. C) Standard phylogenetic tree relating the sampled sequences. D) To
represent transmission and evolutionary history simultaneously without including
epidemiological data, we use “Maypole” trees. The phylogenetic tree representing the
evolutionary history of the pathogen is annotated with colours (one colour for each host)
representing the host within which the lineage is inferred to have been. Transition from
one colour to another represents transmission between hosts. In this supplement, a
similar graphical format is used, where the tree represents the transmission tree
enriched with epidemiological data.

Table A. Symbols used in model description.

D
nD
dr
di
E
m
Ne
I
si
ti
li
µ
T
M
Ai = [αi−1, αi]
τi = αi − αi−1
Λi
Ai1 and Ai2
Di

set of all hosts
size of D (total number of hosts)
removal time
introduction time
set of all exposure time information
transmission rate
within-host effective population size
set of samples
genetic sequence of sample i
time of collection of sample i
host from which sample i is collected
substitution rate matrix
phylogeny relating the samples
transmission history
time interval between events
length of time between events
set of extant lineages at interval i
sub-intervals of Ai
number of hosts exposed at interval i

24

TimeNested transmission and phylogenetic treeAS1S2S3H1H2H3H1H2H3S1S2S3Transmission tree(“beanbag” tree)BCPhylogenetic treeS1S2S3DAnnotated phylogenetic tree(“Maypole” tree)Figure B. Comparison of approaches to transmission inference from genetic
data. Several methods to reconstruct transmission from genetic and epidemiological
data have been proposed in literature, and here we attempt a comparison and summary
of their features. Each row represents a method for inferring transmission history, and
each column represents a feature of the model. A red “X” means that the feature is not
included, while a green “V” means that the feature is allowed. “−” methods without an
explicit phylogenetic structure can indirectly account for phylogenetic uncertainty.

25

Method'Allows'mul.ple'samples'from'same'host'Uses'exposure'data'Uses'sampling'.mes'Uses'phylogene.c'structure'Accounts'for'tree'uncertainty'Allows'non:observed'hosts'Allows'host'distance'data'Models'within:host'evolu.on'Allows'mixed'infec.ons'Models'par.al'transmission'bo=lenecks'Allows'compartmentaliza.on'model'Infers'infec.on'.mes'Co=am'et'al'2008'(cid:2)'(cid:1)(cid:1)'(cid:1)'(cid:2)'(cid:2)'(cid:2)'(cid:2)'(cid:2)'(cid:2)'(cid:2)'(cid:1)'Aldrin'et'al'2011'(cid:2)'(cid:1)'(cid:2)'(cid:2)':'(cid:2)'(cid:1)'(cid:2)'(cid:2)'(cid:2)'(cid:2)'(cid:1)'Ypma'et'al'2011'(cid:2)'(cid:1)'(cid:2)'(cid:2)':'(cid:2)'(cid:1)'(cid:2)'(cid:2)'(cid:2)'(cid:2)'(cid:1)'Jombart'et'al'2011'(SeqTrack)'(cid:2)'(cid:2)'(cid:1)'(cid:2)':'(cid:1)'(cid:1)'(cid:2)'(cid:2)'(cid:2)'(cid:2)'(cid:2)'Morelli'et'al'2012'(cid:2)'(cid:1)'(cid:1)'(cid:2)':'(cid:2)'(cid:1)'(cid:2)'(cid:2)'(cid:2)'(cid:2)'(cid:1)'Ypma'et'al'2013'(cid:2)'(cid:1)'(cid:1)'(cid:1)'(cid:1)'(cid:2)'(cid:2)'(cid:1)'(cid:2)'(cid:2)'(cid:2)'(cid:1)'Jombart'et'al'2014'(Outbreaker)'(cid:2)'(cid:2)'(cid:1)'(cid:2)':'(cid:1)'(cid:1)'(cid:2)'(cid:2)'(cid:2)'(cid:2)'(cid:1)'Didelot'et'al'2014'(cid:2)'(cid:1)'(cid:1)'(cid:1)'(cid:2)'(cid:2)'(cid:2)'(cid:1)'(cid:2)'(cid:2)'(cid:1)'(cid:1)'Mollentze'et'al'2014'(cid:2)'(cid:1)'(cid:1)'(cid:2)':'(cid:1)'(cid:1)'(cid:2)'(cid:2)'(cid:2)'(cid:2)'(cid:1)'SCOTTI'(cid:1)'(cid:1)'(cid:1)'(cid:1)'(cid:1)'(cid:1)'(cid:2)'(cid:1)'(cid:1)'(cid:2)'(cid:2)'(cid:2)'Figure C. Accuracy of Reconstructed transmissions in the base simulation
scenario. SCOTTI shows overall higher accuracy than Outbreaker in the base
simulation setting. Coloured trees represent the (fixed) simulated transmission trees,
with one colour associated to each host, and internal nodes corresponding to infection
events and times, while tips represent infection clearance times. A) transmission history
1, B) transmission history 2. In both plots the base simulation setting is considered.
The numbers show the accuracy of the infection origin inference for each sampled host.
Statistics for each origin are plotted below the branch at which top the respective
transmission event occurs. For example, in A, statistics regarding the origin of infection
of host M are plotted below the branch representing host M. Statistics regarding index
hosts (K in A and P1 in B) are shown next to the root. The origin of infection of a
host is defined as either the donor host, if it is sampled, or a general non-sampled origin
otherwise. The non-bracketed numbers represent replicates (out of a total of 100) for
which the considered origin has been correctly inferred. The numbers in brackets are
the average posterior support for the corresponding correct origin over all replicates.
For each considered origin, each row represents the results from one of the inference
methods (“S1” represents SCOTTI with 1 sample, “S2” SCOTTI with two samples, and
“O” Outbreaker). In blue are results for a strong bottleneck (equivalent to the drift of
100 Ne generations), in red for a weak bottleneck (equivalent to the drift of Ne
generations).

26

2.0P6P8P11P7P5P2P3P1P9P1P2P1P5P1P1P8P1#SNPs&per&case:&2.2&Overall&accuracy:&100&&100&(97)&(97)&&&99&&100&(94)&(97)&&&60&&&&53&(60)&(53)&S1&&&S2&&&O&&&S1&46&(37)&49&(37)&&&S2&81&(71)&81&(72)&O&&45&(42)&50&(53)&S1&&40&(41)&&&S2&&73&(61)&O&&&&35&(35)&S1&36&(35)&38&(38)&&&S2&73&(53)&79&(55)&O&&33&(30)&18&(20)&S1&30&(35)&27&(34)&&&S2&76&(55)&78&(57)&O&&26&(27)&16&(16)&S1&&0&(7)&&&&2&(7)&&&S2&10&(15)&12&(16)&O&&25&(26)&34&(33)&S1&35&(38)&31&(34)&&&S2&77&(56)&79&(56)&O&&35&(33)&20&(19)&S1&28&(35)&27&(33)&&&S2&74&(56)&80&(58)&O&&26&(27)&17&(17)&S1&59&(50)&63&(53)&&&S2&85&(80)&85&(80)&O&&67&(63)&66&(64)&S1&26&(36)&27&(33)&&&S2&76&(60)&76&(62)&O&&26&(26)&16&(16)&8.0GBLJOIMPKFDCEDKGKKLOIOKFO#SNPs&per&case:&2.5&Overall&accuracy:&S1&34&(41)&39&(42)&&&S2&73&(61)&70&(60)&O&&49&(49)&56&(54)&S1&61&(48)&75&(57)&&&S2&90&(78)&89&(79)&O&&51&(50)&60&(57)&S1&43&(37)&40&(37)&&&S2&69&(55)&70&(56)&O&&29&(32)&33&(32)&S1&37&(38)&45&(43)&&&S2&79&(62)&79&(62)&O&&43&(45)&46&(48)&S1&46&(36)&49&(38)&&&S2&81&(68)&79&(64)&O&&32&(32)&40&(37)&S1&61&(43)&60&(42)&&&S2&79&(62)&75&(58)&O&&33&(32)&34&(34)&S1&63&(40)&62&(42)&&&S2&77&(61)&78&(59)&O&&29&(31)&33&(32)&S1&91&(64)&&&89&(63)&&&S2&100&(88)&98&(89)&O&&72&(69)&&&69&(66)&S1&46&(37)&38&(35)&&&S2&64&(53)&68&(54)&O&&34&(36)&33&(36)&S1&75&(46)&71&(47)&&&S2&97&(83)&95&(83)&O&&44&(43)&54&(55)&S1&87&(63)&&&93&(67)&&&S2&100&(92)&100&(93)&O&&66&(63)&&&&60&(60)&S1&95&(69)&93&(70)&&&S2&98&(91)&98&(90)&O&&66&(66)&75&(73)&100&&100&(98)&(99)&&&99&&100&(98)&(96)&&&67&&&&66&(67)&(66)&S1&&&S2&&&O&&&S1&&65&(52)&&&S2&&85&(73)&O&&&&49&(49)&O"SCOTTI,&1&sample&SCOTTI,&2&samples&OUTBREAKER&100&Ne&boLleneck&1Ne&boLleneck&S1&S2&A"B"Figure D. Summary of errors in transmission inference. While error in
Outbreaker is mostly attributable to the inference of direct transmission between the
wrong pair of sampled hosts, in SCOTTI it is more often due to the incorrect
attribution of infection source to non-sampled hosts. Pathogen sequence evolution was
simulated under transmission history 1, used in A and C, and transmission history 2,
used in B and D. In A and B bars represent proportions, expressed as percentages, of
incorrect inferences of transmission origin (i.e. donor host) over 100 replicates and all
transmission events for each method (differentiated by colour as in legend). The
proportion of error due to attribution of transmission to non-sampled hosts is shaded
with hashes, while the proportion of error due to attribution to sampled hosts is not
shaded. In C and D bars represent average posterior supports, again expressed as
percentages, for the incorrect sources over all patients and replicates. On the X axis are
different simulation scenarios.

27

History(1(History(2(Simula0on(scenario(Mean(posterior(support(of((incorrect(transmission(Mean(propor0on(of(error((of(the(point(es0mate(A(B(C(D(Figure E. SCOTTI and Outbreaker accuracy with non-sampled hosts.
SCOTTI shows overall higher accuracy than Outbreaker in the simulation scenarios
with some non-sampled hosts. Trees represent simulated transmission trees, internal
nodes correspond to infection events and times, and tips represent infection clearance
times. The numbers represent inference accuracy as described in Figure C. A)
Transmission history 1 and one non-sampled host (O). B) Transmission history 2 and
one non-sampled host (P5). C) Transmission history 1 and three non-sampled hosts (O,
G, and H). D) Transmission history 2 and three non-sampled hosts (P1, P5, and P8).

28

2.0P6P8P11P7P5P2P3P1P9P1P2P1P5P1P1P8P1#SNPs&per&case:&2.7&Overall&accuracy:&S1&37&(34)&53&(43)&&&S2&84&(72)&74&(64)&O&&57&(56)&50&(51)&S1&&86&(73)&&&S2&&78&(66)&O&&&&38&(39)&S1&96&(77)&93&(74)&&&S2&69&(52)&79&(60)&O&&70&(70)&62&(62)&S1&95&(78)&96&(75)&&&S2&70&(56)&79&(63)&O&&15&(17)&29&(31)&S1&97&(81)&94&(78)&&&S2&80&(65)&83&(68)&O&&23&(25)&30&(32)&S1&100&(97)&100&(97)&&&S2&&99&(96)&&99&(97)&O&&&36&(37)&&40&(41)&S1&89&(71)&86&(68)&&&S2&50&(43)&64&(50)&O&&18&(19)&23&(24)&S1&?&(?)&?&(?)&&&S2&?&(?)&?&(?)&O&&?&(?)&?&(?)&S1&?&(?)&?&(?)&&&S2&?&(?)&?&(?)&O&&?&(?)&?&(?)&S1&?&(?)&?&(?)&&&S2&?&(?)&?&(?)&O&&?&(?)&?&(?)&2.0P6P8P11P7P5P2P3P1P9P1P2P1P5P1P1P8P1#SNPs&per&case:&2.3&Overall&accuracy:&100&&100&(96)&(96)&&&98&&100&(95)&(95)&&&60&&&&55&(60)&(56)&S1&&&S2&&&O&&&S1&51&(38)&58&(40)&&&S2&78&(66)&83&(72)&O&&48&(47)&51&(49)&S1&&53&(48)&&&S2&&70&(60)&O&&&&35&(35)&S1&47&(37)&48&(39)&&&S2&75&(56)&77&(52)&O&&28&(27)&25&(26)&S1&59&(48)&59&(48)&&&S2&17&(22)&13&(21)&O&&14&(16)&10&(13)&S1&39&(37)&39&(36)&&&S2&74&(54)&66&(52)&O&&35&(35)&21&(22)&S1&31&(35)&34&(36)&&&S2&65&(51)&72&(55)&O&&33&(33)&28&(28)&S1&62&(53)&61&(50)&&&S2&80&(77)&91&(84)&O&&57&(55)&54&(54)&S1&31&(35)&29&(36)&&&S2&64&(54)&74&(59)&O&&20&(21)&15&(15)&S1&?&(?)&?&(?)&&&S2&?&(?)&?&(?)&O&&?&(?)&?&(?)&8.0GBLJOIMPKFDCEDKGKKLOIOKFO#SNPs&per&case:&3.2&Overall&accuracy:&S1&100&(98)&100&(98)&&&S2&100&(98)&100&(98)&O&&&87&(87)&&&86&(86)&S1&55&(48)&61&(48)&&&S2&91&(81)&93&(80)&O&&58&(58)&68&(67)&S1&?&(?)&?&(?)&&&S2&?&(?)&?&(?)&O&&?&(?)&?&(?)&S1&100&(83)&100&(83)&&&S2&&89&(72)&&&78&(68)&O&&&17&(18)&&&17&(18)&S1&98&(75)&97&(76)&&&S2&64&(50)&59&(49)&O&&&&0&(1)&&&&0&(1)&S1&97&(68)&97&(70)&&&S2&55&(42)&47&(41)&O&&&&0&(1)&&&&0&(2)&S1&100&(66)&97&(68)&&&S2&&46&(37)&&42&(36)&O&&&&&0&(1)&&&&&1&(2)&S1&84&(60)&79&(59)&&&S2&97&(87)&98&(89)&O&&70&(68)&70&(65)&S1&99&(76)&98&(79)&&&S2&57&(51)&62&(53)&O&&&2&(3)&&&&&&1&(2)&S1&98&(67)&96&(68)&&&S2&22&(30)&20&(30)&O&&10&(10)&16&(17)&S1&80&(66)&78&(62)&&&S2&97&(87)&99&(89)&O&&71&(69)&69&(68)&S1&&91&(71)&&&S2&&71&(63)&O&&&&32&(32)&S1&?&(?)&?&(?)&&&S2&?&(?)&?&(?)&O&&?&(?)&?&(?)&S1&?&(?)&?&(?)&&&S2&?&(?)&?&(?)&O&&?&(?)&?&(?)&8.0GBLJOIMPKFDCEDKGKKLOIOKFO#SNPs&per&case:&2.7&Overall&accuracy:&S1&25&(38)&37&(43)&&&S2&77&(63)&77&(62)&O&&45&(44)&54&(53)&S1&80&(60)&79&(58)&&&S2&89&(79)&95&(84)&O&&48&(49)&55&(52)&S1&?&(?)&?&(?)&&&S2&?&(?)&?&(?)&O&&?&(?)&?&(?)&S1&42&(42)&44&(42)&&&S2&83&(62)&81&(63)&O&&50&(51)&57&(55)&S1&66&(48)&54&(42)&&&S2&15&(19)&10&(17)&O&&&&1&(3)&&&&0&(1)&S1&72&(45)&56&(38)&&&S2&14&(17)&7&(14)&O&&&&0&(2)&&&&1&(2)&S1&70&(43)&55&(37)&&&S2&13&(15)&6&(14)&O&&&&2&(4)&&&&1(1)&S1&86&(63)&89&(65)&&&S2&98&(91)&99&(92)&O&&64&(60)&71&(68)&S1&41&(39)&45&(40)&&&S2&73&(59)&64&(57)&O&&49&(47)&49&(49)&S1&68&(48)&83&(53)&&&S2&95&(82)&98&(85)&O&&45&(44)&50&(49)&S1&84&(60)&&&92&(65)&&&S2&99&(92)&100&(94)&O&&71&(69)&&&&68&(66)&S1&88&(65)&88&(69)&&&S2&99&(92)&99&(93)&O&&74&(70)&63&(60)&100&&100&(98)&(98)&&100&&100&(97)&(98)&&&62&&&&67&(62)&(67)&S1&&&S2&&&O&&&S1&&69&(54)&&&S2&&70&(64)&O&&&&43&(43)&O"SCOTTI,&1&sample&SCOTTI,&2&samples&OUTBREAKER&100&Ne&boMleneck&1Ne&boMleneck&S1&S2&A"C"B"D"Figure F. Increased accuracy with more genetic variation. Both SCOTTI and
Outbreaker show increased accuracy when more genetic variation (and so phylogenetic
signal) is provided, and SCOTTI shows overall higher accuracy than Outbreaker. Trees,
internal nodes and tips have the same respective meanings as those in Figure E. The
numbers represent inference accuracy as described in Figure C. A) Transmission history
1 and long infection time (average time of infection 10 Ne generations instead of 2 Ne).
B) Transmission history 2 and long infection time. C) Transmission history 1 and
abundant genetic data (15000 base pairs instead of 1500). D) Transmission history 2
and abundant genetic data.

29

2.0P6P8P11P7P5P2P3P1P9P1P2P1P5P1P1P8P1#SNPs&per&case:&22&Overall&accuracy:&100&&100&(99)&(99)&&100&&100&(99)&(97)&&&56&&&&56&(57)&(56)&S1&&&S2&&&O&&&S1&63&(50)&60&(47)&&&S2&84&(78)&87&(79)&O&&72&(70)&59&(58)&S1&&56&(52)&&&S2&&78&(72)&O&&&&44&(43)&S1&58&(53)&69&(57)&&&S2&83&(74)&84&(73)&O&&33&(32)&28&(28)&S1&53&(52)&63&(56)&&&S2&85&(71)&79&(70)&O&&34&(34)&31&(31)&S1&&4&(12)&&4&(12)&&&S2&38&(37)&34&(35)&O&&37&(36)&43&(41)&S1&53&(49)&64&(55)&&&S2&80&(69)&74&(71)&O&&29&(29)&31&(29)&S1&46&(46)&48&(48)&&&S2&76&(68)&78&(68)&O&&36&(35)&33&(31)&S1&67&(56)&66&(57)&&&S2&93&(87)&90&(87)&O&&78&(77)&78&(76)&S1&41&(44)&44&(46)&&&S2&68&(63)&65&(64)&O&&25&(25)&27&(27)&8.0GBLJOIMPKFDCEDKGKKLOIOKFO#SNPs&per&case:&25&Overall&accuracy:&S1&65&(56)&62&(53)&&&S2&79&(67)&77&(70)&O&&45&(44)&56&(55)&S1&78&(64)&80&(66)&&&S2&95&(87)&99&(85)&O&&54&(53)&71&(70)&S1&72&(59)&67&(54)&&&S2&91&(80)&90&(80)&O&&43&(43)&33&(33)&S1&71&(61)&65&(54)&&&S2&90&(79)&89&(79)&O&&46&(46)&54&(53)&S1&72&(52)&73&(57)&&&S2&91&(80)&89&(80)&O&&45&(44)&43&(42)&S1&76&(55)&70&(54)&&&S2&96&(85)&94&(85)&O&&38&(37)&40&(39)&S1&78&(53)&75&(55)&&&S2&93&(79)&94&(81)&O&&35&(35)&39&(38)&S1&96&(69)&89&(67)&&&S2&99&(94)&99&(95)&O&&74&(72)&71&(69)&S1&72&(57)&69&(54)&&&S2&85&(75)&90&(79)&O&&47&(47)&52&(52)&S1&83&(58)&86&(59)&&&S2&97&(88)&97&(86)&O&&68&(67)&66&(65)&S1&98&(73)&92&(71)&&&S2&99&(94)&99&(93)&O&&69&(69)&62&(62)&S1&92&(77)&&&94&(77)&&&S2&100&(93)&98&(93)&O&&79&(78)&&&70&(69)&100&&100&(99)&(98)&&100&&100&(99)&(99)&&&57&&&&69&(57)&(69)&S1&&&S2&&&O&&&S1&&80&(64)&&&S2&&93&(85)&O&&&&55&(54)&2.0P6P8P11P7P5P2P3P1P9P1P2P1P5P1P1P8P1#SNPs&per&case:&9.3&Overall&accuracy:&100&&100&(98)&(97)&&100&&&98&(99)&(96)&&&52&&&&56&(53)&(56)&S1&&&S2&&&O&&&S1&91&(67)&89&(67)&&&S2&98&(93)&99&(93)&O&&67&(67)&69&(70)&S1&&75&(63)&&&S2&&87&(79)&O&&&&42&(42)&S1&89&(71)&87&(68)&&&S2&97&(86)&93&(82)&O&&27&(27)&28&(27)&S1&86&(66)&82&(63)&&&S2&98&(85)&93&(81)&O&&30&(30)&29&(28)&S1&&&3&(11)&&&&5&(9)&&&S2&17&(25)&16&(22)&O&&32&(33)&28&(27)&S1&85&(64)&81&(62)&&&S2&97&(85)&95&(82)&O&&29&(28)&35&(34)&S1&69&(58)&74&(58)&&&S2&92&(77)&94&(76)&O&&34&(33)&30&(30)&S1&89&(75)&92&(77)&&&S2&99&(97)&99&(96)&O&&83&(80)&73&(71)&S1&66&(58)&70&(56)&&&S2&94&(78)&94&(76)&O&&29&(29)&25&(24)&8.0GBLJOIMPKFDCEDKGKKLOIOKFOO"SCOTTI,'1'sample'SCOTTI,'2'samples'OUTBREAKER'100'Ne'bo:leneck'1Ne'bo:leneck'S1'S2'#SNPs'per'case:'10'Overall'accuracy:'S1'78'(64)'79'(63)'''S2'90'(78)'90'(79)'O''49'(49)'47'(46)'S1''91'(75)'''91'(73)'''S2'100'(97)'100'(96)'O'''64'(64)'''79'(77)'S1'86'(68)'84'(68)'''S2'86'(83)'92'(84)'O''43'(42)'48'(49)'S1''87'(68)''85'(67)'''S2'100'(89)'98'(89)'O'''49'(48)''47'(46)'S1'88'(62)'84'(65)'''S2'99'(90)'99'(87)'O''55'(53)'57'(56)'S1'93'(67)'88'(68)'''S2'93'(87)'92'(83)'O''60'(58)'60'(60)'S1'91'(63)'87'(65)'''S2'90'(80)'92'(81)'O''43'(42)'42'(41)'S1''97'(79)''98'(82)'''S2'100'(97)'100'(96)'O'''77'(75)'''89'(86)'S1'82'(64)'82'(62)'''S2'84'(76)'88'(77)'O''61'(60)'57'(57)'S1''86'(65)''91'(67)'''S2'100'(93)'99'(93)'O'''71'(70)''69'(68)'S1''98'(83)'''98'(84)'''S2'100'(97)'100'(97)'O'''66'(65)''''73'(72)'S1''97'(86)''98'(85)'''S2'100'(98)'99'(97)'O'''75'(75)''80'(78)'100''100'(98)'(98)''100'100'(99)'(99)'''61''''59'(61)'(59)'S1'''S2'''O'''S1''90'(73)'''S2''96'(89)'O''''61'(60)'A"C"B"D"Figure G. Accuracy of host exposure has limited effect on SCOTTI. When
provided with inaccurate epidemiological data (exposure intervals are double in length
than true ones) SCOTTI is not considerably affected, and still shows higher accuracy
than Outbreaker. Trees, internal nodes and tips have the same respective meanings as
those in Figure E. The numbers represent inference accuracy as described in Figure C.
A) Transmission history 1 and inaccurate introduction and removal times (exposure
intervals are double in length than the truth). B) Transmission history 2 and
inaccurate introduction and removal times.

30

8.0GBLJOIMPKFDCEDKGKKLOIOKFO#SNPs&per&case:&2.6&Overall&accuracy:&S1&67&(53)&62&(50)&&&S2&74&(59)&83&(59)&O&&56&(56)&43&(41)&S1&82&(46)&69&(42)&&&S2&82&(67)&83&(63)&O&&63&(61)&56&(53)&S1&74&(39)&78&(41)&&&S2&63&(41)&76&(45)&O&&32&(33)&33&(33)&S1&87&(49)&80&(47)&&&S2&82&(54)&82&(54)&O&&47&(47)&41&(40)&S1&35&(24)&31&(23)&&&S2&52&(36)&59&(39)&O&&40&(38)&31&(29)&S1&47&(27)&36&(26)&&&S2&53&(36)&55&(39)&O&&33&(35)&31&(32)&S1&44&(25)&44&(26)&&&S2&53&(36)&54&(38)&O&&31&(30)&31&(31)&S1&91&(58)&92&(60)&&&S2&97&(79)&94&(77)&O&&66&(63)&74&(71)&S1&71&(38)&78&(42)&&&S2&77&(51)&73&(48)&O&&28&(30)&34&(36)&S1&75&(46)&83&(46)&&&S2&95&(70)&89&(67)&O&&58&(57)&47&(46)&S1&90&(69)&95&(60)&&&S2&89&(74)&93&(76)&O&&71&(69)&64&(61)&S1&87&(60)&90&(59)&&&S2&92&(75)&91&(75)&O&&78&(76)&70&(68)&100&&&98&(83)&(80)&&&98&&&&97&(76)&(74)&&&73&&&&61&(73)&(61)&S1&&&S2&&&O&&&S1&&73&(46)&&&S2&&78&(58)&O&&&&50&(49)&O"SCOTTI,&1&sample&SCOTTI,&2&samples&OUTBREAKER&100&Ne&boLleneck&1Ne&boLleneck&S1&S2&2.0P6P8P11P7P5P2P3P1P9P1P2P1P5P1P1P8P1#SNPs&per&case:&2.2&Overall&accuracy:&100&&&99&(82)&(85)&&&92&&&&98&(81)&(85)&&&54&&&&46&(55)&(47)&S1&&&S2&&&O&&&S1&51&(33)&44&(31)&&&S2&63&(51)&70&(54)&O&&53&(52)&45&(46)&S1&&53&(41)&&&S2&&56&(47)&O&&&&33&(33)&S1&59&(38)&55&(39)&&&S2&60&(44)&67&(44)&O&&21&(20)&30&(29)&S1&56&(39)&52&(38)&&&S2&50&(41)&49&(38)&O&&28&(25)&23&(25)&S1&&7&(11)&&14&(13)&&&S2&14&(16)&13&(15)&O&&28&(28)&29&(29)&S1&55&(38)&51&(38)&&&S2&55&(41)&47&(38)&O&&21&(22)&24&(25)&S1&48&(37)&41&(37)&&&S2&42&(39)&40&(38)&O&&22&(22)&17&(17)&S1&82&(54)&76&(50)&&&S2&90&(71)&89&(75)&O&&61&(62)&58&(55)&S1&36&(37)&35&(38)&&&S2&33&(40)&34&(39)&O&&17&(17)&16&(16)&A"B"Figure H. Effects of sampling times on the reconstruction of transmission.
With late sampling times (close to infection clearance) SCOTTI shows higher accuracy
than Outbreaker, which has high error rates. With samples collected early in infection,
instead, SCOTTI has a noticeable decrease in accuracy, and becomes less accurate than
Outbreaker. Trees, internal nodes and tips have the same respective meanings as those
in Figure E. The numbers represent inference accuracy as described in Figure C. A)
Transmission history 1 and late sampling (at host clearance). B) Transmission history 2
and late sampling. C) Transmission history 1 and early sampling (close to infection
time). D) Transmission history 2 and early sampling.

31

2.0P6P8P11P7P5P2P3P1P9P1P2P1P5P1P1P8P1#SNPs&per&case:&3.7&Overall&accuracy:&100&100&(93)&(93)&&100&100&(96)&(97)&&&0&&&&&&0&(1)&&&(1)&S1&&&S2&&&O&&&S1&44&(34)&63&(37)&&&S2&70&(46)&72&(50)&O&&&&0&(0)&&&&0&(0)&S1&&54&(44)&&&S2&&58&(49)&O&&&&&7&&(7)&S1&65&(44)&65&(45)&&&S2&64&(48)&74&(50)&O&&&&0&(0)&&&&0&(0)&S1&54&(41)&51&(41)&&&S2&56&(46)&58&(46)&O&&&&0&(0)&&&&&0&(0)&S1&0&(4)&&&&1&(4)&&&S2&0&(6)&&&&1&(5)&O&36&(34)&33&(32)&S1&51&(40)&45&(40)&&&S2&49&(43)&59&(47)&O&&19&(18)&12&(13)&S1&43&(39)&41&(39)&&&S2&36&(40)&46&(42)&O&&22&(20)&10&(10)&S1&86&(59)&82&(55)&&&S2&90&(65)&93&(72)&O&&&&0&(0)&&&&0&(0)&S1&40&(40)&36&(41)&&&S2&33&(41)&43&(44)&O&&&&0&(0)&&&&&0&(0)&8.0GBLJOIMPKFDCEDKGKKLOIOKFO#SNPs&per&case:&3.7&Overall&accuracy:&S1&64&(52)&57&(51)&&&S2&52&(48)&59&(49)&O&&&&0&(0)&&&&0&(0)&S1&92&(57)&83&(54)&&&S2&89&(64)&86&(65)&O&&34&(33)&33&(33)&S1&76&(51)&72&(50)&&&S2&78&(54)&85&(56)&O&&52&(52)&55&(56)&S1&75&(50)&66&(49)&&&S2&70&(51)&71&(51)&O&&39&(38)&31&(30)&S1&50&(33)&42&(31)&&&S2&55&(36)&56&(37)&O&&37&(37)&30&(30)&S1&63&(38)&53&(33)&&&S2&80&(47)&77&(47)&O&&36&(35)&25&(24)&S1&69&(39)&68&(37)&&&S2&81&(45)&82&(47)&O&&38&(37)&26&(26)&S1&&95&(55)&&95&(55)&&&S2&100&(64)&99&(64)&O&&&30&(29)&&&31&(31)&S1&80&(55)&84&(54)&&&S2&78&(57)&82&(57)&O&&49&(45)&46&(48)&S1&63&(39)&60&(37)&&&S2&75&(46)&75&(45)&O&&47&(45)&30&(31)&S1&&98&(62)&&99&(61)&&&S2&100&(71)&98&(70)&O&&&&&6&(7)&&&&&&&6&(7)&S1&100&(62)&98&(57)&&&S2&100&(71)&99&(72)&O&&&&&7&(8)&&&&&12&(11)&&100&&&100&&(95)&&&(95)&&&100&&&100&&(97)&&&(96)&&&100&&&100&(100)&(100)&S1&&&S2&&&O&&&S1&&77&(52)&&&S2&&82&(58)&O&&&&35&(34)&O"SCOTTI,&1&sample&SCOTTI,&2&samples&OUTBREAKER&100&Ne&boLleneck&1Ne&boLleneck&S1&S2&2.0P6P8P11P7P5P2P3P1P9P1P2P1P5P1P1P8P1#SNPs&per&case:&1.1&Overall&accuracy:&&100&&&100&(100)&(100)&&&100&&&100&(100)&(100)&&&100&&&&100&(100)&(100)&S1&&&S2&&&O&&&S1&15&(17)&10&(15)&&&S2&56&(38)&59&(39)&O&&66&(67)&60&(61)&S1&&16&(28)&&&S2&&46&(42)&O&&&&60&(60)&S1&&0&(14)&&0&(13)&&&S2&11&(16)&7&(13)&O&17&(24)&15&(18)&S1&&0&(18)&&0&(17)&&&S2&27&(25)&12&(21)&O&&29&(39)&31&(38)&S1&10&(19)&8&(17)&&&S2&50&(39)&44&(36)&O&&65&(61)&67&(62)&S1&&2&(17)&&1&(17)&&&S2&26&(28)&16&(24)&O&&48&(48)&32&(37)&S1&&1&(22)&&2&(22)&&&S2&34&(38)&33&(39)&O&&81&(74)&75&(70)&S1&&5&(20)&&&3&(18)&&&S2&52&(37)&43&(34)&O&&55&(54)&58&(53)&S1&10&(29)&12&(30)&&&S2&77&(61)&75&(61)&O&&89&(87)&86&(83)&8.0GBLJOIMPKFDCEDKGKKLOIOKFO#SNPs&per&case:&1.8&Overall&accuracy:&S1&&0&(15)&&&0&(13)&&&S2&&1&(29)&&&2&(29)&O&100&(99)&99&(98)&S1&&1&(17)&&&3&(20)&&&S2&39&(35)&40&(36)&O&&72&(64)&70&(60)&S1&0&(8)&&&&&0&(8)&&&S2&0&(17)&&0&(18)&O&24&(31)&24&(29)&S1&0&(11)&0&(11)&&&S2&0&(23)&0&(23)&O&54&(61)&42&(50)&S1&&3&(19)&&4&(17)&&&S2&47&(37)&34&(34)&O&&58&(54)&52&(50)&S1&&2&(17)&&2&(17)&&&S2&30&(29)&15&(24)&O&&41&(45)&35&(40)&S1&&1&(15)&&&2&(13)&&&S2&27&(24)&15&(20)&O&&30&(29)&17&(20)&S1&38&(36)&36&(35)&&&S2&91&(57)&86&(51)&O&&87&(67)&79&(67)&S1&&0&(7)&&&&0&(7)&&&S2&0&(12)&&0&(13)&O&16&(23)&11&(18)&S1&&0&(20)&&2&(19)&&&S2&55&(41)&49&(38)&O&&64&(56)&58&(55)&S1&15&(27)&13&(25)&&&S2&82&(45)&80&(43)&O&&99&(95)&92&(84)&S1&24&(25)&&&17&(23)&&&S2&88&(41)&&&82&(39)&O&100&(97)&100&(98)&&100&&&100&(100)&(100)&&&100&&&100&(100)&(100)&&&100&&&&100&(100)&(100)&S1&&&S2&&&O&&&S1&&14&(24)&&&S2&&41&(37)&O&&&&62&(61)&A"C"B"D"Figure I. Epidemiological and genetic information from the FMDV
outbreak [15]. Details of the FMDV outbreak dataset considered. This figure is
reproduced from [15]. A) Connecting lines represent a nucleotide substitution, thicker
lines represent non-synonymous substitutions, with substitutions indicative of
adaptation to cell culture coloured green. Sequenced haplotypes (red circles), and
putative ancestral virus haplotypes (white circles) are shown. B) Lesion age derived
infection profiles of holdings overlaid with the outbreak virus geneology. The orange
shading estimates the time when animals with lesions were present from the oldest
lesion age at post-mortem. For IP2c, there were no clinical signs of disease. The light
blue shading represents incubation periods for each holding, estimated to begin no more
than 14 days prior to appearance of lesions. The dark blue shading is the infection date
based on the most likely incubation time for this strain of 2-5 days. Each UK 2007
outbreak virus haplotype is plotted according to the time the sample was taken from
the affected animal (X axis).

32

Figure J. Presence of patients within the wards affected by the K.
pneumoniae outbreak [30]. Timeline of K. pneumoniae patients exposures,
including individuals who were both part of epidemiologically defined clusters and had
genetically linked outbreak strains. This figure is reproduced from [30].

33

